{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExMzEzMDIz", "number": 2646, "title": "feature: add support for HikariCP", "bodyText": "HikariCP is a solid, high-performance, JDBC connection pool.\nSpring Boot uses HikariCP as the default DataSource from 2.X.\n\nbrettwooldridge/HikariCP: \u5149 HikariCP\u30fbA solid, high-performance, JDBC connection pool at last.\nMySQL Configuration \u00b7 brettwooldridge/HikariCP Wiki", "createdAt": "2020-04-30T10:08:12Z", "url": "https://github.com/seata/seata/pull/2646", "merged": true, "mergeCommit": {"oid": "1811109de6f7c87220d836f0780566c329f7cdc1"}, "closed": true, "closedAt": "2020-05-09T03:05:33Z", "author": {"login": "diguage"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcdtgF4AFqTQwNDYzNTMwOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfdjauAFqTQwODYwNjAwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NjM1MzA5", "url": "https://github.com/seata/seata/pull/2646#pullrequestreview-404635309", "createdAt": "2020-05-03T16:30:34Z", "commit": {"oid": "4da2e81da4ed0aa23d49013ed361f0ca8d9174f4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QxNjozMDozNFrOGPtfFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QxNjozMDozNFrOGPtfFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTEyNzA2Mg==", "bodyText": "", "url": "https://github.com/seata/seata/pull/2646#discussion_r419127062", "createdAt": "2020-05-03T16:30:34Z", "author": {"login": "slievrly"}, "path": "server/src/main/java/io/seata/server/store/HikariDataSourceGenerator.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.server.store;\n+\n+import javax.sql.DataSource;\n+import java.util.Properties;\n+\n+import com.zaxxer.hikari.HikariConfig;\n+import com.zaxxer.hikari.HikariDataSource;\n+import io.seata.common.loader.LoadLevel;\n+import io.seata.core.store.db.AbstractDataSourceGenerator;\n+\n+/**\n+ * The type Hikari data source generator.\n+ *\n+ * @author diguage\n+ */\n+@LoadLevel(name = \"hikari\")\n+public class HikariDataSourceGenerator extends AbstractDataSourceGenerator {\n+    @Override\n+    public DataSource generateDataSource() {\n+        Properties properties = new Properties();\n+        properties.setProperty(\"dataSource.cachePrepStmts\", \"true\");\n+        properties.setProperty(\"dataSource.prepStmtCacheSize\", \"250\");\n+        properties.setProperty(\"dataSource.prepStmtCacheSqlLimit\", \"2048\");\n+        properties.setProperty(\"dataSource.useServerPrepStmts\", \"true\");\n+        properties.setProperty(\"dataSource.useLocalSessionState\", \"true\");\n+        properties.setProperty(\"dataSource.rewriteBatchedStatements\", \"true\");\n+        properties.setProperty(\"dataSource.cacheResultSetMetadata\", \"true\");\n+        properties.setProperty(\"dataSource.cacheServerConfiguration\", \"true\");\n+        properties.setProperty(\"dataSource.elideSetAutoCommits\", \"true\");\n+        properties.setProperty(\"dataSource.maintainTimeStats\", \"false\");\n+\n+        HikariConfig config = new HikariConfig(properties);\n+        config.setDriverClassName(getDriverClassName());\n+        config.setJdbcUrl(getUrl());\n+        config.setUsername(getUser());\n+        config.setPassword(getPassword());\n+        config.setMaximumPoolSize(getMaxConn());\n+        config.setMinimumIdle(getMinConn());\n+        config.setAutoCommit(true);\n+        config.setConnectionTestQuery(getValidationQuery(getDBType()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4da2e81da4ed0aa23d49013ed361f0ca8d9174f4"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d714992aeb81300bc7f95f0c0582a5e966dc8d19", "author": {"user": {"login": "diguage", "name": null}}, "url": "https://github.com/seata/seata/commit/d714992aeb81300bc7f95f0c0582a5e966dc8d19", "committedDate": "2020-05-04T01:07:31Z", "message": "feature: add support for HikariCP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4da2e81da4ed0aa23d49013ed361f0ca8d9174f4", "author": {"user": {"login": "zjinlei", "name": null}}, "url": "https://github.com/seata/seata/commit/4da2e81da4ed0aa23d49013ed361f0ca8d9174f4", "committedDate": "2020-05-03T11:07:45Z", "message": "Merge branch 'develop' into hikari-data-source"}, "afterCommit": {"oid": "d714992aeb81300bc7f95f0c0582a5e966dc8d19", "author": {"user": {"login": "diguage", "name": null}}, "url": "https://github.com/seata/seata/commit/d714992aeb81300bc7f95f0c0582a5e966dc8d19", "committedDate": "2020-05-04T01:07:31Z", "message": "feature: add support for HikariCP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f121cac4ac1220ea601390af3929f799b03b4dc", "author": {"user": {"login": "slievrly", "name": "jimin"}}, "url": "https://github.com/seata/seata/commit/1f121cac4ac1220ea601390af3929f799b03b4dc", "committedDate": "2020-05-06T10:22:50Z", "message": "Merge branch 'develop' into hikari-data-source"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c43fde36328b78d015e1aa314d914198b561def", "author": {"user": {"login": "diguage", "name": null}}, "url": "https://github.com/seata/seata/commit/8c43fde36328b78d015e1aa314d914198b561def", "committedDate": "2020-05-07T06:40:42Z", "message": "delete config for connectionTestQuery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e375e5b4d361cbda5d233d2f7f7194acfe79cafb", "author": {"user": {"login": "diguage", "name": null}}, "url": "https://github.com/seata/seata/commit/e375e5b4d361cbda5d233d2f7f7194acfe79cafb", "committedDate": "2020-05-07T06:42:01Z", "message": "Merge branch 'hikari-data-source' of github.com:diguage/seata into hikari-data-source"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MjUyNjQ0", "url": "https://github.com/seata/seata/pull/2646#pullrequestreview-407252644", "createdAt": "2020-05-07T08:24:31Z", "commit": {"oid": "e375e5b4d361cbda5d233d2f7f7194acfe79cafb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4190691ba21b7ca92d61b7ea7094b851c356db0", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/f4190691ba21b7ca92d61b7ea7094b851c356db0", "committedDate": "2020-05-08T01:20:45Z", "message": "Merge branch 'develop' into hikari-data-source"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55e768b9c3f2c374bc40372bf328254cea3246a5", "author": {"user": {"login": "zjinlei", "name": null}}, "url": "https://github.com/seata/seata/commit/55e768b9c3f2c374bc40372bf328254cea3246a5", "committedDate": "2020-05-08T04:00:03Z", "message": "Merge branch 'develop' into hikari-data-source"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e3dd2278b1a28c08a7985c850561a501187f7d9", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/7e3dd2278b1a28c08a7985c850561a501187f7d9", "committedDate": "2020-05-08T09:04:29Z", "message": "Merge branch 'develop' into hikari-data-source"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4MDA1MjY4", "url": "https://github.com/seata/seata/pull/2646#pullrequestreview-408005268", "createdAt": "2020-05-08T05:31:25Z", "commit": {"oid": "55e768b9c3f2c374bc40372bf328254cea3246a5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQwNTozMToyNVrOGSZmsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQwNTozMToyNVrOGSZmsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk0NzA1Ng==", "bodyText": "connectionTimeout is equivalent to druid maxWait? if yes, please add config.setConnectionTimeout(getMaxWait());", "url": "https://github.com/seata/seata/pull/2646#discussion_r421947056", "createdAt": "2020-05-08T05:31:25Z", "author": {"login": "a364176773"}, "path": "server/src/main/java/io/seata/server/store/HikariDataSourceGenerator.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.server.store;\n+\n+import javax.sql.DataSource;\n+import java.util.Properties;\n+\n+import com.zaxxer.hikari.HikariConfig;\n+import com.zaxxer.hikari.HikariDataSource;\n+import io.seata.common.loader.LoadLevel;\n+import io.seata.core.store.db.AbstractDataSourceGenerator;\n+\n+/**\n+ * The type Hikari data source generator.\n+ *\n+ * @author diguage\n+ */\n+@LoadLevel(name = \"hikari\")\n+public class HikariDataSourceGenerator extends AbstractDataSourceGenerator {\n+    @Override\n+    public DataSource generateDataSource() {\n+        Properties properties = new Properties();\n+        properties.setProperty(\"dataSource.cachePrepStmts\", \"true\");\n+        properties.setProperty(\"dataSource.prepStmtCacheSize\", \"250\");\n+        properties.setProperty(\"dataSource.prepStmtCacheSqlLimit\", \"2048\");\n+        properties.setProperty(\"dataSource.useServerPrepStmts\", \"true\");\n+        properties.setProperty(\"dataSource.useLocalSessionState\", \"true\");\n+        properties.setProperty(\"dataSource.rewriteBatchedStatements\", \"true\");\n+        properties.setProperty(\"dataSource.cacheResultSetMetadata\", \"true\");\n+        properties.setProperty(\"dataSource.cacheServerConfiguration\", \"true\");\n+        properties.setProperty(\"dataSource.elideSetAutoCommits\", \"true\");\n+        properties.setProperty(\"dataSource.maintainTimeStats\", \"false\");\n+\n+        HikariConfig config = new HikariConfig(properties);\n+        config.setDriverClassName(getDriverClassName());\n+        config.setJdbcUrl(getUrl());\n+        config.setUsername(getUser());\n+        config.setPassword(getPassword());\n+        config.setMaximumPoolSize(getMaxConn());\n+        config.setMinimumIdle(getMinConn());\n+        config.setAutoCommit(true);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55e768b9c3f2c374bc40372bf328254cea3246a5"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "731805fc13f887611eabe0211d09d4f2a8ed195d", "author": {"user": {"login": "diguage", "name": null}}, "url": "https://github.com/seata/seata/commit/731805fc13f887611eabe0211d09d4f2a8ed195d", "committedDate": "2020-05-09T02:54:32Z", "message": "add config for connectionTimeout"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NjA2MDA4", "url": "https://github.com/seata/seata/pull/2646#pullrequestreview-408606008", "createdAt": "2020-05-09T03:03:40Z", "commit": {"oid": "7e3dd2278b1a28c08a7985c850561a501187f7d9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3953, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}