{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0NTM4ODEz", "number": 3201, "title": "optimize: no longer substring the message in rpc transmission", "bodyText": "\u2160. Describe what this PR did\nUser Feedback: Misunderstand the message when transaction error occurred in TC. Because if the message longer than 128 byte, and TC would substring the message before rpc transmission.\nno longer substring the message in rpc transmission and show the hold message especially in transaction error.\n\u2161. Does this pull request fix one issue?\n\u2162. Why don't you add test cases (unit test/integration test)?\n\u2163. Describe how to verify it\n\u2164. Special notes for reviews", "createdAt": "2020-10-16T03:53:20Z", "url": "https://github.com/seata/seata/pull/3201", "merged": true, "mergeCommit": {"oid": "0e380806151b8e6d24e5dce2a7e654a3c4162a31"}, "closed": true, "closedAt": "2020-10-22T07:59:24Z", "author": {"login": "l81893521"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdS8-16gH2gAyNTA0NTM4ODEzOjc3ZjdiYTc5N2Y4MDM5MmI2NmMxYjFhMTE3ZjM4NDQ4OWFjMDM3ZTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdU9RrFAFqTUxNDQ1NTk2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "77f7ba797f80392b66c1b1a117f384489ac037e5", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/77f7ba797f80392b66c1b1a117f384489ac037e5", "committedDate": "2020-10-16T02:30:49Z", "message": "optimize substring message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a383046404217f434cc95e1b3727763f85c97208", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/a383046404217f434cc95e1b3727763f85c97208", "committedDate": "2020-10-16T02:32:34Z", "message": "Merge branch 'develop' into optimize_substring_msg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b475d95f07566dfdbd448c39e2177fa9a9e6751", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/1b475d95f07566dfdbd448c39e2177fa9a9e6751", "committedDate": "2020-10-16T03:47:11Z", "message": "optimize substring message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "801195055df6d8ffa37e758cb69d35b482bddfdc", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/801195055df6d8ffa37e758cb69d35b482bddfdc", "committedDate": "2020-10-16T03:47:38Z", "message": "Merge remote-tracking branch 'me/optimize_substring_msg' into optimize_substring_msg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb9e0be8003f622d8eb66307f3f642e916710a2d", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/eb9e0be8003f622d8eb66307f3f642e916710a2d", "committedDate": "2020-10-16T03:54:01Z", "message": "Merge remote-tracking branch 'origin/develop' into optimize_substring_msg\n\n# Conflicts:\n#\tserializer/seata-serializer-seata/src/main/java/io/seata/serializer/seata/protocol/AbstractResultMessageCodec.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6cc5e70e78699fe0a2de7bd28986bf5027c2b12", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/c6cc5e70e78699fe0a2de7bd28986bf5027c2b12", "committedDate": "2020-10-16T03:58:22Z", "message": "optimize substring message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5OTk0Nzk2", "url": "https://github.com/seata/seata/pull/3201#pullrequestreview-509994796", "createdAt": "2020-10-16T03:59:40Z", "commit": {"oid": "c6cc5e70e78699fe0a2de7bd28986bf5027c2b12"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5OTk1MTU1", "url": "https://github.com/seata/seata/pull/3201#pullrequestreview-509995155", "createdAt": "2020-10-16T04:00:58Z", "commit": {"oid": "c6cc5e70e78699fe0a2de7bd28986bf5027c2b12"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "543e0f3fb01bbeeecf56eb85747339b4a42ba382", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/543e0f3fb01bbeeecf56eb85747339b4a42ba382", "committedDate": "2020-10-16T09:20:47Z", "message": "Merge branch 'develop' into optimize_substring_msg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2149c42e049bea2f97065fc898bcb75bafab97dc", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/2149c42e049bea2f97065fc898bcb75bafab97dc", "committedDate": "2020-10-17T11:15:09Z", "message": "Merge branch 'develop' into optimize_substring_msg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d6f1928f04a5835344225693b7f6d2450f12963", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/2d6f1928f04a5835344225693b7f6d2450f12963", "committedDate": "2020-10-19T01:26:54Z", "message": "Merge branch 'develop' into optimize_substring_msg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73b0b941073effbe390854753ddc1cd8f51e5fcd", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/73b0b941073effbe390854753ddc1cd8f51e5fcd", "committedDate": "2020-10-21T03:38:27Z", "message": "Merge branch 'develop' into optimize_substring_msg"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMjg2NDA1", "url": "https://github.com/seata/seata/pull/3201#pullrequestreview-513286405", "createdAt": "2020-10-21T03:46:52Z", "commit": {"oid": "73b0b941073effbe390854753ddc1cd8f51e5fcd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMzg0MTY0", "url": "https://github.com/seata/seata/pull/3201#pullrequestreview-513384164", "createdAt": "2020-10-21T07:34:19Z", "commit": {"oid": "73b0b941073effbe390854753ddc1cd8f51e5fcd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNzozNDoyMFrOHleGdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwNzozNDoyMFrOHleGdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTA1MjUzNA==", "bodyText": "short  should need to be less  2^15-1", "url": "https://github.com/seata/seata/pull/3201#discussion_r509052534", "createdAt": "2020-10-21T07:34:20Z", "author": {"login": "slievrly"}, "path": "serializer/seata-serializer-seata/src/main/java/io/seata/serializer/seata/protocol/AbstractResultMessageCodec.java", "diffHunk": "@@ -45,13 +43,7 @@\n         out.writeByte(resultCode.ordinal());\n         if (resultCode == ResultCode.Failed) {\n             if (StringUtils.isNotEmpty(resultMsg)) {\n-                String msg;\n-                if (resultMsg.length() > MAX_ERR_MSG_LEN) {\n-                    msg = resultMsg.substring(0, MAX_ERR_MSG_LEN) + \"...\";\n-                } else {\n-                    msg = resultMsg;\n-                }\n-                byte[] bs = msg.getBytes(UTF8);\n+                byte[] bs = resultMsg.getBytes(UTF8);\n                 out.writeShort((short)bs.length);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73b0b941073effbe390854753ddc1cd8f51e5fcd"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d38c14cddd019dfc0c2229347e92be85cce92e88", "author": {"user": {"login": "jsbxyyx", "name": "jsbxyyx"}}, "url": "https://github.com/seata/seata/commit/d38c14cddd019dfc0c2229347e92be85cce92e88", "committedDate": "2020-10-21T07:36:24Z", "message": "Merge branch 'develop' into optimize_substring_msg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46d361477a1fa8cea65a98f127a60c223442c006", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/46d361477a1fa8cea65a98f127a60c223442c006", "committedDate": "2020-10-21T12:19:46Z", "message": "optimize substring message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cbf222670f4e72705d96ff46fdc6a7e705dde1f", "author": {"user": {"login": "l81893521", "name": "will"}}, "url": "https://github.com/seata/seata/commit/5cbf222670f4e72705d96ff46fdc6a7e705dde1f", "committedDate": "2020-10-21T12:20:15Z", "message": "Merge remote-tracking branch 'me/optimize_substring_msg' into optimize_substring_msg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "030804fee9a9ac85cec5fe933b87059ceaa7a6a6", "author": {"user": {"login": "a364176773", "name": "FUNKYE"}}, "url": "https://github.com/seata/seata/commit/030804fee9a9ac85cec5fe933b87059ceaa7a6a6", "committedDate": "2020-10-22T05:45:20Z", "message": "Merge branch 'develop' into optimize_substring_msg"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0NDU1OTY3", "url": "https://github.com/seata/seata/pull/3201#pullrequestreview-514455967", "createdAt": "2020-10-22T07:59:14Z", "commit": {"oid": "030804fee9a9ac85cec5fe933b87059ceaa7a6a6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3710, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}