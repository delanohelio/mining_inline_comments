{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyODIwOTg3", "number": 750, "title": "Allow running rustfmt and generating only Rust flatbuffers bindings", "bodyText": "Added the --run-rustfmt command line option to run rustfmt over the generated code\n\nPreviously the types/flatbuf.rs, types/flatbuf_generated.rs and value/flatbuf.rs files were not generated for non-flatbuffers builds, which broke tooling (namely rustfmt). This was fixed by adding the generateDummyRustBindings function which makes placeholder files when flatbuffers are disabled (In the future a more preferable solution would be removing the module declarations entirely)\n\n\nAdded the --rust-flatbuffers command line option to only generate Rust flatbuffers bindings, previously passing the --java flag was required for this", "createdAt": "2020-08-24T22:31:46Z", "url": "https://github.com/vmware/differential-datalog/pull/750", "merged": true, "mergeCommit": {"oid": "0a0b9525aa7f170f56b289ab71c35779e176f0fe"}, "closed": true, "closedAt": "2020-08-25T02:56:52Z", "author": {"login": "Kixiron"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCKYoHAH2gAyNDcyODIwOTg3OjRiYmZjODExOWNmMjdlYWMxNDJjODNiYjQ1ZGRkY2QyYTFlOTQzNjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCNe5kAH2gAyNDcyODIwOTg3OjYzYjJmMDM1NjRiYzA2Yjc4OTViNjBlOWVlODZhMWZmZmM0ZDIzODY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362", "author": {"user": {"login": "Kixiron", "name": "Chase Wilson"}}, "url": "https://github.com/vmware/differential-datalog/commit/4bbfc8119cf27eac142c83bb45dddcd2a1e94362", "committedDate": "2020-08-24T22:31:02Z", "message": "Added option for generating only rust flatbuffers bindings and option to run rustfmt on generated code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0MDAzMjI3", "url": "https://github.com/vmware/differential-datalog/pull/750#pullrequestreview-474003227", "createdAt": "2020-08-24T23:54:09Z", "commit": {"oid": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMzo1NDowOVrOHF7R0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwMTo1NToxMlrOHGAMHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk3NjE0NA==", "bodyText": "Just FYI: rustfmt can take many minutes on large generated files.", "url": "https://github.com/vmware/differential-datalog/pull/750#discussion_r475976144", "createdAt": "2020-08-24T23:54:09Z", "author": {"login": "ryzhyk"}, "path": "app/Main.hs", "diffHunk": "@@ -63,6 +63,8 @@ data TOption = Help\n              | ReValidate\n              | OmitProfile\n              | OmitWorkspace\n+             | RunRustfmt", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk3OTI2Ng==", "bodyText": "Does this need to be exported?", "url": "https://github.com/vmware/differential-datalog/pull/750#discussion_r475979266", "createdAt": "2020-08-24T23:58:40Z", "author": {"login": "ryzhyk"}, "path": "src/Language/DifferentialDatalog/FlatBuffer.hs", "diffHunk": "@@ -60,9 +60,11 @@ TODO: Generated Java code structure:\n \n {-# LANGUAGE RecordWildCards, FlexibleContexts, LambdaCase, OverloadedStrings, ImplicitParams, TemplateHaskell #-}\n \n-module Language.DifferentialDatalog.FlatBuffer(\n-    flatBufferValidate,\n-    compileFlatBufferBindings)\n+module Language.DifferentialDatalog.FlatBuffer\n+  ( flatBufferValidate,\n+    compileFlatBufferBindings,\n+    compileFlatBufferRustBindings,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjA1NjYwNw==", "bodyText": "We should probably also update the --java option description to specify that it implies --rust-flatbuffers.", "url": "https://github.com/vmware/differential-datalog/pull/750#discussion_r476056607", "createdAt": "2020-08-25T01:55:12Z", "author": {"login": "ryzhyk"}, "path": "app/Main.hs", "diffHunk": "@@ -86,6 +88,8 @@ options = [ Option ['h'] [\"help\"]             (NoArg Help)\n           , Option []    [\"re-validate\"]      (NoArg ReValidate)                \"[developers only] Re-validate the program after type inference and optimization passes.\"\n           , Option []    [\"omit-profile\"]     (NoArg OmitProfile)               \"Skips adding a Cargo profile (silences warnings for some rust builds, included by default)\"\n           , Option []    [\"omit-workspace\"]   (NoArg OmitWorkspace)             \"Skips adding a Cargo workspace (silences errors for some rust builds, included by default)\"\n+          , Option []    [\"run-rustfmt\"]      (NoArg RunRustfmt)                \"Attempts to run rustfmt on the generated code after it's emitted\"\n+          , Option []    [\"rust-flatbuffers\"] (NoArg RustFlatBuffers)           \"Builds flatbuffers bindings for Rust\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4bbfc8119cf27eac142c83bb45dddcd2a1e94362"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "411ba90fb91a488c431d638ae952350afb827e3b", "author": {"user": {"login": "Kixiron", "name": "Chase Wilson"}}, "url": "https://github.com/vmware/differential-datalog/commit/411ba90fb91a488c431d638ae952350afb827e3b", "committedDate": "2020-08-25T01:59:33Z", "message": "Removed redundant export"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63b2f03564bc06b7895b60e9ee86a1fffc4d2386", "author": {"user": {"login": "Kixiron", "name": "Chase Wilson"}}, "url": "https://github.com/vmware/differential-datalog/commit/63b2f03564bc06b7895b60e9ee86a1fffc4d2386", "committedDate": "2020-08-25T02:07:36Z", "message": "Improved --java cli description"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4598, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}