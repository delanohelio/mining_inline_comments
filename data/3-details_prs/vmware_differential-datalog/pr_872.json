{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyMDc5ODQ5", "number": 872, "title": "Split tuples, arrays and the C API off from the records file and refactored them", "bodyText": "Made differential_datalog/records.rs into a module\nPulled the C API out of it, refactored a bit and put it into a feature gated file\nRewrote the tuple macro, added 1-tuples and moved it to a file\nRefactored the array macro and moved it to a file\nAdded some utility functions to the Record enum", "createdAt": "2020-12-17T19:32:54Z", "url": "https://github.com/vmware/differential-datalog/pull/872", "merged": true, "mergeCommit": {"oid": "6293df06defb334f039dcf59927de3ed838c7d69"}, "closed": true, "closedAt": "2020-12-22T21:16:25Z", "author": {"login": "Kixiron"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnKBnlABqjQxMjcwMTg1NDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdowh86ABqjQxNDE2NTI2NjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "504d673ee625ba1f9bef93ae0fadc68e236132a1", "author": {"user": {"login": "Kixiron", "name": "Chase Wilson"}}, "url": "https://github.com/vmware/differential-datalog/commit/504d673ee625ba1f9bef93ae0fadc68e236132a1", "committedDate": "2020-12-17T19:32:12Z", "message": "Split tuples, arrays and the C API off from the records file and refactored them"}, "afterCommit": {"oid": "39fed97998e778593dee433e7a965e8b649c230d", "author": {"user": {"login": "Kixiron", "name": "Chase Wilson"}}, "url": "https://github.com/vmware/differential-datalog/commit/39fed97998e778593dee433e7a965e8b649c230d", "committedDate": "2020-12-17T21:00:58Z", "message": "Split tuples, arrays and the C API off from the records file and refactored them"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2MDY4Njg0", "url": "https://github.com/vmware/differential-datalog/pull/872#pullrequestreview-556068684", "createdAt": "2020-12-20T22:46:14Z", "commit": {"oid": "39fed97998e778593dee433e7a965e8b649c230d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMFQyMjo0NjoxNFrOIJIfyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMFQyMjo0NjoxNFrOIJIfyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQ0NzMwNg==", "bodyText": "This requires Rust 1.48 (https://doc.rust-lang.org/std/primitive.array.html#impl-TryFrom%3CVec%3CT%3E%3E).\nI will roll this back to the old implementation.", "url": "https://github.com/vmware/differential-datalog/pull/872#discussion_r546447306", "createdAt": "2020-12-20T22:46:14Z", "author": {"login": "ryzhyk"}, "path": "rust/template/differential_datalog/record/arrays.rs", "diffHunk": "@@ -0,0 +1,44 @@\n+//! Implementing `Record`-related traits for Rust arrays\n+\n+use crate::record::{CollectionKind, FromRecord, IntoRecord, Mutator, Record};\n+use std::convert::TryInto;\n+\n+/// Implements `FromRecord`, `IntoRecord` and `Mutator` for arrays\n+// FIXME: Replace this with `min_const_generics` after Rust v1.50\n+//        https://github.com/rust-lang/rust/issues/74878\n+macro_rules! ddlog_array_traits {\n+    ($($length:literal),* $(,)?) => {\n+        $(\n+            impl<T: FromRecord> FromRecord for [T; $length] {\n+                fn from_record(val: &Record) -> Result<Self, String> {\n+                    Vec::from_record(val)?.try_into().map_err(|_| {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39fed97998e778593dee433e7a965e8b649c230d"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "39fed97998e778593dee433e7a965e8b649c230d", "author": {"user": {"login": "Kixiron", "name": "Chase Wilson"}}, "url": "https://github.com/vmware/differential-datalog/commit/39fed97998e778593dee433e7a965e8b649c230d", "committedDate": "2020-12-17T21:00:58Z", "message": "Split tuples, arrays and the C API off from the records file and refactored them"}, "afterCommit": {"oid": "f7dcc30d405fbdcf62e3917cef6af3e2f2966e01", "author": {"user": {"login": "ryzhyk", "name": "Leonid Ryzhyk"}}, "url": "https://github.com/vmware/differential-datalog/commit/f7dcc30d405fbdcf62e3917cef6af3e2f2966e01", "committedDate": "2020-12-21T01:14:02Z", "message": "Upgrade minimal supported version of Rust to 1.47.\n\nWe have so far maintained compatibility with Rust 1.41+.  Newer versions\nhave more and more features that we'd like to use, as well as some that\nbreak backwards compatibility.  We therefore upgrade our Rust dependency\nto 1.47.\n\nSome earlier versions might still work, but 1.47.0 is going to be the\nearliest \"officially\" supported one."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f7dcc30d405fbdcf62e3917cef6af3e2f2966e01", "author": {"user": {"login": "ryzhyk", "name": "Leonid Ryzhyk"}}, "url": "https://github.com/vmware/differential-datalog/commit/f7dcc30d405fbdcf62e3917cef6af3e2f2966e01", "committedDate": "2020-12-21T01:14:02Z", "message": "Upgrade minimal supported version of Rust to 1.47.\n\nWe have so far maintained compatibility with Rust 1.41+.  Newer versions\nhave more and more features that we'd like to use, as well as some that\nbreak backwards compatibility.  We therefore upgrade our Rust dependency\nto 1.47.\n\nSome earlier versions might still work, but 1.47.0 is going to be the\nearliest \"officially\" supported one."}, "afterCommit": {"oid": "e476cac44cf9c80a603791e72b7d2e376e8cbf53", "author": {"user": {"login": "ryzhyk", "name": "Leonid Ryzhyk"}}, "url": "https://github.com/vmware/differential-datalog/commit/e476cac44cf9c80a603791e72b7d2e376e8cbf53", "committedDate": "2020-12-22T07:07:06Z", "message": "Upgrade minimal supported version of Rust to 1.47.\n\nWe have so far maintained compatibility with Rust 1.41+.  Newer versions\nhave more and more features that we'd like to use, as well as some that\nbreak backwards compatibility.  We therefore upgrade our Rust dependency\nto 1.47.\n\nSome earlier versions might still work, but 1.47.0 is going to be the\nearliest \"officially\" supported one."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "625c3e6e3d9743af816a932060c860205823f505", "author": {"user": {"login": "Kixiron", "name": "Chase Wilson"}}, "url": "https://github.com/vmware/differential-datalog/commit/625c3e6e3d9743af816a932060c860205823f505", "committedDate": "2020-12-22T20:08:20Z", "message": "Split tuples, arrays and the C API off from the records file and refactored them"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b18c6f36f93c4f16ff90b8507fc8ccd2befa4fbb", "author": {"user": {"login": "ryzhyk", "name": "Leonid Ryzhyk"}}, "url": "https://github.com/vmware/differential-datalog/commit/b18c6f36f93c4f16ff90b8507fc8ccd2befa4fbb", "committedDate": "2020-12-22T20:08:20Z", "message": "Upgrade minimal supported version of Rust to 1.47.\n\nWe have so far maintained compatibility with Rust 1.41+.  Newer versions\nhave more and more features that we'd like to use, as well as some that\nbreak backwards compatibility.  We therefore upgrade our Rust dependency\nto 1.47.\n\nSome earlier versions might still work, but 1.47.0 is going to be the\nearliest \"officially\" supported one."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05a471ebd99892688b564bc8ac7d59161f91a238", "author": {"user": {"login": "ryzhyk", "name": "Leonid Ryzhyk"}}, "url": "https://github.com/vmware/differential-datalog/commit/05a471ebd99892688b564bc8ac7d59161f91a238", "committedDate": "2020-12-22T20:24:18Z", "message": "Move record::c_api back in the main record module.\n\nAfter `record.rs` was split into multiple modules, the C API disappeared\nfrom the compiled .so library.  This is likely due to this compiler bug:\nhttps://github.com/rust-lang/rust/issues/50007\n\nAs a workaround until the bug is fixed, we move the API from `record/c_api.rs`\nto `record/mod.rs`."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e476cac44cf9c80a603791e72b7d2e376e8cbf53", "author": {"user": {"login": "ryzhyk", "name": "Leonid Ryzhyk"}}, "url": "https://github.com/vmware/differential-datalog/commit/e476cac44cf9c80a603791e72b7d2e376e8cbf53", "committedDate": "2020-12-22T07:07:06Z", "message": "Upgrade minimal supported version of Rust to 1.47.\n\nWe have so far maintained compatibility with Rust 1.41+.  Newer versions\nhave more and more features that we'd like to use, as well as some that\nbreak backwards compatibility.  We therefore upgrade our Rust dependency\nto 1.47.\n\nSome earlier versions might still work, but 1.47.0 is going to be the\nearliest \"officially\" supported one."}, "afterCommit": {"oid": "05a471ebd99892688b564bc8ac7d59161f91a238", "author": {"user": {"login": "ryzhyk", "name": "Leonid Ryzhyk"}}, "url": "https://github.com/vmware/differential-datalog/commit/05a471ebd99892688b564bc8ac7d59161f91a238", "committedDate": "2020-12-22T20:24:18Z", "message": "Move record::c_api back in the main record module.\n\nAfter `record.rs` was split into multiple modules, the C API disappeared\nfrom the compiled .so library.  This is likely due to this compiler bug:\nhttps://github.com/rust-lang/rust/issues/50007\n\nAs a workaround until the bug is fixed, we move the API from `record/c_api.rs`\nto `record/mod.rs`."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4496, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}