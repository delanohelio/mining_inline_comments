{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0NDUyMjU2", "number": 754, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwNToyMDozN1rOEdDMQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwNToyMDozN1rOEdDMQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4ODk2NDQ5OnYy", "diffSide": "RIGHT", "path": "src/Language/DifferentialDatalog/Compile.hs", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwNToyMDozN1rOHH-8FQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QwNToyODoxM1rOHH_OfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODEzMzI2OQ==", "bodyText": "Unfortunately, this does not work.  I don't remember the exact error, but basically rustc failed when there were too many static variables within a single lazy_static.", "url": "https://github.com/vmware/differential-datalog/pull/754#discussion_r478133269", "createdAt": "2020-08-27T05:20:37Z", "author": {"login": "ryzhyk"}, "path": "src/Language/DifferentialDatalog/Compile.hs", "diffHunk": "@@ -624,13 +624,19 @@ collectStatics d = execState (progExprMapCtxM d (checkStaticExpr)) M.empty\n -- computed by 'collectStatics'.\n mkStatics :: DatalogProgram -> Statics -> Doc\n mkStatics d statics =\n-    vcat $\n-    map (\\((e, t), i) ->\n-            let static_name = \"__STATIC_\" <> pp i in\n-            let ?statics = deleteStatic e t statics in\n-            let e' = mkExpr d CtxTop (eTyped e t) EVal in\n-            \"lazy_static!{ pub static ref\" <+> static_name <> \":\" <+> mkType t <+> \"=\" <+> e' <+> \"; }\")\n-        $ M.toList statics\n+    \"lazy_static! {\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "358c798a5e8dff74690215340ae040f3c6e2230b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODEzNzk4MA==", "bodyText": "That's really bizarre, and rather unfortunate. I revered the change, should be good now", "url": "https://github.com/vmware/differential-datalog/pull/754#discussion_r478137980", "createdAt": "2020-08-27T05:28:13Z", "author": {"login": "Kixiron"}, "path": "src/Language/DifferentialDatalog/Compile.hs", "diffHunk": "@@ -624,13 +624,19 @@ collectStatics d = execState (progExprMapCtxM d (checkStaticExpr)) M.empty\n -- computed by 'collectStatics'.\n mkStatics :: DatalogProgram -> Statics -> Doc\n mkStatics d statics =\n-    vcat $\n-    map (\\((e, t), i) ->\n-            let static_name = \"__STATIC_\" <> pp i in\n-            let ?statics = deleteStatic e t statics in\n-            let e' = mkExpr d CtxTop (eTyped e t) EVal in\n-            \"lazy_static!{ pub static ref\" <+> static_name <> \":\" <+> mkType t <+> \"=\" <+> e' <+> \"; }\")\n-        $ M.toList statics\n+    \"lazy_static! {\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODEzMzI2OQ=="}, "originalCommit": {"oid": "358c798a5e8dff74690215340ae040f3c6e2230b"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4830, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}