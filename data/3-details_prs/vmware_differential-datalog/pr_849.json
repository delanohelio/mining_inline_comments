{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0ODE0MjIw", "number": 849, "title": "Small fixes in the language reference and a few tests", "bodyText": "", "createdAt": "2020-12-09T00:30:45Z", "url": "https://github.com/vmware/differential-datalog/pull/849", "merged": true, "mergeCommit": {"oid": "c9ed15f86550db0ca92c2d99d3f63bed4afe5395"}, "closed": true, "closedAt": "2020-12-09T21:27:08Z", "author": {"login": "mbudiu-vmw"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkV_YugFqTU0NzgwMzIyOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkknqmgBqjQwOTE4MDU0Mjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3ODAzMjI4", "url": "https://github.com/vmware/differential-datalog/pull/849#pullrequestreview-547803228", "createdAt": "2020-12-09T03:10:51Z", "commit": {"oid": "2549b7d64bceadb01d46683cff56c34325e965cd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwMzoxMDo1MlrOICAPsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwMzoxMDo1MlrOICAPsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODk3MjA4Mw==", "bodyText": "This is no longer true. All string conversion functions are called to_string(). I forgot to update the docs.", "url": "https://github.com/vmware/differential-datalog/pull/849#discussion_r538972083", "createdAt": "2020-12-09T03:10:52Z", "author": {"login": "ryzhyk"}, "path": "doc/language_reference/language_reference.md", "diffHunk": "@@ -380,45 +390,106 @@ exponent ::= (* empty *)\n            | (\"e\"|\"E\") [\"+\"|\"-\"] decimal\n ```\n \n-The \"s\" in a literal indicates a \"signed\" literal.\n+The \"s\" in a literal indicates a \"signed\" literal.  Note that floating\n+point widths can only be 32 or 64, while integer width are arbitrary.\n \n-We support two types of UTF-8 string literals: quoted strings with escaping,\n-e.g., `\"foo\\nbar\"`\n-(**We rely on parsec's standard parser for strings, which\n-supports unicode and escaping. TODO: check and document its exact\n-functionality.**) and raw strings where all characters, including backslash and\n-line breaks are interpreted as is:\n+### String literals\n \n-```EBNF\n-string_literal   ::= '\"' utf8_character* '\"'\n-                     | \"[|\" utf8_character* \"|]\"\n-```\n+We support two types of UTF-8 string literals: quoted strings with\n+escaping, and raw strings.\n \n-Multiple string literals are automatically concatenated, e.g.,\n-`\"foo\" [|bar|]` is equivalent to `\"foobar\"`.\n+In quoted strings, e.g.,`\"foo\\nbar\"` C-like escape are recognized; for\n+example single quotes and backslash characters can be escaped using\n+backslashes; `\\n` is newline, and `\\t` is tab.  Unicode character with\n+code 100 can be written as `\\u{100}`.\n \n-Interpolated strings are string literals, that contain\n-expressions inside curly brackets preceeded by a dollar sign (`${}`), whose values are substituted at runtime.\n-Quoted strings are interpolate by default, e.g.,\n-`\"x: ${x}, y: ${y}, f(x): ${f(x)}\"` is equivalent to\n-`\"x: \" ++ x ++ \", y: \" ++ y ++ \", f(x): \" ++ f(x)`.\n-\n-Raw interpolated strings must be preceed by a dollar sign:\n+Interpolated strings are string literals, that contain expressions\n+inside curly brackets preceeded by a dollar sign (`${}`), whose values\n+are substituted at runtime.  Quoted strings are interpolated by\n+default, e.g., `\"x: ${x}, y: ${y}, f(x): ${f(x)}\"` is equivalent to\n+the following string expressoin: `\"x: \" ++ x ++ \", y: \" ++ y ++ \",\n+f(x): \" ++ f(x)`.\n \n ```EBNF\n+string_literal   ::= '\"' utf8_character* '\"'\n+                     | raw_string\n+                     | raw_interpolated_string\n+\n+raw_string       ::= \"[|\" utf8_character* \"|]\"\n raw_interpolated_string ::= (\"$[|\" utf8_character* \"|]\")+\n ```\n \n+Raw strings are delimited by `[|` and `|]` (where the closing sequence\n+cannot appear nested inside the string).  In raw strings all\n+characters, including backslash and line breaks are interpreted as-is.\n+Raw strings do not perform interpolation.\n+\n+Raw interpolated strings, which are preceeded by a dollar sign, will\n+perform interpolation: `$[|x: ${x}, y: ${y}, f(x): ${f(x)}|]` produces\n+the same string as above.\n+\n+Compare the value of the raw string `[|a = ${2+3}|]`, which is the\n+string containing the following characters: `a = ${2+3}`, with the\n+value of the raw interpolated string `$[|a = ${2+3}|]`, which is the\n+string containing `a = 5`.\n+\n Expressions in curly brackets can be arbitrarily complex, as long as\n they produce results of type `string`, e.g.:\n `$[|foo{var x = \"bar\"; x}|]` will evaluate to \"foobar\" at runtime.\n \n-Other terms:\n+Consecutive string literals are automatically concatenated, e.g.,\n+`\"foo\" [|bar|]` is equivalent to `\"foobar\"`.\n+\n+### Automatic string conversion\n+\n+Values of arbitrary types that occur inside interpolated strings or as\n+a second argument to the string concatenation operator (`++`) are\n+automatically converted to strings.\n+Values of primitive types (`string`, `bigint`, `bit`, and `bool`) are converted using\n+builtin methods.\n+\n+For user-defined types, conversion is performed by calling a user-defined function", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2549b7d64bceadb01d46683cff56c34325e965cd"}, "originalPosition": 100}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e068c410f4ac93b3b7e1241d0300a3df25ed79a4", "author": {"user": {"login": "mbudiu-vmw", "name": "Mihai Budiu"}}, "url": "https://github.com/vmware/differential-datalog/commit/e068c410f4ac93b3b7e1241d0300a3df25ed79a4", "committedDate": "2020-12-09T19:58:59Z", "message": "Small fixes in the language reference and a few tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cece01a4ef92d5981bf2a8014b9168aa73844a64", "author": {"user": {"login": "mbudiu-vmw", "name": "Mihai Budiu"}}, "url": "https://github.com/vmware/differential-datalog/commit/cece01a4ef92d5981bf2a8014b9168aa73844a64", "committedDate": "2020-12-09T20:17:42Z", "message": "Fix documentation and libraries to use to_string"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2549b7d64bceadb01d46683cff56c34325e965cd", "author": {"user": {"login": "mbudiu-vmw", "name": "Mihai Budiu"}}, "url": "https://github.com/vmware/differential-datalog/commit/2549b7d64bceadb01d46683cff56c34325e965cd", "committedDate": "2020-12-09T00:29:18Z", "message": "Small fixes in the language reference and a few tests"}, "afterCommit": {"oid": "cece01a4ef92d5981bf2a8014b9168aa73844a64", "author": {"user": {"login": "mbudiu-vmw", "name": "Mihai Budiu"}}, "url": "https://github.com/vmware/differential-datalog/commit/cece01a4ef92d5981bf2a8014b9168aa73844a64", "committedDate": "2020-12-09T20:17:42Z", "message": "Fix documentation and libraries to use to_string"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4478, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}