{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2Njc4NjMz", "number": 885, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMTozNzowMFrOFJ6G6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwNDowNTo0N1rOFJ7IJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1OTMzNTQ3OnYy", "diffSide": "RIGHT", "path": "java/test1/RedistTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMTozNzowMFrOIMbqWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMTozNzowMFrOIMbqWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkwNzAzMw==", "bodyText": "why not just delete this?", "url": "https://github.com/vmware/differential-datalog/pull/885#discussion_r549907033", "createdAt": "2020-12-30T01:37:00Z", "author": {"login": "mbudiu-vmw"}, "path": "java/test1/RedistTest.java", "diffHunk": "@@ -286,7 +277,7 @@ void onCommitChange(DDlogCommand<DDlogRecord> command) {\n                 printSpan = false;\n                 System.out.println(\"Span:\");\n             }\n-            this.onCommit(command);  // process change\n+            //this.onCommit(command);  // process change", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b63b20867c7260f6f5ce53253c5fff1b223968db"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1OTMzOTExOnYy", "diffSide": "RIGHT", "path": "rust/template/distributed_datalog/src/accumulate/accumulator.rs", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMTozOTozOVrOIMbsFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMTozOTozOVrOIMbsFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkwNzQ3Ng==", "bodyText": "this one was right.", "url": "https://github.com/vmware/differential-datalog/pull/885#discussion_r549907476", "createdAt": "2020-12-30T01:39:39Z", "author": {"login": "mbudiu-vmw"}, "path": "rust/template/distributed_datalog/src/accumulate/accumulator.rs", "diffHunk": "@@ -33,7 +33,7 @@ use crate::accumulate::AccumulatingObserver;\n use crate::accumulate::TxnDistributor;\n \n /// A trait object that acts as a proxy between an observable and observer.\n-/// It accumulates the updates to maintain the current state of the data.\n+/// It accumulates the updates to maintains the current state of the data.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b63b20867c7260f6f5ce53253c5fff1b223968db"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1OTM0MTU0OnYy", "diffSide": "RIGHT", "path": "test/datalog_tests/rust_api_test/src/main.rs", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMTo0MToyOVrOIMbtSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMTo0MToyOVrOIMbtSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkwNzc4NQ==", "bodyText": "delete \"use\"", "url": "https://github.com/vmware/differential-datalog/pull/885#discussion_r549907785", "createdAt": "2020-12-30T01:41:29Z", "author": {"login": "mbudiu-vmw"}, "path": "test/datalog_tests/rust_api_test/src/main.rs", "diffHunk": "@@ -37,17 +37,15 @@ use differential_datalog::record::UpdCmd; // Dynamically typed representation of\n \n fn main() -> Result<(), String> {\n \n-    fn cb(_rel: usize, _rec: &Record, _w: isize) {}\n-\n     // Instantiate a DDlog program.\n     // Returns a handle to the program and initial contents of output relations.\n     // Arguments\n     // - number of worker threads (you typically want 1 or 2).\n     // - Boolean flag that indicates whether DDlog will track the complete snapshot\n-    //   of output relations.  Should only be used if you plan to dump `dump_table`\n-    //   their contents using `HDDlog::dump_table()`.\n-    // - Callback - obsolete and will disappear in future releases.\n-    let (mut hddlog, init_state) = HDDlog::run(1, false, cb)?;\n+    //   of output relations.  Should only be used for debugging in order to dump\n+    //   the contents of output tables using `HDDlog::dump_table()`.  Otherwise,\n+    //   use indexes are the preferred way to achieve this.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b63b20867c7260f6f5ce53253c5fff1b223968db"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1OTUwMjQ0OnYy", "diffSide": "RIGHT", "path": "CHANGELOG.md", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwNDowNTo0N1rOIMc92w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwNjoyNjoxMVrOIMeNWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkyODQxMQ==", "bodyText": "Removing the update callback from the external api should allow removing Relation.change_cb if I'm not mistaken", "url": "https://github.com/vmware/differential-datalog/pull/885#discussion_r549928411", "createdAt": "2020-12-30T04:05:47Z", "author": {"login": "Kixiron"}, "path": "CHANGELOG.md", "diffHunk": "@@ -3,6 +3,15 @@ All notable changes to this project will be documented in this file.\n \n The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n \n+## [Unreleased]\n+\n+### API changes\n+\n+- Removed callback argument from `HDDlog::run`, `ddlog_run`, and Go/Java language\n+  bindings based on `ddlog_run`.  This optional callback, invoked by DD workers on\n+  each update to an output collection complicated the API and was tricky to use\n+  correctly.  Most importantly, it is superseded by the `commit_dump_changes` API.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b456af54677ea7ab5a3d5002b63a0bebe471188"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkyODk3OQ==", "bodyText": "That callback's still used internally to implement commit_dump_change.", "url": "https://github.com/vmware/differential-datalog/pull/885#discussion_r549928979", "createdAt": "2020-12-30T04:09:26Z", "author": {"login": "ryzhyk"}, "path": "CHANGELOG.md", "diffHunk": "@@ -3,6 +3,15 @@ All notable changes to this project will be documented in this file.\n \n The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n \n+## [Unreleased]\n+\n+### API changes\n+\n+- Removed callback argument from `HDDlog::run`, `ddlog_run`, and Go/Java language\n+  bindings based on `ddlog_run`.  This optional callback, invoked by DD workers on\n+  each update to an output collection complicated the API and was tricky to use\n+  correctly.  Most importantly, it is superseded by the `commit_dump_changes` API.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkyODQxMQ=="}, "originalCommit": {"oid": "5b456af54677ea7ab5a3d5002b63a0bebe471188"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkyOTI2Mw==", "bodyText": "Darn, I would like to do a rework of that sometime then since I think it's a source of contention that isn't good for perf. If the callback is properly synchronized, we should just be able to store an Arc<dyn Callback> directly, which would eliminate the need for a mutex entirely", "url": "https://github.com/vmware/differential-datalog/pull/885#discussion_r549929263", "createdAt": "2020-12-30T04:11:36Z", "author": {"login": "Kixiron"}, "path": "CHANGELOG.md", "diffHunk": "@@ -3,6 +3,15 @@ All notable changes to this project will be documented in this file.\n \n The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n \n+## [Unreleased]\n+\n+### API changes\n+\n+- Removed callback argument from `HDDlog::run`, `ddlog_run`, and Go/Java language\n+  bindings based on `ddlog_run`.  This optional callback, invoked by DD workers on\n+  each update to an output collection complicated the API and was tricky to use\n+  correctly.  Most importantly, it is superseded by the `commit_dump_changes` API.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkyODQxMQ=="}, "originalCommit": {"oid": "5b456af54677ea7ab5a3d5002b63a0bebe471188"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk0ODQxNg==", "bodyText": "Good point, that's stupid and needs to be fixed.", "url": "https://github.com/vmware/differential-datalog/pull/885#discussion_r549948416", "createdAt": "2020-12-30T06:24:23Z", "author": {"login": "ryzhyk"}, "path": "CHANGELOG.md", "diffHunk": "@@ -3,6 +3,15 @@ All notable changes to this project will be documented in this file.\n \n The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n \n+## [Unreleased]\n+\n+### API changes\n+\n+- Removed callback argument from `HDDlog::run`, `ddlog_run`, and Go/Java language\n+  bindings based on `ddlog_run`.  This optional callback, invoked by DD workers on\n+  each update to an output collection complicated the API and was tricky to use\n+  correctly.  Most importantly, it is superseded by the `commit_dump_changes` API.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkyODQxMQ=="}, "originalCommit": {"oid": "5b456af54677ea7ab5a3d5002b63a0bebe471188"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk0ODc2MQ==", "bodyText": "PS. (but not necessarily by you, I should probably clean my own mess)", "url": "https://github.com/vmware/differential-datalog/pull/885#discussion_r549948761", "createdAt": "2020-12-30T06:26:11Z", "author": {"login": "ryzhyk"}, "path": "CHANGELOG.md", "diffHunk": "@@ -3,6 +3,15 @@ All notable changes to this project will be documented in this file.\n \n The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n \n+## [Unreleased]\n+\n+### API changes\n+\n+- Removed callback argument from `HDDlog::run`, `ddlog_run`, and Go/Java language\n+  bindings based on `ddlog_run`.  This optional callback, invoked by DD workers on\n+  each update to an output collection complicated the API and was tricky to use\n+  correctly.  Most importantly, it is superseded by the `commit_dump_changes` API.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkyODQxMQ=="}, "originalCommit": {"oid": "5b456af54677ea7ab5a3d5002b63a0bebe471188"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4726, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}