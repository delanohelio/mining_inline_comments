{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0OTU4NDkz", "number": 658, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzowMTo1N1rOD6c1Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzo0Mjo1NFrOD6dXlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNjE2MzQ2OnYy", "diffSide": "RIGHT", "path": "test/datalog_tests/json_test.dl", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzowMTo1N1rOGSTNqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzo0NjozOVrOGSUF_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg0MjM0NA==", "bodyText": "no reference output?", "url": "https://github.com/vmware/differential-datalog/pull/658#discussion_r421842344", "createdAt": "2020-05-07T23:01:57Z", "author": {"login": "mbudiu-vmw"}, "path": "test/datalog_tests/json_test.dl", "diffHunk": "@@ -183,3 +183,16 @@ JsonTest(s32FromString1(),\n          to_json_string_or_default(from_json_string(s32FromString1()): Result<S32FromString, string>)).\n JsonTest(s32FromString2(),\n          to_json_string_or_default(from_json_string(s32FromString2()): Result<S32FromString, string>)).\n+\n+typedef WrappedEnum = JsonWrapper<TaggedEnum>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f17aaa8d062cbf62d55bf45554f764b53ad265a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg1Njc2NA==", "bodyText": "Just added that.", "url": "https://github.com/vmware/differential-datalog/pull/658#discussion_r421856764", "createdAt": "2020-05-07T23:46:39Z", "author": {"login": "ryzhyk"}, "path": "test/datalog_tests/json_test.dl", "diffHunk": "@@ -183,3 +183,16 @@ JsonTest(s32FromString1(),\n          to_json_string_or_default(from_json_string(s32FromString1()): Result<S32FromString, string>)).\n JsonTest(s32FromString2(),\n          to_json_string_or_default(from_json_string(s32FromString2()): Result<S32FromString, string>)).\n+\n+typedef WrappedEnum = JsonWrapper<TaggedEnum>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg0MjM0NA=="}, "originalCommit": {"oid": "4f17aaa8d062cbf62d55bf45554f764b53ad265a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNjE2NjIyOnYy", "diffSide": "RIGHT", "path": "lib/json.dl", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzowMzoyOFrOGSTPXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzo0Njo0NVrOGSUGGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg0Mjc4Mw==", "bodyText": "if the previous annotation was obscure, this one is doubly obscure.\nMaybe once this API stabilizes we can wrap it into something that looks nicer for the user.", "url": "https://github.com/vmware/differential-datalog/pull/658#discussion_r421842783", "createdAt": "2020-05-07T23:03:28Z", "author": {"login": "mbudiu-vmw"}, "path": "lib/json.dl", "diffHunk": "@@ -20,7 +20,7 @@ extern function to_json_string(x: 'T): Result<string, string>\n \n /* Represents any valid JSON value.\n  */\n-#[rust=\"serde(from = \\\"serde_json::value::Value\\\", into = \\\"serde_json::value::Value\\\")\"]\n+#[rust=\"serde(from = \\\"__json::ValueWrapper\\\", into = \\\"__json::ValueWrapper\\\")\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f17aaa8d062cbf62d55bf45554f764b53ad265a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg1Njc5NQ==", "bodyText": "Fortunately, this is internal to the library, users don't need to understand the annotations.", "url": "https://github.com/vmware/differential-datalog/pull/658#discussion_r421856795", "createdAt": "2020-05-07T23:46:45Z", "author": {"login": "ryzhyk"}, "path": "lib/json.dl", "diffHunk": "@@ -20,7 +20,7 @@ extern function to_json_string(x: 'T): Result<string, string>\n \n /* Represents any valid JSON value.\n  */\n-#[rust=\"serde(from = \\\"serde_json::value::Value\\\", into = \\\"serde_json::value::Value\\\")\"]\n+#[rust=\"serde(from = \\\"__json::ValueWrapper\\\", into = \\\"__json::ValueWrapper\\\")\"]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg0Mjc4Mw=="}, "originalCommit": {"oid": "4f17aaa8d062cbf62d55bf45554f764b53ad265a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNjE3NzI2OnYy", "diffSide": "RIGHT", "path": "src/Language/DifferentialDatalog/Attribute.hs", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzowODo0OFrOGSTVwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzo0NzowNlrOGSUGiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg0NDQxNw==", "bodyText": "it is not useful to have this documentation just in the code, you have to surface it to the users as well.\nthere should be a section on annotations in the reference document?", "url": "https://github.com/vmware/differential-datalog/pull/658#discussion_r421844417", "createdAt": "2020-05-07T23:08:48Z", "author": {"login": "mbudiu-vmw"}, "path": "src/Language/DifferentialDatalog/Attribute.hs", "diffHunk": "@@ -127,6 +134,23 @@ tdefCheckSizeAttr d TypeDef{..} =\n          [Attribute{..}] -> err d attrPos $ \"Invalid 'size' attribute: size must be an integer between 0 and \" ++ show (maxBound::Int)\n          _                    -> err d tdefPos $ \"Multiple 'size' attributes are not allowed\"\n \n+{- 'custom_serde' attribute: Tells DDlog not to generate `Serialize` and", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f17aaa8d062cbf62d55bf45554f764b53ad265a"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg1NjkwNw==", "bodyText": "There is a section in the tutorial. I'll add the new attribute there.", "url": "https://github.com/vmware/differential-datalog/pull/658#discussion_r421856907", "createdAt": "2020-05-07T23:47:06Z", "author": {"login": "ryzhyk"}, "path": "src/Language/DifferentialDatalog/Attribute.hs", "diffHunk": "@@ -127,6 +134,23 @@ tdefCheckSizeAttr d TypeDef{..} =\n          [Attribute{..}] -> err d attrPos $ \"Invalid 'size' attribute: size must be an integer between 0 and \" ++ show (maxBound::Int)\n          _                    -> err d tdefPos $ \"Multiple 'size' attributes are not allowed\"\n \n+{- 'custom_serde' attribute: Tells DDlog not to generate `Serialize` and", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg0NDQxNw=="}, "originalCommit": {"oid": "4f17aaa8d062cbf62d55bf45554f764b53ad265a"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNjI1MTc1OnYy", "diffSide": "RIGHT", "path": "lib/json.dl", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzo0Mjo1NFrOGSUBEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzo0Mjo1NFrOGSUBEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg1NTUwNA==", "bodyText": "I don't really understand the connection between JSON, strings, and binary serialization.", "url": "https://github.com/vmware/differential-datalog/pull/658#discussion_r421855504", "createdAt": "2020-05-07T23:42:54Z", "author": {"login": "mbudiu-vmw"}, "path": "lib/json.dl", "diffHunk": "@@ -164,3 +164,27 @@ typedef JsonNum = // Integer number.  The value must be in the range between the\n                 | // NaN and infinity are not valid JSON values.\n                   // When serializing to JSON, such values will be replaced with 0.\n                   JsonFloat{d: double}\n+\n+/* Wrapper type that serializes its inner object into binary formats via JSON string.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a80c72ff8471dc299436fec621b24ccc6321400b"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4748, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}