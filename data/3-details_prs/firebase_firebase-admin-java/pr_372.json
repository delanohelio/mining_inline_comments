{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3OTg3MTQ4", "number": 372, "title": "Add deleteTenant operation to TenantManager.", "bodyText": "This pull request add deleteTenant to the TenantManager class. I've added the relevant unit tests to FirebaseUserManagerTest (based off of the getTenant unit test). This is part of the initiative to adding multi-tenancy support (see issue #332).\nREST API: https://identitytoolkit.googleapis.com/$discovery/rest?version=v2", "createdAt": "2020-02-20T21:37:55Z", "url": "https://github.com/firebase/firebase-admin-java/pull/372", "merged": true, "mergeCommit": {"oid": "a04fcfa740a902337d60d30c26ac527c0fd1583a"}, "closed": true, "closedAt": "2020-02-27T23:08:06Z", "author": {"login": "micahstairs"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGSHE_gH2gAyMzc3OTg3MTQ4OmE3NWJmYmNhOWJjNzEwNTYyY2ZlN2E4OTA3MmU0NDRkODBhZTI0NGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIjmGRAH2gAyMzc3OTg3MTQ4OmQyMjAzMWZlNjEwNDJkN2IzN2UzMDIyYjQyNmI0ZjgzNGY3NTJmYjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b", "author": {"user": {"login": "micahstairs", "name": "Micah Stairs"}}, "url": "https://github.com/firebase/firebase-admin-java/commit/a75bfbca9bc710562cfe7a89072e444d80ae244b", "committedDate": "2020-02-20T21:35:39Z", "message": "Add deleteTenant operation to TenantManager."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMzA1MDUx", "url": "https://github.com/firebase/firebase-admin-java/pull/372#pullrequestreview-362305051", "createdAt": "2020-02-20T23:21:29Z", "commit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMzoyMToyOVrOFsmmlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMzoyMjoxOFrOFsmnqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDEzMg==", "bodyText": "Should use DELETE /tenants/{tenantId} URL format here.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r382314132", "createdAt": "2020-02-20T23:21:29Z", "author": {"login": "hiranya911"}, "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "diffHunk": "@@ -226,6 +226,15 @@ UserImportResult importUsers(UserImportRequest request) throws FirebaseAuthExcep\n     return new UserImportResult(request.getUsersCount(), response);\n   }\n \n+  void deleteTenant(String tenantId) throws FirebaseAuthException {\n+    GenericUrl url = new GenericUrl(tenantMgtBaseUrl + \"/tenants:delete\");\n+    url.put(\"name\", tenantId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDQwOA==", "bodyText": "Let's also assert the URL of the outgoing request and make sure TENANT_1 is being included in the request.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r382314408", "createdAt": "2020-02-20T23:22:18Z", "author": {"login": "hiranya911"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,14 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {\n+    TestResponseInterceptor interceptor = initializeAppForUserManagement(\"{}\");\n+    // should not throw\n+    FirebaseAuth.getInstance().getTenantManager().deleteTenantAsync(\"TENANT_1\").get();\n+    checkRequestHeaders(interceptor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyODQwMjg4", "url": "https://github.com/firebase/firebase-admin-java/pull/372#pullrequestreview-362840288", "createdAt": "2020-02-21T18:48:34Z", "commit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1", "author": {"user": {"login": "micahstairs", "name": "Micah Stairs"}}, "url": "https://github.com/firebase/firebase-admin-java/commit/c03dd3627955d6d8316ea5ceca17902da7b899a1", "committedDate": "2020-02-27T17:03:09Z", "message": "Address pull request feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTI2MTc1", "url": "https://github.com/firebase/firebase-admin-java/pull/372#pullrequestreview-365926175", "createdAt": "2020-02-27T19:12:07Z", "commit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOToxMjowOFrOFvdxNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOToxNDoyNFrOFvd1qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNTEyNw==", "bodyText": "Why was the annotation removed?", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385315127", "createdAt": "2020-02-27T19:12:08Z", "author": {"login": "hiranya911"}, "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "diffHunk": "@@ -287,7 +295,7 @@ String getEmailActionLink(EmailLinkType type, String email,\n \n   private <T> T sendRequest(\n           String method, GenericUrl url,\n-          @Nullable Object content, Class<T> clazz) throws FirebaseAuthException {\n+          Object content, Class<T> clazz) throws FirebaseAuthException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNTU5OA==", "bodyText": "Something like the following should work:\ninterceptor.getResponse().getRequest().getMethod()", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385315598", "createdAt": "2020-02-27T19:13:05Z", "author": {"login": "hiranya911"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,14 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {\n+    TestResponseInterceptor interceptor = initializeAppForUserManagement(\"{}\");\n+    // should not throw\n+    FirebaseAuth.getInstance().getTenantManager().deleteTenantAsync(\"TENANT_1\").get();\n+    checkRequestHeaders(interceptor);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDQwOA=="}, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNjI2Ng==", "bodyText": "Make sure the TENANT_NOT_FOUND is handled correctly (similar to getTenant)", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385316266", "createdAt": "2020-02-27T19:14:24Z", "author": {"login": "hiranya911"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,16 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c042c0fc0391c5a2f490ae7b28fe4cb41dbe3e95", "author": {"user": {"login": "micahstairs", "name": "Micah Stairs"}}, "url": "https://github.com/firebase/firebase-admin-java/commit/c042c0fc0391c5a2f490ae7b28fe4cb41dbe3e95", "committedDate": "2020-02-27T20:53:32Z", "message": "Work on testing error handling of deleteTenant."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa2467b0a0ea84906d059d7df5b219f79292d82c", "author": {"user": {"login": "micahstairs", "name": "Micah Stairs"}}, "url": "https://github.com/firebase/firebase-admin-java/commit/aa2467b0a0ea84906d059d7df5b219f79292d82c", "committedDate": "2020-02-27T22:08:09Z", "message": "Fix error handling test for deleteTenant and do some refactoring."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MDQ0ODE1", "url": "https://github.com/firebase/firebase-admin-java/pull/372#pullrequestreview-366044815", "createdAt": "2020-02-27T22:27:20Z", "commit": {"oid": "aa2467b0a0ea84906d059d7df5b219f79292d82c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjoyNzoyMFrOFvjcVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjoyNzoyMFrOFvjcVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQwODA4NA==", "bodyText": "Nit: Introduce local variable for HttpRequest.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385408084", "createdAt": "2020-02-27T22:27:20Z", "author": {"login": "hiranya911"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -1326,6 +1343,11 @@ private static void checkRequestHeaders(TestResponseInterceptor interceptor) {\n     assertEquals(clientVersion, headers.getFirstHeaderStringValue(\"X-Client-Version\"));\n   }\n \n+  private static void checkUrl(TestResponseInterceptor interceptor, String method, String url) {\n+    assertEquals(method, interceptor.getResponse().getRequest().getRequestMethod());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa2467b0a0ea84906d059d7df5b219f79292d82c"}, "originalPosition": 235}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d22031fe61042d7b37e3022b426b4f834f752fb5", "author": {"user": {"login": "micahstairs", "name": "Micah Stairs"}}, "url": "https://github.com/firebase/firebase-admin-java/commit/d22031fe61042d7b37e3022b426b4f834f752fb5", "committedDate": "2020-02-27T23:05:46Z", "message": "Introduce local variable for HttpRequest"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2829, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}