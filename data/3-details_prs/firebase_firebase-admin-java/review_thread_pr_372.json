{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3OTg3MTQ4", "number": 372, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMzoyMToyOVrODhtoSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjoyNzoyMFrODjojDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2Njc3MTkzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMzoyMToyOVrOFsmmlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNzowMzo0NVrOFvZeCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDEzMg==", "bodyText": "Should use DELETE /tenants/{tenantId} URL format here.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r382314132", "createdAt": "2020-02-20T23:21:29Z", "author": {"login": "hiranya911"}, "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "diffHunk": "@@ -226,6 +226,15 @@ UserImportResult importUsers(UserImportRequest request) throws FirebaseAuthExcep\n     return new UserImportResult(request.getUsersCount(), response);\n   }\n \n+  void deleteTenant(String tenantId) throws FirebaseAuthException {\n+    GenericUrl url = new GenericUrl(tenantMgtBaseUrl + \"/tenants:delete\");\n+    url.put(\"name\", tenantId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI0NDY4MA==", "bodyText": "Done.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385244680", "createdAt": "2020-02-27T17:03:45Z", "author": {"login": "micahstairs"}, "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "diffHunk": "@@ -226,6 +226,15 @@ UserImportResult importUsers(UserImportRequest request) throws FirebaseAuthExcep\n     return new UserImportResult(request.getUsersCount(), response);\n   }\n \n+  void deleteTenant(String tenantId) throws FirebaseAuthException {\n+    GenericUrl url = new GenericUrl(tenantMgtBaseUrl + \"/tenants:delete\");\n+    url.put(\"name\", tenantId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDEzMg=="}, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2Njc3Mzc0OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQyMzoyMjoxOFrOFsmnqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjowODo0NlrOFvi9Vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDQwOA==", "bodyText": "Let's also assert the URL of the outgoing request and make sure TENANT_1 is being included in the request.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r382314408", "createdAt": "2020-02-20T23:22:18Z", "author": {"login": "hiranya911"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,14 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {\n+    TestResponseInterceptor interceptor = initializeAppForUserManagement(\"{}\");\n+    // should not throw\n+    FirebaseAuth.getInstance().getTenantManager().deleteTenantAsync(\"TENANT_1\").get();\n+    checkRequestHeaders(interceptor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI0NDgzNw==", "bodyText": "Done. How do I assert that that it was a DELETE request?", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385244837", "createdAt": "2020-02-27T17:04:04Z", "author": {"login": "micahstairs"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,14 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {\n+    TestResponseInterceptor interceptor = initializeAppForUserManagement(\"{}\");\n+    // should not throw\n+    FirebaseAuth.getInstance().getTenantManager().deleteTenantAsync(\"TENANT_1\").get();\n+    checkRequestHeaders(interceptor);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDQwOA=="}, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNTU5OA==", "bodyText": "Something like the following should work:\ninterceptor.getResponse().getRequest().getMethod()", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385315598", "createdAt": "2020-02-27T19:13:05Z", "author": {"login": "hiranya911"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,14 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {\n+    TestResponseInterceptor interceptor = initializeAppForUserManagement(\"{}\");\n+    // should not throw\n+    FirebaseAuth.getInstance().getTenantManager().deleteTenantAsync(\"TENANT_1\").get();\n+    checkRequestHeaders(interceptor);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDQwOA=="}, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQwMDE1MA==", "bodyText": "Done.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385400150", "createdAt": "2020-02-27T22:08:46Z", "author": {"login": "micahstairs"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,14 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {\n+    TestResponseInterceptor interceptor = initializeAppForUserManagement(\"{}\");\n+    // should not throw\n+    FirebaseAuth.getInstance().getTenantManager().deleteTenantAsync(\"TENANT_1\").get();\n+    checkRequestHeaders(interceptor);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMxNDQwOA=="}, "originalCommit": {"oid": "a75bfbca9bc710562cfe7a89072e444d80ae244b"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NjMyNDgxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOToxMjowOFrOFvdxNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMTo1Njo0MVrOFvioTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNTEyNw==", "bodyText": "Why was the annotation removed?", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385315127", "createdAt": "2020-02-27T19:12:08Z", "author": {"login": "hiranya911"}, "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "diffHunk": "@@ -287,7 +295,7 @@ String getEmailActionLink(EmailLinkType type, String email,\n \n   private <T> T sendRequest(\n           String method, GenericUrl url,\n-          @Nullable Object content, Class<T> clazz) throws FirebaseAuthException {\n+          Object content, Class<T> clazz) throws FirebaseAuthException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMzMjc5NA==", "bodyText": "I removed this because of the following line:\ncheckNotNull(clazz, \"response class must not be null\");", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385332794", "createdAt": "2020-02-27T19:45:40Z", "author": {"login": "micahstairs"}, "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "diffHunk": "@@ -287,7 +295,7 @@ String getEmailActionLink(EmailLinkType type, String email,\n \n   private <T> T sendRequest(\n           String method, GenericUrl url,\n-          @Nullable Object content, Class<T> clazz) throws FirebaseAuthException {\n+          Object content, Class<T> clazz) throws FirebaseAuthException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNTEyNw=="}, "originalCommit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMzOTg3OQ==", "bodyText": "The annotation was on Object content, which is nullable?", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385339879", "createdAt": "2020-02-27T19:59:29Z", "author": {"login": "hiranya911"}, "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "diffHunk": "@@ -287,7 +295,7 @@ String getEmailActionLink(EmailLinkType type, String email,\n \n   private <T> T sendRequest(\n           String method, GenericUrl url,\n-          @Nullable Object content, Class<T> clazz) throws FirebaseAuthException {\n+          Object content, Class<T> clazz) throws FirebaseAuthException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNTEyNw=="}, "originalCommit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM5NDc2Nw==", "bodyText": "Ah sorry, I was looking at the wrong variable. This will be fixed when I push my other changes.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385394767", "createdAt": "2020-02-27T21:56:41Z", "author": {"login": "micahstairs"}, "path": "src/main/java/com/google/firebase/auth/FirebaseUserManager.java", "diffHunk": "@@ -287,7 +295,7 @@ String getEmailActionLink(EmailLinkType type, String email,\n \n   private <T> T sendRequest(\n           String method, GenericUrl url,\n-          @Nullable Object content, Class<T> clazz) throws FirebaseAuthException {\n+          Object content, Class<T> clazz) throws FirebaseAuthException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNTEyNw=="}, "originalCommit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NjMzMTcyOnYy", "diffSide": "RIGHT", "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOToxNDoyNFrOFvd1qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjowODo1NlrOFvi9pA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNjI2Ng==", "bodyText": "Make sure the TENANT_NOT_FOUND is handled correctly (similar to getTenant)", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385316266", "createdAt": "2020-02-27T19:14:24Z", "author": {"login": "hiranya911"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,16 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQwMDIyOA==", "bodyText": "Done.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385400228", "createdAt": "2020-02-27T22:08:56Z", "author": {"login": "micahstairs"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -476,6 +476,16 @@ public void testListZeroTenants() throws Exception {\n     checkRequestHeaders(interceptor);\n   }\n \n+  @Test\n+  public void testDeleteTenant() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMxNjI2Ng=="}, "originalCommit": {"oid": "c03dd3627955d6d8316ea5ceca17902da7b899a1"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NjkxMDg0OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjoyNzoyMFrOFvjcVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMjoyNzoyMFrOFvjcVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQwODA4NA==", "bodyText": "Nit: Introduce local variable for HttpRequest.", "url": "https://github.com/firebase/firebase-admin-java/pull/372#discussion_r385408084", "createdAt": "2020-02-27T22:27:20Z", "author": {"login": "hiranya911"}, "path": "src/test/java/com/google/firebase/auth/FirebaseUserManagerTest.java", "diffHunk": "@@ -1326,6 +1343,11 @@ private static void checkRequestHeaders(TestResponseInterceptor interceptor) {\n     assertEquals(clientVersion, headers.getFirstHeaderStringValue(\"X-Client-Version\"));\n   }\n \n+  private static void checkUrl(TestResponseInterceptor interceptor, String method, String url) {\n+    assertEquals(method, interceptor.getResponse().getRequest().getRequestMethod());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa2467b0a0ea84906d059d7df5b219f79292d82c"}, "originalPosition": 235}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1532, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}