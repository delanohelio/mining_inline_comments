{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MTI0NDE3", "number": 791, "title": "CAM-11186: add new pricing model metrics", "bodyText": "Related to CAM-11186\n\u2139\ufe0f The separate commits have been added for review purposes. They should be squashed before merging.", "createdAt": "2020-04-20T15:11:02Z", "url": "https://github.com/camunda/camunda-bpm-platform/pull/791", "merged": true, "mergeCommit": {"oid": "f09166cb5a3d1df958bf2686617c153e4e228b8f"}, "closed": true, "closedAt": "2020-04-29T13:49:36Z", "author": {"login": "koevskinikola"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZgiQVAH2gAyNDA2MTI0NDE3OjczNTZjMjAzNjhiMGIwYjk0YjE3ZGQ0NjAyNjg3ODM3ZmExZjYwMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccYxBtAFqTQwMjY4MjUxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7356c20368b0b0b94b17dd4602687837fa1f6028", "author": {"user": {"login": "koevskinikola", "name": "Nikola Koevski"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/7356c20368b0b0b94b17dd4602687837fa1f6028", "committedDate": "2020-04-20T15:08:34Z", "message": "feat(engine-dmn): add executed decision instances metrics\n\nRelated to CAM-11186"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14f80316ad47c495f6c5d49260df5ad223b8dcaa", "author": {"user": {"login": "koevskinikola", "name": "Nikola Koevski"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/14f80316ad47c495f6c5d49260df5ad223b8dcaa", "committedDate": "2020-04-20T15:08:48Z", "message": "feat(engine): add root process instance metrics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ca033eab756a1d41d222281dd41f195211c454a", "author": {"user": {"login": "koevskinikola", "name": "Nikola Koevski"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/3ca033eab756a1d41d222281dd41f195211c454a", "committedDate": "2020-04-20T15:08:48Z", "message": "chore(engine): refactor junit3 metrics tests\n\nRelated to CAM-11186"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "023b2d2f108e3a013986cfd824c4b27e8f866542", "author": {"user": {"login": "koevskinikola", "name": "Nikola Koevski"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/023b2d2f108e3a013986cfd824c4b27e8f866542", "committedDate": "2020-04-20T15:08:48Z", "message": "feat(engine): add tests for new pricing model metrics\n\nRelated to CAM-11186"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00e18d235afcd579b34e6fdfabb4590511a186f1", "author": {"user": {"login": "koevskinikola", "name": "Nikola Koevski"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/00e18d235afcd579b34e6fdfabb4590511a186f1", "committedDate": "2020-04-22T11:51:58Z", "message": "SQUASH ME: adjust metrics test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cf29b5872bb5653687de44da67c568144a0252ee", "author": {"user": {"login": "koevskinikola", "name": "Nikola Koevski"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/cf29b5872bb5653687de44da67c568144a0252ee", "committedDate": "2020-04-22T10:25:37Z", "message": "SQUASH ME: adjust metrics test"}, "afterCommit": {"oid": "00e18d235afcd579b34e6fdfabb4590511a186f1", "author": {"user": {"login": "koevskinikola", "name": "Nikola Koevski"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/00e18d235afcd579b34e6fdfabb4590511a186f1", "committedDate": "2020-04-22T11:51:58Z", "message": "SQUASH ME: adjust metrics test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTUzOTU0", "url": "https://github.com/camunda/camunda-bpm-platform/pull/791#pullrequestreview-400953954", "createdAt": "2020-04-27T13:32:00Z", "commit": {"oid": "14f80316ad47c495f6c5d49260df5ad223b8dcaa"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMzozMjowMVrOGMjViw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMzozMjowMVrOGMjViw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgxNTA1MQ==", "bodyText": "It's more robust to flip the operands of the comparison. An execution always has an ID, but an execution may not have a root process instance id (consider a migration case where a process instance was started in an old Camuna version without a root process instance id, and it executes a call activity in 7.13).", "url": "https://github.com/camunda/camunda-bpm-platform/pull/791#discussion_r415815051", "createdAt": "2020-04-27T13:32:01Z", "author": {"login": "ThorbenLindhauer"}, "path": "engine/src/main/java/org/camunda/bpm/engine/impl/metrics/parser/MetricsBpmnParseListener.java", "diffHunk": "@@ -18,25 +18,41 @@\n \n import org.camunda.bpm.engine.delegate.ExecutionListener;\n import org.camunda.bpm.engine.impl.bpmn.parser.AbstractBpmnParseListener;\n+import org.camunda.bpm.engine.impl.persistence.entity.ExecutionEntity;\n+import org.camunda.bpm.engine.impl.persistence.entity.ProcessDefinitionEntity;\n import org.camunda.bpm.engine.impl.pvm.process.ActivityImpl;\n import org.camunda.bpm.engine.impl.pvm.process.ScopeImpl;\n import org.camunda.bpm.engine.impl.util.xml.Element;\n import org.camunda.bpm.engine.management.Metrics;\n+import org.camunda.bpm.engine.runtime.Execution;\n \n /**\n  * @author Daniel Meyer\n  *\n  */\n public class MetricsBpmnParseListener extends AbstractBpmnParseListener {\n \n-  public static MetricsExecutionListener ACTIVITY_INSTANCE_START_COUNTER = new MetricsExecutionListener(Metrics.ACTIVTY_INSTANCE_START);\n-  public static MetricsExecutionListener ACTIVITY_INSTANCE_END_COUNTER = new MetricsExecutionListener(Metrics.ACTIVTY_INSTANCE_END);\n+  public static MetricsExecutionListener ROOT_PROCESS_INSTANCE_START_COUNTER =\n+      new MetricsExecutionListener(Metrics.ROOT_PROCESS_INSTANCE_START,\n+                                   delegateExecution -> ((ExecutionEntity) delegateExecution)\n+                                       .getRootProcessInstanceId()\n+                                       .equals(delegateExecution.getId()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14f80316ad47c495f6c5d49260df5ad223b8dcaa"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d035de463df4ac3c3fe92bd90706911bd749bb7f", "author": {"user": {"login": "koevskinikola", "name": "Nikola Koevski"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/d035de463df4ac3c3fe92bd90706911bd749bb7f", "committedDate": "2020-04-28T11:13:46Z", "message": "SQUASH ME: implement review hints"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNjgyNTE2", "url": "https://github.com/camunda/camunda-bpm-platform/pull/791#pullrequestreview-402682516", "createdAt": "2020-04-29T13:47:14Z", "commit": {"oid": "d035de463df4ac3c3fe92bd90706911bd749bb7f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1851, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}