{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMzkwMjU2", "number": 875, "title": "Add support for custom extension properties in external tasks", "bodyText": "Related to CAM-12080", "createdAt": "2020-06-29T12:49:10Z", "url": "https://github.com/camunda/camunda-bpm-platform/pull/875", "merged": true, "mergeCommit": {"oid": "af43b0eb83fb3f87dc8aad4916938391bdd311af"}, "closed": true, "closedAt": "2020-07-01T07:18:40Z", "author": {"login": "mboskamp"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwP39qgBqjM0OTYxMjE2MjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwk7PQABqjM1MDEwMjYxMTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d5cbb4038cfec8d1b12866bd73632c321e9a0081", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/d5cbb4038cfec8d1b12866bd73632c321e9a0081", "committedDate": "2020-06-29T12:45:13Z", "message": "feat(engine-rest): support for external task extension properties (REST)\n\nRelated to CAM-12080"}, "afterCommit": {"oid": "3effa29446d4d6494ca0b4714420aac8d2fd514a", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/3effa29446d4d6494ca0b4714420aac8d2fd514a", "committedDate": "2020-06-30T06:42:46Z", "message": "feat(engine-rest): support for external task extension properties (REST)\n\nRelated to CAM-12080"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5ODA1NjQ1", "url": "https://github.com/camunda/camunda-bpm-platform/pull/875#pullrequestreview-439805645", "createdAt": "2020-06-30T08:50:50Z", "commit": {"oid": "31080c0d5d5bd8282bef8fe4dcf9e7b26ee52411"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwODo1MDo1MFrOGqygXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQwODo1MDo1MFrOGqygXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyMDg2Mg==", "bodyText": "It is suggested to use the functions rather than the constants for type-safety.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    properties = Collections.EMPTY_MAP;\n          \n          \n            \n                    properties = Collections.emptyMap();", "url": "https://github.com/camunda/camunda-bpm-platform/pull/875#discussion_r447520862", "createdAt": "2020-06-30T08:50:50Z", "author": {"login": "tmetzke"}, "path": "engine/src/main/java/org/camunda/bpm/engine/impl/externaltask/LockedExternalTaskImpl.java", "diffHunk": "@@ -164,6 +174,14 @@ public static LockedExternalTaskImpl fromEntity(ExternalTaskEntity externalTaskE\n     result.variables = new VariableMapImpl();\n     execution.collectVariables(result.variables, variablesToFetch, isLocal, deserializeVariables);\n \n+    if(includeExtensionProperties) {\n+      Map<String, String> properties = (Map<String, String>) execution.getActivity().getProperty(BpmnProperties.EXTENSION_PROPERTIES.getName());\n+      if(properties == null) {\n+        properties = Collections.EMPTY_MAP;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31080c0d5d5bd8282bef8fe4dcf9e7b26ee52411"}, "originalPosition": 51}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31080c0d5d5bd8282bef8fe4dcf9e7b26ee52411", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/31080c0d5d5bd8282bef8fe4dcf9e7b26ee52411", "committedDate": "2020-06-30T08:16:51Z", "message": "chore(rest): add OpenAPI doc for fetchAndLock with extension properties\n\nRelated to CAM-12080"}, "afterCommit": {"oid": "66b8de4162d1040e53d4e5bd052e1a70a820af94", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/66b8de4162d1040e53d4e5bd052e1a70a820af94", "committedDate": "2020-07-01T05:59:31Z", "message": "chore(rest): add OpenAPI doc for fetchAndLock with extension properties\n\nRelated to CAM-12080"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNTc3Nzk2", "url": "https://github.com/camunda/camunda-bpm-platform/pull/875#pullrequestreview-440577796", "createdAt": "2020-07-01T06:27:31Z", "commit": {"oid": "66b8de4162d1040e53d4e5bd052e1a70a820af94"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNjoyNzozMVrOGrYaEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNjoyODo1NFrOGrYcBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE0MTg0MA==", "bodyText": "I guess it's self-explanatory that a map can be empty and it's an implementation detail as well.\nI think the \"never null\" contract is more interesting for consumers.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @return the properties or {@link Collections#emptyMap()} if no properties were configured\n          \n          \n            \n               * @return the properties, never <code>null</code>", "url": "https://github.com/camunda/camunda-bpm-platform/pull/875#discussion_r448141840", "createdAt": "2020-07-01T06:27:31Z", "author": {"login": "tmetzke"}, "path": "engine/src/main/java/org/camunda/bpm/engine/externaltask/ExternalTask.java", "diffHunk": "@@ -121,6 +123,12 @@\n    */\n   long getPriority();\n \n+  /**\n+   * Returns a map containing all custom extension properties of the external task.\n+   * \n+   * @return the properties or {@link Collections#emptyMap()} if no properties were configured", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66b8de4162d1040e53d4e5bd052e1a70a820af94"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE0MjM0MQ==", "bodyText": "You explained the circumstances pretty well beforehand, no need for duplicated information I would say, the \"never null\" part is more interesting API-wise I would say\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @return a potentially empty map of all defined custom extension properties\n          \n          \n            \n               *         if the fetch-and-lock instructions include extension properties,\n          \n          \n            \n               *         otherwise {@link Collections#emptyMap()}\n          \n          \n            \n               * @return all defined custom extension properties, never <code>null</code>", "url": "https://github.com/camunda/camunda-bpm-platform/pull/875#discussion_r448142341", "createdAt": "2020-07-01T06:28:54Z", "author": {"login": "tmetzke"}, "path": "engine/src/main/java/org/camunda/bpm/engine/externaltask/LockedExternalTask.java", "diffHunk": "@@ -134,4 +136,19 @@\n    */\n   String getBusinessKey();\n \n+  /**\n+   * Returns a map of custom extension properties if the fetch instructions\n+   * indicate to include extension properties.\n+   * \n+   * If extension properties are included, the returned map contains any\n+   * extension property that is defined in the model definition of the external\n+   * task. If extension properties not included or no properties are defined for\n+   * the external task, the map will be empty.\n+   * \n+   * @return a potentially empty map of all defined custom extension properties\n+   *         if the fetch-and-lock instructions include extension properties,\n+   *         otherwise {@link Collections#emptyMap()}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66b8de4162d1040e53d4e5bd052e1a70a820af94"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54f3a844ace78fc8a88005928fd2182c6b6f02d9", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/54f3a844ace78fc8a88005928fd2182c6b6f02d9", "committedDate": "2020-07-01T07:15:02Z", "message": "feat(external-task): add extension properties to external task results\n\nRelated to CAM-12080"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1adad014e68fa6db5069ef2032a9f7a7cfd00ab6", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/1adad014e68fa6db5069ef2032a9f7a7cfd00ab6", "committedDate": "2020-07-01T07:15:14Z", "message": "feat(engine-rest): support for external task extension properties (REST)\n\nRelated to CAM-12080"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e27b01c9d85c8f76a7c5a805020bf4ef2bbff22", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/1e27b01c9d85c8f76a7c5a805020bf4ef2bbff22", "committedDate": "2020-07-01T07:15:15Z", "message": "chore(rest): add OpenAPI doc for fetchAndLock with extension properties\n\nRelated to CAM-12080"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "66b8de4162d1040e53d4e5bd052e1a70a820af94", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/66b8de4162d1040e53d4e5bd052e1a70a820af94", "committedDate": "2020-07-01T05:59:31Z", "message": "chore(rest): add OpenAPI doc for fetchAndLock with extension properties\n\nRelated to CAM-12080"}, "afterCommit": {"oid": "1e27b01c9d85c8f76a7c5a805020bf4ef2bbff22", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/1e27b01c9d85c8f76a7c5a805020bf4ef2bbff22", "committedDate": "2020-07-01T07:15:15Z", "message": "chore(rest): add OpenAPI doc for fetchAndLock with extension properties\n\nRelated to CAM-12080"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2575, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}