{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNTI1NDEz", "number": 756, "title": "CAM-11532: add documentation for metric endpoints", "bodyText": "", "createdAt": "2020-03-25T11:11:23Z", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756", "merged": true, "mergeCommit": {"oid": "b5c873004c1032db0b39f13105359fc803bc16d2"}, "closed": true, "closedAt": "2020-03-26T07:59:43Z", "author": {"login": "mboskamp"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRFXBcAH2gAyMzkzNTI1NDEzOmNjZDU4NjY1NGFlYjdkMThmYzk5ZTZlODBkMWY4NDg0Njk0NDI5MDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRXZt1AFqTM4MTc2OTYzMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ccd586654aeb7d18fc99e6e80d1f848469442902", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/ccd586654aeb7d18fc99e6e80d1f848469442902", "committedDate": "2020-03-25T10:57:28Z", "message": "chore(engine-rest): add general improvements\n\nRelated to CAM-11532"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f638fd343835cbd2fb36434681f65008985b4069", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/f638fd343835cbd2fb36434681f65008985b4069", "committedDate": "2020-03-25T10:58:17Z", "message": "feat(engine-rest): add documentation for metrics endpoints\n\nRelated to CAM-11532"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79da2e1f6cde037e8e42b5ba499024cb672e077e", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/79da2e1f6cde037e8e42b5ba499024cb672e077e", "committedDate": "2020-03-25T11:10:24Z", "message": "chore(engine-rest): add general improvements\n\nRelated to CAM-11532"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzAwNTI4", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#pullrequestreview-381300528", "createdAt": "2020-03-25T16:06:17Z", "commit": {"oid": "79da2e1f6cde037e8e42b5ba499024cb672e077e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjowNjoxOFrOF7ijuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNjozMDoyMVrOF7jsMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk3NjUwNw==", "bodyText": "I think that this is supposed to be:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    type = \"number\"\n          \n          \n            \n                    type = \"integer\"\n          \n          \n            \n                    format = \"int64\"", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397976507", "createdAt": "2020-03-25T16:06:18Z", "author": {"login": "koevskinikola"}, "path": "engine-rest/engine-rest-openapi/src/main/templates/models/org/camunda/bpm/engine/rest/dto/metrics/MetricsIntervalResultDto.ftl", "diffHunk": "@@ -0,0 +1,25 @@\n+<@lib.dto>\n+\n+    <@lib.property\n+        name = \"timestamp\"\n+        type = \"string\"\n+        format = \"date-time\"\n+        desc = \"The interval timestamp.\"/>\n+\n+    <@lib.property\n+        name = \"name\"\n+        type = \"string\"\n+        desc = \"The name of the metric.\"/>\n+\n+    <@lib.property\n+        name = \"reporter\"\n+        type = \"string\"\n+        desc = \"The reporter of the metric. `null` if the metrics are aggregated by reporter.\"/>\n+\n+    <@lib.property\n+        name = \"value\"\n+        type = \"number\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79da2e1f6cde037e8e42b5ba499024cb672e077e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4MjA0MA==", "bodyText": "From what I can see from the (only) usage, this is a Java long (see here). The OpenAPI spec defines the number type as float/double. So we need to set this to:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    type = \"number\"\n          \n          \n            \n                    type = \"integer\"\n          \n          \n            \n                    format = \"int64\"", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397982040", "createdAt": "2020-03-25T16:13:16Z", "author": {"login": "koevskinikola"}, "path": "engine-rest/engine-rest-openapi/src/main/templates/models/org/camunda/bpm/engine/rest/dto/metrics/MetricsResultDto.ftl", "diffHunk": "@@ -0,0 +1,9 @@\n+<@lib.dto>\n+\n+    <@lib.property\n+        name = \"result\"\n+        type = \"number\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79da2e1f6cde037e8e42b5ba499024cb672e077e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4NzAwOQ==", "bodyText": "Shouldn't we define these as enumValues? The values are limited by the constants in the Metrics class", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397987009", "createdAt": "2020-03-25T16:19:49Z", "author": {"login": "koevskinikola"}, "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/metrics/get.ftl", "diffHunk": "@@ -0,0 +1,92 @@\n+{\n+  <@lib.endpointInfo\n+      id = \"interval\"\n+      tag = \"Metrics\"\n+      desc = \"Retrieves a list of metrics, aggregated for a given interval.\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"name\"\n+        location = \"query\"\n+        type = \"string\"\n+        desc = \"The name of the metric. Supported names:\n+                `activity-instance-start`,\n+                `activity-instance-end`,\n+                `job-acquisition-attempt`,\n+                `job-acquired-success`,\n+                `job-acquired-failure`,\n+                `job-execution-rejected`,\n+                `job-successful`,\n+                `job-failed`,\n+                `job-locked-exclusive`,\n+                `executed-decision-elements`,\n+                `history-cleanup-removed-process-instances`,\n+                `history-cleanup-removed-case-instances`,\n+                `history-cleanup-removed-decision-instances`,\n+                `history-cleanup-removed-batch-operations`\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79da2e1f6cde037e8e42b5ba499024cb672e077e"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk5MzQxMQ==", "bodyText": "I thinl that we should add that the defaultValue is 900:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    desc = \"The interval for which the metrics should be aggregated. Time unit is seconds.\n          \n          \n            \n                    defaultValue = \"900\"\n          \n          \n            \n                    desc = \"The interval for which the metrics should be aggregated. Time unit is seconds.", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397993411", "createdAt": "2020-03-25T16:28:10Z", "author": {"login": "koevskinikola"}, "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/metrics/get.ftl", "diffHunk": "@@ -0,0 +1,92 @@\n+{\n+  <@lib.endpointInfo\n+      id = \"interval\"\n+      tag = \"Metrics\"\n+      desc = \"Retrieves a list of metrics, aggregated for a given interval.\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"name\"\n+        location = \"query\"\n+        type = \"string\"\n+        desc = \"The name of the metric. Supported names:\n+                `activity-instance-start`,\n+                `activity-instance-end`,\n+                `job-acquisition-attempt`,\n+                `job-acquired-success`,\n+                `job-acquired-failure`,\n+                `job-execution-rejected`,\n+                `job-successful`,\n+                `job-failed`,\n+                `job-locked-exclusive`,\n+                `executed-decision-elements`,\n+                `history-cleanup-removed-process-instances`,\n+                `history-cleanup-removed-case-instances`,\n+                `history-cleanup-removed-decision-instances`,\n+                `history-cleanup-removed-batch-operations`\" />\n+\n+    <@lib.parameter\n+        name = \"reporter\"\n+        location = \"query\"\n+        type = \"string\"\n+        desc = \"The name of the reporter (host), on which the metrics was logged. This will have\n+                value provided by the [hostname configuration property](${docsUrl}/reference/deployment-descriptors/tags/process-engine/#hostname).\" />\n+\n+    <@lib.parameter\n+        name = \"startDate\"\n+        location = \"query\"\n+        type = \"string\"\n+        format = \"date-time\"\n+        desc = \"The start date (inclusive).\"/>\n+\n+    <@lib.parameter\n+        name = \"endDate\"\n+        location = \"query\"\n+        type = \"string\"\n+        format = \"date-time\"\n+        desc = \"The end date (exclusive).\"/>\n+\n+    <#include \"/lib/commons/pagination-params.ftl\" >\n+\n+    <@lib.parameter\n+        name = \"interval\"\n+        location = \"query\"\n+        type = \"string\"\n+        desc = \"The interval for which the metrics should be aggregated. Time unit is seconds.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79da2e1f6cde037e8e42b5ba499024cb672e077e"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk5NTA1Nw==", "bodyText": "Same as above, these can be defined as enumValues.", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397995057", "createdAt": "2020-03-25T16:30:21Z", "author": {"login": "koevskinikola"}, "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/metrics/{metrics-name}/sum/get.ftl", "diffHunk": "@@ -0,0 +1,59 @@\n+{\n+  <@lib.endpointInfo\n+      id = \"getMetrics\"\n+      tag = \"Metrics\"\n+      desc = \"Retrieves the `sum` (count) for a given metric.\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"metrics-name\"\n+        location = \"path\"\n+        required = true\n+        type = \"string\"\n+        desc = \"The name of the metric. Supported names:\n+                `activity-instance-start`,\n+                `activity-instance-end`,\n+                `job-acquisition-attempt`,\n+                `job-acquired-success`,\n+                `job-acquired-failure`,\n+                `job-execution-rejected`,\n+                `job-successful`,\n+                `job-failed`,\n+                `job-locked-exclusive`,\n+                `executed-decision-elements`,\n+                `history-cleanup-removed-process-instances`,\n+                `history-cleanup-removed-case-instances`,\n+                `history-cleanup-removed-decision-instances`,\n+                `history-cleanup-removed-batch-operations`\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79da2e1f6cde037e8e42b5ba499024cb672e077e"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3147fff0ee1bec4eda33e829833956f0496885b4", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/3147fff0ee1bec4eda33e829833956f0496885b4", "committedDate": "2020-03-26T07:13:34Z", "message": "Apply suggestions from code review\n\nCo-Authored-By: Nikola Koevski <nikola.koevski@camunda.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad05179370f22e13ccf08685c3e593313fd2db02", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/ad05179370f22e13ccf08685c3e593313fd2db02", "committedDate": "2020-03-26T07:32:51Z", "message": "chore(engine-rest): add enum values for metrics-name\n\nRelated to CAM-11532"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1aa2e64eb961705d9b1131f84622da2c9ddf3a2", "author": {"user": {"login": "mboskamp", "name": "Miklas Boskamp"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/a1aa2e64eb961705d9b1131f84622da2c9ddf3a2", "committedDate": "2020-03-26T07:41:26Z", "message": "chore(engine-rest): add enum values for metrics-name\n\nRelated to CAM-11532"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNzY5NjMz", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#pullrequestreview-381769633", "createdAt": "2020-03-26T07:58:42Z", "commit": {"oid": "a1aa2e64eb961705d9b1131f84622da2c9ddf3a2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1803, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}