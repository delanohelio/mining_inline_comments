{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4NDMwMzE2", "number": 869, "title": "chore(engine): adjust telemetry configuration property", "bodyText": "renamed to telemetryInitialized\nconsidered only for the initial value of the telemetryEnabled db property\n\nRelated to CAM-12023", "createdAt": "2020-06-23T09:08:47Z", "url": "https://github.com/camunda/camunda-bpm-platform/pull/869", "merged": true, "mergeCommit": {"oid": "2b06450b4d6fe6f3ec7b45ad3707ee1d6b4fc6cc"}, "closed": true, "closedAt": "2020-06-25T06:13:37Z", "author": {"login": "yanavasileva"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuBq9zAH2gAyNDM4NDMwMzE2OmJlZDI2OTQ4ZTdjNzExMGFjYTgxNjkzYjk3M2ZjYTI2NjQ3YTkyNDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcub584AFqTQzNjc2OTc5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bed26948e7c7110aca81693b973fca26647a9246", "author": {"user": {"login": "yanavasileva", "name": null}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/bed26948e7c7110aca81693b973fca26647a9246", "committedDate": "2020-06-23T09:03:26Z", "message": "chore(engine): adjust telemetry configuration property\n\n* renamed to `telemetryInitialized`\n* considered only for the initial value of the telemetryEnabled db property\n\nRelated to CAM-12023"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30a05dfe711a3d2fa7647ab9374c876d740ec55d", "author": {"user": {"login": "yanavasileva", "name": null}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/30a05dfe711a3d2fa7647ab9374c876d740ec55d", "committedDate": "2020-06-23T15:11:47Z", "message": "improve(test): improve telemetry authoration test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb1b67fe6f71b644cddc84dcbb899b466295f89a", "author": {"user": {"login": "yanavasileva", "name": null}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/bb1b67fe6f71b644cddc84dcbb899b466295f89a", "committedDate": "2020-06-23T10:56:18Z", "message": "improve(test): improve telemetry authoration test"}, "afterCommit": {"oid": "30a05dfe711a3d2fa7647ab9374c876d740ec55d", "author": {"user": {"login": "yanavasileva", "name": null}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/30a05dfe711a3d2fa7647ab9374c876d740ec55d", "committedDate": "2020-06-23T15:11:47Z", "message": "improve(test): improve telemetry authoration test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9205d9e8067e841c3023ce0089b6f7976bfa549d", "author": {"user": {"login": "yanavasileva", "name": null}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/9205d9e8067e841c3023ce0089b6f7976bfa549d", "committedDate": "2020-06-24T07:00:51Z", "message": "improve(test): cleanup db property only if the test is run"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDkwMjIx", "url": "https://github.com/camunda/camunda-bpm-platform/pull/869#pullrequestreview-436490221", "createdAt": "2020-06-24T09:44:29Z", "commit": {"oid": "9205d9e8067e841c3023ce0089b6f7976bfa549d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwOTo0NDoyOVrOGoK4aQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwOTo0ODowMFrOGoLAoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc3NDUwNQ==", "bodyText": "I would prefer an active verb for this property, e.g. initializeTelemetry. The reason is that this property refers to something the engine does once on startup. Other properties that use passive voice (e.g. authorizationEnabled) refer to a state of the engine during its lifetime.", "url": "https://github.com/camunda/camunda-bpm-platform/pull/869#discussion_r444774505", "createdAt": "2020-06-24T09:44:29Z", "author": {"login": "ThorbenLindhauer"}, "path": "engine/src/main/java/org/camunda/bpm/engine/impl/cfg/ProcessEngineConfigurationImpl.java", "diffHunk": "@@ -865,7 +865,8 @@\n \n \n   // telemetry ///////////////////////////////////////////////////////\n-  protected boolean telemetryEnabled = false;\n+  /** if set to true the telemetry will be enabled from the first engine start*/\n+  protected boolean telemetryInitialized = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9205d9e8067e841c3023ce0089b6f7976bfa549d"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc3NDg4Mg==", "bodyText": "The Javadoc should be a bit more verbose to make it more clear what the configuration does. E.g. explain that this will initialize the telemetry configuration only once when it has never been enabled/disabled before. After that, it can only be changed via API.", "url": "https://github.com/camunda/camunda-bpm-platform/pull/869#discussion_r444774882", "createdAt": "2020-06-24T09:45:09Z", "author": {"login": "ThorbenLindhauer"}, "path": "engine/src/main/java/org/camunda/bpm/engine/impl/cfg/ProcessEngineConfigurationImpl.java", "diffHunk": "@@ -865,7 +865,8 @@\n \n \n   // telemetry ///////////////////////////////////////////////////////\n-  protected boolean telemetryEnabled = false;\n+  /** if set to true the telemetry will be enabled from the first engine start*/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9205d9e8067e841c3023ce0089b6f7976bfa549d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc3NTk1MA==", "bodyText": "Not directly related to the topic of this ticket: I think this API design is a bit confusing. To disable delemetry, I would write managementService.enableTelemetry(false) which is not intuitive to read. Maybe toggleTelemetry instead of enableTelemetry is more clear.", "url": "https://github.com/camunda/camunda-bpm-platform/pull/869#discussion_r444775950", "createdAt": "2020-06-24T09:46:57Z", "author": {"login": "ThorbenLindhauer"}, "path": "engine/src/test/java/org/camunda/bpm/engine/test/api/authorization/ManagementAuthorizationTest.java", "diffHunk": "@@ -252,14 +252,17 @@ public void testTelemetryEnabledWithoutAutorization() {\n \n   public void testTelemetryEnabledAsCamundaAdmin() {\n     // given\n+    disableAuthorization();\n+    managementService.enableTelemetry(true);\n+    enableAuthorization();\n     identityService.setAuthentication(userId, Collections.singletonList(Groups.CAMUNDA_ADMIN));\n \n     // when\n-    managementService.enableTelemetry(true);\n+    managementService.enableTelemetry(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9205d9e8067e841c3023ce0089b6f7976bfa549d"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc3NjE2OA==", "bodyText": "Not directly related to the topic of this ticket: Why is there no API method to check if telemetry is enabled?", "url": "https://github.com/camunda/camunda-bpm-platform/pull/869#discussion_r444776168", "createdAt": "2020-06-24T09:47:18Z", "author": {"login": "ThorbenLindhauer"}, "path": "engine/src/test/java/org/camunda/bpm/engine/test/api/authorization/ManagementAuthorizationTest.java", "diffHunk": "@@ -252,14 +252,17 @@ public void testTelemetryEnabledWithoutAutorization() {\n \n   public void testTelemetryEnabledAsCamundaAdmin() {\n     // given\n+    disableAuthorization();\n+    managementService.enableTelemetry(true);\n+    enableAuthorization();\n     identityService.setAuthentication(userId, Collections.singletonList(Groups.CAMUNDA_ADMIN));\n \n     // when\n-    managementService.enableTelemetry(true);\n+    managementService.enableTelemetry(false);\n \n     // then\n     String telemetryPropertyValue = TelemetryHelper.fetchConfigurationProperty(processEngineConfiguration).getValue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9205d9e8067e841c3023ce0089b6f7976bfa549d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc3NjYwOQ==", "bodyText": "Not directly related to the topic of this ticket: Why does the test method sleep for 2 seconds?", "url": "https://github.com/camunda/camunda-bpm-platform/pull/869#discussion_r444776609", "createdAt": "2020-06-24T09:48:00Z", "author": {"login": "ThorbenLindhauer"}, "path": "engine/src/test/java/org/camunda/bpm/engine/test/concurrency/ConcurrentTelemetryConfigurationTest.java", "diffHunk": "@@ -52,6 +46,8 @@ protected void runTest() throws Throwable {\n         || (transactionIsolationLevel != null && !transactionIsolationLevel.equals(Connection.TRANSACTION_READ_COMMITTED))) {\n       // skip test method - if database is H2\n     } else {\n+      // clean up the db property\n+      TestHelper.deleteTelemetryProperty(processEngineConfiguration);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9205d9e8067e841c3023ce0089b6f7976bfa549d"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98b7a59059edc60cbf235e0f6878966f568057c4", "author": {"user": {"login": "yanavasileva", "name": null}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/98b7a59059edc60cbf235e0f6878966f568057c4", "committedDate": "2020-06-24T11:59:06Z", "message": "improve(engine): rename telemetry configuration property\n\nand extend its javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NzY5Nzk2", "url": "https://github.com/camunda/camunda-bpm-platform/pull/869#pullrequestreview-436769796", "createdAt": "2020-06-24T15:37:20Z", "commit": {"oid": "98b7a59059edc60cbf235e0f6878966f568057c4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2564, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}