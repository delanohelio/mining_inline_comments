{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4NTQyMTYw", "number": 633, "title": "CAM-11345: remove BOM from pom hierarchy", "bodyText": "", "createdAt": "2020-01-29T12:56:37Z", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633", "merged": true, "mergeCommit": {"oid": "638197e4ba1de13b1347003367d782e90d78e467"}, "closed": true, "closedAt": "2020-02-11T07:33:17Z", "author": {"login": "ThorbenLindhauer"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_WS9tgBqjI5OTIzOTM5OTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDMjASgFqTM1NjQ1MDk0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "893f98a36f4545c5dae460e72385af1d8133fc42", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/893f98a36f4545c5dae460e72385af1d8133fc42", "committedDate": "2020-01-29T15:58:40Z", "message": "restore correct pom property"}, "afterCommit": {"oid": "197ab3d5352fa905d70ee3eae12c8cb3fe1e594d", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/197ab3d5352fa905d70ee3eae12c8cb3fe1e594d", "committedDate": "2020-01-30T08:30:14Z", "message": "restore correct pom property"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f6edf07785d46c7e14dea86a665da142203fc3b", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/3f6edf07785d46c7e14dea86a665da142203fc3b", "committedDate": "2020-01-30T12:23:34Z", "message": "chore(repo): remove BOM from POM parent hierarchy\n\n- The BOM is now no longer a parent of all other poms, but\n  only imported in camunda-parent's dependencyManagement section\n- This resolves issues with the resolution of transitive dependencies\n  in our qa projects, where we depend on older modules that are also\n  built in the current reactor. Example: Instance migration setup for\n  7.5 uses camunda-engine:7.5. With the previous POM hierarchy, any\n  transitive dependencies of camunda-engine:7.5 would be overridden to\n  be 7.13.0-SNAPSHOT dependencies. This lead to workarounds where we\n  would explicitly declare all transitive dependencies in the POM and\n  pin their versions to 7.5. With the removal of the BOM from the parent\n  hierarchy, such modules can simply import a different BOM version and\n  all dependencies are resolved like expected\n- This also solves one issue we had with parallel builds, as the\n  parallel builder was not able to build a proper dependency tree out of\n  a dependency chain like A (7.13.0-SNAPSHOT) <- B (7.5.0) <- C\n  (7.13.0-SNAPSHOT)\n- However, this change also means that properties defined in the BOM\n  will not be available to any other POMs in the repo. We need this at\n  least for the maven-bundle-plugin. That's why I moved these properties\n  to camunda-root and made camunda-root a parent of both camunda-parent\n  and camunda-bom.\n- In some test suites (engine-rest and engine-integration), we use\n  shrinkwrap to create artifacts with Maven dependencies. As far as I\n  understand, these dependencies must be installed in the local Maven\n  repository, because we use Shrinkwrap in offline mode. The tests also\n  require camunda-bom, so it is important that camunda-bom is built in a\n  reactor before these test modules are built. I resolved this by adding\n  explicit BOM dependencies to those modules\n\nrelated to CAM-11345"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/0f7952c96c2a6c0beda6c9d0025c570f555d3876", "committedDate": "2020-01-30T12:23:42Z", "message": "chore(project): remove unnecessary dependency declarations\n\n- with the change in the parent hierarchy, we no longer need to\n  explicilty declare transitive dependencies to force them to an older\n  version\n\nrelated to CAM-11345"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "197ab3d5352fa905d70ee3eae12c8cb3fe1e594d", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/197ab3d5352fa905d70ee3eae12c8cb3fe1e594d", "committedDate": "2020-01-30T08:30:14Z", "message": "restore correct pom property"}, "afterCommit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/0f7952c96c2a6c0beda6c9d0025c570f555d3876", "committedDate": "2020-01-30T12:23:42Z", "message": "chore(project): remove unnecessary dependency declarations\n\n- with the change in the parent hierarchy, we no longer need to\n  explicilty declare transitive dependencies to force them to an older\n  version\n\nrelated to CAM-11345"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNzUxMjg1", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633#pullrequestreview-352751285", "createdAt": "2020-02-04T06:42:37Z", "commit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjo0MjozN1rOFlJeuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNzoyNjo0MVrOFlKNUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5Njk1Mw==", "bodyText": "Any specific reasons to add the groupId and version? This should be correctly inherited from the parent, doesn't it?", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633#discussion_r374496953", "createdAt": "2020-02-04T06:42:37Z", "author": {"login": "tmetzke"}, "path": "parent/pom.xml", "diffHunk": "@@ -3,12 +3,14 @@\n \n   <parent>\n     <groupId>org.camunda.bpm</groupId>\n-    <artifactId>camunda-bom</artifactId>\n+    <artifactId>camunda-root</artifactId>\n     <version>7.13.0-SNAPSHOT</version>\n-    <relativePath>../bom</relativePath>\n+    <relativePath>../</relativePath>\n   </parent>\n \n+  <groupId>org.camunda.bpm</groupId>\n   <artifactId>camunda-parent</artifactId>\n+  <version>7.13.0-SNAPSHOT</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5ODMyMA==", "bodyText": "If the BOM uses the properties in the dependencyManagement section and parent imports the BOM in its own dependencyManagement, the properties aren't necessary in the parent, are they?", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633#discussion_r374498320", "createdAt": "2020-02-04T06:47:34Z", "author": {"login": "tmetzke"}, "path": "pom.xml", "diffHunk": "@@ -23,6 +23,16 @@\n \n   <properties>\n     <license.includeTransitiveDependencies>false</license.includeTransitiveDependencies>\n+\n+    <!-- These properties are used in both the BOM as well as camunda-parent and subprojects -->\n+    <version.mybatis>3.5.3</version.mybatis>\n+    <version.joda-time>2.1</version.joda-time>\n+    <version.uuid-generator>3.2.0</version.uuid-generator>\n+    <version.camunda.commons>1.9.0</version.camunda.commons>\n+    <version.camunda.connect>1.3.0</version.camunda.connect>\n+    <version.camunda.spin>1.8.0</version.camunda.spin>\n+    <version.camunda.template-engines>1.1.0</version.camunda.template-engines>\n+    <version.camunda.ee.xslt-plugin>1.1.0</version.camunda.ee.xslt-plugin>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDUwMTU3Mw==", "bodyText": "Do you know why this wasn't necessary when the BOM was the parent of this?\nAny specific errors if we remove this that you already encountered? (Haven't tested yet myself)", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633#discussion_r374501573", "createdAt": "2020-02-04T07:00:33Z", "author": {"login": "tmetzke"}, "path": "parent/pom.xml", "diffHunk": "@@ -622,6 +631,11 @@\n       <name>SpringSource Enterprise Bundle Repository - External Bundle Releases</name>\n       <url>http://repository.springsource.com/maven/bundles/external</url>\n     </repository>\n+\n+    <repository>\n+      <id>fix-maven-snapshots-issue-with-nexus</id>\n+      <url>allow-parent-pom-resolving-when-snapshot</url>\n+    </repository>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDUwNzYxNA==", "bodyText": "Just to understand this correctly:\nThis dependency is included so this project is definitely build after the BOM project?\nShouldn't this already be the case because\n\nthis project's parent is rest-root\nrest-root's parent is database-settings\ndatabase-settings' parent is parent\nparent depends on BOM to be build", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633#discussion_r374507614", "createdAt": "2020-02-04T07:22:22Z", "author": {"login": "tmetzke"}, "path": "engine-rest/engine-rest/pom.xml", "diffHunk": "@@ -92,6 +92,18 @@\n       <version>1.6.5</version>\n       <scope>test</scope>\n     </dependency>\n+    \n+    <!--\n+      needed for offline shrinkwrap (in particular CustomJacksonDateFormatTest), \n+      BOM must be installed before this module is built\n+    -->\n+    <dependency>\n+      <groupId>org.camunda.bpm</groupId>\n+      <artifactId>camunda-bom</artifactId>\n+      <version>${project.version}</version>\n+      <type>pom</type>\n+      <scope>test</scope>\n+    </dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDUwODg4MQ==", "bodyText": "Similar to camunda-engine-rest-core, shouldn't the BOM already reliably come first in the reactor build since\n\nthis project's parent is camunda-qa\ncamunda-qa's parent is database-settings\ndatabase-settings' parent is parent\nparent depends on BOM to be build", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633#discussion_r374508881", "createdAt": "2020-02-04T07:26:41Z", "author": {"login": "tmetzke"}, "path": "qa/integration-tests-engine/pom.xml", "diffHunk": "@@ -176,6 +176,17 @@\n       -->\n     </dependency>\n \n+    <!--\n+      needed for offline shrinkwrap,\n+      BOM must be installed before this module is built\n+    -->\n+    <dependency>\n+      <groupId>org.camunda.bpm</groupId>\n+      <artifactId>camunda-bom</artifactId>\n+      <version>${project.version}</version>\n+      <type>pom</type>\n+      <scope>test</scope>\n+    </dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNzg3MTc3", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633#pullrequestreview-352787177", "createdAt": "2020-02-04T08:16:42Z", "commit": {"oid": "0f7952c96c2a6c0beda6c9d0025c570f555d3876"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa41a8715a1a75a939fb6e9fb6870dd8ea012373", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/fa41a8715a1a75a939fb6e9fb6870dd8ea012373", "committedDate": "2020-02-07T14:09:16Z", "message": "squash me: implement review hints"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e4751af85bb6f97dc3e1cf151d8b5a91413f8b01", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/e4751af85bb6f97dc3e1cf151d8b5a91413f8b01", "committedDate": "2020-02-06T15:03:09Z", "message": "squash me: implement review hints"}, "afterCommit": {"oid": "fa41a8715a1a75a939fb6e9fb6870dd8ea012373", "author": {"user": {"login": "ThorbenLindhauer", "name": "Thorben Lindhauer"}}, "url": "https://github.com/camunda/camunda-bpm-platform/commit/fa41a8715a1a75a939fb6e9fb6870dd8ea012373", "committedDate": "2020-02-07T14:09:16Z", "message": "squash me: implement review hints"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NDUwOTQ0", "url": "https://github.com/camunda/camunda-bpm-platform/pull/633#pullrequestreview-356450944", "createdAt": "2020-02-11T07:24:57Z", "commit": {"oid": "fa41a8715a1a75a939fb6e9fb6870dd8ea012373"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2027, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}