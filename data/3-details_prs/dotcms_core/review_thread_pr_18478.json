{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2ODY5Mjk0", "number": 18478, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0MVrOD7wb8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OVrOD7wcIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzOTg2MTYyOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/AppView.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0MVrOGURwow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0MVrOGURwow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTY4Mw==", "bodyText": "Issue found: Assigning an Object to null is a code smell.  Consider refactoring.", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915683", "createdAt": "2020-05-12T17:39:41Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/AppView.java", "diffHunk": "@@ -48,14 +52,15 @@ public AppView(final AppDescriptor appDescriptor, final long configurationsCount\n      * @param configurationsCount\n      * @param sites\n      */\n-    public AppView(final AppDescriptor appDescriptor, final long configurationsCount, final List<SiteView> sites) {\n+    public AppView(final AppDescriptor appDescriptor, final int configurationsCount, final List<SiteView> sites) {\n         this.key = appDescriptor.getKey();\n         this.name = appDescriptor.getName();\n         this.description = appDescriptor.getDescription();\n         this.iconUrl = appDescriptor.getIconUrl();\n         this.allowExtraParams = appDescriptor.isAllowExtraParameters();\n         this.configurationsCount = configurationsCount;\n         this.sites = sites;\n+        this.sitesWithWarnings = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzOTg2MTY3OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0M1rOGURwrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0M1rOGURwrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTY5Mw==", "bodyText": "Issue found: The String literal \"any-name\" appears 18 times in this file; the first occurrence is on line 461", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915693", "createdAt": "2020-05-12T17:39:43Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "diffHunk": "@@ -434,6 +439,104 @@ public void Test_Secret_Destroy_Method() {\n         }\n     }\n \n+    /**\n+     * Test computeSecretWarnings.\n+     * Given scenario: You create a secret with no value the secret is expected to be required according to the descriptor.\n+     * Expected Result: Such situation should generate a warning\n+     */\n+    @Test\n+    public void Test_Secret_Integrity_Check_Expect_Warning()\n+            throws DotDataException, DotSecurityException {\n+        final AppsAPI api = APILocator.getAppsAPI();\n+\n+        final String appKey = \"any-key\";\n+\n+        final AppDescriptor descriptor = mock(AppDescriptor.class);\n+        when(descriptor.isAllowExtraParameters()).thenReturn(false);\n+        final Map<String, ParamDescriptor> params = of(\n+        \"requiredNoDefault\",newParam(null, false, Type.STRING, \"any\", \"hint\", true), // This is the rule we intend to break\n+        \"requiredDefault\", newParam(\"default\", false, Type.STRING, \"any\", \"hint\", true),\n+        \"nonRequiredNoDefault\", newParam(null, false, Type.STRING, \"any\", \"hint\", false)\n+         );\n+        when(descriptor.getParams()).thenReturn(params);\n+        when(descriptor.getName()).thenReturn(\"any-name\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzOTg2MTcyOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NFrOGURwsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NFrOGURwsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTY5OQ==", "bodyText": "Issue found: Avoid variables with short names like id", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915699", "createdAt": "2020-05-12T17:39:44Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "diffHunk": "@@ -23,11 +26,12 @@\n      * @param name\n      * @param configured\n      */\n-    public SiteView(final String id, final String name, final boolean configured) {\n+    public SiteView(final String id, final String name, final boolean configured, final int secretsWithWarning) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzOTg2MTc1OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NVrOGURwvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NVrOGURwvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTcwOA==", "bodyText": "Issue found: Useless parentheses.", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915708", "createdAt": "2020-05-12T17:39:45Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "diffHunk": "@@ -23,11 +26,12 @@\n      * @param name\n      * @param configured\n      */\n-    public SiteView(final String id, final String name, final boolean configured) {\n+    public SiteView(final String id, final String name, final boolean configured, final int secretsWithWarning) {\n         this.id = id;\n         this.name = name;\n         this.configured = configured;\n         this.secrets = null;\n+        this.secretsWithWarnings = (secretsWithWarning == 0 ? null : secretsWithWarning);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzOTg2MTg0OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NVrOGURwyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NVrOGURwyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTcyMA==", "bodyText": "Issue found: The String literal \"requiredDefault\" appears 4 times in this file; the first occurrence is on line 457", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915720", "createdAt": "2020-05-12T17:39:45Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "diffHunk": "@@ -434,6 +439,104 @@ public void Test_Secret_Destroy_Method() {\n         }\n     }\n \n+    /**\n+     * Test computeSecretWarnings.\n+     * Given scenario: You create a secret with no value the secret is expected to be required according to the descriptor.\n+     * Expected Result: Such situation should generate a warning\n+     */\n+    @Test\n+    public void Test_Secret_Integrity_Check_Expect_Warning()\n+            throws DotDataException, DotSecurityException {\n+        final AppsAPI api = APILocator.getAppsAPI();\n+\n+        final String appKey = \"any-key\";\n+\n+        final AppDescriptor descriptor = mock(AppDescriptor.class);\n+        when(descriptor.isAllowExtraParameters()).thenReturn(false);\n+        final Map<String, ParamDescriptor> params = of(\n+        \"requiredNoDefault\",newParam(null, false, Type.STRING, \"any\", \"hint\", true), // This is the rule we intend to break\n+        \"requiredDefault\", newParam(\"default\", false, Type.STRING, \"any\", \"hint\", true),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzOTg2MTk3OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0N1rOGURw2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0N1rOGURw2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTczNw==", "bodyText": "Issue found: The String literal \"requiredNoDefault\" appears 4 times in this file; the first occurrence is on line 456", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915737", "createdAt": "2020-05-12T17:39:47Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "diffHunk": "@@ -434,6 +439,104 @@ public void Test_Secret_Destroy_Method() {\n         }\n     }\n \n+    /**\n+     * Test computeSecretWarnings.\n+     * Given scenario: You create a secret with no value the secret is expected to be required according to the descriptor.\n+     * Expected Result: Such situation should generate a warning\n+     */\n+    @Test\n+    public void Test_Secret_Integrity_Check_Expect_Warning()\n+            throws DotDataException, DotSecurityException {\n+        final AppsAPI api = APILocator.getAppsAPI();\n+\n+        final String appKey = \"any-key\";\n+\n+        final AppDescriptor descriptor = mock(AppDescriptor.class);\n+        when(descriptor.isAllowExtraParameters()).thenReturn(false);\n+        final Map<String, ParamDescriptor> params = of(\n+        \"requiredNoDefault\",newParam(null, false, Type.STRING, \"any\", \"hint\", true), // This is the rule we intend to break", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzOTg2MjAyOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OFrOGURw4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OFrOGURw4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTc0Ng==", "bodyText": "Issue found: Assigning an Object to null is a code smell.  Consider refactoring.", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915746", "createdAt": "2020-05-12T17:39:48Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "diffHunk": "@@ -42,6 +46,7 @@ public SiteView(final String id,final String name,\n         this.name = name;\n         this.configured = secrets.stream().anyMatch(secretView -> null != secretView.getSecret());\n         this.secrets = secrets;\n+        this.secretsWithWarnings = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzOTg2MjA4OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OVrOGURw7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OVrOGURw7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTc1OA==", "bodyText": "Issue found: The String literal \"any-key\" appears 15 times in this file; the first occurrence is on line 451", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915758", "createdAt": "2020-05-12T17:39:49Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "diffHunk": "@@ -434,6 +439,104 @@ public void Test_Secret_Destroy_Method() {\n         }\n     }\n \n+    /**\n+     * Test computeSecretWarnings.\n+     * Given scenario: You create a secret with no value the secret is expected to be required according to the descriptor.\n+     * Expected Result: Such situation should generate a warning\n+     */\n+    @Test\n+    public void Test_Secret_Integrity_Check_Expect_Warning()\n+            throws DotDataException, DotSecurityException {\n+        final AppsAPI api = APILocator.getAppsAPI();\n+\n+        final String appKey = \"any-key\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 44}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2314, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}