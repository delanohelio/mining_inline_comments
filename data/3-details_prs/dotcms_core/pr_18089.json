{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMTE3MDc0", "number": 18089, "title": "#16433 vanity url trailing forward slash support", "bodyText": "This PR comes to solve\n#16433\nThe solution was adding a conditional statement to the regexp that basically adds support to match an optional forward slash at the end of the URI.\nIt is added behind the scenes to the VanityURL that lives in the cache\nfor which the uri matching regexp will remain the same.", "createdAt": "2020-03-03T18:52:54Z", "url": "https://github.com/dotCMS/core/pull/18089", "merged": true, "mergeCommit": {"oid": "abcc7aa09968bd47594a536cb4500d8ddf6e48bb"}, "closed": true, "closedAt": "2020-03-04T16:13:08Z", "author": {"login": "fabrizzio-dotCMS"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKGayigH2gAyMzgzMTE3MDc0OmQ2M2ZjZWRiNDE1OTZmNDVjOTdiYzczZjhjZWQwMzFiYTBmODVjODg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKJxLPgFqTM2ODM2MTk5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d63fcedb41596f45c97bc73f8ced031ba0f85c88", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/d63fcedb41596f45c97bc73f8ced031ba0f85c88", "committedDate": "2020-03-03T18:14:01Z", "message": "#16433 vanity url trailing forwardslash support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MjM3MTkx", "url": "https://github.com/dotCMS/core/pull/18089#pullrequestreview-368237191", "createdAt": "2020-03-03T18:53:46Z", "commit": {"oid": "d63fcedb41596f45c97bc73f8ced031ba0f85c88"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxODo1Mzo0NlrOFxSUcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxODo1Mzo0NlrOFxSUcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzIyNDY5MQ==", "bodyText": "doc", "url": "https://github.com/dotCMS/core/pull/18089#discussion_r387224691", "createdAt": "2020-03-03T18:53:46Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/integration-test/java/com/dotcms/vanityurl/business/VanityUrlAPITest.java", "diffHunk": "@@ -1518,4 +1519,45 @@ public void removeVanityURLDefaultHostfromCacheTest() throws DotDataException, D\n         }\n     }\n \n+    @Test\n+    public void Test_Vanity_URI_Ending_With_Forward_Slash_Handles_Non_forward_Slash_Ending_URL()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d63fcedb41596f45c97bc73f8ced031ba0f85c88"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4Mjc5MjE0", "url": "https://github.com/dotCMS/core/pull/18089#pullrequestreview-368279214", "createdAt": "2020-03-03T19:55:44Z", "commit": {"oid": "d63fcedb41596f45c97bc73f8ced031ba0f85c88"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzA5Mjk3", "url": "https://github.com/dotCMS/core/pull/18089#pullrequestreview-368309297", "createdAt": "2020-03-03T20:43:16Z", "commit": {"oid": "d63fcedb41596f45c97bc73f8ced031ba0f85c88"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzYxODk2", "url": "https://github.com/dotCMS/core/pull/18089#pullrequestreview-368361896", "createdAt": "2020-03-03T22:08:02Z", "commit": {"oid": "d63fcedb41596f45c97bc73f8ced031ba0f85c88"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMjowODowMlrOFxYX-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMjowODowMlrOFxYX-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMyMzg5OA==", "bodyText": "not sure why just do not return uri.substring(0, regex.length() -1 ) + \"(/)*\"", "url": "https://github.com/dotCMS/core/pull/18089#discussion_r387323898", "createdAt": "2020-03-03T22:08:02Z", "author": {"login": "jdotcms"}, "path": "dotCMS/src/main/java/com/dotcms/vanityurl/model/CachedVanityUrl.java", "diffHunk": "@@ -153,6 +152,32 @@ public String getVanityUrlId() {\n         return vanityUrlId;\n     }\n \n+    /**\n+     * This comes as fix for https://github.com/dotCMS/core/issues/16433\n+     * If the uri ends with forward slash `/`\n+     * This method will make that piece optional.\n+     * @param uri the uri stored in the contentlet.\n+     * @return the uri regexp with the optional forward slash support added.\n+     */\n+    private String addOptionalForwardSlashSupport(final String uri){\n+        if(uri.endsWith(StringPool.FORWARD_SLASH)){\n+            String regex = uri;\n+            regex = regex.substring(0, regex.length() -1 );\n+            return regex + \"(/)*\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d63fcedb41596f45c97bc73f8ced031ba0f85c88"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzYxOTkw", "url": "https://github.com/dotCMS/core/pull/18089#pullrequestreview-368361990", "createdAt": "2020-03-03T22:08:11Z", "commit": {"oid": "d63fcedb41596f45c97bc73f8ced031ba0f85c88"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1147, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}