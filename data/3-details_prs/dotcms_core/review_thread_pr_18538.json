{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNTM2NDE3", "number": 18538, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1NjozOVrOD-xu1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0OVrOD-xu_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTEwOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotmarketing/db/DBPropertiesDataSourceStrategyTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1NjozOVrOGZFjQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1NjozOVrOGZFjQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODUyOQ==", "bodyText": "Issue found: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958529", "createdAt": "2020-05-21T22:56:39Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotmarketing/db/DBPropertiesDataSourceStrategyTest.java", "diffHunk": "@@ -84,16 +85,20 @@ public void testApplyWithValidFileShouldPass()\n     @Test\n     public void testGetHikariConfigWithValidFileShouldPass()\n             throws IOException, ConfigurationException {\n-        final File tempFile = createTempFile(\"connection_db_driver=org.postgresql.Driver\\n\"\n-                + \"connection_db_base_url=jdbc:postgresql://localhost/dotcms\\n\"\n-                + \"connection_db_username=postgres\\n\"\n-                + \"connection_db_password=postgres\\n\"\n-                + \"connection_db_validation_query=SELECT 1\");\n+        final File tempFile = createTempFile(\"driverClassName=org.postgresql.Driver\\n\"\n+                + \"jdbcUrl=jdbc:postgresql://localhost/dotcms\\n\"\n+                + \"username=postgres\\n\"\n+                + \"password=postgres\\n\"\n+                + \"connectionTestQuery=SELECT 1\\n\"\n+                + \"maximumPoolSize=60\\n\"\n+                + \"idleTimeout=10000\\n\"\n+                + \"maxLifetime=60000\\n\"\n+                + \"leakDetectionThreshold=60000\");\n \n         final PropertiesConfiguration properties = new PropertiesConfiguration();\n-        properties.load(tempFile);\n+        properties.load(new FileInputStream(tempFile));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTE1OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0MFrOGZFjSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0MFrOGZFjSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODUzNg==", "bodyText": "Issue found: Parameter 'clazz' is not assigned and could be declared final", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958536", "createdAt": "2020-05-21T22:56:40Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 218}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTI1OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/config/RestServiceUtil.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0MVrOGZFjUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0MVrOGZFjUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU0Nw==", "bodyText": "Issue found: Parameter 'clazz' is not assigned and could be declared final", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958547", "createdAt": "2020-05-21T22:56:41Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/config/RestServiceUtil.java", "diffHunk": "@@ -1,37 +1,14 @@\n package com.dotcms.rest.config;\n \n-import com.dotcms.rest.servlet.ReloadableServletContainer;\n-\n-\n-\n public class RestServiceUtil {\n-\t\n-\tpublic synchronized static void addResource(Class clazz){\n-\t\t\n-\t\tnew DotRestApplication().getClasses();\n-\t\tif(DotRestApplication.REST_CLASSES.contains(clazz)){\n-\t\t\treturn;\n-\t\t}\n-\t\t\n-\t\tDotRestApplication.REST_CLASSES.add(clazz);\n \n-\t\treloadRest();\n-\t\t\n+    public static void addResource(Class clazz) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTI4OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0MlrOGZFjVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0MlrOGZFjVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU1MQ==", "bodyText": "Issue found: Use block level rather than method level synchronization", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958551", "createdAt": "2020-05-21T22:56:42Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {\n+        if(clazz==null)return;\n+        if(!customClasses.containsKey(clazz)) {\n+            customClasses.put(clazz, true);\n+            ReloadableServletContainer.reload(new DotRestApplication());\n+        }\n+    }\n+\n+    /**\n+     * removes a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void removeClass(Class<?> clazz) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 230}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTMwOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0M1rOGZFjWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0M1rOGZFjWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU1NQ==", "bodyText": "Issue found: Use block level rather than method level synchronization", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958555", "createdAt": "2020-05-21T22:56:43Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 218}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTMyOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/util/TestDataSourceProvider.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0NFrOGZFjYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0NFrOGZFjYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU2MQ==", "bodyText": "Issue found: Local variable 'config' could be declared final", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958561", "createdAt": "2020-05-21T22:56:44Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/util/TestDataSourceProvider.java", "diffHunk": "@@ -11,50 +12,12 @@\n \n public class TestDataSourceProvider implements DotDataSourceStrategy {\n \n-    private Properties prop;\n-\n     @Override\n     public DataSource apply() {\n \n-        String dbType = \"postgres.\";\n-\n-        if (System.getProperty(\"databaseType\")!=null){\n-            dbType = System.getProperty(\"databaseType\") + \".\";\n-        } else if(System.getenv(\"databaseType\")!=null){\n-            dbType = System.getenv(\"databaseType\") + \".\";\n-        }\n-\n-        loadProperties();\n-\n-        // https://github.com/brettwooldridge/HikariCP#configuration-knobs-baby\n-        HikariConfig config = new HikariConfig();\n+        HikariConfig config = new HikariConfig(getProperties());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTM3OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0NVrOGZFjaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0NVrOGZFjaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU2OA==", "bodyText": "Issue found: This statement should have braces", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958568", "createdAt": "2020-05-21T22:56:45Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {\n+        if(clazz==null)return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 219}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTQwOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/util/TestDataSourceProvider.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0N1rOGZFjbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0N1rOGZFjbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU3NQ==", "bodyText": "Issue found: Useless parentheses.", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958575", "createdAt": "2020-05-21T22:56:47Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/util/TestDataSourceProvider.java", "diffHunk": "@@ -63,18 +26,22 @@ public DataSource apply() {\n      * Load properties file with DB connection details\n      * @throws NamingException\n      */\n-    private void loadProperties()  {\n-        ClassLoader loader = Thread.currentThread().getContextClassLoader();\n-        prop = new Properties();\n+    private Properties getProperties()  {\n+        final ClassLoader loader = Thread.currentThread().getContextClassLoader();\n+        final Properties properties = new Properties();\n \n-        try (InputStream resourceStream = loader.getResourceAsStream(\"db-config.properties\")) {\n-            prop.load(resourceStream);\n+        final String dbType = System.getProperty(\"databaseType\",\n+                (System.getenv(\"databaseType\") != null ? System.getenv(\"databaseType\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTQ0OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/system/monitor/MonitorHelper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0OFrOGZFjcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0OFrOGZFjcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU3OQ==", "bodyText": "Issue found: Do not hard code the IP address", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958579", "createdAt": "2020-05-21T22:56:48Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/system/monitor/MonitorHelper.java", "diffHunk": "@@ -47,7 +47,7 @@\n     private static final long   DEFAULT_ASSET_FS_TIMEOUT    = 1000;\n     private static final long   DEFAULT_INDEX_TIMEOUT       = 1000;\n     private static final long   DEFAULT_DB_TIMEOUT          = 1000;\n-    private static final String DEFAULT_IP_ACL_VALUE        = \"127.0.0.1/32,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,0:0:0:0:0:0:0:1/128\";\n+    private static final String[] DEFAULT_IP_ACL_VALUE        = new String[] {\"127.0.0.1/32\",\"10.0.0.0/8\",\"172.16.0.0/12\",\"192.168.0.0/16\",\"0:0:0:0:0:0:0:1\"};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MTUzMTQ5OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0OVrOGZFjeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMjo1Njo0OVrOGZFjeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk1ODU4NQ==", "bodyText": "Issue found: Parameter 'clazz' is not assigned and could be declared final", "url": "https://github.com/dotCMS/core/pull/18538#discussion_r428958585", "createdAt": "2020-05-21T22:56:49Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/config/DotRestApplication.java", "diffHunk": "@@ -67,111 +69,129 @@\n  */\n public class DotRestApplication extends javax.ws.rs.core.Application {\n \n-\tprotected volatile static Set<Class<?>> REST_CLASSES = null;\n-\n-\t@Override\n-\tpublic Set<Class<?>> getClasses() {\n-\t\tif(REST_CLASSES == null){\n-\t\t\tsynchronized (this.getClass().getName().intern()) {\n-\t\t\t\tif(REST_CLASSES == null){\n-\t\t\t\t\tREST_CLASSES = new HashSet<>();\n-                    REST_CLASSES.add(MultiPartFeature.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.index.ESIndexResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.StructureResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ContentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.BundlePublisherResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.JSPPortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.AuditPublishingResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WidgetResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.CMSConfigResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.OSGIResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.ClusterResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.EnvironmentResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.notification.NotificationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.IntegrityResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.LicenseResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.WorkflowResource.class);\n-\n-                    REST_CLASSES.add(com.dotcms.rest.RestExamplePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonaResource.class);\n-\t\t\t\t\tREST_CLASSES.add(UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.user.UserResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TagResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(RulesEnginePortlet.class);\n-\t\t\t\t\tREST_CLASSES.add(RuleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionGroupResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConditionValueResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PersonasResourcePortlet.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ConditionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(MonitorResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ActionletsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(I18NResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LanguagesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.languages.LanguagesResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(MenuResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AuthenticationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LogoutResource.class);\n-\t\t\t\t\tREST_CLASSES.add(LoginFormResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ForgotPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ConfigurationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(AppContextInitResource.class);\n-\t\t\t\t\tREST_CLASSES.add(SiteResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v2.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v3.contenttype.FieldResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldTypeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FieldVariableResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ResetPasswordResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RoleResource.class);\n-\t\t\t\t\tREST_CLASSES.add(CreateJsonWebTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ApiTokenResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PortletResource.class);\n-\t\t\t\t\tREST_CLASSES.add(EventsResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FolderResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(BrowserTreeResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(CategoriesResource.class);\n-\t\t\t\t\tREST_CLASSES.add(PageResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentRelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContainerResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(ThemeResource.class);\n-\t\t\t\t\tREST_CLASSES.add(NavResource.class);\n-\t\t\t\t\tREST_CLASSES.add(RelationshipsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(VTLResource.class);\n-\t\t\t\t\tREST_CLASSES.add(ContentVersionResource.class);\n-\t\t\t\t\tREST_CLASSES.add(FileAssetsResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(PersonalizationResource.class);\n-\t\t\t\t\tREST_CLASSES.add(TempFileResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(UpgradeTaskResource.class);\n-\n-\t\t\t\t\tREST_CLASSES.add(AppsResource.class);\n+    \n+    /**\n+     * these are system resources and should never change\n+     */\n+\tprivate final static Set<Class<?>> INTERNAL_CLASSES = ImmutableSet.<Class<?>>builder()\n+                    .add(MultiPartFeature.class)\n+                    .add(com.dotcms.rest.api.v1.index.ESIndexResource.class)\n+                    .add(com.dotcms.rest.RoleResource.class)\n+                    .add(com.dotcms.rest.BundleResource.class)\n+                    .add(com.dotcms.rest.StructureResource.class)\n+                    .add(com.dotcms.rest.ContentResource.class)\n+                    .add(com.dotcms.rest.BundlePublisherResource.class)\n+                    .add(com.dotcms.rest.JSPPortlet.class)\n+                    .add(com.dotcms.rest.AuditPublishingResource.class)\n+                    .add(com.dotcms.rest.WidgetResource.class)\n+                    .add(com.dotcms.rest.CMSConfigResource.class)\n+                    .add(com.dotcms.rest.OSGIResource.class)\n+                    .add(com.dotcms.rest.UserResource.class)\n+                    .add(com.dotcms.rest.ClusterResource.class)\n+                    .add(com.dotcms.rest.EnvironmentResource.class)\n+                    .add(com.dotcms.rest.api.v1.notification.NotificationResource.class)\n+                    .add(com.dotcms.rest.IntegrityResource.class)\n+                    .add(com.dotcms.rest.LicenseResource.class)\n+                    .add(com.dotcms.rest.WorkflowResource.class)\n+                    .add(com.dotcms.rest.RestExamplePortlet.class)\n+                    .add(com.dotcms.rest.elasticsearch.ESContentResourcePortlet.class)\n+                    .add(PersonaResource.class)\n+                    .add(UserResource.class)\n+                    .add(com.dotcms.rest.api.v2.user.UserResource.class)\n+                    .add(TagResource.class)\n+                    .add(RulesEnginePortlet.class)\n+                    .add(RuleResource.class)\n+                    .add(ConditionGroupResource.class)\n+                    .add(ConditionResource.class)\n+                    .add(ConditionValueResource.class)\n+                    .add(PersonasResourcePortlet.class)\n+                    .add(ConditionletsResource.class)\n+                    .add(MonitorResource.class)\n+                    .add(ActionResource.class)\n+                    .add(ActionletsResource.class)\n+                    .add(I18NResource.class)\n+                    .add(LanguagesResource.class)\n+                    .add(com.dotcms.rest.api.v2.languages.LanguagesResource.class)\n+                    .add(MenuResource.class)\n+                    .add(AuthenticationResource.class)\n+                    .add(LogoutResource.class)\n+                    .add(LoginFormResource.class)\n+                    .add(ForgotPasswordResource.class)\n+                    .add(ConfigurationResource.class)\n+                    .add(AppContextInitResource.class)\n+                    .add(SiteResource.class)\n+                    .add(ContentTypeResource.class)\n+                    .add(FieldResource.class)\n+                    .add(com.dotcms.rest.api.v2.contenttype.FieldResource.class)\n+                    .add(com.dotcms.rest.api.v3.contenttype.FieldResource.class)\n+                    .add(FieldTypeResource.class)\n+                    .add(FieldVariableResource.class)\n+                    .add(ResetPasswordResource.class)\n+                    .add(RoleResource.class)\n+                    .add(CreateJsonWebTokenResource.class)\n+                    .add(ApiTokenResource.class)\n+                    .add(PortletResource.class)\n+                    .add(EventsResource.class)\n+                    .add(FolderResource.class)\n+                    .add(BrowserTreeResource.class)\n+                    .add(CategoriesResource.class)\n+                    .add(PageResource.class)\n+                    .add(ContentRelationshipsResource.class)\n+                    .add(com.dotcms.rest.api.v1.workflow.WorkflowResource.class)\n+                    .add(ContainerResource.class)\n+                    .add(ThemeResource.class)\n+                    .add(NavResource.class)\n+                    .add(RelationshipsResource.class)\n+                    .add(VTLResource.class)\n+                    .add(ContentVersionResource.class)\n+                    .add(FileAssetsResource.class)\n+                    .add(PersonalizationResource.class)\n+                    .add(TempFileResource.class)\n+                    .add(UpgradeTaskResource.class)\n+                    .add(AppsResource.class)\n+                    .add(BrowserResource.class)\n+                    .add(ResourceLinkResource.class)\n+                    .build();\n+\n+\t\n+\t/**\n+\t * This is the cheap way to create a concurrent set of user provided classes\n+\t */\n+    private final static Map<Class<?>, Boolean> customClasses = new ConcurrentHashMap<>();\n+\n+    /**\n+     * adds a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void addClass(Class<?> clazz) {\n+        if(clazz==null)return;\n+        if(!customClasses.containsKey(clazz)) {\n+            customClasses.put(clazz, true);\n+            ReloadableServletContainer.reload(new DotRestApplication());\n+        }\n+    }\n+\n+    /**\n+     * removes a class and reloads\n+     * @param clazz\n+     */\n+    public synchronized static void removeClass(Class<?> clazz) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f92ce2e13d0feb6a4d98ec7646124e9aea895c25"}, "originalPosition": 230}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2087, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}