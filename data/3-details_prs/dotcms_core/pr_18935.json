{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0NjM2NzU1", "number": 18935, "title": "#18571 Testing", "bodyText": "Testing dotCMS/enterprise#739", "createdAt": "2020-07-21T17:09:49Z", "url": "https://github.com/dotCMS/core/pull/18935", "merged": true, "mergeCommit": {"oid": "b321c292c2230e95de05a25709a5bec92c8c6fd0"}, "closed": true, "closedAt": "2020-07-27T16:18:42Z", "author": {"login": "freddyucv"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3JUCegH2gAyNDU0NjM2NzU1Ojk2NGQzNGY2ODc2MGJlZjNkYjc1MDc4Njg5ZDIzZDNkZjRjMjAwMmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5CrmgAFqTQ1NTgzNTA1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "964d34f68760bef3db75078689d23d3df4c2002c", "author": {"user": {"login": "freddyucv", "name": "Freddy Rodriguez"}}, "url": "https://github.com/dotCMS/core/commit/964d34f68760bef3db75078689d23d3df4c2002c", "committedDate": "2020-07-21T17:02:57Z", "message": "#18571 Testing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNjk5OTgw", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-452699980", "createdAt": "2020-07-21T17:57:49Z", "commit": {"oid": "964d34f68760bef3db75078689d23d3df4c2002c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6685a09c43d2e5ae9d971838fd995a6096b2a66", "author": {"user": {"login": "freddyucv", "name": "Freddy Rodriguez"}}, "url": "https://github.com/dotCMS/core/commit/b6685a09c43d2e5ae9d971838fd995a6096b2a66", "committedDate": "2020-07-21T19:59:29Z", "message": "Update Reltionship_cache_in_push_publish.postman_collection.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e5cc7d33ff6b7e9777d02040680fab7018d2704", "author": {"user": {"login": "freddyucv", "name": "Freddy Rodriguez"}}, "url": "https://github.com/dotCMS/core/commit/9e5cc7d33ff6b7e9777d02040680fab7018d2704", "committedDate": "2020-07-21T21:36:09Z", "message": "Update Reltionship_cache_in_push_publish.postman_collection.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a6ae1a658137b1a98663ae97a2cfd35be2f3122", "author": {"user": {"login": "freddyucv", "name": "Freddy Rodriguez"}}, "url": "https://github.com/dotCMS/core/commit/8a6ae1a658137b1a98663ae97a2cfd35be2f3122", "committedDate": "2020-07-21T22:09:37Z", "message": "Update Reltionship_cache_in_push_publish.postman_collection.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8550987eb89b5de759274755f6168503be8ad967", "author": {"user": {"login": "freddyucv", "name": "Freddy Rodriguez"}}, "url": "https://github.com/dotCMS/core/commit/8550987eb89b5de759274755f6168503be8ad967", "committedDate": "2020-07-21T22:43:16Z", "message": "Update Reltionship_cache_in_push_publish.postman_collection.json"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MjI1MDY4", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-454225068", "createdAt": "2020-07-23T15:00:44Z", "commit": {"oid": "8550987eb89b5de759274755f6168503be8ad967"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c6a88b425b199bd3747fefa19d20d4ccdf976a4", "author": {"user": {"login": "freddyucv", "name": "Freddy Rodriguez"}}, "url": "https://github.com/dotCMS/core/commit/0c6a88b425b199bd3747fefa19d20d4ccdf976a4", "committedDate": "2020-07-24T17:39:52Z", "message": "#18780 Testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5fcd2327bae99065061f0a760492a1e900bfcb3", "author": {"user": {"login": "freddyucv", "name": "Freddy Rodriguez"}}, "url": "https://github.com/dotCMS/core/commit/d5fcd2327bae99065061f0a760492a1e900bfcb3", "committedDate": "2020-07-24T18:23:16Z", "message": "Merge branch 'issue-18571-Relationships-cache-on-receiver-out-of-sync-after-deleting-a-relation-and-pushing-content' of https://github.com/dotCMS/core into issue-18571-Relationships-cache-on-receiver-out-of-sync-after-deleting-a-relation-and-pushing-content"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290", "author": {"user": {"login": "freddyucv", "name": "Freddy Rodriguez"}}, "url": "https://github.com/dotCMS/core/commit/ce91b935ebc983efd0b85ca7e2fdb6670c36e290", "committedDate": "2020-07-27T14:16:30Z", "message": "#18571 bundle files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM0ODIz", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455834823", "createdAt": "2020-07-27T14:26:59Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNjo1OVrOG3k9kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNjo1OVrOG3k9kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDQ1MA==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.dotmarketing.portlets.structure.model.ContentletRelationships'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930450", "createdAt": "2020-07-27T14:26:59Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM0ODQ4", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455834848", "createdAt": "2020-07-27T14:27:00Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowMFrOG3k9pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowMFrOG3k9pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDQ2OQ==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'org.junit.Assert'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930469", "createdAt": "2020-07-27T14:27:00Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM0ODc2", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455834876", "createdAt": "2020-07-27T14:27:02Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowMlrOG3k9wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowMlrOG3k9wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDQ5OA==", "bodyText": "Codacy found an issue: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930498", "createdAt": "2020-07-27T14:27:02Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {\n+        //Setting web app environment\n+        IntegrationTestInitService.getInstance().init();\n+    }\n+\n+    /**\n+     * Method to Test: {@link BundleResource#uploadBundleSync(HttpServletRequest, HttpServletResponse, FormDataMultiPart)}\n+     *                  and {@link com.dotcms.enterprise.publishing.remote.handler.ContentHandler#handle(File, Boolean)}\n+     * When: Send a PushPublish request with two content related, and later sned another Push Publish request removing the\n+     *       relationships between this two content\n+     * Should: Clean the relationship cache\n+     */\n+    @Test\n+    public void shouldCleanRelationshipCache() throws FileNotFoundException, DotPublisherException, DotDataException, DotCacheException {\n+\n+        final File createRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/create_relationship_content.tar.gz\")\n+                .getFile());\n+\n+        final File removeRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/remove_relationship_in_content.tar.gz\")\n+                .getFile());\n+\n+        final FileInputStream createCOntentFileInputStream = new FileInputStream(createRelationshipContentBundle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM0OTAy", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455834902", "createdAt": "2020-07-27T14:27:03Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowM1rOG3k91w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowM1rOG3k91w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDUxOQ==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.dotmarketing.portlets.rules.model.Condition'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930519", "createdAt": "2020-07-27T14:27:03Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM0OTE1", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455834915", "createdAt": "2020-07-27T14:27:04Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNFrOG3k94w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNFrOG3k94w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDUzMQ==", "bodyText": "Codacy found an issue: A method/constructor should not explicitly throw java.lang.Exception", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930531", "createdAt": "2020-07-27T14:27:04Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM0OTQw", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455834940", "createdAt": "2020-07-27T14:27:05Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNVrOG3k98g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNVrOG3k98g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU0Ng==", "bodyText": "Codacy found an issue: Ensure that resources like this FileInputStream object are closed after use", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930546", "createdAt": "2020-07-27T14:27:05Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {\n+        //Setting web app environment\n+        IntegrationTestInitService.getInstance().init();\n+    }\n+\n+    /**\n+     * Method to Test: {@link BundleResource#uploadBundleSync(HttpServletRequest, HttpServletResponse, FormDataMultiPart)}\n+     *                  and {@link com.dotcms.enterprise.publishing.remote.handler.ContentHandler#handle(File, Boolean)}\n+     * When: Send a PushPublish request with two content related, and later sned another Push Publish request removing the\n+     *       relationships between this two content\n+     * Should: Clean the relationship cache\n+     */\n+    @Test\n+    public void shouldCleanRelationshipCache() throws FileNotFoundException, DotPublisherException, DotDataException, DotCacheException {\n+\n+        final File createRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/create_relationship_content.tar.gz\")\n+                .getFile());\n+\n+        final File removeRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/remove_relationship_in_content.tar.gz\")\n+                .getFile());\n+\n+        final FileInputStream createCOntentFileInputStream = new FileInputStream(createRelationshipContentBundle);\n+        final FileInputStream removeRelationshipFileInputStream = new FileInputStream(removeRelationshipContentBundle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM0OTU3", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455834957", "createdAt": "2020-07-27T14:27:06Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNlrOG3k9_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNlrOG3k9_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU1Nw==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.liferay.portal.model.User'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930557", "createdAt": "2020-07-27T14:27:06Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM0OTc5", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455834979", "createdAt": "2020-07-27T14:27:07Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowN1rOG3k-EQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowN1rOG3k-EQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU3Nw==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.dotcms.util.CollectionsUtils.toImmutableList'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930577", "createdAt": "2020-07-27T14:27:07Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM1MDA2", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455835006", "createdAt": "2020-07-27T14:27:09Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowOVrOG3k-Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowOVrOG3k-Jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU5OA==", "bodyText": "Codacy found an issue: Ensure that resources like this FileInputStream object are closed after use", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930598", "createdAt": "2020-07-27T14:27:09Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {\n+        //Setting web app environment\n+        IntegrationTestInitService.getInstance().init();\n+    }\n+\n+    /**\n+     * Method to Test: {@link BundleResource#uploadBundleSync(HttpServletRequest, HttpServletResponse, FormDataMultiPart)}\n+     *                  and {@link com.dotcms.enterprise.publishing.remote.handler.ContentHandler#handle(File, Boolean)}\n+     * When: Send a PushPublish request with two content related, and later sned another Push Publish request removing the\n+     *       relationships between this two content\n+     * Should: Clean the relationship cache\n+     */\n+    @Test\n+    public void shouldCleanRelationshipCache() throws FileNotFoundException, DotPublisherException, DotDataException, DotCacheException {\n+\n+        final File createRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/create_relationship_content.tar.gz\")\n+                .getFile());\n+\n+        final File removeRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/remove_relationship_in_content.tar.gz\")\n+                .getFile());\n+\n+        final FileInputStream createCOntentFileInputStream = new FileInputStream(createRelationshipContentBundle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM1MDMx", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455835031", "createdAt": "2020-07-27T14:27:10Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMFrOG3k-PQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMFrOG3k-PQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDYyMQ==", "bodyText": "Codacy found an issue: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930621", "createdAt": "2020-07-27T14:27:10Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {\n+        //Setting web app environment\n+        IntegrationTestInitService.getInstance().init();\n+    }\n+\n+    /**\n+     * Method to Test: {@link BundleResource#uploadBundleSync(HttpServletRequest, HttpServletResponse, FormDataMultiPart)}\n+     *                  and {@link com.dotcms.enterprise.publishing.remote.handler.ContentHandler#handle(File, Boolean)}\n+     * When: Send a PushPublish request with two content related, and later sned another Push Publish request removing the\n+     *       relationships between this two content\n+     * Should: Clean the relationship cache\n+     */\n+    @Test\n+    public void shouldCleanRelationshipCache() throws FileNotFoundException, DotPublisherException, DotDataException, DotCacheException {\n+\n+        final File createRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/create_relationship_content.tar.gz\")\n+                .getFile());\n+\n+        final File removeRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/remove_relationship_in_content.tar.gz\")\n+                .getFile());\n+\n+        final FileInputStream createCOntentFileInputStream = new FileInputStream(createRelationshipContentBundle);\n+        final FileInputStream removeRelationshipFileInputStream = new FileInputStream(removeRelationshipContentBundle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODM1MDUy", "url": "https://github.com/dotCMS/core/pull/18935#pullrequestreview-455835052", "createdAt": "2020-07-27T14:27:11Z", "commit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMlrOG3k-SQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMlrOG3k-SQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDYzMw==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.dotmarketing.portlets.rules.model.ConditionGroup'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930633", "createdAt": "2020-07-27T14:27:12Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 827, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}