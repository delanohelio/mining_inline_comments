{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2NDA0MDQ5", "number": 19076, "title": "#19070 almost all template properties working", "bodyText": "Implements the template field for the GraphQL Page API.\nReturns the same fields returned by the REST API.\nAlso Postman tests were included.", "createdAt": "2020-08-11T23:13:27Z", "url": "https://github.com/dotCMS/core/pull/19076", "merged": true, "mergeCommit": {"oid": "eac74d24b0a0307a79e54b64385564a6de16608f"}, "closed": true, "closedAt": "2020-08-14T21:35:01Z", "author": {"login": "dsilvam"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9_MGhAH2gAyNDY2NDA0MDQ5OjEwMTRhYjEwYTdhZmNhNWVhOGE5YTViYmU4NDc5YzIzMDQ0ZDhiNzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-5_dAgFqTQ2NzgzMzk3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1014ab10a7afca5ea8a9a5bbe8479c23044d8b75", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/1014ab10a7afca5ea8a9a5bbe8479c23044d8b75", "committedDate": "2020-08-11T23:12:42Z", "message": "#19070 almost all template properties working"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92bb3f3ad6ea7f31a7259bb351b95b3306d32395", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/92bb3f3ad6ea7f31a7259bb351b95b3306d32395", "committedDate": "2020-08-12T23:37:08Z", "message": "19070 missing properties for template"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ea6df55590aa4f2fbff7cbdf4929f3e9f5e3bcf", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/8ea6df55590aa4f2fbff7cbdf4929f3e9f5e3bcf", "committedDate": "2020-08-13T22:21:03Z", "message": "#19070 postman tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b78fb26acebed2316f59e360a34b083d39a2d7fd", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/b78fb26acebed2316f59e360a34b083d39a2d7fd", "committedDate": "2020-08-13T22:24:34Z", "message": "#19070 codacy feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0ad61e7102482b7ceba97d6441b5038bd4ef6a1", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/d0ad61e7102482b7ceba97d6441b5038bd4ef6a1", "committedDate": "2020-08-13T22:27:05Z", "message": "#19070 javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3NjAxNDc2", "url": "https://github.com/dotCMS/core/pull/19076#pullrequestreview-467601476", "createdAt": "2020-08-14T14:04:38Z", "commit": {"oid": "d0ad61e7102482b7ceba97d6441b5038bd4ef6a1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3NjY4MTky", "url": "https://github.com/dotCMS/core/pull/19076#pullrequestreview-467668192", "createdAt": "2020-08-14T15:25:05Z", "commit": {"oid": "d0ad61e7102482b7ceba97d6441b5038bd4ef6a1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbd530f80c0dc1c7d23d1e0b83f27a503bc220c5", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/dbd530f80c0dc1c7d23d1e0b83f27a503bc220c5", "committedDate": "2020-08-14T19:36:00Z", "message": "#19070 fix postman test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3ODMzOTc4", "url": "https://github.com/dotCMS/core/pull/19076#pullrequestreview-467833978", "createdAt": "2020-08-14T19:43:17Z", "commit": {"oid": "dbd530f80c0dc1c7d23d1e0b83f27a503bc220c5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQxOTo0MzoxN1rOHBBVkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQxOTo0MzoxN1rOHBBVkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDgzMjUyOA==", "bodyText": "Codacy found an issue: Avoid catching generic exceptions such as NullPointerException, RuntimeException, Exception in try-catch block", "url": "https://github.com/dotCMS/core/pull/19076#discussion_r470832528", "createdAt": "2020-08-14T19:43:17Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/graphql/datafetcher/page/TemplateDataFetcher.java", "diffHunk": "@@ -0,0 +1,93 @@\n+package com.dotcms.graphql.datafetcher.page;\n+\n+import com.dotcms.graphql.DotGraphQLContext;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.PermissionLevel;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.exception.DotRuntimeException;\n+import com.dotmarketing.exception.DotSecurityException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.htmlpageasset.business.HTMLPageAssetAPI;\n+import com.dotmarketing.portlets.htmlpageasset.business.render.page.JsonMapper;\n+import com.dotmarketing.portlets.htmlpageasset.model.HTMLPageAsset;\n+import com.dotmarketing.portlets.templates.model.Template;\n+import com.dotmarketing.util.Logger;\n+import com.dotmarketing.util.PageMode;\n+import com.fasterxml.jackson.databind.ObjectWriter;\n+import com.liferay.portal.model.User;\n+import graphql.schema.DataFetcher;\n+import graphql.schema.DataFetchingEnvironment;\n+import java.io.CharArrayReader;\n+import java.io.IOException;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+/**\n+ * This DataFetcher returns a {@link Map} representing a {@link Template} associated to the originally\n+ * requested {@link HTMLPageAsset}.\n+ */\n+public class TemplateDataFetcher implements DataFetcher<Map<Object, Object>> {\n+    @Override\n+    public Map<Object, Object> get(final DataFetchingEnvironment environment) throws Exception {\n+        try {\n+            final User user = ((DotGraphQLContext) environment.getContext()).getUser();\n+            final Contentlet contentlet = environment.getSource();\n+            final String pageModeAsString = environment.getArgument(\"pageMode\")\n+                    != null ? environment.getArgument(\"pageMode\") : PageMode.LIVE.name();\n+\n+            final PageMode mode = PageMode.get(pageModeAsString);\n+\n+            final String templateId = contentlet.getStringProperty(HTMLPageAssetAPI.TEMPLATE_FIELD);\n+\n+            final Template template = getTemplate(templateId, mode);\n+\n+            return asMap(template, user);\n+        } catch (Exception e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbd530f80c0dc1c7d23d1e0b83f27a503bc220c5"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 731, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}