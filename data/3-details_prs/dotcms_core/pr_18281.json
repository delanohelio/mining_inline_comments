{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwNTAzNDY4", "number": 18281, "title": "Issue 18268 when es is down the form are not getting render", "bodyText": "When Elasticsearch is down we are getting a error trying to search by the Language variable here:\nhttps://github.com/dotCMS/core/compare/issue-18268-When-ES-is-down-the-form-are-not-getting-render?expand=1#diff-2fbc504febcbcbd478a77db00d87e7ecR264\nFix: when ES is down the Field Internationalization is not going to work but we want that the form still could be rendered", "createdAt": "2020-04-07T21:08:41Z", "url": "https://github.com/dotCMS/core/pull/18281", "merged": true, "mergeCommit": {"oid": "81b0cad0d3cca929de3a2baf53ce12f268b28fa5"}, "closed": true, "closedAt": "2020-04-14T15:57:05Z", "author": {"login": "freddyucv"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVFo3NgH2gAyNDAwNTAzNDY4OjYwZjlmMTliNjQ1Y2U3ZmU1YjAyMTIwYWE1NThlODUwNmM1N2FhNzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXXdw4AFqTM5MjUwNDk1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "60f9f19b645ce7fe5b02120aa558e8506c57aa74", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/60f9f19b645ce7fe5b02120aa558e8506c57aa74", "committedDate": "2020-04-06T21:32:39Z", "message": "Fix: render form when Es is down"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2713c7f428b94532bfaced656a7488efeae84159", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/2713c7f428b94532bfaced656a7488efeae84159", "committedDate": "2020-04-07T16:37:47Z", "message": "#18268 refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bcfb784ff9da722a3e797056ca839839bae8a1d", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/2bcfb784ff9da722a3e797056ca839839bae8a1d", "committedDate": "2020-04-07T16:38:14Z", "message": "Merge remote-tracking branch 'origin/master' into issue-18268-When-ES-is-down-the-form-are-not-getting-render"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTEyODk4", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-389512898", "createdAt": "2020-04-07T21:44:39Z", "commit": {"oid": "2bcfb784ff9da722a3e797056ca839839bae8a1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMTo0NDo0MFrOGCXSlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMTo0NDo0MFrOGCXSlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEzMTkyNA==", "bodyText": "can we write a test for this?", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r405131924", "createdAt": "2020-04-07T21:44:40Z", "author": {"login": "dsilvam"}, "path": "dotCMS/src/main/java/com/dotcms/contenttype/model/field/layout/FieldUtil.java", "diffHunk": "@@ -245,14 +257,22 @@ public static void setFieldInternationalization(\n         final long languageId = contentTypeInternationalization.getLanguageId();\n         final boolean live = contentTypeInternationalization.isLive();\n         final User user = APILocator.systemUser();\n-        \n-        for (final String propertyName : fieldMap.keySet()) {\n-            final String key = String.format(\"%s.%s.%s\", contentType.variable(), fieldMap.get(\"variable\"), propertyName);\n-            final String i18nValue = APILocator.getLanguageVariableAPI().getLanguageVariable(\n-                    key, languageId, user, live, user == null);\n-\n-            if (!i18nValue.equals(key) && !i18nValue.equals(fieldMap.get(propertyName).toString())) {\n-                fieldMap.put(propertyName, i18nValue);\n+\n+        try {\n+            for (final String propertyName : fieldMap.keySet()) {\n+                final String key = String.format(\"%s.%s.%s\", contentType.variable(), fieldMap.get(\"variable\"), propertyName);\n+                final String i18nValue = APILocator.getLanguageVariableAPI().getLanguageVariable(\n+                        key, languageId, user, live, user == null);\n+\n+                if (!i18nValue.equals(key) && !i18nValue.equals(fieldMap.get(propertyName).toString())) {\n+                    fieldMap.put(propertyName, i18nValue);\n+                }\n+            }\n+        } catch (DotRuntimeException e) {\n+            if ( ExceptionUtil.causedBy(e, ConnectException.class)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2bcfb784ff9da722a3e797056ca839839bae8a1d"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTIxOTcw", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-389521970", "createdAt": "2020-04-07T22:01:43Z", "commit": {"oid": "2bcfb784ff9da722a3e797056ca839839bae8a1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMjowMTo0NFrOGCXwuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMjowMTo0NFrOGCXwuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEzOTY0MQ==", "bodyText": "This method sounds like a good candidate to be moved to an API. Too much for a util method?", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r405139641", "createdAt": "2020-04-07T22:01:44Z", "author": {"login": "dsilvam"}, "path": "dotCMS/src/main/java/com/dotcms/contenttype/model/field/layout/FieldUtil.java", "diffHunk": "@@ -236,6 +239,15 @@ public static Field copyField(final Field field, final int newSortOrder) {\n         return jsonFieldTransformer.from();\n     }\n \n+    /**\n+     * Apply Internationalization to field property using a Language Variable, for each field property set into\n+     * fieldMap a Language Variable with the name contentTypeVariable.fieldVariable.propertyName is searched, if it\n+     * exists then the field's property value is replaced by the language variable value\n+     *\n+     * @param contentType\n+     * @param contentTypeInternationalization set the mode, language and user to search the Language Variable\n+     * @param fieldMap field properties\n+     */\n     public static void setFieldInternationalization(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2bcfb784ff9da722a3e797056ca839839bae8a1d"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMDI5NTM5", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-390029539", "createdAt": "2020-04-08T14:29:13Z", "commit": {"oid": "2bcfb784ff9da722a3e797056ca839839bae8a1d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMTIyNTgw", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-390122580", "createdAt": "2020-04-08T16:10:12Z", "commit": {"oid": "2bcfb784ff9da722a3e797056ca839839bae8a1d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5d753c9f171f339c058cfc4df2a6d8a16a5725a", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/c5d753c9f171f339c058cfc4df2a6d8a16a5725a", "committedDate": "2020-04-08T20:23:33Z", "message": "#18268 refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc44d05d8a9e9041ebf7df076ce9de4b45694bc7", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/fc44d05d8a9e9041ebf7df076ce9de4b45694bc7", "committedDate": "2020-04-08T20:24:58Z", "message": "#18268 testing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMTcxMDE1", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-391171015", "createdAt": "2020-04-09T22:23:42Z", "commit": {"oid": "fc44d05d8a9e9041ebf7df076ce9de4b45694bc7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28baff427f7d145ecdc9e563b50db0cca153634f", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/28baff427f7d145ecdc9e563b50db0cca153634f", "committedDate": "2020-04-13T17:59:49Z", "message": "Merge branch 'master' of github.com:dotCMS/core into issue-18268-When-ES-is-down-the-form-are-not-getting-render"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "217cffc801a9fc2dd7124526a1e9b57c89d3c3ce", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/217cffc801a9fc2dd7124526a1e9b57c89d3c3ce", "committedDate": "2020-04-13T22:13:16Z", "message": "#18268 Fixing error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNDg3NDk4", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392487498", "createdAt": "2020-04-13T22:41:00Z", "commit": {"oid": "217cffc801a9fc2dd7124526a1e9b57c89d3c3ce"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3e32950377d6f04ccee9d6349b1f6d69f99cb24", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/d3e32950377d6f04ccee9d6349b1f6d69f99cb24", "committedDate": "2020-04-13T22:41:22Z", "message": "Merge branch 'issue-18268-When-ES-is-down-the-form-are-not-getting-render' of github.com:dotCMS/core into issue-18268-When-ES-is-down-the-form-are-not-getting-render"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02351b8e54207dd6081453e4baeeefb1960f9796", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/02351b8e54207dd6081453e4baeeefb1960f9796", "committedDate": "2020-04-13T23:13:33Z", "message": "#18268 merge with master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7dac5a71a5b36eb085a122ce1cc3a01cb8891fc", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/b7dac5a71a5b36eb085a122ce1cc3a01cb8891fc", "committedDate": "2020-04-13T23:15:16Z", "message": "Merge branch 'master' into issue-18268-When-ES-is-down-the-form-are-not-getting-render"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bfde6e99b8dfface957bcf9b3261df80044b4b9", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/6bfde6e99b8dfface957bcf9b3261df80044b4b9", "committedDate": "2020-04-13T23:19:13Z", "message": "#18268 merge with master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/66ef18c78cb62d766e29256273e926614f6bf390", "committedDate": "2020-04-13T23:19:59Z", "message": "#18268 merge with master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA0OTAz", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392504903", "createdAt": "2020-04-13T23:26:33Z", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozM1rOGE4smw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozM1rOGE4smw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3NjQxMQ==", "bodyText": "Issue found: The String literal \"value_3\" appears 4 times in this file; the first occurrence is on line 72", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r407776411", "createdAt": "2020-04-13T23:26:33Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/test/java/com/dotcms/contenttype/business/FieldAPIImplTest.java", "diffHunk": "@@ -0,0 +1,160 @@\n+package com.dotcms.contenttype.business;\n+\n+import com.dotcms.contenttype.business.FieldAPIImpl;\n+import com.dotcms.contenttype.model.type.ContentType;\n+import com.dotcms.contenttype.transform.contenttype.ContentTypeInternationalization;\n+import com.dotcms.languagevariable.business.LanguageVariableAPI;\n+import com.dotcms.system.event.local.business.LocalSystemEventsAPI;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.PermissionAPI;\n+import com.dotmarketing.business.RelationshipAPI;\n+import com.dotmarketing.business.UserAPI;\n+import com.dotmarketing.exception.DotRuntimeException;\n+import com.dotmarketing.portlets.contentlet.business.ContentletAPI;\n+import com.liferay.portal.model.User;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import java.net.ConnectException;\n+import java.util.Map;\n+\n+import static com.dotcms.util.CollectionsUtils.map;\n+import static org.mockito.Matchers.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+import static org.junit.Assert.assertEquals;\n+\n+public class FieldAPIImplTest {\n+    private static PermissionAPI perAPI;\n+    private static ContentletAPI conAPI;\n+    private static UserAPI userAPI;\n+    private static RelationshipAPI relationshipAPI;\n+    private static LocalSystemEventsAPI localSystemEventsAPI;\n+    private static LanguageVariableAPI languageVariableAPI;\n+\n+    private static FieldAPIImpl fieldAPIImpl;\n+\n+    @BeforeClass\n+    public static void init(){\n+        perAPI = mock(PermissionAPI.class);\n+        conAPI = mock(ContentletAPI.class);\n+        userAPI = mock(UserAPI.class);\n+        relationshipAPI = mock(RelationshipAPI.class);\n+        localSystemEventsAPI = mock(LocalSystemEventsAPI.class);\n+        languageVariableAPI = mock(LanguageVariableAPI.class);\n+\n+        fieldAPIImpl = new FieldAPIImpl(\n+                perAPI,\n+                conAPI,\n+                userAPI,\n+                relationshipAPI,\n+                localSystemEventsAPI,\n+                languageVariableAPI\n+        );\n+    }\n+\n+    /**\n+     * when: you have to language variable for the Content Type's fields\n+     * Should: Change the field property name by the language variable values\n+     */\n+    @Test\n+    public void shouldFieldInternationalizationWork(){\n+        final long languageId = 1;\n+        final boolean live = true;\n+        final User user = mock(User.class);\n+        final Object object = mock(Object.class);\n+\n+        final ContentType contentType = mock(ContentType.class);\n+        final ContentTypeInternationalization contentTypeInternationalization = mock(ContentTypeInternationalization.class);\n+        final Map<String, Object> fieldMap = map(\n+                \"attribute_1\", \"value_1\",\n+                \"attribute_2\", \"value_2\",\n+                \"attribute_3\", \"value_3\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "originalPosition": 72}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA0OTEx", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392504911", "createdAt": "2020-04-13T23:26:34Z", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozNFrOGE4soQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozNFrOGE4soQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3NjQxNw==", "bodyText": "Issue found: The String literal \"attribute_1\" appears 4 times in this file; the first occurrence is on line 70", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r407776417", "createdAt": "2020-04-13T23:26:34Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/test/java/com/dotcms/contenttype/business/FieldAPIImplTest.java", "diffHunk": "@@ -0,0 +1,160 @@\n+package com.dotcms.contenttype.business;\n+\n+import com.dotcms.contenttype.business.FieldAPIImpl;\n+import com.dotcms.contenttype.model.type.ContentType;\n+import com.dotcms.contenttype.transform.contenttype.ContentTypeInternationalization;\n+import com.dotcms.languagevariable.business.LanguageVariableAPI;\n+import com.dotcms.system.event.local.business.LocalSystemEventsAPI;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.PermissionAPI;\n+import com.dotmarketing.business.RelationshipAPI;\n+import com.dotmarketing.business.UserAPI;\n+import com.dotmarketing.exception.DotRuntimeException;\n+import com.dotmarketing.portlets.contentlet.business.ContentletAPI;\n+import com.liferay.portal.model.User;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import java.net.ConnectException;\n+import java.util.Map;\n+\n+import static com.dotcms.util.CollectionsUtils.map;\n+import static org.mockito.Matchers.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+import static org.junit.Assert.assertEquals;\n+\n+public class FieldAPIImplTest {\n+    private static PermissionAPI perAPI;\n+    private static ContentletAPI conAPI;\n+    private static UserAPI userAPI;\n+    private static RelationshipAPI relationshipAPI;\n+    private static LocalSystemEventsAPI localSystemEventsAPI;\n+    private static LanguageVariableAPI languageVariableAPI;\n+\n+    private static FieldAPIImpl fieldAPIImpl;\n+\n+    @BeforeClass\n+    public static void init(){\n+        perAPI = mock(PermissionAPI.class);\n+        conAPI = mock(ContentletAPI.class);\n+        userAPI = mock(UserAPI.class);\n+        relationshipAPI = mock(RelationshipAPI.class);\n+        localSystemEventsAPI = mock(LocalSystemEventsAPI.class);\n+        languageVariableAPI = mock(LanguageVariableAPI.class);\n+\n+        fieldAPIImpl = new FieldAPIImpl(\n+                perAPI,\n+                conAPI,\n+                userAPI,\n+                relationshipAPI,\n+                localSystemEventsAPI,\n+                languageVariableAPI\n+        );\n+    }\n+\n+    /**\n+     * when: you have to language variable for the Content Type's fields\n+     * Should: Change the field property name by the language variable values\n+     */\n+    @Test\n+    public void shouldFieldInternationalizationWork(){\n+        final long languageId = 1;\n+        final boolean live = true;\n+        final User user = mock(User.class);\n+        final Object object = mock(Object.class);\n+\n+        final ContentType contentType = mock(ContentType.class);\n+        final ContentTypeInternationalization contentTypeInternationalization = mock(ContentTypeInternationalization.class);\n+        final Map<String, Object> fieldMap = map(\n+                \"attribute_1\", \"value_1\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA0OTE1", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392504915", "createdAt": "2020-04-13T23:26:35Z", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozNVrOGE4sow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozNVrOGE4sow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3NjQxOQ==", "bodyText": "Issue found: The String literal \"attribute_2\" appears 4 times in this file; the first occurrence is on line 71", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r407776419", "createdAt": "2020-04-13T23:26:35Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/test/java/com/dotcms/contenttype/business/FieldAPIImplTest.java", "diffHunk": "@@ -0,0 +1,160 @@\n+package com.dotcms.contenttype.business;\n+\n+import com.dotcms.contenttype.business.FieldAPIImpl;\n+import com.dotcms.contenttype.model.type.ContentType;\n+import com.dotcms.contenttype.transform.contenttype.ContentTypeInternationalization;\n+import com.dotcms.languagevariable.business.LanguageVariableAPI;\n+import com.dotcms.system.event.local.business.LocalSystemEventsAPI;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.PermissionAPI;\n+import com.dotmarketing.business.RelationshipAPI;\n+import com.dotmarketing.business.UserAPI;\n+import com.dotmarketing.exception.DotRuntimeException;\n+import com.dotmarketing.portlets.contentlet.business.ContentletAPI;\n+import com.liferay.portal.model.User;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import java.net.ConnectException;\n+import java.util.Map;\n+\n+import static com.dotcms.util.CollectionsUtils.map;\n+import static org.mockito.Matchers.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+import static org.junit.Assert.assertEquals;\n+\n+public class FieldAPIImplTest {\n+    private static PermissionAPI perAPI;\n+    private static ContentletAPI conAPI;\n+    private static UserAPI userAPI;\n+    private static RelationshipAPI relationshipAPI;\n+    private static LocalSystemEventsAPI localSystemEventsAPI;\n+    private static LanguageVariableAPI languageVariableAPI;\n+\n+    private static FieldAPIImpl fieldAPIImpl;\n+\n+    @BeforeClass\n+    public static void init(){\n+        perAPI = mock(PermissionAPI.class);\n+        conAPI = mock(ContentletAPI.class);\n+        userAPI = mock(UserAPI.class);\n+        relationshipAPI = mock(RelationshipAPI.class);\n+        localSystemEventsAPI = mock(LocalSystemEventsAPI.class);\n+        languageVariableAPI = mock(LanguageVariableAPI.class);\n+\n+        fieldAPIImpl = new FieldAPIImpl(\n+                perAPI,\n+                conAPI,\n+                userAPI,\n+                relationshipAPI,\n+                localSystemEventsAPI,\n+                languageVariableAPI\n+        );\n+    }\n+\n+    /**\n+     * when: you have to language variable for the Content Type's fields\n+     * Should: Change the field property name by the language variable values\n+     */\n+    @Test\n+    public void shouldFieldInternationalizationWork(){\n+        final long languageId = 1;\n+        final boolean live = true;\n+        final User user = mock(User.class);\n+        final Object object = mock(Object.class);\n+\n+        final ContentType contentType = mock(ContentType.class);\n+        final ContentTypeInternationalization contentTypeInternationalization = mock(ContentTypeInternationalization.class);\n+        final Map<String, Object> fieldMap = map(\n+                \"attribute_1\", \"value_1\",\n+                \"attribute_2\", \"value_2\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "originalPosition": 71}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA0OTI0", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392504924", "createdAt": "2020-04-13T23:26:36Z", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozNlrOGE4sqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozNlrOGE4sqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3NjQyNQ==", "bodyText": "Issue found: The String literal \"variable\" appears 4 times in this file; the first occurrence is on line 73", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r407776425", "createdAt": "2020-04-13T23:26:36Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/test/java/com/dotcms/contenttype/business/FieldAPIImplTest.java", "diffHunk": "@@ -0,0 +1,160 @@\n+package com.dotcms.contenttype.business;\n+\n+import com.dotcms.contenttype.business.FieldAPIImpl;\n+import com.dotcms.contenttype.model.type.ContentType;\n+import com.dotcms.contenttype.transform.contenttype.ContentTypeInternationalization;\n+import com.dotcms.languagevariable.business.LanguageVariableAPI;\n+import com.dotcms.system.event.local.business.LocalSystemEventsAPI;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.PermissionAPI;\n+import com.dotmarketing.business.RelationshipAPI;\n+import com.dotmarketing.business.UserAPI;\n+import com.dotmarketing.exception.DotRuntimeException;\n+import com.dotmarketing.portlets.contentlet.business.ContentletAPI;\n+import com.liferay.portal.model.User;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import java.net.ConnectException;\n+import java.util.Map;\n+\n+import static com.dotcms.util.CollectionsUtils.map;\n+import static org.mockito.Matchers.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+import static org.junit.Assert.assertEquals;\n+\n+public class FieldAPIImplTest {\n+    private static PermissionAPI perAPI;\n+    private static ContentletAPI conAPI;\n+    private static UserAPI userAPI;\n+    private static RelationshipAPI relationshipAPI;\n+    private static LocalSystemEventsAPI localSystemEventsAPI;\n+    private static LanguageVariableAPI languageVariableAPI;\n+\n+    private static FieldAPIImpl fieldAPIImpl;\n+\n+    @BeforeClass\n+    public static void init(){\n+        perAPI = mock(PermissionAPI.class);\n+        conAPI = mock(ContentletAPI.class);\n+        userAPI = mock(UserAPI.class);\n+        relationshipAPI = mock(RelationshipAPI.class);\n+        localSystemEventsAPI = mock(LocalSystemEventsAPI.class);\n+        languageVariableAPI = mock(LanguageVariableAPI.class);\n+\n+        fieldAPIImpl = new FieldAPIImpl(\n+                perAPI,\n+                conAPI,\n+                userAPI,\n+                relationshipAPI,\n+                localSystemEventsAPI,\n+                languageVariableAPI\n+        );\n+    }\n+\n+    /**\n+     * when: you have to language variable for the Content Type's fields\n+     * Should: Change the field property name by the language variable values\n+     */\n+    @Test\n+    public void shouldFieldInternationalizationWork(){\n+        final long languageId = 1;\n+        final boolean live = true;\n+        final User user = mock(User.class);\n+        final Object object = mock(Object.class);\n+\n+        final ContentType contentType = mock(ContentType.class);\n+        final ContentTypeInternationalization contentTypeInternationalization = mock(ContentTypeInternationalization.class);\n+        final Map<String, Object> fieldMap = map(\n+                \"attribute_1\", \"value_1\",\n+                \"attribute_2\", \"value_2\",\n+                \"attribute_3\", \"value_3\",\n+                \"variable\", \"testField\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "originalPosition": 73}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA0OTI3", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392504927", "createdAt": "2020-04-13T23:26:37Z", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozN1rOGE4sqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozN1rOGE4sqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3NjQyNw==", "bodyText": "Issue found: Unnecessary modifier 'public' on method 'getFieldInternationalization': the method is declared in an interface type", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r407776427", "createdAt": "2020-04-13T23:26:37Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/contenttype/business/FieldAPI.java", "diffHunk": "@@ -229,4 +220,37 @@ default FieldAPI instance() {\n \t * @throws DotDataException\n \t */\n     void saveFields(final List<Field> fields, final User user) throws DotSecurityException, DotDataException;\n+\n+\t/**\n+\t * Apply Internationalization to field property using a Language Variable, for each field property set into\n+\t * fieldMap a Language Variable with the name contentTypeVariable.fieldVariable.propertyName is searched, if it\n+\t * exists then the field's property value is replaced by the language variable value\n+\t *\n+\t * @param contentType\n+\t * @param contentTypeInternationalization set the mode, language and user to search the Language Variable\n+\t * @param fieldMap field properties\n+\t * @return  The Field's properties with the new internationalization values\n+\t */\n+\tpublic Map<String, Object> getFieldInternationalization(\n+\t\t\tfinal ContentType contentType,\n+\t\t\tfinal ContentTypeInternationalization contentTypeInternationalization,\n+\t\t\tfinal Map<String, Object> fieldMap\n+\t);\n+\n+\t/**\n+\t * Apply Internationalization to field property using a Language Variable, for each field property set into\n+\t * fieldMap a Language Variable with the name contentTypeVariable.fieldVariable.propertyName is searched, if it\n+\t * exists then the field's property value is replaced by the language variable value\n+\t *\n+\t * @param contentType\n+\t * @param contentTypeInternationalization set the mode, language and user to search the Language Variable\n+\t * @param fieldMap field properties\n+\t * @return  The Field's properties with the new internationalization values\n+\t */\n+\tpublic Map<String, Object> getFieldInternationalization(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "originalPosition": 62}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA0OTM3", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392504937", "createdAt": "2020-04-13T23:26:38Z", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozOFrOGE4ssg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozOFrOGE4ssg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3NjQzNA==", "bodyText": "Issue found: No need to import a type that lives in the same package", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r407776434", "createdAt": "2020-04-13T23:26:38Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/test/java/com/dotcms/contenttype/business/FieldAPIImplTest.java", "diffHunk": "@@ -0,0 +1,160 @@\n+package com.dotcms.contenttype.business;\n+\n+import com.dotcms.contenttype.business.FieldAPIImpl;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA0OTQ3", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392504947", "createdAt": "2020-04-13T23:26:39Z", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozOVrOGE4svA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjozOVrOGE4svA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3NjQ0NA==", "bodyText": "Issue found: Avoid unused imports such as 'org.mockito.Matchers'", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r407776444", "createdAt": "2020-04-13T23:26:39Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/test/java/com/dotcms/contenttype/business/FieldAPIImplTest.java", "diffHunk": "@@ -0,0 +1,160 @@\n+package com.dotcms.contenttype.business;\n+\n+import com.dotcms.contenttype.business.FieldAPIImpl;\n+import com.dotcms.contenttype.model.type.ContentType;\n+import com.dotcms.contenttype.transform.contenttype.ContentTypeInternationalization;\n+import com.dotcms.languagevariable.business.LanguageVariableAPI;\n+import com.dotcms.system.event.local.business.LocalSystemEventsAPI;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.PermissionAPI;\n+import com.dotmarketing.business.RelationshipAPI;\n+import com.dotmarketing.business.UserAPI;\n+import com.dotmarketing.exception.DotRuntimeException;\n+import com.dotmarketing.portlets.contentlet.business.ContentletAPI;\n+import com.liferay.portal.model.User;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import java.net.ConnectException;\n+import java.util.Map;\n+\n+import static com.dotcms.util.CollectionsUtils.map;\n+import static org.mockito.Matchers.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA0OTU1", "url": "https://github.com/dotCMS/core/pull/18281#pullrequestreview-392504955", "createdAt": "2020-04-13T23:26:40Z", "commit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjo0MFrOGE4sww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzoyNjo0MFrOGE4sww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc3NjQ1MQ==", "bodyText": "Issue found: Avoid unused imports such as 'com.dotmarketing.business.APILocator'", "url": "https://github.com/dotCMS/core/pull/18281#discussion_r407776451", "createdAt": "2020-04-13T23:26:40Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/test/java/com/dotcms/contenttype/business/FieldAPIImplTest.java", "diffHunk": "@@ -0,0 +1,160 @@\n+package com.dotcms.contenttype.business;\n+\n+import com.dotcms.contenttype.business.FieldAPIImpl;\n+import com.dotcms.contenttype.model.type.ContentType;\n+import com.dotcms.contenttype.transform.contenttype.ContentTypeInternationalization;\n+import com.dotcms.languagevariable.business.LanguageVariableAPI;\n+import com.dotcms.system.event.local.business.LocalSystemEventsAPI;\n+import com.dotmarketing.business.APILocator;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ef18c78cb62d766e29256273e926614f6bf390"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1260, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}