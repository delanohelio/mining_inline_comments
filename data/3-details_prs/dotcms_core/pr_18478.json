{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2ODY5Mjk0", "number": 18478, "title": "Apps feature branch", "bodyText": "All pending changes from Apps, already reviewed on previous PRs", "createdAt": "2020-05-12T17:34:00Z", "url": "https://github.com/dotCMS/core/pull/18478", "merged": true, "mergeCommit": {"oid": "ea90883a2f8c2d662ff364dcb5e4547b3c697a3f"}, "closed": true, "closedAt": "2020-05-12T21:47:10Z", "author": {"login": "nollymar"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcafU3vAH2gAyNDE2ODY5Mjk0Ojc5ZmU1Yjk3MzcyZTE5OTg3NzFkNzVhOGI5OTYwZmQ0MDU2Y2M4YTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgn4oogFqTQxMDI3NDk5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "79fe5b97372e1998771d75a8b9960fd4056cc8a4", "author": {"user": {"login": "alfredo-dotcms", "name": null}}, "url": "https://github.com/dotCMS/core/commit/79fe5b97372e1998771d75a8b9960fd4056cc8a4", "committedDate": "2020-04-23T16:17:58Z", "message": "issue-18249-Refactor-Dot-Field-Variables core#18249 (#18290)\n\n* core#18249\r\n\r\n* Added missing languages\r\n\r\n* add hidden title label\r\n\r\n* custom label added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98e9bdb8269c3f230ec0cb75f24991b096d5057b", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/98e9bdb8269c3f230ec0cb75f24991b096d5057b", "committedDate": "2020-04-27T15:15:35Z", "message": "Merge branch 'master' of https://github.com/dotCMS/core into apps-feature-branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44fda47a71168a2a60fdf3ead1a2fa6557a63344", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/44fda47a71168a2a60fdf3ead1a2fa6557a63344", "committedDate": "2020-04-27T18:24:21Z", "message": "Issue 18218 warnings (#18360)\n\n* #18218 apps secret  warning checks\r\n\r\n* #18218 lang keys\r\n\r\n* #18218  warnings fix broken test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e511817f36777295385ded5df9eb3134fa47257", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/1e511817f36777295385ded5df9eb3134fa47257", "committedDate": "2020-04-27T22:44:49Z", "message": "  #18373 apps resilience when a site is deleted (#18365)\n\n* apps resilience when a site is deleted\r\n\r\n* # apps delete secrets for site\r\n\r\n* apps site delete resilience\r\n\r\n* # apps site delete resilience"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97acae1b22c048f3575b9fe21119244bb1f67996", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/97acae1b22c048f3575b9fe21119244bb1f67996", "committedDate": "2020-04-28T15:51:11Z", "message": "Merge branch 'master' of https://github.com/dotCMS/core into apps-feature-branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd31431c73ef647b622fe149d7784041d1b2ddd6", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/cd31431c73ef647b622fe149d7784041d1b2ddd6", "committedDate": "2020-04-28T15:51:39Z", "message": "Merge branch 'apps-feature-branch' of https://github.com/dotCMS/core into apps-feature-branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f812d12b4c56f6490539582f8f8e30f5fe83fbd", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/2f812d12b4c56f6490539582f8f8e30f5fe83fbd", "committedDate": "2020-04-28T23:32:40Z", "message": "#18218 fixes for apps  warnings (#18386)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "643b70f3e106d6984376d262f9154d76b6f80eb1", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/643b70f3e106d6984376d262f9154d76b6f80eb1", "committedDate": "2020-04-30T18:40:10Z", "message": "Merge branch 'master' of https://github.com/dotCMS/core into apps-feature-branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25b00ebb8a15c9d59019cb729093acd0ac0c41e0", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/25b00ebb8a15c9d59019cb729093acd0ac0c41e0", "committedDate": "2020-05-01T16:06:44Z", "message": " fixes for  #18416 #18414 #18413 (#18418)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e", "author": {"user": {"login": "alfredo-dotcms", "name": null}}, "url": "https://github.com/dotCMS/core/commit/2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e", "committedDate": "2020-05-05T15:51:55Z", "message": "fix core#18415 (#18432)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjc0ODky", "url": "https://github.com/dotCMS/core/pull/18478#pullrequestreview-410274892", "createdAt": "2020-05-12T17:39:41Z", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0MVrOGURwow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0MVrOGURwow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTY4Mw==", "bodyText": "Issue found: Assigning an Object to null is a code smell.  Consider refactoring.", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915683", "createdAt": "2020-05-12T17:39:41Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/AppView.java", "diffHunk": "@@ -48,14 +52,15 @@ public AppView(final AppDescriptor appDescriptor, final long configurationsCount\n      * @param configurationsCount\n      * @param sites\n      */\n-    public AppView(final AppDescriptor appDescriptor, final long configurationsCount, final List<SiteView> sites) {\n+    public AppView(final AppDescriptor appDescriptor, final int configurationsCount, final List<SiteView> sites) {\n         this.key = appDescriptor.getKey();\n         this.name = appDescriptor.getName();\n         this.description = appDescriptor.getDescription();\n         this.iconUrl = appDescriptor.getIconUrl();\n         this.allowExtraParams = appDescriptor.isAllowExtraParameters();\n         this.configurationsCount = configurationsCount;\n         this.sites = sites;\n+        this.sitesWithWarnings = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjc0OTEx", "url": "https://github.com/dotCMS/core/pull/18478#pullrequestreview-410274911", "createdAt": "2020-05-12T17:39:42Z", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0M1rOGURwrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0M1rOGURwrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTY5Mw==", "bodyText": "Issue found: The String literal \"any-name\" appears 18 times in this file; the first occurrence is on line 461", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915693", "createdAt": "2020-05-12T17:39:43Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "diffHunk": "@@ -434,6 +439,104 @@ public void Test_Secret_Destroy_Method() {\n         }\n     }\n \n+    /**\n+     * Test computeSecretWarnings.\n+     * Given scenario: You create a secret with no value the secret is expected to be required according to the descriptor.\n+     * Expected Result: Such situation should generate a warning\n+     */\n+    @Test\n+    public void Test_Secret_Integrity_Check_Expect_Warning()\n+            throws DotDataException, DotSecurityException {\n+        final AppsAPI api = APILocator.getAppsAPI();\n+\n+        final String appKey = \"any-key\";\n+\n+        final AppDescriptor descriptor = mock(AppDescriptor.class);\n+        when(descriptor.isAllowExtraParameters()).thenReturn(false);\n+        final Map<String, ParamDescriptor> params = of(\n+        \"requiredNoDefault\",newParam(null, false, Type.STRING, \"any\", \"hint\", true), // This is the rule we intend to break\n+        \"requiredDefault\", newParam(\"default\", false, Type.STRING, \"any\", \"hint\", true),\n+        \"nonRequiredNoDefault\", newParam(null, false, Type.STRING, \"any\", \"hint\", false)\n+         );\n+        when(descriptor.getParams()).thenReturn(params);\n+        when(descriptor.getName()).thenReturn(\"any-name\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjc0OTIw", "url": "https://github.com/dotCMS/core/pull/18478#pullrequestreview-410274920", "createdAt": "2020-05-12T17:39:43Z", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NFrOGURwsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NFrOGURwsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTY5OQ==", "bodyText": "Issue found: Avoid variables with short names like id", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915699", "createdAt": "2020-05-12T17:39:44Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "diffHunk": "@@ -23,11 +26,12 @@\n      * @param name\n      * @param configured\n      */\n-    public SiteView(final String id, final String name, final boolean configured) {\n+    public SiteView(final String id, final String name, final boolean configured, final int secretsWithWarning) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjc0OTM0", "url": "https://github.com/dotCMS/core/pull/18478#pullrequestreview-410274934", "createdAt": "2020-05-12T17:39:44Z", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NVrOGURwvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NVrOGURwvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTcwOA==", "bodyText": "Issue found: Useless parentheses.", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915708", "createdAt": "2020-05-12T17:39:45Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "diffHunk": "@@ -23,11 +26,12 @@\n      * @param name\n      * @param configured\n      */\n-    public SiteView(final String id, final String name, final boolean configured) {\n+    public SiteView(final String id, final String name, final boolean configured, final int secretsWithWarning) {\n         this.id = id;\n         this.name = name;\n         this.configured = configured;\n         this.secrets = null;\n+        this.secretsWithWarnings = (secretsWithWarning == 0 ? null : secretsWithWarning);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjc0OTQ3", "url": "https://github.com/dotCMS/core/pull/18478#pullrequestreview-410274947", "createdAt": "2020-05-12T17:39:45Z", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NVrOGURwyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0NVrOGURwyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTcyMA==", "bodyText": "Issue found: The String literal \"requiredDefault\" appears 4 times in this file; the first occurrence is on line 457", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915720", "createdAt": "2020-05-12T17:39:45Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "diffHunk": "@@ -434,6 +439,104 @@ public void Test_Secret_Destroy_Method() {\n         }\n     }\n \n+    /**\n+     * Test computeSecretWarnings.\n+     * Given scenario: You create a secret with no value the secret is expected to be required according to the descriptor.\n+     * Expected Result: Such situation should generate a warning\n+     */\n+    @Test\n+    public void Test_Secret_Integrity_Check_Expect_Warning()\n+            throws DotDataException, DotSecurityException {\n+        final AppsAPI api = APILocator.getAppsAPI();\n+\n+        final String appKey = \"any-key\";\n+\n+        final AppDescriptor descriptor = mock(AppDescriptor.class);\n+        when(descriptor.isAllowExtraParameters()).thenReturn(false);\n+        final Map<String, ParamDescriptor> params = of(\n+        \"requiredNoDefault\",newParam(null, false, Type.STRING, \"any\", \"hint\", true), // This is the rule we intend to break\n+        \"requiredDefault\", newParam(\"default\", false, Type.STRING, \"any\", \"hint\", true),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjc0OTY5", "url": "https://github.com/dotCMS/core/pull/18478#pullrequestreview-410274969", "createdAt": "2020-05-12T17:39:47Z", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0N1rOGURw2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0N1rOGURw2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTczNw==", "bodyText": "Issue found: The String literal \"requiredNoDefault\" appears 4 times in this file; the first occurrence is on line 456", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915737", "createdAt": "2020-05-12T17:39:47Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "diffHunk": "@@ -434,6 +439,104 @@ public void Test_Secret_Destroy_Method() {\n         }\n     }\n \n+    /**\n+     * Test computeSecretWarnings.\n+     * Given scenario: You create a secret with no value the secret is expected to be required according to the descriptor.\n+     * Expected Result: Such situation should generate a warning\n+     */\n+    @Test\n+    public void Test_Secret_Integrity_Check_Expect_Warning()\n+            throws DotDataException, DotSecurityException {\n+        final AppsAPI api = APILocator.getAppsAPI();\n+\n+        final String appKey = \"any-key\";\n+\n+        final AppDescriptor descriptor = mock(AppDescriptor.class);\n+        when(descriptor.isAllowExtraParameters()).thenReturn(false);\n+        final Map<String, ParamDescriptor> params = of(\n+        \"requiredNoDefault\",newParam(null, false, Type.STRING, \"any\", \"hint\", true), // This is the rule we intend to break", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjc0OTg1", "url": "https://github.com/dotCMS/core/pull/18478#pullrequestreview-410274985", "createdAt": "2020-05-12T17:39:48Z", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OFrOGURw4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OFrOGURw4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTc0Ng==", "bodyText": "Issue found: Assigning an Object to null is a code smell.  Consider refactoring.", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915746", "createdAt": "2020-05-12T17:39:48Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/view/SiteView.java", "diffHunk": "@@ -42,6 +46,7 @@ public SiteView(final String id,final String name,\n         this.name = name;\n         this.configured = secrets.stream().anyMatch(secretView -> null != secretView.getSecret());\n         this.secrets = secrets;\n+        this.secretsWithWarnings = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMjc0OTk4", "url": "https://github.com/dotCMS/core/pull/18478#pullrequestreview-410274998", "createdAt": "2020-05-12T17:39:49Z", "commit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OVrOGURw7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxNzozOTo0OVrOGURw7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxNTc1OA==", "bodyText": "Issue found: The String literal \"any-key\" appears 15 times in this file; the first occurrence is on line 451", "url": "https://github.com/dotCMS/core/pull/18478#discussion_r423915758", "createdAt": "2020-05-12T17:39:49Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/security/apps/AppsAPIImplTest.java", "diffHunk": "@@ -434,6 +439,104 @@ public void Test_Secret_Destroy_Method() {\n         }\n     }\n \n+    /**\n+     * Test computeSecretWarnings.\n+     * Given scenario: You create a secret with no value the secret is expected to be required according to the descriptor.\n+     * Expected Result: Such situation should generate a warning\n+     */\n+    @Test\n+    public void Test_Secret_Integrity_Check_Expect_Warning()\n+            throws DotDataException, DotSecurityException {\n+        final AppsAPI api = APILocator.getAppsAPI();\n+\n+        final String appKey = \"any-key\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2322a4c4b2c099d3c5eeb3a6c34e670edd6f242e"}, "originalPosition": 44}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1101, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}