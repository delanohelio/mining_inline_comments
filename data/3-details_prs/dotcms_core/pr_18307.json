{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNDY4MTEx", "number": 18307, "title": "Fix method", "bodyText": "The condition was wrong. Was giving the wrong result when it shouldn't. This was breaking showing content on pages in the different modes (preview, edit, live)", "createdAt": "2020-04-14T23:48:08Z", "url": "https://github.com/dotCMS/core/pull/18307", "merged": true, "mergeCommit": {"oid": "c2caed56e76b1c708e771b88a5c9cae1fcf39867"}, "closed": true, "closedAt": "2020-04-15T21:54:22Z", "author": {"login": "dsilvam"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXsXNjgH2gAyNDAzNDY4MTExOjI3NDYxOTcwMzNkNTRlMzE3MmFlYTcxOGZjYWRjNWJlZDg1ZDE2NzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcX_S8VgFqTM5NDE2MDY4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2746197033d54e3172aea718fcadc5bed85d1672", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/2746197033d54e3172aea718fcadc5bed85d1672", "committedDate": "2020-04-14T23:47:31Z", "message": "Fix method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNDQ3MDM4", "url": "https://github.com/dotCMS/core/pull/18307#pullrequestreview-393447038", "createdAt": "2020-04-15T04:24:38Z", "commit": {"oid": "2746197033d54e3172aea718fcadc5bed85d1672"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNDoyNDozOFrOGFpTkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNDoyNDozOFrOGFpTkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODU3MjgxOA==", "bodyText": "I am wondering if this should be something like\n        return info == null || !key.mode.showLive || !UtilMethods.isSet(info.getLiveInode());\n\nAlso set final the parameters", "url": "https://github.com/dotCMS/core/pull/18307#discussion_r408572818", "createdAt": "2020-04-15T04:24:38Z", "author": {"login": "jdotcms"}, "path": "dotCMS/src/main/java/com/dotcms/rendering/velocity/services/ContentletLoader.java", "diffHunk": "@@ -581,8 +581,8 @@ public InputStream writeObject(final VelocityResourceKey key)\n \n     }\n \n-    private boolean isLiveVersionAvailable(VelocityResourceKey key, ContentletVersionInfo info) {\n-        return info != null && key.mode.showLive && UtilMethods.isSet(info.getLiveInode());\n+    private boolean isLiveVersionNotAvailable(VelocityResourceKey key, ContentletVersionInfo info) {\n+        return info == null || key.mode.showLive && !UtilMethods.isSet(info.getLiveInode());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2746197033d54e3172aea718fcadc5bed85d1672"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzODA3NDAz", "url": "https://github.com/dotCMS/core/pull/18307#pullrequestreview-393807403", "createdAt": "2020-04-15T14:05:56Z", "commit": {"oid": "2746197033d54e3172aea718fcadc5bed85d1672"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNDowNTo1NlrOGF7YeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNDoxMzoyM1rOGF7tpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODg2ODk4NA==", "bodyText": "maybe we should move this condition to a private method, this way the method name could give us more information about what it is doing here", "url": "https://github.com/dotCMS/core/pull/18307#discussion_r408868984", "createdAt": "2020-04-15T14:05:56Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/main/java/com/dotcms/rendering/velocity/services/ContentletLoader.java", "diffHunk": "@@ -561,11 +561,11 @@ public InputStream writeObject(final VelocityResourceKey key)\n         long language = new Long(key.language);\n         ContentletVersionInfo info = APILocator.getVersionableAPI().getContentletVersionInfo(key.id1, language);\n \n-        if (!isLiveVersionAvailable(key, info) && language != defaultLang && APILocator.getLanguageAPI().canDefaultContentToDefaultLanguage()) {\n+        if (isLiveVersionNotAvailable(key, info) && language != defaultLang && APILocator.getLanguageAPI().canDefaultContentToDefaultLanguage()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2746197033d54e3172aea718fcadc5bed85d1672"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODg3NDQwNw==", "bodyText": "I think we need test to these changes.", "url": "https://github.com/dotCMS/core/pull/18307#discussion_r408874407", "createdAt": "2020-04-15T14:13:23Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/main/java/com/dotcms/rendering/velocity/services/ContentletLoader.java", "diffHunk": "@@ -561,11 +561,11 @@ public InputStream writeObject(final VelocityResourceKey key)\n         long language = new Long(key.language);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2746197033d54e3172aea718fcadc5bed85d1672"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21cbf7c62efd13353840c16bfdc6170b68291d46", "author": {"user": {"login": "dsilvam", "name": "Daniel Silva"}}, "url": "https://github.com/dotCMS/core/commit/21cbf7c62efd13353840c16bfdc6170b68291d46", "committedDate": "2020-04-15T15:17:39Z", "message": "applying code-review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzODgxMDYw", "url": "https://github.com/dotCMS/core/pull/18307#pullrequestreview-393881060", "createdAt": "2020-04-15T15:21:11Z", "commit": {"oid": "21cbf7c62efd13353840c16bfdc6170b68291d46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MDg4Njgy", "url": "https://github.com/dotCMS/core/pull/18307#pullrequestreview-394088682", "createdAt": "2020-04-15T19:55:01Z", "commit": {"oid": "21cbf7c62efd13353840c16bfdc6170b68291d46"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MTYwNjgx", "url": "https://github.com/dotCMS/core/pull/18307#pullrequestreview-394160681", "createdAt": "2020-04-15T21:51:03Z", "commit": {"oid": "21cbf7c62efd13353840c16bfdc6170b68291d46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 985, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}