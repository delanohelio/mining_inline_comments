{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0NjM2NzU1", "number": 18935, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNjo1OVrOESaYHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMVrOESaYmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQxOTgzOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNjo1OVrOG3k9kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNjo1OVrOG3k9kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDQ1MA==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.dotmarketing.portlets.structure.model.ContentletRelationships'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930450", "createdAt": "2020-07-27T14:26:59Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQxOTk0OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowMFrOG3k9pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowMFrOG3k9pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDQ2OQ==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'org.junit.Assert'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930469", "createdAt": "2020-07-27T14:27:00Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMDIwOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowMlrOG3k9wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowMlrOG3k9wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDQ5OA==", "bodyText": "Codacy found an issue: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930498", "createdAt": "2020-07-27T14:27:02Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {\n+        //Setting web app environment\n+        IntegrationTestInitService.getInstance().init();\n+    }\n+\n+    /**\n+     * Method to Test: {@link BundleResource#uploadBundleSync(HttpServletRequest, HttpServletResponse, FormDataMultiPart)}\n+     *                  and {@link com.dotcms.enterprise.publishing.remote.handler.ContentHandler#handle(File, Boolean)}\n+     * When: Send a PushPublish request with two content related, and later sned another Push Publish request removing the\n+     *       relationships between this two content\n+     * Should: Clean the relationship cache\n+     */\n+    @Test\n+    public void shouldCleanRelationshipCache() throws FileNotFoundException, DotPublisherException, DotDataException, DotCacheException {\n+\n+        final File createRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/create_relationship_content.tar.gz\")\n+                .getFile());\n+\n+        final File removeRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/remove_relationship_in_content.tar.gz\")\n+                .getFile());\n+\n+        final FileInputStream createCOntentFileInputStream = new FileInputStream(createRelationshipContentBundle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMDMyOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowM1rOG3k91w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowM1rOG3k91w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDUxOQ==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.dotmarketing.portlets.rules.model.Condition'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930519", "createdAt": "2020-07-27T14:27:03Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMDM5OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNFrOG3k94w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNFrOG3k94w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDUzMQ==", "bodyText": "Codacy found an issue: A method/constructor should not explicitly throw java.lang.Exception", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930531", "createdAt": "2020-07-27T14:27:04Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMDQ4OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNVrOG3k98g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNVrOG3k98g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU0Ng==", "bodyText": "Codacy found an issue: Ensure that resources like this FileInputStream object are closed after use", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930546", "createdAt": "2020-07-27T14:27:05Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {\n+        //Setting web app environment\n+        IntegrationTestInitService.getInstance().init();\n+    }\n+\n+    /**\n+     * Method to Test: {@link BundleResource#uploadBundleSync(HttpServletRequest, HttpServletResponse, FormDataMultiPart)}\n+     *                  and {@link com.dotcms.enterprise.publishing.remote.handler.ContentHandler#handle(File, Boolean)}\n+     * When: Send a PushPublish request with two content related, and later sned another Push Publish request removing the\n+     *       relationships between this two content\n+     * Should: Clean the relationship cache\n+     */\n+    @Test\n+    public void shouldCleanRelationshipCache() throws FileNotFoundException, DotPublisherException, DotDataException, DotCacheException {\n+\n+        final File createRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/create_relationship_content.tar.gz\")\n+                .getFile());\n+\n+        final File removeRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/remove_relationship_in_content.tar.gz\")\n+                .getFile());\n+\n+        final FileInputStream createCOntentFileInputStream = new FileInputStream(createRelationshipContentBundle);\n+        final FileInputStream removeRelationshipFileInputStream = new FileInputStream(removeRelationshipContentBundle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMDU1OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNlrOG3k9_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowNlrOG3k9_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU1Nw==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.liferay.portal.model.User'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930557", "createdAt": "2020-07-27T14:27:06Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMDY4OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowN1rOG3k-EQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowN1rOG3k-EQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU3Nw==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.dotcms.util.CollectionsUtils.toImmutableList'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930577", "createdAt": "2020-07-27T14:27:07Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMDg2OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowOVrOG3k-Jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzowOVrOG3k-Jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU5OA==", "bodyText": "Codacy found an issue: Ensure that resources like this FileInputStream object are closed after use", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930598", "createdAt": "2020-07-27T14:27:09Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {\n+        //Setting web app environment\n+        IntegrationTestInitService.getInstance().init();\n+    }\n+\n+    /**\n+     * Method to Test: {@link BundleResource#uploadBundleSync(HttpServletRequest, HttpServletResponse, FormDataMultiPart)}\n+     *                  and {@link com.dotcms.enterprise.publishing.remote.handler.ContentHandler#handle(File, Boolean)}\n+     * When: Send a PushPublish request with two content related, and later sned another Push Publish request removing the\n+     *       relationships between this two content\n+     * Should: Clean the relationship cache\n+     */\n+    @Test\n+    public void shouldCleanRelationshipCache() throws FileNotFoundException, DotPublisherException, DotDataException, DotCacheException {\n+\n+        final File createRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/create_relationship_content.tar.gz\")\n+                .getFile());\n+\n+        final File removeRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/remove_relationship_in_content.tar.gz\")\n+                .getFile());\n+\n+        final FileInputStream createCOntentFileInputStream = new FileInputStream(createRelationshipContentBundle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMDk3OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMFrOG3k-PQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMFrOG3k-PQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDYyMQ==", "bodyText": "Codacy found an issue: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930621", "createdAt": "2020-07-27T14:27:10Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;\n+import com.dotmarketing.portlets.structure.model.ContentletRelationships;\n+import com.liferay.portal.model.User;\n+import com.liferay.portal.util.WebKeys;\n+import org.glassfish.jersey.media.multipart.BodyPart;\n+import org.glassfish.jersey.media.multipart.ContentDisposition;\n+import org.glassfish.jersey.media.multipart.FormDataMultiPart;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileNotFoundException;\n+\n+import static com.dotcms.util.CollectionsUtils.list;\n+import static com.dotcms.util.CollectionsUtils.toImmutableList;\n+import static org.junit.Assert.*;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class BundleResourceTest {\n+\n+    @BeforeClass\n+    public static void prepare() throws Exception {\n+        //Setting web app environment\n+        IntegrationTestInitService.getInstance().init();\n+    }\n+\n+    /**\n+     * Method to Test: {@link BundleResource#uploadBundleSync(HttpServletRequest, HttpServletResponse, FormDataMultiPart)}\n+     *                  and {@link com.dotcms.enterprise.publishing.remote.handler.ContentHandler#handle(File, Boolean)}\n+     * When: Send a PushPublish request with two content related, and later sned another Push Publish request removing the\n+     *       relationships between this two content\n+     * Should: Clean the relationship cache\n+     */\n+    @Test\n+    public void shouldCleanRelationshipCache() throws FileNotFoundException, DotPublisherException, DotDataException, DotCacheException {\n+\n+        final File createRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/create_relationship_content.tar.gz\")\n+                .getFile());\n+\n+        final File removeRelationshipContentBundle = new File(getClass().getResource(\n+                \"/bundle/relationship_push_publish/remove_relationship_in_content.tar.gz\")\n+                .getFile());\n+\n+        final FileInputStream createCOntentFileInputStream = new FileInputStream(createRelationshipContentBundle);\n+        final FileInputStream removeRelationshipFileInputStream = new FileInputStream(removeRelationshipContentBundle);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzQyMTA2OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMlrOG3k-SQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNzoxMlrOG3k-SQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDYzMw==", "bodyText": "Codacy found an issue: Avoid unused imports such as 'com.dotmarketing.portlets.rules.model.ConditionGroup'", "url": "https://github.com/dotCMS/core/pull/18935#discussion_r460930633", "createdAt": "2020-07-27T14:27:12Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/BundleResourceTest.java", "diffHunk": "@@ -0,0 +1,94 @@\n+package com.dotcms.rest;\n+\n+import com.dotcms.publisher.business.DotPublisherException;\n+import com.dotcms.util.IntegrationTestInitService;\n+import com.dotmarketing.business.APILocator;\n+import com.dotmarketing.business.CacheLocator;\n+import com.dotmarketing.business.DotCacheException;\n+import com.dotmarketing.exception.DotDataException;\n+import com.dotmarketing.portlets.contentlet.model.Contentlet;\n+import com.dotmarketing.portlets.rules.model.Condition;\n+import com.dotmarketing.portlets.rules.model.ConditionGroup;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce91b935ebc983efd0b85ca7e2fdb6670c36e290"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2065, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}