{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NjcwMTIz", "number": 19122, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODozODoyM1rOEcMh9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODo0NDowOVrOEcMqHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDAwODg3OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotmarketing/portlets/containers/ajax/ContainerAjaxDrawedTemplate.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODozODoyNFrOHGk7mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxOTo0Mzo0NlrOHGnIGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY1ODU4Nw==", "bodyText": "remove", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476658587", "createdAt": "2020-08-25T18:38:24Z", "author": {"login": "dsilvam"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/containers/ajax/ContainerAjaxDrawedTemplate.java", "diffHunk": "@@ -89,7 +90,10 @@\n                 contMap.put(\"source\", container.getSource().toString());\n                 if (container instanceof FileAssetContainer) {\n \n-                    contMap.put(\"path\", FileAssetContainer.class.cast(container).getPath());\n+                    contMap.put(\"path\",\n+                            FileAssetContainerUtil.getInstance()\n+                                    .getFullPath(FileAssetContainer.class.cast(container))\n+                    );\n                 }\n \n //                StringBuffer containerCode = new StringBuffer( cont.getCode() );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY5NDU1Mg==", "bodyText": "done dotCMS/src/main/java/com/dotmarketing/util/TaskLocatorUtil.java", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476694552", "createdAt": "2020-08-25T19:43:46Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/containers/ajax/ContainerAjaxDrawedTemplate.java", "diffHunk": "@@ -89,7 +90,10 @@\n                 contMap.put(\"source\", container.getSource().toString());\n                 if (container instanceof FileAssetContainer) {\n \n-                    contMap.put(\"path\", FileAssetContainer.class.cast(container).getPath());\n+                    contMap.put(\"path\",\n+                            FileAssetContainerUtil.getInstance()\n+                                    .getFullPath(FileAssetContainer.class.cast(container))\n+                    );\n                 }\n \n //                StringBuffer containerCode = new StringBuffer( cont.getCode() );", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY1ODU4Nw=="}, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDAxNDc0OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotmarketing/portlets/containers/business/ContainerFactory.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODo0MDowMVrOHGk_MA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxOTo0NDowMFrOHGnIjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY1OTUwNA==", "bodyText": "javadoc", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476659504", "createdAt": "2020-08-25T18:40:01Z", "author": {"login": "dsilvam"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/containers/business/ContainerFactory.java", "diffHunk": "@@ -67,6 +67,9 @@\n \t */\r\n \tList<Container> findContainers(User user, boolean includeArchived, Map<String,Object> params, String hostId, String inode, String identifier, String parent, int offset, int limit, String orderBy) throws DotSecurityException, DotDataException;\r\n \r\n+\tContainer getContainerByFolderPath(String path, Host host, User user, boolean live,\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY5NDY2OQ==", "bodyText": "done fbaded8#diff-bb0b37e225ac8347fc10ee3c512dea1bR70", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476694669", "createdAt": "2020-08-25T19:44:00Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/containers/business/ContainerFactory.java", "diffHunk": "@@ -67,6 +67,9 @@\n \t */\r\n \tList<Container> findContainers(User user, boolean includeArchived, Map<String,Object> params, String hostId, String inode, String identifier, String parent, int offset, int limit, String orderBy) throws DotSecurityException, DotDataException;\r\n \r\n+\tContainer getContainerByFolderPath(String path, Host host, User user, boolean live,\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY1OTUwNA=="}, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDAyMjAzOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotmarketing/portlets/templates/design/bean/TemplateLayout.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODo0MjowMFrOHGlDnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxOTo0NToyMlrOHGnLqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY2MDYzNg==", "bodyText": "remove", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476660636", "createdAt": "2020-08-25T18:42:00Z", "author": {"login": "dsilvam"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/templates/design/bean/TemplateLayout.java", "diffHunk": "@@ -182,11 +186,70 @@ public String toString() {\n         }\n     }\n \n-    public boolean existsContainer(final String identifier, final String uuid){\n-        return this.getContainers().stream()\n-                .anyMatch(containerUUID ->\n-                        containerUUID.getIdentifier().equals(identifier) && isTheSameUUID(containerUUID.getUUID(), uuid)\n-                );\n+    public boolean existsContainer(final Container container, final String uuid){\n+        final FileAssetContainerUtil instance = FileAssetContainerUtil.getInstance();\n+        if (instance.isFileAssetContainer(container)) {\n+            final FileAssetContainer fileAssetContainer = (FileAssetContainer) container;\n+            final String containerPath = fileAssetContainer.getPath();\n+\n+            return this.getContainers().stream()\n+                    .anyMatch((ContainerUUID containerUUID) -> {\n+                        final String relativePath = instance.isFullPath(containerUUID.getIdentifier()) ?\n+                                instance.getRelativePath(containerUUID.getIdentifier()) :\n+                                containerUUID.getIdentifier();\n+\n+                        return relativePath.equals(containerPath)\n+                                    && isTheSameUUID(containerUUID.getUUID(), uuid);\n+                    }\n+                    );\n+        } else {\n+            return this.getContainers().stream()\n+                    .anyMatch(containerUUID ->\n+                            containerUUID.getIdentifier().equals(container.getIdentifier())\n+                                    && isTheSameUUID(containerUUID.getUUID(), uuid)\n+                    );\n+        }\n+\n+\n+    }\n+\n+    @JsonIgnore\n+    @NotNull", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY5NTQ2Ng==", "bodyText": "done e02441e#diff-bf2367c305d13964ae1bcb10f2c61543L217", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476695466", "createdAt": "2020-08-25T19:45:22Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/templates/design/bean/TemplateLayout.java", "diffHunk": "@@ -182,11 +186,70 @@ public String toString() {\n         }\n     }\n \n-    public boolean existsContainer(final String identifier, final String uuid){\n-        return this.getContainers().stream()\n-                .anyMatch(containerUUID ->\n-                        containerUUID.getIdentifier().equals(identifier) && isTheSameUUID(containerUUID.getUUID(), uuid)\n-                );\n+    public boolean existsContainer(final Container container, final String uuid){\n+        final FileAssetContainerUtil instance = FileAssetContainerUtil.getInstance();\n+        if (instance.isFileAssetContainer(container)) {\n+            final FileAssetContainer fileAssetContainer = (FileAssetContainer) container;\n+            final String containerPath = fileAssetContainer.getPath();\n+\n+            return this.getContainers().stream()\n+                    .anyMatch((ContainerUUID containerUUID) -> {\n+                        final String relativePath = instance.isFullPath(containerUUID.getIdentifier()) ?\n+                                instance.getRelativePath(containerUUID.getIdentifier()) :\n+                                containerUUID.getIdentifier();\n+\n+                        return relativePath.equals(containerPath)\n+                                    && isTheSameUUID(containerUUID.getUUID(), uuid);\n+                    }\n+                    );\n+        } else {\n+            return this.getContainers().stream()\n+                    .anyMatch(containerUUID ->\n+                            containerUUID.getIdentifier().equals(container.getIdentifier())\n+                                    && isTheSameUUID(containerUUID.getUUID(), uuid)\n+                    );\n+        }\n+\n+\n+    }\n+\n+    @JsonIgnore\n+    @NotNull", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY2MDYzNg=="}, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDAyMzQ1OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotmarketing/portlets/templates/design/bean/TemplateLayout.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODo0MjoyM1rOHGlEfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxOTo0NDoxN1rOHGnJMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY2MDg2MA==", "bodyText": "javadoc", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476660860", "createdAt": "2020-08-25T18:42:23Z", "author": {"login": "dsilvam"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/templates/design/bean/TemplateLayout.java", "diffHunk": "@@ -182,11 +186,70 @@ public String toString() {\n         }\n     }\n \n-    public boolean existsContainer(final String identifier, final String uuid){\n-        return this.getContainers().stream()\n-                .anyMatch(containerUUID ->\n-                        containerUUID.getIdentifier().equals(identifier) && isTheSameUUID(containerUUID.getUUID(), uuid)\n-                );\n+    public boolean existsContainer(final Container container, final String uuid){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY5NDgzNA==", "bodyText": "done fbaded8#diff-bf2367c305d13964ae1bcb10f2c61543R188", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476694834", "createdAt": "2020-08-25T19:44:17Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/templates/design/bean/TemplateLayout.java", "diffHunk": "@@ -182,11 +186,70 @@ public String toString() {\n         }\n     }\n \n-    public boolean existsContainer(final String identifier, final String uuid){\n-        return this.getContainers().stream()\n-                .anyMatch(containerUUID ->\n-                        containerUUID.getIdentifier().equals(identifier) && isTheSameUUID(containerUUID.getUUID(), uuid)\n-                );\n+    public boolean existsContainer(final Container container, final String uuid){", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY2MDg2MA=="}, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDAyOTcyOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotmarketing/util/TaskLocatorUtil.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODo0NDowOVrOHGlIdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxOTo0NDoyOVrOHGnJng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY2MTg3OA==", "bodyText": "put at the end and naming according to the last task", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476661878", "createdAt": "2020-08-25T18:44:09Z", "author": {"login": "dsilvam"}, "path": "dotCMS/src/main/java/com/dotmarketing/util/TaskLocatorUtil.java", "diffHunk": "@@ -282,6 +282,7 @@ public static void removeFixTask(Class<?> clazz){\n         .add(Task05300UpdateIndexNameLength.class)\n         .add(Task05305AddPushPublishFilterColumn.class)\n \t\t.add(Task05350AddDotSaltClusterColumn.class)\n+\t\t.add(Task05370ChangeContainerPathToAbsolute.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY5NDk0Mg==", "bodyText": "done fbaded8#diff-a5f6335b9d67b8de8cbdc378cbe131a4R286", "url": "https://github.com/dotCMS/core/pull/19122#discussion_r476694942", "createdAt": "2020-08-25T19:44:29Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/main/java/com/dotmarketing/util/TaskLocatorUtil.java", "diffHunk": "@@ -282,6 +282,7 @@ public static void removeFixTask(Class<?> clazz){\n         .add(Task05300UpdateIndexNameLength.class)\n         .add(Task05305AddPushPublishFilterColumn.class)\n \t\t.add(Task05350AddDotSaltClusterColumn.class)\n+\t\t.add(Task05370ChangeContainerPathToAbsolute.class)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY2MTg3OA=="}, "originalCommit": {"oid": "2668c671ae267e820314e53ae2bc436d142ee87e"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1987, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}