{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NTA2MTAw", "number": 18134, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQyMjo0MTowNlrODnqQAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNzoyNTowN1rODn6kKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyOTEzMjgzOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/index/ESIndexResource.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQyMjo0MTowNlrOF1yU-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNDo0ODo0NlrOF2Gh1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk0MzQxOA==", "bodyText": "I think we should remove this catch also and let the Mappers catch these Exceptions", "url": "https://github.com/dotCMS/core/pull/18134#discussion_r391943418", "createdAt": "2020-03-12T22:41:06Z", "author": {"login": "freddyucv"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/index/ESIndexResource.java", "diffHunk": "@@ -484,15 +484,18 @@ public Response getActive(@Context HttpServletRequest httpServletRequest, @Conte\n     @Path(\"/docscount/{params:.*}\")\n     @Produces(\"text/plain\")\n     public Response getDocumentCount(@Context HttpServletRequest httpServletRequest, @Context final HttpServletResponse httpServletResponse, @PathParam(\"params\") String params) {\n+\n+        InitDataObject init= null;\n         try {\n-            InitDataObject init=auth(params,httpServletRequest, httpServletResponse);\n+            init = auth(params,httpServletRequest, httpServletResponse);\n \n             //Creating an utility response object\n             ResourceResponse responseResource = new ResourceResponse( init.getParamsMap() );\n \n             String indexName = this.indexHelper.getIndexNameOrAlias(init.getParamsMap(),\"index\",\"alias\",this.indexAPI);\n             return responseResource.response( Long.toString( indexDocumentCount( indexName ) ) );\n-        } catch (Exception e) {\n+\n+        } catch (DotSecurityException | DotDataException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b28da220cacb831e557587017548be93302a7a8a"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjI3NDM4OQ==", "bodyText": "The problem with doing this is that it would change the method signature. That's why I left those 2 exceptions", "url": "https://github.com/dotCMS/core/pull/18134#discussion_r392274389", "createdAt": "2020-03-13T14:48:46Z", "author": {"login": "nollymar"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/index/ESIndexResource.java", "diffHunk": "@@ -484,15 +484,18 @@ public Response getActive(@Context HttpServletRequest httpServletRequest, @Conte\n     @Path(\"/docscount/{params:.*}\")\n     @Produces(\"text/plain\")\n     public Response getDocumentCount(@Context HttpServletRequest httpServletRequest, @Context final HttpServletResponse httpServletResponse, @PathParam(\"params\") String params) {\n+\n+        InitDataObject init= null;\n         try {\n-            InitDataObject init=auth(params,httpServletRequest, httpServletResponse);\n+            init = auth(params,httpServletRequest, httpServletResponse);\n \n             //Creating an utility response object\n             ResourceResponse responseResource = new ResourceResponse( init.getParamsMap() );\n \n             String indexName = this.indexHelper.getIndexNameOrAlias(init.getParamsMap(),\"index\",\"alias\",this.indexAPI);\n             return responseResource.response( Long.toString( indexDocumentCount( indexName ) ) );\n-        } catch (Exception e) {\n+\n+        } catch (DotSecurityException | DotDataException e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk0MzQxOA=="}, "originalCommit": {"oid": "b28da220cacb831e557587017548be93302a7a8a"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMTgwNTg1OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/main/java/com/dotcms/rest/exception/mapper/ElasticsearchStatusExceptionMapper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNzoyNTowN1rOF2MScA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNzoyNTowN1rOF2MScA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM2ODc1Mg==", "bodyText": "I think the fall back should be INTERNAL_SERVER_ERROR", "url": "https://github.com/dotCMS/core/pull/18134#discussion_r392368752", "createdAt": "2020-03-13T17:25:07Z", "author": {"login": "dsilvam"}, "path": "dotCMS/src/main/java/com/dotcms/rest/exception/mapper/ElasticsearchStatusExceptionMapper.java", "diffHunk": "@@ -0,0 +1,29 @@\n+package com.dotcms.rest.exception.mapper;\n+\n+import com.dotmarketing.util.Logger;\n+import javax.ws.rs.core.Response;\n+import javax.ws.rs.core.Response.Status;\n+import org.elasticsearch.ElasticsearchStatusException;\n+import javax.ws.rs.ext.ExceptionMapper;\n+\n+public class ElasticsearchStatusExceptionMapper implements ExceptionMapper<ElasticsearchStatusException> {\n+\n+\n+    @Override\n+    public Response toResponse(ElasticsearchStatusException exception) {\n+\n+        //Log into our logs first.\n+        Logger.warn(this.getClass(), exception.getMessage(), exception);\n+\n+        //Create the message.\n+        String message = exception.getMessage();\n+\n+        //Creating the message in JSON format.\n+        String entity = ExceptionMapperUtil.getJsonErrorAsString(message);\n+\n+        //Return 4xx message to the client.\n+        return ExceptionMapperUtil.createResponse(entity, message,\n+                message.contains(\"index_not_found_exception\") ? Status.NOT_FOUND\n+                        : Status.BAD_REQUEST);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b28da220cacb831e557587017548be93302a7a8a"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2373, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}