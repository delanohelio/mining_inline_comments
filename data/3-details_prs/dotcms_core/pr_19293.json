{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNTU0MzYw", "number": 19293, "title": "#19291 unifying the 3 quartz schedulers", "bodyText": "To see the tests.\nThis is meant to simplify quartz where we're removing repetitive schedulers there were adding up a pool of unnecessary threads.\nit is coupled with an enterprise PR dotCMS/enterprise#753", "createdAt": "2020-09-21T20:54:35Z", "url": "https://github.com/dotCMS/core/pull/19293", "merged": true, "mergeCommit": {"oid": "999036092e9a72f1c54217d85351d5610b4b728a"}, "closed": true, "closedAt": "2020-10-12T19:43:08Z", "author": {"login": "wezell"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLJuipgH2gAyNDkwNTU0MzYwOmMwMTUwNzZlODY1YzdhNzhkYTBjMDBkNWYzNTU3ZmY2NzYyNGFkZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdR3BcNAFqTUwNjc4MzA0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c015076e865c7a78da0c00d5f3557ff67624ade3", "author": {"user": {"login": "wezell", "name": "Will Ezell"}}, "url": "https://github.com/dotCMS/core/commit/c015076e865c7a78da0c00d5f3557ff67624ade3", "committedDate": "2020-09-21T20:50:23Z", "message": "#19291 unifying the 3 quartz schedulers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b32e535aebe296ab8fb68902d9cc7e7f5ef61dda", "author": {"user": {"login": "wezell", "name": "Will Ezell"}}, "url": "https://github.com/dotCMS/core/commit/b32e535aebe296ab8fb68902d9cc7e7f5ef61dda", "committedDate": "2020-09-21T21:24:15Z", "message": "#19291 adding jobs tab to maintenance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64826a3621add39429055c714eee386ea329f67d", "author": {"user": {"login": "wezell", "name": "Will Ezell"}}, "url": "https://github.com/dotCMS/core/commit/64826a3621add39429055c714eee386ea329f67d", "committedDate": "2020-09-21T21:27:14Z", "message": "#19291 adding jobs tab to maintenance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece", "author": {"user": {"login": "wezell", "name": "Will Ezell"}}, "url": "https://github.com/dotCMS/core/commit/81625a76c6f658ee3bc30a2a533877aea73e4ece", "committedDate": "2020-09-23T13:37:18Z", "message": "merge master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2NjcxMzg5", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-496671389", "createdAt": "2020-09-25T18:34:24Z", "commit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxODozNDoyNFrOHYOcTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxODozNDoyNFrOHYOcTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTE2NDQ5Mw==", "bodyText": "Nitpick: Do we still need to name it sequentialScheduler?", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r495164493", "createdAt": "2020-09-25T18:34:24Z", "author": {"login": "victoralfaro-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotmarketing/quartz/DotStatefulJobTest.java", "diffHunk": "@@ -110,7 +110,7 @@ public void Test_Launch_Stateful_Jobs_Verify_They_Dont_Overlap_In_Time()\n     private Optional<JobExecutionContext> getJobExecutionContext(){\n         final String jobName = getJobName(MyStatefulJob.class);\n         try {\n-            final Scheduler sequentialScheduler = getSequentialScheduler();\n+            final Scheduler sequentialScheduler = DotSchedulerFactory.getInstance().getScheduler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2Njg1Mzc4", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-496685378", "createdAt": "2020-09-25T18:44:14Z", "commit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxODo0NDoxNFrOHYOvVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxODo0NDoxNFrOHYOvVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTE2OTM2NA==", "bodyText": "Above there are references to QuartzUtils.getScheduler() (https://github.com/dotCMS/core/pull/19293/files#diff-27537b844a5f2b5de0edbbe49ef2bbb4R71). I wonder if they are the same and i f they are, we should pick one.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r495169364", "createdAt": "2020-09-25T18:44:14Z", "author": {"login": "victoralfaro-dotcms"}, "path": "dotCMS/src/main/java/com/dotmarketing/init/DotInitScheduler.java", "diffHunk": "@@ -755,7 +550,7 @@ private static void addSystemEventsJob () {\n \t */\r\n \tprivate static void scheduleJob(final JobBuilder jobBuilder) {\r\n \t\ttry {\r\n-\t\t\tScheduler sched = QuartzUtils.getStandardScheduler();\r\n+\t\t\tScheduler sched = DotSchedulerFactory.getInstance().getScheduler();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 361}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2NjkwMjIw", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-496690220", "createdAt": "2020-09-25T18:47:03Z", "commit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxODo0NzowM1rOHYO0yA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxODo0NzowM1rOHYO0yA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTE3MDc2MA==", "bodyText": "Nitpick: return instead Arrays.asList(...)", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r495170760", "createdAt": "2020-09-25T18:47:03Z", "author": {"login": "victoralfaro-dotcms"}, "path": "dotCMS/src/main/java/com/dotmarketing/quartz/DotSchedulerFactory.java", "diffHunk": "@@ -5,107 +5,67 @@\n import java.util.Collection;\n import java.util.List;\n import java.util.Properties;\n-\n import org.quartz.Scheduler;\n import org.quartz.SchedulerException;\n import org.quartz.SchedulerFactory;\n import org.quartz.impl.StdSchedulerFactory;\n-\n import com.dotmarketing.util.Logger;\n \n public class DotSchedulerFactory implements SchedulerFactory {\n \n-\tprivate static DotSchedulerFactory factory;\n-\t\n-\tprivate StdSchedulerFactory sequentialSchedulerFactory;\n-\tprivate StdSchedulerFactory standardSchedulerFactory;\n-\tprivate StdSchedulerFactory localSchedulerFactory;\n-\tprivate Scheduler sequentialScheduler;\n-\tprivate Scheduler standardScheduler;\n-\tprivate Scheduler localScheduler;\n-\n-\tprivate DotSchedulerFactory () throws SchedulerException {\n-\t\t\n-\t\t\tif(sequentialSchedulerFactory == null) {\n-\t\t\t\tProperties sequentialProperties = new Properties();\n-\t\t\t\ttry {\n-\t\t\t\t\tClassLoader cl = Thread.currentThread().getContextClassLoader();\n-\t\t\t\t\tsequentialProperties.load(cl.getResourceAsStream(\"quartz_sequential.properties\"));\n-\t\t\t\t} catch (IOException e) {\n-\t\t\t\t\tLogger.error(DotSchedulerFactory.class, e.getMessage(), e);\n-\t\t\t\t\tthrow new SchedulerException(e.getMessage(), e);\n-\t\t\t\t}\n-\t\t\t\tsequentialSchedulerFactory = new StdSchedulerFactory(sequentialProperties);\n-\t\t\t\tsequentialScheduler = sequentialSchedulerFactory.getScheduler();\n-\t\t\t}\n-\n-\t\t\tif(standardSchedulerFactory == null) {\n-\t\t\t\tProperties standardProperties = new Properties();\n-\t\t\t\ttry {\n-\t\t\t\t\tClassLoader cl = Thread.currentThread().getContextClassLoader();\n-\t\t\t\t\tstandardProperties.load(cl.getResourceAsStream(\"quartz.properties\"));\n-\t\t\t\t} catch (IOException e) {\n-\t\t\t\t\tLogger.error(DotSchedulerFactory.class, e.getMessage(), e);\n-\t\t\t\t\tthrow new SchedulerException(e.getMessage(), e);\n-\t\t\t\t}\n-\t\t\t\tstandardSchedulerFactory = new StdSchedulerFactory(standardProperties);\n-\t\t\t\tstandardScheduler = standardSchedulerFactory.getScheduler();\n-\t\t\t}\n-\n-        /*\n-         Local Scheduler in order to store scheduling information within memory,\n-         This mechanist is fast and lightweight, but all scheduling information is lost when the process terminates.\n-         */\n-        if ( localSchedulerFactory == null ) {\n-            Properties localProperties = new Properties();\n+    private static DotSchedulerFactory factory;\n+\n+\n+    private StdSchedulerFactory standardSchedulerFactory;\n+\n+    private Scheduler standardScheduler;\n+\n+\n+    private DotSchedulerFactory() throws SchedulerException {\n+\n+\n+        if (standardSchedulerFactory == null) {\n+            Properties standardProperties = new Properties();\n             try {\n                 ClassLoader cl = Thread.currentThread().getContextClassLoader();\n-                localProperties.load( cl.getResourceAsStream( \"quartz_local.properties\" ) );\n-            } catch ( IOException e ) {\n-                Logger.error( DotSchedulerFactory.class, e.getMessage(), e );\n-                throw new SchedulerException( e.getMessage(), e );\n+                standardProperties.load(cl.getResourceAsStream(\"quartz.properties\"));\n+            } catch (IOException e) {\n+                Logger.error(DotSchedulerFactory.class, e.getMessage(), e);\n+                throw new SchedulerException(e.getMessage(), e);\n+            }\n+            standardSchedulerFactory = new StdSchedulerFactory(standardProperties);\n+            standardScheduler = standardSchedulerFactory.getScheduler();\n+        }\n+\n+\n+    }\n+\n+    public Collection<Scheduler> getAllSchedulers() throws SchedulerException {\n+        List<Scheduler> list = new ArrayList<Scheduler>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 89}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2NzI4Nzg0", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-496728784", "createdAt": "2020-09-25T19:17:42Z", "commit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxOToxNzo0MlrOHYPrpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxOToxNzo0MlrOHYPrpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTE4NDgwNQ==", "bodyText": "@wezell when this gets merge you will notice a new isJobRunning() method here: 704c8c6#diff-834b3711e1888aa36bedbb65f457e411R870", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r495184805", "createdAt": "2020-09-25T19:17:42Z", "author": {"login": "victoralfaro-dotcms"}, "path": "dotCMS/src/main/java/com/dotmarketing/quartz/QuartzUtils.java", "diffHunk": "@@ -775,79 +616,23 @@ public static void startSchedulers () throws SchedulerException {\n \t\tlong start = System.currentTimeMillis();\r\n \t\tScheduler sched = DotSchedulerFactory.getInstance().getScheduler();\r\n \t\tsched.start();\r\n-\t\tsched = DotSchedulerFactory.getInstance().getSequentialScheduler();\r\n-\t\tsched.start();\r\n+\r\n \t\tSystem.setProperty(WebKeys.DOTCMS_STARTUP_TIME_QUARTZ, String.valueOf(System.currentTimeMillis() - start));\r\n \t}\r\n \t\r\n-\t/**\r\n-\t * Temporarily pauses all schedulers from executing future triggers\r\n-\t * @throws SchedulerException \r\n-\t */\r\n-\tpublic static void startStandardSchedulers () throws SchedulerException {\r\n-\t\tScheduler sched = DotSchedulerFactory.getInstance().getScheduler();\r\n-\t\tsched.start();\r\n-\t}\r\n \r\n-\t/**\r\n-\t * Temporarily pauses all schedulers from executing future triggers\r\n-\t * @throws SchedulerException \r\n-\t */\r\n-\tpublic static void startSequentialSchedulers () throws SchedulerException {\r\n-\t\tScheduler sched = DotSchedulerFactory.getInstance().getSequentialScheduler();\r\n-\t\tsched.start();\r\n-\t}\r\n \r\n-    /**\r\n-     * Starts the local quartz scheduler\r\n-     *\r\n-     * @throws SchedulerException\r\n-     */\r\n-    public static void startLocalScheduler () throws SchedulerException {\r\n-        Scheduler localScheduler = DotSchedulerFactory.getInstance().getLocalScheduler();\r\n-        localScheduler.start();\r\n-    }\r\n+\t\r\n+\tpublic static boolean isJobRunning(String jobName, String jobGroup) throws SchedulerException{\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 428}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3Njc0Nzgw", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-497674780", "createdAt": "2020-09-28T15:58:13Z", "commit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNTo1ODoxM1rOHZFLkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNzo0MzowNFrOHZJF4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA2MTMyOA==", "bodyText": "if we're unifying all schedulers then let's use the QuartzUtils.getScheduler() instead of the Factory\nSame thing internally for the class  QuartzUtils let's replace DotSchedulerFactory.getInstance().getScheduler(); by getScheduler();", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496061328", "createdAt": "2020-09-28T15:58:13Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotcms/publisher/business/PublisherAPIImpl.java", "diffHunk": "@@ -308,7 +309,7 @@ private void sendQueueElements (final String bundleId) {\n     @Override\n     public void firePublisherQueueNow(Map<String, Object> dataMap){\n \t\ttry {\n-\t\t    Scheduler sched = QuartzUtils.getStandardScheduler();\n+\t\t    Scheduler sched = DotSchedulerFactory.getInstance().getScheduler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA2MTg0NQ==", "bodyText": "same.. let's use QuartzUtils.getScheduler() instead", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496061845", "createdAt": "2020-09-28T15:59:02Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotcms/publisher/pusher/PushPublisher.java", "diffHunk": "@@ -460,7 +461,7 @@ private Client getRestClient() {\n \t */\n \tprivate void updateJobDataMap(DeliveryStrategy deliveryStrategy) {\n \t\ttry {\n-\t\t\tScheduler sched = QuartzUtils.getStandardScheduler();\n+\t\t\tScheduler sched = DotSchedulerFactory.getInstance().getScheduler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA2MzI3Mg==", "bodyText": "let's use QuartzUtils.getScheduler() instead.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496063272", "createdAt": "2020-09-28T16:01:03Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/init/DotInitScheduler.java", "diffHunk": "@@ -90,49 +76,14 @@ public static ScheduledThreadPoolExecutor getScheduledThreadPoolExecutor() {\n \t */\r\n \tpublic static void start() throws SchedulerException {\r\n \t\ttry {\r\n-\t\t\tScheduler sched = QuartzUtils.getStandardScheduler();\r\n+\t\t\tfinal Scheduler sched = DotSchedulerFactory.getInstance().getScheduler();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA2NzY3NQ==", "bodyText": "I assume this is a safe move then let's Deprecate or remove the ContentReviewThread", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496067675", "createdAt": "2020-09-28T16:08:04Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/init/DotInitScheduler.java", "diffHunk": "@@ -90,49 +76,14 @@ public static ScheduledThreadPoolExecutor getScheduledThreadPoolExecutor() {\n \t */\r\n \tpublic static void start() throws SchedulerException {\r\n \t\ttry {\r\n-\t\t\tScheduler sched = QuartzUtils.getStandardScheduler();\r\n+\t\t\tfinal Scheduler sched = DotSchedulerFactory.getInstance().getScheduler();\r\n \t\t\tJobDetail job;\r\n \t\t\tCronTrigger trigger;\r\n \t\t\tCalendar calendar;\r\n \t\t\tboolean isNew;\r\n \r\n-\t\t        if(Config.getBooleanProperty(\"ENABLE_CONTENT_REVIEW_THREAD\")) {\r\n-\t\t\t\ttry {\r\n-\t\t\t\t\tisNew = false;\r\n-\r\n-\t\t\t\t\ttry {\r\n-\t\t\t\t\t\tif ((job = sched.getJobDetail(\"ContentReviewJob\", DOTCMS_JOB_GROUP_NAME)) == null) {\r\n-\t\t\t\t\t\t\tjob = new JobDetail(\"ContentReviewJob\", DOTCMS_JOB_GROUP_NAME, ContentReviewThread.class);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA2ODQyOA==", "bodyText": "Same here. let's remove or deprecate the CalendarReminderThread", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496068428", "createdAt": "2020-09-28T16:09:18Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/init/DotInitScheduler.java", "diffHunk": "@@ -182,44 +133,6 @@ public static void start() throws SchedulerException {\n \t\t\t\t}\r\n \t\t\t}\r\n \r\n-\t\t\t//Calendar Reminder Job\r\n-\r\n-\t\t\tif(Config.getBooleanProperty(\"CALENDAR_REMINDER_THREAD\")) {\r\n-\t\t\t\ttry {\r\n-\t\t\t\t\tisNew = false;\r\n-\r\n-\t\t\t\t\ttry {\r\n-\t\t\t\t\t\tif ((job = sched.getJobDetail(\"CalendarReminderJob\", DOTCMS_JOB_GROUP_NAME)) == null) {\r\n-\t\t\t\t\t\t\tjob = new JobDetail(\"CalendarReminderJob\", DOTCMS_JOB_GROUP_NAME, CalendarReminderThread.class);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 116}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA2OTk3NQ==", "bodyText": "let's use the new QuartzUtils.getScheduler();", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496069975", "createdAt": "2020-09-28T16:11:37Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/init/DotInitScheduler.java", "diffHunk": "@@ -755,7 +550,7 @@ private static void addSystemEventsJob () {\n \t */\r\n \tprivate static void scheduleJob(final JobBuilder jobBuilder) {\r\n \t\ttry {\r\n-\t\t\tScheduler sched = QuartzUtils.getStandardScheduler();\r\n+\t\t\tScheduler sched = DotSchedulerFactory.getInstance().getScheduler();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 361}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA3MDU2NA==", "bodyText": "use QuartzUtils.getScheduler(); instead of the factory itself.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496070564", "createdAt": "2020-09-28T16:12:33Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/UpdateContainersPathsJob.java", "diffHunk": "@@ -62,7 +63,7 @@ public void run(final JobExecutionContext jobContext) throws JobExecutionExcepti\n             throw new JobExecutionException(e);\n         } finally {\n             try {\n-                QuartzUtils.getSequentialScheduler().unscheduleJob(\n+                DotSchedulerFactory.getInstance().getScheduler().unscheduleJob(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA3MTAxMQ==", "bodyText": "use QuartzUtils.getScheduler(); instead of the factory itself.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496071011", "createdAt": "2020-09-28T16:13:16Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/UpdateContainersPathsJob.java", "diffHunk": "@@ -130,7 +131,7 @@ public static void triggerUpdateContainersPathsJob(final String oldHostName, fin\n         );\n \n         try {\n-            Scheduler scheduler = QuartzUtils.getSequentialScheduler();\n+            Scheduler scheduler = DotSchedulerFactory.getInstance().getScheduler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA3MTEyNw==", "bodyText": "use QuartzUtils.getScheduler(); instead of the factory itself.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496071127", "createdAt": "2020-09-28T16:13:27Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/linkchecker/ajax/LinkCheckerAjaxAction.java", "diffHunk": "@@ -120,7 +121,7 @@ public void runCheckNow(HttpServletRequest request, HttpServletResponse response\n             \n             Trigger trigger=new SimpleTrigger(\"linkCheckerTrigger-\"+randomID, \"group20\", new Date());\n             \n-            Scheduler sched = QuartzUtils.getStandardScheduler();\n+            Scheduler sched = DotSchedulerFactory.getInstance().getScheduler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA3MTI5Mw==", "bodyText": "use QuartzUtils.getScheduler(); instead of the factory itself.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496071293", "createdAt": "2020-09-28T16:13:45Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/scheduler/action/ViewSchedulersAction.java", "diffHunk": "@@ -61,14 +62,14 @@ public ActionForward render(\n \t\t\tString group2 = \"Recurrent Campaign\";\n \t\t\tMap<String,List<String>> results = new HashMap<String,List<String>>();\n \t\t\tList<String> list = new ArrayList<String>();\n-\t\t\tString[] tasks =  QuartzUtils.getStandardScheduler().getJobNames(group);\n+\t\t\tString[] tasks =  DotSchedulerFactory.getInstance().getScheduler().getJobNames(group);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA3MTM4MA==", "bodyText": "use QuartzUtils.getScheduler(); instead of the factory itself.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496071380", "createdAt": "2020-09-28T16:13:53Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/portlets/scheduler/action/ViewSchedulersAction.java", "diffHunk": "@@ -61,14 +62,14 @@ public ActionForward render(\n \t\t\tString group2 = \"Recurrent Campaign\";\n \t\t\tMap<String,List<String>> results = new HashMap<String,List<String>>();\n \t\t\tList<String> list = new ArrayList<String>();\n-\t\t\tString[] tasks =  QuartzUtils.getStandardScheduler().getJobNames(group);\n+\t\t\tString[] tasks =  DotSchedulerFactory.getInstance().getScheduler().getJobNames(group);\n \t\t\tfor(String task : tasks){\n \t\t\t\tlist.add(task);\n \t\t\t}\n \t\t\tresults.put(group, list);\n \t\t\t\n \t\t\tList<String> list2 = new ArrayList<String>();\n-\t\t\tString[] tasks2 =  QuartzUtils.getStandardScheduler().getJobNames(group2);\n+\t\t\tString[] tasks2 =  DotSchedulerFactory.getInstance().getScheduler().getJobNames(group2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA3Mzk4OQ==", "bodyText": "use QuartzUtils.getScheduler(); instead of the factory itself.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496073989", "createdAt": "2020-09-28T16:17:45Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/quartz/DotStatefulJob.java", "diffHunk": "@@ -82,7 +82,7 @@ static String getTriggerGroupName(final Class<? extends StatefulJob> jobClass) {\n     private static Optional<Map<String, Object>> getTriggerJobDetail(final String jobName,\n             final String groupName) {\n         final JobDetail jobDetail = Try\n-                .of(() -> QuartzUtils.getSequentialScheduler().getJobDetail(jobName, groupName))\n+                .of(() -> DotSchedulerFactory.getInstance().getScheduler().getJobDetail(jobName, groupName))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA4ODMyMQ==", "bodyText": "I had my doubts but it looks like the Standart and Sequential are exchangeable after all", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496088321", "createdAt": "2020-09-28T16:40:27Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/quartz/DotSchedulerFactory.java", "diffHunk": "@@ -5,107 +5,67 @@\n import java.util.Collection;\n import java.util.List;\n import java.util.Properties;\n-\n import org.quartz.Scheduler;\n import org.quartz.SchedulerException;\n import org.quartz.SchedulerFactory;\n import org.quartz.impl.StdSchedulerFactory;\n-\n import com.dotmarketing.util.Logger;\n \n public class DotSchedulerFactory implements SchedulerFactory {\n \n-\tprivate static DotSchedulerFactory factory;\n-\t\n-\tprivate StdSchedulerFactory sequentialSchedulerFactory;\n-\tprivate StdSchedulerFactory standardSchedulerFactory;\n-\tprivate StdSchedulerFactory localSchedulerFactory;\n-\tprivate Scheduler sequentialScheduler;\n-\tprivate Scheduler standardScheduler;\n-\tprivate Scheduler localScheduler;\n-\n-\tprivate DotSchedulerFactory () throws SchedulerException {\n-\t\t\n-\t\t\tif(sequentialSchedulerFactory == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjEwNjg0Ng==", "bodyText": "Theoretically this class CronScheduledTask has a param that should instruct before what scheduler needed to be used. Sequential/Standart maybe that param  and the getter should be removed or at least marked deprecated", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496106846", "createdAt": "2020-09-28T17:09:51Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/integration-test/java/com/dotmarketing/quartz/DotStatefulJobTest.java", "diffHunk": "@@ -110,7 +110,7 @@ public void Test_Launch_Stateful_Jobs_Verify_They_Dont_Overlap_In_Time()\n     private Optional<JobExecutionContext> getJobExecutionContext(){\n         final String jobName = getJobName(MyStatefulJob.class);\n         try {\n-            final Scheduler sequentialScheduler = getSequentialScheduler();\n+            final Scheduler sequentialScheduler = DotSchedulerFactory.getInstance().getScheduler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjEyNTQxMA==", "bodyText": "I get a java.lang.NoSuchMethodError: com.dotmarketing.quartz.QuartzUtils.getStandardScheduledTasks from site search on this branch", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r496125410", "createdAt": "2020-09-28T17:43:04Z", "author": {"login": "fabrizzio-dotCMS"}, "path": "dotCMS/src/main/java/com/dotmarketing/quartz/QuartzUtils.java", "diffHunk": "@@ -40,29 +37,7 @@\n \t\r\n \tprivate static Map<String, TaskRuntimeValues> runtimeTaskValues = new HashMap<String, TaskRuntimeValues>();\r\n \t\r\n-\t/**\r\n-\t * \r\n-\t * Lists all jobs scheduled through the sequential scheduler, the sequential scheduler\r\n-\t * let you run only one job at a time\r\n-\t * \r\n-\t * @return\r\n-\t */\r\n-\tpublic static List<ScheduledTask> getSequentialScheduledTasks() throws SchedulerException {\r\n-\t\tScheduler sched = DotSchedulerFactory.getInstance().getSequentialScheduler();\r\n-\t\treturn getScheduledTasks(sched, true, null);\r\n-\t}\r\n-\t\r\n-\t/**\r\n-\t * \r\n-\t * Lists all jobs scheduled through the standard scheduler, the standard scheduler\r\n-\t * let you run multiple jobs in parallel\r\n-\t * \r\n-\t * @return\r\n-\t */\r\n-\tpublic static List<ScheduledTask> getStandardScheduledTasks() throws SchedulerException {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81625a76c6f658ee3bc30a2a533877aea73e4ece"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dce21feadbf659cf636d1323a677f9fbf6d53827", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/dce21feadbf659cf636d1323a677f9fbf6d53827", "committedDate": "2020-10-09T03:01:49Z", "message": "#19291  quartz simplified clean-up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55bd231c53e948d0f047ce39d46bc7be3bd9d7b2", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/55bd231c53e948d0f047ce39d46bc7be3bd9d7b2", "committedDate": "2020-10-09T03:43:12Z", "message": "#19291 code bot feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dddc785d8e6aa85f30a863e37091bbec8731aa51", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/dddc785d8e6aa85f30a863e37091bbec8731aa51", "committedDate": "2020-10-09T03:51:23Z", "message": "#19291 more feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe7ca2793274c16620f73dca33126942869ee543", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/fe7ca2793274c16620f73dca33126942869ee543", "committedDate": "2020-10-09T04:08:19Z", "message": "#19291 more feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "114551a154cec4bcb99d9663890828935a3939b0", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/114551a154cec4bcb99d9663890828935a3939b0", "committedDate": "2020-10-09T04:24:14Z", "message": "#19291 more feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MzU2MjE0", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-505356214", "createdAt": "2020-10-09T04:29:42Z", "commit": {"oid": "114551a154cec4bcb99d9663890828935a3939b0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1Nzk0MDQw", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-505794040", "createdAt": "2020-10-09T15:46:58Z", "commit": {"oid": "114551a154cec4bcb99d9663890828935a3939b0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MDExNjQx", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-506011641", "createdAt": "2020-10-09T22:07:10Z", "commit": {"oid": "114551a154cec4bcb99d9663890828935a3939b0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c24f2f5346d934ee75ace186c57a086d1c0c5caf", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/c24f2f5346d934ee75ace186c57a086d1c0c5caf", "committedDate": "2020-10-12T15:06:38Z", "message": "#19291 solve conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "059013dd543887dd39f2c4af32b584bbbbdfbab1", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/059013dd543887dd39f2c4af32b584bbbbdfbab1", "committedDate": "2020-10-12T16:50:42Z", "message": "Merge branch 'master' into issue-19291-quartz-simpler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NzgzMDEw", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-506783010", "createdAt": "2020-10-12T17:00:15Z", "commit": {"oid": "059013dd543887dd39f2c4af32b584bbbbdfbab1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzowMDoxNVrOHgGghw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzowMDoxNVrOHgGghw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyMzExMQ==", "bodyText": "Codacy found an issue: Do not use an attribute called class.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r503423111", "createdAt": "2020-10-12T17:00:15Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/webapp/html/portlet/ext/cmsmaintenance/system_jobs.jsp", "diffHunk": "@@ -0,0 +1,86 @@\n+<%@page import=\"com.dotcms.repackage.javax.portlet.WindowState\"%>\n+<%@page import=\"com.liferay.portal.util.Constants\"%>\n+<%@page import=\"com.liferay.portal.language.LanguageUtil\"%>\n+<%@page import=\"org.quartz.CronTrigger\"%>\n+<%@page import=\"java.text.SimpleDateFormat\"%>\n+<%@page import=\"java.text.DateFormat\"%>\n+<%@page import=\"org.quartz.Trigger\"%>\n+<%@page import=\"org.quartz.JobDetail\"%>\n+<%@page import=\"java.util.Set\"%>\n+<%@page import=\"com.dotmarketing.quartz.ScheduledTask\"%>\n+<%@page import=\"com.dotmarketing.quartz.QuartzUtils\"%>\n+<%@page import=\"java.util.Date\"%>\n+<%@page import=\"java.util.ArrayList\"%>\n+<%@page import=\"java.util.Arrays\"%>\n+<%@page import=\"java.util.List\"%>\n+<%@page import=\"com.dotmarketing.business.APILocator\"%>\n+<%@ page import=\"com.dotmarketing.util.UtilMethods\" %>\n+<%@ page import=\"com.dotmarketing.beans.Host\" %>\n+<%@ page import=\"com.dotmarketing.business.web.WebAPILocator\"%>\n+\n+<%@ include file=\"/html/common/uservalidation.jsp\"%>\n+\n+<%String[] groups = QuartzUtils.getScheduler().getJobGroupNames(); %>\n+<table class=\"listingTable\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "059013dd543887dd39f2c4af32b584bbbbdfbab1"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NzgzMDMw", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-506783030", "createdAt": "2020-10-12T17:00:16Z", "commit": {"oid": "059013dd543887dd39f2c4af32b584bbbbdfbab1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzowMDoxNlrOHgGglA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzowMDoxNlrOHgGglA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyMzEyNA==", "bodyText": "Codacy found an issue: Do not use an attribute called class.", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r503423124", "createdAt": "2020-10-12T17:00:16Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/webapp/html/portlet/ext/cmsmaintenance/system_jobs.jsp", "diffHunk": "@@ -0,0 +1,86 @@\n+<%@page import=\"com.dotcms.repackage.javax.portlet.WindowState\"%>\n+<%@page import=\"com.liferay.portal.util.Constants\"%>\n+<%@page import=\"com.liferay.portal.language.LanguageUtil\"%>\n+<%@page import=\"org.quartz.CronTrigger\"%>\n+<%@page import=\"java.text.SimpleDateFormat\"%>\n+<%@page import=\"java.text.DateFormat\"%>\n+<%@page import=\"org.quartz.Trigger\"%>\n+<%@page import=\"org.quartz.JobDetail\"%>\n+<%@page import=\"java.util.Set\"%>\n+<%@page import=\"com.dotmarketing.quartz.ScheduledTask\"%>\n+<%@page import=\"com.dotmarketing.quartz.QuartzUtils\"%>\n+<%@page import=\"java.util.Date\"%>\n+<%@page import=\"java.util.ArrayList\"%>\n+<%@page import=\"java.util.Arrays\"%>\n+<%@page import=\"java.util.List\"%>\n+<%@page import=\"com.dotmarketing.business.APILocator\"%>\n+<%@ page import=\"com.dotmarketing.util.UtilMethods\" %>\n+<%@ page import=\"com.dotmarketing.beans.Host\" %>\n+<%@ page import=\"com.dotmarketing.business.web.WebAPILocator\"%>\n+\n+<%@ include file=\"/html/common/uservalidation.jsp\"%>\n+\n+<%String[] groups = QuartzUtils.getScheduler().getJobGroupNames(); %>\n+<table class=\"listingTable\">\n+    <tr>\n+        <th><%= LanguageUtil.get(pageContext, \"scheduler.job.class\") %></th>\n+        <th><%= LanguageUtil.get(pageContext, \"group\") %></th>\n+        <th><%= LanguageUtil.get(pageContext, \"scheduler.job.durable\") %></th>\n+        <th><%= LanguageUtil.get(pageContext, \"scheduler.job.stateful\") %></th>\n+        <th><%= LanguageUtil.get(pageContext, \"scheduler.job.sequential\") %></th>\n+        <th><%= LanguageUtil.get(pageContext, \"scheduler.job.runsAt\") %></th>\n+        <th><%= LanguageUtil.get(pageContext, \"scheduler.job.misfire\") %></th>\n+    </tr>\n+\n+<%for(String myGroup : groups) {%>\n+\t<%String[] tasks =  QuartzUtils.getScheduler().getJobNames(myGroup);%>\n+    <%if(tasks.length==0){continue;}%>\n+\n+\n+\t<%for(String t : tasks){%>\n+      \t<%try{ %>\n+      \t\t<% final JobDetail detail = QuartzUtils.getScheduler().getJobDetail(t, myGroup);  %>\n+      \t\t<% Trigger[] triggers  =QuartzUtils.getScheduler().getTriggersOfJob(t, myGroup);%>\n+            <% Trigger trig  =triggers!=null && triggers.length>0? triggers[0] : null;%>\n+      \t\t<%if(trig==null)continue; %>\n+      \t\t<tr>\n+      \t\t\t<td>\n+      \t\t\t\t<%=detail.getJobClass().getSimpleName() %>\n+      \t\t\t</td>\n+               <td>\n+                    <%=myGroup %>\n+               </td>\n+      \t\t\t<td>\n+      \t\t\t\t<%=detail.isDurable() %>\n+      \t\t\t</td>\n+      \t\t\t<td>\n+      \t\t\t\t<%=detail.isStateful() %>\n+      \t\t\t</td>\n+      \t\t\t<td>\n+      \t\t\t\t<%=detail.isVolatile()%>\n+      \t\t\t</td>\n+      \t\t\t<td>\n+                    <%if(QuartzUtils.isJobRunning(detail.getName(), detail.getGroup())){ %>\n+                        Running \n+      \t\t\t\t<%}else if(trig !=null && trig.getNextFireTime()!=null){ %>\n+      \t\t\t\t\t<%=new SimpleDateFormat(\"yyyy-MM-dd 'at' HH:mm:ss  z\").format( trig.getNextFireTime()) %>\n+      \t\t\t\t<%}%>\n+      \t\t\t</td>\n+      \t\t\t<td>\n+      \t\t\t\t<%if(trig !=null){ %>\n+      \t\t\t\t\t<%if(CronTrigger.MISFIRE_INSTRUCTION_DO_NOTHING == trig.getMisfireInstruction()){ %>\n+      \t\t\t\t\t\t<%= LanguageUtil.get(pageContext, \"scheduler.job.misfire.donothing\") %>\n+      \t\t\t\t\t<%}else if(CronTrigger.MISFIRE_INSTRUCTION_FIRE_ONCE_NOW == trig.getMisfireInstruction()){ %>\n+      \t\t\t\t\t\t<%= LanguageUtil.get(pageContext, \"scheduler.job.misfire.fireOnce\") %>\n+      \t\t\t\t\t<%}%>\n+      \t\t\t\t<%} %>\n+      \t\t\t</td>\n+      \t\t</tr>\n+\t\t<%}catch(Exception e){%>\n+\t\t<tr><td><%=t%></td><td colspan=\"10\" class=\"red\"><%=LanguageUtil.get(pageContext, \"an-unexpected-error-occurred\")+\"<br/>\"+e.getMessage() %></td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "059013dd543887dd39f2c4af32b584bbbbdfbab1"}, "originalPosition": 80}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NzgzMDQw", "url": "https://github.com/dotCMS/core/pull/19293#pullrequestreview-506783040", "createdAt": "2020-10-12T17:00:17Z", "commit": {"oid": "059013dd543887dd39f2c4af32b584bbbbdfbab1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzowMDoxN1rOHgGgoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzowMDoxN1rOHgGgoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyMzEzNg==", "bodyText": "Codacy found an issue: Avoid assignments in operands", "url": "https://github.com/dotCMS/core/pull/19293#discussion_r503423136", "createdAt": "2020-10-12T17:00:17Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotmarketing/quartz/QuartzUtils.java", "diffHunk": "@@ -427,35 +439,31 @@ public static void removeTaskRuntimeValues(String jobName, String jobGroup) {\n \t * @throws ParseException \r\n \t * @throws ClassNotFoundException \r\n \t */\r\n-\tpublic static void scheduleTask(ScheduledTask job) throws SchedulerException, ParseException, ClassNotFoundException {\r\n+\tpublic static void scheduleTask(final ScheduledTask job) throws SchedulerException, ParseException, ClassNotFoundException {\r\n \r\n-\t\tScheduler sched;\r\n-\t\tif (job.isSequentialScheduled())\r\n-\t\t\tsched = DotSchedulerFactory.getInstance().getSequentialScheduler();\r\n-\t\telse\r\n-\t\t\tsched = DotSchedulerFactory.getInstance().getScheduler();\r\n+\t\tfinal Scheduler scheduler = getScheduler();\r\n \r\n \t\tJobDetail jobDetail;\r\n \t\tTrigger trigger;\r\n \t\tboolean isNew;\r\n \r\n \t\tisNew = false;\r\n \r\n-\t\tString jobName = job.getJobName();\r\n-\t\tString jobGroup = job.getJobGroup();\r\n-\t\tString triggerName = job.getTriggerName() == null ? jobName + \"_trigger\" : job.getTriggerName();\r\n-\t\tString triggerGroup = job.getTriggerGroup() == null ? jobGroup : job.getTriggerGroup();\r\n-\t\tDate startDate = job.getStartDate();\r\n-\t\tDate endDate = job.getEndDate();\r\n+\t\tfinal String jobName = job.getJobName();\r\n+\t\tfinal String jobGroup = job.getJobGroup();\r\n+\t\tfinal String triggerName = job.getTriggerName() == null ? jobName + \"_trigger\" : job.getTriggerName();\r\n+\t\tfinal String triggerGroup = job.getTriggerGroup() == null ? jobGroup : job.getTriggerGroup();\r\n+\t\tfinal Date startDate = job.getStartDate();\r\n+\t\tfinal Date endDate = job.getEndDate();\r\n \r\n-\t\tif ((jobDetail = sched.getJobDetail(jobName, jobGroup)) == null) {\r\n+\t\tif ((jobDetail = scheduler.getJobDetail(jobName, jobGroup)) == null) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "059013dd543887dd39f2c4af32b584bbbbdfbab1"}, "originalPosition": 464}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 621, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}