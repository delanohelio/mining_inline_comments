{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0ODAyOTE0", "number": 18665, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNTo0MjowNVrOEF_5Hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNTo0MjowN1rOEF_5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NzI1MTUxOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/enterprise/publishing/remote/PushPublishBundleGeneratorTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNTo0MjowNVrOGkhmtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNTo0MjowNVrOGkhmtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDk1MjUwMQ==", "bodyText": "Issue found: A method/constructor should not explicitly throw java.lang.Exception", "url": "https://github.com/dotCMS/core/pull/18665#discussion_r440952501", "createdAt": "2020-06-16T15:42:05Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/enterprise/publishing/remote/PushPublishBundleGeneratorTest.java", "diffHunk": "@@ -597,5 +605,80 @@ public void Test_GenerateBundle_PageWithTemplateDeleted_PageSuccessfullyAddedToB\n \n     }\n \n+    /**\n+     * Given Scenario: If a file asset has zero files and CONTENT_ALLOW_ZERO_LENGTH_FILES set to true,\n+     *                  we should be able to generate the bundle without issues.\n+     * ExpectedResult: The bundle should be generated without issues and the page added to the bundle.\n+     */\n+    @Test\n+    public void Test_GenerateBundle_FileAssetZeroBytes_ContentAllowZeroLengthFilesSetToTrue_Success() throws Exception {\n+        final boolean allowZeroLengthFilesDefault = Config.getBooleanProperty(\"CONTENT_ALLOW_ZERO_LENGTH_FILES\", true);\n+        try {\n+            //Set Property to True\n+            Config.setProperty(\"CONTENT_ALLOW_ZERO_LENGTH_FILES\", true);\n+            //Create Folder\n+            final Folder folder = new FolderDataGen().nextPersisted();\n+            // Create File with zero length\n+            final File file = File.createTempFile(\"testing-file\", \".vtl\");\n+            FileUtil.write(file, \"\");\n+            // Create File Asset with that file\n+            final Contentlet fileAssetShown = new FileAssetDataGen(folder, file).nextPersisted();\n+            ContentletDataGen.publish(fileAssetShown);\n+\n+            //Create bundle\n+            final Bundle bundle = createBundle(\"TestBundle\" + System.currentTimeMillis(), false,\n+                    \"\");\n+            //Add assets to the bundle\n+            PublisherAPI.getInstance()\n+                    .saveBundleAssets(Arrays.asList(fileAssetShown.getIdentifier()), bundle.getId(),\n+                            systemUser);\n+            //Generate Bundle, will return several dependencySet with the assets that will be added to the bundle\n+            final PushPublisherConfig listOfAssetsInBundle = generateBundle(bundle.getId(),\n+                    Operation.PUBLISH);\n+            Assert.assertNotNull(listOfAssetsInBundle);\n+            Assert.assertTrue(\n+                    listOfAssetsInBundle.getContentlets().contains(fileAssetShown.getIdentifier()));\n+        } finally {\n+            //Set Property to Default Value\n+            Config.setProperty(\"CONTENT_ALLOW_ZERO_LENGTH_FILES\", allowZeroLengthFilesDefault);\n+        }\n+\n+    }\n+\n+    /**\n+     * Given Scenario: If a file asset has zero bytes and CONTENT_ALLOW_ZERO_LENGTH_FILES set to false,\n+     *                    when you try to generate a bundle with that file asset it fails.\n+     * ExpectedResult: DotBundleException should be thrown when trying to generate the bundle with a file with zero bytes.\n+     */\n+    @Test (expected = DotBundleException.class)\n+    public void Test_GenerateBundle_FileAssetZeroBytes_ContentAllowZeroLengthFilesSetToFalse_DotBundleException() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd381f7a4569dcf7bb1e8c33e6ac15f2c2ceda26"}, "originalPosition": 109}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NzI1MTYyOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/enterprise/publishing/remote/PushPublishBundleGeneratorTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNTo0MjowNlrOGkhmxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNTo0MjowNlrOGkhmxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDk1MjUxNw==", "bodyText": "Issue found: A method/constructor should not explicitly throw java.lang.Exception", "url": "https://github.com/dotCMS/core/pull/18665#discussion_r440952517", "createdAt": "2020-06-16T15:42:06Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/enterprise/publishing/remote/PushPublishBundleGeneratorTest.java", "diffHunk": "@@ -597,5 +605,80 @@ public void Test_GenerateBundle_PageWithTemplateDeleted_PageSuccessfullyAddedToB\n \n     }\n \n+    /**\n+     * Given Scenario: If a file asset has zero files and CONTENT_ALLOW_ZERO_LENGTH_FILES set to true,\n+     *                  we should be able to generate the bundle without issues.\n+     * ExpectedResult: The bundle should be generated without issues and the page added to the bundle.\n+     */\n+    @Test\n+    public void Test_GenerateBundle_FileAssetZeroBytes_ContentAllowZeroLengthFilesSetToTrue_Success() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd381f7a4569dcf7bb1e8c33e6ac15f2c2ceda26"}, "originalPosition": 69}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NzI1MTc2OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotcms/enterprise/publishing/remote/PushPublishBundleGeneratorTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNTo0MjowN1rOGkhm2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNTo0MjowN1rOGkhm2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDk1MjUzNw==", "bodyText": "Issue found: The String literal \"CONTENT_ALLOW_ZERO_LENGTH_FILES\" appears 6 times in this file; the first occurrence is on line 615", "url": "https://github.com/dotCMS/core/pull/18665#discussion_r440952537", "createdAt": "2020-06-16T15:42:07Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/enterprise/publishing/remote/PushPublishBundleGeneratorTest.java", "diffHunk": "@@ -597,5 +605,80 @@ public void Test_GenerateBundle_PageWithTemplateDeleted_PageSuccessfullyAddedToB\n \n     }\n \n+    /**\n+     * Given Scenario: If a file asset has zero files and CONTENT_ALLOW_ZERO_LENGTH_FILES set to true,\n+     *                  we should be able to generate the bundle without issues.\n+     * ExpectedResult: The bundle should be generated without issues and the page added to the bundle.\n+     */\n+    @Test\n+    public void Test_GenerateBundle_FileAssetZeroBytes_ContentAllowZeroLengthFilesSetToTrue_Success() throws Exception {\n+        final boolean allowZeroLengthFilesDefault = Config.getBooleanProperty(\"CONTENT_ALLOW_ZERO_LENGTH_FILES\", true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd381f7a4569dcf7bb1e8c33e6ac15f2c2ceda26"}, "originalPosition": 70}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2159, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}