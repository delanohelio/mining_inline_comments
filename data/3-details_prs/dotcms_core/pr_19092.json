{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3NDQzMjY5", "number": 19092, "title": "Improve reindex mapping process", "bodyText": "With this change, we make sure that a put mapping request for multiple fields is processed by content type.\nAdditionally, I moved the addCustomMapping logic out of the commit listener to avoid race conditions in case the ReindexThread is executed before the addCustomMapping finishes", "createdAt": "2020-08-13T15:01:21Z", "url": "https://github.com/dotCMS/core/pull/19092", "merged": true, "mergeCommit": {"oid": "20c990f8a0a51af8a350f462f6f6a923d755c364"}, "closed": true, "closedAt": "2020-08-13T21:46:27Z", "author": {"login": "nollymar"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-hMyIgH2gAyNDY3NDQzMjY5OjA0NTdiMmFkNWRkZWU5MWY0ODBhMDQ3YjM1MTFjMWQ0MjNkMGM5OWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-nICmAH2gAyNDY3NDQzMjY5OjRjZDZiNWY0ODdlMDBkOWYxNTQwNjBjZjE3NGI3YmNiYjlkZWExYjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0457b2ad5ddee91f480a047b3511c1d423d0c99e", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/0457b2ad5ddee91f480a047b3511c1d423d0c99e", "committedDate": "2020-08-13T14:50:13Z", "message": "#19091 ESMappingUtilHelper.getInstance().addCustomMapping was moved out of the commit listener and the reindex switchover pause was increased"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04939462863df5477e83f1978c940bc696755fab", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/04939462863df5477e83f1978c940bc696755fab", "committedDate": "2020-08-13T14:52:15Z", "message": "#19091 Field mapping is executed per content type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2ODgxMzIx", "url": "https://github.com/dotCMS/core/pull/19092#pullrequestreview-466881321", "createdAt": "2020-08-13T15:36:31Z", "commit": {"oid": "04939462863df5477e83f1978c940bc696755fab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxNTozNjozMlrOHARJ5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxNTozNjozMlrOHARJ5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA0MzEwOQ==", "bodyText": "stream() method can be removed", "url": "https://github.com/dotCMS/core/pull/19092#discussion_r470043109", "createdAt": "2020-08-13T15:36:32Z", "author": {"login": "victoralfaro-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/content/elasticsearch/util/ESMappingUtilHelper.java", "diffHunk": "@@ -294,23 +295,28 @@ private void addMappingForRemainingFields(final Set<String> mappedFields,\n     private void addMappingForContentTypeIfNeeded(final ContentType contentType,\n             final Set<String> mappedFields, final String... indexes) {\n         final Map<String, JSONObject> contentTypeMapping = new HashMap();\n-        contentType.fields().stream().forEach(field-> {\n-                try {\n-                    addMappingForFieldIfNeeded(contentType, field,\n-                            mappedFields, contentTypeMapping);\n-                    putContentTypeMapping(contentType, contentTypeMapping, indexes);\n-                } catch (Exception e) {\n-                    handleInvalidCustomMappingError(\n-                            \"notification.reindexing.content.type.mapping.error\",\n-                            contentType.name(), indexes);\n-                    final String message =\n-                            \"Error updating index mapping for content type \" + contentType.name()\n-                                    + \". This custom mapping will be ignored for index(es) \" +\n-                                    Arrays.stream(indexes).collect(Collectors.joining(\",\"));\n-                    Logger.warn(ESMappingUtilHelper.class, message, e);\n+        try {\n+            contentType.fields().stream().forEach(field-> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "04939462863df5477e83f1978c940bc696755fab"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2ODkzMjIz", "url": "https://github.com/dotCMS/core/pull/19092#pullrequestreview-466893223", "createdAt": "2020-08-13T15:50:21Z", "commit": {"oid": "04939462863df5477e83f1978c940bc696755fab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f59802ad3ca5ff400b233d0946be0773a8c4e0f3", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/f59802ad3ca5ff400b233d0946be0773a8c4e0f3", "committedDate": "2020-08-13T15:53:47Z", "message": "#19091 Applying code review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2OTAwMTkw", "url": "https://github.com/dotCMS/core/pull/19092#pullrequestreview-466900190", "createdAt": "2020-08-13T15:58:13Z", "commit": {"oid": "f59802ad3ca5ff400b233d0946be0773a8c4e0f3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd53e2b51b31f512b73d04e5c630d555b26f49c2", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/fd53e2b51b31f512b73d04e5c630d555b26f49c2", "committedDate": "2020-08-13T21:42:49Z", "message": "#19091 Show switchover notification when the switchover actually finishes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "407a3ab058ae8dd8ec8de05dfb75868a775ba37a", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/407a3ab058ae8dd8ec8de05dfb75868a775ba37a", "committedDate": "2020-08-13T21:43:19Z", "message": "Updating release version number"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d01d706c388b14c962661dd9f032a4f11e41c55b", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/d01d706c388b14c962661dd9f032a4f11e41c55b", "committedDate": "2020-08-13T21:43:34Z", "message": "#19091 Show switchover notification when the switchover actually finishes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cd6b5f487e00d9f154060cf174b7bcbb9dea1b6", "author": {"user": null}, "url": "https://github.com/dotCMS/core/commit/4cd6b5f487e00d9f154060cf174b7bcbb9dea1b6", "committedDate": "2020-08-13T21:44:28Z", "message": "Changing log level to debug"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 738, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}