{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5NTU0NTQy", "number": 18365, "title": "  apps resilience when a site is deleted", "bodyText": "These changes basically fix problems on apps that had configurations for different sites when a site is deleted.\nAdditionally, t that I'm introducing a new endpoint meant for support usage that cleans up any orphan secrets. Orphan secrets are secrets that once belonged to a site that no longer exists.", "createdAt": "2020-04-27T14:55:04Z", "url": "https://github.com/dotCMS/core/pull/18365", "merged": true, "mergeCommit": {"oid": "1e511817f36777295385ded5df9eb3134fa47257"}, "closed": true, "closedAt": "2020-04-27T22:44:50Z", "author": {"login": "fabrizzio-dotCMS"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbTdmhAH2gAyNDA5NTU0NTQyOmRmYzJiNDZjMGJiMDk2M2M5M2ZkYzdlYjI0NzQyNTEzNDU4YmUyZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcb2458AFqTQwMTM2Nzg1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dfc2b46c0bb0963c93fdc7eb24742513458be2d8", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/dfc2b46c0bb0963c93fdc7eb24742513458be2d8", "committedDate": "2020-04-26T05:02:34Z", "message": "  apps resilience when a site is deleted"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMDU5NTE0", "url": "https://github.com/dotCMS/core/pull/18365#pullrequestreview-401059514", "createdAt": "2020-04-27T15:21:04Z", "commit": {"oid": "dfc2b46c0bb0963c93fdc7eb24742513458be2d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxNToyMTowNFrOGMo4jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxNToyMTowNFrOGMo4jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTkwNTkzNQ==", "bodyText": "I think appKeysByHost  methods do not need to be public. But in case it's necessary, they should have integration tests", "url": "https://github.com/dotCMS/core/pull/18365#discussion_r415905935", "createdAt": "2020-04-27T15:21:04Z", "author": {"login": "nollymar"}, "path": "dotCMS/src/main/java/com/dotcms/security/apps/AppsAPIImpl.java", "diffHunk": "@@ -130,13 +135,24 @@ private boolean userDoesNotHaveAccess(final User user) throws DotDataException {\n     }\n \n     @Override\n-    public Map<String, Set<String>> appKeysByHost() {\n-        return secretsStore.listKeys().stream()\n+    public Map<String, Set<String>> appKeysByHost() throws DotSecurityException, DotDataException{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfc2b46c0bb0963c93fdc7eb24742513458be2d8"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMDYyMTE4", "url": "https://github.com/dotCMS/core/pull/18365#pullrequestreview-401062118", "createdAt": "2020-04-27T15:23:48Z", "commit": {"oid": "dfc2b46c0bb0963c93fdc7eb24742513458be2d8"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d06a6dbbea84ab29116abcbea67c972821472dc7", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/d06a6dbbea84ab29116abcbea67c972821472dc7", "committedDate": "2020-04-27T15:57:42Z", "message": "Merge branch 'apps-feature-branch' into apps-site-delete-resilience"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c201c8c6d27da0a1134139ac54bde33ae6fc0aae", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/c201c8c6d27da0a1134139ac54bde33ae6fc0aae", "committedDate": "2020-04-27T16:56:26Z", "message": "# apps delete secrets for site"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1e8c9ef9af33267af12d8ab1d26694eaf4c074e", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/b1e8c9ef9af33267af12d8ab1d26694eaf4c074e", "committedDate": "2020-04-27T18:56:28Z", "message": " apps site delete resilience"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e56b9666a9f049713ecd78ee423ce9d4801c393", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/0e56b9666a9f049713ecd78ee423ce9d4801c393", "committedDate": "2020-04-27T19:00:32Z", "message": "# apps site delete resilience"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "448a46b6c45096e2b4efc31d87706c51db5f44b3", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/448a46b6c45096e2b4efc31d87706c51db5f44b3", "committedDate": "2020-04-27T20:06:39Z", "message": "#apps site resilience + merge"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMzIwMTEx", "url": "https://github.com/dotCMS/core/pull/18365#pullrequestreview-401320111", "createdAt": "2020-04-27T20:56:58Z", "commit": {"oid": "448a46b6c45096e2b4efc31d87706c51db5f44b3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QyMDo1Njo1OFrOGM3WJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QyMDo1Njo1OFrOGM3WJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0Mjg4NQ==", "bodyText": "Changing this file on this PR is not necessary as the remove orphan endpoint was deleted", "url": "https://github.com/dotCMS/core/pull/18365#discussion_r416142885", "createdAt": "2020-04-27T20:56:58Z", "author": {"login": "nollymar"}, "path": "dotCMS/src/main/java/com/dotcms/rest/api/v1/apps/AppsResource.java", "diffHunk": "@@ -6,8 +6,8 @@\n import com.dotcms.rest.ResponseEntityView;\n import com.dotcms.rest.WebResource;\n import com.dotcms.rest.annotation.NoCache;\n-import com.dotcms.rest.api.v1.authentication.ResponseUtil;\n import com.dotcms.rest.api.v1.apps.view.AppView;\n+import com.dotcms.rest.api.v1.authentication.ResponseUtil;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "448a46b6c45096e2b4efc31d87706c51db5f44b3"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMzI5MTky", "url": "https://github.com/dotCMS/core/pull/18365#pullrequestreview-401329192", "createdAt": "2020-04-27T21:10:30Z", "commit": {"oid": "448a46b6c45096e2b4efc31d87706c51db5f44b3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMzY3ODU3", "url": "https://github.com/dotCMS/core/pull/18365#pullrequestreview-401367857", "createdAt": "2020-04-27T22:19:04Z", "commit": {"oid": "448a46b6c45096e2b4efc31d87706c51db5f44b3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1024, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}