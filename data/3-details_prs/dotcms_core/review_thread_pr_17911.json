{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3MDIyMzcy", "number": 17911, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNjozNTo1NlrODbo8Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNjozNTo1N1rODbo8LQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwMzA4OTAzOnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/business/ContentletFactoryTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNjozNTo1NlrOFjPSJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNjozNTo1NlrOFjPSJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjQ5NDg4NA==", "bodyText": "Issue found: Useless parentheses.", "url": "https://github.com/dotCMS/core/pull/17911#discussion_r372494884", "createdAt": "2020-01-29T16:35:56Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/business/ContentletFactoryTest.java", "diffHunk": "@@ -63,33 +70,46 @@ public void findAllCurrent () throws DotDataException, DotSecurityException {\n     @Test\n     public void findAllCurrentOffsetLimit () throws DotDataException, DotSecurityException {\n \n-        //Getting all contentlets live/working contentlets\n-        List<Contentlet> contentlets = contentletFactory.findAllCurrent( 0, 5 );\n-\n-        //Validations\n-        assertTrue( contentlets != null && !contentlets.isEmpty() );\n-        assertEquals( contentlets.size(), 5 );\n-\n-        //Validate the integrity of the array\n-        Contentlet foundContentlet = null;\n-        for ( Contentlet contentlet : contentlets ) {\n-\n-            //TODO: We need to verify for null because the findAllCurrent CAN return null objects, this could happen because the index can return inodes that are not into the db....\n-            if ( contentlet != null ) {\n-                foundContentlet = contentlet;\n-                break;\n+        final ContentType type = new ContentTypeDataGen().nextPersisted();\n+        final ContentletDataGen contentletDataGen = new ContentletDataGen(type.id());\n+        final List<Contentlet> newContentlets = new ArrayList<>();\n+\n+        try {\n+\n+            // Let's create 10 contentlets, 5 live 5 working\n+            IntStream.range(0, 10).forEach(\n+                    (i) -> {\n+                        final Contentlet newContent = contentletDataGen.nextPersisted();\n+                        if (i % 2 == 0) {\n+                            Sneaky.sneaked(() -> APILocator.getContentletAPI()\n+                                    .publish(newContent, user, false));\n+                        }\n+                        newContentlets.add(newContent);\n+                    }\n+            );\n+\n+            //Getting all contentlets live/working contentlets\n+            List<Contentlet> contentlets = contentletFactory.findAllCurrent(0, 10);\n+\n+            // filter out null records\n+            contentlets = contentlets.stream().filter(Objects::nonNull).collect(Collectors.toList());\n+            //Validations\n+            assertTrue(contentlets != null && !contentlets.isEmpty());\n+            assertTrue(contentlets.size() >= 10);\n+\n+            //Search for one of the objects we found\n+            String inode = contentlets.get(0).getInode();\n+            Contentlet contentlet = contentletFactory.find(inode);\n+\n+            //Validations\n+            assertTrue(\n+                    contentlet != null && (contentlet.getInode() != null && !contentlet.getInode()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "361b4cb6c4c716e4d4eacfc6040034029a893bf4"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwMzA4OTA5OnYy", "diffSide": "RIGHT", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/business/ContentletFactoryTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNjozNTo1N1rOFjPSLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNjozNTo1N1rOFjPSLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjQ5NDg5Mw==", "bodyText": "Issue found: Local variable 'inode' could be declared final", "url": "https://github.com/dotCMS/core/pull/17911#discussion_r372494893", "createdAt": "2020-01-29T16:35:57Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/business/ContentletFactoryTest.java", "diffHunk": "@@ -63,33 +70,46 @@ public void findAllCurrent () throws DotDataException, DotSecurityException {\n     @Test\n     public void findAllCurrentOffsetLimit () throws DotDataException, DotSecurityException {\n \n-        //Getting all contentlets live/working contentlets\n-        List<Contentlet> contentlets = contentletFactory.findAllCurrent( 0, 5 );\n-\n-        //Validations\n-        assertTrue( contentlets != null && !contentlets.isEmpty() );\n-        assertEquals( contentlets.size(), 5 );\n-\n-        //Validate the integrity of the array\n-        Contentlet foundContentlet = null;\n-        for ( Contentlet contentlet : contentlets ) {\n-\n-            //TODO: We need to verify for null because the findAllCurrent CAN return null objects, this could happen because the index can return inodes that are not into the db....\n-            if ( contentlet != null ) {\n-                foundContentlet = contentlet;\n-                break;\n+        final ContentType type = new ContentTypeDataGen().nextPersisted();\n+        final ContentletDataGen contentletDataGen = new ContentletDataGen(type.id());\n+        final List<Contentlet> newContentlets = new ArrayList<>();\n+\n+        try {\n+\n+            // Let's create 10 contentlets, 5 live 5 working\n+            IntStream.range(0, 10).forEach(\n+                    (i) -> {\n+                        final Contentlet newContent = contentletDataGen.nextPersisted();\n+                        if (i % 2 == 0) {\n+                            Sneaky.sneaked(() -> APILocator.getContentletAPI()\n+                                    .publish(newContent, user, false));\n+                        }\n+                        newContentlets.add(newContent);\n+                    }\n+            );\n+\n+            //Getting all contentlets live/working contentlets\n+            List<Contentlet> contentlets = contentletFactory.findAllCurrent(0, 10);\n+\n+            // filter out null records\n+            contentlets = contentlets.stream().filter(Objects::nonNull).collect(Collectors.toList());\n+            //Validations\n+            assertTrue(contentlets != null && !contentlets.isEmpty());\n+            assertTrue(contentlets.size() >= 10);\n+\n+            //Search for one of the objects we found\n+            String inode = contentlets.get(0).getInode();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "361b4cb6c4c716e4d4eacfc6040034029a893bf4"}, "originalPosition": 68}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2518, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}