{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1MTg0MDM3", "number": 18942, "title": "Issue 18686 apps select fields", "bodyText": "We're adding support for apps to use select like fields. See #18686", "createdAt": "2020-07-22T15:14:37Z", "url": "https://github.com/dotCMS/core/pull/18942", "merged": true, "mergeCommit": {"oid": "7d726775451d5ccabd79801a19d6555802363ad5"}, "closed": true, "closedAt": "2020-07-22T21:53:26Z", "author": {"login": "fabrizzio-dotCMS"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc126gngH2gAyNDU1MTg0MDM3OjQwODY4NzgyNmViYzJmYjg2MDQ5NTMwYTVkMDQwY2RmNTc2NWI0MDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3gzSfAFqTQ1MzY1NzQ3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "408687826ebc2fb86049530a5d040cdf5765b402", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/408687826ebc2fb86049530a5d040cdf5765b402", "committedDate": "2020-07-17T17:02:51Z", "message": "#18686 adding support for select fields"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba20076176b16a707e9985b88f6ff4d1567f9fda", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/ba20076176b16a707e9985b88f6ff4d1567f9fda", "committedDate": "2020-07-22T15:10:12Z", "message": "#18686 apps support for select like fields"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de9f99a723d0232b3be58ff787cbf22e720857a8", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/de9f99a723d0232b3be58ff787cbf22e720857a8", "committedDate": "2020-07-22T17:16:47Z", "message": "#18686  codacy feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNTMzMTU2", "url": "https://github.com/dotCMS/core/pull/18942#pullrequestreview-453533156", "createdAt": "2020-07-22T17:27:56Z", "commit": {"oid": "de9f99a723d0232b3be58ff787cbf22e720857a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNTM0NDY5", "url": "https://github.com/dotCMS/core/pull/18942#pullrequestreview-453534469", "createdAt": "2020-07-22T17:29:36Z", "commit": {"oid": "de9f99a723d0232b3be58ff787cbf22e720857a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e", "author": {"user": {"login": "fabrizzio-dotCMS", "name": "Fabrizzio Araya"}}, "url": "https://github.com/dotCMS/core/commit/509a914b7c7837721016b429e8c8367b133ad81e", "committedDate": "2020-07-22T20:17:04Z", "message": "#18686 fix side-effect"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNjU3NDQ1", "url": "https://github.com/dotCMS/core/pull/18942#pullrequestreview-453657445", "createdAt": "2020-07-22T20:24:50Z", "commit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyNDo1MVrOG1y5FA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyNDo1MVrOG1y5FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA2MTUyNA==", "bodyText": "Codacy found an issue: The String literal \"selectParam\" appears 4 times in this file; the first occurrence is on line 795", "url": "https://github.com/dotCMS/core/pull/18942#discussion_r459061524", "createdAt": "2020-07-22T20:24:51Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/api/v1/apps/AppsResourceTest.java", "diffHunk": "@@ -773,6 +773,92 @@ public void Test_Secret_Serializer_Returned_Values_Match_Descriptor_Verify_Hidde\n         }\n     }\n \n+    /**\n+     * Test we save a secret that is described as a Select List\n+     * Given scenario: We create a secret then we update the select value sending one of the values\n+     * Expected Result: Only the public value  was supposed to be updated. The other 2 hidden fields should remain the same since we sent a bunch of *****\n+     * @throws IOException\n+     */\n+    @Test\n+    public void Test_Select_List_Param()\n+            throws IOException {\n+       //Select list definition\n+       final List<Map<String,String>> list = ImmutableList.of(\n+           ImmutableMap.of(\"label\",\"-\",\"value\",\"\"),\n+           ImmutableMap.of(\"label\",\"uno\",\"value\",\"1\"),\n+           ImmutableMap.of(\"label\",\"dos\",\"value\",\"2\",\"selected\",\"true\"),\n+           ImmutableMap.of(\"label\",\"tres\",\"value\",\"3\")\n+       );\n+\n+        final AppDescriptorDataGen dataGen = new AppDescriptorDataGen()\n+                .stringParam(\"param1\", false,  true)\n+                .selectParam(\"selectParam\", true, list)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNjU3NDUy", "url": "https://github.com/dotCMS/core/pull/18942#pullrequestreview-453657452", "createdAt": "2020-07-22T20:24:52Z", "commit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyNDo1MlrOG1y5HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyNDo1MlrOG1y5HA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA2MTUzMg==", "bodyText": "Codacy found an issue: The String literal \"label\" appears 4 times in this file; the first occurrence is on line 787", "url": "https://github.com/dotCMS/core/pull/18942#discussion_r459061532", "createdAt": "2020-07-22T20:24:52Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/integration-test/java/com/dotcms/rest/api/v1/apps/AppsResourceTest.java", "diffHunk": "@@ -773,6 +773,92 @@ public void Test_Secret_Serializer_Returned_Values_Match_Descriptor_Verify_Hidde\n         }\n     }\n \n+    /**\n+     * Test we save a secret that is described as a Select List\n+     * Given scenario: We create a secret then we update the select value sending one of the values\n+     * Expected Result: Only the public value  was supposed to be updated. The other 2 hidden fields should remain the same since we sent a bunch of *****\n+     * @throws IOException\n+     */\n+    @Test\n+    public void Test_Select_List_Param()\n+            throws IOException {\n+       //Select list definition\n+       final List<Map<String,String>> list = ImmutableList.of(\n+           ImmutableMap.of(\"label\",\"-\",\"value\",\"\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNjU3NDY0", "url": "https://github.com/dotCMS/core/pull/18942#pullrequestreview-453657464", "createdAt": "2020-07-22T20:24:53Z", "commit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyNDo1M1rOG1y5JQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyNDo1M1rOG1y5JQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA2MTU0MQ==", "bodyText": "Codacy found an issue: Useless parentheses.", "url": "https://github.com/dotCMS/core/pull/18942#discussion_r459061541", "createdAt": "2020-07-22T20:24:53Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/security/apps/AppsAPIImpl.java", "diffHunk": "@@ -610,6 +611,45 @@ private void removeDescriptor(final AppDescriptor descriptor) throws DotDataExce\n         return emptyMap();\n     }\n \n+    /**\n+     * Condition check This verifies the descriptor demands the param to be required but.. No default value is provided and the secret neither has a stored value\n+     * @param descriptor ParamDescriptor\n+     * @param secret stored secret\n+     * @return\n+     */\n+    private boolean isRequiredWithNoDefaultValue(final ParamDescriptor descriptor, final Secret secret ){\n+        //Verify we have a param marked required and no default Value\n+        final boolean isRequiredWithNoDefaultParam = (descriptor.isRequired() && isEmpty(descriptor.getValue()));\n+        //Verify the secret is empty\n+        final boolean isSecretWithEmptyValue = (null == secret || isNotSet(secret.getValue()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e"}, "originalPosition": 67}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNjU3NDcy", "url": "https://github.com/dotCMS/core/pull/18942#pullrequestreview-453657472", "createdAt": "2020-07-22T20:24:54Z", "commit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyNDo1NFrOG1y5KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyNDo1NFrOG1y5KQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA2MTU0NQ==", "bodyText": "Codacy found an issue: Useless parentheses.", "url": "https://github.com/dotCMS/core/pull/18942#discussion_r459061545", "createdAt": "2020-07-22T20:24:54Z", "author": {"login": "dev-dotcms"}, "path": "dotCMS/src/main/java/com/dotcms/security/apps/AppsAPIImpl.java", "diffHunk": "@@ -610,6 +611,45 @@ private void removeDescriptor(final AppDescriptor descriptor) throws DotDataExce\n         return emptyMap();\n     }\n \n+    /**\n+     * Condition check This verifies the descriptor demands the param to be required but.. No default value is provided and the secret neither has a stored value\n+     * @param descriptor ParamDescriptor\n+     * @param secret stored secret\n+     * @return\n+     */\n+    private boolean isRequiredWithNoDefaultValue(final ParamDescriptor descriptor, final Secret secret ){\n+        //Verify we have a param marked required and no default Value\n+        final boolean isRequiredWithNoDefaultParam = (descriptor.isRequired() && isEmpty(descriptor.getValue()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "509a914b7c7837721016b429e8c8367b133ad81e"}, "originalPosition": 65}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 832, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}