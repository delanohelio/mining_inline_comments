{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4OTMzNDk2", "number": 400, "title": "Add in type-to-filter attributes option for Import from CSV", "bodyText": "Description of the Change\nModify the \"Import CSV Dialog\" to be able to filter the many attributes by typing in a partial match on a number of attributes names.\nAlternate Designs\nI did have an extra menu item under the existing 'select all' checkbox but it felt clunky to use.  Simply typing in 'Lati' to get all the Latitude fields or \"Geo\" to get geo or Date to get the date ones feels a lot more intuitive.\nWhy Should This Be In Core?\nLooking and pecking through the 140+ 'All' fields feels exceedingly cumbersome to find the field you're interested in.\nBenefits\nPeople (I) won't be frustrated by finding the one attribute they actually want to use\nPossible Drawbacks\nA Corona pandemic will occur in early-mid 2020... Does anybody read this?  I don't think there are any.\nVerification Process\n\n\nHow did you verify that all new functionality works as expected?\nHave run it and tested the new functionality without any appreciable differences in performance.  Imported and used a sample CSV file of my choosing.\n\n\nHow did you verify that all changed functionality works as expected?\nHave reviewed the changes to the code to hopefully ensure nothing to outrageous is going to go in.  Have done 'Fix imports' and 'Format' on all files to ensure correctly formatted code.\n\n\nHow did you verify that the change has not introduced any regressions?\nRebuilt code.\n\n\nBasically Import -> Delimited file , and then started typing in things I wanted to filter on (geo, lat, long, datetime)\nApplicable Issues\nNil.", "createdAt": "2020-04-05T06:51:23Z", "url": "https://github.com/constellation-app/constellation/pull/400", "merged": true, "mergeCommit": {"oid": "43918728f48b9b0b07ebf8fca36eeeaae3123474"}, "closed": true, "closedAt": "2020-04-07T11:19:04Z", "author": {"login": "CrucisGamma"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUkKuiAH2gAyMzk4OTMzNDk2Ojk2NGY1ODhkNDlkZGE2ZDg5YzNkOTc5OGE0YzYwOTJjMjQ2NTkwN2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVNiwKgH2gAyMzk4OTMzNDk2OmRiMzQ5ZTdkNTc5ZWVjNGRmNjdiMmZmZmJmOTEyNWJkMGY2Y2U2NTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "964f588d49dda6d89c3d9798a4c6092c2465907c", "author": {"user": {"login": "CrucisGamma", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/964f588d49dda6d89c3d9798a4c6092c2465907c", "committedDate": "2020-04-05T06:32:52Z", "message": "Add in type-to-filter attributes option for Import from CSV"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40", "author": {"user": {"login": "CrucisGamma", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/f84b0d6c50d93c074c0433a4583a6667ca523c40", "committedDate": "2020-04-05T06:38:35Z", "message": "Add in type-to-filter attributes option for Import from CSV"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3ODgzODQ1", "url": "https://github.com/constellation-app/constellation/pull/400#pullrequestreview-387883845", "createdAt": "2020-04-06T00:49:25Z", "commit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwMDo0OToyNVrOGBE9OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwMDo1NToxNVrOGBFAhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4Mjk2OQ==", "bodyText": "This should be setAttributeFilter, and the variable should be attributeFilter.", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403782969", "createdAt": "2020-04-06T00:49:25Z", "author": {"login": "cygnus-x-1"}, "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -488,6 +508,10 @@ public void setShowAllSchemaAttributes(final boolean showAllSchemaAttributes) {\n         // TODO: the tick box could have changed but the menu item isn't updated, fix it\n     }\n \n+    public void setShowFilteredSchemaAttributes(final String filterAttributes) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzA0MA==", "bodyText": "You should use contains over matches with a regex.", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783040", "createdAt": "2020-04-06T00:49:54Z", "author": {"login": "cygnus-x-1"}, "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -328,8 +334,22 @@ public void updateDisplayedAttributes() {\n \n     private Map<String, Attribute> createDisplayedAttributes(final Map<String, Attribute> autoAddedAttributes, final Map<String, Attribute> manuallyAddedAttributes) {\n         Map<String, Attribute> displayedAttributes = new HashMap<>();\n-        displayedAttributes.putAll(manuallyAddedAttributes);\n-        displayedAttributes.putAll(autoAddedAttributes);\n+\n+        if (filterAttributes != null &&  filterAttributes.length() > 0) {\n+            for (String name : autoAddedAttributes.keySet()) {\n+                if (name.toUpperCase().matches(\".*\" + filterAttributes.toUpperCase() + \".*\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzEyNw==", "bodyText": "I think we have a utility method to check for both bull and blank - @arcturus2?", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783127", "createdAt": "2020-04-06T00:50:32Z", "author": {"login": "cygnus-x-1"}, "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -328,8 +334,22 @@ public void updateDisplayedAttributes() {\n \n     private Map<String, Attribute> createDisplayedAttributes(final Map<String, Attribute> autoAddedAttributes, final Map<String, Attribute> manuallyAddedAttributes) {\n         Map<String, Attribute> displayedAttributes = new HashMap<>();\n-        displayedAttributes.putAll(manuallyAddedAttributes);\n-        displayedAttributes.putAll(autoAddedAttributes);\n+\n+        if (filterAttributes != null &&  filterAttributes.length() > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzE3Ng==", "bodyText": "Make name final.", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783176", "createdAt": "2020-04-06T00:50:54Z", "author": {"login": "cygnus-x-1"}, "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -328,8 +334,22 @@ public void updateDisplayedAttributes() {\n \n     private Map<String, Attribute> createDisplayedAttributes(final Map<String, Attribute> autoAddedAttributes, final Map<String, Attribute> manuallyAddedAttributes) {\n         Map<String, Attribute> displayedAttributes = new HashMap<>();\n-        displayedAttributes.putAll(manuallyAddedAttributes);\n-        displayedAttributes.putAll(autoAddedAttributes);\n+\n+        if (filterAttributes != null &&  filterAttributes.length() > 0) {\n+            for (String name : autoAddedAttributes.keySet()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzE5MA==", "bodyText": "Make name final.", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783190", "createdAt": "2020-04-06T00:51:03Z", "author": {"login": "cygnus-x-1"}, "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -328,8 +334,22 @@ public void updateDisplayedAttributes() {\n \n     private Map<String, Attribute> createDisplayedAttributes(final Map<String, Attribute> autoAddedAttributes, final Map<String, Attribute> manuallyAddedAttributes) {\n         Map<String, Attribute> displayedAttributes = new HashMap<>();\n-        displayedAttributes.putAll(manuallyAddedAttributes);\n-        displayedAttributes.putAll(autoAddedAttributes);\n+\n+        if (filterAttributes != null &&  filterAttributes.length() > 0) {\n+            for (String name : autoAddedAttributes.keySet()) {\n+                if (name.toUpperCase().matches(\".*\" + filterAttributes.toUpperCase() + \".*\")) {\n+                    displayedAttributes.put(name, autoAddedAttributes.get(name));\n+                }\n+            }\n+            for (String name : manuallyAddedAttributes.keySet()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzM1OQ==", "bodyText": "You could make this more concise using:\nif (destination == null) {\n    return;\n}\nthis.currentDestination = destination;\n\n...but is there an issue with setting currentDestination to null?", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783359", "createdAt": "2020-04-06T00:52:09Z", "author": {"login": "cygnus-x-1"}, "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/ImportController.java", "diffHunk": "@@ -170,7 +171,12 @@ public void setClearManuallyAdded(final boolean b) {\n     }\n \n     public void setDestination(final ImportDestination<?> destination) {\n-        this.currentDestination = destination;\n+        if (destination != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc4MzgxNA==", "bodyText": "In the interest of good UX, I would strongly recommend having a visual element to this filter. Having it just hide attributes as you type with no visual feedback is begging for erroneous bug reports.", "url": "https://github.com/constellation-app/constellation/pull/400#discussion_r403783814", "createdAt": "2020-04-06T00:55:15Z", "author": {"login": "cygnus-x-1"}, "path": "CoreImportExportPlugins/src/au/gov/asd/tac/constellation/plugins/importexport/delimited/RunPane.java", "diffHunk": "@@ -186,6 +189,19 @@ public RunPane(final ImportController importController) {\n \n         attributePane.addRow(0, sourceVertexScrollPane, destinationVertexScrollPane, transactionScrollPane);\n \n+        attributePane.setOnKeyPressed(event -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f84b0d6c50d93c074c0433a4583a6667ca523c40"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15c772b2035ddaccc006ad774627e920979ce979", "author": {"user": {"login": "CrucisGamma", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/15c772b2035ddaccc006ad774627e920979ce979", "committedDate": "2020-04-06T08:36:33Z", "message": "Updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f338d73fd56a53439450d02af2559b774b1236c4", "author": {"user": {"login": "CrucisGamma", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/f338d73fd56a53439450d02af2559b774b1236c4", "committedDate": "2020-04-06T14:37:33Z", "message": "Add in type-to-filter attributes option for Import from CSV"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4Nzg3MDU2", "url": "https://github.com/constellation-app/constellation/pull/400#pullrequestreview-388787056", "createdAt": "2020-04-07T05:09:54Z", "commit": {"oid": "f338d73fd56a53439450d02af2559b774b1236c4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db349e7d579eec4df67b2fffbf9125bd0f6ce658", "author": {"user": {"login": "CrucisGamma", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/db349e7d579eec4df67b2fffbf9125bd0f6ce658", "committedDate": "2020-04-07T06:45:13Z", "message": "Merge branch 'master' into update_error_format_messages"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3645, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}