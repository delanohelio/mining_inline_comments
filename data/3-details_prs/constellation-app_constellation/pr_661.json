{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3MjAzMjA5", "number": 661, "title": "Fix the Body type parameters in the Rest API", "bodyText": "Description of the Change\nThe parameters of body type in the REST API are broken. The request doesn't add any content for any user input.\nE.g.:\nplugins parameter in run_plugins endpoint\nargs parameter in run_plugin endpoint\ndata parameter in add_recordstore endpoint\n\nAlternate Designs\nN/A\n\nWhy Should This Be In Core?\nFixes the bug\n\nBenefits\nThe endpoints are now usable with json type parameters. This can be improved to contain Example Value which will be fixed in another case.\n\nPossible Drawbacks\nN/A\n\nVerification Process\n\nOpen Swagger (Run constellation and Tools->Start Rest Server then Display Rest Server Documentation)\nTry any of the above endpoints in the REST API with a valid json input\nVerify it worked with a successful response message and the request should contain the JSON you entered.\n\n\nApplicable Issues\n#654", "createdAt": "2020-07-10T03:34:15Z", "url": "https://github.com/constellation-app/constellation/pull/661", "merged": true, "mergeCommit": {"oid": "23ae159be9a93204f22a4bb1576c0aea0aaafc6c"}, "closed": true, "closedAt": "2020-07-19T13:43:30Z", "author": {"login": "Auriga2"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcza30LgH2gAyNDQ3MjAzMjA5Ojc2YTNkMWVkZmNhZGEzNDcxNTQwZDhlNmE4MjQzYjk4MWY2OWQyZWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc2dQbZgFqTQ1MTEzMjkzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "76a3d1edfcada3471540d8e6a8243b981f69d2ee", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/76a3d1edfcada3471540d8e6a8243b981f69d2ee", "committedDate": "2020-07-10T03:14:43Z", "message": "Fix the Body type parameters in the Rest API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MTEyODM4", "url": "https://github.com/constellation-app/constellation/pull/661#pullrequestreview-446112838", "createdAt": "2020-07-10T04:22:20Z", "commit": {"oid": "76a3d1edfcada3471540d8e6a8243b981f69d2ee"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwNDoyMjoyMFrOGvpZfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwNDoyMjoyMFrOGvpZfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYxNDUyNw==", "bodyText": "Are you able to change Locale.US to Locale.ENGLISH? This just keeps it consistent with the rest of the codebase", "url": "https://github.com/constellation-app/constellation/pull/661#discussion_r452614527", "createdAt": "2020-07-10T04:22:20Z", "author": {"login": "antares1470"}, "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java", "diffHunk": "@@ -122,13 +122,24 @@ protected void doGet(final HttpServletRequest request, final HttpServletResponse\n                     final ArrayNode params = httpMethod.putArray(\"parameters\");\n                     rs.createParameters().getParameters().entrySet().forEach(entry -> {\n                         final PluginParameter<?> pp = entry.getValue();\n+\n+                        if (pp.getName().toLowerCase(Locale.US).contains(\"(body)\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76a3d1edfcada3471540d8e6a8243b981f69d2ee"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MTI3Nzcy", "url": "https://github.com/constellation-app/constellation/pull/661#pullrequestreview-446127772", "createdAt": "2020-07-10T05:20:47Z", "commit": {"oid": "76a3d1edfcada3471540d8e6a8243b981f69d2ee"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c478cf50f88e1cf51368f0dbe58c87b335521870", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/c478cf50f88e1cf51368f0dbe58c87b335521870", "committedDate": "2020-07-10T06:04:17Z", "message": "Fixed the locale, and improved the response body description by including the name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c0fe68ac4e311f8f158fff5d005ca934962bbe0", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/0c0fe68ac4e311f8f158fff5d005ca934962bbe0", "committedDate": "2020-07-10T06:18:15Z", "message": "Fix the code smells"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2Mzg1MDAx", "url": "https://github.com/constellation-app/constellation/pull/661#pullrequestreview-446385001", "createdAt": "2020-07-10T13:06:49Z", "commit": {"oid": "0c0fe68ac4e311f8f158fff5d005ca934962bbe0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NzE5MDAz", "url": "https://github.com/constellation-app/constellation/pull/661#pullrequestreview-446719003", "createdAt": "2020-07-10T21:49:21Z", "commit": {"oid": "0c0fe68ac4e311f8f158fff5d005ca934962bbe0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMTo0OToyMlrOGwGj3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMTo0OToyMlrOGwGj3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA5MjMxOQ==", "bodyText": "@Auriga2 can you please prefix this comment with \"TODO\" and you can mention the GitHub issue like #123. Thanks.", "url": "https://github.com/constellation-app/constellation/pull/661#discussion_r453092319", "createdAt": "2020-07-10T21:49:22Z", "author": {"login": "arcturus2"}, "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/SwaggerServlet.java", "diffHunk": "@@ -122,20 +124,31 @@ protected void doGet(final HttpServletRequest request, final HttpServletResponse\n                     final ArrayNode params = httpMethod.putArray(\"parameters\");\n                     rs.createParameters().getParameters().entrySet().forEach(entry -> {\n                         final PluginParameter<?> pp = entry.getValue();\n-                        final ObjectNode param = params.addObject();\n-                        param.put(\"name\", pp.getId());\n-                        param.put(\"in\", pp.getName().toLowerCase(Locale.US).contains(\"(body)\") ? \"body\" : \"query\");\n-                        param.put(\"required\", false); // TODO Hard-code this until PluginParameters grows a required field.\n-                        param.put(DESCRIPTION, pp.getDescription());\n-                        final ObjectNode schema = param.putObject(SCHEMA);\n-                        schema.put(\"type\", pp.getType().getId());\n+\n+                        if (pp.getName().toLowerCase(Locale.ENGLISH).contains(\"(body)\")) {\n+                            final ObjectNode requestBody = httpMethod.putObject(\"requestBody\");\n+                            requestBody.put(DESCRIPTION, pp.getName().replace(\"(body)\", \" - \") + pp.getDescription());\n+                            requestBody.put(REQUIRED, false); //fix in the other ticket", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c0fe68ac4e311f8f158fff5d005ca934962bbe0"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ea4af64e171f76b5c3494daba16333bdeb813b9", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/5ea4af64e171f76b5c3494daba16333bdeb813b9", "committedDate": "2020-07-13T04:11:35Z", "message": "Fix the comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMTMyOTM4", "url": "https://github.com/constellation-app/constellation/pull/661#pullrequestreview-451132938", "createdAt": "2020-07-19T13:43:11Z", "commit": {"oid": "5ea4af64e171f76b5c3494daba16333bdeb813b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3597, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}