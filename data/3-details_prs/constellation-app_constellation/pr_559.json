{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2MzU5Nzkz", "number": 559, "title": "Make global parameters singletons", "bodyText": "Description of the Change\nMoved creation of globally accessed variables to CoreGlobalParameters.java.\n\nAlternate Designs\nN/A\n\nWhy Should This Be In Core?\nSignificant change to how globally accessed variables are created.\n\nBenefits\nAvoids possible discrepancies during singleton configuration.\n\nPossible Drawbacks\nCurrent solution works but requires a lot of repeated code.\n\nVerification Process\nExecuted Data Access View with breakpoints in code to verify actions pass through code correctly.\n\nApplicable Issues\n#331", "createdAt": "2020-06-02T05:31:11Z", "url": "https://github.com/constellation-app/constellation/pull/559", "merged": true, "mergeCommit": {"oid": "2462d924023a41d9e16de49147dee0e27ed3abe6"}, "closed": true, "closedAt": "2020-06-15T07:56:49Z", "author": {"login": "sol695510"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclT3XYgH2gAyNDI2MzU5NzkzOjc2MTE3ZWU3MTcwMzQ2OThkNDdlZDkwNzM4ZGE5ZjcyZjFjNDYwZmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrZxGcgH2gAyNDI2MzU5NzkzOjRlNWRmYzliNDBhYmE2MzFmN2MyYTc2N2Y4NmJjOWVjMDI4YzczMWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "76117ee717034698d47ed90738da9f72f1c460ff", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/76117ee717034698d47ed90738da9f72f1c460ff", "committedDate": "2020-05-27T07:09:57Z", "message": "dummy_commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "865210ddb1ba67dbf00542073f8d68f5f81a89f8", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/865210ddb1ba67dbf00542073f8d68f5f81a89f8", "committedDate": "2020-05-27T07:11:34Z", "message": "Merge branch 'master' into Make-global-parameters-singletons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dde35f5ef792026a20e1317c23edbe15a2a3493f", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/dde35f5ef792026a20e1317c23edbe15a2a3493f", "committedDate": "2020-05-28T06:39:06Z", "message": "Merge branch 'master' into Make-global-parameters-singletons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ffcfc155d895795c36067be805d65b34bb6a92b", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/8ffcfc155d895795c36067be805d65b34bb6a92b", "committedDate": "2020-05-28T06:40:04Z", "message": "Singleton fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a6ff5c0644caa2595b463e0d74c890d646956ba", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/8a6ff5c0644caa2595b463e0d74c890d646956ba", "committedDate": "2020-05-28T06:51:39Z", "message": "Update TestParametersPlugin.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b", "committedDate": "2020-06-02T05:11:12Z", "message": "Merge branch 'master' into Make-global-parameters-singletons"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzMTUwNTgw", "url": "https://github.com/constellation-app/constellation/pull/559#pullrequestreview-423150580", "createdAt": "2020-06-03T00:55:32Z", "commit": {"oid": "b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwMDo1NTozMlrOGeIpfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwMDo1NjowNFrOGeIqCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDI1MjE1Nw==", "bodyText": "If checking for whether a key exists, better using containsKey().\ni.e. if (!SINGLETON_MAP.containsKey(PARAMETER_ID)) {", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r434252157", "createdAt": "2020-06-03T00:55:32Z", "author": {"login": "antares1470"}, "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/CoreGlobalParameters.java", "diffHunk": "@@ -51,7 +55,26 @@\n      */\n     private static final int DATETIME_RANGE_PARAMETER_ID_INDEX = 1;\n     public static final String DATETIME_RANGE_PARAMETER_ID = PluginParameter.buildId(CoreGlobalParameters.class, \"datetime_range\");\n-\n+    \n+    // Map of string types, datetime types, etc.\n+    private static final Map<String,PluginParameter> SINGLETON_MAP = new HashMap<>();\n+    \n+    public static PluginParameter getStringParameterType(final String PARAMETER_ID) {\n+        if (SINGLETON_MAP.get(PARAMETER_ID) == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDI1MjI5OQ==", "bodyText": "same here", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r434252299", "createdAt": "2020-06-03T00:56:04Z", "author": {"login": "antares1470"}, "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/CoreGlobalParameters.java", "diffHunk": "@@ -51,7 +55,26 @@\n      */\n     private static final int DATETIME_RANGE_PARAMETER_ID_INDEX = 1;\n     public static final String DATETIME_RANGE_PARAMETER_ID = PluginParameter.buildId(CoreGlobalParameters.class, \"datetime_range\");\n-\n+    \n+    // Map of string types, datetime types, etc.\n+    private static final Map<String,PluginParameter> SINGLETON_MAP = new HashMap<>();\n+    \n+    public static PluginParameter getStringParameterType(final String PARAMETER_ID) {\n+        if (SINGLETON_MAP.get(PARAMETER_ID) == null) {\n+            SINGLETON_MAP.put(PARAMETER_ID, StringParameterType.build(PARAMETER_ID));\n+        }\n+        \n+        return SINGLETON_MAP.get(PARAMETER_ID);\n+    }\n+    \n+    public static PluginParameter getDateTimeRangeParameterType(final String PARAMETER_ID) {\n+        if (SINGLETON_MAP.get(PARAMETER_ID) == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzMTkyMDYz", "url": "https://github.com/constellation-app/constellation/pull/559#pullrequestreview-423192063", "createdAt": "2020-06-03T03:21:15Z", "commit": {"oid": "b8fae7da7fa15f7e023ffa8dcf911a085ddc7f0b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce586d92a561b2a7f8795e57890bbfa60f718bfb", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/ce586d92a561b2a7f8795e57890bbfa60f718bfb", "committedDate": "2020-06-03T05:43:29Z", "message": "Merge branch 'master' into Make-global-parameters-singletons"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MDk5Mzgy", "url": "https://github.com/constellation-app/constellation/pull/559#pullrequestreview-424099382", "createdAt": "2020-06-04T04:48:03Z", "commit": {"oid": "ce586d92a561b2a7f8795e57890bbfa60f718bfb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNDo0ODowM1rOGe1szA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNDo0ODowM1rOGe1szA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5MDI4NA==", "bodyText": "Rather than having the parameter id's as keys (and having to deal with the issue of figuring out what type of parameter it is), couldn't you just build the parameters upfront and make the actual parameter objects the keys?", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r434990284", "createdAt": "2020-06-04T04:48:03Z", "author": {"login": "cygnus-x-1"}, "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/plugins/experimental/TestParametersPlugin.java", "diffHunk": "@@ -178,10 +178,10 @@ public PluginParameters createParameters() {\n         selected.setDescription(\"Only use selected elements\");\n         params.addParameter(selected);\n \n-        final PluginParameter<StringParameterValue> queryName = StringParameterType.build(CoreGlobalParameters.QUERY_NAME_PARAMETER_ID);\n+        final PluginParameter<StringParameterValue> queryName = CoreGlobalParameters.getStringParameterType(CoreGlobalParameters.QUERY_NAME_PARAMETER_ID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce586d92a561b2a7f8795e57890bbfa60f718bfb"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NjkyODU5", "url": "https://github.com/constellation-app/constellation/pull/559#pullrequestreview-426692859", "createdAt": "2020-06-08T23:40:05Z", "commit": {"oid": "ce586d92a561b2a7f8795e57890bbfa60f718bfb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQyMzo0MDowNVrOGgz81A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQyMzo0MDowNVrOGgz81A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA1ODc3Mg==", "bodyText": "Key was probably the wrong word to use there. If the parameters are built up-front, you could refer to them directly (ie. CoreGlobalParameters.QUERY_NAME_PARAMETER), or look them up using their parameter ID. I guess this technically wouldn't make them singletons - however the root issue here was having multiple instances of them built across multiple modules, and that would be addressed. It would also make using them simpler as the developer wouldn't have to know what type they are up-front.", "url": "https://github.com/constellation-app/constellation/pull/559#discussion_r437058772", "createdAt": "2020-06-08T23:40:05Z", "author": {"login": "cygnus-x-1"}, "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/plugins/experimental/TestParametersPlugin.java", "diffHunk": "@@ -178,10 +178,10 @@ public PluginParameters createParameters() {\n         selected.setDescription(\"Only use selected elements\");\n         params.addParameter(selected);\n \n-        final PluginParameter<StringParameterValue> queryName = StringParameterType.build(CoreGlobalParameters.QUERY_NAME_PARAMETER_ID);\n+        final PluginParameter<StringParameterValue> queryName = CoreGlobalParameters.getStringParameterType(CoreGlobalParameters.QUERY_NAME_PARAMETER_ID);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk5MDI4NA=="}, "originalCommit": {"oid": "ce586d92a561b2a7f8795e57890bbfa60f718bfb"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7723c367175cc6650e16c0faf2a589b77fb9b5bb", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/7723c367175cc6650e16c0faf2a589b77fb9b5bb", "committedDate": "2020-06-09T02:23:17Z", "message": "Merge branch 'master' into Make-global-parameters-singletons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84d17fdcae00b5aecf0adfc2e0d53efca539cabd", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/84d17fdcae00b5aecf0adfc2e0d53efca539cabd", "committedDate": "2020-06-10T00:14:48Z", "message": "Merge branch 'master' into Make-global-parameters-singletons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60b3df8bdec45060d0b227be43681eb93cb0fd93", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/60b3df8bdec45060d0b227be43681eb93cb0fd93", "committedDate": "2020-06-10T04:05:23Z", "message": "Update TestParametersPlugin.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccc5e8f3b5f81b78843e43ee832ad677feeb6f43", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/ccc5e8f3b5f81b78843e43ee832ad677feeb6f43", "committedDate": "2020-06-10T04:05:45Z", "message": "Update CoreGlobalParameters.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfb3c37a23861c27f40c75551915e35f27c35415", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/cfb3c37a23861c27f40c75551915e35f27c35415", "committedDate": "2020-06-10T04:33:51Z", "message": "Remove unnecessary imports and code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3Nzg3NDQ3", "url": "https://github.com/constellation-app/constellation/pull/559#pullrequestreview-427787447", "createdAt": "2020-06-10T07:37:11Z", "commit": {"oid": "cfb3c37a23861c27f40c75551915e35f27c35415"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NTk0Mzc1", "url": "https://github.com/constellation-app/constellation/pull/559#pullrequestreview-428594375", "createdAt": "2020-06-11T05:03:43Z", "commit": {"oid": "cfb3c37a23861c27f40c75551915e35f27c35415"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e65ace50bc5c174f035a86710bd527be8d87e65", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/7e65ace50bc5c174f035a86710bd527be8d87e65", "committedDate": "2020-06-11T06:13:21Z", "message": "Merge branch 'master' into Make-global-parameters-singletons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0eed890fde54bd314eb8e2bf3390160797234cd2", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/0eed890fde54bd314eb8e2bf3390160797234cd2", "committedDate": "2020-06-15T00:15:44Z", "message": "Merge branch 'master' into Make-global-parameters-singletons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4127d943a2d9bb4c94e9d5ebbee8cf5e1061d73", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/e4127d943a2d9bb4c94e9d5ebbee8cf5e1061d73", "committedDate": "2020-06-15T05:22:09Z", "message": "Update CHANGELOG.md and CONTRIBUTING.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e5dfc9b40aba631f7c2a767f86bc9ec028c731c", "author": {"user": {"login": "sol695510", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/4e5dfc9b40aba631f7c2a767f86bc9ec028c731c", "committedDate": "2020-06-15T05:26:05Z", "message": "Update CHANGELOG.md"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3546, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}