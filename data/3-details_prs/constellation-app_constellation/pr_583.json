{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1NTQ1NjMz", "number": 583, "title": "Rest API returns custom error codes and Run_plugin endpoint returns a valid error when an incorrect graph_id is supplied.", "bodyText": "Description of the Change\n\n\nWhen any errors are thrown from the services, the Rest API was throwing them only as Error 500.\nWith this fix we can response with custom error codes.\n\n\nRun_plugin endpoint returns a valid error when an incorrect graph_id is supplied.\n\n\n\nAlternate Designs\nI managed to get it to work by passing the HttpServletResponse response object to the services classes. But tricky to refactor the FileListener.java class.\n\nWhy Should This Be In Core?\nBetter UX\n\nBenefits\nBetter UX\n\nPossible Drawbacks\nN/A\n\nVerification Process\n\nIn the Rest API, try the SetGraph endpoint with an invalid graph ID. It should return an Error 422 instead of 500\nTry the RunPlugin endpoint with an invalid graph ID. It should return an Error 422 instead of 200\n\n\nApplicable Issues\n\n#577", "createdAt": "2020-06-17T01:13:45Z", "url": "https://github.com/constellation-app/constellation/pull/583", "merged": true, "mergeCommit": {"oid": "594f4f8b9678e2734591a9665f558600ccffb2d0"}, "closed": true, "closedAt": "2020-07-04T17:27:56Z", "author": {"login": "Auriga2"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcr_JJRAH2gAyNDM1NTQ1NjMzOjRiOWMxYzkzMWEzNTU4YzhlNzkzMTFiNThhNzI5MDBiMmRiNGYzMWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxI3DugH2gAyNDM1NTQ1NjMzOjc3ODg3MDQwMjc0ZDA5OTVkMTMzZWU3MTNiZTUzNjViMjZjYjZhMjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/4b9c1c931a3558c8e79311b58a72900b2db4f31a", "committedDate": "2020-06-17T00:58:50Z", "message": "Rest API returns custom error codes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDI0NTIx", "url": "https://github.com/constellation-app/constellation/pull/583#pullrequestreview-432024521", "createdAt": "2020-06-17T02:57:35Z", "commit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMjo1NzozNlrOGkz58A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMjo1NzozNlrOGkz58A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MjMzNg==", "bodyText": "Can you please use the HttpURLConnection class instead of creating these constants?", "url": "https://github.com/constellation-app/constellation/pull/583#discussion_r441252336", "createdAt": "2020-06-17T02:57:36Z", "author": {"login": "arcturus2"}, "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/restapi/RestService.java", "diffHunk": "@@ -38,9 +38,56 @@\n  * <p>\n  * All services are accessed via RestServiceServlet; see that for more details.\n  *\n+ * This also stores status codes.\n+ * Top section copied from public interface HttpServletResponse.\n+ * \n  * @author algol\n  */\n public abstract class RestService {\n+    public static final int SC_CONTINUE = 100;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDI2MTUw", "url": "https://github.com/constellation-app/constellation/pull/583#pullrequestreview-432026150", "createdAt": "2020-06-17T03:03:10Z", "commit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMzowMzoxMFrOGkz_Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMzowMzoxMFrOGkz_Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI1MzY5OA==", "bodyText": "So in here it would be HttpURLConnection.HTTP_OK.\nWhat is the reason to show the message \"Successful\" given the HTTP code will inform this. Does the message appear in the response output?\nAlso if you are going to keep it then its work making the string a constant.", "url": "https://github.com/constellation-app/constellation/pull/583#discussion_r441253698", "createdAt": "2020-06-17T03:03:10Z", "author": {"login": "arcturus2"}, "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/services/AddRecordStore.java", "diffHunk": "@@ -182,6 +183,7 @@ public void callService(final PluginParameters parameters, final InputStream in,\n         }\n \n         addToGraph(graphId, rs, completeWithSchema, arrange, resetView);\n+        return new ServiceResponse(SC_OK, \"Successful\"); ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDI2MzI1", "url": "https://github.com/constellation-app/constellation/pull/583#pullrequestreview-432026325", "createdAt": "2020-06-17T03:03:56Z", "commit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMTE3NDQ5", "url": "https://github.com/constellation-app/constellation/pull/583#pullrequestreview-432117449", "createdAt": "2020-06-17T07:11:15Z", "commit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNzoxMToxNlrOGk4iMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNzoxMToxNlrOGk4iMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyODE3Ng==", "bodyText": "how about statusMessage?", "url": "https://github.com/constellation-app/constellation/pull/583#discussion_r441328176", "createdAt": "2020-06-17T07:11:16Z", "author": {"login": "arcturus2"}, "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/restapi/ServiceResponse.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright 2010-2020 Australian Signals Directorate\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package au.gov.asd.tac.constellation.webserver.restapi;\n+\n+/**\n+ * This class is used to send custom HTTP error codes generated from the \n+ * callService in webserver.services classes.\n+ */\n+public class ServiceResponse { \n+    private String errorMessage;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMTE3Nzk2", "url": "https://github.com/constellation-app/constellation/pull/583#pullrequestreview-432117796", "createdAt": "2020-06-17T07:11:50Z", "commit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNzoxMTo1MFrOGk4jQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNzoxMTo1MFrOGk4jQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyODQ1MQ==", "bodyText": "how about statusCode given the response is not always when there is an error.", "url": "https://github.com/constellation-app/constellation/pull/583#discussion_r441328451", "createdAt": "2020-06-17T07:11:50Z", "author": {"login": "arcturus2"}, "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/restapi/ServiceResponse.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright 2010-2020 Australian Signals Directorate\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package au.gov.asd.tac.constellation.webserver.restapi;\n+\n+/**\n+ * This class is used to send custom HTTP error codes generated from the \n+ * callService in webserver.services classes.\n+ */\n+public class ServiceResponse { \n+    private String errorMessage;\n+    private int errorCode;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b9c1c931a3558c8e79311b58a72900b2db4f31a"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2583d5699b6a7734578ed76ae867185bbb24ed9", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/c2583d5699b6a7734578ed76ae867185bbb24ed9", "committedDate": "2020-06-18T07:51:49Z", "message": "Bug fixes and improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NTIzMjMx", "url": "https://github.com/constellation-app/constellation/pull/583#pullrequestreview-434523231", "createdAt": "2020-06-21T18:39:07Z", "commit": {"oid": "c2583d5699b6a7734578ed76ae867185bbb24ed9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQxODozOTowN1rOGmtjHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQxODozOTowN1rOGmtjHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI0NTM0MQ==", "bodyText": "@Auriga2  should the 200 be replaced with HttpURLConnection.HTTP_OK?", "url": "https://github.com/constellation-app/constellation/pull/583#discussion_r443245341", "createdAt": "2020-06-21T18:39:07Z", "author": {"login": "arcturus2"}, "path": "CoreWebServer/src/au/gov/asd/tac/constellation/webserver/api/RestServiceServlet.java", "diffHunk": "@@ -101,7 +102,10 @@ private void callService(final HttpMethod httpMethod, final HttpServletRequest r\n         try {\n             response.setContentType(rs.getMimeType());\n             response.setStatus(HttpServletResponse.SC_OK);\n-            rs.callService(parameters, request.getInputStream(), response.getOutputStream());\n+            ServiceResponse serviceResponse = rs.callService(parameters, request.getInputStream(), response.getOutputStream());\n+            if (serviceResponse.getStatusCode()!=200){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2583d5699b6a7734578ed76ae867185bbb24ed9"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fad9e05f24440cfd90ff3685a23dc47eaa2416b6", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/fad9e05f24440cfd90ff3685a23dc47eaa2416b6", "committedDate": "2020-06-22T00:05:16Z", "message": "Minor fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38f1a15d49862f5632a747c8d54e700dd9833d9e", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/38f1a15d49862f5632a747c8d54e700dd9833d9e", "committedDate": "2020-06-25T07:15:42Z", "message": "Revert \"Minor fix\"\n\nThis reverts commit fad9e05f24440cfd90ff3685a23dc47eaa2416b6."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25a98dc2009fff59e715e7738969b0bfcae48f15", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/25a98dc2009fff59e715e7738969b0bfcae48f15", "committedDate": "2020-06-25T07:19:01Z", "message": "Revert \"Bug fixes and improvements\"\n\nThis reverts commit c2583d5699b6a7734578ed76ae867185bbb24ed9."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b2624c254c5abf1b9007f99156fecc0d1ec5984", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/1b2624c254c5abf1b9007f99156fecc0d1ec5984", "committedDate": "2020-06-25T07:19:15Z", "message": "Revert \"Rest API returns custom error codes\"\n\nThis reverts commit 4b9c1c931a3558c8e79311b58a72900b2db4f31a."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f69c20c87b2a7ccde1ce140a13c1347eeecda079", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/f69c20c87b2a7ccde1ce140a13c1347eeecda079", "committedDate": "2020-06-26T01:11:22Z", "message": "API returns custom error codes using RestServiceException, and fix the run plugin and set graph endpoints."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3OTU4OTUx", "url": "https://github.com/constellation-app/constellation/pull/583#pullrequestreview-437958951", "createdAt": "2020-06-26T01:24:35Z", "commit": {"oid": "f69c20c87b2a7ccde1ce140a13c1347eeecda079"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77887040274d0995d133ee713be5365b26cb6a27", "author": {"user": {"login": "Auriga2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/77887040274d0995d133ee713be5365b26cb6a27", "committedDate": "2020-07-03T01:07:45Z", "message": "Fixing rest of the endpoints and some bugs"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3565, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}