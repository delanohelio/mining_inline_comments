{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4MjkzMzk4", "number": 568, "title": "Fix a bug with split nodes plugin", "bodyText": "Description of the Change\n\ud83d\udc1b Fix a bug with split nodes plugin\n\nThe split nodes plugin was only working splitting for one node. It now works as expected for all nodes selected on the graph.\n\nAlternate Designs\n\nWhy Should This Be In Core?\n\nBenefits\n\nPossible Drawbacks\n\nVerification Process\nDid some test driven development; wrote the unit test and then fixed the code until it passed.\nAlso did some manual testing too.\nApplicable Issues", "createdAt": "2020-06-05T08:08:38Z", "url": "https://github.com/constellation-app/constellation/pull/568", "merged": true, "mergeCommit": {"oid": "5b41a82338e04fbd628881ea0312bb699a4ce89a"}, "closed": true, "closedAt": "2020-06-21T19:21:45Z", "author": {"login": "arcturus2"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoOEFTgH2gAyNDI4MjkzMzk4OmUyMWRmMDI4OTRkNTY3ZmQ4MjllMGU2ODM5YTU0YjVhNThlZjRiY2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcptSCAAFqTQyNzYwMjk3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd", "author": {"user": {"login": "arcturus2", "name": null}}, "url": "https://github.com/constellation-app/constellation/commit/e21df02894d567fd829e0e6839a54b5a58ef4bcd", "committedDate": "2020-06-05T08:06:11Z", "message": ":bug: Fix a bug with split nodes plugin\n* The split nodes plugin was only working splitting for one node. It now works as expected for all nodes selected on the graph."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NjYwMDY5", "url": "https://github.com/constellation-app/constellation/pull/568#pullrequestreview-426660069", "createdAt": "2020-06-08T22:17:19Z", "commit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2Njg4MDg3", "url": "https://github.com/constellation-app/constellation/pull/568#pullrequestreview-426688087", "createdAt": "2020-06-08T23:26:31Z", "commit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQyMzoyNjozMVrOGgzt4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQyMzoyODo1OVrOGgzwiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA1NDk0NQ==", "bodyText": "Why set the type to HostName when the identifier is an IP address?", "url": "https://github.com/constellation-app/constellation/pull/568#discussion_r437054945", "createdAt": "2020-06-08T23:26:31Z", "author": {"login": "cygnus-x-1"}, "path": "CoreDataAccessView/test/unit/src/au/gov/asd/tac/constellation/views/dataaccess/plugins/clean/SplitNodesPluginNGTest.java", "diffHunk": "@@ -96,7 +97,7 @@ public void testQueryWithTypes() throws Exception {\n         expResult.set(GraphRecordStoreUtilities.SOURCE + VisualConcept.VertexAttribute.IDENTIFIER, \"+123456789\");\n         expResult.set(GraphRecordStoreUtilities.SOURCE + AnalyticConcept.VertexAttribute.TYPE, AnalyticConcept.VertexType.TELEPHONE_IDENTIFIER);\n         expResult.set(GraphRecordStoreUtilities.DESTINATION + VisualConcept.VertexAttribute.IDENTIFIER, \"192.168.1.1\");\n-        expResult.set(GraphRecordStoreUtilities.DESTINATION + AnalyticConcept.VertexAttribute.TYPE, AnalyticConcept.VertexType.URL);\n+        expResult.set(GraphRecordStoreUtilities.DESTINATION + AnalyticConcept.VertexAttribute.TYPE, AnalyticConcept.VertexType.HOST_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA1NTYyNQ==", "bodyText": "I must be missing something here - but I would have thought that by removing the RecordStore iterator you're treating it as a Record and so only the one data record currently pointed at will be modified.", "url": "https://github.com/constellation-app/constellation/pull/568#discussion_r437055625", "createdAt": "2020-06-08T23:28:59Z", "author": {"login": "cygnus-x-1"}, "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/plugins/clean/SplitNodesPlugin.java", "diffHunk": "@@ -157,19 +157,16 @@ private void editResultStore(final RecordStore result, final String left, final\n         result.set(GraphRecordStoreUtilities.DESTINATION + VisualConcept.VertexAttribute.IDENTIFIER, right);\n \n         //Loops through all of the Node attributes and copies them to the new node\n-        query.reset();\n-        while (query.next()) {\n-            for (final String key : query.keys()) {\n-                if (key.endsWith(\".[id]\") || SOURCE_IDENTIFIER.equals(key)) {\n-                    //Skips the id and Identifier to make the new node unique\n-                } else if ((GraphRecordStoreUtilities.SOURCE + VisualConcept.VertexAttribute.X).equals(key)\n-                        || (GraphRecordStoreUtilities.SOURCE + VisualConcept.VertexAttribute.Y).equals(key)\n-                        || (GraphRecordStoreUtilities.SOURCE + VisualConcept.VertexAttribute.Z).equals(key)) {\n-                    //The coordinates are also skipped so that the second node is not created in the exact same location\n-                    //as the first node\n-                } else {\n-                    result.set(GraphRecordStoreUtilities.DESTINATION + key.replace(GraphRecordStoreUtilities.SOURCE, \"\"), query.get(key));\n-                }\n+        for (final String key : query.keys()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2OTE1NzI1", "url": "https://github.com/constellation-app/constellation/pull/568#pullrequestreview-426915725", "createdAt": "2020-06-09T08:42:38Z", "commit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwODo0MjozOFrOGg-2Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwODo0Mzo1NVrOGg-5Rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzIzNzI5OQ==", "bodyText": "Ahh I see, the iteration is happening elsewhere.", "url": "https://github.com/constellation-app/constellation/pull/568#discussion_r437237299", "createdAt": "2020-06-09T08:42:38Z", "author": {"login": "cygnus-x-1"}, "path": "CoreDataAccessView/src/au/gov/asd/tac/constellation/views/dataaccess/plugins/clean/SplitNodesPlugin.java", "diffHunk": "@@ -157,19 +157,16 @@ private void editResultStore(final RecordStore result, final String left, final\n         result.set(GraphRecordStoreUtilities.DESTINATION + VisualConcept.VertexAttribute.IDENTIFIER, right);\n \n         //Loops through all of the Node attributes and copies them to the new node\n-        query.reset();\n-        while (query.next()) {\n-            for (final String key : query.keys()) {\n-                if (key.endsWith(\".[id]\") || SOURCE_IDENTIFIER.equals(key)) {\n-                    //Skips the id and Identifier to make the new node unique\n-                } else if ((GraphRecordStoreUtilities.SOURCE + VisualConcept.VertexAttribute.X).equals(key)\n-                        || (GraphRecordStoreUtilities.SOURCE + VisualConcept.VertexAttribute.Y).equals(key)\n-                        || (GraphRecordStoreUtilities.SOURCE + VisualConcept.VertexAttribute.Z).equals(key)) {\n-                    //The coordinates are also skipped so that the second node is not created in the exact same location\n-                    //as the first node\n-                } else {\n-                    result.set(GraphRecordStoreUtilities.DESTINATION + key.replace(GraphRecordStoreUtilities.SOURCE, \"\"), query.get(key));\n-                }\n+        for (final String key : query.keys()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA1NTYyNQ=="}, "originalCommit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzIzODA4Nw==", "bodyText": "I don't see how the type could be causing issues here - the type should be irrelevant to the operation of this plugin. However, if the type is causing issues - then perhaps there is a schema-related bug that needs resolving?", "url": "https://github.com/constellation-app/constellation/pull/568#discussion_r437238087", "createdAt": "2020-06-09T08:43:55Z", "author": {"login": "cygnus-x-1"}, "path": "CoreDataAccessView/test/unit/src/au/gov/asd/tac/constellation/views/dataaccess/plugins/clean/SplitNodesPluginNGTest.java", "diffHunk": "@@ -96,7 +97,7 @@ public void testQueryWithTypes() throws Exception {\n         expResult.set(GraphRecordStoreUtilities.SOURCE + VisualConcept.VertexAttribute.IDENTIFIER, \"+123456789\");\n         expResult.set(GraphRecordStoreUtilities.SOURCE + AnalyticConcept.VertexAttribute.TYPE, AnalyticConcept.VertexType.TELEPHONE_IDENTIFIER);\n         expResult.set(GraphRecordStoreUtilities.DESTINATION + VisualConcept.VertexAttribute.IDENTIFIER, \"192.168.1.1\");\n-        expResult.set(GraphRecordStoreUtilities.DESTINATION + AnalyticConcept.VertexAttribute.TYPE, AnalyticConcept.VertexType.URL);\n+        expResult.set(GraphRecordStoreUtilities.DESTINATION + AnalyticConcept.VertexAttribute.TYPE, AnalyticConcept.VertexType.HOST_NAME);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA1NDk0NQ=="}, "originalCommit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NjAyOTcw", "url": "https://github.com/constellation-app/constellation/pull/568#pullrequestreview-427602970", "createdAt": "2020-06-09T23:02:24Z", "commit": {"oid": "e21df02894d567fd829e0e6839a54b5a58ef4bcd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3553, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}