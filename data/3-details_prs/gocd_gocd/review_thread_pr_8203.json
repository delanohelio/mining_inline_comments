{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NTU4OTc4", "number": 8203, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwOTozNTozOFrOEBq2Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMDozMTo1N1rOEBr-4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMTg2MDAzOnYy", "diffSide": "LEFT", "path": "buildSrc/src/main/resources/gocd-docker-server/Dockerfile.server.ftl", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwOTozNTozOFrOGdp3AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwNToxNzo1NFrOGeMXcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc0NzcxMw==", "bodyText": "My worry about this is that will silently break if the structure of the zip changes. I tried this locally and the files copied over are 197MB and the files left behind due to this are 17MB. Not sure if the risk is worth that.\nAlso, there is a LICENSE file there, that would be nice to copy over, if going with this.", "url": "https://github.com/gocd/gocd/pull/8203#discussion_r433747713", "createdAt": "2020-06-02T09:35:38Z", "author": {"login": "arvindsv"}, "path": "buildSrc/src/main/resources/gocd-docker-server/Dockerfile.server.ftl", "diffHunk": "@@ -28,10 +28,18 @@ RUN \\\n   curl --fail --location --silent --show-error \"https://download.gocd.org/binaries/${fullVersion}/generic/go-server-${fullVersion}.zip\" > /tmp/go-server-${fullVersion}.zip\n </#if>\n RUN unzip /tmp/go-server-${fullVersion}.zip -d /\n-RUN mv /go-server-${goVersion} /go-server && chown -R ${r\"${UID}\"}:0 /go-server && chmod -R g=u /go-server", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0b49e6935918ef9a412d44dffd7b23d08e6d96d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA0MzY0MQ==", "bodyText": "There are windows, mac, freebsd etc files that are not needed to run on alpine. But, yeah, I guess I'll remove this change if you think that the structure is likely to change.", "url": "https://github.com/gocd/gocd/pull/8203#discussion_r434043641", "createdAt": "2020-06-02T17:19:38Z", "author": {"login": "varshavaradarajan"}, "path": "buildSrc/src/main/resources/gocd-docker-server/Dockerfile.server.ftl", "diffHunk": "@@ -28,10 +28,18 @@ RUN \\\n   curl --fail --location --silent --show-error \"https://download.gocd.org/binaries/${fullVersion}/generic/go-server-${fullVersion}.zip\" > /tmp/go-server-${fullVersion}.zip\n </#if>\n RUN unzip /tmp/go-server-${fullVersion}.zip -d /\n-RUN mv /go-server-${goVersion} /go-server && chown -R ${r\"${UID}\"}:0 /go-server && chmod -R g=u /go-server", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc0NzcxMw=="}, "originalCommit": {"oid": "d0b49e6935918ef9a412d44dffd7b23d08e6d96d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA0ODYyNg==", "bodyText": "Not sure if it's likely to change, but I'd like something to fail in an obvious way if it changes ...", "url": "https://github.com/gocd/gocd/pull/8203#discussion_r434048626", "createdAt": "2020-06-02T17:27:34Z", "author": {"login": "arvindsv"}, "path": "buildSrc/src/main/resources/gocd-docker-server/Dockerfile.server.ftl", "diffHunk": "@@ -28,10 +28,18 @@ RUN \\\n   curl --fail --location --silent --show-error \"https://download.gocd.org/binaries/${fullVersion}/generic/go-server-${fullVersion}.zip\" > /tmp/go-server-${fullVersion}.zip\n </#if>\n RUN unzip /tmp/go-server-${fullVersion}.zip -d /\n-RUN mv /go-server-${goVersion} /go-server && chown -R ${r\"${UID}\"}:0 /go-server && chmod -R g=u /go-server", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc0NzcxMw=="}, "originalCommit": {"oid": "d0b49e6935918ef9a412d44dffd7b23d08e6d96d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMxMzA3NQ==", "bodyText": "I guess if something important does change, docker run will fail to start the server. There used to be some docker tests we were running to make sure basic things(bringing up a server and all agents) worked. I don't see it on build.go.cd anymore though.\nThis: https://github.com/gocd/docker-test", "url": "https://github.com/gocd/gocd/pull/8203#discussion_r434313075", "createdAt": "2020-06-03T05:17:54Z", "author": {"login": "varshavaradarajan"}, "path": "buildSrc/src/main/resources/gocd-docker-server/Dockerfile.server.ftl", "diffHunk": "@@ -28,10 +28,18 @@ RUN \\\n   curl --fail --location --silent --show-error \"https://download.gocd.org/binaries/${fullVersion}/generic/go-server-${fullVersion}.zip\" > /tmp/go-server-${fullVersion}.zip\n </#if>\n RUN unzip /tmp/go-server-${fullVersion}.zip -d /\n-RUN mv /go-server-${goVersion} /go-server && chown -R ${r\"${UID}\"}:0 /go-server && chmod -R g=u /go-server", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc0NzcxMw=="}, "originalCommit": {"oid": "d0b49e6935918ef9a412d44dffd7b23d08e6d96d"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMjA0NjQwOnYy", "diffSide": "LEFT", "path": "buildSrc/src/main/groovy/com/thoughtworks/go/build/docker/Distro.groovy", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMDozMTo1N1rOGdruhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNzoxNToyOFrOGd7xkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc3ODMwOQ==", "bodyText": "I see we use curl later here. ls it not needed?", "url": "https://github.com/gocd/gocd/pull/8203#discussion_r433778309", "createdAt": "2020-06-02T10:31:57Z", "author": {"login": "arvindsv"}, "path": "buildSrc/src/main/groovy/com/thoughtworks/go/build/docker/Distro.groovy", "diffHunk": "@@ -54,7 +54,7 @@ enum Distro implements DistroBehavior {\n       return [\n         '# install glibc and zlib for adoptopenjdk',\n         '# See https://github.com/AdoptOpenJDK/openjdk-docker/blob/ce8b120411b131e283106ab89ea5921ebb1d1759/8/jdk/alpine/Dockerfile.hotspot.releases.slim#L24-L54',\n-        '  apk add --no-cache --virtual .build-deps curl binutils',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0b49e6935918ef9a412d44dffd7b23d08e6d96d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA0MTIzMg==", "bodyText": "We have already added curl", "url": "https://github.com/gocd/gocd/pull/8203#discussion_r434041232", "createdAt": "2020-06-02T17:15:28Z", "author": {"login": "varshavaradarajan"}, "path": "buildSrc/src/main/groovy/com/thoughtworks/go/build/docker/Distro.groovy", "diffHunk": "@@ -54,7 +54,7 @@ enum Distro implements DistroBehavior {\n       return [\n         '# install glibc and zlib for adoptopenjdk',\n         '# See https://github.com/AdoptOpenJDK/openjdk-docker/blob/ce8b120411b131e283106ab89ea5921ebb1d1759/8/jdk/alpine/Dockerfile.hotspot.releases.slim#L24-L54',\n-        '  apk add --no-cache --virtual .build-deps curl binutils',", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc3ODMwOQ=="}, "originalCommit": {"oid": "d0b49e6935918ef9a412d44dffd7b23d08e6d96d"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2853, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}