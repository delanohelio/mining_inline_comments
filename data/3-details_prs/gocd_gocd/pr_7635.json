{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NjQ2MDM2", "number": 7635, "title": "Enable Elastic Agent Status Report button for users with view permission for elastic profile (#7549)", "bodyText": "Issue: #7549", "createdAt": "2020-01-20T05:13:38Z", "url": "https://github.com/gocd/gocd/pull/7635", "merged": true, "mergeCommit": {"oid": "d221bb8c503c6389aec82e5c0ae4b3278bf4338b"}, "closed": true, "closedAt": "2020-01-20T05:56:36Z", "author": {"login": "GaneshSPatil"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8GBDdAH2gAyMzY0NjQ2MDM2OmViOTI0ZTZjOTc4YTk4ODMxOGM0MWEyZjU0YjMxY2YzZDQzNDE1ZmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8GF0JAFqTM0NTA5MTI4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eb924e6c978a988318c41a2f54b31cf3d43415fe", "author": {"user": {"login": "GaneshSPatil", "name": "Ganesh S Patil"}}, "url": "https://github.com/gocd/gocd/commit/eb924e6c978a988318c41a2f54b31cf3d43415fe", "committedDate": "2020-01-20T05:50:58Z", "message": "Enable Elastic Agent Status Report button for users with view permission for elastic profile (#7549)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5a94be64dfcd3365d7eed0c2f0c4bc3f41e9ae0d", "author": {"user": {"login": "GaneshSPatil", "name": "Ganesh S Patil"}}, "url": "https://github.com/gocd/gocd/commit/5a94be64dfcd3365d7eed0c2f0c4bc3f41e9ae0d", "committedDate": "2020-01-20T05:13:05Z", "message": "Enable Elastic Agent Status Report button for users with view permission for elastic profile (#7549)"}, "afterCommit": {"oid": "eb924e6c978a988318c41a2f54b31cf3d43415fe", "author": {"user": {"login": "GaneshSPatil", "name": "Ganesh S Patil"}}, "url": "https://github.com/gocd/gocd/commit/eb924e6c978a988318c41a2f54b31cf3d43415fe", "committedDate": "2020-01-20T05:50:58Z", "message": "Enable Elastic Agent Status Report button for users with view permission for elastic profile (#7549)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MDkxMjgy", "url": "https://github.com/gocd/gocd/pull/7635#pullrequestreview-345091282", "createdAt": "2020-01-20T05:56:09Z", "commit": {"oid": "eb924e6c978a988318c41a2f54b31cf3d43415fe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwNTo1NjowOVrOFfUFvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwNTo1NjowOVrOFfUFvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3OTMyNg==", "bodyText": "This method needs to be removed.\nInstead, use AbstractAuthenticationHelper.doesUserHasPermissions\nAs of today, JobController can not autowire ApiAuthenticationHelper component, as it is a circular dependency (Requires dependency on module 'com.thoughtworks.go.api-base.main').\nTo refactor this,\nWe will need to move the Authorization related to methods from AbstractAuthenticationHelper to SecurityService.", "url": "https://github.com/gocd/gocd/pull/7635#discussion_r368379326", "createdAt": "2020-01-20T05:56:09Z", "author": {"login": "GaneshSPatil"}, "path": "server/src/main/java/com/thoughtworks/go/server/service/SecurityService.java", "diffHunk": "@@ -207,6 +209,30 @@ public boolean isAuthorizedToViewTemplates(Username username) {\n         return goConfigService.cruiseConfig().isAuthorizedToViewTemplates(username.getUsername());\n     }\n \n+    //todo: needs refactoring use AbstractAuthenticationHelper.doesUserHasPermissions\n+    //a specific method to check whether a user has permission to access agent status report has been added\n+    public boolean doesUserHasPermissionsToViewAgentStatusReport(Username username, String elasticAgentProfileId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb924e6c978a988318c41a2f54b31cf3d43415fe"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1989, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}