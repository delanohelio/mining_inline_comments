{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxMjUxMjU3", "number": 8526, "title": "Update material check connection in case pipeline name is not provided", "bodyText": "Issue: #8524\nDescription:\n\nIn case of check connection from new pipeline wizard, the pipeline name is not provided. Hence param expansion was not done.\nBut it also caused the # to not being escaped. Hence, creating a dummy pipeline config object for such cases", "createdAt": "2020-09-07T10:08:57Z", "url": "https://github.com/gocd/gocd/pull/8526", "merged": true, "mergeCommit": {"oid": "31e57840549f1e0e90747c97511278184de28dcc"}, "closed": true, "closedAt": "2020-09-07T10:50:18Z", "author": {"login": "kritika-singh3"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdGf9WfgH2gAyNDgxMjUxMjU3OmMyYmE1NmIzYjZlMTRhOTEyMWE0NDg4M2YzNTg0YWY0MTMzZTQ1NWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdGu6YfgFqTQ4Mzc3MDcwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c2ba56b3b6e14a9121a44883f3584af4133e455e", "author": {"user": {"login": "kritika-singh3", "name": "Kritika"}}, "url": "https://github.com/gocd/gocd/commit/c2ba56b3b6e14a9121a44883f3584af4133e455e", "committedDate": "2020-09-07T09:54:51Z", "message": "Update material check connection in case pipeline name is not provided\n\n - In case of check connection from new pipeline wizard, the pipeline name is not provided. Hence param expansion was not done.\n   But it also caused the # to not being escaped. Hence, creating a dummy pipeline config object for such cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNzcwNzA4", "url": "https://github.com/gocd/gocd/pull/8526#pullrequestreview-483770708", "createdAt": "2020-09-08T03:20:11Z", "commit": {"oid": "c2ba56b3b6e14a9121a44883f3584af4133e455e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwMzoyMDoxMVrOHOLYMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwMzoyMDoxMVrOHOLYMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDYyODUyOQ==", "bodyText": "@kritika-singh3 do you think we can add a test for these scenarios over adding a comment?", "url": "https://github.com/gocd/gocd/pull/8526#discussion_r484628529", "createdAt": "2020-09-08T03:20:11Z", "author": {"login": "maheshp"}, "path": "api/api-abstract-material-test/src/main/java/com/thoughtworks/go/api/abstractmaterialtest/AbstractMaterialTestController.java", "diffHunk": "@@ -126,12 +123,18 @@ private String handleValidationBeanResponse(ValidationBean validationBean, Respo\n     }\n \n     private void performParamExpansion(ScmMaterialConfig scmMaterialConfig, String pipelineName) {\n-        PipelineConfig existingPipeline = goConfigService.pipelineConfigNamed(new CaseInsensitiveString(pipelineName));\n-        PipelineConfig pipelineConfig = new PipelineConfig(existingPipeline.name(), new MaterialConfigs());\n-\n-        GoConfigCloner goConfigCloner = new GoConfigCloner();\n-        pipelineConfig.setParams(goConfigCloner.deepClone(existingPipeline.getParams()));\n+        PipelineConfig pipelineConfig;\n+        // If the pipeline name is provided, find the pipeline and add the params to the new pipeline config object\n+        if (isNotBlank(pipelineName)) {\n+            PipelineConfig existingPipeline = goConfigService.pipelineConfigNamed(new CaseInsensitiveString(pipelineName));\n+            pipelineConfig = new PipelineConfig(existingPipeline.name(), new MaterialConfigs());\n \n+            GoConfigCloner goConfigCloner = new GoConfigCloner();\n+            pipelineConfig.setParams(goConfigCloner.deepClone(existingPipeline.getParams()));\n+        } else {\n+            // If the pipeline name is not provided, this means that the pipeline is still in creation nd hence no params exist", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2ba56b3b6e14a9121a44883f3584af4133e455e"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1863, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}