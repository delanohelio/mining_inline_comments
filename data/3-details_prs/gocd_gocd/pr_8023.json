{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1ODE4NTY4", "number": 8023, "title": "Webhook triggers for configrepo branch support", "bodyText": "This PR introduces 2 shiny, new things:\n\nA new webhook endpoint, specifically for config repos: /go/api/webhooks/:provider/config_repos/:id\nA UI component that builds the webhook URL for a given config repo to help the user set them up properly on their chosen provider (GitHub, Bitbucket, and friends)\n\nSo how does this help PR/branch support?\nCurrently, PR support queries your git provider's APIs to refresh the list of pull requests. As such, the resulting pipeline configurations can change even if there are no code changes to your config repo definitions. Because of this, config repos need to poll the APIs regularly, which is probably fine for a small amount of config repos. However, if one has many config repos that take advantage of PR support, this won't scale. What we need are webhooks that notify config repos when a pull request is opened or closed/merged, in addition to when there is a code push so that GoCD only queries the API when a real change has happened.\nContext: Why can't the existing webhooks suffice?\nGreat question.\n\nFirstly, the current \"notify\" endpoints do not support any pull/merge request-related events, but only push (and ping, when applicable)\nSecondly, the notify endpoints locate materials by heuristics based on the repository identity reported by the POST payload (by guessing the material URL); this won't work because:\n\nConfig repo materials are not necessarily related to the materials owned by the pipelines one defines in the config repo\nFor example, one might have a disparate private (or filesystem-local) repo that only holds pipeline definitions for that use the GitHub repo you are interested in. The webhook must be able to resolve and trigger the config repo if a push or pull request happens. The config repo need not even be a git repo in this case.\nThus, the most straightforward solution is to trigger a specific config repo by its explicit ID, rather than try to figure this out by analyzing the payload\n\n\n\nNotable changes\n\nMajor refactor of webhook domain objects\n\nWebhookRequest objects are now decoupled/agnostic to the payload and supported events\n\nThese are responsible for extracting authentication credentials and event names\nWebhookRequest objects no longer need to decide payload/event type before inspecting the raw request; previously this made it difficult to support multiple event and payload types in a single endpoint because it's rather catch-22\n\n\nPayload instances tell WebhookRequest instances how to deserialize request bodies; this happens after WebhookRequest instantiation and after event-type identification\nValidation and authentication now happens in the controller, instead of within the WebhookRequest domain object\n\nMuch of this logic is in reusable mixins and provider-specific helper classes\n\n\n\n\nServer configuration site URLs are now exposed to SPA layouts\nNew helpers to generate base URLs from server configurations falling back to guessing from window.location in the absence of configuration\nNew UI component to build webhook URLs for a specific config repo with instructions on what to configure at the git provider", "createdAt": "2020-04-20T04:38:19Z", "url": "https://github.com/gocd/gocd/pull/8023", "merged": true, "mergeCommit": {"oid": "d1fe2f2a8782bd9917f3240d5cb28d81a30c996b"}, "closed": true, "closedAt": "2020-12-09T04:43:35Z", "author": {"login": "marques-work"}, "timelineItems": {"totalCount": 48, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZj5KPABqjMyNTMxNTU1ODU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkXOG0AH2gAyNDA1ODE4NTY4OjMyMmYwNjMyMjQ3YTY5MjFjOGRjYzNlNDc4MjY3NTI3NDViNGQxYWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b610efb8378e7a0f3d99e67bda937457f22fcd4", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/6b610efb8378e7a0f3d99e67bda937457f22fcd4", "committedDate": "2020-04-20T04:37:13Z", "message": "wip: add github PR type for webhook payloads"}, "afterCommit": {"oid": "b44f6649ec2b8cfe2622662d35d6521f44e43354", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/b44f6649ec2b8cfe2622662d35d6521f44e43354", "committedDate": "2020-04-20T19:03:04Z", "message": "wip: add github PR type for webhook payloads"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b44f6649ec2b8cfe2622662d35d6521f44e43354", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/b44f6649ec2b8cfe2622662d35d6521f44e43354", "committedDate": "2020-04-20T19:03:04Z", "message": "wip: add github PR type for webhook payloads"}, "afterCommit": {"oid": "869aca22b28047898c9ea1912aac7b31fb6d531c", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/869aca22b28047898c9ea1912aac7b31fb6d531c", "committedDate": "2020-06-12T09:32:48Z", "message": "wip: add github PR type for webhook payloads"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "869aca22b28047898c9ea1912aac7b31fb6d531c", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/869aca22b28047898c9ea1912aac7b31fb6d531c", "committedDate": "2020-06-12T09:32:48Z", "message": "wip: add github PR type for webhook payloads"}, "afterCommit": {"oid": "920402ed98512a1ee31da07b3391413db0fcc734", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/920402ed98512a1ee31da07b3391413db0fcc734", "committedDate": "2020-06-29T18:43:52Z", "message": "wip: add github PR type for webhook payloads"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b32add2f4d9189e3d59aa0bca81cc25d654400f2", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/b32add2f4d9189e3d59aa0bca81cc25d654400f2", "committedDate": "2020-06-30T10:56:47Z", "message": "wip"}, "afterCommit": {"oid": "3ba023076a1a9cbf3287dd91344264064892c089", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/3ba023076a1a9cbf3287dd91344264064892c089", "committedDate": "2020-07-03T01:22:05Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ba023076a1a9cbf3287dd91344264064892c089", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/3ba023076a1a9cbf3287dd91344264064892c089", "committedDate": "2020-07-03T01:22:05Z", "message": "wip"}, "afterCommit": {"oid": "a0754c26e0505e9ae89eab94931d4aed35e5dfc1", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/a0754c26e0505e9ae89eab94931d4aed35e5dfc1", "committedDate": "2020-07-08T10:27:09Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a0754c26e0505e9ae89eab94931d4aed35e5dfc1", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/a0754c26e0505e9ae89eab94931d4aed35e5dfc1", "committedDate": "2020-07-08T10:27:09Z", "message": "wip"}, "afterCommit": {"oid": "865a153147c2805a2837ab2631d86ba1338a9e94", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/865a153147c2805a2837ab2631d86ba1338a9e94", "committedDate": "2020-07-11T05:10:27Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "865a153147c2805a2837ab2631d86ba1338a9e94", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/865a153147c2805a2837ab2631d86ba1338a9e94", "committedDate": "2020-07-11T05:10:27Z", "message": "wip"}, "afterCommit": {"oid": "512fbce235f92efdb41010345287fa18956094c9", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/512fbce235f92efdb41010345287fa18956094c9", "committedDate": "2020-10-05T16:30:32Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e25f75629ab65f8bb05f5a4509cec769bfca5d30", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/e25f75629ab65f8bb05f5a4509cec769bfca5d30", "committedDate": "2020-10-07T20:52:54Z", "message": "wip"}, "afterCommit": {"oid": "4966465ff8953f941c69981420704ccc30817b14", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/4966465ff8953f941c69981420704ccc30817b14", "committedDate": "2020-10-14T22:05:55Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4966465ff8953f941c69981420704ccc30817b14", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/4966465ff8953f941c69981420704ccc30817b14", "committedDate": "2020-10-14T22:05:55Z", "message": "wip"}, "afterCommit": {"oid": "efadcbe5dc3af509cb9ac2d500bbcda0423c23e4", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/efadcbe5dc3af509cb9ac2d500bbcda0423c23e4", "committedDate": "2020-10-14T22:47:23Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c5f7e268c411da311d7060fd722b1d5ab57a2895", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/c5f7e268c411da311d7060fd722b1d5ab57a2895", "committedDate": "2020-10-14T22:54:49Z", "message": "Remove validation that required `autoUpdate == true` on `ConfigRepoConfig`"}, "afterCommit": {"oid": "5fd1ea74faab8af68c30ba53fdd942f8300be83b", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/5fd1ea74faab8af68c30ba53fdd942f8300be83b", "committedDate": "2020-10-14T23:34:49Z", "message": "Remove validation that required `autoUpdate == true` on `ConfigRepoConfig`"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5fd1ea74faab8af68c30ba53fdd942f8300be83b", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/5fd1ea74faab8af68c30ba53fdd942f8300be83b", "committedDate": "2020-10-14T23:34:49Z", "message": "Remove validation that required `autoUpdate == true` on `ConfigRepoConfig`"}, "afterCommit": {"oid": "16a2a878daf04662ec278e5e5f115d0481519215", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/16a2a878daf04662ec278e5e5f115d0481519215", "committedDate": "2020-10-16T00:05:53Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16a2a878daf04662ec278e5e5f115d0481519215", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/16a2a878daf04662ec278e5e5f115d0481519215", "committedDate": "2020-10-16T00:05:53Z", "message": "wip"}, "afterCommit": {"oid": "f360fe376a44e4138b7f5672de89c905c122e5b2", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/f360fe376a44e4138b7f5672de89c905c122e5b2", "committedDate": "2020-10-19T11:09:43Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f360fe376a44e4138b7f5672de89c905c122e5b2", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/f360fe376a44e4138b7f5672de89c905c122e5b2", "committedDate": "2020-10-19T11:09:43Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "cd74b2b2de4dfe580639126cff3359c770e5bed7", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/cd74b2b2de4dfe580639126cff3359c770e5bed7", "committedDate": "2020-10-19T14:44:40Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cd74b2b2de4dfe580639126cff3359c770e5bed7", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/cd74b2b2de4dfe580639126cff3359c770e5bed7", "committedDate": "2020-10-19T14:44:40Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "e15d20445ccdc42cfe6364b2db63d55caa038b19", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/e15d20445ccdc42cfe6364b2db63d55caa038b19", "committedDate": "2020-10-20T01:55:04Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e15d20445ccdc42cfe6364b2db63d55caa038b19", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/e15d20445ccdc42cfe6364b2db63d55caa038b19", "committedDate": "2020-10-20T01:55:04Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "269818c8e7a49c29d51137e43322c13228c981ee", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/269818c8e7a49c29d51137e43322c13228c981ee", "committedDate": "2020-10-20T08:15:14Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "269818c8e7a49c29d51137e43322c13228c981ee", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/269818c8e7a49c29d51137e43322c13228c981ee", "committedDate": "2020-10-20T08:15:14Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "2883fab6667b56acf185f016689ac9496636dbf8", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/2883fab6667b56acf185f016689ac9496636dbf8", "committedDate": "2020-10-20T09:48:59Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2883fab6667b56acf185f016689ac9496636dbf8", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/2883fab6667b56acf185f016689ac9496636dbf8", "committedDate": "2020-10-20T09:48:59Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "5d02feeb8a31e54db365bfeb8fa26d14e32fde0d", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/5d02feeb8a31e54db365bfeb8fa26d14e32fde0d", "committedDate": "2020-10-20T10:04:23Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d02feeb8a31e54db365bfeb8fa26d14e32fde0d", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/5d02feeb8a31e54db365bfeb8fa26d14e32fde0d", "committedDate": "2020-10-20T10:04:23Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "1ba6a599c4403e4d6ad85f82331241053151aa1b", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/1ba6a599c4403e4d6ad85f82331241053151aa1b", "committedDate": "2020-10-21T06:25:42Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ba6a599c4403e4d6ad85f82331241053151aa1b", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/1ba6a599c4403e4d6ad85f82331241053151aa1b", "committedDate": "2020-10-21T06:25:42Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "8208ad976ed8ff7d6ec63a24f91a53599e9f1964", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/8208ad976ed8ff7d6ec63a24f91a53599e9f1964", "committedDate": "2020-10-21T08:06:26Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8208ad976ed8ff7d6ec63a24f91a53599e9f1964", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/8208ad976ed8ff7d6ec63a24f91a53599e9f1964", "committedDate": "2020-10-21T08:06:26Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "c244d4563bbbc49844005d9c4b3cc1c62e868b3d", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/c244d4563bbbc49844005d9c4b3cc1c62e868b3d", "committedDate": "2020-10-21T10:21:38Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c244d4563bbbc49844005d9c4b3cc1c62e868b3d", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/c244d4563bbbc49844005d9c4b3cc1c62e868b3d", "committedDate": "2020-10-21T10:21:38Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "51072e589c357a07d8f172d5cb8c2d4958cc2763", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/51072e589c357a07d8f172d5cb8c2d4958cc2763", "committedDate": "2020-10-23T02:31:40Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51072e589c357a07d8f172d5cb8c2d4958cc2763", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/51072e589c357a07d8f172d5cb8c2d4958cc2763", "committedDate": "2020-10-23T02:31:40Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "315a64cc9ef1e50a4667a1ec80bdf310bf44a1b6", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/315a64cc9ef1e50a4667a1ec80bdf310bf44a1b6", "committedDate": "2020-10-26T04:21:12Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "315a64cc9ef1e50a4667a1ec80bdf310bf44a1b6", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/315a64cc9ef1e50a4667a1ec80bdf310bf44a1b6", "committedDate": "2020-10-26T04:21:12Z", "message": "wip: add new pull request webhook endpoint for configrepos"}, "afterCommit": {"oid": "ced98e83af375a0030c293767f4bb13054e76ea7", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/ced98e83af375a0030c293767f4bb13054e76ea7", "committedDate": "2020-10-26T13:49:57Z", "message": "wip: add new pull request webhook endpoint for configrepos"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f6eaeacad49083baa1e272c98b66b0fc8384d92", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/4f6eaeacad49083baa1e272c98b66b0fc8384d92", "committedDate": "2020-11-03T03:50:24Z", "message": "wip2"}, "afterCommit": {"oid": "ddaeb03d773dc7b93ae413ca32a9cd324ae911c7", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/ddaeb03d773dc7b93ae413ca32a9cd324ae911c7", "committedDate": "2020-11-04T04:24:17Z", "message": "wip2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ddaeb03d773dc7b93ae413ca32a9cd324ae911c7", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/ddaeb03d773dc7b93ae413ca32a9cd324ae911c7", "committedDate": "2020-11-04T04:24:17Z", "message": "wip2"}, "afterCommit": {"oid": "e1c28f60230bc2db32c1320f65bd6a74fd2c9001", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/e1c28f60230bc2db32c1320f65bd6a74fd2c9001", "committedDate": "2020-11-10T06:03:16Z", "message": "wip2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9d813fb1ba08899b321dbc7ec773c8447c54c061", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/9d813fb1ba08899b321dbc7ec773c8447c54c061", "committedDate": "2020-11-13T05:17:05Z", "message": "wip3"}, "afterCommit": {"oid": "fa0615946d2acbc9a1cb953d27344b978a06082f", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/fa0615946d2acbc9a1cb953d27344b978a06082f", "committedDate": "2020-11-13T05:48:53Z", "message": "wip3"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4fcd78dc2dd7bb16e1a8652346033d863683c5f0", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/4fcd78dc2dd7bb16e1a8652346033d863683c5f0", "committedDate": "2020-11-17T03:20:40Z", "message": "for fox sake, finally. tests are refactored."}, "afterCommit": {"oid": "4ef7be4fb6daefbb8609f17452f0d9d8732de7af", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/4ef7be4fb6daefbb8609f17452f0d9d8732de7af", "committedDate": "2020-11-17T03:56:41Z", "message": "whitespc"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ef7be4fb6daefbb8609f17452f0d9d8732de7af", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/4ef7be4fb6daefbb8609f17452f0d9d8732de7af", "committedDate": "2020-11-17T03:56:41Z", "message": "whitespc"}, "afterCommit": {"oid": "5931b345ad8b9442e233eaa241f6587dfedcf93b", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/5931b345ad8b9442e233eaa241f6587dfedcf93b", "committedDate": "2020-11-17T05:00:35Z", "message": "whitespc"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d147049e78afde4c63c98da7cfc73d2b81c556a2", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/d147049e78afde4c63c98da7cfc73d2b81c556a2", "committedDate": "2020-11-17T05:07:13Z", "message": "optimize js/ts imports"}, "afterCommit": {"oid": "05381e6ba76f7a93fed6712e021b6f7b90459fbb", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/05381e6ba76f7a93fed6712e021b6f7b90459fbb", "committedDate": "2020-11-18T00:26:16Z", "message": "wip fleshing out PR payload, some rethinking too"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05381e6ba76f7a93fed6712e021b6f7b90459fbb", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/05381e6ba76f7a93fed6712e021b6f7b90459fbb", "committedDate": "2020-11-18T00:26:16Z", "message": "wip fleshing out PR payload, some rethinking too"}, "afterCommit": {"oid": "eaf9eae3c312c7cfb3dd49aff6cb267459019097", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/eaf9eae3c312c7cfb3dd49aff6cb267459019097", "committedDate": "2020-11-18T02:41:19Z", "message": "wip fleshing out PR payload, some rethinking too"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eaf9eae3c312c7cfb3dd49aff6cb267459019097", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/eaf9eae3c312c7cfb3dd49aff6cb267459019097", "committedDate": "2020-11-18T02:41:19Z", "message": "wip fleshing out PR payload, some rethinking too"}, "afterCommit": {"oid": "8c683c173177b0093a8ca2670f5eea57b72abf3c", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/8c683c173177b0093a8ca2670f5eea57b72abf3c", "committedDate": "2020-11-19T05:53:08Z", "message": "wip fleshing out PR payload, some rethinking too"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d0c5b2139326ccd57f7cc845b94cd53be4b8433c", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/d0c5b2139326ccd57f7cc845b94cd53be4b8433c", "committedDate": "2020-11-19T10:22:48Z", "message": "Flesh out PR payloads and tests"}, "afterCommit": {"oid": "1d7ceda63db3f21cecb408a419e6718051e1fa2b", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/1d7ceda63db3f21cecb408a419e6718051e1fa2b", "committedDate": "2020-11-19T10:23:13Z", "message": "Flesh out PR payloads and tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d7ceda63db3f21cecb408a419e6718051e1fa2b", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/1d7ceda63db3f21cecb408a419e6718051e1fa2b", "committedDate": "2020-11-19T10:23:13Z", "message": "Flesh out PR payloads and tests"}, "afterCommit": {"oid": "819644dc101eb1379afe29fb104fe21a853f9f9c", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/819644dc101eb1379afe29fb104fe21a853f9f9c", "committedDate": "2020-11-23T12:17:40Z", "message": "full controller coverage"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dbf16b3335ba1df6f2a7f69f6f09cb51f6ed3c41", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/dbf16b3335ba1df6f2a7f69f6f09cb51f6ed3c41", "committedDate": "2020-11-24T16:07:33Z", "message": "wip-ui"}, "afterCommit": {"oid": "4602b4ad548560f8c5b167ced359b5c45e47af9d", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/4602b4ad548560f8c5b167ced359b5c45e47af9d", "committedDate": "2020-11-25T12:09:59Z", "message": "ui"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4602b4ad548560f8c5b167ced359b5c45e47af9d", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/4602b4ad548560f8c5b167ced359b5c45e47af9d", "committedDate": "2020-11-25T12:09:59Z", "message": "ui"}, "afterCommit": {"oid": "a9c210337106a53300ffd0698572392f9cf86be1", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/a9c210337106a53300ffd0698572392f9cf86be1", "committedDate": "2020-12-01T05:41:52Z", "message": "ui"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9c210337106a53300ffd0698572392f9cf86be1", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/a9c210337106a53300ffd0698572392f9cf86be1", "committedDate": "2020-12-01T05:41:52Z", "message": "ui"}, "afterCommit": {"oid": "33e4782471c1f8f6c4dccc9365e6dd7cbfe7f82b", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/33e4782471c1f8f6c4dccc9365e6dd7cbfe7f82b", "committedDate": "2020-12-03T08:31:23Z", "message": "ui"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aaff1c166e99b9995b67d499f71a527bd7e533aa", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/aaff1c166e99b9995b67d499f71a527bd7e533aa", "committedDate": "2020-12-03T12:36:12Z", "message": "ui2"}, "afterCommit": {"oid": "eec8baf36c45feb32098a67c27335a39dc53e032", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/eec8baf36c45feb32098a67c27335a39dc53e032", "committedDate": "2020-12-04T21:16:53Z", "message": "ui2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a1e9d641a94b75d1ea66e972a2e24ac0c6814b7", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/0a1e9d641a94b75d1ea66e972a2e24ac0c6814b7", "committedDate": "2020-12-07T00:06:00Z", "message": "tweak ui"}, "afterCommit": {"oid": "f3c53ccfb7a6ec65be143b600a6e4f2fb9db6b71", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/f3c53ccfb7a6ec65be143b600a6e4f2fb9db6b71", "committedDate": "2020-12-07T00:08:46Z", "message": "wip-ui\n\nui\n\nui\n\nui2\n\ntweak ui"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3c53ccfb7a6ec65be143b600a6e4f2fb9db6b71", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/f3c53ccfb7a6ec65be143b600a6e4f2fb9db6b71", "committedDate": "2020-12-07T00:08:46Z", "message": "wip-ui\n\nui\n\nui\n\nui2\n\ntweak ui"}, "afterCommit": {"oid": "d2bc7f527029a11a7c5114ae0c4478578a72fe8e", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/d2bc7f527029a11a7c5114ae0c4478578a72fe8e", "committedDate": "2020-12-07T03:50:50Z", "message": "Update lombok so it works on the latest IDEA"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d2bc7f527029a11a7c5114ae0c4478578a72fe8e", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/d2bc7f527029a11a7c5114ae0c4478578a72fe8e", "committedDate": "2020-12-07T03:50:50Z", "message": "Update lombok so it works on the latest IDEA"}, "afterCommit": {"oid": "ad6cfe214858d7f58e866dafea77eeaccb589a99", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/ad6cfe214858d7f58e866dafea77eeaccb589a99", "committedDate": "2020-12-07T05:27:45Z", "message": "Update lombok so it works on the latest IDEA"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01a7d0df12d0688e0487ac47ed4084d9f4e8a2b8", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/01a7d0df12d0688e0487ac47ed4084d9f4e8a2b8", "committedDate": "2020-12-07T05:30:23Z", "message": "Include configured server site urls in the base layout so we can build URLs client-side"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aec09a6eb2f20f50bf746e5ead1423e473442ece", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/aec09a6eb2f20f50bf746e5ead1423e473442ece", "committedDate": "2020-12-07T05:32:26Z", "message": "Introduce endpoint for config repo webhooks\n\nPath: `/go/api/webhooks/:provider/config_repos/:repoId`\n\n- Responds to both push and pull request events\n- Triggers an arbitrary config repo based on an ID parameter\n    - Config repos need not correspond with the webhook's originating repo\n      as one can store config-as-code definitions in any repostiory\n    - Introduce new payload types for pull requests and associated\n      children\n- Refactor webhook request and payload relationship to facilitate support\n  for multiple event types and conditional payload parsing under a single\n  endpoint\n    - Webhook requests are now payload-independent, and are only\n      concerned with webhook auth, event parsing, and event validation\n    - Webhook payloads are a separate domain object that are only parsed\n      after knowing the event type\n    - Tests refactored to DRY via parameterized tests over payload\n      classes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ad6cfe214858d7f58e866dafea77eeaccb589a99", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/ad6cfe214858d7f58e866dafea77eeaccb589a99", "committedDate": "2020-12-07T05:27:45Z", "message": "Update lombok so it works on the latest IDEA"}, "afterCommit": {"oid": "e16b74f414baaaebfebc38a05cbe78d233f3b7bf", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/e16b74f414baaaebfebc38a05cbe78d233f3b7bf", "committedDate": "2020-12-07T05:34:18Z", "message": "Update lombok so it works on the latest IDEA"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d0ad31e8512e0c7f26c181cd7328ce0fede5d22", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/2d0ad31e8512e0c7f26c181cd7328ce0fede5d22", "committedDate": "2020-12-07T12:22:05Z", "message": "Introduce webhook URL suggestion helper component\n\nThis component generates configrepo webhook URLs for chosen providers.\nIt is shown on the config repo page for config repos where `autoUpdate`\nis set to `false`.\n\nThis relies on a base-URL building utility which first consults any\nconfigured site URL or secure site URL, falling back to guessing the\nbase URL from the `window.location` if neither is configured.\n\nThe component also informs the user of the provider-specific events to\nconfigure the webhook.\n\nThis also introduces a new click-to-copy component that can be composed\nmore flexibly in that it does not rely on an input field. It will probably\nreplace <CopyField/>."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edcbaa703677002ea9b5b08993de396abcf98cd1", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/edcbaa703677002ea9b5b08993de396abcf98cd1", "committedDate": "2020-12-07T12:24:48Z", "message": "Update lombok so it works on the latest IDEA"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e16b74f414baaaebfebc38a05cbe78d233f3b7bf", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/e16b74f414baaaebfebc38a05cbe78d233f3b7bf", "committedDate": "2020-12-07T05:34:18Z", "message": "Update lombok so it works on the latest IDEA"}, "afterCommit": {"oid": "edcbaa703677002ea9b5b08993de396abcf98cd1", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/edcbaa703677002ea9b5b08993de396abcf98cd1", "committedDate": "2020-12-07T12:24:48Z", "message": "Update lombok so it works on the latest IDEA"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NzQ0NzY2", "url": "https://github.com/gocd/gocd/pull/8023#pullrequestreview-546744766", "createdAt": "2020-12-08T04:55:02Z", "commit": {"oid": "2d0ad31e8512e0c7f26c181cd7328ce0fede5d22"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNDo1NTowMlrOIBHBkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwNDo1OToyM1rOIBHHTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODAzNDU3Nw==", "bodyText": "IMO, the default settings for the project is to align on value. Pls verify.", "url": "https://github.com/gocd/gocd/pull/8023#discussion_r538034577", "createdAt": "2020-12-08T04:55:02Z", "author": {"login": "kritika-singh3"}, "path": "server/src/main/webapp/WEB-INF/rails/webpack/views/components/buttons/index.tsx", "diffHunk": "@@ -60,9 +64,9 @@ function dataTestIdAttrs(attrs: Attrs) {\n }\n \n abstract class Button extends RestyleViewComponent<Styles, Attrs> {\n-  css: Styles                                  = defaultStyles;\n+  css: Styles = defaultStyles;\n   ajaxOperationMonitor: Stream<OperationState> = Stream<OperationState>(OperationState.UNKNOWN);\n-  forceSpinner                                 = false;\n+  forceSpinner = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d0ad31e8512e0c7f26c181cd7328ce0fede5d22"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODAzNTA5MA==", "bodyText": "How about using generator instead of page?", "url": "https://github.com/gocd/gocd/pull/8023#discussion_r538035090", "createdAt": "2020-12-08T04:56:21Z", "author": {"login": "kritika-singh3"}, "path": "server/src/main/webapp/WEB-INF/rails/webpack/views/pages/config_repos/config_repos_widget.tsx", "diffHunk": "@@ -14,38 +14,41 @@\n  * limitations under the License.\n  */\n \n-import {docsUrl} from \"gen/gocd_version\";\n-import {MithrilComponent, MithrilViewComponent} from \"jsx/mithril-component\";\n+import { docsUrl } from \"gen/gocd_version\";\n+import { MithrilComponent, MithrilViewComponent } from \"jsx/mithril-component\";\n import _ from \"lodash\";\n import m from \"mithril\";\n import Stream from \"mithril/stream\";\n-import {ConfigRepo, ParseInfo} from \"models/config_repos/types\";\n-import {PluginInfo} from \"models/shared/plugin_infos_new/plugin_info\";\n-import {Anchor, ScrollManager} from \"views/components/anchor/anchor\";\n-import {Code} from \"views/components/code\";\n-import {CollapsiblePanel} from \"views/components/collapsible_panel\";\n-import {FlashMessage, MessageType} from \"views/components/flash_message\";\n-import {HeaderIcon} from \"views/components/header_icon\";\n-import {Delete, Edit, IconGroup, Refresh} from \"views/components/icons\";\n-import {KeyValuePair} from \"views/components/key_value_pair\";\n-import {Link} from \"views/components/link\";\n-import {ShowRulesWidget} from \"views/components/rules/show_rules_widget\";\n-import {RequiresPluginInfos} from \"views/pages/page_operations\";\n-import {allAttributes, resolveHumanReadableAttributes, userDefinedProperties} from \"./config_repo_attribute_helper\";\n-import {CRResult} from \"./config_repo_result\";\n-import {ConfigRepoVM, CRVMAware} from \"./config_repo_view_model\";\n+import { ConfigRepo, ParseInfo } from \"models/config_repos/types\";\n+import { PluginInfo } from \"models/shared/plugin_infos_new/plugin_info\";\n+import { Anchor, ScrollManager } from \"views/components/anchor/anchor\";\n+import { Code } from \"views/components/code\";\n+import { CollapsiblePanel } from \"views/components/collapsible_panel\";\n+import { FlashMessage, MessageType } from \"views/components/flash_message\";\n+import { HeaderIcon } from \"views/components/header_icon\";\n+import { Delete, Edit, IconGroup, Refresh } from \"views/components/icons\";\n+import { KeyValuePair } from \"views/components/key_value_pair\";\n+import { Link } from \"views/components/link\";\n+import { ShowRulesWidget } from \"views/components/rules/show_rules_widget\";\n+import { RequiresPluginInfos } from \"views/pages/page_operations\";\n+import { allAttributes, resolveHumanReadableAttributes, userDefinedProperties } from \"./config_repo_attribute_helper\";\n+import { CRResult } from \"./config_repo_result\";\n+import { ConfigRepoVM, CRVMAware, WebhookUrlGenerator } from \"./config_repo_view_model\";\n import styles from \"./index.scss\";\n+import { WebhookSuggestions } from \"./webhook_suggestions\";\n \n interface CollectionAttrs extends RequiresPluginInfos {\n   models: Stream<ConfigRepoVM[]>;\n   flushEtag: () => void;\n   sm: ScrollManager;\n+  page: WebhookUrlGenerator;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d0ad31e8512e0c7f26c181cd7328ce0fede5d22"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODAzNjA0Nw==", "bodyText": "This should be id: https://docs.gitlab.com/ee/user/project/integrations/webhooks.html#merge-request-events", "url": "https://github.com/gocd/gocd/pull/8023#discussion_r538036047", "createdAt": "2020-12-08T04:59:23Z", "author": {"login": "kritika-singh3"}, "path": "api/api-webhook-v1/src/main/java/com/thoughtworks/go/apiv1/webhook/request/payload/pr/GitLabPR.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright 2020 ThoughtWorks, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.thoughtworks.go.apiv1.webhook.request.payload.pr;\n+\n+import com.google.gson.annotations.SerializedName;\n+import com.thoughtworks.go.apiv1.webhook.request.json.GitLabProject;\n+\n+import static com.thoughtworks.go.apiv1.webhook.request.payload.pr.PrPayload.State.CLOSED;\n+import static com.thoughtworks.go.apiv1.webhook.request.payload.pr.PrPayload.State.OPEN;\n+import static java.lang.String.format;\n+\n+@SuppressWarnings({\"unused\", \"RedundantSuppression\"})\n+public class GitLabPR implements PrPayload {\n+    private GitLabProject project;\n+\n+    @SerializedName(\"object_attributes\")\n+    private Attrs attrs;\n+\n+    @Override\n+    public String identifier() {\n+        return format(\"#%d\", attrs.number);\n+    }\n+\n+    @Override\n+    public State state() {\n+        return \"opened\".equals(attrs.state) ? OPEN : CLOSED;\n+    }\n+\n+    @Override\n+    public String hostname() {\n+        return project.hostname();\n+    }\n+\n+    @Override\n+    public String fullName() {\n+        return project.fullName();\n+    }\n+\n+    private static class Attrs {\n+        @SerializedName(\"iid\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aec09a6eb2f20f50bf746e5ead1423e473442ece"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "322f0632247a6921c8dcc3e47826752745b4d1ae", "author": {"user": {"login": "marques-work", "name": null}}, "url": "https://github.com/gocd/gocd/commit/322f0632247a6921c8dcc3e47826752745b4d1ae", "committedDate": "2020-12-09T04:41:44Z", "message": "Rename field `page` => `urlGenerator` for clarity; also restore assignment operator alignment in `buttons/index.tsx`"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1904, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}