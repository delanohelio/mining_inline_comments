{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3MTU1MTA4", "number": 8557, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwODo1MTo1NVrOEqoWZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMjoyMFrOEqomlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTM2NzQzOnYy", "diffSide": "LEFT", "path": "build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwODo1MTo1NVrOHc8aeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwODo1MTo1NVrOHc8aeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDExMTk5NA==", "bodyText": "This bit is partly redundant since compileClasspath already extendsFrom compileOnly.\nAdding the compileClasspath to test{Compile,Runtime}Classpath is achieved on line 296:\n    // it's rather convenient to allow compile and runtime classpaths for tests inherit from the main compile classpath\n    testImplementation.extendsFrom compileClasspath", "url": "https://github.com/gocd/gocd/pull/8557#discussion_r500111994", "createdAt": "2020-10-06T08:51:55Z", "author": {"login": "marques-work"}, "path": "build.gradle", "diffHunk": "@@ -423,42 +483,11 @@ subprojects {\n       fatJarConfig\n \n       testOutput {\n-        extendsFrom testRuntime\n+        extendsFrom testRuntimeClasspath\n         transitive = true\n       }\n     }\n \n-    sourceSets {\n-      main {\n-        java {\n-          compileClasspath += configurations.compileOnly\n-        }\n-      }\n-      test {\n-        java {\n-          compileClasspath += configurations.compileOnly\n-          runtimeClasspath += configurations.compileOnly\n-        }\n-      }\n-    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "743babf458061a811c349043f13e1f947666b40b"}, "originalPosition": 131}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTM5MDQzOnYy", "diffSide": "LEFT", "path": "server/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwODo1NzoyOFrOHc8o1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwODo1NzoyOFrOHc8o1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDExNTY2OA==", "bodyText": "None of these were used (anymore?).", "url": "https://github.com/gocd/gocd/pull/8557#discussion_r500115668", "createdAt": "2020-10-06T08:57:28Z", "author": {"login": "marques-work"}, "path": "server/build.gradle", "diffHunk": "@@ -88,14 +88,7 @@ sourceSets {\n configurations {\n   jrubyGems\n \n-  sharedTestCompile.extendsFrom testCompile\n-  sharedTestRuntime.extendsFrom testRuntime\n-\n-  fastUnitTestCompile.extendsFrom sharedTestCompile\n-  fastUnitTestRuntime.extendsFrom sharedTestRuntime", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "743babf458061a811c349043f13e1f947666b40b"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTQwMjI4OnYy", "diffSide": "LEFT", "path": "server/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMDozNlrOHc8whQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMDozNlrOHc8whQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDExNzYzNw==", "bodyText": "All of this exclusion logic is handled during packaging in the war task. See the lines pertaining to configurations \"arithmetic\" when building the classpath.", "url": "https://github.com/gocd/gocd/pull/8557#discussion_r500117637", "createdAt": "2020-10-06T09:00:36Z", "author": {"login": "marques-work"}, "path": "server/build.gradle", "diffHunk": "@@ -110,19 +103,15 @@ configurations {\n   }\n \n   sharedTestOutput {\n-    extendsFrom testRuntime\n+    extendsFrom testRuntimeClasspath\n     transitive = true\n   }\n \n-  compile.exclude(group: 'org.springframework', module: 'spring-support')\n-  runtime.exclude(group: 'org.springframework', module: 'spring-support')\n-\n-  // this dependency is a \"provided\" dependency\n-  compile.exclude(group: 'ch.qos.logback', module: 'logback-classic')\n-  runtime.exclude(group: 'ch.qos.logback', module: 'logback-classic')\n-  apiBase.exclude(group: 'ch.qos.logback', module: 'logback-classic')\n-  api.exclude(group: 'ch.qos.logback', module: 'logback-classic')\n-  spark.exclude(group: 'ch.qos.logback', module: 'logback-classic')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "743babf458061a811c349043f13e1f947666b40b"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTQwODg1OnYy", "diffSide": "RIGHT", "path": "server/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMjoyMFrOHc80hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMjoyMFrOHc80hw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDExODY2Mw==", "bodyText": "In other words, Set<String> is better at deduplicating paths to jars than Set<File>.", "url": "https://github.com/gocd/gocd/pull/8557#discussion_r500118663", "createdAt": "2020-10-06T09:02:20Z", "author": {"login": "marques-work"}, "path": "server/build.gradle", "diffHunk": "@@ -725,23 +723,40 @@ task war(type: Jar) {\n   dependsOn rootProject.generateLicenseReport\n   dependsOn configureWar\n   dependsOn ':server:jar', ':server:compileAssets'\n-  dependsOn project.configurations.compile\n-  dependsOn project.configurations.api\n+  dependsOn project.configurations.compileClasspath\n+  dependsOn project.configurations.allApis\n   dependsOn project.configurations.spark\n   finalizedBy 'verifyWar'\n   archiveBaseName = 'cruise'\n-  extension 'war'\n+  archiveExtension = 'war'\n+\n+  // Using a Set<String> is more reliable than Set<File> because File.equals() may be affected by other internal fields\n+  // aside from `path` that aren't important to us; thus, Set<File> may allow duplicate paths and Set<String> will not.\n+  Set<String> classpath = (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "743babf458061a811c349043f13e1f947666b40b"}, "originalPosition": 271}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2790, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}