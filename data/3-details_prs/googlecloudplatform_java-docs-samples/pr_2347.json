{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0ODI3NDUz", "number": 2347, "title": "feat: add QueryOptions samples for JDBC", "bodyText": "Adds samples for QueryOptions for Cloud Spanner JDBC. This PR also adds basic infrastructure for samples for Cloud Spanner JDBC.\nThe PR currently fails to build as the changes that are needed have not yet been added to the JDBC driver.", "createdAt": "2020-03-06T13:43:04Z", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347", "merged": true, "mergeCommit": {"oid": "46e82786ce2a3841691a8bdf53032179af579f5f"}, "closed": true, "closedAt": "2020-03-25T21:43:39Z", "author": {"login": "olavloite"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcLErrvgFqTM3MDUyNzE4Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcROVzkgH2gAyMzg0ODI3NDUzOmNiYjBlNjVlMDM4MjI1MGI4N2VhOTRmMmFmN2MxNTg4MWQ2YmYxMTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNTI3MTgz", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#pullrequestreview-370527183", "createdAt": "2020-03-06T18:15:53Z", "commit": {"oid": "7b764234c138cc43102cf2c4650dce680676bd77"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxODoxNTo1M1rOFzCiOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxODo0MjozMVrOFzDUPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2MzIyNQ==", "bodyText": "Nice, simple and clear!", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r389063225", "createdAt": "2020-03-06T18:15:53Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/README.md", "diffHunk": "@@ -0,0 +1,36 @@\n+# Cloud Spanner JDBC Example", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b764234c138cc43102cf2c4650dce680676bd77"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2MzQ0MA==", "bodyText": "Try 1.0.12 - we are trying to roll it out.", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r389063440", "createdAt": "2020-03-06T18:16:21Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/pom.xml", "diffHunk": "@@ -0,0 +1,94 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <properties>\n+    <maven.compiler.target>1.8</maven.compiler.target>\n+    <maven.compiler.source>1.8</maven.compiler.source>\n+  </properties>\n+\n+  <!--\n+    The parent pom defines common style checks and testing strategies for our samples.\n+    Removing or replacing it should not affect the execution of the samples in anyway.\n+  -->\n+  <parent>\n+    <groupId>com.google.cloud.samples</groupId>\n+    <artifactId>shared-configuration</artifactId>\n+    <version>1.0.11</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b764234c138cc43102cf2c4650dce680676bd77"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2MzY0OA==", "bodyText": "Don't use -SNAPSHOT's", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r389063648", "createdAt": "2020-03-06T18:16:46Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/pom.xml", "diffHunk": "@@ -0,0 +1,94 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <properties>\n+    <maven.compiler.target>1.8</maven.compiler.target>\n+    <maven.compiler.source>1.8</maven.compiler.source>\n+  </properties>\n+\n+  <!--\n+    The parent pom defines common style checks and testing strategies for our samples.\n+    Removing or replacing it should not affect the execution of the samples in anyway.\n+  -->\n+  <parent>\n+    <groupId>com.google.cloud.samples</groupId>\n+    <artifactId>shared-configuration</artifactId>\n+    <version>1.0.11</version>\n+  </parent>\n+\n+  <groupId>com.example.spanner</groupId>\n+  <artifactId>cloud-spanner-jdbc</artifactId>\n+  <name>Cloud Spanner with JDBC Code Sample</name>\n+  \n+  <!-- [START spanner_jdbc_dependencies] -->\n+  <dependencies>\n+    <dependency>\n+      <groupId>io.grpc</groupId>\n+      <artifactId>grpc-api</artifactId>\n+      <version>1.27.2</version>\n+    </dependency>\n+    <!-- The Spanner JDBC driver dependency -->\n+    <dependency>\n+      <groupId>com.google.cloud</groupId>\n+      <artifactId>google-cloud-spanner-jdbc</artifactId>\n+      <version>1.13.1-SNAPSHOT</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b764234c138cc43102cf2c4650dce680676bd77"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2MzgyOQ==", "bodyText": "Not a good idea.", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r389063829", "createdAt": "2020-03-06T18:17:13Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/pom.xml", "diffHunk": "@@ -0,0 +1,94 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <properties>\n+    <maven.compiler.target>1.8</maven.compiler.target>\n+    <maven.compiler.source>1.8</maven.compiler.source>\n+  </properties>\n+\n+  <!--\n+    The parent pom defines common style checks and testing strategies for our samples.\n+    Removing or replacing it should not affect the execution of the samples in anyway.\n+  -->\n+  <parent>\n+    <groupId>com.google.cloud.samples</groupId>\n+    <artifactId>shared-configuration</artifactId>\n+    <version>1.0.11</version>\n+  </parent>\n+\n+  <groupId>com.example.spanner</groupId>\n+  <artifactId>cloud-spanner-jdbc</artifactId>\n+  <name>Cloud Spanner with JDBC Code Sample</name>\n+  \n+  <!-- [START spanner_jdbc_dependencies] -->\n+  <dependencies>\n+    <dependency>\n+      <groupId>io.grpc</groupId>\n+      <artifactId>grpc-api</artifactId>\n+      <version>1.27.2</version>\n+    </dependency>\n+    <!-- The Spanner JDBC driver dependency -->\n+    <dependency>\n+      <groupId>com.google.cloud</groupId>\n+      <artifactId>google-cloud-spanner-jdbc</artifactId>\n+      <version>1.13.1-SNAPSHOT</version>\n+      <exclusions>\n+        <exclusion>\n+          <groupId>io.grpc</groupId>\n+          <artifactId>grpc-api</artifactId>\n+        </exclusion>\n+      </exclusions>\n+    </dependency>\n+    \n+    <!-- Test dependencies -->\n+    <dependency>\n+      <groupId>junit</groupId>\n+      <artifactId>junit</artifactId>\n+      <version>4.13</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>com.google.truth</groupId>\n+      <artifactId>truth</artifactId>\n+      <version>1.0</version>\n+      <scope>test</scope>\n+    </dependency>\n+  </dependencies>\n+  <!-- [END spanner_jdbc_dependencies] -->\n+\n+  <build>\n+    <plugins>\n+      <plugin>\n+        <groupId>org.codehaus.mojo</groupId>\n+        <artifactId>exec-maven-plugin</artifactId>\n+        <version>1.6.0</version>\n+        <executions>\n+          <execution>\n+            <goals>\n+              <goal>java</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n+        <configuration>\n+          <mainClass>com.example.spanner.JdbcSample</mainClass>\n+          <cleanupDaemonThreads>false</cleanupDaemonThreads>\n+        </configuration>\n+      </plugin>\n+    </plugins>\n+  </build>\n+\n+  <!-- [START spanner_jdbc_snapshot_repo] -->\n+  <repositories>\n+    <repository>\n+      <id>snapshots-repo</id>\n+      <url>https://oss.sonatype.org/content/repositories/snapshots</url>\n+      <releases><enabled>false</enabled></releases>\n+      <snapshots><enabled>true</enabled></snapshots>\n+    </repository>\n+  </repositories>\n+  <!-- [END spanner_jdbc_snapshot_repo] -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b764234c138cc43102cf2c4650dce680676bd77"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2NDIxOA==", "bodyText": "Nice!", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r389064218", "createdAt": "2020-03-06T18:18:07Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/src/main/java/com/example/spanner/JdbcSample.java", "diffHunk": "@@ -0,0 +1,214 @@\n+/*\n+ * Copyright 2020 Google Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.spanner;\n+\n+import com.google.cloud.spanner.SpannerOptions;\n+import java.sql.Connection;\n+import java.sql.DriverManager;\n+import java.sql.PreparedStatement;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+import java.sql.Statement;\n+import java.sql.Types;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+/** Example showing how to use the Cloud Spanner open source JDBC driver. */\n+public class JdbcSample {\n+\n+  /** Class to contain singer sample data. */\n+  static class Singer {\n+\n+    final long singerId;\n+    final String firstName;\n+    final String lastName;\n+\n+    Singer(long singerId, String firstName, String lastName) {\n+      this.singerId = singerId;\n+      this.firstName = firstName;\n+      this.lastName = lastName;\n+    }\n+  }\n+\n+  static final List<Singer> SINGERS =\n+      Arrays.asList(\n+          new Singer(1, \"Marc\", \"Richards\"),\n+          new Singer(2, \"Catalina\", \"Smith\"),\n+          new Singer(3, \"Alice\", \"Trentor\"),\n+          new Singer(4, \"Lea\", \"Martin\"),\n+          new Singer(5, \"David\", \"Lomond\"));\n+\n+  /**\n+   * This example shows how to create a JDBC connection and use this to execute queries and updates.\n+   */\n+  public static void main(String[] args) throws Exception {\n+    if (args.length != 3) {\n+      printUsageAndExit();\n+    }\n+\n+    /*\n+     * CREATE TABLE Singers (\n+     *   SingerId   INT64 NOT NULL,\n+     *   FirstName  STRING(1024),\n+     *   LastName   STRING(1024),\n+     *   SingerInfo BYTES(MAX),\n+     * ) PRIMARY KEY (SingerId);\n+     */\n+\n+    String command = args[0];\n+    String projectId = SpannerOptions.getDefaultProjectId();\n+    String instanceId = args[1];\n+    String databaseId = args[2];\n+\n+    String connectionUrl =\n+        String.format(\n+            \"jdbc:cloudspanner:/projects/%s/instances/%s/databases/%s\",\n+            projectId, instanceId, databaseId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b764234c138cc43102cf2c4650dce680676bd77"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2NTg1NQ==", "bodyText": "I think we try to avoid using CLI tools for java samples.  I'll approve this since I couldn't find a prohibition in https://github.com/GoogleCloudPlatform/java-docs-samples/blob/master/SAMPLE_FORMAT.md", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r389065855", "createdAt": "2020-03-06T18:21:35Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/src/main/java/com/example/spanner/JdbcSample.java", "diffHunk": "@@ -0,0 +1,214 @@\n+/*\n+ * Copyright 2020 Google Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.spanner;\n+\n+import com.google.cloud.spanner.SpannerOptions;\n+import java.sql.Connection;\n+import java.sql.DriverManager;\n+import java.sql.PreparedStatement;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+import java.sql.Statement;\n+import java.sql.Types;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+/** Example showing how to use the Cloud Spanner open source JDBC driver. */\n+public class JdbcSample {\n+\n+  /** Class to contain singer sample data. */\n+  static class Singer {\n+\n+    final long singerId;\n+    final String firstName;\n+    final String lastName;\n+\n+    Singer(long singerId, String firstName, String lastName) {\n+      this.singerId = singerId;\n+      this.firstName = firstName;\n+      this.lastName = lastName;\n+    }\n+  }\n+\n+  static final List<Singer> SINGERS =\n+      Arrays.asList(\n+          new Singer(1, \"Marc\", \"Richards\"),\n+          new Singer(2, \"Catalina\", \"Smith\"),\n+          new Singer(3, \"Alice\", \"Trentor\"),\n+          new Singer(4, \"Lea\", \"Martin\"),\n+          new Singer(5, \"David\", \"Lomond\"));\n+\n+  /**\n+   * This example shows how to create a JDBC connection and use this to execute queries and updates.\n+   */\n+  public static void main(String[] args) throws Exception {\n+    if (args.length != 3) {\n+      printUsageAndExit();\n+    }\n+\n+    /*\n+     * CREATE TABLE Singers (\n+     *   SingerId   INT64 NOT NULL,\n+     *   FirstName  STRING(1024),\n+     *   LastName   STRING(1024),\n+     *   SingerInfo BYTES(MAX),\n+     * ) PRIMARY KEY (SingerId);\n+     */\n+\n+    String command = args[0];\n+    String projectId = SpannerOptions.getDefaultProjectId();\n+    String instanceId = args[1];\n+    String databaseId = args[2];\n+\n+    String connectionUrl =\n+        String.format(\n+            \"jdbc:cloudspanner:/projects/%s/instances/%s/databases/%s\",\n+            projectId, instanceId, databaseId);\n+    try (Connection connection = DriverManager.getConnection(connectionUrl)) {\n+      run(command, connection, projectId, instanceId, databaseId);\n+    }\n+  }\n+\n+  static void run(\n+      String command, Connection connection, String projectId, String instanceId, String databaseId)\n+      throws SQLException {\n+    switch (command) {\n+      case \"createtable\":\n+        createTable(connection);\n+        break;\n+      case \"insertdata\":\n+        insertData(connection);\n+        break;\n+      case \"connectionwithqueryoptions\":\n+        connectionWithQueryOptions(projectId, instanceId, databaseId);\n+        break;\n+      case \"setqueryoptions\":\n+        setQueryOptions(projectId, instanceId, databaseId);\n+        break;\n+      default:\n+        printUsageAndExit();\n+    }\n+  }\n+\n+  static void printUsageAndExit() {\n+    System.err.println(\"Usage:\");\n+    System.err.println(\"    JdbcSample <command> <instance_id> <database_id>\");\n+    System.err.println(\"\");\n+    System.err.println(\"Examples:\");\n+    System.err.println(\"    JdbcSample createtable my-instance example-db\");\n+    System.err.println(\"    JdbcSample insertdata my-instance example-db\");\n+    System.err.println(\"    JdbcSample connectionwithqueryoptions my-instance example-db\");\n+    System.err.println(\"    JdbcSample setqueryoptions my-instance example-db\");\n+\n+    System.exit(1);\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b764234c138cc43102cf2c4650dce680676bd77"}, "originalPosition": 118}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA3NjAyOA==", "bodyText": "Do we need to add something in Java-Docs-Samples-Testing for this?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r389076028", "createdAt": "2020-03-06T18:42:31Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/src/test/java/com/example/spanner/JdbcSampleIT.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Copyright 2020 Google Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.spanner;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+\n+import com.google.cloud.spanner.DatabaseAdminClient;\n+import com.google.cloud.spanner.DatabaseId;\n+import com.google.cloud.spanner.Spanner;\n+import com.google.cloud.spanner.SpannerOptions;\n+import java.io.ByteArrayOutputStream;\n+import java.io.PrintStream;\n+import java.util.Collections;\n+import java.util.UUID;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+/** Unit tests for {@code JdbcSample} */\n+@RunWith(JUnit4.class)\n+public class JdbcSampleIT {\n+  // The instance needs to exist for tests to pass.\n+  private final String instanceId = System.getProperty(\"spanner.test.instance\");\n+  private final String databaseId = formatForTest(System.getProperty(\"spanner.sample.database\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b764234c138cc43102cf2c4650dce680676bd77"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f45d9d41a8f614262d25874bb3fca7d0a3d46c94", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/f45d9d41a8f614262d25874bb3fca7d0a3d46c94", "committedDate": "2020-03-24T11:03:57Z", "message": "feat: add QueryOptions samples for JDBC"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fa6e08d935ce7597e0cc9c0f14ff26c73879c5c", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/3fa6e08d935ce7597e0cc9c0f14ff26c73879c5c", "committedDate": "2020-03-24T11:03:57Z", "message": "fix: review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad9b4ac752307010fa7c9e6cb3f7199bf6fe14a3", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/ad9b4ac752307010fa7c9e6cb3f7199bf6fe14a3", "committedDate": "2020-03-24T11:03:57Z", "message": "deps: update to most recent jdbc version"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "884c3fba9da2bf21b7c7e3024227a2f30e3b306b", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/884c3fba9da2bf21b7c7e3024227a2f30e3b306b", "committedDate": "2020-03-10T15:19:29Z", "message": "Merge branch 'spanner-jdbc-query-options' of github.com:olavloite/java-docs-samples into spanner-jdbc-query-options"}, "afterCommit": {"oid": "ad9b4ac752307010fa7c9e6cb3f7199bf6fe14a3", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/ad9b4ac752307010fa7c9e6cb3f7199bf6fe14a3", "committedDate": "2020-03-24T11:03:57Z", "message": "deps: update to most recent jdbc version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d51b7cf2c91b6213714e3b5bc0fd150fdb19c3ca", "author": {"user": {"login": "skuruppu", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/d51b7cf2c91b6213714e3b5bc0fd150fdb19c3ca", "committedDate": "2020-03-24T23:25:01Z", "message": "Merge branch 'master' into spanner-jdbc-query-options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7bbd3b207da2f9fcfdc6655f2ee3f69ee42e84b", "author": {"user": {"login": "skuruppu", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/b7bbd3b207da2f9fcfdc6655f2ee3f69ee42e84b", "committedDate": "2020-03-25T04:08:29Z", "message": "Merge branch 'master' into spanner-jdbc-query-options"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwODQ4Njc0", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#pullrequestreview-380848674", "createdAt": "2020-03-25T04:13:52Z", "commit": {"oid": "d51b7cf2c91b6213714e3b5bc0fd150fdb19c3ca"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwNDoxNDoyMFrOF7LmVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwNDoxNDoyMFrOF7LmVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzYwMDM0MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String optimizerVersion = \"LATEST\";\n          \n          \n            \n                String optimizerVersion = \"1\";", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r397600340", "createdAt": "2020-03-25T04:14:20Z", "author": {"login": "skuruppu"}, "path": "spanner/jdbc/src/main/java/com/example/spanner/JdbcSample.java", "diffHunk": "@@ -0,0 +1,214 @@\n+/*\n+ * Copyright 2020 Google Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.spanner;\n+\n+import com.google.cloud.spanner.SpannerOptions;\n+import java.sql.Connection;\n+import java.sql.DriverManager;\n+import java.sql.PreparedStatement;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+import java.sql.Statement;\n+import java.sql.Types;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+/** Example showing how to use the Cloud Spanner open source JDBC driver. */\n+public class JdbcSample {\n+\n+  /** Class to contain singer sample data. */\n+  static class Singer {\n+\n+    final long singerId;\n+    final String firstName;\n+    final String lastName;\n+\n+    Singer(long singerId, String firstName, String lastName) {\n+      this.singerId = singerId;\n+      this.firstName = firstName;\n+      this.lastName = lastName;\n+    }\n+  }\n+\n+  static final List<Singer> SINGERS =\n+      Arrays.asList(\n+          new Singer(1, \"Marc\", \"Richards\"),\n+          new Singer(2, \"Catalina\", \"Smith\"),\n+          new Singer(3, \"Alice\", \"Trentor\"),\n+          new Singer(4, \"Lea\", \"Martin\"),\n+          new Singer(5, \"David\", \"Lomond\"));\n+\n+  /**\n+   * This example shows how to create a JDBC connection and use this to execute queries and updates.\n+   */\n+  public static void main(String[] args) throws Exception {\n+    if (args.length != 3) {\n+      printUsageAndExit();\n+    }\n+\n+    /*\n+     * CREATE TABLE Singers (\n+     *   SingerId   INT64 NOT NULL,\n+     *   FirstName  STRING(1024),\n+     *   LastName   STRING(1024),\n+     *   SingerInfo BYTES(MAX),\n+     * ) PRIMARY KEY (SingerId);\n+     */\n+\n+    String command = args[0];\n+    String projectId = SpannerOptions.getDefaultProjectId();\n+    String instanceId = args[1];\n+    String databaseId = args[2];\n+\n+    String connectionUrl =\n+        String.format(\n+            \"jdbc:cloudspanner:/projects/%s/instances/%s/databases/%s\",\n+            projectId, instanceId, databaseId);\n+    try (Connection connection = DriverManager.getConnection(connectionUrl)) {\n+      run(command, connection, projectId, instanceId, databaseId);\n+    }\n+  }\n+\n+  static void run(\n+      String command, Connection connection, String projectId, String instanceId, String databaseId)\n+      throws SQLException {\n+    switch (command) {\n+      case \"createtable\":\n+        createTable(connection);\n+        break;\n+      case \"insertdata\":\n+        insertData(connection);\n+        break;\n+      case \"connectionwithqueryoptions\":\n+        connectionWithQueryOptions(projectId, instanceId, databaseId);\n+        break;\n+      case \"setqueryoptions\":\n+        setQueryOptions(projectId, instanceId, databaseId);\n+        break;\n+      default:\n+        printUsageAndExit();\n+    }\n+  }\n+\n+  static void printUsageAndExit() {\n+    System.err.println(\"Usage:\");\n+    System.err.println(\"    JdbcSample <command> <instance_id> <database_id>\");\n+    System.err.println(\"\");\n+    System.err.println(\"Examples:\");\n+    System.err.println(\"    JdbcSample createtable my-instance example-db\");\n+    System.err.println(\"    JdbcSample insertdata my-instance example-db\");\n+    System.err.println(\"    JdbcSample connectionwithqueryoptions my-instance example-db\");\n+    System.err.println(\"    JdbcSample setqueryoptions my-instance example-db\");\n+\n+    System.exit(1);\n+  }\n+\n+  static void createTable(Connection connection) throws SQLException {\n+    try (Statement statement = connection.createStatement()) {\n+      statement.execute(\n+          \"CREATE TABLE Singers (\\n\"\n+              + \"              SingerId   INT64 NOT NULL,\\n\"\n+              + \"              FirstName  STRING(1024),\\n\"\n+              + \"              LastName   STRING(1024),\\n\"\n+              + \"              SingerInfo BYTES(MAX),\\n\"\n+              + \"              ) PRIMARY KEY (SingerId)\\n\");\n+    }\n+    System.out.println(\"Created table [Singers]\");\n+  }\n+\n+  static void insertData(Connection connection) throws SQLException {\n+    boolean originalAutoCommit = connection.getAutoCommit();\n+    connection.setAutoCommit(false);\n+    try (PreparedStatement ps =\n+        connection.prepareStatement(\n+            \"INSERT INTO Singers\\n\"\n+                + \"(SingerId, FirstName, LastName, SingerInfo)\\n\"\n+                + \"VALUES\\n\"\n+                + \"(?, ?, ?, ?)\")) {\n+      for (Singer singer : SINGERS) {\n+        ps.setLong(1, singer.singerId);\n+        ps.setString(2, singer.firstName);\n+        ps.setString(3, singer.lastName);\n+        ps.setNull(4, Types.BINARY);\n+        ps.addBatch();\n+      }\n+      int[] updateCounts = ps.executeBatch();\n+      connection.commit();\n+      System.out.printf(\"Insert counts: %s\\n\", Arrays.toString(updateCounts));\n+    } finally {\n+      connection.setAutoCommit(originalAutoCommit);\n+    }\n+  }\n+\n+  // [START spanner_jdbc_connection_with_query_options]\n+  static void connectionWithQueryOptions(String projectId, String instanceId, String databaseId)\n+      throws SQLException {\n+    String optimizerVersion = \"LATEST\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7bbd3b207da2f9fcfdc6655f2ee3f69ee42e84b"}, "originalPosition": 160}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "066d0310d1be9e8faeb9c6e55b18bbbf8d16374d", "author": {"user": {"login": "skuruppu", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/066d0310d1be9e8faeb9c6e55b18bbbf8d16374d", "committedDate": "2020-03-25T04:18:51Z", "message": "Fix google-cloud-spanner-jdbc version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83a587edbde3016dd6bb68c9b033c59688b29cc5", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/83a587edbde3016dd6bb68c9b033c59688b29cc5", "committedDate": "2020-03-25T08:37:33Z", "message": "fix: fix test cases and jdbc version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d96d083b85d3adf5405ae565d1f6bbbe1d1ef23", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/8d96d083b85d3adf5405ae565d1f6bbbe1d1ef23", "committedDate": "2020-03-25T08:37:39Z", "message": "Merge branch 'spanner-jdbc-query-options' of github.com:olavloite/java-docs-samples into spanner-jdbc-query-options"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzY1MDE4", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#pullrequestreview-381365018", "createdAt": "2020-03-25T17:16:06Z", "commit": {"oid": "8d96d083b85d3adf5405ae565d1f6bbbe1d1ef23"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoxNjowNlrOF7lyCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoxNjowNlrOF7lyCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyOTMyMQ==", "bodyText": "1.0.13 now", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r398029321", "createdAt": "2020-03-25T17:16:06Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/pom.xml", "diffHunk": "@@ -0,0 +1,72 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <properties>\n+    <maven.compiler.target>1.8</maven.compiler.target>\n+    <maven.compiler.source>1.8</maven.compiler.source>\n+  </properties>\n+\n+  <!--\n+    The parent pom defines common style checks and testing strategies for our samples.\n+    Removing or replacing it should not affect the execution of the samples in anyway.\n+  -->\n+  <parent>\n+    <groupId>com.google.cloud.samples</groupId>\n+    <artifactId>shared-configuration</artifactId>\n+    <version>1.0.12</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d96d083b85d3adf5405ae565d1f6bbbe1d1ef23"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzY1NzIw", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#pullrequestreview-381365720", "createdAt": "2020-03-25T17:16:52Z", "commit": {"oid": "8d96d083b85d3adf5405ae565d1f6bbbe1d1ef23"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoxNjo1MlrOF7l0ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoxNjo1MlrOF7l0ZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyOTkyNQ==", "bodyText": "1.0.1", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#discussion_r398029925", "createdAt": "2020-03-25T17:16:52Z", "author": {"login": "lesv"}, "path": "spanner/jdbc/pom.xml", "diffHunk": "@@ -0,0 +1,72 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <properties>\n+    <maven.compiler.target>1.8</maven.compiler.target>\n+    <maven.compiler.source>1.8</maven.compiler.source>\n+  </properties>\n+\n+  <!--\n+    The parent pom defines common style checks and testing strategies for our samples.\n+    Removing or replacing it should not affect the execution of the samples in anyway.\n+  -->\n+  <parent>\n+    <groupId>com.google.cloud.samples</groupId>\n+    <artifactId>shared-configuration</artifactId>\n+    <version>1.0.12</version>\n+  </parent>\n+\n+  <groupId>com.example.spanner</groupId>\n+  <artifactId>cloud-spanner-jdbc</artifactId>\n+  <name>Cloud Spanner with JDBC Code Sample</name>\n+  \n+  <!-- [START spanner_jdbc_dependencies] -->\n+  <dependencies>\n+    <!-- The Spanner JDBC driver dependency -->\n+    <dependency>\n+      <groupId>com.google.cloud</groupId>\n+      <artifactId>google-cloud-spanner-jdbc</artifactId>\n+      <version>1.15.0</version>\n+    </dependency>\n+    \n+    <!-- Test dependencies -->\n+    <dependency>\n+      <groupId>junit</groupId>\n+      <artifactId>junit</artifactId>\n+      <version>4.13</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>com.google.truth</groupId>\n+      <artifactId>truth</artifactId>\n+      <version>1.0</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d96d083b85d3adf5405ae565d1f6bbbe1d1ef23"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzY3MjM5", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2347#pullrequestreview-381367239", "createdAt": "2020-03-25T17:18:33Z", "commit": {"oid": "8d96d083b85d3adf5405ae565d1f6bbbe1d1ef23"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac63ae1d755219ba57b4355e4a8d7b73e4ec289e", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/ac63ae1d755219ba57b4355e4a8d7b73e4ec289e", "committedDate": "2020-03-25T17:30:46Z", "message": "fix: fix dependency versions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f896045ff77a33196656a02b65793a66f615683", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/8f896045ff77a33196656a02b65793a66f615683", "committedDate": "2020-03-25T20:46:55Z", "message": "fix: use default db and instance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cf6e1ed4f266aa70cd36bafee52eb0fb293b2db", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/6cf6e1ed4f266aa70cd36bafee52eb0fb293b2db", "committedDate": "2020-03-25T20:47:22Z", "message": "fix: remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c69e653fff4b3f77c9c6f5c13eba19c8747f1d3e", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/c69e653fff4b3f77c9c6f5c13eba19c8747f1d3e", "committedDate": "2020-03-25T21:02:24Z", "message": "Merge branch 'master' into spanner-jdbc-query-options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbb0e65e0382250b87ea94f2af7c15881d6bf111", "author": {"user": {"login": "olavloite", "name": "Knut Olav L\u00f8ite"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/cbb0e65e0382250b87ea94f2af7c15881d6bf111", "committedDate": "2020-03-25T21:25:17Z", "message": "Merge branch 'master' into spanner-jdbc-query-options"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 906, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}