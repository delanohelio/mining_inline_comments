{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2OTM3NzM4", "number": 2719, "title": "automl: explictly update timeoutes due to default library changes", "bodyText": "Fixes PR: #2704\n\nIt's a good idea to open an issue first for discussion.\n\n\n pom.xml parent set to latest shared-configuration\n Appropriate changes to README are included in PR\n API's need to be enabled to test (tell us)\n Environment Variables need to be set (ask us to set them)\n Tests pass (mvn -P lint clean verify)\n\n(Note- Checkstyle passing is required; Spotbugs, ErrorProne, PMD, etc. ERROR's are advisory only)", "createdAt": "2020-04-21T22:18:39Z", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719", "merged": true, "mergeCommit": {"oid": "7550386196b81bcb58d3f01b92036310c66dcecc"}, "closed": true, "closedAt": "2020-04-24T22:31:46Z", "author": {"login": "nnegrey"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ7Q13gH2gAyNDA2OTM3NzM4OjY1ZmNjZDk5YjU3NjEyMmNjMGU0NmI3MTJmM2ExMGZiYWM0N2Q0YmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABca46kPAH2gAyNDA2OTM3NzM4OjZhNWI5Njg3NTNkZTNkZWU2MzY2ZGJjM2U5YjZlMGUyZDUxY2UzNzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "65fccd99b576122cc0e46b712f3a10fbac47d4bd", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/65fccd99b576122cc0e46b712f3a10fbac47d4bd", "committedDate": "2020-04-21T22:16:59Z", "message": "automl: explictly update timeoutes due to library changes in the defaults"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NzE2NTU1", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719#pullrequestreview-397716555", "createdAt": "2020-04-21T22:19:37Z", "commit": {"oid": "65fccd99b576122cc0e46b712f3a10fbac47d4bd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMjoxOTozOFrOGJa4dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMjoxOTozOFrOGJa4dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUzMDgwNg==", "bodyText": "@lesv, I wanted to make a note for the timeout that even though there is a timeout exception, the operation is still running in the background. But I still end up throwing the error.\nWhat's the best practice here?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719#discussion_r412530806", "createdAt": "2020-04-21T22:19:38Z", "author": {"login": "nnegrey"}, "path": "automl/cloud-client/src/main/java/com/example/automl/ImportDataset.java", "diffHunk": "@@ -55,8 +59,22 @@ static void importDataset(String projectId, String datasetId, String path)\n       InputConfig inputConfig = InputConfig.newBuilder().setGcsSource(gcsSource).build();\n       System.out.println(\"Processing import...\");\n \n-      Empty response = client.importDataAsync(datasetFullId, inputConfig).get();\n-      System.out.format(\"Dataset imported. %s\\n\", response);\n+      // Start the import job\n+      OperationFuture<Empty, OperationMetadata> operation =\n+          client.importDataAsync(datasetFullId, inputConfig);\n+\n+      System.out.format(\"Operation name: %s%n\", operation.getName());\n+\n+      // If you want to wait for the operation to finish, adjust the timeout appropriately. The\n+      // operation will still run if you choose not to wait for it to complete. You can check the\n+      // status of your operation using the operation's name.\n+      Empty response = operation.get(30, TimeUnit.MINUTES);\n+      System.out.format(\"Dataset imported. %s%n\", response);\n+    } catch (TimeoutException e) {\n+      System.out.println(\"The operation's polling period was not long enough.\");\n+      System.out.println(\"You can use the Operation's name to get the current status.\");\n+      System.out.println(\"The import job will still complete as expected.\");\n+      throw e;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65fccd99b576122cc0e46b712f3a10fbac47d4bd"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NzM4MTg5", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719#pullrequestreview-397738189", "createdAt": "2020-04-21T23:11:54Z", "commit": {"oid": "65fccd99b576122cc0e46b712f3a10fbac47d4bd"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMzoxMTo1NFrOGJcSLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMzoxMTo1NFrOGJcSLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjU1Mzc3NQ==", "bodyText": "I'm good w/ this.  I'd prefer to see comments, but this is ok.\nThat said, you might be very clear by changing to:\nThe import job is still running and will complete as expected.", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719#discussion_r412553775", "createdAt": "2020-04-21T23:11:54Z", "author": {"login": "lesv"}, "path": "automl/cloud-client/src/main/java/com/example/automl/ImportDataset.java", "diffHunk": "@@ -55,8 +59,22 @@ static void importDataset(String projectId, String datasetId, String path)\n       InputConfig inputConfig = InputConfig.newBuilder().setGcsSource(gcsSource).build();\n       System.out.println(\"Processing import...\");\n \n-      Empty response = client.importDataAsync(datasetFullId, inputConfig).get();\n-      System.out.format(\"Dataset imported. %s\\n\", response);\n+      // Start the import job\n+      OperationFuture<Empty, OperationMetadata> operation =\n+          client.importDataAsync(datasetFullId, inputConfig);\n+\n+      System.out.format(\"Operation name: %s%n\", operation.getName());\n+\n+      // If you want to wait for the operation to finish, adjust the timeout appropriately. The\n+      // operation will still run if you choose not to wait for it to complete. You can check the\n+      // status of your operation using the operation's name.\n+      Empty response = operation.get(30, TimeUnit.MINUTES);\n+      System.out.format(\"Dataset imported. %s%n\", response);\n+    } catch (TimeoutException e) {\n+      System.out.println(\"The operation's polling period was not long enough.\");\n+      System.out.println(\"You can use the Operation's name to get the current status.\");\n+      System.out.println(\"The import job will still complete as expected.\");\n+      throw e;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUzMDgwNg=="}, "originalCommit": {"oid": "65fccd99b576122cc0e46b712f3a10fbac47d4bd"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e64cb0b4da0c07fd73c36b0666517d79b7ab623", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/7e64cb0b4da0c07fd73c36b0666517d79b7ab623", "committedDate": "2020-04-22T14:46:56Z", "message": "Update ImportDataset.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "962829dfc52cc506c8a0e348f14c026cc932b44d", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/962829dfc52cc506c8a0e348f14c026cc932b44d", "committedDate": "2020-04-22T19:20:28Z", "message": "try bumping timeout\n\nAutoML provides no guarantee on how long this could take and normally would send an email followup. Though normally, I see this finish in under 10 mins. Trying to pin down if TASK CANCELLED is actually related to a timeout or not."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b96bea21cdb21244b5902f746951287c022cb80", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/0b96bea21cdb21244b5902f746951287c022cb80", "committedDate": "2020-04-24T15:25:08Z", "message": "update timeouts for all import methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cf0c8be2c0dfe5e3b2c52106e8bc6b5801bb451", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/8cf0c8be2c0dfe5e3b2c52106e8bc6b5801bb451", "committedDate": "2020-04-24T15:55:15Z", "message": "Merge branch 'master' into fix-automl-test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc7b94825557ee226ce3ada6727ffc33e3da89e5", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/bc7b94825557ee226ce3ada6727ffc33e3da89e5", "committedDate": "2020-04-24T16:12:23Z", "message": "undo changes to TablesImport, add catch for Cancellation Exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdcfc5cd8ed7714083f0c5da9aa22cf92bc56718", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/fdcfc5cd8ed7714083f0c5da9aa22cf92bc56718", "committedDate": "2020-04-24T16:13:45Z", "message": "update to correct CancelledException"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a593a349c5531d7c803f84a40720220baadad4eb", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/a593a349c5531d7c803f84a40720220baadad4eb", "committedDate": "2020-04-24T16:16:22Z", "message": "wrong cancellation again"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "858a7b610b9acc19477e23a299a77f88b87b6d2c", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/858a7b610b9acc19477e23a299a77f88b87b6d2c", "committedDate": "2020-04-24T16:49:18Z", "message": "run tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "903409fe92aaafc904557dc1de05e806a2aeb0bb", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/903409fe92aaafc904557dc1de05e806a2aeb0bb", "committedDate": "2020-04-24T18:25:42Z", "message": "log to error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29e9e6c477ac52420add556245df94df55c80ad0", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/29e9e6c477ac52420add556245df94df55c80ad0", "committedDate": "2020-04-24T19:42:06Z", "message": "test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dafc662f0ca89985acd645f8615c395351e9fad4", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/dafc662f0ca89985acd645f8615c395351e9fad4", "committedDate": "2020-04-24T20:07:39Z", "message": "reset changes that printed error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c6cdbd393a672cda35f9ab4a4ec89a22a02daf8", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/7c6cdbd393a672cda35f9ab4a4ec89a22a02daf8", "committedDate": "2020-04-24T21:14:13Z", "message": "set retry settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a5b968753de3dee6366dbc3e9b6e0e2d51ce374", "author": {"user": {"login": "nnegrey", "name": "Noah Negrey"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/6a5b968753de3dee6366dbc3e9b6e0e2d51ce374", "committedDate": "2020-04-24T22:06:46Z", "message": "add timeout check to beta code"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 755, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}