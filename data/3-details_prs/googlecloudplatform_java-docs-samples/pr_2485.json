{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzMzI1MjM4", "number": 2485, "title": "Add GCF JVM language samples (Kotlin/Scala/Groovy)", "bodyText": "", "createdAt": "2020-03-25T00:44:38Z", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485", "merged": true, "mergeCommit": {"oid": "41fa5411ae5bcf1babf3c8da89deca6c87cc85a9"}, "closed": true, "closedAt": "2020-03-25T20:34:35Z", "author": {"login": "ace-n"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQ71OGAH2gAyMzkzMzI1MjM4OjI2ZDhkNGM1ZjUwNjBkN2JhNzM1M2NmYTQyMDMxZmM1NTVhY2ViNTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRNi9qgFqTM4MTUxMTI4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "26d8d4c5f5060d7ba7353cfa42031fc555aceb50", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/26d8d4c5f5060d7ba7353cfa42031fc555aceb50", "committedDate": "2020-03-24T23:51:24Z", "message": "Add Kotlin/Scala samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6462e3b7daea4c7413134a9428828bc187a7392c", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/6462e3b7daea4c7413134a9428828bc187a7392c", "committedDate": "2020-03-25T00:43:34Z", "message": "Add region tags"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4caa6064d06180ad9aeae9348082dd9c316a5a7", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/b4caa6064d06180ad9aeae9348082dd9c316a5a7", "committedDate": "2020-03-25T00:58:25Z", "message": "Downgrade kotlin version to match build environment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNzk3OTQw", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#pullrequestreview-380797940", "createdAt": "2020-03-25T01:05:28Z", "commit": {"oid": "b4caa6064d06180ad9aeae9348082dd9c316a5a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdd48fbd3fd71180a365559129aa2a0fb9da8c38", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/fdd48fbd3fd71180a365559129aa2a0fb9da8c38", "committedDate": "2020-03-25T03:29:52Z", "message": "Add Groovy sample + remove cruft from Kotlin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c04d7ba125a2da4e319444aab43ce4d6234bbee", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/0c04d7ba125a2da4e319444aab43ce4d6234bbee", "committedDate": "2020-03-25T03:30:36Z", "message": "Merge branch 'master' into gcf-jvm-langs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d060af2eb8d7161c021c765ba32c1fad938b2702", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/d060af2eb8d7161c021c765ba32c1fad938b2702", "committedDate": "2020-03-25T03:32:41Z", "message": "Add missing region tags"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd1d21263ba252ed44b2a605a10e3414b661aa46", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/fd1d21263ba252ed44b2a605a10e3414b661aa46", "committedDate": "2020-03-25T03:58:55Z", "message": "pom.xml: move surefire after Kotlin compilation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/a1373831a7dd3fc944ae62a959d8638b696fc81a", "committedDate": "2020-03-25T19:19:59Z", "message": "Move non-Java languages into separate paths + fix test failures"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDcwMTkw", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#pullrequestreview-381470190", "createdAt": "2020-03-25T19:29:45Z", "commit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOToyOTo0NlrOF7rCAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOToyOTo0NlrOF7rCAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExNTMyOQ==", "bodyText": "should there be a new line here?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398115329", "createdAt": "2020-03-25T19:29:46Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/main/groovy/com/example/functions/GroovyHelloWorld.groovy", "diffHunk": "@@ -0,0 +1,14 @@\n+package com.example.functions\n+\n+// [START functions_helloworld_get]\n+import com.google.cloud.functions.HttpFunction\n+import com.google.cloud.functions.HttpRequest\n+import com.google.cloud.functions.HttpResponse\n+\n+class GroovyHelloWorld implements HttpFunction {\n+    @Override\n+    void service(HttpRequest request, HttpResponse response) {\n+        response.writer.write(\"Hello World!\")\n+    }\n+}\n+// [END functions_helloworld_get]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDcwNDkw", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#pullrequestreview-381470490", "createdAt": "2020-03-25T19:30:13Z", "commit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMDoxM1rOF7rC4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMDoxM1rOF7rC4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExNTU1NQ==", "bodyText": "newLine?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398115555", "createdAt": "2020-03-25T19:30:13Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/main/java/com/example/functions/ScalaHelloWorld.scala", "diffHunk": "@@ -0,0 +1,11 @@\n+package com.example.functions\n+\n+import com.google.cloud.functions.{HttpFunction, HttpRequest, HttpResponse}\n+\n+// [START functions_helloworld_get]\n+class ScalaHelloWorld extends HttpFunction {\n+  override def service(httpRequest: HttpRequest, httpResponse: HttpResponse): Unit = {\n+    httpResponse.getWriter.write(\"Hello World!\")\n+  }\n+}\n+// [END functions_helloworld_get]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDcwNTc2", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#pullrequestreview-381470576", "createdAt": "2020-03-25T19:30:22Z", "commit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMDoyMlrOF7rDMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMDoyMlrOF7rDMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExNTYzMw==", "bodyText": "newLine?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398115633", "createdAt": "2020-03-25T19:30:22Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/main/kotlin/com/example/functions/KotlinHelloBackground.kt", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+* Copyright 2020 Google LLC\n+*\n+* Licensed under the Apache License, Version 2.0 (the \"License\");\n+* you may not use this file except in compliance with the License.\n+* You may obtain a copy of the License at\n+*\n+* http://www.apache.org/licenses/LICENSE-2.0\n+*\n+* Unless required by applicable law or agreed to in writing, software\n+* distributed under the License is distributed on an \"AS IS\" BASIS,\n+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+* See the License for the specific language governing permissions and\n+* limitations under the License.\n+*/\n+package com.example.functions\n+\n+// [START functions_helloworld_background]\n+import com.google.cloud.functions.BackgroundFunction\n+import com.google.cloud.functions.Context\n+import com.google.cloud.functions.HttpRequest\n+import java.util.logging.Logger\n+\n+class KotlinHelloBackground : BackgroundFunction<HttpRequest> {\n+    override fun accept(request: HttpRequest, context: Context) {\n+        var name = \"world\"\n+        if (request.getFirstQueryParameter(\"name\").isPresent) {\n+            name = request.getFirstQueryParameter(\"name\").get()\n+        }\n+        LOGGER.info(String.format(\"Hello %s!\", name))\n+    }\n+\n+    companion object {\n+        private val LOGGER = Logger.getLogger(KotlinHelloBackground::class.java.name)\n+    }\n+}\n+// [END functions_helloworld_background]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDcwODM5", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#pullrequestreview-381470839", "createdAt": "2020-03-25T19:30:43Z", "commit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMDo0NFrOF7rD7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMDo0NFrOF7rD7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExNTgyMQ==", "bodyText": "newLine?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398115821", "createdAt": "2020-03-25T19:30:44Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/main/kotlin/com/example/functions/KotlinHelloWorld.kt", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.example.functions\n+\n+// [START functions_helloworld_get]\n+import com.google.cloud.functions.HttpFunction\n+import com.google.cloud.functions.HttpRequest\n+import com.google.cloud.functions.HttpResponse\n+import java.io.IOException\n+import java.util.logging.Logger\n+\n+class KotlinHelloWorld : HttpFunction {\n+    // Simple function to return \"Hello World\"\n+    @Throws(IOException::class)\n+    override fun service(request: HttpRequest, response: HttpResponse) {\n+        response.writer.write(\"Hello World!\")\n+    }\n+}\n+// [END functions_helloworld_get]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDcxODk4", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#pullrequestreview-381471898", "createdAt": "2020-03-25T19:32:13Z", "commit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMjoxM1rOF7rHIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMjoxM1rOF7rHIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExNjY0Mg==", "bodyText": "Is this following our new naming standard for DRIFT tests?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398116642", "createdAt": "2020-03-25T19:32:13Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/test/java/com/example/functions/GroovyTests.java", "diffHunk": "@@ -0,0 +1,107 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.functions;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+import static org.mockito.Mockito.when;\n+\n+import com.google.cloud.functions.HttpRequest;\n+import com.google.cloud.functions.HttpResponse;\n+import com.google.common.testing.TestLogHandler;\n+import java.io.BufferedReader;\n+import java.io.BufferedWriter;\n+import java.io.IOException;\n+import java.io.StringReader;\n+import java.io.StringWriter;\n+import java.util.Optional;\n+import java.util.logging.Logger;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.mockito.Mock;\n+import org.mockito.Mockito;\n+import org.powermock.api.mockito.PowerMockito;\n+\n+@RunWith(JUnit4.class)\n+public class GroovyTests {\n+  @Mock private HttpRequest request;\n+  @Mock private HttpResponse response;\n+\n+  private static final Logger BACKGROUND_LOGGER = Logger.getLogger(\n+      GroovyHelloBackground.class.getName());\n+  private static final TestLogHandler logHandler = new TestLogHandler();\n+\n+  private BufferedWriter writerOut;\n+  private StringWriter responseOut;\n+\n+  @BeforeClass\n+  public static void beforeClass() {\n+    BACKGROUND_LOGGER.addHandler(logHandler);\n+  }\n+\n+  @Before\n+  public void beforeTest() throws IOException {\n+    Mockito.mockitoSession().initMocks(this);\n+\n+    request = PowerMockito.mock(HttpRequest.class);\n+    response = PowerMockito.mock(HttpResponse.class);\n+\n+    BufferedReader reader = new BufferedReader(new StringReader(\"{}\"));\n+    PowerMockito.when(request.getReader()).thenReturn(reader);\n+\n+    responseOut = new StringWriter();\n+    writerOut = new BufferedWriter(responseOut);\n+    PowerMockito.when(response.getWriter()).thenReturn(writerOut);\n+\n+    logHandler.clear();\n+  }\n+\n+  @After\n+  public void afterTest() {\n+    System.out.flush();\n+    logHandler.flush();\n+  }\n+\n+  @Test\n+  public void groovyHelloWorldTest() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 83}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDcyNzU0", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#pullrequestreview-381472754", "createdAt": "2020-03-25T19:33:29Z", "commit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozMzozMFrOF7rJ8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxOTozNToyNFrOF7rONg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExNzM2MQ==", "bodyText": "Does this follow the DRIFT naming of tests guide?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398117361", "createdAt": "2020-03-25T19:33:30Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/test/java/com/example/functions/GroovyTests.java", "diffHunk": "@@ -0,0 +1,107 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.functions;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+import static org.mockito.Mockito.when;\n+\n+import com.google.cloud.functions.HttpRequest;\n+import com.google.cloud.functions.HttpResponse;\n+import com.google.common.testing.TestLogHandler;\n+import java.io.BufferedReader;\n+import java.io.BufferedWriter;\n+import java.io.IOException;\n+import java.io.StringReader;\n+import java.io.StringWriter;\n+import java.util.Optional;\n+import java.util.logging.Logger;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.mockito.Mock;\n+import org.mockito.Mockito;\n+import org.powermock.api.mockito.PowerMockito;\n+\n+@RunWith(JUnit4.class)\n+public class GroovyTests {\n+  @Mock private HttpRequest request;\n+  @Mock private HttpResponse response;\n+\n+  private static final Logger BACKGROUND_LOGGER = Logger.getLogger(\n+      GroovyHelloBackground.class.getName());\n+  private static final TestLogHandler logHandler = new TestLogHandler();\n+\n+  private BufferedWriter writerOut;\n+  private StringWriter responseOut;\n+\n+  @BeforeClass\n+  public static void beforeClass() {\n+    BACKGROUND_LOGGER.addHandler(logHandler);\n+  }\n+\n+  @Before\n+  public void beforeTest() throws IOException {\n+    Mockito.mockitoSession().initMocks(this);\n+\n+    request = PowerMockito.mock(HttpRequest.class);\n+    response = PowerMockito.mock(HttpResponse.class);\n+\n+    BufferedReader reader = new BufferedReader(new StringReader(\"{}\"));\n+    PowerMockito.when(request.getReader()).thenReturn(reader);\n+\n+    responseOut = new StringWriter();\n+    writerOut = new BufferedWriter(responseOut);\n+    PowerMockito.when(response.getWriter()).thenReturn(writerOut);\n+\n+    logHandler.clear();\n+  }\n+\n+  @After\n+  public void afterTest() {\n+    System.out.flush();\n+    logHandler.flush();\n+  }\n+\n+  @Test\n+  public void groovyHelloWorldTest() throws IOException {\n+    new GroovyHelloWorld().service(request, response);\n+\n+    writerOut.flush();\n+    assertThat(responseOut.toString()).contains(\"Hello World!\");\n+  }\n+\n+  @Test\n+  public void groovyHelloBackground_printsName() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExNzcyNg==", "bodyText": "Naming convention?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398117726", "createdAt": "2020-03-25T19:34:08Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/test/java/com/example/functions/GroovyTests.java", "diffHunk": "@@ -0,0 +1,107 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.functions;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+import static org.mockito.Mockito.when;\n+\n+import com.google.cloud.functions.HttpRequest;\n+import com.google.cloud.functions.HttpResponse;\n+import com.google.common.testing.TestLogHandler;\n+import java.io.BufferedReader;\n+import java.io.BufferedWriter;\n+import java.io.IOException;\n+import java.io.StringReader;\n+import java.io.StringWriter;\n+import java.util.Optional;\n+import java.util.logging.Logger;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.mockito.Mock;\n+import org.mockito.Mockito;\n+import org.powermock.api.mockito.PowerMockito;\n+\n+@RunWith(JUnit4.class)\n+public class GroovyTests {\n+  @Mock private HttpRequest request;\n+  @Mock private HttpResponse response;\n+\n+  private static final Logger BACKGROUND_LOGGER = Logger.getLogger(\n+      GroovyHelloBackground.class.getName());\n+  private static final TestLogHandler logHandler = new TestLogHandler();\n+\n+  private BufferedWriter writerOut;\n+  private StringWriter responseOut;\n+\n+  @BeforeClass\n+  public static void beforeClass() {\n+    BACKGROUND_LOGGER.addHandler(logHandler);\n+  }\n+\n+  @Before\n+  public void beforeTest() throws IOException {\n+    Mockito.mockitoSession().initMocks(this);\n+\n+    request = PowerMockito.mock(HttpRequest.class);\n+    response = PowerMockito.mock(HttpResponse.class);\n+\n+    BufferedReader reader = new BufferedReader(new StringReader(\"{}\"));\n+    PowerMockito.when(request.getReader()).thenReturn(reader);\n+\n+    responseOut = new StringWriter();\n+    writerOut = new BufferedWriter(responseOut);\n+    PowerMockito.when(response.getWriter()).thenReturn(writerOut);\n+\n+    logHandler.clear();\n+  }\n+\n+  @After\n+  public void afterTest() {\n+    System.out.flush();\n+    logHandler.flush();\n+  }\n+\n+  @Test\n+  public void groovyHelloWorldTest() throws IOException {\n+    new GroovyHelloWorld().service(request, response);\n+\n+    writerOut.flush();\n+    assertThat(responseOut.toString()).contains(\"Hello World!\");\n+  }\n+\n+  @Test\n+  public void groovyHelloBackground_printsName() throws Exception {\n+    when(request.getFirstQueryParameter(\"name\")).thenReturn(Optional.of(\"John\"));\n+\n+    new GroovyHelloBackground().accept(request, new MockContext());\n+\n+    String message = logHandler.getStoredLogRecords().get(0).getMessage();\n+    assertThat(\"Hello John!\").isEqualTo(message);\n+  }\n+\n+  @Test\n+  public void groovyHelloBackground_printsHelloWorld() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExODIzMw==", "bodyText": "Is this following our namingConvention?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398118233", "createdAt": "2020-03-25T19:35:00Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/test/java/com/example/functions/KotlinTests.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.functions;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+import static org.mockito.Mockito.when;\n+\n+import com.google.cloud.functions.HttpRequest;\n+import com.google.cloud.functions.HttpResponse;\n+import com.google.common.testing.TestLogHandler;\n+import java.io.BufferedReader;\n+import java.io.BufferedWriter;\n+import java.io.IOException;\n+import java.io.StringReader;\n+import java.io.StringWriter;\n+import java.util.Optional;\n+import java.util.logging.Logger;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.mockito.Mock;\n+import org.mockito.Mockito;\n+import org.powermock.api.mockito.PowerMockito;\n+\n+@RunWith(JUnit4.class)\n+public class KotlinTests {\n+  @Mock private HttpRequest request;\n+  @Mock private HttpResponse response;\n+\n+  private static final Logger HTTP_LOGGER = Logger.getLogger(KotlinHelloWorld.class.getName());\n+  private static final Logger BACKGROUND_LOGGER = Logger.getLogger(\n+      KotlinHelloBackground.class.getName());\n+  private static final TestLogHandler logHandler = new TestLogHandler();\n+\n+  private BufferedWriter writerOut;\n+  private StringWriter responseOut;\n+\n+  @BeforeClass\n+  public static void beforeClass() {\n+    HTTP_LOGGER.addHandler(logHandler);\n+    BACKGROUND_LOGGER.addHandler(logHandler);\n+  }\n+\n+  @Before\n+  public void beforeTest() throws IOException {\n+    Mockito.mockitoSession().initMocks(this);\n+\n+    request = PowerMockito.mock(HttpRequest.class);\n+    response = PowerMockito.mock(HttpResponse.class);\n+\n+    BufferedReader reader = new BufferedReader(new StringReader(\"{}\"));\n+    PowerMockito.when(request.getReader()).thenReturn(reader);\n+\n+    responseOut = new StringWriter();\n+    writerOut = new BufferedWriter(responseOut);\n+    PowerMockito.when(response.getWriter()).thenReturn(writerOut);\n+\n+    logHandler.clear();\n+  }\n+\n+  @After\n+  public void afterTest() {\n+    System.out.flush();\n+    logHandler.flush();\n+  }\n+\n+  @Test\n+  public void kotlinHelloWorldTest() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODExODQ1NA==", "bodyText": "namingConvention?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#discussion_r398118454", "createdAt": "2020-03-25T19:35:24Z", "author": {"login": "lesv"}, "path": "functions/snippets/src/test/java/com/example/functions/ScalaTests.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.functions;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+import static org.mockito.Mockito.when;\n+\n+import com.google.cloud.functions.HttpRequest;\n+import com.google.cloud.functions.HttpResponse;\n+import com.google.common.testing.TestLogHandler;\n+import java.io.BufferedReader;\n+import java.io.BufferedWriter;\n+import java.io.IOException;\n+import java.io.StringReader;\n+import java.io.StringWriter;\n+import java.util.Optional;\n+import java.util.logging.Logger;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.BeforeClass;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.mockito.Mock;\n+import org.mockito.Mockito;\n+import org.powermock.api.mockito.PowerMockito;\n+\n+@RunWith(JUnit4.class)\n+public class ScalaTests {\n+  @Mock private HttpRequest request;\n+  @Mock private HttpResponse response;\n+\n+  private static final Logger HTTP_LOGGER = Logger.getLogger(ScalaHelloWorld.class.getName());\n+  private static final Logger BACKGROUND_LOGGER = Logger.getLogger(\n+      ScalaHelloBackground.class.getName());\n+  private static final TestLogHandler logHandler = new TestLogHandler();\n+\n+  private BufferedWriter writerOut;\n+  private StringWriter responseOut;\n+\n+  @BeforeClass\n+  public static void beforeClass() {\n+    HTTP_LOGGER.addHandler(logHandler);\n+    BACKGROUND_LOGGER.addHandler(logHandler);\n+  }\n+\n+  @Before\n+  public void beforeTest() throws IOException {\n+    Mockito.mockitoSession().initMocks(this);\n+\n+    request = PowerMockito.mock(HttpRequest.class);\n+    response = PowerMockito.mock(HttpResponse.class);\n+\n+    BufferedReader reader = new BufferedReader(new StringReader(\"{}\"));\n+    PowerMockito.when(request.getReader()).thenReturn(reader);\n+\n+    responseOut = new StringWriter();\n+    writerOut = new BufferedWriter(responseOut);\n+    PowerMockito.when(response.getWriter()).thenReturn(writerOut);\n+\n+    logHandler.clear();\n+  }\n+\n+  @After\n+  public void afterTest() {\n+    System.out.flush();\n+    logHandler.flush();\n+  }\n+\n+  @Test\n+  public void scalaHelloWorldTest() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1373831a7dd3fc944ae62a959d8638b696fc81a"}, "originalPosition": 85}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ddd20d0834fd809bf73c00174bcbcb56b5bc10f", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/7ddd20d0834fd809bf73c00174bcbcb56b5bc10f", "committedDate": "2020-03-25T20:11:30Z", "message": "Follow DRIFT test naming convention"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "625f34e13345006525e8aeff417f2d47f565f56b", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/625f34e13345006525e8aeff417f2d47f565f56b", "committedDate": "2020-03-25T20:11:54Z", "message": "Merge branch 'master' into gcf-jvm-langs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9398da475b106384b7552e3d1865a6e5b13c96ac", "author": {"user": {"login": "ace-n", "name": "Ace Nassri"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/9398da475b106384b7552e3d1865a6e5b13c96ac", "committedDate": "2020-03-25T20:27:15Z", "message": "Add newlines where appropriate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNTExMjg2", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2485#pullrequestreview-381511286", "createdAt": "2020-03-25T20:29:45Z", "commit": {"oid": "9398da475b106384b7552e3d1865a6e5b13c96ac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 866, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}