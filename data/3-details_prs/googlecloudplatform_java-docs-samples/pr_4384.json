{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0NjM4NTU0", "number": 4384, "title": "bigtable: spark example", "bodyText": "I have followed Sample Format Guide\n pom.xml parent set to latest shared-configuration\n Appropriate changes to README are included in PR\n API's need to be enabled to test (tell us)\n Environment Variables need to be set (ask us to set them)\n Tests pass:   mvn clean verify required\n Lint  passes: mvn -P lint checkstyle:check required\n Static Analysis:  mvn -P lint clean compile pmd:cpd-check spotbugs:check advisory only\n Please merge this PR for me once it is approved.", "createdAt": "2020-12-08T18:25:29Z", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384", "merged": true, "mergeCommit": {"oid": "55243f47286022b59091d5184cab96012229a900"}, "closed": true, "closedAt": "2020-12-14T19:38:00Z", "author": {"login": "kolea2"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdMGFbQgH2gAyNTM0NjM4NTU0OjZmMWZmZjk3MzhjNTE5YzQyZmM2YThkZTE5MWIzOTI4ZGU0OWI5NWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmLCVoAFqTU1MTgzMDQzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6f1fff9738c519c42fc6a8de191b3928de49b95f", "author": {"user": {"login": "jaceklaskowski", "name": "Jacek Laskowski"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/6f1fff9738c519c42fc6a8de191b3928de49b95f", "committedDate": "2020-09-24T19:09:41Z", "message": "[WIP] Spark Applications for Cloud Bigtable (#3487)\n\n* [WIP] Spark Applications for Cloud Bigtable\r\n\r\n* Loading and saving using DataFrame API\r\n\r\n* Writing data using RDD API to Bigtable\r\n\r\n* Addressing comments after a code review\r\n\r\n* Submit DataFrameDemo to Cloud Dataproc\r\n\r\n* After code review\r\n\r\n* After code review\r\n\r\n* [Wordcount] Use Admin API to create tables\r\n\r\n* Command-line options + testing framework\r\n\r\n* Add the other cmd options + exclude tests in assembly\r\n\r\n* Tasts marked done (and removed)\r\n\r\n* No need for extra dep. Bye, bye scopt\r\n\r\n* No need for xml config. Command-line arguments enough\r\n\r\n* Create Tables before running demos\r\n\r\n* CopyTable - Copying tables\r\n\r\n* Integration test\r\n\r\n* Assert row count in integration test\r\n\r\n* BIGTABLE_SPARK_ROW_COUNT for IT test to assert the row count\r\n\r\n* Use \"stable\" file for integration test\r\n\r\n* Running Integration Test\r\n\r\n* License headers\r\n\r\n* Fix the last round of style comments\r\n\r\n* Deps to match Dataproc 1.4\r\n\r\n* No need for supersafe\r\n\r\n* Source Code Headers\r\n\r\nAs per the official doc at https://github.com/GoogleCloudPlatform/java-docs-samples#source-code-headers\r\n\r\n* Run Wordcount with Cloud Bigtable verified to work\r\n\r\n* Run Wordcount with Cloud Dataproc\r\n\r\n* Removing HBase version dep\r\n\r\n* Licence headers\r\n\r\n* README"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9efa370300ff4b1eb945cdb913c574d1f95ba369", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/9efa370300ff4b1eb945cdb913c574d1f95ba369", "committedDate": "2020-09-29T15:10:19Z", "message": "bigtable(spark): readme updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2627e64bff5c79d2f2155c315edbade55830bcb4", "author": {"user": {"login": "jaceklaskowski", "name": "Jacek Laskowski"}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/2627e64bff5c79d2f2155c315edbade55830bcb4", "committedDate": "2020-10-06T22:46:35Z", "message": "Wordcount on Dataproc WORKS! (No more NPEs) (#3884)\n\n* Wordcount on Dataproc WORKS! (No more NPEs)\r\n\r\n* Readme\r\n\r\n* After code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdb2d7939db23ea09de01c7923f7898fe3de7fa3", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/bdb2d7939db23ea09de01c7923f7898fe3de7fa3", "committedDate": "2020-11-03T20:17:14Z", "message": "chore(bigtable): spark deps cleanup and readme updates (#4134)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92a9f3e75b8b2c52f1cc711d9c3d05e2bedb4999", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/92a9f3e75b8b2c52f1cc711d9c3d05e2bedb4999", "committedDate": "2020-11-18T19:14:15Z", "message": "test(bigtable_spark): update integration test, update deps and readme (#4262)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb92666f2a26089148baeff5564984dcebaf33d1", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/cb92666f2a26089148baeff5564984dcebaf33d1", "committedDate": "2020-11-19T15:58:43Z", "message": "chore(bigtable_spark): readme cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/2920220f4079b65526d804c2e976e2dcb8b426bf", "committedDate": "2020-12-07T19:02:03Z", "message": "chore(bigtable_spark): last round of readme updates (#4353)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NjY0ODk4", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#pullrequestreview-547664898", "createdAt": "2020-12-08T21:55:23Z", "commit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NTMzMjk2", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#pullrequestreview-548533296", "createdAt": "2020-12-09T19:25:32Z", "commit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxOToyNTozMlrOICljPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxOTozNjoxM1rOICl-og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4MzI5Mw==", "bodyText": "I'd expect this to be okay as long as we're controlling not having duplicate dependencies above.", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#discussion_r539583293", "createdAt": "2020-12-09T19:25:32Z", "author": {"login": "BenWhitehead"}, "path": "bigtable/spark/build.sbt", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+name := \"bigtable-spark-samples\"\n+\n+version := \"0.1\"\n+\n+// Versions to match Dataproc 1.4\n+// https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-release-1.4\n+scalaVersion := \"2.11.12\"\n+val sparkVersion = \"2.4.6\"\n+val bigtableVersion = \"1.16.0\"\n+val hbaseVersion = \"1.3.6\"\n+\n+libraryDependencies ++= Seq(\n+  \"org.apache.spark\" %% \"spark-sql\" % sparkVersion % Provided,\n+  \"org.apache.hbase.connectors.spark\" % \"hbase-spark\" % \"1.0.0\" % Provided,\n+  \"com.google.cloud.bigtable\" % \"bigtable-hbase-2.x-hadoop\" % bigtableVersion\n+)\n+\n+val scalatestVersion = \"3.2.0\"\n+libraryDependencies += \"org.scalactic\" %% \"scalactic\" % scalatestVersion\n+libraryDependencies += \"org.scalatest\" %% \"scalatest\" % scalatestVersion % \"test\"\n+test in assembly := {}\n+\n+val fixes = Seq(\n+  // Required by 'value org.apache.hadoop.hbase.spark.HBaseContext.dstream'\n+  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion % Provided,\n+  // hbase-server is needed because HBaseContext references org/apache/hadoop/hbase/fs/HFileSystem\n+  // hbase-client is declared to override the version of hbase-client declared by bigtable-hbase-2.x-hadoop\n+  \"org.apache.hbase\" % \"hbase-server\" % hbaseVersion,\n+  \"org.apache.hbase\" % \"hbase-client\" % hbaseVersion\n+)\n+libraryDependencies ++= fixes\n+\n+// Fix for Exception: Incompatible Jackson 2.9.2\n+// Version conflict between HBase and Spark\n+// Forcing the version to match Spark\n+dependencyOverrides += \"com.fasterxml.jackson.module\" %% \"jackson-module-scala\" % \"2.9.10\"\n+\n+// Excluding duplicates for the uber-jar\n+// There are other deps to provide necessary packages\n+excludeDependencies ++= Seq(\n+  ExclusionRule(organization = \"asm\", \"asm\"),\n+  ExclusionRule(organization = \"commons-beanutils\", \"commons-beanutils\"),\n+  ExclusionRule(organization = \"commons-beanutils\", \"commons-beanutils-core\"),\n+  ExclusionRule(organization = \"org.mortbay.jetty\", \"servlet-api\")\n+)\n+\n+assemblyMergeStrategy in assembly := {\n+  case PathList(\"META-INF\", \"io.netty.versions.properties\") => MergeStrategy.first\n+  case PathList(\"META-INF\", \"MANIFEST.MF\") => MergeStrategy.discard\n+  case PathList(\"mozilla\", \"public-suffix-list.txt\") => MergeStrategy.first\n+  case PathList(\"google\", xs @ _*) => xs match {\n+    case ps @ (x :: xs) if ps.last.endsWith(\".proto\") => MergeStrategy.first", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4NDcyNA==", "bodyText": "This might cause issues with guava, since our libraries use the most up-to-date version and spark (and especially HBase) doesn't necessarily track as close there is a chance for a diamond. It might be worth asking tomo how we might run linkage checker against an assembly and seeing if it would work.", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#discussion_r539584724", "createdAt": "2020-12-09T19:27:38Z", "author": {"login": "BenWhitehead"}, "path": "bigtable/spark/build.sbt", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+name := \"bigtable-spark-samples\"\n+\n+version := \"0.1\"\n+\n+// Versions to match Dataproc 1.4\n+// https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-release-1.4\n+scalaVersion := \"2.11.12\"\n+val sparkVersion = \"2.4.6\"\n+val bigtableVersion = \"1.16.0\"\n+val hbaseVersion = \"1.3.6\"\n+\n+libraryDependencies ++= Seq(\n+  \"org.apache.spark\" %% \"spark-sql\" % sparkVersion % Provided,\n+  \"org.apache.hbase.connectors.spark\" % \"hbase-spark\" % \"1.0.0\" % Provided,\n+  \"com.google.cloud.bigtable\" % \"bigtable-hbase-2.x-hadoop\" % bigtableVersion\n+)\n+\n+val scalatestVersion = \"3.2.0\"\n+libraryDependencies += \"org.scalactic\" %% \"scalactic\" % scalatestVersion\n+libraryDependencies += \"org.scalatest\" %% \"scalatest\" % scalatestVersion % \"test\"\n+test in assembly := {}\n+\n+val fixes = Seq(\n+  // Required by 'value org.apache.hadoop.hbase.spark.HBaseContext.dstream'\n+  \"org.apache.spark\" %% \"spark-streaming\" % sparkVersion % Provided,\n+  // hbase-server is needed because HBaseContext references org/apache/hadoop/hbase/fs/HFileSystem\n+  // hbase-client is declared to override the version of hbase-client declared by bigtable-hbase-2.x-hadoop\n+  \"org.apache.hbase\" % \"hbase-server\" % hbaseVersion,\n+  \"org.apache.hbase\" % \"hbase-client\" % hbaseVersion\n+)\n+libraryDependencies ++= fixes\n+\n+// Fix for Exception: Incompatible Jackson 2.9.2\n+// Version conflict between HBase and Spark\n+// Forcing the version to match Spark\n+dependencyOverrides += \"com.fasterxml.jackson.module\" %% \"jackson-module-scala\" % \"2.9.10\"\n+\n+// Excluding duplicates for the uber-jar\n+// There are other deps to provide necessary packages\n+excludeDependencies ++= Seq(\n+  ExclusionRule(organization = \"asm\", \"asm\"),\n+  ExclusionRule(organization = \"commons-beanutils\", \"commons-beanutils\"),\n+  ExclusionRule(organization = \"commons-beanutils\", \"commons-beanutils-core\"),\n+  ExclusionRule(organization = \"org.mortbay.jetty\", \"servlet-api\")\n+)\n+\n+assemblyMergeStrategy in assembly := {\n+  case PathList(\"META-INF\", \"io.netty.versions.properties\") => MergeStrategy.first\n+  case PathList(\"META-INF\", \"MANIFEST.MF\") => MergeStrategy.discard\n+  case PathList(\"mozilla\", \"public-suffix-list.txt\") => MergeStrategy.first\n+  case PathList(\"google\", xs @ _*) => xs match {\n+    case ps @ (x :: xs) if ps.last.endsWith(\".proto\") => MergeStrategy.first\n+    case _ => MergeStrategy.deduplicate\n+  }\n+  case x =>\n+    val oldStrategy = (assemblyMergeStrategy in assembly).value\n+    oldStrategy(x)\n+    // FIXME Make sure first is OK (it's worked well so far)\n+    MergeStrategy.first", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4NTQ0MQ==", "bodyText": "Is this tracking the same version as spark? (latest is 1.4.4 according to https://www.scala-sbt.org/download.html)", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#discussion_r539585441", "createdAt": "2020-12-09T19:28:54Z", "author": {"login": "BenWhitehead"}, "path": "bigtable/spark/project/build.properties", "diffHunk": "@@ -0,0 +1,15 @@\n+# Copyright 2020 Google LLC\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#     https://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+sbt.version = 1.3.13", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4NzM0NA==", "bodyText": "The newline here will be kept in the output, not sure if that is intended.", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#discussion_r539587344", "createdAt": "2020-12-09T19:31:40Z", "author": {"login": "BenWhitehead"}, "path": "bigtable/spark/src/main/scala/example/CopyTable.scala", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package example\n+\n+import org.apache.hadoop.hbase.spark.datasources.{HBaseSparkConf, HBaseTableCatalog}\n+import org.apache.spark.sql.types.{IntegerType, StringType, StructField, StructType}\n+\n+object CopyTable extends App {\n+\n+  val appName = this.getClass.getSimpleName.replace(\"$\", \"\")\n+  println(s\"$appName Spark application is starting up...\")\n+\n+  val (projectId, instanceId, fromTable, toTable) = parse(args)\n+  println(\n+    s\"\"\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4ODQ1Ng==", "bodyText": "Missing validation for args like there is in CopyTable", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#discussion_r539588456", "createdAt": "2020-12-09T19:33:25Z", "author": {"login": "BenWhitehead"}, "path": "bigtable/spark/src/main/scala/example/Wordcount.scala", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package example\n+\n+import com.google.cloud.bigtable.hbase.BigtableConfiguration\n+import org.apache.hadoop.hbase.client._\n+import org.apache.hadoop.hbase.io.ImmutableBytesWritable\n+import org.apache.hadoop.hbase.mapreduce.TableOutputFormat\n+import org.apache.hadoop.hbase.util.Bytes\n+import org.apache.spark.SparkContext\n+\n+object Wordcount extends App {\n+\n+  val projectId = args(0)\n+  val instanceId = args(1)\n+  val table = args(2)\n+  val file = args(3)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU5MDMwNg==", "bodyText": "I would split each of these two tests into their own test so you can track them independently. We should be able to factor most of this code so that it's reusable by taking a function for the specific asserts.", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#discussion_r539590306", "createdAt": "2020-12-09T19:36:13Z", "author": {"login": "BenWhitehead"}, "path": "bigtable/spark/src/test/scala/example/IntegrationTest.scala", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package example\n+\n+import java.util.UUID\n+\n+import com.google.bigtable.repackaged.com.google.cloud.bigtable.admin.v2.BigtableTableAdminClient\n+import com.google.bigtable.repackaged.com.google.cloud.bigtable.admin.v2.models.CreateTableRequest\n+import com.google.bigtable.repackaged.com.google.cloud.bigtable.data.v2.models.Query\n+import com.google.bigtable.repackaged.com.google.cloud.bigtable.data.v2.{BigtableDataClient, BigtableDataSettings}\n+import org.scalatest.flatspec._\n+import org.scalatest.matchers._\n+\n+class IntegrationTest extends AnyFlatSpec\n+  with should.Matchers {\n+\n+  def getOrThrowException(envName: String): String = {\n+    sys.env.getOrElse(\n+      envName,\n+      throw new IllegalStateException(s\"Environment variable '$envName' is required to perform this integration test.\"))\n+  }\n+  val projectId: String = getOrThrowException(\"GOOGLE_CLOUD_PROJECT\")\n+  val instanceId: String = getOrThrowException(\"BIGTABLE_TESTING_INSTANCE\")\n+  val file = \"src/test/resources/Romeo-and-Juliet-prologue.txt\"\n+\n+  val wordcount_table_name: String = \"spark-wordcount-\" + UUID.randomUUID.toString.substring(0, 20);\n+  val copytable_table_name: String = \"spark-copytable-\" + UUID.randomUUID.toString.substring(0, 20);\n+\n+  val tableClient: BigtableTableAdminClient = BigtableTableAdminClient.create(projectId, instanceId)\n+  val settings: BigtableDataSettings =\n+    BigtableDataSettings.newBuilder().setProjectId(projectId).setInstanceId(instanceId).build()\n+  val dataClient: BigtableDataClient = BigtableDataClient.create(settings)\n+\n+  \"IntegrationTest\" should \"write records to Bigtable, copy them between tables\" in {\n+    try {\n+      import org.apache.spark.{SparkConf, SparkContext}\n+      val appName = getClass.getSimpleName.replace(\"$\", \"\")\n+      val config = new SparkConf().setMaster(\"local[*]\").setAppName(appName)\n+      SparkContext.getOrCreate(config)\n+\n+      val wordcountRequest = CreateTableRequest.of(wordcount_table_name).addFamily(\"cf\")\n+      tableClient.createTable(wordcountRequest)\n+\n+      val copytableRequest = CreateTableRequest.of(copytable_table_name).addFamily(\"cf\")\n+      tableClient.createTable(copytableRequest);\n+\n+      val wordcountArgs = Array(projectId, instanceId, wordcount_table_name, file)\n+      Wordcount.main(wordcountArgs)\n+      val copytableArgs = Array(projectId, instanceId, wordcount_table_name, copytable_table_name)\n+      CopyTable.main(copytableArgs)\n+\n+      import collection.JavaConverters._\n+      val wordcountRowCount = dataClient.readRows(Query.create(wordcount_table_name)).iterator().asScala.length\n+      val copytableRowCount = dataClient.readRows(Query.create(copytable_table_name)).iterator().asScala.length", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2920220f4079b65526d804c2e976e2dcb8b426bf"}, "originalPosition": 67}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1212d647cf890725031aae0becc1a9fd7d13a19d", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/1212d647cf890725031aae0becc1a9fd7d13a19d", "committedDate": "2020-12-09T22:08:51Z", "message": "validate args"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxODMwNDM5", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/4384#pullrequestreview-551830439", "createdAt": "2020-12-14T19:37:52Z", "commit": {"oid": "1212d647cf890725031aae0becc1a9fd7d13a19d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 427, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}