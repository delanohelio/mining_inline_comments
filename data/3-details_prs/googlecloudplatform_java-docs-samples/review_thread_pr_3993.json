{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyNzIzOTQy", "number": 3993, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QyMDo1MjowN1rOEtOEqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QyMDo1MjowN1rOEtOEqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE1ODUxOTQ0OnYy", "diffSide": "RIGHT", "path": "iot/api-client/end-to-end-example/src/test/java/com/example/cloud/iot/endtoend/CloudiotPubsubExampleServerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QyMDo1MjowN1rOHg5DQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QyMTowNDo0MVrOHg5cLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI1MTIwMw==", "bodyText": "Do you mean for this to be here?", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3993#discussion_r504251203", "createdAt": "2020-10-13T20:52:07Z", "author": {"login": "lesv"}, "path": "iot/api-client/end-to-end-example/src/test/java/com/example/cloud/iot/endtoend/CloudiotPubsubExampleServerTest.java", "diffHunk": "@@ -80,6 +95,37 @@ public void testConfigTurnOn() throws GeneralSecurityException, IOException, JSO\n     CloudiotPubsubExampleServer.deleteRegistry(CLOUD_REGION, PROJECT_ID, REGISTRY_ID);\n   }\n \n+  private void deleteUnusedOldRegistries(String projectId, String region)\n+      throws IOException, GeneralSecurityException {\n+    // Clean 50 oldest registries with testing prefix in the project.\n+    System.out.println(\"The maximum number of registries is about to exceed.\");\n+    System.out.println(\"Deleting the oldest 50 registries with IoT Test prefix\");\n+\n+    // Gather all the registries into temp list\n+    List<DeviceRegistry> registries = CleanUpHelper.getRegisteries(PROJECT_ID, CLOUD_REGION);\n+\n+    // Filter all registries with prefix.\n+    // since the list is already sorted by currentMillis suffix,\n+    // first 50 will be the oldest.\n+    List<DeviceRegistry> filteredRegistries = new ArrayList<>();\n+\n+    for (int i = 0; i < registries.size(); i++) {\n+      DeviceRegistry registry = registries.get(i);\n+      if (registry.getName().contains(\"test-registry-\")\n+          || registry.getName().contains(\"java-reg-\")) {\n+        filteredRegistries.add(registry);\n+      }\n+    }\n+\n+    // Delete the 50 oldest registries\n+    for (DeviceRegistry registry : filteredRegistries) {\n+      CleanUpHelper.clearRegistry(CLOUD_REGION, PROJECT_ID, registry.getId());\n+    }\n+    //      if()\n+    //      CleanUpHelper.clearRegistry();\n+    //    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d2cabaf9e38eceb852055c0fcf1ff7ef3c971f2"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI1NzU4MQ==", "bodyText": "oops\nI will fix that", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3993#discussion_r504257581", "createdAt": "2020-10-13T21:04:41Z", "author": {"login": "munkhuushmgl"}, "path": "iot/api-client/end-to-end-example/src/test/java/com/example/cloud/iot/endtoend/CloudiotPubsubExampleServerTest.java", "diffHunk": "@@ -80,6 +95,37 @@ public void testConfigTurnOn() throws GeneralSecurityException, IOException, JSO\n     CloudiotPubsubExampleServer.deleteRegistry(CLOUD_REGION, PROJECT_ID, REGISTRY_ID);\n   }\n \n+  private void deleteUnusedOldRegistries(String projectId, String region)\n+      throws IOException, GeneralSecurityException {\n+    // Clean 50 oldest registries with testing prefix in the project.\n+    System.out.println(\"The maximum number of registries is about to exceed.\");\n+    System.out.println(\"Deleting the oldest 50 registries with IoT Test prefix\");\n+\n+    // Gather all the registries into temp list\n+    List<DeviceRegistry> registries = CleanUpHelper.getRegisteries(PROJECT_ID, CLOUD_REGION);\n+\n+    // Filter all registries with prefix.\n+    // since the list is already sorted by currentMillis suffix,\n+    // first 50 will be the oldest.\n+    List<DeviceRegistry> filteredRegistries = new ArrayList<>();\n+\n+    for (int i = 0; i < registries.size(); i++) {\n+      DeviceRegistry registry = registries.get(i);\n+      if (registry.getName().contains(\"test-registry-\")\n+          || registry.getName().contains(\"java-reg-\")) {\n+        filteredRegistries.add(registry);\n+      }\n+    }\n+\n+    // Delete the 50 oldest registries\n+    for (DeviceRegistry registry : filteredRegistries) {\n+      CleanUpHelper.clearRegistry(CLOUD_REGION, PROJECT_ID, registry.getId());\n+    }\n+    //      if()\n+    //      CleanUpHelper.clearRegistry();\n+    //    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI1MTIwMw=="}, "originalCommit": {"oid": "6d2cabaf9e38eceb852055c0fcf1ff7ef3c971f2"}, "originalPosition": 68}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 746, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}