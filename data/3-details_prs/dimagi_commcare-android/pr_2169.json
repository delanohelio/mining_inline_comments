{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyNzk0ODkz", "number": 2169, "title": "Add days since last sync param to sync requests", "bodyText": "When performing a sync request, includes the integer days since the last day the device has synced to the URL parameters of the request, ie:\n/a/no-feature-flags/phone/restore/07a82c079ce340a8ae705ef3d66089f7/?device_id=353522096503145&user_id=ce3719da49ef4b4ea8740b2e617ae6b5&days_since_last_sync=34&state=ccsh:ba14c90a2370ecd5778cbdf5d81370ff&version=2.0&items=true&since=2605adb21c2b11eabf720a5180e0c5bc\nThe intent here is to allow HQ to create different pooled priorities for rate limiting based on how far behind a user is in syncing data, as such the data needs to be available to the proxy with no downstream processing.\n@shubham1g5 I am thinking that it makes the most sense for me to hotfix this as 2.47.5 as well, otherwise it won't make it out to users fast enough to be usable. Do you have reservations about that based on the code?\n@snopoke This is what we were discussing this morning. HQ can ignore all other cases other than days_since_last_sync=0, which should be simple pattern matching. Any objections to that?", "createdAt": "2020-01-14T19:14:46Z", "url": "https://github.com/dimagi/commcare-android/pull/2169", "merged": true, "mergeCommit": {"oid": "e0c6d3752359b976cdb317aeab765bffbec4f659"}, "closed": true, "closedAt": "2020-01-15T16:44:33Z", "author": {"login": "ctsims"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6V1NsAH2gAyMzYyNzk0ODkzOjJkNTFlNWU3NzIyYTQ5Nzc5MzM2OWY1NzMxZGNiZDRiMTUyNDk5MGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6ec1ZgFqTM0Mjk5MTQ3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2d51e5e7722a497793369f5731dcbd4b1524990f", "author": {"user": {"login": "ctsims", "name": "Clayton Sims"}}, "url": "https://github.com/dimagi/commcare-android/commit/2d51e5e7722a497793369f5731dcbd4b1524990f", "committedDate": "2020-01-14T19:08:40Z", "message": "Add days since last sync param to sync requests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyOTkwMDkz", "url": "https://github.com/dimagi/commcare-android/pull/2169#pullrequestreview-342990093", "createdAt": "2020-01-15T05:04:18Z", "commit": {"oid": "2d51e5e7722a497793369f5731dcbd4b1524990f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyOTkxNDc5", "url": "https://github.com/dimagi/commcare-android/pull/2169#pullrequestreview-342991479", "createdAt": "2020-01-15T05:11:11Z", "commit": {"oid": "2d51e5e7722a497793369f5731dcbd4b1524990f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwNToxMToxMVrOFdte4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwNToxMToxMVrOFdte4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjY5ODIwOA==", "bodyText": "Maybe use a header instead ? If not, just wanna double check since we are adding a new parameter, it won't result in any cache busting on HQ ?", "url": "https://github.com/dimagi/commcare-android/pull/2169#discussion_r366698208", "createdAt": "2020-01-15T05:11:11Z", "author": {"login": "shubham1g5"}, "path": "app/src/org/commcare/network/CommcareRequestGenerator.java", "diffHunk": "@@ -107,6 +108,11 @@ public static CommcareRequestGenerator buildNoAuthGenerator() {\n             if (digest != null) {\r\n                 params.put(\"state\", \"ccsh:\" + digest);\r\n             }\r\n+\r\n+            int getDaysSinceSync = SyncDetailCalculations.getDaysSinceLastSync();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d51e5e7722a497793369f5731dcbd4b1524990f"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2120, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}