{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MDg3NzE4", "number": 2279, "title": "Hides manual quarantine behind developer option", "bodyText": "Couple changes:\n\nOnly show manual quarantine based on a advance setting\nLogs the Quarantine event to Analytics\n\nhttps://dimagi-dev.atlassian.net/browse/ICDS-1568\nProduct Note: Hides the manual form Quarantine option from the scan record integrity dialog", "createdAt": "2020-06-17T20:47:26Z", "url": "https://github.com/dimagi/commcare-android/pull/2279", "merged": true, "mergeCommit": {"oid": "06aada60e4341a63123f80a40eb6c82af7365363"}, "closed": true, "closedAt": "2020-07-08T20:51:59Z", "author": {"login": "shubham1g5"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsOfvAgH2gAyNDM2MDg3NzE4OjBkMzg5YThkZWZlODMzZjkyYjMxODAwYzY2MDVjZGNjZDI1Y2FmMjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABczABVwgH2gAyNDM2MDg3NzE4OjkzMDFhNmI0ZjE1ZGZiYmZhMTQ5OGM2NWQ2NWE2NmEzMjZlNmZkYzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0d389a8defe833f92b31800c6605cdccd25caf27", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/0d389a8defe833f92b31800c6605cdccd25caf27", "committedDate": "2020-06-17T18:52:05Z", "message": "Hides manual quarantine behind dev option"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5e64ef3406710dbff8306d3d63883547e074c19", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/d5e64ef3406710dbff8306d3d63883547e074c19", "committedDate": "2020-06-17T20:43:52Z", "message": "logs quarantine event to analytics"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNzk2MDgz", "url": "https://github.com/dimagi/commcare-android/pull/2279#pullrequestreview-432796083", "createdAt": "2020-06-17T21:39:21Z", "commit": {"oid": "d5e64ef3406710dbff8306d3d63883547e074c19"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QyMTozOToyMVrOGlYWaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QyMTo0MDozN1rOGlYYow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTg0OTQ1MQ==", "bodyText": "Is there a reason this is \"spring loaded\" so to speak and only lets you quarantine a single form? That will get quite painful if there is some strange event that causes issues for a lot of forms in a row.", "url": "https://github.com/dimagi/commcare-android/pull/2279#discussion_r441849451", "createdAt": "2020-06-17T21:39:21Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/activities/FormRecordListActivity.java", "diffHunk": "@@ -464,10 +464,13 @@ private void createFormRecordScanResultDialog(Pair<Boolean, String> result, Form\n                 result.second, resId, null);\n \n         if (FormRecordFilter.Pending.containsStatus(record.getStatus())) {\n-            dialog.setNegativeButton(Localization.get(\"app.workflow.forms.quarantine\"), (dialog1, which) -> {\n-                manuallyQuarantineRecord(record);\n-                dismissAlertDialog();\n-            });\n+            if (DeveloperPreferences.isManualFormQuarantineAllowed()) {\n+                dialog.setNegativeButton(Localization.get(\"app.workflow.forms.quarantine\"), (dialog1, which) -> {\n+                    manuallyQuarantineRecord(record);\n+                    dismissAlertDialog();\n+                    DeveloperPreferences.disableManualFormQuarantine();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5e64ef3406710dbff8306d3d63883547e074c19"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTg1MDAxOQ==", "bodyText": "I think this needs to be behind the user visible / controllable developer preferences, not the \"Special Dimagi\" level preferences.\nManual quarantining is a support tool that we need non-Dimagi personnel to be able to trigger to recover a clean state on their devices.", "url": "https://github.com/dimagi/commcare-android/pull/2279#discussion_r441850019", "createdAt": "2020-06-17T21:40:37Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/preferences/DeveloperPreferences.java", "diffHunk": "@@ -56,6 +56,7 @@\n     private final static String ENFORCE_SECURE_ENDPOINT = \"cc-enforce-secure-endpoint\";\n     private final static String ALLOW_SPACE_IN_SELECT_CHOICES = \"cc-allow-space-in-select-choices\";\n     private final static String USE_EXPRESSION_CACHING_IN_FORMS = \"use-expression-caching-in-forms\";\n+    private final static String ALLOW_MANUAL_FORM_QUARANTINE = \"cc-allow-manual-form-quarantine\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5e64ef3406710dbff8306d3d63883547e074c19"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyOTE2NTIy", "url": "https://github.com/dimagi/commcare-android/pull/2279#pullrequestreview-432916522", "createdAt": "2020-06-18T03:31:41Z", "commit": {"oid": "d5e64ef3406710dbff8306d3d63883547e074c19"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a3d98fd3a901d4c414fd0ba419e3a66a8576ecc", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/5a3d98fd3a901d4c414fd0ba419e3a66a8576ecc", "committedDate": "2020-07-08T19:43:27Z", "message": "moved the pref to contol manual form quarantine to advanced settings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MDgzOTEy", "url": "https://github.com/dimagi/commcare-android/pull/2279#pullrequestreview-445083912", "createdAt": "2020-07-08T19:55:28Z", "commit": {"oid": "5a3d98fd3a901d4c414fd0ba419e3a66a8576ecc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9301a6b4f15dfbbfa1498c65d65a66a326e6fdc1", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/9301a6b4f15dfbbfa1498c65d65a66a326e6fdc1", "committedDate": "2020-07-08T19:57:41Z", "message": "Merge branch 'master' into hideQuarantineBehindDevOptions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2074, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}