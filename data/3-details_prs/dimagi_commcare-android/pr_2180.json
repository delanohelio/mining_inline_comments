{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MDQxNjM1", "number": 2180, "title": "Auto update scheduling", "bodyText": "Summary of changes\n\n\nIntroduces UpdateWorker which gets triggered by WorkManager periodically every couple hours to check for updates in background\n\n\nRefactors UpdateTask to rely on UpdateHandler which is abstraction for common update related functionality between UpdateTask and UpdateWorker\n\n\nRemoves old auto updates code\n\n\nIntroduces a new AppInstallStatus  Cancelled to denote cancellation of update tasks\n\n\nBinds the UpdateActivity UI to UpdateWorker when the worker task is in progress\n\n\nRelease Note: Implements a more robust background scheduling mechanism for Auto-updates", "createdAt": "2020-01-30T12:15:39Z", "url": "https://github.com/dimagi/commcare-android/pull/2180", "merged": true, "mergeCommit": {"oid": "bee4552175fa35984aff3d42cb97211f6c7919e9"}, "closed": true, "closedAt": "2020-05-01T19:25:00Z", "author": {"login": "shubham1g5"}, "timelineItems": {"totalCount": 41, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb5ZCc5gH2gAyMzY5MDQxNjM1OjZmZjEyMDIyOTVjMmRhZDg4ZmIyY2Y5ODVkZDZmNmYzZjViYmY4MTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcdGk8SAFqTQwNDM0NDQ0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6ff1202295c2dad88fb2cf985dd6f6f3f5bbf813", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/6ff1202295c2dad88fb2cf985dd6f6f3f5bbf813", "committedDate": "2020-01-11T20:18:55Z", "message": "Refactor to move UpdateTask implementation details to UpdateHelper"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e75bf254f262afbd770f291b2c68bd6effe80511", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/e75bf254f262afbd770f291b2c68bd6effe80511", "committedDate": "2020-01-17T11:19:48Z", "message": "Refining Update Worker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7a32e68ddd3426968c8cb586db1998318803fbc", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/c7a32e68ddd3426968c8cb586db1998318803fbc", "committedDate": "2020-01-20T14:06:56Z", "message": "commit -> apply"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "374d48858be21894b21b49ecd7d50f8a22e17d37", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/374d48858be21894b21b49ecd7d50f8a22e17d37", "committedDate": "2020-01-21T11:43:38Z", "message": "Removes old auto updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e70d536babc2891565826d585452ee41ca2f6b2", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/6e70d536babc2891565826d585452ee41ca2f6b2", "committedDate": "2020-01-22T12:10:04Z", "message": "Minor no-ops"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "077aba020cdfebd15a3f3f52fe6c3a9e6d444bdf", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/077aba020cdfebd15a3f3f52fe6c3a9e6d444bdf", "committedDate": "2020-01-22T12:10:57Z", "message": "Merge branch 'master' into autoUpdateScheduling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cba9bf1ca6ba21fcc7f9546018469d3479da839a", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/cba9bf1ca6ba21fcc7f9546018469d3479da839a", "committedDate": "2020-01-22T14:42:52Z", "message": "Removes auto update test as the retry mechanism is handle by workmanager itself"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f2a2234b49fe03f9db5ac0bc25ab62a260992de", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/4f2a2234b49fe03f9db5ac0bc25ab62a260992de", "committedDate": "2020-01-23T05:15:28Z", "message": "Removes userCancellationFlag as auto updates can never be cancelled by user"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "157596f0cb9f052f0de5e4396ec7625e5c62bdd1", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/157596f0cb9f052f0de5e4396ec7625e5c62bdd1", "committedDate": "2020-01-23T05:45:42Z", "message": "Error handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "108dd03b75f5076964eae6faded9782c205687a5", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/108dd03b75f5076964eae6faded9782c205687a5", "committedDate": "2020-01-23T05:47:55Z", "message": "no-op"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a0fb79ff4d8022b4acb1ee2f2e4432df0887b47", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/4a0fb79ff4d8022b4acb1ee2f2e4432df0887b47", "committedDate": "2020-01-27T09:18:04Z", "message": "Shifts Kotlin to Java 8 byte code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64a43cb747b0bf471120274dfa504948636daa84", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/64a43cb747b0bf471120274dfa504948636daa84", "committedDate": "2020-01-30T12:14:44Z", "message": "Binds updateActivity UI with UpdateWorker, cancel workers on app lifecycle changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ff9849403ed662d38fbd7a7f918e394262f784f", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/5ff9849403ed662d38fbd7a7f918e394262f784f", "committedDate": "2020-01-30T12:26:51Z", "message": "bump workmanager to stable release"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/902179a7ac968aebe78a09f14f6eba446cdc5eb5", "committedDate": "2020-02-04T12:19:02Z", "message": "repackaging updatewoker and updateTask in update module"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7da9ee95771d79bbf820316fd24c24da45ba455", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/b7da9ee95771d79bbf820316fd24c24da45ba455", "committedDate": "2020-02-04T13:44:38Z", "message": "Repackage ProcessAndSendTak in sync module"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NDI2OTg3", "url": "https://github.com/dimagi/commcare-android/pull/2180#pullrequestreview-355426987", "createdAt": "2020-02-07T20:47:04Z", "commit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMDo0NzowNFrOFnJ1AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMToxNDozMVrOFnKeuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU5OTgwOQ==", "bodyText": "This error message is pretty confusing. Can we shift it to just say something like \"An app update event was cancelled before it completed\"?", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376599809", "createdAt": "2020-02-07T20:47:04Z", "author": {"login": "ctsims"}, "path": "app/assets/locales/android_translatable_strings.txt", "diffHunk": "@@ -543,6 +543,10 @@ notification.install.badcert.title=Bad Certificate\n notification.install.badcert.detail=The certificate you received from the server was invalid. This can be casued by many things, but is often do to a mis-set clock on your phone.\r\n notification.install.badcert.action=This is often due to your phone's internal clock being incorrect.\r\n \r\n+notification.install.cancel.title=Update Cancelled\r\n+notification.install.cancel.detail=This update was aborted either by CommCare or you.\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwMTc2MA==", "bodyText": "Should areAutomatedActionsInvalid() still apply to this line?", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376601760", "createdAt": "2020-02-07T20:51:53Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/CommCareApplication.java", "diffHunk": "@@ -702,9 +708,8 @@ public void onServiceConnected(ComponentName className, IBinder service) {\n                             CommCareApplication.this.sessionWrapper = new AndroidSessionWrapper(CommCareApplication.this.getCommCarePlatform());\r\n                         }\r\n \r\n-                        if (shouldAutoUpdate()) {\r\n-                            startAutoUpdate();\r\n-                        }\r\n+                        scheduleAppUpdate();\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwMjkyNA==", "bodyText": "Since this comes after the commit change, this should actually be cancelling the lastSeatedId above, right?", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376602924", "createdAt": "2020-02-07T20:55:10Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/activities/LoginActivity.java", "diffHunk": "@@ -238,11 +238,22 @@ protected boolean checkForSeatedAppChange() {\n         String currentSeatedId = CommCareApplication.instance().getCurrentApp().getUniqueId();\r\n         if (!lastSeatedId.equals(currentSeatedId)) {\r\n             prefs.edit().putString(KEY_LAST_APP, currentSeatedId).commit();\r\n+            disableWorkForLastSeatedApp();\r\n             return true;\r\n         }\r\n         return false;\r\n     }\r\n \r\n+\r\n+    // cancels all worker tasks for previously seated app\r\n+    private static void disableWorkForLastSeatedApp() {\r\n+        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(CommCareApplication.instance());\r\n+        String lastSeatedId = prefs.getString(KEY_LAST_APP, \"\");\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwNDA0OA==", "bodyText": "Maybe I'm a bit confused but does this all imply that there's both an UpdateTask and an Update Worker now, and both can be running the process?", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376604048", "createdAt": "2020-02-07T20:57:46Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/activities/UpdateActivity.java", "diffHunk": "@@ -128,22 +135,61 @@ private void loadSavedInstanceState(Bundle savedInstanceState) {\n     }\n \n     private void setupUpdateTask(boolean isRotation) {\n-        updateTask = UpdateTask.getRunningInstance();\n-\n-        if (updateTask != null) {\n-            try {\n-                updateTask.registerTaskListener(this);\n-            } catch (TaskListenerRegistrationException e) {\n-                Log.e(TAG, \"Attempting to register a TaskListener to an already \" +\n-                        \"registered task.\");\n-                uiController.errorUiState();\n+        if (isAutoUpdateInProgress()) {\n+            connectToUpdateWorker();\n+        } else {\n+            updateTask = UpdateTask.getRunningInstance();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwNzU4OA==", "bodyText": "This needs to occur before line 45 above, since once the instance is unseated we would start to experience issues if the worker continued until line 56.\nI'd actually recommend that we add this \"cancelAllWorkByTag\" action directly to the CCInstance.unseat()method in general", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376607588", "createdAt": "2020-02-07T21:06:37Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/utils/AppLifecycleUtils.java", "diffHunk": "@@ -50,6 +52,9 @@ public static void uninstall(ApplicationRecord record) {\n         record.setStatus(ApplicationRecord.STATUS_DELETE_REQUESTED);\n         ccInstance.getGlobalStorage(ApplicationRecord.class).write(record);\n \n+        // cancel all Workmanager tasks for this app\n+        WorkManager.getInstance(CommCareApplication.instance()).cancelAllWorkByTag(record.getApplicationId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwODAxMw==", "bodyText": "Is there a reason we aren't replicating a similar test?\nI think in general we should consider it a poor outcome to replace one process that was tested with another that had no tests.", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376608013", "createdAt": "2020-02-07T21:07:41Z", "author": {"login": "ctsims"}, "path": "app/unit-tests/src/org/commcare/android/tests/application/AutoUpdateTest.java", "diffHunk": "@@ -38,92 +26,6 @@\n @Config(application = CommCareTestApplication.class)\n @RunWith(CommCareTestRunner.class)\n public class AutoUpdateTest {\n-    private final static String REF_BASE_DIR = \"jr://resource/commcare-apps/update_tests/\";\n-    private final static String username = \"test\";\n-    private final static String password = \"123\";\n-\n-    /**\n-     * Check that logging out after an auto-update check failed once should\n-     * trigger the auto-update to resume.\n-     */\n-    @Test\n-    public void testAppAutoUpdateLogoutRetry() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwODU1OA==", "bodyText": "It looks like this more or less takes us to a context where we retry auto update every 2 hours, right?\nServer load-wise I think that's quite often if we're presuming that we tried to contact the server, succeeded, and saw there was no update.", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376608558", "createdAt": "2020-02-07T21:09:10Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/CommCareApplication.java", "diffHunk": "@@ -755,6 +761,30 @@ public void onServiceDisconnected(ComponentName className) {\n         sessionServiceIsBinding = true;\r\n     }\r\n \r\n+    // Hand off an app update task to the Android WorkManager\r\n+    private void scheduleAppUpdate() {\r\n+        Constraints constraints = new Constraints.Builder()\r\n+                .setRequiredNetworkType(NetworkType.CONNECTED)\r\n+                .setRequiresBatteryNotLow(true)\r\n+                .build();\r\n+\r\n+        PeriodicWorkRequest updateRequest =\r\n+                new PeriodicWorkRequest.Builder(UpdateWorker.class, PERIODICITY_FOR_UPDATE_IN_HOURS, TimeUnit.HOURS)\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwOTk2Nw==", "bodyText": "I'm not sure this resonates with me.\nI think we only want to be applying the backoff-controlled-retries if there was a network reason for the update to fail. The UnknownError state, for example, doesn't feel like it should necessarily be triggering up to (5 min, 25 min, 10 hr) 3 retries over the course of the day before the user is logged out.", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376609967", "createdAt": "2020-02-07T21:13:10Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/update/UpdateWorker.kt", "diffHunk": "@@ -0,0 +1,105 @@\n+package org.commcare.update\n+\n+import android.content.Context\n+import androidx.work.CoroutineWorker\n+import androidx.work.WorkerParameters\n+import androidx.work.workDataOf\n+import kotlinx.coroutines.CancellationException\n+import kotlinx.coroutines.async\n+import kotlinx.coroutines.coroutineScope\n+import org.commcare.CommCareApplication\n+import org.commcare.engine.resource.AppInstallStatus\n+import org.commcare.engine.resource.ResourceInstallUtils\n+import org.commcare.resources.model.InstallCancelled\n+import org.commcare.tasks.ResultAndError\n+\n+/**\n+ * Used to stage an update for the seated app in the background. Does not perform\n+ * actual update.\n+ *\n+ */\n+class UpdateWorker(appContext: Context, workerParams: WorkerParameters)\n+    : CoroutineWorker(appContext, workerParams), InstallCancelled, UpdateProgressListener {\n+\n+    companion object {\n+        const val Progress_Complete = \"complete\"\n+        const val Progress_Total = \"total\"\n+    }\n+\n+    private lateinit var updateHelper: UpdateHelper\n+\n+    override suspend fun doWork(): Result {\n+\n+        updateHelper = UpdateHelper.getNewInstance(true, this, this)\n+\n+        return coroutineScope {\n+            val job = async {\n+                doUpdateWork()\n+            }\n+\n+            job.invokeOnCompletion { exception: Throwable? ->\n+                when (exception) {\n+                    is CancellationException -> {\n+                        handleUpdateResult(ResultAndError(AppInstallStatus.Cancelled))\n+                    }\n+                    else -> {\n+                        handleUpdateResult(ResultAndError(AppInstallStatus.UnknownFailure))\n+                    }\n+                }\n+            }\n+\n+            job.await()\n+        }\n+\n+    }\n+\n+    private fun doUpdateWork(): Result {\n+        var updateResult: ResultAndError<AppInstallStatus>\n+\n+        // skip if - An update task is already running | no app is seated | user session is not active\n+        if (UpdateTask.getRunningInstance() == null &&\n+                CommCareApplication.instance().getCurrentApp() != null &&\n+                CommCareApplication.instance().getSession().isActive() &&\n+                UpdateHelper.shouldAutoUpdate()) {\n+\n+            updateHelper.startPinnedNotification(CommCareApplication.instance())\n+            updateResult = updateHelper.update(ResourceInstallUtils.getDefaultProfileRef())\n+        } else {\n+            return Result.success()\n+        }\n+        return handleUpdateResult(updateResult)\n+    }\n+\n+    private fun handleUpdateResult(updateResult: ResultAndError<AppInstallStatus>): Result {\n+\n+        if (updateResult.data == AppInstallStatus.Cancelled) {\n+            updateHelper.OnUpdateCancelled()\n+        }\n+\n+        updateHelper.OnUpdateComplete(updateResult)\n+\n+        cleanUp()\n+\n+        return when (updateResult.data.isUpdateInCompletedState) {\n+            true -> Result.success()\n+            else -> Result.retry()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYxMDQ5MQ==", "bodyText": "Quick note that this request isn't synchronous. I'm not sure how killing the update tasks worked when we unseated apps, but if you haven't checked it would be worth confirming that the semantics are the same.", "url": "https://github.com/dimagi/commcare-android/pull/2180#discussion_r376610491", "createdAt": "2020-02-07T21:14:31Z", "author": {"login": "ctsims"}, "path": "app/src/org/commcare/activities/LoginActivity.java", "diffHunk": "@@ -238,11 +238,22 @@ protected boolean checkForSeatedAppChange() {\n         String currentSeatedId = CommCareApplication.instance().getCurrentApp().getUniqueId();\r\n         if (!lastSeatedId.equals(currentSeatedId)) {\r\n             prefs.edit().putString(KEY_LAST_APP, currentSeatedId).commit();\r\n+            disableWorkForLastSeatedApp();\r\n             return true;\r\n         }\r\n         return false;\r\n     }\r\n \r\n+\r\n+    // cancels all worker tasks for previously seated app\r\n+    private static void disableWorkForLastSeatedApp() {\r\n+        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(CommCareApplication.instance());\r\n+        String lastSeatedId = prefs.getString(KEY_LAST_APP, \"\");\r\n+        if(!lastSeatedId.isEmpty()) {\r\n+            WorkManager.getInstance(CommCareApplication.instance()).cancelAllWorkByTag(lastSeatedId);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "902179a7ac968aebe78a09f14f6eba446cdc5eb5"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd2f30c878dfa77008e2e6efd536455e4f82c66f", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/bd2f30c878dfa77008e2e6efd536455e4f82c66f", "committedDate": "2020-02-10T08:13:52Z", "message": "PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88ff0244ecb7c102fa60e62c231196086dc3cb05", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/88ff0244ecb7c102fa60e62c231196086dc3cb05", "committedDate": "2020-02-10T09:28:28Z", "message": "Only retry updates on Network related errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "003444348497b47ca2713cbbe5d2417bb039392f", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/003444348497b47ca2713cbbe5d2417bb039392f", "committedDate": "2020-02-17T10:56:07Z", "message": "Refactors ProcessAndSendTask to use FormSubmissionHelper"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bac133edb564396488f83e5ab67a835c22fa8252", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/bac133edb564396488f83e5ab67a835c22fa8252", "committedDate": "2020-02-20T04:23:06Z", "message": "Makes unsent records calculation part of the background work"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ecdf9960b59a5b9a53fb95bc06ff240a524b644", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/1ecdf9960b59a5b9a53fb95bc06ff240a524b644", "committedDate": "2020-02-20T06:15:07Z", "message": "Schedules Form Submission Work Request"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0005d3fe6489b1c854a4fe6b1c8a46b8f4ff61d3", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/0005d3fe6489b1c854a4fe6b1c8a46b8f4ff61d3", "committedDate": "2020-02-21T09:36:12Z", "message": "Update notifcation from form submission worker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58b11115206038256d4af62a8549a09819ec9e00", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/58b11115206038256d4af62a8549a09819ec9e00", "committedDate": "2020-03-05T12:37:06Z", "message": "Merge branch 'master' into formSubmissionsScheduling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abb135fa8163520d54ae0d848809c577b761169d", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/abb135fa8163520d54ae0d848809c577b761169d", "committedDate": "2020-03-05T13:14:58Z", "message": "Merge branch 'master' into autoUpdateScheduling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fc4466b53a74d54268d70109537c70b1e899cb3", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/8fc4466b53a74d54268d70109537c70b1e899cb3", "committedDate": "2020-03-05T13:15:51Z", "message": "Merge branch 'autoUpdateScheduling' into formSubmissionsScheduling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5d61dec3abb5d8ffa0b9d05194dce8fca501d03", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/a5d61dec3abb5d8ffa0b9d05194dce8fca501d03", "committedDate": "2020-03-05T14:37:15Z", "message": "Removes cancel on no filed found for the form as we may wanna continue to upload other forms"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96c26ce226d5b1fdf448b9b23cb5d9e1e3917a58", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/96c26ce226d5b1fdf448b9b23cb5d9e1e3917a58", "committedDate": "2020-03-08T06:15:31Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f85c618b7c43283aedd3e2e2795a14195f354d7", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/7f85c618b7c43283aedd3e2e2795a14195f354d7", "committedDate": "2020-03-11T12:25:05Z", "message": "Adds flag to disable work manager tasks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3e63e90eecd855a47579eada20948ef466c5738", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/f3e63e90eecd855a47579eada20948ef466c5738", "committedDate": "2020-03-11T12:56:11Z", "message": "Backs off in case of rate limiting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e647fe50494e70945865f0e66980b13f7844a113", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/e647fe50494e70945865f0e66980b13f7844a113", "committedDate": "2020-03-11T13:51:56Z", "message": "Removes the explicit trigger for sending forms on login as it should be triggered by Work Manager in timely fashion now"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b928dd1acd5376fe7cbfd4cd99ca9b36b27b80a", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/3b928dd1acd5376fe7cbfd4cd99ca9b36b27b80a", "committedDate": "2020-03-20T07:20:23Z", "message": "Makes auto update periodicity dependent on app settings auto-update-frequency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6db06b2935d2b52b061e98f043db02223df6371d", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/6db06b2935d2b52b061e98f043db02223df6371d", "committedDate": "2020-03-20T07:25:53Z", "message": "Merge branch 'autoUpdateScheduling' into formSubmissionsScheduling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9c969223dbf989b51dba076ce228f15a207a925", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/f9c969223dbf989b51dba076ce228f15a207a925", "committedDate": "2020-03-20T08:01:33Z", "message": "Add java docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1ODgyMzQw", "url": "https://github.com/dimagi/commcare-android/pull/2180#pullrequestreview-385882340", "createdAt": "2020-04-01T19:24:53Z", "commit": {"oid": "3b928dd1acd5376fe7cbfd4cd99ca9b36b27b80a"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2adfc93857755e9ebfd281e97af623f97fd5423", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/c2adfc93857755e9ebfd281e97af623f97fd5423", "committedDate": "2020-04-09T11:55:10Z", "message": "Merge branch 'master' into formSubmissionsScheduling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39550bdf4f93888e17a0d74dd9e509a6603eabce", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/39550bdf4f93888e17a0d74dd9e509a6603eabce", "committedDate": "2020-04-18T10:54:01Z", "message": "Merge branch 'master' into formSubmissionsScheduling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32aaf0774baec7fcb676ceaef1b22c96dbd48ed0", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/32aaf0774baec7fcb676ceaef1b22c96dbd48ed0", "committedDate": "2020-04-18T11:13:05Z", "message": "Set background work to be disabled for 36 hours after the heartbeat flag is set"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5eb5d03e189f67e2ebdd34ea2ee577ed7172bf9d", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/5eb5d03e189f67e2ebdd34ea2ee577ed7172bf9d", "committedDate": "2020-04-18T11:15:51Z", "message": "better constant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbc327968e7aaa6e719bfd24bead73cab669740b", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/dbc327968e7aaa6e719bfd24bead73cab669740b", "committedDate": "2020-05-01T13:59:44Z", "message": "Merge pull request #2195 from dimagi/formSubmissionsScheduling\n\nForm submissions Scheduling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cef353a4d92f653e5abafc71bc9901dca10dacd7", "author": {"user": {"login": "shubham1g5", "name": "Shubham Goyal"}}, "url": "https://github.com/dimagi/commcare-android/commit/cef353a4d92f653e5abafc71bc9901dca10dacd7", "committedDate": "2020-05-01T14:06:04Z", "message": "Merge branch 'master' into autoUpdateScheduling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MzQ0NDQy", "url": "https://github.com/dimagi/commcare-android/pull/2180#pullrequestreview-404344442", "createdAt": "2020-05-01T19:09:40Z", "commit": {"oid": "cef353a4d92f653e5abafc71bc9901dca10dacd7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2129, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}