{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwNDU2NDM0", "number": 6655, "title": "fix: correct validation rule for Event's TEI value", "bodyText": "Fixes an issue with validating the trackedEntity value of an incoming Event.\nAdditionally, this PR introduces a BundlePreProcessor interface to alter the payload prior to validation.\nA new PreProcessor is created to infer the trackedEntity value of an Event from the parent Enrollment.\nref: DHIS2-9958", "createdAt": "2020-11-13T09:16:57Z", "url": "https://github.com/dhis2/dhis2-core/pull/6655", "merged": true, "mergeCommit": {"oid": "2670177207885cb54b4b51516d55749ab8836588"}, "closed": true, "closedAt": "2020-11-13T13:02:17Z", "author": {"login": "luciano-fiandesio"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcEY0xgFqTUyOTkzNjg2Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcF-ZwAH2gAyNTIwNDU2NDM0OjNiNDM3MzczY2IxZTQ3MjdkOTNhOTEwNzdkYzkyYTQ1ZjJkMDEzNmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5OTM2ODY2", "url": "https://github.com/dhis2/dhis2-core/pull/6655#pullrequestreview-529936866", "createdAt": "2020-11-13T10:13:52Z", "commit": {"oid": "705f75762e693db5b37173d6a0fd12d67b1a57fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5OTM5MTI1", "url": "https://github.com/dhis2/dhis2-core/pull/6655#pullrequestreview-529939125", "createdAt": "2020-11-13T10:17:08Z", "commit": {"oid": "f56dda1c05e6d5abe8b6e0fe68962dbd706a3fca"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxMDoxNzowOVrOHyok4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxMDoxNzowOVrOHyok4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjg1NTY0OQ==", "bodyText": "Just so we dont forget, lets make a jira issue for it (TECH)", "url": "https://github.com/dhis2/dhis2-core/pull/6655#discussion_r522855649", "createdAt": "2020-11-13T10:17:09Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/preprocess/DefaultTrackerPreprocessService.java", "diffHunk": "@@ -48,15 +48,29 @@\n {\n     private List<RuleActionApplier> appliers = new ArrayList<>();\n \n+    private List<BundlePreProcessor> preProcessors = new ArrayList<>();\n+\n     @Autowired( required = false )\n     public void setAppliers( List<RuleActionApplier> appliers )\n     {\n         this.appliers = appliers;\n     }\n \n+    @Autowired( required = false )\n+    public void setPreProcessors( List<BundlePreProcessor> preProcessors )\n+    {\n+        this.preProcessors = preProcessors;\n+    }\n+\n     @Override\n     public TrackerBundle preprocess( TrackerBundle bundle )\n     {\n+        // TODO we may consider \"merging\" the BundlePreProcessor with the RuleActionApplier, since", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f56dda1c05e6d5abe8b6e0fe68962dbd706a3fca"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "298ef50d4dfb8ddc83ba4143dd65126208826a36", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/298ef50d4dfb8ddc83ba4143dd65126208826a36", "committedDate": "2020-11-13T11:03:45Z", "message": "fix: correct validation rule for Event's TEI value\n\nFixes an issue with validating the `trackedEntity` value of an incoming Event.\n\nAdditionally, this PR introduces a `BundlePreProcessor` interface to alter the payload prior to validation.\nA new PreProcessor is created to infer the `trackedEntity` value of an Event from the parent Enrollment.\n\nref: DHIS2-9958"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d69d6dbe30cb25024df2bf1bb9f45267a89a3fc0", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/d69d6dbe30cb25024df2bf1bb9f45267a89a3fc0", "committedDate": "2020-11-13T11:03:45Z", "message": "fix: unit test failing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa590517352d8bc408547141b5492f59241453ba", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/fa590517352d8bc408547141b5492f59241453ba", "committedDate": "2020-11-13T11:10:22Z", "message": "fix: add tei to preheat in preprocessor"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "705f75762e693db5b37173d6a0fd12d67b1a57fe", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/705f75762e693db5b37173d6a0fd12d67b1a57fe", "committedDate": "2020-11-13T09:59:38Z", "message": "fix: unit test failing"}, "afterCommit": {"oid": "fa590517352d8bc408547141b5492f59241453ba", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/fa590517352d8bc408547141b5492f59241453ba", "committedDate": "2020-11-13T11:10:22Z", "message": "fix: add tei to preheat in preprocessor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3265843c6aedbd05f3c289f8f6d4f9d9fe7ac5b3", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3265843c6aedbd05f3c289f8f6d4f9d9fe7ac5b3", "committedDate": "2020-11-13T11:37:23Z", "message": "fix: unignored and fixed test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b437373cb1e4727d93a91077dc92a45f2d0136d", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3b437373cb1e4727d93a91077dc92a45f2d0136d", "committedDate": "2020-11-13T12:04:48Z", "message": "fix: fixed tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2264, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}