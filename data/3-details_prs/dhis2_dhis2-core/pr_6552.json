{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MDA3NDU5", "number": 6552, "title": "fix: Exception when importing TEI with relationship [DHIS2-9856]", "bodyText": "Update all preCheck hooks to include implementation of the validateRelationShip method in order to avoid exception when TEI is imported with relationships.", "createdAt": "2020-11-02T11:53:30Z", "url": "https://github.com/dhis2/dhis2-core/pull/6552", "merged": true, "mergeCommit": {"oid": "6e28dbfdaea7ceacbe560fe82ddba1e94c6cd203"}, "closed": true, "closedAt": "2020-11-11T16:41:56Z", "author": {"login": "zubaira"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYjJ--AH2gAyNTE0MDA3NDU5OmEwMDViNjg3ZmI3MTE4N2Y4YjY4ZjQwZjI2YzdmNmRhNDQ4MDRlY2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbgHToAH2gAyNTE0MDA3NDU5OjM2OTU3ZDBkZWNmYzk1MTE3MzI5MDU3OTUwYzYyY2FhYzJmNGEzNWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a005b687fb71187f8b68f40f26c7f6da44804ecf", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/a005b687fb71187f8b68f40f26c7f6da44804ecf", "committedDate": "2020-11-02T11:49:00Z", "message": "fix: Exception when importing TEI with relationship"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNjA4MzQ0", "url": "https://github.com/dhis2/dhis2-core/pull/6552#pullrequestreview-521608344", "createdAt": "2020-11-02T13:04:35Z", "commit": {"oid": "a005b687fb71187f8b68f40f26c7f6da44804ecf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNjEyMzE2", "url": "https://github.com/dhis2/dhis2-core/pull/6552#pullrequestreview-521612316", "createdAt": "2020-11-02T13:09:29Z", "commit": {"oid": "a005b687fb71187f8b68f40f26c7f6da44804ecf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0OTkyMzEy", "url": "https://github.com/dhis2/dhis2-core/pull/6552#pullrequestreview-524992312", "createdAt": "2020-11-06T09:37:24Z", "commit": {"oid": "a005b687fb71187f8b68f40f26c7f6da44804ecf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQwOTozNzoyNFrOHumuRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQwOTozODo1NFrOHumxcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYzMDk4MA==", "bodyText": "In my refactor, I am actually generating all missing uids. The only thing we need to validate is that isUidInvalid(). This is just a note though, for this PR, keep it like this :)", "url": "https://github.com/dhis2/dhis2-core/pull/6552#discussion_r518630980", "createdAt": "2020-11-06T09:37:24Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/validation/hooks/PreCheckValidateAndGenerateUidHook.java", "diffHunk": "@@ -120,7 +121,27 @@ public void validateEvent( ValidationErrorReporter reporter, Event event )\n         validateNotesUid( event.getNotes(), reporter );\n     }\n \n-    private void validateNotesUid( List<Note> notes, ValidationErrorReporter reporter )\n+    @Override\n+    public void validateRelationship( ValidationErrorReporter reporter, Relationship relationship )", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a005b687fb71187f8b68f40f26c7f6da44804ecf"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYzMTY5NQ==", "bodyText": "I am removing the String uid fields from the other models, since we already have fields for uid (trackedEntity, enrollment, event, relationship).\nI would like you to use relationship instead here, since the only change we would potentially do here, is to add a new uid if there is no uid already.", "url": "https://github.com/dhis2/dhis2-core/pull/6552#discussion_r518631695", "createdAt": "2020-11-06T09:38:41Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/domain/Relationship.java", "diffHunk": "@@ -43,6 +43,8 @@\n @AllArgsConstructor\n public class Relationship implements TrackerDto\n {\n+    private String uid;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a005b687fb71187f8b68f40f26c7f6da44804ecf"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYzMTc5Mg==", "bodyText": "the \"relationship\" field on Relationship I mean :)", "url": "https://github.com/dhis2/dhis2-core/pull/6552#discussion_r518631792", "createdAt": "2020-11-06T09:38:54Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/domain/Relationship.java", "diffHunk": "@@ -43,6 +43,8 @@\n @AllArgsConstructor\n public class Relationship implements TrackerDto\n {\n+    private String uid;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODYzMTY5NQ=="}, "originalCommit": {"oid": "a005b687fb71187f8b68f40f26c7f6da44804ecf"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20a6bbd8e00b29d2f70d119d5b3e1a87e8b79bb9", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/20a6bbd8e00b29d2f70d119d5b3e1a87e8b79bb9", "committedDate": "2020-11-09T10:32:54Z", "message": "Merge branch 'master' into DHIS2-9856"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bba2661fdbd6fada1dbe4e19208fa59abdb186a7", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/bba2661fdbd6fada1dbe4e19208fa59abdb186a7", "committedDate": "2020-11-09T10:38:39Z", "message": "remove uid and use relationship field instead"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MjE3Nzcy", "url": "https://github.com/dhis2/dhis2-core/pull/6552#pullrequestreview-526217772", "createdAt": "2020-11-09T12:50:39Z", "commit": {"oid": "bba2661fdbd6fada1dbe4e19208fa59abdb186a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36957d0decfc95117329057950c62caac2f4a35c", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/36957d0decfc95117329057950c62caac2f4a35c", "committedDate": "2020-11-11T15:58:08Z", "message": "Merge branch 'master' into DHIS2-9856"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2295, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}