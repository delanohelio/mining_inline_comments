{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2ODQ5NTc0", "number": 5409, "title": "fix: Ensure unique column names for Resource Tables", "bodyText": "DHIS2-8684\nThis fix makes sure that during Resource Table generation process, the column names are always unique.", "createdAt": "2020-04-21T19:03:20Z", "url": "https://github.com/dhis2/dhis2-core/pull/5409", "merged": true, "mergeCommit": {"oid": "7e8667f33c993c831f47aa1948d65e1901105ebb"}, "closed": true, "closedAt": "2020-06-04T10:35:41Z", "author": {"login": "luciano-fiandesio"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ4eY-AH2gAyNDA2ODQ5NTc0OmE4YjExNWUzMjQxOTU5YzcwYWY1Y2FiNTU5OTBmZDdhYzIxYWI1Mjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcn7maWgFqTQyNDMxMzkwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/a8b115e3241959c70af5cab55990fd7ac21ab528", "committedDate": "2020-04-21T19:02:04Z", "message": "fix: ensure unique column names for Resource Table\n\n- DHIS2-8684\n- This fix makes sure that during Resource Table generation process, the column names are always unique."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3OTAxMTIx", "url": "https://github.com/dhis2/dhis2-core/pull/5409#pullrequestreview-397901121", "createdAt": "2020-04-22T07:09:26Z", "commit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3OTI0NzEw", "url": "https://github.com/dhis2/dhis2-core/pull/5409#pullrequestreview-397924710", "createdAt": "2020-04-22T07:43:10Z", "commit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNzo0MzoxMFrOGJoKAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNzo0MzoxMFrOGJoKAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjc0ODI4OA==", "bodyText": "I suggest using Set / HashSet here, for which the contains method is a lot faster (hash/bag match vs linear search).", "url": "https://github.com/dhis2/dhis2-core/pull/5409#discussion_r412748288", "createdAt": "2020-04-22T07:43:10Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/table/AbstractNameUniquenessAwareResourceTable.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package org.hisp.dhis.resourcetable.table;\n+\n+import static org.hisp.dhis.system.util.SqlUtils.quote;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hisp.dhis.common.BaseDimensionalObject;\n+import org.hisp.dhis.resourcetable.ResourceTable;\n+\n+/**\n+ * This class can be extended by Resource Table generation classes that need to\n+ * generate unique colum names\n+ *\n+ */\n+public abstract class AbstractNameUniquenessAwareResourceTable<T>\n+    extends\n+    ResourceTable<T>\n+{\n+    protected List<String> uniqueColumnNames = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3OTI1MTAy", "url": "https://github.com/dhis2/dhis2-core/pull/5409#pullrequestreview-397925102", "createdAt": "2020-04-22T07:43:43Z", "commit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNzo0Mzo0M1rOGJoLYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNzo0Mzo0M1rOGJoLYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjc0ODY0Mg==", "bodyText": "Add license.", "url": "https://github.com/dhis2/dhis2-core/pull/5409#discussion_r412748642", "createdAt": "2020-04-22T07:43:43Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/table/AbstractNameUniquenessAwareResourceTable.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package org.hisp.dhis.resourcetable.table;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3OTI2MDMy", "url": "https://github.com/dhis2/dhis2-core/pull/5409#pullrequestreview-397926032", "createdAt": "2020-04-22T07:45:04Z", "commit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNzo0NTowNFrOGJoOqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNzo0NTowNFrOGJoOqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjc0OTQ4Mg==", "bodyText": "Add license.", "url": "https://github.com/dhis2/dhis2-core/pull/5409#discussion_r412749482", "createdAt": "2020-04-22T07:45:04Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-administration/src/test/java/org/hisp/dhis/resourcetable/table/AbstractNameUniquenessAwareResourceTableTest.java", "diffHunk": "@@ -0,0 +1,72 @@\n+package org.hisp.dhis.resourcetable.table;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3OTg2MTAz", "url": "https://github.com/dhis2/dhis2-core/pull/5409#pullrequestreview-397986103", "createdAt": "2020-04-22T09:00:16Z", "commit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwOTowMDoxNlrOGJrgOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwOTowMDoxNlrOGJrgOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjgwMzEzMQ==", "bodyText": "I am wondering if it will be better to use a stateful utility class like UniqueNameVerifier or similar. Using the class hierarchy/subclassing for very specific stuff might be limiting/causing issues going forward.", "url": "https://github.com/dhis2/dhis2-core/pull/5409#discussion_r412803131", "createdAt": "2020-04-22T09:00:16Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-administration/src/main/java/org/hisp/dhis/resourcetable/table/AbstractNameUniquenessAwareResourceTable.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package org.hisp.dhis.resourcetable.table;\n+\n+import static org.hisp.dhis.system.util.SqlUtils.quote;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hisp.dhis.common.BaseDimensionalObject;\n+import org.hisp.dhis.resourcetable.ResourceTable;\n+\n+/**\n+ * This class can be extended by Resource Table generation classes that need to\n+ * generate unique colum names\n+ *\n+ */\n+public abstract class AbstractNameUniquenessAwareResourceTable<T>\n+    extends", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8b115e3241959c70af5cab55990fd7ac21ab528"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85120b5fff6247f71553c49c36b223410741b39f", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/85120b5fff6247f71553c49c36b223410741b39f", "committedDate": "2020-04-22T10:09:49Z", "message": "chore: add missing class header"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4Nzc4Mjcy", "url": "https://github.com/dhis2/dhis2-core/pull/5409#pullrequestreview-398778272", "createdAt": "2020-04-23T05:54:10Z", "commit": {"oid": "85120b5fff6247f71553c49c36b223410741b39f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "511ab1f4a9fa5499d1d6093eb6904e03ee9d36f5", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/511ab1f4a9fa5499d1d6093eb6904e03ee9d36f5", "committedDate": "2020-04-27T06:56:45Z", "message": "Replace Abstract class with class encapsulating logic to ensure short\nnames do not collide."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cb764eac9f6534670c4d90f91546c2ce83dc916", "author": {"user": {"login": "luciano-fiandesio", "name": "Luciano Fiandesio"}}, "url": "https://github.com/dhis2/dhis2-core/commit/5cb764eac9f6534670c4d90f91546c2ce83dc916", "committedDate": "2020-04-27T07:13:44Z", "message": "chore: renamed variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MzEzOTAz", "url": "https://github.com/dhis2/dhis2-core/pull/5409#pullrequestreview-424313903", "createdAt": "2020-06-04T10:35:29Z", "commit": {"oid": "5cb764eac9f6534670c4d90f91546c2ce83dc916"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2718, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}