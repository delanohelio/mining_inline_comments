{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4Njg5NjEy", "number": 5848, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToxMzowMVrOEOLF7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwOTo0NzozNFrOESvMng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMjk3MjYwOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/program/ProgramInstanceStore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToxMzowMVrOGxLNPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToyNzoxN1rOGxLtbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIxNzAyMg==", "bodyText": "typo: size -> side?", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r454217022", "createdAt": "2020-07-14T09:13:01Z", "author": {"login": "netroms"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/program/ProgramInstanceStore.java", "diffHunk": "@@ -138,4 +139,26 @@\n      * @param programInstance the ProgramInstance to delete.\n      */\n     void hardDelete( ProgramInstance programInstance );\n+\n+    /**\n+     * Executes a query to fetch all {@see ProgramInstance} matching the\n+     * Program/TrackedEntityInstance list.\n+     *\n+     * Resulting SQL query:\n+     *\n+     * <pre>{@code\n+     *  select programinstanceid, programid, trackedentityinstanceid\n+     *      from programinstance\n+     *      where (programid = 726 and trackedentityinstanceid = 19 and status = 'ACTIVE')\n+     *         or (programid = 726 and trackedentityinstanceid = 18 and status = 'ACTIVE')\n+     *         or (programid = 726 and trackedentityinstanceid = 17 and status = 'ACTIVE')\n+     * }</pre>\n+     *\n+     * @param programTeiPair a List of Pair, where the left size is a {@see Program}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3ec92fb23590e899435527adee34dc10bdc8227"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyNTI2Mw==", "bodyText": "Fixed", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r454225263", "createdAt": "2020-07-14T09:27:17Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/program/ProgramInstanceStore.java", "diffHunk": "@@ -138,4 +139,26 @@\n      * @param programInstance the ProgramInstance to delete.\n      */\n     void hardDelete( ProgramInstance programInstance );\n+\n+    /**\n+     * Executes a query to fetch all {@see ProgramInstance} matching the\n+     * Program/TrackedEntityInstance list.\n+     *\n+     * Resulting SQL query:\n+     *\n+     * <pre>{@code\n+     *  select programinstanceid, programid, trackedentityinstanceid\n+     *      from programinstance\n+     *      where (programid = 726 and trackedentityinstanceid = 19 and status = 'ACTIVE')\n+     *         or (programid = 726 and trackedentityinstanceid = 18 and status = 'ACTIVE')\n+     *         or (programid = 726 and trackedentityinstanceid = 17 and status = 'ACTIVE')\n+     * }</pre>\n+     *\n+     * @param programTeiPair a List of Pair, where the left size is a {@see Program}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIxNzAyMg=="}, "originalCommit": {"oid": "f3ec92fb23590e899435527adee34dc10bdc8227"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMjk3NDQxOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/program/ProgramInstanceStore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToxMzozNlrOGxLOeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToyNzoyMVrOGxLtpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIxNzMzNg==", "bodyText": "left -> right?", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r454217336", "createdAt": "2020-07-14T09:13:36Z", "author": {"login": "netroms"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/program/ProgramInstanceStore.java", "diffHunk": "@@ -138,4 +139,26 @@\n      * @param programInstance the ProgramInstance to delete.\n      */\n     void hardDelete( ProgramInstance programInstance );\n+\n+    /**\n+     * Executes a query to fetch all {@see ProgramInstance} matching the\n+     * Program/TrackedEntityInstance list.\n+     *\n+     * Resulting SQL query:\n+     *\n+     * <pre>{@code\n+     *  select programinstanceid, programid, trackedentityinstanceid\n+     *      from programinstance\n+     *      where (programid = 726 and trackedentityinstanceid = 19 and status = 'ACTIVE')\n+     *         or (programid = 726 and trackedentityinstanceid = 18 and status = 'ACTIVE')\n+     *         or (programid = 726 and trackedentityinstanceid = 17 and status = 'ACTIVE')\n+     * }</pre>\n+     *\n+     * @param programTeiPair a List of Pair, where the left size is a {@see Program}\n+     *        and the left side is a {@see TrackedEntityInstance}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3ec92fb23590e899435527adee34dc10bdc8227"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyNTMxNg==", "bodyText": "Fixed", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r454225316", "createdAt": "2020-07-14T09:27:21Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/program/ProgramInstanceStore.java", "diffHunk": "@@ -138,4 +139,26 @@\n      * @param programInstance the ProgramInstance to delete.\n      */\n     void hardDelete( ProgramInstance programInstance );\n+\n+    /**\n+     * Executes a query to fetch all {@see ProgramInstance} matching the\n+     * Program/TrackedEntityInstance list.\n+     *\n+     * Resulting SQL query:\n+     *\n+     * <pre>{@code\n+     *  select programinstanceid, programid, trackedentityinstanceid\n+     *      from programinstance\n+     *      where (programid = 726 and trackedentityinstanceid = 19 and status = 'ACTIVE')\n+     *         or (programid = 726 and trackedentityinstanceid = 18 and status = 'ACTIVE')\n+     *         or (programid = 726 and trackedentityinstanceid = 17 and status = 'ACTIVE')\n+     * }</pre>\n+     *\n+     * @param programTeiPair a List of Pair, where the left size is a {@see Program}\n+     *        and the left side is a {@see TrackedEntityInstance}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIxNzMzNg=="}, "originalCommit": {"oid": "f3ec92fb23590e899435527adee34dc10bdc8227"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMjk4Mjg5OnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/hibernate/HibernateProgramInstanceStore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToxNTo0MlrOGxLTlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOTozMDowM1rOGxLz8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIxODY0Ng==", "bodyText": "Does it make sense to send in null here? Might it be better to not allow null, since null might indicate a bug? Use checkNotNull and cast a np?", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r454218646", "createdAt": "2020-07-14T09:15:42Z", "author": {"login": "netroms"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/hibernate/HibernateProgramInstanceStore.java", "diffHunk": "@@ -328,6 +330,39 @@ public void hardDelete( ProgramInstance programInstance )\n         getSession().delete( programInstance );\n     }\n \n+    @Override\n+    public List<ProgramInstance> getByProgramAndTrackedEntityInstance(\n+        List<Pair<Program, TrackedEntityInstance>> programTeiPair, ProgramStatus programStatus )\n+    {\n+        if ( programTeiPair == null || programTeiPair.isEmpty() )", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3ec92fb23590e899435527adee34dc10bdc8227"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyNjkyOQ==", "bodyText": "Good point, fixed", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r454226929", "createdAt": "2020-07-14T09:30:03Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/hibernate/HibernateProgramInstanceStore.java", "diffHunk": "@@ -328,6 +330,39 @@ public void hardDelete( ProgramInstance programInstance )\n         getSession().delete( programInstance );\n     }\n \n+    @Override\n+    public List<ProgramInstance> getByProgramAndTrackedEntityInstance(\n+        List<Pair<Program, TrackedEntityInstance>> programTeiPair, ProgramStatus programStatus )\n+    {\n+        if ( programTeiPair == null || programTeiPair.isEmpty() )", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIxODY0Ng=="}, "originalCommit": {"oid": "f3ec92fb23590e899435527adee34dc10bdc8227"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzM5NzA0OnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/preheat/TrackerPreheat.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwOTowNDo0NFrOGx1IDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwOTowOToyMFrOGx1Sqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkwMzgyMw==", "bodyText": "key->value?", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r454903823", "createdAt": "2020-07-15T09:04:44Z", "author": {"login": "netroms"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/preheat/TrackerPreheat.java", "diffHunk": "@@ -131,10 +131,12 @@\n     private Map<TrackerIdScheme, Map<String, Relationship>> relationships = new EnumMap<>( TrackerIdScheme.class );\n \n     /**\n-     *\n+     * A Map of event uid and preheated {@see ProgramInstance}. The key is a List,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88b69c7c9d78d6eaf767a96c9b44f18f933fa510"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkwNjUzOQ==", "bodyText": "Fixed", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r454906539", "createdAt": "2020-07-15T09:09:20Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/preheat/TrackerPreheat.java", "diffHunk": "@@ -131,10 +131,12 @@\n     private Map<TrackerIdScheme, Map<String, Relationship>> relationships = new EnumMap<>( TrackerIdScheme.class );\n \n     /**\n-     *\n+     * A Map of event uid and preheated {@see ProgramInstance}. The key is a List,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkwMzgyMw=="}, "originalCommit": {"oid": "88b69c7c9d78d6eaf767a96c9b44f18f933fa510"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MDgzMTAyOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-tracker/src/test/java/org/hisp/dhis/tracker/validation/EventImportValidationTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwOTo0NzozNFrOG4FKtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwOTo0NzozNFrOG4FKtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ1ODEwMg==", "bodyText": "Any reason why this is Ignored?", "url": "https://github.com/dhis2/dhis2-core/pull/5848#discussion_r461458102", "createdAt": "2020-07-28T09:47:34Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/test/java/org/hisp/dhis/tracker/validation/EventImportValidationTest.java", "diffHunk": "@@ -605,6 +596,7 @@ public void testTeiNotEnrolled()\n     }\n \n     @Test\n+    @Ignore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba9b9d076f0497f9f456794c391f28072c0c07fd"}, "originalPosition": 44}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3959, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}