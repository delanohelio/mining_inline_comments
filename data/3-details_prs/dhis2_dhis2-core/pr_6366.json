{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwNTI4NTk3", "number": 6366, "title": "fix: support non-root deployments when matching paths for override [DHIS2-180]", "bodyText": "Previously, application overrides only worked on instances deployed as ROOT.war, because the entire request URI was matched against the override regex.  This change removes the context path from the start of the request URI before performing the match.\nHuge thanks to @Philip-Larsen-Donnelly for finding this and sniffing out the root cause!", "createdAt": "2020-10-09T11:32:26Z", "url": "https://github.com/dhis2/dhis2-core/pull/6366", "merged": true, "mergeCommit": {"oid": "f6477fae1c50f7fb0c2ff94fd10769fa0645dc0b"}, "closed": true, "closedAt": "2020-10-16T16:21:05Z", "author": {"login": "amcgee"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQ0fEEgH2gAyNTAwNTI4NTk3Ojc2NWZkZThlNmViNmQ2NmJmNWQ1OTY1N2M4OWNkNmZlZGRjNWZlMDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdTIYHvgH2gAyNTAwNTI4NTk3OjdhMGYwZDMzNjBhZjM5ZjhlOTk0ZjBhMDQ4NzZjMDA0NGEzOGU4NzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "765fde8e6eb6d66bf5d59657c89cd6feddc5fe09", "author": {"user": {"login": "amcgee", "name": "Austin McGee"}}, "url": "https://github.com/dhis2/dhis2-core/commit/765fde8e6eb6d66bf5d59657c89cd6feddc5fe09", "committedDate": "2020-10-09T11:29:01Z", "message": "fix: support non-root deployments when matching paths for override"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NTkyNzQy", "url": "https://github.com/dhis2/dhis2-core/pull/6366#pullrequestreview-505592742", "createdAt": "2020-10-09T11:37:01Z", "commit": {"oid": "765fde8e6eb6d66bf5d59657c89cd6feddc5fe09"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMzYwMjA0", "url": "https://github.com/dhis2/dhis2-core/pull/6366#pullrequestreview-510360204", "createdAt": "2020-10-16T10:49:57Z", "commit": {"oid": "765fde8e6eb6d66bf5d59657c89cd6feddc5fe09"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMDo0OTo1N1rOHi1SLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMDo0OTo1N1rOHi1SLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjI4NjYzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String requestURI = req.getRequestURI().substring(req.getContextPath().length());\n          \n          \n            \n                    String requestURI = req.getRequestURI().substring( req.getContextPath().length() );", "url": "https://github.com/dhis2/dhis2-core/pull/6366#discussion_r506286639", "createdAt": "2020-10-16T10:49:57Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-web/dhis-web-commons/src/main/java/org/hisp/dhis/servlet/filter/AppOverrideFilter.java", "diffHunk": "@@ -145,7 +145,7 @@ else if ( \"index.action\".equals( resourcePath ) )\n     protected void doFilterInternal( HttpServletRequest req, HttpServletResponse res, FilterChain chain )\n         throws IOException, ServletException\n     {\n-        String requestURI = req.getRequestURI();\n+        String requestURI = req.getRequestURI().substring(req.getContextPath().length());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "765fde8e6eb6d66bf5d59657c89cd6feddc5fe09"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0271ffc26b8ad6ae4287331a158285d75cf2ca0d", "author": {"user": {"login": "stian-sandvold", "name": "Stian Sandvold"}}, "url": "https://github.com/dhis2/dhis2-core/commit/0271ffc26b8ad6ae4287331a158285d75cf2ca0d", "committedDate": "2020-10-16T10:50:02Z", "message": "Apply suggestions from code review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMzYwMzEw", "url": "https://github.com/dhis2/dhis2-core/pull/6366#pullrequestreview-510360310", "createdAt": "2020-10-16T10:50:08Z", "commit": {"oid": "0271ffc26b8ad6ae4287331a158285d75cf2ca0d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a0f0d3360af39f8e994f0a04876c0044a38e875", "author": {"user": {"login": "amcgee", "name": "Austin McGee"}}, "url": "https://github.com/dhis2/dhis2-core/commit/7a0f0d3360af39f8e994f0a04876c0044a38e875", "committedDate": "2020-10-16T15:47:23Z", "message": "Merge branch 'patch/2.35.0' into fix/app-override-custom-context-2.35.0"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2371, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}