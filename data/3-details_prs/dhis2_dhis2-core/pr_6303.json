{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1NzU0NTk2", "number": 6303, "title": "refactor: Constructor instead of set method init of DataSourceManager", "bodyText": "Simple refactor of DefaultDataSourceManager to make sure all required dependencies are set on initialization.", "createdAt": "2020-09-30T20:00:54Z", "url": "https://github.com/dhis2/dhis2-core/pull/6303", "merged": true, "mergeCommit": {"oid": "e577f25f0dc42e963646454c49661c4e0ccdcf1c"}, "closed": true, "closedAt": "2020-10-02T07:29:12Z", "author": {"login": "larshelge"}, "timelineItems": {"totalCount": 40, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDBOVNAH2gAyNDk1NzU0NTk2OjAyMTIwNzMxZDAwNDRjYjc3ZjIxYzY3Yzg1MjE4MDEzMjA2ODgzMmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdONnBnAFqTUwMDE0NjU1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "02120731d0044cb77f21c67c852180132068832c", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/02120731d0044cb77f21c67c852180132068832c", "committedDate": "2020-08-27T14:24:34Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51771650446f2011bb65f40224439144d23a6045", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/51771650446f2011bb65f40224439144d23a6045", "committedDate": "2020-08-27T15:22:19Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b58f0a0a9fe8f090ff106990430d0146a3e3ab81", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/b58f0a0a9fe8f090ff106990430d0146a3e3ab81", "committedDate": "2020-08-31T14:58:45Z", "message": "Rename"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6055f1cd10016c9916cfbc4be05af4e147b4c43a", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/6055f1cd10016c9916cfbc4be05af4e147b4c43a", "committedDate": "2020-09-01T12:36:52Z", "message": "Minor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "714fe2430869802e1ebdb02165f26d4a84456a51", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/714fe2430869802e1ebdb02165f26d4a84456a51", "committedDate": "2020-09-01T12:37:00Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce93bd0610b6f801e4fc2f4d40a331007ad487fc", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/ce93bd0610b6f801e4fc2f4d40a331007ad487fc", "committedDate": "2020-09-01T12:37:07Z", "message": "Merge branch 'master' into lars-dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4eb958db2b25180e62fe2270ee791600d9c76e33", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/4eb958db2b25180e62fe2270ee791600d9c76e33", "committedDate": "2020-09-02T10:30:36Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d873074dd2496c9c383babe76ffb2f9896463c8e", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/d873074dd2496c9c383babe76ffb2f9896463c8e", "committedDate": "2020-09-04T09:21:13Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0758a385ad6d41ec7d63cac1e090b596019b6bbc", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/0758a385ad6d41ec7d63cac1e090b596019b6bbc", "committedDate": "2020-09-04T09:24:36Z", "message": "Merge with master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "163623769a257f49d01654468f2820b7130254e0", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/163623769a257f49d01654468f2820b7130254e0", "committedDate": "2020-09-10T09:22:44Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e69cc596dac6999a746eb5ad392997f11988f067", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e69cc596dac6999a746eb5ad392997f11988f067", "committedDate": "2020-09-14T10:29:24Z", "message": "Add top and bottom to text align"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc097760a4ea4c103322e1c3a5759e312642b79d", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/dc097760a4ea4c103322e1c3a5759e312642b79d", "committedDate": "2020-09-14T10:30:42Z", "message": "Minor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c77180e932245f79dfb78b3bdd62f47845635745", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/c77180e932245f79dfb78b3bdd62f47845635745", "committedDate": "2020-09-14T10:52:52Z", "message": "Revert"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2dbfa1afe0d78471d5e1fbd85effde7016755ab2", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/2dbfa1afe0d78471d5e1fbd85effde7016755ab2", "committedDate": "2020-09-18T08:35:19Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c91fb98aafa1c10d6a787ecbb4318f0ab02f376d", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/c91fb98aafa1c10d6a787ecbb4318f0ab02f376d", "committedDate": "2020-09-18T08:52:13Z", "message": "Merge branch 'master' into lars-dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "410d1b8ae4e3c7d3443c2d183e9734c2c99c03ab", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/410d1b8ae4e3c7d3443c2d183e9734c2c99c03ab", "committedDate": "2020-09-22T14:52:59Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab1dc28f76bd0219a66c700b9b4ed7adff9bdc6e", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/ab1dc28f76bd0219a66c700b9b4ed7adff9bdc6e", "committedDate": "2020-09-22T14:53:10Z", "message": "Merge branch 'master' into lars-dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3f808d5545bdc9a09b04145326145aa35fe95c7", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/f3f808d5545bdc9a09b04145326145aa35fe95c7", "committedDate": "2020-09-23T12:51:56Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "119a44276d7f8131e0c50ac68e37e4c58a94321d", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/119a44276d7f8131e0c50ac68e37e4c58a94321d", "committedDate": "2020-09-23T13:20:22Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f46bfe45381b9f3f6a6c6ce17920627ba8471f6", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/7f46bfe45381b9f3f6a6c6ce17920627ba8471f6", "committedDate": "2020-09-23T13:33:44Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13a184206e3af6c3ab0cecb869a83c0cc9a3a363", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/13a184206e3af6c3ab0cecb869a83c0cc9a3a363", "committedDate": "2020-09-24T12:26:08Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b03a49d424f9b8177ecc354367e86d6baf3f2fc", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3b03a49d424f9b8177ecc354367e86d6baf3f2fc", "committedDate": "2020-09-24T12:26:15Z", "message": "Merge branch 'master' into lars-dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34ba07764d15be691c4bc643b1ea59755a86db18", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/34ba07764d15be691c4bc643b1ea59755a86db18", "committedDate": "2020-09-24T12:55:19Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22d1a961afc15403ab749af2e4d4890a0536a8bd", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/22d1a961afc15403ab749af2e4d4890a0536a8bd", "committedDate": "2020-09-24T12:55:24Z", "message": "Merge branch 'master' into lars-dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dac5d62586509319f78526bf07827588a41da7c3", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/dac5d62586509319f78526bf07827588a41da7c3", "committedDate": "2020-09-24T12:55:30Z", "message": "Cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8206d5a037db2fe2dbb2a5a8b73d0f22b8d32ba", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e8206d5a037db2fe2dbb2a5a8b73d0f22b8d32ba", "committedDate": "2020-09-24T15:04:14Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f87bad85c3bee39ff3029cb1c84feac4c2ae95d6", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/f87bad85c3bee39ff3029cb1c84feac4c2ae95d6", "committedDate": "2020-09-24T15:04:23Z", "message": "Merge branch 'master' into lars-dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "768fe7abcd3b16611efc5ec2e1c75db15ab123aa", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/768fe7abcd3b16611efc5ec2e1c75db15ab123aa", "committedDate": "2020-09-25T12:49:35Z", "message": "Javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaac33239a7f408c5b21f936ef2d9cecce469eb7", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/aaac33239a7f408c5b21f936ef2d9cecce469eb7", "committedDate": "2020-09-25T13:07:35Z", "message": "Minor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1571ae02b1e376a31592afd132fc46e0514b286", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e1571ae02b1e376a31592afd132fc46e0514b286", "committedDate": "2020-09-25T13:12:24Z", "message": "Javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a579be05284a7b85079adf7a30f6f0362ef3d8bd", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/a579be05284a7b85079adf7a30f6f0362ef3d8bd", "committedDate": "2020-09-25T13:56:00Z", "message": "Code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74dc2fdd1db373666e11dd75fb705811b2f3a06e", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/74dc2fdd1db373666e11dd75fb705811b2f3a06e", "committedDate": "2020-09-25T13:59:00Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0396e7747db57d8195c28776233ebde6e811b521", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/0396e7747db57d8195c28776233ebde6e811b521", "committedDate": "2020-09-25T14:12:45Z", "message": "Merge branch 'master' into lars-dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edcf9a0594044aceef6ca066be4f38e2a5856a3e", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/edcf9a0594044aceef6ca066be4f38e2a5856a3e", "committedDate": "2020-09-25T14:42:11Z", "message": "System settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "623c13181847b33d1ec93dd7b847a3b2501aa04e", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/623c13181847b33d1ec93dd7b847a3b2501aa04e", "committedDate": "2020-09-30T10:37:43Z", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73957bbb45f26e10005f35f381d19bc96d5f8654", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/73957bbb45f26e10005f35f381d19bc96d5f8654", "committedDate": "2020-09-30T19:46:46Z", "message": "Merge branch 'master' into lars-dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4631d3bbff68349eeb0b3cbc16032c466813fb55", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/4631d3bbff68349eeb0b3cbc16032c466813fb55", "committedDate": "2020-09-30T19:59:38Z", "message": "Refactor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5ODU5NjE0", "url": "https://github.com/dhis2/dhis2-core/pull/6303#pullrequestreview-499859614", "createdAt": "2020-09-30T22:37:14Z", "commit": {"oid": "4631d3bbff68349eeb0b3cbc16032c466813fb55"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMjozNzoxNFrOHaxtBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQyMjozNzozMVrOHaxtYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzOTM2NQ==", "bodyText": "Maybe add a static import, to match with existing code style", "url": "https://github.com/dhis2/dhis2-core/pull/6303#discussion_r497839365", "createdAt": "2020-09-30T22:37:14Z", "author": {"login": "mortenoh"}, "path": "dhis-2/dhis-support/dhis-support-hibernate/src/main/java/org/hisp/dhis/datasource/DefaultDataSourceManager.java", "diffHunk": "@@ -71,6 +72,18 @@\n     private static final int MAX_READ_REPLICAS = 5;\n     private static final String DEFAULT_POOL_SIZE = \"40\";\n \n+    private final DhisConfigurationProvider config;\n+\n+    private final DataSource mainDataSource;\n+\n+    public DefaultDataSourceManager( DhisConfigurationProvider config, DataSource mainDataSource )\n+    {\n+        Preconditions.checkNotNull( config );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4631d3bbff68349eeb0b3cbc16032c466813fb55"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzOTQ1Ng==", "bodyText": "Newline", "url": "https://github.com/dhis2/dhis2-core/pull/6303#discussion_r497839456", "createdAt": "2020-09-30T22:37:31Z", "author": {"login": "mortenoh"}, "path": "dhis-2/dhis-support/dhis-support-hibernate/src/main/java/org/hisp/dhis/datasource/DefaultDataSourceManager.java", "diffHunk": "@@ -71,6 +72,18 @@\n     private static final int MAX_READ_REPLICAS = 5;\n     private static final String DEFAULT_POOL_SIZE = \"40\";\n \n+    private final DhisConfigurationProvider config;\n+\n+    private final DataSource mainDataSource;\n+\n+    public DefaultDataSourceManager( DhisConfigurationProvider config, DataSource mainDataSource )\n+    {\n+        Preconditions.checkNotNull( config );\n+        Preconditions.checkNotNull( mainDataSource );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4631d3bbff68349eeb0b3cbc16032c466813fb55"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80be34e83cce790137b2bcd7a7f79ab9ed63c803", "author": {"user": {"login": "larshelge", "name": "Lars Helge \u00d8verland"}}, "url": "https://github.com/dhis2/dhis2-core/commit/80be34e83cce790137b2bcd7a7f79ab9ed63c803", "committedDate": "2020-10-01T07:40:03Z", "message": "Minor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMTQ2NTUw", "url": "https://github.com/dhis2/dhis2-core/pull/6303#pullrequestreview-500146550", "createdAt": "2020-10-01T09:03:34Z", "commit": {"oid": "80be34e83cce790137b2bcd7a7f79ab9ed63c803"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2419, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}