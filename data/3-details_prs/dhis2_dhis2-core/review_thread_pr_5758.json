{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1OTIzNTYx", "number": 5758, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwNzo0MDowMVrOEGoo5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwNzo0MjozNVrOEGoshA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1MzkyNzQyOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/Visualization.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwNzo0MDowMVrOGljSow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMTowMDozNFrOGlqVGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAyODcwNw==", "bodyText": "Maybe rename to addDimensionDescriptor to make it similar to other naming in the system.", "url": "https://github.com/dhis2/dhis2-core/pull/5758#discussion_r442028707", "createdAt": "2020-06-18T07:40:01Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/Visualization.java", "diffHunk": "@@ -1025,6 +1028,30 @@ public void setYearlySeries( List<String> yearlySeries )\n         this.yearlySeries = yearlySeries;\n     }\n \n+    /**\n+     * Returns the list of DimensionDescriptor held internaly to the current Visualization object.\n+     * See {@link #holdDimensionDescriptor}.\n+     *\n+     * @return the list of DimensionDescriptor's held.\n+     */\n+    public List<DimensionDescriptor> getDimensionDescriptors()\n+    {\n+        return dimensionDescriptors;\n+    }\n+\n+    /**\n+     * This method will hold the mapping of a dimension and its respective formal\n+     * type.\n+     *\n+     * @param dimension: the dimension, which should also be found in\n+     *        \"{@link #columnDimensions}\" and \"{@link #rowDimensions}\".\n+     * @param dimensionType: the formal dimension type. See {@link DimensionType}\n+     */\n+    public void holdDimensionDescriptor( final String dimension, final DimensionType dimensionType )", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6b68ed85cde6f60dc4b4b5a0dfcff837406cea5"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE0NDAyNQ==", "bodyText": "Done", "url": "https://github.com/dhis2/dhis2-core/pull/5758#discussion_r442144025", "createdAt": "2020-06-18T11:00:34Z", "author": {"login": "maikelarabori"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/Visualization.java", "diffHunk": "@@ -1025,6 +1028,30 @@ public void setYearlySeries( List<String> yearlySeries )\n         this.yearlySeries = yearlySeries;\n     }\n \n+    /**\n+     * Returns the list of DimensionDescriptor held internaly to the current Visualization object.\n+     * See {@link #holdDimensionDescriptor}.\n+     *\n+     * @return the list of DimensionDescriptor's held.\n+     */\n+    public List<DimensionDescriptor> getDimensionDescriptors()\n+    {\n+        return dimensionDescriptors;\n+    }\n+\n+    /**\n+     * This method will hold the mapping of a dimension and its respective formal\n+     * type.\n+     *\n+     * @param dimension: the dimension, which should also be found in\n+     *        \"{@link #columnDimensions}\" and \"{@link #rowDimensions}\".\n+     * @param dimensionType: the formal dimension type. See {@link DimensionType}\n+     */\n+    public void holdDimensionDescriptor( final String dimension, final DimensionType dimensionType )", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAyODcwNw=="}, "originalCommit": {"oid": "d6b68ed85cde6f60dc4b4b5a0dfcff837406cea5"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1MzkzMjIzOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/Visualization.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwNzo0MToyMlrOGljVqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMTowMDozOVrOGlqVQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAyOTQ4MA==", "bodyText": "Remove \"0\" here.", "url": "https://github.com/dhis2/dhis2-core/pull/5758#discussion_r442029480", "createdAt": "2020-06-18T07:41:22Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/Visualization.java", "diffHunk": "@@ -342,6 +343,8 @@\n \n     private transient List<List<DimensionalItemObject>> gridRows = new ArrayList<>();\n \n+    private transient List<DimensionDescriptor> dimensionDescriptors = new ArrayList<>( 0 );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6b68ed85cde6f60dc4b4b5a0dfcff837406cea5"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE0NDA2NA==", "bodyText": "Done", "url": "https://github.com/dhis2/dhis2-core/pull/5758#discussion_r442144064", "createdAt": "2020-06-18T11:00:39Z", "author": {"login": "maikelarabori"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/Visualization.java", "diffHunk": "@@ -342,6 +343,8 @@\n \n     private transient List<List<DimensionalItemObject>> gridRows = new ArrayList<>();\n \n+    private transient List<DimensionDescriptor> dimensionDescriptors = new ArrayList<>( 0 );", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAyOTQ4MA=="}, "originalCommit": {"oid": "d6b68ed85cde6f60dc4b4b5a0dfcff837406cea5"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1MzkzNjY4OnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/DimensionDescriptor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwNzo0MjozNVrOGljYPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxMTowMDo0N1rOGlqVeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAzMDE0Mg==", "bodyText": "Do you think you could add a description about what is going here in the PR and in Javadoc?", "url": "https://github.com/dhis2/dhis2-core/pull/5758#discussion_r442030142", "createdAt": "2020-06-18T07:42:35Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/DimensionDescriptor.java", "diffHunk": "@@ -0,0 +1,105 @@\n+package org.hisp.dhis.visualization;\n+\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+import static org.apache.commons.collections4.CollectionUtils.isNotEmpty;\n+import static org.apache.commons.lang3.StringUtils.EMPTY;\n+import static org.apache.commons.lang3.StringUtils.defaultIfEmpty;\n+import static org.apache.commons.lang3.StringUtils.equalsIgnoreCase;\n+import static org.apache.commons.lang3.StringUtils.trimToEmpty;\n+import static org.hisp.dhis.common.DimensionalObject.ATTRIBUTEOPTIONCOMBO_DIM_ID;\n+import static org.hisp.dhis.common.DimensionalObject.CATEGORYOPTIONCOMBO_DIM_ID;\n+import static org.hisp.dhis.common.DimensionalObject.DATA_X_DIM_ID;\n+import static org.hisp.dhis.common.DimensionalObject.ORGUNIT_DIM_ID;\n+import static org.hisp.dhis.common.DimensionalObject.PERIOD_DIM_ID;\n+\n+import java.util.List;\n+import java.util.Map;\n+\n+import org.hisp.dhis.common.DimensionType;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+import lombok.Setter;\n+\n+@Getter\n+@Setter\n+@AllArgsConstructor\n+public class DimensionDescriptor\n+{\n+    private String value;\n+\n+    private DimensionType type;\n+\n+    public boolean hasAbbreviation( final String abbreviation )\n+    {\n+        return trimToEmpty( abbreviation ).equalsIgnoreCase( trimToEmpty( getValue() ) );\n+    }\n+\n+    public static String retrieveDescriptiveValue( final List<DimensionDescriptor> dimensionDescriptors,\n+        final String valueToRetrieve, final Map<String, String> metaData )\n+    {\n+        String descriptiveValue = EMPTY;\n+\n+        if ( isNotEmpty( dimensionDescriptors ) )\n+        {\n+            for ( final DimensionDescriptor dimensionDescriptor : dimensionDescriptors )\n+            {\n+                if ( dimensionDescriptor.hasAbbreviation( valueToRetrieve ) )\n+                {\n+                    return !equalsIgnoreCase( dimensionDescriptor.getDescriptiveValue(), EMPTY )\n+                        ? dimensionDescriptor.getDescriptiveValue()\n+                        : defaultIfEmpty( metaData.get( valueToRetrieve ), valueToRetrieve );\n+                }\n+            }\n+        }\n+\n+        return descriptiveValue;\n+    }\n+\n+    private String getDescriptiveValue()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6b68ed85cde6f60dc4b4b5a0dfcff837406cea5"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE0NDEyMQ==", "bodyText": "Done", "url": "https://github.com/dhis2/dhis2-core/pull/5758#discussion_r442144121", "createdAt": "2020-06-18T11:00:47Z", "author": {"login": "maikelarabori"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/visualization/DimensionDescriptor.java", "diffHunk": "@@ -0,0 +1,105 @@\n+package org.hisp.dhis.visualization;\n+\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+import static org.apache.commons.collections4.CollectionUtils.isNotEmpty;\n+import static org.apache.commons.lang3.StringUtils.EMPTY;\n+import static org.apache.commons.lang3.StringUtils.defaultIfEmpty;\n+import static org.apache.commons.lang3.StringUtils.equalsIgnoreCase;\n+import static org.apache.commons.lang3.StringUtils.trimToEmpty;\n+import static org.hisp.dhis.common.DimensionalObject.ATTRIBUTEOPTIONCOMBO_DIM_ID;\n+import static org.hisp.dhis.common.DimensionalObject.CATEGORYOPTIONCOMBO_DIM_ID;\n+import static org.hisp.dhis.common.DimensionalObject.DATA_X_DIM_ID;\n+import static org.hisp.dhis.common.DimensionalObject.ORGUNIT_DIM_ID;\n+import static org.hisp.dhis.common.DimensionalObject.PERIOD_DIM_ID;\n+\n+import java.util.List;\n+import java.util.Map;\n+\n+import org.hisp.dhis.common.DimensionType;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+import lombok.Setter;\n+\n+@Getter\n+@Setter\n+@AllArgsConstructor\n+public class DimensionDescriptor\n+{\n+    private String value;\n+\n+    private DimensionType type;\n+\n+    public boolean hasAbbreviation( final String abbreviation )\n+    {\n+        return trimToEmpty( abbreviation ).equalsIgnoreCase( trimToEmpty( getValue() ) );\n+    }\n+\n+    public static String retrieveDescriptiveValue( final List<DimensionDescriptor> dimensionDescriptors,\n+        final String valueToRetrieve, final Map<String, String> metaData )\n+    {\n+        String descriptiveValue = EMPTY;\n+\n+        if ( isNotEmpty( dimensionDescriptors ) )\n+        {\n+            for ( final DimensionDescriptor dimensionDescriptor : dimensionDescriptors )\n+            {\n+                if ( dimensionDescriptor.hasAbbreviation( valueToRetrieve ) )\n+                {\n+                    return !equalsIgnoreCase( dimensionDescriptor.getDescriptiveValue(), EMPTY )\n+                        ? dimensionDescriptor.getDescriptiveValue()\n+                        : defaultIfEmpty( metaData.get( valueToRetrieve ), valueToRetrieve );\n+                }\n+            }\n+        }\n+\n+        return descriptiveValue;\n+    }\n+\n+    private String getDescriptiveValue()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAzMDE0Mg=="}, "originalCommit": {"oid": "d6b68ed85cde6f60dc4b4b5a0dfcff837406cea5"}, "originalPosition": 86}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3391, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}