{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1NDU5MTQ5", "number": 6569, "title": "fix: (2.35) Lazy issue in audit service", "bodyText": "", "createdAt": "2020-11-04T15:26:40Z", "url": "https://github.com/dhis2/dhis2-core/pull/6569", "merged": true, "mergeCommit": {"oid": "08a8fb898fbb6c6f182cfc5c7c7899394918b863"}, "closed": true, "closedAt": "2020-11-12T06:13:11Z", "author": {"login": "vietnguyen"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZNH7XAH2gAyNTE1NDU5MTQ5OjU5NDlkOGViZTIyOGZmOGRkNTgyZjA2NmQ0ZDkyMGUwZGFhNDYwYWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbsDYBAH2gAyNTE1NDU5MTQ5OmIwNWY3YzU5OGQ2OGYwN2ZmMmRmZTE1YTE4YWRlNDg2MTAwNzgzZDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5949d8ebe228ff8dd582f066d4d920e0daa460aa", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/5949d8ebe228ff8dd582f066d4d920e0daa460aa", "committedDate": "2020-11-04T12:42:46Z", "message": "fix: lazy issue in audit service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a9dbb5453f38da68e92f871fb7d2ee4b41328bb", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3a9dbb5453f38da68e92f871fb7d2ee4b41328bb", "committedDate": "2020-11-04T12:43:28Z", "message": "fix merge error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27ed7a4b2621c423b2517fb11e80f05590f1448d", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/27ed7a4b2621c423b2517fb11e80f05590f1448d", "committedDate": "2020-11-04T12:43:31Z", "message": "fix: hibernate lazy exception in audit service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c53c91992b7755ba690b2fbb8414da38d35c996", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/6c53c91992b7755ba690b2fbb8414da38d35c996", "committedDate": "2020-11-04T13:35:37Z", "message": "fix: hibernate lazy exception in audit service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab3ef0f965a22ff8e9d436109a900083f23264ba", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/ab3ef0f965a22ff8e9d436109a900083f23264ba", "committedDate": "2020-11-04T13:35:54Z", "message": "clean up code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d29195198ee0b2cd899dbc5d4a60cfd0f4161de", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/1d29195198ee0b2cd899dbc5d4a60cfd0f4161de", "committedDate": "2020-11-04T13:35:54Z", "message": "clean up codes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f605e383ec44dd1348f1529bdf2602492e6c61ad", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/f605e383ec44dd1348f1529bdf2602492e6c61ad", "committedDate": "2020-11-04T13:35:54Z", "message": "clean up code and add test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3759d091cd122c00f0ee1be326855573fc46ac85", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3759d091cd122c00f0ee1be326855573fc46ac85", "committedDate": "2020-11-04T13:35:54Z", "message": "fix: eventDataValue is blank for audit entry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "510fa32c095b59e00d4a3c50ad5d29b163cae923", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/510fa32c095b59e00d4a3c50ad5d29b163cae923", "committedDate": "2020-11-04T13:35:54Z", "message": "add license"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2498849bd235ed40e592e9e3839f065afb1062a9", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/2498849bd235ed40e592e9e3839f065afb1062a9", "committedDate": "2020-11-04T15:25:37Z", "message": "fix NPE in AbstractHibernateListener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4901abb65d7876e2b67218b8224906da80c8c2c9", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/4901abb65d7876e2b67218b8224906da80c8c2c9", "committedDate": "2020-11-04T16:12:37Z", "message": "fix merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24b1e4f4de0a56654f4dbb39e536ede65fbdecc5", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/24b1e4f4de0a56654f4dbb39e536ede65fbdecc5", "committedDate": "2020-11-05T11:21:51Z", "message": "Fix unit test error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MTc0MTc3", "url": "https://github.com/dhis2/dhis2-core/pull/6569#pullrequestreview-526174177", "createdAt": "2020-11-09T11:47:37Z", "commit": {"oid": "4901abb65d7876e2b67218b8224906da80c8c2c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMTo0NzozN1rOHvq9ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxMTo0NzozN1rOHvq9ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc0ODk2NA==", "bodyText": "I asked the same in @zubaira 's PR; Why are we using Object, and not Map (as commented) or Serializable?", "url": "https://github.com/dhis2/dhis2-core/pull/6569#discussion_r519748964", "createdAt": "2020-11-09T11:47:37Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/AuditableEntity.java", "diffHunk": "@@ -38,5 +38,19 @@\n @AllArgsConstructor\n public class AuditableEntity\n {\n-    private Object entity;\n+    /**\n+     * Class of the AuditableEntity\n+     * It will be used by {@link org.hisp.dhis.artemis.audit.legacy.AuditObjectFactory#collectAuditAttributes(Object)}\n+     */\n+    Class entityClass;\n+\n+    /**\n+     * An object that is ready for serialized by Jackson.\n+     * Means that this object should:\n+     * 1. Only includes referenced properties that are owned by the current Audit Entity. Means that the property's schema has attribute \"owner = true\"\n+     * 2. Do not include any lazy HibernateProxy or PersistentCollection that is not loaded.\n+     * 3. All referenced properties that extend BaseIdentifiableObject should be mapped to only UID string\n+     * This object could be a Map<String, Object>  with key is property name and value is the property value\n+     */\n+    Object serializableObject;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4901abb65d7876e2b67218b8224906da80c8c2c9"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2MTc0OTI3", "url": "https://github.com/dhis2/dhis2-core/pull/6569#pullrequestreview-526174927", "createdAt": "2020-11-09T11:48:40Z", "commit": {"oid": "4901abb65d7876e2b67218b8224906da80c8c2c9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b9abb1fab291eedd7aae91334100f9e2b23f0e7", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/0b9abb1fab291eedd7aae91334100f9e2b23f0e7", "committedDate": "2020-11-11T08:11:38Z", "message": "fix: support serialize embeddedObject for audit (#6579)\n\n* fix: support serialize embeddedObject for audit\n\n* fix: save audit attributes for non-owner properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f52886aca596bbd63fa7c3b7205d9d8b89ea5c1b", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/f52886aca596bbd63fa7c3b7205d9d8b89ea5c1b", "committedDate": "2020-11-11T08:13:24Z", "message": "fix: api test error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "747e23eae812958f1e273596105cd7340e0e03f3", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/747e23eae812958f1e273596105cd7340e0e03f3", "committedDate": "2020-11-11T08:13:24Z", "message": "fix; api test error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10063ef7885e682b546a272665c75bbdaf4eea42", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/10063ef7885e682b546a272665c75bbdaf4eea42", "committedDate": "2020-11-11T08:13:24Z", "message": "fix: unit test error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e91adc350bb07f9d74745489841b764654d01dd", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3e91adc350bb07f9d74745489841b764654d01dd", "committedDate": "2020-11-11T08:13:24Z", "message": "fix: api test error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e0f1646cc69c640917836338d95b3b334384a81", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/2e0f1646cc69c640917836338d95b3b334384a81", "committedDate": "2020-11-11T08:13:24Z", "message": "fix: ConcurrentModificationException"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c98aedd2345856f25e4e7a26d6a1f3ab6cbfea0", "author": {"user": {"login": "vilkg", "name": "Gintare Vilkelyte"}}, "url": "https://github.com/dhis2/dhis2-core/commit/1c98aedd2345856f25e4e7a26d6a1f3ab6cbfea0", "committedDate": "2020-11-11T08:13:25Z", "message": "test: adds skipCache param to event import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3cffcbca39db8ea49812e5776a489b38099ae09", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/f3cffcbca39db8ea49812e5776a489b38099ae09", "committedDate": "2020-11-11T08:13:25Z", "message": "clean up code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b05f7c598d68f07ff2dfe15a18ade486100783d0", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/b05f7c598d68f07ff2dfe15a18ade486100783d0", "committedDate": "2020-11-12T05:52:42Z", "message": "fix: serialize embedded object for audit"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2308, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}