{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NzQ2OTgz", "number": 5565, "title": "fix: reuse orgunit from TEI instead of converting, then getting org unit", "bodyText": "TECH-377", "createdAt": "2020-05-10T16:39:55Z", "url": "https://github.com/dhis2/dhis2-core/pull/5565", "merged": true, "mergeCommit": {"oid": "4c9013009e17382086b7cadf3a70bd5268998e8b"}, "closed": true, "closedAt": "2020-05-11T08:56:14Z", "author": {"login": "mortenoh"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcf90sdAH2gAyNDE1NzQ2OTgzOjk3NzQ0YjM0YjQ4NzRlODRiNzNkNjk2OWYyMTk4NmZkYjMyMTE1MGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgLyuOgFqTQwODk4NDI2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "97744b34b4874e84b73d6969f21986fdb321150c", "author": {"user": {"login": "mortenoh", "name": "Morten Hansen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/97744b34b4874e84b73d6969f21986fdb321150c", "committedDate": "2020-05-10T16:39:30Z", "message": "fix: reuse orgunit from TEI instead of converting, then getting org unit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e9b9f653e201be07248d503a2fefafcffdf704b", "author": {"user": {"login": "mortenoh", "name": "Morten Hansen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3e9b9f653e201be07248d503a2fefafcffdf704b", "committedDate": "2020-05-10T17:16:47Z", "message": "fix: add back access check from getTei"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4ODkwMzQy", "url": "https://github.com/dhis2/dhis2-core/pull/5565#pullrequestreview-408890342", "createdAt": "2020-05-11T06:27:14Z", "commit": {"oid": "3e9b9f653e201be07248d503a2fefafcffdf704b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQwNjoyNzoxNFrOGTOM2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQwNjoyNzoxNFrOGTOM2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjgwODc5NQ==", "bodyText": "Shouldn't we use ImportSummary here, rather than throw an Exception?", "url": "https://github.com/dhis2/dhis2-core/pull/5565#discussion_r422808795", "createdAt": "2020-05-11T06:27:14Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/events/enrollment/AbstractEnrollmentService.java", "diffHunk": "@@ -1201,8 +1200,12 @@ private boolean doValidationOfMandatoryAttributes( User user )\n             validateAttributeType( attribute, importOptions, importConflicts );\n         }\n \n-        TrackedEntityInstance instance = trackedEntityInstanceService.getTrackedEntityInstance( trackedEntityInstance, TrackedEntityInstanceParams.TRUE,\n-            importOptions.getUser() );\n+        List<String> errors = trackerAccessManager.canRead( importOptions.getUser(), trackedEntityInstance );\n+\n+        if ( !errors.isEmpty() )\n+        {\n+            throw new IllegalQueryException( errors.toString() );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e9b9f653e201be07248d503a2fefafcffdf704b"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4OTg0MjYz", "url": "https://github.com/dhis2/dhis2-core/pull/5565#pullrequestreview-408984263", "createdAt": "2020-05-11T08:56:02Z", "commit": {"oid": "3e9b9f653e201be07248d503a2fefafcffdf704b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2716, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}