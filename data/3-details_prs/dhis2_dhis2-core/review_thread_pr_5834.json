{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2NjI2MjIz", "number": 5834, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwODo0MDo0N1rOEMzIKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxMTo1MDoyMFrOEM3ERg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxODU2MDQyOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwODo0MDo0N1rOGvHcsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQyMDo0MToyOVrOGvhCvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA1ODI5MQ==", "bodyText": "Maybe, add \"com\" and \"bat\" files as well?", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452058291", "createdAt": "2020-07-09T08:40:47Z", "author": {"login": "maikelarabori"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;\n+\n+import org.apache.commons.io.FilenameUtils;\n+\n+import com.google.common.collect.ImmutableSet;\n+\n+/**\n+ * @author Lars Helge Overland\n+ */\n+public class FileResourceBlacklist\n+{\n+    private static final ImmutableSet<String> CONTENT_TYPE_BLACKLIST = ImmutableSet.of(\n+        // Web\n+        \"text/html\",\n+        \"text/css\",\n+        \"text/javascript\",\n+        \"font/otf\",\n+        \"application/x-shockwave-flash\",\n+        // Executable\n+        \"application/vnd.debian.binary-package\",\n+        \"application/x-rpm\",\n+        \"application/java-archive\",\n+        \"application/x-ms-dos-executable\",\n+        \"application/vnd.microsoft.portable-executable\",\n+        \"application/vnd.apple.installer+xml\",\n+        \"application/vnd.mozilla.xul+xml\",\n+        \"application/x-httpd-php\",\n+        \"application/x-sh\",\n+        \"application/x-csh\"\n+    );\n+\n+    private static final ImmutableSet<String> FILE_EXTENSION_BLACKLIST = ImmutableSet.of(\n+        // Web\n+        \"html\",\n+        \"htm\",\n+        \"css\",\n+        \"js\",\n+        \"mjs\",\n+        \"otf\",\n+        \"swf\",\n+        // Executable\n+        \"deb\",\n+        \"rpm\",\n+        \"jar\",\n+        \"jsp\",\n+        \"exe\",\n+        \"msi\",\n+        \"mpkg\",\n+        \"xul\",\n+        \"php\",\n+        \"bin\",\n+        \"sh\",\n+        \"csh\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ3NzYzMA==", "bodyText": "Yes agree, will add at least bat.", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452477630", "createdAt": "2020-07-09T20:41:29Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;\n+\n+import org.apache.commons.io.FilenameUtils;\n+\n+import com.google.common.collect.ImmutableSet;\n+\n+/**\n+ * @author Lars Helge Overland\n+ */\n+public class FileResourceBlacklist\n+{\n+    private static final ImmutableSet<String> CONTENT_TYPE_BLACKLIST = ImmutableSet.of(\n+        // Web\n+        \"text/html\",\n+        \"text/css\",\n+        \"text/javascript\",\n+        \"font/otf\",\n+        \"application/x-shockwave-flash\",\n+        // Executable\n+        \"application/vnd.debian.binary-package\",\n+        \"application/x-rpm\",\n+        \"application/java-archive\",\n+        \"application/x-ms-dos-executable\",\n+        \"application/vnd.microsoft.portable-executable\",\n+        \"application/vnd.apple.installer+xml\",\n+        \"application/vnd.mozilla.xul+xml\",\n+        \"application/x-httpd-php\",\n+        \"application/x-sh\",\n+        \"application/x-csh\"\n+    );\n+\n+    private static final ImmutableSet<String> FILE_EXTENSION_BLACKLIST = ImmutableSet.of(\n+        // Web\n+        \"html\",\n+        \"htm\",\n+        \"css\",\n+        \"js\",\n+        \"mjs\",\n+        \"otf\",\n+        \"swf\",\n+        // Executable\n+        \"deb\",\n+        \"rpm\",\n+        \"jar\",\n+        \"jsp\",\n+        \"exe\",\n+        \"msi\",\n+        \"mpkg\",\n+        \"xul\",\n+        \"php\",\n+        \"bin\",\n+        \"sh\",\n+        \"csh\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA1ODI5MQ=="}, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 81}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxODU5NDM5OnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/fileresource/FileResourceBlacklistTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwODo0OTo0M1rOGvHxZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQyMDo0MTo0NlrOGvhDYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA2MzU5MA==", "bodyText": "Should we add a test to cover the cases where the client passes in a null argument to the \"isValid\" method?", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452063590", "createdAt": "2020-07-09T08:49:43Z", "author": {"login": "maikelarabori"}, "path": "dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/fileresource/FileResourceBlacklistTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;\n+\n+import static org.junit.Assert.assertTrue;\n+import static org.junit.Assert.assertFalse;\n+\n+import org.junit.Test;\n+\n+/**\n+ * @author Lars Helge Overland\n+ */\n+public class FileResourceBlacklistTest\n+{\n+    @Test\n+    public void testValid()\n+    {\n+        FileResource frA = new FileResource( \"My_Checklist.pdf\", \"application/pdf\", 324, \"\", FileResourceDomain.DATA_VALUE );\n+        FileResource frB = new FileResource( \"Evaluation.docx\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", 541, \"\", FileResourceDomain.MESSAGE_ATTACHMENT );\n+        FileResource frC = new FileResource( \"FinancialReport.xlsx\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", 143, \"\", FileResourceDomain.DATA_VALUE );\n+\n+        assertTrue( FileResourceBlacklist.isValid( frA ) );\n+        assertTrue( FileResourceBlacklist.isValid( frB ) );\n+        assertTrue( FileResourceBlacklist.isValid( frC ) );\n+    }\n+\n+    @Test\n+    public void testInvalid()\n+    {\n+        FileResource frA = new FileResource( \"Click_Me.exe\", \"application/x-ms-dos-executable\", 451, \"\", FileResourceDomain.DATA_VALUE );\n+        FileResource frB = new FileResource( \"evil_script.sh\", \"application/pdf\", 125, \"\", FileResourceDomain.MESSAGE_ATTACHMENT ); // Fake content type\n+        FileResource frC = new FileResource( \"cookie_stealer\", \"text/javascript\", 631, \"\", FileResourceDomain.USER_AVATAR ); // No file extension\n+\n+        assertFalse( FileResourceBlacklist.isValid( frA ) );\n+        assertFalse( FileResourceBlacklist.isValid( frB ) );\n+        assertFalse( FileResourceBlacklist.isValid( frC ) );\n+    }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ3Nzc5Mg==", "bodyText": "Yes agree, will fix.", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452477792", "createdAt": "2020-07-09T20:41:46Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/fileresource/FileResourceBlacklistTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;\n+\n+import static org.junit.Assert.assertTrue;\n+import static org.junit.Assert.assertFalse;\n+\n+import org.junit.Test;\n+\n+/**\n+ * @author Lars Helge Overland\n+ */\n+public class FileResourceBlacklistTest\n+{\n+    @Test\n+    public void testValid()\n+    {\n+        FileResource frA = new FileResource( \"My_Checklist.pdf\", \"application/pdf\", 324, \"\", FileResourceDomain.DATA_VALUE );\n+        FileResource frB = new FileResource( \"Evaluation.docx\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", 541, \"\", FileResourceDomain.MESSAGE_ATTACHMENT );\n+        FileResource frC = new FileResource( \"FinancialReport.xlsx\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", 143, \"\", FileResourceDomain.DATA_VALUE );\n+\n+        assertTrue( FileResourceBlacklist.isValid( frA ) );\n+        assertTrue( FileResourceBlacklist.isValid( frB ) );\n+        assertTrue( FileResourceBlacklist.isValid( frC ) );\n+    }\n+\n+    @Test\n+    public void testInvalid()\n+    {\n+        FileResource frA = new FileResource( \"Click_Me.exe\", \"application/x-ms-dos-executable\", 451, \"\", FileResourceDomain.DATA_VALUE );\n+        FileResource frB = new FileResource( \"evil_script.sh\", \"application/pdf\", 125, \"\", FileResourceDomain.MESSAGE_ATTACHMENT ); // Fake content type\n+        FileResource frC = new FileResource( \"cookie_stealer\", \"text/javascript\", 631, \"\", FileResourceDomain.USER_AVATAR ); // No file extension\n+\n+        assertFalse( FileResourceBlacklist.isValid( frA ) );\n+        assertFalse( FileResourceBlacklist.isValid( frB ) );\n+        assertFalse( FileResourceBlacklist.isValid( frC ) );\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA2MzU5MA=="}, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxODY4NDg1OnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwOToxMzo0NFrOGvIpag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQyMDo0MDo1MVrOGvhBfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA3NzkzMA==", "bodyText": "Usually package declaration is before the Copyright para.", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452077930", "createdAt": "2020-07-09T09:13:44Z", "author": {"login": "ameenhere"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ3NzMxMA==", "bodyText": "I have sort of changed my mind on this one. Seems the Java convention is to have copyright before package declaration. It also works better with auto-organize in the IDE (the opposite does not work properly). I think we should do a switch across the code base at some point @ameenhere .", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452477310", "createdAt": "2020-07-09T20:40:51Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA3NzkzMA=="}, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxODY5MDA0OnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/fileresource/FileResourceBlacklistTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwOToxNDo1OVrOGvIslA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwOToxNDo1OVrOGvIslA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA3ODc0MA==", "bodyText": "package declaration before copyright?", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452078740", "createdAt": "2020-07-09T09:14:59Z", "author": {"login": "ameenhere"}, "path": "dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/fileresource/FileResourceBlacklistTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxODcxMzE1OnYy", "diffSide": "LEFT", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/DefaultFileResourceService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwOToyMTowM1rOGvI7Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQyMDo1NDo0NlrOGvhc4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA4MjQzNA==", "bodyText": "Should we also move away from naming \"Blacklist\", and using \"Blocklist\" instead? \ud83d\ude04\nRead a lot of recent changes proposed in several companies/projects that want to move away from using \"Black\" as bad and \"White\" as good.", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452082434", "createdAt": "2020-07-09T09:21:03Z", "author": {"login": "ameenhere"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/DefaultFileResourceService.java", "diffHunk": "@@ -70,12 +66,6 @@\n \n     public static final Predicate<FileResource> IS_ORPHAN_PREDICATE = (fr -> !fr.isAssigned());\n \n-    private static final Set<String> CONTENT_TYPE_BLACKLIST = Sets.newHashSet( \"text/html\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ4NDMyMA==", "bodyText": "Sure, changed to Blocklist.", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452484320", "createdAt": "2020-07-09T20:54:46Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/DefaultFileResourceService.java", "diffHunk": "@@ -70,12 +66,6 @@\n \n     public static final Predicate<FileResource> IS_ORPHAN_PREDICATE = (fr -> !fr.isAssigned());\n \n-    private static final Set<String> CONTENT_TYPE_BLACKLIST = Sets.newHashSet( \"text/html\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA4MjQzNA=="}, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxODcxMzMyOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwOToyMTowN1rOGvI7HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQyMDo0ODowNlrOGvhPSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA4MjQ2MQ==", "bodyText": "package before license", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452082461", "createdAt": "2020-07-09T09:21:07Z", "author": {"login": "mortenoh"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ4MDg0Mg==", "bodyText": "I have sort of changed my mind on this one. Seems the Java convention is to have copyright before package declaration. It also works better with auto-organize in the IDE (the opposite does not work properly). I think we should do a switch across the code base at some point.", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452480842", "createdAt": "2020-07-09T20:48:06Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA4MjQ2MQ=="}, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxODcxMzcwOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwOToyMToxNFrOGvI7Wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQyMDo0Nzo1MFrOGvhOww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA4MjUyMg==", "bodyText": "extra newline", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452082522", "createdAt": "2020-07-09T09:21:14Z", "author": {"login": "mortenoh"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;\n+\n+import org.apache.commons.io.FilenameUtils;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ4MDcwNw==", "bodyText": "Fixed.", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452480707", "createdAt": "2020-07-09T20:47:50Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;\n+\n+import org.apache.commons.io.FilenameUtils;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA4MjUyMg=="}, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxOTIwNTgyOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxMTo1MDoyMFrOGvNqKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQyMDo1MTowOFrOGvhVWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2MDA0MA==", "bodyText": "Add checkNotNull(fileResource)?", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452160040", "createdAt": "2020-07-09T11:50:20Z", "author": {"login": "netroms"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;\n+\n+import org.apache.commons.io.FilenameUtils;\n+\n+import com.google.common.collect.ImmutableSet;\n+\n+/**\n+ * @author Lars Helge Overland\n+ */\n+public class FileResourceBlacklist\n+{\n+    private static final ImmutableSet<String> CONTENT_TYPE_BLACKLIST = ImmutableSet.of(\n+        // Web\n+        \"text/html\",\n+        \"text/css\",\n+        \"text/javascript\",\n+        \"font/otf\",\n+        \"application/x-shockwave-flash\",\n+        // Executable\n+        \"application/vnd.debian.binary-package\",\n+        \"application/x-rpm\",\n+        \"application/java-archive\",\n+        \"application/x-ms-dos-executable\",\n+        \"application/vnd.microsoft.portable-executable\",\n+        \"application/vnd.apple.installer+xml\",\n+        \"application/vnd.mozilla.xul+xml\",\n+        \"application/x-httpd-php\",\n+        \"application/x-sh\",\n+        \"application/x-csh\"\n+    );\n+\n+    private static final ImmutableSet<String> FILE_EXTENSION_BLACKLIST = ImmutableSet.of(\n+        // Web\n+        \"html\",\n+        \"htm\",\n+        \"css\",\n+        \"js\",\n+        \"mjs\",\n+        \"otf\",\n+        \"swf\",\n+        // Executable\n+        \"deb\",\n+        \"rpm\",\n+        \"jar\",\n+        \"jsp\",\n+        \"exe\",\n+        \"msi\",\n+        \"mpkg\",\n+        \"xul\",\n+        \"php\",\n+        \"bin\",\n+        \"sh\",\n+        \"csh\"\n+    );\n+\n+    /**\n+     * Indicates whether the given file resource has a valid file extension and content type\n+     * according to the blacklist.\n+     *\n+     * @param fileResource the {@link FileResource}.\n+     * @return true if valid, false if invalid.\n+     */\n+    public static boolean isValid( FileResource fileResource )\n+    {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ4MjM5Mw==", "bodyText": "Agree, included null check for FileResource.", "url": "https://github.com/dhis2/dhis2-core/pull/5834#discussion_r452482393", "createdAt": "2020-07-09T20:51:08Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/fileresource/FileResourceBlacklist.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+package org.hisp.dhis.fileresource;\n+\n+import org.apache.commons.io.FilenameUtils;\n+\n+import com.google.common.collect.ImmutableSet;\n+\n+/**\n+ * @author Lars Helge Overland\n+ */\n+public class FileResourceBlacklist\n+{\n+    private static final ImmutableSet<String> CONTENT_TYPE_BLACKLIST = ImmutableSet.of(\n+        // Web\n+        \"text/html\",\n+        \"text/css\",\n+        \"text/javascript\",\n+        \"font/otf\",\n+        \"application/x-shockwave-flash\",\n+        // Executable\n+        \"application/vnd.debian.binary-package\",\n+        \"application/x-rpm\",\n+        \"application/java-archive\",\n+        \"application/x-ms-dos-executable\",\n+        \"application/vnd.microsoft.portable-executable\",\n+        \"application/vnd.apple.installer+xml\",\n+        \"application/vnd.mozilla.xul+xml\",\n+        \"application/x-httpd-php\",\n+        \"application/x-sh\",\n+        \"application/x-csh\"\n+    );\n+\n+    private static final ImmutableSet<String> FILE_EXTENSION_BLACKLIST = ImmutableSet.of(\n+        // Web\n+        \"html\",\n+        \"htm\",\n+        \"css\",\n+        \"js\",\n+        \"mjs\",\n+        \"otf\",\n+        \"swf\",\n+        // Executable\n+        \"deb\",\n+        \"rpm\",\n+        \"jar\",\n+        \"jsp\",\n+        \"exe\",\n+        \"msi\",\n+        \"mpkg\",\n+        \"xul\",\n+        \"php\",\n+        \"bin\",\n+        \"sh\",\n+        \"csh\"\n+    );\n+\n+    /**\n+     * Indicates whether the given file resource has a valid file extension and content type\n+     * according to the blacklist.\n+     *\n+     * @param fileResource the {@link FileResource}.\n+     * @return true if valid, false if invalid.\n+     */\n+    public static boolean isValid( FileResource fileResource )\n+    {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2MDA0MA=="}, "originalCommit": {"oid": "8c8f574191ecb1165069f32c2328824a2351824d"}, "originalPosition": 92}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3954, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}