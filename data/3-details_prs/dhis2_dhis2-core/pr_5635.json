{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyNjc1MzU2", "number": 5635, "title": "fix: block deletion of DE used in report tables [DHIS2-7043]", "bodyText": "", "createdAt": "2020-05-25T10:28:08Z", "url": "https://github.com/dhis2/dhis2-core/pull/5635", "merged": true, "mergeCommit": {"oid": "a7a68fa547c53aed804a8e34b6ef6e351796b22e"}, "closed": true, "closedAt": "2020-06-18T14:16:46Z", "author": {"login": "enricocolasante"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcm73oXAFqTQyMTY3MTA5OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsfJxkgFqTQzMzMyODgxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNjcxMDk4", "url": "https://github.com/dhis2/dhis2-core/pull/5635#pullrequestreview-421671098", "createdAt": "2020-06-01T08:20:21Z", "commit": {"oid": "3d990c37ddeded10fc8f6147f54f23628460ada3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwODoyMDoyMVrOGdCf_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwODoyMDoyMVrOGdCf_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzEwMjg0Nw==", "bodyText": "Here we get all data dimensions with dependencies.", "url": "https://github.com/dhis2/dhis2-core/pull/5635#discussion_r433102847", "createdAt": "2020-06-01T08:20:21Z", "author": {"login": "enricocolasante"}, "path": "dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/BaseAnalyticalObject.java", "diffHunk": "@@ -273,7 +277,8 @@ public boolean removeDataDimensionItem( DimensionalItemObject object )\n     {\n         if ( object != null && DataDimensionItem.DATA_DIMENSION_CLASSES.contains( object.getClass() ) )\n         {\n-            return dataDimensionItems.remove( DataDimensionItem.create( object ) );\n+            return dataDimensionItems\n+                .removeAll( DataDimensionItem.createWithDependencies( object, dataDimensionItems ) );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d990c37ddeded10fc8f6147f54f23628460ada3"}, "originalPosition": 63}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d990c37ddeded10fc8f6147f54f23628460ada3", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3d990c37ddeded10fc8f6147f54f23628460ada3", "committedDate": "2020-06-01T07:52:04Z", "message": "fix: delete data element operandd from data dimension when deleting DE"}, "afterCommit": {"oid": "91712ca8bf9fd690be0d3dbafbcab465a5dbe57b", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/91712ca8bf9fd690be0d3dbafbcab465a5dbe57b", "committedDate": "2020-06-01T08:23:18Z", "message": "fix: delete data element operandd from data dimension when deleting DE"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNDg3MTQ2", "url": "https://github.com/dhis2/dhis2-core/pull/5635#pullrequestreview-422487146", "createdAt": "2020-06-02T09:09:58Z", "commit": {"oid": "91712ca8bf9fd690be0d3dbafbcab465a5dbe57b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9556607baac10be974791520ba55cb9a6ce53138", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/9556607baac10be974791520ba55cb9a6ce53138", "committedDate": "2020-06-11T13:21:00Z", "message": "fix: block deletion of DE used in report tables [DHIS2-7043]"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a02eb950c044ed06805c01701c5397edf3f3070e", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/a02eb950c044ed06805c01701c5397edf3f3070e", "committedDate": "2020-06-11T13:21:32Z", "message": "fix: delete data element operandd from data dimension when deleting DE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e68011d285cf644f6fe4442c9091cd4b4da93e7d", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e68011d285cf644f6fe4442c9091cd4b4da93e7d", "committedDate": "2020-06-11T13:22:33Z", "message": "Rename flyway script with free id"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91712ca8bf9fd690be0d3dbafbcab465a5dbe57b", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/91712ca8bf9fd690be0d3dbafbcab465a5dbe57b", "committedDate": "2020-06-01T08:23:18Z", "message": "fix: delete data element operandd from data dimension when deleting DE"}, "afterCommit": {"oid": "e68011d285cf644f6fe4442c9091cd4b4da93e7d", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e68011d285cf644f6fe4442c9091cd4b4da93e7d", "committedDate": "2020-06-11T13:22:33Z", "message": "Rename flyway script with free id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b966af64027e61ef6d63fce90c4cf49d1c20803", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/5b966af64027e61ef6d63fce90c4cf49d1c20803", "committedDate": "2020-06-17T14:11:33Z", "message": "Remove manual saving of data element operand in importer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNDg0NjM5", "url": "https://github.com/dhis2/dhis2-core/pull/5635#pullrequestreview-432484639", "createdAt": "2020-06-17T14:52:18Z", "commit": {"oid": "5b966af64027e61ef6d63fce90c4cf49d1c20803"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDo1MjoxOFrOGlJjuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDo1MjoxOFrOGlJjuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYwNzA5Ng==", "bodyText": "@vietnguyen In order to make the deletion work, we need to remove this save.\nIs this going to create any other problem?", "url": "https://github.com/dhis2/dhis2-core/pull/5635#discussion_r441607096", "createdAt": "2020-06-17T14:52:18Z", "author": {"login": "enricocolasante"}, "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/metadata/DefaultAnalyticalObjectImportHandler.java", "diffHunk": "@@ -84,7 +84,6 @@ private void handleDataDimensionItems( Session session, Schema schema, BaseAnaly\n             if ( dataDimensionItem.getDataElementOperand() != null )\n             {\n                 preheatService.connectReferences( dataDimensionItem.getDataElementOperand(), bundle.getPreheat(), bundle.getPreheatIdentifier() );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b966af64027e61ef6d63fce90c4cf49d1c20803"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38e7287c827bb0c33cc06308e90dbea399c026a4", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/38e7287c827bb0c33cc06308e90dbea399c026a4", "committedDate": "2020-06-18T07:20:30Z", "message": "Merge remote-tracking branch 'origin/master' into DHIS2-7043"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8d19281dab0c4804f93e57310bc17df227fbdf2", "author": {"user": {"login": "enricocolasante", "name": "Enrico Colasante"}}, "url": "https://github.com/dhis2/dhis2-core/commit/f8d19281dab0c4804f93e57310bc17df227fbdf2", "committedDate": "2020-06-18T12:48:34Z", "message": "Add test to verify that operand is imported correctly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMjc5NTU3", "url": "https://github.com/dhis2/dhis2-core/pull/5635#pullrequestreview-433279557", "createdAt": "2020-06-18T13:25:32Z", "commit": {"oid": "f8d19281dab0c4804f93e57310bc17df227fbdf2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMzI4ODEx", "url": "https://github.com/dhis2/dhis2-core/pull/5635#pullrequestreview-433328811", "createdAt": "2020-06-18T14:16:29Z", "commit": {"oid": "f8d19281dab0c4804f93e57310bc17df227fbdf2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2686, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}