{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2MzkyOTQ1", "number": 5833, "title": "test: Add integration tests for tracker side effects", "bodyText": "This PR is blocked by issue https://jira.dhis2.org/browse/DHIS2-9288.", "createdAt": "2020-07-08T17:46:39Z", "url": "https://github.com/dhis2/dhis2-core/pull/5833", "merged": true, "mergeCommit": {"oid": "87ef26080354e452d282d374e4dc6de996844a1c"}, "closed": true, "closedAt": "2020-10-02T07:53:54Z", "author": {"login": "zubaira"}, "timelineItems": {"totalCount": 45, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmXtybAH2gAyNDQ2MzkyOTQ1OmNiNzI3MTNiYjY5NTE3OWFkMmM3YmMxMTkzYmJkODIxMWFmOWUxY2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNMPyEgH2gAyNDQ2MzkyOTQ1OjYwNTE1MWZhM2QxYTE3MmFmNWFkMTQ3ZDk1OWJmZTJlMDlhOWNhNjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cb72713bb695179ad2c7bc1193bbd8211af9e1ce", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/cb72713bb695179ad2c7bc1193bbd8211af9e1ce", "committedDate": "2020-05-30T14:13:02Z", "message": "test side effect handler services"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b042810aadf05dcddb2547bada08e10ded2374e9", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/b042810aadf05dcddb2547bada08e10ded2374e9", "committedDate": "2020-05-31T12:30:38Z", "message": "add sample Tracker events payload"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76f928c1720b25aaaf5ee11699158b8456f695bb", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/76f928c1720b25aaaf5ee11699158b8456f695bb", "committedDate": "2020-06-16T05:58:24Z", "message": "Merge branch 'master' into tracker-side-effect"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e4b516a3b884e9a882b4ee2dcabf1a86c395712", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/8e4b516a3b884e9a882b4ee2dcabf1a86c395712", "committedDate": "2020-07-02T14:28:44Z", "message": "Merge branch 'master' into tracker-side-effect"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1653406266c3fac74a8378a1cf3a7facc3b263b2", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/1653406266c3fac74a8378a1cf3a7facc3b263b2", "committedDate": "2020-07-02T15:12:56Z", "message": "Use IntegrationTestBase to run tests against Postgress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bd346f0c48703d794bb3ab8cb2f60d93163be88", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/2bd346f0c48703d794bb3ab8cb2f60d93163be88", "committedDate": "2020-07-02T16:54:29Z", "message": "remove unused dependency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "631ff3b700f138e3a7fddca60bf0cfe23ecb21fe", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/631ff3b700f138e3a7fddca60bf0cfe23ecb21fe", "committedDate": "2020-07-06T15:39:59Z", "message": "Add tracker side effect converter service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bacc296631ba0347b00a963793a56180d6bc5596", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/bacc296631ba0347b00a963793a56180d6bc5596", "committedDate": "2020-07-06T15:40:23Z", "message": "Add tracker domain objects for rule-engine"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7aa73779f484207a7def21bd6204825698e047a7", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/7aa73779f484207a7def21bd6204825698e047a7", "committedDate": "2020-07-06T15:42:39Z", "message": "MWT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaef4c848de560ed97868fb6bc589a11c8bfd5b7", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/aaef4c848de560ed97868fb6bc589a11c8bfd5b7", "committedDate": "2020-07-06T17:07:16Z", "message": "add json annotations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea315cac6cca85fe06d66b305e4d7a0c5d298bd9", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/ea315cac6cca85fe06d66b305e4d7a0c5d298bd9", "committedDate": "2020-07-07T17:56:59Z", "message": "code refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c52f8c7ef02a1d189eba3a9ac4ee935b14eb2e76", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/c52f8c7ef02a1d189eba3a9ac4ee935b14eb2e76", "committedDate": "2020-07-07T22:40:11Z", "message": "fix valid date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ae5436778e9e86e899c73ff00e84dfa28f9a4b7", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/7ae5436778e9e86e899c73ff00e84dfa28f9a4b7", "committedDate": "2020-07-08T16:48:34Z", "message": "Use awaitility to test side effect thread execution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6e29e98f6bc7782bb7735fc1aecad4a5851f245", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/c6e29e98f6bc7782bb7735fc1aecad4a5851f245", "committedDate": "2020-07-08T16:53:57Z", "message": "rename resource file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2dc61992d93d18a1a7908791589961d810a6c7c", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/b2dc61992d93d18a1a7908791589961d810a6c7c", "committedDate": "2020-07-08T17:42:49Z", "message": "minor code refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85299d182397b2c1a4646c49d611b9b2f377eece", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/85299d182397b2c1a4646c49d611b9b2f377eece", "committedDate": "2020-07-09T07:21:49Z", "message": "Merge branch 'master' into tracker-side-effect"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a5e115cd77cfe8a9f97be6101a976dcc0a8ea11", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/2a5e115cd77cfe8a9f97be6101a976dcc0a8ea11", "committedDate": "2020-07-09T07:27:14Z", "message": "change rule-engine version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89d02443457db4b76b6e0a31a1271b92659afdbe", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/89d02443457db4b76b6e0a31a1271b92659afdbe", "committedDate": "2020-07-09T08:57:40Z", "message": "text fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4b2d82bf2528d44a2f7f37d2c175ac88171430f", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/a4b2d82bf2528d44a2f7f37d2c175ac88171430f", "committedDate": "2020-07-11T10:00:53Z", "message": "fix conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51a34f76fa94aeca41c366950862b97e87d989b1", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/51a34f76fa94aeca41c366950862b97e87d989b1", "committedDate": "2020-07-11T10:02:24Z", "message": "ignore unit tests for now"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbe627784cbc751cb4b0fcaec02159a2ef9efd63", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/dbe627784cbc751cb4b0fcaec02159a2ef9efd63", "committedDate": "2020-07-11T10:36:44Z", "message": "fix sonar code smells"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3OTQwMjg3", "url": "https://github.com/dhis2/dhis2-core/pull/5833#pullrequestreview-447940287", "createdAt": "2020-07-14T09:26:31Z", "commit": {"oid": "dbe627784cbc751cb4b0fcaec02159a2ef9efd63"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToyNjozMVrOGxLryQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToyNjozMVrOGxLryQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyNDg0MQ==", "bodyText": "Might it be better to cast a np here and use checkNotNull, since a silent fail will mask a potential bug?", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r454224841", "createdAt": "2020-07-14T09:26:31Z", "author": {"login": "netroms"}, "path": "dhis-2/dhis-services/dhis-service-program-rule/src/main/java/org/hisp/dhis/programrule/engine/NotificationRuleActionImplementer.java", "diffHunk": "@@ -120,18 +124,21 @@ protected ProgramNotificationInstance createNotificationInstance( ProgramNotific\n         return notificationInstance;\n     }\n \n-    protected boolean validate( RuleEffect ruleEffect, ProgramInstance programInstance )\n+    @Transactional\n+    public boolean validate( RuleEffect ruleEffect, ProgramInstance programInstance )\n     {\n-        if ( ruleEffect == null )\n+        if ( ruleEffect == null || programInstance == null )", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbe627784cbc751cb4b0fcaec02159a2ef9efd63"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c87c2a73d1273ac60b0d6b1ebae83b8f6bfa6a4e", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/c87c2a73d1273ac60b0d6b1ebae83b8f6bfa6a4e", "committedDate": "2020-07-29T12:20:55Z", "message": "Fix conflict and merge with master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/9d5336e61cdd08cc580c3dafb9a94fb514f126cc", "committedDate": "2020-07-29T23:17:07Z", "message": "fix code smells"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NzcyMjA0", "url": "https://github.com/dhis2/dhis2-core/pull/5833#pullrequestreview-459772204", "createdAt": "2020-08-03T06:20:25Z", "commit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoyMDoyNVrOG6tZ3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjo0MToxM1rOG6t0Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNDQ5NA==", "bodyText": "What is the reason to move the @Transactional boundary \"down\" to the DAO class? Normally, we transactionally annotate services rather than a repository. I would suggest adding a short comment to explain the deviation from the norm.", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r464214494", "createdAt": "2020-08-03T06:20:25Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/notification/DefaultProgramNotificationTemplateStore.java", "diffHunk": "@@ -39,11 +39,13 @@\n import org.springframework.context.ApplicationEventPublisher;\n import org.springframework.jdbc.core.JdbcTemplate;\n import org.springframework.stereotype.Repository;\n+import org.springframework.transaction.annotation.Transactional;\n \n /**\n  * Created by zubair@dhis2.org on 16.11.17.\n  */\n @Repository( \"org.hisp.dhis.program.notification.ProgramNotificationTemplateStore\" )\n+@Transactional", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNTIxNg==", "bodyText": "This class doesn't seem to be Spring-managed and the constructor is not used. Is it used in some other way?", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r464215216", "createdAt": "2020-08-03T06:22:40Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/ProgramNotificationInstanceDeletionHandler.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package org.hisp.dhis.program;\n+\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+import org.hisp.dhis.program.notification.ProgramNotificationInstance;\n+import org.hisp.dhis.program.notification.ProgramNotificationInstanceStore;\n+import org.hisp.dhis.system.deletion.DeletionHandler;\n+\n+import java.util.List;\n+\n+/**\n+ * @author Zubair Asghar\n+ */\n+public class ProgramNotificationInstanceDeletionHandler", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNjMxMQ==", "bodyText": "Consider removing this annotation. The method doesn't accces the DB directly, but only through another method (getNotificationTemplate) which is already annotated with @Transactional", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r464216311", "createdAt": "2020-08-03T06:26:05Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-program-rule/src/main/java/org/hisp/dhis/programrule/engine/NotificationRuleActionImplementer.java", "diffHunk": "@@ -86,7 +89,8 @@ protected ExternalNotificationLogEntry createLogEntry(String key, String templat\n         return entry;\n     }\n \n-    protected ProgramNotificationTemplate getNotificationTemplate( RuleAction action )\n+    @Transactional", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNjQ4OQ==", "bodyText": "invalid tag, use @author", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r464216489", "createdAt": "2020-08-03T06:26:40Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-program-rule/src/main/java/org/hisp/dhis/programrule/engine/RuleActionAssignValueImplementer.java", "diffHunk": "@@ -44,12 +44,14 @@\n import org.springframework.stereotype.Component;\n \n import lombok.extern.slf4j.Slf4j;\n+import org.springframework.transaction.annotation.Transactional;\n \n /**\n  * @Author Zubair Asghar.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNzQxNg==", "bodyText": "We standardized the usage of @Trasactional: it should be used on methods rather that at class level. I have the impression that this method does not really need this annotation, since all the methods are\n\nread-only\ncalling other methods on different classes that are already annotated.\n\nPlease review the remaining methods and move the @transactional annotation only to methods where it is needed.", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r464217416", "createdAt": "2020-08-03T06:29:31Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-program-rule/src/main/java/org/hisp/dhis/programrule/engine/RuleActionAssignValueImplementer.java", "diffHunk": "@@ -44,12 +44,14 @@\n import org.springframework.stereotype.Component;\n \n import lombok.extern.slf4j.Slf4j;\n+import org.springframework.transaction.annotation.Transactional;\n \n /**\n  * @Author Zubair Asghar.\n  */\n @Slf4j\n @Component( \"org.hisp.dhis.programrule.engine.RuleActionAssignValueImplementer\" )\n+@Transactional", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxODc5MA==", "bodyText": "This seems unused", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r464218790", "createdAt": "2020-08-03T06:33:42Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/bundle/DefaultTrackerBundleService.java", "diffHunk": "@@ -147,6 +153,7 @@ public DefaultTrackerBundleService( TrackerPreheatService trackerPreheatService,\n         this.dbmsManager = dbmsManager;\n         this.trackerProgramRuleService = trackerProgramRuleService;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIyMDYxMQ==", "bodyText": "Some Javadoc would be good", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r464220611", "createdAt": "2020-08-03T06:39:22Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/main/java/org/hisp/dhis/tracker/sideeffect/TrackerAssignValueSideEffect.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package org.hisp.dhis.tracker.sideeffect;\n+\n+/*\n+ * Copyright (c) 2004-2020, University of Oslo\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following disclaimer in the documentation\n+ * and/or other materials provided with the distribution.\n+ * Neither the name of the HISP project nor the names of its contributors may\n+ * be used to endorse or promote products derived from this software without\n+ * specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR\n+ * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n+ * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ */\n+\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.fasterxml.jackson.databind.annotation.JsonDeserialize;\n+import com.fasterxml.jackson.databind.annotation.JsonPOJOBuilder;\n+import lombok.Builder;\n+import lombok.Data;\n+\n+/**\n+ * @author Zubair Asghar\n+ */\n+\n+@Data\n+@Builder( builderClassName = \"TrackerAssignValueSideEffectBuilder\" )\n+@JsonDeserialize( builder = TrackerAssignValueSideEffect.TrackerAssignValueSideEffectBuilder.class )\n+public class TrackerAssignValueSideEffect implements TrackerSideEffect", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIyMTI1MQ==", "bodyText": "10 seconds is a bit too long for a test? Have you considered lowering to 1 or 2 secs?", "url": "https://github.com/dhis2/dhis2-core/pull/5833#discussion_r464221251", "createdAt": "2020-08-03T06:41:13Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-tracker/src/test/java/org/hisp/dhis/tracker/bundle/TrackerSideEffectHandlerServiceTest.java", "diffHunk": "@@ -129,6 +140,20 @@ public void testRuleEngineSideEffectHandlerService()\n \n         TrackerBundleReport report = trackerBundleService.commit( trackerBundles.get( 0 ) );\n \n+        List<TrackerSideEffectDataBundle> sideEffectDataBundles = ListUtils.union(\n+            report.getTypeReportMap().get( TrackerType.ENROLLMENT ).getSideEffectDataBundles(),\n+            report.getTypeReportMap().get( TrackerType.EVENT ).getSideEffectDataBundles() );\n+\n+        trackerBundleService.handleTrackerSideEffects( sideEffectDataBundles );\n+\n         assertEquals( report.getStatus(), TrackerStatus.OK );\n+\n+        await().atMost( 10, TimeUnit.SECONDS ).until( () -> manager.getAll( ProgramNotificationInstance.class ).size() > 0 );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d5336e61cdd08cc580c3dafb9a94fb514f126cc"}, "originalPosition": 93}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f13e4f5acef189498f5a5645bf049630a6d42583", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/f13e4f5acef189498f5a5645bf049630a6d42583", "committedDate": "2020-08-04T13:08:35Z", "message": "fix conflict with master branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba5ff961fc07a0fc5acf04347e61162447946115", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/ba5ff961fc07a0fc5acf04347e61162447946115", "committedDate": "2020-08-04T13:37:03Z", "message": "use Transactional annotation at class level"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a19ed19cdc06f5af7771004bea00ba9d2d4a96f", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/1a19ed19cdc06f5af7771004bea00ba9d2d4a96f", "committedDate": "2020-08-04T13:40:49Z", "message": "rename TrackerSideEffect class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c54a71ba542c7308c0f1d4575f21ecae0001a049", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/c54a71ba542c7308c0f1d4575f21ecae0001a049", "committedDate": "2020-08-04T13:41:31Z", "message": "reduce waiting time to 2 seconds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6fd1250a0400ba8563f4e9320e0c660f55e4b1c", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/b6fd1250a0400ba8563f4e9320e0c660f55e4b1c", "committedDate": "2020-08-04T13:49:30Z", "message": "add java doc for TrackerRuleEngineSideEffect"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c60aa9857452517dc019455ce2df1889d46a85a8", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/c60aa9857452517dc019455ce2df1889d46a85a8", "committedDate": "2020-08-04T14:18:03Z", "message": "add ProgramNotificationInstanceService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89ef99facfa73dfc1cbeafe5189076ed22d6d242", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/89ef99facfa73dfc1cbeafe5189076ed22d6d242", "committedDate": "2020-08-05T07:50:51Z", "message": "code style changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7534a78e97b8f7fd5a46b3dd6bf01f030e3de13", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e7534a78e97b8f7fd5a46b3dd6bf01f030e3de13", "committedDate": "2020-08-05T12:12:26Z", "message": "Add mocked currentUserService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8f50b8cd8e500fde04ff4378e429501f149700b", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/f8f50b8cd8e500fde04ff4378e429501f149700b", "committedDate": "2020-08-05T12:37:29Z", "message": "Add service layer class for ProgramNotificationTemplate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7019cc895829b216a8494caaddd451a4dde98c62", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/7019cc895829b216a8494caaddd451a4dde98c62", "committedDate": "2020-08-05T16:34:45Z", "message": "update notification implementation test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c64293b493c648bcda9d0f2c84d8380e016de00", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/8c64293b493c648bcda9d0f2c84d8380e016de00", "committedDate": "2020-08-05T22:10:42Z", "message": "fix sonar code smells"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2777d21e2bc77c7300e78bf7055ff936df267f89", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/2777d21e2bc77c7300e78bf7055ff936df267f89", "committedDate": "2020-08-06T07:55:58Z", "message": "fix conflict with master branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5521056db4d3f4a3e6a07bf4ed9238ce8bce311a", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/5521056db4d3f4a3e6a07bf4ed9238ce8bce311a", "committedDate": "2020-08-14T07:53:16Z", "message": "fix: Resolve code conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3668e5ab9ec114f0eac07178ecc1e8cca372aa8e", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/3668e5ab9ec114f0eac07178ecc1e8cca372aa8e", "committedDate": "2020-08-15T13:45:01Z", "message": "changes for new rule engine set up in tracker importer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e418cd2c94f424b34cdfeaa566833d6a4b9d3c3f", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e418cd2c94f424b34cdfeaa566833d6a4b9d3c3f", "committedDate": "2020-09-25T07:56:52Z", "message": "fix conflict after merging master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d776b622d4866fc9374c5ec88f9048a5fdf4e642", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/d776b622d4866fc9374c5ec88f9048a5fdf4e642", "committedDate": "2020-09-25T08:03:04Z", "message": "Revert \"fix conflict after merging master\"\n\nThis reverts commit e418cd2c94f424b34cdfeaa566833d6a4b9d3c3f."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fdd7c7aafe7cf653f6bc6961bff46579e1de178", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/8fdd7c7aafe7cf653f6bc6961bff46579e1de178", "committedDate": "2020-09-25T09:15:20Z", "message": "fix conflicts after merging master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b33eb8a67d0c32dfc89a6f5979d3b47cb9608b4f", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/b33eb8a67d0c32dfc89a6f5979d3b47cb9608b4f", "committedDate": "2020-09-25T10:29:10Z", "message": "fix unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "788742a71362d78cb90ff917b046c5e011e8b1e8", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/788742a71362d78cb90ff917b046c5e011e8b1e8", "committedDate": "2020-09-27T19:16:59Z", "message": "fix integration test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "605151fa3d1a172af5ad147d959bfe2e09a9ca64", "author": {"user": {"login": "zubaira", "name": "Zubair Asghar"}}, "url": "https://github.com/dhis2/dhis2-core/commit/605151fa3d1a172af5ad147d959bfe2e09a9ca64", "committedDate": "2020-09-28T04:54:21Z", "message": "set waiting time to 2 seconds"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2558, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}