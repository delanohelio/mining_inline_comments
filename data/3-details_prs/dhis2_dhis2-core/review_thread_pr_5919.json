{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2ODcwNDM5", "number": 5919, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNDo0NToyNVrOEa_uHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNDo0NTozMFrOEa_uPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NzQyNDI5OnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-analytics/src/test/java/org/hisp/dhis/analytics/data/JdbcAnalyticsManagerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNDo0NToyNVrOHEwGMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQwNzoyODo1MVrOHFXvfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc0NDM2OA==", "bodyText": "Code style, spaces.", "url": "https://github.com/dhis2/dhis2-core/pull/5919#discussion_r474744368", "createdAt": "2020-08-21T14:45:25Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-analytics/src/test/java/org/hisp/dhis/analytics/data/JdbcAnalyticsManagerTest.java", "diffHunk": "@@ -118,6 +118,26 @@ public void verifyQueryGeneratedWhenDataElementHasLastAvgOrgUnitAggregationType(\n         assertExpectedSql(\"desc\");\n     }\n \n+    @Test\n+    public void verifyQueryGeneratedWhenDataElementHasLastInPeriodAggregationType()\n+    {\n+        DataQueryParams params = createParams( AggregationType.LAST_IN_PERIOD );\n+\n+        subject.getAggregatedDataValues( params, AnalyticsTableType.DATA_VALUE, 20000 );\n+\n+        assertExpectedLastSql(\"desc\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "543a5c7dbacaba4247213545a44892a36b94f249"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM5MzkxOQ==", "bodyText": "done", "url": "https://github.com/dhis2/dhis2-core/pull/5919#discussion_r475393919", "createdAt": "2020-08-24T07:28:51Z", "author": {"login": "abyot"}, "path": "dhis-2/dhis-services/dhis-service-analytics/src/test/java/org/hisp/dhis/analytics/data/JdbcAnalyticsManagerTest.java", "diffHunk": "@@ -118,6 +118,26 @@ public void verifyQueryGeneratedWhenDataElementHasLastAvgOrgUnitAggregationType(\n         assertExpectedSql(\"desc\");\n     }\n \n+    @Test\n+    public void verifyQueryGeneratedWhenDataElementHasLastInPeriodAggregationType()\n+    {\n+        DataQueryParams params = createParams( AggregationType.LAST_IN_PERIOD );\n+\n+        subject.getAggregatedDataValues( params, AnalyticsTableType.DATA_VALUE, 20000 );\n+\n+        assertExpectedLastSql(\"desc\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc0NDM2OA=="}, "originalCommit": {"oid": "543a5c7dbacaba4247213545a44892a36b94f249"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NzQyNDYxOnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-analytics/src/test/java/org/hisp/dhis/analytics/data/JdbcAnalyticsManagerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNDo0NTozMFrOHEwGXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQwNzoyODo1OFrOHFXvyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc0NDQxNA==", "bodyText": "Code style, spaces.", "url": "https://github.com/dhis2/dhis2-core/pull/5919#discussion_r474744414", "createdAt": "2020-08-21T14:45:30Z", "author": {"login": "larshelge"}, "path": "dhis-2/dhis-services/dhis-service-analytics/src/test/java/org/hisp/dhis/analytics/data/JdbcAnalyticsManagerTest.java", "diffHunk": "@@ -118,6 +118,26 @@ public void verifyQueryGeneratedWhenDataElementHasLastAvgOrgUnitAggregationType(\n         assertExpectedSql(\"desc\");\n     }\n \n+    @Test\n+    public void verifyQueryGeneratedWhenDataElementHasLastInPeriodAggregationType()\n+    {\n+        DataQueryParams params = createParams( AggregationType.LAST_IN_PERIOD );\n+\n+        subject.getAggregatedDataValues( params, AnalyticsTableType.DATA_VALUE, 20000 );\n+\n+        assertExpectedLastSql(\"desc\");\n+    }\n+\n+    @Test\n+    public void verifyQueryGeneratedWhenDataElementHasLastInPeriodAvgOrgUnitAggregationType()\n+    {\n+        DataQueryParams params = createParams( AggregationType.LAST_IN_PERIOD_AVERAGE_ORG_UNIT );\n+\n+        subject.getAggregatedDataValues( params, AnalyticsTableType.DATA_VALUE, 20000 );\n+\n+        assertExpectedLastSql(\"desc\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "543a5c7dbacaba4247213545a44892a36b94f249"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM5Mzk5NQ==", "bodyText": "done", "url": "https://github.com/dhis2/dhis2-core/pull/5919#discussion_r475393995", "createdAt": "2020-08-24T07:28:58Z", "author": {"login": "abyot"}, "path": "dhis-2/dhis-services/dhis-service-analytics/src/test/java/org/hisp/dhis/analytics/data/JdbcAnalyticsManagerTest.java", "diffHunk": "@@ -118,6 +118,26 @@ public void verifyQueryGeneratedWhenDataElementHasLastAvgOrgUnitAggregationType(\n         assertExpectedSql(\"desc\");\n     }\n \n+    @Test\n+    public void verifyQueryGeneratedWhenDataElementHasLastInPeriodAggregationType()\n+    {\n+        DataQueryParams params = createParams( AggregationType.LAST_IN_PERIOD );\n+\n+        subject.getAggregatedDataValues( params, AnalyticsTableType.DATA_VALUE, 20000 );\n+\n+        assertExpectedLastSql(\"desc\");\n+    }\n+\n+    @Test\n+    public void verifyQueryGeneratedWhenDataElementHasLastInPeriodAvgOrgUnitAggregationType()\n+    {\n+        DataQueryParams params = createParams( AggregationType.LAST_IN_PERIOD_AVERAGE_ORG_UNIT );\n+\n+        subject.getAggregatedDataValues( params, AnalyticsTableType.DATA_VALUE, 20000 );\n+\n+        assertExpectedLastSql(\"desc\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc0NDQxNA=="}, "originalCommit": {"oid": "543a5c7dbacaba4247213545a44892a36b94f249"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3984, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}