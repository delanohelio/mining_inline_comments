{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyNDE4OTA1", "number": 4834, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwODo0MzoxOVrODeXkzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwODo0MzoxOVrODeXkzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMTcwMTI3OnYy", "diffSide": "RIGHT", "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/sync/TrackerSynchronization.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQwODo0MzoxOVrOFndr8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxMjoyMjowNFrOFoG9Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkyNTE3MQ==", "bodyText": "We are putting status in a component, that could lead to some strange behaviour in concurrent calls.\nIs there a way to create it inside the methods or passing it as a parameter?", "url": "https://github.com/dhis2/dhis2-core/pull/4834#discussion_r376925171", "createdAt": "2020-02-10T08:43:19Z", "author": {"login": "enricocolasante"}, "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/sync/TrackerSynchronization.java", "diffHunk": "@@ -65,6 +64,8 @@\n     private final RestTemplate restTemplate;\n     private final RenderService renderService;\n \n+    private TrackedEntityInstanceQueryParams queryParams;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d97a16f94b550fdb4be6a2755ca1129885c7186"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkzNjQ3Mg==", "bodyText": "The code is runned sequentially. It is not run concurrently and it is not built to be run concurrently. If there is a new requirement to run it concurrently, then the whole logic needs to be revised and probably significantly rewritten.", "url": "https://github.com/dhis2/dhis2-core/pull/4834#discussion_r376936472", "createdAt": "2020-02-10T09:08:56Z", "author": {"login": "huzvak"}, "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/sync/TrackerSynchronization.java", "diffHunk": "@@ -65,6 +64,8 @@\n     private final RestTemplate restTemplate;\n     private final RenderService renderService;\n \n+    private TrackedEntityInstanceQueryParams queryParams;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkyNTE3MQ=="}, "originalCommit": {"oid": "9d97a16f94b550fdb4be6a2755ca1129885c7186"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkzNzk4NA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/dhis2/dhis2-core/pull/4834#discussion_r376937984", "createdAt": "2020-02-10T09:12:22Z", "author": {"login": "enricocolasante"}, "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/sync/TrackerSynchronization.java", "diffHunk": "@@ -65,6 +64,8 @@\n     private final RestTemplate restTemplate;\n     private final RenderService renderService;\n \n+    private TrackedEntityInstanceQueryParams queryParams;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkyNTE3MQ=="}, "originalCommit": {"oid": "9d97a16f94b550fdb4be6a2755ca1129885c7186"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk0MTM2NQ==", "bodyText": "@huzvak @enricocolasante I think that Enrico is correct in highlighting that variable. If 2 threads will use that bean, the variable will get overridden by the second concurrent call.", "url": "https://github.com/dhis2/dhis2-core/pull/4834#discussion_r376941365", "createdAt": "2020-02-10T09:18:59Z", "author": {"login": "luciano-fiandesio"}, "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/sync/TrackerSynchronization.java", "diffHunk": "@@ -65,6 +64,8 @@\n     private final RestTemplate restTemplate;\n     private final RenderService renderService;\n \n+    private TrackedEntityInstanceQueryParams queryParams;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkyNTE3MQ=="}, "originalCommit": {"oid": "9d97a16f94b550fdb4be6a2755ca1129885c7186"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzYwMTMwMw==", "bodyText": "Yes. I agree. But in Scheduler, there is a logic that there should never be 2 instances/threads of sync job running at the same time. But I will take a look into it anyway and will improve it in next commit and PR.", "url": "https://github.com/dhis2/dhis2-core/pull/4834#discussion_r377601303", "createdAt": "2020-02-11T12:22:04Z", "author": {"login": "huzvak"}, "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/sync/TrackerSynchronization.java", "diffHunk": "@@ -65,6 +64,8 @@\n     private final RestTemplate restTemplate;\n     private final RenderService renderService;\n \n+    private TrackedEntityInstanceQueryParams queryParams;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkyNTE3MQ=="}, "originalCommit": {"oid": "9d97a16f94b550fdb4be6a2755ca1129885c7186"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3569, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}