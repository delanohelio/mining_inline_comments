{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNjg3NDgx", "number": 4964, "title": "feat: Apply new audit services for Tracker", "bodyText": "Test result\nhttps://docs.google.com/spreadsheets/d/1k5EbA0uoEkzgD-Kqux2_BCIPkKfx1PyywuGZEYwvUf0/edit#gid=213439834", "createdAt": "2020-02-27T07:45:58Z", "url": "https://github.com/dhis2/dhis2-core/pull/4964", "merged": true, "mergeCommit": {"oid": "658f4aa56579520904ae6c616372b371dd78bc74"}, "closed": true, "closedAt": "2020-02-27T10:58:30Z", "author": {"login": "vietnguyen"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIWbAQgH2gAyMzgwNjg3NDgxOmZmMmUzZWMzZGQzNDdiMTkxYzIxOTUxMjRmMjAyMDBhOGQzMGFiNmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIZLXXgFqTM2NTU4ODQ2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ff2e3ec3dd347b191c2195124f20200a8d30ab6a", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/ff2e3ec3dd347b191c2195124f20200a8d30ab6a", "committedDate": "2020-02-27T07:44:53Z", "message": "Use hibernate post commit event listener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc05829b96c08d7e892239133f7bb71f2eeed534", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/dc05829b96c08d7e892239133f7bb71f2eeed534", "committedDate": "2020-02-27T08:59:32Z", "message": "fix lazy load exception in AuditManager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b9a4e5c6b5393ab2dca3a7044dc916c650d30d6", "author": {"user": {"login": "vietnguyen", "name": "Viet Nguyen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/1b9a4e5c6b5393ab2dca3a7044dc916c650d30d6", "committedDate": "2020-02-27T10:37:50Z", "message": "Fix lazy load exception for TrackedEntityAttributeValue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NTgzMjU5", "url": "https://github.com/dhis2/dhis2-core/pull/4964#pullrequestreview-365583259", "createdAt": "2020-02-27T10:49:35Z", "commit": {"oid": "1b9a4e5c6b5393ab2dca3a7044dc916c650d30d6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NTg2NzE1", "url": "https://github.com/dhis2/dhis2-core/pull/4964#pullrequestreview-365586715", "createdAt": "2020-02-27T10:54:52Z", "commit": {"oid": "1b9a4e5c6b5393ab2dca3a7044dc916c650d30d6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDo1NDo1MlrOFvNxdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDo1NDo1MlrOFvNxdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1MzA0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.warn( \"onPostUpdateCommitFailed: \"+ event );\n          \n          \n            \n                    log.warn( \"onPostUpdateCommitFailed: \" + event );", "url": "https://github.com/dhis2/dhis2-core/pull/4964#discussion_r385053047", "createdAt": "2020-02-27T10:54:52Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostUpdateAuditListener.java", "diffHunk": "@@ -81,6 +83,12 @@ public void onPostUpdate( PostUpdateEvent postUpdateEvent )\n     @Override\n     public boolean requiresPostCommitHanding( EntityPersister entityPersister )\n     {\n-        return false;\n+        return true;\n+    }\n+\n+    @Override\n+    public void onPostUpdateCommitFailed( PostUpdateEvent event )\n+    {\n+        log.warn( \"onPostUpdateCommitFailed: \"+ event );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b9a4e5c6b5393ab2dca3a7044dc916c650d30d6"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4db44827016dcf19f8bd0e5b97756193f4e085f3", "author": {"user": {"login": "stian-sandvold", "name": "Stian Sandvold"}}, "url": "https://github.com/dhis2/dhis2-core/commit/4db44827016dcf19f8bd0e5b97756193f4e085f3", "committedDate": "2020-02-27T10:54:57Z", "message": "Update dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostUpdateAuditListener.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NTg2OTk0", "url": "https://github.com/dhis2/dhis2-core/pull/4964#pullrequestreview-365586994", "createdAt": "2020-02-27T10:55:17Z", "commit": {"oid": "4db44827016dcf19f8bd0e5b97756193f4e085f3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDo1NToxN1rOFvNySQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDo1NToxN1rOFvNySQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1MzI1Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.warn( \"onPostInsertCommitFailed: \"+ event );\n          \n          \n            \n                    log.warn( \"onPostInsertCommitFailed: \" + event );", "url": "https://github.com/dhis2/dhis2-core/pull/4964#discussion_r385053257", "createdAt": "2020-02-27T10:55:17Z", "author": {"login": "stian-sandvold"}, "path": "dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostInsertAuditListener.java", "diffHunk": "@@ -80,6 +81,12 @@ public void onPostInsert( PostInsertEvent postInsertEvent )\n     @Override\n     public boolean requiresPostCommitHanding( EntityPersister entityPersister )\n     {\n-        return false;\n+        return true;\n+    }\n+\n+    @Override\n+    public void onPostInsertCommitFailed( PostInsertEvent event )\n+    {\n+        log.warn( \"onPostInsertCommitFailed: \"+ event );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4db44827016dcf19f8bd0e5b97756193f4e085f3"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57038a29240f930f2f298b7da5b70d5e6af0818c", "author": {"user": {"login": "stian-sandvold", "name": "Stian Sandvold"}}, "url": "https://github.com/dhis2/dhis2-core/commit/57038a29240f930f2f298b7da5b70d5e6af0818c", "committedDate": "2020-02-27T10:55:26Z", "message": "Update dhis-2/dhis-support/dhis-support-artemis/src/main/java/org/hisp/dhis/artemis/audit/listener/PostInsertAuditListener.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NTg4NDYx", "url": "https://github.com/dhis2/dhis2-core/pull/4964#pullrequestreview-365588461", "createdAt": "2020-02-27T10:57:31Z", "commit": {"oid": "57038a29240f930f2f298b7da5b70d5e6af0818c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2853, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}