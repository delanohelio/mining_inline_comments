{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5NDYxNDQx", "number": 6093, "title": "fix: [DHIS2-9410] include tei parameter when searching for existing psi (2.35)", "bodyText": "Added tei id into where clause when checking for existing programstageinstace\nRemoved an extra join , and used \"id\" columns instead of \"uid\"", "createdAt": "2020-09-04T08:49:12Z", "url": "https://github.com/dhis2/dhis2-core/pull/6093", "merged": true, "mergeCommit": {"oid": "b5aebeef8636b234e0315e2eef3c02553201198c"}, "closed": true, "closedAt": "2020-09-04T11:48:58Z", "author": {"login": "ameenhere"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFhNf2AH2gAyNDc5NDYxNDQxOmU2ZGJmNDM0NzQ4MDI4ZWM5ZjA0NzRiMGM3YWRiNzk0NGE5NzIxMDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFjZjtgH2gAyNDc5NDYxNDQxOjE1YjgxMzlmNTMxNDI5ZjhmNzgxMDM3ZGYxYjg2OWJkZmUxMzVmYmY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e6dbf434748028ec9f0474b0c7adb7944a972104", "author": {"user": {"login": "ameenhere", "name": "Mohamed Ameen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e6dbf434748028ec9f0474b0c7adb7944a972104", "committedDate": "2020-09-04T08:48:28Z", "message": "fix: [DHIS2-9410] include tei parameter when searching for existing psi"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNDc2NzUx", "url": "https://github.com/dhis2/dhis2-core/pull/6093#pullrequestreview-482476751", "createdAt": "2020-09-04T08:51:03Z", "commit": {"oid": "e6dbf434748028ec9f0474b0c7adb7944a972104"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwODo1MTowM1rOHNFXYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwODo1MTowM1rOHNFXYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ4MTQ0MQ==", "bodyText": "Switched to using primary key (foreign key) column instead of uid and hence this join is no longer required.", "url": "https://github.com/dhis2/dhis2-core/pull/6093#discussion_r483481441", "createdAt": "2020-09-04T08:51:03Z", "author": {"login": "ameenhere"}, "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/events/importer/insert/validation/ProgramInstanceRepeatableStageCheck.java", "diffHunk": "@@ -73,20 +75,20 @@ public ImportSummary check(ImmutableEvent event, WorkContext ctx )\n         return success();\n     }\n \n-    private boolean hasProgramStageInstance( JdbcTemplate jdbcTemplate, String programStageUid )\n+    private boolean hasProgramStageInstance( JdbcTemplate jdbcTemplate, long programStageId, long trackedEntityInstanceId )\n     {\n         // @formatter:off\n         final String sql = \"select exists( \" +\n                 \"select * \" +\n                 \"from programstageinstance psi \" +\n                 \"  join programinstance pi on psi.programinstanceid = pi.programinstanceid \" +\n-                \"  join programstage ps on psi.programstageid = ps.programstageid \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6dbf434748028ec9f0474b0c7adb7944a972104"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d216a17a81a96e691f9c56513c81fa916a51ce78", "author": {"user": {"login": "ameenhere", "name": "Mohamed Ameen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/d216a17a81a96e691f9c56513c81fa916a51ce78", "committedDate": "2020-09-04T09:07:10Z", "message": "minor fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3ceaf814b87b0c93ceb1d7574ef8b150505cae8", "author": {"user": {"login": "ameenhere", "name": "Mohamed Ameen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/e3ceaf814b87b0c93ceb1d7574ef8b150505cae8", "committedDate": "2020-09-04T10:11:32Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7d8252c734ce1d0fb92481c3133f4c5eb093704", "author": {"user": {"login": "ameenhere", "name": "Mohamed Ameen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/c7d8252c734ce1d0fb92481c3133f4c5eb093704", "committedDate": "2020-09-04T10:40:05Z", "message": "Fix sonar complaint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNTYxMDI3", "url": "https://github.com/dhis2/dhis2-core/pull/6093#pullrequestreview-482561027", "createdAt": "2020-09-04T11:03:50Z", "commit": {"oid": "c7d8252c734ce1d0fb92481c3133f4c5eb093704"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15b8139f531429f8f781037df1b869bdfe135fbf", "author": {"user": {"login": "ameenhere", "name": "Mohamed Ameen"}}, "url": "https://github.com/dhis2/dhis2-core/commit/15b8139f531429f8f781037df1b869bdfe135fbf", "committedDate": "2020-09-04T11:21:27Z", "message": "Merge branch '2.35' into DHIS2-9410-2.35"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2493, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}