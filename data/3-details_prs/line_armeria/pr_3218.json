{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2ODUxNjM2", "number": 3218, "title": "Fix NPE in `TomcatService` when the server is shutdown.", "bodyText": "Motivation:\nNPE is raised in TomcatService when the server is shutdown.\nModification:\n\nRespond with 503 if the Connector is in the stopped state in TomcatService.\n\nResult:\n\nYou no longer see NPE in TomcatService when stopping the server.\nClose #3136", "createdAt": "2020-12-11T12:16:34Z", "url": "https://github.com/line/armeria/pull/3218", "merged": true, "mergeCommit": {"oid": "e0fb8eb89a7d265564102be5fbfd832dfdf15e5a"}, "closed": true, "closedAt": "2020-12-15T06:40:11Z", "author": {"login": "minwoox"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdlG6SqAH2gAyNTM2ODUxNjM2OmQ1MGQyMTJmNDIwZTQ3MDI3ZTQ4ZDlmNGFiMzY0MDVjNTE2YjA2MjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmUgasAFqTU1MjE0NDY0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d50d212f420e47027e48d9f4ab36405c516b0623", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/d50d212f420e47027e48d9f4ab36405c516b0623", "committedDate": "2020-12-11T12:15:32Z", "message": "Fix NPE in `TomcatService` when the server is shutdown.\nMotivation:\nNPE is raised in `TomcatService` when the server is shutdown.\n\nModification:\n- Respond with 503 if the `Connector` is in stopped state in `TomcatService`.\n\nResult:\n- You no longer see NPE in `TomcatService` when stopping the server.\n- Close #3136"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc4747eedb030d893b470005aff514d5f22554d5", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/cc4747eedb030d893b470005aff514d5f22554d5", "committedDate": "2020-12-13T09:34:17Z", "message": "Add more if conditions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMDAyMjQ5", "url": "https://github.com/line/armeria/pull/3218#pullrequestreview-551002249", "createdAt": "2020-12-14T02:15:37Z", "commit": {"oid": "a7798bcd4f12a2be263190b6bb840cbcf01555f6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMDM5MDI4", "url": "https://github.com/line/armeria/pull/3218#pullrequestreview-551039028", "createdAt": "2020-12-14T04:40:29Z", "commit": {"oid": "a7798bcd4f12a2be263190b6bb840cbcf01555f6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwNDo0MDozMFrOIE_mWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQwNDo0MDozMFrOIE_mWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEwNzIyNA==", "bodyText": "nit: Could use switch-case?", "url": "https://github.com/line/armeria/pull/3218#discussion_r542107224", "createdAt": "2020-12-14T04:40:30Z", "author": {"login": "trustin"}, "path": "tomcat9/src/main/java/com/linecorp/armeria/server/tomcat/TomcatService.java", "diffHunk": "@@ -400,6 +410,13 @@ public final HttpResponse serve(ServiceRequestContext ctx, HttpRequest req) thro\n         return res;\n     }\n \n+    private static boolean isConnectorStopped(LifecycleState connectorState) {\n+        return connectorState == LifecycleState.STOPPED ||\n+               connectorState == LifecycleState.DESTROYING ||\n+               connectorState == LifecycleState.DESTROYED ||\n+               connectorState == LifecycleState.FAILED;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7798bcd4f12a2be263190b6bb840cbcf01555f6"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "433fd08e1a1eb52b00ea0deb15be7975f014159c", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/433fd08e1a1eb52b00ea0deb15be7975f014159c", "committedDate": "2020-12-15T00:27:57Z", "message": "Address the comment by @trustin"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a7798bcd4f12a2be263190b6bb840cbcf01555f6", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/a7798bcd4f12a2be263190b6bb840cbcf01555f6", "committedDate": "2020-12-14T01:55:49Z", "message": "Checkstyle"}, "afterCommit": {"oid": "433fd08e1a1eb52b00ea0deb15be7975f014159c", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/433fd08e1a1eb52b00ea0deb15be7975f014159c", "committedDate": "2020-12-15T00:27:57Z", "message": "Address the comment by @trustin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMTQ0NjQx", "url": "https://github.com/line/armeria/pull/3218#pullrequestreview-552144641", "createdAt": "2020-12-15T06:39:52Z", "commit": {"oid": "433fd08e1a1eb52b00ea0deb15be7975f014159c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4532, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}