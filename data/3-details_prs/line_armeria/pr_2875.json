{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0Njg2OTM3", "number": 2875, "title": "Hide over-exposed public APIs", "bodyText": "Motivation:\nChecked our public and internal API that has public modifier. See #2360\nModifications:\n\nMark public API with @Deprecation if it could be hided.\nMove internal public API to non-internal package and remove public modifier if possible.\nDeprecate\n\nArmeriaClientHttpConnector has been deprecated in favor of\nArmeriaClientAutoConfiguration.clientHttpConnector(List, DataBufferFactoryWrapper)\nArmeriaWebServer has been deprecated in favor of\nArmeriaReactiveWebServerFactory.getWebServer(HttpHandler)\nConnectionPoolLoggingListener has been deprecated in favor of\nConnectionPoolListener.logging(...)\nRouters.ofCompostieService(...) has been deprecated without a replacement.\nBecause CompositeService has beed deprecated already in #2740\nStickyEndpointSelectionStrategy has beed deprecated in favor of\nEndpointSelectionStrategy.sticky(ToLongFunction)\nTTextProtocol has been deprecated in favor of\nTTextProtocolFactory.getProtocol(TTransport)\n\n\n\nResult:\nHide implementation details", "createdAt": "2020-07-06T10:30:53Z", "url": "https://github.com/line/armeria/pull/2875", "merged": true, "mergeCommit": {"oid": "95b0775361387f9515a6ad27ed56550f84934628"}, "closed": true, "closedAt": "2020-07-08T09:51:43Z", "author": {"login": "ikhoon"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcyOs4FgH2gAyNDQ0Njg2OTM3OmQ4YjE5ZmRiNGE5MmE1NjU3ZmJiODY5ZjZjYTU3Yzk2OTcxZTQ1YTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcy3WKggFqTQ0NDU4ODA3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d8b19fdb4a92a5657fbb869f6ca57c96971e45a6", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/d8b19fdb4a92a5657fbb869f6ca57c96971e45a6", "committedDate": "2020-07-06T10:29:59Z", "message": "Hide over-expossed public APIs\n\nMotivation:\n\nChecked our public and internal API that has `public` modifier. See #2360\n\nModifications:\n\n- Mark public API with `@Deprecation` if it could be hided.\n- Move internal public API to non-internal package and remove public modifier if possible.\n- Deprecate\n  - `ArmeriaClientHttpConnector` has been deprecated in favor of\n    `ArmeriaClientAutoConfiguration.clientHttpConnector(List, DataBufferFactoryWrapper)`\n  - `ArmeriaWebServer` has been deprecated in favor of\n    `ArmeriaReactiveWebServerFactory.getWebServer(HttpHandler)`\n  - `ConnectionPoolLoggingListener` has been deprecated in favor of\n    `ConnectionPoolListener.loggingListener(...)`\n  - `Routers.ofCompostieService(...)` has been deprecated without a replacement.\n    Because `CompositeService` has beed deprecated already in #2740\n  - `StickyEndpointSelectionStrategy` has beed deprecated in favor of\n    `EndpointSelectionStrategy.sticky(ToLongFunction)`\n  - `TTextProtocol` has been deprecated in favor of\n    `TTextProtocolFactory.getProtocol(TTransport)`\n\nResult:\n\nHide implementation details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50f68506c09f0c9f4cbf546da2381bf0a4b20046", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/50f68506c09f0c9f4cbf546da2381bf0a4b20046", "committedDate": "2020-07-06T10:36:43Z", "message": "Clean up"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNTE0MDk3", "url": "https://github.com/line/armeria/pull/2875#pullrequestreview-443514097", "createdAt": "2020-07-07T02:07:31Z", "commit": {"oid": "50f68506c09f0c9f4cbf546da2381bf0a4b20046"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwMjowNzozMVrOGtsuXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwMjowNzozMVrOGtsuXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU3MTg3MQ==", "bodyText": "logging()?", "url": "https://github.com/line/armeria/pull/2875#discussion_r450571871", "createdAt": "2020-07-07T02:07:31Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/client/ConnectionPoolListener.java", "diffHunk": "@@ -33,6 +35,21 @@ static ConnectionPoolListener noop() {\n         return ConnectionPoolListenerAdapter.NOOP;\n     }\n \n+    /**\n+     * Returns a {@link ConnectionPoolListener} that logs the connection pool events.\n+     */\n+    static ConnectionPoolListener loggingListener() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50f68506c09f0c9f4cbf546da2381bf0a4b20046"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNTIxNzQ4", "url": "https://github.com/line/armeria/pull/2875#pullrequestreview-443521748", "createdAt": "2020-07-07T02:32:54Z", "commit": {"oid": "50f68506c09f0c9f4cbf546da2381bf0a4b20046"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwMjozMjo1NFrOGttIDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwMjo0MToxNFrOGttPqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU3ODQ0NA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/line/armeria/pull/2875#discussion_r450578444", "createdAt": "2020-07-07T02:32:54Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/common/util/CompositeException.java", "diffHunk": "@@ -75,7 +75,7 @@\n      * list of suppressed exceptions.\n      * @param exceptions the Throwables to have as initially suppressed exceptions\n      *\n-     * @throws IllegalArgumentException if <code>exceptions</code> is empty.\n+     * @throws IllegalArgumentException if {@code exceptions} is empty.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50f68506c09f0c9f4cbf546da2381bf0a4b20046"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU3ODQ2Ng==", "bodyText": "Thanks!", "url": "https://github.com/line/armeria/pull/2875#discussion_r450578466", "createdAt": "2020-07-07T02:33:03Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/common/stream/StreamMessageDrainer.java", "diffHunk": "@@ -1,81 +0,0 @@\n-/*\n- * Copyright 2019 LINE Corporation\n- *\n- * LINE Corporation licenses this file to you under the Apache License,\n- * version 2.0 (the \"License\"); you may not use this file except in compliance\n- * with the License. You may obtain a copy of the License at:\n- *\n- *   https://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n- * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n- * License for the specific language governing permissions and limitations\n- * under the License.\n- */\n-\n-package com.linecorp.armeria.common.stream;\n-\n-import java.util.List;\n-import java.util.concurrent.CompletableFuture;\n-\n-import javax.annotation.Nullable;\n-\n-import org.reactivestreams.Subscriber;\n-import org.reactivestreams.Subscription;\n-\n-import com.google.common.collect.ImmutableList;\n-import com.google.common.collect.ImmutableList.Builder;\n-\n-import com.linecorp.armeria.common.util.EventLoopCheckingFuture;\n-\n-import io.netty.util.ReferenceCountUtil;\n-\n-final class StreamMessageDrainer<T> implements Subscriber<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50f68506c09f0c9f4cbf546da2381bf0a4b20046"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4MDAzOA==", "bodyText": "It seems like we have one more constructor to deprecate at line 85.", "url": "https://github.com/line/armeria/pull/2875#discussion_r450580038", "createdAt": "2020-07-07T02:39:53Z", "author": {"login": "minwoox"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaClientHttpConnector.java", "diffHunk": "@@ -58,7 +65,11 @@ public ArmeriaClientHttpConnector() {\n      * {@link ArmeriaClientConfigurator} and the default {@link DataBufferFactoryWrapper}.\n      *\n      * @param configurator the configurator to be used to build an {@link WebClient}\n+     *\n+     * @deprecated Use\n+     *             {@link ArmeriaClientAutoConfiguration#clientHttpConnector(List, DataBufferFactoryWrapper)}.\n      */\n+    @Deprecated\n     public ArmeriaClientHttpConnector(ArmeriaClientConfigurator configurator) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50f68506c09f0c9f4cbf546da2381bf0a4b20046"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4MDM5NQ==", "bodyText": "Should we add a static method to ArmeriaClientAutoConfiguration that takes no parameters?", "url": "https://github.com/line/armeria/pull/2875#discussion_r450580395", "createdAt": "2020-07-07T02:41:14Z", "author": {"login": "minwoox"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaClientHttpConnector.java", "diffHunk": "@@ -48,7 +51,11 @@\n     /**\n      * Creates an {@link ArmeriaClientHttpConnector} with the default {@link ArmeriaClientConfigurator} and\n      * {@link DataBufferFactoryWrapper}.\n+     *\n+     * @deprecated Use\n+     *             {@link ArmeriaClientAutoConfiguration#clientHttpConnector(List, DataBufferFactoryWrapper)}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50f68506c09f0c9f4cbf546da2381bf0a4b20046"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ab7f446c4ca7d9f22c6f975d9bda430ad34d0a1", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/3ab7f446c4ca7d9f22c6f975d9bda430ad34d0a1", "committedDate": "2020-07-07T03:19:34Z", "message": "Address comments by @minwoox and @trustin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNjM2NTM5", "url": "https://github.com/line/armeria/pull/2875#pullrequestreview-443636539", "createdAt": "2020-07-07T07:38:45Z", "commit": {"oid": "3ab7f446c4ca7d9f22c6f975d9bda430ad34d0a1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6eda002560625f2b2745d81f30aabab384751b52", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/6eda002560625f2b2745d81f30aabab384751b52", "committedDate": "2020-07-08T02:48:51Z", "message": "Checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0Mzc2NjU1", "url": "https://github.com/line/armeria/pull/2875#pullrequestreview-444376655", "createdAt": "2020-07-08T02:49:50Z", "commit": {"oid": "6eda002560625f2b2745d81f30aabab384751b52"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwMjo0OTo1MVrOGuWNaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwMjo1MTo1N1rOGuWP5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1MTU2MQ==", "bodyText": "Would you mind reverting this so that #2882 has no conflict?", "url": "https://github.com/line/armeria/pull/2875#discussion_r451251561", "createdAt": "2020-07-08T02:49:51Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/common/HttpRequestDuplicator.java", "diffHunk": "@@ -43,9 +43,9 @@\n  * after all subscriptions are done. If you want to stop publishing and clean up the resources immediately,\n  * call {@link #abort()}. If you do none of these, memory leak might happen.</p>\n  *\n- * <p>If you subscribe to the {@linkplain #duplicate() duplicated http request} with the\n- * {@link SubscriptionOption#WITH_POOLED_OBJECTS}, the published elements can be shared across\n- * {@link Subscriber}s. So do not manipulate the data unless you copy them.\n+ * <p>If you subscribe to the {@linkplain #duplicate() duplicated http request} using the\n+ * {@link PooledStreamMessage#subscribeWithPooledObjects(Subscriber)} or its variants, the published elements\n+ * can be shared across {@link Subscriber}s. So do not manipulate the data unless you copy them.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eda002560625f2b2745d81f30aabab384751b52"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1MTYyMw==", "bodyText": "Ditto", "url": "https://github.com/line/armeria/pull/2875#discussion_r451251623", "createdAt": "2020-07-08T02:50:03Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/common/HttpResponseDuplicator.java", "diffHunk": "@@ -43,9 +43,9 @@\n  * after all subscriptions are done. If you want to stop publishing and clean up the resources immediately,\n  * call {@link #abort()}. If you do none of these, memory leak might happen.</p>\n  *\n- * <p>If you subscribe to the {@linkplain #duplicate() duplicated http response} with the\n- * {@link SubscriptionOption#WITH_POOLED_OBJECTS}, the published elements can be shared across\n- * {@link Subscriber}s. So do not manipulate the data unless you copy them.\n+ * <p>If you subscribe to the {@linkplain #duplicate() duplicated http response} using the\n+ * {@link PooledStreamMessage#subscribeWithPooledObjects(Subscriber)} or its variants, the published elements\n+ * can be shared across {@link Subscriber}s. So do not manipulate the data unless you copy them.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eda002560625f2b2745d81f30aabab384751b52"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1MTcxNQ==", "bodyText": "Ditto", "url": "https://github.com/line/armeria/pull/2875#discussion_r451251715", "createdAt": "2020-07-08T02:50:22Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/common/stream/StreamMessageDuplicator.java", "diffHunk": "@@ -45,9 +46,9 @@\n  * after all subscriptions are done. If you want to stop publishing and clean up the resources immediately,\n  * call {@link #abort()}. If you do none of these, memory leak might happen.</p>\n  *\n- * <p>If you subscribe to the {@linkplain #duplicate() duplicated stream message} with the\n- * {@link SubscriptionOption#WITH_POOLED_OBJECTS}, the published elements can be shared across\n- * {@link Subscriber}s. So do not manipulate the data unless you copy them.\n+ * <p>If you subscribe to the {@linkplain #duplicate() duplicated stream message} using the\n+ * {@link PooledStreamMessage#subscribeWithPooledObjects(Subscriber)} or its variants, the published elements\n+ * can be shared across {@link Subscriber}s. So do not manipulate the data unless you copy them.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eda002560625f2b2745d81f30aabab384751b52"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1MTkzMQ==", "bodyText": "This class is actually meant for use by users as well. e.g. A user might want to check if a certain host has no support for H2.", "url": "https://github.com/line/armeria/pull/2875#discussion_r451251931", "createdAt": "2020-07-08T02:51:16Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/internal/client/SessionProtocolNegotiationCache.java", "diffHunk": "@@ -14,7 +14,7 @@\n  * under the License.\n  */\n \n-package com.linecorp.armeria.client;\n+package com.linecorp.armeria.internal.client;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eda002560625f2b2745d81f30aabab384751b52"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1MjE5Nw==", "bodyText": "\ud83d\ude47", "url": "https://github.com/line/armeria/pull/2875#discussion_r451252197", "createdAt": "2020-07-08T02:51:57Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/server/file/HttpFileAttributes.java", "diffHunk": "@@ -28,7 +29,7 @@\n /**\n  * The attributes of an {@link HttpFile}.\n  *\n- * @see HttpFile#readAttributes()\n+ * @see HttpFile#readAttributes(Executor)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eda002560625f2b2745d81f30aabab384751b52"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc1f302e3eb278951d1b20c3142f247a46f9a30c", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/fc1f302e3eb278951d1b20c3142f247a46f9a30c", "committedDate": "2020-07-08T03:16:10Z", "message": "Address comments by @trustin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c1af7e2aa3aae4e9e18ef79e4184d0e8de95895", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/6c1af7e2aa3aae4e9e18ef79e4184d0e8de95895", "committedDate": "2020-07-08T03:21:26Z", "message": "Add super to `ToLongFunction`"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NTg4MDc0", "url": "https://github.com/line/armeria/pull/2875#pullrequestreview-444588074", "createdAt": "2020-07-08T09:51:17Z", "commit": {"oid": "6c1af7e2aa3aae4e9e18ef79e4184d0e8de95895"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 363, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}