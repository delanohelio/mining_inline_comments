{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNzQzMDk5", "number": 2853, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNzoyMDozNVrOEKZJvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMDo0MDo1MFrOEMBVyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MzMzMzA4OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNzoyMDozNVrOGrZ1uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwMTozMToxN1rOGshLdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE2NTMwNw==", "bodyText": "pathPattern.isEmpty()? pathPattern has no @Nullable.", "url": "https://github.com/line/armeria/pull/2853#discussion_r448165307", "createdAt": "2020-07-01T07:20:35Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "diffHunk": "@@ -98,6 +99,10 @@ public RouteBuilder path(String pathPattern) {\n      */\n     public RouteBuilder path(String prefix, String pathPattern) {\n         prefix = ensureAbsolutePath(prefix, \"prefix\");\n+        if (Strings.isNullOrEmpty(pathPattern)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0225e3ef714fd6daf1611be71d06bb067962651a"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMzNDEzMg==", "bodyText": "Fixed 0879163 \ud83d\ude04", "url": "https://github.com/line/armeria/pull/2853#discussion_r449334132", "createdAt": "2020-07-03T01:31:17Z", "author": {"login": "heowc"}, "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "diffHunk": "@@ -98,6 +99,10 @@ public RouteBuilder path(String pathPattern) {\n      */\n     public RouteBuilder path(String prefix, String pathPattern) {\n         prefix = ensureAbsolutePath(prefix, \"prefix\");\n+        if (Strings.isNullOrEmpty(pathPattern)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE2NTMwNw=="}, "originalCommit": {"oid": "0225e3ef714fd6daf1611be71d06bb067962651a"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MzMzOTM1OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNzoyMjoyMVrOGrZ5Zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwMTozMToyM1rOGshLlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE2NjI0Ng==", "bodyText": "pathPattern is never null. Use pathPattern.isEmpty().", "url": "https://github.com/line/armeria/pull/2853#discussion_r448166246", "createdAt": "2020-07-01T07:22:21Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "diffHunk": "@@ -461,7 +466,9 @@ public String toString() {\n \n     private static PathMapping getPathMapping(String pathPattern) {\n         requireNonNull(pathPattern, \"pathPattern\");\n-\n+        if (Strings.isNullOrEmpty(pathPattern)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0225e3ef714fd6daf1611be71d06bb067962651a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMzNDE2NQ==", "bodyText": "Fixed 0879163 \ud83d\ude04", "url": "https://github.com/line/armeria/pull/2853#discussion_r449334165", "createdAt": "2020-07-03T01:31:23Z", "author": {"login": "heowc"}, "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "diffHunk": "@@ -461,7 +466,9 @@ public String toString() {\n \n     private static PathMapping getPathMapping(String pathPattern) {\n         requireNonNull(pathPattern, \"pathPattern\");\n-\n+        if (Strings.isNullOrEmpty(pathPattern)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE2NjI0Ng=="}, "originalCommit": {"oid": "0225e3ef714fd6daf1611be71d06bb067962651a"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5Nzg3MjQzOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwOTo0NzoyNFrOGsFpng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwMTozMzozNFrOGshNbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg4MzEwMg==", "bodyText": "This is used in only one place. How about embedding it and leave a comment?", "url": "https://github.com/line/armeria/pull/2853#discussion_r448883102", "createdAt": "2020-07-02T09:47:24Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "diffHunk": "@@ -168,6 +168,11 @@\n                     .put(Trace.class, HttpMethod.TRACE)\n                     .build();\n \n+    /**\n+     * A value to specify if HTTP method annotation value is empty or not specified.\n+     */\n+    private static final String EMPTY_PATH = \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0225e3ef714fd6daf1611be71d06bb067962651a"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTMzNDYzOA==", "bodyText": "I removed that constant. And I assigned the values myself and added a separate comment. 4508c1a", "url": "https://github.com/line/armeria/pull/2853#discussion_r449334638", "createdAt": "2020-07-03T01:33:34Z", "author": {"login": "heowc"}, "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "diffHunk": "@@ -168,6 +168,11 @@\n                     .put(Trace.class, HttpMethod.TRACE)\n                     .build();\n \n+    /**\n+     * A value to specify if HTTP method annotation value is empty or not specified.\n+     */\n+    private static final String EMPTY_PATH = \"\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg4MzEwMg=="}, "originalCommit": {"oid": "0225e3ef714fd6daf1611be71d06bb067962651a"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMDc4NzM0OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwMjoyNjo0NVrOGsh4hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxNDo1MDo1MFrOGsyn9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTM0NTY3MQ==", "bodyText": "IIUC, httpMethodPaths seems not to be empty here. Could remove this if condition?", "url": "https://github.com/line/armeria/pull/2853#discussion_r449345671", "createdAt": "2020-07-03T02:26:45Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "diffHunk": "@@ -503,6 +503,9 @@ private static int order(Method method) {\n                             }\n                             if (usePathPatterns) {\n                                 httpMethodPaths.addAll(pathPatterns);\n+                            } else if (httpMethodPaths.isEmpty()) {\n+                                // Add an empty value if HTTP method annotation value is empty or not specified.\n+                                httpMethodPaths.add(\"\");\n                             }\n                             if (httpMethodPaths.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2278f336151df26428c065eec2d093b576a35d38"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTM2NjYwMg==", "bodyText": "If this is the default, httpMethodPaths may be empty. This is because the default value is not fetched in the process of getting the value.", "url": "https://github.com/line/armeria/pull/2853#discussion_r449366602", "createdAt": "2020-07-03T04:13:33Z", "author": {"login": "heowc"}, "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "diffHunk": "@@ -503,6 +503,9 @@ private static int order(Method method) {\n                             }\n                             if (usePathPatterns) {\n                                 httpMethodPaths.addAll(pathPatterns);\n+                            } else if (httpMethodPaths.isEmpty()) {\n+                                // Add an empty value if HTTP method annotation value is empty or not specified.\n+                                httpMethodPaths.add(\"\");\n                             }\n                             if (httpMethodPaths.isEmpty()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTM0NTY3MQ=="}, "originalCommit": {"oid": "2278f336151df26428c065eec2d093b576a35d38"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYxNzkyNQ==", "bodyText": "Based on the validations and if-else condition:\n\nif usePatterns is true, httpMethodPaths is always not empty because of the condition of line 505.\nif httpMethodPaths.isEmpty() is true, an empty string is added to it.\n\nTherefore, in line 510, httpMethodPaths has at least one item, in my opinion.", "url": "https://github.com/line/armeria/pull/2853#discussion_r449617925", "createdAt": "2020-07-03T14:45:52Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "diffHunk": "@@ -503,6 +503,9 @@ private static int order(Method method) {\n                             }\n                             if (usePathPatterns) {\n                                 httpMethodPaths.addAll(pathPatterns);\n+                            } else if (httpMethodPaths.isEmpty()) {\n+                                // Add an empty value if HTTP method annotation value is empty or not specified.\n+                                httpMethodPaths.add(\"\");\n                             }\n                             if (httpMethodPaths.isEmpty()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTM0NTY3MQ=="}, "originalCommit": {"oid": "2278f336151df26428c065eec2d093b576a35d38"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYxOTk1Ng==", "bodyText": "Ah! I was mistaken for the number of lines. \ud83d\ude05\nI agree to remove lines 510-513.", "url": "https://github.com/line/armeria/pull/2853#discussion_r449619956", "createdAt": "2020-07-03T14:50:50Z", "author": {"login": "heowc"}, "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "diffHunk": "@@ -503,6 +503,9 @@ private static int order(Method method) {\n                             }\n                             if (usePathPatterns) {\n                                 httpMethodPaths.addAll(pathPatterns);\n+                            } else if (httpMethodPaths.isEmpty()) {\n+                                // Add an empty value if HTTP method annotation value is empty or not specified.\n+                                httpMethodPaths.add(\"\");\n                             }\n                             if (httpMethodPaths.isEmpty()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTM0NTY3MQ=="}, "originalCommit": {"oid": "2278f336151df26428c065eec2d093b576a35d38"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMTM3NTMxOnYy", "diffSide": "RIGHT", "path": "core/src/test/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceNullablePathTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwNzo1NTowMVrOGsnTDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwODo0MzowOVrOGsovpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQzNDM4MA==", "bodyText": "Could you set up a server using ServerExtension and send real HTTP requests to the server? The test cases in this class does not really ensure the requests will go to the desired service methods.\nCould you use a meaningful path instead of /1?", "url": "https://github.com/line/armeria/pull/2853#discussion_r449434380", "createdAt": "2020-07-03T07:55:01Z", "author": {"login": "trustin"}, "path": "core/src/test/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceNullablePathTest.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+ * Copyright 2020 LINE Corporation\n+ *\n+ * LINE Corporation licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.linecorp.armeria.internal.server.annotation;\n+\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import com.linecorp.armeria.common.HttpResponse;\n+import com.linecorp.armeria.common.HttpStatus;\n+import com.linecorp.armeria.server.Server;\n+import com.linecorp.armeria.server.annotation.Get;\n+import com.linecorp.armeria.server.annotation.Path;\n+\n+class AnnotatedServiceNullablePathTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42987be54a41863c232c92cf9b47acc5a4611ecd"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQzNTMzNQ==", "bodyText": "I will reinforce this comment. \ud83d\ude04", "url": "https://github.com/line/armeria/pull/2853#discussion_r449435335", "createdAt": "2020-07-03T07:56:52Z", "author": {"login": "heowc"}, "path": "core/src/test/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceNullablePathTest.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+ * Copyright 2020 LINE Corporation\n+ *\n+ * LINE Corporation licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.linecorp.armeria.internal.server.annotation;\n+\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import com.linecorp.armeria.common.HttpResponse;\n+import com.linecorp.armeria.common.HttpStatus;\n+import com.linecorp.armeria.server.Server;\n+import com.linecorp.armeria.server.annotation.Get;\n+import com.linecorp.armeria.server.annotation.Path;\n+\n+class AnnotatedServiceNullablePathTest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQzNDM4MA=="}, "originalCommit": {"oid": "42987be54a41863c232c92cf9b47acc5a4611ecd"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ1ODA4Nw==", "bodyText": "Fixed de7a209", "url": "https://github.com/line/armeria/pull/2853#discussion_r449458087", "createdAt": "2020-07-03T08:43:09Z", "author": {"login": "heowc"}, "path": "core/src/test/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceNullablePathTest.java", "diffHunk": "@@ -0,0 +1,62 @@\n+/*\n+ * Copyright 2020 LINE Corporation\n+ *\n+ * LINE Corporation licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.linecorp.armeria.internal.server.annotation;\n+\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import com.linecorp.armeria.common.HttpResponse;\n+import com.linecorp.armeria.common.HttpStatus;\n+import com.linecorp.armeria.server.Server;\n+import com.linecorp.armeria.server.annotation.Get;\n+import com.linecorp.armeria.server.annotation.Path;\n+\n+class AnnotatedServiceNullablePathTest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQzNDM4MA=="}, "originalCommit": {"oid": "42987be54a41863c232c92cf9b47acc5a4611ecd"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMTczNDUzOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwOTo0ODozNVrOGsqxgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxNDozMzowN1rOGsyLKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ5MTMzMQ==", "bodyText": "Couldn't we just call path(prefix)?", "url": "https://github.com/line/armeria/pull/2853#discussion_r449491331", "createdAt": "2020-07-03T09:48:35Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "diffHunk": "@@ -98,6 +98,10 @@ public RouteBuilder path(String pathPattern) {\n      */\n     public RouteBuilder path(String prefix, String pathPattern) {\n         prefix = ensureAbsolutePath(prefix, \"prefix\");\n+        if (pathPattern.isEmpty()) {\n+            return path(concatPaths(prefix, pathPattern));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90b93d9b89c454496f8ab89f8ff8e77954b485af"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYxMjU4NA==", "bodyText": "Fixed 1d30371", "url": "https://github.com/line/armeria/pull/2853#discussion_r449612584", "createdAt": "2020-07-03T14:33:07Z", "author": {"login": "heowc"}, "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "diffHunk": "@@ -98,6 +98,10 @@ public RouteBuilder path(String pathPattern) {\n      */\n     public RouteBuilder path(String prefix, String pathPattern) {\n         prefix = ensureAbsolutePath(prefix, \"prefix\");\n+        if (pathPattern.isEmpty()) {\n+            return path(concatPaths(prefix, pathPattern));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ5MTMzMQ=="}, "originalCommit": {"oid": "90b93d9b89c454496f8ab89f8ff8e77954b485af"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMTg2MDU1OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxMDozMToyM1rOGsr-sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxNDozMzo0N1rOGsyMQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTUxMTA4OA==", "bodyText": "IIUC, ExactPathMapping will throw an  IllegalArgumentException on an empty string.", "url": "https://github.com/line/armeria/pull/2853#discussion_r449511088", "createdAt": "2020-07-03T10:31:23Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "diffHunk": "@@ -461,7 +465,9 @@ public String toString() {\n \n     private static PathMapping getPathMapping(String pathPattern) {\n         requireNonNull(pathPattern, \"pathPattern\");\n-\n+        if (pathPattern.isEmpty()) {\n+            return new ExactPathMapping(pathPattern);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90b93d9b89c454496f8ab89f8ff8e77954b485af"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYxMjg2Ng==", "bodyText": "This code was removed in 1d30371 :)", "url": "https://github.com/line/armeria/pull/2853#discussion_r449612866", "createdAt": "2020-07-03T14:33:47Z", "author": {"login": "heowc"}, "path": "core/src/main/java/com/linecorp/armeria/server/RouteBuilder.java", "diffHunk": "@@ -461,7 +465,9 @@ public String toString() {\n \n     private static PathMapping getPathMapping(String pathPattern) {\n         requireNonNull(pathPattern, \"pathPattern\");\n-\n+        if (pathPattern.isEmpty()) {\n+            return new ExactPathMapping(pathPattern);\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTUxMTA4OA=="}, "originalCommit": {"oid": "90b93d9b89c454496f8ab89f8ff8e77954b485af"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxMDQwMzMwOnYy", "diffSide": "RIGHT", "path": "core/src/test/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceNullablePathTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMDo0MDo1MFrOGt46KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNDowMjoxOVrOGuACOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc3MTQ5Nw==", "bodyText": "nit: Add hasMessageContaining(\"...\")?", "url": "https://github.com/line/armeria/pull/2853#discussion_r450771497", "createdAt": "2020-07-07T10:40:50Z", "author": {"login": "ikhoon"}, "path": "core/src/test/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceNullablePathTest.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * Copyright 2020 LINE Corporation\n+ *\n+ * LINE Corporation licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.linecorp.armeria.internal.server.annotation;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.RegisterExtension;\n+import org.junit.jupiter.params.ParameterizedTest;\n+import org.junit.jupiter.params.provider.CsvSource;\n+\n+import com.linecorp.armeria.client.WebClient;\n+import com.linecorp.armeria.common.HttpResponse;\n+import com.linecorp.armeria.common.HttpStatus;\n+import com.linecorp.armeria.server.Server;\n+import com.linecorp.armeria.server.ServerBuilder;\n+import com.linecorp.armeria.server.annotation.Get;\n+import com.linecorp.armeria.server.annotation.Path;\n+import com.linecorp.armeria.testing.junit5.server.ServerExtension;\n+\n+class AnnotatedServiceNullablePathTest {\n+\n+    @RegisterExtension\n+    static final ServerExtension server = new ServerExtension() {\n+        @Override\n+        protected void configure(ServerBuilder sb) throws Exception {\n+            sb.annotatedService(\"/default\", new Object() {\n+                @Get\n+                public HttpResponse defaultValue() {\n+                    return HttpResponse.of(HttpStatus.OK);\n+                }\n+            });\n+\n+            sb.annotatedService(\"/empty\", new Object() {\n+                @Get(\"\")\n+                public HttpResponse emptyValue() {\n+                    return HttpResponse.of(HttpStatus.OK);\n+                }\n+            });\n+\n+            sb.annotatedService(\"/multiple\", new Object() {\n+                @Get\n+                @Path(\"/\")\n+                public HttpResponse multipleValue() {\n+                    return HttpResponse.of(HttpStatus.OK);\n+                }\n+            });\n+        }\n+    };\n+\n+    @ParameterizedTest\n+    @CsvSource({ \"/default, 200\", \"/empty, 200\", \"/multiple, 307\", \"/multiple/, 200\" })\n+    void params(String path, int statusCode) {\n+        final WebClient client = WebClient.of(server.httpUri());\n+        assertThat(client.get(path).aggregate().join().status().code()).isEqualTo(statusCode);\n+    }\n+\n+    @Test\n+    void testNullablePathFailureService() {\n+        assertThatThrownBy(() -> {\n+            Server.builder()\n+                  .annotatedService(\"/multiple\", new Object() {\n+                      @Get(\"\")\n+                      @Path(\"/\")\n+                      public HttpResponse multipleValue() {\n+                          return HttpResponse.of(HttpStatus.OK);\n+                      }\n+                  })\n+                  .build();\n+        }).isInstanceOf(IllegalArgumentException.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c59e0605c376b12f9364931a187b11b5a613d00"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg4ODI1MQ==", "bodyText": "Fixed 47ff3d3", "url": "https://github.com/line/armeria/pull/2853#discussion_r450888251", "createdAt": "2020-07-07T14:02:19Z", "author": {"login": "heowc"}, "path": "core/src/test/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceNullablePathTest.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * Copyright 2020 LINE Corporation\n+ *\n+ * LINE Corporation licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.linecorp.armeria.internal.server.annotation;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.extension.RegisterExtension;\n+import org.junit.jupiter.params.ParameterizedTest;\n+import org.junit.jupiter.params.provider.CsvSource;\n+\n+import com.linecorp.armeria.client.WebClient;\n+import com.linecorp.armeria.common.HttpResponse;\n+import com.linecorp.armeria.common.HttpStatus;\n+import com.linecorp.armeria.server.Server;\n+import com.linecorp.armeria.server.ServerBuilder;\n+import com.linecorp.armeria.server.annotation.Get;\n+import com.linecorp.armeria.server.annotation.Path;\n+import com.linecorp.armeria.testing.junit5.server.ServerExtension;\n+\n+class AnnotatedServiceNullablePathTest {\n+\n+    @RegisterExtension\n+    static final ServerExtension server = new ServerExtension() {\n+        @Override\n+        protected void configure(ServerBuilder sb) throws Exception {\n+            sb.annotatedService(\"/default\", new Object() {\n+                @Get\n+                public HttpResponse defaultValue() {\n+                    return HttpResponse.of(HttpStatus.OK);\n+                }\n+            });\n+\n+            sb.annotatedService(\"/empty\", new Object() {\n+                @Get(\"\")\n+                public HttpResponse emptyValue() {\n+                    return HttpResponse.of(HttpStatus.OK);\n+                }\n+            });\n+\n+            sb.annotatedService(\"/multiple\", new Object() {\n+                @Get\n+                @Path(\"/\")\n+                public HttpResponse multipleValue() {\n+                    return HttpResponse.of(HttpStatus.OK);\n+                }\n+            });\n+        }\n+    };\n+\n+    @ParameterizedTest\n+    @CsvSource({ \"/default, 200\", \"/empty, 200\", \"/multiple, 307\", \"/multiple/, 200\" })\n+    void params(String path, int statusCode) {\n+        final WebClient client = WebClient.of(server.httpUri());\n+        assertThat(client.get(path).aggregate().join().status().code()).isEqualTo(statusCode);\n+    }\n+\n+    @Test\n+    void testNullablePathFailureService() {\n+        assertThatThrownBy(() -> {\n+            Server.builder()\n+                  .annotatedService(\"/multiple\", new Object() {\n+                      @Get(\"\")\n+                      @Path(\"/\")\n+                      public HttpResponse multipleValue() {\n+                          return HttpResponse.of(HttpStatus.OK);\n+                      }\n+                  })\n+                  .build();\n+        }).isInstanceOf(IllegalArgumentException.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc3MTQ5Nw=="}, "originalCommit": {"oid": "3c59e0605c376b12f9364931a187b11b5a613d00"}, "originalPosition": 84}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2459, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}