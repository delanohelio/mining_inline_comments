{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2MzE1MzE4", "number": 3039, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwNzozODoxOFrOEexj3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMDoyNjoxNFrOEf7UpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwNzA0NzM1OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/common/SerializationFormat.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwNzozODoxOFrOHKpZKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwODowMDowM1rOHMay7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDkyNTk5NA==", "bodyText": "How about using Loaded instead of Found to meet the term ServiceLoader.load?", "url": "https://github.com/line/armeria/pull/3039#discussion_r480925994", "createdAt": "2020-09-01T07:38:18Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/common/SerializationFormat.java", "diffHunk": "@@ -67,10 +75,16 @@\n                                    \"unknown\", create(\"application\", \"x-unknown\")));\n \n         // Load all serialization formats from the providers.\n-        ServiceLoader.load(SerializationFormatProvider.class,\n-                           SerializationFormatProvider.class.getClassLoader())\n-                     .forEach(p -> p.entries().forEach(e -> register(mutableUriTextToFormats,\n+        final List<SerializationFormatProvider> providers = Streams.stream(\n+                ServiceLoader.load(SerializationFormatProvider.class,\n+                                   SerializationFormatProvider.class.getClassLoader())).collect(\n+                toImmutableList());\n+        if (!providers.isEmpty()) {\n+            logger.info(\"Found {}: {}\", SerializationFormatProvider.class.getSimpleName(), providers);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b805c2566aed463b54a64d36e1612a3f0ab4bc19"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc4Mzk4Mg==", "bodyText": "Fixed. \ud83d\ude09", "url": "https://github.com/line/armeria/pull/3039#discussion_r482783982", "createdAt": "2020-09-03T08:00:03Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/common/SerializationFormat.java", "diffHunk": "@@ -67,10 +75,16 @@\n                                    \"unknown\", create(\"application\", \"x-unknown\")));\n \n         // Load all serialization formats from the providers.\n-        ServiceLoader.load(SerializationFormatProvider.class,\n-                           SerializationFormatProvider.class.getClassLoader())\n-                     .forEach(p -> p.entries().forEach(e -> register(mutableUriTextToFormats,\n+        final List<SerializationFormatProvider> providers = Streams.stream(\n+                ServiceLoader.load(SerializationFormatProvider.class,\n+                                   SerializationFormatProvider.class.getClassLoader())).collect(\n+                toImmutableList());\n+        if (!providers.isEmpty()) {\n+            logger.info(\"Found {}: {}\", SerializationFormatProvider.class.getSimpleName(), providers);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDkyNTk5NA=="}, "originalCommit": {"oid": "b805c2566aed463b54a64d36e1612a3f0ab4bc19"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTEyNjMzOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/common/SerializationFormat.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMDoyNDoyNVrOHMgOkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMDozNjo0M1rOHMgmfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3Mjk3Nw==", "bodyText": "ImmutableList.copyOf, think it should work", "url": "https://github.com/line/armeria/pull/3039#discussion_r482872977", "createdAt": "2020-09-03T10:24:25Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/common/SerializationFormat.java", "diffHunk": "@@ -67,10 +75,16 @@\n                                    \"unknown\", create(\"application\", \"x-unknown\")));\n \n         // Load all serialization formats from the providers.\n-        ServiceLoader.load(SerializationFormatProvider.class,\n-                           SerializationFormatProvider.class.getClassLoader())\n-                     .forEach(p -> p.entries().forEach(e -> register(mutableUriTextToFormats,\n+        final List<SerializationFormatProvider> providers = Streams.stream(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3OTEwMA==", "bodyText": "Fixed. Thanks \ud83d\ude09", "url": "https://github.com/line/armeria/pull/3039#discussion_r482879100", "createdAt": "2020-09-03T10:36:43Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/common/SerializationFormat.java", "diffHunk": "@@ -67,10 +75,16 @@\n                                    \"unknown\", create(\"application\", \"x-unknown\")));\n \n         // Load all serialization formats from the providers.\n-        ServiceLoader.load(SerializationFormatProvider.class,\n-                           SerializationFormatProvider.class.getClassLoader())\n-                     .forEach(p -> p.entries().forEach(e -> register(mutableUriTextToFormats,\n+        final List<SerializationFormatProvider> providers = Streams.stream(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3Mjk3Nw=="}, "originalCommit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTEzMjUzOnYy", "diffSide": "RIGHT", "path": "thrift0.13/src/main/java/com/linecorp/armeria/internal/common/thrift/ThriftSerializationFormatProvider.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMDoyNjoxNFrOHMgSOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMDo0MDo1MFrOHMgupQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3MzkxNQ==", "bodyText": "Does toStringHelper do anything without adding fields to it?", "url": "https://github.com/line/armeria/pull/3039#discussion_r482873915", "createdAt": "2020-09-03T10:26:14Z", "author": {"login": "anuraaga"}, "path": "thrift0.13/src/main/java/com/linecorp/armeria/internal/common/thrift/ThriftSerializationFormatProvider.java", "diffHunk": "@@ -63,4 +64,9 @@ private static MediaType create(String subtype) {\n     private static MediaType create(String subtype, String protocol) {\n         return create(subtype).withParameter(\"protocol\", protocol);\n     }\n+\n+    @Override\n+    public String toString() {\n+        return MoreObjects.toStringHelper(this).toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3Njc5Nw==", "bodyText": "Not exactly. \ud83d\ude04 Just removing the reference from the result string.\nBut yeah, this creates an additional instance so let me just use the string. \ud83d\ude04", "url": "https://github.com/line/armeria/pull/3039#discussion_r482876797", "createdAt": "2020-09-03T10:31:48Z", "author": {"login": "minwoox"}, "path": "thrift0.13/src/main/java/com/linecorp/armeria/internal/common/thrift/ThriftSerializationFormatProvider.java", "diffHunk": "@@ -63,4 +64,9 @@ private static MediaType create(String subtype) {\n     private static MediaType create(String subtype, String protocol) {\n         return create(subtype).withParameter(\"protocol\", protocol);\n     }\n+\n+    @Override\n+    public String toString() {\n+        return MoreObjects.toStringHelper(this).toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3MzkxNQ=="}, "originalCommit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg4MTE4OQ==", "bodyText": "Changed my mind and just removed the method completely. \ud83d\ude09", "url": "https://github.com/line/armeria/pull/3039#discussion_r482881189", "createdAt": "2020-09-03T10:40:50Z", "author": {"login": "minwoox"}, "path": "thrift0.13/src/main/java/com/linecorp/armeria/internal/common/thrift/ThriftSerializationFormatProvider.java", "diffHunk": "@@ -63,4 +64,9 @@ private static MediaType create(String subtype) {\n     private static MediaType create(String subtype, String protocol) {\n         return create(subtype).withParameter(\"protocol\", protocol);\n     }\n+\n+    @Override\n+    public String toString() {\n+        return MoreObjects.toStringHelper(this).toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3MzkxNQ=="}, "originalCommit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1860, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}