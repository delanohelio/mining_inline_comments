{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMTIzNzM2", "number": 2969, "title": "Fix to set content-type correctly for gRPC Trailers-Only", "bodyText": "Motivation:\nWe hardcoded the content-type with application/grpc+proto when sending gRPC Trailers-Only.\nIt is no harm to set the value because there's no following messages.\nBut I think it's better to set the content-type of the corresponding gRPC request so that a user\ndoesn't get surprised.\nModifications:\n\nSet the content-type of the corresponding gRPC request to the gRPC Trailers-Only.\n\nResult:\n\ngRPC Trailers-Only now has the content-type of the corresponding gRPC request.", "createdAt": "2020-08-05T03:35:59Z", "url": "https://github.com/line/armeria/pull/2969", "merged": true, "mergeCommit": {"oid": "b7e03f1f893d0cecede772ac052966ab2b2bdbad"}, "closed": true, "closedAt": "2020-08-05T07:15:40Z", "author": {"login": "minwoox"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7yv4bAH2gAyNDYzMTIzNzM2OmIzYjgxMGJkZjZiZmY4YWMyYTc1Y2FhMjZjMzFiYjZiMDJhZTc3ZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc71SjjgH2gAyNDYzMTIzNzM2OmJkM2IwMTQ5MTg1YTZjMDMzZTU0YTBiMjlkNGFkMTdjNzhjZDhkMzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b3b810bdf6bff8ac2a75caa26c31bb6b02ae77fc", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/b3b810bdf6bff8ac2a75caa26c31bb6b02ae77fc", "committedDate": "2020-08-05T03:35:10Z", "message": "Fix to set content-type correctly for gRPC Trailers-Only\nMotivation:\nWe hardcoded the content-type with `application/grpc+proto` when sending gRPC Trailers-Only.\nIt is no harm to set the value because there's no following messages.\nBut I think it's better to set the content-type of the corresponding gRPC request so that a user\ndoesn't get surprised.\n\nModifications:\n- Set the content-type of the corresponding gRPC request to the gRPC Trailers-Only.\n\nResult:\n- gRPC Trailers-Only now has the content-type of the corresponding gRPC request."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxMzIyNDU2", "url": "https://github.com/line/armeria/pull/2969#pullrequestreview-461322456", "createdAt": "2020-08-05T03:57:36Z", "commit": {"oid": "b3b810bdf6bff8ac2a75caa26c31bb6b02ae77fc"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMzo1NzozN1rOG75Qug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMzo1NzozN1rOG75Qug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ1NzMzOA==", "bodyText": "nit:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        ServiceRequestContext ctx, HttpHeadersBuilder trailerBuilder, Status status, Metadata metadata) {\n          \n          \n            \n                        ServiceRequestContext ctx, HttpHeadersBuilder trailersBuilder, Status status, Metadata metadata) {", "url": "https://github.com/line/armeria/pull/2969#discussion_r465457338", "createdAt": "2020-08-05T03:57:37Z", "author": {"login": "ikhoon"}, "path": "grpc/src/main/java/com/linecorp/armeria/server/grpc/ArmeriaServerCall.java", "diffHunk": "@@ -515,22 +517,22 @@ private void setClientStreamClosed() {\n \n     // Returns ResponseHeaders if headersSent == false or HttpHeaders otherwise.\n     static HttpHeaders statusToTrailers(\n-            ServiceRequestContext ctx, Status status, Metadata metadata, boolean headersSent) {\n-        final HttpHeadersBuilder trailers = GrpcTrailersUtil.statusToTrailers(\n-                status.getCode().value(), status.getDescription(), headersSent);\n+            ServiceRequestContext ctx, HttpHeadersBuilder trailerBuilder, Status status, Metadata metadata) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3b810bdf6bff8ac2a75caa26c31bb6b02ae77fc"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxMzYwMDkw", "url": "https://github.com/line/armeria/pull/2969#pullrequestreview-461360090", "createdAt": "2020-08-05T05:56:36Z", "commit": {"oid": "b3b810bdf6bff8ac2a75caa26c31bb6b02ae77fc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd3b0149185a6c033e54a0b29d4ad17c78cd8d31", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/bd3b0149185a6c033e54a0b29d4ad17c78cd8d31", "committedDate": "2020-08-05T06:32:51Z", "message": "Address the comment by @ikhoon"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 9, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}