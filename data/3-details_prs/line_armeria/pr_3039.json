{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2MzE1MzE4", "number": 3039, "title": "Log the implementations found by SPI", "bodyText": "Motivation:\nIt's not easy to recognize if Java SPI service interfaces are not applied correctly due to fat JAR, etc.\nThis is the related link and possible solution in that case: https://romanmarkunas.com/build/2018/11/13/0007-build-gradle-fat-jars/\nModification:\n\nLog the implementations found by SPI.\n\nResult:\n\nYou are now easily get noticed whether SPI service interfaces are applied correctly.", "createdAt": "2020-08-31T13:55:29Z", "url": "https://github.com/line/armeria/pull/3039", "merged": true, "mergeCommit": {"oid": "4839d788a066ab013490d816de0717f111ed5cd4"}, "closed": true, "closedAt": "2020-09-07T03:06:51Z", "author": {"login": "minwoox"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdETMTZAH2gAyNDc2MzE1MzE4OmI4MDVjMjU2NmFlZDQ2M2I1NGE2NGQzNmUxNjEyYTNmMGFiNGJjMTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdGaHMNAFqTQ4MzIxNjYxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b805c2566aed463b54a64d36e1612a3f0ab4bc19", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/b805c2566aed463b54a64d36e1612a3f0ab4bc19", "committedDate": "2020-08-31T13:54:34Z", "message": "Log the implementations found by SPI\nMotivation:\nIt's not easy to recognize if Java SPI service interfaces are not applied correctly due to fat JAR, etc.\nThis is the related link and possible solution in that case: https://romanmarkunas.com/build/2018/11/13/0007-build-gradle-fat-jars/\n\nModification:\n- Log the implementations found by SPI.\n\nResult:\n- You are now easily get noticed whether SPI servie interfaces are applied correctly."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NDc1NDYz", "url": "https://github.com/line/armeria/pull/3039#pullrequestreview-479475463", "createdAt": "2020-09-01T07:38:17Z", "commit": {"oid": "b805c2566aed463b54a64d36e1612a3f0ab4bc19"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwNzozODoxOFrOHKpZKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwNzozODoxOFrOHKpZKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDkyNTk5NA==", "bodyText": "How about using Loaded instead of Found to meet the term ServiceLoader.load?", "url": "https://github.com/line/armeria/pull/3039#discussion_r480925994", "createdAt": "2020-09-01T07:38:18Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/common/SerializationFormat.java", "diffHunk": "@@ -67,10 +75,16 @@\n                                    \"unknown\", create(\"application\", \"x-unknown\")));\n \n         // Load all serialization formats from the providers.\n-        ServiceLoader.load(SerializationFormatProvider.class,\n-                           SerializationFormatProvider.class.getClassLoader())\n-                     .forEach(p -> p.entries().forEach(e -> register(mutableUriTextToFormats,\n+        final List<SerializationFormatProvider> providers = Streams.stream(\n+                ServiceLoader.load(SerializationFormatProvider.class,\n+                                   SerializationFormatProvider.class.getClassLoader())).collect(\n+                toImmutableList());\n+        if (!providers.isEmpty()) {\n+            logger.info(\"Found {}: {}\", SerializationFormatProvider.class.getSimpleName(), providers);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b805c2566aed463b54a64d36e1612a3f0ab4bc19"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/9c868c04ea284e0d13a0f58df96807a6f9633c37", "committedDate": "2020-09-03T07:59:44Z", "message": "Address the comment by @ikhoon"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNzAzMzc0", "url": "https://github.com/line/armeria/pull/3039#pullrequestreview-481703374", "createdAt": "2020-09-03T10:24:25Z", "commit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMDoyNDoyNVrOHMgOkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMDoyNjoxNFrOHMgSOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3Mjk3Nw==", "bodyText": "ImmutableList.copyOf, think it should work", "url": "https://github.com/line/armeria/pull/3039#discussion_r482872977", "createdAt": "2020-09-03T10:24:25Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/common/SerializationFormat.java", "diffHunk": "@@ -67,10 +75,16 @@\n                                    \"unknown\", create(\"application\", \"x-unknown\")));\n \n         // Load all serialization formats from the providers.\n-        ServiceLoader.load(SerializationFormatProvider.class,\n-                           SerializationFormatProvider.class.getClassLoader())\n-                     .forEach(p -> p.entries().forEach(e -> register(mutableUriTextToFormats,\n+        final List<SerializationFormatProvider> providers = Streams.stream(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg3MzkxNQ==", "bodyText": "Does toStringHelper do anything without adding fields to it?", "url": "https://github.com/line/armeria/pull/3039#discussion_r482873915", "createdAt": "2020-09-03T10:26:14Z", "author": {"login": "anuraaga"}, "path": "thrift0.13/src/main/java/com/linecorp/armeria/internal/common/thrift/ThriftSerializationFormatProvider.java", "diffHunk": "@@ -63,4 +64,9 @@ private static MediaType create(String subtype) {\n     private static MediaType create(String subtype, String protocol) {\n         return create(subtype).withParameter(\"protocol\", protocol);\n     }\n+\n+    @Override\n+    public String toString() {\n+        return MoreObjects.toStringHelper(this).toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c868c04ea284e0d13a0f58df96807a6f9633c37"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35bd07d225d108d7798750df7cb146d40a691172", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/35bd07d225d108d7798750df7cb146d40a691172", "committedDate": "2020-09-03T10:38:43Z", "message": "Address comments by @anuraaga"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43c079a7c1b6c20ecdb6aea3fc8db013d8ea7e36", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/43c079a7c1b6c20ecdb6aea3fc8db013d8ea7e36", "committedDate": "2020-09-03T10:39:44Z", "message": "Remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9e14253fead27584e274c0e04b3e5f3d792c65c", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/f9e14253fead27584e274c0e04b3e5f3d792c65c", "committedDate": "2020-09-03T13:24:04Z", "message": "Remove unused"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMjcyMzM4", "url": "https://github.com/line/armeria/pull/3039#pullrequestreview-482272338", "createdAt": "2020-09-03T23:48:50Z", "commit": {"oid": "f9e14253fead27584e274c0e04b3e5f3d792c65c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMzA3MzMz", "url": "https://github.com/line/armeria/pull/3039#pullrequestreview-482307333", "createdAt": "2020-09-04T01:54:29Z", "commit": {"oid": "f9e14253fead27584e274c0e04b3e5f3d792c65c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzMjE2NjE5", "url": "https://github.com/line/armeria/pull/3039#pullrequestreview-483216619", "createdAt": "2020-09-07T03:06:10Z", "commit": {"oid": "f9e14253fead27584e274c0e04b3e5f3d792c65c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4622, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}