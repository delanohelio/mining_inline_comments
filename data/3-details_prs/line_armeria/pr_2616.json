{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxNDA2OTEw", "number": 2616, "title": "Make `ClosedSessionException` extend `ClosedStreamException`", "bodyText": "Motivation:\nClosedSessionException also means that all sessions are closed.\nIf ClosedSessionException extends ClosedSessionException,\na ClosedSessionException can be caught by ClosedSessionException.\nIt will be useful when a user wants to make their own retrying strategy.\nModifications:\n\nMake ClosedStreamException extensible\nClosedSessionException extends ClosedStreamException instead of RuntimeException\n\nResult:\n\nYou can now catch ClosedSessionException by ClosedStreamException\nFixes #2596", "createdAt": "2020-03-20T08:23:41Z", "url": "https://github.com/line/armeria/pull/2616", "merged": true, "mergeCommit": {"oid": "a459ca6584aa7142a3f007c4ed87dc2e80c7dc34"}, "closed": true, "closedAt": "2020-03-25T11:09:02Z", "author": {"login": "ikhoon"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPcLByAH2gAyMzkxNDA2OTEwOjVmZDlhZmJlNWVmNWIzZjhiNjg0MDVhZjVlMTQ3YThjMjY3NTAxNGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRElDMgBqjMxNjMyNzEyNzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5fd9afbe5ef5b3f8b68405af5e147a8c2675014d", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/5fd9afbe5ef5b3f8b68405af5e147a8c2675014d", "committedDate": "2020-03-20T08:24:20Z", "message": "Make `ClosedSessionException` extend `ClosedStreamException`\n\nMotivation:\n\n`ClosedSessionException` also means that all sessions are closed.\nIf `ClosedSessionException` extends `ClosedSessionException`,\na `ClosedSessionException` can be caught by `ClosedSessionException`.\nIt will be useful when a user wants to make their own retrying strategy.\n\nModifications:\n\n- Make `ClosedStreamException` extensible\n- `ClosedSessionException` extends `ClosedStreamException` instead of `RuntimeException`\n\nResult:\n\n- You can now catch `ClosedSessionException` by `ClosedStreamException`\n- Fixes #2596"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb13a2c5b0d17d5be0f92e474321e689990c7ff9", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/fb13a2c5b0d17d5be0f92e474321e689990c7ff9", "committedDate": "2020-03-20T08:08:18Z", "message": "Make `ClosedSessionException` extend `ClosedStreamException`\n\nMotivation:\n\n`ClosedSessionException` also means that all sessions are closed.\nIf `ClosedSessionException` extends `ClosedSessionException`,\na `ClosedSessionException` can be caught by `ClosedSessionException`.\nIt will useful when a user want to make their own retrying strategy.\n\nModifications:\n\n- Make `ClosedStreamException` extensible\n- `ClosedSessionException` extends `ClosedStreamException` instead of `RuntimeException`\n\nResult:\n\n- You can now catch `ClosedSessionException` by `ClosedStreamException`\n- Fixes #2596"}, "afterCommit": {"oid": "5fd9afbe5ef5b3f8b68405af5e147a8c2675014d", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/5fd9afbe5ef5b3f8b68405af5e147a8c2675014d", "committedDate": "2020-03-20T08:24:20Z", "message": "Make `ClosedSessionException` extend `ClosedStreamException`\n\nMotivation:\n\n`ClosedSessionException` also means that all sessions are closed.\nIf `ClosedSessionException` extends `ClosedSessionException`,\na `ClosedSessionException` can be caught by `ClosedSessionException`.\nIt will be useful when a user wants to make their own retrying strategy.\n\nModifications:\n\n- Make `ClosedStreamException` extensible\n- `ClosedSessionException` extends `ClosedStreamException` instead of `RuntimeException`\n\nResult:\n\n- You can now catch `ClosedSessionException` by `ClosedStreamException`\n- Fixes #2596"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4NTAwODE3", "url": "https://github.com/line/armeria/pull/2616#pullrequestreview-378500817", "createdAt": "2020-03-20T13:52:55Z", "commit": {"oid": "5fd9afbe5ef5b3f8b68405af5e147a8c2675014d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37c19947a85a739a8e804d49376a5ce5e3424cb2", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/37c19947a85a739a8e804d49376a5ce5e3424cb2", "committedDate": "2020-03-20T16:18:25Z", "message": "Address comments by @trustin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4ODYyMDA0", "url": "https://github.com/line/armeria/pull/2616#pullrequestreview-378862004", "createdAt": "2020-03-20T23:30:47Z", "commit": {"oid": "37c19947a85a739a8e804d49376a5ce5e3424cb2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQyMzozMDo0N1rOF5lu7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQyMzozMDo0N1rOF5lu7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkzMTM3NA==", "bodyText": "Can we add a helper somewhere that just returns this boolean condition with documentation? It's not clear to me what the semantic meaning of this is. Or perhaps it's an overridden method of ClosedStreamException.\nThough one thought is given the complexity of this sort of check, is it actually a good idea to have the inheritance relationship after all?", "url": "https://github.com/line/armeria/pull/2616#discussion_r395931374", "createdAt": "2020-03-20T23:30:47Z", "author": {"login": "anuraaga"}, "path": "grpc/src/main/java/com/linecorp/armeria/internal/common/grpc/GrpcStatus.java", "diffHunk": "@@ -81,7 +82,7 @@ public static Status fromThrowable(Throwable t) {\n         if (s.getCode() != Code.UNKNOWN) {\n             return s;\n         }\n-        if (t instanceof ClosedStreamException) {\n+        if (t instanceof ClosedStreamException && !(t instanceof ClosedSessionException)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37c19947a85a739a8e804d49376a5ce5e3424cb2"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MDk0MDEx", "url": "https://github.com/line/armeria/pull/2616#pullrequestreview-379094011", "createdAt": "2020-03-23T01:59:22Z", "commit": {"oid": "37c19947a85a739a8e804d49376a5ce5e3424cb2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d473039dad8497fdd3b87e9733d4184aa1bfd4ed", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/d473039dad8497fdd3b87e9733d4184aa1bfd4ed", "committedDate": "2020-03-23T02:09:10Z", "message": "Fix checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MTI3ODE2", "url": "https://github.com/line/armeria/pull/2616#pullrequestreview-379127816", "createdAt": "2020-03-23T04:34:34Z", "commit": {"oid": "d473039dad8497fdd3b87e9733d4184aa1bfd4ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNDozNDozNFrOF52rkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNDozNDozNFrOF52rkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwOTA0MA==", "bodyText": "cause instanceof ClosedSessionException is true when the cause is ClosedStreamException.", "url": "https://github.com/line/armeria/pull/2616#discussion_r396209040", "createdAt": "2020-03-23T04:34:34Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/server/HttpServerHandler.java", "diffHunk": "@@ -106,7 +106,8 @@\n \n     static final ChannelFutureListener CLOSE_ON_FAILURE = future -> {\n         final Throwable cause = future.cause();\n-        if (cause != null && !(cause instanceof ClosedStreamException)) {\n+        if (cause != null && (!(cause instanceof ClosedStreamException) ||\n+                              cause instanceof ClosedSessionException)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d473039dad8497fdd3b87e9733d4184aa1bfd4ed"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49732b89ed305746b4aa93cd301423df592d282c", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/49732b89ed305746b4aa93cd301423df592d282c", "committedDate": "2020-03-25T07:17:58Z", "message": "Address comments by @minwoox"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9230c0dc01f8cb8c23628ba7d857aa75d1d3d690", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/9230c0dc01f8cb8c23628ba7d857aa75d1d3d690", "committedDate": "2020-03-25T09:55:26Z", "message": "Address comments 2 by @minnwoo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMDAzMjIz", "url": "https://github.com/line/armeria/pull/2616#pullrequestreview-381003223", "createdAt": "2020-03-25T10:02:24Z", "commit": {"oid": "2e5761237d4c0dbdcf1ea470e8c6221603cfe213"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05c49bbc86daa3c6db2c58f7ea3c495ff0774c96", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/05c49bbc86daa3c6db2c58f7ea3c495ff0774c96", "committedDate": "2020-03-25T10:02:32Z", "message": "Indent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e5761237d4c0dbdcf1ea470e8c6221603cfe213", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/2e5761237d4c0dbdcf1ea470e8c6221603cfe213", "committedDate": "2020-03-25T09:58:26Z", "message": "Indent"}, "afterCommit": {"oid": "05c49bbc86daa3c6db2c58f7ea3c495ff0774c96", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/05c49bbc86daa3c6db2c58f7ea3c495ff0774c96", "committedDate": "2020-03-25T10:02:32Z", "message": "Indent"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 723, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}