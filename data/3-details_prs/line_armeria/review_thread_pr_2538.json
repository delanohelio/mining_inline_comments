{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNzA3MTcy", "number": 2538, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwOTowMzo0OFrODjYXBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMTo1ODo1M1rODjb76g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDI1ODYxOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/client/ClientBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwOTowMzo0OFrOFvJ_wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwOTowMzo0OFrOFvJ_wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDk5MTE2OA==", "bodyText": "nit:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Sets the {@link SerializationFormat} of the client from the specified {@code String}.\n          \n          \n            \n                 * Sets the {@link SerializationFormat} of the client from the specified {@code format}.", "url": "https://github.com/line/armeria/pull/2538#discussion_r384991168", "createdAt": "2020-02-27T09:03:48Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/client/ClientBuilder.java", "diffHunk": "@@ -67,96 +66,43 @@\n     @Nullable\n     private final EndpointGroup endpointGroup;\n     @Nullable\n-    private final Scheme scheme;\n-    @Nullable\n-    private final SessionProtocol protocol;\n-    @Nullable\n-    private String path;\n-\n-    private SerializationFormat format = SerializationFormat.NONE;\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified {@code uri}.\n-     *\n-     * @deprecated Use {@link Clients#builder(String)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(String uri) {\n-        this(URI.create(requireNonNull(uri, \"uri\")));\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified {@link URI}.\n-     *\n-     * @deprecated Use {@link Clients#builder(URI)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(URI uri) {\n-        this(requireNonNull(uri, \"uri\"), null, null, null);\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@code scheme}.\n-     *\n-     * @deprecated Use {@link Clients#builder(String, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(String scheme, Endpoint endpoint) {\n-        this(Scheme.parse(requireNonNull(scheme, \"scheme\")), requireNonNull(endpoint, \"endpoint\"));\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@link Scheme}.\n-     *\n-     * @deprecated Use {@link Clients#builder(Scheme, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(Scheme scheme, Endpoint endpoint) {\n-        this(null, requireNonNull(scheme, \"scheme\"), null, requireNonNull(endpoint, \"endpoint\"));\n-    }\n+    private final String path;\n+    private Scheme scheme;\n+    private boolean updatedScheme;\n \n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@link SessionProtocol}.\n-     *\n-     * @deprecated Use {@link Clients#builder(SessionProtocol, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(SessionProtocol protocol, Endpoint endpoint) {\n-        this(null, null, requireNonNull(protocol, \"protocol\"), requireNonNull(endpoint, \"endpoint\"));\n+    ClientBuilder(URI uri) {\n+        checkArgument(uri.getScheme() != null, \"uri must have scheme: %s\", uri);\n+        checkArgument(uri.getRawAuthority() != null, \"uri must have authority: %s\", uri);\n+        this.uri = uri;\n+        endpointGroup = null;\n+        path = null;\n+        scheme = Scheme.parse(uri.getScheme());\n     }\n \n-    ClientBuilder(@Nullable URI uri, @Nullable Scheme scheme, @Nullable SessionProtocol protocol,\n-                  @Nullable EndpointGroup endpointGroup) {\n-        this.uri = uri;\n-        this.scheme = scheme;\n-        this.protocol = protocol;\n+    ClientBuilder(Scheme scheme, EndpointGroup endpointGroup, @Nullable String path) {\n+        if (path != null) {\n+            checkArgument(path.startsWith(\"/\"),\n+                          \"path: %s (expected: an absolute path starting with '/')\", path);\n+        }\n+        uri = null;\n         this.endpointGroup = endpointGroup;\n+        this.path = path;\n+        this.scheme = scheme;\n     }\n \n     /**\n-     * Sets the {@code path} of the client.\n+     * Sets the {@link SerializationFormat} of the client from the specified {@code String}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc75d559ef3b6a2edd13d5aa84aa37e2ac223abe"}, "originalPosition": 101}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDMyNTE1OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/client/WebClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwOToyMzo1MlrOFvKo5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwOToyMzo1MlrOFvKo5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAwMTcwMA==", "bodyText": "nit: I don't think all SessionProtocal is supported.\nHow about:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n          \n          \n            \n                 *                                  in {@link SessionProtocol}\n          \n          \n            \n                 * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n          \n          \n            \n                 *                                  in {@link SessionProtocol#httpValues()} or {@link SessionProtocol#httpsValues()}", "url": "https://github.com/line/armeria/pull/2538#discussion_r385001700", "createdAt": "2020-02-27T09:23:52Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/client/WebClient.java", "diffHunk": "@@ -312,15 +352,50 @@ static WebClientBuilder builder(URI uri) {\n         return new WebClientBuilder(uri);\n     }\n \n+    /**\n+     * Returns a new {@link WebClientBuilder} created with the specified {@code protocol}\n+     * and base {@link EndpointGroup}.\n+     *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(String protocol, EndpointGroup endpointGroup) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")), endpointGroup);\n+    }\n+\n     /**\n      * Returns a new {@link WebClientBuilder} created with the specified {@link SessionProtocol}\n      * and base {@link EndpointGroup}.\n      *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc75d559ef3b6a2edd13d5aa84aa37e2ac223abe"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDM0MDM5OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/client/WebClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwOToyODoxNVrOFvKyZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwOToyODoxNVrOFvKyZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAwNDEzNQ==", "bodyText": "nit: Change sessionProtocol to protocol for consistency?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                static WebClientBuilder builder(SessionProtocol sessionProtocol, EndpointGroup endpointGroup,\n          \n          \n            \n                static WebClientBuilder builder(SessionProtocol protocol, EndpointGroup endpointGroup,", "url": "https://github.com/line/armeria/pull/2538#discussion_r385004135", "createdAt": "2020-02-27T09:28:15Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/client/WebClient.java", "diffHunk": "@@ -312,15 +352,50 @@ static WebClientBuilder builder(URI uri) {\n         return new WebClientBuilder(uri);\n     }\n \n+    /**\n+     * Returns a new {@link WebClientBuilder} created with the specified {@code protocol}\n+     * and base {@link EndpointGroup}.\n+     *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(String protocol, EndpointGroup endpointGroup) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")), endpointGroup);\n+    }\n+\n     /**\n      * Returns a new {@link WebClientBuilder} created with the specified {@link SessionProtocol}\n      * and base {@link EndpointGroup}.\n      *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(SessionProtocol protocol, EndpointGroup endpointGroup) {\n+        return builder(protocol, endpointGroup, null);\n+    }\n+\n+    /**\n+     * Returns a new {@link WebClientBuilder} created with the specified {@code protocol}.\n+     * base {@link EndpointGroup} and path.\n+     *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(String protocol, EndpointGroup endpointGroup, @Nullable String path) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")),\n+                       endpointGroup, path);\n+    }\n+\n+    /**\n+     * Returns a new {@link WebClientBuilder} created with the specified {@link SessionProtocol},\n+     * base {@link EndpointGroup} and path.\n+     *\n      * @throws IllegalArgumentException if the {@code sessionProtocol} is not one of the fields\n      *                                  in {@link SessionProtocol}\n      */\n-    static WebClientBuilder builder(SessionProtocol sessionProtocol, EndpointGroup endpointGroup) {\n-        return new WebClientBuilder(sessionProtocol, endpointGroup);\n+    static WebClientBuilder builder(SessionProtocol sessionProtocol, EndpointGroup endpointGroup,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc75d559ef3b6a2edd13d5aa84aa37e2ac223abe"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDM3NjMzOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/client/WebClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwOTozNzo0OVrOFvLIGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDoxMzozOVrOFvMZhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAwOTY4OA==", "bodyText": "How about making path non-null? Because this builder already have\nbuilder(String protocol, EndpointGroup endpointGroup).", "url": "https://github.com/line/armeria/pull/2538#discussion_r385009688", "createdAt": "2020-02-27T09:37:49Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/client/WebClient.java", "diffHunk": "@@ -312,15 +352,50 @@ static WebClientBuilder builder(URI uri) {\n         return new WebClientBuilder(uri);\n     }\n \n+    /**\n+     * Returns a new {@link WebClientBuilder} created with the specified {@code protocol}\n+     * and base {@link EndpointGroup}.\n+     *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(String protocol, EndpointGroup endpointGroup) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")), endpointGroup);\n+    }\n+\n     /**\n      * Returns a new {@link WebClientBuilder} created with the specified {@link SessionProtocol}\n      * and base {@link EndpointGroup}.\n      *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(SessionProtocol protocol, EndpointGroup endpointGroup) {\n+        return builder(protocol, endpointGroup, null);\n+    }\n+\n+    /**\n+     * Returns a new {@link WebClientBuilder} created with the specified {@code protocol}.\n+     * base {@link EndpointGroup} and path.\n+     *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(String protocol, EndpointGroup endpointGroup, @Nullable String path) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc75d559ef3b6a2edd13d5aa84aa37e2ac223abe"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMDUzNA==", "bodyText": "Made path non-null. \ud83d\ude47\u200d\u2642\ufe0f", "url": "https://github.com/line/armeria/pull/2538#discussion_r385030534", "createdAt": "2020-02-27T10:13:39Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/client/WebClient.java", "diffHunk": "@@ -312,15 +352,50 @@ static WebClientBuilder builder(URI uri) {\n         return new WebClientBuilder(uri);\n     }\n \n+    /**\n+     * Returns a new {@link WebClientBuilder} created with the specified {@code protocol}\n+     * and base {@link EndpointGroup}.\n+     *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(String protocol, EndpointGroup endpointGroup) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")), endpointGroup);\n+    }\n+\n     /**\n      * Returns a new {@link WebClientBuilder} created with the specified {@link SessionProtocol}\n      * and base {@link EndpointGroup}.\n      *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(SessionProtocol protocol, EndpointGroup endpointGroup) {\n+        return builder(protocol, endpointGroup, null);\n+    }\n+\n+    /**\n+     * Returns a new {@link WebClientBuilder} created with the specified {@code protocol}.\n+     * base {@link EndpointGroup} and path.\n+     *\n+     * @throws IllegalArgumentException if the {@code protocol} is not one of the fields\n+     *                                  in {@link SessionProtocol}\n+     */\n+    static WebClientBuilder builder(String protocol, EndpointGroup endpointGroup, @Nullable String path) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAwOTY4OA=="}, "originalCommit": {"oid": "dc75d559ef3b6a2edd13d5aa84aa37e2ac223abe"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDUxODkzOnYy", "diffSide": "RIGHT", "path": "retrofit2/src/main/java/com/linecorp/armeria/client/retrofit2/ArmeriaRetrofit.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDoxNjowNlrOFvMegA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDoyMToyOFrOFvMp5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMTgwOA==", "bodyText": "Shouldn't we update this too? \ud83d\ude00", "url": "https://github.com/line/armeria/pull/2538#discussion_r385031808", "createdAt": "2020-02-27T10:16:06Z", "author": {"login": "ikhoon"}, "path": "retrofit2/src/main/java/com/linecorp/armeria/client/retrofit2/ArmeriaRetrofit.java", "diffHunk": "@@ -78,14 +104,40 @@ public static ArmeriaRetrofitBuilder builder(URI baseUrl) {\n         return builder(WebClient.of(baseUrl));\n     }\n \n+    /**\n+     * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n+     * the specified {@link EndpointGroup} using the specified {@code protocol}.\n+     */\n+    public static ArmeriaRetrofitBuilder builder(String protocol, EndpointGroup endpointGroup) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")), endpointGroup);\n+    }\n+\n     /**\n      * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n      * the specified {@link EndpointGroup} using the specified {@link SessionProtocol}.\n      */\n     public static ArmeriaRetrofitBuilder builder(SessionProtocol protocol, EndpointGroup endpointGroup) {\n+        return builder(protocol, endpointGroup, null);\n+    }\n+\n+    /**\n+     * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n+     * the specified {@link EndpointGroup} using the specified {@link SessionProtocol} and {@code path}.\n+     */\n+    public static ArmeriaRetrofitBuilder builder(String protocol, EndpointGroup endpointGroup,\n+                                                 @Nullable String path) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f43dbbeec7aa866ed230a2b65aa90cbc86f453a"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzNDcyNA==", "bodyText": "Fixed \ud83d\ude05", "url": "https://github.com/line/armeria/pull/2538#discussion_r385034724", "createdAt": "2020-02-27T10:21:28Z", "author": {"login": "trustin"}, "path": "retrofit2/src/main/java/com/linecorp/armeria/client/retrofit2/ArmeriaRetrofit.java", "diffHunk": "@@ -78,14 +104,40 @@ public static ArmeriaRetrofitBuilder builder(URI baseUrl) {\n         return builder(WebClient.of(baseUrl));\n     }\n \n+    /**\n+     * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n+     * the specified {@link EndpointGroup} using the specified {@code protocol}.\n+     */\n+    public static ArmeriaRetrofitBuilder builder(String protocol, EndpointGroup endpointGroup) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")), endpointGroup);\n+    }\n+\n     /**\n      * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n      * the specified {@link EndpointGroup} using the specified {@link SessionProtocol}.\n      */\n     public static ArmeriaRetrofitBuilder builder(SessionProtocol protocol, EndpointGroup endpointGroup) {\n+        return builder(protocol, endpointGroup, null);\n+    }\n+\n+    /**\n+     * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n+     * the specified {@link EndpointGroup} using the specified {@link SessionProtocol} and {@code path}.\n+     */\n+    public static ArmeriaRetrofitBuilder builder(String protocol, EndpointGroup endpointGroup,\n+                                                 @Nullable String path) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMTgwOA=="}, "originalCommit": {"oid": "0f43dbbeec7aa866ed230a2b65aa90cbc86f453a"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDUyMDEwOnYy", "diffSide": "RIGHT", "path": "retrofit2/src/main/java/com/linecorp/armeria/client/retrofit2/ArmeriaRetrofit.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDoxNjoyN1rOFvMfOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMDoxNjoyN1rOFvMfOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMTk5NQ==", "bodyText": "Ditto", "url": "https://github.com/line/armeria/pull/2538#discussion_r385031995", "createdAt": "2020-02-27T10:16:27Z", "author": {"login": "ikhoon"}, "path": "retrofit2/src/main/java/com/linecorp/armeria/client/retrofit2/ArmeriaRetrofit.java", "diffHunk": "@@ -78,14 +104,40 @@ public static ArmeriaRetrofitBuilder builder(URI baseUrl) {\n         return builder(WebClient.of(baseUrl));\n     }\n \n+    /**\n+     * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n+     * the specified {@link EndpointGroup} using the specified {@code protocol}.\n+     */\n+    public static ArmeriaRetrofitBuilder builder(String protocol, EndpointGroup endpointGroup) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")), endpointGroup);\n+    }\n+\n     /**\n      * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n      * the specified {@link EndpointGroup} using the specified {@link SessionProtocol}.\n      */\n     public static ArmeriaRetrofitBuilder builder(SessionProtocol protocol, EndpointGroup endpointGroup) {\n+        return builder(protocol, endpointGroup, null);\n+    }\n+\n+    /**\n+     * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n+     * the specified {@link EndpointGroup} using the specified {@link SessionProtocol} and {@code path}.\n+     */\n+    public static ArmeriaRetrofitBuilder builder(String protocol, EndpointGroup endpointGroup,\n+                                                 @Nullable String path) {\n+        return builder(SessionProtocol.of(requireNonNull(protocol, \"protocol\")), endpointGroup, path);\n+    }\n+\n+    /**\n+     * Returns a new {@link ArmeriaRetrofitBuilder} that builds a client that sends requests to\n+     * the specified {@link EndpointGroup} using the specified {@link SessionProtocol} and {@code path}.\n+     */\n+    public static ArmeriaRetrofitBuilder builder(SessionProtocol protocol, EndpointGroup endpointGroup,\n+                                                 @Nullable String path) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f43dbbeec7aa866ed230a2b65aa90cbc86f453a"}, "originalPosition": 81}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDg0NDU4OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/client/ClientBuilder.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMTo1ODo1M1rOFvPjdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwNDo1ODo0NlrOFvpiTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA4MjIzMA==", "bodyText": "Similar to path, shouldn't this also go away since scheme is a required parameter?", "url": "https://github.com/line/armeria/pull/2538#discussion_r385082230", "createdAt": "2020-02-27T11:58:53Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/client/ClientBuilder.java", "diffHunk": "@@ -67,96 +66,43 @@\n     @Nullable\n     private final EndpointGroup endpointGroup;\n     @Nullable\n-    private final Scheme scheme;\n-    @Nullable\n-    private final SessionProtocol protocol;\n-    @Nullable\n-    private String path;\n-\n-    private SerializationFormat format = SerializationFormat.NONE;\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified {@code uri}.\n-     *\n-     * @deprecated Use {@link Clients#builder(String)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(String uri) {\n-        this(URI.create(requireNonNull(uri, \"uri\")));\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified {@link URI}.\n-     *\n-     * @deprecated Use {@link Clients#builder(URI)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(URI uri) {\n-        this(requireNonNull(uri, \"uri\"), null, null, null);\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@code scheme}.\n-     *\n-     * @deprecated Use {@link Clients#builder(String, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(String scheme, Endpoint endpoint) {\n-        this(Scheme.parse(requireNonNull(scheme, \"scheme\")), requireNonNull(endpoint, \"endpoint\"));\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@link Scheme}.\n-     *\n-     * @deprecated Use {@link Clients#builder(Scheme, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(Scheme scheme, Endpoint endpoint) {\n-        this(null, requireNonNull(scheme, \"scheme\"), null, requireNonNull(endpoint, \"endpoint\"));\n-    }\n+    private final String path;\n+    private Scheme scheme;\n+    private boolean updatedScheme;\n \n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@link SessionProtocol}.\n-     *\n-     * @deprecated Use {@link Clients#builder(SessionProtocol, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(SessionProtocol protocol, Endpoint endpoint) {\n-        this(null, null, requireNonNull(protocol, \"protocol\"), requireNonNull(endpoint, \"endpoint\"));\n+    ClientBuilder(URI uri) {\n+        checkArgument(uri.getScheme() != null, \"uri must have scheme: %s\", uri);\n+        checkArgument(uri.getRawAuthority() != null, \"uri must have authority: %s\", uri);\n+        this.uri = uri;\n+        endpointGroup = null;\n+        path = null;\n+        scheme = Scheme.parse(uri.getScheme());\n     }\n \n-    ClientBuilder(@Nullable URI uri, @Nullable Scheme scheme, @Nullable SessionProtocol protocol,\n-                  @Nullable EndpointGroup endpointGroup) {\n-        this.uri = uri;\n-        this.scheme = scheme;\n-        this.protocol = protocol;\n+    ClientBuilder(Scheme scheme, EndpointGroup endpointGroup, @Nullable String path) {\n+        if (path != null) {\n+            checkArgument(path.startsWith(\"/\"),\n+                          \"path: %s (expected: an absolute path starting with '/')\", path);\n+        }\n+        uri = null;\n         this.endpointGroup = endpointGroup;\n+        this.path = path;\n+        this.scheme = scheme;\n     }\n \n     /**\n-     * Sets the {@code path} of the client.\n+     * Sets the {@link SerializationFormat} of the client from the specified {@code format}.\n      */\n-    public ClientBuilder path(String path) {\n-        ensureEndpointGroup();\n-        requireNonNull(path, \"path\");\n-        checkArgument(path.startsWith(\"/\"), \"path: %s (expected: an absolute path starting with '/')\", path);\n-        this.path = path;\n-        return this;\n+    public ClientBuilder serializationFormat(String format) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df90b0da6d7854680d0b8af5aface4893a86bdb7"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ2Njk2OA==", "bodyText": "+1 if possible.", "url": "https://github.com/line/armeria/pull/2538#discussion_r385466968", "createdAt": "2020-02-28T01:39:56Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/client/ClientBuilder.java", "diffHunk": "@@ -67,96 +66,43 @@\n     @Nullable\n     private final EndpointGroup endpointGroup;\n     @Nullable\n-    private final Scheme scheme;\n-    @Nullable\n-    private final SessionProtocol protocol;\n-    @Nullable\n-    private String path;\n-\n-    private SerializationFormat format = SerializationFormat.NONE;\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified {@code uri}.\n-     *\n-     * @deprecated Use {@link Clients#builder(String)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(String uri) {\n-        this(URI.create(requireNonNull(uri, \"uri\")));\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified {@link URI}.\n-     *\n-     * @deprecated Use {@link Clients#builder(URI)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(URI uri) {\n-        this(requireNonNull(uri, \"uri\"), null, null, null);\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@code scheme}.\n-     *\n-     * @deprecated Use {@link Clients#builder(String, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(String scheme, Endpoint endpoint) {\n-        this(Scheme.parse(requireNonNull(scheme, \"scheme\")), requireNonNull(endpoint, \"endpoint\"));\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@link Scheme}.\n-     *\n-     * @deprecated Use {@link Clients#builder(Scheme, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(Scheme scheme, Endpoint endpoint) {\n-        this(null, requireNonNull(scheme, \"scheme\"), null, requireNonNull(endpoint, \"endpoint\"));\n-    }\n+    private final String path;\n+    private Scheme scheme;\n+    private boolean updatedScheme;\n \n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@link SessionProtocol}.\n-     *\n-     * @deprecated Use {@link Clients#builder(SessionProtocol, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(SessionProtocol protocol, Endpoint endpoint) {\n-        this(null, null, requireNonNull(protocol, \"protocol\"), requireNonNull(endpoint, \"endpoint\"));\n+    ClientBuilder(URI uri) {\n+        checkArgument(uri.getScheme() != null, \"uri must have scheme: %s\", uri);\n+        checkArgument(uri.getRawAuthority() != null, \"uri must have authority: %s\", uri);\n+        this.uri = uri;\n+        endpointGroup = null;\n+        path = null;\n+        scheme = Scheme.parse(uri.getScheme());\n     }\n \n-    ClientBuilder(@Nullable URI uri, @Nullable Scheme scheme, @Nullable SessionProtocol protocol,\n-                  @Nullable EndpointGroup endpointGroup) {\n-        this.uri = uri;\n-        this.scheme = scheme;\n-        this.protocol = protocol;\n+    ClientBuilder(Scheme scheme, EndpointGroup endpointGroup, @Nullable String path) {\n+        if (path != null) {\n+            checkArgument(path.startsWith(\"/\"),\n+                          \"path: %s (expected: an absolute path starting with '/')\", path);\n+        }\n+        uri = null;\n         this.endpointGroup = endpointGroup;\n+        this.path = path;\n+        this.scheme = scheme;\n     }\n \n     /**\n-     * Sets the {@code path} of the client.\n+     * Sets the {@link SerializationFormat} of the client from the specified {@code format}.\n      */\n-    public ClientBuilder path(String path) {\n-        ensureEndpointGroup();\n-        requireNonNull(path, \"path\");\n-        checkArgument(path.startsWith(\"/\"), \"path: %s (expected: an absolute path starting with '/')\", path);\n-        this.path = path;\n-        return this;\n+    public ClientBuilder serializationFormat(String format) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA4MjIzMA=="}, "originalCommit": {"oid": "df90b0da6d7854680d0b8af5aface4893a86bdb7"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTUwNzkxOA==", "bodyText": "Done", "url": "https://github.com/line/armeria/pull/2538#discussion_r385507918", "createdAt": "2020-02-28T04:58:46Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/client/ClientBuilder.java", "diffHunk": "@@ -67,96 +66,43 @@\n     @Nullable\n     private final EndpointGroup endpointGroup;\n     @Nullable\n-    private final Scheme scheme;\n-    @Nullable\n-    private final SessionProtocol protocol;\n-    @Nullable\n-    private String path;\n-\n-    private SerializationFormat format = SerializationFormat.NONE;\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified {@code uri}.\n-     *\n-     * @deprecated Use {@link Clients#builder(String)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(String uri) {\n-        this(URI.create(requireNonNull(uri, \"uri\")));\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified {@link URI}.\n-     *\n-     * @deprecated Use {@link Clients#builder(URI)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(URI uri) {\n-        this(requireNonNull(uri, \"uri\"), null, null, null);\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@code scheme}.\n-     *\n-     * @deprecated Use {@link Clients#builder(String, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(String scheme, Endpoint endpoint) {\n-        this(Scheme.parse(requireNonNull(scheme, \"scheme\")), requireNonNull(endpoint, \"endpoint\"));\n-    }\n-\n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@link Scheme}.\n-     *\n-     * @deprecated Use {@link Clients#builder(Scheme, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(Scheme scheme, Endpoint endpoint) {\n-        this(null, requireNonNull(scheme, \"scheme\"), null, requireNonNull(endpoint, \"endpoint\"));\n-    }\n+    private final String path;\n+    private Scheme scheme;\n+    private boolean updatedScheme;\n \n-    /**\n-     * Creates a new {@link ClientBuilder} that builds the client that connects to the specified\n-     * {@link Endpoint} with the {@link SessionProtocol}.\n-     *\n-     * @deprecated Use {@link Clients#builder(SessionProtocol, EndpointGroup)}.\n-     */\n-    @Deprecated\n-    public ClientBuilder(SessionProtocol protocol, Endpoint endpoint) {\n-        this(null, null, requireNonNull(protocol, \"protocol\"), requireNonNull(endpoint, \"endpoint\"));\n+    ClientBuilder(URI uri) {\n+        checkArgument(uri.getScheme() != null, \"uri must have scheme: %s\", uri);\n+        checkArgument(uri.getRawAuthority() != null, \"uri must have authority: %s\", uri);\n+        this.uri = uri;\n+        endpointGroup = null;\n+        path = null;\n+        scheme = Scheme.parse(uri.getScheme());\n     }\n \n-    ClientBuilder(@Nullable URI uri, @Nullable Scheme scheme, @Nullable SessionProtocol protocol,\n-                  @Nullable EndpointGroup endpointGroup) {\n-        this.uri = uri;\n-        this.scheme = scheme;\n-        this.protocol = protocol;\n+    ClientBuilder(Scheme scheme, EndpointGroup endpointGroup, @Nullable String path) {\n+        if (path != null) {\n+            checkArgument(path.startsWith(\"/\"),\n+                          \"path: %s (expected: an absolute path starting with '/')\", path);\n+        }\n+        uri = null;\n         this.endpointGroup = endpointGroup;\n+        this.path = path;\n+        this.scheme = scheme;\n     }\n \n     /**\n-     * Sets the {@code path} of the client.\n+     * Sets the {@link SerializationFormat} of the client from the specified {@code format}.\n      */\n-    public ClientBuilder path(String path) {\n-        ensureEndpointGroup();\n-        requireNonNull(path, \"path\");\n-        checkArgument(path.startsWith(\"/\"), \"path: %s (expected: an absolute path starting with '/')\", path);\n-        this.path = path;\n-        return this;\n+    public ClientBuilder serializationFormat(String format) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA4MjIzMA=="}, "originalCommit": {"oid": "df90b0da6d7854680d0b8af5aface4893a86bdb7"}, "originalPosition": 109}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2704, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}