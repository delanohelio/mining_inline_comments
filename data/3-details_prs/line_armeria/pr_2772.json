{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3NjE0NjM1", "number": 2772, "title": "Apply errorprone", "bodyText": "https://errorprone.info/\nIt will be nice if we apply errorprone to avoid mistakes.", "createdAt": "2020-06-04T06:19:49Z", "url": "https://github.com/line/armeria/pull/2772", "merged": true, "mergeCommit": {"oid": "228a8ca65b8ea4f27d8019a77661b4aaed408d58"}, "closed": true, "closedAt": "2020-06-05T11:48:09Z", "author": {"login": "minwoox"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcn37aUAH2gAyNDI3NjE0NjM1OmI2MWE0MjY1MzhlNmZiYzZiOGE5OTY4M2UzNWQ1YmM3YmVkNzJlNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoROx9gFqTQyNTIyNzc0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/b61a426538e6fbc6b8a99683e35d5bc7bed72e54", "committedDate": "2020-06-04T06:18:48Z", "message": "Fix compilation error suggested by errorprone\nFound some silly mistakes as well. :smile:"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTMyMTk2", "url": "https://github.com/line/armeria/pull/2772#pullrequestreview-424132196", "createdAt": "2020-06-04T06:20:33Z", "commit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjoyMDozM1rOGe3TsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjoyMDozM1rOGe3TsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAxNjYyNQ==", "bodyText": "I think we can remove this annotation rather than suppressing where it's used. \ud83e\udd14", "url": "https://github.com/line/armeria/pull/2772#discussion_r435016625", "createdAt": "2020-06-04T06:20:33Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/common/stream/StreamWriter.java", "diffHunk": "@@ -96,7 +94,6 @@ default void write(Supplier<? extends T> o) {\n      * @throws IllegalArgumentException if the publication of the specified object has been rejected\n      * @see <a href=\"#reference-counted\">Life cycle of reference-counted objects</a>\n      */\n-    @CheckReturnValue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTM4NTQ5", "url": "https://github.com/line/armeria/pull/2772#pullrequestreview-424138549", "createdAt": "2020-06-04T06:33:48Z", "commit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTQ0MzQ4", "url": "https://github.com/line/armeria/pull/2772#pullrequestreview-424144348", "createdAt": "2020-06-04T06:44:47Z", "commit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjo0NDo0N1rOGe348Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjo0NDo0N1rOGe348Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyNjE2MQ==", "bodyText": "/cc @jrhee17 \ud83d\ude09", "url": "https://github.com/line/armeria/pull/2772#discussion_r435026161", "createdAt": "2020-06-04T06:44:47Z", "author": {"login": "trustin"}, "path": "core/src/test/java/com/linecorp/armeria/client/proxy/ProxyClientIntegrationTest.java", "diffHunk": "@@ -369,7 +369,7 @@ void testProxyWithUserName() throws Exception {\n         final String username = \"username\";\n         DYNAMIC_HANDLER.setChannelReadCustomizer((ctx, msg) -> {\n             if (msg instanceof DefaultSocks4CommandRequest) {\n-                assertThat(username.equals(((DefaultSocks4CommandRequest) msg).userId()));\n+                assertThat(username).isEqualTo(((DefaultSocks4CommandRequest) msg).userId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTQ0Nzc0", "url": "https://github.com/line/armeria/pull/2772#pullrequestreview-424144774", "createdAt": "2020-06-04T06:45:32Z", "commit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjo0NTozMlrOGe36Rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNjo0NTozMlrOGe36Rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyNjUwMw==", "bodyText": "Isn't this cast redundant?", "url": "https://github.com/line/armeria/pull/2772#discussion_r435026503", "createdAt": "2020-06-04T06:45:32Z", "author": {"login": "trustin"}, "path": "core/src/test/java/com/linecorp/armeria/server/TestConverters.java", "diffHunk": "@@ -38,7 +38,7 @@ public HttpResponse convertResponse(ServiceRequestContext ctx,\n                                             @Nullable Object result,\n                                             HttpHeaders trailers) throws Exception {\n             if (result instanceof Integer) {\n-                return httpResponse(HttpData.ofUtf8(String.format(\"Integer: %d\", result)));\n+                return httpResponse(HttpData.ofUtf8(String.format(\"Integer: %d\", (Integer) result)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MTY0OTEx", "url": "https://github.com/line/armeria/pull/2772#pullrequestreview-424164911", "createdAt": "2020-06-04T07:19:14Z", "commit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNzoxOToxNFrOGe44JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwNzoyMTo0N1rOGe49Yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA0MjM0MA==", "bodyText": "I think it's much easier to have a bug because of not checking this return value, in almost all cases the user should specially handle a closed stream right?\nFor example, here it looks like we should actually be skipping the rest of the callback if the stream is already closed\n\n  \n    \n      armeria/core/src/main/java/com/linecorp/armeria/server/healthcheck/HealthCheckService.java\n    \n    \n         Line 332\n      in\n      4f62fc0\n    \n    \n    \n    \n\n        \n          \n           res.tryWrite(ping);", "url": "https://github.com/line/armeria/pull/2772#discussion_r435042340", "createdAt": "2020-06-04T07:19:14Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/common/stream/StreamWriter.java", "diffHunk": "@@ -96,7 +94,6 @@ default void write(Supplier<? extends T> o) {\n      * @throws IllegalArgumentException if the publication of the specified object has been rejected\n      * @see <a href=\"#reference-counted\">Life cycle of reference-counted objects</a>\n      */\n-    @CheckReturnValue", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAxNjYyNQ=="}, "originalCommit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA0Mjk5OQ==", "bodyText": "These fluent assertion checks are awesome", "url": "https://github.com/line/armeria/pull/2772#discussion_r435042999", "createdAt": "2020-06-04T07:20:30Z", "author": {"login": "anuraaga"}, "path": "examples/server-sent-events/src/test/java/example/armeria/server/sse/MainTest.java", "diffHunk": "@@ -56,7 +56,7 @@ void testServerSentEvents() {\n                     .expectNext(HttpData.ofUtf8(\"data:2\\n\\n\"))\n                     .expectNext(HttpData.ofUtf8(\"data:3\\n\\n\"))\n                     .expectNext(HttpData.ofUtf8(\"data:4\\n\\n\"))\n-                    .assertNext(o -> assertThat(o.isEndOfStream()))\n+                    .assertNext(o -> assertThat(o.isEndOfStream()).isTrue())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA0MzY4Mg==", "bodyText": "In Java 14 maybe it doesn't complain? :) But yeah seems like a false positive but harmless workaround", "url": "https://github.com/line/armeria/pull/2772#discussion_r435043682", "createdAt": "2020-06-04T07:21:47Z", "author": {"login": "anuraaga"}, "path": "core/src/test/java/com/linecorp/armeria/server/TestConverters.java", "diffHunk": "@@ -38,7 +38,7 @@ public HttpResponse convertResponse(ServiceRequestContext ctx,\n                                             @Nullable Object result,\n                                             HttpHeaders trailers) throws Exception {\n             if (result instanceof Integer) {\n-                return httpResponse(HttpData.ofUtf8(String.format(\"Integer: %d\", result)));\n+                return httpResponse(HttpData.ofUtf8(String.format(\"Integer: %d\", (Integer) result)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAyNjUwMw=="}, "originalCommit": {"oid": "b61a426538e6fbc6b8a99683e35d5bc7bed72e54"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6506e13be6279b7ceec152fdf97e44a8def7e6a1", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/6506e13be6279b7ceec152fdf97e44a8def7e6a1", "committedDate": "2020-06-04T08:45:59Z", "message": "Apply errorprone"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MjQxNzc0", "url": "https://github.com/line/armeria/pull/2772#pullrequestreview-424241774", "createdAt": "2020-06-04T09:00:06Z", "commit": {"oid": "6506e13be6279b7ceec152fdf97e44a8def7e6a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwOTowMDowN1rOGe8bKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwOTowMDowN1rOGe8bKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEwMDQ1Nw==", "bodyText": "Don't we need apply false?", "url": "https://github.com/line/armeria/pull/2772#discussion_r435100457", "createdAt": "2020-06-04T09:00:07Z", "author": {"login": "ikhoon"}, "path": "build.gradle", "diffHunk": "@@ -5,6 +5,8 @@ plugins {\n     // If you want to change `org.jetbrains.kotlin.jvm` version, \n     // you also need to change `org.jetbrains.kotlin:kotlin-allopen` version in `dependencies.yml`.\n     id 'org.jetbrains.kotlin.jvm' version '1.3.72' apply false\n+\n+    id 'net.ltgt.errorprone' version '1.2.1'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6506e13be6279b7ceec152fdf97e44a8def7e6a1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MjQ5MjY3", "url": "https://github.com/line/armeria/pull/2772#pullrequestreview-424249267", "createdAt": "2020-06-04T09:09:21Z", "commit": {"oid": "6506e13be6279b7ceec152fdf97e44a8def7e6a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwOTowOToyMVrOGe8xlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwOTowOToyMVrOGe8xlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEwNjE5Ng==", "bodyText": "The default value of disableWarningsInGeneratedCode is false.\nHow about making it true for fewer noisy.", "url": "https://github.com/line/armeria/pull/2772#discussion_r435106196", "createdAt": "2020-06-04T09:09:21Z", "author": {"login": "ikhoon"}, "path": "build.gradle", "diffHunk": "@@ -69,13 +71,18 @@ task checkJavaVersion {\n \n // Configure all Java projects\n configure(projectsWithFlags('java')) {\n+    apply plugin: 'net.ltgt.errorprone'\n+\n     // Common dependencies\n     dependencies {\n         // All projects currently require ':core' (except itself)\n         if (project != project(':core')) {\n             api project(':core')\n         }\n \n+        // Error Prone compiler\n+        errorprone 'com.google.errorprone:error_prone_core'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6506e13be6279b7ceec152fdf97e44a8def7e6a1"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20be9c0d250947dd06f31bece349b60dc4daa156", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/20be9c0d250947dd06f31bece349b60dc4daa156", "committedDate": "2020-06-04T09:37:18Z", "message": "Address the comment by @ikhoon"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b5745e34e0635ac876eec885c5893237817b4b0", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/6b5745e34e0635ac876eec885c5893237817b4b0", "committedDate": "2020-06-05T08:56:49Z", "message": "Diable when noLint is specified"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MjI3NzQ4", "url": "https://github.com/line/armeria/pull/2772#pullrequestreview-425227748", "createdAt": "2020-06-05T11:47:35Z", "commit": {"oid": "6b5745e34e0635ac876eec885c5893237817b4b0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 155, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}