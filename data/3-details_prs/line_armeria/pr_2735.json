{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMTg0NDA1", "number": 2735, "title": "Fix a bug where ArmeriaHttpUtil throws NPE when failing to read versi\u2026", "bodyText": "\u2026on.properties\nMotivation:\nAccording to the order of dependency of Armeria artifacts,\nMETA-INF/com.linecorp.armeria.versions.properties is removed by Maven shade plugin.\nIf fails to read the file, Version.getAll(loader).get(\"armeria\") will return null.\nSee #2731 for more information.\nModifications:\n\nUse Version.get(\"armeria\") which returns a dummy object that contains 'unknown' version\nif fails to read version.properties.\n\nResult:\nWorkaround for #2731\nArmeriaHttpUtil does not throw NullPointerException anymore.\nTODO: We need a workaround or guide to keep versions.properties with Maven shade plugin.", "createdAt": "2020-05-21T06:54:14Z", "url": "https://github.com/line/armeria/pull/2735", "merged": true, "mergeCommit": {"oid": "cacb88d86e75e87872fe6838dc475f57222050cf"}, "closed": true, "closedAt": "2020-05-22T09:41:40Z", "author": {"login": "ikhoon"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjYEf6AH2gAyNDIxMTg0NDA1OjNkNTBmNTQ0ZDJhM2RhYmZhMjkxMGZlOTEyMmY3NTAzNDdiZmM2YWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjrliYgFqTQxNjY1OTgyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3d50f544d2a3dabfa2910fe9122f750347bfc6ae", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/3d50f544d2a3dabfa2910fe9122f750347bfc6ae", "committedDate": "2020-05-21T06:56:04Z", "message": "Fix a bug where ArmeriaHttpUtil throws NPE when failing to read version.properties\n\nMotivation:\nThe order of dependency of Armeria artifact,\n`META-INF/com.linecorp.armeria.versions.properties` is removed by Maven shade plugin.\nIf fails to read the file, `Version.getAll(loader).get(\"armeria\")` will return null.\nSee #2731 for more information.\n\nModifications:\n\n- Use Version.get(\"armeria\") which returns a dummy object that contains 'unknown' version\n  if fails to read `version.properties`\n\nResult:\nWorkaround for #2731\nArmeriaHttpUtil does not throws NullPointerException any more.\n\nTODO: We need a workaround or guide to keep versions.properties with Maven shade plugin."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eef8536498461b66687498e54fbf06f051d42b82", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/eef8536498461b66687498e54fbf06f051d42b82", "committedDate": "2020-05-21T06:53:29Z", "message": "Fix a bug where ArmeriaHttpUtil throws NPE when failing to read version.properties\n\nMotivation:\nThe order of dependency of Armeria artifact,\n`META-INF/com.linecorp.armeria.versions.properties` is removed by Maven shade plugin.\nIf fails to read the file, `Version.getAll(loader).get(\"armeria\")` will return null.\nSee #2731 for more information.\n\nModifications:\n\n- Use Version.get(\"armeria\") which returns a dummy object that contains 'unknown' version.\n\nResult:\nWorkaround for #2731\nArmeriaHttpUtil does not throws NullPointerException any more.\n\nTODO: We need a workaround or guide to keep versions.properties with Maven shade plugin."}, "afterCommit": {"oid": "3d50f544d2a3dabfa2910fe9122f750347bfc6ae", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/3d50f544d2a3dabfa2910fe9122f750347bfc6ae", "committedDate": "2020-05-21T06:56:04Z", "message": "Fix a bug where ArmeriaHttpUtil throws NPE when failing to read version.properties\n\nMotivation:\nThe order of dependency of Armeria artifact,\n`META-INF/com.linecorp.armeria.versions.properties` is removed by Maven shade plugin.\nIf fails to read the file, `Version.getAll(loader).get(\"armeria\")` will return null.\nSee #2731 for more information.\n\nModifications:\n\n- Use Version.get(\"armeria\") which returns a dummy object that contains 'unknown' version\n  if fails to read `version.properties`\n\nResult:\nWorkaround for #2731\nArmeriaHttpUtil does not throws NullPointerException any more.\n\nTODO: We need a workaround or guide to keep versions.properties with Maven shade plugin."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1OTI5MjM0", "url": "https://github.com/line/armeria/pull/2735#pullrequestreview-415929234", "createdAt": "2020-05-21T07:16:16Z", "commit": {"oid": "3d50f544d2a3dabfa2910fe9122f750347bfc6ae"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNzoxNjoxNlrOGYouGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNzoxNjoxNlrOGYouGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ4NjE2OA==", "bodyText": "How about using some regular expression to check the version number format?", "url": "https://github.com/line/armeria/pull/2735#discussion_r428486168", "createdAt": "2020-05-21T07:16:16Z", "author": {"login": "trustin"}, "path": "core/src/test/java/com/linecorp/armeria/internal/common/ArmeriaHttpUtilTest.java", "diffHunk": "@@ -500,6 +501,11 @@ void isAbsoluteUri() {\n         bad.forEach(path -> assertThat(ArmeriaHttpUtil.isAbsoluteUri(path)).isFalse());\n     }\n \n+    @Test\n+    void serverHeader() {\n+        assertThat(ArmeriaHttpUtil.SERVER_HEADER).contains(\"Armeria/\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d50f544d2a3dabfa2910fe9122f750347bfc6ae"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "019b7402cf6424a7b42a6297d1d41627e5353ed4", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/019b7402cf6424a7b42a6297d1d41627e5353ed4", "committedDate": "2020-05-21T07:27:02Z", "message": "Add regex pattern for testing version"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1OTM2MjA3", "url": "https://github.com/line/armeria/pull/2735#pullrequestreview-415936207", "createdAt": "2020-05-21T07:30:06Z", "commit": {"oid": "019b7402cf6424a7b42a6297d1d41627e5353ed4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNzozMDowN1rOGYpDaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNzozMDowN1rOGYpDaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ5MTYyNA==", "bodyText": "1.0.0 is coming soon. \ud83d\ude0e", "url": "https://github.com/line/armeria/pull/2735#discussion_r428491624", "createdAt": "2020-05-21T07:30:07Z", "author": {"login": "ikhoon"}, "path": "core/src/test/java/com/linecorp/armeria/internal/common/ArmeriaHttpUtilTest.java", "diffHunk": "@@ -500,6 +501,14 @@ void isAbsoluteUri() {\n         bad.forEach(path -> assertThat(ArmeriaHttpUtil.isAbsoluteUri(path)).isFalse());\n     }\n \n+    @Test\n+    void serverHeader() {\n+        final String pattern = \"Armeria/(\\\\d+).(\\\\d+).(\\\\d+)(-SNAPSHOT)?\";\n+        assertThat(\"Armeria/1.0.0\").containsPattern(pattern);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "019b7402cf6424a7b42a6297d1d41627e5353ed4"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NjM1MjU0", "url": "https://github.com/line/armeria/pull/2735#pullrequestreview-416635254", "createdAt": "2020-05-22T04:07:32Z", "commit": {"oid": "019b7402cf6424a7b42a6297d1d41627e5353ed4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NjU5ODIw", "url": "https://github.com/line/armeria/pull/2735#pullrequestreview-416659820", "createdAt": "2020-05-22T05:40:21Z", "commit": {"oid": "019b7402cf6424a7b42a6297d1d41627e5353ed4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 542, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}