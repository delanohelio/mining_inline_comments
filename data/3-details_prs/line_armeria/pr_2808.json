{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MjEyMDIy", "number": 2808, "title": "Fix flaky test in `ServerMaxConnectionAgeTest.http1MaxConnectionAge`", "bodyText": "Motivation:\nThere is a flaky test on CI build of Windows.\nhttps://ci.appveyor.com/project/line/armeria/builds/33590131/job/ldyjqjdblci54j2q#L58\nServerMaxConnectionAgeTest > [1] protocol=H1C FAILED\n    org.awaitility.core.ConditionTimeoutException: Assertion condition defined as a lambda expression in com.linecorp.armeria.server.ServerMaxConnectionAgeTest that uses com.linecorp.armeria.common.SessionProtocol\n    Expecting:\n      <1845.49376>\n    to be close to:\n      <1000.0>\n    by less than 25% but difference was 84.54937600000001%\n\nModifications:\n\nModify the tolerance to between 0.8 seconds to 2 seconds from the relative 25%\n\nResult:\nLess flaky", "createdAt": "2020-06-18T03:56:46Z", "url": "https://github.com/line/armeria/pull/2808", "merged": true, "mergeCommit": {"oid": "7f77877e28293d97e55aed411edd0564405448bc"}, "closed": true, "closedAt": "2020-06-18T08:31:38Z", "author": {"login": "ikhoon"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsWNXyAH2gAyNDM2MjEyMDIyOjY1YjY2ZmY1ZjcxM2Y3NjU5OTc0MmY3YmNiNTk3YjgzZjY4YTM4ZWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsZ5twgFqTQzMzAzOTkxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "65b66ff5f713f76599742f7bcb597b83f68a38ef", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/65b66ff5f713f76599742f7bcb597b83f68a38ef", "committedDate": "2020-06-18T03:51:16Z", "message": "Fix flaky test in `ServerMaxConnectionAgeTest.http1MaxConnectionAge`\n\nMotivation:\n\nThere is a flaky test on CI build of Windows.\nhttps://ci.appveyor.com/project/line/armeria/builds/33590131/job/ldyjqjdblci54j2q#L58\n\n```\nServerMaxConnectionAgeTest > [1] protocol=H1C FAILED\n    org.awaitility.core.ConditionTimeoutException: Assertion condition defined as a lambda expression in com.linecorp.armeria.server.ServerMaxConnectionAgeTest that uses com.linecorp.armeria.common.SessionProtocol\n    Expecting:\n      <1845.49376>\n    to be close to:\n      <1000.0>\n    by less than 25% but difference was 84.54937600000001%\n```\n\nModifications:\n\n* Modify the tolerance to between 0.8 seconds to 2 seconds from relative 25%\n\nResult:\n\nLess flaky"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyOTkyMTU3", "url": "https://github.com/line/armeria/pull/2808#pullrequestreview-432992157", "createdAt": "2020-06-18T07:00:20Z", "commit": {"oid": "65b66ff5f713f76599742f7bcb597b83f68a38ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwNzowMDoyMFrOGliFKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQwNzowMDoyMFrOGliFKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAwODg3NA==", "bodyText": "200.0 and 2.0 ?", "url": "https://github.com/line/armeria/pull/2808#discussion_r442008874", "createdAt": "2020-06-18T07:00:20Z", "author": {"login": "trustin"}, "path": "core/src/test/java/com/linecorp/armeria/server/ServerMaxConnectionAgeTest.java", "diffHunk": "@@ -159,13 +159,15 @@ public void connectionClosed(SessionProtocol protocol, InetSocketAddress remoteA\n                             \"armeria.server.connections.lifespan.percentile#value{phi=0,protocol=\" +\n                             protocol.uriText() + '}',\n                             value -> {\n-                                assertThat(value * 1000).isCloseTo(MAX_CONNECTION_AGE, withinPercentage(25));\n+                                assertThat(value * 1000)\n+                                        .isBetween(MAX_CONNECTION_AGE - 200D, MAX_CONNECTION_AGE * 2D);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65b66ff5f713f76599742f7bcb597b83f68a38ef"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7c6c6c9da1998123efb7c86d73783f1f6b38ee8", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/c7c6c6c9da1998123efb7c86d73783f1f6b38ee8", "committedDate": "2020-06-18T07:08:56Z", "message": "Address comments by @trustin, @minwoox"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyOTk4NTc2", "url": "https://github.com/line/armeria/pull/2808#pullrequestreview-432998576", "createdAt": "2020-06-18T07:11:10Z", "commit": {"oid": "c7c6c6c9da1998123efb7c86d73783f1f6b38ee8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01c00572cc770f171ecb7402edec774bdc21a7fe", "author": {"user": {"login": "ikhoon", "name": "Ikhun Um"}}, "url": "https://github.com/line/armeria/commit/01c00572cc770f171ecb7402edec774bdc21a7fe", "committedDate": "2020-06-18T08:01:48Z", "message": "\ud83e\udd26\u200d\u2642\ufe0f"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMDM5OTE5", "url": "https://github.com/line/armeria/pull/2808#pullrequestreview-433039919", "createdAt": "2020-06-18T08:09:25Z", "commit": {"oid": "01c00572cc770f171ecb7402edec774bdc21a7fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 231, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}