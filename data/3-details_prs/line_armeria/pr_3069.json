{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5MDg0NTYz", "number": 3069, "title": "Fix stale documents due to changed APIs", "bodyText": "I encountered two strange things while upgrading from 0.97.0 to 1.0.0.\nNot confident about partial() though.", "createdAt": "2020-09-18T05:35:17Z", "url": "https://github.com/line/armeria/pull/3069", "merged": true, "mergeCommit": {"oid": "c529585fa269311b5d62eb4adfbce783c345f994"}, "closed": true, "closedAt": "2020-09-22T02:06:11Z", "author": {"login": "wooyeong"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJ-xlxAH2gAyNDg5MDg0NTYzOjZmYWM5YTEwZjgzZDNjZGQwMTU3M2FmY2IxYTdjZDA3Y2M5NDI5MGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdK9r4YgH2gAyNDg5MDg0NTYzOjYxYTA3OWRjNTcxYzE2ZTA0NGE4Y2UyMjczOWI2ZDEzNzBlMTY5YTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6fac9a10f83d3cdd01573afcb1a7cd07cc94290a", "author": {"user": {"login": "wooyeong", "name": "Woo-Yeong Jeong"}}, "url": "https://github.com/line/armeria/commit/6fac9a10f83d3cdd01573afcb1a7cd07cc94290a", "committedDate": "2020-09-18T05:30:50Z", "message": "Fix stale documents due to changed APIs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMjA2NTg4", "url": "https://github.com/line/armeria/pull/3069#pullrequestreview-491206588", "createdAt": "2020-09-18T07:14:58Z", "commit": {"oid": "6fac9a10f83d3cdd01573afcb1a7cd07cc94290a"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNzoxNDo1OFrOHUA65w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNzoxNjo0MlrOHUA9yA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc0ODY0Nw==", "bodyText": "Could you use {@linkplain #getAll(ClassLoader) getAll(Version.class.getClassLoader())}?", "url": "https://github.com/line/armeria/pull/3069#discussion_r490748647", "createdAt": "2020-09-18T07:14:58Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/common/util/Version.java", "diffHunk": "@@ -111,7 +111,7 @@ public static Version get(String artifactId, ClassLoader classLoader) {\n \n     /**\n      * Retrieves the version information of Armeria artifacts.\n-     * This method is a shortcut for {@code identify(Version.class.getClassLoader())}.\n+     * This method is a shortcut for {@code getAll(Version.class.getClassLoader())}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fac9a10f83d3cdd01573afcb1a7cd07cc94290a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc0OTM4NA==", "bodyText": "Could you use ensureAvailable(RequestLogProperty.RESPONSE_HEADERS) instead?", "url": "https://github.com/line/armeria/pull/3069#discussion_r490749384", "createdAt": "2020-09-18T07:16:42Z", "author": {"login": "minwoox"}, "path": "site/src/pages/docs/client-retry.mdx", "diffHunk": "@@ -71,7 +71,7 @@ new RetryRule() {\n             }\n         }\n \n-        if (ctx.log().responseHeaders().status() == HttpStatus.TOO_MANY_REQUESTS) {\n+        if (ctx.log().partial().responseHeaders().status() == HttpStatus.TOO_MANY_REQUESTS) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fac9a10f83d3cdd01573afcb1a7cd07cc94290a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d373fa078a5310164aac08108efa7f450dfd734", "author": {"user": {"login": "wooyeong", "name": "Woo-Yeong Jeong"}}, "url": "https://github.com/line/armeria/commit/7d373fa078a5310164aac08108efa7f450dfd734", "committedDate": "2020-09-18T07:21:48Z", "message": "Address @minwoox's comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc7bb46fab7e97375e62788fede5d049fb189e10", "author": {"user": {"login": "wooyeong", "name": "Woo-Yeong Jeong"}}, "url": "https://github.com/line/armeria/commit/cc7bb46fab7e97375e62788fede5d049fb189e10", "committedDate": "2020-09-18T07:25:00Z", "message": "Address 2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMjMwNzU0", "url": "https://github.com/line/armeria/pull/3069#pullrequestreview-491230754", "createdAt": "2020-09-18T07:52:43Z", "commit": {"oid": "cc7bb46fab7e97375e62788fede5d049fb189e10"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMjM0MTY4", "url": "https://github.com/line/armeria/pull/3069#pullrequestreview-491234168", "createdAt": "2020-09-18T07:57:30Z", "commit": {"oid": "cc7bb46fab7e97375e62788fede5d049fb189e10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNzo1NzozMFrOHUCNMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNzo1NzozMFrOHUCNMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc2OTcxNA==", "bodyText": "could you break the line, please?\nor extract the status to a variable so that the line doesn't get too long?", "url": "https://github.com/line/armeria/pull/3069#discussion_r490769714", "createdAt": "2020-09-18T07:57:30Z", "author": {"login": "minwoox"}, "path": "site/src/pages/docs/client-retry.mdx", "diffHunk": "@@ -71,7 +71,7 @@ new RetryRule() {\n             }\n         }\n \n-        if (ctx.log().responseHeaders().status() == HttpStatus.TOO_MANY_REQUESTS) {\n+        if (ctx.log().ensureAvailable(RequestLogProperty.RESPONSE_HEADERS).responseHeaders().status() == HttpStatus.TOO_MANY_REQUESTS) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc7bb46fab7e97375e62788fede5d049fb189e10"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c58f8e8033b6f0a6c017cbc469671c7418eb7e7d", "author": {"user": {"login": "wooyeong", "name": "Woo-Yeong Jeong"}}, "url": "https://github.com/line/armeria/commit/c58f8e8033b6f0a6c017cbc469671c7418eb7e7d", "committedDate": "2020-09-18T08:36:20Z", "message": "Introduce a variable to hold `HttpStatus`"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMTk3MDQx", "url": "https://github.com/line/armeria/pull/3069#pullrequestreview-492197041", "createdAt": "2020-09-20T14:02:40Z", "commit": {"oid": "c58f8e8033b6f0a6c017cbc469671c7418eb7e7d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMFQxNDowMjo0MFrOHU6p7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMFQxNDowMzo1OFrOHU6qVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY5NDU3Mw==", "bodyText": "@link is better than @linkplain in this case because the text is code.", "url": "https://github.com/line/armeria/pull/3069#discussion_r491694573", "createdAt": "2020-09-20T14:02:40Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/common/util/Version.java", "diffHunk": "@@ -111,7 +111,7 @@ public static Version get(String artifactId, ClassLoader classLoader) {\n \n     /**\n      * Retrieves the version information of Armeria artifacts.\n-     * This method is a shortcut for {@code identify(Version.class.getClassLoader())}.\n+     * This method is a shortcut for {@linkplain #getAll(ClassLoader) getAll(Version.class.getClassLoader())}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58f8e8033b6f0a6c017cbc469671c7418eb7e7d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY5NDY3Nw==", "bodyText": "I don't think we need to do this because the response headers are always available at this point. It can be unavailable only when cause != null.", "url": "https://github.com/line/armeria/pull/3069#discussion_r491694677", "createdAt": "2020-09-20T14:03:58Z", "author": {"login": "trustin"}, "path": "site/src/pages/docs/client-retry.mdx", "diffHunk": "@@ -71,7 +71,8 @@ new RetryRule() {\n             }\n         }\n \n-        if (ctx.log().responseHeaders().status() == HttpStatus.TOO_MANY_REQUESTS) {\n+        HttpStatus status = ctx.log().ensureAvailable(RequestLogProperty.RESPONSE_HEADERS).responseHeaders().status();\n+        if (status == HttpStatus.TOO_MANY_REQUESTS) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58f8e8033b6f0a6c017cbc469671c7418eb7e7d"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61a079dc571c16e044a8ce22739b6d1370e169a5", "author": {"user": {"login": "wooyeong", "name": "Woo-Yeong Jeong"}}, "url": "https://github.com/line/armeria/commit/61a079dc571c16e044a8ce22739b6d1370e169a5", "committedDate": "2020-09-21T06:48:37Z", "message": "linkplain to link, ensureAvailable to partial"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4676, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}