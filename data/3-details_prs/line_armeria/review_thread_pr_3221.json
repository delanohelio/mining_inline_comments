{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM4MjE4NTc4", "number": 3221, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMToxMjo1MVrOFGeQrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjo0NjoyMlrOFGft7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMzMxNTY0OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/TransientService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMToxMjo1MlrOIHgJbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjowNToxM1rOIHhSxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDczNzY0NA==", "bodyText": "Should we move this to TransientHttpService?", "url": "https://github.com/line/armeria/pull/3221#discussion_r544737644", "createdAt": "2020-12-17T01:12:52Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/server/TransientService.java", "diffHunk": "@@ -31,6 +36,17 @@\n @FunctionalInterface\n public interface TransientService<I extends Request, O extends Response> extends Service<I, O> {\n \n+    /**\n+     * Returns a new {@link HttpService} decorator which makes the specified {@link HttpService} as\n+     * {@link TransientService}.\n+     */\n+    static Function<? super HttpService, SimpleDecoratingHttpService> newDecorator(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed9b76fb0d6b8b616c7bf90f585781f0d961685"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDc1NjQyMg==", "bodyText": "Ah... you are right. I thought this is an HttpService like LoggingService. \ud83d\ude05", "url": "https://github.com/line/armeria/pull/3221#discussion_r544756422", "createdAt": "2020-12-17T02:05:13Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/server/TransientService.java", "diffHunk": "@@ -31,6 +36,17 @@\n @FunctionalInterface\n public interface TransientService<I extends Request, O extends Response> extends Service<I, O> {\n \n+    /**\n+     * Returns a new {@link HttpService} decorator which makes the specified {@link HttpService} as\n+     * {@link TransientService}.\n+     */\n+    static Function<? super HttpService, SimpleDecoratingHttpService> newDecorator(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDczNzY0NA=="}, "originalCommit": {"oid": "eed9b76fb0d6b8b616c7bf90f585781f0d961685"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMzMyMTg3OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/WrappingTransientHttpService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMToxNToxOVrOIHgM3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMToxNToxOVrOIHgM3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDczODUyNg==", "bodyText": "nit: Decorates an?", "url": "https://github.com/line/armeria/pull/3221#discussion_r544738526", "createdAt": "2020-12-17T01:15:19Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/server/WrappingTransientHttpService.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2020 LINE Corporation\n+ *\n+ * LINE Corporation licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package com.linecorp.armeria.server;\n+\n+import java.util.Set;\n+\n+import com.linecorp.armeria.common.HttpRequest;\n+import com.linecorp.armeria.common.HttpResponse;\n+\n+/**\n+ * Decorated a {@link HttpService} to be treated as {@link TransientService} without inheritance.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed9b76fb0d6b8b616c7bf90f585781f0d961685"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMzMyMjA5OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/WrappingTransientRpcService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMToxNToyN1rOIHgM_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMToxNToyN1rOIHgM_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDczODU1Nw==", "bodyText": "ditto", "url": "https://github.com/line/armeria/pull/3221#discussion_r544738557", "createdAt": "2020-12-17T01:15:27Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/server/WrappingTransientRpcService.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2020 LINE Corporation\n+ *\n+ * LINE Corporation licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package com.linecorp.armeria.server;\n+\n+import java.util.Set;\n+\n+import com.linecorp.armeria.common.RpcRequest;\n+import com.linecorp.armeria.common.RpcResponse;\n+\n+/**\n+ * Decorated a {@link RpcService} to be treated as {@link TransientService} without inheritance.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed9b76fb0d6b8b616c7bf90f585781f0d961685"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMzUzOTg2OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/TransientService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjo0MDo0MVrOIHiDIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjo0MDo0MVrOIHiDIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDc2ODgwMw==", "bodyText": "Could use EnumSet such as Sets.immutableEnumSet()?\nAdd another factory method for Iterable<TransientServiceOption> transientServiceOptions?", "url": "https://github.com/line/armeria/pull/3221#discussion_r544768803", "createdAt": "2020-12-17T02:40:41Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/server/TransientService.java", "diffHunk": "@@ -31,6 +36,17 @@\n @FunctionalInterface\n public interface TransientService<I extends Request, O extends Response> extends Service<I, O> {\n \n+    /**\n+     * Returns a new {@link HttpService} decorator which makes the specified {@link HttpService} as\n+     * {@link TransientService}.\n+     */\n+    static Function<? super HttpService, SimpleDecoratingHttpService> newDecorator(\n+            TransientServiceOption... transientServiceOptions) {\n+        requireNonNull(transientServiceOptions, \"transientServiceOptions\");\n+        return delegate -> new WrappingTransientHttpService(delegate,\n+                                                            ImmutableSet.copyOf(transientServiceOptions));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed9b76fb0d6b8b616c7bf90f585781f0d961685"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMzU0OTU0OnYy", "diffSide": "RIGHT", "path": "core/src/test/java/com/linecorp/armeria/server/WrappingTransientRpcServiceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjo0NDoyMlrOIHiIVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjo0NDoyMlrOIHiIVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDc3MDEzMw==", "bodyText": "nit: A Service is not constant and FOO is not good for a service name. Just use fooService?", "url": "https://github.com/line/armeria/pull/3221#discussion_r544770133", "createdAt": "2020-12-17T02:44:22Z", "author": {"login": "ikhoon"}, "path": "core/src/test/java/com/linecorp/armeria/server/WrappingTransientRpcServiceTest.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2020 LINE Corporation\n+ *\n+ * LINE Corporation licenses this file to you under the Apache License,\n+ * version 2.0 (the \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at:\n+ *\n+ *   https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package com.linecorp.armeria.server;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import java.util.Set;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import com.linecorp.armeria.common.RpcResponse;\n+\n+class WrappingTransientRpcServiceTest {\n+\n+    static final RpcService FOO = (ctx, req) -> RpcResponse.of(\"foo\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed9b76fb0d6b8b616c7bf90f585781f0d961685"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyMzU1NDM4OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/TransientRpcService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjo0NjoyMlrOIHiK8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwMjo0NjoyMlrOIHiK8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDc3MDgwMg==", "bodyText": "Ditto\n\nUse EnumSet?\nAdd a new method that takes Iterable.", "url": "https://github.com/line/armeria/pull/3221#discussion_r544770802", "createdAt": "2020-12-17T02:46:22Z", "author": {"login": "ikhoon"}, "path": "core/src/main/java/com/linecorp/armeria/server/TransientRpcService.java", "diffHunk": "@@ -24,4 +30,15 @@\n  */\n @FunctionalInterface\n public interface TransientRpcService extends TransientService<RpcRequest, RpcResponse>, RpcService {\n+\n+    /**\n+     * Returns a new {@link RpcService} decorator which makes the specified {@link RpcService} as\n+     * {@link TransientService}.\n+     */\n+    static Function<? super RpcService, SimpleDecoratingRpcService> newDecorator(\n+            TransientServiceOption... transientServiceOptions) {\n+        requireNonNull(transientServiceOptions, \"transientServiceOptions\");\n+        return delegate -> new WrappingTransientRpcService(delegate,\n+                                                           ImmutableSet.copyOf(transientServiceOptions));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed9b76fb0d6b8b616c7bf90f585781f0d961685"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1804, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}