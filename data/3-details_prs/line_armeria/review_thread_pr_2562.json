{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MzgzNjAz", "number": 2562, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNDo0ODo1OFrODmKRXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNDo0ODo1OFrODmKRXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMzQwNzY2OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/com/linecorp/armeria/server/auth/AuthServiceBuilder.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNDo0ODo1OFrOFza4AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNjoxMTozNVrOFzbzYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ2MjAxNw==", "bodyText": "I have a question about this. Because I have changed to this to use HttpRequest only,\n(I should've done this in #2323) is there any chance that a user might not want to return different status than 401?\nIf so, I was wondering if we can guide them to use HttpResponseException or HttpStatusException.\nAnd remove these handlers and just add sort of AuthorizingStrategy with a builder, so that a user just can return true or false. \ud83e\udd14", "url": "https://github.com/line/armeria/pull/2562#discussion_r389462017", "createdAt": "2020-03-09T04:48:58Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/server/auth/AuthServiceBuilder.java", "diffHunk": "@@ -154,7 +154,7 @@ public AuthServiceBuilder onSuccess(AuthSuccessHandler<HttpRequest, HttpResponse\n      * By default, an exception thrown during authorization is logged at WARN level (if any) and a\n      * {@code 401 Unauthorized} response will be sent.\n      */\n-    public AuthServiceBuilder onFailure(AuthFailureHandler<HttpRequest, HttpResponse> failureHandler) {\n+    public AuthServiceBuilder onFailure(AuthFailureHandler failureHandler) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "878c6231fca4aeb0f786a12acf7d600de49e12a1"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ3MDQzNg==", "bodyText": "Not sure I understand the question but I don't think we need a new strategy since we have Authorizer. These handlers seem clearer to me than throwing exceptions in the authorizer to me, and should have better performance.", "url": "https://github.com/line/armeria/pull/2562#discussion_r389470436", "createdAt": "2020-03-09T05:37:16Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/server/auth/AuthServiceBuilder.java", "diffHunk": "@@ -154,7 +154,7 @@ public AuthServiceBuilder onSuccess(AuthSuccessHandler<HttpRequest, HttpResponse\n      * By default, an exception thrown during authorization is logged at WARN level (if any) and a\n      * {@code 401 Unauthorized} response will be sent.\n      */\n-    public AuthServiceBuilder onFailure(AuthFailureHandler<HttpRequest, HttpResponse> failureHandler) {\n+    public AuthServiceBuilder onFailure(AuthFailureHandler failureHandler) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ2MjAxNw=="}, "originalCommit": {"oid": "878c6231fca4aeb0f786a12acf7d600de49e12a1"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ3NDIxNw==", "bodyText": "Ah yes, I should've made it clear before I ask a question. I was sort of thinking like:\n\nChange Authorizer to AuthorizingStrategy\n\nThe new strategy can have multiple Authorizers inside to check.\n\n\nRemove AuthSuccessHandler and AuthFailureHandler.\n\nAll these changes are based on that there's not so much chance that a user wants to send a different response other than 401, but I guess not. \ud83d\ude06\nSo yes, let's keep this as it is.", "url": "https://github.com/line/armeria/pull/2562#discussion_r389474217", "createdAt": "2020-03-09T05:57:36Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/server/auth/AuthServiceBuilder.java", "diffHunk": "@@ -154,7 +154,7 @@ public AuthServiceBuilder onSuccess(AuthSuccessHandler<HttpRequest, HttpResponse\n      * By default, an exception thrown during authorization is logged at WARN level (if any) and a\n      * {@code 401 Unauthorized} response will be sent.\n      */\n-    public AuthServiceBuilder onFailure(AuthFailureHandler<HttpRequest, HttpResponse> failureHandler) {\n+    public AuthServiceBuilder onFailure(AuthFailureHandler failureHandler) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ2MjAxNw=="}, "originalCommit": {"oid": "878c6231fca4aeb0f786a12acf7d600de49e12a1"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ3NzIxNg==", "bodyText": "Found the issue for this. #506", "url": "https://github.com/line/armeria/pull/2562#discussion_r389477216", "createdAt": "2020-03-09T06:11:35Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/server/auth/AuthServiceBuilder.java", "diffHunk": "@@ -154,7 +154,7 @@ public AuthServiceBuilder onSuccess(AuthSuccessHandler<HttpRequest, HttpResponse\n      * By default, an exception thrown during authorization is logged at WARN level (if any) and a\n      * {@code 401 Unauthorized} response will be sent.\n      */\n-    public AuthServiceBuilder onFailure(AuthFailureHandler<HttpRequest, HttpResponse> failureHandler) {\n+    public AuthServiceBuilder onFailure(AuthFailureHandler failureHandler) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ2MjAxNw=="}, "originalCommit": {"oid": "878c6231fca4aeb0f786a12acf7d600de49e12a1"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2748, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}