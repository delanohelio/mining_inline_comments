{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3MTgwNDIw", "number": 2515, "title": "Make `RequestContextExporter` capable of exporting request ID", "bodyText": "Motivation:\nRequestContextExportor did not have BuiltInProperty for request ID.\nModification:\n\nAdd BuiltInProperty.REQ_ID and export it if necessary.\n\nResult:\n\nFixes #2511", "createdAt": "2020-02-19T13:48:53Z", "url": "https://github.com/line/armeria/pull/2515", "merged": true, "mergeCommit": {"oid": "25a5e751f470e38bb86720f7a77c5b3cd531d882"}, "closed": true, "closedAt": "2020-02-20T14:37:12Z", "author": {"login": "JunoJunho"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcF20koAH2gAyMzc3MTgwNDIwOmFiNTA1YTMyNTE2ZGM0MjdlNDQyNjU0MDk2Y2Q0MGM3YzBlNjBlZGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGMGIRgH2gAyMzc3MTgwNDIwOmFkZTA0OTcwOGMxNzczZDFiOTEyNTdjMzNmODdlNzRhM2NhNWI2ZWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ab505a32516dc427e442654096cd40c7c0e60edd", "author": {"user": {"login": "JunoJunho", "name": "Junho Kim"}}, "url": "https://github.com/line/armeria/commit/ab505a32516dc427e442654096cd40c7c0e60edd", "committedDate": "2020-02-19T13:48:00Z", "message": "Exporting request_id into RequestContextExporter\n\nMotivation:\nRequestContextExportor did not have export for req.id\n\nModification:\n\n - Introduce REQ_ID into BuiltInProperty\n - Introduce method for REQ_ID\n - Update test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMTIzMjc2", "url": "https://github.com/line/armeria/pull/2515#pullrequestreview-361123276", "createdAt": "2020-02-19T13:50:02Z", "commit": {"oid": "ab505a32516dc427e442654096cd40c7c0e60edd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1MDowMlrOFrowcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1MDowMlrOFrowcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMwMDg1MA==", "bodyText": "Please address about this ctx.id().text()\nRequestId class also has shortText() for human-readable. I think later one is better, but this can make people confuse if two id is nearly same.", "url": "https://github.com/line/armeria/pull/2515#discussion_r381300850", "createdAt": "2020-02-19T13:50:02Z", "author": {"login": "JunoJunho"}, "path": "core/src/main/java/com/linecorp/armeria/common/logging/RequestContextExporter.java", "diffHunk": "@@ -423,6 +427,10 @@ private static String getAuthority(RequestContext ctx, HttpHeaders headers) {\n         return null;\n     }\n \n+    private static void exportId(Map<String, String> out, RequestContext ctx) {\n+        putBuiltInProperty(out, REQ_ID, ctx.id().text());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab505a32516dc427e442654096cd40c7c0e60edd"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMTI3ODAw", "url": "https://github.com/line/armeria/pull/2515#pullrequestreview-361127800", "createdAt": "2020-02-19T13:56:06Z", "commit": {"oid": "ab505a32516dc427e442654096cd40c7c0e60edd"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1NjowNlrOFro-IA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMzo1NjowNlrOFro-IA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMwNDM1Mg==", "bodyText": "I'd lean towards using full, not human readable. This is often used for searching logs based on the ID so precision is nice.", "url": "https://github.com/line/armeria/pull/2515#discussion_r381304352", "createdAt": "2020-02-19T13:56:06Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/common/logging/RequestContextExporter.java", "diffHunk": "@@ -423,6 +427,10 @@ private static String getAuthority(RequestContext ctx, HttpHeaders headers) {\n         return null;\n     }\n \n+    private static void exportId(Map<String, String> out, RequestContext ctx) {\n+        putBuiltInProperty(out, REQ_ID, ctx.id().text());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMwMDg1MA=="}, "originalCommit": {"oid": "ab505a32516dc427e442654096cd40c7c0e60edd"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNjQ4Mzk5", "url": "https://github.com/line/armeria/pull/2515#pullrequestreview-361648399", "createdAt": "2020-02-20T05:55:47Z", "commit": {"oid": "ab505a32516dc427e442654096cd40c7c0e60edd"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNTo1NTo0N1rOFsGLAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQwNTo1NTo0N1rOFsGLAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTc4Mjc4NA==", "bodyText": "{@code \"req.id\"} - the request ID. ?", "url": "https://github.com/line/armeria/pull/2515#discussion_r381782784", "createdAt": "2020-02-20T05:55:47Z", "author": {"login": "trustin"}, "path": "core/src/main/java/com/linecorp/armeria/common/logging/BuiltInProperty.java", "diffHunk": "@@ -90,6 +90,10 @@\n      * The port number is omitted when it is same with the default port number of the current {@link Scheme}.\n      */\n     REQ_AUTHORITY(\"req.authority\"),\n+    /**\n+     * {@code \"req.id\"} - the id of the request.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab505a32516dc427e442654096cd40c7c0e60edd"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39c21a93a7326b4ba45f91c34a26377d33632a58", "author": {"user": {"login": "JunoJunho", "name": "Junho Kim"}}, "url": "https://github.com/line/armeria/commit/39c21a93a7326b4ba45f91c34a26377d33632a58", "committedDate": "2020-02-20T13:05:20Z", "message": "Update test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxODg5OTUz", "url": "https://github.com/line/armeria/pull/2515#pullrequestreview-361889953", "createdAt": "2020-02-20T13:15:40Z", "commit": {"oid": "39c21a93a7326b4ba45f91c34a26377d33632a58"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ade049708c1773d1b91257c33f87e74a3ca5b6ea", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/ade049708c1773d1b91257c33f87e74a3ca5b6ea", "committedDate": "2020-02-20T14:35:11Z", "message": "Update BuiltInProperty.java"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 577, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}