{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4NjUwODU0", "number": 3202, "title": "Use `ClassValue` for the map whose key is `Class`", "bodyText": "Close #3138", "createdAt": "2020-11-27T14:42:34Z", "url": "https://github.com/line/armeria/pull/3202", "merged": true, "mergeCommit": {"oid": "3c181d8c708e7fdef6aab80e5417958bffda00ff"}, "closed": true, "closedAt": "2020-11-30T03:27:31Z", "author": {"login": "minwoox"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgonRzgH2gAyNTI4NjUwODU0OmY1MzM2NTUwNTg0MzUwODZhMmQ5MmExNzBmZWU2ZTI4M2U0OTQ5MjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhcwKWgFqTU0MDU3ODAwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f533655058435086a2d92a170fee6e283e494920", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/f533655058435086a2d92a170fee6e283e494920", "committedDate": "2020-11-27T14:41:55Z", "message": "Use weakKeys for the map whose key is a `Class`\nClose #3138"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93a702e02b1f57474aaea503de3a3a118a7ba669", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/93a702e02b1f57474aaea503de3a3a118a7ba669", "committedDate": "2020-11-27T14:45:44Z", "message": "Reorder static fields"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMDMyNzgz", "url": "https://github.com/line/armeria/pull/3202#pullrequestreview-540032783", "createdAt": "2020-11-27T14:49:04Z", "commit": {"oid": "93a702e02b1f57474aaea503de3a3a118a7ba669"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMjIxNTEz", "url": "https://github.com/line/armeria/pull/3202#pullrequestreview-540221513", "createdAt": "2020-11-28T02:20:01Z", "commit": {"oid": "93a702e02b1f57474aaea503de3a3a118a7ba669"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOFQwMjoyMDowMVrOH7L52A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOFQwMjoyMDowMVrOH7L52A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTgyMzA2NA==", "bodyText": "By the way maybe for a separate PR but I recently learned of ClassValue\nhttps://docs.oracle.com/javase/7/docs/api/java/lang/ClassValue.html\nIt's like a map from class to value, but handled natively by Java with optimal performance.", "url": "https://github.com/line/armeria/pull/3202#discussion_r531823064", "createdAt": "2020-11-28T02:20:01Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/internal/server/annotation/AnnotatedServiceFactory.java", "diffHunk": "@@ -136,7 +136,7 @@\n     /**\n      * An instance map for reusing converters, exception handlers and decorators.\n      */\n-    private static final ConcurrentMap<Class<?>, Object> instanceCache = new ConcurrentHashMap<>();\n+    private static final ConcurrentMap<Class<?>, Object> instanceCache = new MapMaker().weakKeys().makeMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93a702e02b1f57474aaea503de3a3a118a7ba669"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b55428a6eae46f7143eab23026f13a0f66651c1", "author": {"user": {"login": "minwoox", "name": "minux"}}, "url": "https://github.com/line/armeria/commit/8b55428a6eae46f7143eab23026f13a0f66651c1", "committedDate": "2020-11-28T13:51:33Z", "message": "Use ClassValue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNTc4MDA2", "url": "https://github.com/line/armeria/pull/3202#pullrequestreview-540578006", "createdAt": "2020-11-30T03:26:41Z", "commit": {"oid": "8b55428a6eae46f7143eab23026f13a0f66651c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4867, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}