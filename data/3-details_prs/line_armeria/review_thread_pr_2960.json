{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYxMjk1NzQw", "number": 2960, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMjozMzowN1rOEUcthQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMjozODowNFrOEUcwPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5ODc3MzgxOnYy", "diffSide": "RIGHT", "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMjozMzowN1rOG6qX6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQwMzo0NDo0N1rOG7P_yA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NDg0Mw==", "bodyText": "If fails to find DocServiceConfigurator, how about calling configureArmeriaService(sb, settings)?", "url": "https://github.com/line/armeria/pull/2960#discussion_r464164843", "createdAt": "2020-08-03T02:33:07Z", "author": {"login": "ikhoon"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "diffHunk": "@@ -192,9 +193,13 @@ public WebServer getWebServer(HttpHandler httpHandler) {\n                                                   Ints.saturatedCast(minResponseSize)));\n         }\n \n+        final DocServiceBuilder docServiceBuilder = DocService.builder();\n+        findBeans(DocServiceConfigurator.class).forEach(\n+                configurator -> configurator.configure(docServiceBuilder));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NTA4Mw==", "bodyText": "Is it possible to add a test case for DocServiceConfigurator to prevent future mistakes?", "url": "https://github.com/line/armeria/pull/2960#discussion_r464165083", "createdAt": "2020-08-03T02:34:14Z", "author": {"login": "ikhoon"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "diffHunk": "@@ -192,9 +193,13 @@ public WebServer getWebServer(HttpHandler httpHandler) {\n                                                   Ints.saturatedCast(minResponseSize)));\n         }\n \n+        final DocServiceBuilder docServiceBuilder = DocService.builder();\n+        findBeans(DocServiceConfigurator.class).forEach(\n+                configurator -> configurator.configure(docServiceBuilder));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NDg0Mw=="}, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDYzMTYwNg==", "bodyText": "If fails to find DocServiceConfigurator, how about calling configureArmeriaService(sb, settings)?\n\nCould you explain it in more detail?\nI referred to ArmeriaAutoConfiguration.", "url": "https://github.com/line/armeria/pull/2960#discussion_r464631606", "createdAt": "2020-08-03T20:00:06Z", "author": {"login": "matsumana"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "diffHunk": "@@ -192,9 +193,13 @@ public WebServer getWebServer(HttpHandler httpHandler) {\n                                                   Ints.saturatedCast(minResponseSize)));\n         }\n \n+        final DocServiceBuilder docServiceBuilder = DocService.builder();\n+        findBeans(DocServiceConfigurator.class).forEach(\n+                configurator -> configurator.configure(docServiceBuilder));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NDg0Mw=="}, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc1MzA1Mg==", "bodyText": "My explanation was not enough. \ud83d\ude05 What I meant was:\nList<DocServiceConfigurator> docServiceConfigurators = findBeans(DocServiceConfigurator.class);\nif (docServiceConfigurators.isEmpty()) {\n   configureArmeriaService(sb, settings);\n} else {\n   final DocServiceBuilder docServiceBuilder = DocService.builder();\n   docServiceConfigurators.forEach(\n       ... // Same as you did \n   );\n}", "url": "https://github.com/line/armeria/pull/2960#discussion_r464753052", "createdAt": "2020-08-04T01:53:26Z", "author": {"login": "ikhoon"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "diffHunk": "@@ -192,9 +193,13 @@ public WebServer getWebServer(HttpHandler httpHandler) {\n                                                   Ints.saturatedCast(minResponseSize)));\n         }\n \n+        final DocServiceBuilder docServiceBuilder = DocService.builder();\n+        findBeans(DocServiceConfigurator.class).forEach(\n+                configurator -> configurator.configure(docServiceBuilder));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NDg0Mw=="}, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc3NjU4Mg==", "bodyText": "Thank you for your explanation.\nI need to pass DocServiceBuilder to configureArmeriaService if I can find DocServiceConfigurator.\nYou mean that would it be better to create overload method like the following?\nfinal ArmeriaSettings settings = findBean(ArmeriaSettings.class);\nif (settings != null) {\n    final List<DocServiceConfigurator> docServiceConfigurators =\n            findBeans(DocServiceConfigurator.class);\n    if (docServiceConfigurators.isEmpty()) {\n        configureArmeriaService(sb, settings);\n    } else {\n        final DocServiceBuilder docServiceBuilder = DocService.builder();\n        configureArmeriaService(sb, docServiceBuilder, settings);\n        docServiceConfigurators.forEach(configurator -> configurator.configure(docServiceBuilder));\n    }\n}\n\nprivate void configureArmeriaService(ServerBuilder sb, ArmeriaSettings settings) {\n    final DocServiceBuilder docServiceBuilder = DocService.builder();\n    configureArmeriaService(sb, docServiceBuilder, settings);\n}\n\nprivate void configureArmeriaService(ServerBuilder sb, DocServiceBuilder docServiceBuilder,\n                                        ArmeriaSettings settings) {\n    ...\n}", "url": "https://github.com/line/armeria/pull/2960#discussion_r464776582", "createdAt": "2020-08-04T03:25:54Z", "author": {"login": "matsumana"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "diffHunk": "@@ -192,9 +193,13 @@ public WebServer getWebServer(HttpHandler httpHandler) {\n                                                   Ints.saturatedCast(minResponseSize)));\n         }\n \n+        final DocServiceBuilder docServiceBuilder = DocService.builder();\n+        findBeans(DocServiceConfigurator.class).forEach(\n+                configurator -> configurator.configure(docServiceBuilder));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NDg0Mw=="}, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc4MDI0MQ==", "bodyText": "The current code looks OK to me.  DocService has to be built even if there are no DocServiceConfigurator, so there's no point of handling the case of empty list specially.", "url": "https://github.com/line/armeria/pull/2960#discussion_r464780241", "createdAt": "2020-08-04T03:40:28Z", "author": {"login": "trustin"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "diffHunk": "@@ -192,9 +193,13 @@ public WebServer getWebServer(HttpHandler httpHandler) {\n                                                   Ints.saturatedCast(minResponseSize)));\n         }\n \n+        final DocServiceBuilder docServiceBuilder = DocService.builder();\n+        findBeans(DocServiceConfigurator.class).forEach(\n+                configurator -> configurator.configure(docServiceBuilder));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NDg0Mw=="}, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc4MDU4Ng==", "bodyText": "Let me mark this thread as resolved. No change is necessary.", "url": "https://github.com/line/armeria/pull/2960#discussion_r464780586", "createdAt": "2020-08-04T03:41:56Z", "author": {"login": "trustin"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "diffHunk": "@@ -192,9 +193,13 @@ public WebServer getWebServer(HttpHandler httpHandler) {\n                                                   Ints.saturatedCast(minResponseSize)));\n         }\n \n+        final DocServiceBuilder docServiceBuilder = DocService.builder();\n+        findBeans(DocServiceConfigurator.class).forEach(\n+                configurator -> configurator.configure(docServiceBuilder));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NDg0Mw=="}, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc4MTI1Ng==", "bodyText": "Sorry for the wrong direction. \ud83d\ude2d I thought configureArmeriaService is an API that is outside of this code.\nPlease ignore this review. Your code was good from the start! \ud83d\ude47\u200d\u2642\ufe0f", "url": "https://github.com/line/armeria/pull/2960#discussion_r464781256", "createdAt": "2020-08-04T03:44:47Z", "author": {"login": "ikhoon"}, "path": "spring/boot2-webflux-autoconfigure/src/main/java/com/linecorp/armeria/spring/web/reactive/ArmeriaReactiveWebServerFactory.java", "diffHunk": "@@ -192,9 +193,13 @@ public WebServer getWebServer(HttpHandler httpHandler) {\n                                                   Ints.saturatedCast(minResponseSize)));\n         }\n \n+        final DocServiceBuilder docServiceBuilder = DocService.builder();\n+        findBeans(DocServiceConfigurator.class).forEach(\n+                configurator -> configurator.configure(docServiceBuilder));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NDg0Mw=="}, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5ODc4MDc2OnYy", "diffSide": "RIGHT", "path": "spring/boot2-webflux-autoconfigure/build.gradle", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMjozODowNFrOG6qb2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMjo0MDo0OFrOG6qeBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NTg0OA==", "bodyText": "Could you include ArmeriaBeanPostProcessorConfiguration by changing\ninclude '**/*ArmeriaBeanPostProcessor.java' to include '**/*ArmeriaBeanPostProcessor*.java'\nplease?", "url": "https://github.com/line/armeria/pull/2960#discussion_r464165848", "createdAt": "2020-08-03T02:38:04Z", "author": {"login": "minwoox"}, "path": "spring/boot2-webflux-autoconfigure/build.gradle", "diffHunk": "@@ -37,6 +37,7 @@ task generateSources(type: Copy) {\n     include '**/ArmeriaServerConfigurator.java'\n     include '**/ArmeriaSettings.java'\n     include '**/CustomAlias*KeyManager*.java'\n+    include '**/DocServiceConfigurator.java'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NjQwNw==", "bodyText": "Also could group the classes with the package so that we can easily recognize what we missed please?\nlike:\n// Copy from /internal/spring package.\ninclude '**/ArmeriaConfigurationNetUtil.java'\ninclude '**/ArmeriaConfigurationUtil.java'\ninclude '**/CustomAlias*KeyManager*.java'\n\n// Copy from /spring package.", "url": "https://github.com/line/armeria/pull/2960#discussion_r464166407", "createdAt": "2020-08-03T02:40:48Z", "author": {"login": "minwoox"}, "path": "spring/boot2-webflux-autoconfigure/build.gradle", "diffHunk": "@@ -37,6 +37,7 @@ task generateSources(type: Copy) {\n     include '**/ArmeriaServerConfigurator.java'\n     include '**/ArmeriaSettings.java'\n     include '**/CustomAlias*KeyManager*.java'\n+    include '**/DocServiceConfigurator.java'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE2NTg0OA=="}, "originalCommit": {"oid": "c84c55db9daf415ba39162c381443760b2f5eda1"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2166, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}