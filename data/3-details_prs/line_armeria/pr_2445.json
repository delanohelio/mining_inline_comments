{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwMjYwNjEz", "number": 2445, "title": "Add `UnstableApi` annotation and hide some internal classes", "bodyText": "See: #2360\n\nAdded the UnstableApi annotation to indicate unstable API.\nAnnotated some classes and packages with the UnstableApi annotation.\nHid TimeoutController and DefaultRequestLog from the public API\nMiscellaneous:\n\nRemoved deprecated onDemand() calls.\nMoved Tomcat protocol handler and buffers to internal", "createdAt": "2020-02-03T11:13:22Z", "url": "https://github.com/line/armeria/pull/2445", "merged": true, "mergeCommit": {"oid": "e3d18350b6062cc6a6ed5bd27c16db2c67c7ead0"}, "closed": true, "closedAt": "2020-02-05T01:55:43Z", "author": {"login": "trustin"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcAq_pigH2gAyMzcwMjYwNjEzOjU1MGZjMzA4NTJmM2QyOWFiYjI5MzgxNDliYWFlOGY1YTI4MDc1MWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBAKHFgH2gAyMzcwMjYwNjEzOjRlMDg3MGVmNzcxZmI2OWJjZmNlNWYwMGI3MDA1NWVlODVkM2FiZTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "550fc30852f3d29abb2938149baae8f5a280751e", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/550fc30852f3d29abb2938149baae8f5a280751e", "committedDate": "2020-02-03T11:11:37Z", "message": "Add `UnstableApi` annotation and hide `DefaultRequestLog`\n\nSee: #2360\n\n- Added the `UnstableApi` annotation to indicate unstable API.\n- Annotated some classes and packages with the `UnstableApi` annotation."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMjAwMTcz", "url": "https://github.com/line/armeria/pull/2445#pullrequestreview-352200173", "createdAt": "2020-02-03T11:53:32Z", "commit": {"oid": "550fc30852f3d29abb2938149baae8f5a280751e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMjE4NDYz", "url": "https://github.com/line/armeria/pull/2445#pullrequestreview-352218463", "createdAt": "2020-02-03T12:29:59Z", "commit": {"oid": "550fc30852f3d29abb2938149baae8f5a280751e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMjoyOTo1OVrOFkvxVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMjoyOTo1OVrOFkvxVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDA3NTczNQ==", "bodyText": "nit: 2020. \ud83d\ude06", "url": "https://github.com/line/armeria/pull/2445#discussion_r374075735", "createdAt": "2020-02-03T12:29:59Z", "author": {"login": "minwoox"}, "path": "core/src/main/java/com/linecorp/armeria/common/util/UnstableApi.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Copyright 2019 LINE Corporation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "550fc30852f3d29abb2938149baae8f5a280751e"}, "originalPosition": 2}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fba0501432d3d67a5d2042094cbe5ac3c8e2b9a", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/9fba0501432d3d67a5d2042094cbe5ac3c8e2b9a", "committedDate": "2020-02-03T13:21:26Z", "message": "Time travel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ccadd7c5de0b7a757d6993fb30932b5ccc9f169", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/4ccadd7c5de0b7a757d6993fb30932b5ccc9f169", "committedDate": "2020-02-03T13:23:40Z", "message": "Merge branch 'master' into unstable_api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7842904f37d02242aa9670679039ef1eb9d3ce2", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/d7842904f37d02242aa9670679039ef1eb9d3ce2", "committedDate": "2020-02-03T13:28:54Z", "message": "Merge branch 'master' into unstable_api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86bed0f213b3279e1e0fded5ca9a3855e08d9379", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/86bed0f213b3279e1e0fded5ca9a3855e08d9379", "committedDate": "2020-02-03T13:46:36Z", "message": "Once more unstable API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d1ad1a407b560aa1956163f3b490326f39aea66", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/0d1ad1a407b560aa1956163f3b490326f39aea66", "committedDate": "2020-02-04T02:59:04Z", "message": "Mark intermediary `StreamMessage` implementations as unstable\n\nAlso removed deprecated `onDemand()` calls."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNjk5ODUw", "url": "https://github.com/line/armeria/pull/2445#pullrequestreview-352699850", "createdAt": "2020-02-04T03:04:59Z", "commit": {"oid": "0d1ad1a407b560aa1956163f3b490326f39aea66"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/b5f948b2344fcf0849cce53e572ca3045c9f688b", "committedDate": "2020-02-04T03:15:53Z", "message": "Mark `DefaultStreamMessageDuplicator` as unstable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNzIyMTgw", "url": "https://github.com/line/armeria/pull/2445#pullrequestreview-352722180", "createdAt": "2020-02-04T04:47:40Z", "commit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNDo0Nzo0MFrOFlH_0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNDo1Mzo1MVrOFlIEQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ3MjY1Ng==", "bodyText": "Does this effectively mean we only officially support our official client implementations, and user-created custom ones may potentially have breaking changes? I'm ok with either but we may want to document that explicitly (I lean towards not marking this unstable though it seems pretty well-baked).", "url": "https://github.com/line/armeria/pull/2445#discussion_r374472656", "createdAt": "2020-02-04T04:47:40Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/client/ClientFactoryProvider.java", "diffHunk": "@@ -17,10 +17,12 @@\n package com.linecorp.armeria.client;\n \n import com.linecorp.armeria.common.SerializationFormat;\n+import com.linecorp.armeria.common.util.UnstableApi;\n \n /**\n  * Creates a new {@link ClientFactory} dynamically via Java SPI (Service Provider Interface).\n  */\n+@UnstableApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ3Mjc2MA==", "bodyText": "Just want to confirm, I think it's possible to hide some of these completely, is the idea to mark as unstable first and then hide later?", "url": "https://github.com/line/armeria/pull/2445#discussion_r374472760", "createdAt": "2020-02-04T04:48:15Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/client/DefaultClientRequestContext.java", "diffHunk": "@@ -67,6 +67,7 @@\n /**\n  * Default {@link ClientRequestContext} implementation.\n  */\n+@UnstableApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ3MzA3NA==", "bodyText": "This is already in internal package", "url": "https://github.com/line/armeria/pull/2445#discussion_r374473074", "createdAt": "2020-02-04T04:49:50Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/internal/annotation/AnnotatedDocServicePlugin.java", "diffHunk": "@@ -80,6 +81,7 @@\n /**\n  * A {@link DocServicePlugin} implementation that supports the {@link AnnotatedService}.\n  */\n+@UnstableApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ3MzI0MQ==", "bodyText": "Should we add to docs/package-inf.java?", "url": "https://github.com/line/armeria/pull/2445#discussion_r374473241", "createdAt": "2020-02-04T04:50:45Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/server/docs/DocServicePlugin.java", "diffHunk": "@@ -24,12 +24,14 @@\n import com.google.common.collect.ImmutableMap;\n import com.google.common.collect.ImmutableSet;\n \n+import com.linecorp.armeria.common.util.UnstableApi;\n import com.linecorp.armeria.server.Service;\n import com.linecorp.armeria.server.ServiceConfig;\n \n /**\n  * Generates the {@link ServiceSpecification}s of the supported {@link Service}s.\n  */\n+@UnstableApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ3MzUyNQ==", "bodyText": "Do we also need to add to the classes? (I noticed we did in grpc-protocol)", "url": "https://github.com/line/armeria/pull/2445#discussion_r374473525", "createdAt": "2020-02-04T04:52:16Z", "author": {"login": "anuraaga"}, "path": "core/src/main/java/com/linecorp/armeria/unsafe/package-info.java", "diffHunk": "@@ -13,14 +13,14 @@\n  * License for the specific language governing permissions and limitations\n  * under the License.\n  */\n-\n /**\n  * Utilities for working with {@link io.netty.buffer.ByteBuf} in an unsafe way. These can improve performance\n  * when dealing with large buffers but require careful memory management or there will be memory leaks. Only use\n  * these methods if you really know what you're doing.\n  */\n-\n+@UnstableApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ3MzYyMw==", "bodyText": "Guess we should move to internal package", "url": "https://github.com/line/armeria/pull/2445#discussion_r374473623", "createdAt": "2020-02-04T04:52:52Z", "author": {"login": "anuraaga"}, "path": "grpc/src/main/java/com/linecorp/armeria/server/grpc/GrpcDocServicePlugin.java", "diffHunk": "@@ -74,6 +75,7 @@\n /**\n  * {@link DocServicePlugin} implementation that supports {@link GrpcService}s.\n  */\n+@UnstableApi\n public final class GrpcDocServicePlugin implements DocServicePlugin {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ3MzY4OQ==", "bodyText": "I wonder if it's ok for SPI implementations to be in internal package I guess so", "url": "https://github.com/line/armeria/pull/2445#discussion_r374473689", "createdAt": "2020-02-04T04:53:17Z", "author": {"login": "anuraaga"}, "path": "grpc/src/main/java/com/linecorp/armeria/client/grpc/GrpcClientFactoryProvider.java", "diffHunk": "@@ -18,10 +18,12 @@\n \n import com.linecorp.armeria.client.ClientFactory;\n import com.linecorp.armeria.client.ClientFactoryProvider;\n+import com.linecorp.armeria.common.util.UnstableApi;\n \n /**\n  * {@link ClientFactoryProvider} that creates a {@link GrpcClientFactory}.\n  */\n+@UnstableApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ3Mzc5NA==", "bodyText": "Is it worth having both UnstableApi and Internal to separate what definitely won't ever be stable?", "url": "https://github.com/line/armeria/pull/2445#discussion_r374473794", "createdAt": "2020-02-04T04:53:51Z", "author": {"login": "anuraaga"}, "path": "tomcat/src/main/java/com/linecorp/armeria/server/tomcat/Tomcat90ProtocolHandler.java", "diffHunk": "@@ -28,10 +28,13 @@\n import org.apache.coyote.UpgradeProtocol;\n import org.apache.tomcat.util.net.SSLHostConfig;\n \n+import com.linecorp.armeria.common.util.UnstableApi;\n+\n /**\n  * A {@link ProtocolHandler} for Tomcat 8.5 and above.\n  * Do not use; loaded and instantiated by Tomcat via reflection.\n  */\n+@UnstableApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f948b2344fcf0849cce53e572ca3045c9f688b"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7d214424c51db78c1cc78b7a7b759cb9f4404c3", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/c7d214424c51db78c1cc78b7a7b759cb9f4404c3", "committedDate": "2020-02-04T09:05:40Z", "message": "Merge branch 'master' into unstable_api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a02abe8fc58e0cc1fdd42ee738bff3a77ac64ea7", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/a02abe8fc58e0cc1fdd42ee738bff3a77ac64ea7", "committedDate": "2020-02-04T09:16:16Z", "message": "Remove unnecessary `UnstableApi` annotation in `AnnotatedDocServicePlugin`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56f7c847fb6da0b8cb98e57fd72b3a5f1741868d", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/56f7c847fb6da0b8cb98e57fd72b3a5f1741868d", "committedDate": "2020-02-04T09:19:28Z", "message": "Move Tomcat protocol handler and buffers to internal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4aec1b4c2ed17b41b58fc9d9bda1ca4cc0253d9b", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/4aec1b4c2ed17b41b58fc9d9bda1ca4cc0253d9b", "committedDate": "2020-02-04T09:45:02Z", "message": "Move another Tomcat internal class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e0870ef771fb69bcfce5f00b70055ee85d3abe6", "author": {"user": {"login": "trustin", "name": "Trustin Lee"}}, "url": "https://github.com/line/armeria/commit/4e0870ef771fb69bcfce5f00b70055ee85d3abe6", "committedDate": "2020-02-04T11:51:03Z", "message": "Hide `TimeoutController` from the public API"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 941, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}