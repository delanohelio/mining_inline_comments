{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0NDExMzc4", "number": 871, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjo1MjowNVrOEufJxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxNToxMTo1M1rOEukdCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3MTgwMzU5OnYy", "diffSide": "RIGHT", "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjo1MjowNVrOHi7EhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMzowMjo0N1rOHi7l8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM4MTQ0NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    logs = logs.recordPackage(ContainerExecDecorator.class, Level.FINEST);\n          \n          \n            \n                    logs.recordPackage(ContainerExecDecorator.class, Level.FINEST);\n          \n      \n    \n    \n  \n\n(only has a return value for fluid syntax)", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/871#discussion_r506381445", "createdAt": "2020-10-16T12:52:05Z", "author": {"login": "jglick"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "diffHunk": "@@ -95,6 +95,7 @@ public void setUp() throws Exception {\n         deletePods(cloud.connect(), getLabels(cloud, this, name), false);\n         warnings.record(\"\", Level.WARNING).capture(1000);\n         assertNotNull(createJobThenScheduleRun());\n+        logs = logs.recordPackage(ContainerExecDecorator.class, Level.FINEST);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fededad5e8df8a0ece6777fde8bc11db6bc8e35a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM5MDAwMQ==", "bodyText": "Ah, need to revert this line, It becomes too verbose for what Jenkins collects. Was useful to debug though.", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/871#discussion_r506390001", "createdAt": "2020-10-16T13:02:47Z", "author": {"login": "Vlatombe"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "diffHunk": "@@ -95,6 +95,7 @@ public void setUp() throws Exception {\n         deletePods(cloud.connect(), getLabels(cloud, this, name), false);\n         warnings.record(\"\", Level.WARNING).capture(1000);\n         assertNotNull(createJobThenScheduleRun());\n+        logs = logs.recordPackage(ContainerExecDecorator.class, Level.FINEST);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM4MTQ0NQ=="}, "originalCommit": {"oid": "fededad5e8df8a0ece6777fde8bc11db6bc8e35a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3MTgwNjEyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjo1MjoyOVrOHi7GZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjo1MjoyOVrOHi7GZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM4MTkyNA==", "bodyText": "Did you mean to use FilterOutputStream? You are missing an override I think.", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/871#discussion_r506381924", "createdAt": "2020-10-16T12:52:29Z", "author": {"login": "jglick"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "diffHunk": "@@ -536,6 +552,29 @@ public void close() throws IOException {\n         }\n     }\n \n+    private static class ToggleOutputStream extends OutputStream {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fededad5e8df8a0ece6777fde8bc11db6bc8e35a"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3MTgxODEyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjo1NDoxOVrOHi7O3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjo1NDoxOVrOHi7O3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM4NDA5NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    launcher.getListener().error(\"Process exited immediately after creation. See output below%n%s\",stdout.toString(StandardCharsets.UTF_8.name()));\n          \n          \n            \n                                    launcher.getListener().error(\"Process exited immediately after creation. See output below%n%s\", stdout.toString(StandardCharsets.UTF_8.name()));", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/871#discussion_r506384095", "createdAt": "2020-10-16T12:54:19Z", "author": {"login": "jglick"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "diffHunk": "@@ -442,6 +451,13 @@ public void onClose(int i, String s) {\n                 }\n \n                 try {\n+                    // Depends on the ping time with the kubernetes api\n+                    // Not fully satisfied with this solution because it can delay the execution\n+                    if (finished.await(COMMAND_FINISHED_TIMEOUT_MS, TimeUnit.MILLISECONDS)) {\n+                        launcher.getListener().error(\"Process exited immediately after creation. See output below%n%s\",stdout.toString(StandardCharsets.UTF_8.name()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fededad5e8df8a0ece6777fde8bc11db6bc8e35a"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3MTgxOTEzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjo1NDozMFrOHi7PmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjo1NDozMFrOHi7PmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM4NDI4MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                // Depends on the ping time with the kubernetes api\n          \n          \n            \n                                // Depends on the ping time with the Kubernetes API server", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/871#discussion_r506384281", "createdAt": "2020-10-16T12:54:30Z", "author": {"login": "jglick"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "diffHunk": "@@ -442,6 +451,13 @@ public void onClose(int i, String s) {\n                 }\n \n                 try {\n+                    // Depends on the ping time with the kubernetes api", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fededad5e8df8a0ece6777fde8bc11db6bc8e35a"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3MTg2Mjk5OnYy", "diffSide": "RIGHT", "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMzowNDo0OVrOHi7rZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMzowNDo0OVrOHi7rZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM5MTM5OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    logs = logs.recordPackage(ContainerExecDecorator.class, Level.FINEST);", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/871#discussion_r506391399", "createdAt": "2020-10-16T13:04:49Z", "author": {"login": "Vlatombe"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "diffHunk": "@@ -95,6 +95,7 @@ public void setUp() throws Exception {\n         deletePods(cloud.connect(), getLabels(cloud, this, name), false);\n         warnings.record(\"\", Level.WARNING).capture(1000);\n         assertNotNull(createJobThenScheduleRun());\n+        logs = logs.recordPackage(ContainerExecDecorator.class, Level.FINEST);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fededad5e8df8a0ece6777fde8bc11db6bc8e35a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3MjY3MjExOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxNToxMTo1M1rOHjEL2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxNToxMTo1M1rOHjEL2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjUzMDc3Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            LOGGER.log(Level.FINE, \"failed to close {0}\")   ;\n          \n          \n            \n                            LOGGER.log(Level.FINE, \"failed to close\", e);\n          \n      \n    \n    \n  \n\n??", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/871#discussion_r506530777", "createdAt": "2020-10-16T15:11:53Z", "author": {"login": "jglick"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/ContainerExecDecorator.java", "diffHunk": "@@ -547,7 +547,7 @@ public void close() throws IOException {\n             try {\n                 closable.close();\n             } catch (Exception e) {\n-                LOGGER.log(Level.FINE, \"failed to close {0}\");\n+                LOGGER.log(Level.FINE, \"failed to close {0}\")   ;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47eab1537b6420d817e87ae11d01b6c1df5a45e4"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4854, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}