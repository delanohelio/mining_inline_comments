{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMjg3NTkz", "number": 728, "title": "Set default cpu & memory requests on the jnlp container", "bodyText": "Suggested by @jtnord. If the user has not bothered to set any resource requests or limits on the jnlp container, it is wise to offer some reasonable default values. I chose 100m CPU and 256Mi memory based on kubectl top pod of a container from a simple build in EKS that was generating a modest amount of log output and consuming somewhat less than these values.", "createdAt": "2020-03-04T01:26:14Z", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/728", "merged": true, "mergeCommit": {"oid": "580e1a1b7380c433f573df45389e302089f01b93"}, "closed": true, "closedAt": "2020-03-04T10:31:10Z", "author": {"login": "jglick"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKMfnTgH2gAyMzgzMjg3NTkzOjE1MjdkZjgxYTcyYmI0OTc4Zjk4MzllMWFmZjc4NTljNDk3NzlkMDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKUZTkAFqTM2ODY2NDY0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1527df81a72bb4978f9839e1aff7859c49779d00", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/1527df81a72bb4978f9839e1aff7859c49779d00", "committedDate": "2020-03-04T01:18:43Z", "message": "Forgotten annotation on shouldCombineAllResources"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73a2f3a30282492ecebb398651d08471545715de", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/73a2f3a30282492ecebb398651d08471545715de", "committedDate": "2020-03-04T01:19:58Z", "message": "Unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9d4f017096b883cd81f0c693a95c67905e8253f", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/d9d4f017096b883cd81f0c693a95c67905e8253f", "committedDate": "2020-03-04T01:21:10Z", "message": "No need to start Jenkins during unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bae94bf89a41c59d33be409c338fcfd459b999dc", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/bae94bf89a41c59d33be409c338fcfd459b999dc", "committedDate": "2020-03-04T01:22:23Z", "message": "https://github.com/fabric8io/kubernetes-client/issues/2034"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fd2f2eef7100e49e802adbdcdb8d1cc740b1995", "author": {"user": {"login": "jglick", "name": "Jesse Glick"}}, "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/1fd2f2eef7100e49e802adbdcdb8d1cc740b1995", "committedDate": "2020-03-04T01:23:08Z", "message": "Set default cpu & memory requests on the jnlp container"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NDQ3MTky", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/728#pullrequestreview-368447192", "createdAt": "2020-03-04T01:27:28Z", "commit": {"oid": "1fd2f2eef7100e49e802adbdcdb8d1cc740b1995"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwMToyNzoyOVrOFxdBeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwMToyNzoyOVrOFxdBeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQwMDA1Nw==", "bodyText": "Without this workaround for fabric8io/kubernetes-client#2034, testOverridesFromYaml improperly fails when the if (jnlp.getResources() == null) gate is disabled in main sources: the actual CPU is 100m but this compares as equal to 200m!", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/728#discussion_r387400057", "createdAt": "2020-03-04T01:27:29Z", "author": {"login": "jglick"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplateUtilsTest.java", "diffHunk": "@@ -553,10 +553,20 @@ public void shouldCombineAllResources() {\n \n         Container result = combine(container1, container2);\n \n-        assertEquals(new Quantity(\"2\"), result.getResources().getLimits().get(\"cpu\"));\n-        assertEquals(new Quantity(\"2Gi\"), result.getResources().getLimits().get(\"memory\"));\n-        assertEquals(new Quantity(\"200m\"), result.getResources().getRequests().get(\"cpu\"));\n-        assertEquals(new Quantity(\"256Mi\"), result.getResources().getRequests().get(\"memory\"));\n+        assertQuantity(\"2\", result.getResources().getLimits().get(\"cpu\"));\n+        assertQuantity(\"2Gi\", result.getResources().getLimits().get(\"memory\"));\n+        assertQuantity(\"200m\", result.getResources().getRequests().get(\"cpu\"));\n+        assertQuantity(\"256Mi\", result.getResources().getRequests().get(\"memory\"));\n+    }\n+\n+    /**\n+     * Use instead of {@link org.junit.Assert#assertEquals(Object, Object)} on {@link Quantity}.\n+     * @see <a href=\"https://github.com/fabric8io/kubernetes-client/issues/2034\">kubernetes-client #2034</a>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fd2f2eef7100e49e802adbdcdb8d1cc740b1995"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NjY0NjM1", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/728#pullrequestreview-368664635", "createdAt": "2020-03-04T10:31:03Z", "commit": {"oid": "1fd2f2eef7100e49e802adbdcdb8d1cc740b1995"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NjY0NjQ2", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/728#pullrequestreview-368664646", "createdAt": "2020-03-04T10:31:04Z", "commit": {"oid": "1fd2f2eef7100e49e802adbdcdb8d1cc740b1995"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 212, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}