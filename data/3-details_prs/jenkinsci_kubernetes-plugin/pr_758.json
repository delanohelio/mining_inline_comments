{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0MzUyNDU5", "number": 758, "title": "[JENKINS-61930] JCasC testing", "bodyText": "", "createdAt": "2020-04-16T13:00:49Z", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/758", "merged": true, "mergeCommit": {"oid": "df2f143de6ee8ea4d2fc64d06f7ed2caf4cfdb5c"}, "closed": true, "closedAt": "2020-04-17T07:56:05Z", "author": {"login": "Vlatombe"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYMTghAH2gAyNDA0MzUyNDU5OjA3NTYxZDZlMGE2MTZkNDQ0MjYwZWNjNmZlMGEzMzJkMzY5ODM1NzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYQmEyAFqTM5NDg3Mzg3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "07561d6e0a616d444260ecc6fe0a332d36983575", "author": {"user": {"login": "Vlatombe", "name": "Vincent Latombe"}}, "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/07561d6e0a616d444260ecc6fe0a332d36983575", "committedDate": "2020-04-16T13:00:26Z", "message": "[JENKINS-61930] JCasC testing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NjA5MTU4", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/758#pullrequestreview-394609158", "createdAt": "2020-04-16T13:02:54Z", "commit": {"oid": "07561d6e0a616d444260ecc6fe0a332d36983575"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxMzowMjo1NFrOGGkMcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxMzowODo0NFrOGGkbrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTUzNzY1MA==", "bodyText": "Better to use the BOM.", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/758#discussion_r409537650", "createdAt": "2020-04-16T13:02:54Z", "author": {"login": "jglick"}, "path": "pom.xml", "diffHunk": "@@ -53,6 +53,7 @@\n     <pipeline-model-definition.version>1.6.0</pipeline-model-definition.version>\n     <slf4jVersion>1.7.26</slf4jVersion>\n     <useBeta>true</useBeta>\n+    <configuration-as-code.version>1.36</configuration-as-code.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07561d6e0a616d444260ecc6fe0a332d36983575"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTUzODMxNA==", "bodyText": "OK I am bored already. \ud83d\ude2a", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/758#discussion_r409538314", "createdAt": "2020-04-16T13:03:58Z", "author": {"login": "jglick"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/casc/CasCTest.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package org.csanchez.jenkins.plugins.kubernetes.casc;\n+\n+import io.jenkins.plugins.casc.misc.RoundTripAbstractTest;\n+import org.csanchez.jenkins.plugins.kubernetes.ContainerLivenessProbe;\n+import org.csanchez.jenkins.plugins.kubernetes.ContainerTemplate;\n+import org.csanchez.jenkins.plugins.kubernetes.KubernetesCloud;\n+import org.csanchez.jenkins.plugins.kubernetes.PodTemplate;\n+import org.csanchez.jenkins.plugins.kubernetes.pod.yaml.Merge;\n+import org.csanchez.jenkins.plugins.kubernetes.pod.yaml.Overrides;\n+import org.csanchez.jenkins.plugins.kubernetes.volumes.workspace.DynamicPVCWorkspaceVolume;\n+import org.csanchez.jenkins.plugins.kubernetes.volumes.workspace.WorkspaceVolume;\n+import org.jvnet.hudson.test.RestartableJenkinsRule;\n+\n+import java.util.List;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.isA;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertNotNull;\n+\n+public class CasCTest extends RoundTripAbstractTest {\n+\n+    @Override\n+    protected void assertConfiguredAsExpected(RestartableJenkinsRule r, String configContent) {\n+        KubernetesCloud cloud = r.j.jenkins.clouds.get(KubernetesCloud.class);\n+        assertNotNull(cloud);\n+        assertEquals(\"10\",cloud.getContainerCapStr());\n+        assertEquals(\"http://jenkinshost:8080/jenkins/\", cloud.getJenkinsUrl());\n+        assertEquals(\"32\", cloud.getMaxRequestsPerHostStr());\n+        assertEquals(\"kubernetes\", cloud.name);\n+        List<PodTemplate> templates = cloud.getTemplates();\n+        assertNotNull(templates);\n+        assertEquals(3, templates.size());\n+        PodTemplate podTemplate = templates.get(0);\n+        assertEquals(false, podTemplate.isHostNetwork());\n+        assertEquals(\"java\", podTemplate.getLabel());\n+        assertEquals(\"default-java\", podTemplate.getName());\n+        assertThat(podTemplate.getYamlMergeStrategy(), isA(Overrides.class));\n+        podTemplate = templates.get(1);\n+        assertEquals(false, podTemplate.isHostNetwork());\n+        assertEquals(\"dynamic-pvc\", podTemplate.getLabel());\n+        assertEquals(\"dynamic-pvc\", podTemplate.getName());\n+        assertThat(podTemplate.getYamlMergeStrategy(), isA(Overrides.class));\n+        WorkspaceVolume workspaceVolume = podTemplate.getWorkspaceVolume();\n+        assertNotNull(workspaceVolume);\n+        assertThat(workspaceVolume, isA(DynamicPVCWorkspaceVolume.class));\n+        DynamicPVCWorkspaceVolume dynamicPVCVolume = (DynamicPVCWorkspaceVolume) workspaceVolume;\n+        assertEquals(\"ReadWriteOnce\", dynamicPVCVolume.getAccessModes());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07561d6e0a616d444260ecc6fe0a332d36983575"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTU0MTU1MA==", "bodyText": "Ugly. We cannot convert to type Integer?", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/758#discussion_r409541550", "createdAt": "2020-04-16T13:08:44Z", "author": {"login": "jglick"}, "path": "src/test/resources/org/csanchez/jenkins/plugins/kubernetes/casc/casc_envVar_keyValue.yaml", "diffHunk": "@@ -0,0 +1,12 @@\n+jenkins:\n+  clouds:\n+    - kubernetes:\n+        containerCapStr: \"10\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07561d6e0a616d444260ecc6fe0a332d36983575"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37b9e97ef211c216675f429224935397f8fa8013", "author": {"user": {"login": "Vlatombe", "name": "Vincent Latombe"}}, "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/37b9e97ef211c216675f429224935397f8fa8013", "committedDate": "2020-04-16T13:18:53Z", "message": "use version from bom"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fff7a7feb18a3f6ced58dca03922f7fb006f257", "author": {"user": {"login": "Vlatombe", "name": "Vincent Latombe"}}, "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/9fff7a7feb18a3f6ced58dca03922f7fb006f257", "committedDate": "2020-04-16T13:33:44Z", "message": "Clean up and accept int variants for fields using strings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NzYwMzA0", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/758#pullrequestreview-394760304", "createdAt": "2020-04-16T15:39:38Z", "commit": {"oid": "07561d6e0a616d444260ecc6fe0a332d36983575"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNTozOTozOFrOGGrcJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQxNTozOTozOFrOGGrcJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY1NjM1Ng==", "bodyText": "They're up to 1.39 now.", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/758#discussion_r409656356", "createdAt": "2020-04-16T15:39:38Z", "author": {"login": "kerogers-cloudbees"}, "path": "pom.xml", "diffHunk": "@@ -53,6 +53,7 @@\n     <pipeline-model-definition.version>1.6.0</pipeline-model-definition.version>\n     <slf4jVersion>1.7.26</slf4jVersion>\n     <useBeta>true</useBeta>\n+    <configuration-as-code.version>1.36</configuration-as-code.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07561d6e0a616d444260ecc6fe0a332d36983575"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0ODczODcy", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/758#pullrequestreview-394873872", "createdAt": "2020-04-16T18:00:20Z", "commit": {"oid": "9fff7a7feb18a3f6ced58dca03922f7fb006f257"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 107, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}