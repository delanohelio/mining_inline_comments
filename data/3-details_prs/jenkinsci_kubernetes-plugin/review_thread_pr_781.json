{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4NTY0ODAz", "number": 781, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNTowMTozOVrOD86Ebw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNTowMjo0NlrOD86GPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MTkyNTU5OnYy", "diffSide": "RIGHT", "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNTowMTozOVrOGWIkmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNTowMTozOVrOGWIkmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2MjI5Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    if (j == null) break;\n          \n          \n            \n                                    if (j == null) {\n          \n          \n            \n                                        break;\n          \n          \n            \n                                    }", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/781#discussion_r425862296", "createdAt": "2020-05-15T15:01:39Z", "author": {"login": "jglick"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "diffHunk": "@@ -128,8 +129,12 @@ public void runInPod() throws Exception {\n             new Thread(() -> {\n                 long pos = 0;\n                 try {\n-                    while (Jenkins.getInstanceOrNull() != null) { // otherwise get NPE from Computer.getLogDir\n-                        if (c.getLogFile().isFile()) { // TODO should LargeText.FileSession handle this?\n+                    while (true) {\n+                        Jenkins j = Jenkins.getInstanceOrNull();\n+                        if (j == null) break;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "033beed9b8680eac68b3d7e011b9e411ef6364f4"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MTkzMDIzOnYy", "diffSide": "RIGHT", "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNTowMjo0NlrOGWInkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNTowMjo0NlrOGWInkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2MzA1Ng==", "bodyText": "Hmm. I guess OK as a hotfix but this is not maintainable. Is there a core patch to fix the underlying issue?", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/781#discussion_r425863056", "createdAt": "2020-05-15T15:02:46Z", "author": {"login": "jglick"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/pipeline/KubernetesPipelineTest.java", "diffHunk": "@@ -128,8 +129,12 @@ public void runInPod() throws Exception {\n             new Thread(() -> {\n                 long pos = 0;\n                 try {\n-                    while (Jenkins.getInstanceOrNull() != null) { // otherwise get NPE from Computer.getLogDir\n-                        if (c.getLogFile().isFile()) { // TODO should LargeText.FileSession handle this?\n+                    while (true) {\n+                        Jenkins j = Jenkins.getInstanceOrNull();\n+                        if (j == null) break;\n+                        // not using Computer#getLogDir as it has side-effect of creating log directories which can create a race condition with main code\n+                        File logFile = new File(j.getRootDir(), \"logs/slaves/\" + c.getName() + \"/slave.log\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "033beed9b8680eac68b3d7e011b9e411ef6364f4"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4939, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}