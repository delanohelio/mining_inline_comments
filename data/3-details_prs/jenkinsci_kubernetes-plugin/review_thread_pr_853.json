{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2ODA0NDE2", "number": 853, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMjozNToyMFrOEpzCKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMjozNToyMFrOEpzCKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMjYzMjA4OnYy", "diffSide": "RIGHT", "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplateUtilsTest.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMjozNToyMFrOHbr6sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQwNzo1Mjo1OVrOHcROug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc5MzEzOA==", "bodyText": "Is this test reproducing the bug? I thought that the problem was that the parent template would grow endlessly, so we should have a test asserting that after combination the parent template does not contain some property.", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/853#discussion_r498793138", "createdAt": "2020-10-02T12:35:20Z", "author": {"login": "jglick"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplateUtilsTest.java", "diffHunk": "@@ -688,17 +689,21 @@ public void shouldCombineAllToolLocations() {\n \n         PodTemplate podTemplate1 = new PodTemplate();\n         List<ToolLocationNodeProperty> nodeProperties1 = new ArrayList<>();\n-        nodeProperties1.add(new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey1@Test\",\"toolHome1\")));\n+        ToolLocationNodeProperty toolHome1 = new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey1@Test\", \"toolHome1\"));\n+        nodeProperties1.add(toolHome1);\n         podTemplate1.setNodeProperties(nodeProperties1);\n \n         PodTemplate podTemplate2 = new PodTemplate();\n         List<ToolLocationNodeProperty> nodeProperties2 = new ArrayList<>();\n-        nodeProperties2.add(new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey2@Test\",\"toolHome2\")));\n+        ToolLocationNodeProperty toolHome2 = new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey2@Test\", \"toolHome2\"));\n+        nodeProperties2.add(toolHome2);\n         podTemplate2.setNodeProperties(nodeProperties2);\n \n         PodTemplate result = combine(podTemplate1,podTemplate2);\n \n-        assertThat(result.getNodeProperties(), hasItems(nodeProperties1.get(0),nodeProperties2.get(0)));\n+        assertThat(podTemplate1.getNodeProperties(), contains(toolHome1));\n+        assertThat(podTemplate2.getNodeProperties(), contains(toolHome2));\n+        assertThat(result.getNodeProperties(), contains(toolHome1, toolHome2));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715385ae2ca316b27ddfddf68013b5f4d0b8828b"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg0Njc0Mw==", "bodyText": "Or that the size of the parent template's nodeProperties didn't change.", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/853#discussion_r498846743", "createdAt": "2020-10-02T14:11:36Z", "author": {"login": "kerogers-cloudbees"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplateUtilsTest.java", "diffHunk": "@@ -688,17 +689,21 @@ public void shouldCombineAllToolLocations() {\n \n         PodTemplate podTemplate1 = new PodTemplate();\n         List<ToolLocationNodeProperty> nodeProperties1 = new ArrayList<>();\n-        nodeProperties1.add(new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey1@Test\",\"toolHome1\")));\n+        ToolLocationNodeProperty toolHome1 = new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey1@Test\", \"toolHome1\"));\n+        nodeProperties1.add(toolHome1);\n         podTemplate1.setNodeProperties(nodeProperties1);\n \n         PodTemplate podTemplate2 = new PodTemplate();\n         List<ToolLocationNodeProperty> nodeProperties2 = new ArrayList<>();\n-        nodeProperties2.add(new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey2@Test\",\"toolHome2\")));\n+        ToolLocationNodeProperty toolHome2 = new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey2@Test\", \"toolHome2\"));\n+        nodeProperties2.add(toolHome2);\n         podTemplate2.setNodeProperties(nodeProperties2);\n \n         PodTemplate result = combine(podTemplate1,podTemplate2);\n \n-        assertThat(result.getNodeProperties(), hasItems(nodeProperties1.get(0),nodeProperties2.get(0)));\n+        assertThat(podTemplate1.getNodeProperties(), contains(toolHome1));\n+        assertThat(podTemplate2.getNodeProperties(), contains(toolHome2));\n+        assertThat(result.getNodeProperties(), contains(toolHome1, toolHome2));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc5MzEzOA=="}, "originalCommit": {"oid": "715385ae2ca316b27ddfddf68013b5f4d0b8828b"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQwNDQ3NA==", "bodyText": "First assertion failed with the previous code, since there was a side-effect on the first pod template. Note that contains does an exact match of all specified elements, unlike hasItems.", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/853#discussion_r499404474", "createdAt": "2020-10-05T07:52:59Z", "author": {"login": "Vlatombe"}, "path": "src/test/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplateUtilsTest.java", "diffHunk": "@@ -688,17 +689,21 @@ public void shouldCombineAllToolLocations() {\n \n         PodTemplate podTemplate1 = new PodTemplate();\n         List<ToolLocationNodeProperty> nodeProperties1 = new ArrayList<>();\n-        nodeProperties1.add(new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey1@Test\",\"toolHome1\")));\n+        ToolLocationNodeProperty toolHome1 = new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey1@Test\", \"toolHome1\"));\n+        nodeProperties1.add(toolHome1);\n         podTemplate1.setNodeProperties(nodeProperties1);\n \n         PodTemplate podTemplate2 = new PodTemplate();\n         List<ToolLocationNodeProperty> nodeProperties2 = new ArrayList<>();\n-        nodeProperties2.add(new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey2@Test\",\"toolHome2\")));\n+        ToolLocationNodeProperty toolHome2 = new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation(\"toolKey2@Test\", \"toolHome2\"));\n+        nodeProperties2.add(toolHome2);\n         podTemplate2.setNodeProperties(nodeProperties2);\n \n         PodTemplate result = combine(podTemplate1,podTemplate2);\n \n-        assertThat(result.getNodeProperties(), hasItems(nodeProperties1.get(0),nodeProperties2.get(0)));\n+        assertThat(podTemplate1.getNodeProperties(), contains(toolHome1));\n+        assertThat(podTemplate2.getNodeProperties(), contains(toolHome2));\n+        assertThat(result.getNodeProperties(), contains(toolHome1, toolHome2));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc5MzEzOA=="}, "originalCommit": {"oid": "715385ae2ca316b27ddfddf68013b5f4d0b8828b"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4837, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}