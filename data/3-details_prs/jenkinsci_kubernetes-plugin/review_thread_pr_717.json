{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MjgzMTgy", "number": 717, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyMjoxMVrODh5MAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNTozMVrODh5QeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2ODY2NTYwOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesSlave.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyMjoxMVrOFs4cPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNjo1NlrOFs4mkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNjM5OQ==", "bodyText": "Is this related, or just a deprecation warning?", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382606399", "createdAt": "2020-02-21T14:22:11Z", "author": {"login": "jglick"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesSlave.java", "diffHunk": "@@ -125,16 +129,13 @@ public KubernetesSlave(PodTemplate template, String nodeDescription, String clou\n     protected KubernetesSlave(String name, @Nonnull PodTemplate template, String nodeDescription, String cloudName, String labelStr,\n                            ComputerLauncher computerLauncher, RetentionStrategy rs)\n             throws Descriptor.FormException, IOException {\n-        super(name,\n-                nodeDescription,\n-                template.getRemoteFs(),\n-                1,\n-                template.getNodeUsageMode() != null ? template.getNodeUsageMode() : Node.Mode.NORMAL,\n-                labelStr,\n-                computerLauncher,\n-                rs,\n-                template.getNodeProperties());\n-\n+        super(name, null, computerLauncher);\n+        setNodeDescription(nodeDescription);\n+        setNumExecutors(1);\n+        setMode(template.getNodeUsageMode() != null ? template.getNodeUsageMode() : Node.Mode.NORMAL);\n+        setLabelString(labelStr);\n+        setRetentionStrategy(rs);\n+        setNodeProperties(template.getNodeProperties());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNzIzMQ==", "bodyText": "I guess you addressed the deprecation while dealing with the remoteFs?", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382607231", "createdAt": "2020-02-21T14:23:43Z", "author": {"login": "jglick"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesSlave.java", "diffHunk": "@@ -125,16 +129,13 @@ public KubernetesSlave(PodTemplate template, String nodeDescription, String clou\n     protected KubernetesSlave(String name, @Nonnull PodTemplate template, String nodeDescription, String cloudName, String labelStr,\n                            ComputerLauncher computerLauncher, RetentionStrategy rs)\n             throws Descriptor.FormException, IOException {\n-        super(name,\n-                nodeDescription,\n-                template.getRemoteFs(),\n-                1,\n-                template.getNodeUsageMode() != null ? template.getNodeUsageMode() : Node.Mode.NORMAL,\n-                labelStr,\n-                computerLauncher,\n-                rs,\n-                template.getNodeProperties());\n-\n+        super(name, null, computerLauncher);\n+        setNodeDescription(nodeDescription);\n+        setNumExecutors(1);\n+        setMode(template.getNodeUsageMode() != null ? template.getNodeUsageMode() : Node.Mode.NORMAL);\n+        setLabelString(labelStr);\n+        setRetentionStrategy(rs);\n+        setNodeProperties(template.getNodeProperties());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNjM5OQ=="}, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwOTA0MA==", "bodyText": "Yes", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382609040", "createdAt": "2020-02-21T14:26:56Z", "author": {"login": "Vlatombe"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesSlave.java", "diffHunk": "@@ -125,16 +129,13 @@ public KubernetesSlave(PodTemplate template, String nodeDescription, String clou\n     protected KubernetesSlave(String name, @Nonnull PodTemplate template, String nodeDescription, String cloudName, String labelStr,\n                            ComputerLauncher computerLauncher, RetentionStrategy rs)\n             throws Descriptor.FormException, IOException {\n-        super(name,\n-                nodeDescription,\n-                template.getRemoteFs(),\n-                1,\n-                template.getNodeUsageMode() != null ? template.getNodeUsageMode() : Node.Mode.NORMAL,\n-                labelStr,\n-                computerLauncher,\n-                rs,\n-                template.getNodeProperties());\n-\n+        super(name, null, computerLauncher);\n+        setNodeDescription(nodeDescription);\n+        setNumExecutors(1);\n+        setMode(template.getNodeUsageMode() != null ? template.getNodeUsageMode() : Node.Mode.NORMAL);\n+        setLabelString(labelStr);\n+        setRetentionStrategy(rs);\n+        setNodeProperties(template.getNodeProperties());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNjM5OQ=="}, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2ODY2Njk2OnYy", "diffSide": "LEFT", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesLauncher.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyMjozOVrOFs4dIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNzo1NVrOFs4otw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNjYyNA==", "bodyText": "Related, or just another bug?", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382606624", "createdAt": "2020-02-21T14:22:39Z", "author": {"login": "jglick"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesLauncher.java", "diffHunk": "@@ -110,9 +110,7 @@ public void launch(SlaveComputer computer, TaskListener listener) {\n         try {\n             KubernetesClient client = slave.getKubernetesCloud().connect();\n             Pod pod = template.build(slave);\n-            if (template.isShowRawYaml()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwOTU5MQ==", "bodyText": "Not a bug, but with the impl change, having the pod at hand is mandatory, so this is combined with https://github.com/jenkinsci/kubernetes-plugin/pull/717/files#diff-7de256a4d98e2297b5323f04b76bd471R410", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382609591", "createdAt": "2020-02-21T14:27:55Z", "author": {"login": "Vlatombe"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesLauncher.java", "diffHunk": "@@ -110,9 +110,7 @@ public void launch(SlaveComputer computer, TaskListener listener) {\n         try {\n             KubernetesClient client = slave.getKubernetesCloud().connect();\n             Pod pod = template.build(slave);\n-            if (template.isShowRawYaml()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNjYyNA=="}, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2ODY3MzYyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesSlave.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNDoyNlrOFs4hLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNDoyNlrOFs4hLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNzY2Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @CheckForNull\n          \n          \n            \n                @CheckForNull\n          \n          \n            \n                @Override\n          \n      \n    \n    \n  \n\n?", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382607662", "createdAt": "2020-02-21T14:24:26Z", "author": {"login": "jglick"}, "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/KubernetesSlave.java", "diffHunk": "@@ -156,6 +157,34 @@ public String getPodName() {\n         return PodTemplateUtils.substituteEnv(getNodeName());\n     }\n \n+    private String remoteFS;\n+\n+    @Override\n+    public String getRemoteFS() {\n+        if (remoteFS == null) {\n+            Optional<Pod> optionalPod = getPod();\n+            if (optionalPod.isPresent()) {\n+                Optional<Container> optionalJnlp = optionalPod.get().getSpec().getContainers().stream().filter(c -> JNLP_NAME.equals(c.getName())).findFirst();\n+                if (optionalJnlp.isPresent()) {\n+                    remoteFS = StringUtils.defaultIfBlank(optionalJnlp.get().getWorkingDir(), ContainerTemplate.DEFAULT_WORKING_DIR);\n+                }\n+            }\n+        }\n+        return Util.fixNull(remoteFS);\n+    }\n+\n+    // Copied from Slave#getRootPath because this uses the underlying field\n+    @CheckForNull", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM2ODY3NzA0OnYy", "diffSide": "RIGHT", "path": "src/test/resources/org/csanchez/jenkins/plugins/kubernetes/pipeline/sidecarWorkingDir.groovy", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDoyNTozMVrOFs4jcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNToxMDoyNFrOFs6G9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwODI0Mw==", "bodyText": "Should the test assert something about /src?", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382608243", "createdAt": "2020-02-21T14:25:31Z", "author": {"login": "jglick"}, "path": "src/test/resources/org/csanchez/jenkins/plugins/kubernetes/pipeline/sidecarWorkingDir.groovy", "diffHunk": "@@ -0,0 +1,12 @@\n+podTemplate(containers: [\n+    containerTemplate(name: 'busybox', image: 'busybox', ttyEnabled: true, command: '/bin/cat', workingDir: '/src')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwOTgyMA==", "bodyText": "Right could be made slightly better.", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382609820", "createdAt": "2020-02-21T14:28:18Z", "author": {"login": "Vlatombe"}, "path": "src/test/resources/org/csanchez/jenkins/plugins/kubernetes/pipeline/sidecarWorkingDir.groovy", "diffHunk": "@@ -0,0 +1,12 @@\n+podTemplate(containers: [\n+    containerTemplate(name: 'busybox', image: 'busybox', ttyEnabled: true, command: '/bin/cat', workingDir: '/src')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwODI0Mw=="}, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYzMzcxOA==", "bodyText": "Done", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/717#discussion_r382633718", "createdAt": "2020-02-21T15:10:24Z", "author": {"login": "Vlatombe"}, "path": "src/test/resources/org/csanchez/jenkins/plugins/kubernetes/pipeline/sidecarWorkingDir.groovy", "diffHunk": "@@ -0,0 +1,12 @@\n+podTemplate(containers: [\n+    containerTemplate(name: 'busybox', image: 'busybox', ttyEnabled: true, command: '/bin/cat', workingDir: '/src')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwODI0Mw=="}, "originalCommit": {"oid": "bbdf319a87ed5fe02f80221de60fc114eae3d1f1"}, "originalPosition": 2}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 15, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}