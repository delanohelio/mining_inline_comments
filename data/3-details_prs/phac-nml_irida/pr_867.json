{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0OTc1MTcy", "number": 867, "title": "Announcements upgrade admin edit & details forms", "bodyText": "Description of changes\nAdding title and priority to edit and details forms.\n\n\nRelated issue\nLink to the GitHub issue this pull request addresses using the #issuenum format.  If it completes an issue, use Fixes #issuenum to automatically close the issue.\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n Tests added (or description of how to test) for any new features.\n User documentation updated for UI or technical changes.", "createdAt": "2020-11-20T22:01:34Z", "url": "https://github.com/phac-nml/irida/pull/867", "merged": true, "mergeCommit": {"oid": "59ef97dfd395cfb55eb1d765bcc48169a30938ea"}, "closed": true, "closedAt": "2020-11-30T15:12:34Z", "author": {"login": "ksierks"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeesEZgH2gAyNTI0OTc1MTcyOmE2NTY1OTNhNjlhYzU5Nzk1OTVhMGY3YWI2OTUzY2I0NjE2MGY0MTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhm1VXgFqTUzNzgxNzExNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a656593a69ac5979595a0f7ab6953cb46160f412", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/a656593a69ac5979595a0f7ab6953cb46160f412", "committedDate": "2020-11-20T22:00:15Z", "message": "starting to make changes to the edit announcement modal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6054a01a700dbfdb186e39857d96fd78fe185c54", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/6054a01a700dbfdb186e39857d96fd78fe185c54", "committedDate": "2020-11-23T16:02:15Z", "message": "fixing tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c19e9dab02c69c91db0a7a0ab4be8d331b8868c", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/4c19e9dab02c69c91db0a7a0ab4be8d331b8868c", "committedDate": "2020-11-23T16:17:09Z", "message": "updating the details page to add new title and priority"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NjUxODU4", "url": "https://github.com/phac-nml/irida/pull/867#pullrequestreview-536651858", "createdAt": "2020-11-23T16:38:37Z", "commit": {"oid": "4c19e9dab02c69c91db0a7a0ab4be8d331b8868c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozODozN1rOH4V-Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozODozN1rOH4V-Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MjI4Nw==", "bodyText": "Sorry, I'm going to take this opportunity to ask a couple questions. I noticed there are these variables with underscores. Is this Thymeleaf pre-processing?", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528842287", "createdAt": "2020-11-23T16:38:37Z", "author": {"login": "ksierks"}, "path": "src/main/webapp/pages/announcements/details.html", "diffHunk": "@@ -27,11 +27,27 @@\n                     <h2 class=\"panel-title\" th:text=\"#{announcement.control.details.edit}\"></h2>\n                 </div>\n                 <div class=\"panel-body\">\n-                    <textarea class=\"form-control input-full announcement-input\" type=\"text\" id=\"message\" name=\"message\"\n+                    <div class=\"form-group\">\n+                        <label for=\"title\" th:text=\"#{announcement.control.title}\">__Title__</label>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c19e9dab02c69c91db0a7a0ab4be8d331b8868c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NjUyNzQ1", "url": "https://github.com/phac-nml/irida/pull/867#pullrequestreview-536652745", "createdAt": "2020-11-23T16:39:36Z", "commit": {"oid": "4c19e9dab02c69c91db0a7a0ab4be8d331b8868c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozOTozNlrOH4WBOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozOTozNlrOH4WBOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0MzA2NA==", "bodyText": "I am trying to keep this page's look and feel consistent, but I have not been able to find the 'input-full' class in the css.", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528843064", "createdAt": "2020-11-23T16:39:36Z", "author": {"login": "ksierks"}, "path": "src/main/webapp/pages/announcements/details.html", "diffHunk": "@@ -27,11 +27,27 @@\n                     <h2 class=\"panel-title\" th:text=\"#{announcement.control.details.edit}\"></h2>\n                 </div>\n                 <div class=\"panel-body\">\n-                    <textarea class=\"form-control input-full announcement-input\" type=\"text\" id=\"message\" name=\"message\"\n+                    <div class=\"form-group\">\n+                        <label for=\"title\" th:text=\"#{announcement.control.title}\">__Title__</label>\n+                        <input id=\"title\" name=\"title\" type=\"text\"\n+                               class=\"form-control input-full\"\n+                               required=\"required\"\n+                               th:value=\"${announcement.getTitle()}\"\n+                               th:placeholder=\"#{announcement.create.form.placeholder}\" />\n+                    </div>\n+                    <div class=\"form-group\">\n+                        <label for=\"message\" th:text=\"#{announcement.control.message}\">__Message__</label>\n+                        <textarea class=\"form-control input-full announcement-input\" type=\"text\" id=\"message\" name=\"message\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c19e9dab02c69c91db0a7a0ab4be8d331b8868c"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a31e4791e2e2b8ac4f5c1dcad2342689c9b66b5", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/4a31e4791e2e2b8ac4f5c1dcad2342689c9b66b5", "committedDate": "2020-11-23T16:42:52Z", "message": "fixing checkbox to defaultChecked"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NzAzNzUx", "url": "https://github.com/phac-nml/irida/pull/867#pullrequestreview-536703751", "createdAt": "2020-11-23T17:38:48Z", "commit": {"oid": "4a31e4791e2e2b8ac4f5c1dcad2342689c9b66b5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNzozODo0OVrOH4YbGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNzozODo0OVrOH4YbGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg4MjQ1Nw==", "bodyText": "Since this is almost exactly the same as the CreateAnnouncementModal do you think you could refactor to use only one?", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r528882457", "createdAt": "2020-11-23T17:38:49Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/admin/components/announcements/EditAnnouncementModal.jsx", "diffHunk": "@@ -0,0 +1,84 @@\n+import React, { useRef } from \"react\";\n+import { Checkbox, Form, Input, Modal, Space } from \"antd\";\n+import { IconEdit } from \"../../../../components/icons/Icons\";\n+import { FONT_COLOR_PRIMARY } from \"../../../../styles/fonts\";\n+import { MarkdownEditor } from \"../../../../components/markdown/MarkdownEditor\";\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a31e4791e2e2b8ac4f5c1dcad2342689c9b66b5"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9c2e7bdb58b19ac7cdcd2dcac654afe4be0e5cf", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/f9c2e7bdb58b19ac7cdcd2dcac654afe4be0e5cf", "committedDate": "2020-11-23T19:15:02Z", "message": "fixing checkbox and adding missing updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "009862e53c90db858ad04f9e173c94b034948137", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/009862e53c90db858ad04f9e173c94b034948137", "committedDate": "2020-11-23T22:43:45Z", "message": "deciding whether refactoring the modal this way makes sense"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1a74c62c67a1605397aa823087fd8d998c2c306", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/f1a74c62c67a1605397aa823087fd8d998c2c306", "committedDate": "2020-11-23T22:45:57Z", "message": "undo mistake"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8566243558a6b1847a50561525c6e29a5baf932f", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/8566243558a6b1847a50561525c6e29a5baf932f", "committedDate": "2020-11-24T13:19:02Z", "message": "updating documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5897b4c13964eae65b317cb9193c6ff2c5e19af5", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/5897b4c13964eae65b317cb9193c6ff2c5e19af5", "committedDate": "2020-11-24T19:09:57Z", "message": "adding missing message property"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18e9c90ca0dfa67b10f0d5ffaf1305edd5ae5dbd", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/18e9c90ca0dfa67b10f0d5ffaf1305edd5ae5dbd", "committedDate": "2020-11-27T20:31:56Z", "message": "adding some error handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6af0b76923b58311e23decbf635e85b0991eff32", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/6af0b76923b58311e23decbf635e85b0991eff32", "committedDate": "2020-11-27T23:15:54Z", "message": "putting className back for ok button so submit new announcement tests pass again"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3ODE3MTE0", "url": "https://github.com/phac-nml/irida/pull/867#pullrequestreview-537817114", "createdAt": "2020-11-24T18:59:07Z", "commit": {"oid": "8566243558a6b1847a50561525c6e29a5baf932f"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxODo1OTowOFrOH5Q--g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxOTowMjoyMFrOH5RGuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTgwOTE0Ng==", "bodyText": "In es6 there is a destructuring syntax for this:\nconst { title, priority } = values;\nor, since you only use those values you can do that right up in the function arguments:\nform.validateFields().then(({ title, priority }) => {\n\t// ...\n});", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r529809146", "createdAt": "2020-11-24T18:59:08Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/admin/components/announcements/AnnouncementModal.jsx", "diffHunk": "@@ -31,9 +35,18 @@ export function CreateAnnouncementModal({\n       const title = values.title;\n       const priority = values.priority;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8566243558a6b1847a50561525c6e29a5baf932f"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTgxMTEyOA==", "bodyText": "In es6 you never have to do this redundant assignment of object attributes, in this case since title and priority are already defined (and are labelled correct) you could write this as:\nupdateAnnouncement({\n  id: announcement.id,\n  title,\n  message: markdown,\n  priority,\n});\n``", "url": "https://github.com/phac-nml/irida/pull/867#discussion_r529811128", "createdAt": "2020-11-24T19:02:20Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/admin/components/announcements/AnnouncementModal.jsx", "diffHunk": "@@ -31,9 +35,18 @@ export function CreateAnnouncementModal({\n       const title = values.title;\n       const priority = values.priority;\n \n-      createAnnouncement(title, markdown, priority);\n+      if (announcement) {\n+        updateAnnouncement({\n+          id: announcement.id,\n+          title: title,\n+          message: markdown,\n+          priority: priority,\n+        });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8566243558a6b1847a50561525c6e29a5baf932f"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4974, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}