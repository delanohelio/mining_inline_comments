{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExNjM5MDU5", "number": 844, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxOTowOTo1NVrOEy9kdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDo0MToyOVrOE0iuew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODczMDE0OnYy", "diffSide": "RIGHT", "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxOTowOTo1NVrOHp5hOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxODoxMzoxMFrOHqoptA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5NjA1Ng==", "bodyText": "Check in the hibernate generated database for these _AUD fields, but I would assume these fields are nullable in the _AUD tables.  The constraints in the liquibase version of the db should match the hibernate version.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r513696056", "createdAt": "2020-10-28T19:09:55Z", "author": {"login": "tom114"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"announcement_upgrade\" author=\"katherine\">\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"title\" type=\"varchar(255)\" />\n+        </addColumn>\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"priority\" type=\"tinyint(1)\">\n+                <constraints nullable=\"false\" />\n+            </column>\n+        </addColumn>\n+\n+        <addColumn tableName=\"announcement_AUD\">\n+            <column name=\"title\" type=\"varchar(255)\" />\n+        </addColumn>\n+        <addColumn tableName=\"announcement_AUD\">\n+            <column name=\"priority\" type=\"tinyint(1)\">\n+                <constraints nullable=\"false\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09c38933065c2f73c8ada70f797482f68931d95a"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQwMjk3Nw==", "bodyText": "The hibernate generated database set priority to null=\"true\" in the announcement_AUD table. I will fix this to reflect hibernate. Please see 8328ac4.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r514402977", "createdAt": "2020-10-29T16:36:58Z", "author": {"login": "ksierks"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"announcement_upgrade\" author=\"katherine\">\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"title\" type=\"varchar(255)\" />\n+        </addColumn>\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"priority\" type=\"tinyint(1)\">\n+                <constraints nullable=\"false\" />\n+            </column>\n+        </addColumn>\n+\n+        <addColumn tableName=\"announcement_AUD\">\n+            <column name=\"title\" type=\"varchar(255)\" />\n+        </addColumn>\n+        <addColumn tableName=\"announcement_AUD\">\n+            <column name=\"priority\" type=\"tinyint(1)\">\n+                <constraints nullable=\"false\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5NjA1Ng=="}, "originalCommit": {"oid": "09c38933065c2f73c8ada70f797482f68931d95a"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ2ODI3Ng==", "bodyText": "Yeah I assumed.  That's what we usually see with the not null things in the _AUD tables.  You can just remove the constraint here.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r514468276", "createdAt": "2020-10-29T18:13:10Z", "author": {"login": "tom114"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"announcement_upgrade\" author=\"katherine\">\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"title\" type=\"varchar(255)\" />\n+        </addColumn>\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"priority\" type=\"tinyint(1)\">\n+                <constraints nullable=\"false\" />\n+            </column>\n+        </addColumn>\n+\n+        <addColumn tableName=\"announcement_AUD\">\n+            <column name=\"title\" type=\"varchar(255)\" />\n+        </addColumn>\n+        <addColumn tableName=\"announcement_AUD\">\n+            <column name=\"priority\" type=\"tinyint(1)\">\n+                <constraints nullable=\"false\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5NjA1Ng=="}, "originalCommit": {"oid": "09c38933065c2f73c8ada70f797482f68931d95a"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODczMjE0OnYy", "diffSide": "RIGHT", "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxOToxMDoyOVrOHp5ifA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNjo1MDo1NFrOHqlR1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5NjM4MA==", "bodyText": "Do we have a default for the priority?  If not I believe when upgrading an existing database this priority may fail.\nI tested and it looks like it defaulted everything to 0, but it would be better not to rely on chance.  I think if you add a value=0 to the column tag it'll definitively set the priority to false.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r513696380", "createdAt": "2020-10-28T19:10:29Z", "author": {"login": "tom114"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"announcement_upgrade\" author=\"katherine\">\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"title\" type=\"varchar(255)\" />\n+        </addColumn>\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"priority\" type=\"tinyint(1)\">\n+                <constraints nullable=\"false\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09c38933065c2f73c8ada70f797482f68931d95a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQxMzAxMg==", "bodyText": "Done.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r514413012", "createdAt": "2020-10-29T16:50:54Z", "author": {"login": "ksierks"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"announcement_upgrade\" author=\"katherine\">\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"title\" type=\"varchar(255)\" />\n+        </addColumn>\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"priority\" type=\"tinyint(1)\">\n+                <constraints nullable=\"false\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5NjM4MA=="}, "originalCommit": {"oid": "09c38933065c2f73c8ada70f797482f68931d95a"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODczODY5OnYy", "diffSide": "RIGHT", "path": "src/main/resources/scripts/announcements/generate_json.py", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxOToxMjozNFrOHp5mjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNDo1NDowNlrOHrSvpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5NzQyMQ==", "bodyText": "Can we get some documentation in these files?  Particularly a big statement at the top about what the scripts are doing.  I can see in previous update scripts in here there isn't much but we should do it in the future.\nWe'll write up a big info section in the UPGRADING.md guide and probably https://irida.corefacility.ca/documentation/administrator/upgrades/ about these but still worthwhile to add something to the files themselves.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r513697421", "createdAt": "2020-10-28T19:12:34Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/python\n+import argparse\n+from bs4 import BeautifulSoup\n+import json\n+from markdown import markdown\n+import mysql.connector\n+import re\n+\n+def create_json_file(json_file, host, user, password, database):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09c38933065c2f73c8ada70f797482f68931d95a"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQyMzExMA==", "bodyText": "Done. I'm not a great writer. Hopefully, this will suffice. Please see 19a454c.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r514423110", "createdAt": "2020-10-29T17:05:04Z", "author": {"login": "ksierks"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/python\n+import argparse\n+from bs4 import BeautifulSoup\n+import json\n+from markdown import markdown\n+import mysql.connector\n+import re\n+\n+def create_json_file(json_file, host, user, password, database):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5NzQyMQ=="}, "originalCommit": {"oid": "09c38933065c2f73c8ada70f797482f68931d95a"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE1NzkyNQ==", "bodyText": "Perfect for the block comment.  Thanks @ksierks !", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r515157925", "createdAt": "2020-10-30T14:54:06Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/python\n+import argparse\n+from bs4 import BeautifulSoup\n+import json\n+from markdown import markdown\n+import mysql.connector\n+import re\n+\n+def create_json_file(json_file, host, user, password, database):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY5NzQyMQ=="}, "originalCommit": {"oid": "09c38933065c2f73c8ada70f797482f68931d95a"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODg2MjgyOnYy", "diffSide": "RIGHT", "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxOTo0ODoyMlrOHp6zxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxODozODozM1rOHqpmYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcxNzE4OA==", "bodyText": "This is a bit pedantic, but in most cases we like to use the primitive boolean where we can in the models.  Capital B Boolean sometimes can get us into a weird tri-state since it can also be null.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r513717188", "createdAt": "2020-10-28T19:48:22Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "diffHunk": "@@ -48,10 +48,17 @@\n     @Column(name = \"created_date\", updatable = false)\n     private Date createdDate;\n \n+    @Column(name = \"title\")\n+    private String title;\n+\n     @Column(name = \"message\")\n     @Lob\n     private String message;\n \n+    @Column(name = \"priority\")\n+    @NotNull\n+    private Boolean priority;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e82ed0098fcc74120f96a3c417f4e313dbb80de2"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ4MzgwOA==", "bodyText": "Done. Please see 3b1ab44.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r514483808", "createdAt": "2020-10-29T18:38:33Z", "author": {"login": "ksierks"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "diffHunk": "@@ -48,10 +48,17 @@\n     @Column(name = \"created_date\", updatable = false)\n     private Date createdDate;\n \n+    @Column(name = \"title\")\n+    private String title;\n+\n     @Column(name = \"message\")\n     @Lob\n     private String message;\n \n+    @Column(name = \"priority\")\n+    @NotNull\n+    private Boolean priority;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcxNzE4OA=="}, "originalCommit": {"oid": "e82ed0098fcc74120f96a3c417f4e313dbb80de2"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODg3ODQ2OnYy", "diffSide": "RIGHT", "path": "src/main/resources/scripts/announcements/generate_json.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxOTo1Mjo0MlrOHp69mA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjo0MToyMFrOHrNWsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcxOTcwNA==", "bodyText": "If we're having external libraries we'll need to include install instructions for those libraries, or a script or something to install.  Something like a script to build a virutalenv or something would be good.\nIf at all possible try to use base Python libraries.  I'm guessing this case is being used to render the md to HTML to pull out the title?", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r513719704", "createdAt": "2020-10-28T19:52:42Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/python\n+import argparse\n+from bs4 import BeautifulSoup", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e82ed0098fcc74120f96a3c417f4e313dbb80de2"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA2OTYxNw==", "bodyText": "I removed the external libraries. Please see f6aae03.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r515069617", "createdAt": "2020-10-30T12:41:20Z", "author": {"login": "ksierks"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/python\n+import argparse\n+from bs4 import BeautifulSoup", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcxOTcwNA=="}, "originalCommit": {"oid": "e82ed0098fcc74120f96a3c417f4e313dbb80de2"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTAyNjI4OnYy", "diffSide": "RIGHT", "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQyMDozNDoyMlrOHp8X0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxOTowMTo0NVrOHqqdPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc0MjgwMw==", "bodyText": "This should probably also be not null.  It's a pain because we haven't set the titles yet with your python scripts.  An option would be to set a default value with the value=something tag here.  It could even be as simple as Announcement title not found.  At least that way we can set the not null constraint.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r513742803", "createdAt": "2020-10-28T20:34:22Z", "author": {"login": "tom114"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"announcement_upgrade\" author=\"katherine\">\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"title\" type=\"varchar(255)\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e82ed0098fcc74120f96a3c417f4e313dbb80de2"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ5Nzg1Mw==", "bodyText": "Done. Please see 8328ac4 and dee5891.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r514497853", "createdAt": "2020-10-29T19:01:45Z", "author": {"login": "ksierks"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/announcements_upgrade.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"announcement_upgrade\" author=\"katherine\">\n+        <addColumn tableName=\"announcement\">\n+            <column name=\"title\" type=\"varchar(255)\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc0MjgwMw=="}, "originalCommit": {"oid": "e82ed0098fcc74120f96a3c417f4e313dbb80de2"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNzgyMjc5OnYy", "diffSide": "RIGHT", "path": "src/main/resources/scripts/announcements/generate_json.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNDo1NDozNFrOHrSxwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNjoyMDoxMFrOHrWZwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE1ODQ2NQ==", "bodyText": "Since we've got this funky regex stuff going on in here can you add some inline comments on how this is working?", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r515158465", "createdAt": "2020-10-30T14:54:34Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,87 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector\n+import re\n+\n+# This script will fetch all the rows from the announcement table, then parse\n+# the title out from the message content and return a json file with the newly\n+# populated title and modified message content.\n+#\n+# Step #1: Run this script to generate a json file with the modified\n+# announcement data.\n+#\n+# Step #2: Please review the json file to make sure the title was parsed\n+# correctly from the message content.\n+#\n+# Step #3: To update the announcement table with the json file run the\n+# update_announcement.py script next.\n+\n+def create_json_file(json_file, host, user, password, database):\n+\n+    json_data = []\n+    json_file = open(json_file,\"w+\")\n+\n+    db = mysql.connector.connect(\n+        host=host,\n+        user=user,\n+        password=password,\n+        database=database\n+    )\n+    cursor = db.cursor()\n+    cursor.execute(\"SELECT id, created_date, created_by_id, title, message, priority FROM announcement\")\n+    result = cursor.fetchall()\n+    cursor.close()\n+    db.close()\n+\n+    for id, created_date, created_by_id, title, message, priority in result:\n+        \n+        if not title:\n+            lines = message.split(\"\\n\",1)\n+\n+            if len(lines) > 0:\n+                first_line = lines[0]\n+                header = re.match(r\"^#+\\s(.+)$\", first_line)\n+                \n+                if header:\n+                    title = header[1]\n+\n+                    if len(lines) > 1:\n+                        message = lines[1]\n+                else:\n+                    if len(lines) > 1:\n+                        lines = lines[1].split(\"\\n\",1)\n+\n+                        if len(lines) > 0:\n+                            second_line = lines[0]\n+                            underline = re.match(r\"^(-|=)+$\", second_line)\n+\n+                            if underline:\n+                                title = first_line\n+\n+                                if len(lines) > 1:\n+                                    message = lines[1]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dee5891e98e3ed096e2edda6065051c62087d94d"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIxNzg1Ng==", "bodyText": "Yeah, lots of if statements. Please see 649d364.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r515217856", "createdAt": "2020-10-30T16:20:10Z", "author": {"login": "ksierks"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,87 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector\n+import re\n+\n+# This script will fetch all the rows from the announcement table, then parse\n+# the title out from the message content and return a json file with the newly\n+# populated title and modified message content.\n+#\n+# Step #1: Run this script to generate a json file with the modified\n+# announcement data.\n+#\n+# Step #2: Please review the json file to make sure the title was parsed\n+# correctly from the message content.\n+#\n+# Step #3: To update the announcement table with the json file run the\n+# update_announcement.py script next.\n+\n+def create_json_file(json_file, host, user, password, database):\n+\n+    json_data = []\n+    json_file = open(json_file,\"w+\")\n+\n+    db = mysql.connector.connect(\n+        host=host,\n+        user=user,\n+        password=password,\n+        database=database\n+    )\n+    cursor = db.cursor()\n+    cursor.execute(\"SELECT id, created_date, created_by_id, title, message, priority FROM announcement\")\n+    result = cursor.fetchall()\n+    cursor.close()\n+    db.close()\n+\n+    for id, created_date, created_by_id, title, message, priority in result:\n+        \n+        if not title:\n+            lines = message.split(\"\\n\",1)\n+\n+            if len(lines) > 0:\n+                first_line = lines[0]\n+                header = re.match(r\"^#+\\s(.+)$\", first_line)\n+                \n+                if header:\n+                    title = header[1]\n+\n+                    if len(lines) > 1:\n+                        message = lines[1]\n+                else:\n+                    if len(lines) > 1:\n+                        lines = lines[1].split(\"\\n\",1)\n+\n+                        if len(lines) > 0:\n+                            second_line = lines[0]\n+                            underline = re.match(r\"^(-|=)+$\", second_line)\n+\n+                            if underline:\n+                                title = first_line\n+\n+                                if len(lines) > 1:\n+                                    message = lines[1]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE1ODQ2NQ=="}, "originalCommit": {"oid": "dee5891e98e3ed096e2edda6065051c62087d94d"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNzgyNjUyOnYy", "diffSide": "RIGHT", "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNDo1NToyNVrOHrS0CQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNjoxOToyOFrOHrWYHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE1OTA0OQ==", "bodyText": "Since this field is not null in the liquibase please add @NotNull here as well please.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r515159049", "createdAt": "2020-10-30T14:55:25Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "diffHunk": "@@ -48,10 +48,17 @@\n     @Column(name = \"created_date\", updatable = false)\n     private Date createdDate;\n \n+    @Column(name = \"title\")\n+    private String title;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dee5891e98e3ed096e2edda6065051c62087d94d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIxNzQzOA==", "bodyText": "Sorry I missed this. Please see bd781b5.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r515217438", "createdAt": "2020-10-30T16:19:28Z", "author": {"login": "ksierks"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "diffHunk": "@@ -48,10 +48,17 @@\n     @Column(name = \"created_date\", updatable = false)\n     private Date createdDate;\n \n+    @Column(name = \"title\")\n+    private String title;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE1OTA0OQ=="}, "originalCommit": {"oid": "dee5891e98e3ed096e2edda6065051c62087d94d"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyODI0NjE1OnYy", "diffSide": "RIGHT", "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNjozNToxMVrOHrW9VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNjo0MTo0M1rOHrXMcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIyNjk2NQ==", "bodyText": "Looks like an accidental addition here", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r515226965", "createdAt": "2020-10-30T16:35:11Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "diffHunk": "@@ -31,7 +31,7 @@\n  * An announcement object. Announcements can be created only by admin users, and announcements\n  * are displayed on the dashboard page.\n  */\n-@Entity\n+@Entity.sql", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "649d36421ac3535ab3a16283aac93e9e96130a64"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIzMDgzNQ==", "bodyText": "My mistake. Please see d57593d.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r515230835", "createdAt": "2020-10-30T16:41:43Z", "author": {"login": "ksierks"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/model/announcements/Announcement.java", "diffHunk": "@@ -31,7 +31,7 @@\n  * An announcement object. Announcements can be created only by admin users, and announcements\n  * are displayed on the dashboard page.\n  */\n-@Entity\n+@Entity.sql", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIyNjk2NQ=="}, "originalCommit": {"oid": "649d36421ac3535ab3a16283aac93e9e96130a64"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNTE4MjYzOnYy", "diffSide": "RIGHT", "path": "src/main/resources/scripts/announcements/generate_json.py", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDowMzozN1rOHsTxUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNTo1MTowMVrOHs1Iqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzMxNA==", "bodyText": "Unfortunately this isn't part of base python either.  You'll have to add instructions for how to install.  Please be sure to use something like a virtualenv.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516223314", "createdAt": "2020-11-02T20:03:37Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY3MDgxOA==", "bodyText": "I hope a README would suffice? I don't really know how far to go with these instructions. Can we assume the user has Python and pip already installed? Do we need to specify where the scripts are run  to be run if they use a virtual env? If they run the scripts in place with a virtual env, a folder is created with the executable files. Do we add this folder to git ignore? Please see 7a9b7ea and 776a156.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516670818", "createdAt": "2020-11-03T13:37:54Z", "author": {"login": "ksierks"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzMxNA=="}, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcxMDg1MQ==", "bodyText": "Yup I think a README would be good.  I think you can definitely assume python & pip, but in general I like when it can be (mostly) foolproof with just giving them the list of commands.\nSo like:\n\nrun this to create the venv\nrun this to activate it\nrun this to install the necessary libraries\nThen here's some basic usage for how to run the scripts.\n\nIf this was a larger and more regularily used script, I'd say we need a full blown install process (such as the one with the IRIDA uploader https://github.com/phac-nml/irida-uploader/blob/development/Makefile).  In this case since its a \"run once and forget it\" thing I think just some instructions is fine.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516710851", "createdAt": "2020-11-03T14:33:50Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzMxNA=="}, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcyODM2Ng==", "bodyText": "Please see cad41a5 and 9fdf41f.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516728366", "createdAt": "2020-11-03T14:55:47Z", "author": {"login": "ksierks"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzMxNA=="}, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc2OTk2Mw==", "bodyText": "That looks great.  Thanks!", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516769963", "createdAt": "2020-11-03T15:51:01Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzMxNA=="}, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNTE5MjEzOnYy", "diffSide": "RIGHT", "path": "src/main/resources/scripts/announcements/generate_json.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDowNjoyOVrOHsT2_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMzozNTo1NlrOHsvAnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyNDc2NQ==", "bodyText": "Typically we've used the defaults as the defaults of our test database.  Use test/test for the defaults for user/password please.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516224765", "createdAt": "2020-11-02T20:06:29Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector\n+import re\n+\n+# This script will fetch all the rows from the announcement table, then parse\n+# the title out from the message content and return a json file with the newly\n+# populated title and modified message content.\n+#\n+# Step #1: Run this script to generate a json file with the modified\n+# announcement data.\n+#\n+# Step #2: Please review the json file to make sure the title was parsed\n+# correctly from the message content.\n+#\n+# Step #3: To update the announcement table with the json file run the\n+# update_announcement.py script next.\n+\n+def create_json_file(json_file, host, user, password, database):\n+\n+    json_data = []\n+    json_file = open(json_file,\"w+\")\n+\n+    db = mysql.connector.connect(\n+        host=host,\n+        user=user,\n+        password=password,\n+        database=database\n+    )\n+    cursor = db.cursor()\n+    cursor.execute(\"SELECT id, created_date, created_by_id, title, message, priority FROM announcement\")\n+    result = cursor.fetchall()\n+    cursor.close()\n+    db.close()\n+\n+    for id, created_date, created_by_id, title, message, priority in result:\n+        \n+        if not title:\n+            # split the message into two,\n+            # the first line and the rest of the message\n+            lines = message.split(\"\\n\",1)\n+\n+            if len(lines) > 0:\n+                # check if the first line in the message is a header\n+                # by trying to find number signs in front of a word\n+                first_line = lines[0]\n+                header = re.match(r\"^#+\\s(.+)$\", first_line)\n+                \n+                if header:\n+                    title = header[1]\n+\n+                    if len(lines) > 1:\n+                        message = lines[1]\n+                else:\n+                    if len(lines) > 1:\n+                        # split the rest of the message into two again,\n+                        # the first line and the rest of the message\n+                        lines = lines[1].split(\"\\n\",1)\n+\n+                        if len(lines) > 0:\n+                            # check if the second line in the message is a header\n+                            # by trying to find any number of = or - characters\n+                            second_line = lines[0]\n+                            underline = re.match(r\"^(-|=)+$\", second_line)\n+\n+                            if underline:\n+                                title = first_line\n+\n+                                if len(lines) > 1:\n+                                    message = lines[1]\n+\n+            json_data.append({\"id\":id, \"created_date\":created_date, \"created_by_id\":created_by_id, \"title\":title, \"message\":message, \"priority\":priority})\n+\n+    # convert the list to a JSON string\n+    json_string = json.dumps(json_data, indent=2, default=str)\n+    json_file.write(json_string)\n+    json_file.close()\n+\n+\n+def main():\n+    parser = argparse.ArgumentParser()\n+\n+    parser.add_argument( 'json_file', help=\"The output json file of announcement titles to be populated.\")\n+    parser.add_argument( '--host', default='localhost', help=\"The database host name.\", required=False)\n+    parser.add_argument( '--database', default='irida_test', help=\"The database name.\", required=False)\n+    parser.add_argument( '--user', default='root', help=\"The database user name.\", required=False)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY2OTU5Nw==", "bodyText": "Please see f79d1ff.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516669597", "createdAt": "2020-11-03T13:35:56Z", "author": {"login": "ksierks"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector\n+import re\n+\n+# This script will fetch all the rows from the announcement table, then parse\n+# the title out from the message content and return a json file with the newly\n+# populated title and modified message content.\n+#\n+# Step #1: Run this script to generate a json file with the modified\n+# announcement data.\n+#\n+# Step #2: Please review the json file to make sure the title was parsed\n+# correctly from the message content.\n+#\n+# Step #3: To update the announcement table with the json file run the\n+# update_announcement.py script next.\n+\n+def create_json_file(json_file, host, user, password, database):\n+\n+    json_data = []\n+    json_file = open(json_file,\"w+\")\n+\n+    db = mysql.connector.connect(\n+        host=host,\n+        user=user,\n+        password=password,\n+        database=database\n+    )\n+    cursor = db.cursor()\n+    cursor.execute(\"SELECT id, created_date, created_by_id, title, message, priority FROM announcement\")\n+    result = cursor.fetchall()\n+    cursor.close()\n+    db.close()\n+\n+    for id, created_date, created_by_id, title, message, priority in result:\n+        \n+        if not title:\n+            # split the message into two,\n+            # the first line and the rest of the message\n+            lines = message.split(\"\\n\",1)\n+\n+            if len(lines) > 0:\n+                # check if the first line in the message is a header\n+                # by trying to find number signs in front of a word\n+                first_line = lines[0]\n+                header = re.match(r\"^#+\\s(.+)$\", first_line)\n+                \n+                if header:\n+                    title = header[1]\n+\n+                    if len(lines) > 1:\n+                        message = lines[1]\n+                else:\n+                    if len(lines) > 1:\n+                        # split the rest of the message into two again,\n+                        # the first line and the rest of the message\n+                        lines = lines[1].split(\"\\n\",1)\n+\n+                        if len(lines) > 0:\n+                            # check if the second line in the message is a header\n+                            # by trying to find any number of = or - characters\n+                            second_line = lines[0]\n+                            underline = re.match(r\"^(-|=)+$\", second_line)\n+\n+                            if underline:\n+                                title = first_line\n+\n+                                if len(lines) > 1:\n+                                    message = lines[1]\n+\n+            json_data.append({\"id\":id, \"created_date\":created_date, \"created_by_id\":created_by_id, \"title\":title, \"message\":message, \"priority\":priority})\n+\n+    # convert the list to a JSON string\n+    json_string = json.dumps(json_data, indent=2, default=str)\n+    json_file.write(json_string)\n+    json_file.close()\n+\n+\n+def main():\n+    parser = argparse.ArgumentParser()\n+\n+    parser.add_argument( 'json_file', help=\"The output json file of announcement titles to be populated.\")\n+    parser.add_argument( '--host', default='localhost', help=\"The database host name.\", required=False)\n+    parser.add_argument( '--database', default='irida_test', help=\"The database name.\", required=False)\n+    parser.add_argument( '--user', default='root', help=\"The database user name.\", required=False)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyNDc2NQ=="}, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 87}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNTMwMzYzOnYy", "diffSide": "RIGHT", "path": "src/main/resources/scripts/announcements/generate_json.py", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDo0MToyOVrOHsU5cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNTo1MToyNVrOHs1J2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MTc3OQ==", "bodyText": "Kinda a funky oops here.  You select for title, but since we're automatically adding the fake title to the announcements in the liquibase it means that none of them get added to this file.  If you remove this if it works as expected.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516241779", "createdAt": "2020-11-02T20:41:29Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector\n+import re\n+\n+# This script will fetch all the rows from the announcement table, then parse\n+# the title out from the message content and return a json file with the newly\n+# populated title and modified message content.\n+#\n+# Step #1: Run this script to generate a json file with the modified\n+# announcement data.\n+#\n+# Step #2: Please review the json file to make sure the title was parsed\n+# correctly from the message content.\n+#\n+# Step #3: To update the announcement table with the json file run the\n+# update_announcement.py script next.\n+\n+def create_json_file(json_file, host, user, password, database):\n+\n+    json_data = []\n+    json_file = open(json_file,\"w+\")\n+\n+    db = mysql.connector.connect(\n+        host=host,\n+        user=user,\n+        password=password,\n+        database=database\n+    )\n+    cursor = db.cursor()\n+    cursor.execute(\"SELECT id, created_date, created_by_id, title, message, priority FROM announcement\")\n+    result = cursor.fetchall()\n+    cursor.close()\n+    db.close()\n+\n+    for id, created_date, created_by_id, title, message, priority in result:\n+        \n+        if not title:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY2NTU2MQ==", "bodyText": "I forgot we changed the title to auto populate the title. I didn't think about the downstream effects. I changed the if statement to check that the message is populated. As long as the message comes back as an empty string, it's not needed. Please see 5e99a12.", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516665561", "createdAt": "2020-11-03T13:29:25Z", "author": {"login": "ksierks"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector\n+import re\n+\n+# This script will fetch all the rows from the announcement table, then parse\n+# the title out from the message content and return a json file with the newly\n+# populated title and modified message content.\n+#\n+# Step #1: Run this script to generate a json file with the modified\n+# announcement data.\n+#\n+# Step #2: Please review the json file to make sure the title was parsed\n+# correctly from the message content.\n+#\n+# Step #3: To update the announcement table with the json file run the\n+# update_announcement.py script next.\n+\n+def create_json_file(json_file, host, user, password, database):\n+\n+    json_data = []\n+    json_file = open(json_file,\"w+\")\n+\n+    db = mysql.connector.connect(\n+        host=host,\n+        user=user,\n+        password=password,\n+        database=database\n+    )\n+    cursor = db.cursor()\n+    cursor.execute(\"SELECT id, created_date, created_by_id, title, message, priority FROM announcement\")\n+    result = cursor.fetchall()\n+    cursor.close()\n+    db.close()\n+\n+    for id, created_date, created_by_id, title, message, priority in result:\n+        \n+        if not title:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MTc3OQ=="}, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc3MDI2Ng==", "bodyText": "That seems to work now.  Thanks", "url": "https://github.com/phac-nml/irida/pull/844#discussion_r516770266", "createdAt": "2020-11-03T15:51:25Z", "author": {"login": "tom114"}, "path": "src/main/resources/scripts/announcements/generate_json.py", "diffHunk": "@@ -0,0 +1,95 @@\n+#!/usr/bin/python\n+import argparse\n+import json\n+import mysql.connector\n+import re\n+\n+# This script will fetch all the rows from the announcement table, then parse\n+# the title out from the message content and return a json file with the newly\n+# populated title and modified message content.\n+#\n+# Step #1: Run this script to generate a json file with the modified\n+# announcement data.\n+#\n+# Step #2: Please review the json file to make sure the title was parsed\n+# correctly from the message content.\n+#\n+# Step #3: To update the announcement table with the json file run the\n+# update_announcement.py script next.\n+\n+def create_json_file(json_file, host, user, password, database):\n+\n+    json_data = []\n+    json_file = open(json_file,\"w+\")\n+\n+    db = mysql.connector.connect(\n+        host=host,\n+        user=user,\n+        password=password,\n+        database=database\n+    )\n+    cursor = db.cursor()\n+    cursor.execute(\"SELECT id, created_date, created_by_id, title, message, priority FROM announcement\")\n+    result = cursor.fetchall()\n+    cursor.close()\n+    db.close()\n+\n+    for id, created_date, created_by_id, title, message, priority in result:\n+        \n+        if not title:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MTc3OQ=="}, "originalCommit": {"oid": "d57593d3e1ae927a707170237a803d18d7edb1c3"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 790, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}