{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0ODg0OTU2", "number": 849, "title": "Add html result viewer", "bodyText": "Description of changes\nWhat did you change in this pull request?  Provide a description of files changed, user interactions changed, etc.  Include how to test your changes.\nAdd html result viewer for analyses that output html files\nAs none of the pipelines within IRIDA output single html files we must do the following to test it\n\nGet the files from irida-sample-data available at https://irida.corefacility.ca/downloads/data/irida-sample-data.zip. Within there go into the miseq-run-salmonella directory and upload the 2 files (AE014613_S1_L001_R1_001.fastq.gz and AE014613_S1_L001_R2_001.fastq.gz) into a sample.\nRun the SISTR analysis pipeline\nOnce it's complete, create an html file using a text editor with a basic heading etc in it\nIn the mysql database > analysis_output_file table update the file_path for one of the output files from the analysis above. For example if a file is saved as 26/0/FILENAME.EXT then update it to 26/0/FILENAME.html\nMove your html file to the path in the above step. The path where the file should be is /opt/irida/data/output/26/0/.\n\nNote the 26 in the path above will be different. Once the sistr analysis completes, within your terminal/intellij console you should see which paths the output files were copied to.\nRelated issue\nLink to the GitHub issue this pull request addresses using the #issuenum format.  If it completes an issue, use Fixes #issuenum to automatically close the issue.\nFixes #164\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n* [ ] Tests added (or description of how to test) for any new features.\n* [ ] User documentation updated for UI or technical changes.", "createdAt": "2020-11-03T17:22:41Z", "url": "https://github.com/phac-nml/irida/pull/849", "merged": true, "mergeCommit": {"oid": "6942f3a9a21d5561acfb22908c53e8b64b9b022d"}, "closed": true, "closedAt": "2021-01-11T15:36:45Z", "author": {"login": "deepsidhu85"}, "timelineItems": {"totalCount": 33, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdY8gwZAH2gAyNTE0ODg0OTU2OmYwNTIxMjgxMWRiZWZhODEwOTEzZDU5YzkzODdmYTBhN2FhZTZiZjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdvIXXJAFqTU2NTQ2OTIwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f05212811dbefa810913d59c9387fa0a7aae6bf7", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/f05212811dbefa810913d59c9387fa0a7aae6bf7", "committedDate": "2020-11-03T17:21:30Z", "message": "Added html viewer for analyses that output html files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b716ba4ef20348a402671ca75b7609aea6694c4", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/4b716ba4ef20348a402671ca75b7609aea6694c4", "committedDate": "2020-11-03T17:22:07Z", "message": "Merge branch 'development' into add-html-result-viewer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81a7f0f4fba17564d339087790637315eb503520", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/81a7f0f4fba17564d339087790637315eb503520", "committedDate": "2020-11-03T18:56:07Z", "message": "Updated api call to throw an error if one is returned. Fixed formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "800391c3427e2c9f16a05b727cb23c20265e08de", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/800391c3427e2c9f16a05b727cb23c20265e08de", "committedDate": "2020-11-03T18:57:08Z", "message": "Updated CHANGELOG"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d04040ae0f2e72cf9742b040a5f767e6b4b917e", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/0d04040ae0f2e72cf9742b040a5f767e6b4b917e", "committedDate": "2020-11-04T15:15:21Z", "message": "Updated api url"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c797de7d0d890c99dc7fb92d23d6d9b4763f7f89", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/c797de7d0d890c99dc7fb92d23d6d9b4763f7f89", "committedDate": "2020-11-04T15:36:46Z", "message": "Fixed issue with html data being undefined"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8663e42a304c0afa42ac276fa812d231994d25c", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/b8663e42a304c0afa42ac276fa812d231994d25c", "committedDate": "2020-11-04T17:19:55Z", "message": "Changed to using an iframe."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68daf3b89cfb568f4f1aedf9d4817134b02c733e", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/68daf3b89cfb568f4f1aedf9d4817134b02c733e", "committedDate": "2020-11-04T19:59:48Z", "message": "Removed file not required. Updated html output iframe to use border. Removed code not required in analysisajaxcontroller."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "725d7fe8edf2684a257bbdb84d8f9b6a44858458", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/725d7fe8edf2684a257bbdb84d8f9b6a44858458", "committedDate": "2020-11-04T20:00:26Z", "message": "Changed frameBorder to 0 for iframe"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ebd843cfcae68d728042fae36db8c5b74284991", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/8ebd843cfcae68d728042fae36db8c5b74284991", "committedDate": "2020-11-05T11:25:59Z", "message": "Added link icon to the open button"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88cc7a3dba682122386c6118ca24ea7786d5b689", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/88cc7a3dba682122386c6118ca24ea7786d5b689", "committedDate": "2020-11-05T14:51:30Z", "message": "Removed api call not required"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d28bc684f81e7e6d7a5b28b15005830a86d49f4d", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/d28bc684f81e7e6d7a5b28b15005830a86d49f4d", "committedDate": "2020-11-05T14:55:09Z", "message": "Added missing javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e679bcc7ed83ae50123fac1dd468effd5359085e", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/e679bcc7ed83ae50123fac1dd468effd5359085e", "committedDate": "2020-11-05T14:59:54Z", "message": "Merge pull request #851 from phac-nml/add-html-result-viewer-iframe\n\nChanged to using an iframe."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4460c5faf3abadfbe36e5e5b8d758c5d50f69107", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/4460c5faf3abadfbe36e5e5b8d758c5d50f69107", "committedDate": "2020-11-05T15:20:51Z", "message": "Added documentation on adding css/js to html output for it to work in viewer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cefe4e3f1dcfb022c3195128a5e60257b03d84a4", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/cefe4e3f1dcfb022c3195128a5e60257b03d84a4", "committedDate": "2020-11-05T15:21:51Z", "message": "Removed finally block"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1df94bb4c184736cae511e9c9e6cbda54815147d", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/1df94bb4c184736cae511e9c9e6cbda54815147d", "committedDate": "2020-11-17T16:53:08Z", "message": "Merged dev and fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bd4187c2661666a078d4546a36965f4e93c3d70", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/9bd4187c2661666a078d4546a36965f4e93c3d70", "committedDate": "2020-11-18T21:22:17Z", "message": "Merged update to chromedriver 87 and fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e44c473e943c064b2d7a2540199b7f546abfcb69", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/e44c473e943c064b2d7a2540199b7f546abfcb69", "committedDate": "2020-11-23T16:33:01Z", "message": "Merge branch 'development' into add-html-result-viewer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7190a79bca71a2ac4df951f9694c188bce593e83", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/7190a79bca71a2ac4df951f9694c188bce593e83", "committedDate": "2020-11-30T20:50:28Z", "message": "Merged dev and fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "542a7e9675be7467bd23f922ecfda2b0395442a4", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/542a7e9675be7467bd23f922ecfda2b0395442a4", "committedDate": "2020-12-02T17:09:54Z", "message": "Merged dev and fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "850e2844ea5e61e32eed37c88bea37733a784ece", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/850e2844ea5e61e32eed37c88bea37733a784ece", "committedDate": "2020-12-02T19:08:55Z", "message": "Merge branch 'development' into add-html-result-viewer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22bd83cb062ed613bb137bcd34f6ebd413cdee30", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/22bd83cb062ed613bb137bcd34f6ebd413cdee30", "committedDate": "2020-12-08T22:15:58Z", "message": "Merged dev and fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c69fc2f495238f2cbd5943c49b6c3d0ec24bfa80", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/c69fc2f495238f2cbd5943c49b6c3d0ec24bfa80", "committedDate": "2020-12-21T02:50:52Z", "message": "Merged dev and fixed merge conflicts:"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b33f973411760eb43ead9ad69b6fe10e0eb6a6bf", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/b33f973411760eb43ead9ad69b6fe10e0eb6a6bf", "committedDate": "2020-12-24T20:33:34Z", "message": "Merged dev and fixed merge conflict"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxMzI4ODAz", "url": "https://github.com/phac-nml/irida/pull/849#pullrequestreview-561328803", "createdAt": "2021-01-04T20:39:54Z", "commit": {"oid": "b33f973411760eb43ead9ad69b6fe10e0eb6a6bf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQyMDozOTo1NFrOIOAUxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQyMDozOTo1NFrOIOAUxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTU1NjI5Mg==", "bodyText": "An issue I can see with this is if the HTML file is really big.  I've seen some tools which may (for example) dump a pile of data in a javascript object for displaying a result on a page.  In a case like this loading everything into a string in memory could cause a problem.\nAlternative: can we stream this output directly as a response?  I think you can do something like that but I can't find an example in our existing codebase.  I know you can get a handle on the request & response objects in the controllers and write to them similar to what we do in FastqView.  Can you check if that's possible for these purposes as well?", "url": "https://github.com/phac-nml/irida/pull/849#discussion_r551556292", "createdAt": "2021-01-04T20:39:54Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/analysis/AnalysisController.java", "diffHunk": "@@ -151,4 +162,47 @@ public String getAdvancedPhylogeneticVisualizationPage(@PathVariable Long submis\n \t\tmodel.addAttribute(\"submission\", submission);\n \t\treturn BASE + \"visualizations/phylocanvas-metadata\";\n \t}\n+\n+\t/**\n+\t * Get the html page from the file name provided.\n+\t *\n+\t * @param submissionId {@link Long} identifier for an {@link AnalysisSubmission}\n+\t * @param filename     The html file name\n+\t * @param model        {@link Model}\n+\t * @param locale       User's locale\n+\t * @return {@link String} path to the page template.\n+\t */\n+\t@RequestMapping(\"/{submissionId}/html-output\")\n+\tpublic String getHtmlOutputForSubmission(@PathVariable Long submissionId, @RequestParam String filename,\n+\t\t\tModel model, Locale locale) {\n+\t\tAnalysisSubmission submission = analysisSubmissionService.read(submissionId);\n+\t\tSet<AnalysisOutputFile> files = submission.getAnalysis()\n+\t\t\t\t.getAnalysisOutputFiles();\n+\t\tAnalysisOutputFile outputFile = null;\n+\t\tString htmlExt = \"html\";\n+\t\tString htmlOutput = \"\";\n+\n+\t\tfor (AnalysisOutputFile file : files) {\n+\t\t\tif (file.getFile()\n+\t\t\t\t\t.toFile()\n+\t\t\t\t\t.getName()\n+\t\t\t\t\t.contains(filename) && FilenameUtils.getExtension(filename)\n+\t\t\t\t\t.equals(htmlExt)) {\n+\t\t\t\toutputFile = file;\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t}\n+\n+\t\ttry {\n+\t\t\thtmlOutput = FileUtils.readFileToString(outputFile.getFile()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b33f973411760eb43ead9ad69b6fe10e0eb6a6bf"}, "originalPosition": 91}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9123a19284ed01987451861e3da27613ae05b86", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/f9123a19284ed01987451861e3da27613ae05b86", "committedDate": "2021-01-06T19:10:53Z", "message": "Updated retrieval of html from file to stream input into the response outputstream rather than reading it into memory. Added translation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "694675faff1c81b67d390e1833219a4622e7275c", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/694675faff1c81b67d390e1833219a4622e7275c", "committedDate": "2021-01-06T19:25:21Z", "message": "Merged dev and fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f2c5a55bec80b281d95705dae38916805d18f4c", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/7f2c5a55bec80b281d95705dae38916805d18f4c", "committedDate": "2021-01-06T20:06:43Z", "message": "Added param and throws tags to javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7da7cf08c865e829a8358783db91f52628c4caed", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/7da7cf08c865e829a8358783db91f52628c4caed", "committedDate": "2021-01-07T16:07:42Z", "message": "Merged dev and fixed merge conflict"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY0NDQwNzc5", "url": "https://github.com/phac-nml/irida/pull/849#pullrequestreview-564440779", "createdAt": "2021-01-08T17:19:28Z", "commit": {"oid": "7da7cf08c865e829a8358783db91f52628c4caed"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOFQxNzoxOToyOFrOIQageQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOFQxNzoyMToyMFrOIQak6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDA4MjQyNQ==", "bodyText": "I think the browser will handle things without this response header.  It looks like it should just stream the response.  That way if there's some filesystem size hiccup here it won't make the browser freak out that the content is different than the size it recieved.", "url": "https://github.com/phac-nml/irida/pull/849#discussion_r554082425", "createdAt": "2021-01-08T17:19:28Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/analysis/AnalysisController.java", "diffHunk": "@@ -151,4 +167,59 @@ public String getAdvancedPhylogeneticVisualizationPage(@PathVariable Long submis\n \t\tmodel.addAttribute(\"submission\", submission);\n \t\treturn BASE + \"visualizations/phylocanvas-metadata\";\n \t}\n+\n+\t/**\n+\t * Get the html page from the file name provided.\n+\t *\n+\t * @param submissionId {@link Long} identifier for an {@link AnalysisSubmission}\n+\t * @param filename     The html file name\n+\t * @param locale       User's locale\n+\t * @param response     {@link HttpServletResponse}\n+\t * @throws IOException if we can't write the file to the response\n+\t */\n+\t@RequestMapping(\"/{submissionId}/html-output\")\n+\tpublic void getHtmlOutputForSubmission(@PathVariable Long submissionId, @RequestParam String filename,\n+\t\t\tLocale locale, HttpServletResponse response) throws IOException {\n+\t\tAnalysisSubmission submission = analysisSubmissionService.read(submissionId);\n+\t\tSet<AnalysisOutputFile> files = submission.getAnalysis()\n+\t\t\t\t.getAnalysisOutputFiles();\n+\t\tAnalysisOutputFile outputFile = null;\n+\t\tString htmlExt = \"html\";\n+\n+\t\tfor (AnalysisOutputFile file : files) {\n+\t\t\tif (file.getFile()\n+\t\t\t\t\t.toFile()\n+\t\t\t\t\t.getName()\n+\t\t\t\t\t.contains(filename) && FilenameUtils.getExtension(filename)\n+\t\t\t\t\t.equals(htmlExt)) {\n+\t\t\t\toutputFile = file;\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t}\n+\n+\t\t// Set the common Http headers\n+\t\tresponse.setHeader(HttpHeaders.CONTENT_DISPOSITION, \"inline\");\n+\t\tresponse.setHeader(HttpHeaders.CONTENT_TYPE, \"text/html\");\n+\n+\t\ttry (InputStream inputStream = new FileInputStream(outputFile.getFile()\n+\t\t\t\t.toString()); OutputStream outputStream = response.getOutputStream()) {\n+\t\t\tresponse.setHeader(HttpHeaders.CONTENT_LENGTH, String.valueOf(Files.size(outputFile.getFile())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7da7cf08c865e829a8358783db91f52628c4caed"}, "originalPosition": 104}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDA4MzU2MA==", "bodyText": "The output stream will get closed anyway with the try-with-resources block right?  Is this needed?", "url": "https://github.com/phac-nml/irida/pull/849#discussion_r554083560", "createdAt": "2021-01-08T17:21:20Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/analysis/AnalysisController.java", "diffHunk": "@@ -151,4 +167,59 @@ public String getAdvancedPhylogeneticVisualizationPage(@PathVariable Long submis\n \t\tmodel.addAttribute(\"submission\", submission);\n \t\treturn BASE + \"visualizations/phylocanvas-metadata\";\n \t}\n+\n+\t/**\n+\t * Get the html page from the file name provided.\n+\t *\n+\t * @param submissionId {@link Long} identifier for an {@link AnalysisSubmission}\n+\t * @param filename     The html file name\n+\t * @param locale       User's locale\n+\t * @param response     {@link HttpServletResponse}\n+\t * @throws IOException if we can't write the file to the response\n+\t */\n+\t@RequestMapping(\"/{submissionId}/html-output\")\n+\tpublic void getHtmlOutputForSubmission(@PathVariable Long submissionId, @RequestParam String filename,\n+\t\t\tLocale locale, HttpServletResponse response) throws IOException {\n+\t\tAnalysisSubmission submission = analysisSubmissionService.read(submissionId);\n+\t\tSet<AnalysisOutputFile> files = submission.getAnalysis()\n+\t\t\t\t.getAnalysisOutputFiles();\n+\t\tAnalysisOutputFile outputFile = null;\n+\t\tString htmlExt = \"html\";\n+\n+\t\tfor (AnalysisOutputFile file : files) {\n+\t\t\tif (file.getFile()\n+\t\t\t\t\t.toFile()\n+\t\t\t\t\t.getName()\n+\t\t\t\t\t.contains(filename) && FilenameUtils.getExtension(filename)\n+\t\t\t\t\t.equals(htmlExt)) {\n+\t\t\t\toutputFile = file;\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t}\n+\n+\t\t// Set the common Http headers\n+\t\tresponse.setHeader(HttpHeaders.CONTENT_DISPOSITION, \"inline\");\n+\t\tresponse.setHeader(HttpHeaders.CONTENT_TYPE, \"text/html\");\n+\n+\t\ttry (InputStream inputStream = new FileInputStream(outputFile.getFile()\n+\t\t\t\t.toString()); OutputStream outputStream = response.getOutputStream()) {\n+\t\t\tresponse.setHeader(HttpHeaders.CONTENT_LENGTH, String.valueOf(Files.size(outputFile.getFile())));\n+\t\t\t// Copy the file contents to the response outputstream\n+\t\t\tIOUtils.copy(inputStream, outputStream);\n+\t\t} catch (IOException e) {\n+\t\t\tlogger.debug(\"Html output not found.\");\n+\t\t\tresponse.setHeader(HttpHeaders.CONTENT_LENGTH, \"0\");\n+\t\t\tString htmlOutputNotFound = messageSource.getMessage(\"analysis.html.file.not.found\",\n+\t\t\t\t\tnew Object[] { filename }, locale);\n+\t\t\tOutputStream outputStream = response.getOutputStream();\n+\t\t\t/*\n+\t\t\tWrite the htmlNotFound message to the outputstream. We do this\n+\t\t\tso that the page doesn't error and will instead display the\n+\t\t\tmessage.\n+\t\t\t */\n+\t\t\toutputStream.write(htmlOutputNotFound.getBytes(StandardCharsets.UTF_8));\n+\t\t\toutputStream.flush();\n+\t\t\toutputStream.close();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7da7cf08c865e829a8358783db91f52628c4caed"}, "originalPosition": 120}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c116df5695ce8f3b89c8013f76a705e6dd3482f", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/1c116df5695ce8f3b89c8013f76a705e6dd3482f", "committedDate": "2021-01-08T22:03:44Z", "message": "Removed content lengh from response header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35a62ae804ec11f074327353a7bb4742c74ab816", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/35a62ae804ec11f074327353a7bb4742c74ab816", "committedDate": "2021-01-08T22:06:44Z", "message": "Removed unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1NDY5MjA3", "url": "https://github.com/phac-nml/irida/pull/849#pullrequestreview-565469207", "createdAt": "2021-01-11T15:36:26Z", "commit": {"oid": "35a62ae804ec11f074327353a7bb4742c74ab816"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4943, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}