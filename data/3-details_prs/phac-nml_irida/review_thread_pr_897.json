{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1MDAxNTY3", "number": 897, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxOTozMzo0NVrOFLBXyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QyMDozMTo1NVrOFOUoPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ3MTAxMTMxOnYy", "diffSide": "RIGHT", "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/analysis-submission-email-pipeline-result-on-error.xml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxOTozMzo0NVrOIN-TvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxOToxMjowNVrOIPTAUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTUyMzI2MA==", "bodyText": "Can you use the renameColumn thing fom liquibase instead of the custom sql?  https://docs.liquibase.com/change-types/community/rename-column.html", "url": "https://github.com/phac-nml/irida/pull/897#discussion_r551523260", "createdAt": "2021-01-04T19:33:45Z", "author": {"login": "tom114"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/analysis-submission-email-pipeline-result-on-error.xml", "diffHunk": "@@ -0,0 +1,26 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"analysis-submission-email-pipeline-result-on-error\" author=\"deep\">\n+        <addColumn tableName=\"analysis_submission\">\n+            <column name=\"email_pipeline_result_error\" type=\"bit(1)\" valueBoolean=\"false\"\n+                    defaultValueBoolean=\"false\">\n+                <constraints nullable=\"false\" />\n+            </column>\n+        </addColumn>\n+\n+        <addColumn tableName=\"analysis_submission_AUD\">\n+            <column name=\"email_pipeline_result_error\" type=\"bit(1)\" />\n+        </addColumn>\n+\n+        <!--Updating analysis submission table to change column email_pipeline_result to email_pipeline_result_completed -->\n+        <sql>\n+            ALTER TABLE analysis_submission CHANGE email_pipeline_result email_pipeline_result_completed BIT(1) not null DEFAULT 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e6a110b45ff8cb2373411b13da296d030426453"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTU2NDE5MA==", "bodyText": "Sure thing!", "url": "https://github.com/phac-nml/irida/pull/897#discussion_r551564190", "createdAt": "2021-01-04T20:56:46Z", "author": {"login": "deepsidhu85"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/analysis-submission-email-pipeline-result-on-error.xml", "diffHunk": "@@ -0,0 +1,26 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"analysis-submission-email-pipeline-result-on-error\" author=\"deep\">\n+        <addColumn tableName=\"analysis_submission\">\n+            <column name=\"email_pipeline_result_error\" type=\"bit(1)\" valueBoolean=\"false\"\n+                    defaultValueBoolean=\"false\">\n+                <constraints nullable=\"false\" />\n+            </column>\n+        </addColumn>\n+\n+        <addColumn tableName=\"analysis_submission_AUD\">\n+            <column name=\"email_pipeline_result_error\" type=\"bit(1)\" />\n+        </addColumn>\n+\n+        <!--Updating analysis submission table to change column email_pipeline_result to email_pipeline_result_completed -->\n+        <sql>\n+            ALTER TABLE analysis_submission CHANGE email_pipeline_result email_pipeline_result_completed BIT(1) not null DEFAULT 0;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTUyMzI2MA=="}, "originalCommit": {"oid": "9e6a110b45ff8cb2373411b13da296d030426453"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjkxMDkyOA==", "bodyText": "Updated in 741ea9a", "url": "https://github.com/phac-nml/irida/pull/897#discussion_r552910928", "createdAt": "2021-01-06T19:12:05Z", "author": {"login": "deepsidhu85"}, "path": "src/main/resources/ca/corefacility/bioinformatics/irida/database/changesets/21.01/analysis-submission-email-pipeline-result-on-error.xml", "diffHunk": "@@ -0,0 +1,26 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n+         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"analysis-submission-email-pipeline-result-on-error\" author=\"deep\">\n+        <addColumn tableName=\"analysis_submission\">\n+            <column name=\"email_pipeline_result_error\" type=\"bit(1)\" valueBoolean=\"false\"\n+                    defaultValueBoolean=\"false\">\n+                <constraints nullable=\"false\" />\n+            </column>\n+        </addColumn>\n+\n+        <addColumn tableName=\"analysis_submission_AUD\">\n+            <column name=\"email_pipeline_result_error\" type=\"bit(1)\" />\n+        </addColumn>\n+\n+        <!--Updating analysis submission table to change column email_pipeline_result to email_pipeline_result_completed -->\n+        <sql>\n+            ALTER TABLE analysis_submission CHANGE email_pipeline_result email_pipeline_result_completed BIT(1) not null DEFAULT 0;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTUyMzI2MA=="}, "originalCommit": {"oid": "9e6a110b45ff8cb2373411b13da296d030426453"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUwNTYyMzY1OnYy", "diffSide": "RIGHT", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/pipelines/PipelineController.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QyMDozMTo1NVrOITBAIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QyMjo1NDoxNlrOITIZ9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjgxMDI3NA==", "bodyText": "Again kinda a weird logic thing here with the way this is named.  If you select the \"error\" dropdown, emailPipelineResultError is true.  If you select the \"completion (error or success)\" dropdown, emailPipelineResultCompleted is true.  The names of the variables would suggest though that with the 2nd dropdown \"completion (error or success)\" that both of these values would be true.\nIf you want to keep it that only 1 of these will be true, I think it would be better set as an enum or something on AnalysisSubmission rather than the 2 boolean to indicate the \"level\" of email that will be sent here None, Error, Completion or All or something.", "url": "https://github.com/phac-nml/irida/pull/897#discussion_r556810274", "createdAt": "2021-01-13T20:31:55Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/pipelines/PipelineController.java", "diffHunk": "@@ -471,7 +471,8 @@ private String localizedParamOptionLabel(Locale locale, String workflowName, Str\n \n             String analysisDescription = parameters.getDescription();\n             Boolean writeResultsToSamples = parameters.getWriteResultsToSamples();\n-            Boolean emailPipelineResult = parameters.getEmailPipelineResult();\n+            Boolean emailPipelineResultCompleted = parameters.getEmailPipelineResultCompleted();\n+            Boolean emailPipelineResultError = parameters.getEmailPipelineResultError();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e26dcc0758db6810781cafcc08005ac315da511b"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjkzMTU3NA==", "bodyText": "Thanks for taking a look at that. I updated it so that both email_pipeline_result_completed and email_pipeline_result_error are set to true if the completion (error or success) option is selected. Also, updated the required-data.sql. I for some reason always forget about it. Updated in b3f3e8b", "url": "https://github.com/phac-nml/irida/pull/897#discussion_r556931574", "createdAt": "2021-01-13T22:54:16Z", "author": {"login": "deepsidhu85"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/pipelines/PipelineController.java", "diffHunk": "@@ -471,7 +471,8 @@ private String localizedParamOptionLabel(Locale locale, String workflowName, Str\n \n             String analysisDescription = parameters.getDescription();\n             Boolean writeResultsToSamples = parameters.getWriteResultsToSamples();\n-            Boolean emailPipelineResult = parameters.getEmailPipelineResult();\n+            Boolean emailPipelineResultCompleted = parameters.getEmailPipelineResultCompleted();\n+            Boolean emailPipelineResultError = parameters.getEmailPipelineResultError();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjgxMDI3NA=="}, "originalCommit": {"oid": "e26dcc0758db6810781cafcc08005ac315da511b"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 621, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}