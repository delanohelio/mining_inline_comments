{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQxMjIyOTEy", "number": 892, "title": "Announcements upgrade user dashboard", "bodyText": "Description of changes\nPrototype from Josh:\n\nBefore:\n\nAfter:\n\n\n\n\nThe announcements section on the dashboard will be moved under the main navigation bar as the dropdown when the new bell icon is clicked.\nA modal window displays the announcements details, because there was discussion around the idea of possibly having new high priority announcements displayed as soon as the user logs in.\nThe 'Mark as Read' functionality is now triggered when the modal windows closes.\n\nRelated issue\nLink to the GitHub issue this pull request addresses using the #issuenum format.  If it completes an issue, use Fixes #issuenum to automatically close the issue.\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n Tests added (or description of how to test) for any new features.\n User documentation updated for UI or technical changes.", "createdAt": "2020-12-16T14:54:41Z", "url": "https://github.com/phac-nml/irida/pull/892", "merged": true, "mergeCommit": {"oid": "ad20eaced56bf1bc4aedd5a165ff2e7d3e7de2cb"}, "closed": true, "closedAt": "2021-01-12T01:21:43Z", "author": {"login": "ksierks"}, "timelineItems": {"totalCount": 42, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmwIzcgH2gAyNTQxMjIyOTEyOjYzYjU4MDM2Zjg5MDY3ZjY2Y2M0ZmJhYzEwNmE5NTQwNzhhYzAyMjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdvNhOeAH2gAyNTQxMjIyOTEyOjk3ZWE3MDgyYzU3YWE1N2YzMDM1NTJiYWM0NTJkZWIxZDRkZWZhYTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "63b58036f89067f66cc4fbac106a954078ac0225", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/63b58036f89067f66cc4fbac106a954078ac0225", "committedDate": "2020-12-16T14:51:25Z", "message": "starting to render react on the dashboard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35986bd62d55fe22b8f28890efcb2076301dccd0", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/35986bd62d55fe22b8f28890efcb2076301dccd0", "committedDate": "2020-12-23T16:10:19Z", "message": "forgot to import dashboard2.bundle.css into index.html"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d96607e541994cafe8cc572fe842a8e4cad02531", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/d96607e541994cafe8cc572fe842a8e4cad02531", "committedDate": "2020-12-23T16:22:35Z", "message": "renaming Dashboard.jsx to DashboardPage.jsx"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79458a90399f10879965c4ae7f800e8e6fb47d32", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/79458a90399f10879965c4ae7f800e8e6fb47d32", "committedDate": "2020-12-23T18:01:41Z", "message": "creating a list within a card for unread announcements on dashboard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a0d41fdbb9d8c0348992838c485e3ffff3f73f1", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/5a0d41fdbb9d8c0348992838c485e3ffff3f73f1", "committedDate": "2020-12-23T20:54:27Z", "message": "adding ajax method readAnnouncements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf24c08a928121cf88bb7b7bb779e683068ec09f", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/bf24c08a928121cf88bb7b7bb779e683068ec09f", "committedDate": "2020-12-24T14:41:48Z", "message": "splitting up read and unread message lists into their own tabs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b2df7134e67dddeca6162a264f02d8f8b273c3c", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/3b2df7134e67dddeca6162a264f02d8f8b273c3c", "committedDate": "2020-12-30T15:12:46Z", "message": "adding modals to display read and unread announcments details and starting to work on the mark as read button functionality"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8934ad3233742a10abbf1594023ade1ceb450d69", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/8934ad3233742a10abbf1594023ade1ceb450d69", "committedDate": "2020-12-30T18:25:02Z", "message": "removing ant descriptions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1fa03e2d58a4fae96652ada7a70d38d69da224a", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/a1fa03e2d58a4fae96652ada7a70d38d69da224a", "committedDate": "2020-12-30T21:02:29Z", "message": "sorting read and unread announcements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6c624c2a1d30e9581ffb8e7d7f95dc433f2f2a4", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/f6c624c2a1d30e9581ffb8e7d7f95dc433f2f2a4", "committedDate": "2021-01-04T17:25:01Z", "message": "calling 'mark as read' functionality when modal closes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e89b2be0a8de09b058160b11cf6a25d38e08c4a", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/3e89b2be0a8de09b058160b11cf6a25d38e08c4a", "committedDate": "2021-01-04T18:00:30Z", "message": "playing with list pagination"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77047603714e870d80b6e8244d45a02ca7cd428a", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/77047603714e870d80b6e8244d45a02ca7cd428a", "committedDate": "2021-01-04T18:52:13Z", "message": "adding pagination page size of 5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87b32bf3f598ed9a2f64ad42949b69fc77fe141f", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/87b32bf3f598ed9a2f64ad42949b69fc77fe141f", "committedDate": "2021-01-04T20:50:20Z", "message": "playing with color"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d688300cc45990dd4a16624dd66665e50f76069", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/5d688300cc45990dd4a16624dd66665e50f76069", "committedDate": "2021-01-05T15:52:40Z", "message": "removing card and rendering the dashbord within the bootstrap panel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "527182be8960898f6b7868039c5a69fd7ea4d269", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/527182be8960898f6b7868039c5a69fd7ea4d269", "committedDate": "2021-01-05T16:17:03Z", "message": "removing read announcements from dashboard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc9ecacd15056ec6495ab76941fc148fd341cda6", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/bc9ecacd15056ec6495ab76941fc148fd341cda6", "committedDate": "2021-01-05T17:05:57Z", "message": "creating a LinkButton component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02131a255ed9aea92c8d2c11d621800dd499781a", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/02131a255ed9aea92c8d2c11d621800dd499781a", "committedDate": "2021-01-05T17:08:53Z", "message": "forgot to remove tabs const"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "537ec3991ba7dc583d5f157bd6944f2a7debba69", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/537ec3991ba7dc583d5f157bd6944f2a7debba69", "committedDate": "2021-01-05T19:21:48Z", "message": "creating PriorityFlag component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be9a31c1cc02aa0a08d0f1938c0327536d7479af", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/be9a31c1cc02aa0a08d0f1938c0327536d7479af", "committedDate": "2021-01-05T19:32:39Z", "message": "removing classes on dashboard-root div on index page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "580a43f85ad92c717be0716b224ff8bb13a25f11", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/580a43f85ad92c717be0716b224ff8bb13a25f11", "committedDate": "2021-01-06T17:33:20Z", "message": "fixing mark as read test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyOTU4Mjk4", "url": "https://github.com/phac-nml/irida/pull/892#pullrequestreview-562958298", "createdAt": "2021-01-06T18:49:52Z", "commit": {"oid": "580a43f85ad92c717be0716b224ff8bb13a25f11"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxODo0OTo1MlrOIPSVAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxODo0OTo1MlrOIPSVAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjg5OTg0MQ==", "bodyText": "Can you update this to be an actual avatar:\n\n              <Avatar\n                style={{ backgroundColor: \"#fff\" }}\n                icon={<PriorityFlag hasPriority={item.priority} />}\n              />", "url": "https://github.com/phac-nml/irida/pull/892#discussion_r552899841", "createdAt": "2021-01-06T18:49:52Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/announcement/AnnouncementDashboard.jsx", "diffHunk": "@@ -0,0 +1,57 @@\n+import React, { useEffect, useState } from \"react\";\n+import { List, notification, Typography } from \"antd\";\n+import { fromNow } from \"../../utilities/date-utilities\";\n+import {\n+  getUnreadAnnouncements,\n+  markAnnouncementRead,\n+} from \"../../apis/announcements/announcements\";\n+import ViewUnreadAnnouncement from \"./ViewUnreadAnnouncement\";\n+import Markdown from \"react-markdown\";\n+import { PriorityFlag } from \"./PriorityFlag\";\n+\n+export function AnnouncementDashboard() {\n+  const [unreadAnnouncements, setUnreadAnnouncements] = useState([]);\n+  const [unreadTotal, setUnreadTotal] = useState(0);\n+  const { Paragraph } = Typography;\n+\n+  useEffect(() => {\n+    getUnreadAnnouncements().then((data) => {\n+      setUnreadAnnouncements(data.data);\n+      setUnreadTotal(data.data.length);\n+    });\n+  }, [unreadTotal]);\n+\n+  function markAnnouncementAsRead(aID) {\n+    return markAnnouncementRead({ aID })\n+      .then(() => {\n+        setUnreadTotal(unreadTotal - 1);\n+      })\n+      .catch(({ message }) => {\n+        notification.error({ message });\n+      });\n+  }\n+\n+  return (\n+    <List\n+      pagination={unreadTotal > 5 ? { pageSize: 5 } : false}\n+      dataSource={unreadAnnouncements}\n+      renderItem={(item) => (\n+        <List.Item className=\"t-announcement-item\">\n+          <List.Item.Meta\n+            avatar={<PriorityFlag hasPriority={item.priority} />}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "580a43f85ad92c717be0716b224ff8bb13a25f11"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyOTU4NTgz", "url": "https://github.com/phac-nml/irida/pull/892#pullrequestreview-562958583", "createdAt": "2021-01-06T18:50:18Z", "commit": {"oid": "580a43f85ad92c717be0716b224ff8bb13a25f11"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxODo1MDoxOFrOIPSV4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxODo1MDoxOFrOIPSV4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjkwMDA2Ng==", "bodyText": "Please remove commented out code", "url": "https://github.com/phac-nml/irida/pull/892#discussion_r552900066", "createdAt": "2021-01-06T18:50:18Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/announcement/AnnouncementDashboard.jsx", "diffHunk": "@@ -0,0 +1,57 @@\n+import React, { useEffect, useState } from \"react\";\n+import { List, notification, Typography } from \"antd\";\n+import { fromNow } from \"../../utilities/date-utilities\";\n+import {\n+  getUnreadAnnouncements,\n+  markAnnouncementRead,\n+} from \"../../apis/announcements/announcements\";\n+import ViewUnreadAnnouncement from \"./ViewUnreadAnnouncement\";\n+import Markdown from \"react-markdown\";\n+import { PriorityFlag } from \"./PriorityFlag\";\n+\n+export function AnnouncementDashboard() {\n+  const [unreadAnnouncements, setUnreadAnnouncements] = useState([]);\n+  const [unreadTotal, setUnreadTotal] = useState(0);\n+  const { Paragraph } = Typography;\n+\n+  useEffect(() => {\n+    getUnreadAnnouncements().then((data) => {\n+      setUnreadAnnouncements(data.data);\n+      setUnreadTotal(data.data.length);\n+    });\n+  }, [unreadTotal]);\n+\n+  function markAnnouncementAsRead(aID) {\n+    return markAnnouncementRead({ aID })\n+      .then(() => {\n+        setUnreadTotal(unreadTotal - 1);\n+      })\n+      .catch(({ message }) => {\n+        notification.error({ message });\n+      });\n+  }\n+\n+  return (\n+    <List\n+      pagination={unreadTotal > 5 ? { pageSize: 5 } : false}\n+      dataSource={unreadAnnouncements}\n+      renderItem={(item) => (\n+        <List.Item className=\"t-announcement-item\">\n+          <List.Item.Meta\n+            avatar={<PriorityFlag hasPriority={item.priority} />}\n+            title=<ViewUnreadAnnouncement\n+              announcement={item}\n+              markAnnouncementAsRead={markAnnouncementAsRead}\n+            />\n+            description={fromNow({ date: item.createdDate })}\n+          />\n+          {/*<Paragraph*/}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "580a43f85ad92c717be0716b224ff8bb13a25f11"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c222f11517de800b7b4cca6bab4042b9c2e1e89d", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/c222f11517de800b7b4cca6bab4042b9c2e1e89d", "committedDate": "2021-01-06T20:26:44Z", "message": "resolving overflow text for long announcement titles"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21e0a3fe841212a8fef36a16c141f2b48145fba2", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/21e0a3fe841212a8fef36a16c141f2b48145fba2", "committedDate": "2021-01-06T21:26:14Z", "message": "adding Josh's implementation of ViewUnreadAnnouncement and updating mark as read test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed419fb43ac0e4dea0835c2fa2b078b1830f0fc4", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/ed419fb43ac0e4dea0835c2fa2b078b1830f0fc4", "committedDate": "2021-01-06T21:28:23Z", "message": "adding i18n"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8289eae205430e8fccfce1f604220a26e253ceda", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/8289eae205430e8fccfce1f604220a26e253ceda", "committedDate": "2021-01-06T23:49:24Z", "message": " removing commented out code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c74c721758aa2f74939229fc7b6a3ff651d13ea4", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/c74c721758aa2f74939229fc7b6a3ff651d13ea4", "committedDate": "2021-01-06T23:56:52Z", "message": "using ant's Avatar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzNzI1Nzgz", "url": "https://github.com/phac-nml/irida/pull/892#pullrequestreview-563725783", "createdAt": "2021-01-07T18:33:11Z", "commit": {"oid": "c74c721758aa2f74939229fc7b6a3ff651d13ea4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxODozMzoxMVrOIP3efA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxODozMzoxMVrOIP3efA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUwODQ3Ng==", "bodyText": "Because this is a RestController you don't actually need to add` responsebody` it does not hurt, but not required. \u00a0Just an FYI.", "url": "https://github.com/phac-nml/irida/pull/892#discussion_r553508476", "createdAt": "2021-01-07T18:33:11Z", "author": {"login": "joshsadam"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/announcements/AnnouncementAjaxController.java", "diffHunk": "@@ -39,6 +43,48 @@ public AnnouncementAjaxController(UIAnnouncementsService UIAnnouncementsService)\n \t\treturn UIAnnouncementsService.getAnnouncementsAdmin(tableRequest);\n \t}\n \n+\t/**\n+\t * Handle request for getting a list of read announcements for a user.\n+\t *\n+\t * @param principal the currently logged in user\n+\t * @return a {@link List} of unread {@link AnnouncementUserJoin}s for a user.\n+\t */\n+\t@RequestMapping(value = \"/user/read\")\n+\t@PreAuthorize(\"hasRole('ROLE_USER')\")\n+\t@ResponseBody", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c74c721758aa2f74939229fc7b6a3ff651d13ea4"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzNzM5NDQw", "url": "https://github.com/phac-nml/irida/pull/892#pullrequestreview-563739440", "createdAt": "2021-01-07T18:54:21Z", "commit": {"oid": "c74c721758aa2f74939229fc7b6a3ff651d13ea4"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxODo1NDoyMVrOIP4H2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QxOTowMzoxMVrOIP4Z6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUxOTA2Nw==", "bodyText": "JSDoc", "url": "https://github.com/phac-nml/irida/pull/892#discussion_r553519067", "createdAt": "2021-01-07T18:54:21Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/DashboardPage.jsx", "diffHunk": "@@ -0,0 +1,6 @@\n+import React from \"react\";\n+import { render } from \"react-dom\";\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c74c721758aa2f74939229fc7b6a3ff651d13ea4"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUxOTE3NA==", "bodyText": "JSDoc", "url": "https://github.com/phac-nml/irida/pull/892#discussion_r553519174", "createdAt": "2021-01-07T18:54:35Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/announcement/AnnouncementDashboard.jsx", "diffHunk": "@@ -0,0 +1,53 @@\n+import React, { useEffect, useState } from \"react\";\n+import { Avatar, List, notification } from \"antd\";\n+import { fromNow } from \"../../utilities/date-utilities\";\n+import {\n+  getUnreadAnnouncements,\n+  markAnnouncementRead,\n+} from \"../../apis/announcements/announcements\";\n+import ViewUnreadAnnouncement from \"./ViewUnreadAnnouncement\";\n+import { PriorityFlag } from \"./PriorityFlag\";\n+\n+export function AnnouncementDashboard() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c74c721758aa2f74939229fc7b6a3ff651d13ea4"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyMzY5MQ==", "bodyText": "I have a concern if the content is very long. \u00a0Perhaps wrap this in a div that has overflow scroll set on it for vertical with a max-height of window - 200px or something.", "url": "https://github.com/phac-nml/irida/pull/892#discussion_r553523691", "createdAt": "2021-01-07T19:03:11Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/announcement/ViewUnreadAnnouncement.jsx", "diffHunk": "@@ -0,0 +1,59 @@\n+import React from \"react\";\n+import { Modal, Typography } from \"antd\";\n+import { VisibilityProvider } from \"../../contexts/visibility-context\";\n+import { formatDate } from \"../../utilities/date-utilities\";\n+import Markdown from \"react-markdown\";\n+import { LinkButton } from \"../../components/Buttons/LinkButton\";\n+import { PriorityFlag } from \"./PriorityFlag\";\n+/**\n+ * Component to add a button which will open a modal to view a unread announcement.\n+ * @param {function} ViewAnnouncement - the function that displays a unread announcement.\n+ * @returns {*}\n+ * @constructor\n+ */\n+const { Text } = Typography;\n+const { confirm } = Modal;\n+function ViewUnreadAnnouncementModal({ announcement, markAnnouncementAsRead }) {\n+  const displayAnnouncement = () =>\n+    confirm({\n+      type: \"info\",\n+      width: `60%`,\n+      icon: <PriorityFlag hasPriority={announcement.priority} />,\n+      okText: `Read`,\n+      onOk() {\n+        markAnnouncementAsRead(announcement.identifier);\n+      },\n+      title: (\n+        <>\n+          <Text strong>{announcement.title}</Text>\n+          <br />\n+          <Text type=\"secondary\" style={{ fontSize: `.8em` }}>\n+            {i18n(\n+              \"ViewUnreadAnnouncement.create.details\",\n+              announcement.user.username,\n+              formatDate({ date: announcement.createdDate })\n+            )}\n+          </Text>\n+        </>\n+      ),\n+      content: <Markdown source={announcement.message} />,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c74c721758aa2f74939229fc7b6a3ff651d13ea4"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a7aff71e32004d63d7bf2d680ce7448ba74b604", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/2a7aff71e32004d63d7bf2d680ce7448ba74b604", "committedDate": "2021-01-07T19:40:04Z", "message": "making modal scrollable for insanely long announcment content"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1aa2944c66af39e4c13aff6b33682b7e80ec8511", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/1aa2944c66af39e4c13aff6b33682b7e80ec8511", "committedDate": "2021-01-07T21:02:43Z", "message": "adding url to username in modal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4dade373f91e51b7f98139f151c469f32229d61", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/c4dade373f91e51b7f98139f151c469f32229d61", "committedDate": "2021-01-07T21:04:26Z", "message": "removing OutputWrapper from modal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5630ea6461eef708f4cebab09395f057edb6ca71", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/5630ea6461eef708f4cebab09395f057edb6ca71", "committedDate": "2021-01-08T15:31:39Z", "message": "adding documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb639f3196300d47ecb44efdb476e478c70c2084", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/fb639f3196300d47ecb44efdb476e478c70c2084", "committedDate": "2021-01-08T19:13:23Z", "message": "revert user link on user name in modal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d726b0bfed30bfb7e5945322235183b3e847f94a", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/d726b0bfed30bfb7e5945322235183b3e847f94a", "committedDate": "2021-01-11T15:28:10Z", "message": "Changing empty list message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31d6a4791defd287cc4ce2e30ee3da47d04a19c9", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/31d6a4791defd287cc4ce2e30ee3da47d04a19c9", "committedDate": "2021-01-11T15:33:41Z", "message": "updating empty list message to use i18n"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79887000d134656e0a48d964632a611b8d842cf5", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/79887000d134656e0a48d964632a611b8d842cf5", "committedDate": "2021-01-11T16:22:25Z", "message": "adding client-side validation on title length"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1NjQxMjc3", "url": "https://github.com/phac-nml/irida/pull/892#pullrequestreview-565641277", "createdAt": "2021-01-11T18:47:22Z", "commit": {"oid": "79887000d134656e0a48d964632a611b8d842cf5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMVQxODo0NzoyM1rOIRioMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMVQxODo0NzoyM1rOIRioMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTI2NDA1MA==", "bodyText": "You can also use just By.className(\"t-announcement-item\") - again just an FYI of whats available", "url": "https://github.com/phac-nml/irida/pull/892#discussion_r555264050", "createdAt": "2021-01-11T18:47:23Z", "author": {"login": "joshsadam"}, "path": "src/test/java/ca/corefacility/bioinformatics/irida/ria/integration/pages/announcements/AnnouncementDashboardPage.java", "diffHunk": "@@ -27,12 +27,15 @@ public void viewReadAnnouncements() {\n     }\n \n     public List<WebElement> getCurrentUnreadAnnouncements() {\n-        return driver.findElements(By.cssSelector(\".announcement-item\"));\n+        return driver.findElements(By.cssSelector(\".t-announcement-item\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79887000d134656e0a48d964632a611b8d842cf5"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab653aacce916ee31a3cef2c2d48ae97866f8212", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/ab653aacce916ee31a3cef2c2d48ae97866f8212", "committedDate": "2021-01-11T19:39:51Z", "message": "cleaning up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0799d1ec2fe1b6884300668a7da47cf32e46741", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/b0799d1ec2fe1b6884300668a7da47cf32e46741", "committedDate": "2021-01-11T19:48:23Z", "message": "cleaning up"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1NzUzOTA4", "url": "https://github.com/phac-nml/irida/pull/892#pullrequestreview-565753908", "createdAt": "2021-01-11T21:30:18Z", "commit": {"oid": "b0799d1ec2fe1b6884300668a7da47cf32e46741"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMVQyMTozMDoxOFrOIRn_oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMVQyMTozMDoxOFrOIRn_oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTM1MTk2OQ==", "bodyText": "This comment is old now.", "url": "https://github.com/phac-nml/irida/pull/892#discussion_r555351969", "createdAt": "2021-01-11T21:30:18Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/pages/index.html", "diffHunk": "@@ -45,12 +45,15 @@ <h4 class=\"pull-left\" th:text=\"#{announcement.title}\">_New Announcements_</h4>\n         </div>\n       </div>\n       <div class=\"panel-body\">\n-        <div class=\"form-group\">\n-          <announcements data:url=\"@{announcements/user/unread}\"></announcements>\n+        <div id=\"dashboard-root\">\n+          <!-- Contents rendered from DashboardPage.jsx -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0799d1ec2fe1b6884300668a7da47cf32e46741"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97ea7082c57aa57f303552bac452deb1d4defaa9", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/97ea7082c57aa57f303552bac452deb1d4defaa9", "committedDate": "2021-01-11T21:36:44Z", "message": "updating old comment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 0, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}