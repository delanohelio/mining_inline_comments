{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyNjgxMDE4", "number": 860, "title": "Upgrade admin new announcement modal", "bodyText": "Description of changes\nAdding new fields title and priority to admin new announcement modal.\n\nRelated issue\nLink to the GitHub issue this pull request addresses using the #issuenum format.  If it completes an issue, use Fixes #issuenum to automatically close the issue.\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n Tests added (or description of how to test) for any new features.\n User documentation updated for UI or technical changes.", "createdAt": "2020-11-17T20:18:30Z", "url": "https://github.com/phac-nml/irida/pull/860", "merged": true, "mergeCommit": {"oid": "f6c66b0c2e1df3c80cabaf240fd3c69be086c757"}, "closed": true, "closedAt": "2020-11-20T14:33:11Z", "author": {"login": "ksierks"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddfY0IAH2gAyNTIyNjgxMDE4OjgxOWQzNzA4OWMyMWE3OWRmMDBlMDRlYzBhMTc4OTgxY2UxYzA1NGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeHxSYAH2gAyNTIyNjgxMDE4OmZkNDQyYmU5YjU5ZjUxOTM3NDI3NjA2YjBhN2NlZjUxYjRmOWU2ODg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "819d37089c21a79df00e04ec0a178981ce1c054d", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/819d37089c21a79df00e04ec0a178981ce1c054d", "committedDate": "2020-11-17T20:15:12Z", "message": "adding title and priority to admin new announcement modal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9b3926b24a2a1a0e08c873530ef8afcd1bb2435", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/c9b3926b24a2a1a0e08c873530ef8afcd1bb2435", "committedDate": "2020-11-18T15:17:41Z", "message": "Working on new create announcement modal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b0ef29e910232ae60ab202f50beb936f9963b5d", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/0b0ef29e910232ae60ab202f50beb936f9963b5d", "committedDate": "2020-11-18T15:18:01Z", "message": "Merge remote-tracking branch 'origin/announcements-upgrade-admin-forms' into announcements-upgrade-admin-forms"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e0f3f5186b84bbe84dc4f64986f6be5132423a0", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/9e0f3f5186b84bbe84dc4f64986f6be5132423a0", "committedDate": "2020-11-18T16:45:13Z", "message": "setting a fixed width on the priority column of the admin announcements table"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a92f907537ac87a27d560544f2c27c270b1cc3d4", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/a92f907537ac87a27d560544f2c27c270b1cc3d4", "committedDate": "2020-11-18T16:50:52Z", "message": "changing modal.confirm to a modal as we are able to set the visibility"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7cee39b6c58b4fc53a7838a37cd6990376e8b14", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/b7cee39b6c58b4fc53a7838a37cd6990376e8b14", "committedDate": "2020-11-18T18:25:05Z", "message": "adding i18n properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea6a093aa2c5708d53e04a2ed88ff8627468172f", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/ea6a093aa2c5708d53e04a2ed88ff8627468172f", "committedDate": "2020-11-18T18:36:32Z", "message": "fixing form preservation not working"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "984d376a2e036f59ae6f5da31dc6caa72853b821", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/984d376a2e036f59ae6f5da31dc6caa72853b821", "committedDate": "2020-11-18T18:51:00Z", "message": "adding missing i18n and comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzgyNTEz", "url": "https://github.com/phac-nml/irida/pull/860#pullrequestreview-533782513", "createdAt": "2020-11-18T19:02:26Z", "commit": {"oid": "984d376a2e036f59ae6f5da31dc6caa72853b821"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxOTowMjoyNlrOH19pqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxOToxMzoyMlrOH1-C3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM0NjY2Ng==", "bodyText": "Instead of a react fragment, let's use Space to give some breathing room between the icon and the title.\ntitle={\n        <Space>\n          <IconEdit style={{ color: FONT_COLOR_PRIMARY }} />\n          {i18n(\"CreateNewAnnouncement.title\")}\n        </Space>\n      }", "url": "https://github.com/phac-nml/irida/pull/860#discussion_r526346666", "createdAt": "2020-11-18T19:02:26Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/admin/components/announcements/CreateAnnouncementModal.jsx", "diffHunk": "@@ -0,0 +1,81 @@\n+import React, { useRef } from \"react\";\n+import { Checkbox, Form, Input, Modal } from \"antd\";\n+import { IconEdit } from \"../../../../components/icons/Icons\";\n+import { FONT_COLOR_PRIMARY } from \"../../../../styles/fonts\";\n+import { MarkdownEditor } from \"../../../../components/markdown/MarkdownEditor\";\n+\n+/**\n+ * React component to display an Ant Design Modal containing a form to create a new announcement\n+ * @param {boolean} visible - whether the modal is open or not\n+ * @param {function} closeModal - the function to close the modal\n+ * @param {function} createAnnouncement - the function to create a new announcement and refresh the table\n+ * @returns {JSX.Element}\n+ * @constructor\n+ */\n+export function CreateAnnouncementModal({\n+  visible,\n+  closeModal,\n+  createAnnouncement,\n+}) {\n+  const markdownRef = useRef();\n+  const [form] = Form.useForm();\n+\n+  const onCancel = () => {\n+    form.resetFields();\n+    closeModal();\n+  };\n+\n+  function saveMarkdown() {\n+    form.validateFields().then((values) => {\n+      const markdown = markdownRef.current.getMarkdown();\n+      const title = values.title;\n+      const priority = values.priority;\n+\n+      createAnnouncement(title, markdown, priority);\n+      closeModal();\n+    });\n+  }\n+  return (\n+    <Modal\n+      visible={visible}\n+      title={\n+        <>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "984d376a2e036f59ae6f5da31dc6caa72853b821"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM0NzM3OA==", "bodyText": "You're form is not resetting when the modal is closed.  This might be a little tricky as you will need to reset the contents of the markdown as well.", "url": "https://github.com/phac-nml/irida/pull/860#discussion_r526347378", "createdAt": "2020-11-18T19:03:40Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/admin/components/announcements/CreateAnnouncementModal.jsx", "diffHunk": "@@ -0,0 +1,81 @@\n+import React, { useRef } from \"react\";\n+import { Checkbox, Form, Input, Modal } from \"antd\";\n+import { IconEdit } from \"../../../../components/icons/Icons\";\n+import { FONT_COLOR_PRIMARY } from \"../../../../styles/fonts\";\n+import { MarkdownEditor } from \"../../../../components/markdown/MarkdownEditor\";\n+\n+/**\n+ * React component to display an Ant Design Modal containing a form to create a new announcement\n+ * @param {boolean} visible - whether the modal is open or not\n+ * @param {function} closeModal - the function to close the modal\n+ * @param {function} createAnnouncement - the function to create a new announcement and refresh the table\n+ * @returns {JSX.Element}\n+ * @constructor\n+ */\n+export function CreateAnnouncementModal({\n+  visible,\n+  closeModal,\n+  createAnnouncement,\n+}) {\n+  const markdownRef = useRef();\n+  const [form] = Form.useForm();\n+\n+  const onCancel = () => {\n+    form.resetFields();\n+    closeModal();\n+  };\n+\n+  function saveMarkdown() {\n+    form.validateFields().then((values) => {\n+      const markdown = markdownRef.current.getMarkdown();\n+      const title = values.title;\n+      const priority = values.priority;\n+\n+      createAnnouncement(title, markdown, priority);\n+      closeModal();\n+    });\n+  }\n+  return (\n+    <Modal\n+      visible={visible}\n+      title={\n+        <>\n+          <IconEdit style={{ color: FONT_COLOR_PRIMARY }} />\n+          {i18n(\"CreateNewAnnouncement.title\")}\n+        </>\n+      }\n+      width=\"80%\"\n+      okText={i18n(\"CreateNewAnnouncement.okBtn\")}\n+      okButtonProps={{\n+        className: \"t-submit-announcement\",\n+      }}\n+      onOk={saveMarkdown}\n+      onCancel={onCancel}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "984d376a2e036f59ae6f5da31dc6caa72853b821"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM1MTM1Mg==", "bodyText": "Checkboxes are a little trickier than this.  I am sure you noticed that it looks a bit off with the label on a different line than the checkbox, makes it feel like the checkbox is a poor orphan child.\n\nThis is the way to write it to get it all working together:\n<Form.Item name=\"priority\" valuePropName=\"checked\">\n   <Checkbox>{i18n(\"announcement.control.priority\")}</Checkbox>\n</Form.Item>", "url": "https://github.com/phac-nml/irida/pull/860#discussion_r526351352", "createdAt": "2020-11-18T19:10:28Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/admin/components/announcements/CreateAnnouncementModal.jsx", "diffHunk": "@@ -0,0 +1,81 @@\n+import React, { useRef } from \"react\";\n+import { Checkbox, Form, Input, Modal } from \"antd\";\n+import { IconEdit } from \"../../../../components/icons/Icons\";\n+import { FONT_COLOR_PRIMARY } from \"../../../../styles/fonts\";\n+import { MarkdownEditor } from \"../../../../components/markdown/MarkdownEditor\";\n+\n+/**\n+ * React component to display an Ant Design Modal containing a form to create a new announcement\n+ * @param {boolean} visible - whether the modal is open or not\n+ * @param {function} closeModal - the function to close the modal\n+ * @param {function} createAnnouncement - the function to create a new announcement and refresh the table\n+ * @returns {JSX.Element}\n+ * @constructor\n+ */\n+export function CreateAnnouncementModal({\n+  visible,\n+  closeModal,\n+  createAnnouncement,\n+}) {\n+  const markdownRef = useRef();\n+  const [form] = Form.useForm();\n+\n+  const onCancel = () => {\n+    form.resetFields();\n+    closeModal();\n+  };\n+\n+  function saveMarkdown() {\n+    form.validateFields().then((values) => {\n+      const markdown = markdownRef.current.getMarkdown();\n+      const title = values.title;\n+      const priority = values.priority;\n+\n+      createAnnouncement(title, markdown, priority);\n+      closeModal();\n+    });\n+  }\n+  return (\n+    <Modal\n+      visible={visible}\n+      title={\n+        <>\n+          <IconEdit style={{ color: FONT_COLOR_PRIMARY }} />\n+          {i18n(\"CreateNewAnnouncement.title\")}\n+        </>\n+      }\n+      width=\"80%\"\n+      okText={i18n(\"CreateNewAnnouncement.okBtn\")}\n+      okButtonProps={{\n+        className: \"t-submit-announcement\",\n+      }}\n+      onOk={saveMarkdown}\n+      onCancel={onCancel}\n+    >\n+      <Form layout=\"vertical\" form={form}>\n+        <Form.Item\n+          name=\"title\"\n+          label={i18n(\"announcement.control.title\")}\n+          rules={[\n+            {\n+              required: true,\n+              message: i18n(\"CreateNewAnnouncement.form.title\"),\n+            },\n+          ]}\n+        >\n+          <Input />\n+        </Form.Item>\n+        <Form.Item name=\"message\" label={i18n(\"announcement.control.message\")}>\n+          <MarkdownEditor ref={markdownRef} />\n+        </Form.Item>\n+        <Form.Item\n+          name=\"priority\"\n+          label={i18n(\"announcement.control.priority\")}\n+          valuePropName=\"checked\"\n+        >\n+          <Checkbox />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "984d376a2e036f59ae6f5da31dc6caa72853b821"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM1MzExOA==", "bodyText": "Can you also make the wording a little more descriptive.  I suck at word smithing, but even \"Set as priority announcement\"", "url": "https://github.com/phac-nml/irida/pull/860#discussion_r526353118", "createdAt": "2020-11-18T19:13:22Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/pages/admin/components/announcements/CreateAnnouncementModal.jsx", "diffHunk": "@@ -0,0 +1,81 @@\n+import React, { useRef } from \"react\";\n+import { Checkbox, Form, Input, Modal } from \"antd\";\n+import { IconEdit } from \"../../../../components/icons/Icons\";\n+import { FONT_COLOR_PRIMARY } from \"../../../../styles/fonts\";\n+import { MarkdownEditor } from \"../../../../components/markdown/MarkdownEditor\";\n+\n+/**\n+ * React component to display an Ant Design Modal containing a form to create a new announcement\n+ * @param {boolean} visible - whether the modal is open or not\n+ * @param {function} closeModal - the function to close the modal\n+ * @param {function} createAnnouncement - the function to create a new announcement and refresh the table\n+ * @returns {JSX.Element}\n+ * @constructor\n+ */\n+export function CreateAnnouncementModal({\n+  visible,\n+  closeModal,\n+  createAnnouncement,\n+}) {\n+  const markdownRef = useRef();\n+  const [form] = Form.useForm();\n+\n+  const onCancel = () => {\n+    form.resetFields();\n+    closeModal();\n+  };\n+\n+  function saveMarkdown() {\n+    form.validateFields().then((values) => {\n+      const markdown = markdownRef.current.getMarkdown();\n+      const title = values.title;\n+      const priority = values.priority;\n+\n+      createAnnouncement(title, markdown, priority);\n+      closeModal();\n+    });\n+  }\n+  return (\n+    <Modal\n+      visible={visible}\n+      title={\n+        <>\n+          <IconEdit style={{ color: FONT_COLOR_PRIMARY }} />\n+          {i18n(\"CreateNewAnnouncement.title\")}\n+        </>\n+      }\n+      width=\"80%\"\n+      okText={i18n(\"CreateNewAnnouncement.okBtn\")}\n+      okButtonProps={{\n+        className: \"t-submit-announcement\",\n+      }}\n+      onOk={saveMarkdown}\n+      onCancel={onCancel}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM0NzM3OA=="}, "originalCommit": {"oid": "984d376a2e036f59ae6f5da31dc6caa72853b821"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bdf855381a0c447dffa1528a00bad9702726e58", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/3bdf855381a0c447dffa1528a00bad9702726e58", "committedDate": "2020-11-18T19:21:18Z", "message": "adding some space between the icon and title"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d067ffcd1bb1b26262527921f01ada91f173fb4", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/5d067ffcd1bb1b26262527921f01ada91f173fb4", "committedDate": "2020-11-18T19:24:11Z", "message": "fixing the poor orphan checkbox"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a5dc4336711173327e2db79ac17deefd7eeee2c", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/4a5dc4336711173327e2db79ac17deefd7eeee2c", "committedDate": "2020-11-18T19:59:00Z", "message": "fixing resetting form after saving an announcement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "458b3dc5c8e84271f36f8cf25345b23fcb75674c", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/458b3dc5c8e84271f36f8cf25345b23fcb75674c", "committedDate": "2020-11-19T14:52:15Z", "message": "renaming the priority label in the new announcement form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d48a28b22916603a02a375fd03370557118dd28d", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/d48a28b22916603a02a375fd03370557118dd28d", "committedDate": "2020-11-19T15:34:45Z", "message": "rearranging some i18n properties"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NTc1NzI3", "url": "https://github.com/phac-nml/irida/pull/860#pullrequestreview-534575727", "createdAt": "2020-11-19T15:39:59Z", "commit": {"oid": "d48a28b22916603a02a375fd03370557118dd28d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ad2314ca09f19d23bfe1b5d852850cae527b9d6d", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/ad2314ca09f19d23bfe1b5d852850cae527b9d6d", "committedDate": "2020-11-19T16:20:55Z", "message": "Merge remote-tracking branch 'origin/development' into announcements-upgrade-admin-forms"}, "afterCommit": {"oid": "d48a28b22916603a02a375fd03370557118dd28d", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/d48a28b22916603a02a375fd03370557118dd28d", "committedDate": "2020-11-19T15:34:45Z", "message": "rearranging some i18n properties"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b96de43f777a1e9d30bb02226732622ebd6b94ba", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/b96de43f777a1e9d30bb02226732622ebd6b94ba", "committedDate": "2020-11-19T17:32:08Z", "message": "Merge branch 'development' into announcements-upgrade-admin-forms"}, "afterCommit": {"oid": "d48a28b22916603a02a375fd03370557118dd28d", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/d48a28b22916603a02a375fd03370557118dd28d", "committedDate": "2020-11-19T15:34:45Z", "message": "rearranging some i18n properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd442be9b59f51937427606b0a7cef51b4f9e688", "author": {"user": {"login": "ksierks", "name": "Katherine Thiessen"}}, "url": "https://github.com/phac-nml/irida/commit/fd442be9b59f51937427606b0a7cef51b4f9e688", "committedDate": "2020-11-19T19:18:08Z", "message": "Merge branch 'announcements-upgrade-base' into announcements-upgrade-admin-forms"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4956, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}