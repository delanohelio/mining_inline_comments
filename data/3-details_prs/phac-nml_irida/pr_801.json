{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1MzI0MDUw", "number": 801, "title": "Fix remoate oath create remote project", "bodyText": "Description of changes\nUpdated the create remote synchronized project page to use Ant Design with the working Oauth component.\nRelated issue\nN/A\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n Tests added (or description of how to test) for any new features.\n User documentation updated for UI or technical changes.", "createdAt": "2020-09-11T18:06:38Z", "url": "https://github.com/phac-nml/irida/pull/801", "merged": true, "mergeCommit": {"oid": "5f075abf9f50d06c85db05bc609e0fcb2a4e1b1b"}, "closed": true, "closedAt": "2020-09-16T16:43:01Z", "author": {"login": "joshsadam"}, "timelineItems": {"totalCount": 36, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdH0P5eAH2gAyNDg1MzI0MDUwOjM4OWUwYzhlMDE4MDkyMDkwN2E2Y2FmMjM0ZWExNTRlMjM1ZGIwNGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJc1r0AH2gAyNDg1MzI0MDUwOjExYmFiMDFkMjFhMWZjZmU2NmI1MTcyZGM3NjQ2NzVlNjBhMjk5OTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "389e0c8e0180920907a6caf234ea154e235db04c", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/389e0c8e0180920907a6caf234ea154e235db04c", "committedDate": "2020-09-11T12:07:08Z", "message": ":construction: Working fetch projects when switching apis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffce86308d56cb0bdcafea2672cdc2d80780d956", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/ffce86308d56cb0bdcafea2672cdc2d80780d956", "committedDate": "2020-09-11T17:45:46Z", "message": ":construction: Working create remote.:construction:\n\nStill needs to have redirect and errors set up."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1767b6f742f5b51dbae7c587cf188f7fc7abc57", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/b1767b6f742f5b51dbae7c587cf188f7fc7abc57", "committedDate": "2020-09-11T17:53:17Z", "message": ":construction: Working with redirect"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e44c7e70d89ea0bee0892c95ff49b3f005ff4eb4", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/e44c7e70d89ea0bee0892c95ff49b3f005ff4eb4", "committedDate": "2020-09-11T18:33:32Z", "message": ":recycle: Cleaning up old code and updating i18n"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e65dc7c8ad6eacb9c1707f0d0e61474a83936db", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/0e65dc7c8ad6eacb9c1707f0d0e61474a83936db", "committedDate": "2020-09-14T11:26:33Z", "message": ":recycle: Removed unused method calls"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ec33e76113a2299b092ea14a0beeb6c8e1e3ec2", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/2ec33e76113a2299b092ea14a0beeb6c8e1e3ec2", "committedDate": "2020-09-14T12:32:11Z", "message": ":bulb: Updated JavaDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32e2ad220274e602ab45fbd4e68d0a07db969c5a", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/32e2ad220274e602ab45fbd4e68d0a07db969c5a", "committedDate": "2020-09-14T12:37:49Z", "message": ":white_check_mark: Updated service testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97af6a369f9c335b1fb56bf2f519398f55316f0e", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/97af6a369f9c335b1fb56bf2f519398f55316f0e", "committedDate": "2020-09-14T15:14:05Z", "message": "Merge branch 'FIX-remote-oauth-CLIENT_DETAILS' into FIX-remoate-oath-CREATE_REMOTE_PROJECT\n\n# Conflicts:\n#\tsrc/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UIRemoteAPIService.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fd394498c4cc6d5e46a16d1055787e6895f1633", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/5fd394498c4cc6d5e46a16d1055787e6895f1633", "committedDate": "2020-09-14T16:03:25Z", "message": ":construction: Cleaned up imports from merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ba73ad0e6d12451424eaa56c29e1200da12f8ed", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/0ba73ad0e6d12451424eaa56c29e1200da12f8ed", "committedDate": "2020-09-14T16:22:04Z", "message": ":construction: Fixed removed page request"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b17dd0bdc30ef487b860880c60e059b8ccbd2ac", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/3b17dd0bdc30ef487b860880c60e059b8ccbd2ac", "committedDate": "2020-09-14T17:39:26Z", "message": ":bulb: Updated JavaDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f41b1d6c59ec6d875bd65693071965cd3e39965f", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/f41b1d6c59ec6d875bd65693071965cd3e39965f", "committedDate": "2020-09-14T17:58:05Z", "message": ":construction: Updated request to create remote project with better enum support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b4cb7fbb52a1cee26cbb096b064961ddace1d61", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/5b4cb7fbb52a1cee26cbb096b064961ddace1d61", "committedDate": "2020-09-14T18:13:38Z", "message": ":memo: Fixed typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6776d1b0c0a53952420effbd5a157263be78b4e6", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/6776d1b0c0a53952420effbd5a157263be78b4e6", "committedDate": "2020-09-14T18:15:25Z", "message": ":memo: Fixed typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80ebcbb567a318e20b3e7437e9884cd80440ecf4", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/80ebcbb567a318e20b3e7437e9884cd80440ecf4", "committedDate": "2020-09-14T18:33:08Z", "message": ":construction: removed old angular reference and page variables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bfe2c4a7fa552679b66d3a8884f3d115c0701ac", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/7bfe2c4a7fa552679b66d3a8884f3d115c0701ac", "committedDate": "2020-09-14T18:55:58Z", "message": ":construction: Seperated out the create form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e654ab99b60e780b635f9ec402c3381298b7609", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/2e654ab99b60e780b635f9ec402c3381298b7609", "committedDate": "2020-09-15T10:38:28Z", "message": ":construction: This was added to the wrong page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9e1554b9a578679e6f94a30b7745e7a8ca7be11", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/e9e1554b9a578679e6f94a30b7745e7a8ca7be11", "committedDate": "2020-09-15T11:32:25Z", "message": ":construction: Fixed issue with sync frequencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f261953c51a7511b4f0f5365c5a707e2ba964b8b", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/f261953c51a7511b4f0f5365c5a707e2ba964b8b", "committedDate": "2020-09-15T11:40:15Z", "message": ":memo: Updated CHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bed89508ebc796091a80d8e68a964fdd9676377", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/1bed89508ebc796091a80d8e68a964fdd9676377", "committedDate": "2020-09-15T11:40:53Z", "message": "Merge branch 'FIX-remote-oauth-CLIENT_DETAILS' into FIX-remoate-oath-CREATE_REMOTE_PROJECT\n\n# Conflicts:\n#\tCHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1a7990bd9d94aa551b0410b1fda607a67fc8936", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/c1a7990bd9d94aa551b0410b1fda607a67fc8936", "committedDate": "2020-09-15T13:16:02Z", "message": ":construction: Fixed issue with center popup window on screen"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac8d0804c0d4ddf25e5ce842583b2ad1b8497e4a", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/ac8d0804c0d4ddf25e5ce842583b2ad1b8497e4a", "committedDate": "2020-09-15T14:33:56Z", "message": ":bulb: Fixed typo in CreateRemoteProjectRequest docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6279225572747be61cfd7b03fbda8dfb5e6e536", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/e6279225572747be61cfd7b03fbda8dfb5e6e536", "committedDate": "2020-09-15T15:53:02Z", "message": ":white_check_mark: Fixed broken tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "585c70733be6286d5dae2c90f1fbdaffcb590ef3", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/585c70733be6286d5dae2c90f1fbdaffcb590ef3", "committedDate": "2020-09-15T17:02:05Z", "message": "Merge branch 'FIX-remote-oath' into FIX-remoate-oath-CREATE_REMOTE_PROJECT"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODUyMTY4", "url": "https://github.com/phac-nml/irida/pull/801#pullrequestreview-488852168", "createdAt": "2020-09-15T16:18:56Z", "commit": {"oid": "e6279225572747be61cfd7b03fbda8dfb5e6e536"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjoxODo1NlrOHSJuRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjo0NjowNVrOHSKwKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc5NTcxOQ==", "bodyText": "I don't think we need these final variables", "url": "https://github.com/phac-nml/irida/pull/801#discussion_r488795719", "createdAt": "2020-09-15T16:18:56Z", "author": {"login": "deepsidhu85"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/projects/ProjectsController.java", "diffHunk": "@@ -654,8 +569,8 @@ private DTProject createDataTablesProject(Project project) {\n \t * Response class for a {@link Project} and its {@link RemoteStatus}\n \t */\n \tpublic class ProjectByApiResponse {\n-\t\tprivate RemoteStatus remoteStatus;\n-\t\tprivate Project project;\n+\t\tprivate final RemoteStatus remoteStatus;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6279225572747be61cfd7b03fbda8dfb5e6e536"}, "originalPosition": 181}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwNzUyMQ==", "bodyText": "Function comments", "url": "https://github.com/phac-nml/irida/pull/801#discussion_r488807521", "createdAt": "2020-09-15T16:37:43Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/apis/remote-api/remote-api.js", "diffHunk": "@@ -1,13 +1,48 @@\n import axios from \"axios\";\n import { setBaseUrl } from \"../../utilities/url-utilities\";\n \n+const BASE_URL = setBaseUrl(`ajax/remote_api`);\n+\n /**\n  * Check the status of a specific Remote API.\n  * @param {number} id - identifier for the API.\n  * @returns {Promise<boolean>}\n  */\n export function checkConnectionStatus({ id }) {\n   return axios\n-    .get(setBaseUrl(`ajax/remote_api/status/${id}`))\n-    .then(({ data }) => data === \"valid_token\");\n+    .get(`${BASE_URL}/status/${id}`)\n+    .then(({ data }) => data)\n+    .catch(() => false);\n+}\n+\n+/**\n+ * Get the specific details about a remote api connection\n+ * @param id - identifier for a remote api\n+ * @returns {Promise<*>}\n+ */\n+export function getConnectionDetails({ id }) {\n+  return axios.get(`${BASE_URL}/${id}`).then(({ data }) => data);\n+}\n+\n+/**\n+ * Delete a specific remote api\n+ * @param id - identifier for a remote api\n+ * @returns {Promise<AxiosResponse<any>>}\n+ */\n+export function deleteRemoteApi({ id }) {\n+  return axios.delete(`${BASE_URL}/${id}/delete`);\n+}\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6279225572747be61cfd7b03fbda8dfb5e6e536"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgxMDE5MQ==", "bodyText": "Internationalize", "url": "https://github.com/phac-nml/irida/pull/801#discussion_r488810191", "createdAt": "2020-09-15T16:42:09Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/components/remote-api/CreateRemoteProjectSyncForm.jsx", "diffHunk": "@@ -0,0 +1,158 @@\n+import React, { useEffect, useRef, useState } from \"react\";\n+import { Button, Checkbox, Form, Input, Select } from \"antd\";\n+import {\n+  createSynchronizedProject,\n+  getListOfRemoteApis,\n+  getProjectsForAPI,\n+} from \"../../apis/remote-api/remote-api\";\n+import { setBaseUrl } from \"../../utilities/url-utilities\";\n+import { RemoteApiStatus } from \"../../pages/admin/components/remote-connections/RemoteApiStatus\";\n+import { HelpPopover } from \"../popovers\";\n+\n+/**\n+ * React form for creating a Synchronized Remote Project\n+ * @returns {JSX.Element}\n+ * @constructor\n+ */\n+export function CreateRemoteProjectSyncForm() {\n+  const [apis, setApis] = useState([]);\n+  const [selectedApi, setSelectedApi] = useState();\n+  const [projects, setProjects] = useState([]);\n+  const [connected, setConnected] = useState();\n+  const [manual, setManual] = useState(false);\n+  const [form] = Form.useForm();\n+  const apiRef = useRef();\n+\n+  useEffect(() => {\n+    // Load all remote api's at mount time\n+    getListOfRemoteApis().then((list) => {\n+      setApis(list);\n+      if (list.length === 1) {\n+        form.setFieldsValue({ api: 0 });\n+        setSelectedApi(list[0]);\n+      }\n+      // Set user focus on the api select after at mount time\n+      apiRef.current.focus();\n+    });\n+  }, [form]);\n+\n+  /**\n+   * Update the status of a specific api.\n+   * @param {number} value - index of the api in the apis list.\n+   */\n+  const updateApiStatus = (value) => setSelectedApi(apis[value]);\n+\n+  const getApiProjects = () => {\n+    if (selectedApi.id) {\n+      getProjectsForAPI({ id: selectedApi.id })\n+        .then(setProjects)\n+        .then(() => setConnected(true));\n+    }\n+  };\n+\n+  const createRemote = () => {\n+    const url = form.getFieldValue(\"project\");\n+    const frequency = form.getFieldValue(\"frequency\");\n+    createSynchronizedProject({\n+      url,\n+      frequency,\n+    }).then(({ id }) => (window.location.href = setBaseUrl(`/projects/${id}`)));\n+  };\n+\n+  return (\n+    <Form\n+      form={form}\n+      layout=\"vertical\"\n+      initialValues={{\n+        frequency: 2,\n+      }}\n+    >\n+      <Form.Item\n+        name=\"api\"\n+        label={i18n(\"NewProjectSync.api\")}\n+        help={i18n(\"NewProjectSync.api.help\")}\n+      >\n+        <Select\n+          ref={apiRef}\n+          showSearch\n+          onChange={updateApiStatus}\n+          placeholder={i18n(\"NewProjectSync.api.placeholder\")}\n+        >\n+          {apis.map((api, index) => (\n+            <Select.Option key={`api-${api.id}`} value={index}>\n+              {api.name}\n+            </Select.Option>\n+          ))}\n+        </Select>\n+      </Form.Item>\n+      {selectedApi ? (\n+        <>\n+          <Form.Item label={i18n(\"NewProjectSync.api-status\")}>\n+            <RemoteApiStatus api={selectedApi} onConnect={getApiProjects} />\n+          </Form.Item>\n+          {connected ? (\n+            <>\n+              <Form.Item label={i18n(\"NewProjectSync.project\")} name=\"project\">\n+                <Select\n+                  onChange={(value) =>\n+                    form.setFieldsValue({ projectUrl: value })\n+                  }\n+                  showSearch\n+                  options={projects}\n+                  placeholder={i18n(\"NewProjectSync.project.placeholder\")}\n+                />\n+              </Form.Item>\n+              <Form.Item\n+                required\n+                label={\n+                  <span>\n+                    REMOTE PROJECT URL", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6279225572747be61cfd7b03fbda8dfb5e6e536"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgxMDI5OA==", "bodyText": "Internationalize", "url": "https://github.com/phac-nml/irida/pull/801#discussion_r488810298", "createdAt": "2020-09-15T16:42:19Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/components/remote-api/CreateRemoteProjectSyncForm.jsx", "diffHunk": "@@ -0,0 +1,158 @@\n+import React, { useEffect, useRef, useState } from \"react\";\n+import { Button, Checkbox, Form, Input, Select } from \"antd\";\n+import {\n+  createSynchronizedProject,\n+  getListOfRemoteApis,\n+  getProjectsForAPI,\n+} from \"../../apis/remote-api/remote-api\";\n+import { setBaseUrl } from \"../../utilities/url-utilities\";\n+import { RemoteApiStatus } from \"../../pages/admin/components/remote-connections/RemoteApiStatus\";\n+import { HelpPopover } from \"../popovers\";\n+\n+/**\n+ * React form for creating a Synchronized Remote Project\n+ * @returns {JSX.Element}\n+ * @constructor\n+ */\n+export function CreateRemoteProjectSyncForm() {\n+  const [apis, setApis] = useState([]);\n+  const [selectedApi, setSelectedApi] = useState();\n+  const [projects, setProjects] = useState([]);\n+  const [connected, setConnected] = useState();\n+  const [manual, setManual] = useState(false);\n+  const [form] = Form.useForm();\n+  const apiRef = useRef();\n+\n+  useEffect(() => {\n+    // Load all remote api's at mount time\n+    getListOfRemoteApis().then((list) => {\n+      setApis(list);\n+      if (list.length === 1) {\n+        form.setFieldsValue({ api: 0 });\n+        setSelectedApi(list[0]);\n+      }\n+      // Set user focus on the api select after at mount time\n+      apiRef.current.focus();\n+    });\n+  }, [form]);\n+\n+  /**\n+   * Update the status of a specific api.\n+   * @param {number} value - index of the api in the apis list.\n+   */\n+  const updateApiStatus = (value) => setSelectedApi(apis[value]);\n+\n+  const getApiProjects = () => {\n+    if (selectedApi.id) {\n+      getProjectsForAPI({ id: selectedApi.id })\n+        .then(setProjects)\n+        .then(() => setConnected(true));\n+    }\n+  };\n+\n+  const createRemote = () => {\n+    const url = form.getFieldValue(\"project\");\n+    const frequency = form.getFieldValue(\"frequency\");\n+    createSynchronizedProject({\n+      url,\n+      frequency,\n+    }).then(({ id }) => (window.location.href = setBaseUrl(`/projects/${id}`)));\n+  };\n+\n+  return (\n+    <Form\n+      form={form}\n+      layout=\"vertical\"\n+      initialValues={{\n+        frequency: 2,\n+      }}\n+    >\n+      <Form.Item\n+        name=\"api\"\n+        label={i18n(\"NewProjectSync.api\")}\n+        help={i18n(\"NewProjectSync.api.help\")}\n+      >\n+        <Select\n+          ref={apiRef}\n+          showSearch\n+          onChange={updateApiStatus}\n+          placeholder={i18n(\"NewProjectSync.api.placeholder\")}\n+        >\n+          {apis.map((api, index) => (\n+            <Select.Option key={`api-${api.id}`} value={index}>\n+              {api.name}\n+            </Select.Option>\n+          ))}\n+        </Select>\n+      </Form.Item>\n+      {selectedApi ? (\n+        <>\n+          <Form.Item label={i18n(\"NewProjectSync.api-status\")}>\n+            <RemoteApiStatus api={selectedApi} onConnect={getApiProjects} />\n+          </Form.Item>\n+          {connected ? (\n+            <>\n+              <Form.Item label={i18n(\"NewProjectSync.project\")} name=\"project\">\n+                <Select\n+                  onChange={(value) =>\n+                    form.setFieldsValue({ projectUrl: value })\n+                  }\n+                  showSearch\n+                  options={projects}\n+                  placeholder={i18n(\"NewProjectSync.project.placeholder\")}\n+                />\n+              </Form.Item>\n+              <Form.Item\n+                required\n+                label={\n+                  <span>\n+                    REMOTE PROJECT URL\n+                    <Checkbox onChange={(e) => setManual(e.target.checked)}>\n+                      Set url manually", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6279225572747be61cfd7b03fbda8dfb5e6e536"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgxMjU4Nw==", "bodyText": "Add comments to this function", "url": "https://github.com/phac-nml/irida/pull/801#discussion_r488812587", "createdAt": "2020-09-15T16:46:05Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/pages/admin/components/remote-connections/RemoteApiStatus.jsx", "diffHunk": "@@ -0,0 +1,91 @@\n+import React, { useEffect, useState } from \"react\";\n+import { Alert, Button } from \"antd\";\n+import { checkConnectionStatus } from \"../../../../apis/remote-api/remote-api\";\n+import { setBaseUrl } from \"../../../../utilities/url-utilities\";\n+import { IconLoading, IconLogin } from \"../../../../components/icons/Icons\";\n+import { SPACE_XS } from \"../../../../styles/spacing\";\n+import { formatInternationalizedDateTime } from \"../../../../utilities/date-utilities\";\n+\n+/**\n+ * React component to render the status of a Remote API.\n+ * If the API is not connected it will present the user a button allowing\n+ * them to connect.\n+ * @param {object} api - details about the remote API\n+ * @param {function} onConnect - what do when the connection is made.\n+ * @returns {*}\n+ * @constructor\n+ */\n+export function RemoteApiStatus({ api, onConnect = () => {} }) {\n+  const [loading, setLoading] = useState(true);\n+  const [expiration, setExpiration] = useState(undefined);\n+\n+  useEffect(checkApiStatus, []);\n+\n+  useEffect(() => {\n+    // Listen for a remote api connection\n+    window.addEventListener(\"message\", updateRemoteApi, false);\n+    return () => window.removeEventListener(\"message\", updateRemoteApi);\n+  }, []);\n+\n+  useEffect(() => checkApiStatus(), [api.id]);\n+\n+  function checkApiStatus() {\n+    setLoading(true);\n+    checkConnectionStatus({ id: api.id }).then((data) => {\n+      setLoading(false);\n+      setExpiration(data);\n+      data && onConnect();\n+    });\n+  }\n+\n+  function updateRemoteApi(event) {\n+    if (\n+      event.origin === window.location.origin &&\n+      event.data === \"remote_api_connect\"\n+    ) {\n+      checkApiStatus();\n+    }\n+  }\n+\n+  function updateConnectionStatus() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6279225572747be61cfd7b03fbda8dfb5e6e536"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf21801406f8704b290fe2765b38dd26ac6bd17f", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/cf21801406f8704b290fe2765b38dd26ac6bd17f", "committedDate": "2020-09-15T17:23:12Z", "message": ":fire: This class was not used anymore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76197dc4c28387a4bfb35cc6133e5ae2b0044731", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/76197dc4c28387a4bfb35cc6133e5ae2b0044731", "committedDate": "2020-09-15T17:25:09Z", "message": ":bulb: Added JSDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "822fbe4d0a6e2fa59b9a28536d5e05606f1e7987", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/822fbe4d0a6e2fa59b9a28536d5e05606f1e7987", "committedDate": "2020-09-15T17:32:06Z", "message": ":globe_with_meridians: Updated i18n"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "611706cbe6ec2624b3ea759cf6541983c98a771e", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/611706cbe6ec2624b3ea759cf6541983c98a771e", "committedDate": "2020-09-15T17:34:08Z", "message": ":bulb: Updated JSDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00cff37f2827c5d40a090f4e365138f1227d7726", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/00cff37f2827c5d40a090f4e365138f1227d7726", "committedDate": "2020-09-15T19:46:32Z", "message": ":recycle: Made the sync frequency into its own component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c7714e2284ab0d8ad76c3e3755b419bcdc1ace1", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/4c7714e2284ab0d8ad76c3e3755b419bcdc1ace1", "committedDate": "2020-09-15T19:48:49Z", "message": ":construction: Removed offensive word alert!"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da661e69eb6dbb64f291c61d4b410c701d38896c", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/da661e69eb6dbb64f291c61d4b410c701d38896c", "committedDate": "2020-09-16T12:10:24Z", "message": ":white_check_mark: Fixed broken remote sync page tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d6d0f3b96d75b15fe89acee2419483bf6c9a1d0", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/3d6d0f3b96d75b15fe89acee2419483bf6c9a1d0", "committedDate": "2020-09-16T12:51:45Z", "message": "\ud83d\udcdd Updated synchronize-connect-api image"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a070fc4c969c001014f9f08c2acbf7776413c9a7", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/a070fc4c969c001014f9f08c2acbf7776413c9a7", "committedDate": "2020-09-16T13:16:58Z", "message": ":memo: Updated create remote project docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NjQwNzkz", "url": "https://github.com/phac-nml/irida/pull/801#pullrequestreview-489640793", "createdAt": "2020-09-16T13:44:46Z", "commit": {"oid": "a070fc4c969c001014f9f08c2acbf7776413c9a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11bab01d21a1fcfe66b5172dc764675e60a29992", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/11bab01d21a1fcfe66b5172dc764675e60a29992", "committedDate": "2020-09-16T13:58:32Z", "message": "Merge branch 'FIX-remote-oath' into FIX-remoate-oath-CREATE_REMOTE_PROJECT\n\n# Conflicts:\n#\tCHANGELOG.md"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 111, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}