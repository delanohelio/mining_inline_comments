{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyMjA4NDYz", "number": 566, "title": "Analyses queue counts", "bodyText": "Description of changes\nAdded a react component for displaying analyses queued and running counts on all analyses listing pages, the cart page, and pipeline launch page.\n\nRelated issue\nFixes #342\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n[X ] CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n Tests added (or description of how to test) for any new features.\n* [ ] User documentation updated for UI or technical changes.", "createdAt": "2020-01-13T16:29:06Z", "url": "https://github.com/phac-nml/irida/pull/566", "merged": true, "mergeCommit": {"oid": "d4480b1e2b4be6f949a5f027457fcb91d90f3fc5"}, "closed": true, "closedAt": "2020-01-21T21:46:23Z", "author": {"login": "joshsadam"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbwAlnlgH2gAyMzYyMjA4NDYzOjkyYzdiZTQ0OTI5OWY0YTAwNDgwNDJjNDY4Y2JiMjE2ZmY2YmVjZDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8oR9KAFqTM0NjIxMzk4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "92c7be449299f4a0048042c468cbb216ff6becd0", "author": {"user": {"login": "tom114", "name": "Tom Matthews"}}, "url": "https://github.com/phac-nml/irida/commit/92c7be449299f4a0048042c468cbb216ff6becd0", "committedDate": "2019-12-13T16:44:23Z", "message": "adding some initial files for showing analysis queue count.  pct bar for now"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "089c23faad8ed67d949d7e5ae87390bb9e1311fb", "author": {"user": {"login": "tom114", "name": "Tom Matthews"}}, "url": "https://github.com/phac-nml/irida/commit/089c23faad8ed67d949d7e5ae87390bb9e1311fb", "committedDate": "2020-01-10T16:59:47Z", "message": "Merge branch 'development' into analysis-queue-count"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bba7024f5a9ebfcdc0dae83c17c3657e09a8d5a", "author": {"user": {"login": "tom114", "name": "Tom Matthews"}}, "url": "https://github.com/phac-nml/irida/commit/3bba7024f5a9ebfcdc0dae83c17c3657e09a8d5a", "committedDate": "2020-01-10T17:02:37Z", "message": "commenting the service and repo methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9628908c86d709adb9e8f20edc3168286873359c", "author": {"user": {"login": "tom114", "name": "Tom Matthews"}}, "url": "https://github.com/phac-nml/irida/commit/9628908c86d709adb9e8f20edc3168286873359c", "committedDate": "2020-01-10T17:05:09Z", "message": "rolling back controllers and web components"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec0f4b32fe3d88f613d40620c3a7cd1da0edeaca", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/ec0f4b32fe3d88f613d40620c3a7cd1da0edeaca", "committedDate": "2020-01-13T20:47:38Z", "message": "Display the running and queued analyes counts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95e8f8245aede87781e27abf44f9372cc5ea7438", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/95e8f8245aede87781e27abf44f9372cc5ea7438", "committedDate": "2020-01-14T14:23:57Z", "message": "Internationalized support for number formatting."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "481b6fab5bb91e5c3b208b08c8c2541932a264b3", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/481b6fab5bb91e5c3b208b08c8c2541932a264b3", "committedDate": "2020-01-14T16:30:21Z", "message": "Forgot to remove constant when testing size"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4824571a7f190124a6d4b81730db957a8502c38", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/b4824571a7f190124a6d4b81730db957a8502c38", "committedDate": "2020-01-14T19:02:43Z", "message": "Removed unused import."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd4f5a0e66e7e58c716ee509217f788b7d851a15", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/fd4f5a0e66e7e58c716ee509217f788b7d851a15", "committedDate": "2020-01-15T14:55:16Z", "message": "Fixed test and updated CHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99e7df9e19d51bb979760682975f8a6e5c06c34c", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/99e7df9e19d51bb979760682975f8a6e5c06c34c", "committedDate": "2020-01-20T20:38:26Z", "message": "Merge branch 'development' into analyses-queue-counts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NTI3NDgw", "url": "https://github.com/phac-nml/irida/pull/566#pullrequestreview-345527480", "createdAt": "2020-01-20T20:51:03Z", "commit": {"oid": "fd4f5a0e66e7e58c716ee509217f788b7d851a15"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQyMDo1MzoxNVrOFfpBkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQyMDo1MzoxNVrOFfpBkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODcyMjMyMw==", "bodyText": "I like the idea of the running man icon, but I don't think it's clear enough.  Any ideas for text replacements?  Maybe a tooltip? I might even say it looks better with no icon or text.", "url": "https://github.com/phac-nml/irida/pull/566#discussion_r368722323", "createdAt": "2020-01-20T20:53:15Z", "author": {"login": "tom114"}, "path": "src/main/webapp/resources/js/components/AnalysesQueue.jsx", "diffHunk": "@@ -0,0 +1,70 @@\n+import React, { useEffect, useState } from \"react\";\n+import { Tag } from \"antd\";\n+import { fetchAnalysesQueueCounts } from \"./../apis/analysis/analysis\";\n+import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n+import { faRunning } from \"@fortawesome/free-solid-svg-icons\";\n+import { SPACE_XS } from \"../styles/spacing\";\n+import styled from \"styled-components\";\n+import { formatNumber } from \"../utilities/number-utilities\";\n+import { blue4 } from \"../styles/colors\";\n+\n+const LabelTD = styled.td`\n+  font-weight: bold;\n+`;\n+\n+const ValueTD = styled.td`\n+  width: 50px;\n+  text-align: right;\n+  font-family: monospace;\n+`;\n+\n+/**\n+ * React component for rendering the current server status\n+ * for running analyses.\n+ * @return {*}\n+ * @constructor\n+ */\n+export function AnalysesQueue({}) {\n+  const [running, setRunning] = useState(0);\n+  const [queued, setQueued] = useState(0);\n+\n+  useEffect(() => {\n+    fetchAnalysesQueueCounts().then(data => {\n+      setRunning(data.running);\n+      setQueued(data.queued);\n+    });\n+  }, [fetchAnalysesQueueCounts]);\n+\n+  return (\n+    <Tag color={\"blue\"}>\n+      <div\n+        style={{\n+          width: 150,\n+          display: \"flex\",\n+          justifyContent: \"space-between\",\n+          alignContent: \"center\"\n+        }}\n+      >\n+        <FontAwesomeIcon", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99e7df9e19d51bb979760682975f8a6e5c06c34c"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dec89f29be084ce651d8506519bdce798ff86aba", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/dec89f29be084ce651d8506519bdce798ff86aba", "committedDate": "2020-01-21T15:38:25Z", "message": "Updated documentation and added a tooltip"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MDUyOTMw", "url": "https://github.com/phac-nml/irida/pull/566#pullrequestreview-346052930", "createdAt": "2020-01-21T17:19:53Z", "commit": {"oid": "dec89f29be084ce651d8506519bdce798ff86aba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNzoxOTo1M1rOFgCQXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNzoxOTo1M1rOFgCQXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEzNTcxMQ==", "bodyText": "Can we target this on either the left or bottom center? it gives me very weird overflows depending on screen size.", "url": "https://github.com/phac-nml/irida/pull/566#discussion_r369135711", "createdAt": "2020-01-21T17:19:53Z", "author": {"login": "tom114"}, "path": "src/main/webapp/resources/js/components/AnalysesQueue.jsx", "diffHunk": "@@ -0,0 +1,80 @@\n+import React, { useEffect, useState } from \"react\";\n+import { Tag, Tooltip } from \"antd\";\n+import { fetchAnalysesQueueCounts } from \"./../apis/analysis/analysis\";\n+import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n+import { faRunning } from \"@fortawesome/free-solid-svg-icons\";\n+import { SPACE_XS } from \"../styles/spacing\";\n+import styled from \"styled-components\";\n+import { formatNumber } from \"../utilities/number-utilities\";\n+import { blue4 } from \"../styles/colors\";\n+\n+const LabelTD = styled.td`\n+  font-weight: bold;\n+`;\n+\n+const ValueTD = styled.td`\n+  width: 50px;\n+  text-align: right;\n+  font-family: monospace;\n+`;\n+\n+/**\n+ * React component for rendering the current server status\n+ * for running analyses.\n+ * @return {*}\n+ * @constructor\n+ */\n+export function AnalysesQueue({}) {\n+  const [running, setRunning] = useState(0);\n+  const [queued, setQueued] = useState(0);\n+\n+  useEffect(() => {\n+    fetchAnalysesQueueCounts().then(data => {\n+      setRunning(data.running);\n+      setQueued(data.queued);\n+    });\n+  }, [fetchAnalysesQueueCounts]);\n+\n+  return (\n+    <Tooltip title={i18n(\"AnalysesQueue.title\")} placement={\"bottomRight\"}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dec89f29be084ce651d8506519bdce798ff86aba"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MDU1NTQx", "url": "https://github.com/phac-nml/irida/pull/566#pullrequestreview-346055541", "createdAt": "2020-01-21T17:23:43Z", "commit": {"oid": "dec89f29be084ce651d8506519bdce798ff86aba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNzoyMzo0M1rOFgCYWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNzoyMzo0M1rOFgCYWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEzNzc1Mg==", "bodyText": "Comment on this class please", "url": "https://github.com/phac-nml/irida/pull/566#discussion_r369137752", "createdAt": "2020-01-21T17:23:43Z", "author": {"login": "tom114"}, "path": "src/test/java/ca/corefacility/bioinformatics/irida/ria/integration/components/AnalysesQueue.java", "diffHunk": "@@ -0,0 +1,26 @@\n+package ca.corefacility.bioinformatics.irida.ria.integration.components;\n+\n+import org.openqa.selenium.WebDriver;\n+import org.openqa.selenium.WebElement;\n+import org.openqa.selenium.support.FindBy;\n+import org.openqa.selenium.support.PageFactory;\n+\n+public class AnalysesQueue {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dec89f29be084ce651d8506519bdce798ff86aba"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09ed5e84cccec47b34e10d6fce0709e0f7009f00", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/09ed5e84cccec47b34e10d6fce0709e0f7009f00", "committedDate": "2020-01-21T17:26:28Z", "message": "Updated file comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d76b2493d65241c307a221f85c75041ccd05ecd", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/9d76b2493d65241c307a221f85c75041ccd05ecd", "committedDate": "2020-01-21T18:57:19Z", "message": "Fixed full width table issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c482c7db0c67ab75259051a6de48d5d7becdb0d5", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/c482c7db0c67ab75259051a6de48d5d7becdb0d5", "committedDate": "2020-01-21T18:58:03Z", "message": "Merge branch 'and-table-width-fix' into analyses-queue-counts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6f29fefd0838bed82d6b4c11c6105f4976ee8c3", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/a6f29fefd0838bed82d6b4c11c6105f4976ee8c3", "committedDate": "2020-01-21T20:59:33Z", "message": "Merge branch 'development' into analyses-queue-counts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MjEzOTgy", "url": "https://github.com/phac-nml/irida/pull/566#pullrequestreview-346213982", "createdAt": "2020-01-21T21:46:12Z", "commit": {"oid": "a6f29fefd0838bed82d6b4c11c6105f4976ee8c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 291, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}