{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4MjM4MTQ0", "number": 873, "title": "Add reference file upload progress", "bodyText": "Description of changes\nWhat did you change in this pull request?  Provide a description of files changed, user interactions changed, etc.  Include how to test your changes.\nReference file uploads now display progress for each file being uploaded to a project using a custom request.\nRelated issue\nLink to the GitHub issue this pull request addresses using the #issuenum format.  If it completes an issue, use Fixes #issuenum to automatically close the issue.\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n* [ ] Tests added (or description of how to test) for any new features.\n* [ ] User documentation updated for UI or technical changes.", "createdAt": "2020-11-26T19:17:04Z", "url": "https://github.com/phac-nml/irida/pull/873", "merged": true, "mergeCommit": {"oid": "eeb782045d6a14af33451c581f573f75eacf2e60"}, "closed": true, "closedAt": "2020-12-02T16:01:21Z", "author": {"login": "deepsidhu85"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgX7EkgH2gAyNTI4MjM4MTQ0OjQ1OWM0MTM3ZTc2NmEyNzI1NzA5NmEzNzMwYmRmMmYxMzk2ODZhMGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiQvrSgFqTU0Mjk4NzEzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "459c4137e766a27257096a3730bdf2f139686a0b", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/459c4137e766a27257096a3730bdf2f139686a0b", "committedDate": "2020-11-26T19:15:09Z", "message": "Added progress display for reference file uploads"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4d3b1c35c0f1e2342e759883fc5358f70282996", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/a4d3b1c35c0f1e2342e759883fc5358f70282996", "committedDate": "2020-11-26T19:16:17Z", "message": "Merge branch 'development' into add-reference-file-upload-progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da7a321201ff6411d36a0f1d7de13ce6e0cdbbd0", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/da7a321201ff6411d36a0f1d7de13ce6e0cdbbd0", "committedDate": "2020-11-27T15:00:21Z", "message": "Updated CHANGELOG"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMTA3NTg2", "url": "https://github.com/phac-nml/irida/pull/873#pullrequestreview-540107586", "createdAt": "2020-11-27T17:09:40Z", "commit": {"oid": "da7a321201ff6411d36a0f1d7de13ce6e0cdbbd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxNzowOTo0MFrOH7Engw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxNzowOTo0MFrOH7Engw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcwMzY4Mw==", "bodyText": "When using await keep to the syntax you like (this is probably how I have been doing it and it is not exactly correct.  Keep the way I have seen you write it, it is much more elegant.  Also, I learned recently that instead of throwing a new error, just return a rejected promise:\nexport async function uploadProjectReferenceFiles(projectId, formData, config) {\n  try {\n    const { data } = await axios.post(\n      setBaseUrl(`ajax/reference-files/project/${projectId}`),\n      formData,\n      config\n    );\n    return data;\n  } catch (e) {\n    return Promise.reject(error.response.data.error);\n  }\n}\nYou can then handle this the same way:\nuploadProjectReferenceFiles(projectId, formData, config)\n  .then(console.log)\n  .catch(console.error);   \nYou should start freaking out on me when I don't do it this way!", "url": "https://github.com/phac-nml/irida/pull/873#discussion_r531703683", "createdAt": "2020-11-27T17:09:40Z", "author": {"login": "joshsadam"}, "path": "src/main/webapp/resources/js/apis/projects/reference-files.js", "diffHunk": "@@ -41,3 +41,23 @@ export async function removeProjectReferenceFile(projectId, fileId) {\n       throw new Error(error.response.data.error);\n     });\n }\n+\n+/**\n+ * Remove the reference file from the project id provided\n+ * @param {projectId} project for which to remove reference file from\n+ * @param {formData} List of files to upload\n+ * @param config Configuration options for upload\n+ * @return {Promise<*>} `data` contains the OK response; `error` contains error information if an error occurred.\n+ */\n+export async function uploadProjectReferenceFiles(projectId, formData, config) {\n+  return await axios\n+    .post(\n+      setBaseUrl(`ajax/reference-files/project/${projectId}`),\n+      formData,\n+      config\n+    )\n+    .then(({ data }) => data)\n+    .catch((error) => {\n+      throw new Error(error.response.data.error);\n+    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da7a321201ff6411d36a0f1d7de13ce6e0cdbbd0"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "496e77453248495380b0e3afe0eea9b5031b7f33", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/496e77453248495380b0e3afe0eea9b5031b7f33", "committedDate": "2020-11-27T19:34:34Z", "message": "Updated api call to return a promise.reject instead of throwing new error. Fixed console warnings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40847b22cc8e70680c848ce10e51587a905a9cc6", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/40847b22cc8e70680c848ce10e51587a905a9cc6", "committedDate": "2020-11-30T20:51:08Z", "message": "Merged dev and fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "813160d548918d2c31ea8c7722f6d928262fb2ca", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/813160d548918d2c31ea8c7722f6d928262fb2ca", "committedDate": "2020-12-01T16:42:57Z", "message": "Removed custom progress bar and updated progress to show percentage as whole number"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41c5ae0e4ab17dd402a7bed30fa54897758cdb5a", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/41c5ae0e4ab17dd402a7bed30fa54897758cdb5a", "committedDate": "2020-12-01T20:40:26Z", "message": "Upload list is hidden once uploads are completed or errored"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyOTg3MTMw", "url": "https://github.com/phac-nml/irida/pull/873#pullrequestreview-542987130", "createdAt": "2020-12-02T16:01:13Z", "commit": {"oid": "41c5ae0e4ab17dd402a7bed30fa54897758cdb5a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4980, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}