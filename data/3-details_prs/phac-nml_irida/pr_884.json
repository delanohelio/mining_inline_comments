{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyNzExNDMw", "number": 884, "title": "Updated displaying sample details within the cart", "bodyText": "Description of changes\nUsers can already view details about a sample from within the cart.  This PR simplifies the code and makes it more self contained so can be used anywhere.  Eventually the goal is to be able to do everything for a sample from within this details display.\nThis is setting up for use within the new pipeline launch page.\nRelated issue\nN/A\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n* [ ] Tests added (or description of how to test) for any new features.\n* [ ] User documentation updated for UI or technical changes.", "createdAt": "2020-12-04T18:33:24Z", "url": "https://github.com/phac-nml/irida/pull/884", "merged": true, "mergeCommit": {"oid": "b571247d84e9c3c461151757640a3735f3fb3c44"}, "closed": true, "closedAt": "2020-12-15T13:24:56Z", "author": {"login": "joshsadam"}, "timelineItems": {"totalCount": 42, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgva6qgH2gAyNTMyNzExNDMwOmRmNmFhNGNlZjI5N2YzNGNhNzkyY2VhZDA0Y2M4NzBiN2Q4YmVlMzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmYyZ2AH2gAyNTMyNzExNDMwOjVjZWYyYjliOTNjZTI5MDllZmQxZGJmNDg4MWZmMjgxZWVlNzU0MTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "df6aa4cef297f34ca792cead04cc870b7d8bee33", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/df6aa4cef297f34ca792cead04cc870b7d8bee33", "committedDate": "2020-11-27T22:37:45Z", "message": "Initial commit.\n\nReworking samples drawer to show full detials and files."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e79ca06a5e9e6c594d40750aab7cd7357e8a38a8", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/e79ca06a5e9e6c594d40750aab7cd7357e8a38a8", "committedDate": "2020-11-28T02:16:11Z", "message": "Updating server code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0575ba8466e366e41ac16addd65827778bbb234", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/d0575ba8466e366e41ac16addd65827778bbb234", "committedDate": "2020-11-30T11:21:45Z", "message": "Working on indicating if a sample is in the cart"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a14514fa5c3f3636229d90853ce9b26e6d06a95", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/3a14514fa5c3f3636229d90853ce9b26e6d06a95", "committedDate": "2020-11-30T18:15:58Z", "message": "If the sample is in the part return the project id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bf6c7208c66ee64f70f9a0042a4d3e6e9ca154a", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/7bf6c7208c66ee64f70f9a0042a4d3e6e9ca154a", "committedDate": "2020-12-02T13:23:50Z", "message": "Merge branch 'fix-adding-samples-response' into cart-sample-details\n\n# Conflicts:\n#\tsrc/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UICartService.java\n#\tsrc/main/java/ca/corefacility/bioinformatics/irida/ria/web/sessionAttrs/Cart.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ddb09ab585e5550e0c4f20a56651ce0db9071a0", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/4ddb09ab585e5550e0c4f20a56651ce0db9071a0", "committedDate": "2020-12-02T15:14:44Z", "message": "Remove sample from cart"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b10a07c774a6c966c384ab4c36a237807ff71f0b", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/b10a07c774a6c966c384ab4c36a237807ff71f0b", "committedDate": "2020-12-02T15:50:04Z", "message": "Added button to remove sample from cart"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "116617cc01c93905e5b3ee4caaa051bc84270de5", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/116617cc01c93905e5b3ee4caaa051bc84270de5", "committedDate": "2020-12-02T16:56:34Z", "message": "Show sample created date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a47426736312f4753154ec7eb3fb0edd5995e9db", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/a47426736312f4753154ec7eb3fb0edd5995e9db", "committedDate": "2020-12-02T18:47:54Z", "message": "Working on displaying files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1024b975289576144dfc55eb125d5cbae4d273c5", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/1024b975289576144dfc55eb125d5cbae4d273c5", "committedDate": "2020-12-03T18:37:36Z", "message": "Merge branch 'fix-adding-samples-response' into cart-sample-details\n\n# Conflicts:\n#\tsrc/main/java/ca/corefacility/bioinformatics/irida/ria/web/sessionAttrs/Cart.java\n#\tsrc/main/webapp/resources/js/apis/cart/cart.js"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a04dca53c96534024584088cf9fc5222ff5a7934", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/a04dca53c96534024584088cf9fc5222ff5a7934", "committedDate": "2020-12-03T18:59:16Z", "message": "Manually adding each file type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58c0dab99d7ccdd6014d0932c6f6dc30e6c6d257", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/58c0dab99d7ccdd6014d0932c6f6dc30e6c6d257", "committedDate": "2020-12-03T19:27:40Z", "message": "Layout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81eff7e7c9b1e735e191cf9325695fa8e1bb6da6", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/81eff7e7c9b1e735e191cf9325695fa8e1bb6da6", "committedDate": "2020-12-04T16:50:12Z", "message": "Merge branch 'development' into cart-sample-details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60040c115bd63f8ec060e5c1924fbf70920286f0", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/60040c115bd63f8ec060e5c1924fbf70920286f0", "committedDate": "2020-12-04T16:50:24Z", "message": "Merge branch 'fix-adding-samples-response' into cart-sample-details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34e57e85afb933a3e37e6a05ed55cbd662c3c07b", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/34e57e85afb933a3e37e6a05ed55cbd662c3c07b", "committedDate": "2020-12-04T17:41:53Z", "message": "Removed old dead code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be84f7a4fdff99ae22c4f4960227f199a0bd1aba", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/be84f7a4fdff99ae22c4f4960227f199a0bd1aba", "committedDate": "2020-12-04T19:02:33Z", "message": "Merge branch 'fix-adding-samples-response' into cart-sample-details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "850ee6372e25c6cc961866b4999e4b98bb21dd27", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/850ee6372e25c6cc961866b4999e4b98bb21dd27", "committedDate": "2020-12-04T19:36:18Z", "message": "Only show the types of files that the sample actually has."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78ece14f9df6e17e20fb44b55867b57577350ba1", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/78ece14f9df6e17e20fb44b55867b57577350ba1", "committedDate": "2020-12-07T15:05:54Z", "message": "Cleaned up ajax requests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00562c980aef586af52ab38fa80732e434c1c8f2", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/00562c980aef586af52ab38fa80732e434c1c8f2", "committedDate": "2020-12-07T15:06:10Z", "message": "Merge branch 'development' into cart-sample-details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2dc665d14429f74c7cc876544b02090a6c51e8a7", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/2dc665d14429f74c7cc876544b02090a6c51e8a7", "committedDate": "2020-12-07T15:13:45Z", "message": "Updated CHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "707a58fa468ef4df2dca50518c113513c56a895c", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/707a58fa468ef4df2dca50518c113513c56a895c", "committedDate": "2020-12-07T18:16:13Z", "message": "Fixed JavaDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f654ce7d7f485b96fe9f49f2a5c6f7a2e3244ad", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/9f654ce7d7f485b96fe9f49f2a5c6f7a2e3244ad", "committedDate": "2020-12-07T23:17:49Z", "message": "Removed dependency on redux"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66f62d2e73c1e34a36ae6c71946a070145c2b001", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/66f62d2e73c1e34a36ae6c71946a070145c2b001", "committedDate": "2020-12-08T15:33:50Z", "message": "Fields never get modified so can be final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d55944470ac66cd826374f3011266d16af247d5a", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/d55944470ac66cd826374f3011266d16af247d5a", "committedDate": "2020-12-08T15:35:18Z", "message": "Added missing JavaDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b831e3ce9f9d6148f748329d9bbab8bf3461e90b", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/b831e3ce9f9d6148f748329d9bbab8bf3461e90b", "committedDate": "2020-12-10T13:20:25Z", "message": "Merge branch 'development' into cart-sample-details\n\n# Conflicts:\n#\tCHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b460ee9da5dd2a349d9c7c86a86a548ef60ee5ac", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/b460ee9da5dd2a349d9c7c86a86a548ef60ee5ac", "committedDate": "2020-12-10T17:30:47Z", "message": "Updated JavaDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d8aa57bb814be90cdcbf707338f373ac6a7a44d", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/3d8aa57bb814be90cdcbf707338f373ac6a7a44d", "committedDate": "2020-12-10T17:59:14Z", "message": "Fixed missing imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "300a258d14313dfc60402a7e5afc1a208a5e094a", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/300a258d14313dfc60402a7e5afc1a208a5e094a", "committedDate": "2020-12-10T22:16:11Z", "message": "Switching to a modal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/972ac84be46b54d0e84705fb5fcaca5a5c629eac", "committedDate": "2020-12-11T13:31:53Z", "message": "Updated to use a Modal instead of Drawer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMTg3ODQ1", "url": "https://github.com/phac-nml/irida/pull/884#pullrequestreview-550187845", "createdAt": "2020-12-11T15:16:27Z", "commit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNToxNjoyN1rOID9MoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNTo1MzoxM1rOID-0jA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAxOTI5Nw==", "bodyText": "Update this change", "url": "https://github.com/phac-nml/irida/pull/884#discussion_r541019297", "createdAt": "2020-12-11T15:16:27Z", "author": {"login": "deepsidhu85"}, "path": "CHANGELOG.md", "diffHunk": "@@ -26,6 +26,7 @@ Changes\n * [UI]: Added functionality for users to synchronize fast5 data from remote APIs.\n * [UI]: Added usage statistics to admin panel.\n * [UI]: Updated analysis results page to show loading indicator when retrieving output file data.\n+* [UI]: Updated sample details sidebar with sample files and simpler API for use on more pages.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAyNzgyNA==", "bodyText": "Fast5 data also has qc files associated with it. So I think there should be a section here which sets the enhanceQCEntries for it", "url": "https://github.com/phac-nml/irida/pull/884#discussion_r541027824", "createdAt": "2020-12-11T15:28:14Z", "author": {"login": "deepsidhu85"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UISampleService.java", "diffHunk": "@@ -0,0 +1,138 @@\n+package ca.corefacility.bioinformatics.irida.ria.web.services;\n+\n+import java.util.*;\n+import java.util.stream.Collectors;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.security.core.context.SecurityContextHolder;\n+import org.springframework.stereotype.Component;\n+\n+import ca.corefacility.bioinformatics.irida.model.assembly.GenomeAssembly;\n+import ca.corefacility.bioinformatics.irida.model.joins.impl.SampleGenomeAssemblyJoin;\n+import ca.corefacility.bioinformatics.irida.model.project.Project;\n+import ca.corefacility.bioinformatics.irida.model.sample.QCEntry;\n+import ca.corefacility.bioinformatics.irida.model.sample.Sample;\n+import ca.corefacility.bioinformatics.irida.model.sample.SampleSequencingObjectJoin;\n+import ca.corefacility.bioinformatics.irida.model.sequenceFile.Fast5Object;\n+import ca.corefacility.bioinformatics.irida.model.sequenceFile.SequenceFilePair;\n+import ca.corefacility.bioinformatics.irida.model.sequenceFile.SequencingObject;\n+import ca.corefacility.bioinformatics.irida.model.sequenceFile.SingleEndSequenceFile;\n+import ca.corefacility.bioinformatics.irida.ria.web.samples.dto.SampleDetails;\n+import ca.corefacility.bioinformatics.irida.ria.web.samples.dto.SampleFiles;\n+import ca.corefacility.bioinformatics.irida.security.permissions.sample.UpdateSamplePermission;\n+import ca.corefacility.bioinformatics.irida.service.GenomeAssemblyService;\n+import ca.corefacility.bioinformatics.irida.service.ProjectService;\n+import ca.corefacility.bioinformatics.irida.service.SequencingObjectService;\n+import ca.corefacility.bioinformatics.irida.service.sample.SampleService;\n+\n+/**\n+ * UI Service for samples\n+ */\n+@Component\n+public class UISampleService {\n+\tprivate final SampleService sampleService;\n+\tprivate final ProjectService projectService;\n+\tprivate final UpdateSamplePermission updateSamplePermission;\n+\tprivate final SequencingObjectService sequencingObjectService;\n+\tprivate final GenomeAssemblyService genomeAssemblyService;\n+\tprivate final UICartService cartService;\n+\n+\t@Autowired\n+\tpublic UISampleService(SampleService sampleService, ProjectService projectService, UpdateSamplePermission updateSamplePermission,\n+\t\t\tSequencingObjectService sequencingObjectService, GenomeAssemblyService genomeAssemblyService, UICartService cartService) {\n+\t\tthis.sampleService = sampleService;\n+\t\tthis.projectService = projectService;\n+\t\tthis.updateSamplePermission = updateSamplePermission;\n+\t\tthis.sequencingObjectService = sequencingObjectService;\n+\t\tthis.genomeAssemblyService = genomeAssemblyService;\n+\t\tthis.cartService = cartService;\n+\t}\n+\n+\t/**\n+\t * Get full details, including metadata for a {@link Sample}\n+\t *\n+\t * @param id Identifier for a {@link Sample}\n+\t * @return {@link SampleDetails}\n+\t */\n+\tpublic SampleDetails getSampleDetails(Long id) {\n+\t\tSample sample = sampleService.read(id);\n+\t\tAuthentication authentication = SecurityContextHolder.getContext()\n+\t\t\t\t.getAuthentication();\n+\t\tboolean isModifiable = updateSamplePermission.isAllowed(authentication, sample);\n+\t\treturn new SampleDetails(sample, isModifiable, cartService.isSampleInCart(id));\n+\t}\n+\n+\t/**\n+\t * Get the sequence files associated with a sample\n+\t *\n+\t * @param sampleId  Identifier for a sample\n+\t * @param projectId Identifier for the project the sample belong to\n+\t * @return All the sequencing files associated with the sample\n+\t */\n+\tpublic SampleFiles getSampleFiles(Long sampleId, Long projectId) {\n+\t\tSample sample = sampleService.read(sampleId);\n+\t\t// get the project if available\n+\t\tProject project = null;\n+\t\tif (projectId != null) {\n+\t\t\tproject = projectService.read(projectId);\n+\t\t}\n+\n+\t\tCollection<SampleSequencingObjectJoin> filePairJoins = sequencingObjectService.getSequencesForSampleOfType(\n+\t\t\t\tsample, SequenceFilePair.class);\n+\t\tCollection<SampleSequencingObjectJoin> singleFileJoins = sequencingObjectService.getSequencesForSampleOfType(\n+\t\t\t\tsample, SingleEndSequenceFile.class);\n+\t\tCollection<SampleSequencingObjectJoin> fast5FileJoins = sequencingObjectService.getSequencesForSampleOfType(\n+\t\t\t\tsample, Fast5Object.class);\n+\t\tList<SequencingObject> fast5 = fast5FileJoins.stream()\n+\t\t\t\t.map(SampleSequencingObjectJoin::getObject)\n+\t\t\t\t.collect(Collectors.toList());\n+\n+\t\tCollection<SampleGenomeAssemblyJoin> genomeAssemblyJoins = genomeAssemblyService.getAssembliesForSample(sample);\n+\n+\t\tList<GenomeAssembly> genomeAssemblies = genomeAssemblyJoins.stream()\n+\t\t\t\t.map(SampleGenomeAssemblyJoin::getObject)\n+\t\t\t\t.collect(Collectors.toList());\n+\n+\t\t// add project to qc entries and filter any unavailable entries\n+\t\tList<SequencingObject> filePairs = new ArrayList<>();\n+\t\tfor (SampleSequencingObjectJoin join : filePairJoins) {\n+\t\t\tSequencingObject obj = join.getObject();\n+\t\t\tenhanceQcEntries(obj, project);\n+\t\t\tfilePairs.add(obj);\n+\t\t}\n+\n+\t\tList<SequencingObject> singles = new ArrayList<>();\n+\t\tfor (SampleSequencingObjectJoin join : singleFileJoins) {\n+\t\t\tSequencingObject obj = join.getObject();\n+\t\t\tenhanceQcEntries(obj, project);\n+\t\t\tsingles.add(obj);\n+\t\t}\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAyOTAyOA==", "bodyText": "Extra sample in @param text", "url": "https://github.com/phac-nml/irida/pull/884#discussion_r541029028", "createdAt": "2020-12-11T15:29:56Z", "author": {"login": "deepsidhu85"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/sessionAttrs/Cart.java", "diffHunk": "@@ -88,4 +88,13 @@ public int removeProject(Long projectId) {\n \t\treturn Sets.newHashSet(this.values());\n \t}\n \n+\t/**\n+\t * Find if a sample is currently in the cart.  If it is get the project that it belongs to.\n+\t *\n+\t * @param sampleId identifier for a sample sample to check the cart for.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAzMTYyMQ==", "bodyText": "File comments", "url": "https://github.com/phac-nml/irida/pull/884#discussion_r541031621", "createdAt": "2020-12-11T15:33:33Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/apis/samples/samples.js", "diffHunk": "@@ -1,7 +1,25 @@\n import axios from \"axios\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAzMjg5OQ==", "bodyText": "Why are we displaying a notification.error here? I think it would be better to be in the UI file where this is called. We should leave this to just make the api call and return the data or error", "url": "https://github.com/phac-nml/irida/pull/884#discussion_r541032899", "createdAt": "2020-12-11T15:35:16Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/apis/samples/samples.js", "diffHunk": "@@ -1,7 +1,25 @@\n import axios from \"axios\";\n import { setBaseUrl } from \"../../utilities/url-utilities\";\n+import { notification } from \"antd\";\n \n-const URL = setBaseUrl(`samples`);\n+const URL = setBaseUrl(`ajax/samples`);\n \n-export const getSampleDetails = id =>\n-  axios.get(`${URL}?id=${id}`).then(response => response.data);\n+export const fetchSampleDetails = async (id) => {\n+  try {\n+    const { data } = await axios.get(`${URL}/${id}/details`);\n+    return data;\n+  } catch (e) {\n+    return Promise.reject(e.response.data.error);\n+  }\n+};\n+\n+export async function fetchSampleFiles({ sampleId, projectId }) {\n+  try {\n+    const response = await axios(\n+      `${URL}/${sampleId}/files${projectId ? `?projectId=${projectId}` : null}`\n+    );\n+    return response.data;\n+  } catch (e) {\n+    notification.error({ message: e.response.data.message });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAzNDI5Mw==", "bodyText": "File comments", "url": "https://github.com/phac-nml/irida/pull/884#discussion_r541034293", "createdAt": "2020-12-11T15:37:05Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/components/CalendarDate.jsx", "diffHunk": "@@ -0,0 +1,15 @@\n+import React from \"react\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTA0NDQzNQ==", "bodyText": "More of just a comment. We should probably create styles for this as we use display: flex and justifyContent: \"space-between\" in multiple other places. Something for us to do in the future", "url": "https://github.com/phac-nml/irida/pull/884#discussion_r541044435", "createdAt": "2020-12-11T15:51:04Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/components/samples/SampleDetailSidebar.jsx", "diffHunk": "@@ -0,0 +1,86 @@\n+import React from \"react\";\n+import { Button, Modal, Skeleton, Typography } from \"antd\";\n+import { fetchSampleDetails } from \"../../apis/samples/samples\";\n+import { SampleDetails } from \"./components/SampleDetails\";\n+\n+const { Text } = Typography;\n+\n+/**\n+ * React component to render details (metadata and files) for a sample.\n+ * @param sampleId - identifier for a sample\n+ * @param removeSample - function to remove the sample from the cart.\n+ * @param children\n+ * @returns {JSX.Element}\n+ * @constructor\n+ */\n+export function SampleDetailSidebar({\n+  sampleId,\n+  removeSample = Function.prototype,\n+  children,\n+}) {\n+  const [loading, setLoading] = React.useState(true);\n+  const [details, setDetails] = React.useState({});\n+  const [visible, setVisible] = React.useState(false);\n+\n+  React.useEffect(() => {\n+    if (visible) {\n+      fetchSampleDetails(sampleId)\n+        .then(setDetails)\n+        .then(() => setLoading(false));\n+    }\n+  }, [visible]);\n+\n+  const removeSampleFromCart = () => {\n+    removeSample({ projectId: details.projectId, sampleId });\n+  };\n+\n+  return (\n+    <>\n+      {React.cloneElement(children, {\n+        onClick: () => setVisible(true),\n+      })}\n+      {visible ? (\n+        <Modal\n+          bodyStyle={{\n+            padding: 0,\n+            maxHeight: window.innerHeight - 400,\n+            overflowY: \"auto\",\n+          }}\n+          title={\n+            loading ? null : (\n+              <div\n+                style={{\n+                  display: \"flex\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTA0NTkwMA==", "bodyText": "What's this empty useeffect for?", "url": "https://github.com/phac-nml/irida/pull/884#discussion_r541045900", "createdAt": "2020-12-11T15:53:13Z", "author": {"login": "deepsidhu85"}, "path": "src/main/webapp/resources/js/pages/cart/components/Cart.jsx", "diffHunk": "@@ -20,6 +19,8 @@ function CartComponent({ count = 0, loadCart }) {\n     }\n   }, [count]);\n \n+  useEffect(() => {}, []);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "972ac84be46b54d0e84705fb5fcaca5a5c629eac"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "734428dd3df5a132d87d42e4b199091a52b989e1", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/734428dd3df5a132d87d42e4b199091a52b989e1", "committedDate": "2020-12-11T18:54:58Z", "message": "Cleaned up how files are displayed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f06a334425e8c4a2dc70f9216e8193d45173cd2", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/1f06a334425e8c4a2dc70f9216e8193d45173cd2", "committedDate": "2020-12-14T14:56:22Z", "message": "Cleaned up internationalization and file names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f46cfbc8f4a483568031136dec220c4c60298fb3", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/f46cfbc8f4a483568031136dec220c4c60298fb3", "committedDate": "2020-12-14T19:13:51Z", "message": "Updated CHANGELOG"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25828a13e932bd65ed5dc10eaede867a2af9e306", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/25828a13e932bd65ed5dc10eaede867a2af9e306", "committedDate": "2020-12-14T19:15:45Z", "message": "Fixed JavaDoc with too many samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "874db0bac778d4cde15a8cdc94c1af7bed39019c", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/874db0bac778d4cde15a8cdc94c1af7bed39019c", "committedDate": "2020-12-14T19:17:48Z", "message": "Update file JSDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94bab472469c60e4cd4d889d7d5bc69a1cb7b1af", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/94bab472469c60e4cd4d889d7d5bc69a1cb7b1af", "committedDate": "2020-12-14T19:20:23Z", "message": "Moved notification message into the file sample files component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "238a09c7f58f1b4e0f602a758c1d05890476d133", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/238a09c7f58f1b4e0f602a758c1d05890476d133", "committedDate": "2020-12-14T19:22:15Z", "message": "Add JSDoc to CalendarDate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51e9c13b8125d5fd0b22d9e4128210b2cbaccc3d", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/51e9c13b8125d5fd0b22d9e4128210b2cbaccc3d", "committedDate": "2020-12-14T19:23:52Z", "message": "Removed empty useEffect hook"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxODk4Mjgw", "url": "https://github.com/phac-nml/irida/pull/884#pullrequestreview-551898280", "createdAt": "2020-12-14T21:14:36Z", "commit": {"oid": "51e9c13b8125d5fd0b22d9e4128210b2cbaccc3d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c76e26d3e472c5740cc86767bae7f95f2244d3d", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/7c76e26d3e472c5740cc86767bae7f95f2244d3d", "committedDate": "2020-12-15T04:19:57Z", "message": "Added initial test checking for sample name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "661df15bcb59366bb4b811ead8b819cac335e42b", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/661df15bcb59366bb4b811ead8b819cac335e42b", "committedDate": "2020-12-15T11:07:12Z", "message": "Test to make sure that the created date is set up properly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cef2b9b93ce2909efd1dbf4881ff281eee75415", "author": {"user": {"login": "joshsadam", "name": "Josh Adam"}}, "url": "https://github.com/phac-nml/irida/commit/5cef2b9b93ce2909efd1dbf4881ff281eee75415", "committedDate": "2020-12-15T11:39:08Z", "message": "Added tests for metadata fields"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4989, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}