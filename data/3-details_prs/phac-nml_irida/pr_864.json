{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0MDUxMzE5", "number": 864, "title": "Add fast5 sync", "bodyText": "Description of changes\nWhat did you change in this pull request?  Provide a description of files changed, user interactions changed, etc.  Include how to test your changes.\nAdded fast5 data to project synchronization.\nTo test this PR:\n\nUpload some fast5 data to a sample in a project\nSynchronize it using the project  synchronization features.\nEnsure the fast5 data gets sync'd from the remote installation.\n\nRelated issue\nLink to the GitHub issue this pull request addresses using the #issuenum format.  If it completes an issue, use Fixes #issuenum to automatically close the issue.\nFixes #716\nChecklist\nThings for the developer to confirm they've done before the PR should be accepted:\n\n CHANGELOG.md (and UPGRADING.md if necessary) updated with information for new change.\n Tests added (or description of how to test) for any new features.\n User documentation updated for UI or technical changes.", "createdAt": "2020-11-19T15:51:43Z", "url": "https://github.com/phac-nml/irida/pull/864", "merged": true, "mergeCommit": {"oid": "1be80c552349fc31d028d7ebf8e3ba9158d9ec77"}, "closed": true, "closedAt": "2020-12-02T22:09:40Z", "author": {"login": "deepsidhu85"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddMAgPgH2gAyNTI0MDUxMzE5OmYzNTMyYTIzN2ZjNzRiODhlNmJhY2U2ZDhhZDlmNDFjYTJjYTVkYTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiWAqrAFqTU0MzI3OTA4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f3532a237fc74b88e6bace6d8ad9f41ca2ca5da9", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/f3532a237fc74b88e6bace6d8ad9f41ca2ca5da9", "committedDate": "2020-11-16T21:40:27Z", "message": "Updated project synchronization to also sync fast5 data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22b20d844d724c2b1388408bf0bd2024942404ef", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/22b20d844d724c2b1388408bf0bd2024942404ef", "committedDate": "2020-11-19T15:46:32Z", "message": "Merge branch 'development' into add-fast5-sync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "730286a0bf25c3687e3ea1545fbef60cea979659", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/730286a0bf25c3687e3ea1545fbef60cea979659", "committedDate": "2020-11-20T05:07:04Z", "message": "Updated fast5object to set sequencefile"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2dcbeb2527ba6561de903ceff591c9de051a3e1", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/b2dcbeb2527ba6561de903ceff591c9de051a3e1", "committedDate": "2020-11-20T05:08:45Z", "message": "Updated CHANGELOG"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "033ad3e6a4a4e6dc14e7ac44ab54ee8376630de1", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/033ad3e6a4a4e6dc14e7ac44ab54ee8376630de1", "committedDate": "2020-11-23T16:12:47Z", "message": "Updated test for syncing fast5 data to project"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3cac4ca41221bd373a5dcbbc8a3603dc7420db9", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/e3cac4ca41221bd373a5dcbbc8a3603dc7420db9", "committedDate": "2020-11-23T16:13:45Z", "message": "Changed url for fast5object remotestatus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3e6ade8bf2eacf6d38b7a01c6ceffdcb9f7827c", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/c3e6ade8bf2eacf6d38b7a01c6ceffdcb9f7827c", "committedDate": "2020-11-23T16:18:47Z", "message": "Updated docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "454abbdea5fcc4a42a048c5a4999dbdb08e0df49", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/454abbdea5fcc4a42a048c5a4999dbdb08e0df49", "committedDate": "2020-11-23T16:32:44Z", "message": "Merge branch 'development' into add-fast5-sync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc9696bb8d262371fcfbbf428efc6ac66971dd09", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/cc9696bb8d262371fcfbbf428efc6ac66971dd09", "committedDate": "2020-11-30T20:49:48Z", "message": "Merged dev and fixed merge conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMzAxNDky", "url": "https://github.com/phac-nml/irida/pull/864#pullrequestreview-542301492", "createdAt": "2020-12-01T21:14:59Z", "commit": {"oid": "cc9696bb8d262371fcfbbf428efc6ac66971dd09"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMToxNTowMFrOH9AB9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMToyMToyMlrOH9APNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcyNTY4NQ==", "bodyText": "Remove the fast5 section below in the will not section.", "url": "https://github.com/phac-nml/irida/pull/864#discussion_r533725685", "createdAt": "2020-12-01T21:15:00Z", "author": {"login": "tom114"}, "path": "doc/user/user/project/index.md", "diffHunk": "@@ -310,6 +310,7 @@ The following data will be synchronized:\n * Basic project metadata\n * FASTQ sequencing data associated with samples\n * Assemblies associated with samples (including both assemblies created by pipelines within IRIDA, and uploaded assemblies)\n+* FAST5 sequencing data associated with samples", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc9696bb8d262371fcfbbf428efc6ac66971dd09"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcyNzM4Ng==", "bodyText": "Note the try/catch around this block in the assemblies section below.  It should be added in case the host system doesn't support fast5 data.", "url": "https://github.com/phac-nml/irida/pull/864#discussion_r533727386", "createdAt": "2020-12-01T21:18:11Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/service/remote/ProjectSynchronizationService.java", "diffHunk": "@@ -374,6 +377,24 @@ private void syncProject(Project project) {\n \t\t\t}\n \t\t}\n \n+\t\t//list the fast5 files from the remote api\n+\t\tList<Fast5Object> fast5FilesForSample = fast5ObjectRemoteService.getFast5FilesForSample(sample);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc9696bb8d262371fcfbbf428efc6ac66971dd09"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcyOTA3Nw==", "bodyText": "This whole section is exactly the same for single end and fast5 files, and nearly the same for pairs.  Want to encapsulate it into a private method that can be called here and in those other file types?", "url": "https://github.com/phac-nml/irida/pull/864#discussion_r533729077", "createdAt": "2020-12-01T21:21:22Z", "author": {"login": "tom114"}, "path": "src/main/java/ca/corefacility/bioinformatics/irida/service/remote/ProjectSynchronizationService.java", "diffHunk": "@@ -465,6 +488,39 @@ public void syncSingleEndSequenceFile(SingleEndSequenceFile file, Sample sample)\n \t\t}\n \t}\n \n+\t/**\n+\t * Synchronize a given {@link Fast5Object} to the local\n+\t * installation\n+\t *\n+\t * @param fast5Object\n+\t *            the {@link Fast5Object} to sync\n+\t * @param sample\n+\t *            the {@link Sample} to add the file to\n+\t */\n+\tpublic void syncFast5File(Fast5Object fast5Object, Sample sample) {\n+\t\tRemoteStatus fileStatus = fast5Object.getRemoteStatus();\n+\t\tfileStatus.setSyncStatus(SyncStatus.UPDATING);\n+\t\ttry {\n+\t\t\tfast5Object = fast5ObjectRemoteService.mirrorSequencingObject(fast5Object);\n+\n+\t\t\tfast5Object.setProcessingState(SequencingObject.ProcessingState.UNPROCESSED);\n+\t\t\tfast5Object.setFileProcessor(null);\n+\n+\t\t\tfast5Object.getFile().setId(null);\n+\t\t\tfast5Object.getRemoteStatus().setSyncStatus(SyncStatus.SYNCHRONIZED);\n+\n+\t\t\tobjectService.createSequencingObjectInSample(fast5Object, sample);\n+\n+\t\t\tfileStatus.setSyncStatus(SyncStatus.SYNCHRONIZED);\n+\n+\t\t\tobjectService.updateRemoteStatus(fast5Object.getId(), fileStatus);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc9696bb8d262371fcfbbf428efc6ac66971dd09"}, "originalPosition": 96}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccf8d68de322f55c99d3283986c593dd49df391e", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/ccf8d68de322f55c99d3283986c593dd49df391e", "committedDate": "2020-12-02T15:48:54Z", "message": "Added try/catch when attempting to get fast5 file data from remote installation. Updated docs. Added a private method to to sync the sequencing object to a local installation which is used by sequencefilepair, singleendsequencfile, and fast5object"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "955479ae87aa5da6fa4764b3c016b5a764305959", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/955479ae87aa5da6fa4764b3c016b5a764305959", "committedDate": "2020-12-02T16:34:48Z", "message": "Updated user docs. Updated sequencefilepair, singleendsequencefiles, and fast5object to pass the remote status to the syncSequencingObject as we already retrieved it."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1d02ccb5025a86602212c8b2d784e05d39482f5", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/f1d02ccb5025a86602212c8b2d784e05d39482f5", "committedDate": "2020-12-02T17:08:24Z", "message": "Merged dev and fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfb636885a7b2cb68594ba2b685924359891c5de", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/bfb636885a7b2cb68594ba2b685924359891c5de", "committedDate": "2020-12-02T19:09:12Z", "message": "Merge branch 'development' into add-fast5-sync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6497259f108893d0f5a31be63670b4fe8ec1c503", "author": {"user": {"login": "deepsidhu85", "name": null}}, "url": "https://github.com/phac-nml/irida/commit/6497259f108893d0f5a31be63670b4fe8ec1c503", "committedDate": "2020-12-02T19:40:34Z", "message": "Updated logging statement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjc5MDg0", "url": "https://github.com/phac-nml/irida/pull/864#pullrequestreview-543279084", "createdAt": "2020-12-02T22:09:18Z", "commit": {"oid": "6497259f108893d0f5a31be63670b4fe8ec1c503"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4964, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}