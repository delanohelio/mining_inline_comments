{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NTQ2NjEw", "number": 3284, "title": "KOGITO-1687: DMN invalid data type names are not reported", "bodyText": "Please refer to: https://issues.redhat.com/browse/KOGITO-1687\nIssue description: Data type name validation is not present in Kogito\nProposed solution: Data type name validation is present in Business Central, in particular in the class FeelParser.\nHowever, as for now, we cannot use back-end services in dmn client, so for the short/middle term, the solution is to have a tiny&simple validation mechanism for variable names, that would cover as more cases as possible.", "createdAt": "2020-04-24T13:19:24Z", "url": "https://github.com/kiegroup/kie-wb-common/pull/3284", "merged": true, "mergeCommit": {"oid": "8260dac006ec9d5cf63de25f7d37cdcc09951991"}, "closed": true, "closedAt": "2020-04-30T11:14:48Z", "author": {"login": "vpellegrino"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcancS5gH2gAyNDA4NTQ2NjEwOjFlNzJlZDM4ZmU4NzgxNWY2MTM3MzA1OTg1OGVhYWNlMDYwNmU4NGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccCzEQgFqTQwMTc3MTM0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1e72ed38fe87815f61373059858eaace0606e84c", "author": {"user": {"login": "vpellegrino", "name": "Valentino Pellegrino"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/1e72ed38fe87815f61373059858eaace0606e84c", "committedDate": "2020-04-24T01:45:19Z", "message": "Adding draft of FEELSyntaxLightValidator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83ef53fa76dd3b67eee91bea8bd33c0fdc233aca", "author": {"user": {"login": "vpellegrino", "name": "Valentino Pellegrino"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/83ef53fa76dd3b67eee91bea8bd33c0fdc233aca", "committedDate": "2020-04-24T13:04:36Z", "message": "Considering other separators for keyword check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMDYzMzc3", "url": "https://github.com/kiegroup/kie-wb-common/pull/3284#pullrequestreview-400063377", "createdAt": "2020-04-24T15:45:22Z", "commit": {"oid": "83ef53fa76dd3b67eee91bea8bd33c0fdc233aca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNTE5NjAx", "url": "https://github.com/kiegroup/kie-wb-common/pull/3284#pullrequestreview-401519601", "createdAt": "2020-04-28T06:02:00Z", "commit": {"oid": "83ef53fa76dd3b67eee91bea8bd33c0fdc233aca"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwNjowMjowMFrOGND8QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwNjowNTo0NFrOGNEBsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM0OTI0OQ==", "bodyText": "There is one more keyword I am aware of - 'in'. Could we please add it to this list?", "url": "https://github.com/kiegroup/kie-wb-common/pull/3284#discussion_r416349249", "createdAt": "2020-04-28T06:02:00Z", "author": {"login": "jomarko"}, "path": "kie-wb-common-dmn/kie-wb-common-dmn-webapp-kogito-common/src/main/java/org/kie/workbench/common/dmn/webapp/kogito/common/client/services/FEELSyntaxLightValidator.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.webapp.kogito.common.client.services;\n+\n+import java.util.Arrays;\n+import java.util.function.Function;\n+import java.util.stream.Stream;\n+\n+import static java.util.stream.Stream.of;\n+\n+/**\n+ * <p>It provides a light validation for variable names, respect to the FEEL syntax</p>\n+ * <p>We already have a validation mechanism on back-end side, provided by <strong>FeelParser</strong></p>\n+ * <p>However, as for now, we cannot use back-end services in dmn client, so the aim of this class is to provide a more accurate as possible validation</p>\n+ * <p>Its purpose is to be temporary for the short/middle term</p>\n+ */\n+public class FEELSyntaxLightValidator {\n+\n+    private static final Character[] FORBIDDEN_CHARS = new Character[]{\n+            '!', '@', '#', '$', '$', '%', '&', '^', '(', ')', '\\\"', '\u00b0', '\u00a7', '\u2190', '\u2192', '\u2193', '\u00a2', '\u00b5',\n+            '{', '}', '[', ']', '|', '\\\\', '=', '<', '>', ';', ':', ',', '\u00b6', '\u00ab', '\u00bb', '\u201d', '\u201c'\n+    };\n+\n+    private static final Character[] ALLOWED_SEPARATORS = {'-', '.', '/', '\\'', '*', '+'};\n+\n+    private static final Character[] FORBIDDEN_CHARS_AS_INITIAL = Stream.concat(\n+            of(FORBIDDEN_CHARS),\n+            of(ALLOWED_SEPARATORS)\n+    ).toArray(Character[]::new);\n+\n+    private static final String[] RESERVED_KEYWORDS = new String[]{\n+            \"for\", \"return\", \"if\", \"then\", \"else\", \"some\", \"every\", \"satisfies\", \"instance\", \"of\",\n+            \"function\", \"external\", \"or\", \"and\", \"between\", \"not\", \"null\", \"true\", \"false\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83ef53fa76dd3b67eee91bea8bd33c0fdc233aca"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM1MDY0Mw==", "bodyText": "One more tricky point. Business central reports built type names as not allowed for custom types, however they are allowed as graph node names. Is that out of scope of this jira?", "url": "https://github.com/kiegroup/kie-wb-common/pull/3284#discussion_r416350643", "createdAt": "2020-04-28T06:05:44Z", "author": {"login": "jomarko"}, "path": "kie-wb-common-dmn/kie-wb-common-dmn-webapp-kogito-common/src/main/java/org/kie/workbench/common/dmn/webapp/kogito/common/client/services/FEELSyntaxLightValidator.java", "diffHunk": "@@ -0,0 +1,96 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.dmn.webapp.kogito.common.client.services;\n+\n+import java.util.Arrays;\n+import java.util.function.Function;\n+import java.util.stream.Stream;\n+\n+import static java.util.stream.Stream.of;\n+\n+/**\n+ * <p>It provides a light validation for variable names, respect to the FEEL syntax</p>\n+ * <p>We already have a validation mechanism on back-end side, provided by <strong>FeelParser</strong></p>\n+ * <p>However, as for now, we cannot use back-end services in dmn client, so the aim of this class is to provide a more accurate as possible validation</p>\n+ * <p>Its purpose is to be temporary for the short/middle term</p>\n+ */\n+public class FEELSyntaxLightValidator {\n+\n+    private static final Character[] FORBIDDEN_CHARS = new Character[]{\n+            '!', '@', '#', '$', '$', '%', '&', '^', '(', ')', '\\\"', '\u00b0', '\u00a7', '\u2190', '\u2192', '\u2193', '\u00a2', '\u00b5',\n+            '{', '}', '[', ']', '|', '\\\\', '=', '<', '>', ';', ':', ',', '\u00b6', '\u00ab', '\u00bb', '\u201d', '\u201c'\n+    };\n+\n+    private static final Character[] ALLOWED_SEPARATORS = {'-', '.', '/', '\\'', '*', '+'};\n+\n+    private static final Character[] FORBIDDEN_CHARS_AS_INITIAL = Stream.concat(\n+            of(FORBIDDEN_CHARS),\n+            of(ALLOWED_SEPARATORS)\n+    ).toArray(Character[]::new);\n+\n+    private static final String[] RESERVED_KEYWORDS = new String[]{\n+            \"for\", \"return\", \"if\", \"then\", \"else\", \"some\", \"every\", \"satisfies\", \"instance\", \"of\",\n+            \"function\", \"external\", \"or\", \"and\", \"between\", \"not\", \"null\", \"true\", \"false\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM0OTI0OQ=="}, "originalCommit": {"oid": "83ef53fa76dd3b67eee91bea8bd33c0fdc233aca"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13d3fbad1ed30533e0603ff34ad0e249aa1c1bdd", "author": {"user": {"login": "vpellegrino", "name": "Valentino Pellegrino"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/13d3fbad1ed30533e0603ff34ad0e249aa1c1bdd", "committedDate": "2020-04-28T07:13:57Z", "message": "Adding \"in\" as reserved keyword"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNTY1NjQw", "url": "https://github.com/kiegroup/kie-wb-common/pull/3284#pullrequestreview-401565640", "createdAt": "2020-04-28T07:27:34Z", "commit": {"oid": "13d3fbad1ed30533e0603ff34ad0e249aa1c1bdd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzcxMzQw", "url": "https://github.com/kiegroup/kie-wb-common/pull/3284#pullrequestreview-401771340", "createdAt": "2020-04-28T12:11:33Z", "commit": {"oid": "13d3fbad1ed30533e0603ff34ad0e249aa1c1bdd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 615, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}