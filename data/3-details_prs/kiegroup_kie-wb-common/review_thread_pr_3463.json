{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4MDAyOTcz", "number": 3463, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMTozODoxN1rOEwuXtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMTozODoxN1rOEwuXtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTI2ODM5OnYy", "diffSide": "RIGHT", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/marshaller/marshall/DMNMarshaller.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMTozODoxN1rOHmdd-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjozNzoyOFrOHmflxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA5MDc0Ng==", "bodyText": "Could we add here second argument and combine the lists like:\nprivate <T extends JSITDMNElement> List<T> distinct(final List<T> list, final List<T> secondList) {\n    List<T> toBeProcessed = new ArrayList(list);\n    toBeProcessed.addAll(secondList);\n    // the rest is the same, just process the combined list\n    final Map<String, T> map = new HashMap<>();\n    forEach(toBeProcessed, item -> {\n        map.putIfAbsent(item.getId(), Js.uncheckedCast(item));\n    });\n    return new ArrayList<>(map.values());\n}\n\nThe usage then wouldn't need to first to invoke addAllAuthorityRequirement and then retrospectively filtering and setting using setAuthorityRequirement.\nResulting in a single call for each requirement type\nexistingKnowledgeSource.setAuthorityRequirement(\n    distinct(\n        existingKnowledgeSource.getAuthorityRequirement(),\n        nodeKnowledgeSource.getAuthorityRequirement()\n    )\n);\n\nwhich is IMO nicer than\nexistingKnowledgeSource.addAllAuthorityRequirement(nodeKnowledgeSource.getAuthorityRequirement().toArray(new JSITAuthorityRequirement[0]));\nexistingKnowledgeSource.setAuthorityRequirement(distinct(existingKnowledgeSource.getAuthorityRequirement()));", "url": "https://github.com/kiegroup/kie-wb-common/pull/3463#discussion_r510090746", "createdAt": "2020-10-22T11:38:17Z", "author": {"login": "jstastny-cz"}, "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/marshaller/marshall/DMNMarshaller.java", "diffHunk": "@@ -355,33 +365,41 @@ private void mergeNodeRequirements(final JSITDRGElement node,\n             final JSITBusinessKnowledgeModel existingBkm = Js.uncheckedCast(existingDRGElement);\n             final JSITBusinessKnowledgeModel nodeBkm = Js.uncheckedCast(node);\n \n-            final List<JSITAuthorityRequirement> authorityRequirement = nodeBkm.getAuthorityRequirement();\n-            final List<JSITKnowledgeRequirement> knowledgeRequirement = nodeBkm.getKnowledgeRequirement();\n+            existingBkm.addAllAuthorityRequirement(nodeBkm.getAuthorityRequirement().toArray(new JSITAuthorityRequirement[0]));\n+            existingBkm.addAllKnowledgeRequirement(nodeBkm.getKnowledgeRequirement().toArray(new JSITKnowledgeRequirement[0]));\n \n-            existingBkm.addAllAuthorityRequirement(authorityRequirement.toArray(new JSITAuthorityRequirement[0]));\n-            existingBkm.addAllKnowledgeRequirement(knowledgeRequirement.toArray(new JSITKnowledgeRequirement[0]));\n+            existingBkm.setAuthorityRequirement(distinct(existingBkm.getAuthorityRequirement()));\n+            existingBkm.setKnowledgeRequirement(distinct(existingBkm.getKnowledgeRequirement()));\n         } else if (instanceOfDecision(node)) {\n \n             final JSITDecision existingDecision = Js.uncheckedCast(existingDRGElement);\n             final JSITDecision nodeDecision = Js.uncheckedCast(node);\n \n-            final List<JSITAuthorityRequirement> authorityRequirement = nodeDecision.getAuthorityRequirement();\n-            final List<JSITInformationRequirement> informationRequirement = nodeDecision.getInformationRequirement();\n-            final List<JSITKnowledgeRequirement> knowledgeRequirement = nodeDecision.getKnowledgeRequirement();\n+            existingDecision.addAllAuthorityRequirement(nodeDecision.getAuthorityRequirement().toArray(new JSITAuthorityRequirement[0]));\n+            existingDecision.addAllInformationRequirement(nodeDecision.getInformationRequirement().toArray(new JSITInformationRequirement[0]));\n+            existingDecision.addAllKnowledgeRequirement(nodeDecision.getKnowledgeRequirement().toArray(new JSITKnowledgeRequirement[0]));\n \n-            existingDecision.addAllAuthorityRequirement(authorityRequirement.toArray(new JSITAuthorityRequirement[0]));\n-            existingDecision.addAllInformationRequirement(informationRequirement.toArray(new JSITInformationRequirement[0]));\n-            existingDecision.addAllKnowledgeRequirement(knowledgeRequirement.toArray(new JSITKnowledgeRequirement[0]));\n+            existingDecision.setAuthorityRequirement(distinct(existingDecision.getAuthorityRequirement()));\n+            existingDecision.setInformationRequirement(distinct(existingDecision.getInformationRequirement()));\n+            existingDecision.setKnowledgeRequirement(distinct(existingDecision.getKnowledgeRequirement()));\n         } else if (instanceOfKnowledgeSource(node)) {\n \n             final JSITKnowledgeSource existingKnowledgeSource = Js.uncheckedCast(existingDRGElement);\n             final JSITKnowledgeSource nodeKnowledgeSource = Js.uncheckedCast(node);\n \n-            final List<JSITAuthorityRequirement> authorityRequirement = nodeKnowledgeSource.getAuthorityRequirement();\n-            existingKnowledgeSource.addAllAuthorityRequirement(authorityRequirement.toArray(new JSITAuthorityRequirement[0]));\n+            existingKnowledgeSource.addAllAuthorityRequirement(nodeKnowledgeSource.getAuthorityRequirement().toArray(new JSITAuthorityRequirement[0]));\n+            existingKnowledgeSource.setAuthorityRequirement(distinct(existingKnowledgeSource.getAuthorityRequirement()));\n         }\n     }\n \n+    private <T extends JSITDMNElement> List<T> distinct(final List<T> list) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6aa65c532f7f69a571afbde047faa33cf80daeba"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEyNTUxMQ==", "bodyText": "Nice enhancement. Thanks, @jstastny-cz!", "url": "https://github.com/kiegroup/kie-wb-common/pull/3463#discussion_r510125511", "createdAt": "2020-10-22T12:37:28Z", "author": {"login": "karreiro"}, "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/marshaller/marshall/DMNMarshaller.java", "diffHunk": "@@ -355,33 +365,41 @@ private void mergeNodeRequirements(final JSITDRGElement node,\n             final JSITBusinessKnowledgeModel existingBkm = Js.uncheckedCast(existingDRGElement);\n             final JSITBusinessKnowledgeModel nodeBkm = Js.uncheckedCast(node);\n \n-            final List<JSITAuthorityRequirement> authorityRequirement = nodeBkm.getAuthorityRequirement();\n-            final List<JSITKnowledgeRequirement> knowledgeRequirement = nodeBkm.getKnowledgeRequirement();\n+            existingBkm.addAllAuthorityRequirement(nodeBkm.getAuthorityRequirement().toArray(new JSITAuthorityRequirement[0]));\n+            existingBkm.addAllKnowledgeRequirement(nodeBkm.getKnowledgeRequirement().toArray(new JSITKnowledgeRequirement[0]));\n \n-            existingBkm.addAllAuthorityRequirement(authorityRequirement.toArray(new JSITAuthorityRequirement[0]));\n-            existingBkm.addAllKnowledgeRequirement(knowledgeRequirement.toArray(new JSITKnowledgeRequirement[0]));\n+            existingBkm.setAuthorityRequirement(distinct(existingBkm.getAuthorityRequirement()));\n+            existingBkm.setKnowledgeRequirement(distinct(existingBkm.getKnowledgeRequirement()));\n         } else if (instanceOfDecision(node)) {\n \n             final JSITDecision existingDecision = Js.uncheckedCast(existingDRGElement);\n             final JSITDecision nodeDecision = Js.uncheckedCast(node);\n \n-            final List<JSITAuthorityRequirement> authorityRequirement = nodeDecision.getAuthorityRequirement();\n-            final List<JSITInformationRequirement> informationRequirement = nodeDecision.getInformationRequirement();\n-            final List<JSITKnowledgeRequirement> knowledgeRequirement = nodeDecision.getKnowledgeRequirement();\n+            existingDecision.addAllAuthorityRequirement(nodeDecision.getAuthorityRequirement().toArray(new JSITAuthorityRequirement[0]));\n+            existingDecision.addAllInformationRequirement(nodeDecision.getInformationRequirement().toArray(new JSITInformationRequirement[0]));\n+            existingDecision.addAllKnowledgeRequirement(nodeDecision.getKnowledgeRequirement().toArray(new JSITKnowledgeRequirement[0]));\n \n-            existingDecision.addAllAuthorityRequirement(authorityRequirement.toArray(new JSITAuthorityRequirement[0]));\n-            existingDecision.addAllInformationRequirement(informationRequirement.toArray(new JSITInformationRequirement[0]));\n-            existingDecision.addAllKnowledgeRequirement(knowledgeRequirement.toArray(new JSITKnowledgeRequirement[0]));\n+            existingDecision.setAuthorityRequirement(distinct(existingDecision.getAuthorityRequirement()));\n+            existingDecision.setInformationRequirement(distinct(existingDecision.getInformationRequirement()));\n+            existingDecision.setKnowledgeRequirement(distinct(existingDecision.getKnowledgeRequirement()));\n         } else if (instanceOfKnowledgeSource(node)) {\n \n             final JSITKnowledgeSource existingKnowledgeSource = Js.uncheckedCast(existingDRGElement);\n             final JSITKnowledgeSource nodeKnowledgeSource = Js.uncheckedCast(node);\n \n-            final List<JSITAuthorityRequirement> authorityRequirement = nodeKnowledgeSource.getAuthorityRequirement();\n-            existingKnowledgeSource.addAllAuthorityRequirement(authorityRequirement.toArray(new JSITAuthorityRequirement[0]));\n+            existingKnowledgeSource.addAllAuthorityRequirement(nodeKnowledgeSource.getAuthorityRequirement().toArray(new JSITAuthorityRequirement[0]));\n+            existingKnowledgeSource.setAuthorityRequirement(distinct(existingKnowledgeSource.getAuthorityRequirement()));\n         }\n     }\n \n+    private <T extends JSITDMNElement> List<T> distinct(final List<T> list) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA5MDc0Ng=="}, "originalCommit": {"oid": "6aa65c532f7f69a571afbde047faa33cf80daeba"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1261, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}