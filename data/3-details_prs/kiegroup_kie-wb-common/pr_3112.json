{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyODY3MjU2", "number": 3112, "title": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error", "bodyText": "@romartin, @inodeman Could you please review this PR?", "createdAt": "2020-01-14T22:23:21Z", "url": "https://github.com/kiegroup/kie-wb-common/pull/3112", "merged": true, "mergeCommit": {"oid": "8df950c7f409fc1fc12ec6d3a5c47f5378758500"}, "closed": true, "closedAt": "2020-01-29T21:32:14Z", "author": {"login": "handreyrc"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb616PPgFqTM0Mzc0MTcyMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-6NNEgFqTM0OTc4MzcxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNzQxNzIx", "url": "https://github.com/kiegroup/kie-wb-common/pull/3112#pullrequestreview-343741721", "createdAt": "2020-01-16T08:31:08Z", "commit": {"oid": "25d202e1183a088fe55b6cd655c158d2f861fcff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "25d202e1183a088fe55b6cd655c158d2f861fcff", "author": {"user": {"login": "handreyrc", "name": "Handreyrc"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/25d202e1183a088fe55b6cd655c158d2f861fcff", "committedDate": "2020-01-14T22:19:10Z", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error"}, "afterCommit": {"oid": "1d1f8b71af761245a7d7fc95607e131482050c8d", "author": {"user": {"login": "handreyrc", "name": "Handreyrc"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/1d1f8b71af761245a7d7fc95607e131482050c8d", "committedDate": "2020-01-21T02:48:29Z", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02c7c6fb1907b0d593c57c58256351693c353e4d", "author": {"user": {"login": "handreyrc", "name": "Handreyrc"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/02c7c6fb1907b0d593c57c58256351693c353e4d", "committedDate": "2020-01-21T04:42:19Z", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error"}, "afterCommit": {"oid": "3a2c400e21a63055e84de0551d336939f6e63dde", "author": {"user": {"login": "handreyrc", "name": "Handreyrc"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/3a2c400e21a63055e84de0551d336939f6e63dde", "committedDate": "2020-01-21T05:03:13Z", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18ee9ed1036baa58fe0cd922f470a841524717eb", "author": {"user": {"login": "handreyrc", "name": "Handreyrc"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/18ee9ed1036baa58fe0cd922f470a841524717eb", "committedDate": "2020-01-21T23:02:53Z", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3a2c400e21a63055e84de0551d336939f6e63dde", "author": {"user": {"login": "handreyrc", "name": "Handreyrc"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/3a2c400e21a63055e84de0551d336939f6e63dde", "committedDate": "2020-01-21T05:03:13Z", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error"}, "afterCommit": {"oid": "18ee9ed1036baa58fe0cd922f470a841524717eb", "author": {"user": {"login": "handreyrc", "name": "Handreyrc"}}, "url": "https://github.com/kiegroup/kie-wb-common/commit/18ee9ed1036baa58fe0cd922f470a841524717eb", "committedDate": "2020-01-21T23:02:53Z", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2OTc0MTUx", "url": "https://github.com/kiegroup/kie-wb-common/pull/3112#pullrequestreview-346974151", "createdAt": "2020-01-22T23:24:29Z", "commit": {"oid": "18ee9ed1036baa58fe0cd922f470a841524717eb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQyMzoyNDoyOVrOFgugrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQyMzoyNDoyOVrOFgugrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg2MDc4MA==", "bodyText": "All code inside the forEach is exaclly the same for backend as for client side marshallers, right? If so, would be possible to move it to some util class, in the bpmn-api module, so will be available on both sides, and we'll be able to write it just once. Makes sense?", "url": "https://github.com/kiegroup/kie-wb-common/pull/3112#discussion_r369860780", "createdAt": "2020-01-22T23:24:29Z", "author": {"login": "romartin"}, "path": "kie-wb-common-stunner/kie-wb-common-stunner-sets/kie-wb-common-stunner-bpmn/kie-wb-common-stunner-bpmn-marshalling/src/main/java/org/kie/workbench/common/stunner/bpmn/client/marshall/converters/customproperties/ParsedAssignmentsInfo.java", "diffHunk": "@@ -196,15 +197,30 @@ public AssociationList getAssociations() {\n     }\n \n     public List<InitializedOutputVariable> createInitializedOutputVariables(String parentId, VariableScope variableScope) {\n-        return getOutputs()\n+        List<InitializedOutputVariable> initializedOutputVariables = new ArrayList<>();\n+\n+        getOutputs()\n                 .getDeclarations()\n-                .stream()\n-                .map(varDecl -> InitializedVariable.outputOf(\n-                        parentId,\n-                        variableScope,\n-                        varDecl,\n-                        associations.lookupOutput(varDecl.getTypedIdentifier().getName())))\n-                .collect(Collectors.toList());\n+                .forEach(varDecl -> {\n+                    if (associations.lookupOutputs(varDecl.getTypedIdentifier().getName()).isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18ee9ed1036baa58fe0cd922f470a841524717eb"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NzgzNzE3", "url": "https://github.com/kiegroup/kie-wb-common/pull/3112#pullrequestreview-349783717", "createdAt": "2020-01-28T23:47:09Z", "commit": {"oid": "18ee9ed1036baa58fe0cd922f470a841524717eb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 656, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}