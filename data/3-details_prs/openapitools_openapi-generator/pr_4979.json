{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxNzkzNzMz", "number": 4979, "title": "[core] Extracting recommendations to validation framework", "bodyText": "This is work to extract recommendation logic out of the CLI validate command into a shared evaluation instance which can be used elsewhere (such as Gradle, or the Online tool).\nFor now, these validations are in addition to those provided by swagger-parser and are only the following recommendations:\n\nApache/Nginx warning that header values with underscore are dropped by default\nUnused models/schemas\nUse of properties with oneOf, which is ambiguous in OpenAPI Specification\nGET/HEAD operations defined with body considered an anti-pattern\n\nI've allowed for disabling recommendations via System properties, since this is something that has been requested a few times by users. System properties in this commit include:\n\nopenapi.generator.rule.recommendations=false\n\nAllows for disabling recommendations completely. This wouldn't include all warnings and errors, only those we deem to be suggestions\n\n\nopenapi.generator.rule.apache-nginx-underscore=false\n\nAllows for disabling the Apache/Nginx warning when header names have underscore\nThis is a legacy CGI configuration, and doesn't affect all web servers\n\n\nopenapi.generator.rule.oneof-properties-ambiguity=false\n\nWe support this functionality, but the specification may not intend for it\nThis is more to reduce noise\n\n\nopenapi.generator.rule.unused-schemas=false\n\nWe will warn when a schema is not referenced outside of Components, which users have requested to be able to turn off\n\n\nopenapi.generator.rule.anti-patterns.uri-unexpected-body=false\n\nThis moves validations as suggested in #4412, and prepares for sharing it with other tools in our project.\nExample output:\nopenapi-generator validate -i samples/server/petstore/python-aiohttp/openapi_server/openapi/openapi.yaml --recommend\nValidating spec (/Users/jim/projects/openapi-generator/samples/server/petstore/python-aiohttp/openapi_server/openapi/openapi.yaml)\nWarnings:\n\t- Apache and Nginx webservers may fail due to legacy CGI constraints enabled by default in\n\t  which header keys with underscore are disallowed. See\n\t  https://stackoverflow.com/a/22856867/151445.\n\t- Schemas defining properties and oneOf are not clearly defined in the OpenAPI\n\t  Specification. While our tooling supports this, it may cause issues with other tools.\n\n[info] Spec has 2 recommendation(s).\n\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project before.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.\n\ncc @ybelenko @OpenAPITools/generator-core-team", "createdAt": "2020-01-12T04:40:04Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4979", "merged": true, "mergeCommit": {"oid": "22c6c0ca68aee25ca7923f7eff85079f9dc08376"}, "closed": true, "closedAt": "2020-01-31T17:19:17Z", "author": {"login": "jimschubert"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6DLLuAFqTM0MjE0ODcwMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_vhhvgBqjI5OTcxNTQzMDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMTQ4NzAz", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4979#pullrequestreview-342148703", "createdAt": "2020-01-13T21:24:28Z", "commit": {"oid": "2e3b9272264386a8d0a34df88abf08c886fc9259"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyOTE5Nzkz", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4979#pullrequestreview-342919793", "createdAt": "2020-01-15T00:08:32Z", "commit": {"oid": "2e3b9272264386a8d0a34df88abf08c886fc9259"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwMDowODozMlrOFdpykg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwMDowODozMlrOFdpykg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjYzNzcxNA==", "bodyText": "Note this API change. I think this is unused by users due to the package private APIs elsewhere in this PR. We can target 4.3 if there are concerns.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4979#discussion_r366637714", "createdAt": "2020-01-15T00:08:32Z", "author": {"login": "jimschubert"}, "path": "modules/openapi-generator-core/src/main/java/org/openapitools/codegen/validation/ValidationRule.java", "diffHunk": "@@ -60,7 +60,7 @@ public String getFailureMessage() {\n      *\n      * @return <code>true</code> if the object state is valid according to this rule, otherwise <code>false</code>.\n      */\n-    public boolean evaluate(Object input) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e3b9272264386a8d0a34df88abf08c886fc9259"}, "originalPosition": 22}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e3b9272264386a8d0a34df88abf08c886fc9259", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/2e3b9272264386a8d0a34df88abf08c886fc9259", "committedDate": "2020-01-13T02:59:59Z", "message": "Update operationId values in test"}, "afterCommit": {"oid": "557e4be723d37e73f349bf38df4166cc2a8be6d2", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/557e4be723d37e73f349bf38df4166cc2a8be6d2", "committedDate": "2020-01-18T14:15:22Z", "message": "Update operationId values in test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88856720c4cff2e2a069cca990ec14029e021b60", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/88856720c4cff2e2a069cca990ec14029e021b60", "committedDate": "2020-01-31T13:53:22Z", "message": "[core] Extracting recommendations to validation framework\n\nThis is work to extract recommendation logic out of the CLI validate command\ninto a shared evaluation instance which can be used elsewhere (such as Gradle,\nor the Online tool).\n\nFor now, these validations are in addition to those provided by swagger-parser and\nare only the following recommendations:\n\n* Apache/Nginx warning that header values with underscore are dropped by default\n* Unused models/schemas\n* Use of properties with oneOf, which is ambiguous in OpenAPI Specification\n\nI've allowed for disabling recommendations via System properties, since this is\nsomething that has been requested a few times by users. System properties in this\ncommit include:\n\n* openapi.generator.rule.recommendations=false\n  - Allows for disabling recommendations completely. This wouldn't include all warnings\n    and errors, only those we deem to be suggestions\n* openapi.generator.rule.apache-nginx-underscore=false\n  - Allows for disabling the Apache/Nginx warning when header names have underscore\n  - This is a legacy CGI configuration, and doesn't affect all web servers\n* openapi.generator.rule.oneof-properties-ambiguity=false\n  - We support this functionality, but the specification may not intend for it\n  - This is more to reduce noise\n* openapi.generator.rule.unused-schemas=false\n  - We will warn when a schema is not referenced outside of Components, which\n    users have requested to be able to turn off"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c1ef7550609f1278823143c51fda1f5ed8f796f", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/3c1ef7550609f1278823143c51fda1f5ed8f796f", "committedDate": "2020-01-31T13:53:33Z", "message": "Move to oas package and add javadoc comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "018ace788a4290cd5459c990430011903b7d5c27", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/018ace788a4290cd5459c990430011903b7d5c27", "committedDate": "2020-01-31T13:53:33Z", "message": "Refactor and test recommendation validations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a5191fe7d14ebbff8c3c6de71730b4072aacf96", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/2a5191fe7d14ebbff8c3c6de71730b4072aacf96", "committedDate": "2020-01-31T13:53:34Z", "message": "Refactor validation function signatures to return explicit state rather than boolean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d4ab5070244b1e8b8882a6d793ce740b8efc348", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/5d4ab5070244b1e8b8882a6d793ce740b8efc348", "committedDate": "2020-01-31T13:53:34Z", "message": "Add operation recommendation for GET/HEAD w/body\n\nRecommendation can be disabled via system property:\n\n-Dopenapi.generator.rule.anti-patterns.uri-unexpected-body=false"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "129d0e1486cbc13c76bb6ccf56df296a1e491ffd", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/129d0e1486cbc13c76bb6ccf56df296a1e491ffd", "committedDate": "2020-01-31T13:53:35Z", "message": "Update operationId values in test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "722a1a3ea490463853f6b0e8666793502d36fb3d", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/722a1a3ea490463853f6b0e8666793502d36fb3d", "committedDate": "2020-01-29T23:27:41Z", "message": "Merge branch '4.3.x' into shared-validations\n\n* 4.3.x: (82 commits)\n  [java][client] oneOf support for jackson clients (#5120)\n  [dart-dio] Various fixes (#5027)\n  Add java code comments based on explanation from Jim Schubert (#5048)\n  Execute ./bin/openapi3/go-experimental-petstore.sh script (#5049)\n  [docs] Sorted doc outputs and clean up duplicated CliOptions (#5046)\n  Add docs/installation.md and docsite index to version update script (#5037)\n  [gradle] consistent use of maven url in gradle files (#5045)\n  Use HTTPS Maven URL in Kotlin meta generator (#5043)\n  [Python] fix numeric enum in python flask, aiohttp (#5019)\n  add multipleOf to various codegen classes (#5021)\n  Add a link to a youtube video on Pulp and OpenAPI Generator (#5038)\n  Evaluating https issues in CircleCI (on top of CiscoM31-maven-h\u2026 (#5034)\n  better code format in java jersey doc (#5031)\n  Escape query params before invoking api (#5023)\n  [Java][jersey2] Use builder pattern for requests (#4666)\n  [Slim4] Add integer formats support to Data Mocker (#4965)\n  Add a link to Scala Gatling blog post (#5029)\n  minor improve to rust server (#5020)\n  [Rust Server] fix handling of special characters in path param names (#4897)\n  [dart-dio] Fixes issues with DateTime import and form date paramaterToString function (#4929)\n  ..."}, "afterCommit": {"oid": "129d0e1486cbc13c76bb6ccf56df296a1e491ffd", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/129d0e1486cbc13c76bb6ccf56df296a1e491ffd", "committedDate": "2020-01-31T13:53:35Z", "message": "Update operationId values in test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1980, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}