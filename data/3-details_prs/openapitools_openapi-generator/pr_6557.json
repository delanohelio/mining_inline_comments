{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4Mzc0MjM5", "number": 6557, "title": "[Python] Support for per-operation servers", "bodyText": "Support servers: definition.\nSee:\n\ngo-experimental #4635\njava #4998\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project before.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.", "createdAt": "2020-06-05T10:48:34Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557", "merged": true, "mergeCommit": {"oid": "8b9c070e5d4f262e0f434eb77d215c2ca9245126"}, "closed": true, "closedAt": "2020-06-26T04:28:55Z", "author": {"login": "jirikuncar"}, "timelineItems": {"totalCount": 39, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoQSU0gH2gAyNDI4Mzc0MjM5OjgxZTU5NGQzMTlhNWU3NjU0OWU4ZjRhYTQ1YzQyMDBmNjdiM2Y2NDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuCuKlAH2gAyNDI4Mzc0MjM5OjY2ZGY2NDcxN2M0N2QyZTI3ZWEyZDJjNmE1Nzk1N2MyOTU0OTZlNTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "81e594d319a5e76549e8f4aa45c4200f67b3f646", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/81e594d319a5e76549e8f4aa45c4200f67b3f646", "committedDate": "2020-06-05T10:41:33Z", "message": "Dynamic server support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4985f2711ee994f75deb55d67a028c54defc0d8c", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/4985f2711ee994f75deb55d67a028c54defc0d8c", "committedDate": "2020-06-05T10:47:33Z", "message": "regenerated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MjMyOTc4", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-425232978", "createdAt": "2020-06-05T11:56:19Z", "commit": {"oid": "4985f2711ee994f75deb55d67a028c54defc0d8c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMTo1NjoxOVrOGfrhCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMTo1NzozOVrOGfrjpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg3MjAwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"\"\"Default sever variables\n          \n          \n            \n                    \"\"\"Default server variables", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r435872008", "createdAt": "2020-06-05T11:56:19Z", "author": {"login": "therve"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -155,20 +155,30 @@ conf = {{{packageName}}}.Configuration(\n \n     _default = None\n \n-    def __init__(self, host=\"{{{basePath}}}\",\n+    def __init__(self, host=None,\n                  api_key=None, api_key_prefix=None,\n                  username=None, password=None,\n                  discard_unknown_keys=False,\n                  disabled_client_side_validations=\"\",\n {{#hasHttpSignatureMethods}}\n                  signing_info=None,\n {{/hasHttpSignatureMethods}}\n+                 server_index=None, server_variables=None,\n+                 server_operation_index=None, server_operation_variables=None,\n                  ):\n         \"\"\"Constructor\n         \"\"\"\n-        self.host = host\n+        self._base_path = \"{{{basePath}}}\" if host is None else host\n         \"\"\"Default Base url\n         \"\"\"\n+        self.server_index = 0 if server_index is None and host is None else server_index\n+        self.server_operation_index = server_operation_index or {}\n+        \"\"\"Default server index\n+        \"\"\"\n+        self.server_variables = server_variables or {}\n+        self.server_operation_variables = server_operation_variables or {}\n+        \"\"\"Default sever variables", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4985f2711ee994f75deb55d67a028c54defc0d8c"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg3MjE1Mg==", "bodyText": "Missing servers params doc.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r435872152", "createdAt": "2020-06-05T11:56:38Z", "author": {"login": "therve"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -561,14 +571,14 @@ conf = {{{packageName}}}.Configuration(\n             {{/servers}}\n         ]\n \n-    def get_host_from_settings(self, index, variables=None):\n+    def get_host_from_settings(self, index, variables=None, servers=None):\n         \"\"\"Gets host URL based on the index and variables\n         :param index: array index of the host settings\n         :param variables: hash of variable and the corresponding value", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4985f2711ee994f75deb55d67a028c54defc0d8c"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg3MjY3Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        kwargs['_host_index'] = kwargs.get('_host_index', None)\n          \n          \n            \n                        kwargs['_host_index'] = kwargs.get('_host_index')", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r435872677", "createdAt": "2020-06-05T11:57:39Z", "author": {"login": "therve"}, "path": "modules/openapi-generator/src/main/resources/python/python-experimental/api.mustache", "diffHunk": "@@ -131,7 +131,7 @@ class {{classname}}(object):\n             kwargs['_check_return_type'] = kwargs.get(\n                 '_check_return_type', True\n             )\n-            kwargs['_host_index'] = kwargs.get('_host_index', 0)\n+            kwargs['_host_index'] = kwargs.get('_host_index', None)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4985f2711ee994f75deb55d67a028c54defc0d8c"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MjUwNDIz", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-425250423", "createdAt": "2020-06-05T12:23:37Z", "commit": {"oid": "4985f2711ee994f75deb55d67a028c54defc0d8c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMjoyMzozN1rOGfsVIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMjoyMzozN1rOGfsVIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg4NTM0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    :param variables: hash of variable and the corresponding value\n          \n          \n            \n                    :param variables: hash of variable and the corresponding value\n          \n          \n            \n                    :param servers: host settings for the endpoint", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r435885347", "createdAt": "2020-06-05T12:23:37Z", "author": {"login": "jirikuncar"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -561,14 +571,14 @@ conf = {{{packageName}}}.Configuration(\n             {{/servers}}\n         ]\n \n-    def get_host_from_settings(self, index, variables=None):\n+    def get_host_from_settings(self, index, variables=None, servers=None):\n         \"\"\"Gets host URL based on the index and variables\n         :param index: array index of the host settings\n         :param variables: hash of variable and the corresponding value", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4985f2711ee994f75deb55d67a028c54defc0d8c"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fd2e65794a3996f358ce868265c8b5df51cb2d5", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/1fd2e65794a3996f358ce868265c8b5df51cb2d5", "committedDate": "2020-06-05T12:24:09Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Thomas Herv\u00e9 <thomas.herve@datadoghq.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6caf66f430e8317c925794022ee1e8de9fcf6cbc", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/6caf66f430e8317c925794022ee1e8de9fcf6cbc", "committedDate": "2020-06-05T12:27:14Z", "message": "regenerated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1Mjg1ODY5", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-425285869", "createdAt": "2020-06-05T13:12:59Z", "commit": {"oid": "6caf66f430e8317c925794022ee1e8de9fcf6cbc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5eec72936750c4afd35b909699705ba54f785e20", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/5eec72936750c4afd35b909699705ba54f785e20", "committedDate": "2020-06-05T13:45:09Z", "message": "Add ParameterizedServer feature to Python experimental"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df1c3242d6641b357272912f50c8abaa0ccf60d2", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/df1c3242d6641b357272912f50c8abaa0ccf60d2", "committedDate": "2020-06-05T15:23:17Z", "message": "Fix lookup of server variables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39206459fc9c227c2326f548b770d37ba9a7b80c", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/39206459fc9c227c2326f548b770d37ba9a7b80c", "committedDate": "2020-06-08T10:06:05Z", "message": "Add tests and change default value for servers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7420edb6ccf308d350d5601e626fb7e68a16976f", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/7420edb6ccf308d350d5601e626fb7e68a16976f", "committedDate": "2020-06-08T10:15:06Z", "message": "Fix server variables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5422cfd66af43372998367b94758dfba8c00d972", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/5422cfd66af43372998367b94758dfba8c00d972", "committedDate": "2020-06-08T11:50:44Z", "message": "Return base path when index is None"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "280837f05b0db29a0ead9287bea5d556b4e9be09", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/280837f05b0db29a0ead9287bea5d556b4e9be09", "committedDate": "2020-06-08T13:57:19Z", "message": "Merge remote-tracking branch 'upstream/master' into python-experimental/dynamic-servers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/294d164ab033df0f7c60f38885c9b57c1fb711c3", "committedDate": "2020-06-08T15:15:06Z", "message": "Use HOST"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjM3NDcw", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428637470", "createdAt": "2020-06-11T06:54:10Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjo1NDoxMFrOGiQtig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjo1NDoxMFrOGiQtig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU3ODU3MA==", "bodyText": "How about removing this if block because it already exists in get_host_from_settings?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438578570", "createdAt": "2020-06-11T06:54:10Z", "author": {"login": "spacether"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -595,3 +609,17 @@ conf = {{{packageName}}}.Configuration(\n             url = url.replace(\"{\" + variable_name + \"}\", used_value)\n \n         return url\n+\n+    @property\n+    def host(self):\n+        \"\"\"Return generated host.\"\"\"\n+        if self.server_index is None:\n+            return self._base_path", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 72}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjQwMTgy", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428640182", "createdAt": "2020-06-11T06:59:03Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjo1OTowM1rOGiQ14w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjo1OTowM1rOGiQ14w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU4MDcwNw==", "bodyText": "How about naming this variable _host, which more clearly conveys that this is the default host that we use?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438580707", "createdAt": "2020-06-11T06:59:03Z", "author": {"login": "spacether"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -155,20 +155,30 @@ conf = {{{packageName}}}.Configuration(\n \n     _default = None\n \n-    def __init__(self, host=\"{{{basePath}}}\",\n+    def __init__(self, host=None,\n                  api_key=None, api_key_prefix=None,\n                  username=None, password=None,\n                  discard_unknown_keys=False,\n                  disabled_client_side_validations=\"\",\n {{#hasHttpSignatureMethods}}\n                  signing_info=None,\n {{/hasHttpSignatureMethods}}\n+                 server_index=None, server_variables=None,\n+                 server_operation_index=None, server_operation_variables=None,\n                  ):\n         \"\"\"Constructor\n         \"\"\"\n-        self.host = host\n+        self._base_path = \"{{{basePath}}}\" if host is None else host", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjQ0OTU1", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428644955", "createdAt": "2020-06-11T07:07:25Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzowNzoyNVrOGiREbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzowNzoyNVrOGiREbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU4NDQzMA==", "bodyText": "Can you also update the docstring here to show that _host_index can now be type int/None?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438584430", "createdAt": "2020-06-11T07:07:25Z", "author": {"login": "spacether"}, "path": "modules/openapi-generator/src/main/resources/python/python-experimental/api.mustache", "diffHunk": "@@ -105,7 +105,7 @@ class {{classname}}(object):\n                     Default is True.\n                 _host_index (int): specifies the index of the server\n                     that we want to use.\n-                    Default is 0.\n+                    Default is read from the configuration.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjQ2NjI4", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428646628", "createdAt": "2020-06-11T07:10:10Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzoxMDoxMFrOGiRJXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzoxMDoxMFrOGiRJXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU4NTY5NQ==", "bodyText": "Can you describe that servers should is of type (list/None)?\nCan you describe that index is of type (int/None)?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438585695", "createdAt": "2020-06-11T07:10:10Z", "author": {"login": "spacether"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -561,14 +571,18 @@ conf = {{{packageName}}}.Configuration(\n             {{/servers}}\n         ]\n \n-    def get_host_from_settings(self, index, variables=None):\n+    def get_host_from_settings(self, index, variables=None, servers=None):\n         \"\"\"Gets host URL based on the index and variables\n         :param index: array index of the host settings\n         :param variables: hash of variable and the corresponding value\n+        :param servers: host settings for the endpoint", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjYxNjQ0", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428661644", "createdAt": "2020-06-11T07:34:30Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzozNDozMVrOGiR2nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzozNDozMVrOGiR2nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU5NzI3OQ==", "bodyText": "This method already has 8 inputs not counting self.\nAdding 4 more variables here increases out input count to 12 which is a lot.\nIt is clearer if related variables are grouped together in dicts.\nCan you restructure these 4 new additions into two dicts?\nHow about something like:\nserver_info=None\n# which is a dict like: {index:1, variables={}}\noperation_server_info=None:\n# which is a dict like {index_by_operation_id: {'get_pet': 0}, variables_by_operation_id: {'get_pet': blah}}\n\nCan you add descriptions of these new parameters to the docstring above?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438597279", "createdAt": "2020-06-11T07:34:31Z", "author": {"login": "spacether"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -155,20 +155,30 @@ conf = {{{packageName}}}.Configuration(\n \n     _default = None\n \n-    def __init__(self, host=\"{{{basePath}}}\",\n+    def __init__(self, host=None,\n                  api_key=None, api_key_prefix=None,\n                  username=None, password=None,\n                  discard_unknown_keys=False,\n                  disabled_client_side_validations=\"\",\n {{#hasHttpSignatureMethods}}\n                  signing_info=None,\n {{/hasHttpSignatureMethods}}\n+                 server_index=None, server_variables=None,\n+                 server_operation_index=None, server_operation_variables=None,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjY4NDM1", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428668435", "createdAt": "2020-06-11T07:44:44Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzo0NDo0NFrOGiSK6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzo0NDo0NFrOGiSK6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYwMjQ3NA==", "bodyText": "Possible improvement:\nThis works and a more standard python way to do it is to use\nassert_called_with", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438602474", "createdAt": "2020-06-11T07:44:44Z", "author": {"login": "spacether"}, "path": "samples/openapi3/client/petstore/python-experimental/tests/test_api_validation.py", "diffHunk": "@@ -44,6 +46,27 @@ def test_configuration(self):\n             config.disabled_client_side_validations = 'foo'\n         config.disabled_client_side_validations = \"\"\n \n+    def test_servers(self):\n+        config = petstore_api.Configuration(server_index=1, server_variables={'version': 'v1'})\n+        api_client = petstore_api.ApiClient(config)\n+        api = pet_api.PetApi(api_client)\n+\n+        def request(expected_url, method, url, **kwargs):\n+            assert expected_url == url\n+            raise RuntimeError('pass')\n+\n+        api_client.request = functools.partial(request, 'http://path-server-test.petstore.local/v2/pet')\n+        try:\n+            api.add_pet({'name': 'pet', 'photo_urls': []})\n+        except RuntimeError as e:\n+            assert \"pass\" == str(e)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjcwOTIy", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428670922", "createdAt": "2020-06-11T07:48:30Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzo0ODozMFrOGiSSbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNzo0ODozMFrOGiSSbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYwNDM5Ng==", "bodyText": "Please also add tests of server_operation_index and server_operation_variables.\nThat code is added in this PR and does not yet have any test coverage.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438604396", "createdAt": "2020-06-11T07:48:30Z", "author": {"login": "spacether"}, "path": "samples/openapi3/client/petstore/python-experimental/tests/test_api_validation.py", "diffHunk": "@@ -44,6 +46,27 @@ def test_configuration(self):\n             config.disabled_client_side_validations = 'foo'\n         config.disabled_client_side_validations = \"\"\n \n+    def test_servers(self):\n+        config = petstore_api.Configuration(server_index=1, server_variables={'version': 'v1'})\n+        api_client = petstore_api.ApiClient(config)\n+        api = pet_api.PetApi(api_client)\n+\n+        def request(expected_url, method, url, **kwargs):\n+            assert expected_url == url\n+            raise RuntimeError('pass')\n+\n+        api_client.request = functools.partial(request, 'http://path-server-test.petstore.local/v2/pet')\n+        try:\n+            api.add_pet({'name': 'pet', 'photo_urls': []})\n+        except RuntimeError as e:\n+            assert \"pass\" == str(e)\n+\n+        api_client.request = functools.partial(request, 'https://localhost:8080/v1/pet/123456789')\n+        try:\n+            api.delete_pet(123456789)\n+        except RuntimeError as e:\n+            assert \"pass\" == str(e)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4OTc0MjE0", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428974214", "createdAt": "2020-06-11T14:34:19Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDozNDoxOVrOGigNhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDozNDoxOVrOGigNhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzMjUxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if self.server_index is None:\n          \n          \n            \n                        return self._base_path", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438832517", "createdAt": "2020-06-11T14:34:19Z", "author": {"login": "jirikuncar"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -595,3 +609,17 @@ conf = {{{packageName}}}.Configuration(\n             url = url.replace(\"{\" + variable_name + \"}\", used_value)\n \n         return url\n+\n+    @property\n+    def host(self):\n+        \"\"\"Return generated host.\"\"\"\n+        if self.server_index is None:\n+            return self._base_path\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 73}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4OTc0ODYy", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428974862", "createdAt": "2020-06-11T14:34:59Z", "commit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDozNDo1OVrOGigPOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDozNDo1OVrOGigPOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzMjk1NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            _host_index (int): specifies the index of the server\n          \n          \n            \n                            _host_index (int/None): specifies the index of the server", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438832954", "createdAt": "2020-06-11T14:34:59Z", "author": {"login": "jirikuncar"}, "path": "modules/openapi-generator/src/main/resources/python/python-experimental/api.mustache", "diffHunk": "@@ -105,7 +105,7 @@ class {{classname}}(object):\n                     Default is True.\n                 _host_index (int): specifies the index of the server", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "294d164ab033df0f7c60f38885c9b57c1fb711c3"}, "originalPosition": 2}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f38fc72f8343345bcf751f245a7bac661c57dd2c", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f38fc72f8343345bcf751f245a7bac661c57dd2c", "committedDate": "2020-06-11T14:35:17Z", "message": "Apply suggestions from code review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4OTk3MDM3", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-428997037", "createdAt": "2020-06-11T14:58:14Z", "commit": {"oid": "f38fc72f8343345bcf751f245a7bac661c57dd2c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDo1ODoxNFrOGihPaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDo1ODoxNFrOGihPaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg0OTM4NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    :param servers: host settings for the endpoint\n          \n          \n            \n                    :param servers: an array of host settings or None", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r438849384", "createdAt": "2020-06-11T14:58:14Z", "author": {"login": "jirikuncar"}, "path": "modules/openapi-generator/src/main/resources/python/configuration.mustache", "diffHunk": "@@ -561,14 +571,18 @@ conf = {{{packageName}}}.Configuration(\n             {{/servers}}\n         ]\n \n-    def get_host_from_settings(self, index, variables=None):\n+    def get_host_from_settings(self, index, variables=None, servers=None):\n         \"\"\"Gets host URL based on the index and variables\n         :param index: array index of the host settings\n         :param variables: hash of variable and the corresponding value\n+        :param servers: host settings for the endpoint", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f38fc72f8343345bcf751f245a7bac661c57dd2c"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ec2cb7f7fb227e373936b816ba4ed67e92be624", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/8ec2cb7f7fb227e373936b816ba4ed67e92be624", "committedDate": "2020-06-11T14:58:57Z", "message": "Apply suggestions from code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "655ecd04f4ebe067d22114ce93a6da814ba74a9c", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/655ecd04f4ebe067d22114ce93a6da814ba74a9c", "committedDate": "2020-06-11T15:07:04Z", "message": "Merge remote-tracking branch 'upstream/master' into python-experimental/dynamic-servers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MDI3NjA0", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-429027604", "createdAt": "2020-06-11T15:26:28Z", "commit": {"oid": "8ec2cb7f7fb227e373936b816ba4ed67e92be624"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e973605c39bcbc06b73874b961f3e4f18e0fe20", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/6e973605c39bcbc06b73874b961f3e4f18e0fe20", "committedDate": "2020-06-11T15:34:41Z", "message": "regenerated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a57b4cd84d4ecbb4c5477bc530e1a96dfb7f267", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/0a57b4cd84d4ecbb4c5477bc530e1a96dfb7f267", "committedDate": "2020-06-12T09:06:04Z", "message": "Add specific tests for dynamic servers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NTg4NTQx", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-429588541", "createdAt": "2020-06-12T09:16:57Z", "commit": {"oid": "0a57b4cd84d4ecbb4c5477bc530e1a96dfb7f267"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwOToxNjo1N1rOGi9GMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwOToxNjo1N1rOGi9GMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTMwNTc3OA==", "bodyText": "@jimschubert I have tried to create a minimal specification on which we can showcase the dynamic server configuration to avoid modifications of default \"Petstore\" example. This should follow the work for extensions from #6469.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#discussion_r439305778", "createdAt": "2020-06-12T09:16:57Z", "author": {"login": "jirikuncar"}, "path": "modules/openapi-generator/src/test/resources/3_0/features/dynamic-servers.yaml", "diffHunk": "@@ -0,0 +1,92 @@\n+openapi: 3.0.0\n+info:\n+  description: This specification shows how to use dynamic servers.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a57b4cd84d4ecbb4c5477bc530e1a96dfb7f267"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5788068afe4c08202ce1b8625a7a82e516afe2f0", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/5788068afe4c08202ce1b8625a7a82e516afe2f0", "committedDate": "2020-06-12T12:33:12Z", "message": "Merge remote-tracking branch 'upstream/master' into python-experimental/dynamic-servers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d190976bcbcecfee5de97afab55a8e996d48a06", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/1d190976bcbcecfee5de97afab55a8e996d48a06", "committedDate": "2020-06-12T12:37:44Z", "message": "regenerated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff976a4273b7221ea6f52f1a57be8da89961be75", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/ff976a4273b7221ea6f52f1a57be8da89961be75", "committedDate": "2020-06-14T16:43:02Z", "message": "add docstring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "032533d2a034ba164c0897bb6d28f30a5351cd81", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/032533d2a034ba164c0897bb6d28f30a5351cd81", "committedDate": "2020-06-14T16:43:07Z", "message": "Merge remote-tracking branch 'upstream/master' into python-experimental/dynamic-servers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3706f4d89fc69f3a9d7969940e5d5dc0b8535dad", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/3706f4d89fc69f3a9d7969940e5d5dc0b8535dad", "committedDate": "2020-06-15T08:27:18Z", "message": "regenerated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxNjE5NDQ3", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6557#pullrequestreview-431619447", "createdAt": "2020-06-16T15:17:53Z", "commit": {"oid": "3706f4d89fc69f3a9d7969940e5d5dc0b8535dad"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a1d0cad86335a5bc58cec1cf56022a4d1e8d8c9", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/3a1d0cad86335a5bc58cec1cf56022a4d1e8d8c9", "committedDate": "2020-06-23T08:59:30Z", "message": "Merge remote-tracking branch 'upstream/master' into python-experimental/dynamic-servers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66df64717c47d2e27ea2d2c6a57957c295496e58", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/66df64717c47d2e27ea2d2c6a57957c295496e58", "committedDate": "2020-06-23T10:16:50Z", "message": "Fix wrong merge resolution"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2217, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}