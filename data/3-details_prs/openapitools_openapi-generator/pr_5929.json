{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzMTcwNzQ4", "number": 5929, "title": "[C#][NetCore] adding retry configuration", "bodyText": "Adding retry configuration using the Polly library.\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project before.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.", "createdAt": "2020-04-14T13:03:06Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5929", "merged": true, "mergeCommit": {"oid": "ed1e30e75e31315e9f5cc7e2f4c77ead1cde0929"}, "closed": true, "closedAt": "2020-08-19T10:18:10Z", "author": {"login": "Ramanth"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXjFN7gH2gAyNDAzMTcwNzQ4OmJjMjcxZTcwNjA0OGM3YmNhYzY5ZjZhOTg5ZmI3ZmFmZWMyZmM2Mzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAWE2vgH2gAyNDAzMTcwNzQ4OjFkMmM0NzRlMGZlMTQyMGI5Mjk4MTU0ZjYxMTYwZjUyN2U4YzVmOWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bc271e706048c7bcac69f6a989fb7fafec2fc639", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/bc271e706048c7bcac69f6a989fb7fafec2fc639", "committedDate": "2020-04-14T12:58:43Z", "message": "feat(csharp): adding retry configuration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNTI3NDQ3", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5929#pullrequestreview-402527447", "createdAt": "2020-04-29T10:05:22Z", "commit": {"oid": "bc271e706048c7bcac69f6a989fb7fafec2fc639"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxMDowNToyMlrOGN4DWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxMDowNToyMlrOGN4DWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzIwMzAzMw==", "bodyText": "The inability to customize the retry strategy is a concern, and I think a design that injects the retry strategy via IConfiguration would be better.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5929#discussion_r417203033", "createdAt": "2020-04-29T10:05:22Z", "author": {"login": "shibayan"}, "path": "modules/openapi-generator/src/main/resources/csharp-netcore/ApiClient.mustache", "diffHunk": "@@ -408,7 +410,26 @@ namespace {{packageName}}.Client\n \n             InterceptRequest(req);\n \n-            var response = client.Execute<T>(req);\n+            IRestResponse<T> response;\n+            if (configuration.RetryStatusCodes != null)\t\n+            {\n+                Random jitterer = new Random();\n+                var policy = Policy\n+                    .HandleResult<IRestResponse<T>>(resp => (configuration.RetryStatusCodes.Contains(resp.StatusCode)))\n+                    .WaitAndRetry(configuration.MaxRetries, retryAttempt => TimeSpan.FromSeconds(Math.Pow(2, retryAttempt))\n+                                                          + TimeSpan.FromMilliseconds(jitterer.Next(0, 1000))\n+                     );\n+                var policyResult = policy.ExecuteAndCapture(() => client.Execute<T>(req));\n+                response = (policyResult.Outcome == OutcomeType.Successful) ? policyResult.Result : new RestResponse<T>\n+                {\n+                    Request = req,\n+                    ErrorException = policyResult.FinalException\n+                };\n+            }\n+            else\n+            {\n+                response = client.Execute<T>(req);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc271e706048c7bcac69f6a989fb7fafec2fc639"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1e5605f7a2cb461d850a9f6e99dda95f067f23e", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/e1e5605f7a2cb461d850a9f6e99dda95f067f23e", "committedDate": "2020-05-13T05:53:12Z", "message": "fix(csharp-retry) : adding retry policy through configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "258a80f5f5435f5619b0e28b27ba7347c9212c64", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/258a80f5f5435f5619b0e28b27ba7347c9212c64", "committedDate": "2020-05-13T06:05:07Z", "message": "Merge branch 'master' into feat/csharp/retry-configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2d85525d80cff0f833805e6c234d45b290e0665", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f2d85525d80cff0f833805e6c234d45b290e0665", "committedDate": "2020-05-14T09:19:03Z", "message": "Merge branch 'master' into feat/csharp/retry-configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "943388665c2e53e49bf8032938ac9b3fafea66b0", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/943388665c2e53e49bf8032938ac9b3fafea66b0", "committedDate": "2020-05-15T03:02:34Z", "message": "Merge branch 'master' into feat/csharp/retry-configuration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MDU2MzE5", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5929#pullrequestreview-424056319", "createdAt": "2020-06-04T02:18:10Z", "commit": {"oid": "943388665c2e53e49bf8032938ac9b3fafea66b0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMjoxODoxMFrOGezg_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMjoxOTo0NVrOGeziVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1NDQ5Mw==", "bodyText": "This configuration object is meant to be framework agnostic.\nBy adding RestSharp and Polly here, this breaks our contract of allowing users to build without RestSharp as a dependency and now adds Polly into the mix.\nIf the decision here is to tightly couple Polly with the RestSharp implementation of ApiClient, please modify only the ApiClient (preferably via constructor or thread-safe property injection).", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5929#discussion_r434954493", "createdAt": "2020-06-04T02:18:10Z", "author": {"login": "jimschubert"}, "path": "modules/openapi-generator/src/main/resources/csharp-netcore/Configuration.mustache", "diffHunk": "@@ -10,6 +10,10 @@ using System.IO;\n using System.Linq;\n using System.Security.Cryptography.X509Certificates;\n using System.Text;\n+using System.Net;\n+using Polly;\n+using Polly.Retry;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "943388665c2e53e49bf8032938ac9b3fafea66b0"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1NDgzNw==", "bodyText": "We can't mix non-System types into this interface.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5929#discussion_r434954837", "createdAt": "2020-06-04T02:19:45Z", "author": {"login": "jimschubert"}, "path": "modules/openapi-generator/src/main/resources/csharp-netcore/IReadableConfiguration.mustache", "diffHunk": "@@ -2,7 +2,11 @@\n \n using System;\n using System.Collections.Generic;\n+using System.Net;\n using System.Security.Cryptography.X509Certificates;\n+using Polly;\n+using Polly.Retry;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "943388665c2e53e49bf8032938ac9b3fafea66b0"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4181ca8314911b31ee3d377e427850da108fb3ba", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/4181ca8314911b31ee3d377e427850da108fb3ba", "committedDate": "2020-06-22T05:42:05Z", "message": "Merge branch 'master' into feat/csharp/retry-configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d743ed58e2ef650cc5bb299addcc3c209d79fbc", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/5d743ed58e2ef650cc5bb299addcc3c209d79fbc", "committedDate": "2020-06-22T07:02:48Z", "message": "fix(csharp): moving RetryConfiguration out of Configuration class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7956383011c6a116a6e62a7bdc621600186c3795", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/7956383011c6a116a6e62a7bdc621600186c3795", "committedDate": "2020-06-22T10:21:03Z", "message": "fix(csharp): minor changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f167dd4426daa0c9ca97be8afcc1d752b90628fc", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f167dd4426daa0c9ca97be8afcc1d752b90628fc", "committedDate": "2020-06-23T10:45:29Z", "message": "fix(csharp): fixing tabs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f92656f08620a06236326dab791f777615ffb59", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/2f92656f08620a06236326dab791f777615ffb59", "committedDate": "2020-06-23T12:58:31Z", "message": "fix(csharp): reverting FILES"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff2898417740478a3e92b6af364e324db4226b05", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/ff2898417740478a3e92b6af364e324db4226b05", "committedDate": "2020-06-24T05:21:16Z", "message": "fix(csharp) :reverting some file changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5b7ab9f9dc8034156d8e5fda0e26cb2254cc8d3", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/c5b7ab9f9dc8034156d8e5fda0e26cb2254cc8d3", "committedDate": "2020-06-24T05:29:12Z", "message": "fix(csharp): reverting changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0b188c1213785a525b44a7e7744037dab6d5381", "author": {"user": {"login": "wing328", "name": "William Cheng"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/e0b188c1213785a525b44a7e7744037dab6d5381", "committedDate": "2020-06-30T09:26:40Z", "message": "update samples"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTczNzUz", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5929#pullrequestreview-463573753", "createdAt": "2020-08-07T19:52:17Z", "commit": {"oid": "e0b188c1213785a525b44a7e7744037dab6d5381"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTkxMDg1", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5929#pullrequestreview-463991085", "createdAt": "2020-08-10T06:55:24Z", "commit": {"oid": "e0b188c1213785a525b44a7e7744037dab6d5381"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8ceac7bde476f364a791886dcd6cac2618c00d0", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f8ceac7bde476f364a791886dcd6cac2618c00d0", "committedDate": "2020-08-18T07:53:27Z", "message": "Merge branch 'master' into feat/csharp/retry-configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad602514875bdb13c91eb6219e4ba62988863499", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/ad602514875bdb13c91eb6219e4ba62988863499", "committedDate": "2020-08-18T09:49:29Z", "message": "fix(csharp-retry) : fixing merge conflicts and build failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65d703be155d3f093e17b7beb8a13159020826c7", "author": {"user": {"login": "Ramanth", "name": "Ramanth Addala"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/65d703be155d3f093e17b7beb8a13159020826c7", "committedDate": "2020-08-19T05:16:31Z", "message": "fix(chsarp-retry) : FILES changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d2c474e0fe1420b9298154f61160f527e8c5f9f", "author": {"user": {"login": "wing328", "name": "William Cheng"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/1d2c474e0fe1420b9298154f61160f527e8c5f9f", "committedDate": "2020-08-19T07:00:27Z", "message": "update samples"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2421, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}