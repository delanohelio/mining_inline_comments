{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyNTgxOTc0", "number": 5680, "title": "[C#] Fixed valuetype parameters and discriminator deserialization", "bodyText": "Made non-required valuetypes nullable, and flagged required valuetypes as \"x-csharp-value-type\"\nMade sure to camelCase discriminator property names in Subtype converter\nMade sure all enum variables are marked as such in the codegen\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project before.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.\n\n@mandrean @jimschubert @frankyjuang @shibayan\nThis should address these issues: #3308 #4194", "createdAt": "2020-03-23T19:11:41Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680", "merged": true, "mergeCommit": {"oid": "bc097cfddef9d7a4bfcd265d2da255328127a40b"}, "closed": true, "closedAt": "2020-04-29T13:36:28Z", "author": {"login": "gbrown-ce"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQjQJVgFqTM3OTc0MDUyMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABccUZ6bAFqTQwMjQ2OTEyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5NzQwNTIw", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#pullrequestreview-379740520", "createdAt": "2020-03-23T19:13:10Z", "commit": {"oid": "a98757bcf47f225da3d05731c4dedda6fa143383"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxOToxMzoxMFrOF6USkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxOToxMzoxMFrOF6USkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjY5NDE2MQ==", "bodyText": "Should be noted that this code is just copied from the csharp-netcore generator and works properly there", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#discussion_r396694161", "createdAt": "2020-03-23T19:13:10Z", "author": {"login": "gbrown-ce"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/CSharpClientCodegen.java", "diffHunk": "@@ -651,13 +651,25 @@ public void postProcessParameter(CodegenParameter parameter) {\n         postProcessPattern(parameter.pattern, parameter.vendorExtensions);\n         postProcessEmitDefaultValue(parameter.vendorExtensions);\n         super.postProcessParameter(parameter);\n+        \n+        if (nullableType.contains(parameter.dataType)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a98757bcf47f225da3d05731c4dedda6fa143383"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5NzQwNTkx", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#pullrequestreview-379740591", "createdAt": "2020-03-23T19:13:16Z", "commit": {"oid": "a98757bcf47f225da3d05731c4dedda6fa143383"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxOToxMzoxN1rOF6USyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxOToxMzoxN1rOF6USyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjY5NDIxOQ==", "bodyText": "Should be noted that this code is just copied from the csharp-netcore generator and works properly there", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#discussion_r396694219", "createdAt": "2020-03-23T19:13:17Z", "author": {"login": "gbrown-ce"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/CSharpClientCodegen.java", "diffHunk": "@@ -651,13 +651,25 @@ public void postProcessParameter(CodegenParameter parameter) {\n         postProcessPattern(parameter.pattern, parameter.vendorExtensions);\n         postProcessEmitDefaultValue(parameter.vendorExtensions);\n         super.postProcessParameter(parameter);\n+        \n+        if (nullableType.contains(parameter.dataType)) {\n+            if (!parameter.required) { //optional\n+                parameter.dataType = parameter.dataType + \"?\";\n+            } else {\n+                parameter.vendorExtensions.put(\"x-csharp-value-type\", true);\n+            }\n+        }\n     }\n \n     @Override\n     public void postProcessModelProperty(CodegenModel model, CodegenProperty property) {\n         postProcessPattern(property.pattern, property.vendorExtensions);\n         postProcessEmitDefaultValue(property.vendorExtensions);\n         super.postProcessModelProperty(model, property);\n+        \n+        if (!property.isContainer && (nullableType.contains(property.dataType) || property.isEnum)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a98757bcf47f225da3d05731c4dedda6fa143383"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5NzQxMjQx", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#pullrequestreview-379741241", "createdAt": "2020-03-23T19:14:12Z", "commit": {"oid": "a98757bcf47f225da3d05731c4dedda6fa143383"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxOToxNDoxM1rOF6UU0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxOToxNDoxM1rOF6UU0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjY5NDczNg==", "bodyText": "Right now if this discriminator isn't camelCased it causes things to not deserialize properly when receiving them from an API (since the json is expected to come back camelcased)", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#discussion_r396694736", "createdAt": "2020-03-23T19:14:13Z", "author": {"login": "gbrown-ce"}, "path": "modules/openapi-generator/src/main/resources/csharp/modelGeneric.mustache", "diffHunk": "@@ -3,7 +3,7 @@\n     /// </summary>\n     [DataContract]\n     {{#discriminator}}\n-    [JsonConverter(typeof(JsonSubtypes), \"{{{discriminatorName}}}\")]{{#children}}\n+    [JsonConverter(typeof(JsonSubtypes), \"{{#lambda.camelcase_param}}{{{discriminatorName}}}{{/lambda.camelcase_param}}\")]{{#children}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a98757bcf47f225da3d05731c4dedda6fa143383"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MTUzODYw", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#pullrequestreview-384153860", "createdAt": "2020-03-30T19:14:54Z", "commit": {"oid": "ba0a8b39a89e09eded3448692c657ef7ff71181b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxOToxNDo1NVrOF94Z0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxOToxNDo1NVrOF94Z0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQzMTU2OA==", "bodyText": "Previously this only flagged things in the allVars array which are not actually references to the objecsts in the readWrite or readOnly arrays, so it was missing out on this decoration", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#discussion_r400431568", "createdAt": "2020-03-30T19:14:55Z", "author": {"login": "gbrown-ce"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/AbstractCSharpCodegen.java", "diffHunk": "@@ -470,6 +470,32 @@ private void postProcessEnumRefs(final Map<String, Object> models) {\n                         var.isPrimitiveType = true;\n                     }\n                 }\n+                for (CodegenProperty var : model.readWriteVars) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba0a8b39a89e09eded3448692c657ef7ff71181b"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "188569fd98fa107630f310aed354a40424803664", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/188569fd98fa107630f310aed354a40424803664", "committedDate": "2020-04-02T18:15:27Z", "message": "Fields that are required should emit default values (otherwise the consuming API might throw a fit"}, "afterCommit": {"oid": "4a2b88801e36c7d14903a3da061e196e13254034", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/4a2b88801e36c7d14903a3da061e196e13254034", "committedDate": "2020-04-03T15:43:15Z", "message": "Fields that are required should emit default values (otherwise the consuming API might throw a fit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35e1e992d1836513479d8fdc91b964c84c07bc7e", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/35e1e992d1836513479d8fdc91b964c84c07bc7e", "committedDate": "2020-04-24T16:55:04Z", "message": "Fixed valuetype parameters and discriminator deserialization\n\n- Made non-required valuetypes nullable, and flagged required valuetypes as \"x-csharp-value-type\"\n- Made sure to camelCase discriminator property names in Subtype converter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3afe020abb5bbc525b171fa78f50b3b22e3e44bc", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/3afe020abb5bbc525b171fa78f50b3b22e3e44bc", "committedDate": "2020-04-24T16:55:05Z", "message": "Ran pet store sample script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c735e51115e3424efd3e7975ef4ff2fee43c8907", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/c735e51115e3424efd3e7975ef4ff2fee43c8907", "committedDate": "2020-04-24T16:55:05Z", "message": "Ensure that readWriteVars and readOnlyVars are also marked as isEnum and isPrimitiveType where appropriate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f614f0d3d3755f2c42016b4230e98a44f4c80a0", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/2f614f0d3d3755f2c42016b4230e98a44f4c80a0", "committedDate": "2020-04-24T16:55:05Z", "message": "Updated petstore sample with enum fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5727fab6a6f6337c5e1ab9bd75ba8d33d906b1d9", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/5727fab6a6f6337c5e1ab9bd75ba8d33d906b1d9", "committedDate": "2020-04-24T16:55:06Z", "message": "Fields that are required should emit default values (otherwise the consuming API might throw a fit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecabacff4829f62308c4b55651fdb6e7ff95879c", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/ecabacff4829f62308c4b55651fdb6e7ff95879c", "committedDate": "2020-04-24T16:55:06Z", "message": "Added missing sample updated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "722342a124bbaf5f19ea50417b3a355f0d084c41", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/722342a124bbaf5f19ea50417b3a355f0d084c41", "committedDate": "2020-04-24T16:55:07Z", "message": "Re-ran petstore example script to grab all changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cda388658845ec2cda6d42b8443f44448149a491", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/cda388658845ec2cda6d42b8443f44448149a491", "committedDate": "2020-04-24T17:02:07Z", "message": "Rebased and re-ran example update script"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "17e417488865c94fb16133bc9fa4d6dcb71abcc7", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/17e417488865c94fb16133bc9fa4d6dcb71abcc7", "committedDate": "2020-04-24T14:34:16Z", "message": "Re-ran petstore example script to grab all changes"}, "afterCommit": {"oid": "cda388658845ec2cda6d42b8443f44448149a491", "author": {"user": {"login": "gbrown-ce", "name": "Geoff Brown"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/cda388658845ec2cda6d42b8443f44448149a491", "committedDate": "2020-04-24T17:02:07Z", "message": "Rebased and re-ran example update script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "635d176810bbf98d26ffd8fbcc72e0dda29505df", "author": {"user": {"login": "wing328", "name": "William Cheng"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/635d176810bbf98d26ffd8fbcc72e0dda29505df", "committedDate": "2020-04-27T13:15:38Z", "message": "update csharp samples"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNDY5MTIw", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#pullrequestreview-402469120", "createdAt": "2020-04-29T08:42:21Z", "commit": {"oid": "635d176810bbf98d26ffd8fbcc72e0dda29505df"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwODo0MjoyMlrOGN1NrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQwODo0MjoyMlrOGN1NrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzE1NjUyNA==", "bodyText": "These are not defined as nullable in the spec but with this PR these become nullable: https://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator/src/test/resources/2_0/petstore-with-fake-endpoints-models-for-testing.yaml#L709\n@gbrown-ce can you please take a look when you've time?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5680#discussion_r417156524", "createdAt": "2020-04-29T08:42:22Z", "author": {"login": "wing328"}, "path": "samples/client/petstore/csharp/OpenAPIClient/docs/FakeApi.md", "diffHunk": "@@ -645,14 +645,14 @@ namespace Example\n             var _double = 1.2D;  // double | None\n             var patternWithoutDelimiter = patternWithoutDelimiter_example;  // string | None\n             var _byte = BYTE_ARRAY_DATA_HERE;  // byte[] | None\n-            var integer = 56;  // int | None (optional) \n-            var int32 = 56;  // int | None (optional) \n-            var int64 = 789;  // long | None (optional) \n-            var _float = 3.4F;  // float | None (optional) \n+            var integer = 56;  // int? | None (optional) \n+            var int32 = 56;  // int? | None (optional) \n+            var int64 = 789;  // long? | None (optional) \n+            var _float = 3.4F;  // float? | None (optional) ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "635d176810bbf98d26ffd8fbcc72e0dda29505df"}, "originalPosition": 74}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2638, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}