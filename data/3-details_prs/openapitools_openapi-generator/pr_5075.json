{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1NjMyNjg5", "number": 5075, "title": "[go-experimental] Fix multiple go compilation errors and enable go integration test", "bodyText": "Fix issues listed in #5074\nThe generated go-experimental code has multiple issues that cause syntax errors:\nUse but does not define the \"NullableMap\" type\nRefer to the \"NullableTime.Time\" type, but the type is actually \"NullableTime\"\nImport but does not use the \"time\" package\nRefer to the Nullable[]map[string]interface{}, which is not a valid golang type.\nSome \"const\" values are defined twice with the same identifier, once for the enum value, and once for the default value.\nOther issues found:\nMissing pom.xml files in the go and go-experimental directories.\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project before.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.", "createdAt": "2020-01-22T02:28:10Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5075", "merged": true, "mergeCommit": {"oid": "75d5569e92ede1e79df194225f1e872ec2da9b40"}, "closed": true, "closedAt": "2020-01-24T01:54:27Z", "author": {"login": "sebastien-rosset"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8sTGMAH2gAyMzY1NjMyNjg5OjY4NWE3YWY3YjIzNWIwZDljYjE0YTcwYjZjZmE2MTc5ZWI5NjYyOTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9QWYNAH2gAyMzY1NjMyNjg5OmVmMjVlNTU2OGExMjU5NjQ5MjFmOWI4MjA5YjgwOWQ2ZTAxOTA2MjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "685a7af7b235b0d9cb14a70b6cfa6179eb966299", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/685a7af7b235b0d9cb14a70b6cfa6179eb966299", "committedDate": "2020-01-22T02:27:04Z", "message": "fix go compilation error for properties of type map and array"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31527ca170ec9e043a489d0686a426619430c764", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/31527ca170ec9e043a489d0686a426619430c764", "committedDate": "2020-01-22T02:47:08Z", "message": "fix go compilation error for properties of type date and datetime"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "937093700346aab03326d0d3d16f916423616472", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/937093700346aab03326d0d3d16f916423616472", "committedDate": "2020-01-22T04:50:26Z", "message": "add missing shell script to bin/utils/ensure-up-to-date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d665d7c17b2ca2464f87418e2d555f73dfabc231", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/d665d7c17b2ca2464f87418e2d555f73dfabc231", "committedDate": "2020-01-22T05:18:12Z", "message": "add missing shell script to bin/utils/ensure-up-to-date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48526daabe4badbe823a61e4b419dda3919ea93c", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/48526daabe4badbe823a61e4b419dda3919ea93c", "committedDate": "2020-01-22T05:20:10Z", "message": "add missing shell script to bin/utils/ensure-up-to-date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "262dc8afc88d714cd732b65d24cdc0e5c171c09b", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/262dc8afc88d714cd732b65d24cdc0e5c171c09b", "committedDate": "2020-01-22T06:20:31Z", "message": "fix issue with 'date' type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3bb335c60353a3694991a88afca91938018257f", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/a3bb335c60353a3694991a88afca91938018257f", "committedDate": "2020-01-22T06:32:43Z", "message": "fix time import problem"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "735f84c19b9e38d1cc68a943194e602b64e96f9e", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/735f84c19b9e38d1cc68a943194e602b64e96f9e", "committedDate": "2020-01-22T06:41:06Z", "message": "Add missing pom.xml files for golang"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53226d321626a9d45c65f2d13f2a057894fa1576", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/53226d321626a9d45c65f2d13f2a057894fa1576", "committedDate": "2020-01-22T07:48:22Z", "message": "Add missing unit test files for golang"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be0b85c2abfcfd43428c16340d0f88cccb5a786e", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/be0b85c2abfcfd43428c16340d0f88cccb5a786e", "committedDate": "2020-01-22T15:02:38Z", "message": "Add missing unit test files for golang. Must use class name prefix for enums"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "295bbb71845721039aac5db20b26d952bfb58c7f", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/295bbb71845721039aac5db20b26d952bfb58c7f", "committedDate": "2020-01-22T15:29:48Z", "message": "Fix unit tests for go-experimental in OAS3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2cf635460db566d0148ef0d444e583e81bd6eca", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/e2cf635460db566d0148ef0d444e583e81bd6eca", "committedDate": "2020-01-22T15:38:06Z", "message": "Fix unit tests for go-experimental in OAS3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1769234b2e15060f2083d2a5beb57aee92c11bf2", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/1769234b2e15060f2083d2a5beb57aee92c11bf2", "committedDate": "2020-01-22T16:59:49Z", "message": "Add code comments in codegen"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ed28d8be6cf474c72c1c54649283f8954c2df53", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/1ed28d8be6cf474c72c1c54649283f8954c2df53", "committedDate": "2020-01-22T17:17:25Z", "message": "Fix compilation errors of generated go code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "705a8c3c624de46dccc266529db504d5841d8200", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/705a8c3c624de46dccc266529db504d5841d8200", "committedDate": "2020-01-22T17:17:49Z", "message": "Fix compilation errors of generated go code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f115d8c1b104c5ee8ee272a8bb6bc3256108eb82", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f115d8c1b104c5ee8ee272a8bb6bc3256108eb82", "committedDate": "2020-01-22T17:42:57Z", "message": "remove antihax from go-experimental, it is no longer used"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MzcyNTI1", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5075#pullrequestreview-346372525", "createdAt": "2020-01-22T06:44:34Z", "commit": {"oid": "735f84c19b9e38d1cc68a943194e602b64e96f9e"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0NDozNFrOFgR6ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxNjowNDoxNVrOFghskw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5MjIzNA==", "bodyText": "How about using NullableTime for the OAS \"time\" type instead of plain \"string\" type? At least specifically for go-experimental, because this would be a breaking change for \"go\". Golang has the time.Time.Truncate() function, which could help to perform arithmetic with dates.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5075#discussion_r369392234", "createdAt": "2020-01-22T06:44:34Z", "author": {"login": "sebastien-rosset"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/GoClientExperimentalCodegen.java", "diffHunk": "@@ -83,16 +82,23 @@ public void processOpts() {\n                 }\n \n                 for (CodegenProperty param : model.vars) {\n-                    if (!param.isNullable) {\n+                    if (!param.isNullable || param.isMapContainer || param.isListContainer) {\n                         continue;\n                     }\n-\n-                    param.dataType = \"Nullable\" + Character.toUpperCase(param.dataType.charAt(0))\n+                    if (param.isDateTime) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "735f84c19b9e38d1cc68a943194e602b64e96f9e"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5MjUwNw==", "bodyText": "It's not very clear where in the pom.xml these two lines should be added.\nShould we add a \"go-experimental\" profile in the top-level pom.xml? Similar to https://github.com/OpenAPITools/openapi-generator/blob/master/pom.xml#L911?\nIt would be good to add XML comments to explain the purpose of the profiles in the top-level pom.xml file. Specifically, there are 4 profiles that use a different JDK. Why? I'd like to add an XML comment to explain. Is it done because some samples require a specific version of the JDK? Or because someone wanted to make sure the sample can compile against multiple JDK versions? Or because whoever added the sample found a spot where to add the sample, without thinking about which JDK is needed?\n\n\nhttps://github.com/OpenAPITools/openapi-generator/blob/master/pom.xml#L1031\nhttps://github.com/OpenAPITools/openapi-generator/blob/master/pom.xml#L1086\nhttps://github.com/OpenAPITools/openapi-generator/blob/master/pom.xml#L1178\nhttps://github.com/OpenAPITools/openapi-generator/blob/master/pom.xml#L1240", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5075#discussion_r369392507", "createdAt": "2020-01-22T06:45:46Z", "author": {"login": "sebastien-rosset"}, "path": "pom.xml", "diffHunk": "@@ -1097,6 +1097,8 @@\n                 <!-- test non-java projects -->\n                 <module>samples/client/petstore/go</module>\n                 <module>samples/client/petstore/go-experimental</module>\n+                <module>samples/openapi3/client/petstore/go-experimental</module>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "735f84c19b9e38d1cc68a943194e602b64e96f9e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY0OTcwMw==", "bodyText": "Why not invoke the following code in go-experimental processOpts() instead of modifying the dataType here? What is the reason for changing the type in postProcessModels()?\ntypeMapping.put(\"DateTime\", \"NullableTime\");", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5075#discussion_r369649703", "createdAt": "2020-01-22T16:02:27Z", "author": {"login": "sebastien-rosset"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/GoClientExperimentalCodegen.java", "diffHunk": "@@ -83,16 +82,23 @@ public void processOpts() {\n                 }\n \n                 for (CodegenProperty param : model.vars) {\n-                    if (!param.isNullable) {\n+                    if (!param.isNullable || param.isMapContainer || param.isListContainer) {\n                         continue;\n                     }\n-\n-                    param.dataType = \"Nullable\" + Character.toUpperCase(param.dataType.charAt(0))\n+                    if (param.isDateTime) {\n+                        param.dataType = \"NullableTime\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2cf635460db566d0148ef0d444e583e81bd6eca"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY1MDM0OQ==", "bodyText": "I've added error checking, but it does not seem a good idea to depend on the Python module.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5075#discussion_r369650349", "createdAt": "2020-01-22T16:03:28Z", "author": {"login": "sebastien-rosset"}, "path": "samples/client/petstore/go-experimental/pet_api_test.go", "diffHunk": "@@ -139,7 +139,10 @@ func TestFindPetsByStatus(t *testing.T) {\n }\n \n func TestUploadFile(t *testing.T) {\n-\tfile, _ := os.Open(\"../python/testfiles/foo.png\")\n+\tfile, err1 := os.Open(\"../python/testfiles/foo.png\")\n+\tif err1 != nil {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2cf635460db566d0148ef0d444e583e81bd6eca"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY1MDgzNQ==", "bodyText": "Should I copy all of the existing unit test files from samples/client/petstore/go-experimental?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5075#discussion_r369650835", "createdAt": "2020-01-22T16:04:15Z", "author": {"login": "sebastien-rosset"}, "path": "samples/openapi3/client/petstore/go-experimental/auth_test.go", "diffHunk": "@@ -0,0 +1,259 @@\n+package main", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2cf635460db566d0148ef0d444e583e81bd6eca"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "220e0cfd7b212b8738792a45403ce3d60565062d", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/220e0cfd7b212b8738792a45403ce3d60565062d", "committedDate": "2020-01-23T15:28:42Z", "message": "Merge remote-tracking branch 'origin' into go-syntax-error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ac6769367d39cf8674ee81f0cd6655d8cdb1c42", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/2ac6769367d39cf8674ee81f0cd6655d8cdb1c42", "committedDate": "2020-01-23T15:33:20Z", "message": "copy python testfile for ut purpose"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2e34eef862d8124f47654ad0745692d594e41b4", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/d2e34eef862d8124f47654ad0745692d594e41b4", "committedDate": "2020-01-23T15:35:46Z", "message": "add error checkout in unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0049c793b8c2346ab256192f19475501f6fbeba7", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/0049c793b8c2346ab256192f19475501f6fbeba7", "committedDate": "2020-01-23T15:45:30Z", "message": "add unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60e67092498dd9e3dbcd931fa4838614d66e2f35", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/60e67092498dd9e3dbcd931fa4838614d66e2f35", "committedDate": "2020-01-23T16:09:16Z", "message": "add code comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NDMxNDc4", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5075#pullrequestreview-347431478", "createdAt": "2020-01-23T16:23:06Z", "commit": {"oid": "60e67092498dd9e3dbcd931fa4838614d66e2f35"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cd66c2defc17a1991dbde7ec4f2e084f252c8e6", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/4cd66c2defc17a1991dbde7ec4f2e084f252c8e6", "committedDate": "2020-01-23T16:48:36Z", "message": "move test foo.png file to correct location"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f0676c1b3d4f64a9d3b2637aa597cc40b6f2b6f", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/1f0676c1b3d4f64a9d3b2637aa597cc40b6f2b6f", "committedDate": "2020-01-23T17:42:28Z", "message": "run samples scripts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef25e5568a125964921f9b8209b809d6e0190620", "author": {"user": {"login": "sebastien-rosset", "name": "Sebastien Rosset"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/ef25e5568a125964921f9b8209b809d6e0190620", "committedDate": "2020-01-23T20:27:14Z", "message": "run samples scripts"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2844, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}