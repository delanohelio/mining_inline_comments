{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMjkzMDQ2", "number": 5266, "title": "[typescript] Don't hardcode the date type if user has mapped it", "bodyText": "If the user has set --type-mappings Date=foo, respect this setting\ninstead of hardcoding the date type.\n\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project before.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.", "createdAt": "2020-02-10T18:45:44Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266", "merged": true, "mergeCommit": {"oid": "e157b0520603a031eca41ec9ccc7be4bb8c0bee1"}, "closed": true, "closedAt": "2020-02-12T09:49:46Z", "author": {"login": "asmundg"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDBm3sgH2gAyMzczMjkzMDQ2OmJlOGUwNWRiMmRjYzE0NThlYWY3ODE0NjQxMTY2ZTcxOTBiNzhmYTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDik2wgH2gAyMzczMjkzMDQ2OjUxNTg1MGNiNGE5Y2JhZTYzMWMwODAxZGJiNzY5NGM2OGQ4YTYwMDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "be8e05db2dcc1458eaf7814641166e7190b78fa2", "author": {"user": {"login": "asmundg", "name": "\u00c5smund Grammeltvedt"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/be8e05db2dcc1458eaf7814641166e7190b78fa2", "committedDate": "2020-02-10T18:40:13Z", "message": "[typescript] Don't hardcode the date type if user has mapped it\n\nIf the user has set --type-mappings Date=foo, respect this setting\ninstead of hardcoding the date type."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MjA4Njk3", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#pullrequestreview-356208697", "createdAt": "2020-02-10T19:38:58Z", "commit": {"oid": "be8e05db2dcc1458eaf7814641166e7190b78fa2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MjYxMjI4", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#pullrequestreview-356261228", "createdAt": "2020-02-10T21:03:50Z", "commit": {"oid": "be8e05db2dcc1458eaf7814641166e7190b78fa2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMTowMzo1MFrOFn1ezg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMTowMzo1MFrOFn1ezg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMxNTAyMg==", "bodyText": "is this variable used?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#discussion_r377315022", "createdAt": "2020-02-10T21:03:50Z", "author": {"login": "amakhrov"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/TypeScriptFetchClientCodegen.java", "diffHunk": "@@ -134,14 +134,15 @@ public void processOpts() {\n \n     @Override\n     public String getTypeDeclaration(Schema p) {\n+        String oasType = getSchemaType(p);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be8e05db2dcc1458eaf7814641166e7190b78fa2"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MjY1ODEy", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#pullrequestreview-356265812", "createdAt": "2020-02-10T21:11:21Z", "commit": {"oid": "be8e05db2dcc1458eaf7814641166e7190b78fa2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMToxMToyMVrOFn1skA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMToxMToyMVrOFn1skA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMxODU0NA==", "bodyText": "I don't think there is a need to have custom type mapping for datetime here at all - because AbstractTsClient already includes it into its typeMappings map. That's why it's not a problem for the TsAngularClient, which doesn't define any specific mapping for DateTime at all, and it still works.\nSo we could just remove it from the child TS generators and rely on the abstract one\nAny thoughts?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#discussion_r377318544", "createdAt": "2020-02-10T21:11:21Z", "author": {"login": "amakhrov"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/TypeScriptFetchClientCodegen.java", "diffHunk": "@@ -134,14 +134,15 @@ public void processOpts() {\n \n     @Override\n     public String getTypeDeclaration(Schema p) {\n+        String oasType = getSchemaType(p);\n         if (ModelUtils.isFileSchema(p)) {\n             return \"Blob\";\n         } else if (ModelUtils.isBinarySchema(p)) {\n             return \"Blob\";\n         } else if (ModelUtils.isDateSchema(p)) {\n-            return \"Date\";\n+            return typeMapping.containsKey(\"Date\") ? typeMapping.get(\"Date\") : \"Date\";\n         } else if (ModelUtils.isDateTimeSchema(p)) {\n-            return \"Date\";\n+            return typeMapping.containsKey(\"Date\") ? typeMapping.get(\"Date\") : \"Date\";\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be8e05db2dcc1458eaf7814641166e7190b78fa2"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MjY3NTAy", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#pullrequestreview-356267502", "createdAt": "2020-02-10T21:14:12Z", "commit": {"oid": "be8e05db2dcc1458eaf7814641166e7190b78fa2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMToxNDoxMlrOFn1x0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMToxNDoxMlrOFn1x0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMxOTg4OQ==", "bodyText": "not sure this is correct.\nAccording to DefaultCodegen#getPrimitiveType() implementation, \"Date\" is not a valid primitive type. Instead, \"date\" is (more precisely, SchemaTypeUtil.DATE_FORMAT).\nAgain, the AbstractTsClient already includes a reasonable mapping for it (maps to \"string\": typeMapping.put(\"date\", \"string\");). So having it in the child TS codegens seems redundant", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#discussion_r377319889", "createdAt": "2020-02-10T21:14:12Z", "author": {"login": "amakhrov"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/TypeScriptFetchClientCodegen.java", "diffHunk": "@@ -134,14 +134,15 @@ public void processOpts() {\n \n     @Override\n     public String getTypeDeclaration(Schema p) {\n+        String oasType = getSchemaType(p);\n         if (ModelUtils.isFileSchema(p)) {\n             return \"Blob\";\n         } else if (ModelUtils.isBinarySchema(p)) {\n             return \"Blob\";\n         } else if (ModelUtils.isDateSchema(p)) {\n-            return \"Date\";\n+            return typeMapping.containsKey(\"Date\") ? typeMapping.get(\"Date\") : \"Date\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be8e05db2dcc1458eaf7814641166e7190b78fa2"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f446eec0ab2b75a12eae1f77aa0c956f20404ad", "author": {"user": {"login": "asmundg", "name": "\u00c5smund Grammeltvedt"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/2f446eec0ab2b75a12eae1f77aa0c956f20404ad", "committedDate": "2020-02-10T22:11:00Z", "message": "Use default type mappings for date/date-time"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NDgyNzc2", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#pullrequestreview-356482776", "createdAt": "2020-02-11T08:43:34Z", "commit": {"oid": "2f446eec0ab2b75a12eae1f77aa0c956f20404ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwODo0MzozNFrOFoAurg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwODo0MzozNFrOFoAurg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzQ5OTMxMA==", "bodyText": "this should be Date, since typescript-fetch implements date deserialization:\nhttps://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator/src/main/resources/typescript-fetch/modelGeneric.mustache#L66", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#discussion_r377499310", "createdAt": "2020-02-11T08:43:34Z", "author": {"login": "macjohnny"}, "path": "modules/openapi-generator/src/test/java/org/openapitools/codegen/typescript/fetch/TypeScriptFetchModelTest.java", "diffHunk": "@@ -95,7 +95,7 @@ public void simpleModelTest() {\n         final CodegenProperty property4 = cm.vars.get(3);\n         Assert.assertEquals(property4.baseName, \"birthDate\");\n         Assert.assertEquals(property4.complexType, null);\n-        Assert.assertEquals(property4.dataType, \"Date\");\n+        Assert.assertEquals(property4.dataType, \"string\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f446eec0ab2b75a12eae1f77aa0c956f20404ad"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa6d77ca01e11f21b0e42249a2bc1f749b3d520b", "author": {"user": {"login": "asmundg", "name": "\u00c5smund Grammeltvedt"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/fa6d77ca01e11f21b0e42249a2bc1f749b3d520b", "committedDate": "2020-02-11T08:54:45Z", "message": "Use typeMapping mechanism correctly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NDk1NDk5", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#pullrequestreview-356495499", "createdAt": "2020-02-11T09:06:48Z", "commit": {"oid": "fa6d77ca01e11f21b0e42249a2bc1f749b3d520b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "317a3a49492215053212cc643b2b8db2cafb9364", "author": {"user": {"login": "asmundg", "name": "\u00c5smund Grammeltvedt"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/317a3a49492215053212cc643b2b8db2cafb9364", "committedDate": "2020-02-11T13:07:05Z", "message": "Add default mapping for angular and node to preserve behavior"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NjQ1NTQ5", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#pullrequestreview-356645549", "createdAt": "2020-02-11T13:15:58Z", "commit": {"oid": "317a3a49492215053212cc643b2b8db2cafb9364"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxMzoxNTo1OFrOFoIeHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxMzoxNTo1OFrOFoIeHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzYyNjE0MQ==", "bodyText": "I think it would be good to remove this, i.e. to change the mapping from Date to string for format: date-time, since the typescript-angular generator does not support serialization for the models.\nNote: this would pose a problem, since serialization for query params is implemented, see e.g. #5225", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5266#discussion_r377626141", "createdAt": "2020-02-11T13:15:58Z", "author": {"login": "macjohnny"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/TypeScriptAngularClientCodegen.java", "diffHunk": "@@ -86,6 +86,8 @@ public TypeScriptAngularClientCodegen() {\n         apiPackage = \"api\";\n         modelPackage = \"model\";\n \n+        typeMapping.put(\"DateTime\", \"Date\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "317a3a49492215053212cc643b2b8db2cafb9364"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "976d7b27330e0d503e8768a4add511cbff3bc7e8", "author": {"user": {"login": "asmundg", "name": "\u00c5smund Grammeltvedt"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/976d7b27330e0d503e8768a4add511cbff3bc7e8", "committedDate": "2020-02-11T14:33:01Z", "message": "One more change to keep current behavior"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "515850cb4a9cbae631c0801dbb7694c68d8a6007", "author": {"user": {"login": "asmundg", "name": "\u00c5smund Grammeltvedt"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/515850cb4a9cbae631c0801dbb7694c68d8a6007", "committedDate": "2020-02-12T09:04:53Z", "message": "Add default type mappings to the other TS generators"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2773, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}