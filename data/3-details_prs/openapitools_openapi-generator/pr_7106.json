{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYxNTA2NDQx", "number": 7106, "title": "[bug][core] Copy all attributes (not properties) on composed schemas when flattening models", "bodyText": "Fixes #6950\nThe model flattening for composed schemas was not copying all attributes of the schema being flattened. This broke inheritance across composed schemas, which is a feature that is supported by the specification.\ncc @OpenAPITools/generator-core-team\ncc @jeff9finger\nExample output showing proper inheritance using spec from #6950:\n\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project beforehand.\n Run the shell script ./bin/generate-samples.shto update all Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit as it would merge with master. These must match the expectations made by your contribution. You may regenerate an individual generator by passing the relevant config(s) as an argument to the script, for example ./bin/generate-samples.sh bin/configs/java*. For Windows users, please run the script in Git BASH.\n File the PR against the correct branch: master\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.", "createdAt": "2020-08-01T23:17:41Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7106", "merged": true, "mergeCommit": {"oid": "7a846a193ab129dbdadcfbce90572c0a044efcaf"}, "closed": true, "closedAt": "2020-08-04T01:16:48Z", "author": {"login": "jimschubert"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6xFpEAH2gAyNDYxNTA2NDQxOmZhNjlhN2Y0YWY1ZmYzZGU2ODMxMDI4MWY4Y2NmYjY1M2M4YzgzMzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7cHRfAH2gAyNDYxNTA2NDQxOmEwMzRiNTJmZWRmMGRiMDU2MmEwYzAzNjY1ZWE1OGYyNTE2NjJkMTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fa69a7f4af5ff3de68310281f8ccfb653c8c8332", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/fa69a7f4af5ff3de68310281f8ccfb653c8c8332", "committedDate": "2020-08-01T23:05:12Z", "message": "[bug] Copy all validations on composed schemas when flattening models"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7f578851d9853ae9503d5325825d240a25cfe13", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f7f578851d9853ae9503d5325825d240a25cfe13", "committedDate": "2020-08-01T23:08:52Z", "message": "Regenerate samples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb85d809ec486d0beed60ef903a1a59be204d244", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/eb85d809ec486d0beed60ef903a1a59be204d244", "committedDate": "2020-08-02T02:04:15Z", "message": "Add regression test for attribute copy of flattened composed schemas"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3770a2b7b4d05ab454f82bb8112a4eea70697f37", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/3770a2b7b4d05ab454f82bb8112a4eea70697f37", "committedDate": "2020-08-02T02:04:47Z", "message": "Ensure consistent model structure keying with sorted properties in Jackson JSON writer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NjYyNTc1", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7106#pullrequestreview-459662575", "createdAt": "2020-08-02T16:41:08Z", "commit": {"oid": "3770a2b7b4d05ab454f82bb8112a4eea70697f37"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQxNjo0MTowOFrOG6mTmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQxNjo0MTowOFrOG6mTmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA5ODIwMg==", "bodyText": "So I have some questions about how our code works here. Can you help answer them?\n\nThis copies the property from the inline schema into the extracted schema that we put into openapi component schemas, right?\nSo it sets the discriminator on this schema:\n\n      - type: object\n        discriminator: party_type\n        required:\n          - party_type\n        properties:\n          party_type:\n            readOnly: true\n            $ref: '#/definitions/PartyType'\n          tax_id_number:\n            type: string\n\nWhich is extracted and used to create the schema with the key Party_allOf, correct?\n2. Is only one Party_allOf class made for each composed schema or is each inline schema extracted out into its own Party_allOf1, Party_allOf2 etc?\n3. How about adding a javadoc to this method so one can understand this by reading the doc in the future?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7106#discussion_r464098202", "createdAt": "2020-08-02T16:41:08Z", "author": {"login": "spacether"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/InlineModelResolver.java", "diffHunk": "@@ -627,6 +653,30 @@ private Schema modelFromProperty(OpenAPI openAPI, Schema object, String path) {\n         model.setXml(xml);\n         model.setRequired(object.getRequired());\n         model.setNullable(object.getNullable());\n+        model.setDiscriminator(object.getDiscriminator());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3770a2b7b4d05ab454f82bb8112a4eea70697f37"}, "originalPosition": 71}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "410ec31636b934a932a18e1170b4cf9eb913a078", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/410ec31636b934a932a18e1170b4cf9eb913a078", "committedDate": "2020-08-03T23:53:13Z", "message": "Merge branch 'master' into jersey-inheritance\n\n* master:\n  [core] Add type and format properties to model of inline response (#6153)\n  [PowerShell] better publishing workflow (#7114)\n  [aspnetcore] Typo issues in docs and generated code (#7094)\n  fix http signaure auth in build.sbt (#7110)\n  fix for the issue facing spec invlolving arrayschema structure with ref (#6310)\n  [csharp-netcore] added cancellation tokens to async calls (#7077)\n  [PS] Allow CI to publish the module (#7091)\n  [Dart] Treat float as double (#6924)\n  [Java][jersey2]Fix gradle HttpSignatureAuth dependencies (#7096)\n  move maven,gradle tests to shipppable ci (#7108)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a034b52fedf0db0562a0c03665ea58f251662d16", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/a034b52fedf0db0562a0c03665ea58f251662d16", "committedDate": "2020-08-04T01:12:54Z", "message": "Remove unnecessary null checks and duplicate setters in InlineModelResolver"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3290, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}