{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5NzU2MDk4", "number": 5182, "title": "[core][typescript][perl] Ensure model.parent is also added to model.allParents with multiple inheritance", "bodyText": "Fixes #4770\nTurned out that generator still supports a deprecated inheritance case with a single oneOf ref without a discriminator. The behavior in this case is to treat it as inheritance rather than composition.\nNow, the problem is that even though model.parent is properly populated with the referenced model in this situation, model.allParents (used with multiple inheritance) stays empty. It looks like a bug in the implementation rather than intended behavior - but of course correct me if I'm wrong.\nThis PR makes sure the same logic supporting the deprecated inheritance case applies both to parent and allParents.\nI also cleaned up a few tests for DefaultCodegen that are related to allOf composition - just to give me a bit more safety assurance of the change (better than nothing)\n\nPR checklist\n\n Read the contribution guidelines.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.\n\nTypescript generators family use multiple inheritance, hence copying them here:\n@TiFu @taxpon @sebastianhaas @kenisteward @Vrolijkx @macjohnny @nicokoenig @topce @akehir @petejohansonxo\nAnd also Perl (another representative of multiple inheritance supporting generator):\n@wing328  @yue9944882", "createdAt": "2020-01-31T20:21:59Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5182", "merged": true, "mergeCommit": {"oid": "197cea3248b66b11ed22da6cd0760804b1737776"}, "closed": true, "closedAt": "2020-02-06T19:21:07Z", "author": {"login": "amakhrov"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_1FBsgFqTM1MTc1NTg4Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBtZd0gBqjMwMTQ1OTY5MDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNzU1ODg3", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5182#pullrequestreview-351755887", "createdAt": "2020-01-31T20:22:37Z", "commit": {"oid": "ce65af478ab209aa7279771c74f79a4888116219"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMDoyMjozN1rOFkW9zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMDoyMjozN1rOFkW9zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2OTMyNA==", "bodyText": "not sure how we ended up here having a test without any assertions :)", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5182#discussion_r373669324", "createdAt": "2020-01-31T20:22:37Z", "author": {"login": "amakhrov"}, "path": "modules/openapi-generator/src/test/java/org/openapitools/codegen/DefaultCodegenTest.java", "diffHunk": "@@ -528,9 +528,31 @@ public void testAllOfRequired() {\n         Schema child = openAPI.getComponents().getSchemas().get(\"clubForCreation\");\n         codegen.setOpenAPI(openAPI);\n         CodegenModel childModel = codegen.fromModel(\"clubForCreation\", child);\n-        showVars(childModel);\n+        Assert.assertEquals(getRequiredVars(childModel), Collections.singletonList(\"name\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce65af478ab209aa7279771c74f79a4888116219"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyMDUwNzAz", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5182#pullrequestreview-352050703", "createdAt": "2020-02-03T07:03:55Z", "commit": {"oid": "ce65af478ab209aa7279771c74f79a4888116219"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNzowMzo1NlrOFkn39w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QwNzowMzo1NlrOFkn39w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk0NjM1OQ==", "bodyText": "is the comment above still valid?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5182#discussion_r373946359", "createdAt": "2020-02-03T07:03:56Z", "author": {"login": "macjohnny"}, "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/utils/ModelUtils.java", "diffHunk": "@@ -996,13 +997,20 @@ public static String getParentName(ComposedSchema composedSchema, Map<String, Sc\n                     } else {\n                         LOGGER.debug(\"Not a parent since discriminator.propertyName is not set {}\", s.get$ref());\n                         // not a parent since discriminator.propertyName is not set\n+                        refedParentNames.add(parentName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce65af478ab209aa7279771c74f79a4888116219"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c47fa561de3d967cc31a1dbcba37ca053c581a7", "author": {"user": {"login": "amakhrov", "name": "Alexey Makhrov"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/2c47fa561de3d967cc31a1dbcba37ca053c581a7", "committedDate": "2020-02-06T16:27:51Z", "message": "Add real assertions in DefaultCodegenTest.java testAllOfXXX methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69e168a416426124cd338e0e4424cc3e977ed6b4", "author": {"user": {"login": "amakhrov", "name": "Alexey Makhrov"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/69e168a416426124cd338e0e4424cc3e977ed6b4", "committedDate": "2020-02-06T16:27:51Z", "message": "Add test to DefaultCodegenTest for an allOf composition with a single ref and no own props"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "167388560e528b9f3d6f0114f7cf4629833a5e38", "author": {"user": {"login": "amakhrov", "name": "Alexey Makhrov"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/167388560e528b9f3d6f0114f7cf4629833a5e38", "committedDate": "2020-02-06T16:27:51Z", "message": "Ensure model.parent is also added to model.allParents when multipleInheritance is supported"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b25bfebf84d1685978da4379d8313653737b6542", "author": {"user": {"login": "amakhrov", "name": "Alexey Makhrov"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/b25bfebf84d1685978da4379d8313653737b6542", "committedDate": "2020-02-06T16:31:26Z", "message": "Cleanup: remove LOGGER.debug, renamed refedParentNames to refedWithoutDiscriminator"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3bb637f34a737bc4c3b681d1ab79901424c92b50", "author": {"user": {"login": "amakhrov", "name": "Alexey Makhrov"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/3bb637f34a737bc4c3b681d1ab79901424c92b50", "committedDate": "2020-02-04T05:35:24Z", "message": "Cleanup: remove LOGGER.debug, renamed refedParentNames to refedWithoutDiscriminator"}, "afterCommit": {"oid": "b25bfebf84d1685978da4379d8313653737b6542", "author": {"user": {"login": "amakhrov", "name": "Alexey Makhrov"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/b25bfebf84d1685978da4379d8313653737b6542", "committedDate": "2020-02-06T16:31:26Z", "message": "Cleanup: remove LOGGER.debug, renamed refedParentNames to refedWithoutDiscriminator"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2913, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}