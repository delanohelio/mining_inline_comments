{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyOTY3NjQ5", "number": 7842, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjo0Mzo0OFrOEzxuSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjo0NDo1M1rOEzxvrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNzI3NDk2OnYy", "diffSide": "LEFT", "path": "modules/openapi-generator/src/main/resources/ruby-client/api_client_faraday_partial.mustache", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjo0Mzo0OFrOHrNbOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjo0Mzo0OFrOHrNbOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA3MDc3OQ==", "bodyText": "Does not process this block.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7842#discussion_r515070779", "createdAt": "2020-10-30T12:43:48Z", "author": {"login": "tsuwatch"}, "path": "modules/openapi-generator/src/main/resources/ruby-client/api_client_faraday_partial.mustache", "diffHunk": "@@ -128,40 +128,11 @@\n       data\n     end\n \n-    # Save response body into a file in (the defined) temporary folder, using the filename\n-    # from the \"Content-Disposition\" header if provided, otherwise a random filename.\n-    # The response body is written to the file in chunks in order to handle files which\n-    # size is larger than maximum Ruby String or even larger than the maximum memory a Ruby\n-    # process can use.\n-    #\n-    # @see Configuration#temp_folder_path\n     def download_file(request)\n-      tempfile = nil\n-      encoding = nil\n-      request.headers do |response|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c7e150323a68aee8e7cd72c8f5ccb9a20d8ed4"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNzI3NTU0OnYy", "diffSide": "LEFT", "path": "modules/openapi-generator/src/main/resources/ruby-client/api_client_faraday_partial.mustache", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjo0NDowMFrOHrNbng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMzowMDoyM1rOHrN8RQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA3MDg3OA==", "bodyText": "@tsuwatch thanks for the PR. Would it be possible to keep the filename from the response headers if available?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7842#discussion_r515070878", "createdAt": "2020-10-30T12:44:00Z", "author": {"login": "wing328"}, "path": "modules/openapi-generator/src/main/resources/ruby-client/api_client_faraday_partial.mustache", "diffHunk": "@@ -128,40 +128,11 @@\n       data\n     end\n \n-    # Save response body into a file in (the defined) temporary folder, using the filename\n-    # from the \"Content-Disposition\" header if provided, otherwise a random filename.\n-    # The response body is written to the file in chunks in order to handle files which\n-    # size is larger than maximum Ruby String or even larger than the maximum memory a Ruby\n-    # process can use.\n-    #\n-    # @see Configuration#temp_folder_path\n     def download_file(request)\n-      tempfile = nil\n-      encoding = nil\n-      request.headers do |response|\n-        content_disposition = response.headers['Content-Disposition']\n-        if content_disposition && content_disposition =~ /filename=/i\n-          filename = content_disposition[/filename=['\"]?([^'\"\\s]+)['\"]?/, 1]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c7e150323a68aee8e7cd72c8f5ccb9a20d8ed4"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA3OTIzNw==", "bodyText": "did it.\n3e3ea88", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7842#discussion_r515079237", "createdAt": "2020-10-30T13:00:23Z", "author": {"login": "tsuwatch"}, "path": "modules/openapi-generator/src/main/resources/ruby-client/api_client_faraday_partial.mustache", "diffHunk": "@@ -128,40 +128,11 @@\n       data\n     end\n \n-    # Save response body into a file in (the defined) temporary folder, using the filename\n-    # from the \"Content-Disposition\" header if provided, otherwise a random filename.\n-    # The response body is written to the file in chunks in order to handle files which\n-    # size is larger than maximum Ruby String or even larger than the maximum memory a Ruby\n-    # process can use.\n-    #\n-    # @see Configuration#temp_folder_path\n     def download_file(request)\n-      tempfile = nil\n-      encoding = nil\n-      request.headers do |response|\n-        content_disposition = response.headers['Content-Disposition']\n-        if content_disposition && content_disposition =~ /filename=/i\n-          filename = content_disposition[/filename=['\"]?([^'\"\\s]+)['\"]?/, 1]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA3MDg3OA=="}, "originalCommit": {"oid": "d5c7e150323a68aee8e7cd72c8f5ccb9a20d8ed4"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNzI3ODUyOnYy", "diffSide": "RIGHT", "path": "samples/client/petstore/ruby-faraday/lib/petstore/api_client.rb", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjo0NDo1M1rOHrNdTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxMjo0NTowOVrOHrNd6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA3MTMwOQ==", "bodyText": "@stream is array", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7842#discussion_r515071309", "createdAt": "2020-10-30T12:44:53Z", "author": {"login": "tsuwatch"}, "path": "samples/client/petstore/ruby-faraday/lib/petstore/api_client.rb", "diffHunk": "@@ -232,7 +203,8 @@ def deserialize(response, return_type)\n       # handle file downloading - return the File instance processed in request callbacks\n       # note that response body is empty when the file is written in chunks in request on_body callback\n       if return_type == 'File'\n-        @tempfile.write(@stream)\n+        @tempfile = Tempfile.open('download-', @config.temp_folder_path, encoding: body.encoding)\n+        @tempfile.write(@stream.join.force_encoding(body.encoding))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c7e150323a68aee8e7cd72c8f5ccb9a20d8ed4"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA3MTQ2NQ==", "bodyText": "Need to force_encoding", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7842#discussion_r515071465", "createdAt": "2020-10-30T12:45:09Z", "author": {"login": "tsuwatch"}, "path": "samples/client/petstore/ruby-faraday/lib/petstore/api_client.rb", "diffHunk": "@@ -232,7 +203,8 @@ def deserialize(response, return_type)\n       # handle file downloading - return the File instance processed in request callbacks\n       # note that response body is empty when the file is written in chunks in request on_body callback\n       if return_type == 'File'\n-        @tempfile.write(@stream)\n+        @tempfile = Tempfile.open('download-', @config.temp_folder_path, encoding: body.encoding)\n+        @tempfile.write(@stream.join.force_encoding(body.encoding))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTA3MTMwOQ=="}, "originalCommit": {"oid": "d5c7e150323a68aee8e7cd72c8f5ccb9a20d8ed4"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4064, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}