{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5ODcwNjkx", "number": 6956, "title": "[Java][jersey2] Fix `serializeToString`", "bodyText": "To fix #6954\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project beforehand.\n Run the shell script ./bin/generate-samples.shto update all Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit as it would merge with master. These must match the expectations made by your contribution. You may regenerate an individual generator by passing the relevant config(s) as an argument to the script, for example ./bin/generate-samples.sh bin/config/java*. For Windows users, please run the script in Git BASH.\n File the PR against the correct branch: master\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.\n\ncc @bbdouglas (2017/07) @sreeshas (2017/08) @jfiala (2017/08) @lukoyanov (2017/09) @cbornet (2017/09) @jeff9finger (2018/01) @karismann (2019/03) @Zomzog (2019/04) @lwlee2608 (2019/10) @bkabrda (2020/01)", "createdAt": "2020-07-16T03:30:54Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6956", "merged": true, "mergeCommit": {"oid": "9899315aab8d5a823898479b9ecc6405c7533acd"}, "closed": true, "closedAt": "2020-07-23T02:39:05Z", "author": {"login": "wing328"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1WZxoAH2gAyNDQ5ODcwNjkxOmEwZTYyN2E3Mjk3MjFiZmJkZmYzNjM2MDEyNjRhOTc5ODYwOTdkNTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1hCWRAH2gAyNDQ5ODcwNjkxOmQxMGI3M2RhNTM0ZmQwNzRlMjcwM2QxMzg2Njg1YTE1MTJlMDMxNmM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a0e627a729721bfbdff363601264a97986097d55", "author": {"user": {"login": "wing328", "name": "William Cheng"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/a0e627a729721bfbdff363601264a97986097d55", "committedDate": "2020-07-16T03:10:08Z", "message": "fix empty get body in serializeToString, add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ad472b4ff3deac6751dbe02f3f0a0630400fecf", "author": {"user": {"login": "wing328", "name": "William Cheng"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/7ad472b4ff3deac6751dbe02f3f0a0630400fecf", "committedDate": "2020-07-16T03:10:34Z", "message": "add new file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bd6419dfc05b0ec40bb35acc18f2c0b05c48f71", "author": {"user": {"login": "wing328", "name": "William Cheng"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/5bd6419dfc05b0ec40bb35acc18f2c0b05c48f71", "committedDate": "2020-07-16T06:53:13Z", "message": "Merge remote-tracking branch 'origin/master' into fix-jersey2-serializetostring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfe97a54fef276200cf427501d5cb8d7fbd01e17", "author": {"user": {"login": "wing328", "name": "William Cheng"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/cfe97a54fef276200cf427501d5cb8d7fbd01e17", "committedDate": "2020-07-16T07:49:19Z", "message": "fix serialize to better handle null string"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5OTMzMDk1", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6956#pullrequestreview-449933095", "createdAt": "2020-07-16T14:57:37Z", "commit": {"oid": "cfe97a54fef276200cf427501d5cb8d7fbd01e17"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDo1NzozN1rOGyu_eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDo1NzozN1rOGyu_eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg1MTg5OA==", "bodyText": "Did you mean\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // nullable string \"string\" should give \"\\\"null\\\"\"\n          \n          \n            \n                    // nullable string \"null\" should give \"\\\"null\\\"\"", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6956#discussion_r455851898", "createdAt": "2020-07-16T14:57:37Z", "author": {"login": "sebastien-rosset"}, "path": "samples/openapi3/client/petstore/java/jersey2-java8/src/test/java/org/openapitools/client/ApiClientTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package org.openapitools.client;\n+\n+import org.openapitools.client.model.*;\n+import org.openapitools.client.ApiClient;\n+\n+import java.lang.Exception;\n+import java.util.Arrays;\n+import java.util.Date;\n+import java.util.TimeZone;\n+import java.text.SimpleDateFormat;\n+import java.time.OffsetDateTime;\n+import java.time.ZoneId;\n+import java.time.format.DateTimeFormatter;\n+import org.junit.*;\n+import static org.junit.Assert.*;\n+\n+public class ApiClientTest {\n+    ApiClient apiClient = null;\n+    Pet pet = null;\n+\n+    @Before\n+    public void setup() {\n+        apiClient = new ApiClient();\n+        pet = new Pet();\n+    }\n+\n+    @Test\n+    public void testSerializeToString() throws Exception {\n+        Long petId = 4321L;\n+        pet.setId(petId);\n+        pet.setName(\"jersey2 java8 pet\");\n+        Category category = new Category();\n+        category.setId(petId);\n+        category.setName(\"jersey2 java8 category\");\n+        pet.setCategory(category);\n+        pet.setStatus(Pet.StatusEnum.AVAILABLE);\n+        pet.setPhotoUrls(Arrays.asList(\"A\", \"B\", \"C\"));\n+        Tag tag = new Tag();\n+        tag.setId(petId);\n+        tag.setName(\"jersey2 java8 tag\");\n+        pet.setTags(Arrays.asList(tag));\n+\n+        String result = \"{\\\"id\\\":4321,\\\"category\\\":{\\\"id\\\":4321,\\\"name\\\":\\\"jersey2 java8 category\\\"},\\\"name\\\":\\\"jersey2 java8 pet\\\",\\\"photoUrls\\\":[\\\"A\\\",\\\"B\\\",\\\"C\\\"],\\\"tags\\\":[{\\\"id\\\":4321,\\\"name\\\":\\\"jersey2 java8 tag\\\"}],\\\"status\\\":\\\"available\\\"}\";\n+        assertEquals(result, apiClient.serializeToString(pet, null, \"application/json\", false));\n+        // nulllable and there should be no diffencne as the payload is not null\n+        assertEquals(result, apiClient.serializeToString(pet, null, \"application/json\", true));\n+\n+        // non-nullable null object should give \"\" (empty body)\n+        assertEquals(\"\", apiClient.serializeToString(null, null, \"application/json\", false));\n+        // nullable null object should give \"null\"\n+        assertEquals(\"null\", apiClient.serializeToString(null, null, \"application/json\", true));\n+\n+        // non-nullable empty string should give \"\\\"\\\"\" (empty json string)\n+        assertEquals(\"\\\"\\\"\", apiClient.serializeToString(\"\", null, \"application/json\", false));\n+        // nullable null empty string should give \"\\\"\\\"\" (empty json string)\n+        assertEquals(\"\\\"\\\"\", apiClient.serializeToString(\"\", null, \"application/json\", true));\n+\n+        // non-nullable string \"null\"  should give \"\\\"null\\\"\"\n+        assertEquals(\"\\\"null\\\"\", apiClient.serializeToString(\"null\", null, \"application/json\", false));\n+        // nullable string \"string\" should give \"\\\"null\\\"\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cfe97a54fef276200cf427501d5cb8d7fbd01e17"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5OTM0ODU2", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6956#pullrequestreview-449934856", "createdAt": "2020-07-16T14:59:23Z", "commit": {"oid": "cfe97a54fef276200cf427501d5cb8d7fbd01e17"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDo1OToyM1rOGyvErg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDo1OToyM1rOGyvErg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg1MzIzMA==", "bodyText": "Did you mean?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // nullable null empty string should give \"\\\"\\\"\" (empty json string)\n          \n          \n            \n                    // nullable empty string should give \"\\\"\\\"\" (empty json string)", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6956#discussion_r455853230", "createdAt": "2020-07-16T14:59:23Z", "author": {"login": "sebastien-rosset"}, "path": "samples/openapi3/client/petstore/java/jersey2-java8/src/test/java/org/openapitools/client/ApiClientTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package org.openapitools.client;\n+\n+import org.openapitools.client.model.*;\n+import org.openapitools.client.ApiClient;\n+\n+import java.lang.Exception;\n+import java.util.Arrays;\n+import java.util.Date;\n+import java.util.TimeZone;\n+import java.text.SimpleDateFormat;\n+import java.time.OffsetDateTime;\n+import java.time.ZoneId;\n+import java.time.format.DateTimeFormatter;\n+import org.junit.*;\n+import static org.junit.Assert.*;\n+\n+public class ApiClientTest {\n+    ApiClient apiClient = null;\n+    Pet pet = null;\n+\n+    @Before\n+    public void setup() {\n+        apiClient = new ApiClient();\n+        pet = new Pet();\n+    }\n+\n+    @Test\n+    public void testSerializeToString() throws Exception {\n+        Long petId = 4321L;\n+        pet.setId(petId);\n+        pet.setName(\"jersey2 java8 pet\");\n+        Category category = new Category();\n+        category.setId(petId);\n+        category.setName(\"jersey2 java8 category\");\n+        pet.setCategory(category);\n+        pet.setStatus(Pet.StatusEnum.AVAILABLE);\n+        pet.setPhotoUrls(Arrays.asList(\"A\", \"B\", \"C\"));\n+        Tag tag = new Tag();\n+        tag.setId(petId);\n+        tag.setName(\"jersey2 java8 tag\");\n+        pet.setTags(Arrays.asList(tag));\n+\n+        String result = \"{\\\"id\\\":4321,\\\"category\\\":{\\\"id\\\":4321,\\\"name\\\":\\\"jersey2 java8 category\\\"},\\\"name\\\":\\\"jersey2 java8 pet\\\",\\\"photoUrls\\\":[\\\"A\\\",\\\"B\\\",\\\"C\\\"],\\\"tags\\\":[{\\\"id\\\":4321,\\\"name\\\":\\\"jersey2 java8 tag\\\"}],\\\"status\\\":\\\"available\\\"}\";\n+        assertEquals(result, apiClient.serializeToString(pet, null, \"application/json\", false));\n+        // nulllable and there should be no diffencne as the payload is not null\n+        assertEquals(result, apiClient.serializeToString(pet, null, \"application/json\", true));\n+\n+        // non-nullable null object should give \"\" (empty body)\n+        assertEquals(\"\", apiClient.serializeToString(null, null, \"application/json\", false));\n+        // nullable null object should give \"null\"\n+        assertEquals(\"null\", apiClient.serializeToString(null, null, \"application/json\", true));\n+\n+        // non-nullable empty string should give \"\\\"\\\"\" (empty json string)\n+        assertEquals(\"\\\"\\\"\", apiClient.serializeToString(\"\", null, \"application/json\", false));\n+        // nullable null empty string should give \"\\\"\\\"\" (empty json string)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cfe97a54fef276200cf427501d5cb8d7fbd01e17"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5OTM4OTMy", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6956#pullrequestreview-449938932", "createdAt": "2020-07-16T15:03:36Z", "commit": {"oid": "cfe97a54fef276200cf427501d5cb8d7fbd01e17"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTowMzozNlrOGyvQ1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTowMzozNlrOGyvQ1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg1NjM0Mg==", "bodyText": "I think this use case is non trivial to understand because there may be two variants:\n\nThe request is supposed to have an empty body by design, i.e. the OpenAPI doc request or response schema indicates the body is empty.\nThe client or server is setting the data incorrectly. I.e. the OpenAPI doc indicates the object is not nullable, but the actually either the client or server are setting to a null value.\n\nIs it even possible?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6956#discussion_r455856342", "createdAt": "2020-07-16T15:03:36Z", "author": {"login": "sebastien-rosset"}, "path": "samples/openapi3/client/petstore/java/jersey2-java8/src/test/java/org/openapitools/client/ApiClientTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package org.openapitools.client;\n+\n+import org.openapitools.client.model.*;\n+import org.openapitools.client.ApiClient;\n+\n+import java.lang.Exception;\n+import java.util.Arrays;\n+import java.util.Date;\n+import java.util.TimeZone;\n+import java.text.SimpleDateFormat;\n+import java.time.OffsetDateTime;\n+import java.time.ZoneId;\n+import java.time.format.DateTimeFormatter;\n+import org.junit.*;\n+import static org.junit.Assert.*;\n+\n+public class ApiClientTest {\n+    ApiClient apiClient = null;\n+    Pet pet = null;\n+\n+    @Before\n+    public void setup() {\n+        apiClient = new ApiClient();\n+        pet = new Pet();\n+    }\n+\n+    @Test\n+    public void testSerializeToString() throws Exception {\n+        Long petId = 4321L;\n+        pet.setId(petId);\n+        pet.setName(\"jersey2 java8 pet\");\n+        Category category = new Category();\n+        category.setId(petId);\n+        category.setName(\"jersey2 java8 category\");\n+        pet.setCategory(category);\n+        pet.setStatus(Pet.StatusEnum.AVAILABLE);\n+        pet.setPhotoUrls(Arrays.asList(\"A\", \"B\", \"C\"));\n+        Tag tag = new Tag();\n+        tag.setId(petId);\n+        tag.setName(\"jersey2 java8 tag\");\n+        pet.setTags(Arrays.asList(tag));\n+\n+        String result = \"{\\\"id\\\":4321,\\\"category\\\":{\\\"id\\\":4321,\\\"name\\\":\\\"jersey2 java8 category\\\"},\\\"name\\\":\\\"jersey2 java8 pet\\\",\\\"photoUrls\\\":[\\\"A\\\",\\\"B\\\",\\\"C\\\"],\\\"tags\\\":[{\\\"id\\\":4321,\\\"name\\\":\\\"jersey2 java8 tag\\\"}],\\\"status\\\":\\\"available\\\"}\";\n+        assertEquals(result, apiClient.serializeToString(pet, null, \"application/json\", false));\n+        // nulllable and there should be no diffencne as the payload is not null\n+        assertEquals(result, apiClient.serializeToString(pet, null, \"application/json\", true));\n+\n+        // non-nullable null object should give \"\" (empty body)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cfe97a54fef276200cf427501d5cb8d7fbd01e17"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d10b73da534fd074e2703d1386685a1512e0316c", "author": {"user": {"login": "wing328", "name": "William Cheng"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/d10b73da534fd074e2703d1386685a1512e0316c", "committedDate": "2020-07-16T15:33:30Z", "message": "update test comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3390, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}