{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMTIxMTQ3", "number": 7647, "title": "[Fix/Dart2] Resolve an exception with status 204 and no body.", "bodyText": "This resolves a problem in API client when a remote server returns no body with a status code of 204 (default behavior according to the spec.)\n@ircecho (2017/07) @swipesight (2018/09) @jaumard (2018/09) @athornz (2019/12) @amondnet (2019/12) @wing328 @sbu-WBT @agilob\n\n\n Read the contribution guidelines.\n Pull Request title clearly describes the work in the pull request and Pull Request description provides details about how to validate the work. Missing information here may result in delayed response from the community.\n If contributing template-only or documentation-only changes which will change sample output, build the project beforehand.\n Run the shell script ./bin/generate-samples.shto update all Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit as it would merge with master. These must match the expectations made by your contribution. You may regenerate an individual generator by passing the relevant config(s) as an argument to the script, for example ./bin/generate-samples.sh bin/configs/java*. For Windows users, please run the script in Git BASH.\n File the PR against the correct branch: master\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.", "createdAt": "2020-10-11T11:17:39Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647", "merged": true, "mergeCommit": {"oid": "3c869d5b12595dba739a6c9168f63f9e6c655969"}, "closed": true, "closedAt": "2020-10-13T15:30:49Z", "author": {"login": "noordawod"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRdfMaAH2gAyNTAxMTIxMTQ3OjMyMjc4ZWYwZTAxOGU5N2E5YjY4ZmY1Y2QzNmQ4ZjU5NWRiZDY1MGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSDPpugFqTUwNzEzMTI0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "32278ef0e018e97a9b68ff5cd36d8f595dbd650c", "author": {"user": {"login": "noordawod", "name": "Noor Dawod"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/32278ef0e018e97a9b68ff5cd36d8f595dbd650c", "committedDate": "2020-10-11T11:15:16Z", "message": "Resolve an exception situation when a remote server returns 204 with no body."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dd786749fecfda62a1bea1dd238c6aeb7792941", "author": {"user": {"login": "noordawod", "name": "Noor Dawod"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/3dd786749fecfda62a1bea1dd238c6aeb7792941", "committedDate": "2020-10-11T11:25:36Z", "message": "Only return a value when needed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MTcwNjY0", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#pullrequestreview-506170664", "createdAt": "2020-10-11T11:35:08Z", "commit": {"oid": "32278ef0e018e97a9b68ff5cd36d8f595dbd650c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMTozNTowOFrOHfmy8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMTozNzoyMFrOHfmz1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkwMzUzNw==", "bodyText": "lol you like yoga syntax \ud83d\ude06\ncan we put the 204 in a const variable with proper name instead creating a magic number?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r502903537", "createdAt": "2020-10-11T11:35:08Z", "author": {"login": "agilob"}, "path": "modules/openapi-generator/src/main/resources/dart2/api.mustache", "diffHunk": "@@ -165,7 +165,12 @@ class {{{classname}}} {\n     if (response.statusCode >= 400) {\n       throw ApiException(response.statusCode, _decodeBodyBytes(response));\n     }\n-    if (response.body != null) {\n+\n+    // When a remote server returns no body with a status of 204, we shall not decode it.\n+    // At the time of writing this, `dart:convert` will throw an \"Unexpected end of input\"\n+    // FormatException when trying to decode an empty string.\n+    final responseBody = response.body;\n+    if (responseBody != null && (responseBody.isNotEmpty || 204 != response.statusCode)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32278ef0e018e97a9b68ff5cd36d8f595dbd650c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkwMzc2NQ==", "bodyText": "or even better, an interface/class with such magic numbers we can refer to in the future\nclass HttpCodes {\nint NO_BODY = 204;\n}\nThat's probably more effort than you were aiming here, but I feel it would be an investment into code quality for future.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r502903765", "createdAt": "2020-10-11T11:37:20Z", "author": {"login": "agilob"}, "path": "modules/openapi-generator/src/main/resources/dart2/api.mustache", "diffHunk": "@@ -165,7 +165,12 @@ class {{{classname}}} {\n     if (response.statusCode >= 400) {\n       throw ApiException(response.statusCode, _decodeBodyBytes(response));\n     }\n-    if (response.body != null) {\n+\n+    // When a remote server returns no body with a status of 204, we shall not decode it.\n+    // At the time of writing this, `dart:convert` will throw an \"Unexpected end of input\"\n+    // FormatException when trying to decode an empty string.\n+    final responseBody = response.body;\n+    if (responseBody != null && (responseBody.isNotEmpty || 204 != response.statusCode)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkwMzUzNw=="}, "originalCommit": {"oid": "32278ef0e018e97a9b68ff5cd36d8f595dbd650c"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d52cdff614cdb66b4fcf80f2d5f905959a60cb42", "author": {"user": {"login": "noordawod", "name": "Noor Dawod"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/d52cdff614cdb66b4fcf80f2d5f905959a60cb42", "committedDate": "2020-10-11T14:42:11Z", "message": "Use HttpStatus codes instead of magic numbers."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6464d7ad43383c42e8b436ea3b41143c54ff4c9a", "author": {"user": {"login": "noordawod", "name": "Noor Dawod"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/6464d7ad43383c42e8b436ea3b41143c54ff4c9a", "committedDate": "2020-10-11T15:29:29Z", "message": "Drop checking for a body as it will consume too much memory."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MjA3MzE3", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#pullrequestreview-506207317", "createdAt": "2020-10-11T19:01:12Z", "commit": {"oid": "6464d7ad43383c42e8b436ea3b41143c54ff4c9a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxOTowMToxMlrOHfp0PA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxOTowMToxMlrOHfp0PA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1MzAyMA==", "bodyText": "This is getting complex fast", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r502953020", "createdAt": "2020-10-11T19:01:12Z", "author": {"login": "agilob"}, "path": "samples/client/petstore/dart2/petstore_client_lib/lib/api_helper.dart", "diffHunk": "@@ -56,6 +56,6 @@ String parameterToString(dynamic value) {\n String _decodeBodyBytes(Response response) {\n   final contentType = response.headers['content-type'];\n   return contentType != null && contentType.contains('application/json')\n-    ? utf8.decode(response.bodyBytes)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6464d7ad43383c42e8b436ea3b41143c54ff4c9a"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e974a7da05062a87530e217cc347dafddab6cf0", "author": {"user": {"login": "noordawod", "name": "Noor Dawod"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/2e974a7da05062a87530e217cc347dafddab6cf0", "committedDate": "2020-10-12T05:14:28Z", "message": "Merge branch 'master' into bugfix/dart2-status-204"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "529eea759811ebc25b8077b94f20419e7cd94095", "author": {"user": {"login": "noordawod", "name": "Noor Dawod"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/529eea759811ebc25b8077b94f20419e7cd94095", "committedDate": "2020-10-12T06:11:37Z", "message": "Cosmetic changes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4c92d5a1816abd286a76ae71977af42e4fb5ae0", "author": {"user": {"login": "noordawod", "name": "Noor Dawod"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/d4c92d5a1816abd286a76ae71977af42e4fb5ae0", "committedDate": "2020-10-12T19:05:41Z", "message": "Merge branch 'master' into bugfix/dart2-status-204"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a992d7ccbceed25769731fb326f2e6c771707b0", "author": {"user": {"login": "noordawod", "name": "Noor Dawod"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/9a992d7ccbceed25769731fb326f2e6c771707b0", "committedDate": "2020-10-13T06:12:41Z", "message": "Merge branch 'master' into bugfix/dart2-status-204"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MTMxMjQ0", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#pullrequestreview-507131244", "createdAt": "2020-10-13T07:14:41Z", "commit": {"oid": "9a992d7ccbceed25769731fb326f2e6c771707b0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3098, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}