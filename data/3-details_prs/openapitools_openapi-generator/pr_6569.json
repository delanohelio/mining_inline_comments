{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4NjMzNzM5", "number": 6569, "title": "[python-client] Enable per-request auth settings", "bodyText": "Fixes #6565\nThe changes are backward compatible with existing wiring since we're only adding optional keyword arguments.\nPlease forgive me if I've missed something in the contributing guidelines.\n@taxpon @frol @mbohlool @cbornet @kenjones-cisco @tomplus @Jyhess @arun-nalla @spacether\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project before.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.", "createdAt": "2020-06-05T18:06:47Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6569", "merged": true, "mergeCommit": {"oid": "933ab0640add0a4430c6a1c5b7fdb8824df6d381"}, "closed": true, "closedAt": "2020-06-11T06:40:11Z", "author": {"login": "warrengray"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoZZhCgBqjM0MTMzMTQ5NTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqIbWegFqTQyODYzMDM0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea153f7f1e3e38e4656527cc1178902d5caef3ed", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/ea153f7f1e3e38e4656527cc1178902d5caef3ed", "committedDate": "2020-06-05T18:57:34Z", "message": "Add missing comma...."}, "afterCommit": {"oid": "f0229a67fd8d662728d8ccdee749f89d895bf12f", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f0229a67fd8d662728d8ccdee749f89d895bf12f", "committedDate": "2020-06-05T21:18:10Z", "message": "Enable per-request access token in Python client."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MjAwMjA0", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6569#pullrequestreview-428200204", "createdAt": "2020-06-10T15:55:21Z", "commit": {"oid": "8c1c200a604be39a0fb671eefdc634ff01d92fa7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNTo1NToyMVrOGh7l9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNTo1NToyMVrOGh7l9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODIzMjU2NA==", "bodyText": "When request_auth is passed in, this will loop through n times where n is the number of keys in auth_settings and:\n\nupdate auth for the same request_auth\nif request_auth is is in query, it will append n instances of the same auth info into the query, which is not what we desire\n\nNote: endpoints can have multiple auth settings set at one time.\nWhat should your solution do in that case?\nHow about instead requiring that the request_auth that you are passing in looks like:\nConfiguration.auth_settings()\nthat way we can call it like:\nauth_setting = request_auth.get(auth) or self.configuration.auth_settings().get(auth)\n\nAnd request_auth would look like:\n{\n    'http_basic_test':\n            'in': 'header',\n            'key': 'Authorization',\n            'value': 'Prefix ANOTHER_TOKEN'\n        }\n}\n\nOr if you want to keep the shape of request_auth as-is, how about changing the line 653 for loop to only run once when request_auth is passed in, and to only use request_auth?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6569#discussion_r438232564", "createdAt": "2020-06-10T15:55:21Z", "author": {"login": "spacether"}, "path": "modules/openapi-generator/src/main/resources/python/api_client.mustache", "diffHunk": "@@ -550,18 +559,21 @@ class ApiClient(object):\n         else:\n             return content_types[0]\n \n-    def update_params_for_auth(self, headers, querys, auth_settings):\n+    def update_params_for_auth(self, headers, querys, auth_settings,\n+                               request_auth=None):\n         \"\"\"Updates header and query params based on authentication setting.\n \n         :param headers: Header parameters dict to be updated.\n         :param querys: Query parameters tuple list to be updated.\n         :param auth_settings: Authentication setting identifiers list.\n+        :param request_auth: if set, the provided settings will\n+                             override the token in the configuration.\n         \"\"\"\n         if not auth_settings:\n             return\n \n         for auth in auth_settings:\n-            auth_setting = self.configuration.auth_settings().get(auth)\n+            auth_setting = request_auth or self.configuration.auth_settings().get(auth)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c1c200a604be39a0fb671eefdc634ff01d92fa7"}, "originalPosition": 81}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MjAyNjM2", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6569#pullrequestreview-428202636", "createdAt": "2020-06-10T15:57:48Z", "commit": {"oid": "8c1c200a604be39a0fb671eefdc634ff01d92fa7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9e5fc22b6c84d0d6398522c095966a105405c2c", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/a9e5fc22b6c84d0d6398522c095966a105405c2c", "committedDate": "2020-06-10T16:57:42Z", "message": "Update api_client.mustache so that request_auth overrides all other auth settings when specified."}, "afterCommit": {"oid": "4a4b7dd60f358c9fa87c51a25a866a4dfaf7e41e", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/4a4b7dd60f358c9fa87c51a25a866a4dfaf7e41e", "committedDate": "2020-06-10T17:10:29Z", "message": "Update api_client.mustache so that request_auth overrides all other auth settings when specified."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17fda855dc80c1c548339b1396e06b3c9627a856", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/17fda855dc80c1c548339b1396e06b3c9627a856", "committedDate": "2020-06-10T18:47:05Z", "message": "Enable per-request access token in Python client."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5cef78474ef7fa67eaccdf05c4fad8263e91787", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/a5cef78474ef7fa67eaccdf05c4fad8263e91787", "committedDate": "2020-06-10T18:47:06Z", "message": "Add missing regenerated sample files."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7332bd69b5fe9cece524301c866231085e0f15f2", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/7332bd69b5fe9cece524301c866231085e0f15f2", "committedDate": "2020-06-10T18:47:07Z", "message": "Rework to the more general case of overriding the auth settings for a request."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b520693a05bc9cba3a7c1803d3674253a22c231", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/0b520693a05bc9cba3a7c1803d3674253a22c231", "committedDate": "2020-06-10T18:47:08Z", "message": "Add unit tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8a76720cbeec1301d2344df88beb0ec652e96e8", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/a8a76720cbeec1301d2344df88beb0ec652e96e8", "committedDate": "2020-06-10T18:47:09Z", "message": "Update api_client.mustache so that request_auth overrides all other auth settings when specified."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a4b7dd60f358c9fa87c51a25a866a4dfaf7e41e", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/4a4b7dd60f358c9fa87c51a25a866a4dfaf7e41e", "committedDate": "2020-06-10T17:10:29Z", "message": "Update api_client.mustache so that request_auth overrides all other auth settings when specified."}, "afterCommit": {"oid": "a8a76720cbeec1301d2344df88beb0ec652e96e8", "author": {"user": {"login": "warrengray", "name": "Warren Gray"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/a8a76720cbeec1301d2344df88beb0ec652e96e8", "committedDate": "2020-06-10T18:47:09Z", "message": "Update api_client.mustache so that request_auth overrides all other auth settings when specified."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjMwMzQz", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6569#pullrequestreview-428630343", "createdAt": "2020-06-11T06:40:01Z", "commit": {"oid": "a8a76720cbeec1301d2344df88beb0ec652e96e8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2220, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}