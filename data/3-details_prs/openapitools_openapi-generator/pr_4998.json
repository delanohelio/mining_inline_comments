{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyNzQ1MDcw", "number": 4998, "title": "[java] Support templated servers", "bodyText": "Adds support for multiple templated servers from OpenAPI specification.\nSee related PR for Go: #4635\nAddresses #590\n\nPR checklist\n\n Read the contribution guidelines.\n If contributing template-only or documentation-only changes which will change sample output, build the project before.\n Run the shell script(s) under ./bin/ (or Windows batch scripts under.\\bin\\windows) to update Petstore samples related to your fix. This is important, as CI jobs will verify all generator outputs of your HEAD commit, and these must match the expectations made by your contribution. You only need to run ./bin/{LANG}-petstore.sh, ./bin/openapi3/{LANG}-petstore.sh if updating the code or mustache templates for a language ({LANG}) (e.g. php, ruby, python, etc).\n File the PR against the correct branch: master, 4.3.x, 5.0.x. Default: master.\n Copy the technical committee to review the pull request if your PR is targeting a particular programming language.\n\n\ncc @bbdouglas (2017/07) @sreeshas (2017/08) @jfiala (2017/08) @lukoyanov (2017/09) @cbornet (2017/09) @jeff9finger (2018/01) @karismann (2019/03) @Zomzog (2019/04) @lwlee2608 (2019/10", "createdAt": "2020-01-14T17:07:29Z", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4998", "merged": true, "mergeCommit": {"oid": "a09271e76d088ff2f32c8d5a89e881314d743147"}, "closed": true, "closedAt": "2020-02-19T14:27:46Z", "author": {"login": "jirikuncar"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6ms3WABqjI5NTEwNzI1ODE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcE7JtZgH2gAyMzYyNzQ1MDcwOjYzYTI2YzhkNTQ3ZjA5NTg2NDA5Mzc4NTE5MGYzMmMwYmY4NGIwMjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "847ba8a074a9c7a183e956144ac39ee9cbf27572", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/847ba8a074a9c7a183e956144ac39ee9cbf27572", "committedDate": "2020-01-15T11:06:41Z", "message": "fix type"}, "afterCommit": {"oid": "f1ddc182687ad5ae02a4d45ef3b61c01c6cf730e", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f1ddc182687ad5ae02a4d45ef3b61c01c6cf730e", "committedDate": "2020-01-15T14:47:18Z", "message": "initial"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "594f055ff9191dbb375f846d341218c1b96b66a7", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/594f055ff9191dbb375f846d341218c1b96b66a7", "committedDate": "2020-01-15T16:18:42Z", "message": "[java] Support templated servers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1ddc182687ad5ae02a4d45ef3b61c01c6cf730e", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/f1ddc182687ad5ae02a4d45ef3b61c01c6cf730e", "committedDate": "2020-01-15T14:47:18Z", "message": "initial"}, "afterCommit": {"oid": "594f055ff9191dbb375f846d341218c1b96b66a7", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/594f055ff9191dbb375f846d341218c1b96b66a7", "committedDate": "2020-01-15T16:18:42Z", "message": "[java] Support templated servers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzMzQ3Njc0", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4998#pullrequestreview-343347674", "createdAt": "2020-01-15T16:24:12Z", "commit": {"oid": "f1ddc182687ad5ae02a4d45ef3b61c01c6cf730e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxNjoyNDoxMlrOFd-RAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxNjozNjozMFrOFd-s7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk3MzE4Nw==", "bodyText": "We should probably check that serverIndex is within the length of servers, as it's a user-set value and can be wrong.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4998#discussion_r366973187", "createdAt": "2020-01-15T16:24:12Z", "author": {"login": "bkabrda"}, "path": "modules/openapi-generator/src/main/resources/Java/ApiClient.mustache", "diffHunk": "@@ -626,8 +684,15 @@ public class ApiClient {\n    * @return The full URL\n    */\n   private String buildUrl(String path, List<Pair> queryParams, List<Pair> collectionQueryParams) {\n+    String baseURL;\n+    if (serverIndex != null) {\n+      baseURL = servers[serverIndex].URL(serverVariables);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1ddc182687ad5ae02a4d45ef3b61c01c6cf730e"}, "originalPosition": 102}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk4MDMzMg==", "bodyText": "Maybe we could preserve backwards compatibility here by also keeping the method with its original signature, which would call this new method while passing operation=null?", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4998#discussion_r366980332", "createdAt": "2020-01-15T16:36:30Z", "author": {"login": "bkabrda"}, "path": "modules/openapi-generator/src/main/resources/Java/libraries/jersey2/ApiClient.mustache", "diffHunk": "@@ -684,12 +785,24 @@ public class ApiClient {\n    * @return The response body in type of string\n    * @throws ApiException API exception\n    */\n-  public <T> ApiResponse<T> invokeAPI(String path, String method, List<Pair> queryParams, Object body, Map<String, String> headerParams, Map<String, String> cookieParams, Map<String, Object> formParams, String accept, String contentType, String[] authNames, GenericType<T> returnType) throws ApiException {\n+  public <T> ApiResponse<T> invokeAPI(String operation, String path, String method, List<Pair> queryParams, Object body, Map<String, String> headerParams, Map<String, String> cookieParams, Map<String, Object> formParams, String accept, String contentType, String[] authNames, GenericType<T> returnType) throws ApiException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "594f055ff9191dbb375f846d341218c1b96b66a7"}, "originalPosition": 142}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "807ece0fa5d7293639bc62d8d698c8a4ff00ae22", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/807ece0fa5d7293639bc62d8d698c8a4ff00ae22", "committedDate": "2020-01-15T17:17:40Z", "message": "Deprecate old signature of invokeAPI method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6577bde7638a546f7badc1cf88938a9633fa2e1a", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/6577bde7638a546f7badc1cf88938a9633fa2e1a", "committedDate": "2020-01-15T17:20:29Z", "message": "Regenerated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b93d63ac9b0bc3e5336669a1c49621de601f375", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/5b93d63ac9b0bc3e5336669a1c49621de601f375", "committedDate": "2020-01-16T10:40:54Z", "message": "throw ArrayIndexOutOfBoundsException"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07965b9b78505b663bff0b4fb33baea3639778ab", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/07965b9b78505b663bff0b4fb33baea3639778ab", "committedDate": "2020-01-16T10:56:56Z", "message": "Regenerated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09b84f51db5d85d72f001ad713c02cc9d8cdf46f", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/09b84f51db5d85d72f001ad713c02cc9d8cdf46f", "committedDate": "2020-01-21T16:06:34Z", "message": "Merge branch 'master' into java-client-endpoint-servers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NzU4NzU4", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4998#pullrequestreview-356758758", "createdAt": "2020-02-11T15:36:48Z", "commit": {"oid": "09b84f51db5d85d72f001ad713c02cc9d8cdf46f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNTozNjo0OFrOFoNznA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxNTozNjo0OFrOFoNznA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzcxMzU2NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import com.datadog.api.v1.client.ServerVariable;\n          \n          \n            \n            import {{invokerPackage}}.ServerVariable;", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4998#discussion_r377713564", "createdAt": "2020-02-11T15:36:48Z", "author": {"login": "jirikuncar"}, "path": "modules/openapi-generator/src/main/resources/Java/ServerConfiguration.mustache", "diffHunk": "@@ -0,0 +1,60 @@\n+package {{invokerPackage}};\n+\n+import java.util.Map;\n+\n+import com.datadog.api.v1.client.ServerVariable;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09b84f51db5d85d72f001ad713c02cc9d8cdf46f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edca168d19e1cbca10593e42e21354d1b0521e6c", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/edca168d19e1cbca10593e42e21354d1b0521e6c", "committedDate": "2020-02-11T15:48:13Z", "message": "Update modules/openapi-generator/src/main/resources/Java/ServerConfiguration.mustache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d98c7ddfef44a28f5967649173383e810123ccca", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/d98c7ddfef44a28f5967649173383e810123ccca", "committedDate": "2020-02-11T15:51:42Z", "message": "Regenerated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "63219abd9754a3b10ca2a1b28f06e4247c124167", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/63219abd9754a3b10ca2a1b28f06e4247c124167", "committedDate": "2020-02-11T15:37:23Z", "message": "Update modules/openapi-generator/src/main/resources/Java/ServerConfiguration.mustache"}, "afterCommit": {"oid": "d98c7ddfef44a28f5967649173383e810123ccca", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/d98c7ddfef44a28f5967649173383e810123ccca", "committedDate": "2020-02-11T15:51:42Z", "message": "Regenerated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe93888056dee60cdbe465e607c1453ab75f561b", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/fe93888056dee60cdbe465e607c1453ab75f561b", "committedDate": "2020-02-12T09:16:00Z", "message": "Merge remote-tracking branch 'upstream/master' into java-client-endpoint-servers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0b1cfec3fc448a6f67744c208f18879d10ba5d8", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/b0b1cfec3fc448a6f67744c208f18879d10ba5d8", "committedDate": "2020-02-12T09:21:44Z", "message": "Fix imports and typo in index name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e299f8da88b080b98788260d6b4cf08a1fa2cebb", "author": {"user": {"login": "jirikuncar", "name": "Jiri Kuncar"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/e299f8da88b080b98788260d6b4cf08a1fa2cebb", "committedDate": "2020-02-12T09:56:32Z", "message": "Fix javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NDEzNDY4", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4998#pullrequestreview-359413468", "createdAt": "2020-02-16T16:12:30Z", "commit": {"oid": "e299f8da88b080b98788260d6b4cf08a1fa2cebb"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNlQxNjoxMjozMFrOFqUIvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNlQxNjoxMjozMFrOFqUIvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTkxNDQzMA==", "bodyText": "Notice here to consumers that if new server variable functionality causes issue, one may call setServerIndex(null) to revert to previous behavior. Current default behavior with the server index 0 behaves in the same way as before, but moves the URL configuration to the servers array.", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4998#discussion_r379914430", "createdAt": "2020-02-16T16:12:30Z", "author": {"login": "jimschubert"}, "path": "modules/openapi-generator/src/main/resources/Java/libraries/jersey2/ApiClient.mustache", "diffHunk": "@@ -684,12 +783,36 @@ public class ApiClient {\n    * @return The response body in type of string\n    * @throws ApiException API exception\n    */\n-  public <T> ApiResponse<T> invokeAPI(String path, String method, List<Pair> queryParams, Object body, Map<String, String> headerParams, Map<String, String> cookieParams, Map<String, Object> formParams, String accept, String contentType, String[] authNames, GenericType<T> returnType) throws ApiException {\n+  public <T> ApiResponse<T> invokeAPI(String operation, String path, String method, List<Pair> queryParams, Object body, Map<String, String> headerParams, Map<String, String> cookieParams, Map<String, Object> formParams, String accept, String contentType, String[] authNames, GenericType<T> returnType) throws ApiException {\n     updateParamsForAuth(authNames, queryParams, headerParams, cookieParams);\n \n-    // Not using `.target(this.basePath).path(path)` below,\n+    // Not using `.target(targetURL).path(path)` below,\n     // to support (constant) query string in `path`, e.g. \"/posts?draft=1\"\n-    WebTarget target = httpClient.target(this.basePath + path);\n+    String targetURL;\n+    if (serverIndex != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e299f8da88b080b98788260d6b4cf08a1fa2cebb"}, "originalPosition": 148}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63a26c8d547f095864093785190f32c0bf84b022", "author": {"user": {"login": "jimschubert", "name": "Jim Schubert"}}, "url": "https://github.com/OpenAPITools/openapi-generator/commit/63a26c8d547f095864093785190f32c0bf84b022", "committedDate": "2020-02-16T16:16:47Z", "message": "[java] Regenerate samples"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1997, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}