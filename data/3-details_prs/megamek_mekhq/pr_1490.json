{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1ODU1Mjc3", "number": 1490, "title": "Ship Autoload ui fixes 2", "bodyText": "Improvements to the UI of assigning units to ships from the TOE tab\nFixes some bugs that causes the Assign to Ship menu item to display when it shouldn't, as well as not display when it should.", "createdAt": "2020-02-16T18:14:45Z", "url": "https://github.com/MegaMek/mekhq/pull/1490", "merged": true, "mergeCommit": {"oid": "be8d9a6ae78694b33788f0a566511ee7edc10a4b"}, "closed": true, "closedAt": "2020-02-23T02:02:31Z", "author": {"login": "mkerensky"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcC_uCTAH2gAyMzc1ODU1Mjc3OmExOGFiZGMxNTkzZWZkMmU1MTFjZjVhMjdlN2M0NGZjZGZiYmNhZWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcG4YuVgFqTM2MzA0MjYyMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a18abdc1593efd2e511cf5a27e7c44fcdfbbcaeb", "author": {"user": {"login": "mkerensky", "name": null}}, "url": "https://github.com/MegaMek/mekhq/commit/a18abdc1593efd2e511cf5a27e7c44fcdfbbcaeb", "committedDate": "2020-02-10T16:28:14Z", "message": "Set up static check for all units of same type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a5b02fded0a45946f41e20744a635746a701d7f", "author": {"user": {"login": "mkerensky", "name": null}}, "url": "https://github.com/MegaMek/mekhq/commit/4a5b02fded0a45946f41e20744a635746a701d7f", "committedDate": "2020-02-10T17:17:23Z", "message": "Add weight check to areAllUnitsSameType"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb5fd1a599f1d423cad3040388cd1101516d7406", "author": {"user": {"login": "mkerensky", "name": null}}, "url": "https://github.com/MegaMek/mekhq/commit/fb5fd1a599f1d423cad3040388cd1101516d7406", "committedDate": "2020-02-10T17:18:53Z", "message": "WIP show bay capacity and restrict ship shown by selection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f86b9285c25a20984bc83223c945b7290525b08c", "author": {"user": {"login": "mkerensky", "name": null}}, "url": "https://github.com/MegaMek/mekhq/commit/f86b9285c25a20984bc83223c945b7290525b08c", "committedDate": "2020-02-10T17:31:29Z", "message": "Display current bay space by ship correctly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcecbf0a856926e11ad9f3b3e496ae2723d2b558", "author": {"user": {"login": "mkerensky", "name": null}}, "url": "https://github.com/MegaMek/mekhq/commit/fcecbf0a856926e11ad9f3b3e496ae2723d2b558", "committedDate": "2020-02-11T17:17:26Z", "message": "Refresh forceViewPanel when transport assignment changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfbf3fb7163c1a7c5621cd6d9a2b7187fe9d7f17", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/cfbf3fb7163c1a7c5621cd6d9a2b7187fe9d7f17", "committedDate": "2020-02-15T17:29:47Z", "message": "Set up single unit type menus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6482aff226892cb6eda0b18ec7c4cee188a66af", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/e6482aff226892cb6eda0b18ec7c4cee188a66af", "committedDate": "2020-02-15T17:49:20Z", "message": "Fix NPE and title update for single unit ship menu"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e061da0e0647970f8919f91975619cd9c187bf33", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/e061da0e0647970f8919f91975619cd9c187bf33", "committedDate": "2020-02-16T16:31:40Z", "message": "Fix single and group unit assign to ship menus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fca8774d632d45d2b38096ce6c656e77b99f48b8", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/fca8774d632d45d2b38096ce6c656e77b99f48b8", "committedDate": "2020-02-16T18:05:14Z", "message": "Fix tank bay processing to handle support vees"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7078d3ee2f11bf7040423b11bc6cfd8c27d2ccf2", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/7078d3ee2f11bf7040423b11bc6cfd8c27d2ccf2", "committedDate": "2020-02-16T18:11:57Z", "message": "Fix bug preventing non-force infantry assignment to ships"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5NDIxOTg2", "url": "https://github.com/MegaMek/mekhq/pull/1490#pullrequestreview-359421986", "createdAt": "2020-02-16T18:54:57Z", "commit": {"oid": "7078d3ee2f11bf7040423b11bc6cfd8c27d2ccf2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNlQxODo1NDo1N1rOFqUxGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNlQxODo1NDo1N1rOFqUxGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTkyNDc2Mg==", "bodyText": "Why are you initializing this with a \"\" instead of just not including text?", "url": "https://github.com/MegaMek/mekhq/pull/1490#discussion_r379924762", "createdAt": "2020-02-16T18:54:57Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/gui/adapter/TOEMouseAdapter.java", "diffHunk": "@@ -1168,15 +1172,30 @@ private void maybeShowPopup(MouseEvent e) {\n                 JMenu i_trn = new JMenu(TOEMouseAdapter.INFANTRY_CARRIERS);\n                 JMenu a_trn = new JMenu(TOEMouseAdapter.ASF_CARRIERS);\n                 JMenu sc_trn = new JMenu(TOEMouseAdapter.SC_CARRIERS);\n+                JMenu singleUnitMenu = new JMenu(\"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7078d3ee2f11bf7040423b11bc6cfd8c27d2ccf2"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eca41edaa680b2d68d7e61fb5ebb5d52f0085182", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/eca41edaa680b2d68d7e61fb5ebb5d52f0085182", "committedDate": "2020-02-16T23:53:33Z", "message": "Remove unneeded quotes from JMenu text"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyOTk0NDU4", "url": "https://github.com/MegaMek/mekhq/pull/1490#pullrequestreview-362994458", "createdAt": "2020-02-22T01:00:39Z", "commit": {"oid": "eca41edaa680b2d68d7e61fb5ebb5d52f0085182"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQwMTowMDozOVrOFtIfpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQwMTowMTo1N1rOFtIgYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg2OTQxMw==", "bodyText": "This should exit early if units is empty.", "url": "https://github.com/MegaMek/mekhq/pull/1490#discussion_r382869413", "createdAt": "2020-02-22T01:00:39Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/utilities/StaticChecks.java", "diffHunk": "@@ -405,6 +405,42 @@ public static boolean doAllUnitsHaveC3Master(Vector<Unit> units) {\n         return true;\n \n     }\n+    \n+    /**\n+     * Used to test a selection of Units provided by the player and determine whether they all share a designated unitType. \n+     * @param units Vector of units that the player has selected\n+     * @return false if any unit in the passed-in Vector does not have the specified unit type\n+     */\n+    public static boolean areAllUnitsSameType(Vector<Unit> units, int unitType) {\n+        // For our purposes, a selection of tanks isn't the same unless they're all the same weight class\n+        // Set this based on the first unit in the selection\n+        double firstUnitWeight = units.get(0).getEntity() != null ? units.get(0).getEntity().getWeight() : 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eca41edaa680b2d68d7e61fb5ebb5d52f0085182"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg2OTUwMg==", "bodyText": "Is the > 0 necessary? Won't they all have at least some weight (if you have some unit).", "url": "https://github.com/MegaMek/mekhq/pull/1490#discussion_r382869502", "createdAt": "2020-02-22T01:01:18Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/utilities/StaticChecks.java", "diffHunk": "@@ -405,6 +405,42 @@ public static boolean doAllUnitsHaveC3Master(Vector<Unit> units) {\n         return true;\n \n     }\n+    \n+    /**\n+     * Used to test a selection of Units provided by the player and determine whether they all share a designated unitType. \n+     * @param units Vector of units that the player has selected\n+     * @return false if any unit in the passed-in Vector does not have the specified unit type\n+     */\n+    public static boolean areAllUnitsSameType(Vector<Unit> units, int unitType) {\n+        // For our purposes, a selection of tanks isn't the same unless they're all the same weight class\n+        // Set this based on the first unit in the selection\n+        double firstUnitWeight = units.get(0).getEntity() != null ? units.get(0).getEntity().getWeight() : 0;\n+        boolean light = firstUnitWeight > 0 && firstUnitWeight <= 50;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eca41edaa680b2d68d7e61fb5ebb5d52f0085182"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg2OTYwMg==", "bodyText": "Is there something > 200 for units?", "url": "https://github.com/MegaMek/mekhq/pull/1490#discussion_r382869602", "createdAt": "2020-02-22T01:01:57Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/utilities/StaticChecks.java", "diffHunk": "@@ -405,6 +405,42 @@ public static boolean doAllUnitsHaveC3Master(Vector<Unit> units) {\n         return true;\n \n     }\n+    \n+    /**\n+     * Used to test a selection of Units provided by the player and determine whether they all share a designated unitType. \n+     * @param units Vector of units that the player has selected\n+     * @return false if any unit in the passed-in Vector does not have the specified unit type\n+     */\n+    public static boolean areAllUnitsSameType(Vector<Unit> units, int unitType) {\n+        // For our purposes, a selection of tanks isn't the same unless they're all the same weight class\n+        // Set this based on the first unit in the selection\n+        double firstUnitWeight = units.get(0).getEntity() != null ? units.get(0).getEntity().getWeight() : 0;\n+        boolean light = firstUnitWeight > 0 && firstUnitWeight <= 50;\n+        boolean heavy = firstUnitWeight > 50 && firstUnitWeight <= 100;\n+        boolean superheavy = firstUnitWeight > 100 && firstUnitWeight <= 200;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eca41edaa680b2d68d7e61fb5ebb5d52f0085182"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3578abed33c886f0deefa48212cbe021106f0b3a", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/3578abed33c886f0deefa48212cbe021106f0b3a", "committedDate": "2020-02-22T17:02:33Z", "message": "Merge branch 'master' of https://github.com/megamek/mekhq into\nAutoload_UI_Fixes_2\n\nConflicts:\n\tMekHQ/src/mekhq/gui/adapter/TOEMouseAdapter.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDM5NzQx", "url": "https://github.com/MegaMek/mekhq/pull/1490#pullrequestreview-363039741", "createdAt": "2020-02-22T17:12:05Z", "commit": {"oid": "3578abed33c886f0deefa48212cbe021106f0b3a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxNzoxMjowNlrOFtMA5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxNzoxMjowNlrOFtMA5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkyNzA3OA==", "bodyText": "This is superfluous with the for loop below. It'll do nothing if units is empty.", "url": "https://github.com/MegaMek/mekhq/pull/1490#discussion_r382927078", "createdAt": "2020-02-22T17:12:06Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/adapter/TOEMouseAdapter.java", "diffHunk": "@@ -280,22 +281,27 @@ public void actionPerformed(ActionEvent action) {\n                             if (oldShip != null) {\n                                 oldShip.unloadFromTransportShip(u);\n                                 MekHQ.triggerEvent(new UnitChangedEvent(oldShip));\n+                                gui.getTOETab().refreshForceView();\n                             }\n                         }\n                     }\n                     //now load the units\n                     ship.loadTransportShip(units);\n                     MekHQ.triggerEvent(new UnitChangedEvent(ship));\n+                    gui.getTOETab().refreshForceView();\n                 }\n             }\n         }\n         if (command.contains(UNASSIGN_FROM_SHIP)) {\n-            for (Unit u : units) {\n-                for (UUID oldShipId : u.getTransportShipId().keySet()) {\n-                    Unit oldShip = gui.getCampaign().getUnit(oldShipId);\n-                    if (oldShip != null) {\n-                        oldShip.unloadFromTransportShip(u);\n-                        MekHQ.triggerEvent(new UnitChangedEvent(oldShip));\n+            if (!units.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3578abed33c886f0deefa48212cbe021106f0b3a"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec8445fcd102631efa12e82a469eb3836ff22ae2", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/ec8445fcd102631efa12e82a469eb3836ff22ae2", "committedDate": "2020-02-22T17:37:00Z", "message": "Remove unneeded empty check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c361f47a252c292ff8bdfe4d96a67aeaa37ae66", "author": {"user": null}, "url": "https://github.com/MegaMek/mekhq/commit/9c361f47a252c292ff8bdfe4d96a67aeaa37ae66", "committedDate": "2020-02-22T17:43:48Z", "message": "Check for empty vector in sametypeunit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDQyNjIy", "url": "https://github.com/MegaMek/mekhq/pull/1490#pullrequestreview-363042622", "createdAt": "2020-02-22T18:11:19Z", "commit": {"oid": "9c361f47a252c292ff8bdfe4d96a67aeaa37ae66"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4452, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}