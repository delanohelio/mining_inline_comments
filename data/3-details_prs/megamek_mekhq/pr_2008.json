{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3NzIwMDEx", "number": 2008, "title": "crew skill upgrader bulletproofing", "bodyText": "This fixes a few exceptions I ran into while working on another project - sometimes, a unit without weapons rolls a \"Weapon Specialization\" SPA, and sometimes, a unit gets generated without a crew or the options data structure isn't initialized.\nNow, instead of failing the whole process, we just don't generate an SPA and move on.", "createdAt": "2020-09-16T04:43:45Z", "url": "https://github.com/MegaMek/mekhq/pull/2008", "merged": true, "mergeCommit": {"oid": "5de42cfecc5754ea80889de3492475a2952d7fe4"}, "closed": true, "closedAt": "2020-09-16T13:59:27Z", "author": {"login": "NickAragua"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJUz2EgH2gAyNDg3NzIwMDExOjA5OWE3MjZiOWE1YzY0MjNjNDAzMjIwYzlhOWZlMjAyNjcyMzA2MTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJc2Q7AH2gAyNDg3NzIwMDExOmVmZjNhNDhiZjhmMjEzYWM1ZjYxOTAyYTBiOTVhNGIwZDAzMzg4MDU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "099a726b9a5c6423c403220c9a9fe20267230617", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/mekhq/commit/099a726b9a5c6423c403220c9a9fe20267230617", "committedDate": "2020-09-16T04:37:17Z", "message": "crew skill upgrader fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MjY4MDk2", "url": "https://github.com/MegaMek/mekhq/pull/2008#pullrequestreview-489268096", "createdAt": "2020-09-16T04:45:06Z", "commit": {"oid": "099a726b9a5c6423c403220c9a9fe20267230617"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNDo0NTowNlrOHSf3KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwNDo0NToyMVrOHSf3cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE1ODQ0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    if(entity.getCrew() == null ||\n          \n          \n            \n                                        entity.getCrew().getOptions() == null || \n          \n          \n            \n                                        entity.getCrew().getOptions(spa.getName()) == null) {\n          \n          \n            \n                                    if ((entity.getCrew() == null) ||\n          \n          \n            \n                                            (entity.getCrew().getOptions() == null) || \n          \n          \n            \n                                            (entity.getCrew().getOptions(spa.getName()) == null)) {", "url": "https://github.com/MegaMek/mekhq/pull/2008#discussion_r489158441", "createdAt": "2020-09-16T04:45:06Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/mission/CrewSkillUpgrader.java", "diffHunk": "@@ -167,6 +167,12 @@ private int addSingleSPA(Entity entity, double xpCap) {\n                         spaValue = pickRandomWeapon(entity, true);\n                         break;\n                     default:\n+                        if(entity.getCrew() == null ||\n+                            entity.getCrew().getOptions() == null || \n+                            entity.getCrew().getOptions(spa.getName()) == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "099a726b9a5c6423c403220c9a9fe20267230617"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE1ODUxNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(entity.getIndividualWeaponList().size() <= 0) {\n          \n          \n            \n                    if (entity.getIndividualWeaponList().size() <= 0) {", "url": "https://github.com/MegaMek/mekhq/pull/2008#discussion_r489158515", "createdAt": "2020-09-16T04:45:21Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/mission/CrewSkillUpgrader.java", "diffHunk": "@@ -246,6 +252,11 @@ private String pickRandomWeapon(Entity entity, boolean clusterOnly) {\n      * @return Gunnery specialization name\n      */\n     private String pickRandomGunnerySpecialization(Entity entity) {\n+        // if you've got no weapons, tough\n+        if(entity.getIndividualWeaponList().size() <= 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "099a726b9a5c6423c403220c9a9fe20267230617"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eff3a48bf8f213ac5f61902a0b95a4b0d0338805", "author": {"user": {"login": "NickAragua", "name": null}}, "url": "https://github.com/MegaMek/mekhq/commit/eff3a48bf8f213ac5f61902a0b95a4b0d0338805", "committedDate": "2020-09-16T13:59:10Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4195, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}