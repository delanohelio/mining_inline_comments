{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MjA2Njgy", "number": 1620, "title": "780/1102: Implementing Submenus for Personnel Unit Assignment", "bodyText": "This fixes #780 and fixes #1102, as they are both calling for the same thing to be implemented.\nThis produces a list of the units sorted by weight, then alphabetically within the same weight.\nThere will be a follow up PR that moves the weight sorting into its own sorter.", "createdAt": "2020-04-03T14:27:57Z", "url": "https://github.com/MegaMek/mekhq/pull/1620", "merged": true, "mergeCommit": {"oid": "cef57fca07bb6dcfcbd472db8d93fc415812bd85"}, "closed": true, "closedAt": "2020-05-01T13:10:27Z", "author": {"login": "Windchild292"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSK4ImgH2gAyMzk4MjA2NjgyOjUxMjQxOWVjZWIzZTM0ZjVkN2I2MDhkMmIxNTQ0OTIwODdmMTMzMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcc3smFgFqTQwMzk4NDQxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "512419eceb3e34f5d7b608d2b154492087f13328", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/512419eceb3e34f5d7b608d2b154492087f13328", "committedDate": "2020-03-28T19:57:05Z", "message": "Hiding assign to unit based on an if statement instead of doing the logic then disabling it (performance improvement)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d50ac0128d8e80e7af1ae41ef2bb11bf59fe8bee", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/d50ac0128d8e80e7af1ae41ef2bb11bf59fe8bee", "committedDate": "2020-03-28T19:58:46Z", "message": "Switching to use JMenuHelpers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "738813d342e8ad680254d8846cf9a29fd1c70f8d", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/738813d342e8ad680254d8846cf9a29fd1c70f8d", "committedDate": "2020-03-28T20:00:22Z", "message": "Switching to using weight-based menu options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "095c6d2a68aee1438d342cfaf3fef4bb734ca9a6", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/095c6d2a68aee1438d342cfaf3fef4bb734ca9a6", "committedDate": "2020-03-28T20:17:42Z", "message": "Renaming from submenu to entity weight menu"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1495bdd17ce561fe8a22fdc82657a13251d89e31", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/1495bdd17ce561fe8a22fdc82657a13251d89e31", "committedDate": "2020-03-28T20:36:02Z", "message": "Part 1 of implementing unit type menus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34ed1e9147ae794a6563ea7b4f3597773a3b68e1", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/34ed1e9147ae794a6563ea7b4f3597773a3b68e1", "committedDate": "2020-03-28T21:26:21Z", "message": "Switching the sorting to include a third type based on Entity Type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82cb619af355732d26c8215502f5bdb7da917268", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/82cb619af355732d26c8215502f5bdb7da917268", "committedDate": "2020-03-28T22:21:59Z", "message": "Adding additional sorting methods to getUnits"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6aa99035a0ef1d2f3732d2270e53ef115806c72", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/b6aa99035a0ef1d2f3732d2270e53ef115806c72", "committedDate": "2020-03-28T22:22:22Z", "message": "Reverting getUnits call change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dbfc4833442f76a7e3bac1b0a9a9c544b639791", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/0dbfc4833442f76a7e3bac1b0a9a9c544b639791", "committedDate": "2020-03-28T22:58:56Z", "message": "Fixing issues in sorting order, and making the normal sort natural order"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76fa24445fea2143be7f9fa8f6365af4b6418611", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/76fa24445fea2143be7f9fa8f6365af4b6418611", "committedDate": "2020-03-28T22:59:38Z", "message": "Switching to using the proper sort format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94b2fc588f259a043677c1d0afeca263903ef3c5", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/94b2fc588f259a043677c1d0afeca263903ef3c5", "committedDate": "2020-03-28T23:00:14Z", "message": "Properly implementing unit type sorting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82fcdfe59e99ce3a3ad63e27a8ccef25cb6f7e8a", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/82fcdfe59e99ce3a3ad63e27a8ccef25cb6f7e8a", "committedDate": "2020-04-03T02:32:00Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8847f7f7f8bce58e00a297cdd35dcd8c5f362541", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/8847f7f7f8bce58e00a297cdd35dcd8c5f362541", "committedDate": "2020-04-04T18:31:35Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf7ea705096a76af1a299d07eae0bccac722d154", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/cf7ea705096a76af1a299d07eae0bccac722d154", "committedDate": "2020-04-04T18:31:47Z", "message": "Merge remote-tracking branch 'upstream/master' into dev_Windchild_780"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NzIzNzYy", "url": "https://github.com/MegaMek/mekhq/pull/1620#pullrequestreview-387723762", "createdAt": "2020-04-04T18:37:28Z", "commit": {"oid": "cf7ea705096a76af1a299d07eae0bccac722d154"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxODozNzoyOFrOGAzzvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxODo0MTo1MFrOGAz1rA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwMjAxMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    return (int) (rhs.getEntity().getWeight() - lhs.getEntity().getWeight());\n          \n          \n            \n                                    return Double.compare(rhs.getEntity().getWeight(), lhs.getEntity().getWeight());", "url": "https://github.com/MegaMek/mekhq/pull/1620#discussion_r403502012", "createdAt": "2020-04-04T18:37:28Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -1150,18 +1151,50 @@ public Unit addUnit(Entity en, boolean allowNewPilots, int days) {\n         return units.values();\n     }\n \n-    public ArrayList<Unit> getUnits(boolean weightSorted, boolean alphaSorted) {\n-        ArrayList<Unit> sortedUnits = getCopyOfUnits();\n-        if (alphaSorted || weightSorted) {\n-            if (alphaSorted) {\n-                sortedUnits.sort(Comparator.comparing(Unit::getName));\n-            }\n-            if (weightSorted) {\n+    public List<Unit> getUnits(boolean weightSorted) {\n+        return getUnits(false, weightSorted, false);\n+    }\n+\n+    /**\n+     * This returns a list of the current units, sorted alphabetically and potentially by other methods\n+     * @param weightSorted      True if the unit list is sorted by weight descending, otherwise false\n+     * @param weightClassSorted True if the unit list is sorted by weight class in format heaviest to lightest, otherwise false\n+     * @param unitTypeSorted    True if the unit list is sorted by the unit type\n+     * @return a copy of the units in the campaign with the applicable sort format\n+     */\n+    public List<Unit> getUnits(boolean weightClassSorted, boolean weightSorted,\n+                               boolean unitTypeSorted) {\n+        List<Unit> units = getCopyOfUnits();\n+\n+        // Natural order sorting the units alphabetically is the default for getSortedUnits\n+        Comparator<String> naturalOrderComparator = new NaturalOrderComparator();\n+        units.sort((o1, o2) -> naturalOrderComparator.compare(o1.getName(), o2.getName()));\n+\n+        if (weightClassSorted || weightSorted || unitTypeSorted) {\n+            // We need to determine these by both the weight sorted and weight class sorted values,\n+            // as to properly sort by weight class and weight we should do both at the same time\n+            if (weightSorted && weightClassSorted) {\n+                units.sort((lhs, rhs) -> {\n+                    int weightClass1 = lhs.getEntity().getWeightClass();\n+                    int weightClass2 = rhs.getEntity().getWeightClass();\n+                    if (weightClass1 == weightClass2) {\n+                        return (int) (rhs.getEntity().getWeight() - lhs.getEntity().getWeight());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7ea705096a76af1a299d07eae0bccac722d154"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwMjI3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            units.sort((lhs, rhs) -> Double.compare(rhs.getEntity().getWeight(), lhs.getEntity().getWeight()));\n          \n          \n            \n                            units.sort(Comparator.comparingDouble(o -> o.getEntity().getWeight()));", "url": "https://github.com/MegaMek/mekhq/pull/1620#discussion_r403502275", "createdAt": "2020-04-04T18:39:30Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -1150,18 +1151,50 @@ public Unit addUnit(Entity en, boolean allowNewPilots, int days) {\n         return units.values();\n     }\n \n-    public ArrayList<Unit> getUnits(boolean weightSorted, boolean alphaSorted) {\n-        ArrayList<Unit> sortedUnits = getCopyOfUnits();\n-        if (alphaSorted || weightSorted) {\n-            if (alphaSorted) {\n-                sortedUnits.sort(Comparator.comparing(Unit::getName));\n-            }\n-            if (weightSorted) {\n+    public List<Unit> getUnits(boolean weightSorted) {\n+        return getUnits(false, weightSorted, false);\n+    }\n+\n+    /**\n+     * This returns a list of the current units, sorted alphabetically and potentially by other methods\n+     * @param weightSorted      True if the unit list is sorted by weight descending, otherwise false\n+     * @param weightClassSorted True if the unit list is sorted by weight class in format heaviest to lightest, otherwise false\n+     * @param unitTypeSorted    True if the unit list is sorted by the unit type\n+     * @return a copy of the units in the campaign with the applicable sort format\n+     */\n+    public List<Unit> getUnits(boolean weightClassSorted, boolean weightSorted,\n+                               boolean unitTypeSorted) {\n+        List<Unit> units = getCopyOfUnits();\n+\n+        // Natural order sorting the units alphabetically is the default for getSortedUnits\n+        Comparator<String> naturalOrderComparator = new NaturalOrderComparator();\n+        units.sort((o1, o2) -> naturalOrderComparator.compare(o1.getName(), o2.getName()));\n+\n+        if (weightClassSorted || weightSorted || unitTypeSorted) {\n+            // We need to determine these by both the weight sorted and weight class sorted values,\n+            // as to properly sort by weight class and weight we should do both at the same time\n+            if (weightSorted && weightClassSorted) {\n+                units.sort((lhs, rhs) -> {\n+                    int weightClass1 = lhs.getEntity().getWeightClass();\n+                    int weightClass2 = rhs.getEntity().getWeightClass();\n+                    if (weightClass1 == weightClass2) {\n+                        return (int) (rhs.getEntity().getWeight() - lhs.getEntity().getWeight());\n+                    } else {\n+                        return weightClass2 - weightClass1;\n+                    }\n+                });\n+            } else if (weightClassSorted) {\n+                units.sort(Comparator.comparingInt(o -> o.getEntity().getWeightClass()));\n+            } else if (weightSorted) {\n                 // Sorted in descending order of weights\n-                sortedUnits.sort((lhs, rhs) -> Double.compare(rhs.getEntity().getWeight(), lhs.getEntity().getWeight()));\n+                units.sort((lhs, rhs) -> Double.compare(rhs.getEntity().getWeight(), lhs.getEntity().getWeight()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7ea705096a76af1a299d07eae0bccac722d154"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwMjQyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Comparator<String> naturalOrderComparator = new NaturalOrderComparator();\n          \n          \n            \n                    units.sort((o1, o2) -> naturalOrderComparator.compare(o1.getName(), o2.getName()));\n          \n          \n            \n                    units.sort(Comparator.comparing(o -> o.getName(), new NaturalOrderComparator()));", "url": "https://github.com/MegaMek/mekhq/pull/1620#discussion_r403502429", "createdAt": "2020-04-04T18:41:14Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -1150,18 +1151,50 @@ public Unit addUnit(Entity en, boolean allowNewPilots, int days) {\n         return units.values();\n     }\n \n-    public ArrayList<Unit> getUnits(boolean weightSorted, boolean alphaSorted) {\n-        ArrayList<Unit> sortedUnits = getCopyOfUnits();\n-        if (alphaSorted || weightSorted) {\n-            if (alphaSorted) {\n-                sortedUnits.sort(Comparator.comparing(Unit::getName));\n-            }\n-            if (weightSorted) {\n+    public List<Unit> getUnits(boolean weightSorted) {\n+        return getUnits(false, weightSorted, false);\n+    }\n+\n+    /**\n+     * This returns a list of the current units, sorted alphabetically and potentially by other methods\n+     * @param weightSorted      True if the unit list is sorted by weight descending, otherwise false\n+     * @param weightClassSorted True if the unit list is sorted by weight class in format heaviest to lightest, otherwise false\n+     * @param unitTypeSorted    True if the unit list is sorted by the unit type\n+     * @return a copy of the units in the campaign with the applicable sort format\n+     */\n+    public List<Unit> getUnits(boolean weightClassSorted, boolean weightSorted,\n+                               boolean unitTypeSorted) {\n+        List<Unit> units = getCopyOfUnits();\n+\n+        // Natural order sorting the units alphabetically is the default for getSortedUnits\n+        Comparator<String> naturalOrderComparator = new NaturalOrderComparator();\n+        units.sort((o1, o2) -> naturalOrderComparator.compare(o1.getName(), o2.getName()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7ea705096a76af1a299d07eae0bccac722d154"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwMjUwOA==", "bodyText": "Are these mutually exclusive or \"then by\"?", "url": "https://github.com/MegaMek/mekhq/pull/1620#discussion_r403502508", "createdAt": "2020-04-04T18:41:50Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -1150,18 +1151,50 @@ public Unit addUnit(Entity en, boolean allowNewPilots, int days) {\n         return units.values();\n     }\n \n-    public ArrayList<Unit> getUnits(boolean weightSorted, boolean alphaSorted) {\n-        ArrayList<Unit> sortedUnits = getCopyOfUnits();\n-        if (alphaSorted || weightSorted) {\n-            if (alphaSorted) {\n-                sortedUnits.sort(Comparator.comparing(Unit::getName));\n-            }\n-            if (weightSorted) {\n+    public List<Unit> getUnits(boolean weightSorted) {\n+        return getUnits(false, weightSorted, false);\n+    }\n+\n+    /**\n+     * This returns a list of the current units, sorted alphabetically and potentially by other methods\n+     * @param weightSorted      True if the unit list is sorted by weight descending, otherwise false\n+     * @param weightClassSorted True if the unit list is sorted by weight class in format heaviest to lightest, otherwise false\n+     * @param unitTypeSorted    True if the unit list is sorted by the unit type\n+     * @return a copy of the units in the campaign with the applicable sort format\n+     */\n+    public List<Unit> getUnits(boolean weightClassSorted, boolean weightSorted,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7ea705096a76af1a299d07eae0bccac722d154"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28edf47e027e294172a07fa28f74184fc45b2f97", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/28edf47e027e294172a07fa28f74184fc45b2f97", "committedDate": "2020-04-04T18:45:41Z", "message": "Update MekHQ/src/mekhq/campaign/Campaign.java\n\nCo-Authored-By: Christopher Watford <christopher.watford@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc56acacb00b3cdb47ad0c94af73c0baa6ae9353", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/fc56acacb00b3cdb47ad0c94af73c0baa6ae9353", "committedDate": "2020-04-04T18:46:02Z", "message": "Update MekHQ/src/mekhq/campaign/Campaign.java\n\nCo-Authored-By: Christopher Watford <christopher.watford@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed8aa94ba0b24e27ced47e6c75ec6658191da93a", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/ed8aa94ba0b24e27ced47e6c75ec6658191da93a", "committedDate": "2020-04-04T18:47:13Z", "message": "Update MekHQ/src/mekhq/campaign/Campaign.java\n\nCo-Authored-By: Christopher Watford <christopher.watford@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08ca5798d467cc39d3e667923a87244e2a41cb33", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/08ca5798d467cc39d3e667923a87244e2a41cb33", "committedDate": "2020-04-20T15:23:10Z", "message": "Merge remote-tracking branch 'upstream/master' into dev_Windchild_780"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a085eb7c2b1b8014061fff7e1b9905d6ad469cb", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/7a085eb7c2b1b8014061fff7e1b9905d6ad469cb", "committedDate": "2020-04-20T15:34:50Z", "message": "Fixing comparator source following MegaMek move"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzOTg0NDEz", "url": "https://github.com/MegaMek/mekhq/pull/1620#pullrequestreview-403984413", "createdAt": "2020-05-01T01:49:27Z", "commit": {"oid": "7a085eb7c2b1b8014061fff7e1b9905d6ad469cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4345, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}