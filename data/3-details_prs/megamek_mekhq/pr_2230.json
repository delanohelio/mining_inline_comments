{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMDY2NTY0", "number": 2230, "title": "Issue #2166: NRE in Money::plus/Money::minus", "bodyText": "We have seen more than a handful of null exceptions in Money::plus, most of the calling code however, has been fixed. There are a few places that may or may not have been fixed, but I couldn't find any issues with Part::getStickerPrice in my search today.\nInstead, I've gone ahead and null protected Money::plus and Money::minus, and ensured that BattleArmorSuit does not return a null value for alternateCost. This fixes #2166, albeit in a defensive way we may not need anymore.", "createdAt": "2020-11-14T22:09:01Z", "url": "https://github.com/MegaMek/mekhq/pull/2230", "merged": true, "mergeCommit": {"oid": "2eec7aef064f4a2aa7b8c8fc458c931dccf8aca4"}, "closed": true, "closedAt": "2020-11-15T20:12:10Z", "author": {"login": "sixlettervariables"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcjKkQAH2gAyNTIxMDY2NTY0OjI5Yjc4NjBhYjBiMTRkMzkyNDQ1NjhjYjEwMzQ1MTJhM2FlMTlkYWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcjRGOAFqTUzMDYwODAzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "29b7860ab0b14d39244568cb1034512a3ae19daf", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/29b7860ab0b14d39244568cb1034512a3ae19daf", "committedDate": "2020-11-14T22:05:20Z", "message": "Avoid NRE in Money::plus/Money::minus, fixing #2166"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNjA3OTM5", "url": "https://github.com/MegaMek/mekhq/pull/2230#pullrequestreview-530607939", "createdAt": "2020-11-14T22:09:30Z", "commit": {"oid": "29b7860ab0b14d39244568cb1034512a3ae19daf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNFQyMjowOTozMFrOHzOA3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNFQyMjowOTozMFrOHzOA3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQ2OTAyMA==", "bodyText": "This ensures we get a clone of the underlying BigMoney instance and don't share it between two Money instances.", "url": "https://github.com/MegaMek/mekhq/pull/2230#discussion_r523469020", "createdAt": "2020-11-14T22:09:30Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/finances/Money.java", "diffHunk": "@@ -102,6 +102,10 @@ public Money absolute() {\n     }\n \n     public Money plus(Money amount) {\n+        if (amount == null) {\n+            return plus(0L);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29b7860ab0b14d39244568cb1034512a3ae19daf"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNjA3OTQz", "url": "https://github.com/MegaMek/mekhq/pull/2230#pullrequestreview-530607943", "createdAt": "2020-11-14T22:09:34Z", "commit": {"oid": "29b7860ab0b14d39244568cb1034512a3ae19daf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNFQyMjowOTozNFrOHzOA6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNFQyMjowOTozNFrOHzOA6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQ2OTAzNA==", "bodyText": "This ensures we get a clone of the underlying BigMoney instance and don't share it between two Money instances.", "url": "https://github.com/MegaMek/mekhq/pull/2230#discussion_r523469034", "createdAt": "2020-11-14T22:09:34Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/finances/Money.java", "diffHunk": "@@ -114,6 +118,10 @@ public Money plus(List<Money> amounts) {\n     }\n \n     public Money minus(Money amount) {\n+        if (amount == null) {\n+            return minus(0L);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29b7860ab0b14d39244568cb1034512a3ae19daf"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNjA4MDMy", "url": "https://github.com/MegaMek/mekhq/pull/2230#pullrequestreview-530608032", "createdAt": "2020-11-14T22:11:39Z", "commit": {"oid": "29b7860ab0b14d39244568cb1034512a3ae19daf"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNFQyMjoxMTozOVrOHzOBgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNFQyMjoxMTo1MFrOHzOBhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQ2OTE4NA==", "bodyText": "Easy ternary candidate, plus why not instead return Money.zero() ?", "url": "https://github.com/MegaMek/mekhq/pull/2230#discussion_r523469184", "createdAt": "2020-11-14T22:11:39Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/finances/Money.java", "diffHunk": "@@ -102,6 +102,10 @@ public Money absolute() {\n     }\n \n     public Money plus(Money amount) {\n+        if (amount == null) {\n+            return plus(0L);\n+        }\n+\n         return new Money(getWrapped().plus(amount.getWrapped()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29b7860ab0b14d39244568cb1034512a3ae19daf"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQ2OTE4OQ==", "bodyText": "Same as above", "url": "https://github.com/MegaMek/mekhq/pull/2230#discussion_r523469189", "createdAt": "2020-11-14T22:11:50Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/finances/Money.java", "diffHunk": "@@ -114,6 +118,10 @@ public Money plus(List<Money> amounts) {\n     }\n \n     public Money minus(Money amount) {\n+        if (amount == null) {\n+            return minus(0L);\n+        }\n+\n         return new Money(getWrapped().minus(amount.getWrapped()));\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29b7860ab0b14d39244568cb1034512a3ae19daf"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4144, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}