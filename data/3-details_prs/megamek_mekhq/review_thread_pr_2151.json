{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1MTAwMjM0", "number": 2151, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMToxMDowMVrOEwjtPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xMlQwMjozNjowN1rOFlAm2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MzUyMTI2OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/Campaign.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwMToxMDowMlrOHmNDEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNTozMDowM1rOHmnkkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgyMTcxMg==", "bodyText": "I would suggest retaining the isActive() method, but having it call getStatus().isActive(). That way you can reduce the footprint of this PR quite a bit while keeping the spirit.", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r509821712", "createdAt": "2020-10-22T01:10:02Z", "author": {"login": "NickAragua"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -3064,7 +3064,7 @@ public void readNews() {\n     }\n \n     public int getDeploymentDeficit(AtBContract contract) {\n-        if (!contract.isActive()) {\n+        if (!contract.getStatus().isActive()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f34ac06c3db416f5e852246e928d3b1c6c132500"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTkyMzYwMg==", "bodyText": "That is purposeful. I'd rather have the code in the enum in question to prevent future problems... This is especially for tracing, as I've seen what happens when coders go over-the-top with putting methods that do this and the sheer amount of effort that it adds to tracing [especially for enums], and thus would prefer to avoid it in our code base.", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r509923602", "createdAt": "2020-10-22T07:00:52Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -3064,7 +3064,7 @@ public void readNews() {\n     }\n \n     public int getDeploymentDeficit(AtBContract contract) {\n-        if (!contract.isActive()) {\n+        if (!contract.getStatus().isActive()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgyMTcxMg=="}, "originalCommit": {"oid": "f34ac06c3db416f5e852246e928d3b1c6c132500"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE0MzY4Nw==", "bodyText": "My preference would be Contract::isActive as well. It is more intuitive and benefits from intellisense (etc). Much like Person::isDeployed which wraps a similar check for convenience.", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r510143687", "createdAt": "2020-10-22T13:04:15Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -3064,7 +3064,7 @@ public void readNews() {\n     }\n \n     public int getDeploymentDeficit(AtBContract contract) {\n-        if (!contract.isActive()) {\n+        if (!contract.getStatus().isActive()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgyMTcxMg=="}, "originalCommit": {"oid": "f34ac06c3db416f5e852246e928d3b1c6c132500"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE0NjIyOA==", "bodyText": "A compromise could be Contract::isActiveOn(LocalDate date) which would handle a lot of these call sites.", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r510146228", "createdAt": "2020-10-22T13:07:48Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -3064,7 +3064,7 @@ public void readNews() {\n     }\n \n     public int getDeploymentDeficit(AtBContract contract) {\n-        if (!contract.isActive()) {\n+        if (!contract.getStatus().isActive()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgyMTcxMg=="}, "originalCommit": {"oid": "f34ac06c3db416f5e852246e928d3b1c6c132500"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI1NjI3Mg==", "bodyText": "I'm actually planning on implementing contact end date nag and removing most uses of isActive in the near future. This originally contained them, but it got too busy for the PR so I reverted it.\nFuther, Person::isDeployed isn't an enum check but rather a unit value check. Because it is an enum check is why this is implemented as it is.\nAs for isActiveOn, that's a nice way to handle it that will simplify some of the logic for my next changes, but it should be handled by getActiveContract if it is simply an active state check that does not currently need to be handled based only on start date.", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r510256272", "createdAt": "2020-10-22T15:30:03Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -3064,7 +3064,7 @@ public void readNews() {\n     }\n \n     public int getDeploymentDeficit(AtBContract contract) {\n-        if (!contract.isActive()) {\n+        if (!contract.getStatus().isActive()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTgyMTcxMg=="}, "originalCommit": {"oid": "f34ac06c3db416f5e852246e928d3b1c6c132500"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzc0MzUxMjM2OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/gui/dialog/ContractMarketDialog.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xMlQwMjozNDo0NlrOI1Z2mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xMlQwMjo1Nzo0OFrOI1aUdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mjg2OTAxOQ==", "bodyText": "Looks like you missed a .isActiveOn() call here", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r592869019", "createdAt": "2021-03-12T02:34:46Z", "author": {"login": "NickAragua"}, "path": "MekHQ/src/mekhq/gui/dialog/ContractMarketDialog.java", "diffHunk": "@@ -104,16 +103,15 @@ public ContractMarketDialog(Frame frame, Campaign c) {\n      */\n     private void countSuccessfulContracts() {\n         HashMap<String, Integer> successfulContracts = new HashMap<>();\n-        for (Mission m : campaign.getMissions()) {\n-            if (m.isActive() || !(m instanceof AtBContract)\n-                    || ((AtBContract) m).getEmployerCode().equals(campaign.getRetainerEmployerCode())) {\n+        for (AtBContract contract : campaign.getAtBContracts()) {\n+            if (contract.getStatus().isActive()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9eca5ea7a7d0fe44db02d1ce091f5bf294cb156d"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mjg3NjY2Mg==", "bodyText": "That's a bug", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r592876662", "createdAt": "2021-03-12T02:57:48Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/gui/dialog/ContractMarketDialog.java", "diffHunk": "@@ -104,16 +103,15 @@ public ContractMarketDialog(Frame frame, Campaign c) {\n      */\n     private void countSuccessfulContracts() {\n         HashMap<String, Integer> successfulContracts = new HashMap<>();\n-        for (Mission m : campaign.getMissions()) {\n-            if (m.isActive() || !(m instanceof AtBContract)\n-                    || ((AtBContract) m).getEmployerCode().equals(campaign.getRetainerEmployerCode())) {\n+        for (AtBContract contract : campaign.getAtBContracts()) {\n+            if (contract.getStatus().isActive()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mjg2OTAxOQ=="}, "originalCommit": {"oid": "9eca5ea7a7d0fe44db02d1ce091f5bf294cb156d"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzc0MzUxNTc2OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/Campaign.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xMlQwMjozNjowN1rOI1Z4gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xMlQwMjo1OToyNFrOI1aWRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mjg2OTUwNg==", "bodyText": "Is this a good place for isActiveOn()?", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r592869506", "createdAt": "2021-03-12T02:36:07Z", "author": {"login": "NickAragua"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -2939,11 +2998,12 @@ public void readNews() {\n         }\n     }\n \n+    /**\n+     * @param contract an active AtBContract\n+     * @return the current deployment deficit for the contract\n+     */\n     public int getDeploymentDeficit(AtBContract contract) {\n-        if (!contract.isActive()) {\n-            // Inactive contracts have no deficits.\n-            return 0;\n-        } else if (contract.getStartDate().compareTo(getLocalDate()) >= 0) {\n+        if (contract.getStartDate().compareTo(getLocalDate()) >= 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9eca5ea7a7d0fe44db02d1ce091f5bf294cb156d"}, "originalPosition": 133}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mjg3NzEyNQ==", "bodyText": "It would be", "url": "https://github.com/MegaMek/mekhq/pull/2151#discussion_r592877125", "createdAt": "2021-03-12T02:59:24Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -2939,11 +2998,12 @@ public void readNews() {\n         }\n     }\n \n+    /**\n+     * @param contract an active AtBContract\n+     * @return the current deployment deficit for the contract\n+     */\n     public int getDeploymentDeficit(AtBContract contract) {\n-        if (!contract.isActive()) {\n-            // Inactive contracts have no deficits.\n-            return 0;\n-        } else if (contract.getStartDate().compareTo(getLocalDate()) >= 0) {\n+        if (contract.getStartDate().compareTo(getLocalDate()) >= 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mjg2OTUwNg=="}, "originalCommit": {"oid": "9eca5ea7a7d0fe44db02d1ce091f5bf294cb156d"}, "originalPosition": 133}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2124, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}