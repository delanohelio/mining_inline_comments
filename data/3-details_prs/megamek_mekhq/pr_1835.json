{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0MTEyNzg0", "number": 1835, "title": "DateTime to LocalDate Switchover", "bodyText": "This removes Joda DateTime completely from MekHQ, and replaces it with LocalDate. This needed to be done in a single large PR because of the integration between the different places that use DateTime.\nPart of this fixes #1797, fixes #1820, because the time zone difference no longer applies.\nTo review: Whitespace differences off, and I apologize for the difficulty in this review.", "createdAt": "2020-07-03T15:33:56Z", "url": "https://github.com/MegaMek/mekhq/pull/1835", "merged": true, "mergeCommit": {"oid": "281fbcd315f3243b5b0ac5547d844c7f909b6412"}, "closed": true, "closedAt": "2020-07-07T16:28:37Z", "author": {"login": "Windchild292"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABctJXuYAH2gAyNDQ0MTEyNzg0OmViOWZiMzg1OWE3NWQyMTUxMmZlMjAzZjU5NTgwNzA1MmE5NTMwMTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcx_ur3gFqTQ0MjY5MjMyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eb9fb3859a75d21512fe203f595807052a953010", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/eb9fb3859a75d21512fe203f595807052a953010", "committedDate": "2020-06-20T15:27:44Z", "message": "Switching Injuries to LocalDate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9986c8575667a8b2777855382ac1ceab15feeea", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/d9986c8575667a8b2777855382ac1ceab15feeea", "committedDate": "2020-06-20T17:03:19Z", "message": "Starting to move Planetary Systems to LocalDate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ece1d1e504e13a24589f2bc4eb7b75c284a805c", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/8ece1d1e504e13a24589f2bc4eb7b75c284a805c", "committedDate": "2020-06-20T17:40:42Z", "message": "Moving more files to LocalDate and removing DateTime"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1fa2174f6b9518beb164534f29b6d61a7254c8e", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/b1fa2174f6b9518beb164534f29b6d61a7254c8e", "committedDate": "2020-06-20T17:41:06Z", "message": "Removing DateTime from Campaign"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c268496826c1ed4b5d3bb5e35285a5d5a81ab6a4", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/c268496826c1ed4b5d3bb5e35285a5d5a81ab6a4", "committedDate": "2020-06-20T18:49:04Z", "message": "Starting to wrap up removing DateTime"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c9afac9f6f8fb43be75f4959c709dd2906f6b6a", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/9c9afac9f6f8fb43be75f4959c709dd2906f6b6a", "committedDate": "2020-06-21T13:26:21Z", "message": "Finishing switch to LocalDate instead of Joda DateTime"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "039ab3c338404a8015837e242249c86c175b19d6", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/039ab3c338404a8015837e242249c86c175b19d6", "committedDate": "2020-06-21T13:52:16Z", "message": "Fixing name spelling issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f68c2b610efed096c2b564a43bb0e99916da4ab", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/5f68c2b610efed096c2b564a43bb0e99916da4ab", "committedDate": "2020-06-21T14:16:12Z", "message": "Fixing planetary events following LocalDate transition"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29badf2047a87bb7c6dc6be2281bb275145e24a3", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/29badf2047a87bb7c6dc6be2281bb275145e24a3", "committedDate": "2020-06-21T14:16:36Z", "message": "Fixing unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d32083c7e6dc1f51f5c96df1923ef870f4438957", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/d32083c7e6dc1f51f5c96df1923ef870f4438957", "committedDate": "2020-06-21T15:11:39Z", "message": "Adding active tracing for LocalDate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e1bfe8a46bf8722cf02fb153176ca831e3fad9c", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/0e1bfe8a46bf8722cf02fb153176ca831e3fad9c", "committedDate": "2020-06-21T15:19:47Z", "message": "Merge remote-tracking branch 'upstream/master' into dev_Windchild_DateTime"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67b83fb6393a53e1c000a3770f0b546700cf8ba8", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/67b83fb6393a53e1c000a3770f0b546700cf8ba8", "committedDate": "2020-06-21T16:01:24Z", "message": "Applying changes from personal review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "618da4a9b5b8c69fe8967107936b0d18bd561e57", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/618da4a9b5b8c69fe8967107936b0d18bd561e57", "committedDate": "2020-07-03T15:24:15Z", "message": "Fixing LocalDate calculation issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNTQ1MjI0", "url": "https://github.com/MegaMek/mekhq/pull/1835#pullrequestreview-442545224", "createdAt": "2020-07-03T19:42:58Z", "commit": {"oid": "618da4a9b5b8c69fe8967107936b0d18bd561e57"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxOTo0Mjo1OFrOGs29BA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxOTo0NTozM1rOGs2-qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTY5MDg4NA==", "bodyText": "This seems more awkward than the previous syntax, is there any way to make it less, uh...", "url": "https://github.com/MegaMek/mekhq/pull/1835#discussion_r449690884", "createdAt": "2020-07-03T19:42:58Z", "author": {"login": "NickAragua"}, "path": "MekHQ/src/mekhq/gui/view/ContractSummaryPanel.java", "diffHunk": "@@ -226,7 +226,9 @@ public void mouseClicked(MouseEvent e) {\n             mainPanel.add(lblDistance, gridBagConstraintsLabels);\n \n             JumpPath path = campaign.calculateJumpPath(campaign.getCurrentSystem(), contract.getSystem());\n-            int days = (int) Math.ceil(path.getTotalTime(Utilities.getDateTimeDay(contract.getStartDate()),\n+\n+            int days = (int) Math.ceil(path.getTotalTime(\n+                    contract.getStartDate().toInstant().atZone(ZoneId.systemDefault()).toLocalDate(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "618da4a9b5b8c69fe8967107936b0d18bd561e57"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTY5MTMwNg==", "bodyText": "This seems like it's a behavior change from existing behavior, can you go into a little detail on why it was done?", "url": "https://github.com/MegaMek/mekhq/pull/1835#discussion_r449691306", "createdAt": "2020-07-03T19:45:33Z", "author": {"login": "NickAragua"}, "path": "MekHQ/src/mekhq/campaign/universe/Planet.java", "diffHunk": "@@ -314,18 +297,22 @@ public Planet(String tsvData, List<DateTime> years) throws Exception {\n \n                 // dirty hack here assumes that there's only one faction per event, which is true in the case\n                 // of this spreadsheet\n-                if(x == 3 || !eventList.get(eventList.size() - 1).faction.get(0).equals(newFaction)) {\n-                    PlanetaryEvent pe = new PlanetaryEvent();\n-                    DateTime eventDate = years.get(x - 3);\n-                    pe.faction = new ArrayList<String>();\n+                if ((x == 3) || !eventList.get(eventList.size() - 1).faction.get(0).equals(newFaction)) {\n+                    LocalDate eventDate = years.get(x - 3);\n+\n+                    PlanetaryEvent pe = events.getOrDefault(eventDate, new PlanetaryEvent());\n+                    pe.faction = new ArrayList<>();\n                     pe.faction.add(newFaction);\n-                    pe.date = eventDate;\n \n-                    this.eventList.add(pe);\n-                    this.events.put(eventDate, pe);\n+                    if (!events.containsKey(eventDate)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "618da4a9b5b8c69fe8967107936b0d18bd561e57"}, "originalPosition": 185}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61acc12bc3be21692834dc6d84f2ab5640f1e5f1", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/61acc12bc3be21692834dc6d84f2ab5640f1e5f1", "committedDate": "2020-07-04T14:23:56Z", "message": "Merge remote-tracking branch 'upstream/master' into dev_Windchild_DateTime"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "976211ce7bce04f8f6ea545d2437afbb3a7d318b", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/976211ce7bce04f8f6ea545d2437afbb3a7d318b", "committedDate": "2020-07-05T16:58:27Z", "message": "Fixing the name change and faction change events so they uses getOrDefault properly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNjkyMzI4", "url": "https://github.com/MegaMek/mekhq/pull/1835#pullrequestreview-442692328", "createdAt": "2020-07-05T17:03:23Z", "commit": {"oid": "976211ce7bce04f8f6ea545d2437afbb3a7d318b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4303, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}