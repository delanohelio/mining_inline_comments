{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MjY3MDk0", "number": 1794, "title": "1781: Adding Sorting to the Scenario Table", "bodyText": "This fixes #1781 by adding sorting to the scenario table, fixing a few NPEs, adding a missing MissionRemovedEvent, fixing the ScenarioRemovedEvent, and fixing the GM button refresh.\nThe NPEs were in ScenarioTableModel.java according to the logs, but I was unable to originally figure out why they were happening (did not expect it to be the wrong event firing when a scenario was removed). After trying a bunch of things out, I found a comparable model (the UnitMarketTableModel), and refactored the two to be nigh-on identical while actually using the inherited methods of their parent properly. That is why those two files are both included with heavy refactors, even though they would otherwise be out of scope.", "createdAt": "2020-06-03T15:08:25Z", "url": "https://github.com/MegaMek/mekhq/pull/1794", "merged": true, "mergeCommit": {"oid": "d12ccd0c348e243b6a3e614492561105722490fd"}, "closed": true, "closedAt": "2020-06-15T16:35:05Z", "author": {"login": "Windchild292"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnoOOSAH2gAyNDI3MjY3MDk0OjlkYTdmZjc3NThkZGQyZTYwYzdlNDAzYTZlNWRlMTA5OGNmN2U4ZTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrjLYWAFqTQzMDgwMjEyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9da7ff7758ddd2e60c7e403a6e5de1098cf7e8e6", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/9da7ff7758ddd2e60c7e403a6e5de1098cf7e8e6", "committedDate": "2020-06-03T12:00:52Z", "message": "Initial work to add the sorting, just need to deal with a NPE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d2d98d3542799e4c2d50f15a2527a41c0e4d362", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/1d2d98d3542799e4c2d50f15a2527a41c0e4d362", "committedDate": "2020-06-03T13:45:08Z", "message": "Fixing the NPE caused by not updating the data properly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a29f5d2f12ca11241c03409154299e60577fc26a", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/a29f5d2f12ca11241c03409154299e60577fc26a", "committedDate": "2020-06-03T13:45:42Z", "message": "Fixing scenario null pointers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a95c8b6f5a01634e741825eb66d8d18ce7fecf3a", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/a95c8b6f5a01634e741825eb66d8d18ce7fecf3a", "committedDate": "2020-06-03T13:46:45Z", "message": "Refactoring to standardize and actually utilize the abstraction for scenario and unit market table models."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31512be33c75df10670ff2d28040e11ced4430e4", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/31512be33c75df10670ff2d28040e11ced4430e4", "committedDate": "2020-06-03T13:49:43Z", "message": "clarifying # units"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad1a76bcbd9ffee17557f38b77d4ff5d0ffaaabe", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/ad1a76bcbd9ffee17557f38b77d4ff5d0ffaaabe", "committedDate": "2020-06-03T13:50:08Z", "message": "Merge remote-tracking branch 'upstream/master' into dev_Windchild_1781"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "703699b9b33eb700e482c2748b0f77b9caac091e", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/703699b9b33eb700e482c2748b0f77b9caac091e", "committedDate": "2020-06-03T14:15:49Z", "message": "Adding a special sort for Scenario Status"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac57d7bd39fc9507e29c0a63841a025a2c7dabfe", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/ac57d7bd39fc9507e29c0a63841a025a2c7dabfe", "committedDate": "2020-06-03T14:17:47Z", "message": "Adding GMModeEvent handler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66ddfe0fcaa7fd5bad7e2b78a76ab46cfa15f8fd", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/66ddfe0fcaa7fd5bad7e2b78a76ab46cfa15f8fd", "committedDate": "2020-06-03T14:26:31Z", "message": "Fixing the sort order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NDEyMTIw", "url": "https://github.com/MegaMek/mekhq/pull/1794#pullrequestreview-429412120", "createdAt": "2020-06-12T01:53:29Z", "commit": {"oid": "66ddfe0fcaa7fd5bad7e2b78a76ab46cfa15f8fd"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwMTo1MzoyOVrOGi0i-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQwMTo1ODo0MFrOGi0nyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE2NTY5MQ==", "bodyText": "Why not try these first?", "url": "https://github.com/MegaMek/mekhq/pull/1794#discussion_r439165691", "createdAt": "2020-06-12T01:53:29Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/sorter/DateStringComparator.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright (c) 2020 - The MegaMek Team. All Rights Reserved.\n+ *\n+ * This file is part of MekHQ.\n+ *\n+ * MekHQ is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * MekHQ is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with MekHQ. If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package mekhq.gui.sorter;\n+\n+import mekhq.campaign.Campaign;\n+\n+import java.io.Serializable;\n+import java.time.LocalDate;\n+import java.time.format.DateTimeFormatter;\n+import java.util.Comparator;\n+\n+public class DateStringComparator implements Comparator<String>, Serializable {\n+    private static final long serialVersionUID = -6745919248211983499L;\n+\n+    private Campaign campaign;\n+\n+    public DateStringComparator(Campaign campaign) {\n+        this.campaign = campaign;\n+    }\n+\n+    @Override\n+    public int compare(String o1, String o2) {\n+        LocalDate dateA;\n+        LocalDate dateB;\n+        try {\n+            dateA = LocalDate.parse(o1, DateTimeFormatter.ofPattern(\n+                    campaign.getCampaignOptions().getDisplayDateFormat()));\n+        } catch (Exception ignored) {\n+            if (\"-\".equals(o2) && \"-\".equals(o1)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ddfe0fcaa7fd5bad7e2b78a76ab46cfa15f8fd"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE2NTk2MA==", "bodyText": "Could o1 and o2 be equal?", "url": "https://github.com/MegaMek/mekhq/pull/1794#discussion_r439165960", "createdAt": "2020-06-12T01:54:40Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/sorter/ScenarioStatusComparator.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright (c) 2020 - The MegaMek Team. All Rights Reserved.\n+ *\n+ * This file is part of MekHQ.\n+ *\n+ * MekHQ is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * MekHQ is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with MekHQ. If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package mekhq.gui.sorter;\n+\n+import mekhq.campaign.mission.Scenario;\n+\n+import java.io.Serializable;\n+import java.util.Comparator;\n+\n+public class ScenarioStatusComparator implements Comparator<String>, Serializable {\n+    private static final long serialVersionUID = -6287998488809978029L;\n+\n+    @Override\n+    public int compare(String o1, String o2) {\n+        int a = -1;\n+        int b = -1;\n+\n+        // First we need to determine the numbers based on the name\n+        for (int i = 0; i < Scenario.S_NUM; i++) {\n+            if (Scenario.getStatusName(i).equals(o1)) {\n+                a = i;\n+            } else if (Scenario.getStatusName(i).equals(o2)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ddfe0fcaa7fd5bad7e2b78a76ab46cfa15f8fd"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE2NjEwMw==", "bodyText": "Comments for which is defeat and which is draw would be nice.", "url": "https://github.com/MegaMek/mekhq/pull/1794#discussion_r439166103", "createdAt": "2020-06-12T01:55:13Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/sorter/ScenarioStatusComparator.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright (c) 2020 - The MegaMek Team. All Rights Reserved.\n+ *\n+ * This file is part of MekHQ.\n+ *\n+ * MekHQ is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * MekHQ is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with MekHQ. If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package mekhq.gui.sorter;\n+\n+import mekhq.campaign.mission.Scenario;\n+\n+import java.io.Serializable;\n+import java.util.Comparator;\n+\n+public class ScenarioStatusComparator implements Comparator<String>, Serializable {\n+    private static final long serialVersionUID = -6287998488809978029L;\n+\n+    @Override\n+    public int compare(String o1, String o2) {\n+        int a = -1;\n+        int b = -1;\n+\n+        // First we need to determine the numbers based on the name\n+        for (int i = 0; i < Scenario.S_NUM; i++) {\n+            if (Scenario.getStatusName(i).equals(o1)) {\n+                a = i;\n+            } else if (Scenario.getStatusName(i).equals(o2)) {\n+                b = i;\n+            }\n+        }\n+\n+        // Now we need to fix the references to Defeat and Draw so they sort nicely\n+        switch (a) {\n+            case 3:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ddfe0fcaa7fd5bad7e2b78a76ab46cfa15f8fd"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE2NjkyMg==", "bodyText": "I think it would be more natural to have a helper method that converted the string to its sort order integer, then just compare the two integers.", "url": "https://github.com/MegaMek/mekhq/pull/1794#discussion_r439166922", "createdAt": "2020-06-12T01:58:40Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/sorter/ScenarioStatusComparator.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright (c) 2020 - The MegaMek Team. All Rights Reserved.\n+ *\n+ * This file is part of MekHQ.\n+ *\n+ * MekHQ is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * MekHQ is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with MekHQ. If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package mekhq.gui.sorter;\n+\n+import mekhq.campaign.mission.Scenario;\n+\n+import java.io.Serializable;\n+import java.util.Comparator;\n+\n+public class ScenarioStatusComparator implements Comparator<String>, Serializable {\n+    private static final long serialVersionUID = -6287998488809978029L;\n+\n+    @Override\n+    public int compare(String o1, String o2) {\n+        int a = -1;\n+        int b = -1;\n+\n+        // First we need to determine the numbers based on the name\n+        for (int i = 0; i < Scenario.S_NUM; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66ddfe0fcaa7fd5bad7e2b78a76ab46cfa15f8fd"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88e8402880f44659023689eab665fc291706ec45", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/88e8402880f44659023689eab665fc291706ec45", "committedDate": "2020-06-15T13:47:02Z", "message": "Modifying sorters based on code review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNzA0MDEx", "url": "https://github.com/MegaMek/mekhq/pull/1794#pullrequestreview-430704011", "createdAt": "2020-06-15T14:34:32Z", "commit": {"oid": "88e8402880f44659023689eab665fc291706ec45"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNDozNDozMlrOGj09YQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNDozNTowOVrOGj0_Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDIyMTAyNQ==", "bodyText": "This will fail on a null string, prefer Objects.equals here to make that case moot.", "url": "https://github.com/MegaMek/mekhq/pull/1794#discussion_r440221025", "createdAt": "2020-06-15T14:34:32Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/sorter/DateStringComparator.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright (c) 2020 - The MegaMek Team. All Rights Reserved.\n+ *\n+ * This file is part of MekHQ.\n+ *\n+ * MekHQ is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * MekHQ is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with MekHQ. If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package mekhq.gui.sorter;\n+\n+import mekhq.campaign.Campaign;\n+\n+import java.io.Serializable;\n+import java.time.LocalDate;\n+import java.time.format.DateTimeFormatter;\n+import java.util.Comparator;\n+\n+public class DateStringComparator implements Comparator<String>, Serializable {\n+    private static final long serialVersionUID = -6745919248211983499L;\n+\n+    private Campaign campaign;\n+\n+    public DateStringComparator(Campaign campaign) {\n+        this.campaign = campaign;\n+    }\n+\n+    @Override\n+    public int compare(String o1, String o2) {\n+        if (o1.equals(o2)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88e8402880f44659023689eab665fc291706ec45"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDIyMTQ1MQ==", "bodyText": "Null check issues again.", "url": "https://github.com/MegaMek/mekhq/pull/1794#discussion_r440221451", "createdAt": "2020-06-15T14:35:09Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/gui/sorter/ScenarioStatusComparator.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright (c) 2020 - The MegaMek Team. All Rights Reserved.\n+ *\n+ * This file is part of MekHQ.\n+ *\n+ * MekHQ is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * MekHQ is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with MekHQ. If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package mekhq.gui.sorter;\n+\n+import mekhq.campaign.mission.Scenario;\n+import mekhq.campaign.parts.Part;\n+\n+import java.io.Serializable;\n+import java.util.Comparator;\n+\n+/**\n+ * This class compares two {@link Scenario} status integers\n+ */\n+public class ScenarioStatusComparator implements Comparator<String>, Serializable {\n+    private static final long serialVersionUID = -6287998488809978029L;\n+\n+    @Override\n+    public int compare(String o1, String o2) {\n+        if (o1.equals(o2)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88e8402880f44659023689eab665fc291706ec45"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "faee2513e04aff20298874be7a13934eac71b6a1", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/faee2513e04aff20298874be7a13934eac71b6a1", "committedDate": "2020-06-15T14:40:08Z", "message": "Fixing null handling for comparisons"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwODAyMTI5", "url": "https://github.com/MegaMek/mekhq/pull/1794#pullrequestreview-430802129", "createdAt": "2020-06-15T16:23:56Z", "commit": {"oid": "faee2513e04aff20298874be7a13934eac71b6a1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4292, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}