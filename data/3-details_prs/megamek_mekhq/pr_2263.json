{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyODM2MTY3", "number": 2263, "title": "2200: Moving Rank System Name to Data", "bodyText": "This fixes #2200. I also did some cleanup in the files and moved them into their own directory.", "createdAt": "2020-12-04T23:03:05Z", "url": "https://github.com/MegaMek/mekhq/pull/2263", "merged": true, "mergeCommit": {"oid": "dce8434c1c674caf8ba284f7e99a0da72a679958"}, "closed": true, "closedAt": "2020-12-14T23:14:38Z", "author": {"login": "Windchild292"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdi-gQAAH2gAyNTMyODM2MTY3OmQ3NzBlNjdlMjYyMzcyMzQ1NTM5Njc2OTZlNTQ2ZWY0Y2Q1ZTZjNGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmNxbrgH2gAyNTMyODM2MTY3OjY1MGM5ZDY2NWU5MDlmMWU3YzFhZTU3NDYyY2NkYTU5NGVjODAzNzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d770e67e26237234553967696e546ef4cd5e6c4a", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/d770e67e26237234553967696e546ef4cd5e6c4a", "committedDate": "2020-12-04T21:20:00Z", "message": "Moving ranks to their own folder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "198ea362215a2605015f13d5baf7a6f9a27e2323", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/198ea362215a2605015f13d5baf7a6f9a27e2323", "committedDate": "2020-12-04T22:57:54Z", "message": "Moving ranks system names to the Rank XML file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "875b9bde08ba7c0910c8ad45925cc1912afc0db9", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/875b9bde08ba7c0910c8ad45925cc1912afc0db9", "committedDate": "2020-12-05T05:29:07Z", "message": "Fixing unit test failures"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxODg3ODg5", "url": "https://github.com/MegaMek/mekhq/pull/2263#pullrequestreview-551887889", "createdAt": "2020-12-14T20:59:31Z", "commit": {"oid": "875b9bde08ba7c0910c8ad45925cc1912afc0db9"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQyMDo1OTozMVrOIFomyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQyMTowMToyMVrOIFoufA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc3OTA4MQ==", "bodyText": "Honestly I think we can delete this old migration and its associated code.\nThoughts @HammerGS @neoancient ?", "url": "https://github.com/MegaMek/mekhq/pull/2263#discussion_r542779081", "createdAt": "2020-12-14T20:59:31Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/personnel/Person.java", "diffHunk": "@@ -1956,9 +1959,8 @@ public static Person generateInstanceFromXML(Node wn, Campaign c, Version versio\n                     retVal.gender = Gender.parseFromString(wn2.getTextContent().trim());\n                 } else if (wn2.getNodeName().equalsIgnoreCase(\"rank\")) {\n                     if (version.isLowerThan(\"0.3.4-r1782\")) {\n-                        RankTranslator rt = new RankTranslator(c);\n                         try {\n-                            retVal.rank = rt.getNewRank(c.getRanks().getOldRankSystem(),\n+                            retVal.rank = PersonMigrator.getNewRank(c, c.getRanks().getOldRankSystem(),\n                                     Integer.parseInt(wn2.getTextContent()));\n                         } catch (ArrayIndexOutOfBoundsException e) {\n                             // Do nothing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "875b9bde08ba7c0910c8ad45925cc1912afc0db9"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc4MTA1Mg==", "bodyText": "Another spot where I think we can shed some oldancient migration code.", "url": "https://github.com/MegaMek/mekhq/pull/2263#discussion_r542781052", "createdAt": "2020-12-14T21:01:21Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/personnel/ranks/Ranks.java", "diffHunk": "@@ -442,36 +403,47 @@ public static Ranks generateInstanceFromXML(Node wn, Version version) {\n             for (int x = 0; x < nl.getLength(); x++) {\n                 Node wn2 = nl.item(x);\n \n-                if (wn2.getNodeName().equalsIgnoreCase(\"system\") || wn2.getNodeName().equalsIgnoreCase(\"rankSystem\")) {\n-                    retVal.rankSystem = Integer.parseInt(wn2.getTextContent());\n+                if (wn2.getNodeName().equalsIgnoreCase(\"system\")\n+                        || wn2.getNodeName().equalsIgnoreCase(\"rankSystem\")) {\n+                    retVal.rankSystem = Integer.parseInt(wn2.getTextContent().trim());\n \n                     // If this is an older version from before the full blown rank system with\n                     // professions, we need to translate it to match the new constants\n-                    if (version != null && version.isLowerThan(\"0.3.4-r1782\")) {\n+                    if ((version != null) && version.isLowerThan(\"0.3.4-r1782\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "875b9bde08ba7c0910c8ad45925cc1912afc0db9"}, "originalPosition": 274}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abcac4a6acc61c8eb4aa26dd0d73c02498569851", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/abcac4a6acc61c8eb4aa26dd0d73c02498569851", "committedDate": "2020-12-14T22:42:34Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "650c9d665e909f1e7c1ae57462ccda594ec80371", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/650c9d665e909f1e7c1ae57462ccda594ec80371", "committedDate": "2020-12-14T22:49:07Z", "message": "Removing ancient migration code"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3945, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}