{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyMjI5ODI4", "number": 1715, "title": "Prisoner Status Enum", "bodyText": "This PR moves Prisoner Status to an Enum, and changes the logic to occur in a single method instead of across multiple files (which fixes a few minor bugs originating from the spread out code)\nThis was a much larger PR than I expected (I am sorry about this, but it does fix a few minor bugs because of a lack of standardization), and should be reviewed with whitespace differences off.", "createdAt": "2020-05-01T17:49:47Z", "url": "https://github.com/MegaMek/mekhq/pull/1715", "merged": true, "mergeCommit": {"oid": "68a0150beb370eb26184d7f91fd91e08f82a3a58"}, "closed": true, "closedAt": "2020-05-30T12:51:12Z", "author": {"login": "Windchild292"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVLGNnAH2gAyNDEyMjI5ODI4OjM0ZTAxOTMwMjhkMTlmNjM1NTgwYTc3OTNjMzBlMGFiMzg2ZWMwZTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcmWTo5AH2gAyNDEyMjI5ODI4OjU3MzUxNDRiMGNjNDA4ZDkwY2RhZWE1ODgxZTg2Zjc5ZDIwMjA0MmM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "34e0193028d19f635580a7793c30e0ab386ec0e4", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/34e0193028d19f635580a7793c30e0ab386ec0e4", "committedDate": "2020-04-07T03:54:14Z", "message": "Adding and implementing the PrisonerStatus enum"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a53a2d148127ee9203907ac9e1c0510712c22f4d", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/a53a2d148127ee9203907ac9e1c0510712c22f4d", "committedDate": "2020-04-07T03:55:20Z", "message": "Adding comments explaining the enum choice"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c26a2617e35ea9ebee2ae6f976709083046aa55", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/9c26a2617e35ea9ebee2ae6f976709083046aa55", "committedDate": "2020-04-11T14:29:08Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b916ef3f09b28a560f8fcb6b8924ade16b02f33", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/9b916ef3f09b28a560f8fcb6b8924ade16b02f33", "committedDate": "2020-04-11T15:02:48Z", "message": "Rework using lessons learned from BabySurname implemenation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9242bd9c84d47d4be4e47a89c4331eb00a1efcbb", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/9242bd9c84d47d4be4e47a89c4331eb00a1efcbb", "committedDate": "2020-04-11T15:07:07Z", "message": "Fixing spacing issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1430caf8f73a963573b6b78fd7956eca5222dde", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/d1430caf8f73a963573b6b78fd7956eca5222dde", "committedDate": "2020-04-11T15:39:55Z", "message": "Adding Prisoner Defector"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06ca470ac008f81042b734c3e218f41b898c83e6", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/06ca470ac008f81042b734c3e218f41b898c83e6", "committedDate": "2020-04-11T15:40:40Z", "message": "Improving how we do prisoners"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdd8e7c9cd24b495753397bce4cd39a7faacbc5e", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/cdd8e7c9cd24b495753397bce4cd39a7faacbc5e", "committedDate": "2020-04-11T15:53:25Z", "message": "Adding setPrisonerStatus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6277243f163f112b9ef2035688d80d6ffa095e52", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/6277243f163f112b9ef2035688d80d6ffa095e52", "committedDate": "2020-04-11T16:00:16Z", "message": "Removing WillingToDefect logic, as it is now an enum type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "714defd721559ce2c54773f5e227c4e0cfd49f3c", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/714defd721559ce2c54773f5e227c4e0cfd49f3c", "committedDate": "2020-04-11T16:07:21Z", "message": "Renaming PrisonerStatus to OppositionPersonnelStatus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dbce5c122315a39e49b070128ebac601b1a8757", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/8dbce5c122315a39e49b070128ebac601b1a8757", "committedDate": "2020-04-11T16:08:03Z", "message": "Adding bulk change prisoner status (this might be removed)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d2c8be12c8fed89d7efc27b0f53e6cefd2a60c1", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/7d2c8be12c8fed89d7efc27b0f53e6cefd2a60c1", "committedDate": "2020-04-11T16:09:09Z", "message": "Simplifying the code to significantly improve performance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b30fa8024c422882a79e83dcba20975b915ae87", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/0b30fa8024c422882a79e83dcba20975b915ae87", "committedDate": "2020-04-11T16:52:50Z", "message": "Implementing and merging methods for changing PrisonerStatus (as we currently have a few bugs relating to this)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f25fe58738bf90b484618591c1c7a0ddf6ce34e", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/1f25fe58738bf90b484618591c1c7a0ddf6ce34e", "committedDate": "2020-04-11T17:04:49Z", "message": "Removing all remaining comparisons that aren't part of PrisonerStatus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3da6231afc92caac2778a7f3a07343a22ed73186", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/3da6231afc92caac2778a7f3a07343a22ed73186", "committedDate": "2020-04-11T18:51:51Z", "message": "Fixing recruitPerson calls, and finishing up the logic for how defectors can happen"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a38c489fddbe7725e755c59caa28a8dcc30ec2cb", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/a38c489fddbe7725e755c59caa28a8dcc30ec2cb", "committedDate": "2020-04-11T19:40:34Z", "message": "Applying changes from personal review, part 1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7abf11da1e7f8741e4f73958ec949f3f612c7b95", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/7abf11da1e7f8741e4f73958ec949f3f612c7b95", "committedDate": "2020-04-11T19:46:11Z", "message": "Making imprison bulk usable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "595fe178aea358b2631169068e3baf8fa3593bff", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/595fe178aea358b2631169068e3baf8fa3593bff", "committedDate": "2020-04-11T19:53:15Z", "message": "Bulk imprison is now enabled"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "962ab1c8ab38e5e9f03c2caaa1ce13b886eae9b5", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/962ab1c8ab38e5e9f03c2caaa1ce13b886eae9b5", "committedDate": "2020-04-13T20:25:03Z", "message": "Fixing merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5ca317b595f7cb3b82d5fcd7aa4e53db72e19df", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/c5ca317b595f7cb3b82d5fcd7aa4e53db72e19df", "committedDate": "2020-04-16T22:40:36Z", "message": "fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c379832ece35d6ff4c9588e4feacc2fb9d9af946", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/c379832ece35d6ff4c9588e4feacc2fb9d9af946", "committedDate": "2020-04-29T01:18:37Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72748fb21d642ec1a81bfa07dc1e57438f37bb93", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/72748fb21d642ec1a81bfa07dc1e57438f37bb93", "committedDate": "2020-05-01T17:49:14Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3c4762ecd5c5f399cd7f5ff2d4aaf47adaa9583", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/e3c4762ecd5c5f399cd7f5ff2d4aaf47adaa9583", "committedDate": "2020-05-08T14:59:50Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNDAzNDI0", "url": "https://github.com/MegaMek/mekhq/pull/1715#pullrequestreview-411403424", "createdAt": "2020-05-14T01:21:41Z", "commit": {"oid": "e3c4762ecd5c5f399cd7f5ff2d4aaf47adaa9583"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwMToyMTo0MVrOGVI45Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwMToyNDoyM1rOGVI7nA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgxODkxNw==", "bodyText": "You probably still need to say which hash.", "url": "https://github.com/MegaMek/mekhq/pull/1715#discussion_r424818917", "createdAt": "2020-05-14T01:21:41Z", "author": {"login": "NickAragua"}, "path": "MekHQ/src/mekhq/campaign/ResolveScenarioTracker.java", "diffHunk": "@@ -951,24 +952,21 @@ private void processPrisonerCapture(List<TestUnit> unitsToProcess) {\n                 if (null != en.getCrew()) {\n                     currentHits = en.getCrew().getHits();\n                 }\n-                int newHits = (int) Math.max(0, currentHits - existingHits);\n-                casualties = (int) Math.ceil(Compute.getFullCrewSize(en) * (newHits/6.0));\n+                int newHits = Math.max(0, currentHits - existingHits);\n+                casualties = (int) Math.ceil(Compute.getFullCrewSize(en) * (newHits / 6.0));\n             }\n-            for(Person p : crew) {\n-                // Give them a UUID. We won't actually use this for the campaign, but to\n-                //identify them in the prisonerStatus hash\n-                UUID id = p.getId();\n-                if (null == id) {\n-                    id = UUID.randomUUID();\n-                    p.setId(id);\n-                }\n-                PrisonerStatus status = new PrisonerStatus(p.getFullName(), u.getEntity().getDisplayName(), p);\n+            for (Person p : crew) {\n+                // We need to assign them a UUID now to place them into the hash", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3c4762ecd5c5f399cd7f5ff2d4aaf47adaa9583"}, "originalPosition": 148}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgxOTYxMg==", "bodyText": "Seems almost identical to the Bondsman functionality. Is this a) intended, and b) if it is, can it be consolidated?", "url": "https://github.com/MegaMek/mekhq/pull/1715#discussion_r424819612", "createdAt": "2020-05-14T01:24:23Z", "author": {"login": "NickAragua"}, "path": "MekHQ/src/mekhq/campaign/personnel/Person.java", "diffHunk": "@@ -516,44 +507,75 @@ public void setDependent(boolean tf) {\n         }\n     }\n \n-    public boolean isPrisoner() {\n-        return prisonerStatus == PRISONER_YES;\n-    }\n-\n-    public void setPrisoner() {\n-        prisonerStatus = PRISONER_YES;\n-        setRankNumeric(Ranks.RANK_PRISONER);\n-    }\n-\n-    public boolean isBondsman() {\n-        return prisonerStatus == PRISONER_BONDSMAN;\n-    }\n-\n-    public void setBondsman() {\n-        prisonerStatus = PRISONER_BONDSMAN;\n-        willingToDefect = false;\n-        setRankNumeric(Ranks.RANK_BONDSMAN);\n+    public PrisonerStatus getPrisonerStatus() {\n+        return prisonerStatus;\n     }\n \n-    public boolean isFree() {\n-        return (!isPrisoner() && !isBondsman());\n+    public void setPrisonerStatus(PrisonerStatus prisonerStatus) {\n+        setPrisonerStatus(prisonerStatus, true);\n     }\n \n-    public void setFreeMan() {\n-        prisonerStatus = PRISONER_NOT;\n-        willingToDefect = false;\n-    }\n+    public void setPrisonerStatus(PrisonerStatus prisonerStatus, boolean log) {\n+        boolean freed = !this.prisonerStatus.isFree();\n+        this.prisonerStatus = prisonerStatus;\n \n-    public int getPrisonerStatus() {\n-        return prisonerStatus;\n-    }\n+        // Now, we need to fix values and ranks based on the Person's status\n+        switch (prisonerStatus) {\n+            case PRISONER:\n+            case PRISONER_DEFECTOR:\n+                // They don't get to have a rank. Their rank is Bondsman.\n+                getCampaign().changeRank(this, Ranks.RANK_BONDSMAN, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3c4762ecd5c5f399cd7f5ff2d4aaf47adaa9583"}, "originalPosition": 88}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "488524f540a451509c81b3d6e52a1705f92ee293", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/488524f540a451509c81b3d6e52a1705f92ee293", "committedDate": "2020-05-16T21:38:02Z", "message": "Improving prisoner status save functionality"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31e7525edd96c3eb0c1915f9eec60067ed4868fe", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/31e7525edd96c3eb0c1915f9eec60067ed4868fe", "committedDate": "2020-05-16T21:39:14Z", "message": "Fixing merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51f47650ece1abcbdacbda91d80c4f798470143a", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/51f47650ece1abcbdacbda91d80c4f798470143a", "committedDate": "2020-05-16T21:41:11Z", "message": "Adding hash comment clarification"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMzcwMjMy", "url": "https://github.com/MegaMek/mekhq/pull/1715#pullrequestreview-421370232", "createdAt": "2020-05-30T02:25:40Z", "commit": {"oid": "51f47650ece1abcbdacbda91d80c4f798470143a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5b3185710767cdfe95f55361dd345a6baf314ec", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/b5b3185710767cdfe95f55361dd345a6baf314ec", "committedDate": "2020-05-30T12:22:10Z", "message": "Fixing formatting issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5735144b0cc408d90cdaea5881e86f79d202042c", "author": {"user": {"login": "Windchild292", "name": "Justin Bowen"}}, "url": "https://github.com/MegaMek/mekhq/commit/5735144b0cc408d90cdaea5881e86f79d202042c", "committedDate": "2020-05-30T12:34:34Z", "message": "Fixing merge conflicts"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4417, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}