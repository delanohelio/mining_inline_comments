{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxNTE1MDY1", "number": 1997, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNjoxOTowOFrOEg_GTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNjoxOTowOFrOEg_GTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzMDIzNjk0OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/CampaignOptions.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNjoxOTowOFrOHOEQDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNjozMjozN1rOHOEgmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUxMTc1OA==", "bodyText": "How will this handle older saves?", "url": "https://github.com/MegaMek/mekhq/pull/1997#discussion_r484511758", "createdAt": "2020-09-07T16:19:08Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/CampaignOptions.java", "diffHunk": "@@ -3852,14 +3852,14 @@ public static CampaignOptions generateCampaignOptionsFromXml(Node wn) {\n             } else if (wn2.getNodeName().equalsIgnoreCase(\"intensity\")) { // Legacy\n                 double intensity = Double.parseDouble(wn2.getTextContent().trim());\n \n-                retVal.atbBattleChance[AtBLanceRole.FIGHTING.ordinal()] = ((40.0 * intensity) / (40.0 * intensity + 60.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.DEFENCE.ordinal()] = ((20.0 * intensity) / (20.0 * intensity + 80.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.SCOUTING.ordinal()] = ((60.0 * intensity) / (60.0 * intensity + 40.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.TRAINING.ordinal()] = ((10.0 * intensity) / (10.0 * intensity + 90.0)) * 100.0 + 0.5;\n+                retVal.atbBattleChance[AtBLanceRole.FIGHTING.ordinal()] = (int) Math.round(((40.0 * intensity) / (40.0 * intensity + 60.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.DEFENCE.ordinal()] = (int) Math.round(((20.0 * intensity) / (20.0 * intensity + 80.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.SCOUTING.ordinal()] = (int) Math.round(((60.0 * intensity) / (60.0 * intensity + 40.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.TRAINING.ordinal()] = (int) Math.round(((10.0 * intensity) / (10.0 * intensity + 90.0)) * 100.0 + 0.5);\n             } else if (wn2.getNodeName().equalsIgnoreCase(\"atbBattleChance\")) {\n                 String[] values = wn2.getTextContent().split(\",\");\n                 for (int i = 0; i < values.length; i++) {\n-                    retVal.atbBattleChance[i] = Double.parseDouble(values[i]);\n+                    retVal.atbBattleChance[i] = Integer.parseInt(values[i]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2d0323e79f5df976f52f8500f63f93aa09a1029"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUxMzA0Nw==", "bodyText": "Not been on any released versions, so I didn't think it would be necessary... however just remembered that a few outside of the dev team have been using this, so I'll add migration now.", "url": "https://github.com/MegaMek/mekhq/pull/1997#discussion_r484513047", "createdAt": "2020-09-07T16:23:03Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/CampaignOptions.java", "diffHunk": "@@ -3852,14 +3852,14 @@ public static CampaignOptions generateCampaignOptionsFromXml(Node wn) {\n             } else if (wn2.getNodeName().equalsIgnoreCase(\"intensity\")) { // Legacy\n                 double intensity = Double.parseDouble(wn2.getTextContent().trim());\n \n-                retVal.atbBattleChance[AtBLanceRole.FIGHTING.ordinal()] = ((40.0 * intensity) / (40.0 * intensity + 60.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.DEFENCE.ordinal()] = ((20.0 * intensity) / (20.0 * intensity + 80.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.SCOUTING.ordinal()] = ((60.0 * intensity) / (60.0 * intensity + 40.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.TRAINING.ordinal()] = ((10.0 * intensity) / (10.0 * intensity + 90.0)) * 100.0 + 0.5;\n+                retVal.atbBattleChance[AtBLanceRole.FIGHTING.ordinal()] = (int) Math.round(((40.0 * intensity) / (40.0 * intensity + 60.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.DEFENCE.ordinal()] = (int) Math.round(((20.0 * intensity) / (20.0 * intensity + 80.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.SCOUTING.ordinal()] = (int) Math.round(((60.0 * intensity) / (60.0 * intensity + 40.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.TRAINING.ordinal()] = (int) Math.round(((10.0 * intensity) / (10.0 * intensity + 90.0)) * 100.0 + 0.5);\n             } else if (wn2.getNodeName().equalsIgnoreCase(\"atbBattleChance\")) {\n                 String[] values = wn2.getTextContent().split(\",\");\n                 for (int i = 0; i < values.length; i++) {\n-                    retVal.atbBattleChance[i] = Double.parseDouble(values[i]);\n+                    retVal.atbBattleChance[i] = Integer.parseInt(values[i]);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUxMTc1OA=="}, "originalCommit": {"oid": "a2d0323e79f5df976f52f8500f63f93aa09a1029"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUxNTk5Mg==", "bodyText": "Implemented a (not great, but working) migration method. We want it to fail if it can't parse the boolean.", "url": "https://github.com/MegaMek/mekhq/pull/1997#discussion_r484515992", "createdAt": "2020-09-07T16:32:37Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/CampaignOptions.java", "diffHunk": "@@ -3852,14 +3852,14 @@ public static CampaignOptions generateCampaignOptionsFromXml(Node wn) {\n             } else if (wn2.getNodeName().equalsIgnoreCase(\"intensity\")) { // Legacy\n                 double intensity = Double.parseDouble(wn2.getTextContent().trim());\n \n-                retVal.atbBattleChance[AtBLanceRole.FIGHTING.ordinal()] = ((40.0 * intensity) / (40.0 * intensity + 60.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.DEFENCE.ordinal()] = ((20.0 * intensity) / (20.0 * intensity + 80.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.SCOUTING.ordinal()] = ((60.0 * intensity) / (60.0 * intensity + 40.0)) * 100.0 + 0.5;\n-                retVal.atbBattleChance[AtBLanceRole.TRAINING.ordinal()] = ((10.0 * intensity) / (10.0 * intensity + 90.0)) * 100.0 + 0.5;\n+                retVal.atbBattleChance[AtBLanceRole.FIGHTING.ordinal()] = (int) Math.round(((40.0 * intensity) / (40.0 * intensity + 60.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.DEFENCE.ordinal()] = (int) Math.round(((20.0 * intensity) / (20.0 * intensity + 80.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.SCOUTING.ordinal()] = (int) Math.round(((60.0 * intensity) / (60.0 * intensity + 40.0)) * 100.0 + 0.5);\n+                retVal.atbBattleChance[AtBLanceRole.TRAINING.ordinal()] = (int) Math.round(((10.0 * intensity) / (10.0 * intensity + 90.0)) * 100.0 + 0.5);\n             } else if (wn2.getNodeName().equalsIgnoreCase(\"atbBattleChance\")) {\n                 String[] values = wn2.getTextContent().split(\",\");\n                 for (int i = 0; i < values.length; i++) {\n-                    retVal.atbBattleChance[i] = Double.parseDouble(values[i]);\n+                    retVal.atbBattleChance[i] = Integer.parseInt(values[i]);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUxMTc1OA=="}, "originalCommit": {"oid": "a2d0323e79f5df976f52f8500f63f93aa09a1029"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2230, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}