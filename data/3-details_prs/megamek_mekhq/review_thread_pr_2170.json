{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwOTI1Nzg0", "number": 2170, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo0NDo1MVrOEyed2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo0ODoxMVrOEyej7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMzYzNDE3OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/Campaign.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo0NDo1MVrOHpI9sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo0NDo1MVrOHpI9sA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkwMDUyOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if ((roll == 2)  && (doctor.getCurrentEdge() > 0) && (target.getValue() != TargetRoll.AUTOMATIC_SUCCESS)) {\n          \n          \n            \n                        if ((roll == 2) && (doctor.getCurrentEdge() > 0) && (target.getValue() != TargetRoll.AUTOMATIC_SUCCESS)) {", "url": "https://github.com/MegaMek/mekhq/pull/2170#discussion_r512900528", "createdAt": "2020-10-27T17:44:51Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -2052,9 +2052,9 @@ public String healPerson(Person medWork, Person doctor) {\n         int xpGained = 0;\n         //If we get a natural 2 that isn't an automatic success, reroll if Edge is available and in use.\n         if (getCampaignOptions().useSupportEdge()\n-                && (doctor.getOptions().booleanOption(PersonnelOptions.EDGE_MEDICAL))) {\n-            if (roll == 2  && doctor.getCurrentEdge() > 0 && target.getValue() != TargetRoll.AUTOMATIC_SUCCESS) {\n-                doctor.setCurrentEdge(doctor.getCurrentEdge() - 1);\n+                && doctor.getOptions().booleanOption(PersonnelOptions.EDGE_MEDICAL)) {\n+            if ((roll == 2)  && (doctor.getCurrentEdge() > 0) && (target.getValue() != TargetRoll.AUTOMATIC_SUCCESS)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87a66b0b6e807d577eefefada5abc32a73d9ceea"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMzY0MzY2OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/Campaign.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo0Njo1M1rOHpJDlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo0Njo1M1rOHpJDlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkwMjAzOQ==", "bodyText": "Can we indent the ands and ors to make it more obvious which connects with which?", "url": "https://github.com/MegaMek/mekhq/pull/2170#discussion_r512902039", "createdAt": "2020-10-27T17:46:53Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -2920,26 +2914,24 @@ public String fixPart(IPartWork partWork, Person tech) {\n         //if we fail and would break a part, here's a chance to use Edge for a reroll...\n         if (getCampaignOptions().useSupportEdge()\n                 && tech.getOptions().booleanOption(PersonnelOptions.EDGE_REPAIR_BREAK_PART)\n-                && tech.getCurrentEdge() > 0\n-                && target.getValue() != TargetRoll.AUTOMATIC_SUCCESS) {\n+                && (tech.getCurrentEdge() > 0)\n+                && (target.getValue() != TargetRoll.AUTOMATIC_SUCCESS)) {\n             if ((getCampaignOptions().isDestroyByMargin()\n-                    && getCampaignOptions().getDestroyMargin() <= (target.getValue() - roll))\n-                    || (!getCampaignOptions().isDestroyByMargin() && (tech.getExperienceLevel(false) == SkillType.EXP_ELITE //if an elite, primary tech and destroy by margin is NOT on\n-                                    || tech.getPrimaryRole() == Person.T_SPACE_CREW)) // For vessel crews\n-                            && roll < target.getValue()) {\n-                tech.setCurrentEdge(tech.getCurrentEdge() - 1);\n-                if (tech.isRightTechTypeFor(partWork)) {\n-                    roll = Compute.d6(2);\n-                } else {\n-                    roll = Utilities.roll3d6();\n-                }\n+                    && (getCampaignOptions().getDestroyMargin() <= (target.getValue() - roll)))\n+                    || (!getCampaignOptions().isDestroyByMargin()\n+                    && ((tech.getExperienceLevel(false) == SkillType.EXP_ELITE) //if an elite, primary tech and destroy by margin is NOT on\n+                    || (tech.getPrimaryRole() == Person.T_SPACE_CREW))) // For vessel crews\n+                    && (roll < target.getValue())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87a66b0b6e807d577eefefada5abc32a73d9ceea"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMzY0OTc1OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/personnel/Person.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo0ODoxMVrOHpJHow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxODowNDozOFrOHpJ6fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkwMzA3NQ==", "bodyText": "Should currentEdge be allowed to dip below 0?", "url": "https://github.com/MegaMek/mekhq/pull/2170#discussion_r512903075", "createdAt": "2020-10-27T17:48:11Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/personnel/Person.java", "diffHunk": "@@ -3104,6 +3104,10 @@ public void setCurrentEdge(int e) {\n         currentEdge = e;\n     }\n \n+    public void changeCurrentEdge(int amount) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87a66b0b6e807d577eefefada5abc32a73d9ceea"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkwOTU2Ng==", "bodyText": "Because of how this is used it cannot drop below 0. However... I could rework this into returning a boolean value and add it to the if statements instead of having the current check?", "url": "https://github.com/MegaMek/mekhq/pull/2170#discussion_r512909566", "createdAt": "2020-10-27T17:56:28Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/personnel/Person.java", "diffHunk": "@@ -3104,6 +3104,10 @@ public void setCurrentEdge(int e) {\n         currentEdge = e;\n     }\n \n+    public void changeCurrentEdge(int amount) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkwMzA3NQ=="}, "originalCommit": {"oid": "87a66b0b6e807d577eefefada5abc32a73d9ceea"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkxMzAwNw==", "bodyText": "I think the more straightforward change:\ncurrentEdge = Math.max(currentEdge + amount, 0);\n\nAlso protects us from future areas that aren't so good at checking (I was thinking GM Edge, but I think that just 'sets' the edge).", "url": "https://github.com/MegaMek/mekhq/pull/2170#discussion_r512913007", "createdAt": "2020-10-27T18:00:36Z", "author": {"login": "sixlettervariables"}, "path": "MekHQ/src/mekhq/campaign/personnel/Person.java", "diffHunk": "@@ -3104,6 +3104,10 @@ public void setCurrentEdge(int e) {\n         currentEdge = e;\n     }\n \n+    public void changeCurrentEdge(int amount) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkwMzA3NQ=="}, "originalCommit": {"oid": "87a66b0b6e807d577eefefada5abc32a73d9ceea"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkxNjA5NA==", "bodyText": "Implemented, and that does just set the edge.", "url": "https://github.com/MegaMek/mekhq/pull/2170#discussion_r512916094", "createdAt": "2020-10-27T18:04:38Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/personnel/Person.java", "diffHunk": "@@ -3104,6 +3104,10 @@ public void setCurrentEdge(int e) {\n         currentEdge = e;\n     }\n \n+    public void changeCurrentEdge(int amount) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkwMzA3NQ=="}, "originalCommit": {"oid": "87a66b0b6e807d577eefefada5abc32a73d9ceea"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2145, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}