{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMDI3Nzcx", "number": 2137, "title": "Units, Parts, and Refits hold actual Person instances", "bodyText": "As with the part ID fix, this switches from person IDs littered throughout Unit, Part, and Refit.\nThere are two behavioral changes to this PR as well:\n\nImporting parts no longer merges spares (we were already doing this later)\nSpare parts do not include parts queued for refits or overnight work\n\nI've added a test for this as well\n\n\n\nBoth of these caused issues with the ID fixups on \"weird\" campaigns.", "createdAt": "2020-10-10T19:45:20Z", "url": "https://github.com/MegaMek/mekhq/pull/2137", "merged": true, "mergeCommit": {"oid": "7eafd9cf22f76ad54662845471ec5e6d94654778"}, "closed": true, "closedAt": "2020-10-22T19:07:06Z", "author": {"login": "sixlettervariables"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRPwCyAH2gAyNTAxMDI3NzcxOjEzZGU5NDhiMzQxNjZkNzNmNGY3YTJlNWE4OTgyYzlmNjkzYjEyYmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVGeMHgH2gAyNTAxMDI3NzcxOjg0NThlNWViOTY0Y2Y5YmRmNjQxNTE4NWJiODFiYjE3NGNkZGU0MTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "13de948b34166d73f4f7a2e5a8982c9f693b12bc", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/13de948b34166d73f4f7a2e5a8982c9f693b12bc", "committedDate": "2020-10-10T19:15:00Z", "message": "Use Person directly instead of IDs in Unit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "923a477ddb1060c2a48c13cca7c5900a40c0f82a", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/923a477ddb1060c2a48c13cca7c5900a40c0f82a", "committedDate": "2020-10-10T19:15:00Z", "message": "Use Person instead of an ID"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a0bf95eb1bd02bc135eda57ab5ab299b0cb9cb0", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/2a0bf95eb1bd02bc135eda57ab5ab299b0cb9cb0", "committedDate": "2020-10-10T19:15:00Z", "message": "Add tests for spare part invariants"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58291b29acbe7cc24a4491f3d3ab911f0468a7dc", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/58291b29acbe7cc24a4491f3d3ab911f0468a7dc", "committedDate": "2020-10-10T19:41:57Z", "message": "Fix logic to check for Already Being Worked On"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MTI0Mzg5", "url": "https://github.com/MegaMek/mekhq/pull/2137#pullrequestreview-506124389", "createdAt": "2020-10-10T20:28:38Z", "commit": {"oid": "58291b29acbe7cc24a4491f3d3ab911f0468a7dc"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMFQyMDoyODozOFrOHfiQVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMFQyMDozMTo0OFrOHfiReQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjgyOTE0Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            } else if (u.getTech() != null && !tech.getId().equals(u.getTech().getId())) {\n          \n          \n            \n                            } else if (!tech.equals(u.getTech())) {", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r502829142", "createdAt": "2020-10-10T20:28:38Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/io/CampaignXmlParser.java", "diffHunk": "@@ -741,20 +729,20 @@ private void fixupUnitTechProblems(Campaign retVal) {\n                 if (null == u) {\n                     reason = \"referenced missing unit\";\n                     tech.removeTechUnitId(id);\n-                } else if (null == u.getTechId()) {\n+                } else if (null == u.getTech()) {\n                     reason = \"was not referenced by unit\";\n                     u.setTech(tech);\n                 } else if (u.isMothballed()) {\n                     reason = \"referenced mothballed unit\";\n                     unitDesc = u.getName();\n                     tech.removeTechUnitId(id);\n-                } else if (!tech.getId().equals(u.getTechId())) {\n+                } else if (u.getTech() != null && !tech.getId().equals(u.getTech().getId())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58291b29acbe7cc24a4491f3d3ab911f0468a7dc"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjgyOTQzMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (tech == u.getTech()) {\n          \n          \n            \n                        if (tech.equals(u.getTech())) {", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r502829433", "createdAt": "2020-10-10T20:31:48Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/Campaign.java", "diffHunk": "@@ -3747,16 +3689,16 @@ public void removeAllTechJobsFor(Person tech) {\n             return;\n         }\n         getHangar().forEachUnit(u -> {\n-            if (tech.getId().equals(u.getTechId())) {\n+            if (tech == u.getTech()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58291b29acbe7cc24a4491f3d3ab911f0468a7dc"}, "originalPosition": 223}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/9f8fe3ab3ac23c3c2302ca817551a455b5951724", "committedDate": "2020-10-10T21:03:02Z", "message": "Fix exception thrown when PersonTechAssignmentEvent has null person"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwODcwOTMz", "url": "https://github.com/MegaMek/mekhq/pull/2137#pullrequestreview-510870933", "createdAt": "2020-10-17T03:42:40Z", "commit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "state": "COMMENTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QwMzo0Mjo0MFrOHjT9AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xN1QwNDowMDoxNlrOHjUB1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc4OTEyMQ==", "bodyText": "Why is this still using the Id?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506789121", "createdAt": "2020-10-17T03:42:40Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/actions/ActivateUnitAction.java", "diffHunk": "@@ -57,7 +57,7 @@ public void Execute(Campaign campaign, Unit unit) {\n                 return;\n             }\n \n-            unit.startActivating(techId);\n+            unit.startActivating(campaign.getPerson(techId));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc4OTEyNg==", "bodyText": "Why is this still using the Id?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506789126", "createdAt": "2020-10-17T03:42:51Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/actions/MothballUnitAction.java", "diffHunk": "@@ -54,7 +54,7 @@ public void Execute(Campaign campaign, Unit unit) {\n                 return;\n             }\n \n-            unit.startMothballing(techId);\n+            unit.startMothballing(campaign.getPerson(techId));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc4OTczMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (driver.getStatus().isActive() && driver.getUnitId() == null) {\n          \n          \n            \n                        if (driver.getStatus().isActive() && (driver.getUnitId() == null)) {", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506789732", "createdAt": "2020-10-17T03:51:46Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/MothballInfo.java", "diffHunk": "@@ -79,44 +80,35 @@ public MothballInfo(Unit unit) {\n      * @param campaign The campaign in which this is happening\n      */\n     public void restorePreMothballInfo(Unit unit, Campaign campaign) {\n-        Person tech = campaign.getPerson(techID);\n         if (tech != null) {\n             unit.setTech(tech);\n         }\n \n-        for (UUID driverID : driverIDs) {\n-            Person driver = campaign.getPerson(driverID);\n-\n-            if (driver != null && driver.getStatus().isActive() && driver.getUnitId() == null) {\n+        for (Person driver : drivers) {\n+            if (driver.getStatus().isActive() && driver.getUnitId() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc4OTc4Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (crew.getStatus().isActive() && crew.getUnitId() == null) {\n          \n          \n            \n                        if (crew.getStatus().isActive() && (crew.getUnitId() == null)) {", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506789787", "createdAt": "2020-10-17T03:52:11Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/MothballInfo.java", "diffHunk": "@@ -79,44 +80,35 @@ public MothballInfo(Unit unit) {\n      * @param campaign The campaign in which this is happening\n      */\n     public void restorePreMothballInfo(Unit unit, Campaign campaign) {\n-        Person tech = campaign.getPerson(techID);\n         if (tech != null) {\n             unit.setTech(tech);\n         }\n \n-        for (UUID driverID : driverIDs) {\n-            Person driver = campaign.getPerson(driverID);\n-\n-            if (driver != null && driver.getStatus().isActive() && driver.getUnitId() == null) {\n+        for (Person driver : drivers) {\n+            if (driver.getStatus().isActive() && driver.getUnitId() == null) {\n                 unit.addDriver(driver);\n             }\n         }\n \n-        for (UUID gunnerID : gunnerIDs) {\n-            Person gunner = campaign.getPerson(gunnerID);\n-\n+        for (Person gunner : gunners) {\n             // add the gunner if they exist, aren't dead/retired/etc and aren't already assigned to some\n             // other unit. Caveat: single-person units have the same driver and gunner.\n-            if (gunner != null && gunner.getStatus().isActive() &&\n+            if (gunner.getStatus().isActive() &&\n                     ((gunner.getUnitId() == null) || (gunner.getUnitId() == unit.getId()))) {\n                 unit.addGunner(gunner);\n             }\n         }\n \n-        for (UUID vesselCrewID : vesselCrewIDs) {\n-            Person vesselCrew = campaign.getPerson(vesselCrewID);\n-\n-            if (vesselCrew != null && vesselCrew.getStatus().isActive() && vesselCrew.getUnitId() == null) {\n-                unit.addVesselCrew(vesselCrew);\n+        for (Person crew : vesselCrew) {\n+            if (crew.getStatus().isActive() && crew.getUnitId() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc4OTgyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        MekHqXmlUtil.writeSimpleXmlTag(pw1, indent,  \"forceID\", forceID);\n          \n          \n            \n                        MekHqXmlUtil.writeSimpleXmlTag(pw1, indent, \"forceID\", forceID);", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506789829", "createdAt": "2020-10-17T03:52:44Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/MothballInfo.java", "diffHunk": "@@ -135,38 +127,32 @@ public void restorePreMothballInfo(Unit unit, Campaign campaign) {\n     public void writeToXml(PrintWriter pw1, int indent) {\n         pw1.println(MekHqXmlUtil.indentStr(indent) + \"<mothballInfo>\");\n \n-        if (techID != null) {\n-            pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<techID>\" + techID.toString() + \"</techID>\");\n+        if (tech != null) {\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent, \"techId\", tech.getId());\n         }\n \n         if (forceID > 0) {\n-            pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<forceID>\" + forceID + \"</forceID>\");\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent,  \"forceID\", forceID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc4OTg0NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    pw1.println(MekHqXmlUtil.indentStr(indent) + \"<mothballInfo>\");\n          \n          \n            \n                    pw1.println(MekHqXmlUtil.indentStr(indent++) + \"<mothballInfo>\");", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506789844", "createdAt": "2020-10-17T03:52:56Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/MothballInfo.java", "diffHunk": "@@ -135,38 +127,32 @@ public void restorePreMothballInfo(Unit unit, Campaign campaign) {\n     public void writeToXml(PrintWriter pw1, int indent) {\n         pw1.println(MekHqXmlUtil.indentStr(indent) + \"<mothballInfo>\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 113}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc4OTg3Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    pw1.println(MekHqXmlUtil.indentStr(indent) + \"</mothballInfo>\");\n          \n          \n            \n                    pw1.println(MekHqXmlUtil.indentStr(--indent) + \"</mothballInfo>\");", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506789877", "createdAt": "2020-10-17T03:53:36Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/MothballInfo.java", "diffHunk": "@@ -135,38 +127,32 @@ public void restorePreMothballInfo(Unit unit, Campaign campaign) {\n     public void writeToXml(PrintWriter pw1, int indent) {\n         pw1.println(MekHqXmlUtil.indentStr(indent) + \"<mothballInfo>\");\n \n-        if (techID != null) {\n-            pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<techID>\" + techID.toString() + \"</techID>\");\n+        if (tech != null) {\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent, \"techId\", tech.getId());\n         }\n \n         if (forceID > 0) {\n-            pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<forceID>\" + forceID + \"</forceID>\");\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent,  \"forceID\", forceID);\n         }\n \n-        if (driverIDs.size() > 0) {\n-            for (UUID driverID : driverIDs) {\n-                pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<driverID>\" + driverID.toString() + \"</driverID>\");\n-            }\n+        for (Person driver : drivers) {\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent, \"driverId\", driver.getId());\n         }\n \n-        if (gunnerIDs.size() > 0) {\n-            for (UUID gunnerID : gunnerIDs) {\n-                pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<gunnerID>\" + gunnerID.toString() + \"</gunnerID>\");\n-            }\n+        for (Person gunner : gunners) {\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent, \"gunnerId\", gunner.getId());\n         }\n \n-        if (vesselCrewIDs.size() > 0) {\n-            for (UUID vesselCrewID : vesselCrewIDs) {\n-                pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<vesselCrewID>\" + vesselCrewID.toString() + \"</vesselCrewID>\");\n-            }\n+        for (Person crew : vesselCrew) {\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent, \"vesselCrewId\", crew.getId());\n         }\n \n-        if (techOfficerID != null) {\n-            pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<techOfficerID>\" + techOfficerID.toString() + \"</techOfficerID>\");\n+        if (navigator != null) {\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent, \"navigatorId\", navigator.getId());\n         }\n \n-        if (navigatorID != null) {\n-            pw1.println(MekHqXmlUtil.indentStr(indent + 1) + \"<navigatorID>\" + navigatorID.toString() + \"</navigatorID>\");\n+        if (techOfficer != null) {\n+            MekHqXmlUtil.writeSimpleXmlTag(pw1, indent, \"techOfficerId\", techOfficer.getId());\n         }\n \n         pw1.println(MekHqXmlUtil.indentStr(indent) + \"</mothballInfo>\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 162}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MDE4Nw==", "bodyText": "Can these two be combined?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506790187", "createdAt": "2020-10-17T03:57:47Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -3342,37 +3308,24 @@ public String getCamoFileName() {\n \n         Person commander = null;\n \n-        for (UUID pid : vesselCrew) {\n-            if (pid == null) {\n-                continue;\n-            }\n-            Person p = getCampaign().getPerson(pid);\n-            if ((p != null) && p.outRanks(commander)) {\n+        for (Person p : vesselCrew) {\n+            if (p.outRanks(commander)) {\n                 commander = p;\n             }\n         }\n-        for (UUID pid : gunners) {\n-            if (pid == null) {\n-                continue;\n-            }\n-            Person p = getCampaign().getPerson(pid);\n-            if ((p != null) && p.outRanks(commander)) {\n+        for (Person p : gunners) {\n+            if (p.outRanks(commander)) {\n                 commander = p;\n             }\n         }\n-        for (UUID pid : drivers) {\n-            if (pid == null) {\n-                continue;\n-            }\n-            Person p = getCampaign().getPerson(pid);\n-            if ((p != null) && p.outRanks(commander)) {\n+        for (Person p : drivers) {\n+            if (p.outRanks(commander)) {\n                 commander = p;\n             }\n         }\n         if (navigator != null) {\n-            Person p = getCampaign().getPerson(navigator);\n-            if ((p != null) && p.outRanks(commander)) {\n-                commander = p;\n+            if (navigator.outRanks(commander)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 215}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MDIxOA==", "bodyText": "Can these two be combined", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506790218", "createdAt": "2020-10-17T03:58:19Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -3697,15 +3643,13 @@ private void calcCompositeCrew() {\n             }\n         }\n \n-        for (UUID pid : vesselCrew) {\n-            Person p = getCampaign().getPerson(pid);\n-            if (null !=p && p.getHits() == 0) {\n+        for (Person p : vesselCrew) {\n+            if (p.getHits() == 0) {\n                 nCrew++;\n             }\n         }\n         if (null != navigator) {\n-            Person p = getCampaign().getPerson(navigator);\n-            if (null !=p && p.getHits() == 0) {\n+            if (navigator.getHits() == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 348}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MDMwNQ==", "bodyText": "Can this be made into a ternary?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506790305", "createdAt": "2020-10-17T03:59:33Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4326,69 +4261,51 @@ public void setScenarioId(int i) {\n \n     public ArrayList<Person> getCrew() {\n         ArrayList<Person> crew = new ArrayList<>();\n-        for (UUID id : drivers) {\n-            Person p = getCampaign().getPerson(id);\n-            if (null != p) {\n-                crew.add(p);\n-            }\n+        for (Person p : drivers) {\n+            crew.add(p);\n         }\n         if (!usesSoloPilot() && !usesSoldiers()) {\n-            for (UUID id : gunners) {\n-                Person p = getCampaign().getPerson(id);\n-                if (null != p) {\n-                    crew.add(p);\n-                }\n-            }\n-        }\n-        for (UUID id : vesselCrew) {\n-            Person p = getCampaign().getPerson(id);\n-            if (null != p) {\n+            for (Person p : gunners) {\n                 crew.add(p);\n             }\n         }\n+        for (Person p : vesselCrew) {\n+            crew.add(p);\n+        }\n         if (navigator != null) {\n-            Person p = getCampaign().getPerson(navigator);\n-            if (null != p) {\n-                crew.add(p);\n-            }\n+            crew.add(navigator);\n         }\n         if (techOfficer != null) {\n-            Person p = getCampaign().getPerson(techOfficer);\n-            if (null != p) {\n-                crew.add(p);\n-            }\n+            crew.add(techOfficer);\n         }\n         return crew;\n     }\n \n-    public ArrayList<UUID> getDriverIDs() {\n-        return drivers;\n+    public List<Person> getDrivers() {\n+        return Collections.unmodifiableList(drivers);\n     }\n \n-    public ArrayList<UUID> getGunnerIDs() {\n-        return gunners;\n+    public List<Person> getGunners() {\n+        return Collections.unmodifiableList(gunners);\n     }\n \n-    public ArrayList<UUID> getVesselCrewIDs() {\n-        return vesselCrew;\n+    public List<Person> getVesselCrew() {\n+        return Collections.unmodifiableList(vesselCrew);\n     }\n \n-    public UUID getTechOfficerID() {\n+    public Person getTechOfficer() {\n         return techOfficer;\n     }\n \n-    public UUID getNavigatorID() {\n+    public Person getNavigator() {\n         return navigator;\n     }\n \n     public Person getTech() {\n         if (null != engineer) {\n             return engineer;\n         }\n-        if (null != tech) {\n-            return getCampaign().getPerson(tech);\n-        }\n-        return null;\n+        return tech;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 611}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MDM1Ng==", "bodyText": "Formatting here is odd", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r506790356", "createdAt": "2020-10-17T04:00:16Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4602,43 +4515,28 @@ public void cancelMothballOrActivation() {\n \n     public ArrayList<Person> getActiveCrew() {\n         ArrayList<Person> crew = new ArrayList<>();\n-        for (UUID id : drivers) {\n-            Person p = getCampaign().getPerson(id);\n-            if (null != p) {\n-                if (p.getHits() > 0 && (entity instanceof Tank || entity instanceof Infantry)) {\n-                    continue;\n-                }\n-                crew.add(p);\n+        for (Person p : drivers) {\n+            if (p.getHits() > 0 && (entity instanceof Tank || entity instanceof Infantry)) {\n+                continue;\n             }\n+            crew.add(p);\n         }\n         if (!usesSoloPilot() && !usesSoldiers()) {\n-            for (UUID id : gunners) {\n-                Person p = getCampaign().getPerson(id);\n-                if (null != p) {\n-                    if (p.getHits() > 0 && (entity instanceof Tank || entity instanceof Infantry)) {\n-                        continue;\n-                    }\n-                    crew.add(p);\n+            for (Person p : gunners) {\n+                if (p.getHits() > 0 && (entity instanceof Tank || entity instanceof Infantry)) {\n+                    continue;\n                 }\n-            }\n-        }\n-        for (UUID id : vesselCrew) {\n-            Person p = getCampaign().getPerson(id);\n-            if (null != p) {\n                 crew.add(p);\n             }\n         }\n-        if (null != navigator) {\n-            Person p = getCampaign().getPerson(navigator);\n-            if (null != p) {\n-                crew.add(p);\n-            }\n+        for (Person p : vesselCrew) {\n+            crew.add(p);\n+        }\n+        if (navigator != null) {\n+            crew.add(navigator);\n         }\n         if (techOfficer != null) {\n-            Person p = getCampaign().getPerson(techOfficer);\n-            if (null != p) {\n-                crew.add(p);\n-            }\n+                crew.add(techOfficer);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f8fe3ab3ac23c3c2302ca817551a455b5951724"}, "originalPosition": 747}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8259fdbe865fb089917ad4b909e743c08d5c54b9", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/8259fdbe865fb089917ad4b909e743c08d5c54b9", "committedDate": "2020-10-20T18:10:16Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c1a47e2e6268b362edd3d6eb2e39018b5802179", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/9c1a47e2e6268b362edd3d6eb2e39018b5802179", "committedDate": "2020-10-20T18:49:01Z", "message": "Address PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5d38e8af270f50fc091db05cf882ea8380fe3a7", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/b5d38e8af270f50fc091db05cf882ea8380fe3a7", "committedDate": "2020-10-20T18:49:08Z", "message": "Merge remote-tracking branch 'upstream/master' into units-hold-actual-persons"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzMjM0ODcy", "url": "https://github.com/MegaMek/mekhq/pull/2137#pullrequestreview-513234872", "createdAt": "2020-10-21T00:56:59Z", "commit": {"oid": "9c1a47e2e6268b362edd3d6eb2e39018b5802179"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwMDo1Njo1OVrOHlWbeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQwMDo1Nzo0MVrOHlWcJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkyNjg0MA==", "bodyText": "Doesn't this duplicate the nonNull check?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r508926840", "createdAt": "2020-10-21T00:56:59Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4093,10 +4093,12 @@ public void addDriver(Person p, boolean useTransfers) {\n     }\n \n     public void addGunner(Person p) {\n-        addGunner(p, false);\n+        addGunner(Objects.requireNonNull(p), false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1a47e2e6268b362edd3d6eb2e39018b5802179"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkyNjg0NQ==", "bodyText": "Doesn't this duplicate the nonNull check?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r508926845", "createdAt": "2020-10-21T00:57:01Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4076,10 +4074,12 @@ public boolean usesSoldiers() {\n     }\n \n     public void addDriver(Person p) {\n-        addDriver(p, false);\n+        addDriver(Objects.requireNonNull(p), false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1a47e2e6268b362edd3d6eb2e39018b5802179"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkyNjg2Mw==", "bodyText": "Doesn't this duplicate the nonNull check?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r508926863", "createdAt": "2020-10-21T00:57:07Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4110,10 +4112,12 @@ public void addGunner(Person p, boolean useTransfers) {\n     }\n \n     public void addVesselCrew(Person p) {\n-        addVesselCrew(p, false);\n+        addVesselCrew(Objects.requireNonNull(p), false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1a47e2e6268b362edd3d6eb2e39018b5802179"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkyNjg3Nw==", "bodyText": "Doesn't this duplicate the nonNull check?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r508926877", "createdAt": "2020-10-21T00:57:10Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4127,10 +4131,12 @@ public void addVesselCrew(Person p, boolean useTransfers) {\n     }\n \n     public void setNavigator(Person p) {\n-        setNavigator(p, false);\n+        setNavigator(Objects.requireNonNull(p), false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1a47e2e6268b362edd3d6eb2e39018b5802179"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkyNjk0NA==", "bodyText": "Doesn't this duplicate the nonNull check?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r508926944", "createdAt": "2020-10-21T00:57:25Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4143,15 +4149,17 @@ public void setNavigator(Person p, boolean useTransfers) {\n         MekHQ.triggerEvent(new PersonCrewAssignmentEvent(p, this));\n     }\n \n-    public boolean isTechOfficer(Person p) {\n-        return Objects.equals(techOfficer, p);\n+    public boolean isTechOfficer(@Nullable Person p) {\n+        return (techOfficer != null) && techOfficer.equals(p);\n     }\n \n     public void setTechOfficer(Person p) {\n-        setTechOfficer(p, false);\n+        setTechOfficer(Objects.requireNonNull(p), false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1a47e2e6268b362edd3d6eb2e39018b5802179"}, "originalPosition": 95}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODkyNzAxMw==", "bodyText": "Doesn't this duplicate the nonNull check?", "url": "https://github.com/MegaMek/mekhq/pull/2137#discussion_r508927013", "createdAt": "2020-10-21T00:57:41Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/unit/Unit.java", "diffHunk": "@@ -4193,10 +4203,12 @@ private void ensurePersonIsRegistered(Person p) {\n     }\n \n     public void addPilotOrSoldier(Person p) {\n-        addPilotOrSoldier(p, false);\n+        addPilotOrSoldier(Objects.requireNonNull(p), false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c1a47e2e6268b362edd3d6eb2e39018b5802179"}, "originalPosition": 118}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a2c5a7771668182f3f4e407617fdc68cbbf4df1", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/2a2c5a7771668182f3f4e407617fdc68cbbf4df1", "committedDate": "2020-10-21T19:31:25Z", "message": "Address PR feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0ODU3NjM4", "url": "https://github.com/MegaMek/mekhq/pull/2137#pullrequestreview-514857638", "createdAt": "2020-10-22T15:31:58Z", "commit": {"oid": "2a2c5a7771668182f3f4e407617fdc68cbbf4df1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8458e5eb964cf9bdf6415185bb81bb174cdde412", "author": {"user": {"login": "sixlettervariables", "name": "Christopher Watford"}}, "url": "https://github.com/MegaMek/mekhq/commit/8458e5eb964cf9bdf6415185bb81bb174cdde412", "committedDate": "2020-10-22T18:42:03Z", "message": "Add unit tests for various unit methods related to actual persons"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4014, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}