{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0MjQ3Nzk3", "number": 1730, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNDoxODo0OFrOD6RVJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjoxNTo1MVrOD6UnDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNDI3OTQyOnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNDoxODo0OFrOGSA0FA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjowMDowOVrOGSFeLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MDg4NA==", "bodyText": "This could be done through a ternary instead to cut down on near identical code (image is because I wasn't sure if it would work or not). Thoughts?", "url": "https://github.com/MegaMek/mekhq/pull/1730#discussion_r421540884", "createdAt": "2020-05-07T14:18:48Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "diffHunk": "@@ -686,11 +687,21 @@ public boolean isCompatibleAmmo(AmmoType a1, AmmoType a2) {\n     public int getAmountAvailable() {\n         final AmmoType thisType = (AmmoType)getType();\n         if (campaign.getCampaignOptions().useAmmoByType()) {\n-            AmmoStorage a = (AmmoStorage)campaign.findSparePart(part -> {\n-                return part instanceof AmmoStorage\n-                    && thisType.equals(((AmmoStorage)part).getType())\n-                    && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n-            });\n+            Predicate<Part> predicate;\n+            if (AmmoBin.ALLOWED_BY_TYPE.contains(thisType.getAmmoType())) {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equalsAmmoTypeOnly(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            } else {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equals(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            }\n+            AmmoStorage a = (AmmoStorage)campaign.findSparePart(predicate);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c21bc1d7ab3da4ed743166657a3f4bd9ea8c2126"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYxNTI5Mg==", "bodyText": "In my personal opinion I think in this case the readability of the if statement is a greater benefit. The compiler is not going to care and there will be no performance loss. But if you really prefer the ternary I can put it in and test/commit it.", "url": "https://github.com/MegaMek/mekhq/pull/1730#discussion_r421615292", "createdAt": "2020-05-07T15:57:27Z", "author": {"login": "ChaoticInsanity"}, "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "diffHunk": "@@ -686,11 +687,21 @@ public boolean isCompatibleAmmo(AmmoType a1, AmmoType a2) {\n     public int getAmountAvailable() {\n         final AmmoType thisType = (AmmoType)getType();\n         if (campaign.getCampaignOptions().useAmmoByType()) {\n-            AmmoStorage a = (AmmoStorage)campaign.findSparePart(part -> {\n-                return part instanceof AmmoStorage\n-                    && thisType.equals(((AmmoStorage)part).getType())\n-                    && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n-            });\n+            Predicate<Part> predicate;\n+            if (AmmoBin.ALLOWED_BY_TYPE.contains(thisType.getAmmoType())) {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equalsAmmoTypeOnly(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            } else {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equals(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            }\n+            AmmoStorage a = (AmmoStorage)campaign.findSparePart(predicate);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MDg4NA=="}, "originalCommit": {"oid": "c21bc1d7ab3da4ed743166657a3f4bd9ea8c2126"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYxNzE5OA==", "bodyText": "If you go with the suggested option, you'll need to put in a comment explaining what to do - I personally find complicated ternary statements difficult to parse, and someone looking at that code a year from now will need it explained.", "url": "https://github.com/MegaMek/mekhq/pull/1730#discussion_r421617198", "createdAt": "2020-05-07T16:00:09Z", "author": {"login": "NickAragua"}, "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "diffHunk": "@@ -686,11 +687,21 @@ public boolean isCompatibleAmmo(AmmoType a1, AmmoType a2) {\n     public int getAmountAvailable() {\n         final AmmoType thisType = (AmmoType)getType();\n         if (campaign.getCampaignOptions().useAmmoByType()) {\n-            AmmoStorage a = (AmmoStorage)campaign.findSparePart(part -> {\n-                return part instanceof AmmoStorage\n-                    && thisType.equals(((AmmoStorage)part).getType())\n-                    && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n-            });\n+            Predicate<Part> predicate;\n+            if (AmmoBin.ALLOWED_BY_TYPE.contains(thisType.getAmmoType())) {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equalsAmmoTypeOnly(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            } else {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equals(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            }\n+            AmmoStorage a = (AmmoStorage)campaign.findSparePart(predicate);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU0MDg4NA=="}, "originalCommit": {"oid": "c21bc1d7ab3da4ed743166657a3f4bd9ea8c2126"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNDgxNDg4OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjoxNToxOVrOGSGFSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjoxNToxOVrOGSGFSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYyNzIwOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        AmmoStorage a = (AmmoStorage)campaign.findSparePart(predicate);\n          \n          \n            \n                        AmmoStorage a = (AmmoStorage) campaign.findSparePart(predicate);", "url": "https://github.com/MegaMek/mekhq/pull/1730#discussion_r421627209", "createdAt": "2020-05-07T16:15:19Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "diffHunk": "@@ -686,11 +687,21 @@ public boolean isCompatibleAmmo(AmmoType a1, AmmoType a2) {\n     public int getAmountAvailable() {\n         final AmmoType thisType = (AmmoType)getType();\n         if (campaign.getCampaignOptions().useAmmoByType()) {\n-            AmmoStorage a = (AmmoStorage)campaign.findSparePart(part -> {\n-                return part instanceof AmmoStorage\n-                    && thisType.equals(((AmmoStorage)part).getType())\n-                    && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n-            });\n+            Predicate<Part> predicate;\n+            if (AmmoBin.ALLOWED_BY_TYPE.contains(thisType.getAmmoType())) {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equalsAmmoTypeOnly(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            } else {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equals(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            }\n+            AmmoStorage a = (AmmoStorage)campaign.findSparePart(predicate);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c21bc1d7ab3da4ed743166657a3f4bd9ea8c2126"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNDgxNTg0OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjoxNTozNVrOGSGF5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjoxNTozNVrOGSGF5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYyNzM2Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        && thisType.equals(((AmmoStorage)part).getType())\n          \n          \n            \n                                        && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n          \n          \n            \n                                        && thisType.equals(((AmmoStorage) part).getType())\n          \n          \n            \n                                        && thisType.getMunitionType() == ((AmmoType) ((AmmoStorage) part).getType()).getMunitionType();", "url": "https://github.com/MegaMek/mekhq/pull/1730#discussion_r421627367", "createdAt": "2020-05-07T16:15:35Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "diffHunk": "@@ -686,11 +687,21 @@ public boolean isCompatibleAmmo(AmmoType a1, AmmoType a2) {\n     public int getAmountAvailable() {\n         final AmmoType thisType = (AmmoType)getType();\n         if (campaign.getCampaignOptions().useAmmoByType()) {\n-            AmmoStorage a = (AmmoStorage)campaign.findSparePart(part -> {\n-                return part instanceof AmmoStorage\n-                    && thisType.equals(((AmmoStorage)part).getType())\n-                    && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n-            });\n+            Predicate<Part> predicate;\n+            if (AmmoBin.ALLOWED_BY_TYPE.contains(thisType.getAmmoType())) {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equalsAmmoTypeOnly(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n+                };\n+            } else {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equals(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c21bc1d7ab3da4ed743166657a3f4bd9ea8c2126"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNDgxNjc4OnYy", "diffSide": "RIGHT", "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjoxNTo1MVrOGSGGiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNjoxNTo1MVrOGSGGiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYyNzUyOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        && thisType.equalsAmmoTypeOnly(((AmmoStorage)part).getType())\n          \n          \n            \n                                        && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n          \n          \n            \n                                        && thisType.equalsAmmoTypeOnly(((AmmoStorage) part).getType())\n          \n          \n            \n                                        && thisType.getMunitionType() == ((AmmoType) ((AmmoStorage) part).getType()).getMunitionType();", "url": "https://github.com/MegaMek/mekhq/pull/1730#discussion_r421627529", "createdAt": "2020-05-07T16:15:51Z", "author": {"login": "Windchild292"}, "path": "MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java", "diffHunk": "@@ -686,11 +687,21 @@ public boolean isCompatibleAmmo(AmmoType a1, AmmoType a2) {\n     public int getAmountAvailable() {\n         final AmmoType thisType = (AmmoType)getType();\n         if (campaign.getCampaignOptions().useAmmoByType()) {\n-            AmmoStorage a = (AmmoStorage)campaign.findSparePart(part -> {\n-                return part instanceof AmmoStorage\n-                    && thisType.equals(((AmmoStorage)part).getType())\n-                    && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();\n-            });\n+            Predicate<Part> predicate;\n+            if (AmmoBin.ALLOWED_BY_TYPE.contains(thisType.getAmmoType())) {\n+                predicate = part -> {\n+                    return part instanceof AmmoStorage\n+                            && thisType.equalsAmmoTypeOnly(((AmmoStorage)part).getType())\n+                            && thisType.getMunitionType() == ((AmmoType)((AmmoStorage)part).getType()).getMunitionType();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c21bc1d7ab3da4ed743166657a3f4bd9ea8c2126"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2299, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}