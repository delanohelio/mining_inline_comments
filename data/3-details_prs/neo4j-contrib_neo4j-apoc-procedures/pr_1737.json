{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMjM4MDAx", "number": 1737, "title": "Eagerly convert TxData iterables to lists", "bodyText": "Fixes #1736\nThese are ultimately converted to a Collection\nwhen the Cypher query is executed anyway, so no\nreal performance advantage to the old way\nProposed Changes (Mandatory)\nA brief list of proposed changes in order to fix the issue:\n\nEagerly convert TxData iterables to lists. This gets access to the transaction bound lazy iterables out of the way earlier, to prevent issues when the query is executed.", "createdAt": "2020-12-02T19:22:28Z", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1737", "merged": true, "mergeCommit": {"oid": "7284ce8e824c220884680e9a1c57d4c5328d3833"}, "closed": true, "closedAt": "2020-12-04T15:53:11Z", "author": {"login": "ivangreene"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiTkIHgH2gAyNTMxMjM4MDAxOmFkZTJhMjhmNjI5OWY0MDVlMjkxZjQ1NjQ5YWIxZDI0NWI3MDU2NWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdikk3zgFqTU0NDA0ODkxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ade2a28f6299f405e291f45649ab1d245b70565e", "author": {"user": {"login": "ivangreene", "name": null}}, "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/ade2a28f6299f405e291f45649ab1d245b70565e", "committedDate": "2020-12-02T19:18:19Z", "message": "Eagerly convert TxData iterables to lists\n\nThese are ultimately converted to a Collection\nwhen the Cypher query is executed anyway, so no\nreal performance advantage to the old way"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMTcwMjQx", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1737#pullrequestreview-543170241", "createdAt": "2020-12-02T19:31:14Z", "commit": {"oid": "ade2a28f6299f405e291f45649ab1d245b70565e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOTozMToxNFrOH9q4sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOTozMToxNFrOH9q4sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQyNzgyNw==", "bodyText": "If there is a preferred method for this in one of the included libraries we can remove this method and use that", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1737#discussion_r534427827", "createdAt": "2020-12-02T19:31:14Z", "author": {"login": "ivangreene"}, "path": "core/src/main/java/apoc/trigger/TriggerHandler.java", "diffHunk": "@@ -287,6 +288,11 @@ public void afterRollback(TransactionData txData, Void state, GraphDatabaseServi\n         );\n     }\n \n+    private <E> List<E> toList(Iterable<E> iterable) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ade2a28f6299f405e291f45649ab1d245b70565e"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzOTM0ODgy", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1737#pullrequestreview-543934882", "createdAt": "2020-12-03T13:09:06Z", "commit": {"oid": "ade2a28f6299f405e291f45649ab1d245b70565e"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMzowOTowNlrOH-ayhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMzowOTo1M1rOH-a0cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxMjY3OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"createdNodes\", toList(txData.createdNodes()),\n          \n          \n            \n                            \"createdNodes\", Convert.convertToList(txData.createdNodes()),", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1737#discussion_r535212679", "createdAt": "2020-12-03T13:09:06Z", "author": {"login": "conker84"}, "path": "core/src/main/java/apoc/trigger/TriggerHandler.java", "diffHunk": "@@ -273,10 +274,10 @@ public void afterRollback(TransactionData txData, Void state, GraphDatabaseServi\n         }\n         return map(\"transactionId\", txId,\n                 \"commitTime\", commitTime,\n-                \"createdNodes\", txData.createdNodes(),\n-                \"createdRelationships\", txData.createdRelationships(),\n-                \"deletedNodes\", txData.deletedNodes(),\n-                \"deletedRelationships\", txData.deletedRelationships(),\n+                \"createdNodes\", toList(txData.createdNodes()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ade2a28f6299f405e291f45649ab1d245b70565e"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxMzA3OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"deletedNodes\", toList(txData.deletedNodes()),\n          \n          \n            \n                            \"deletedNodes\", Convert.convertToList(txData.deletedNodes()),", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1737#discussion_r535213078", "createdAt": "2020-12-03T13:09:44Z", "author": {"login": "conker84"}, "path": "core/src/main/java/apoc/trigger/TriggerHandler.java", "diffHunk": "@@ -273,10 +274,10 @@ public void afterRollback(TransactionData txData, Void state, GraphDatabaseServi\n         }\n         return map(\"transactionId\", txId,\n                 \"commitTime\", commitTime,\n-                \"createdNodes\", txData.createdNodes(),\n-                \"createdRelationships\", txData.createdRelationships(),\n-                \"deletedNodes\", txData.deletedNodes(),\n-                \"deletedRelationships\", txData.deletedRelationships(),\n+                \"createdNodes\", toList(txData.createdNodes()),\n+                \"createdRelationships\", toList(txData.createdRelationships()),\n+                \"deletedNodes\", toList(txData.deletedNodes()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ade2a28f6299f405e291f45649ab1d245b70565e"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTIxMzE3MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"deletedRelationships\", toList(txData.deletedRelationships()),\n          \n          \n            \n                            \"deletedRelationships\", Convert.convertToList(txData.deletedRelationships()),", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1737#discussion_r535213171", "createdAt": "2020-12-03T13:09:53Z", "author": {"login": "conker84"}, "path": "core/src/main/java/apoc/trigger/TriggerHandler.java", "diffHunk": "@@ -273,10 +274,10 @@ public void afterRollback(TransactionData txData, Void state, GraphDatabaseServi\n         }\n         return map(\"transactionId\", txId,\n                 \"commitTime\", commitTime,\n-                \"createdNodes\", txData.createdNodes(),\n-                \"createdRelationships\", txData.createdRelationships(),\n-                \"deletedNodes\", txData.deletedNodes(),\n-                \"deletedRelationships\", txData.deletedRelationships(),\n+                \"createdNodes\", toList(txData.createdNodes()),\n+                \"createdRelationships\", toList(txData.createdRelationships()),\n+                \"deletedNodes\", toList(txData.deletedNodes()),\n+                \"deletedRelationships\", toList(txData.deletedRelationships()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ade2a28f6299f405e291f45649ab1d245b70565e"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5160726a1b2cccb347c071b80dc3e10a1c4baa2", "author": {"user": {"login": "ivangreene", "name": null}}, "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/e5160726a1b2cccb347c071b80dc3e10a1c4baa2", "committedDate": "2020-12-03T14:57:25Z", "message": "Use Convert.convertToList"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MDQ4OTE3", "url": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/pull/1737#pullrequestreview-544048917", "createdAt": "2020-12-03T15:07:31Z", "commit": {"oid": "e5160726a1b2cccb347c071b80dc3e10a1c4baa2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 888, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}