{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2Mjc5MzU5", "number": 4238, "title": "Plfm 6458", "bodyText": "", "createdAt": "2020-12-10T21:47:27Z", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4238", "merged": true, "mergeCommit": {"oid": "fbba78a60034ece4e5e67b96d779d81189504694"}, "closed": true, "closedAt": "2020-12-11T19:49:26Z", "author": {"login": "nlgilber"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdk5vn_gH2gAyNTM2Mjc5MzU5OjdiNmI1YTVkZmEzZThhODVlNjMwNDdkNjMzNWU5NWY4YTc5NTU1M2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdlMvQxgFqTU1MDQ5NjY2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7b6b5a5dfa3e8a85e63047d6335e95f8a795553e", "author": {"user": {"login": "nlgilber", "name": "Nicoletta"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/7b6b5a5dfa3e8a85e63047d6335e95f8a795553e", "committedDate": "2020-12-10T20:55:07Z", "message": "deleteAccessRequirement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c98bdac11154a8ef459b0c9b7908bf1d0b670b74", "author": {"user": {"login": "nlgilber", "name": "Nicoletta"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/c98bdac11154a8ef459b0c9b7908bf1d0b670b74", "committedDate": "2020-12-10T20:58:07Z", "message": "Merge branch 'develop' into PLFM-6458"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a1d6395ba5895053a034e42d0d2da27e4db7319", "author": {"user": {"login": "nlgilber", "name": "Nicoletta"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/3a1d6395ba5895053a034e42d0d2da27e4db7319", "committedDate": "2020-12-10T21:46:23Z", "message": " refactor id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8f6d49de8cb43bdf275821b5fa65c8f59c21f90", "author": {"user": {"login": "nlgilber", "name": "Nicoletta"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/d8f6d49de8cb43bdf275821b5fa65c8f59c21f90", "committedDate": "2020-12-10T21:57:00Z", "message": " rename"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NzAxMjI1", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4238#pullrequestreview-549701225", "createdAt": "2020-12-10T23:47:06Z", "commit": {"oid": "d8f6d49de8cb43bdf275821b5fa65c8f59c21f90"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMzo0NzowNlrOIDiqKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMzo0OToxOVrOIDit6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDU4NDQ5MA==", "bodyText": "We do not usually put the newline (\\n) in exception messages.", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4238#discussion_r540584490", "createdAt": "2020-12-10T23:47:06Z", "author": {"login": "marcomarasca"}, "path": "lib/jdomodels/src/main/java/org/sagebionetworks/repo/model/dbo/dao/DBOAccessRequirementDAOImpl.java", "diffHunk": "@@ -179,7 +180,13 @@ public AccessRequirement mapRow(ResultSet rs, int rowNum)\n \tpublic void delete(String id) {\n \t\tMapSqlParameterSource param = new MapSqlParameterSource();\n \t\tparam.addValue(COL_ACCESS_REQUIREMENT_ID.toLowerCase(), id);\n-\t\tbasicDao.deleteObjectByPrimaryKey(DBOAccessRequirement.class, param);\n+\t\ttry {\n+\t\t\tbasicDao.deleteObjectByPrimaryKey(DBOAccessRequirement.class, param);\n+\t\t} catch (DataIntegrityViolationException e) {\n+\t\t\tthrow new IllegalArgumentException(\"The access requirement with id \" + id +\n+\t\t\t\t\t\" cannot be deleted as it is referenced by another object \\n\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8f6d49de8cb43bdf275821b5fa65c8f59c21f90"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDU4NTQ0OQ==", "bodyText": "This seems a wrong message for a not found object?", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4238#discussion_r540585449", "createdAt": "2020-12-10T23:49:19Z", "author": {"login": "marcomarasca"}, "path": "lib/jdomodels/src/test/java/org/sagebionetworks/repo/model/dbo/dao/DBOAccessRequirementDAOImplTest.java", "diffHunk": "@@ -415,4 +431,40 @@ public void testGetAccessRequirementDiffWithSourceMoreRestricted() {\n \t\tassertEquals(Arrays.asList(accessRequirement.getId().toString()),\n \t\t\t\taccessRequirementDAO.getAccessRequirementDiff(sourceSubjects, destSubjects , RestrictableObjectType.ENTITY));\n \t}\n+\n+\t@Test\n+\tpublic void testDeleteAccessRequirement() {\n+\t\taccessRequirement = newEntityAccessRequirement(individualGroup, node, \"foo\");\n+\t\taccessRequirement = accessRequirementDAO.create(accessRequirement);\n+\t\tString accessRequirementId = String.valueOf(accessRequirement.getId());\n+\t\tString expectedMessage = \"AccessRequirement ID: \" + accessRequirementId;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8f6d49de8cb43bdf275821b5fa65c8f59c21f90"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18d5b0b3da7ab7ca98c9b687bf309229c59152ce", "author": {"user": {"login": "nlgilber", "name": "Nicoletta"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/18d5b0b3da7ab7ca98c9b687bf309229c59152ce", "committedDate": "2020-12-11T01:05:52Z", "message": " PR changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0eb3ec9899e0838b73dc030ec46f3d57195fc004", "author": {"user": {"login": "nlgilber", "name": "Nicoletta"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/0eb3ec9899e0838b73dc030ec46f3d57195fc004", "committedDate": "2020-12-11T01:21:17Z", "message": "test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b121540a46b67342248e5a2c0511a380f4ccaa3", "author": {"user": {"login": "nlgilber", "name": "Nicoletta"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/0b121540a46b67342248e5a2c0511a380f4ccaa3", "committedDate": "2020-12-11T18:55:59Z", "message": "change error message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwNDk2NjYw", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4238#pullrequestreview-550496660", "createdAt": "2020-12-11T19:02:55Z", "commit": {"oid": "0b121540a46b67342248e5a2c0511a380f4ccaa3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4559, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}