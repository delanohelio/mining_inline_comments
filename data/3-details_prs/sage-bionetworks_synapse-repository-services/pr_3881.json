{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5Nzg5NDEy", "number": 3881, "title": "CR responses for PLFM-6004, add Jacoco code coverage tool", "bodyText": "Code review responses for #3873 (https://sagebionetworks.jira.com/browse/PLFM-6004) Includes all comments except optimizing the SQL query for getProjectSettingForNode", "createdAt": "2020-01-07T01:57:33Z", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881", "merged": true, "mergeCommit": {"oid": "5ee83e0928ee5fc049b8b0d4607b93fcbaf27357"}, "closed": true, "closedAt": "2020-01-15T20:13:40Z", "author": {"login": "DwayneJengSage"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABbzWlniAH2gAyMzU5Nzg5NDEyOjBjOWRhMjY0YmZkMDhmZWVkNmY5NDMyNmM1MWExNmZlMzI3OGIwNjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6rW9eAFqTM0MzQ5MTcwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0c9da264bfd08feed6f94326c51a16fe3278b064", "author": {"user": {"login": "DwayneJengSage", "name": "Dwayne Jeng"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/0c9da264bfd08feed6f94326c51a16fe3278b064", "committedDate": "2019-12-24T02:04:04Z", "message": "CR responses for PLFM-6004, add Jacoco code coverage tool"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "176767467eb2e7d1c478b5ed05d4bb98fe0ae49a", "author": {"user": {"login": "DwayneJengSage", "name": "Dwayne Jeng"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/176767467eb2e7d1c478b5ed05d4bb98fe0ae49a", "committedDate": "2020-01-07T01:10:06Z", "message": "Merge branch 'develop' of https://github.com/Sage-Bionetworks/Synapse-Repository-Services into develop\n\nConflicts:\n\tservices/repository-managers/src/test/java/org/sagebionetworks/repo/manager/file/FileHandleManagerImplTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "645b75dc351cd71d5f4749a281aa9cccb310d499", "author": {"user": {"login": "DwayneJengSage", "name": "Dwayne Jeng"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/645b75dc351cd71d5f4749a281aa9cccb310d499", "committedDate": "2020-01-07T01:55:40Z", "message": "fix FileHandleManagerImplTest after merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "703a5de491da2edf35c90231adca2f6ee24f2876", "author": {"user": {"login": "DwayneJengSage", "name": "Dwayne Jeng"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/703a5de491da2edf35c90231adca2f6ee24f2876", "committedDate": "2020-01-07T02:27:28Z", "message": "fix build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "944dbadab0295cde1d94be256b14203a1e58aa69", "author": {"user": {"login": "DwayneJengSage", "name": "Dwayne Jeng"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/944dbadab0295cde1d94be256b14203a1e58aa69", "committedDate": "2020-01-08T05:07:05Z", "message": "optimize SQL query for getProjectSettingForNode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMjMzNDc2", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#pullrequestreview-340233476", "createdAt": "2020-01-09T00:43:29Z", "commit": {"oid": "703a5de491da2edf35c90231adca2f6ee24f2876"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMDo0MzoyOVrOFboJJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMDo0MzoyOVrOFboJJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDUxMzU3NA==", "bodyText": "Will move to separate pull request and try in root pom.xml", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#discussion_r364513574", "createdAt": "2020-01-09T00:43:29Z", "author": {"login": "john-hill"}, "path": "services/repository-managers/pom.xml", "diffHunk": "@@ -261,6 +261,41 @@\n \t\t\t\t\t</execution>\r\n \t\t\t\t</executions>\r\n \t\t\t</plugin>\r\n+\r\n+\t\t\t<!-- JaCoCo Code Coverage Tool -->\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "703a5de491da2edf35c90231adca2f6ee24f2876"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMjM1NTA4", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#pullrequestreview-340235508", "createdAt": "2020-01-09T00:51:19Z", "commit": {"oid": "703a5de491da2edf35c90231adca2f6ee24f2876"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMDo1MToxOVrOFboPqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMDo1MToxOVrOFboPqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDUxNTI0Mg==", "bodyText": "optimize isEmtpy() (constant time), then can keep order.", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#discussion_r364515242", "createdAt": "2020-01-09T00:51:19Z", "author": {"login": "john-hill"}, "path": "services/repository-managers/src/main/java/org/sagebionetworks/repo/manager/ProjectSettingsManagerImpl.java", "diffHunk": "@@ -157,7 +158,7 @@ public ProjectSetting createProjectSetting(UserInfo userInfo, ProjectSetting pro\n \t\tvalidateProjectSetting(projectSetting, userInfo);\n \n \t\t// Can't add an StsStorageLocation to a non-empty entity.\n-\t\tif (isStsStorageLocationSetting(projectSetting) && !nodeManager.isEntityEmpty(parentId)) {\n+\t\tif (!nodeManager.isEntityEmpty(parentId) && isStsStorageLocationSetting(projectSetting)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "703a5de491da2edf35c90231adca2f6ee24f2876"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMjM4NTEw", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#pullrequestreview-340238510", "createdAt": "2020-01-09T01:02:37Z", "commit": {"oid": "703a5de491da2edf35c90231adca2f6ee24f2876"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMTowMjozOFrOFboZMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMTowMjozOFrOFboZMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDUxNzY4Mw==", "bodyText": "false not illegal arg", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#discussion_r364517683", "createdAt": "2020-01-09T01:02:38Z", "author": {"login": "john-hill"}, "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/ProjectSettingsManagerImplUnitTest.java", "diffHunk": "@@ -945,6 +1024,84 @@ public void testValidateProjectSetting_StsCannotBeEnabledWithOtherStorageLocatio\n \t\t\t\tuploadDestinationListSetting, userInfo), \"An STS-enabled folder cannot add other upload destinations\");\n \t}\n \n+\t@Test\n+\tpublic void testIsStsStorageLocation_NullProjectSetting() {\n+\t\t// Method under test.\n+\t\tboolean result = projectSettingsManagerImpl.isStsStorageLocationSetting(null);\n+\t\tassertFalse(result);\n+\t\tverifyZeroInteractions(mockStorageLocationDAO);\n+\t}\n+\n+\t@Test\n+\tpublic void testIsStsStorageLocation_ProjectSettingWrongSubclass() {\n+\t\t// Create a mock of ProjectSetting, so we can have a ProjectSetting instance that's not an\n+\t\t// UploadDestinationListSetting.\n+\t\tProjectSetting input = mock(ProjectSetting.class);\n+\n+\t\t// Method under test.\n+\t\tboolean result = projectSettingsManagerImpl.isStsStorageLocationSetting(input);\n+\t\tassertFalse(result);\n+\t\tverifyZeroInteractions(mockStorageLocationDAO);\n+\t}\n+\n+\t@Test\n+\tpublic void testIsStsStorageLocation_StorageLocationNotFound() {\n+\t\t// Mock dependencies.\n+\t\twhen(mockStorageLocationDAO.get(STORAGE_LOCATION_ID)).thenThrow(NotFoundException.class);\n+\n+\t\t// Method under test.\n+\t\tassertThrows(IllegalArgumentException.class, () -> projectSettingsManagerImpl.isStsStorageLocationSetting(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "703a5de491da2edf35c90231adca2f6ee24f2876"}, "originalPosition": 529}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8bf73df837ffc1eb998da9309b77a5dc4174969d", "author": {"user": {"login": "DwayneJengSage", "name": "Dwayne Jeng"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/8bf73df837ffc1eb998da9309b77a5dc4174969d", "committedDate": "2020-01-15T01:38:26Z", "message": "2nd CR responses for PLFM-6004"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be137cbf98d68bae47e7170d0f714ab95f822f29", "author": {"user": {"login": "DwayneJengSage", "name": "Dwayne Jeng"}}, "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/be137cbf98d68bae47e7170d0f714ab95f822f29", "committedDate": "2020-01-15T01:38:54Z", "message": "Merge branch 'develop' of https://github.com/Sage-Bionetworks/Synapse-Repository-Services into develop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNDkxNzAy", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/3881#pullrequestreview-343491702", "createdAt": "2020-01-15T20:13:32Z", "commit": {"oid": "be137cbf98d68bae47e7170d0f714ab95f822f29"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4877, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}