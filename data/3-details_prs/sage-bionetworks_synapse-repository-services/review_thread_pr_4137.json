{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5MTg4Nzgz", "number": 4137, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDo1MTo0MFrOEO2pGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDo1NDo1M1rOEO2tag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MDEwNzc2OnYy", "diffSide": "RIGHT", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDo1MTo0MFrOGyPaoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDo1MTo0MFrOGyPaoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMzNDU2MQ==", "bodyText": "This test can be removed", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4137#discussion_r455334561", "createdAt": "2020-07-15T20:51:40Z", "author": {"login": "marcomarasca"}, "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "diffHunk": "@@ -873,24 +874,48 @@ public void testCreateJsonSchemaNullSchema() {\n \tpublic void testGetSchemaWithVersion() {\n \t\twhen(mockSchemaDao.getVersionId(any(), any(), any())).thenReturn(versionId);\n \t\twhen(mockSchemaDao.getSchema(any())).thenReturn(schema);\n-\t\tString $id = organizationName+\"-\"+schemaName+\"-\"+semanticVersionString;\n+\t\tString $id = organizationName + \"-\" + schemaName + \"-\" + semanticVersionString;\n \t\t// call under test\n \t\tJsonSchema result = manager.getSchema($id);\n \t\tassertEquals(schema, result);\n+\t\tassertEquals($id, result.get$id());\n \t\tverify(mockSchemaDao).getVersionId(organizationName, schemaName, semanticVersionString);\n \t\tverify(mockSchemaDao, never()).getLatestVersionId(any(), any());\n \t\tverify(mockSchemaDao).getSchema(versionId);\n \t}\n \n+\t@Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8453ea70e57bfb9fc9496bb4dfa5a13646cccdcb"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MDExNDE3OnYy", "diffSide": "RIGHT", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDo1MzozOFrOGyPeeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDo1MzozOFrOGyPeeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMzNTU0NA==", "bodyText": "We might want to remove the schema in each sub-schema in the validation.", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4137#discussion_r455335544", "createdAt": "2020-07-15T20:53:38Z", "author": {"login": "marcomarasca"}, "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "diffHunk": "@@ -1138,10 +1162,10 @@ public void testGetLatestVersionWithNullSchemaName() {\n \t\tverify(mockSchemaDao, never()).getVersionInfo(any());\n \t}\n \n-\n \t@Test\n \tpublic void testGetValidationSchema() throws JSONObjectAdapterException {\n \t\tJsonSchema one = createSchema(\"one\");\n+\t\tone.set$schema(\"http://json-schema.org/draft-07/schema\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8453ea70e57bfb9fc9496bb4dfa5a13646cccdcb"}, "originalPosition": 176}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MDExODgyOnYy", "diffSide": "RIGHT", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDo1NDo1M1rOGyPhSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQyMDo1NDo1M1rOGyPhSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMzNjI2NA==", "bodyText": "Can be removed..or not.", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4137#discussion_r455336264", "createdAt": "2020-07-15T20:54:53Z", "author": {"login": "marcomarasca"}, "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/schema/JsonSchemaManagerImplTest.java", "diffHunk": "@@ -1397,4 +1425,17 @@ public JsonSchema cloneSchema(JsonSchema toClone) throws JSONObjectAdapterExcept\n \t\tString json = EntityFactory.createJSONStringForEntity(toClone);\n \t\treturn EntityFactory.createEntityFromJSONString(json, JsonSchema.class);\n \t}\n+\n+\t/**\n+\t * Convert a JsonSchema to json.\n+\t * \n+\t * @param schema\n+\t * @return\n+\t * @throws JSONObjectAdapterException\n+\t */\n+\tpublic static String toJson(JsonSchema schema) throws JSONObjectAdapterException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8453ea70e57bfb9fc9496bb4dfa5a13646cccdcb"}, "originalPosition": 275}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2926, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}