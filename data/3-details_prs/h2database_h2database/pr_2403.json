{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzNTM5OTUw", "number": 2403, "title": "Reject too old PageStore databases", "bodyText": "Closes #2402.\n\n\nPageStore databases before 1.4.197 (due to #1247) now throw a version exception on attempt to open them. Old MVStore databases aren't restricted here.\n\n\nVery old versions of TCP protocol (before 1.3.168) aren't supported any more.\n\n\nSupport of DbUpgrade and of legacy LOBs is removed.", "createdAt": "2020-01-16T09:24:27Z", "url": "https://github.com/h2database/h2database/pull/2403", "merged": true, "mergeCommit": {"oid": "12fcf4c219e26176d4027e72eb5f9f0c797f0152"}, "closed": true, "closedAt": "2020-01-16T14:07:13Z", "author": {"login": "katzyn"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb61ZIGgH2gAyMzYzNTM5OTUwOmVjY2Q3ZDY3ZTU0ODFkMjhlMjc5MThmYmRlMzM0NzQ3Y2ZjYThjZGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb93mdpAFqTM0ODMzNzg4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eccd7d67e5481d28e27918fbde334747cfca8cdf", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/eccd7d67e5481d28e27918fbde334747cfca8cdf", "committedDate": "2020-01-16T07:54:57Z", "message": "Remove semi-automatic upgrade support from 1.1.* releases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ec1b58c23d4ebb59f5159a77e7fbd77485cdc71", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/8ec1b58c23d4ebb59f5159a77e7fbd77485cdc71", "committedDate": "2020-01-16T09:00:40Z", "message": "Remove legacy implementation of LOBs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37b3d2f80972bd8c33c7378984fc95379bb19c71", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/37b3d2f80972bd8c33c7378984fc95379bb19c71", "committedDate": "2020-01-16T09:13:14Z", "message": "Drop support of TCP protocol versions older that 12 (1.3.168)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6675b3de6c51ed6c3184934121e49e4fb2722c85", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/6675b3de6c51ed6c3184934121e49e4fb2722c85", "committedDate": "2020-01-16T09:16:38Z", "message": "Wrap long line and update changelog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57283bb48f6b72e8bc80bb8dad38bbd4631e2a9a", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/57283bb48f6b72e8bc80bb8dad38bbd4631e2a9a", "committedDate": "2020-01-16T10:05:28Z", "message": "Throw sane exception if old LOB was read early"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb65df8842269755906f809498f7bc758b11dc0b", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/bb65df8842269755906f809498f7bc758b11dc0b", "committedDate": "2020-01-16T13:02:19Z", "message": "Remove 7 LOB-only methods from the base Value class"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzM3ODgy", "url": "https://github.com/h2database/h2database/pull/2403#pullrequestreview-348337882", "createdAt": "2020-01-25T18:11:05Z", "commit": {"oid": "bb65df8842269755906f809498f7bc758b11dc0b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQxODoxMTowNVrOFhw1EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQxODoxMTowNVrOFhw1EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk0NzM0NA==", "bodyText": "the method name here \"convertToValueLobOrObject\" implies that we are converting to either a ValueLob or an Object, but I don't think that is what you mean.\nPerhaps \"convertObjectToValueLob\"", "url": "https://github.com/h2database/h2database/pull/2403#discussion_r370947344", "createdAt": "2020-01-25T18:11:05Z", "author": {"login": "grandinj"}, "path": "h2/src/main/org/h2/value/DataType.java", "diffHunk": "@@ -1383,8 +1345,47 @@ private static Value convertToValue1(SessionInterface session, Object x,\n         } else if (clazz == Duration.class) {\n             return JSR310Utils.durationToValue(x);\n         } else {\n-            return ValueJavaObject.getNoCopy(x, null, session.getDataHandler());\n+            return convertToValueLobOrObject(session, x);\n+        }\n+    }\n+\n+    private static Value convertToValueLobOrObject(SessionInterface session, Object x) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb65df8842269755906f809498f7bc758b11dc0b"}, "originalPosition": 134}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3898, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}