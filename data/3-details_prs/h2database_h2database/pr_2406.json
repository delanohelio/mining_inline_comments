{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0Njg2MDAx", "number": 2406, "title": "Implement cardinality check for a nested ARRAY", "bodyText": "Closes #2399. The main change is simple, but a lot of preparation work was required to collect all data type conversion logic into one place.\nThis PR also contains a fix for incorrect precision conversion for a NUMERIC / DECIMAL data types.\nTRUNCATE_VALUE function was reimplemented. Old implementation performed incorrect checks for fixed numeric data types and their truncation logic worked only because the fake declared precision of them is large enough.", "createdAt": "2020-01-20T07:37:46Z", "url": "https://github.com/h2database/h2database/pull/2406", "merged": true, "mergeCommit": {"oid": "78de50da4178c336395ec56f4f194ef1b88acb9a"}, "closed": true, "closedAt": "2020-01-20T10:40:44Z", "author": {"login": "katzyn"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7H0vOAH2gAyMzY0Njg2MDAxOmUwZmM3OTMzYTE1MDk4ZjBmODA0YTFkZjY5MzFjMDI2NDE1ZTkyZjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb93JhGgFqTM0ODMzNjU2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e0fc7933a15098f0f804a1df6931c026415e92f4", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/e0fc7933a15098f0f804a1df6931c026415e92f4", "committedDate": "2020-01-17T05:23:24Z", "message": "Pass CastDataProvider to Value.convertScale()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00a9e4a106fca2195bf6923dcc7e808b89b62b74", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/00a9e4a106fca2195bf6923dcc7e808b89b62b74", "committedDate": "2020-01-17T07:50:37Z", "message": "Move cast method from TypeInfo to Value"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "629276fcdab2de7b0852ed4a3dd561584d8a78d4", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/629276fcdab2de7b0852ed4a3dd561584d8a78d4", "committedDate": "2020-01-17T09:07:59Z", "message": "Remove dataType parameter from AggregateData.getValue()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "841bc3c37cb03a6ded26dec1c10ad4fb1dda7db0", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/841bc3c37cb03a6ded26dec1c10ad4fb1dda7db0", "committedDate": "2020-01-18T06:51:59Z", "message": "Call some Value.convertTo*() methods directly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "983c6577b0e50d4bfc6332ecf530ed70e804f2a2", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/983c6577b0e50d4bfc6332ecf530ed70e804f2a2", "committedDate": "2020-01-18T07:01:12Z", "message": "Remove some no-op data type conversions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e699c593af743876f65439aa0b46502f39d4f43a", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/e699c593af743876f65439aa0b46502f39d4f43a", "committedDate": "2020-01-19T07:07:41Z", "message": "Pass TypeInfo and conversion mode to Value.convertTo()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f12561cc109ca3792932665419f7539add60a06", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/8f12561cc109ca3792932665419f7539add60a06", "committedDate": "2020-01-19T10:20:27Z", "message": "Don't call Value.convertScale() from other packages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28e0e2db684899b6b04033007ed77d5d9175352a", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/28e0e2db684899b6b04033007ed77d5d9175352a", "committedDate": "2020-01-19T10:31:20Z", "message": "Merge convertScale() methods into main convertTo*() methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffe1d9c86c0bbff25b49df2e5ce96e0395c194de", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/ffe1d9c86c0bbff25b49df2e5ce96e0395c194de", "committedDate": "2020-01-20T05:56:05Z", "message": "Remove incorrect precision conversion from NUMERIC data type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c392b2c0184fbc8eb3bba455bd2546032570a1d9", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/c392b2c0184fbc8eb3bba455bd2546032570a1d9", "committedDate": "2020-01-20T06:50:53Z", "message": "Merge convertPrecision() methods into main convertTo*() methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62e93768ac9c8b0dee045732471476cad56b8846", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/62e93768ac9c8b0dee045732471476cad56b8846", "committedDate": "2020-01-20T06:51:16Z", "message": "Merge checkPrecision() methods into main convertTo*() methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "514ce3e0a35e3f7583d2eac7401579f9b4075184", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/514ce3e0a35e3f7583d2eac7401579f9b4075184", "committedDate": "2020-01-20T07:11:04Z", "message": "Merge ExtTypeInfo.cast() methods into main Value.convertTo*() methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1faa714c93faefc07327a4590bc5f04d9360c25", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/b1faa714c93faefc07327a4590bc5f04d9360c25", "committedDate": "2020-01-20T07:26:47Z", "message": "Implement cardinality check for a nested ARRAY"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "707ec05ef26846200a4b003cc892826fb0650ff6", "author": {"user": {"login": "katzyn", "name": "Evgenij Ryazanov"}}, "url": "https://github.com/h2database/h2database/commit/707ec05ef26846200a4b003cc892826fb0650ff6", "committedDate": "2020-01-20T07:26:59Z", "message": "Update changelog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzM2NTUw", "url": "https://github.com/h2database/h2database/pull/2406#pullrequestreview-348336550", "createdAt": "2020-01-25T17:39:11Z", "commit": {"oid": "00a9e4a106fca2195bf6923dcc7e808b89b62b74"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQxNzozOToxMlrOFhwvFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQxNzozOToxMlrOFhwvFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk0NTgxNA==", "bodyText": "for to -> to", "url": "https://github.com/h2database/h2database/pull/2406#discussion_r370945814", "createdAt": "2020-01-25T17:39:12Z", "author": {"login": "grandinj"}, "path": "h2/src/main/org/h2/value/Value.java", "diffHunk": "@@ -702,17 +702,73 @@ public final Value convertTo(int targetType, CastDataProvider provider) {\n     }\n \n     /**\n-     * Convert a value to the specified type.\n+     * Convert a value to the specified type without taking scale and precision\n+     * into account.\n      *\n-     * @param targetType the type of the returned value\n-     * @param provider the cast information provider\n-     * @param column the column (if any), used for to improve the error message if conversion fails\n+     * @param targetType\n+     *            the type of the returned value\n+     * @param provider\n+     *            the cast information provider\n+     * @return the converted value\n+     */\n+    public final Value convertTo(TypeInfo targetType, CastDataProvider provider) {\n+        return convertTo(targetType.getValueType(), targetType.getExtTypeInfo(), provider, null);\n+    }\n+\n+    /**\n+     * Convert a value to the specified type without taking scale and precision\n+     * into account.\n+     *\n+     * @param targetType\n+     *            the type of the returned value\n+     * @param provider\n+     *            the cast information provider\n+     * @param column\n+     *            the column, used for to improve the error message if", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00a9e4a106fca2195bf6923dcc7e808b89b62b74"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzM2NTY0", "url": "https://github.com/h2database/h2database/pull/2406#pullrequestreview-348336564", "createdAt": "2020-01-25T17:39:28Z", "commit": {"oid": "00a9e4a106fca2195bf6923dcc7e808b89b62b74"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQxNzozOToyOFrOFhwvHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQxNzozOToyOFrOFhwvHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk0NTgyMg==", "bodyText": "to a -> to the", "url": "https://github.com/h2database/h2database/pull/2406#discussion_r370945822", "createdAt": "2020-01-25T17:39:28Z", "author": {"login": "grandinj"}, "path": "h2/src/main/org/h2/value/Value.java", "diffHunk": "@@ -702,17 +702,73 @@ public final Value convertTo(int targetType, CastDataProvider provider) {\n     }\n \n     /**\n-     * Convert a value to the specified type.\n+     * Convert a value to the specified type without taking scale and precision\n+     * into account.\n      *\n-     * @param targetType the type of the returned value\n-     * @param provider the cast information provider\n-     * @param column the column (if any), used for to improve the error message if conversion fails\n+     * @param targetType\n+     *            the type of the returned value\n+     * @param provider\n+     *            the cast information provider\n+     * @return the converted value\n+     */\n+    public final Value convertTo(TypeInfo targetType, CastDataProvider provider) {\n+        return convertTo(targetType.getValueType(), targetType.getExtTypeInfo(), provider, null);\n+    }\n+\n+    /**\n+     * Convert a value to the specified type without taking scale and precision\n+     * into account.\n+     *\n+     * @param targetType\n+     *            the type of the returned value\n+     * @param provider\n+     *            the cast information provider\n+     * @param column\n+     *            the column, used for to improve the error message if\n+     *            conversion fails\n      * @return the converted value\n      */\n     public final Value convertTo(TypeInfo targetType, CastDataProvider provider, Object column) {\n         return convertTo(targetType.getValueType(), targetType.getExtTypeInfo(), provider, column);\n     }\n \n+    /**\n+     * Cast a value to the specified type. The scale is set if applicable. The\n+     * value is truncated to a required precision.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00a9e4a106fca2195bf6923dcc7e808b89b62b74"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3901, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}