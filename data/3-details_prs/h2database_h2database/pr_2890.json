{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4MTI5MDU5", "number": 2890, "title": "Fixed possible eternal wait(0)", "bodyText": "According to Javadoc https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-\nIf timeout is zero, then real time is not taken into consideration and the thread simply waits until notified.\nIn this particular case, we won't get notified, so we'll wait forever.\nIt happens when we set LOCK_TIMEOUT < 10 ms.", "createdAt": "2020-09-16T17:12:17Z", "url": "https://github.com/h2database/h2database/pull/2890", "merged": true, "mergeCommit": {"oid": "7a11f434ceef92479704ebe1dcab92eac149b9eb"}, "closed": true, "closedAt": "2020-09-17T07:51:15Z", "author": {"login": "Silvmike"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJfbdMAH2gAyNDg4MTI5MDU5OmE4MzBiOWExZmFlZDU5YWNhYmRiNGE2MTA4NmMzMzE5MzkzODg5Yjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJrTDcgH2gAyNDg4MTI5MDU5OjQ1M2IxMjJkOThhY2Y5YTVlY2FiZTZjYzQ0NzNiNzQ2NDJkYTRlZDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a830b9a1faed59acabdb4a61086c3319393889b7", "author": {"user": {"login": "Silvmike", "name": "Michael Silvanovich"}}, "url": "https://github.com/h2database/h2database/commit/a830b9a1faed59acabdb4a61086c3319393889b7", "committedDate": "2020-09-16T16:59:36Z", "message": "Fixed possible eternal wait(0)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMTkxNjk5", "url": "https://github.com/h2database/h2database/pull/2890#pullrequestreview-490191699", "createdAt": "2020-09-17T01:58:39Z", "commit": {"oid": "a830b9a1faed59acabdb4a61086c3319393889b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMTo1ODozOVrOHTLkXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMTo1ODozOVrOHTLkXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg3NDUyNg==", "bodyText": "Thank you for your contribution!\nJust replace 0 with 1 here, 50 can be unreasonably large for systems that support small wait values properly.", "url": "https://github.com/h2database/h2database/pull/2890#discussion_r489874526", "createdAt": "2020-09-17T01:58:39Z", "author": {"login": "katzyn"}, "path": "h2/src/main/org/h2/engine/Database.java", "diffHunk": "@@ -1270,9 +1270,11 @@ private synchronized void closeAllSessionsExcept(SessionLocal except) {\n \n         int timeout = 2 * getLockTimeout();\n         long start = System.currentTimeMillis();\n+        // 'sleep' should be strictly greater than zero, otherwise real time is not taken into consideration\n+        // and the thread simply waits until notified\n+        long sleep = Math.max(timeout / 20, 50);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a830b9a1faed59acabdb4a61086c3319393889b7"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "453b122d98acf9a5ecabe6cc4473b74642da4ed8", "author": {"user": {"login": "Silvmike", "name": "Michael Silvanovich"}}, "url": "https://github.com/h2database/h2database/commit/453b122d98acf9a5ecabe6cc4473b74642da4ed8", "committedDate": "2020-09-17T06:49:17Z", "message": "Decreased minimum wait to 1ms on shutdown"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4256, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}