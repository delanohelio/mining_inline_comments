{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NTEyODIx", "number": 1347, "title": "Lint jar for IID Version incompatabiltiy", "bodyText": "Patched and improved #1346\n@vkryachko  please merge your PR and I ll update the my branch  accordingly.", "createdAt": "2020-03-12T23:00:42Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347", "merged": true, "mergeCommit": {"oid": "e44b4dda0ade748c3b95b56ab3c161121298c000"}, "closed": true, "closedAt": "2020-03-17T16:40:39Z", "author": {"login": "ankitaj224"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBun1cgH2gAyMzg3NTEyODIxOjQyODNhMmJiM2I0NDM0NTEwZTA2MWEwZDljNGIwODA1OTU2NThjMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOlR66gH2gAyMzg3NTEyODIxOjE5YmM4MWRlYmRkMTNhOTkwMWQ1ODJlZmI3YjIwMjFhMWM2NDBjOWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4283a2bb3b4434510e061a0d9c4b080595658c2a", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/4283a2bb3b4434510e061a0d9c4b080595658c2a", "committedDate": "2020-02-06T17:59:09Z", "message": "Dropping guava and appcompat dependency from FIS SDK."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "984884cd6f9a90a8172d0957bd13e68e3f06db2f", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/984884cd6f9a90a8172d0957bd13e68e3f06db2f", "committedDate": "2020-02-06T18:16:08Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a82387701d2549bb5fc3b5dc2530a83ed0680d02", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/a82387701d2549bb5fc3b5dc2530a83ed0680d02", "committedDate": "2020-02-11T18:58:16Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afcb14c913c8dedd87faf6b71fdc7dd4384a6c39", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/afcb14c913c8dedd87faf6b71fdc7dd4384a6c39", "committedDate": "2020-02-13T23:37:48Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5574e30b8e3f6c9d09bfca149a6f7853c4141d25", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/5574e30b8e3f6c9d09bfca149a6f7853c4141d25", "committedDate": "2020-03-05T16:49:33Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5dd4dc54f2b7941ffe4b5cd76b6c8ab5764f7a1", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/a5dd4dc54f2b7941ffe4b5cd76b6c8ab5764f7a1", "committedDate": "2020-03-09T16:31:08Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45312e68fe8516dc4d48a2bfdb422f5023c1241b", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/45312e68fe8516dc4d48a2bfdb422f5023c1241b", "committedDate": "2020-03-10T18:13:59Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0be4fa07222c687044f66d8cb2859e156611896", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/f0be4fa07222c687044f66d8cb2859e156611896", "committedDate": "2020-03-10T21:55:48Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac0397ba816265b24da3eca4645761a37d4b46b6", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/ac0397ba816265b24da3eca4645761a37d4b46b6", "committedDate": "2020-03-11T18:14:18Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f6b46e3346cad5d3a4128ad1316e9e0831c0a2b", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/8f6b46e3346cad5d3a4128ad1316e9e0831c0a2b", "committedDate": "2020-03-12T19:40:52Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe59604397828bfa16ab63ab3d74d3622c7ea914", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/fe59604397828bfa16ab63ab3d74d3622c7ea914", "committedDate": "2020-03-12T22:56:47Z", "message": "Patching vlad's PR and implementing the version incompatability."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczOTkwMDky", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#pullrequestreview-373990092", "createdAt": "2020-03-13T01:06:16Z", "commit": {"oid": "fe59604397828bfa16ab63ab3d74d3622c7ea914"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMTowNjoxNlrOF10llQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwMToxMjo0MlrOF10q6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MDQzNw==", "bodyText": "I don't think developers need this kind of context.\nJust tell them which version to use.\nIf this comment is meant for us, then I would recommend to rephrase:\n\"firebase-iid v20.1.0 is compatible with FirebaseInstallations, but contains a bug that was fixed in v20.1.1\"", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r391980437", "createdAt": "2020-03-13T01:06:16Z", "author": {"login": "andirayo"}, "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -0,0 +1,102 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.installations.lint\n+\n+import com.android.tools.lint.detector.api.Detector\n+\n+import com.android.builder.model.MavenCoordinates\n+import com.android.tools.lint.detector.api.Category\n+import com.android.tools.lint.detector.api.Context\n+import com.android.tools.lint.detector.api.Implementation\n+import com.android.tools.lint.detector.api.Issue\n+import com.android.tools.lint.detector.api.Location\n+import com.android.tools.lint.detector.api.Scope\n+import com.android.tools.lint.detector.api.Severity\n+\n+class IncompatibleIidVersionDetector : Detector() {\n+    companion object Issues {\n+        private val IMPLEMENTATION = Implementation(\n+                IncompatibleIidVersionDetector::class.java,\n+                Scope.EMPTY\n+        )\n+\n+        @JvmField\n+        val INCOMPATIBLE_IID_VERSION = Issue.create(\n+                id = \"IncompatibleIidVersion\",\n+                briefDescription = \"FirebaseInstanceId version is not compatible with FirebaseInstallations\",\n+\n+                explanation = \"\"\"\n+           These versions of FirebaseInstanceId and FirebaseInstallations can not be used in parallel.\n+           Please update your Firebase Instance ID to a version 20.1.0 or later.\n+            \"\"\",\n+                category = Category.INTEROPERABILITY,\n+                priority = 1,\n+                severity = Severity.ERROR,\n+                implementation = IMPLEMENTATION\n+        )\n+    }\n+\n+    override fun beforeCheckEachProject(context: Context) {\n+        if (!context.project.isGradleProject) {\n+            return\n+        }\n+\n+        for (variant in context.project.gradleProjectModel.variants) {\n+            for (lib in variant.mainArtifact.dependencies.libraries) {\n+                val coordinates = lib.resolvedCoordinates\n+                if (coordinates.groupId == \"com.google.firebase\" && coordinates.artifactId == \"firebase-iid\") {\n+                    if (isIncompatibleVersion(coordinates)) {\n+                        context.report(INCOMPATIBLE_IID_VERSION,\n+                                Location.create(context.file),\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {\n+        // firebase-iid v20.1.0 already depended on FirebaseInstallations for identifier creation,\n+        // but had an issue of possible silent failures. Thus, v20.1.1 or later is recommended.\n+        val validIidVersionWithFis = \"20.1.1\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe59604397828bfa16ab63ab3d74d3622c7ea914"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MTE4OQ==", "bodyText": "There seems to be an inconsistent Inconsistent use of versions!\nSometimes it's 20.1.0, sometimes 20.1.1 (see below).\nI assume that you want to prevent usage of <20.1.0 and recommend usage of v20.1.1...\nI think, you would make your life easier by just marking everything before v20.1.1 as incompatible and keep it consistent.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r391981189", "createdAt": "2020-03-13T01:09:51Z", "author": {"login": "andirayo"}, "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -0,0 +1,102 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.installations.lint\n+\n+import com.android.tools.lint.detector.api.Detector\n+\n+import com.android.builder.model.MavenCoordinates\n+import com.android.tools.lint.detector.api.Category\n+import com.android.tools.lint.detector.api.Context\n+import com.android.tools.lint.detector.api.Implementation\n+import com.android.tools.lint.detector.api.Issue\n+import com.android.tools.lint.detector.api.Location\n+import com.android.tools.lint.detector.api.Scope\n+import com.android.tools.lint.detector.api.Severity\n+\n+class IncompatibleIidVersionDetector : Detector() {\n+    companion object Issues {\n+        private val IMPLEMENTATION = Implementation(\n+                IncompatibleIidVersionDetector::class.java,\n+                Scope.EMPTY\n+        )\n+\n+        @JvmField\n+        val INCOMPATIBLE_IID_VERSION = Issue.create(\n+                id = \"IncompatibleIidVersion\",\n+                briefDescription = \"FirebaseInstanceId version is not compatible with FirebaseInstallations\",\n+\n+                explanation = \"\"\"\n+           These versions of FirebaseInstanceId and FirebaseInstallations can not be used in parallel.\n+           Please update your Firebase Instance ID to a version 20.1.0 or later.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe59604397828bfa16ab63ab3d74d3622c7ea914"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MTgwMg==", "bodyText": "This method seems unnecessarily complicated.\nCan't we just check for the version that we are interested in?\nkind of like this (pseudo code):\nversionComponents = version.split('.')\n// check if correct SemVer format\nreturn FALSE if 3 != versionComponents.size\n// major version before v20? => incompatible\nreturn FALSE if 20 > versionComponants[0].asInt\n// major version after v21? => compatible\nreturn TRUE if 21 <= versionComponants[0].asInt\n// major version is v20 and minor version major version after v20.1? => compatible\nreturn (1 <= versionComponants[1].asInt)", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r391981802", "createdAt": "2020-03-13T01:12:42Z", "author": {"login": "andirayo"}, "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -0,0 +1,102 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.installations.lint\n+\n+import com.android.tools.lint.detector.api.Detector\n+\n+import com.android.builder.model.MavenCoordinates\n+import com.android.tools.lint.detector.api.Category\n+import com.android.tools.lint.detector.api.Context\n+import com.android.tools.lint.detector.api.Implementation\n+import com.android.tools.lint.detector.api.Issue\n+import com.android.tools.lint.detector.api.Location\n+import com.android.tools.lint.detector.api.Scope\n+import com.android.tools.lint.detector.api.Severity\n+\n+class IncompatibleIidVersionDetector : Detector() {\n+    companion object Issues {\n+        private val IMPLEMENTATION = Implementation(\n+                IncompatibleIidVersionDetector::class.java,\n+                Scope.EMPTY\n+        )\n+\n+        @JvmField\n+        val INCOMPATIBLE_IID_VERSION = Issue.create(\n+                id = \"IncompatibleIidVersion\",\n+                briefDescription = \"FirebaseInstanceId version is not compatible with FirebaseInstallations\",\n+\n+                explanation = \"\"\"\n+           These versions of FirebaseInstanceId and FirebaseInstallations can not be used in parallel.\n+           Please update your Firebase Instance ID to a version 20.1.0 or later.\n+            \"\"\",\n+                category = Category.INTEROPERABILITY,\n+                priority = 1,\n+                severity = Severity.ERROR,\n+                implementation = IMPLEMENTATION\n+        )\n+    }\n+\n+    override fun beforeCheckEachProject(context: Context) {\n+        if (!context.project.isGradleProject) {\n+            return\n+        }\n+\n+        for (variant in context.project.gradleProjectModel.variants) {\n+            for (lib in variant.mainArtifact.dependencies.libraries) {\n+                val coordinates = lib.resolvedCoordinates\n+                if (coordinates.groupId == \"com.google.firebase\" && coordinates.artifactId == \"firebase-iid\") {\n+                    if (isIncompatibleVersion(coordinates)) {\n+                        context.report(INCOMPATIBLE_IID_VERSION,\n+                                Location.create(context.file),\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {\n+        // firebase-iid v20.1.0 already depended on FirebaseInstallations for identifier creation,\n+        // but had an issue of possible silent failures. Thus, v20.1.1 or later is recommended.\n+        val validIidVersionWithFis = \"20.1.1\"\n+\n+        // IID SDK version is incompatible if it is older than the IID SDK version with FIS\n+        // dependency(i.e 20.1.1).\n+        return compareVersions(validIidVersionWithFis, coordinates.version) == 1\n+    }\n+\n+    private fun compareVersions(versionA: String, versionB: String): Int {\n+        val versionAComponents = versionA.split('.').toTypedArray()\n+        val versionBComponents = versionB.split('.').toTypedArray()\n+        val k = Math.min(versionAComponents.size, versionBComponents.size)\n+        for (i in 0..k - 1) {\n+            if (versionAComponents.get(i) > versionBComponents.get(i)) {\n+                return 1\n+            }\n+            if (versionAComponents.get(i) < versionBComponents.get(i)) {\n+                return -1\n+            }\n+        }\n+\n+        if (versionAComponents.size == versionBComponents.size) {\n+            return 0\n+        }\n+        if (versionAComponents.size < versionBComponents.size) {\n+            return -1\n+        } else {\n+            return 1\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe59604397828bfa16ab63ab3d74d3622c7ea914"}, "originalPosition": 101}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e07ec5fb2e085bb6c720c34e66cd1a68a469987a", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/e07ec5fb2e085bb6c720c34e66cd1a68a469987a", "committedDate": "2020-03-13T18:51:32Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into lintJar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "832318cdb96ac3225f17b8bd575176e09e25ab4f", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/832318cdb96ac3225f17b8bd575176e09e25ab4f", "committedDate": "2020-03-13T19:05:44Z", "message": "Merging with latest changes and addressing rayo's comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ac261ff00e51c909aab406f2de57c19475e84ce", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/6ac261ff00e51c909aab406f2de57c19475e84ce", "committedDate": "2020-03-13T19:06:31Z", "message": "Rmoving the patch."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a77bd376bb5df4c6eee81664bb9d3f8d728aa376", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/a77bd376bb5df4c6eee81664bb9d3f8d728aa376", "committedDate": "2020-03-13T21:46:56Z", "message": "Updating the complicated version check."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c116bcdb200010e98f541b7841cfa56fab259b04", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/c116bcdb200010e98f541b7841cfa56fab259b04", "committedDate": "2020-03-13T21:47:27Z", "message": "Fixing the comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03165121865d9096ec02faae0dec9e3bd4bf4338", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/03165121865d9096ec02faae0dec9e3bd4bf4338", "committedDate": "2020-03-13T22:41:26Z", "message": "Addressing vlad's comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/0dbbc11b3194409b774cf77e0f147c2c5cb6604b", "committedDate": "2020-03-14T02:07:19Z", "message": "Updating the context message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NjYyMDA5", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#pullrequestreview-375662009", "createdAt": "2020-03-17T00:13:37Z", "commit": {"oid": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMDoxMzozN1rOF3J7Fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMDoxNzowNVrOF3J-bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3ODU4Mg==", "bodyText": "This is against Java readability rules in Google I think. Not sure how this is handled here?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393378582", "createdAt": "2020-03-17T00:13:37Z", "author": {"login": "andirayo"}, "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -14,22 +14,15 @@\n \n package com.google.firebase.installations.lint\n \n-import com.android.tools.lint.detector.api.Detector\n-\n import com.android.builder.model.MavenCoordinates\n-import com.android.tools.lint.detector.api.Category\n-import com.android.tools.lint.detector.api.Context\n-import com.android.tools.lint.detector.api.Implementation\n-import com.android.tools.lint.detector.api.Issue\n-import com.android.tools.lint.detector.api.Location\n-import com.android.tools.lint.detector.api.Scope\n-import com.android.tools.lint.detector.api.Severity\n+import com.android.tools.lint.detector.api.*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3ODg5Mg==", "bodyText": "Can #toInt throw an exception?\nDo we care?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393378892", "createdAt": "2020-03-17T00:15:00Z", "author": {"login": "andirayo"}, "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -59,15 +53,29 @@ class IncompatibleIidVersionDetector : Detector() {\n                     if (isIncompatibleVersion(coordinates)) {\n                         context.report(INCOMPATIBLE_IID_VERSION,\n                                 Location.create(context.file),\n-                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name.removeSuffix(\"@aar\")}.\\n\" +\n+                                        \"To resolve this issue, consider updating the build file to the latest firebase-iid version.\")\n                     }\n                 }\n             }\n         }\n     }\n \n     private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {\n-        // TODO: implement version check\n-        return coordinates.version == \"0.0.0\"\n+        val versionComponents = coordinates.version.split('.').toTypedArray()\n+        // check if correct version format\n+        if (3 != versionComponents.size) {\n+            return true\n+        }\n+        // Incompatible if major version is before v20\n+        if (20 > versionComponents.get(0).toInt()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3OTA3OQ==", "bodyText": "Can you tell split to split this into maximum 3 components?\nIf yes, please do so.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393379079", "createdAt": "2020-03-17T00:15:46Z", "author": {"login": "andirayo"}, "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -59,15 +53,29 @@ class IncompatibleIidVersionDetector : Detector() {\n                     if (isIncompatibleVersion(coordinates)) {\n                         context.report(INCOMPATIBLE_IID_VERSION,\n                                 Location.create(context.file),\n-                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name.removeSuffix(\"@aar\")}.\\n\" +\n+                                        \"To resolve this issue, consider updating the build file to the latest firebase-iid version.\")\n                     }\n                 }\n             }\n         }\n     }\n \n     private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {\n-        // TODO: implement version check\n-        return coordinates.version == \"0.0.0\"\n+        val versionComponents = coordinates.version.split('.').toTypedArray()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3OTQzNg==", "bodyText": "Generally it's not a good idea to use negative words in method or variable names.\nThus, I would recommend to call this #isCompatibleInstanceIdVersion", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393379436", "createdAt": "2020-03-17T00:17:05Z", "author": {"login": "andirayo"}, "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -59,15 +53,29 @@ class IncompatibleIidVersionDetector : Detector() {\n                     if (isIncompatibleVersion(coordinates)) {\n                         context.report(INCOMPATIBLE_IID_VERSION,\n                                 Location.create(context.file),\n-                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name.removeSuffix(\"@aar\")}.\\n\" +\n+                                        \"To resolve this issue, consider updating the build file to the latest firebase-iid version.\")\n                     }\n                 }\n             }\n         }\n     }\n \n     private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "350b15128b2beb5d681aa5f5090f3dad3a9714cd", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/350b15128b2beb5d681aa5f5090f3dad3a9714cd", "committedDate": "2020-03-17T00:46:54Z", "message": "Addressing Rayo's comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1Njg3Mjcy", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#pullrequestreview-375687272", "createdAt": "2020-03-17T01:45:04Z", "commit": {"oid": "350b15128b2beb5d681aa5f5090f3dad3a9714cd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19bc81debdd13a9901d582efb7b2021a1c640c9a", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/19bc81debdd13a9901d582efb7b2021a1c640c9a", "committedDate": "2020-03-17T16:27:05Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into lintJar"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2174, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}