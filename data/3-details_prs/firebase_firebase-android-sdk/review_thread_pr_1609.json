{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2MjAwODQ5", "number": 1609, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDozNzoxOVrOEBgYTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxOTowNTowMlrOECSKZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDE0NTQyOnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDozNzoxOVrOGdZPyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDozNzoxOVrOGdZPyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3NTUzMA==", "bodyText": "Can we just throw 1 exception type here?\nOr where happens the unification (of exception types) for users?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433475530", "createdAt": "2020-06-01T20:37:19Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -444,7 +444,7 @@ private String readExistingIidOrCreateFid(PersistedInstallationEntry prefs) {\n \n   /** Registers the created Fid with FIS servers and update the persisted state. */\n   private PersistedInstallationEntry registerFidWithServer(PersistedInstallationEntry prefs)\n-      throws IOException {\n+      throws FirebaseInstallationsException, IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDE1MjUwOnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDozOTozOVrOGdZUKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMjo0MTo0NFrOGdcacQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3NjY1MA==", "bodyText": "Why do we catch FirebaseException here?\na) Do we ever use any Exception type other than FirebaseInstallationsException?\nIf yes: why? If no: I recommend to check for FirebaseInstallationsException here.\nb) Why do we catch FirebaseInstallationsException?\ncatching and rethrowing the same exception is an antipattern.\nCan we not just leave the FirebaseInstallationsException as is?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433476650", "createdAt": "2020-06-01T20:39:39Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -527,7 +532,7 @@ private Void deleteFirebaseInstallationId() throws FirebaseInstallationsExceptio\n             /*projectID= */ getProjectIdentifier(),\n             /*refreshToken= */ entry.getRefreshToken());\n \n-      } catch (FirebaseException exception) {\n+      } catch (FirebaseException | IOException exception) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzUyNzQwOQ==", "bodyText": "Update to check only FirebaseInstallationsException.\nAgreed on the anti-pattern. Updated the code to remove this code.\nI don't know the reason why we had this anti-pattern behavior before.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433527409", "createdAt": "2020-06-01T22:41:44Z", "author": {"login": "ankitaj224"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -527,7 +532,7 @@ private Void deleteFirebaseInstallationId() throws FirebaseInstallationsExceptio\n             /*projectID= */ getProjectIdentifier(),\n             /*refreshToken= */ entry.getRefreshToken());\n \n-      } catch (FirebaseException exception) {\n+      } catch (FirebaseException | IOException exception) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3NjY1MA=="}, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDE1OTU3OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallationsException.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDo0MTo1M1rOGdZYlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDo0MTo1M1rOGdZYlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3Nzc4MQ==", "bodyText": "What \"backoff\" are you referring to?\nExponential backoff?\nIf this is a public comment, I think I would either omit this addition or frame it like this:\n\"This is a most likely due to a transient condition and may be corrected by retrying. We recommend exponential backoff when retrying requests.\"", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433477781", "createdAt": "2020-06-01T20:41:53Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallationsException.java", "diffHunk": "@@ -29,6 +29,11 @@\n      * Project.\n      */\n     BAD_CONFIG,\n+    /**\n+     * The service is currently unavailable. This is a most likely a transient condition and may be\n+     * corrected by retrying with a backoff.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDE2Mjc5OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDo0Mjo0N1rOGdZacQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDo0Mjo0N1rOGdZacQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3ODI1Nw==", "bodyText": "Why are we still throwing IOException?\nCan we get around this and only throw 1 exception type?\nSee comment below.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433478257", "createdAt": "2020-06-01T20:42:47Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -138,7 +138,7 @@ public InstallationResponse createFirebaseInstallation(\n       @NonNull String projectID,\n       @NonNull String appId,\n       @Nullable String iidToken)\n-      throws IOException {\n+      throws FirebaseInstallationsException, IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDE2NDU1OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDo0MzoxNVrOGdZbeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDo0MzoxNVrOGdZbeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3ODUyMg==", "bodyText": "If we catch and ignore IOException here, can we remove IOException from the method interface?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433478522", "createdAt": "2020-06-01T20:43:15Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -179,12 +179,16 @@ public InstallationResponse createFirebaseInstallation(\n \n         // Return empty installation response with BAD_CONFIG response code after max retries\n         return InstallationResponse.builder().setResponseCode(ResponseCode.BAD_CONFIG).build();\n+      } catch (IOException ignored) {\n+        retryCount++;\n       } finally {\n         httpURLConnection.disconnect();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDE2NjY2OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDo0Mzo1N1rOGdZc2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMjoxMToxOVrOGdbzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3ODg3NA==", "bodyText": "Same question as before.\nBtw, just as a comment, no action item for this PR: quite a bit of code duplication going on here.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433478874", "createdAt": "2020-06-01T20:43:57Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -352,7 +360,7 @@ public TokenResult generateAuthToken(\n       @NonNull String fid,\n       @NonNull String projectID,\n       @NonNull String refreshToken)\n-      throws IOException {\n+      throws FirebaseInstallationsException, IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzUxNzM2MA==", "bodyText": "I will address the code duplication in another PR. Updated the exception handling.  PTAL. Thanks", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433517360", "createdAt": "2020-06-01T22:11:19Z", "author": {"login": "ankitaj224"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -352,7 +360,7 @@ public TokenResult generateAuthToken(\n       @NonNull String fid,\n       @NonNull String projectID,\n       @NonNull String refreshToken)\n-      throws IOException {\n+      throws FirebaseInstallationsException, IOException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3ODg3NA=="}, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDE2OTM0OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMDo0NDo0NlrOGdZejA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQyMjoxMDoyNlrOGdbyBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3OTMwOA==", "bodyText": "is it maybe enough to wrap this line with the try-catch block?\nMaybe it gives more clarity about what can go wrong here.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433479308", "createdAt": "2020-06-01T20:44:46Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -407,27 +419,37 @@ private static void logBadConfigError() {\n             + \" initializing Firebase.\");\n   }\n \n-  private HttpURLConnection openHttpURLConnection(URL url, String apiKey) throws IOException {\n-    HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n-    httpURLConnection.setConnectTimeout(NETWORK_TIMEOUT_MILLIS);\n-    httpURLConnection.setUseCaches(false);\n-    httpURLConnection.setReadTimeout(NETWORK_TIMEOUT_MILLIS);\n-    httpURLConnection.addRequestProperty(CONTENT_TYPE_HEADER_KEY, JSON_CONTENT_TYPE);\n-    httpURLConnection.addRequestProperty(ACCEPT_HEADER_KEY, JSON_CONTENT_TYPE);\n-    httpURLConnection.addRequestProperty(CONTENT_ENCODING_HEADER_KEY, GZIP_CONTENT_ENCODING);\n-    httpURLConnection.addRequestProperty(CACHE_CONTROL_HEADER_KEY, CACHE_CONTROL_DIRECTIVE);\n-    httpURLConnection.addRequestProperty(X_ANDROID_PACKAGE_HEADER_KEY, context.getPackageName());\n-    if (heartbeatInfo != null && userAgentPublisher != null) {\n-      HeartBeat heartbeat = heartbeatInfo.getHeartBeatCode(FIREBASE_INSTALLATIONS_ID_HEARTBEAT_TAG);\n-      if (heartbeat != HeartBeat.NONE) {\n-        httpURLConnection.addRequestProperty(USER_AGENT_HEADER, userAgentPublisher.getUserAgent());\n-        httpURLConnection.addRequestProperty(\n-            HEART_BEAT_HEADER, Integer.toString(heartbeat.getCode()));\n+  private HttpURLConnection openHttpURLConnection(URL url, String apiKey)\n+      throws FirebaseInstallationsException {\n+    try {\n+      HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 116}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzUxNzA2Mg==", "bodyText": "Done.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433517062", "createdAt": "2020-06-01T22:10:26Z", "author": {"login": "ankitaj224"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -407,27 +419,37 @@ private static void logBadConfigError() {\n             + \" initializing Firebase.\");\n   }\n \n-  private HttpURLConnection openHttpURLConnection(URL url, String apiKey) throws IOException {\n-    HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n-    httpURLConnection.setConnectTimeout(NETWORK_TIMEOUT_MILLIS);\n-    httpURLConnection.setUseCaches(false);\n-    httpURLConnection.setReadTimeout(NETWORK_TIMEOUT_MILLIS);\n-    httpURLConnection.addRequestProperty(CONTENT_TYPE_HEADER_KEY, JSON_CONTENT_TYPE);\n-    httpURLConnection.addRequestProperty(ACCEPT_HEADER_KEY, JSON_CONTENT_TYPE);\n-    httpURLConnection.addRequestProperty(CONTENT_ENCODING_HEADER_KEY, GZIP_CONTENT_ENCODING);\n-    httpURLConnection.addRequestProperty(CACHE_CONTROL_HEADER_KEY, CACHE_CONTROL_DIRECTIVE);\n-    httpURLConnection.addRequestProperty(X_ANDROID_PACKAGE_HEADER_KEY, context.getPackageName());\n-    if (heartbeatInfo != null && userAgentPublisher != null) {\n-      HeartBeat heartbeat = heartbeatInfo.getHeartBeatCode(FIREBASE_INSTALLATIONS_ID_HEARTBEAT_TAG);\n-      if (heartbeat != HeartBeat.NONE) {\n-        httpURLConnection.addRequestProperty(USER_AGENT_HEADER, userAgentPublisher.getUserAgent());\n-        httpURLConnection.addRequestProperty(\n-            HEART_BEAT_HEADER, Integer.toString(heartbeat.getCode()));\n+  private HttpURLConnection openHttpURLConnection(URL url, String apiKey)\n+      throws FirebaseInstallationsException {\n+    try {\n+      HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ3OTMwOA=="}, "originalCommit": {"oid": "6ddee387374f596854ab374ca56afa54944f4ad1"}, "originalPosition": 116}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDc5MDAwOnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwMTo0NjozNFrOGdfc0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMjo1NDo1MFrOGeGmSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU3NzE2OA==", "bodyText": "Why are you casting this URLConnection?\nAre you using methods that are specific to HttpURLConnection?\nIf not, I strongly recommend programming against the interface rather than the implementation.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433577168", "createdAt": "2020-06-02T01:46:34Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -407,8 +412,16 @@ private static void logBadConfigError() {\n             + \" initializing Firebase.\");\n   }\n \n-  private HttpURLConnection openHttpURLConnection(URL url, String apiKey) throws IOException {\n-    HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n+  private HttpURLConnection openHttpURLConnection(URL url, String apiKey)\n+      throws FirebaseInstallationsException {\n+    HttpURLConnection httpURLConnection;\n+    try {\n+      httpURLConnection = (HttpURLConnection) url.openConnection();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eb7d6d4f0e7bcd85ba5296fafecd6b969ffbf8f"}, "originalPosition": 169}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIxODU3MA==", "bodyText": "Yes, I am using methods specific to HttpURLConnection", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r434218570", "createdAt": "2020-06-02T22:54:50Z", "author": {"login": "ankitaj224"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -407,8 +412,16 @@ private static void logBadConfigError() {\n             + \" initializing Firebase.\");\n   }\n \n-  private HttpURLConnection openHttpURLConnection(URL url, String apiKey) throws IOException {\n-    HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n+  private HttpURLConnection openHttpURLConnection(URL url, String apiKey)\n+      throws FirebaseInstallationsException {\n+    HttpURLConnection httpURLConnection;\n+    try {\n+      httpURLConnection = (HttpURLConnection) url.openConnection();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU3NzE2OA=="}, "originalCommit": {"oid": "0eb7d6d4f0e7bcd85ba5296fafecd6b969ffbf8f"}, "originalPosition": 169}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDc5NTQ3OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwMTo0OTo1OFrOGdfgEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwMTo0OTo1OFrOGdfgEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU3ODAwMg==", "bodyText": "+1 for adding this method!\nAn idea for a different name (feel free to ignore):\n#getFullyQualifiedRequestUri\n#getFullyQualifiedApiEndpoint", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433578002", "createdAt": "2020-06-02T01:49:58Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -321,12 +313,27 @@ public void deleteFirebaseInstallation(\n \n         throw new FirebaseInstallationsException(\n             \"Bad config while trying to delete FID\", Status.BAD_CONFIG);\n+      } catch (IOException ignored) {\n+        retryCount++;\n       } finally {\n         httpURLConnection.disconnect();\n       }\n     }\n \n-    throw new IOException();\n+    throw new FirebaseInstallationsException(\n+        \"Firebase Installations Service is unavailable. Please try again later.\",\n+        Status.UNAVAILABLE);\n+  }\n+\n+  private URL getURL(String resourceName) throws FirebaseInstallationsException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eb7d6d4f0e7bcd85ba5296fafecd6b969ffbf8f"}, "originalPosition": 99}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMDc5NzE0OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwMTo1MDo1NFrOGdfhCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwMTo1MDo1NFrOGdfhCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU3ODI0OQ==", "bodyText": "This seems to be a pretty dramatic error.\nHow about we add some message here, e.g.\n\"Unexpected internal error while creating request URI.\"\nI don't know.\nFeel free to ignore.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r433578249", "createdAt": "2020-06-02T01:50:54Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -321,12 +313,27 @@ public void deleteFirebaseInstallation(\n \n         throw new FirebaseInstallationsException(\n             \"Bad config while trying to delete FID\", Status.BAD_CONFIG);\n+      } catch (IOException ignored) {\n+        retryCount++;\n       } finally {\n         httpURLConnection.disconnect();\n       }\n     }\n \n-    throw new IOException();\n+    throw new FirebaseInstallationsException(\n+        \"Firebase Installations Service is unavailable. Please try again later.\",\n+        Status.UNAVAILABLE);\n+  }\n+\n+  private URL getURL(String resourceName) throws FirebaseInstallationsException {\n+    try {\n+      return new URL(\n+          String.format(\n+              \"https://%s/%s/%s\",\n+              FIREBASE_INSTALLATIONS_API_DOMAIN, FIREBASE_INSTALLATIONS_API_VERSION, resourceName));\n+    } catch (MalformedURLException e) {\n+      throw new FirebaseInstallationsException(e.getMessage(), Status.UNAVAILABLE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eb7d6d4f0e7bcd85ba5296fafecd6b969ffbf8f"}, "originalPosition": 106}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwODMwMTgxOnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallationsException.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxOTowNTowMlrOGepfSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxOTowNTowMlrOGepfSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDc5MDIxOQ==", "bodyText": "extra quote?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1609#discussion_r434790219", "createdAt": "2020-06-03T19:05:02Z", "author": {"login": "ciarand"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallationsException.java", "diffHunk": "@@ -29,6 +29,12 @@\n      * Project.\n      */\n     BAD_CONFIG,\n+\n+    /**\n+     * The service is currently unavailable. This is a most likely due to a transient condition and\n+     * may be corrected by retrying. We recommend exponential backoff when retrying requests.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "882836eafedf66b95dafa99e89b07166643d0bfb"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1394, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}