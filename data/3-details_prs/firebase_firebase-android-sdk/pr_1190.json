{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNTYxMjk3", "number": 1190, "title": "Chime Hack: Allow Chime to migrate Insatnce_IDs.", "bodyText": "", "createdAt": "2020-02-03T22:49:14Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190", "merged": true, "mergeCommit": {"oid": "7a20fd3121133bc02013d5c5372c732680c7e038"}, "closed": true, "closedAt": "2020-02-03T23:45:39Z", "author": {"login": "ankitaj224"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcA09DfAH2gAyMzcwNTYxMjk3OjZjNWQ0YjUzZWEyMmRlODc2ZTVhYTQyZWM3ODQzYmUyYzViMDAxN2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcA1nBCAH2gAyMzcwNTYxMjk3OjRkMTU2NTY2NDJkNWUxNTEzZDFhNDc5ZWQ2YTljNGU0OTQwNjQ2YjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/6c5d4b53ea22de876e5aa42ec7843be2c5b0017b", "committedDate": "2020-02-03T22:47:50Z", "message": "Chime Hack: Allow Chime to migrate Insatnce_IDs."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNjI5NjQ4", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#pullrequestreview-352629648", "createdAt": "2020-02-03T23:13:20Z", "commit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzoxMzoyMFrOFlDQOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzoxMzoyMFrOFlDQOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5NDkzOA==", "bodyText": "shouldn't this be a separate PR?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#discussion_r374394938", "createdAt": "2020-02-03T23:13:20Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -363,13 +364,14 @@ private PersistedInstallationEntry getPrefsWithGeneratedIdMultiProcessSafe() {\n   }\n \n   private String readExistingIidOrCreateFid(PersistedInstallationEntry prefs) {\n-    // Check if this firebase app is the default (first initialized) instance\n-    if (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration()) {\n+    // Check if this firebase app is the default (first initialized) instance or is a chime app\n+    if (!firebaseApp.getName().equals(CHIME_FIREBASE_APP_NAME)\n+        && (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration())) {\n       return fidGenerator.createRandomFid();\n     }\n-    // For a default firebase installation, read the existing iid from shared prefs\n+    // For a default/chime firebase installation, read the existing iid from shared prefs\n     String fid = iidStore.readIid();\n-    if (fid == null) {\n+    if (TextUtils.isEmpty(fid)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNjMwNTY5", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#pullrequestreview-352630569", "createdAt": "2020-02-03T23:15:39Z", "commit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzoxNTozOVrOFlDTRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzoxNTozOVrOFlDTRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5NTcxNw==", "bodyText": "Not sure if the bracketing is right here...\nI don't know what #shouldAttemptMigration does (so I might be wrong here)...\nBut it seems, that this should be changed to:\nif ((!firebaseApp.getName().equals(CHIME_FIREBASE_APP_NAME) && !firebaseApp.isDefaultApp())\n   || !prefs.shouldAttemptMigration()) {", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#discussion_r374395717", "createdAt": "2020-02-03T23:15:39Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -363,13 +364,14 @@ private PersistedInstallationEntry getPrefsWithGeneratedIdMultiProcessSafe() {\n   }\n \n   private String readExistingIidOrCreateFid(PersistedInstallationEntry prefs) {\n-    // Check if this firebase app is the default (first initialized) instance\n-    if (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration()) {\n+    // Check if this firebase app is the default (first initialized) instance or is a chime app\n+    if (!firebaseApp.getName().equals(CHIME_FIREBASE_APP_NAME)\n+        && (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNjMwNjUz", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#pullrequestreview-352630653", "createdAt": "2020-02-03T23:15:50Z", "commit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d15656642d5e1513d1a479ed6a9c4e4940646b0", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/4d15656642d5e1513d1a479ed6a9c4e4940646b0", "committedDate": "2020-02-03T23:33:40Z", "message": "Addressing Rayo's comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2294, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}