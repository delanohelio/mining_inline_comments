{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4NzU0MjA4", "number": 1175, "title": "Add support for ignoring nulls in JsonDataEncoder", "bodyText": "", "createdAt": "2020-01-29T20:37:52Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1175", "merged": true, "mergeCommit": {"oid": "58ce4c0c064db5904a7b6cde736ed098690bce65"}, "closed": true, "closedAt": "2020-01-30T18:06:51Z", "author": {"login": "mrwillis21"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_MJgSAFqTM1MDQwOTgyNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_dKoYgBqjI5OTQwMzY1NDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwNDA5ODI2", "url": "https://github.com/firebase/firebase-android-sdk/pull/1175#pullrequestreview-350409826", "createdAt": "2020-01-29T20:41:24Z", "commit": {"oid": "9402b243076df8945e0e309ef0d98ebbf48293cc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwNDU0MzYy", "url": "https://github.com/firebase/firebase-android-sdk/pull/1175#pullrequestreview-350454362", "createdAt": "2020-01-29T21:59:02Z", "commit": {"oid": "ae2ca18015214cd34cf01fe6730bf79bc4e2ac57"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQyMTo1OTowMlrOFjY_9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQyMTo1OTowMlrOFjY_9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY1NDA2OA==", "bodyText": "I think you can go further simplify by just adding here\nif (ignoreNullValues && o == null) return this;\n\nand the rest of the code can stay the same.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1175#discussion_r372654068", "createdAt": "2020-01-29T21:59:02Z", "author": {"login": "rlazo"}, "path": "encoders/firebase-encoders-json/src/json/java/com/google/firebase/encoders/json/JsonValueObjectEncoderContext.java", "diffHunk": "@@ -37,36 +37,37 @@\n   private final Map<Class<?>, ObjectEncoder<?>> objectEncoders;\n   private final Map<Class<?>, ValueEncoder<?>> valueEncoders;\n   private final ObjectEncoder<Object> fallbackEncoder;\n+  private final boolean ignoreNullValues;\n \n   JsonValueObjectEncoderContext(\n       @NonNull Writer writer,\n       @NonNull Map<Class<?>, ObjectEncoder<?>> objectEncoders,\n       @NonNull Map<Class<?>, ValueEncoder<?>> valueEncoders,\n-      ObjectEncoder<Object> fallbackEncoder) {\n+      ObjectEncoder<Object> fallbackEncoder,\n+      boolean ignoreNullValues) {\n     this.jsonWriter = new JsonWriter(writer);\n     this.objectEncoders = objectEncoders;\n     this.valueEncoders = valueEncoders;\n     this.fallbackEncoder = fallbackEncoder;\n+    this.ignoreNullValues = ignoreNullValues;\n   }\n \n   private JsonValueObjectEncoderContext(JsonValueObjectEncoderContext anotherContext) {\n     this.jsonWriter = anotherContext.jsonWriter;\n     this.objectEncoders = anotherContext.objectEncoders;\n     this.valueEncoders = anotherContext.valueEncoders;\n     this.fallbackEncoder = anotherContext.fallbackEncoder;\n+    this.ignoreNullValues = anotherContext.ignoreNullValues;\n   }\n \n   @NonNull\n   @Override\n   public JsonValueObjectEncoderContext add(@NonNull String name, @Nullable Object o)\n       throws IOException, EncodingException {\n-    maybeUnNest();\n-    jsonWriter.name(name);\n-    if (o == null) {\n-      jsonWriter.nullValue();\n-      return this;\n+    if (ignoreNullValues) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae2ca18015214cd34cf01fe6730bf79bc4e2ac57"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwNDcxNzA2", "url": "https://github.com/firebase/firebase-android-sdk/pull/1175#pullrequestreview-350471706", "createdAt": "2020-01-29T22:31:37Z", "commit": {"oid": "ae2ca18015214cd34cf01fe6730bf79bc4e2ac57"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c21ccaec437242756e4199b887037db614b67d31", "author": {"user": {"login": "mrwillis21", "name": "Matt Willis"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/c21ccaec437242756e4199b887037db614b67d31", "committedDate": "2020-01-30T16:30:45Z", "message": "Add support for ignoring nulls in JsonDataEncoder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94604dc579327ff46ca459d8243fd13879b4e331", "author": {"user": {"login": "mrwillis21", "name": "Matt Willis"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/94604dc579327ff46ca459d8243fd13879b4e331", "committedDate": "2020-01-30T16:30:45Z", "message": "Change 'ignoreNulls' to 'ignoreNullValues'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5113d03c0990076b196e3172bad3720e1e968d3d", "author": {"user": {"login": "mrwillis21", "name": "Matt Willis"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/5113d03c0990076b196e3172bad3720e1e968d3d", "committedDate": "2020-01-30T16:30:45Z", "message": "Add to API file and bump version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd90d1a94ca5ae6e6167e395cc2a93df34d41f31", "author": {"user": {"login": "mrwillis21", "name": "Matt Willis"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/fd90d1a94ca5ae6e6167e395cc2a93df34d41f31", "committedDate": "2020-01-30T16:30:45Z", "message": "Replace dynamic dispatch with simpler 'if' check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "202f3f9f95aca0abd27bf662911339a0f33b6e4c", "author": {"user": {"login": "mrwillis21", "name": "Matt Willis"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/202f3f9f95aca0abd27bf662911339a0f33b6e4c", "committedDate": "2020-01-30T16:30:45Z", "message": "Remove interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae2ca18015214cd34cf01fe6730bf79bc4e2ac57", "author": {"user": {"login": "mrwillis21", "name": "Matt Willis"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/ae2ca18015214cd34cf01fe6730bf79bc4e2ac57", "committedDate": "2020-01-29T21:48:26Z", "message": "Remove interface"}, "afterCommit": {"oid": "202f3f9f95aca0abd27bf662911339a0f33b6e4c", "author": {"user": {"login": "mrwillis21", "name": "Matt Willis"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/202f3f9f95aca0abd27bf662911339a0f33b6e4c", "committedDate": "2020-01-30T16:30:45Z", "message": "Remove interface"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2280, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}