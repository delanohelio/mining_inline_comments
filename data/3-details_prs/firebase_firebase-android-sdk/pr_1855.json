{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNDU1OTg1", "number": 1855, "title": "Log-adjusted backoff logic.", "bodyText": "The effect of the change is that initial attempts with small delay\nare spread out in time more, which increases the overall time that\nevents are stored.", "createdAt": "2020-08-05T15:24:11Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1855", "merged": true, "mergeCommit": {"oid": "975bb5977a682077fa8e2304f849fcb9481082d3"}, "closed": true, "closedAt": "2020-08-06T17:37:20Z", "author": {"login": "vkryachko"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc781jqgH2gAyNDYzNDU1OTg1OjhlNWQ4MGUyZmZhN2U2YjJmNDc1YjBjMWYyZjI1YWFiZWE2YWRjZTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8TFehgFqTQ2MjcyMDUxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8e5d80e2ffa7e6b2f475b0c1f2f25aabea6adce9", "author": {"user": {"login": "vkryachko", "name": "Vladimir Kryachko"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/8e5d80e2ffa7e6b2f475b0c1f2f25aabea6adce9", "committedDate": "2020-08-05T15:20:25Z", "message": "Log-adjusted backoff logic.\n\nThe effect of the change is that initial attempts with small delay\nare spread out in time more, which increases the overall time that\nevents are stored."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNzExNTI2", "url": "https://github.com/firebase/firebase-android-sdk/pull/1855#pullrequestreview-462711526", "createdAt": "2020-08-06T17:10:29Z", "commit": {"oid": "8e5d80e2ffa7e6b2f475b0c1f2f25aabea6adce9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNzIwNTEy", "url": "https://github.com/firebase/firebase-android-sdk/pull/1855#pullrequestreview-462720512", "createdAt": "2020-08-06T17:15:42Z", "commit": {"oid": "8e5d80e2ffa7e6b2f475b0c1f2f25aabea6adce9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNzoxNTo0M1rOG88vbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNzoxNTo0M1rOG88vbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU2MjkyNw==", "bodyText": "I know this algorithm is being used just because it works out the way we want - but it would help to have some commentary about why we're using this rather complex logic, for anyone down the line wondering why this was chosen.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1855#discussion_r466562927", "createdAt": "2020-08-06T17:15:43Z", "author": {"login": "mrwillis21"}, "path": "transport/transport-runtime/src/main/java/com/google/android/datatransport/runtime/scheduling/jobscheduling/SchedulerConfig.java", "diffHunk": "@@ -135,10 +137,20 @@ public long getScheduleDelay(Priority priority, long minTimestamp, int attemptNu\n     long timeDiff = minTimestamp - getClock().getTime();\n     ConfigValue config = getValues().get(priority);\n \n-    long delay = Math.max(((long) Math.pow(2, attemptNumber - 1)) * config.getDelta(), timeDiff);\n+    long delay = Math.max(adjustedExponentialBackoff(attemptNumber, config.getDelta()), timeDiff);\n     return Math.min(delay, config.getMaxAllowedDelay());\n   }\n \n+  private long adjustedExponentialBackoff(int attemptNumber, long delta) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e5d80e2ffa7e6b2f475b0c1f2f25aabea6adce9"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2477, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}