{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3MDIwNDc0", "number": 1555, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMzo0MjoxOVrOD73LKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMzo0MjoxOVrOD73LKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0MDk2NTUzOnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMzo0MjoxOVrOGUcsSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMzoyNDozOFrOGVxdQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA5NDc5Mw==", "bodyText": "Aren't you worried that this might trigger unexpected errors?\nHave you tested this already or should we test it maybe?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1555#discussion_r424094793", "createdAt": "2020-05-12T23:42:19Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -407,6 +407,7 @@ private static void logBadConfigError() {\n   private HttpURLConnection openHttpURLConnection(URL url, String apiKey) throws IOException {\n     HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n     httpURLConnection.setConnectTimeout(NETWORK_TIMEOUT_MILLIS);\n+    httpURLConnection.setUseCaches(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fdb05134dc2e5fc64b01df8b1979f1188e0e54ac"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU5NTM4Ng==", "bodyText": "Additionally, are we sure that POSTs actually respect this value? I would imagine that posts are just never cached", "url": "https://github.com/firebase/firebase-android-sdk/pull/1555#discussion_r424595386", "createdAt": "2020-05-13T17:05:11Z", "author": {"login": "vkryachko"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -407,6 +407,7 @@ private static void logBadConfigError() {\n   private HttpURLConnection openHttpURLConnection(URL url, String apiKey) throws IOException {\n     HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n     httpURLConnection.setConnectTimeout(NETWORK_TIMEOUT_MILLIS);\n+    httpURLConnection.setUseCaches(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA5NDc5Mw=="}, "originalCommit": {"oid": "fdb05134dc2e5fc64b01df8b1979f1188e0e54ac"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ2MTgxNA==", "bodyText": "Since Android 4.4, it uses okhttp for all Http calls.\nsetUseCaches is set to true by default.\nThe ResponseCache implementation decides which resources should be cached, and for how long they should be cached. If a request resource cannot be retrieved from the cache, then the protocol handlers will fetch the resource from its original location. The settings for URLConnection#useCaches controls whether the protocol is allowed to use a cached response.\nFrom the user reported stack trace:\ncom.android.okhttp.internal.huc.JavaApiConverter.createOkResponseForCacheGet(JavaApiConverter.java:216) \nAnd the javadocs of JavaApiConverter.createOkResponseForCacheGet: Creates an OkHttp Response using the supplied Request and CacheResponse to supply the data\nLooks like there is response caching internally.\nRegarding POST not being cached:\nFrom the rfc : Responses to POST method are not cacheable, unless the response includes appropriate Cache-Control or Expires header fields.\nCache-Control is set to private for getToken response.\n@vkryachko Do you see any issue in disabling the cache?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1555#discussion_r425461814", "createdAt": "2020-05-14T22:16:51Z", "author": {"login": "ankitaj224"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -407,6 +407,7 @@ private static void logBadConfigError() {\n   private HttpURLConnection openHttpURLConnection(URL url, String apiKey) throws IOException {\n     HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n     httpURLConnection.setConnectTimeout(NETWORK_TIMEOUT_MILLIS);\n+    httpURLConnection.setUseCaches(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA5NDc5Mw=="}, "originalCommit": {"oid": "fdb05134dc2e5fc64b01df8b1979f1188e0e54ac"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ4MzU4Ng==", "bodyText": "Also, I think we can benefit from setting Cache-Control request header as  no-cache", "url": "https://github.com/firebase/firebase-android-sdk/pull/1555#discussion_r425483586", "createdAt": "2020-05-14T23:24:38Z", "author": {"login": "ankitaj224"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/remote/FirebaseInstallationServiceClient.java", "diffHunk": "@@ -407,6 +407,7 @@ private static void logBadConfigError() {\n   private HttpURLConnection openHttpURLConnection(URL url, String apiKey) throws IOException {\n     HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n     httpURLConnection.setConnectTimeout(NETWORK_TIMEOUT_MILLIS);\n+    httpURLConnection.setUseCaches(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA5NDc5Mw=="}, "originalCommit": {"oid": "fdb05134dc2e5fc64b01df8b1979f1188e0e54ac"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1360, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}