{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MDY1NTg1", "number": 1263, "title": "Quick Fix: FIS SDK \"current time\" doesn't get update.", "bodyText": "FIS SDK is not aware of the real system time due to the \"current time\" was set once when the calendar instance got initialized (at app launches in our case). This bug makes FIS SDK not being able to fetch new AuthToken on time which causes 1M+ authentication fails on VerifyToken RPC call.\nNote: this is a quick fix. Some affected tests removed should be brought back when @ankitaj224  is back to work.", "createdAt": "2020-02-21T01:56:31Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1263", "merged": true, "mergeCommit": {"oid": "bea995412832e97cd317a4329ee5c863e4605cdb"}, "closed": true, "closedAt": "2020-02-21T03:01:06Z", "author": {"login": "ChaoqunCHEN"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGVba1gH2gAyMzc4MDY1NTg1OmI1MThjYjgzZjc1MTBlMzk2Nzc5MDlmYWViNmQ5NDRlODE2MzliNmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGWwC2gH2gAyMzc4MDY1NTg1OjkyNjcwMjIwNzAzY2YxMWFhN2FmYjlkNDdiNDRmOWRiYWJmNTAzOTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b518cb83f7510e39677909faeb6d944e81639b6c", "author": {"user": {"login": "ChaoqunCHEN", "name": null}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/b518cb83f7510e39677909faeb6d944e81639b6c", "committedDate": "2020-02-21T01:27:35Z", "message": "Fix bug: FIS SDK system time doesn't get update."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMzYwMjIy", "url": "https://github.com/firebase/firebase-android-sdk/pull/1263#pullrequestreview-362360222", "createdAt": "2020-02-21T02:07:50Z", "commit": {"oid": "b518cb83f7510e39677909faeb6d944e81639b6c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d39769d34eb2943509184e30a7544a02c0046b6", "author": {"user": {"login": "ChaoqunCHEN", "name": null}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/3d39769d34eb2943509184e30a7544a02c0046b6", "committedDate": "2020-02-21T02:39:29Z", "message": "Fix bug: FIS SDK system time doesn't get update."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2b32447b15b128d56a0cd1ed0da0fc12ce00372", "author": {"user": {"login": "ChaoqunCHEN", "name": null}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/f2b32447b15b128d56a0cd1ed0da0fc12ce00372", "committedDate": "2020-02-21T02:47:11Z", "message": "Merge branch 'fix-fis-system-time' of github.com:firebase/firebase-android-sdk into fix-fis-system-time"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMzcyMDQ4", "url": "https://github.com/firebase/firebase-android-sdk/pull/1263#pullrequestreview-362372048", "createdAt": "2020-02-21T02:54:23Z", "commit": {"oid": "f2b32447b15b128d56a0cd1ed0da0fc12ce00372"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwMjo1NDoyM1rOFsqLag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwMjo1NDoyM1rOFsqLag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjM3MjcxNA==", "bodyText": "make this + TimeUnit.MINUTES.toSeconds(30) please\nFIS SDK should update a FIS auth token even if it is still valid for another hour...\n(see grace period)", "url": "https://github.com/firebase/firebase-android-sdk/pull/1263#discussion_r382372714", "createdAt": "2020-02-21T02:54:23Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/test/java/com/google/firebase/installations/FirebaseInstallationsTest.java", "diffHunk": "@@ -639,13 +554,13 @@ public void testGetAuthToken_expiredAuthToken_fetchedNewTokenFromFIS() throws Ex\n         PersistedInstallationEntry.INSTANCE.withRegisteredFid(\n             TEST_FID_1,\n             TEST_REFRESH_TOKEN,\n-            utils.currentTimeInSecs(),\n+            // Make experation time to be 30 min ago\n+            utils.currentTimeInSecs()\n+                - TEST_TOKEN_EXPIRATION_TIMESTAMP\n+                - TimeUnit.MINUTES.toSeconds(30),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2b32447b15b128d56a0cd1ed0da0fc12ce00372"}, "originalPosition": 124}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMzcyMDY0", "url": "https://github.com/firebase/firebase-android-sdk/pull/1263#pullrequestreview-362372064", "createdAt": "2020-02-21T02:54:28Z", "commit": {"oid": "f2b32447b15b128d56a0cd1ed0da0fc12ce00372"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a97306169c49c87f16a3700cdde853c92116adb", "author": {"user": {"login": "ChaoqunCHEN", "name": null}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/6a97306169c49c87f16a3700cdde853c92116adb", "committedDate": "2020-02-21T02:56:54Z", "message": "Merge branch 'fix-fis-system-time' of github.com:firebase/firebase-android-sdk into fix-fis-system-time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92670220703cf11aa7afb9d47b44f9dbabf50397", "author": {"user": {"login": "ChaoqunCHEN", "name": null}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/92670220703cf11aa7afb9d47b44f9dbabf50397", "committedDate": "2020-02-21T03:00:01Z", "message": "Merge branch 'fix-fis-system-time' of github.com:firebase/firebase-android-sdk into fix-fis-system-time"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2087, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}