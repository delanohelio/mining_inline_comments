{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1NTcxMTA1", "number": 1150, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODozMjowNFrODZ7tiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODozNjowNlrODZ7yYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4NTE5MzA0OnYy", "diffSide": "RIGHT", "path": "firebase-firestore/src/main/java/com/google/firebase/firestore/UserDataConverter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODozMjowNFrOFgmisw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQyMzoxNDo0NlrOFguTOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTczMDIyNw==", "bodyText": "This is pretty verbose. How about ObjectValue.newBuilder()?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1150#discussion_r369730227", "createdAt": "2020-01-22T18:32:04Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/main/java/com/google/firebase/firestore/UserDataConverter.java", "diffHunk": "@@ -117,7 +117,7 @@ public ParsedUpdateData parseUpdateData(Map<String, Object> data) {\n \n     ParseAccumulator accumulator = new ParseAccumulator(UserData.Source.Update);\n     ParseContext context = accumulator.rootContext();\n-    ObjectValue updateData = ObjectValue.emptyObject();\n+    ObjectValue.Builder updateData = ObjectValue.Builder.emptyBuilder();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "550a831502e884355e2d312817dc8defe084fa4e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg1NzMzOA==", "bodyText": "Works for me. I got inspired by the rest of the Protobuf API.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1150#discussion_r369857338", "createdAt": "2020-01-22T23:14:46Z", "author": {"login": "schmidt-sebastian"}, "path": "firebase-firestore/src/main/java/com/google/firebase/firestore/UserDataConverter.java", "diffHunk": "@@ -117,7 +117,7 @@ public ParsedUpdateData parseUpdateData(Map<String, Object> data) {\n \n     ParseAccumulator accumulator = new ParseAccumulator(UserData.Source.Update);\n     ParseContext context = accumulator.rootContext();\n-    ObjectValue updateData = ObjectValue.emptyObject();\n+    ObjectValue.Builder updateData = ObjectValue.Builder.emptyBuilder();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTczMDIyNw=="}, "originalCommit": {"oid": "550a831502e884355e2d312817dc8defe084fa4e"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4NTE5OTAxOnYy", "diffSide": "RIGHT", "path": "firebase-firestore/src/main/java/com/google/firebase/firestore/model/mutation/TransformMutation.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODozNDowM1rOFgmmcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQyMzoxNDo1NVrOFguTZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTczMTE4Nw==", "bodyText": "Trailing .build() here seems wrong.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1150#discussion_r369731187", "createdAt": "2020-01-22T18:34:03Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/main/java/com/google/firebase/firestore/model/mutation/TransformMutation.java", "diffHunk": "@@ -227,11 +228,12 @@ private ObjectValue transformObject(ObjectValue objectValue, List<FieldValue> tr\n     hardAssert(\n         transformResults.size() == fieldTransforms.size(), \"Transform results length mismatch.\");\n \n+    ObjectValue.Builder builder = objectValue.toBuilder();\n     for (int i = 0; i < fieldTransforms.size(); i++) {\n       FieldTransform fieldTransform = fieldTransforms.get(i);\n       FieldPath fieldPath = fieldTransform.getFieldPath();\n-      objectValue = objectValue.set(fieldPath, transformResults.get(i));\n+      builder.set(fieldPath, transformResults.get(i)).build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "550a831502e884355e2d312817dc8defe084fa4e"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg1NzM4MA==", "bodyText": "Removed", "url": "https://github.com/firebase/firebase-android-sdk/pull/1150#discussion_r369857380", "createdAt": "2020-01-22T23:14:55Z", "author": {"login": "schmidt-sebastian"}, "path": "firebase-firestore/src/main/java/com/google/firebase/firestore/model/mutation/TransformMutation.java", "diffHunk": "@@ -227,11 +228,12 @@ private ObjectValue transformObject(ObjectValue objectValue, List<FieldValue> tr\n     hardAssert(\n         transformResults.size() == fieldTransforms.size(), \"Transform results length mismatch.\");\n \n+    ObjectValue.Builder builder = objectValue.toBuilder();\n     for (int i = 0; i < fieldTransforms.size(); i++) {\n       FieldTransform fieldTransform = fieldTransforms.get(i);\n       FieldPath fieldPath = fieldTransform.getFieldPath();\n-      objectValue = objectValue.set(fieldPath, transformResults.get(i));\n+      builder.set(fieldPath, transformResults.get(i)).build();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTczMTE4Nw=="}, "originalCommit": {"oid": "550a831502e884355e2d312817dc8defe084fa4e"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4NTIwNTQ1OnYy", "diffSide": "RIGHT", "path": "firebase-firestore/src/test/java/com/google/firebase/firestore/model/FieldValueTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODozNjowNlrOFgmqlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQyMzoxNToxMVrOFguTww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTczMjI0Nw==", "bodyText": "The caller doesn't necessarily have to pass an empty object, do they? Seems like empty could be objectValue, as it is below.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1150#discussion_r369732247", "createdAt": "2020-01-22T18:36:06Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/test/java/com/google/firebase/firestore/model/FieldValueTest.java", "diffHunk": "@@ -356,4 +374,12 @@ public void testValueOrdering() {\n         .addEqualityGroup(wrapObject(map(\"foo\", \"0\")))\n         .testCompare();\n   }\n+\n+  private ObjectValue setField(ObjectValue empty, String a, FieldValue mod) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "550a831502e884355e2d312817dc8defe084fa4e"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg1NzQ3NQ==", "bodyText": "Yeah, it should have been objectValue.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1150#discussion_r369857475", "createdAt": "2020-01-22T23:15:11Z", "author": {"login": "schmidt-sebastian"}, "path": "firebase-firestore/src/test/java/com/google/firebase/firestore/model/FieldValueTest.java", "diffHunk": "@@ -356,4 +374,12 @@ public void testValueOrdering() {\n         .addEqualityGroup(wrapObject(map(\"foo\", \"0\")))\n         .testCompare();\n   }\n+\n+  private ObjectValue setField(ObjectValue empty, String a, FieldValue mod) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTczMjI0Nw=="}, "originalCommit": {"oid": "550a831502e884355e2d312817dc8defe084fa4e"}, "originalPosition": 142}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 931, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}