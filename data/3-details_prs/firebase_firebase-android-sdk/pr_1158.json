{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2NDY2Mzkz", "number": 1158, "title": "Adding test utilities to create Value types", "bodyText": "This exposes a similar interface as wrap() and allows me to change the existing FieldValue test to use Value protos.\nFor reference: #1156", "createdAt": "2020-01-23T16:58:43Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158", "merged": true, "mergeCommit": {"oid": "94844bb71926990970c9798e8afee187f4a8bbf0"}, "closed": true, "closedAt": "2020-01-24T05:35:12Z", "author": {"login": "schmidt-sebastian"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9NPoegH2gAyMzY2NDY2MzkzOjVkM2Y0NGRiZTM3YzVlZjkxYmI5MGU0YWQ2ZmJmOWU3MWU2OGYyZDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9YLblgH2gAyMzY2NDY2MzkzOjA2M2EyNTY2ZTRhOWRiZjIyZWQzOWUxMGRiMGRmZjZhYTE4ZDI3ZTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5d3f44dbe37c5ef91bb90e4ad6fbf9e71e68f2d3", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/5d3f44dbe37c5ef91bb90e4ad6fbf9e71e68f2d3", "committedDate": "2020-01-23T16:50:09Z", "message": "Adding Proto-based equality and comparison\n\nThis will be used (and tested) in the follow-up CL that adds the FieldValue tpes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d006f0d59f7fa8df29414201376a61e1b54a355", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/5d006f0d59f7fa8df29414201376a61e1b54a355", "committedDate": "2020-01-23T16:57:17Z", "message": "Adding test utilities to create Value types\n\nThis exposes a similar interface as wrap() and allows me to change the existing FieldValue test to use Value protos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/8440ced4f5f4e42b0269ad464e5362ffc8fbafd1", "committedDate": "2020-01-23T18:01:10Z", "message": "Merge branch 'mrschmidt/comparisons' into mrschmidt/testhelpers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NTE2MTQ5", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#pullrequestreview-347516149", "createdAt": "2020-01-23T18:31:06Z", "commit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODozMTowN1rOFhIXIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxODo0MzoyM1rOFhIthA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4NDMyMA==", "bodyText": "I'm not a huge fan of classes named with \"Util\" or \"Helper\". How about just Values? This is a convention found in Guava, where e.g. helpers for creating/manipulating lists are in Lists.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370284320", "createdAt": "2020-01-23T18:31:07Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/ValueHelper.java", "diffHunk": "@@ -0,0 +1,98 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.firestore;\n+\n+import com.google.firebase.Timestamp;\n+import com.google.firebase.firestore.model.DatabaseId;\n+import com.google.firebase.firestore.model.DocumentKey;\n+import com.google.firestore.v1.ArrayValue;\n+import com.google.firestore.v1.Value;\n+import com.google.protobuf.NullValue;\n+import com.google.type.LatLng;\n+import java.util.List;\n+\n+/** Test helper to create Firestore Value protos from Java types. */\n+public class ValueHelper {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4NzkwNA==", "bodyText": "The rest of this class doesn't really have much to do with wrapping, but does create values. How about refValue or something like that?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370287904", "createdAt": "2020-01-23T18:38:46Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/ValueHelper.java", "diffHunk": "@@ -0,0 +1,98 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.firestore;\n+\n+import com.google.firebase.Timestamp;\n+import com.google.firebase.firestore.model.DatabaseId;\n+import com.google.firebase.firestore.model.DocumentKey;\n+import com.google.firestore.v1.ArrayValue;\n+import com.google.firestore.v1.Value;\n+import com.google.protobuf.NullValue;\n+import com.google.type.LatLng;\n+import java.util.List;\n+\n+/** Test helper to create Firestore Value protos from Java types. */\n+public class ValueHelper {\n+\n+  public static Value valueOf(Object o) {\n+    if (o instanceof Value) {\n+      return (Value) o;\n+    } else if (o instanceof String) {\n+      return (Value.newBuilder().setStringValue((String) o).build());\n+    } else if (o instanceof Integer) {\n+      return (Value.newBuilder().setIntegerValue((long) (Integer) o).build());\n+    } else if (o instanceof Long) {\n+      return (Value.newBuilder().setIntegerValue((Long) o).build());\n+    } else if (o instanceof Double) {\n+      return (Value.newBuilder().setDoubleValue((Double) o).build());\n+    } else if (o instanceof Boolean) {\n+      return (Value.newBuilder().setBooleanValue((Boolean) o).build());\n+    } else if (o instanceof Timestamp) {\n+      Timestamp timestamp = (Timestamp) o;\n+      return (Value.newBuilder()\n+          .setTimestampValue(\n+              com.google.protobuf.Timestamp.newBuilder()\n+                  .setSeconds(timestamp.getSeconds())\n+                  .setNanos(timestamp.getNanoseconds())\n+                  .build())\n+          .build());\n+    } else if (o instanceof GeoPoint) {\n+      GeoPoint geoPoint = (GeoPoint) o;\n+      return (Value.newBuilder()\n+          .setGeoPointValue(\n+              LatLng.newBuilder()\n+                  .setLatitude(geoPoint.getLatitude())\n+                  .setLongitude(geoPoint.getLongitude())\n+                  .build())\n+          .build());\n+    } else if (o instanceof Blob) {\n+      return (Value.newBuilder().setBytesValue(((Blob) o).toByteString()).build());\n+    } else if (o instanceof DocumentReference) {\n+      return (Value.newBuilder()\n+          .setReferenceValue(\n+              \"projects/projectId/databases/(default)/documents/\"\n+                  + ((DocumentReference) o).getPath())\n+          .build());\n+    } else if (o instanceof List) {\n+      ArrayValue.Builder list = ArrayValue.newBuilder();\n+      for (Object element : (List) o) {\n+        list.addValues(valueOf(element));\n+      }\n+      return (Value.newBuilder().setArrayValue(list).build());\n+    } else if (o == null) {\n+      return (Value.newBuilder().setNullValue(NullValue.NULL_VALUE).build());\n+    }\n+\n+    throw new UnsupportedOperationException();\n+  }\n+\n+  public static Value map(Object... entries) {\n+    com.google.firestore.v1.MapValue.Builder builder =\n+        com.google.firestore.v1.MapValue.newBuilder();\n+    for (int i = 0; i < entries.length; i += 2) {\n+      builder.putFields((String) entries[i], valueOf(entries[i + 1]));\n+    }\n+    return Value.newBuilder().setMapValue(builder).build();\n+  }\n+\n+  public static Value wrapRef(DatabaseId dbId, DocumentKey key) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4ODE0Mw==", "bodyText": "Extra parens, here and throughout.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370288143", "createdAt": "2020-01-23T18:39:18Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/ValueHelper.java", "diffHunk": "@@ -0,0 +1,98 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.firestore;\n+\n+import com.google.firebase.Timestamp;\n+import com.google.firebase.firestore.model.DatabaseId;\n+import com.google.firebase.firestore.model.DocumentKey;\n+import com.google.firestore.v1.ArrayValue;\n+import com.google.firestore.v1.Value;\n+import com.google.protobuf.NullValue;\n+import com.google.type.LatLng;\n+import java.util.List;\n+\n+/** Test helper to create Firestore Value protos from Java types. */\n+public class ValueHelper {\n+\n+  public static Value valueOf(Object o) {\n+    if (o instanceof Value) {\n+      return (Value) o;\n+    } else if (o instanceof String) {\n+      return (Value.newBuilder().setStringValue((String) o).build());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4ODYwMw==", "bodyText": "This inner build() is unnecessary. Proto setters take messages or builders and automatically call build() for you.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370288603", "createdAt": "2020-01-23T18:40:21Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/ValueHelper.java", "diffHunk": "@@ -0,0 +1,98 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.firestore;\n+\n+import com.google.firebase.Timestamp;\n+import com.google.firebase.firestore.model.DatabaseId;\n+import com.google.firebase.firestore.model.DocumentKey;\n+import com.google.firestore.v1.ArrayValue;\n+import com.google.firestore.v1.Value;\n+import com.google.protobuf.NullValue;\n+import com.google.type.LatLng;\n+import java.util.List;\n+\n+/** Test helper to create Firestore Value protos from Java types. */\n+public class ValueHelper {\n+\n+  public static Value valueOf(Object o) {\n+    if (o instanceof Value) {\n+      return (Value) o;\n+    } else if (o instanceof String) {\n+      return (Value.newBuilder().setStringValue((String) o).build());\n+    } else if (o instanceof Integer) {\n+      return (Value.newBuilder().setIntegerValue((long) (Integer) o).build());\n+    } else if (o instanceof Long) {\n+      return (Value.newBuilder().setIntegerValue((Long) o).build());\n+    } else if (o instanceof Double) {\n+      return (Value.newBuilder().setDoubleValue((Double) o).build());\n+    } else if (o instanceof Boolean) {\n+      return (Value.newBuilder().setBooleanValue((Boolean) o).build());\n+    } else if (o instanceof Timestamp) {\n+      Timestamp timestamp = (Timestamp) o;\n+      return (Value.newBuilder()\n+          .setTimestampValue(\n+              com.google.protobuf.Timestamp.newBuilder()\n+                  .setSeconds(timestamp.getSeconds())\n+                  .setNanos(timestamp.getNanoseconds())\n+                  .build())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4OTA5Mw==", "bodyText": "projectId isn't a valid project identifier. Elsewhere we've just used \"project\", FWIW.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370289093", "createdAt": "2020-01-23T18:41:23Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/ValueHelper.java", "diffHunk": "@@ -0,0 +1,98 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.firestore;\n+\n+import com.google.firebase.Timestamp;\n+import com.google.firebase.firestore.model.DatabaseId;\n+import com.google.firebase.firestore.model.DocumentKey;\n+import com.google.firestore.v1.ArrayValue;\n+import com.google.firestore.v1.Value;\n+import com.google.protobuf.NullValue;\n+import com.google.type.LatLng;\n+import java.util.List;\n+\n+/** Test helper to create Firestore Value protos from Java types. */\n+public class ValueHelper {\n+\n+  public static Value valueOf(Object o) {\n+    if (o instanceof Value) {\n+      return (Value) o;\n+    } else if (o instanceof String) {\n+      return (Value.newBuilder().setStringValue((String) o).build());\n+    } else if (o instanceof Integer) {\n+      return (Value.newBuilder().setIntegerValue((long) (Integer) o).build());\n+    } else if (o instanceof Long) {\n+      return (Value.newBuilder().setIntegerValue((Long) o).build());\n+    } else if (o instanceof Double) {\n+      return (Value.newBuilder().setDoubleValue((Double) o).build());\n+    } else if (o instanceof Boolean) {\n+      return (Value.newBuilder().setBooleanValue((Boolean) o).build());\n+    } else if (o instanceof Timestamp) {\n+      Timestamp timestamp = (Timestamp) o;\n+      return (Value.newBuilder()\n+          .setTimestampValue(\n+              com.google.protobuf.Timestamp.newBuilder()\n+                  .setSeconds(timestamp.getSeconds())\n+                  .setNanos(timestamp.getNanoseconds())\n+                  .build())\n+          .build());\n+    } else if (o instanceof GeoPoint) {\n+      GeoPoint geoPoint = (GeoPoint) o;\n+      return (Value.newBuilder()\n+          .setGeoPointValue(\n+              LatLng.newBuilder()\n+                  .setLatitude(geoPoint.getLatitude())\n+                  .setLongitude(geoPoint.getLongitude())\n+                  .build())\n+          .build());\n+    } else if (o instanceof Blob) {\n+      return (Value.newBuilder().setBytesValue(((Blob) o).toByteString()).build());\n+    } else if (o instanceof DocumentReference) {\n+      return (Value.newBuilder()\n+          .setReferenceValue(\n+              \"projects/projectId/databases/(default)/documents/\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI5MDA1Mg==", "bodyText": "Note that you currently only need this for tests, but eventually, won't the UserDataConverter need this as well? Maybe put this in with regular sources?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370290052", "createdAt": "2020-01-23T18:43:23Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/ValueHelper.java", "diffHunk": "@@ -0,0 +1,98 @@\n+// Copyright 2020 Google LLC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c315cdceb0a40023ddfcd0d966171b06c42e888d", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/c315cdceb0a40023ddfcd0d966171b06c42e888d", "committedDate": "2020-01-23T19:14:44Z", "message": "Address feeback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6f880ae8b4e4b11b91dfaeaec5b1ae86e40f12c", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/a6f880ae8b4e4b11b91dfaeaec5b1ae86e40f12c", "committedDate": "2020-01-23T19:40:29Z", "message": "Address feeback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "529881b881c7c9c40a6a01bb9151e298086074f4", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/529881b881c7c9c40a6a01bb9151e298086074f4", "committedDate": "2020-01-23T19:41:14Z", "message": "Merge branch 'mrschmidt/comparisons' into mrschmidt/testhelpers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8d1ce8f68fe2cca448d4965bf6ec5272b057c91", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/c8d1ce8f68fe2cca448d4965bf6ec5272b057c91", "committedDate": "2020-01-23T19:53:14Z", "message": "Review feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NzE1Mzk0", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#pullrequestreview-347715394", "createdAt": "2020-01-24T01:44:48Z", "commit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwMTo0NDo0OFrOFhSAXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwMTo1Mjo0MlrOFhSG-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQ0MjMzNA==", "bodyText": "FWIW, I think it's nice that this is a separate class that just has these static, simple functions. Moving it into the UserDataConverter would muddy that considerably. I was proposing just moving the class wholesale into the same package, or maybe even merging with/renaming ProtoValues and putting it in model.\nIn any case, no action required for this PR for sure.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370442334", "createdAt": "2020-01-24T01:44:48Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/ValueHelper.java", "diffHunk": "@@ -0,0 +1,98 @@\n+// Copyright 2020 Google LLC", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI5MDA1Mg=="}, "originalCommit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQ0MzQ5Nw==", "bodyText": "Lists is a great example because it's a collection of Guava utilities about java.util.List. In other cases where the library has a class and static utilities for dealing with it, it makes sense that they'd colocate them. I don't think that invalidates the static utilities as plurals convention.\nSee go/java-practices/utility-classes.md.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370443497", "createdAt": "2020-01-24T01:50:09Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/ValueHelper.java", "diffHunk": "@@ -0,0 +1,98 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.firestore;\n+\n+import com.google.firebase.Timestamp;\n+import com.google.firebase.firestore.model.DatabaseId;\n+import com.google.firebase.firestore.model.DocumentKey;\n+import com.google.firestore.v1.ArrayValue;\n+import com.google.firestore.v1.Value;\n+import com.google.protobuf.NullValue;\n+import com.google.type.LatLng;\n+import java.util.List;\n+\n+/** Test helper to create Firestore Value protos from Java types. */\n+public class ValueHelper {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4NDMyMA=="}, "originalCommit": {"oid": "8440ced4f5f4e42b0269ad464e5362ffc8fbafd1"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQ0Mzg3MQ==", "bodyText": "nit: excess newline.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370443871", "createdAt": "2020-01-24T01:51:58Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/Values.java", "diffHunk": "@@ -22,62 +22,71 @@\n import com.google.protobuf.NullValue;\n import com.google.type.LatLng;\n import java.util.List;\n+import java.util.Map;\n \n /** Test helper to create Firestore Value protos from Java types. */\n-public class ValueHelper {\n+public class Values {\n \n+  // TODO(mrschmidt): Move into UserDataConverter\n   public static Value valueOf(Object o) {\n     if (o instanceof Value) {\n       return (Value) o;\n-    } else if (o instanceof String) {\n-      return (Value.newBuilder().setStringValue((String) o).build());\n+    } else if (o == null) {\n+      return Value.newBuilder().setNullValue(NullValue.NULL_VALUE).build();\n+    } else if (o instanceof Boolean) {\n+      return Value.newBuilder().setBooleanValue((Boolean) o).build();\n     } else if (o instanceof Integer) {\n-      return (Value.newBuilder().setIntegerValue((long) (Integer) o).build());\n+      return Value.newBuilder().setIntegerValue((Integer) o).build();\n     } else if (o instanceof Long) {\n-      return (Value.newBuilder().setIntegerValue((Long) o).build());\n+      return Value.newBuilder().setIntegerValue((Long) o).build();\n     } else if (o instanceof Double) {\n-      return (Value.newBuilder().setDoubleValue((Double) o).build());\n-    } else if (o instanceof Boolean) {\n-      return (Value.newBuilder().setBooleanValue((Boolean) o).build());\n+      return Value.newBuilder().setDoubleValue((Double) o).build();\n     } else if (o instanceof Timestamp) {\n       Timestamp timestamp = (Timestamp) o;\n-      return (Value.newBuilder()\n+      return Value.newBuilder()\n           .setTimestampValue(\n               com.google.protobuf.Timestamp.newBuilder()\n                   .setSeconds(timestamp.getSeconds())\n-                  .setNanos(timestamp.getNanoseconds())\n-                  .build())\n-          .build());\n+                  .setNanos(timestamp.getNanoseconds()))\n+          .build();\n+    } else if (o instanceof String) {\n+      return Value.newBuilder().setStringValue((String) o).build();\n+    } else if (o instanceof Blob) {\n+      return Value.newBuilder().setBytesValue(((Blob) o).toByteString()).build();\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8d1ce8f68fe2cca448d4965bf6ec5272b057c91"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQ0NDAyNg==", "bodyText": "nit: import MapValue?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1158#discussion_r370444026", "createdAt": "2020-01-24T01:52:42Z", "author": {"login": "wilhuff"}, "path": "firebase-firestore/src/roboUtil/java/com/google/firebase/firestore/Values.java", "diffHunk": "@@ -22,62 +22,71 @@\n import com.google.protobuf.NullValue;\n import com.google.type.LatLng;\n import java.util.List;\n+import java.util.Map;\n \n /** Test helper to create Firestore Value protos from Java types. */\n-public class ValueHelper {\n+public class Values {\n \n+  // TODO(mrschmidt): Move into UserDataConverter\n   public static Value valueOf(Object o) {\n     if (o instanceof Value) {\n       return (Value) o;\n-    } else if (o instanceof String) {\n-      return (Value.newBuilder().setStringValue((String) o).build());\n+    } else if (o == null) {\n+      return Value.newBuilder().setNullValue(NullValue.NULL_VALUE).build();\n+    } else if (o instanceof Boolean) {\n+      return Value.newBuilder().setBooleanValue((Boolean) o).build();\n     } else if (o instanceof Integer) {\n-      return (Value.newBuilder().setIntegerValue((long) (Integer) o).build());\n+      return Value.newBuilder().setIntegerValue((Integer) o).build();\n     } else if (o instanceof Long) {\n-      return (Value.newBuilder().setIntegerValue((Long) o).build());\n+      return Value.newBuilder().setIntegerValue((Long) o).build();\n     } else if (o instanceof Double) {\n-      return (Value.newBuilder().setDoubleValue((Double) o).build());\n-    } else if (o instanceof Boolean) {\n-      return (Value.newBuilder().setBooleanValue((Boolean) o).build());\n+      return Value.newBuilder().setDoubleValue((Double) o).build();\n     } else if (o instanceof Timestamp) {\n       Timestamp timestamp = (Timestamp) o;\n-      return (Value.newBuilder()\n+      return Value.newBuilder()\n           .setTimestampValue(\n               com.google.protobuf.Timestamp.newBuilder()\n                   .setSeconds(timestamp.getSeconds())\n-                  .setNanos(timestamp.getNanoseconds())\n-                  .build())\n-          .build());\n+                  .setNanos(timestamp.getNanoseconds()))\n+          .build();\n+    } else if (o instanceof String) {\n+      return Value.newBuilder().setStringValue((String) o).build();\n+    } else if (o instanceof Blob) {\n+      return Value.newBuilder().setBytesValue(((Blob) o).toByteString()).build();\n+\n+    } else if (o instanceof DocumentReference) {\n+      return Value.newBuilder()\n+          .setReferenceValue(\n+              \"projects/project/databases/(default)/documents/\" + ((DocumentReference) o).getPath())\n+          .build();\n     } else if (o instanceof GeoPoint) {\n       GeoPoint geoPoint = (GeoPoint) o;\n-      return (Value.newBuilder()\n+      return Value.newBuilder()\n           .setGeoPointValue(\n               LatLng.newBuilder()\n                   .setLatitude(geoPoint.getLatitude())\n-                  .setLongitude(geoPoint.getLongitude())\n-                  .build())\n-          .build());\n-    } else if (o instanceof Blob) {\n-      return (Value.newBuilder().setBytesValue(((Blob) o).toByteString()).build());\n-    } else if (o instanceof DocumentReference) {\n-      return (Value.newBuilder()\n-          .setReferenceValue(\n-              \"projects/projectId/databases/(default)/documents/\"\n-                  + ((DocumentReference) o).getPath())\n-          .build());\n+                  .setLongitude(geoPoint.getLongitude()))\n+          .build();\n+\n     } else if (o instanceof List) {\n       ArrayValue.Builder list = ArrayValue.newBuilder();\n       for (Object element : (List) o) {\n         list.addValues(valueOf(element));\n       }\n-      return (Value.newBuilder().setArrayValue(list).build());\n-    } else if (o == null) {\n-      return (Value.newBuilder().setNullValue(NullValue.NULL_VALUE).build());\n+      return Value.newBuilder().setArrayValue(list).build();\n+    } else if (o instanceof Map) {\n+      com.google.firestore.v1.MapValue.Builder builder =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8d1ce8f68fe2cca448d4965bf6ec5272b057c91"}, "originalPosition": 84}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02c0e78fc28843d95ce7f74dd5d8f111129af1b7", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/02c0e78fc28843d95ce7f74dd5d8f111129af1b7", "committedDate": "2020-01-24T05:31:33Z", "message": "Merge branch 'mrschmidt/rewritefieldvalue' into mrschmidt/testhelpers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8c299ac9d17aa06c9ed088b0f6cb9b7fbafd6c0", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/e8c299ac9d17aa06c9ed088b0f6cb9b7fbafd6c0", "committedDate": "2020-01-24T05:33:22Z", "message": "Fix merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "063a2566e4a9dbf22ed39e10db0dff6aa18d27e5", "author": {"user": {"login": "schmidt-sebastian", "name": "Sebastian Schmidt"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/063a2566e4a9dbf22ed39e10db0dff6aa18d27e5", "committedDate": "2020-01-24T05:34:31Z", "message": "feedback"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2271, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}