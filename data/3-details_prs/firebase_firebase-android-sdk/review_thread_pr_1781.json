{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxNDk4MDM3", "number": 1781, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1NzowNVrOEQT4RA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxODoyNjo0MFrOEQUgfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTM4MzcyOnYy", "diffSide": "RIGHT", "path": "firebase-inappmessaging-display/src/main/java/com/google/firebase/inappmessaging/display/FirebaseInAppMessagingDisplay.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1NzowNVrOG0ZKXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1NzowNVrOG0ZKXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU5MTM4OQ==", "bodyText": "Can we add some documentation for our future selves about why we need to check for custom tabs?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1781#discussion_r457591389", "createdAt": "2020-07-20T17:57:05Z", "author": {"login": "prakhar1989"}, "path": "firebase-inappmessaging-display/src/main/java/com/google/firebase/inappmessaging/display/FirebaseInAppMessagingDisplay.java", "diffHunk": "@@ -535,4 +547,32 @@ private void notifyFiamDismiss() {\n       fiamListener.onFiamDismiss();\n     }\n   }\n+\n+  private void launchUriIntent(Activity activity, Uri uri) {\n+    if (supportsCustomTabs(activity)) {\n+      CustomTabsIntent customTabsIntent = new CustomTabsIntent.Builder().build();\n+      Intent intent = customTabsIntent.intent;\n+      intent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);\n+      intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n+      customTabsIntent.launchUrl(activity, uri);\n+    } else {\n+      Intent browserIntent = new Intent(Intent.ACTION_VIEW, uri);\n+      ResolveInfo info = activity.getPackageManager().resolveActivity(browserIntent, 0);\n+      browserIntent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);\n+      browserIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n+      if (info != null) {\n+        activity.startActivity(browserIntent);\n+      } else {\n+        Logging.loge(\"Device cannot resolve intent for: \" + Intent.ACTION_VIEW);\n+      }\n+    }\n+  }\n+\n+  private boolean supportsCustomTabs(Activity activity) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6be6b1cbfbb6e372bf96b228222557f9fdf64bc0"}, "originalPosition": 87}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTM4OTQyOnYy", "diffSide": "RIGHT", "path": "firebase-inappmessaging-display/src/main/java/com/google/firebase/inappmessaging/display/FirebaseInAppMessagingDisplay.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1ODozNVrOG0ZNwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1ODozNVrOG0ZNwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU5MjI1OA==", "bodyText": "Some documentation for the if/else branches", "url": "https://github.com/firebase/firebase-android-sdk/pull/1781#discussion_r457592258", "createdAt": "2020-07-20T17:58:35Z", "author": {"login": "prakhar1989"}, "path": "firebase-inappmessaging-display/src/main/java/com/google/firebase/inappmessaging/display/FirebaseInAppMessagingDisplay.java", "diffHunk": "@@ -535,4 +547,32 @@ private void notifyFiamDismiss() {\n       fiamListener.onFiamDismiss();\n     }\n   }\n+\n+  private void launchUriIntent(Activity activity, Uri uri) {\n+    if (supportsCustomTabs(activity)) {\n+      CustomTabsIntent customTabsIntent = new CustomTabsIntent.Builder().build();\n+      Intent intent = customTabsIntent.intent;\n+      intent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);\n+      intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n+      customTabsIntent.launchUrl(activity, uri);\n+    } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6be6b1cbfbb6e372bf96b228222557f9fdf64bc0"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTM5MzQzOnYy", "diffSide": "RIGHT", "path": "firebase-inappmessaging-display/src/main/java/com/google/firebase/inappmessaging/display/FirebaseInAppMessagingDisplay.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1OTo0NlrOG0ZQcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1OTo0NlrOG0ZQcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU5Mjk0Ng==", "bodyText": "Worth adding a log here: \"Calling callback for action\"?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1781#discussion_r457592946", "createdAt": "2020-07-20T17:59:46Z", "author": {"login": "prakhar1989"}, "path": "firebase-inappmessaging-display/src/main/java/com/google/firebase/inappmessaging/display/FirebaseInAppMessagingDisplay.java", "diffHunk": "@@ -332,8 +328,24 @@ public void onClick(View v) {\n                 callbacks = null;\n               }\n             };\n+      } else if (action != null && TextUtils.isEmpty(action.getActionUrl())) {\n+        // If the message has an action but no action url, attempt to call developer callback\n+        Logging.logi(\"No action url found for action. Callback will be called if present\");\n+        actionListener =\n+            new View.OnClickListener() {\n+              @Override\n+              public void onClick(View v) {\n+                if (callbacks != null) {\n+                  callbacks.messageClicked(action);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6be6b1cbfbb6e372bf96b228222557f9fdf64bc0"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTQ4NjcwOnYy", "diffSide": "RIGHT", "path": "firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessagingDismissListener.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxODoyNjo0MFrOG0aJ-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxODoyNjo0MFrOG0aJ-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYwNzY3NQ==", "bodyText": "replace i.e with e.g since there are other ways to dismiss as well? (eg. hitting the back button)?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1781#discussion_r457607675", "createdAt": "2020-07-20T18:26:40Z", "author": {"login": "prakhar1989"}, "path": "firebase-inappmessaging/src/main/java/com/google/firebase/inappmessaging/FirebaseInAppMessagingDismissListener.java", "diffHunk": "@@ -0,0 +1,24 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.inappmessaging;\n+\n+import androidx.annotation.NonNull;\n+import com.google.firebase.inappmessaging.model.InAppMessage;\n+\n+public interface FirebaseInAppMessagingDismissListener {\n+\n+  // Triggered when a message is dismissed (ie: \"x\" button, in the modal view)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6be6b1cbfbb6e372bf96b228222557f9fdf64bc0"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1272, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}