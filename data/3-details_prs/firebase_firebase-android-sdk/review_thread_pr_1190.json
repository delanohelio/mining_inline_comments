{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNTYxMjk3", "number": 1190, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzoxMzoyMFrODczvHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzoxNTozOVrODczxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTM0MzY0OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzoxMzoyMFrOFlDQOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzozNTo1M1rOFlDtSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5NDkzOA==", "bodyText": "shouldn't this be a separate PR?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#discussion_r374394938", "createdAt": "2020-02-03T23:13:20Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -363,13 +364,14 @@ private PersistedInstallationEntry getPrefsWithGeneratedIdMultiProcessSafe() {\n   }\n \n   private String readExistingIidOrCreateFid(PersistedInstallationEntry prefs) {\n-    // Check if this firebase app is the default (first initialized) instance\n-    if (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration()) {\n+    // Check if this firebase app is the default (first initialized) instance or is a chime app\n+    if (!firebaseApp.getName().equals(CHIME_FIREBASE_APP_NAME)\n+        && (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration())) {\n       return fidGenerator.createRandomFid();\n     }\n-    // For a default firebase installation, read the existing iid from shared prefs\n+    // For a default/chime firebase installation, read the existing iid from shared prefs\n     String fid = iidStore.readIid();\n-    if (fid == null) {\n+    if (TextUtils.isEmpty(fid)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQwMjM3Ng==", "bodyText": "Small change and seemed relevant as the change the same method. Will do it next time.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#discussion_r374402376", "createdAt": "2020-02-03T23:35:53Z", "author": {"login": "ankitaj224"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -363,13 +364,14 @@ private PersistedInstallationEntry getPrefsWithGeneratedIdMultiProcessSafe() {\n   }\n \n   private String readExistingIidOrCreateFid(PersistedInstallationEntry prefs) {\n-    // Check if this firebase app is the default (first initialized) instance\n-    if (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration()) {\n+    // Check if this firebase app is the default (first initialized) instance or is a chime app\n+    if (!firebaseApp.getName().equals(CHIME_FIREBASE_APP_NAME)\n+        && (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration())) {\n       return fidGenerator.createRandomFid();\n     }\n-    // For a default firebase installation, read the existing iid from shared prefs\n+    // For a default/chime firebase installation, read the existing iid from shared prefs\n     String fid = iidStore.readIid();\n-    if (fid == null) {\n+    if (TextUtils.isEmpty(fid)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5NDkzOA=="}, "originalCommit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTM0ODk2OnYy", "diffSide": "RIGHT", "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzoxNTozOVrOFlDTRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMzozNDowNVrOFlDrCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5NTcxNw==", "bodyText": "Not sure if the bracketing is right here...\nI don't know what #shouldAttemptMigration does (so I might be wrong here)...\nBut it seems, that this should be changed to:\nif ((!firebaseApp.getName().equals(CHIME_FIREBASE_APP_NAME) && !firebaseApp.isDefaultApp())\n   || !prefs.shouldAttemptMigration()) {", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#discussion_r374395717", "createdAt": "2020-02-03T23:15:39Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -363,13 +364,14 @@ private PersistedInstallationEntry getPrefsWithGeneratedIdMultiProcessSafe() {\n   }\n \n   private String readExistingIidOrCreateFid(PersistedInstallationEntry prefs) {\n-    // Check if this firebase app is the default (first initialized) instance\n-    if (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration()) {\n+    // Check if this firebase app is the default (first initialized) instance or is a chime app\n+    if (!firebaseApp.getName().equals(CHIME_FIREBASE_APP_NAME)\n+        && (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQwMTgwMA==", "bodyText": "Done.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1190#discussion_r374401800", "createdAt": "2020-02-03T23:34:05Z", "author": {"login": "ankitaj224"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -363,13 +364,14 @@ private PersistedInstallationEntry getPrefsWithGeneratedIdMultiProcessSafe() {\n   }\n \n   private String readExistingIidOrCreateFid(PersistedInstallationEntry prefs) {\n-    // Check if this firebase app is the default (first initialized) instance\n-    if (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration()) {\n+    // Check if this firebase app is the default (first initialized) instance or is a chime app\n+    if (!firebaseApp.getName().equals(CHIME_FIREBASE_APP_NAME)\n+        && (!firebaseApp.isDefaultApp() || !prefs.shouldAttemptMigration())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDM5NTcxNw=="}, "originalCommit": {"oid": "6c5d4b53ea22de876e5aa42ec7843be2c5b0017b"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 977, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}