{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5MTg4ODgw", "number": 1833, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMzo1NDo1NFrOETsIZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNDozMzoxMFrOEUFHWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MDgxNDQ3OnYy", "diffSide": "RIGHT", "path": "encoders/firebase-decoders-json/src/json/java/com/google/firebase/decoders/json/JsonDataDecoderBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMzo1NDo1NFrOG5kGmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMzo1NDo1NFrOG5kGmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzAxMzUzMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  @NonNull Class<U> clazz, @NonNull AnnotatedFieldHandler<? extends U> objectDecoder) {\n          \n          \n            \n                  @NonNull Class<U> clazz, @NonNull AnnotatedFieldHandler<U> handler) {\n          \n      \n    \n    \n  \n\nIt's not possible to extend/subclass annotations in Java, so consider dropping ? extends", "url": "https://github.com/firebase/firebase-android-sdk/pull/1833#discussion_r463013531", "createdAt": "2020-07-30T13:54:54Z", "author": {"login": "vkryachko"}, "path": "encoders/firebase-decoders-json/src/json/java/com/google/firebase/decoders/json/JsonDataDecoderBuilder.java", "diffHunk": "@@ -33,8 +38,16 @@ public JsonDataDecoderBuilder() {}\n     return this;\n   }\n \n+  @NonNull\n+  @Override\n+  public <U extends Annotation> JsonDataDecoderBuilder register(\n+      @NonNull Class<U> clazz, @NonNull AnnotatedFieldHandler<? extends U> objectDecoder) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5dbd3feb5068cd35e4a0417ede9d0b16dbb1b81f"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MDgyNjcwOnYy", "diffSide": "RIGHT", "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMzo1NzoyOVrOG5kOQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxMzo1Nzo0NVrOG5kPHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzAxNTQ5MQ==", "bodyText": "by convention static fields use UPPER_SNAKE_CASE, please change here and throughout.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1833#discussion_r463015491", "createdAt": "2020-07-30T13:57:29Z", "author": {"login": "vkryachko"}, "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "diffHunk": "@@ -83,6 +84,19 @@ public int hashCode() {\n     }\n   }\n \n+  private static AnnotatedFieldHandler<Default> defaultHandler =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5dbd3feb5068cd35e4a0417ede9d0b16dbb1b81f"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzAxNTcxMQ==", "bodyText": "also make it final pls", "url": "https://github.com/firebase/firebase-android-sdk/pull/1833#discussion_r463015711", "createdAt": "2020-07-30T13:57:45Z", "author": {"login": "vkryachko"}, "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "diffHunk": "@@ -83,6 +84,19 @@ public int hashCode() {\n     }\n   }\n \n+  private static AnnotatedFieldHandler<Default> defaultHandler =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzAxNTQ5MQ=="}, "originalCommit": {"oid": "5dbd3feb5068cd35e4a0417ede9d0b16dbb1b81f"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MDk0MzY0OnYy", "diffSide": "RIGHT", "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNDoyMzoyMFrOG5lV2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNjoxMDoxNlrOG5p_EQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzAzMzgxNg==", "bodyText": "It does not look like having this method be generic adds much type safety for implementers of the interface, otoh it makes it impossible to write implementation as lambda expressions, should be drop the <T> generic argument from the signature?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1833#discussion_r463033816", "createdAt": "2020-07-30T14:23:20Z", "author": {"login": "vkryachko"}, "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "diffHunk": "@@ -83,6 +84,19 @@ public int hashCode() {\n     }\n   }\n \n+  private final static AnnotatedFieldHandler<Default> DEFAULT_HANDLER =\n+      new AnnotatedFieldHandler<Default>() {\n+        @Nullable\n+        @Override\n+        public <T> T apply(\n+            @NonNull Default annotation, @Nullable T fieldDecodedResult, @NonNull Class<T> type) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026f6b8117f322099740e5cb83fd20d55b977a40"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA1OTMwOQ==", "bodyText": "Just ran some experiments to remove T,\nchanges\n  <T> T apply(@NonNull U annotation, @Nullable T fieldDecodedResult, @NonNull Class<T> type);\n\nto\n  Object apply(@NonNull U annotation, @Nullable Object fieldDecodedResult, @NonNull Class<?> type);\n\nwhich allows us to write lambda like the following:\n  private final static AnnotatedFieldHandler<Default> DEFAULT_HANDLER =\n          (an, res, type) -> {\n    if (res == null) {\n      if (type.equals(String.class)) {\n        return an.value();\n      }\n    }\n    return res;\n  };\n\nBut, we still not be able to directly register AnnotatedFieldHandler as lambda, since It still needs the info about the type of the Annotation, in that case, it's the U in above apply method.\nany idea of fully supporting lambda?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1833#discussion_r463059309", "createdAt": "2020-07-30T14:57:32Z", "author": {"login": "James201311"}, "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "diffHunk": "@@ -83,6 +84,19 @@ public int hashCode() {\n     }\n   }\n \n+  private final static AnnotatedFieldHandler<Default> DEFAULT_HANDLER =\n+      new AnnotatedFieldHandler<Default>() {\n+        @Nullable\n+        @Override\n+        public <T> T apply(\n+            @NonNull Default annotation, @Nullable T fieldDecodedResult, @NonNull Class<T> type) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzAzMzgxNg=="}, "originalCommit": {"oid": "026f6b8117f322099740e5cb83fd20d55b977a40"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEwOTkwNQ==", "bodyText": "it should be possible to use the lambda in the register() method as it has the annotation type as first argument, but not possible to do it in the case of Map<? extends Annotation, Handler<?>> - which is fine as it is an internal implementation detail and should not be used directly anywhere", "url": "https://github.com/firebase/firebase-android-sdk/pull/1833#discussion_r463109905", "createdAt": "2020-07-30T16:10:16Z", "author": {"login": "vkryachko"}, "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "diffHunk": "@@ -83,6 +84,19 @@ public int hashCode() {\n     }\n   }\n \n+  private final static AnnotatedFieldHandler<Default> DEFAULT_HANDLER =\n+      new AnnotatedFieldHandler<Default>() {\n+        @Nullable\n+        @Override\n+        public <T> T apply(\n+            @NonNull Default annotation, @Nullable T fieldDecodedResult, @NonNull Class<T> type) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzAzMzgxNg=="}, "originalCommit": {"oid": "026f6b8117f322099740e5cb83fd20d55b977a40"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5MTU3NzM5OnYy", "diffSide": "RIGHT", "path": "encoders/firebase-decoders-json/src/json/java/com/google/firebase/decoders/json/JsonDataDecoderBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNjo0OToxNlrOG5rd-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNjo0OToxNlrOG5rd-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEzNDIwMw==", "bodyText": "nit\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  @NonNull Class<U> clazz, @NonNull AnnotatedFieldHandler<U> objectDecoder) {\n          \n          \n            \n                  @NonNull Class<U> clazz, @NonNull AnnotatedFieldHandler<U> handler) {", "url": "https://github.com/firebase/firebase-android-sdk/pull/1833#discussion_r463134203", "createdAt": "2020-07-30T16:49:16Z", "author": {"login": "vkryachko"}, "path": "encoders/firebase-decoders-json/src/json/java/com/google/firebase/decoders/json/JsonDataDecoderBuilder.java", "diffHunk": "@@ -33,8 +38,16 @@ public JsonDataDecoderBuilder() {}\n     return this;\n   }\n \n+  @NonNull\n+  @Override\n+  public <U extends Annotation> JsonDataDecoderBuilder register(\n+      @NonNull Class<U> clazz, @NonNull AnnotatedFieldHandler<U> objectDecoder) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026f6b8117f322099740e5cb83fd20d55b977a40"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NDkwNzc2OnYy", "diffSide": "RIGHT", "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNDozMzoxMFrOG6Kw1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNDozMzoxMFrOG6Kw1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY0NjkzMg==", "bodyText": "I assume this was not intended?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1833#discussion_r463646932", "createdAt": "2020-07-31T14:33:10Z", "author": {"login": "vkryachko"}, "path": "encoders/firebase-decoders-json/src/test/java/com/google/firebase/decoders/json/JsonDataDecoderAnnotatedFieldHandlerTest.java", "diffHunk": "@@ -1,4 +1,4 @@\n-// Copyright 2020 Google LLC\n+package com.google.firebase.decoders.json; // Copyright 2020 Google LLC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d6d39b104d2f40596d2640f01d7fec8098c0b13"}, "originalPosition": 2}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1141, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}