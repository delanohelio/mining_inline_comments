{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NTQyMjg4", "number": 1355, "title": "Moving FIS network calls onto a separate executor", "bodyText": "#1339", "createdAt": "2020-03-16T23:23:43Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355", "merged": true, "mergeCommit": {"oid": "bbed2eb2e162d9dda3b876d07b33672f0cfa4c1c"}, "closed": true, "closedAt": "2020-03-17T17:27:20Z", "author": {"login": "ankitaj224"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBun1cgH2gAyMzg5NTQyMjg4OjQyODNhMmJiM2I0NDM0NTEwZTA2MWEwZDljNGIwODA1OTU2NThjMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOmIaOAFqTM3NjI1MDg5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4283a2bb3b4434510e061a0d9c4b080595658c2a", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/4283a2bb3b4434510e061a0d9c4b080595658c2a", "committedDate": "2020-02-06T17:59:09Z", "message": "Dropping guava and appcompat dependency from FIS SDK."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "984884cd6f9a90a8172d0957bd13e68e3f06db2f", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/984884cd6f9a90a8172d0957bd13e68e3f06db2f", "committedDate": "2020-02-06T18:16:08Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a82387701d2549bb5fc3b5dc2530a83ed0680d02", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/a82387701d2549bb5fc3b5dc2530a83ed0680d02", "committedDate": "2020-02-11T18:58:16Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afcb14c913c8dedd87faf6b71fdc7dd4384a6c39", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/afcb14c913c8dedd87faf6b71fdc7dd4384a6c39", "committedDate": "2020-02-13T23:37:48Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5574e30b8e3f6c9d09bfca149a6f7853c4141d25", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/5574e30b8e3f6c9d09bfca149a6f7853c4141d25", "committedDate": "2020-03-05T16:49:33Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5dd4dc54f2b7941ffe4b5cd76b6c8ab5764f7a1", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/a5dd4dc54f2b7941ffe4b5cd76b6c8ab5764f7a1", "committedDate": "2020-03-09T16:31:08Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45312e68fe8516dc4d48a2bfdb422f5023c1241b", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/45312e68fe8516dc4d48a2bfdb422f5023c1241b", "committedDate": "2020-03-10T18:13:59Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0be4fa07222c687044f66d8cb2859e156611896", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/f0be4fa07222c687044f66d8cb2859e156611896", "committedDate": "2020-03-10T21:55:48Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac0397ba816265b24da3eca4645761a37d4b46b6", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/ac0397ba816265b24da3eca4645761a37d4b46b6", "committedDate": "2020-03-11T18:14:18Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f6b46e3346cad5d3a4128ad1316e9e0831c0a2b", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/8f6b46e3346cad5d3a4128ad1316e9e0831c0a2b", "committedDate": "2020-03-12T19:40:52Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "686a998ab40a6c855d81b30f7686ef20aef1713c", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/686a998ab40a6c855d81b30f7686ef20aef1713c", "committedDate": "2020-03-16T17:31:01Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24d377c09a00a8a1071ee1ee23d917838e685513", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/24d377c09a00a8a1071ee1ee23d917838e685513", "committedDate": "2020-03-16T23:21:02Z", "message": "Moving FIS network calls onto a separate executor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78dc67ee0dd6411c6e127a08bafffcdda71943c3", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/78dc67ee0dd6411c6e127a08bafffcdda71943c3", "committedDate": "2020-03-16T23:27:11Z", "message": "Update firebase-installations version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/d264161c3e01d178549e29de6ac55d6363c4e5c9", "committedDate": "2020-03-16T23:29:19Z", "message": "Adding patch version"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NjQ5NDA1", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-375649405", "createdAt": "2020-03-16T23:32:00Z", "commit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzozMjowMFrOF3JPiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzozMjowMFrOF3JPiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2NzQzNQ==", "bodyText": "please give this a better name", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393367435", "createdAt": "2020-03-16T23:32:00Z", "author": {"login": "fredquintana"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -307,7 +310,11 @@ private final void doRegistrationInternal(boolean forceRefresh) {\n     }\n \n     triggerOnStateReached(prefs);\n+    networkExecutor.execute(() -> run(forceRefresh));\n+  }\n \n+  private void run(boolean forceRefresh) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NjUwNzk2", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-375650796", "createdAt": "2020-03-16T23:36:26Z", "commit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzozNjoyNlrOF3JUWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzozNjoyNlrOF3JUWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2ODY2NQ==", "bodyText": "just realized, we need to be a little careful, here.\nIf the subsequent call has a different value for \"forceRefresh\" then we need to be sure that it gets enqueued, otherwise the flag value can get lost.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393368665", "createdAt": "2020-03-16T23:36:26Z", "author": {"login": "fredquintana"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -307,7 +310,11 @@ private final void doRegistrationInternal(boolean forceRefresh) {\n     }\n \n     triggerOnStateReached(prefs);\n+    networkExecutor.execute(() -> run(forceRefresh));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NjUwNTY2", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-375650566", "createdAt": "2020-03-16T23:35:44Z", "commit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzozNTo0NFrOF3JTgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzozODowNVrOF3JWEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2ODQ1MQ==", "bodyText": "I am not about the meaning of these, but does this have to be v16.0.1?\nlatestReleasedVersion=16.0.1", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393368451", "createdAt": "2020-03-16T23:35:44Z", "author": {"login": "andirayo"}, "path": "firebase-installations/gradle.properties", "diffHunk": "@@ -1,2 +1,2 @@\n-version=16.0.1\n+version=16.0.2\n latestReleasedVersion=16.0.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2OTEwNw==", "bodyText": "+1\nHow about this:\n#sendRequestToFirebaseInstallationsServerApi\n#syncWithFirebaseInstallationsServerApi\n#updateLocalAuthToken", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393369107", "createdAt": "2020-03-16T23:38:05Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -307,7 +310,11 @@ private final void doRegistrationInternal(boolean forceRefresh) {\n     }\n \n     triggerOnStateReached(prefs);\n+    networkExecutor.execute(() -> run(forceRefresh));\n+  }\n \n+  private void run(boolean forceRefresh) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2NzQzNQ=="}, "originalCommit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d21adb4328f2c7d3e46d987bf6fd82e863d05e02", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/d21adb4328f2c7d3e46d987bf6fd82e863d05e02", "committedDate": "2020-03-16T23:40:02Z", "message": " Adding comments and renaming the method."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2dd4452af21e52d56715b0e09780f47250b3d99", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/a2dd4452af21e52d56715b0e09780f47250b3d99", "committedDate": "2020-03-16T23:42:36Z", "message": "Updating latestRealeasedVersion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NjUyMjc1", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-375652275", "createdAt": "2020-03-16T23:41:20Z", "commit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzo0MToyMFrOF3JZiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzo0MzoyNVrOF3JbpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2OTk5NQ==", "bodyText": "Please cluster both the ExecutorServices below each other.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393369995", "createdAt": "2020-03-16T23:41:20Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -66,6 +67,7 @@\n   private final IidStore iidStore;\n   private final RandomFidGenerator fidGenerator;\n   private final Object lock = new Object();\n+  private final ExecutorService networkExecutor;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3MDA0Mg==", "bodyText": "How about changing the name of the existing threadpool?\nprivate final ExecutorService backgroundExecutor;", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393370042", "createdAt": "2020-03-16T23:41:32Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -66,6 +67,7 @@\n   private final IidStore iidStore;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3MDUzMg==", "bodyText": "Q1: Why is this not injected like all the other variables and created by the other constructor method?\nQ2: Is there a reason that we have different ways how backgroundExecutor and networkExecutor are initialized?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393370532", "createdAt": "2020-03-16T23:43:25Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -124,6 +126,7 @@ public Thread newThread(Runnable r) {\n     this.utils = utils;\n     this.iidStore = iidStore;\n     this.fidGenerator = fidGenerator;\n+    this.networkExecutor = Executors.newSingleThreadExecutor();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d264161c3e01d178549e29de6ac55d6363c4e5c9"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90736ac91ea635d5c02f7acc77edcf0b963d0dd6", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/90736ac91ea635d5c02f7acc77edcf0b963d0dd6", "committedDate": "2020-03-16T23:58:14Z", "message": "Addressing rayo's comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NjY0NTk1", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-375664595", "createdAt": "2020-03-17T00:23:12Z", "commit": {"oid": "90736ac91ea635d5c02f7acc77edcf0b963d0dd6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1Njc4Mjgx", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-375678281", "createdAt": "2020-03-17T01:11:59Z", "commit": {"oid": "90736ac91ea635d5c02f7acc77edcf0b963d0dd6"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMToxMTo1OVrOF3KyOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMToxNToxM1rOF3K1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MjY5OA==", "bodyText": "Executors.newCachedThreadPool() would be good here.\nIf you choose to explicitly create it, please document the constants.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393392698", "createdAt": "2020-03-17T01:11:59Z", "author": {"login": "fredquintana"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -119,11 +120,14 @@ public Thread newThread(Runnable r) {\n       RandomFidGenerator fidGenerator) {\n     this.firebaseApp = firebaseApp;\n     this.serviceClient = serviceClient;\n-    this.executor = executor;\n     this.persistedInstallation = persistedInstallation;\n     this.utils = utils;\n     this.iidStore = iidStore;\n     this.fidGenerator = fidGenerator;\n+    this.backgroundExecutor = backgroundExecutor;\n+    this.networkExecutor =\n+        new ThreadPoolExecutor(\n+            1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue<>(), threadFactory);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90736ac91ea635d5c02f7acc77edcf0b963d0dd6"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzQ1Ng==", "bodyText": "I think fis is redundant here. How about \"doNetworkCall\".", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393393456", "createdAt": "2020-03-17T01:15:13Z", "author": {"login": "fredquintana"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -307,7 +311,13 @@ private final void doRegistrationInternal(boolean forceRefresh) {\n     }\n \n     triggerOnStateReached(prefs);\n+    // Execute network calls (CreateInstallations or GenerateAuthToken) to the FIS Servers on\n+    // a separate executor i.e networkExecutor\n+    networkExecutor.execute(() -> fisNetworkCall(forceRefresh));\n+  }\n \n+  private void fisNetworkCall(boolean forceRefresh) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90736ac91ea635d5c02f7acc77edcf0b963d0dd6"}, "originalPosition": 86}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1Njg2MjI1", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-375686225", "createdAt": "2020-03-17T01:41:28Z", "commit": {"oid": "90736ac91ea635d5c02f7acc77edcf0b963d0dd6"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMTo0MToyOFrOF3LNGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMTo0Mjo0MVrOF3LOYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5OTU3OQ==", "bodyText": "Do I read this correctly?\n0L Milliseconds is the timeout time?\nQuestions and Notes:\n\nCan we use the same numbers that we use for the backgroundExecutor?\nPlease create constants and use them for both executors\nWhy is the core pool size different to the other executor?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393399579", "createdAt": "2020-03-17T01:41:28Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -119,11 +120,14 @@ public Thread newThread(Runnable r) {\n       RandomFidGenerator fidGenerator) {\n     this.firebaseApp = firebaseApp;\n     this.serviceClient = serviceClient;\n-    this.executor = executor;\n     this.persistedInstallation = persistedInstallation;\n     this.utils = utils;\n     this.iidStore = iidStore;\n     this.fidGenerator = fidGenerator;\n+    this.backgroundExecutor = backgroundExecutor;\n+    this.networkExecutor =\n+        new ThreadPoolExecutor(\n+            1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue<>(), threadFactory);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90736ac91ea635d5c02f7acc77edcf0b963d0dd6"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5OTkwNg==", "bodyText": "+1.\nI already made suggestions in the other thread (see below).\nBut #doNetWorkCall sounds totally reasonable.\n#sendNetworkCall\n#makeNetworkCall\n#sendRequestToFirebaseInstallationsServerApi\n#syncWithFirebaseInstallationsServerApi\n#updateLocalAuthToken", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393399906", "createdAt": "2020-03-17T01:42:41Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -307,7 +311,13 @@ private final void doRegistrationInternal(boolean forceRefresh) {\n     }\n \n     triggerOnStateReached(prefs);\n+    // Execute network calls (CreateInstallations or GenerateAuthToken) to the FIS Servers on\n+    // a separate executor i.e networkExecutor\n+    networkExecutor.execute(() -> fisNetworkCall(forceRefresh));\n+  }\n \n+  private void fisNetworkCall(boolean forceRefresh) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzQ1Ng=="}, "originalCommit": {"oid": "90736ac91ea635d5c02f7acc77edcf0b963d0dd6"}, "originalPosition": 86}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b609d215139a07dd53ee00febb539dec9941367", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/9b609d215139a07dd53ee00febb539dec9941367", "committedDate": "2020-03-17T16:41:15Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into fisThreads"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc31cf7c03ea6a9fd69b6196ebc10adf9a248c9d", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/bc31cf7c03ea6a9fd69b6196ebc10adf9a248c9d", "committedDate": "2020-03-17T16:56:09Z", "message": "ddressing fred's comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2MjMyNTAw", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-376232500", "createdAt": "2020-03-17T17:04:09Z", "commit": {"oid": "bc31cf7c03ea6a9fd69b6196ebc10adf9a248c9d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNzowNDowOVrOF3lsGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNzowNDoyNFrOF3lsqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzgzMzQ5Nw==", "bodyText": "did you intend this to be KEEP_ALIVE_TIME_IN_SECONDS?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393833497", "createdAt": "2020-03-17T17:04:09Z", "author": {"login": "fredquintana"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -119,11 +122,19 @@ public Thread newThread(Runnable r) {\n       RandomFidGenerator fidGenerator) {\n     this.firebaseApp = firebaseApp;\n     this.serviceClient = serviceClient;\n-    this.executor = executor;\n     this.persistedInstallation = persistedInstallation;\n     this.utils = utils;\n     this.iidStore = iidStore;\n     this.fidGenerator = fidGenerator;\n+    this.backgroundExecutor = backgroundExecutor;\n+    this.networkExecutor =\n+        new ThreadPoolExecutor(\n+            /* corePoolSize= */ CORE_POOL_SIZE,\n+            /* maximumPoolSize= */ MAXIMUM_POOL_SIZE,\n+            /* keepAliveTime= */ 0L,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc31cf7c03ea6a9fd69b6196ebc10adf9a248c9d"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzgzMzY0MA==", "bodyText": "change to SECONDS", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393833640", "createdAt": "2020-03-17T17:04:24Z", "author": {"login": "fredquintana"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -119,11 +122,19 @@ public Thread newThread(Runnable r) {\n       RandomFidGenerator fidGenerator) {\n     this.firebaseApp = firebaseApp;\n     this.serviceClient = serviceClient;\n-    this.executor = executor;\n     this.persistedInstallation = persistedInstallation;\n     this.utils = utils;\n     this.iidStore = iidStore;\n     this.fidGenerator = fidGenerator;\n+    this.backgroundExecutor = backgroundExecutor;\n+    this.networkExecutor =\n+        new ThreadPoolExecutor(\n+            /* corePoolSize= */ CORE_POOL_SIZE,\n+            /* maximumPoolSize= */ MAXIMUM_POOL_SIZE,\n+            /* keepAliveTime= */ 0L,\n+            TimeUnit.MILLISECONDS,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc31cf7c03ea6a9fd69b6196ebc10adf9a248c9d"}, "originalPosition": 71}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2MjM0MTA1", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-376234105", "createdAt": "2020-03-17T17:06:08Z", "commit": {"oid": "bc31cf7c03ea6a9fd69b6196ebc10adf9a248c9d"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNzowNjowOFrOF3lxCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNzowNjozMFrOF3lx_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzgzNDc2Mg==", "bodyText": "No comments needed since you are using constants that explain the purpose of the parameters.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393834762", "createdAt": "2020-03-17T17:06:08Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -94,12 +97,12 @@ public Thread newThread(Runnable r) {\n       @Nullable HeartBeatInfo heartbeatInfo) {\n     this(\n         new ThreadPoolExecutor(\n-            /* corePoolSize= */ 0,\n-            /* maximumPoolSize= */ 1,\n-            /* keepAliveTime= */ 30L,\n+            /* corePoolSize= */ CORE_POOL_SIZE,\n+            /* maximumPoolSize= */ MAXIMUM_POOL_SIZE,\n+            /* keepAliveTime= */ KEEP_ALIVE_TIME_IN_SECONDS,\n             TimeUnit.SECONDS,\n             /* workQueue= */ new LinkedBlockingQueue<>(),\n-            /* threadFactory= */ threadFactory),\n+            /* threadFactory= */ THREAD_FACTORY),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc31cf7c03ea6a9fd69b6196ebc10adf9a248c9d"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzgzNTAwNg==", "bodyText": "No comments needed since you are using constants that explain the purpose of the parameters.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#discussion_r393835006", "createdAt": "2020-03-17T17:06:30Z", "author": {"login": "andirayo"}, "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -119,11 +122,19 @@ public Thread newThread(Runnable r) {\n       RandomFidGenerator fidGenerator) {\n     this.firebaseApp = firebaseApp;\n     this.serviceClient = serviceClient;\n-    this.executor = executor;\n     this.persistedInstallation = persistedInstallation;\n     this.utils = utils;\n     this.iidStore = iidStore;\n     this.fidGenerator = fidGenerator;\n+    this.backgroundExecutor = backgroundExecutor;\n+    this.networkExecutor =\n+        new ThreadPoolExecutor(\n+            /* corePoolSize= */ CORE_POOL_SIZE,\n+            /* maximumPoolSize= */ MAXIMUM_POOL_SIZE,\n+            /* keepAliveTime= */ 0L,\n+            TimeUnit.MILLISECONDS,\n+            /* workQueue= */ new LinkedBlockingQueue<>(),\n+            /* threadFactory= */ THREAD_FACTORY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc31cf7c03ea6a9fd69b6196ebc10adf9a248c9d"}, "originalPosition": 73}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58b5288022fed211444efa8c56fc0b2f02654e81", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/58b5288022fed211444efa8c56fc0b2f02654e81", "committedDate": "2020-03-17T17:12:44Z", "message": "Removing redudant comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5423e2a5049f9ff2b8d1d12ce782efa50004a6ad", "author": {"user": {"login": "ankitaj224", "name": "Ankita"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/5423e2a5049f9ff2b8d1d12ce782efa50004a6ad", "committedDate": "2020-03-17T17:17:11Z", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into fisThreads"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2MjUwODk5", "url": "https://github.com/firebase/firebase-android-sdk/pull/1355#pullrequestreview-376250899", "createdAt": "2020-03-17T17:26:36Z", "commit": {"oid": "5423e2a5049f9ff2b8d1d12ce782efa50004a6ad"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2183, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}