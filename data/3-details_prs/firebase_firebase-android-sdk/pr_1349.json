{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3ODExNjc5", "number": 1349, "title": "Nudge customers to update if on an old Firebase Analytics", "bodyText": "We can infer the customer is on an outdated version of FA\nif we cannot attach a listener with the \"clx\" origin. If\nthat is the case, use the old \"crash\" origin and write a\nlogcat warning with a nudge to upgrade.", "createdAt": "2020-03-13T14:38:15Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1349", "merged": true, "mergeCommit": {"oid": "84ab31615be8af1266a31041d9dadafdfcec4a2d"}, "closed": true, "closedAt": "2020-03-18T16:09:43Z", "author": {"login": "mrichards"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNRRDxgH2gAyMzg3ODExNjc5OjgzYThiYmNlY2M3YTIzMWMyN2ZhZDFkNzRiNzRmNTFjYjY5Nzg0YWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOORNAgFqTM3NTIxOTQ1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "83a8bbcecc7a231c27fad1d74b74f51cb69784af", "author": {"user": {"login": "mrichards", "name": "Marc Richards"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/83a8bbcecc7a231c27fad1d74b74f51cb69784af", "committedDate": "2020-03-13T14:34:07Z", "message": "Nudge customers to update if on an old Firebase Analytics\n\nWe can infer the customer is on an outdated version of FA\nif we cannot attach a listener with the \"clx\" origin. If\nthat is the case, use the old \"crash\" origin and write a\nlogcat warning with a nudge to upgrade."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MzUyNzcz", "url": "https://github.com/firebase/firebase-android-sdk/pull/1349#pullrequestreview-374352773", "createdAt": "2020-03-13T14:39:09Z", "commit": {"oid": "83a8bbcecc7a231c27fad1d74b74f51cb69784af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNDozOTowOVrOF2GKag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNDozOTowOVrOF2GKag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjI2ODM5NA==", "bodyText": "I'm going to coordinate with the Analytics team on the specific wording, which is likely to change. I created the PR to get feedback on the general approach; don't worry about the warning message just yet.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1349#discussion_r392268394", "createdAt": "2020-03-13T14:39:09Z", "author": {"login": "mrichards"}, "path": "firebase-crashlytics/src/main/java/com/google/firebase/crashlytics/internal/analytics/AnalyticsConnectorReceiver.java", "diffHunk": "@@ -66,6 +67,29 @@ public boolean register() {\n     analyticsConnectorHandle =\n         analyticsConnector.registerAnalyticsConnectorListener(CRASHLYTICS_ORIGIN, this);\n \n+    if (analyticsConnectorHandle == null) {\n+      Logger.getLogger()\n+          .d(\n+              \"Could not register AnalyticsConnectorListener with origin \"\n+                  + \"\\\"\"\n+                  + CRASHLYTICS_ORIGIN\n+                  + \"\\\"\");\n+      // Older versions of FA don't support CRASHLYTICS_ORIGIN. We can try using the old Firebase\n+      // Crash Reporting origin\n+      analyticsConnectorHandle =\n+          analyticsConnector.registerAnalyticsConnectorListener(LEGACY_CRASH_ORIGIN, this);\n+\n+      // If FA allows us to connect with the legacy origin, but not the new one, nudge customers\n+      // to update their FA version.\n+      if (analyticsConnectorHandle != null) {\n+        Logger.getLogger()\n+            .w(\n+                \"Outdated version of Firebase Analytics detected. For improved \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83a8bbcecc7a231c27fad1d74b74f51cb69784af"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NDAzOTk0", "url": "https://github.com/firebase/firebase-android-sdk/pull/1349#pullrequestreview-374403994", "createdAt": "2020-03-13T15:40:55Z", "commit": {"oid": "83a8bbcecc7a231c27fad1d74b74f51cb69784af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNTo0MDo1NVrOF2IgOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNTo0MDo1NVrOF2IgOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMwNjc0Nw==", "bodyText": "I don't think we want to expose this implementation detail to the user. Maybe something more generic like \"Could not register analytics connector with Crashlytics origin\"?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1349#discussion_r392306747", "createdAt": "2020-03-13T15:40:55Z", "author": {"login": "mrwillis21"}, "path": "firebase-crashlytics/src/main/java/com/google/firebase/crashlytics/internal/analytics/AnalyticsConnectorReceiver.java", "diffHunk": "@@ -66,6 +67,29 @@ public boolean register() {\n     analyticsConnectorHandle =\n         analyticsConnector.registerAnalyticsConnectorListener(CRASHLYTICS_ORIGIN, this);\n \n+    if (analyticsConnectorHandle == null) {\n+      Logger.getLogger()\n+          .d(\n+              \"Could not register AnalyticsConnectorListener with origin \"\n+                  + \"\\\"\"\n+                  + CRASHLYTICS_ORIGIN", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83a8bbcecc7a231c27fad1d74b74f51cb69784af"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NDA0NzY5", "url": "https://github.com/firebase/firebase-android-sdk/pull/1349#pullrequestreview-374404769", "createdAt": "2020-03-13T15:41:55Z", "commit": {"oid": "83a8bbcecc7a231c27fad1d74b74f51cb69784af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNTo0MTo1NVrOF2Iivw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNTo0MTo1NVrOF2Iivw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMwNzM5MQ==", "bodyText": "Would it be worth consolidating this with the return value below?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1349#discussion_r392307391", "createdAt": "2020-03-13T15:41:55Z", "author": {"login": "mrwillis21"}, "path": "firebase-crashlytics/src/main/java/com/google/firebase/crashlytics/internal/analytics/AnalyticsConnectorReceiver.java", "diffHunk": "@@ -66,6 +67,29 @@ public boolean register() {\n     analyticsConnectorHandle =\n         analyticsConnector.registerAnalyticsConnectorListener(CRASHLYTICS_ORIGIN, this);\n \n+    if (analyticsConnectorHandle == null) {\n+      Logger.getLogger()\n+          .d(\n+              \"Could not register AnalyticsConnectorListener with origin \"\n+                  + \"\\\"\"\n+                  + CRASHLYTICS_ORIGIN\n+                  + \"\\\"\");\n+      // Older versions of FA don't support CRASHLYTICS_ORIGIN. We can try using the old Firebase\n+      // Crash Reporting origin\n+      analyticsConnectorHandle =\n+          analyticsConnector.registerAnalyticsConnectorListener(LEGACY_CRASH_ORIGIN, this);\n+\n+      // If FA allows us to connect with the legacy origin, but not the new one, nudge customers\n+      // to update their FA version.\n+      if (analyticsConnectorHandle != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83a8bbcecc7a231c27fad1d74b74f51cb69784af"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "604916a8454d3a77d9f80e56a7341dc8ca2e7492", "author": {"user": {"login": "mrichards", "name": "Marc Richards"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/604916a8454d3a77d9f80e56a7341dc8ca2e7492", "committedDate": "2020-03-13T18:15:19Z", "message": "Minor logging output improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1MjE5NDU2", "url": "https://github.com/firebase/firebase-android-sdk/pull/1349#pullrequestreview-375219456", "createdAt": "2020-03-16T13:38:29Z", "commit": {"oid": "604916a8454d3a77d9f80e56a7341dc8ca2e7492"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2176, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}