{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMDg5Mzg0", "number": 1579, "title": "Migrate RC to depend directly on Installations SDK.", "bodyText": "", "createdAt": "2020-05-21T00:46:05Z", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579", "merged": true, "mergeCommit": {"oid": "d4776b30f543f27b1b506ab7038c1b7819d31745"}, "closed": true, "closedAt": "2020-06-17T23:07:09Z", "author": {"login": "danasilver"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABci9YebgH2gAyNDIxMDg5Mzg0Ojk1Y2I5YmRiNjc5Zjc5NjA2YWE5ODEzMmUzMWM0MmFiZTViMWVkZWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcr-QF5gH2gAyNDIxMDg5Mzg0OjVkY2YyOTQwOTQ2M2M4NzU2ZDlhMmRhMGEyOThkNDcxODcyZDRhNTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "95cb9bdb679f79606aa98132e31c42abe5b1edee", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/95cb9bdb679f79606aa98132e31c42abe5b1edee", "committedDate": "2020-05-19T23:50:27Z", "message": "Begin migrating to direct FIS dependency."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa509ae887d1917fc9476da8ec70cbdbd111a88e", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/fa509ae887d1917fc9476da8ec70cbdbd111a88e", "committedDate": "2020-05-20T01:56:31Z", "message": "Migrate RC to directly depend on Installations SDK."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a30b91988c2152cdb4f72fafa858bc5450600861", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/a30b91988c2152cdb4f72fafa858bc5450600861", "committedDate": "2020-05-21T00:45:01Z", "message": "Migrate RC tests and ktx to FIS dependency."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "847cbac4aadb2cc2b5559d452753433cfda7525b", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/847cbac4aadb2cc2b5559d452753433cfda7525b", "committedDate": "2020-05-21T00:45:24Z", "message": "Migrate RC Bandwagoner app to direct FIS dependency."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62fbcb3d6d19e5484c8ac47a8a508c1a7b3e7c98", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/62fbcb3d6d19e5484c8ac47a8a508c1a7b3e7c98", "committedDate": "2020-05-21T18:26:13Z", "message": "Remove google-services plugin from checked in bandwagoner app."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e0fb246217eb2bf7323fcca028cb7bf37546d0a", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/4e0fb246217eb2bf7323fcca028cb7bf37546d0a", "committedDate": "2020-05-21T21:51:11Z", "message": "Update IID -> FIS in integration test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "baadaa848412cd7bb3c963748d2f7279c6cfc411", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/baadaa848412cd7bb3c963748d2f7279c6cfc411", "committedDate": "2020-06-01T19:38:48Z", "message": "Update docs to reference Installations SDK."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/34e356d24970438c4c14ba1c3ea0fbab1ff877ee", "committedDate": "2020-06-01T19:50:57Z", "message": "Run formatter."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTEyODQ5", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#pullrequestreview-424912849", "createdAt": "2020-06-04T23:56:19Z", "commit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMzo1NjoxOVrOGfcIow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMzo1NjoxOVrOGfcIow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyMDAwMw==", "bodyText": "nit: Firebase Installation", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r435620003", "createdAt": "2020-06-04T23:56:19Z", "author": {"login": "ankitaj224"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -301,10 +303,10 @@ public boolean activateFetched() {\n    * FirebaseRemoteConfigSettings.Builder#setMinimumFetchIntervalInSeconds(long)}; the static\n    * default is 12 hours.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "originalPosition": 80}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTEyOTM4", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#pullrequestreview-424912938", "createdAt": "2020-06-04T23:56:37Z", "commit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMzo1NjozN1rOGfcI6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMzo1NjozN1rOGfcI6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyMDA3Mw==", "bodyText": "nit: Firebase Installation", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r435620073", "createdAt": "2020-06-04T23:56:37Z", "author": {"login": "ankitaj224"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -324,10 +326,10 @@ public boolean activateFetched() {\n    * <p>Depending on the time elapsed since the last fetch from the Firebase Remote Config backend,\n    * configs are either served from local storage, or fetched from the backend.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "originalPosition": 95}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTE0ODQz", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#pullrequestreview-424914843", "createdAt": "2020-06-05T00:02:30Z", "commit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDowMjozMFrOGfcO_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDowMjozMFrOGfcO_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyMTYzMA==", "bodyText": "instanceId.getToken is FCM token and FIS getToken is FIS Auth Token.\nThose are diff tokens. Just want to be sure this change is intended.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r435621630", "createdAt": "2020-06-05T00:02:30Z", "author": {"login": "ankitaj224"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigFetchHandler.java", "diffHunk": "@@ -286,16 +297,17 @@ private String createThrottledMessage(long throttledDurationInMillis) {\n    *     error connecting to the server.\n    */\n   @WorkerThread\n-  private FetchResponse fetchFromBackend(InstanceIdResult instanceId, Date currentTime)\n+  private FetchResponse fetchFromBackend(\n+      String installationId, String installationToken, Date currentTime)\n       throws FirebaseRemoteConfigException {\n     try {\n       HttpURLConnection urlConnection = frcBackendApiClient.createHttpURLConnection();\n \n       FetchResponse response =\n           frcBackendApiClient.fetch(\n               urlConnection,\n-              instanceId.getId(),\n-              instanceId.getToken(),\n+              installationId,\n+              installationToken,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "originalPosition": 114}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NTQ2MTg3", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#pullrequestreview-425546187", "createdAt": "2020-06-05T18:51:44Z", "commit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxODo1MTo0NFrOGf5xDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxODo1MjoyNVrOGf5yTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEwNTQ4NQ==", "bodyText": "Strictly speaking, we are trying to use lowercase \"Firebase installation ID.\"\nThis fights our tendency to productize every single thing from Notifications to Extensions, and it is singular, as a reference to this installation vs. the product offering overall.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r436105485", "createdAt": "2020-06-05T18:51:44Z", "author": {"login": "egilmorez"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -66,10 +66,10 @@\n    * <p>{@link FirebaseRemoteConfig} uses the default {@link FirebaseApp}, so if no {@link\n    * FirebaseApp} has been initialized yet, this method throws an {@link IllegalStateException}.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase Installations ID,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEwNTczOA==", "bodyText": "Or even singular lowercase \"Firebase installation\"", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r436105738", "createdAt": "2020-06-05T18:52:16Z", "author": {"login": "egilmorez"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -301,10 +303,10 @@ public boolean activateFetched() {\n    * FirebaseRemoteConfigSettings.Builder#setMinimumFetchIntervalInSeconds(long)}; the static\n    * default is 12 hours.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyMDAwMw=="}, "originalCommit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjEwNTgwNw==", "bodyText": "Or even singular lowercase \"Firebase installation\"", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r436105807", "createdAt": "2020-06-05T18:52:25Z", "author": {"login": "egilmorez"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -324,10 +326,10 @@ public boolean activateFetched() {\n    * <p>Depending on the time elapsed since the last fetch from the Firebase Remote Config backend,\n    * configs are either served from local storage, or fetched from the backend.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyMDA3Mw=="}, "originalCommit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "originalPosition": 95}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/512df9d2135fea8a580549dfc8aafbe004de5f09", "committedDate": "2020-06-05T22:12:39Z", "message": "Fix installation docs."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1Njc5MTE1", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#pullrequestreview-425679115", "createdAt": "2020-06-05T23:31:07Z", "commit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NzE0MDMw", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#pullrequestreview-426714030", "createdAt": "2020-06-09T00:42:37Z", "commit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "state": "APPROVED", "comments": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMDo0MjozOFrOGg09Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzoyMDozN1rOGg3bQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA3NTIwMw==", "bodyText": "How about LOGGING_TAG?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437075203", "createdAt": "2020-06-09T00:42:38Z", "author": {"login": "andirayo"}, "path": "firebase-config/bandwagoner/src/main/java/com/googletest/firebase/remoteconfig/bandwagoner/ApiFragment.java", "diffHunk": "@@ -46,20 +49,25 @@\n public class ApiFragment extends Fragment {\n \n   private FirebaseRemoteConfig frc;\n+  private FirebaseInstallationsApi firebaseInstallations;\n   private View rootView;\n   private EditText minimumFetchIntervalText;\n   private EditText parameterKeyText;\n   private TextView parameterValueText;\n   private TextView apiCallProgressText;\n   private TextView apiCallResultsText;\n \n+  private static final String TAG = \"Bandwagoner\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA3NTUyOA==", "bodyText": "How about fidTask or installationIdTask?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437075528", "createdAt": "2020-06-09T00:43:54Z", "author": {"login": "andirayo"}, "path": "firebase-config/bandwagoner/src/main/java/com/googletest/firebase/remoteconfig/bandwagoner/ApiFragment.java", "diffHunk": "@@ -87,9 +95,25 @@ public View onCreateView(\n     TextView sdkVersionText = rootView.findViewById(R.id.sdk_version_text);\n \n     TextView iidText = rootView.findViewById(R.id.iid_text);\n-    iidText.setText(\"IID: \" + FirebaseInstanceId.getInstance().getId());\n \n-    apiCallResultsText.setText(FirebaseInstanceId.getInstance().getToken());\n+    Task<String> idTask = firebaseInstallations.getId();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA3NTcwNw==", "bodyText": "How about installationAuthTokenTask?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437075707", "createdAt": "2020-06-09T00:44:36Z", "author": {"login": "andirayo"}, "path": "firebase-config/bandwagoner/src/main/java/com/googletest/firebase/remoteconfig/bandwagoner/ApiFragment.java", "diffHunk": "@@ -87,9 +95,25 @@ public View onCreateView(\n     TextView sdkVersionText = rootView.findViewById(R.id.sdk_version_text);\n \n     TextView iidText = rootView.findViewById(R.id.iid_text);\n-    iidText.setText(\"IID: \" + FirebaseInstanceId.getInstance().getId());\n \n-    apiCallResultsText.setText(FirebaseInstanceId.getInstance().getToken());\n+    Task<String> idTask = firebaseInstallations.getId();\n+    Task<InstallationTokenResult> tokenTask = firebaseInstallations.getToken(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA3NjcwMg==", "bodyText": "How about ignoredTasks?\nI am not sure what Android naming convention is here, but do you also use the underscore \"_\" prefix?\n_ignoredTasks", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437076702", "createdAt": "2020-06-09T00:48:13Z", "author": {"login": "andirayo"}, "path": "firebase-config/bandwagoner/src/main/java/com/googletest/firebase/remoteconfig/bandwagoner/ApiFragment.java", "diffHunk": "@@ -87,9 +95,25 @@ public View onCreateView(\n     TextView sdkVersionText = rootView.findViewById(R.id.sdk_version_text);\n \n     TextView iidText = rootView.findViewById(R.id.iid_text);\n-    iidText.setText(\"IID: \" + FirebaseInstanceId.getInstance().getId());\n \n-    apiCallResultsText.setText(FirebaseInstanceId.getInstance().getToken());\n+    Task<String> idTask = firebaseInstallations.getId();\n+    Task<InstallationTokenResult> tokenTask = firebaseInstallations.getToken(false);\n+\n+    Tasks.whenAllComplete(idTask, tokenTask)\n+        .addOnCompleteListener(\n+            unusedCompletedTasks -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA3Njk2OA==", "bodyText": "How about \"installation authentication token\"?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437076968", "createdAt": "2020-06-09T00:49:19Z", "author": {"login": "andirayo"}, "path": "firebase-config/bandwagoner/src/main/java/com/googletest/firebase/remoteconfig/bandwagoner/ApiFragment.java", "diffHunk": "@@ -87,9 +95,25 @@ public View onCreateView(\n     TextView sdkVersionText = rootView.findViewById(R.id.sdk_version_text);\n \n     TextView iidText = rootView.findViewById(R.id.iid_text);\n-    iidText.setText(\"IID: \" + FirebaseInstanceId.getInstance().getId());\n \n-    apiCallResultsText.setText(FirebaseInstanceId.getInstance().getToken());\n+    Task<String> idTask = firebaseInstallations.getId();\n+    Task<InstallationTokenResult> tokenTask = firebaseInstallations.getToken(false);\n+\n+    Tasks.whenAllComplete(idTask, tokenTask)\n+        .addOnCompleteListener(\n+            unusedCompletedTasks -> {\n+              if (idTask.isSuccessful()) {\n+                iidText.setText(String.format(\"Installation ID: %s\", idTask.getResult()));\n+              } else {\n+                Log.e(TAG, \"Error getting Installation ID\", idTask.getException());\n+              }\n+\n+              if (tokenTask.isSuccessful()) {\n+                apiCallResultsText.setText(tokenTask.getResult().getToken());\n+              } else {\n+                Log.e(TAG, \"Error getting Installation Token\", tokenTask.getException());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExMDI4NQ==", "bodyText": "How about this:\n\"Note: Also initializes the Firebase installations SDK that creates installation IDs to identify Firebase installations and periodically sends data to Firebase servers. Remote Config requires installation IDs for Fetch requests. To stop [...]\"", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437110285", "createdAt": "2020-06-09T02:58:18Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -66,10 +66,10 @@\n    * <p>{@link FirebaseRemoteConfig} uses the default {@link FirebaseApp}, so if no {@link\n    * FirebaseApp} has been initialized yet, this method throws an {@link IllegalStateException}.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase installation ID,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExMDkwNw==", "bodyText": "What means \"token\" in this context?\nIs this a (FIS) authentication token?\nIf yes, do developers need to know about this implementation detail.\nIf no, can you please specify what \"token\" is meant here?\nHow about this:\n\"Note: If you send another Fetch request after the deletion, Remote Config and Firebase installations will create a new installation ID for this Firebase installation and resume the periodic sync.\"", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437110907", "createdAt": "2020-06-09T03:00:46Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -66,10 +66,10 @@\n    * <p>{@link FirebaseRemoteConfig} uses the default {@link FirebaseApp}, so if no {@link\n    * FirebaseApp} has been initialized yet, this method throws an {@link IllegalStateException}.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase installation ID,\n+   * which periodically sends data to the Firebase backend. To stop the periodic sync, call {@link\n+   * com.google.firebase.installations.FirebaseInstallations#delete}. To create a new token and", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExMTAzMQ==", "bodyText": "Similar to above.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437111031", "createdAt": "2020-06-09T03:01:11Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -301,10 +303,10 @@ public boolean activateFetched() {\n    * FirebaseRemoteConfigSettings.Builder#setMinimumFetchIntervalInSeconds(long)}; the static\n    * default is 12 hours.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase installation ID,\n+   * which periodically sends data to the Firebase backend. To stop the periodic sync, call {@link\n+   * com.google.firebase.installations.FirebaseInstallations#delete}. To create a new token and\n+   * resume the periodic sync, call {@code fetch} again.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExMTQ4Mw==", "bodyText": "How about removing this duplicated Javadoc and instead refer to the other method, e.g. \"For documentation please refer to {@link fetch()}.\"", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437111483", "createdAt": "2020-06-09T03:02:47Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -324,10 +326,10 @@ public boolean activateFetched() {\n    * <p>Depending on the time elapsed since the last fetch from the Firebase Remote Config backend,\n    * configs are either served from local storage, or fetched from the backend.\n    *\n-   * <p>To identify the current app instance, the fetch request creates a Firebase Instance ID\n-   * token, which periodically sends data to the Firebase backend. To stop the periodic sync, call\n-   * {@link com.google.firebase.iid.FirebaseInstanceId#deleteInstanceId}. To create a new token and\n-   * resume the periodic sync, call {@code fetchConfig} again.\n+   * <p>To identify the current app instance, the fetch request creates a Firebase installation ID,\n+   * which periodically sends data to the Firebase backend. To stop the periodic sync, call {@link\n+   * com.google.firebase.installations.FirebaseInstallations#delete}. To create a new token and\n+   * resume the periodic sync, call {@code fetch} again.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExNDA1NQ==", "bodyText": "+1 for variable naming :)\nI would recommend to have it consistent with variables above to not confuse readers.\ninstallationTokenTask sounds good.\nI would preferinstallationAuthTokenTask to prevent possible(?) confusion with FCM tokens.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437114055", "createdAt": "2020-06-09T03:13:24Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigFetchHandler.java", "diffHunk": "@@ -189,21 +189,32 @@ public ConfigFetchHandler(\n                   createThrottledMessage(backoffEndTime.getTime() - currentTime.getTime()),\n                   backoffEndTime.getTime()));\n     } else {\n-      Task<InstanceIdResult> instanceIdTask = firebaseInstanceId.getInstanceId();\n+      Task<String> installationIdTask = firebaseInstallations.getId();\n+      Task<InstallationTokenResult> installationTokenTask = firebaseInstallations.getToken(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExNDI1NQ==", "bodyText": "How about mentioning \"Firebase Installations\" so that developers have all the info to potentially raise issues with Firebase?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437114255", "createdAt": "2020-06-09T03:14:20Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigFetchHandler.java", "diffHunk": "@@ -189,21 +189,32 @@ public ConfigFetchHandler(\n                   createThrottledMessage(backoffEndTime.getTime() - currentTime.getTime()),\n                   backoffEndTime.getTime()));\n     } else {\n-      Task<InstanceIdResult> instanceIdTask = firebaseInstanceId.getInstanceId();\n+      Task<String> installationIdTask = firebaseInstallations.getId();\n+      Task<InstallationTokenResult> installationTokenTask = firebaseInstallations.getToken(false);\n       fetchResponseTask =\n-          instanceIdTask.continueWithTask(\n-              executor,\n-              (completedIidTask) -> {\n-                if (!completedIidTask.isSuccessful()) {\n-                  return Tasks.forException(\n-                      new FirebaseRemoteConfigClientException(\n-                          \"Failed to get Firebase Instance ID token for fetch.\",\n-                          completedIidTask.getException()));\n-                }\n-\n-                InstanceIdResult instanceIdResult = completedIidTask.getResult();\n-                return fetchFromBackendAndCacheResponse(instanceIdResult, currentTime);\n-              });\n+          Tasks.whenAllComplete(installationIdTask, installationTokenTask)\n+              .continueWithTask(\n+                  executor,\n+                  (completedInstallationsTasks) -> {\n+                    if (!installationIdTask.isSuccessful()) {\n+                      return Tasks.forException(\n+                          new FirebaseRemoteConfigClientException(\n+                              \"Failed to get Firebase Installation ID for fetch.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExNDY4MQ==", "bodyText": "I know we already talked about this, but I strongly recommend to only upload the FIS auth token, because the auth token contains all the information needed on server side, particularly the FID.\nThus, uploading both values is redundancy and might lead to inconsistencies on server side.\nAs far as I understood our conversations, you are planning to get rid of uploading the FID in the future, but want to upload it for now to keep the current processes consistent.\nThat is absolutely fine. I just wanted to mention it again.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437114681", "createdAt": "2020-06-09T03:16:11Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigFetchHandler.java", "diffHunk": "@@ -189,21 +189,32 @@ public ConfigFetchHandler(\n                   createThrottledMessage(backoffEndTime.getTime() - currentTime.getTime()),\n                   backoffEndTime.getTime()));\n     } else {\n-      Task<InstanceIdResult> instanceIdTask = firebaseInstanceId.getInstanceId();\n+      Task<String> installationIdTask = firebaseInstallations.getId();\n+      Task<InstallationTokenResult> installationTokenTask = firebaseInstallations.getToken(false);\n       fetchResponseTask =\n-          instanceIdTask.continueWithTask(\n-              executor,\n-              (completedIidTask) -> {\n-                if (!completedIidTask.isSuccessful()) {\n-                  return Tasks.forException(\n-                      new FirebaseRemoteConfigClientException(\n-                          \"Failed to get Firebase Instance ID token for fetch.\",\n-                          completedIidTask.getException()));\n-                }\n-\n-                InstanceIdResult instanceIdResult = completedIidTask.getResult();\n-                return fetchFromBackendAndCacheResponse(instanceIdResult, currentTime);\n-              });\n+          Tasks.whenAllComplete(installationIdTask, installationTokenTask)\n+              .continueWithTask(\n+                  executor,\n+                  (completedInstallationsTasks) -> {\n+                    if (!installationIdTask.isSuccessful()) {\n+                      return Tasks.forException(\n+                          new FirebaseRemoteConfigClientException(\n+                              \"Failed to get Firebase Installation ID for fetch.\",\n+                              installationIdTask.getException()));\n+                    }\n+\n+                    if (!installationTokenTask.isSuccessful()) {\n+                      return Tasks.forException(\n+                          new FirebaseRemoteConfigClientException(\n+                              \"Failed to get Firebase Installation token for fetch.\",\n+                              installationTokenTask.getException()));\n+                    }\n+\n+                    String installationId = installationIdTask.getResult();\n+                    String installationToken = installationTokenTask.getResult().getToken();\n+                    return fetchFromBackendAndCacheResponse(\n+                        installationId, installationToken, currentTime);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExNTAyOA==", "bodyText": "Potentially add the term \"auth\" to the variable name?", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437115028", "createdAt": "2020-06-09T03:17:44Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigFetchHandler.java", "diffHunk": "@@ -286,16 +297,17 @@ private String createThrottledMessage(long throttledDurationInMillis) {\n    *     error connecting to the server.\n    */\n   @WorkerThread\n-  private FetchResponse fetchFromBackend(InstanceIdResult instanceId, Date currentTime)\n+  private FetchResponse fetchFromBackend(\n+      String installationId, String installationToken, Date currentTime)\n       throws FirebaseRemoteConfigException {\n     try {\n       HttpURLConnection urlConnection = frcBackendApiClient.createHttpURLConnection();\n \n       FetchResponse response =\n           frcBackendApiClient.fetch(\n               urlConnection,\n-              instanceId.getId(),\n-              instanceId.getToken(),\n+              installationId,\n+              installationToken,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYyMTYzMA=="}, "originalCommit": {"oid": "34e356d24970438c4c14ba1c3ea0fbab1ff877ee"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExNTYzOA==", "bodyText": "Please use values that have a roughly correct format in order to make it easier for readers to understand what data is used / required here.\nExamples:\nFID: \"'fL71_VyL3uo9jNMWu1L60S\"\nauth token: \"eyJhbGciOiJF.eyJmaWQiOiJmaXMt.AB2LPV8wRQIhAPs4NvEgA3uhubH\"", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437115638", "createdAt": "2020-06-09T03:20:14Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/test/java/com/google/firebase/remoteconfig/FirebaseRemoteConfigTest.java", "diffHunk": "@@ -96,10 +96,14 @@\n \n   private static final String ETAG = \"ETag\";\n \n-  private static final String INSTANCE_ID_STRING = \"fake instance id\";\n-  private static final String INSTANCE_ID_TOKEN_STRING = \"fake instance id token\";\n-  private static final InstanceIdResult INSTANCE_ID_RESULT =\n-      new FakeInstanceIdResult(INSTANCE_ID_STRING, INSTANCE_ID_TOKEN_STRING);\n+  private static final String INSTALLATION_ID = \"fake instance id\";\n+  private static final String INSTALLATION_TOKEN = \"fake instance id token\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzExNTcxMg==", "bodyText": "Same as above.", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#discussion_r437115712", "createdAt": "2020-06-09T03:20:37Z", "author": {"login": "andirayo"}, "path": "firebase-config/src/test/java/com/google/firebase/remoteconfig/internal/ConfigFetchHandlerTest.java", "diffHunk": "@@ -98,8 +98,14 @@\n @RunWith(RobolectricTestRunner.class)\n @Config(manifest = Config.NONE)\n public class ConfigFetchHandlerTest {\n-  private static final String INSTANCE_ID_STRING = \"fake instance id\";\n-  private static final String INSTANCE_ID_TOKEN_STRING = \"fake instance id token\";\n+  private static final String INSTALLATION_ID = \"fake installation id\";\n+  private static final String INSTALLATION_TOKEN = \"fake installation token\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NDEwMTg0", "url": "https://github.com/firebase/firebase-android-sdk/pull/1579#pullrequestreview-427410184", "createdAt": "2020-06-09T18:00:03Z", "commit": {"oid": "512df9d2135fea8a580549dfc8aafbe004de5f09"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01b4f739609749e34a26e3b97a0340cc86999f3e", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/01b4f739609749e34a26e3b97a0340cc86999f3e", "committedDate": "2020-06-10T00:44:14Z", "message": "Update some variables and comments for FIS."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0481a94fa50002471362ced9ea39ed4ff54f90a3", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/0481a94fa50002471362ced9ea39ed4ff54f90a3", "committedDate": "2020-06-12T01:04:39Z", "message": "Update error messages to directly mention Firebase Installations."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df620df3d28cf116f1cf5af36a8f393ab517f396", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/df620df3d28cf116f1cf5af36a8f393ab517f396", "committedDate": "2020-06-12T01:58:06Z", "message": "Update tests with installations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5dcf29409463c8756d9a2da0a298d471872d4a55", "author": {"user": {"login": "danasilver", "name": "Dana Silver"}}, "url": "https://github.com/firebase/firebase-android-sdk/commit/5dcf29409463c8756d9a2da0a298d471872d4a55", "committedDate": "2020-06-16T23:56:31Z", "message": "Update missing auth token test."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2679, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}