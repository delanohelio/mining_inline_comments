{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNjQyMDEw", "number": 1516, "title": "Studio encoding profile performance improved", "bodyText": "The studio-upload workflow uses an dynamic encoding profile for generating the delivery version of the videos. This profile is currently really slow. I've changed the x264 encoder preset from slower to faster. On the way the buffer size for each quality was fixed to hold 2 sec. of video.\nYour pull request should\u2026\n\n have a concise title\n close an accompanying issue if one exists\n be against the correct branch (features can only go into develop)\n include migration scripts and documentation, if appropriate\n pass automated testing\n have a clean commit history\n have proper commit messages (title and body) for all commits\n have appropriate tags applied", "createdAt": "2020-04-09T20:59:34Z", "url": "https://github.com/opencast/opencast/pull/1516", "merged": true, "mergeCommit": {"oid": "e3650bd2ab90c888b4441e593071741c1083775c"}, "closed": true, "closedAt": "2020-04-28T20:45:37Z", "author": {"login": "wsmirnow"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWC8JDgH2gAyNDAxNjQyMDEwOjJkNTRkMThmN2U0YTk5ZmY0ZGQ4OGQ3MGQ3ODM4NTlmZjdlN2ViNzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccGr0LgH2gAyNDAxNjQyMDEwOmEwODcxNmEwYjFlZDdkYTRhYjIyODBjOTc2NWJkZGNmOGFhOTBlZWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2d54d18f7e4a99ff4dd88d70d783859ff7e7eb76", "author": {"user": {"login": "wsmirnow", "name": "Waldemar Smirnow"}}, "url": "https://github.com/opencast/opencast/commit/2d54d18f7e4a99ff4dd88d70d783859ff7e7eb76", "committedDate": "2020-04-09T20:57:55Z", "message": "Speedup studio adaptive streaming optimized encoding profile\n\nThe studio-upload workflow uses an dynamic encoding profile for generating the delivery version of the videos. This profile is currently really slow. I've changed the x264 encoder preset from slower to faster. On the way the buffer size for each quality was fixed to hold 2 sec. of video."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMTY2Nzk0", "url": "https://github.com/opencast/opencast/pull/1516#pullrequestreview-391166794", "createdAt": "2020-04-09T22:13:28Z", "commit": {"oid": "2d54d18f7e4a99ff4dd88d70d783859ff7e7eb76"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQyMjoxMzoyOFrOGDrNSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQyMjoyNTozNVrOGDreUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUwNjgyNA==", "bodyText": "You accidentally deleted the -:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                -c:v libx264 preset faster -tune film -pix_fmt yuv420p \\\n          \n          \n            \n                -c:v libx264 -preset faster -tune film -pix_fmt yuv420p \\", "url": "https://github.com/opencast/opencast/pull/1516#discussion_r406506824", "createdAt": "2020-04-09T22:13:28Z", "author": {"login": "lkiesow"}, "path": "etc/encoding/adaptive-streaming-movies.properties", "diffHunk": "@@ -108,33 +108,33 @@ profile.studio.adaptive-parallel.http.suffix.360p-quality = -360p-quality.mp4\n profile.studio.adaptive-parallel.http.jobload = 4\n profile.studio.adaptive-parallel.http.ffmpeg.command.if-height-geq-1800 = \\\n   -filter:v scale=w=3840:h=trunc(3840/dar/2)*2,setsar=1,fps=25 \\\n-    -c:v libx264 -preset slower -tune film -pix_fmt yuv420p \\\n-    -x264opts keyint=25:min-keyint=25:no-scenecut -crf 20 -maxrate 14800k -bufsize 18000k \\\n-    -c:a aac -b:a 196k -ac 2 \\\n+    -c:v libx264 preset faster -tune film -pix_fmt yuv420p \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d54d18f7e4a99ff4dd88d70d783859ff7e7eb76"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxMDI4NQ==", "bodyText": "-crf 23 is the default value. We can just drop it.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                -x264opts keyint=25:min-keyint=25:no-scenecut -crf 23 -maxrate 14800k -bufsize 29600k \\\n          \n          \n            \n                -x264opts keyint=25:min-keyint=25:no-scenecut -maxrate 14800k -bufsize 29600k \\", "url": "https://github.com/opencast/opencast/pull/1516#discussion_r406510285", "createdAt": "2020-04-09T22:23:13Z", "author": {"login": "lkiesow"}, "path": "etc/encoding/adaptive-streaming-movies.properties", "diffHunk": "@@ -108,33 +108,33 @@ profile.studio.adaptive-parallel.http.suffix.360p-quality = -360p-quality.mp4\n profile.studio.adaptive-parallel.http.jobload = 4\n profile.studio.adaptive-parallel.http.ffmpeg.command.if-height-geq-1800 = \\\n   -filter:v scale=w=3840:h=trunc(3840/dar/2)*2,setsar=1,fps=25 \\\n-    -c:v libx264 -preset slower -tune film -pix_fmt yuv420p \\\n-    -x264opts keyint=25:min-keyint=25:no-scenecut -crf 20 -maxrate 14800k -bufsize 18000k \\\n-    -c:a aac -b:a 196k -ac 2 \\\n+    -c:v libx264 preset faster -tune film -pix_fmt yuv420p \\\n+    -x264opts keyint=25:min-keyint=25:no-scenecut -crf 23 -maxrate 14800k -bufsize 29600k \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d54d18f7e4a99ff4dd88d70d783859ff7e7eb76"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxMTE4Ng==", "bodyText": "\ud83d\udc4d  for 128k audio for speech. Since we are only recording a microphone which is unlikely to be a stereo signal, should we go for mono? And if we go for mono, should we go for 96k? So many questions :D", "url": "https://github.com/opencast/opencast/pull/1516#discussion_r406511186", "createdAt": "2020-04-09T22:25:35Z", "author": {"login": "lkiesow"}, "path": "etc/encoding/adaptive-streaming-movies.properties", "diffHunk": "@@ -108,33 +108,33 @@ profile.studio.adaptive-parallel.http.suffix.360p-quality = -360p-quality.mp4\n profile.studio.adaptive-parallel.http.jobload = 4\n profile.studio.adaptive-parallel.http.ffmpeg.command.if-height-geq-1800 = \\\n   -filter:v scale=w=3840:h=trunc(3840/dar/2)*2,setsar=1,fps=25 \\\n-    -c:v libx264 -preset slower -tune film -pix_fmt yuv420p \\\n-    -x264opts keyint=25:min-keyint=25:no-scenecut -crf 20 -maxrate 14800k -bufsize 18000k \\\n-    -c:a aac -b:a 196k -ac 2 \\\n+    -c:v libx264 preset faster -tune film -pix_fmt yuv420p \\\n+    -x264opts keyint=25:min-keyint=25:no-scenecut -crf 23 -maxrate 14800k -bufsize 29600k \\\n+    -c:a aac -b:a 128k -ac 2 \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d54d18f7e4a99ff4dd88d70d783859ff7e7eb76"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12b0ac0ceb18643d083e283cfbc64d8571b72810", "author": {"user": {"login": "wsmirnow", "name": "Waldemar Smirnow"}}, "url": "https://github.com/opencast/opencast/commit/12b0ac0ceb18643d083e283cfbc64d8571b72810", "committedDate": "2020-04-14T15:20:29Z", "message": "Update etc/encoding/adaptive-streaming-movies.properties\r\n\r\ntypo fixed\n\nCo-Authored-By: Lars Kiesow <lkiesow@uos.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "460a647dbe3783044adf36c6596b82134562be25", "author": {"user": {"login": "wsmirnow", "name": "Waldemar Smirnow"}}, "url": "https://github.com/opencast/opencast/commit/460a647dbe3783044adf36c6596b82134562be25", "committedDate": "2020-04-23T15:29:48Z", "message": "studio encoding profile updated\n\nremoved -crf 23 ffmpeg option as it is the default value"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5200a2e1abc6f9d367641dfe5f2d4dae737c754", "author": {"user": {"login": "wsmirnow", "name": "Waldemar Smirnow"}}, "url": "https://github.com/opencast/opencast/commit/f5200a2e1abc6f9d367641dfe5f2d4dae737c754", "committedDate": "2020-04-23T20:19:27Z", "message": "studio workflow updated\n\nThe x264 preset is now set to medium, which is the default preset. For this reason the preset option was removed from studio encoding profile."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a08716a0b1ed7da4ab2280c9765bddcf8aa90eeb", "author": {"user": {"login": "wsmirnow", "name": "Waldemar Smirnow"}}, "url": "https://github.com/opencast/opencast/commit/a08716a0b1ed7da4ab2280c9765bddcf8aa90eeb", "committedDate": "2020-04-28T16:43:15Z", "message": "studio encoding profile updated\n\nSet bufsize for each quality to maxrate value. For more information see the ffmpeg documentation at\nhttps://trac.ffmpeg.org/wiki/Limiting%20the%20output%20bitrate"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1873, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}