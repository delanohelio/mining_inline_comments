{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2NzAzMjc3", "number": 1414, "title": "Gracefully crash if there is no password stored", "bodyText": "This is a follow up of  #1399 where in the case that there are\nno password stored in the local database. Now will fail with bad\ncredentials error and not with a java crash page.\nYour pull request should\u2026\n\n have a concise title\n close an accompanying issue if one exists\n be against the correct branch (features can only go into develop)\n include migration scripts and documentation, if appropriate\n pass automated testing\n have a clean commit history\n have proper commit messages (title and body) for all commits\n have appropriate tags applied", "createdAt": "2020-02-18T16:07:12Z", "url": "https://github.com/opencast/opencast/pull/1414", "merged": true, "mergeCommit": {"oid": "4be82e039f390a47a5c9035b9cb94e127da466cd"}, "closed": true, "closedAt": "2020-03-02T19:08:56Z", "author": {"login": "mliradelc"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFkns3gFqTM2MDQ5MTM1NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJymlgAFqTM2NzQ1MjUyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNDkxMzU0", "url": "https://github.com/opencast/opencast/pull/1414#pullrequestreview-360491354", "createdAt": "2020-02-18T16:35:39Z", "commit": {"oid": "726c9830741c6a484ed87d247d32315d4129cc48"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjozNTozOVrOFrJpuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjozNTozOVrOFrJpuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc5MTIyNQ==", "bodyText": "I guess this is caused by .charAt(0)?\nIf yes, instead of catching the exception, my suggestion would be to use StringUtils#startsWith instead which will gracefully handle this in the first place and also handle null.", "url": "https://github.com/opencast/opencast/pull/1414#discussion_r380791225", "createdAt": "2020-02-18T16:35:39Z", "author": {"login": "lkiesow"}, "path": "modules/kernel/src/main/java/org/opencastproject/kernel/security/CustomPasswordEncoder.java", "diffHunk": "@@ -78,6 +78,8 @@ public boolean isPasswordValid(String encodedPassword, String rawPassword, Objec\n       return encodedPassword.charAt(0) == '$' && BCrypt.checkpw(rawPassword, encodedPassword);\n     } catch (IllegalArgumentException e) {\n       logger.debug(\"bcrypt hash verification failed\", e);\n+    } catch (StringIndexOutOfBoundsException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "726c9830741c6a484ed87d247d32315d4129cc48"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1cc8d0db0b6cdaf133c55fe1c78d9ddacced07ed", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/1cc8d0db0b6cdaf133c55fe1c78d9ddacced07ed", "committedDate": "2020-02-19T11:00:01Z", "message": "Modified with a \"StartsWith\" instead of an exception"}, "afterCommit": {"oid": "848b224f003fbe04555b957468583248fac2658e", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/848b224f003fbe04555b957468583248fac2658e", "committedDate": "2020-02-19T11:27:13Z", "message": "Modified with a \"StartsWith\" instead of an exception"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMDcxMTIz", "url": "https://github.com/opencast/opencast/pull/1414#pullrequestreview-361071123", "createdAt": "2020-02-19T12:29:52Z", "commit": {"oid": "1cc8d0db0b6cdaf133c55fe1c78d9ddacced07ed"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMjoyOTo1MlrOFrmSvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxMjoyOTo1MlrOFrmSvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTI2MDQ3Ng==", "bodyText": "This will indeed handle more cases but will still fail if encodedPassword is null. Can we switch to using StringUtils#startsWith? That will handle that as well.", "url": "https://github.com/opencast/opencast/pull/1414#discussion_r381260476", "createdAt": "2020-02-19T12:29:52Z", "author": {"login": "lkiesow"}, "path": "modules/kernel/src/main/java/org/opencastproject/kernel/security/CustomPasswordEncoder.java", "diffHunk": "@@ -75,13 +75,14 @@ public boolean isPasswordValid(String encodedPassword, String rawPassword, Objec\n     // Test BCrypt encoded hash\n     logger.debug(\"Verifying bcrypt hash {}\", encodedPassword);\n     try {\n-      return encodedPassword.charAt(0) == '$' && BCrypt.checkpw(rawPassword, encodedPassword);\n+      return encodedPassword.startsWith(\"$\") && BCrypt.checkpw(rawPassword, encodedPassword);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cc8d0db0b6cdaf133c55fe1c78d9ddacced07ed"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ceadc2b068b4350f4bf363565a645a809820e610", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/ceadc2b068b4350f4bf363565a645a809820e610", "committedDate": "2020-02-21T07:51:41Z", "message": "Deleted empty row"}, "afterCommit": {"oid": "72033d7d1d0dcbb922371107066ec667355a36c7", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/72033d7d1d0dcbb922371107066ec667355a36c7", "committedDate": "2020-02-21T07:54:52Z", "message": "Gracefully crash if there is no password stored\n\nThis is a follow up of  #1399 where in the case that there are\nno password stored in the local database. Now will fail with bad\ncredentials error and not with a java crash page."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "77c8e1d30fabb2de969e4bd0fbba98e3efc9f5b4", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/77c8e1d30fabb2de969e4bd0fbba98e3efc9f5b4", "committedDate": "2020-02-26T13:19:18Z", "message": "Add library to CustomPasswordEncoder"}, "afterCommit": {"oid": "3f57a5036df562ccd559da133ffda6a77bcac7fc", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/3f57a5036df562ccd559da133ffda6a77bcac7fc", "committedDate": "2020-02-27T08:29:32Z", "message": "Gracefully crash if there is no password stored\n\nThis is a follow up of  #1399 where in the case that there are\nno password stored in the local database. Now will fail with bad\ncredentials error and not with a java crash page."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4f70b9fd8e032d634773059469ca02e3830dd00", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/b4f70b9fd8e032d634773059469ca02e3830dd00", "committedDate": "2020-02-27T08:31:02Z", "message": "Gracefully crash if there is no password stored\n\nThis is a follow up of  #1399 where in the case that there are\nno password stored in the local database. Now will fail with bad\ncredentials error and not with a java crash page."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f57a5036df562ccd559da133ffda6a77bcac7fc", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/3f57a5036df562ccd559da133ffda6a77bcac7fc", "committedDate": "2020-02-27T08:29:32Z", "message": "Gracefully crash if there is no password stored\n\nThis is a follow up of  #1399 where in the case that there are\nno password stored in the local database. Now will fail with bad\ncredentials error and not with a java crash page."}, "afterCommit": {"oid": "b4f70b9fd8e032d634773059469ca02e3830dd00", "author": {"user": {"login": "mliradelc", "name": "Maximiliano Lira Del Canto"}}, "url": "https://github.com/opencast/opencast/commit/b4f70b9fd8e032d634773059469ca02e3830dd00", "committedDate": "2020-02-27T08:31:02Z", "message": "Gracefully crash if there is no password stored\n\nThis is a follow up of  #1399 where in the case that there are\nno password stored in the local database. Now will fail with bad\ncredentials error and not with a java crash page."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NDUyNTI0", "url": "https://github.com/opencast/opencast/pull/1414#pullrequestreview-367452524", "createdAt": "2020-03-02T19:08:48Z", "commit": {"oid": "b4f70b9fd8e032d634773059469ca02e3830dd00"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1904, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}