{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwNzk5NDIw", "number": 1791, "title": "Add with acl option to series api", "bodyText": "This adds the option withACL to api/series/ and api/series/{seriesid} so you can additionally receive the ACL(s) of the series from the external API index. This way an external application doesn't have to query the ACL of each series separately. This is very similar to the same option in the events API.\nAnd because this is an API change, it also introduces a new version of the API.", "createdAt": "2020-08-20T09:56:25Z", "url": "https://github.com/opencast/opencast/pull/1791", "merged": true, "mergeCommit": {"oid": "c3ce5d55c59037ca7f794a0d75a61fb1cf8cc99f"}, "closed": true, "closedAt": "2020-10-05T20:14:33Z", "author": {"login": "KatrinIhler"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNSGaogFqTQ5NzQxNjYzMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPlJ_dAFqTUwMjE0OTkxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NDE2NjMx", "url": "https://github.com/opencast/opencast/pull/1791#pullrequestreview-497416631", "createdAt": "2020-09-28T11:21:32Z", "commit": {"oid": "661fab6c39d8ab045ba1e59cce4363ae4164be8a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxMToyMTozMlrOHY5SYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxMTozNDozMVrOHY5q5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg2NjQ2NQ==", "bodyText": "I remember a mailing list discussion about brace style and I think the vast majority of responses were in favor of Greg's proposal to make braces mandatory.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  if (series.getAccessPolicy() != null)\n          \n          \n            \n                    activeAcl = AccessControlParser.parseAcl(series.getAccessPolicy());\n          \n          \n            \n                  if (series.getAccessPolicy() != null) {\n          \n          \n            \n                    activeAcl = AccessControlParser.parseAcl(series.getAccessPolicy());\n          \n          \n            \n                  }", "url": "https://github.com/opencast/opencast/pull/1791#discussion_r495866465", "createdAt": "2020-09-28T11:21:32Z", "author": {"login": "LukasKalbertodt"}, "path": "modules/external-api/src/main/java/org/opencastproject/external/endpoint/SeriesEndpoint.java", "diffHunk": "@@ -344,15 +359,45 @@ public JValue apply(SearchResultItem<Series> a) {\n     }\n   }\n \n+  /**\n+   * Get an {@link AccessControlList} from a {@link Series}.\n+   *\n+   * @param series\n+   *          The {@link Series} to get the ACL from.\n+   * @return The {@link AccessControlList} stored in the {@link Series}\n+   */\n+  private static AccessControlList getAclFromSeries(Series series) {\n+    AccessControlList activeAcl = new AccessControlList();\n+    try {\n+      if (series.getAccessPolicy() != null)\n+        activeAcl = AccessControlParser.parseAcl(series.getAccessPolicy());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "661fab6c39d8ab045ba1e59cce4363ae4164be8a"}, "originalPosition": 116}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg2NzI0Ng==", "bodyText": "Is \"log error and continue with dummy value\" a valid error handling style in Opencast? I would assume the API should respond with 5xx if parsing the ACL fails. But I am not sure, as I have no experience on how the API code usually handles these things.", "url": "https://github.com/opencast/opencast/pull/1791#discussion_r495867246", "createdAt": "2020-09-28T11:23:12Z", "author": {"login": "LukasKalbertodt"}, "path": "modules/external-api/src/main/java/org/opencastproject/external/endpoint/SeriesEndpoint.java", "diffHunk": "@@ -344,15 +359,45 @@ public JValue apply(SearchResultItem<Series> a) {\n     }\n   }\n \n+  /**\n+   * Get an {@link AccessControlList} from a {@link Series}.\n+   *\n+   * @param series\n+   *          The {@link Series} to get the ACL from.\n+   * @return The {@link AccessControlList} stored in the {@link Series}\n+   */\n+  private static AccessControlList getAclFromSeries(Series series) {\n+    AccessControlList activeAcl = new AccessControlList();\n+    try {\n+      if (series.getAccessPolicy() != null)\n+        activeAcl = AccessControlParser.parseAcl(series.getAccessPolicy());\n+    } catch (Exception e) {\n+      logger.error(\"Unable to parse access policy\", e);\n+    }\n+    return activeAcl;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "661fab6c39d8ab045ba1e59cce4363ae4164be8a"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg3Mjc0MQ==", "bodyText": "Opencast doesn't have to be any enforced line length limit, but maybe it's time to break this line? This also applies to other places in this PR.", "url": "https://github.com/opencast/opencast/pull/1791#discussion_r495872741", "createdAt": "2020-09-28T11:34:31Z", "author": {"login": "LukasKalbertodt"}, "path": "modules/external-api/src/main/java/org/opencastproject/external/endpoint/CaptureAgentsEndpoint.java", "diffHunk": "@@ -55,7 +55,7 @@\n import javax.ws.rs.core.Response;\n \n @Path(\"/\")\n-@Produces({ ApiMediaType.JSON, ApiMediaType.VERSION_1_1_0, ApiMediaType.VERSION_1_2_0, ApiMediaType.VERSION_1_3_0, ApiMediaType.VERSION_1_4_0 })\n+@Produces({ ApiMediaType.JSON, ApiMediaType.VERSION_1_1_0, ApiMediaType.VERSION_1_2_0, ApiMediaType.VERSION_1_3_0, ApiMediaType.VERSION_1_4_0, ApiMediaType.VERSION_1_5_0 })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "661fab6c39d8ab045ba1e59cce4363ae4164be8a"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "661fab6c39d8ab045ba1e59cce4363ae4164be8a", "author": {"user": {"login": "KatrinIhler", "name": "Katrin Ihler"}}, "url": "https://github.com/opencast/opencast/commit/661fab6c39d8ab045ba1e59cce4363ae4164be8a", "committedDate": "2020-08-20T09:42:36Z", "message": "Add withAcl option to API for series\n\nAdd withACL option to api/series/ and api/series/{seriesid} to\nadditionally receive the acl(s) of the series from the external API\nindex."}, "afterCommit": {"oid": "26fe93d5b93c28fb1e49095738edca57e3e72307", "author": {"user": {"login": "KatrinIhler", "name": "Katrin Ihler"}}, "url": "https://github.com/opencast/opencast/commit/26fe93d5b93c28fb1e49095738edca57e3e72307", "committedDate": "2020-10-02T08:00:05Z", "message": "Review fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3491bdbf344b36e09ea2818f69028b05557a763", "author": {"user": {"login": "KatrinIhler", "name": "Katrin Ihler"}}, "url": "https://github.com/opencast/opencast/commit/f3491bdbf344b36e09ea2818f69028b05557a763", "committedDate": "2020-10-05T12:13:38Z", "message": "Increase External API Version to 1.5.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cd45962eb5976be6d4696a4186cf9efb9454e17", "author": {"user": {"login": "KatrinIhler", "name": "Katrin Ihler"}}, "url": "https://github.com/opencast/opencast/commit/4cd45962eb5976be6d4696a4186cf9efb9454e17", "committedDate": "2020-10-05T12:13:38Z", "message": "Add withacl option to API for series\n\nAdd withacl option to api/series/ and api/series/{seriesid} to\nadditionally receive the acl(s) of the series from the external API\nindex."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09b606010405bfc4fa74e860fb501a070b161893", "author": {"user": {"login": "KatrinIhler", "name": "Katrin Ihler"}}, "url": "https://github.com/opencast/opencast/commit/09b606010405bfc4fa74e860fb501a070b161893", "committedDate": "2020-10-05T12:13:38Z", "message": "Review fixes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "26fe93d5b93c28fb1e49095738edca57e3e72307", "author": {"user": {"login": "KatrinIhler", "name": "Katrin Ihler"}}, "url": "https://github.com/opencast/opencast/commit/26fe93d5b93c28fb1e49095738edca57e3e72307", "committedDate": "2020-10-02T08:00:05Z", "message": "Review fixes"}, "afterCommit": {"oid": "09b606010405bfc4fa74e860fb501a070b161893", "author": {"user": {"login": "KatrinIhler", "name": "Katrin Ihler"}}, "url": "https://github.com/opencast/opencast/commit/09b606010405bfc4fa74e860fb501a070b161893", "committedDate": "2020-10-05T12:13:38Z", "message": "Review fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMTQ5OTE0", "url": "https://github.com/opencast/opencast/pull/1791#pullrequestreview-502149914", "createdAt": "2020-10-05T15:03:30Z", "commit": {"oid": "09b606010405bfc4fa74e860fb501a070b161893"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1819, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}