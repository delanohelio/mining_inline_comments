{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MDIwNzUz", "number": 1719, "reviewThreads": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDozNDoyMVrOESVKpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzozNzozN1rOEWN97w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjU2NjE1OnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/main/java/org/opencast/engage/theodul/plugin/tab/downloads/App.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDozNDoyMVrOG3c8Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDozNDoyMVrOG3c8Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc5OTAyNw==", "bodyText": "This shouldn't be in here", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460799027", "createdAt": "2020-07-27T10:34:21Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/java/org/opencast/engage/theodul/plugin/tab/downloads/App.java", "diffHunk": "@@ -0,0 +1,13 @@\n+package org.opencast.engage.theodul.plugin.tab.downloads;\n+\n+/**\n+ * Hello world!\n+ *\n+ */\n+public class App \n+{\n+    public static void main( String[] args )\n+    {\n+        System.out.println( \"Hello World!\" );\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjU3MDc1OnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/OSGI-INF/engage-plugin.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDozNTo1MlrOG3c_EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDozNTo1MlrOG3c_EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc5OTc2MA==", "bodyText": "Can we use OSGi annotations instead of specifying this in XML?", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460799760", "createdAt": "2020-07-27T10:35:52Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/OSGI-INF/engage-plugin.xml", "diffHunk": "@@ -0,0 +1,21 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<scr:component xmlns:scr=\"http://www.osgi.org/xmlns/scr/v1.1.0\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjU4MDgwOnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/styles/desktop.css", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDozOTozMFrOG3dFPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDozOTozMFrOG3dFPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgwMTM0Mw==", "bodyText": "This can probably go", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460801343", "createdAt": "2020-07-27T10:39:30Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/styles/desktop.css", "diffHunk": "@@ -0,0 +1,37 @@\n+#engage_description_tab_content {\n+    width: 100%;\n+    padding-top: 15px;\n+    padding-right: 20px;\n+}\n+\n+.description-item {\n+    border-radius: 4px;\n+    padding: 5px;\n+/*\n+  color: #000000;\n+  background-color: #F1F1F1;\n+  border-color: #969696;\n+  */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjU4NDc4OnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/test/java/org/opencast/engage/theodul/plugin/tab/downloads/AppTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0MDo1MVrOG3dHow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0MDo1MVrOG3dHow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgwMTk1NQ==", "bodyText": "This test does not make any sense, does it?\nDrop it.", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460801955", "createdAt": "2020-07-27T10:40:51Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/test/java/org/opencast/engage/theodul/plugin/tab/downloads/AppTest.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package org.opencast.engage.theodul.plugin.tab.downloads;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+import org.junit.Test;\n+\n+/**\n+ * Unit test for simple App.\n+ */\n+public class AppTest \n+{\n+    /**\n+     * Rigorous Test :-)\n+     */\n+    @Test\n+    public void shouldAnswerWithTrue()\n+    {\n+        assertTrue( true );\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjU4OTIxOnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/test/resources/js/engage/core.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0MjoyNlrOG3dKaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0MjoyNlrOG3dKaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgwMjY2Nw==", "bodyText": "Are these tests intended to be used?", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460802667", "createdAt": "2020-07-27T10:42:26Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/test/resources/js/engage/core.js", "diffHunk": "@@ -0,0 +1,66 @@\n+/**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjYwOTUyOnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-core/src/main/resources/ui/js/engage/core.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0ODozM1rOG3dWFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0ODozM1rOG3dWFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgwNTY1NA==", "bodyText": "Instead of checking this here, could we check it in modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js and have the plugin potentially do nothing instead? That way, we have no plug-in specific code in here.", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460805654", "createdAt": "2020-07-27T10:48:33Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-core/src/main/resources/ui/js/engage/core.js", "diffHunk": "@@ -459,6 +459,23 @@ define(['require', 'jquery', 'underscore', 'backbone', 'mousetrap', 'bowser', 'b\n   }\n \n   function loadTemplate(plugin, plugin_name, plugin_path) {\n+\n+    // The following code block contains the logic for the download tab in the theodul player.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjYxMTA2OnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0OTowNlrOG3dW-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo0OTowNlrOG3dW-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgwNTg4MA==", "bodyText": "Why embed these files if they are empty anyway?", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460805880", "createdAt": "2020-07-27T10:49:06Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js", "diffHunk": "@@ -0,0 +1,241 @@\n+/**\n+ * Copyright 2009-2011 The Regents of the University of California Licensed\n+ * under the Educational Community License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.osedu.org/licenses/ECL-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+/*jslint browser: true, nomen: true*/\n+/*global define*/\n+define([\"jquery\", \"underscore\", \"backbone\", \"engage/core\"], function($, _, Backbone, Engage) {\n+    \"use strict\";\n+\n+    var insertIntoDOM = true;\n+    var PLUGIN_NAME = \"Downloads\";\n+    var PLUGIN_TYPE = \"engage_tab\";\n+    var PLUGIN_VERSION = \"1.0\";\n+    var PLUGIN_TEMPLATE_DESKTOP = \"templates/desktop.html\";\n+    var PLUGIN_TEMPLATE_MOBILE = \"templates/mobile.html\";\n+    var PLUGIN_TEMPLATE_EMBED = \"templates/embed.html\";\n+    var PLUGIN_STYLES_DESKTOP = [\n+        \"styles/desktop.css\"\n+    ];\n+    var PLUGIN_STYLES_EMBED = [\n+        \"styles/embed.css\"\n+    ];\n+    var PLUGIN_STYLES_MOBILE = [\n+        \"styles/mobile.css\"\n+    ];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjYxNDQxOnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo1MDowNlrOG3dY7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo1MDowNlrOG3dY7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgwNjM4Mw==", "bodyText": "From what I can tell, these modes do the same thing: nothing.\nWhy handle them separately?", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460806383", "createdAt": "2020-07-27T10:50:06Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js", "diffHunk": "@@ -0,0 +1,241 @@\n+/**\n+ * Copyright 2009-2011 The Regents of the University of California Licensed\n+ * under the Educational Community License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.osedu.org/licenses/ECL-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+/*jslint browser: true, nomen: true*/\n+/*global define*/\n+define([\"jquery\", \"underscore\", \"backbone\", \"engage/core\"], function($, _, Backbone, Engage) {\n+    \"use strict\";\n+\n+    var insertIntoDOM = true;\n+    var PLUGIN_NAME = \"Downloads\";\n+    var PLUGIN_TYPE = \"engage_tab\";\n+    var PLUGIN_VERSION = \"1.0\";\n+    var PLUGIN_TEMPLATE_DESKTOP = \"templates/desktop.html\";\n+    var PLUGIN_TEMPLATE_MOBILE = \"templates/mobile.html\";\n+    var PLUGIN_TEMPLATE_EMBED = \"templates/embed.html\";\n+    var PLUGIN_STYLES_DESKTOP = [\n+        \"styles/desktop.css\"\n+    ];\n+    var PLUGIN_STYLES_EMBED = [\n+        \"styles/embed.css\"\n+    ];\n+    var PLUGIN_STYLES_MOBILE = [\n+        \"styles/mobile.css\"\n+    ];\n+\n+    var plugin;\n+    var events = {\n+        plugin_load_done: new Engage.Event(\"Core:plugin_load_done\", \"\", \"handler\"),\n+        mediaPackageModelError: new Engage.Event(\"MhConnection:mediaPackageModelError\", \"\", \"handler\")\n+    };\n+\n+    var isDesktopMode = false;\n+    var isEmbedMode = false;\n+    var isMobileMode = false;\n+\n+    // desktop, embed and mobile logic\n+    switch (Engage.model.get(\"mode\")) {\n+        case \"embed\":\n+            plugin = {\n+                insertIntoDOM: insertIntoDOM,\n+                name: PLUGIN_NAME,\n+                type: PLUGIN_TYPE,\n+                version: PLUGIN_VERSION,\n+                styles: PLUGIN_STYLES_EMBED,\n+                template: PLUGIN_TEMPLATE_EMBED,\n+                events: events\n+            };\n+            isEmbedMode = true;\n+            break;\n+        case \"mobile\":\n+            plugin = {\n+                insertIntoDOM: insertIntoDOM,\n+                name: PLUGIN_NAME,\n+                type: PLUGIN_TYPE,\n+                version: PLUGIN_VERSION,\n+                styles: PLUGIN_STYLES_MOBILE,\n+                template: PLUGIN_TEMPLATE_MOBILE,\n+                events: events\n+            };\n+            isMobileMode = true;\n+            break;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjYyNDQwOnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo1Mjo1OVrOG3demg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMDo1Mjo1OVrOG3demg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgwNzgzNA==", "bodyText": "The maven-dependency-plugin complains about several dependencies in here.\nYou are also not really using any Jasmine or JUnit tests, are you?", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r460807834", "createdAt": "2020-07-27T10:52:59Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/pom.xml", "diffHunk": "@@ -0,0 +1,136 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "50190ad3881a0193074c9425e8a939fe7e9391d2"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNzI3MDIzOnYy", "diffSide": "RIGHT", "path": "etc/ui-config/mh_default_org/theodul/config.yml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzoyMTo0N1rOG9Zn9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzoyMTo0N1rOG9Zn9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzAzNjE0OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # Default: false\n          \n          \n            \n            allow_video_download: false\n          \n          \n            \n            # Default: true\n          \n          \n            \n            allow_video_download: true", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r467036149", "createdAt": "2020-08-07T13:21:47Z", "author": {"login": "lkiesow"}, "path": "etc/ui-config/mh_default_org/theodul/config.yml", "diffHunk": "@@ -65,6 +65,18 @@ link_mediamodule: true\n # Default: false\n show_embed_links: true\n \n+# Shows/Hides the download tab under the theodul player.\n+# In order to show up, the user also needs a role that matches the\n+# regex in the following configuration 'allowed_roles_for_video_download'\n+# Allowed values: true, false\n+# Default: false\n+allow_video_download: false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8bd8ef60f17ff189485169f433a8e4ea6c364314"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNzI4MDQ5OnYy", "diffSide": "RIGHT", "path": "etc/ui-config/mh_default_org/theodul/config.yml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzoyNDozOVrOG9ZuKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzoyNDozOVrOG9ZuKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzAzNzczOA==", "bodyText": "Let's be a bit more open by default but let's also make sure people understand that this is no security option.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # Configures the roles that are allowed to see the download plugin\n          \n          \n            \n            # Allowed values: regular expressions (if any role of the user matches this regex, the download tab will be shown)\n          \n          \n            \n            # Default: ROLE_ADMIN\n          \n          \n            \n            allowed_roles_for_video_download: ROLE_ADMIN\n          \n          \n            \n            # Configures the roles that are allowed to see the download plugin.\n          \n          \n            \n            # Note that this does not restrict access to the media files itself.\n          \n          \n            \n            # Allowed values: regular expressions (if any role of the user matches this regex, the download tab will be shown)\n          \n          \n            \n            # Default: ROLE_USER\n          \n          \n            \n            allowed_roles_for_video_download: ROLE_USER", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r467037738", "createdAt": "2020-08-07T13:24:39Z", "author": {"login": "lkiesow"}, "path": "etc/ui-config/mh_default_org/theodul/config.yml", "diffHunk": "@@ -65,6 +65,18 @@ link_mediamodule: true\n # Default: false\n show_embed_links: true\n \n+# Shows/Hides the download tab under the theodul player.\n+# In order to show up, the user also needs a role that matches the\n+# regex in the following configuration 'allowed_roles_for_video_download'\n+# Allowed values: true, false\n+# Default: false\n+allow_video_download: false\n+\n+# Configures the roles that are allowed to see the download plugin\n+# Allowed values: regular expressions (if any role of the user matches this regex, the download tab will be shown)\n+# Default: ROLE_ADMIN\n+allowed_roles_for_video_download: ROLE_ADMIN", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8bd8ef60f17ff189485169f433a8e4ea6c364314"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNzI4OTE5OnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/package.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzoyNjo1NFrOG9ZzVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzoyNjo1NFrOG9ZzVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzAzOTA2MA==", "bodyText": "Let's use a recent ESLint version from the start:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \"eslint\": \"^6.6.0\",\n          \n          \n            \n                \"eslint\": \"^7.6.0\",", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r467039060", "createdAt": "2020-08-07T13:26:54Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/package.json", "diffHunk": "@@ -0,0 +1,11 @@\n+{\n+  \"name\": \"engage-theodul-plugin-controls\",\n+  \"private\": true,\n+  \"scripts\": {\n+    \"eslint\": \"eslint --config ../../docs/checkstyle/eslintrc.js --rule '{\\\"no-unused-vars\\\": \\\"off\\\"}' src/main/resources/**/*.js\"\n+  },\n+  \"devDependencies\": {\n+    \"eslint\": \"^6.6.0\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8bd8ef60f17ff189485169f433a8e4ea6c364314"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNzMxMDY4OnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzozMjo0MVrOG9aAOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMjozNjowMFrOHAJhvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA0MjM2MQ==", "bodyText": "There can be many more languages. This should probably be something like:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if (language == 'de') {\n          \n          \n            \n                  Engage.log('Tab:Downloads: Chosing german translations');\n          \n          \n            \n                  jsonstr += 'language/de.json';\n          \n          \n            \n                } else { // No other languages supported, yet\n          \n          \n            \n                  Engage.log('Tab:Downloads: Chosing english translations');\n          \n          \n            \n                  jsonstr += 'language/en.json';\n          \n          \n            \n                }\n          \n          \n            \n                Engage.log('Tab:Downloads: Chosing ' + language + ' translations');\n          \n          \n            \n                jsonstr += 'language/' + language + '.json';", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r467042361", "createdAt": "2020-08-07T13:32:41Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js", "diffHunk": "@@ -0,0 +1,216 @@\n+/**\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ *\n+ * The Apereo Foundation licenses this file to you under the Educational\n+ * Community License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License\n+ * at:\n+ *\n+ *   http://opensource.org/licenses/ecl2.txt\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ *\n+ */\n+/*jslint browser: true, nomen: true*/\n+/*global define*/\n+/*global require*/\n+define(['jquery', 'underscore', 'backbone', 'engage/core'], function ($, _, Backbone, Engage) {\n+  'use strict';\n+\n+  var insertIntoDOM = false;\n+  var PLUGIN_NAME = 'Downloads';\n+  var PLUGIN_TYPE = 'engage_tab';\n+  var PLUGIN_VERSION = '1.0';\n+  var PLUGIN_TEMPLATE_DESKTOP = 'templates/desktop.html';\n+  var PLUGIN_STYLES_DESKTOP = [\n+    'styles/desktop.css'\n+  ];\n+\n+  var isDesktopMode = Engage.model.get('mode') === 'desktop';\n+\n+  // The following code block contains the logic for the download tab in the theodul player.\n+  // The download tab should only be displayed if it's explicitly allowed in the 'config.yml' file and\n+  // when the user has a role that matches a specific regex. The regex is also configured in the 'config.yml'.\n+  const video_download_allowed = Engage.model.get('meInfo').get('allow_video_download');\n+  if (video_download_allowed) {\n+    const userRoles = Engage.model.get('meInfo').get('roles');\n+    const roleRegex = new RegExp(Engage.model.get('meInfo').get('allowed_roles_for_video_download'));\n+    const roleMatches = userRoles.some(function (role) {\n+      return roleRegex.exec(role);\n+    });\n+    if (roleMatches) {\n+      insertIntoDOM = true;\n+    }\n+  }\n+\n+  var events = {\n+    plugin_load_done: new Engage.Event('Core:plugin_load_done', '', 'handler'),\n+    mediaPackageModelError: new Engage.Event('MhConnection:mediaPackageModelError', '', 'handler')\n+  };\n+\n+  var plugin = {\n+    insertIntoDOM: insertIntoDOM,\n+    name: PLUGIN_NAME,\n+    type: PLUGIN_TYPE,\n+    version: PLUGIN_VERSION,\n+    styles: PLUGIN_STYLES_DESKTOP,\n+    template: PLUGIN_TEMPLATE_DESKTOP,\n+    events: events\n+  };\n+\n+  /* don't change these variables */\n+  var viewsModelChange = 'change:views';\n+  var mediapackageChange = 'change:mediaPackage';\n+  var initCount = 4;\n+  var mediapackageError = false;\n+  var translations = new Array();\n+  var Utils;\n+\n+\n+  function initTranslate(language, funcSuccess, funcError) {\n+    var path = Engage.getPluginPath('EngagePluginTabDownloads').replace(/(\\.\\.\\/)/g, '');\n+    var jsonstr = window.location.origin + '/engage/theodul/' + path; // this solution is really bad, fix it...\n+\n+    if (language == 'de') {\n+      Engage.log('Tab:Downloads: Chosing german translations');\n+      jsonstr += 'language/de.json';\n+    } else { // No other languages supported, yet\n+      Engage.log('Tab:Downloads: Chosing english translations');\n+      jsonstr += 'language/en.json';\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8bd8ef60f17ff189485169f433a8e4ea6c364314"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA2NzA4MA==", "bodyText": "Or even just:\nconst url = window.location.origin + '/engage/theodul/' + path + 'language/' + language + '.json';\nBut even easier, you can just use a path without domain for the request:\nconst url = '/engage/theodul/' + path + 'language/' + language + '.json';\nand you could also use a template string:\nconst url = `/engage/theodul/${path}language/${language}.json`;\nEDIT: Wobei ich mich dann gerade frage, ob du nicht einfach folgendes verwenden kannst:\nconst url = Engage.getPluginPath('EngagePluginTabDownloads') + `language/${language}.json`;", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r467067080", "createdAt": "2020-08-07T14:13:43Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js", "diffHunk": "@@ -0,0 +1,216 @@\n+/**\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ *\n+ * The Apereo Foundation licenses this file to you under the Educational\n+ * Community License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License\n+ * at:\n+ *\n+ *   http://opensource.org/licenses/ecl2.txt\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ *\n+ */\n+/*jslint browser: true, nomen: true*/\n+/*global define*/\n+/*global require*/\n+define(['jquery', 'underscore', 'backbone', 'engage/core'], function ($, _, Backbone, Engage) {\n+  'use strict';\n+\n+  var insertIntoDOM = false;\n+  var PLUGIN_NAME = 'Downloads';\n+  var PLUGIN_TYPE = 'engage_tab';\n+  var PLUGIN_VERSION = '1.0';\n+  var PLUGIN_TEMPLATE_DESKTOP = 'templates/desktop.html';\n+  var PLUGIN_STYLES_DESKTOP = [\n+    'styles/desktop.css'\n+  ];\n+\n+  var isDesktopMode = Engage.model.get('mode') === 'desktop';\n+\n+  // The following code block contains the logic for the download tab in the theodul player.\n+  // The download tab should only be displayed if it's explicitly allowed in the 'config.yml' file and\n+  // when the user has a role that matches a specific regex. The regex is also configured in the 'config.yml'.\n+  const video_download_allowed = Engage.model.get('meInfo').get('allow_video_download');\n+  if (video_download_allowed) {\n+    const userRoles = Engage.model.get('meInfo').get('roles');\n+    const roleRegex = new RegExp(Engage.model.get('meInfo').get('allowed_roles_for_video_download'));\n+    const roleMatches = userRoles.some(function (role) {\n+      return roleRegex.exec(role);\n+    });\n+    if (roleMatches) {\n+      insertIntoDOM = true;\n+    }\n+  }\n+\n+  var events = {\n+    plugin_load_done: new Engage.Event('Core:plugin_load_done', '', 'handler'),\n+    mediaPackageModelError: new Engage.Event('MhConnection:mediaPackageModelError', '', 'handler')\n+  };\n+\n+  var plugin = {\n+    insertIntoDOM: insertIntoDOM,\n+    name: PLUGIN_NAME,\n+    type: PLUGIN_TYPE,\n+    version: PLUGIN_VERSION,\n+    styles: PLUGIN_STYLES_DESKTOP,\n+    template: PLUGIN_TEMPLATE_DESKTOP,\n+    events: events\n+  };\n+\n+  /* don't change these variables */\n+  var viewsModelChange = 'change:views';\n+  var mediapackageChange = 'change:mediaPackage';\n+  var initCount = 4;\n+  var mediapackageError = false;\n+  var translations = new Array();\n+  var Utils;\n+\n+\n+  function initTranslate(language, funcSuccess, funcError) {\n+    var path = Engage.getPluginPath('EngagePluginTabDownloads').replace(/(\\.\\.\\/)/g, '');\n+    var jsonstr = window.location.origin + '/engage/theodul/' + path; // this solution is really bad, fix it...\n+\n+    if (language == 'de') {\n+      Engage.log('Tab:Downloads: Chosing german translations');\n+      jsonstr += 'language/de.json';\n+    } else { // No other languages supported, yet\n+      Engage.log('Tab:Downloads: Chosing english translations');\n+      jsonstr += 'language/en.json';\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA0MjM2MQ=="}, "originalCommit": {"oid": "8bd8ef60f17ff189485169f433a8e4ea6c364314"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTkxODE0Mw==", "bodyText": "I used this version now: const url = '/engage/theodul/${path}language/${language}.json'", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r469918143", "createdAt": "2020-08-13T12:36:00Z", "author": {"login": "marwyg"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/main.js", "diffHunk": "@@ -0,0 +1,216 @@\n+/**\n+ * Licensed to The Apereo Foundation under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ *\n+ * The Apereo Foundation licenses this file to you under the Educational\n+ * Community License, Version 2.0 (the \"License\"); you may not use this file\n+ * except in compliance with the License. You may obtain a copy of the License\n+ * at:\n+ *\n+ *   http://opensource.org/licenses/ecl2.txt\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ *\n+ */\n+/*jslint browser: true, nomen: true*/\n+/*global define*/\n+/*global require*/\n+define(['jquery', 'underscore', 'backbone', 'engage/core'], function ($, _, Backbone, Engage) {\n+  'use strict';\n+\n+  var insertIntoDOM = false;\n+  var PLUGIN_NAME = 'Downloads';\n+  var PLUGIN_TYPE = 'engage_tab';\n+  var PLUGIN_VERSION = '1.0';\n+  var PLUGIN_TEMPLATE_DESKTOP = 'templates/desktop.html';\n+  var PLUGIN_STYLES_DESKTOP = [\n+    'styles/desktop.css'\n+  ];\n+\n+  var isDesktopMode = Engage.model.get('mode') === 'desktop';\n+\n+  // The following code block contains the logic for the download tab in the theodul player.\n+  // The download tab should only be displayed if it's explicitly allowed in the 'config.yml' file and\n+  // when the user has a role that matches a specific regex. The regex is also configured in the 'config.yml'.\n+  const video_download_allowed = Engage.model.get('meInfo').get('allow_video_download');\n+  if (video_download_allowed) {\n+    const userRoles = Engage.model.get('meInfo').get('roles');\n+    const roleRegex = new RegExp(Engage.model.get('meInfo').get('allowed_roles_for_video_download'));\n+    const roleMatches = userRoles.some(function (role) {\n+      return roleRegex.exec(role);\n+    });\n+    if (roleMatches) {\n+      insertIntoDOM = true;\n+    }\n+  }\n+\n+  var events = {\n+    plugin_load_done: new Engage.Event('Core:plugin_load_done', '', 'handler'),\n+    mediaPackageModelError: new Engage.Event('MhConnection:mediaPackageModelError', '', 'handler')\n+  };\n+\n+  var plugin = {\n+    insertIntoDOM: insertIntoDOM,\n+    name: PLUGIN_NAME,\n+    type: PLUGIN_TYPE,\n+    version: PLUGIN_VERSION,\n+    styles: PLUGIN_STYLES_DESKTOP,\n+    template: PLUGIN_TEMPLATE_DESKTOP,\n+    events: events\n+  };\n+\n+  /* don't change these variables */\n+  var viewsModelChange = 'change:views';\n+  var mediapackageChange = 'change:mediaPackage';\n+  var initCount = 4;\n+  var mediapackageError = false;\n+  var translations = new Array();\n+  var Utils;\n+\n+\n+  function initTranslate(language, funcSuccess, funcError) {\n+    var path = Engage.getPluginPath('EngagePluginTabDownloads').replace(/(\\.\\.\\/)/g, '');\n+    var jsonstr = window.location.origin + '/engage/theodul/' + path; // this solution is really bad, fix it...\n+\n+    if (language == 'de') {\n+      Engage.log('Tab:Downloads: Chosing german translations');\n+      jsonstr += 'language/de.json';\n+    } else { // No other languages supported, yet\n+      Engage.log('Tab:Downloads: Chosing english translations');\n+      jsonstr += 'language/en.json';\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA0MjM2MQ=="}, "originalCommit": {"oid": "8bd8ef60f17ff189485169f433a8e4ea6c364314"}, "originalPosition": 87}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNzMyOTc1OnYy", "diffSide": "RIGHT", "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/templates/desktop.html", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzozNzozN1rOG9aL3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxMzozNzozN1rOG9aL3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA0NTM0MA==", "bodyText": "indentation + don't use tabs. use two spaces.", "url": "https://github.com/opencast/opencast/pull/1719#discussion_r467045340", "createdAt": "2020-08-07T13:37:37Z", "author": {"login": "lkiesow"}, "path": "modules/engage-theodul-plugin-tab-downloads/src/main/resources/static/templates/desktop.html", "diffHunk": "@@ -0,0 +1,47 @@\n+\n+\n+\n+<% if((typeof str_type !== \"undefined\")\n+    && (typeof str_mimetype !== \"undefined\")\n+    && (typeof str_resolution !== \"undefined\")\n+    && (typeof str_download !== \"undefined\")) { %>\n+<div id=\"engage_tab_downloadableVideos_content\">\n+<table class=\"table table-bordered table-hover\">\n+<thead>\n+\t<tr>\n+\t\t<th><%= str_type %></th>\n+\t\t<th><%= str_mimetype %></th>\n+\t\t<th><%= str_resolution %></th>\n+\t\t<th><%= str_download %></th>\n+\t</tr>\n+</thead>\n+\t<tbody>\n+\t<% if(typeof tracks !== \"undefined\" \n+\t\t&& tracks.length !== \"undefined\") { %>\n+\t\t<% _.each(tracks, function(item) { %>\n+\t\t\t<tr>\n+\t\t\t\t<td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8bd8ef60f17ff189485169f433a8e4ea6c364314"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3217, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}