{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyMTQxNjk5", "number": 1354, "title": "Addition of trim segment configuration and new documentation", "bodyText": "This adds the feature defined in this issue of no trim segments at the start and at the end of the video", "createdAt": "2020-01-13T14:18:11Z", "url": "https://github.com/opencast/opencast/pull/1354", "merged": true, "mergeCommit": {"oid": "a61a9d8ed2102a245260bb7cbf9658d87b4ad5ca"}, "closed": true, "closedAt": "2020-06-04T20:38:08Z", "author": {"login": "NgoniChoga"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb58oRLAH2gAyMzYyMTQxNjk5OjYwMGZlZDA0NTEwOTM4ZGE5Y2YxMmE3OTdiNWE2MTQ2Y2Q3NmRjODk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoBMG7gH2gAyMzYyMTQxNjk5OjFmYmNjZDEwNjQ0MWVkNTMwN2E3MGRlYzA3OWVlY2FiOGY1MjZmMzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "600fed04510938da9cf12a797b5a6146cd76dc89", "author": {"user": null}, "url": "https://github.com/opencast/opencast/commit/600fed04510938da9cf12a797b5a6146cd76dc89", "committedDate": "2020-01-13T13:46:54Z", "message": "Addition of trim segment configuration and new documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04ae7e228ebf7fe2c8a6ccb4814bf9b4737b6bf0", "author": {"user": null}, "url": "https://github.com/opencast/opencast/commit/04ae7e228ebf7fe2c8a6ccb4814bf9b4737b6bf0", "committedDate": "2020-01-13T14:10:03Z", "message": "Updated documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ff507d815e3505f137c55143c9ad8cdf272f9eb", "author": {"user": null}, "url": "https://github.com/opencast/opencast/commit/4ff507d815e3505f137c55143c9ad8cdf272f9eb", "committedDate": "2020-01-13T14:17:16Z", "message": "Updated documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16c941ba21a1a422bc7d6e728443b1cecae80dec", "author": {"user": null}, "url": "https://github.com/opencast/opencast/commit/16c941ba21a1a422bc7d6e728443b1cecae80dec", "committedDate": "2020-01-14T07:02:08Z", "message": "Add new documentation to mkdocs.yml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd36f5e9d61662e8a3ff722903112c51f2ee638e", "author": {"user": null}, "url": "https://github.com/opencast/opencast/commit/cd36f5e9d61662e8a3ff722903112c51f2ee638e", "committedDate": "2020-02-25T09:07:42Z", "message": "Merge branch 'parent_develop' into f/videoeditor_default_start_end"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3Mjg3NjIz", "url": "https://github.com/opencast/opencast/pull/1354#pullrequestreview-367287623", "createdAt": "2020-03-02T15:27:35Z", "commit": {"oid": "cd36f5e9d61662e8a3ff722903112c51f2ee638e"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToyNzozNVrOFwjtLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzowOToyNVrOFxOztg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ2MDk3NQ==", "bodyText": "We don't really enforce code standards in the javascript, but please declare each variable on a separate line.", "url": "https://github.com/opencast/opencast/pull/1354#discussion_r386460975", "createdAt": "2020-03-02T15:27:35Z", "author": {"login": "gregorydlogan"}, "path": "modules/admin-ui-frontend/app/scripts/shared/directives/timelineDirective.js", "diffHunk": "@@ -1264,6 +1264,122 @@ angular.module('adminNg.directives')\n           if (scope.timer) $timeout.cancel( scope.timer );\n         });\n \n+        /**\n+         * Creates a promise object to load the AuthService so that user properties\n+         * are available to the current scope.\n+         */\n+        AuthService.getUser().$promise.then(function (user) {\n+          var startLength = parseInt(user.org.properties['admin.editor.segment.start_length'] || 0, 10);\n+          var endLength = parseInt(user.org.properties['admin.editor.segment.end_length'] || 0, 10);\n+          var minLength = parseInt(user.org.properties['admin.editor.segment.minimum_length'] || 0, 10);\n+\n+          scope.startLength = startLength;\n+          scope.endLength = endLength;\n+          scope.minLength = minLength;\n+\n+          if (!startLength && !endLength && !minLength) {\n+            return;\n+          }\n+\n+          scope.video.$promise.then(function(vidObj) {\n+            var duration = parseInt(vidObj.duration, 10);\n+            var segments = vidObj.segments;\n+\n+            if (duration <= startLength + endLength) {\n+              return;\n+            }\n+\n+            var setSegment = function(_start, _end, _min, _del) {\n+\n+              if (_min > 0) {\n+                _end = (_start - _end < _min) ? _start + _min : _end;\n+              }\n+\n+              return {\n+                start: _start,\n+                end: _end,\n+                deleted: _del,\n+                selected: false\n+              };\n+            };\n+\n+            var getSegmentLength = function(_s) {\n+              return (_s.end - _s.start);\n+            };\n+\n+            var maxSegIdx = segments.length - 1;\n+            segments[0].start = 0;\n+            segments[maxSegIdx].end = duration;\n+\n+            if (segments.length == 1) {\n+\n+              var _start = 0, _duration = duration;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd36f5e9d61662e8a3ff722903112c51f2ee638e"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ2MTU0Nw==", "bodyText": "If there's only one segment, doesn't maxSegIdx end up at -1?", "url": "https://github.com/opencast/opencast/pull/1354#discussion_r386461547", "createdAt": "2020-03-02T15:28:29Z", "author": {"login": "gregorydlogan"}, "path": "modules/admin-ui-frontend/app/scripts/shared/directives/timelineDirective.js", "diffHunk": "@@ -1264,6 +1264,122 @@ angular.module('adminNg.directives')\n           if (scope.timer) $timeout.cancel( scope.timer );\n         });\n \n+        /**\n+         * Creates a promise object to load the AuthService so that user properties\n+         * are available to the current scope.\n+         */\n+        AuthService.getUser().$promise.then(function (user) {\n+          var startLength = parseInt(user.org.properties['admin.editor.segment.start_length'] || 0, 10);\n+          var endLength = parseInt(user.org.properties['admin.editor.segment.end_length'] || 0, 10);\n+          var minLength = parseInt(user.org.properties['admin.editor.segment.minimum_length'] || 0, 10);\n+\n+          scope.startLength = startLength;\n+          scope.endLength = endLength;\n+          scope.minLength = minLength;\n+\n+          if (!startLength && !endLength && !minLength) {\n+            return;\n+          }\n+\n+          scope.video.$promise.then(function(vidObj) {\n+            var duration = parseInt(vidObj.duration, 10);\n+            var segments = vidObj.segments;\n+\n+            if (duration <= startLength + endLength) {\n+              return;\n+            }\n+\n+            var setSegment = function(_start, _end, _min, _del) {\n+\n+              if (_min > 0) {\n+                _end = (_start - _end < _min) ? _start + _min : _end;\n+              }\n+\n+              return {\n+                start: _start,\n+                end: _end,\n+                deleted: _del,\n+                selected: false\n+              };\n+            };\n+\n+            var getSegmentLength = function(_s) {\n+              return (_s.end - _s.start);\n+            };\n+\n+            var maxSegIdx = segments.length - 1;\n+            segments[0].start = 0;\n+            segments[maxSegIdx].end = duration;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd36f5e9d61662e8a3ff722903112c51f2ee638e"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE2NzE1OA==", "bodyText": "I'm not a huge fan of the way this has nested function declarations.  Is this how the rest of Angular codebase is?  It's been a while, but we try to keep things similar, file to file.", "url": "https://github.com/opencast/opencast/pull/1354#discussion_r387167158", "createdAt": "2020-03-03T17:09:25Z", "author": {"login": "gregorydlogan"}, "path": "modules/admin-ui-frontend/app/scripts/shared/directives/timelineDirective.js", "diffHunk": "@@ -1264,6 +1264,122 @@ angular.module('adminNg.directives')\n           if (scope.timer) $timeout.cancel( scope.timer );\n         });\n \n+        /**\n+         * Creates a promise object to load the AuthService so that user properties\n+         * are available to the current scope.\n+         */\n+        AuthService.getUser().$promise.then(function (user) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd36f5e9d61662e8a3ff722903112c51f2ee638e"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fbccd106441ed5307a70dec079eecab8f526f34", "author": {"user": {"login": "NgoniChoga", "name": "Ngonidzashe Nicholas Choga"}}, "url": "https://github.com/opencast/opencast/commit/1fbccd106441ed5307a70dec079eecab8f526f34", "committedDate": "2020-06-04T17:06:11Z", "message": "Declare variables on separate lines"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1951, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}