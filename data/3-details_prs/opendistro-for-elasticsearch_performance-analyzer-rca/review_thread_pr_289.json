{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwOTI4MTQ2", "number": 289, "reviewThreads": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMjo1ODowNlrOEPuFqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwMDozNDowNlrOERqVHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTE5MjEwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMjo1ODowNlrOGzlNtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMDo1NTo1M1rOG0e9rA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDI3OQ==", "bodyText": "Let's move yml file name to a constant that can be changed for tests", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r456740279", "createdAt": "2020-07-18T02:58:06Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder = null;\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(\"deciderConfig.yml\"), HashMap.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY4NjQ0NA==", "bodyText": "Good Point. Done", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457686444", "createdAt": "2020-07-20T20:55:53Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder = null;\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(\"deciderConfig.yml\"), HashMap.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDI3OQ=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTE5NDAzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciderConfig.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMzowMDo0OVrOGzlOmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMToxMTo1M1rOG0fcXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDUwNA==", "bodyText": "We want to use decider and action names (NAME field, also returned by name()) instead of class names. This lets us refer to these names directly at different places in the code.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r456740504", "createdAt": "2020-07-18T03:00:49Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciderConfig.yml", "diffHunk": "@@ -0,0 +1,12 @@\n+# Order of action priorities\n+# Loaded to a map of Decider and action priorities\n+# action priorities are given as a list\n+# priority order is decreasing in nature.\n+---\n+deciderActionPriorityOrder:\n+  QueueHealthDecider:\n+    - ModifyQueueCapacityAction", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5NDMwMA==", "bodyText": "Gotcha. Updated.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457694300", "createdAt": "2020-07-20T21:11:53Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciderConfig.yml", "diffHunk": "@@ -0,0 +1,12 @@\n+# Order of action priorities\n+# Loaded to a map of Decider and action priorities\n+# action priorities are given as a list\n+# priority order is decreasing in nature.\n+---\n+deciderActionPriorityOrder:\n+  QueueHealthDecider:\n+    - ModifyQueueCapacityAction", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDUwNA=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTE5NDY1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMzowMTo1MlrOGzlO4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMToxMjozNlrOG0fdtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDU3Ng==", "bodyText": "Looks like the yml is read and created each time someone fetches action priority. How about parsing and storing it ones, during load/init?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r456740576", "createdAt": "2020-07-18T03:01:52Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5NDY0Ng==", "bodyText": "Yup. Updated in the latest version.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457694646", "createdAt": "2020-07-20T21:12:36Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder = null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDU3Ng=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTE5NTUwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/QueueHealthDecider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMzowMzozMFrOGzlPRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMToxMjowOVrOG0fc5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDY3OQ==", "bodyText": "Use NAME instead of this.getClass().getName()", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r456740679", "createdAt": "2020-07-18T03:03:30Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/QueueHealthDecider.java", "diffHunk": "@@ -81,8 +81,8 @@ public Decision operate() {\n   }\n \n   private void configureActionPriority() {\n-    // TODO: Input from user configured yml\n-    this.actionsByUserPriority.add(ModifyQueueCapacityAction.NAME);\n+    ArrayList<String> actionPriority = getDeciderActionPriorityOrder(this.getClass().getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5NDQzNw==", "bodyText": "Updated", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457694437", "createdAt": "2020-07-20T21:12:09Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/QueueHealthDecider.java", "diffHunk": "@@ -81,8 +81,8 @@ public Decision operate() {\n   }\n \n   private void configureActionPriority() {\n-    // TODO: Input from user configured yml\n-    this.actionsByUserPriority.add(ModifyQueueCapacityAction.NAME);\n+    ArrayList<String> actionPriority = getDeciderActionPriorityOrder(this.getClass().getName());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDY3OQ=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTE5NTg2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/Decider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMzowNDoxOFrOGzlPdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMTowODo0MFrOG0fWtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDcyNQ==", "bodyText": "If ConfigReader can store the priority hashmap in memory, then each decider doesn't need to store it. Config reader can expose the getter methods", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r456740725", "createdAt": "2020-07-18T03:04:18Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/Decider.java", "diffHunk": "@@ -41,10 +45,12 @@\n \n   private static final Logger LOG = LogManager.getLogger(Decider.class);\n   protected final int decisionFrequency; // Measured in terms of number of evaluationIntervalPeriods\n+  private final HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n \n   public Decider(long evalIntervalSeconds, int decisionFrequency) {\n     super(0, evalIntervalSeconds);\n     this.decisionFrequency = decisionFrequency;\n+    this.deciderActionPriorityOrder = ConfigReader.getDeciderActionPriorityOrder();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5Mjg1Mg==", "bodyText": "Modified in the latest version.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457692852", "createdAt": "2020-07-20T21:08:40Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/Decider.java", "diffHunk": "@@ -41,10 +45,12 @@\n \n   private static final Logger LOG = LogManager.getLogger(Decider.class);\n   protected final int decisionFrequency; // Measured in terms of number of evaluationIntervalPeriods\n+  private final HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n \n   public Decider(long evalIntervalSeconds, int decisionFrequency) {\n     super(0, evalIntervalSeconds);\n     this.decisionFrequency = decisionFrequency;\n+    this.deciderActionPriorityOrder = ConfigReader.getDeciderActionPriorityOrder();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDcyNQ=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTE5NTk1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMzowNDo0N1rOGzlPgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDo1Njo0MVrOG1JdtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDczNw==", "bodyText": "nit: rename to something specific to action priorities?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r456740737", "createdAt": "2020-07-18T03:04:47Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY4MjA5NA==", "bodyText": "Made is so as to read any kind of config which the decider needs and not just the action priorities. If we dont anticipate any such config I can rename it.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457682094", "createdAt": "2020-07-20T20:47:20Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDczNw=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1OTcwNg==", "bodyText": "I think we should limit this one to only action priorities, to keep it simple to read. Configuration values could go into rca.conf along with other config values. But you can take a call on that if you think there are other decider level configs that should belong here.\nAlso, if you want to make it generic you (at least) need another level of hierarchy in the yml, right?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457759706", "createdAt": "2020-07-21T00:08:00Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDczNw=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4Mjc3Mw==", "bodyText": "Modified to just use the decider Action Priorities.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r458382773", "createdAt": "2020-07-21T20:56:41Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDczNw=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0OTE5ODkzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciderConfig.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMzowODo0M1rOGzlQ2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMTo0NjowOVrOG0gZRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MTA4MQ==", "bodyText": "Where will this yml be present on a deployed cluster? It cant be within the jar, users need to be able to replace it without building jars. Is that possible with current implementation? I think we should also have a path configuration which can be passed as jvm args in case users need to change its default location.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r456741081", "createdAt": "2020-07-18T03:08:43Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciderConfig.yml", "diffHunk": "@@ -0,0 +1,12 @@\n+# Order of action priorities", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzcwOTg5Mg==", "bodyText": "I have modified the location to be in the same repo as the other PA_CONFIGs. I am thinking that this file can be thought of as a one stop config for all the decider related configs. Do we really want to give the knob of keeping all of them modifiable by the customer? Also, what benefit does changing the location brings? The action priority should be a one time setup from the customer during the cluster setup based on the type of the load customer anticipates and tuning after the setup. Once the initial setup is done Do we still anticipate these priorities changing?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457709892", "createdAt": "2020-07-20T21:46:09Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciderConfig.yml", "diffHunk": "@@ -0,0 +1,12 @@\n+# Order of action priorities", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MTA4MQ=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTA1NzE4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNjoyOTowMlrOG0WBVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMDo0OToyN1rOG0ewiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzUzOTkyNg==", "bodyText": "Is there any specific reason to from from YML instead of JSON ? All RCA related configs are stored in JSON file and why do we want to switch to a different format in decision maker ?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457539926", "createdAt": "2020-07-20T16:29:02Z", "author": {"login": "rguo-aws"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY4MzA4Mw==", "bodyText": "We want it to be a yml because we want to provide the ODFE users as an ability to provide the priorities. Since ES follows a YML model, we don't want to disrupt that and provide the users an ability to provide the same via YML only.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457683083", "createdAt": "2020-07-20T20:49:27Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzUzOTkyNg=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTA1OTU5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNjoyOTozN1rOG0WC2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMTowMDowNFrOG0fGcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0MDMxMw==", "bodyText": "Add an error  log here ?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457540313", "createdAt": "2020-07-20T16:29:37Z", "author": {"login": "rguo-aws"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder = null;\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(\"deciderConfig.yml\"), HashMap.class);\n+            return deciderActionPriorityOrder;\n+        } catch (Exception e) {\n+            e.printStackTrace();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY4ODY5MQ==", "bodyText": "Done", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457688691", "createdAt": "2020-07-20T21:00:04Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder = null;\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(\"deciderConfig.yml\"), HashMap.class);\n+            return deciderActionPriorityOrder;\n+        } catch (Exception e) {\n+            e.printStackTrace();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0MDMxMw=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTA2MzIyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNjozMDoyOVrOG0WFDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMDo1NjowOFrOG0e-TQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0MDg3Nw==", "bodyText": "this return statement seems to be redundant", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457540877", "createdAt": "2020-07-20T16:30:29Z", "author": {"login": "rguo-aws"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder = null;\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(\"deciderConfig.yml\"), HashMap.class);\n+            return deciderActionPriorityOrder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY4NjYwNQ==", "bodyText": "right modified the whole structure.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457686605", "createdAt": "2020-07-20T20:56:08Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder = null;\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(\"deciderConfig.yml\"), HashMap.class);\n+            return deciderActionPriorityOrder;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0MDg3Nw=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTA2NTg5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNjozMTowNVrOG0WGog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMDo0NzozN1rOG0etPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0MTI4Mg==", "bodyText": "Can we add Nullable annotation to this function ?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457541282", "createdAt": "2020-07-20T16:31:05Z", "author": {"login": "rguo-aws"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY4MjIzOQ==", "bodyText": "Modified to keep the value in the class object itself.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457682239", "createdAt": "2020-07-20T20:47:37Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+\n+public class ConfigReader {\n+    public static HashMap<Decider, ArrayList<String>> getDeciderActionPriorityOrder() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0MTI4Mg=="}, "originalCommit": {"oid": "273d788740505025fb350c3649b8dab8f9a00027"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjQ1MTQyOnYy", "diffSide": "RIGHT", "path": "pa_config/deciderConfig.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMzo1NzoxMFrOG0jPcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDoyODoxOVrOG1IkFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1NjUyOA==", "bodyText": "nit: add newline at end of file", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457756528", "createdAt": "2020-07-20T23:57:10Z", "author": {"login": "vigyasharma"}, "path": "pa_config/deciderConfig.yml", "diffHunk": "@@ -0,0 +1,9 @@\n+# Order of action priorities\n+# Loaded to a map of Decider and action priorities\n+# action priorities are given as a list\n+# priority order is decreasing in nature.\n+---\n+queue_health:\n+  - modify_queue_capacity\n+cache_health:\n+  - modify_cache_capacity", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM2ODAyMg==", "bodyText": "Done", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r458368022", "createdAt": "2020-07-21T20:28:19Z", "author": {"login": "aditjind"}, "path": "pa_config/deciderConfig.yml", "diffHunk": "@@ -0,0 +1,9 @@\n+# Order of action priorities\n+# Loaded to a map of Decider and action priorities\n+# action priorities are given as a list\n+# priority order is decreasing in nature.\n+---\n+queue_health:\n+  - modify_queue_capacity\n+cache_health:\n+  - modify_cache_capacity", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1NjUyOA=="}, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjQ1ODcxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDowMDo1MVrOG0jTtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDo1NjowOVrOG1JcwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1NzYyMQ==", "bodyText": "Is this is the right way to provide file path for configuration files? What is the current directory here for ./...?\nPlease see how path has been specified for rca.conf in RcaConsts.java and change accordingly.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457757621", "createdAt": "2020-07-21T00:00:51Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class ConfigReader {\n+    private static final Logger LOG = LogManager.getLogger(ConfigReader.class);\n+    private static HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n+\n+    public static final String CONFIG_FILE_PATH = \"./pa_config/deciderConfig.yml\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MjUyOQ==", "bodyText": "Done", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r458382529", "createdAt": "2020-07-21T20:56:09Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class ConfigReader {\n+    private static final Logger LOG = LogManager.getLogger(ConfigReader.class);\n+    private static HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n+\n+    public static final String CONFIG_FILE_PATH = \"./pa_config/deciderConfig.yml\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1NzYyMQ=="}, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjQ1OTkxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDowMToyNVrOG0jUbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDo1NTo1MVrOG1JcFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1NzgwNw==", "bodyText": "The constructor can take path as input to support test cases with different config files.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457757807", "createdAt": "2020-07-21T00:01:25Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class ConfigReader {\n+    private static final Logger LOG = LogManager.getLogger(ConfigReader.class);\n+    private static HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n+\n+    public static final String CONFIG_FILE_PATH = \"./pa_config/deciderConfig.yml\";\n+\n+    public ConfigReader() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MjM1Nw==", "bodyText": "Done", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r458382357", "createdAt": "2020-07-21T20:55:51Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class ConfigReader {\n+    private static final Logger LOG = LogManager.getLogger(ConfigReader.class);\n+    private static HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n+\n+    public static final String CONFIG_FILE_PATH = \"./pa_config/deciderConfig.yml\";\n+\n+    public ConfigReader() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc1NzgwNw=="}, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjQ3NTY2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDowOToyOFrOG0jdmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDo1NTo0NFrOG1Jb5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc2MDE1NA==", "bodyText": "This will also not work with the generic decider config file you mentioned. Let us just restrict it to an action_priorities file only", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457760154", "createdAt": "2020-07-21T00:09:28Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class ConfigReader {\n+    private static final Logger LOG = LogManager.getLogger(ConfigReader.class);\n+    private static HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n+\n+    public static final String CONFIG_FILE_PATH = \"./pa_config/deciderConfig.yml\";\n+\n+    public ConfigReader() {\n+        this.deciderActionPriorityOrder = null;\n+    }\n+\n+    public static void updateDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(CONFIG_FILE_PATH), HashMap.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MjMwOA==", "bodyText": "done", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r458382308", "createdAt": "2020-07-21T20:55:44Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class ConfigReader {\n+    private static final Logger LOG = LogManager.getLogger(ConfigReader.class);\n+    private static HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n+\n+    public static final String CONFIG_FILE_PATH = \"./pa_config/deciderConfig.yml\";\n+\n+    public ConfigReader() {\n+        this.deciderActionPriorityOrder = null;\n+    }\n+\n+    public static void updateDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(CONFIG_FILE_PATH), HashMap.class);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc2MDE1NA=="}, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjQ3OTA2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDoxMToxMVrOG0jfkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMDo1NToxNlrOG1Ja1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc2MDY1OQ==", "bodyText": "Handle NPE here?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r457760659", "createdAt": "2020-07-21T00:11:11Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class ConfigReader {\n+    private static final Logger LOG = LogManager.getLogger(ConfigReader.class);\n+    private static HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n+\n+    public static final String CONFIG_FILE_PATH = \"./pa_config/deciderConfig.yml\";\n+\n+    public ConfigReader() {\n+        this.deciderActionPriorityOrder = null;\n+    }\n+\n+    public static void updateDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(CONFIG_FILE_PATH), HashMap.class);\n+        } catch (Exception e) {\n+            LOG.error(\"Could not read the Decider Config File\");\n+            e.printStackTrace();\n+        }\n+        return;\n+    }\n+\n+    public static ArrayList<String> getActionPriorityOrder(String decider) {\n+        return deciderActionPriorityOrder.get(decider);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MjAzNw==", "bodyText": "Done", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r458382037", "createdAt": "2020-07-21T20:55:16Z", "author": {"login": "aditjind"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/ConfigReader.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n+\n+import com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker.deciders.Decider;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class ConfigReader {\n+    private static final Logger LOG = LogManager.getLogger(ConfigReader.class);\n+    private static HashMap<Decider, ArrayList<String>> deciderActionPriorityOrder;\n+\n+    public static final String CONFIG_FILE_PATH = \"./pa_config/deciderConfig.yml\";\n+\n+    public ConfigReader() {\n+        this.deciderActionPriorityOrder = null;\n+    }\n+\n+    public static void updateDeciderActionPriorityOrder() {\n+        ObjectMapper mapper = new ObjectMapper(new YAMLFactory());\n+        try {\n+            deciderActionPriorityOrder = mapper.readValue(new File(CONFIG_FILE_PATH), HashMap.class);\n+        } catch (Exception e) {\n+            LOG.error(\"Could not read the Decider Config File\");\n+            e.printStackTrace();\n+        }\n+        return;\n+    }\n+\n+    public static ArrayList<String> getActionPriorityOrder(String decider) {\n+        return deciderActionPriorityOrder.get(decider);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc2MDY1OQ=="}, "originalCommit": {"oid": "7cbfc2a152542087d87e0344f989b84561f9d26b"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTkxMjMxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/QueueHealthDecider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwNjowODowN1rOG19Q3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwMDozMTo0NFrOG2f80g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIzMTQ1Mw==", "bodyText": "nit: we can merge these lines", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r459231453", "createdAt": "2020-07-23T06:08:07Z", "author": {"login": "vigyasharma"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/QueueHealthDecider.java", "diffHunk": "@@ -81,8 +80,8 @@ public Decision operate() {\n   }\n \n   private void configureActionPriority() {\n-    // TODO: Input from user configured yml\n-    this.actionsByUserPriority.add(ModifyQueueCapacityAction.NAME);\n+    ArrayList<String> actionPriority = DeciderActionPriorityReader.getActionPriorityOrder(name());\n+    actionsByUserPriority = actionPriority;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "510a2170cb136d760ac370c0305ba42d47e25a5f"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc5OTc2Mg==", "bodyText": "+1.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r459799762", "createdAt": "2020-07-24T00:31:44Z", "author": {"login": "rguo-aws"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/deciders/QueueHealthDecider.java", "diffHunk": "@@ -81,8 +80,8 @@ public Decision operate() {\n   }\n \n   private void configureActionPriority() {\n-    // TODO: Input from user configured yml\n-    this.actionsByUserPriority.add(ModifyQueueCapacityAction.NAME);\n+    ArrayList<String> actionPriority = DeciderActionPriorityReader.getActionPriorityOrder(name());\n+    actionsByUserPriority = actionPriority;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIzMTQ1Mw=="}, "originalCommit": {"oid": "510a2170cb136d760ac370c0305ba42d47e25a5f"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2OTU0NzgwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/store/ElasticSearchAnalysisGraph.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwMDozNDowNlrOG2f-2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwMDozNDowNlrOG2f-2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTgwMDI4MA==", "bodyText": "let's try to move this reader to somewhere else as it is clearly not part of the RCA graph.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/289#discussion_r459800280", "createdAt": "2020-07-24T00:34:06Z", "author": {"login": "rguo-aws"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/store/ElasticSearchAnalysisGraph.java", "diffHunk": "@@ -175,6 +177,10 @@ public void construct() {\n     queueRejectionClusterRca.addAllUpstreams(Collections.singletonList(queueRejectionNodeRca));\n     queueRejectionClusterRca.addTag(TAG_AGGREGATE_UPSTREAM, LOCUS_DATA_NODE);\n \n+    // Upload the config from YAML into memory.\n+    DeciderActionPriorityReader reader = new DeciderActionPriorityReader(DECIDER_ACTION_PRIORITIES_PATH);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "510a2170cb136d760ac370c0305ba42d47e25a5f"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2532, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}