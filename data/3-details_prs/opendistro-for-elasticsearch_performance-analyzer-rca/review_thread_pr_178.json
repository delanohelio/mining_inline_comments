{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExMjY1OTEw", "number": 178, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQyMzozOTowOFrOD4PlFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQyMzo0MToxMlrOD4Pmhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwMzAyMTAxOnYy", "diffSide": "RIGHT", "path": "src/test/resources/rca/rca_muted.conf", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQyMzozOTowOFrOGO98lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQyMzo1MToxMlrOGO-KRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM0ODE4Mw==", "bodyText": "Do we not want this instead -\n\"muted-rcas\": [\"CPU_Utilization\", \"Heap_AllocRate\"] ?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/178#discussion_r418348183", "createdAt": "2020-04-30T23:39:08Z", "author": {"login": "yojs"}, "path": "src/test/resources/rca/rca_muted.conf", "diffHunk": "@@ -44,5 +44,5 @@\n     \"rotation-period-seconds\": 21600\n   },\n \n-  \"muted-rcas\": \"CPU_Utilization, Heap_AllocRate\"\n+  \"muted-rcas\": [\"CPU_Utilization, Heap_AllocRate\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3829a51a705a485d0eb9dd704ccb471bef318e56"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM1MTY4Ng==", "bodyText": "Correct, fixing this.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/178#discussion_r418351686", "createdAt": "2020-04-30T23:51:12Z", "author": {"login": "khushbr"}, "path": "src/test/resources/rca/rca_muted.conf", "diffHunk": "@@ -44,5 +44,5 @@\n     \"rotation-period-seconds\": 21600\n   },\n \n-  \"muted-rcas\": \"CPU_Utilization, Heap_AllocRate\"\n+  \"muted-rcas\": [\"CPU_Utilization, Heap_AllocRate\"]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM0ODE4Mw=="}, "originalCommit": {"oid": "3829a51a705a485d0eb9dd704ccb471bef318e56"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwMzAyNDcxOnYy", "diffSide": "RIGHT", "path": "src/test/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/RcaControllerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQyMzo0MToxMlrOGO9-1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQyMzo0ODo1NFrOGO-HZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM0ODc1Nw==", "bodyText": "typo: readAndUpdateMutedRcas instead ?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/178#discussion_r418348757", "createdAt": "2020-04-30T23:41:12Z", "author": {"login": "yojs"}, "path": "src/test/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/RcaControllerTest.java", "diffHunk": "@@ -162,9 +169,39 @@ public void readRcaEnabledFromConf() throws IOException {\n     Assert.assertTrue(RcaController.isRcaEnabled());\n   }\n \n+  @Test\n+  public void readAndUpdateMutesRcasBeforeGraphCreation() throws Exception {\n+    Method readAndUpdateMutesRcas = rcaController.getClass()\n+            .getDeclaredMethod(\"readAndUpdateMutesRcas\", null);\n+    readAndUpdateMutesRcas.setAccessible(true);\n+\n+    String rcaConfPath = Paths.get(RcaConsts.TEST_CONFIG_PATH, \"rca_muted.conf\").toString();\n+    Field rcaConfField = rcaController.getClass().getDeclaredField(\"rcaConf\");\n+    rcaConfField.setAccessible(true);\n+    rcaConfField.set(rcaController, new RcaConf(rcaConfPath));\n+    updateConfFileForMutedRcas(rcaConfPath, Arrays.asList(\"CPU_Utilization\", \"Heap_AllocRate\"));\n+\n+    Field mutedGraphNodesField = Stats.class.getDeclaredField(\"mutedGraphNodes\");\n+    mutedGraphNodesField.setAccessible(true);\n+    mutedGraphNodesField.set(Stats.getInstance(), null);\n+    Set<String> initialComponentSet = ConnectedComponent.getNodeNames();\n+    Whitebox.setInternalState(ConnectedComponent.class, \"nodeNames\", new HashSet<>());\n+\n+    readAndUpdateMutesRcas.invoke(rcaController);\n+    Assert.assertNull(Stats.getInstance().getMutedGraphNodes());\n+\n+    // Re-set back to initialComponentSet\n+    Whitebox.setInternalState(ConnectedComponent.class, \"nodeNames\", initialComponentSet);\n+  }\n+\n   @Test\n   public void readAndUpdateMutesRcas() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3829a51a705a485d0eb9dd704ccb471bef318e56"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM1MDk0OQ==", "bodyText": "Fixed the typo.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/178#discussion_r418350949", "createdAt": "2020-04-30T23:48:54Z", "author": {"login": "khushbr"}, "path": "src/test/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/RcaControllerTest.java", "diffHunk": "@@ -162,9 +169,39 @@ public void readRcaEnabledFromConf() throws IOException {\n     Assert.assertTrue(RcaController.isRcaEnabled());\n   }\n \n+  @Test\n+  public void readAndUpdateMutesRcasBeforeGraphCreation() throws Exception {\n+    Method readAndUpdateMutesRcas = rcaController.getClass()\n+            .getDeclaredMethod(\"readAndUpdateMutesRcas\", null);\n+    readAndUpdateMutesRcas.setAccessible(true);\n+\n+    String rcaConfPath = Paths.get(RcaConsts.TEST_CONFIG_PATH, \"rca_muted.conf\").toString();\n+    Field rcaConfField = rcaController.getClass().getDeclaredField(\"rcaConf\");\n+    rcaConfField.setAccessible(true);\n+    rcaConfField.set(rcaController, new RcaConf(rcaConfPath));\n+    updateConfFileForMutedRcas(rcaConfPath, Arrays.asList(\"CPU_Utilization\", \"Heap_AllocRate\"));\n+\n+    Field mutedGraphNodesField = Stats.class.getDeclaredField(\"mutedGraphNodes\");\n+    mutedGraphNodesField.setAccessible(true);\n+    mutedGraphNodesField.set(Stats.getInstance(), null);\n+    Set<String> initialComponentSet = ConnectedComponent.getNodeNames();\n+    Whitebox.setInternalState(ConnectedComponent.class, \"nodeNames\", new HashSet<>());\n+\n+    readAndUpdateMutesRcas.invoke(rcaController);\n+    Assert.assertNull(Stats.getInstance().getMutedGraphNodes());\n+\n+    // Re-set back to initialComponentSet\n+    Whitebox.setInternalState(ConnectedComponent.class, \"nodeNames\", initialComponentSet);\n+  }\n+\n   @Test\n   public void readAndUpdateMutesRcas() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM0ODc1Nw=="}, "originalCommit": {"oid": "3829a51a705a485d0eb9dd704ccb471bef318e56"}, "originalPosition": 58}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2631, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}