{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwMzAxMTI0", "number": 495, "title": "PersistableSlidingWindow#load() modification", "bodyText": "Fixes #: A series of ITs that failed on this error log line\nDescription of changes:\n\nPersistableSlidingWindow#load() will no longer throw an IOException\nwhen it is called with a Path that doesn't exist\n\nTests:\n\nPersistableSlidingWindowTest\n\nIf new tests are added, how long do the new ones take to complete N/A\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-10-26T20:53:18Z", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/495", "merged": true, "mergeCommit": {"oid": "7c32322a32366c7736d850c97f5c5db4716b1e3a"}, "closed": true, "closedAt": "2020-10-28T21:22:10Z", "author": {"login": "sidheart"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWatSZAH2gAyNTEwMzAxMTI0OjdhYWNiOTlkMmYzNjljZGU2OTlhZjM2YTQyNzJlODBmNzU0MDFhNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXDs-aAFqTUxOTA2MjUxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7aacb99d2f369cde699af36a4272e80f75401a65", "author": {"user": {"login": "sidheart", "name": "Sid Narayan"}}, "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/7aacb99d2f369cde699af36a4272e80f75401a65", "committedDate": "2020-10-26T20:50:34Z", "message": "PersistableSlidingWindow#load() modification\n\n- PersistableSlidingWindow#load() will no longer throw an IOException\nwhen it is called with a Path that doesn't exist"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MTgyNzgy", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/495#pullrequestreview-517182782", "createdAt": "2020-10-26T21:17:25Z", "commit": {"oid": "7aacb99d2f369cde699af36a4272e80f75401a65"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQyMToxNzoyNVrOHoiufQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQyMToxNzoyNVrOHoiufQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjI3NDA0NQ==", "bodyText": "As no file exists in this path, will this be more of a warning logger level?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/495#discussion_r512274045", "createdAt": "2020-10-26T21:17:25Z", "author": {"login": "sruti1312"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/framework/api/aggregators/PersistableSlidingWindow.java", "diffHunk": "@@ -72,6 +72,10 @@ protected synchronized void load(Path path) throws IOException {\n     if (!enablePersistence) {\n       return;\n     }\n+    if (!Files.exists(path)) {\n+      LOG.debug(\"{}#load({}) called but the file doesn't exist\", this.getClass().getSimpleName(), path);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7aacb99d2f369cde699af36a4272e80f75401a65"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed0ab850cf3005e8e92e33e485d375550cc877e7", "author": {"user": {"login": "sidheart", "name": "Sid Narayan"}}, "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/ed0ab850cf3005e8e92e33e485d375550cc877e7", "committedDate": "2020-10-26T23:49:22Z", "message": "Move load() validation resposiblity to caller"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3OTUzMjky", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/495#pullrequestreview-517953292", "createdAt": "2020-10-27T17:15:08Z", "commit": {"oid": "ed0ab850cf3005e8e92e33e485d375550cc877e7"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzoxNTowOFrOHpHhUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzoxNTowOFrOHpHhUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg3Njg4Mw==", "bodyText": "Can we add a log message when enablePersistence is not set or when file does not exist in the path? Even debug level log would be great.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/495#discussion_r512876883", "createdAt": "2020-10-27T17:15:08Z", "author": {"login": "sruti1312"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/framework/api/aggregators/PersistableSlidingWindow.java", "diffHunk": "@@ -49,17 +49,15 @@ public PersistableSlidingWindow(int slidingWindowSize,\n                                   Path filePath) {\n     super(slidingWindowSize, timeUnit);\n     this.pathToFile = filePath;\n-    if (this.pathToFile == null) {\n-      this.enablePersistence = false;\n-    } else {\n-      this.enablePersistence = true;\n-      // setting the last write time to now will cause our first write to occur 5 minutes after construction\n-      this.lastWriteTimeEpochMs = Instant.now().toEpochMilli();\n-      try {\n+    this.enablePersistence = this.pathToFile != null;\n+    // setting the last write time to now will cause our first write to occur 5 minutes after construction\n+    this.lastWriteTimeEpochMs = Instant.now().toEpochMilli();\n+    try {\n+      if (enablePersistence && Files.exists(filePath)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed0ab850cf3005e8e92e33e485d375550cc877e7"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "372dd94613d270e737360394ebdf514f51b6f7bd", "author": {"user": {"login": "sidheart", "name": "Sid Narayan"}}, "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/372dd94613d270e737360394ebdf514f51b6f7bd", "committedDate": "2020-10-27T17:56:08Z", "message": "Added more logging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3OTk0NTk3", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/495#pullrequestreview-517994597", "createdAt": "2020-10-27T17:58:25Z", "commit": {"oid": "372dd94613d270e737360394ebdf514f51b6f7bd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MDUyMzI0", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/495#pullrequestreview-519052324", "createdAt": "2020-10-28T20:22:25Z", "commit": {"oid": "372dd94613d270e737360394ebdf514f51b6f7bd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MDYyNTEw", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/495#pullrequestreview-519062510", "createdAt": "2020-10-28T20:36:20Z", "commit": {"oid": "372dd94613d270e737360394ebdf514f51b6f7bd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 801, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}