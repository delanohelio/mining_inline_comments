{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUzNjg5NTg0", "number": 291, "title": "More refactoring to plugin-in an integration test framework for RCA components", "bodyText": "Issue #: #292\nDescription of changes:\nThe changes are mostly to expose interfaces that were otherwise buried into private interfaces.\nIt also removes some of the static usages in the RcaController\nChanges a few tests accordingly to account for the changes\nTests:\nNo new tests are required as this is just refactoring. Existing tests should cover the changes.\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-07-20T17:57:01Z", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/291", "merged": true, "mergeCommit": {"oid": "ec29ff601b5ec3714c08a1cb5d42bc0ba5cc8617"}, "closed": true, "closedAt": "2020-07-20T20:53:32Z", "author": {"login": "yojs"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc21X5oAH2gAyNDUzNjg5NTg0OjQ2NzA2NzM4MTc0ZDhlZDE0Yjk5Nzk3YjJhZjkxMmQyYzg5OTRiMTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc23-PIgFqTQ1MTk0ODgwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "46706738174d8ed14b99797b2af912d2c8994b10", "author": {"user": {"login": "yojs", "name": "Joydeep Sinha"}}, "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/46706738174d8ed14b99797b2af912d2c8994b10", "committedDate": "2020-07-20T17:49:04Z", "message": "More refactoring to plugin-in an integration test framework for RCA components\n\nThe changes are mostly to expose interfaces that were otherwise buried into private interfaces.\nIt also removes some of the static usages in the RcaController\nChanges a few tests accordingly to account for the changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxODk5OTQ1", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/291#pullrequestreview-451899945", "createdAt": "2020-07-20T19:34:05Z", "commit": {"oid": "46706738174d8ed14b99797b2af912d2c8994b10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxOTozNDowNVrOG0cZCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxOTozNDowNVrOG0cZCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY0NDI5Nw==", "bodyText": "does this need to be declared as volatile ?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/291#discussion_r457644297", "createdAt": "2020-07-20T19:34:05Z", "author": {"login": "rguo-aws"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/RcaController.java", "diffHunk": "@@ -114,6 +115,8 @@\n   private final long rcaStateCheckIntervalMillis;\n   private final long roleCheckPeriodicity;\n \n+  private boolean deliberateInterrupt;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46706738174d8ed14b99797b2af912d2c8994b10"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxOTAxMjk0", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/291#pullrequestreview-451901294", "createdAt": "2020-07-20T19:36:12Z", "commit": {"oid": "46706738174d8ed14b99797b2af912d2c8994b10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxOTozNjoxMlrOG0cdNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxOTozNjoxMlrOG0cdNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY0NTM2NQ==", "bodyText": "declare this as volatile ?", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/291#discussion_r457645365", "createdAt": "2020-07-20T19:36:12Z", "author": {"login": "rguo-aws"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/net/NetServer.java", "diffHunk": "@@ -89,10 +89,13 @@\n    */\n   protected Server server;\n \n+  private boolean attemptedShutdown;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46706738174d8ed14b99797b2af912d2c8994b10"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99b97ccec87179aa1b29ca0e66c4c579dc297072", "author": {"user": {"login": "yojs", "name": "Joydeep Sinha"}}, "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/99b97ccec87179aa1b29ca0e66c4c579dc297072", "committedDate": "2020-07-20T20:02:33Z", "message": "addressing PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxOTQzMDUy", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/291#pullrequestreview-451943052", "createdAt": "2020-07-20T20:40:33Z", "commit": {"oid": "99b97ccec87179aa1b29ca0e66c4c579dc297072"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxOTQ4ODA5", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/291#pullrequestreview-451948809", "createdAt": "2020-07-20T20:49:29Z", "commit": {"oid": "99b97ccec87179aa1b29ca0e66c4c579dc297072"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMDo0OToyOVrOG0ewmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMDo0OToyOVrOG0ewmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY4MzA5Nw==", "bodyText": "Looks like this was missed in the original code as well, but we should also propagate the interrupted exception if we caught it by calling Thread.currentThread().interrupt() explicitly here.", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/291#discussion_r457683097", "createdAt": "2020-07-20T20:49:29Z", "author": {"login": "ktkrg"}, "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/rca/RcaController.java", "diffHunk": "@@ -251,8 +285,10 @@ public void run() {\n           Thread.sleep(rcaStateCheckIntervalMillis - duration);\n         }\n       } catch (InterruptedException ie) {\n-        LOG.error(\"RCA controller thread was interrupted. Reason: {}\", ie.getMessage());\n-        LOG.error(ie);\n+        if (!deliberateInterrupt) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99b97ccec87179aa1b29ca0e66c4c579dc297072"}, "originalPosition": 107}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1093, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}