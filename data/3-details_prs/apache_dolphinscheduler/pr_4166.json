{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzMDA2ODg4", "number": 4166, "title": "[Fix-3457][flink] fix flink args build problem", "bodyText": "Tips\n\nThanks very much for contributing to Apache DolphinScheduler.\nPlease review https://dolphinscheduler.apache.org/en-us/community/index.html before opening a pull request.\n\nWhat is the purpose of the pull request\nFix flink args build problem #3457\nthis closes #3987 #3457\nThe official flink run command is flink run [OPTIONS] <jar-file> <arguments> (ref: flink-1.9-cli and  flink-1.11-cli), but there are some errors in the code:\n\nthe other args is after the main args, so that it will be part of the <arguments>\nthe flink queue option is also after the main args, so that the option doesn't work\nthe flink queue option is -yqu, not --qu, and it's only for yarn. see flink-1.9-cli and  flink-1.11-cli\nthe comment --files --conf --libjar ... is for spark, not for flink\n\nBrief change log\nFlink args:\n\n[Fix][Flink] fix flink args build problem\n\nAdjust the order of the other args and optimize the logic\nRename the flink queue option --qu to -yqu\n\n\n[Fix][Flink] fix FlinkArgsUtilsTest\n[Improvement][UI] hide version and cluster input when deployMode is local\n\nVerify this pull request\n(Please pick either of the following options)\nThis pull request is already covered by existing tests, such as (please describe tests).\n(and)\nThis change added tests and can be verified as follows:\nAssume that:\n\nmain args: --input file:///home/user/hamlet.txt --output file:///home/user/wordcount_out\nother args: -p 4\n\nBefore fix, the generated flink commands are as follow:\n\nlocal: flink run -c org.apache.flink.examples.java.wordcount.WordCount WordCount.jar --input file:///home/user/hamlet.txt --output file:///home/user/wordcount_out -p 4\ncluster: flink run -m yarn-cluster -ys 1 -yn 2 -yjm 1G -ytm 2G -d -c org.apache.flink.examples.java.wordcount.WordCount WordCount.jar --input file:///home/user/hamlet.txt --output file:///home/user/wordcount_out --qu test -p 4\n\nAfter fix, the generated flink commands are as follow:\n\nlocal: flink run -p 4 -c org.apache.flink.examples.java.wordcount.WordCount WordCount.jar --input file:///home/user/hamlet.txt --output file:///home/user/wordcount_out\ncluster: flink run -m yarn-cluster -ys 1 -yn 2 -yjm 1G -ytm 2G -yqu test -d -p 4 -c org.apache.flink.examples.java.wordcount.WordCount WordCount.jar --input file:///home/user/hamlet.txt --output file:///home/user/wordcount_out\n\nFor the commit [Improvement][UI] hide version and cluster input when deployMode is local:", "createdAt": "2020-12-05T12:08:11Z", "url": "https://github.com/apache/dolphinscheduler/pull/4166", "merged": true, "mergeCommit": {"oid": "cbc30b4900215424dcbbfb49539259d32273efc3"}, "closed": true, "closedAt": "2020-12-10T14:37:23Z", "author": {"login": "chengshiwen"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjLQdTgFqTU0NTU4Mjc1Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdk0RtdgFqTU0OTI1NDQ0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NTgyNzUy", "url": "https://github.com/apache/dolphinscheduler/pull/4166#pullrequestreview-545582752", "createdAt": "2020-12-05T12:11:30Z", "commit": {"oid": "47441d727eb751580710a0f1a1ef7fb417bd0123"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQxMjoxMTozMVrOH_2nZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQxMjoxMTozMVrOH_2nZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjcxNzE1Nw==", "bodyText": "server.jetty.max-http-post-size is just deprecated", "url": "https://github.com/apache/dolphinscheduler/pull/4166#discussion_r536717157", "createdAt": "2020-12-05T12:11:31Z", "author": {"login": "chengshiwen"}, "path": "dolphinscheduler-api/src/main/resources/application-api.properties", "diffHunk": "@@ -35,7 +35,7 @@ server.compression.enabled=true\n server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json,application/xml\n \n #post content\n-server.jetty.max-http-post-size=5000000", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47441d727eb751580710a0f1a1ef7fb417bd0123"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "940dcfb38f6165ec53c74c07f3664273c1111758", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/940dcfb38f6165ec53c74c07f3664273c1111758", "committedDate": "2020-12-05T12:30:02Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}, "afterCommit": {"oid": "b26502d2f7036c7d198667ed52d82e3032d93f46", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/b26502d2f7036c7d198667ed52d82e3032d93f46", "committedDate": "2020-12-05T12:33:07Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b26502d2f7036c7d198667ed52d82e3032d93f46", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/b26502d2f7036c7d198667ed52d82e3032d93f46", "committedDate": "2020-12-05T12:33:07Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}, "afterCommit": {"oid": "0f39c0ba14bbbbd8bd50f1a04368808bccd20167", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/0f39c0ba14bbbbd8bd50f1a04368808bccd20167", "committedDate": "2020-12-05T13:30:37Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0f39c0ba14bbbbd8bd50f1a04368808bccd20167", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/0f39c0ba14bbbbd8bd50f1a04368808bccd20167", "committedDate": "2020-12-05T13:30:37Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}, "afterCommit": {"oid": "b2d3093b86717ccea98a2233d987253205f6ac91", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/b2d3093b86717ccea98a2233d987253205f6ac91", "committedDate": "2020-12-06T04:40:53Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f12d807b58c1950188b76fd120510b5cbd48fb7f", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/f12d807b58c1950188b76fd120510b5cbd48fb7f", "committedDate": "2020-12-06T05:56:37Z", "message": "[Fix][Flink] fix flink args build problem"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a148aa8ba17b59fdeb6b85dcba8bdcdbec30315", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/5a148aa8ba17b59fdeb6b85dcba8bdcdbec30315", "committedDate": "2020-12-06T05:56:37Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2d3093b86717ccea98a2233d987253205f6ac91", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/b2d3093b86717ccea98a2233d987253205f6ac91", "committedDate": "2020-12-06T04:40:53Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}, "afterCommit": {"oid": "5a148aa8ba17b59fdeb6b85dcba8bdcdbec30315", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/5a148aa8ba17b59fdeb6b85dcba8bdcdbec30315", "committedDate": "2020-12-06T05:56:37Z", "message": "[Fix][Flink] fix FlinkArgsUtilsTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e9cfcf5d4d180d791d791789a9d926c74fc0c7e", "author": {"user": {"login": "chengshiwen", "name": "Shiwen Cheng"}}, "url": "https://github.com/apache/dolphinscheduler/commit/6e9cfcf5d4d180d791d791789a9d926c74fc0c7e", "committedDate": "2020-12-06T06:22:36Z", "message": "[Improvement][UI] hide version and cluster input when deployMode is local"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MjQxMDMx", "url": "https://github.com/apache/dolphinscheduler/pull/4166#pullrequestreview-549241031", "createdAt": "2020-12-10T14:19:30Z", "commit": {"oid": "6e9cfcf5d4d180d791d791789a9d926c74fc0c7e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MjU0NDQw", "url": "https://github.com/apache/dolphinscheduler/pull/4166#pullrequestreview-549254440", "createdAt": "2020-12-10T14:32:55Z", "commit": {"oid": "6e9cfcf5d4d180d791d791789a9d926c74fc0c7e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2286, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}