{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1MjQ0NjY5", "number": 4303, "title": "[Feature-#3828][server] Delete recipients and CCs in the process defi\u2026", "bodyText": "Delete recipients and CCs in the process definition and select the associated alert group instead\n\nThe specific alarm instance associated with the alert group\nThe process definition only associates the alert group, and does not care about the specific alarm instance.\nadd sql upgrade script\ndelete alert column(show_type\u3001alert_type\u3001re\u3001cc)\ndelete alertGroup column(alert_type)\ndelete t_ds_process_definition column(receivers\u3001cc) and add column group_warning_id\ndelete t_ds_process_definition_version column(receivers\u3001cc) and add column group_warning_id\ndelete  t_ds_alert columns( show_type,alert_type, receivers, receivers_cc)\n\nthis closes #3828", "createdAt": "2020-12-24T10:04:29Z", "url": "https://github.com/apache/dolphinscheduler/pull/4303", "merged": true, "mergeCommit": {"oid": "14785f4e390e3f2dcbfa223bd33dbc1907f280d3"}, "closed": true, "closedAt": "2020-12-31T02:18:54Z", "author": {"login": "CalvinKirs"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpQzv2AH2gAyNTQ1MjQ0NjY5OjQ0MzUwNDg2NDAxM2RjNGMzN2I5OWRlZDQyNjg4OWI2Mjg3Y2FiOTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdraW7KgFqTU2MDI0ODA1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "443504864013dc4c37b99ded426889b6287cab97", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/443504864013dc4c37b99ded426889b6287cab97", "committedDate": "2020-12-24T10:03:08Z", "message": "[Feature-#3828][server] Delete recipients and CCs in the process definition and select the associated alert group instead\n\n* The specific alarm instance associated with the alert group\n* The process definition only associates the alert group, and does not care about the specific alarm instance.\n\nthis closes #3828"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c21441adbea0f7eb9d3bd2cb5f6cd75f805012b2", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/c21441adbea0f7eb9d3bd2cb5f6cd75f805012b2", "committedDate": "2020-12-24T11:52:03Z", "message": "remove test cc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8ceb18ba15fd1d088707a2d5cb916011ef73f29", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/b8ceb18ba15fd1d088707a2d5cb916011ef73f29", "committedDate": "2020-12-24T15:09:13Z", "message": "remove test cc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a48b17717c39cc81bbc3f422eccc02b5e7f282b", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/2a48b17717c39cc81bbc3f422eccc02b5e7f282b", "committedDate": "2020-12-25T04:53:49Z", "message": "fix test error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df0457f23aabf5ccb7f48bcabccd01bc81c8861e", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/df0457f23aabf5ccb7f48bcabccd01bc81c8861e", "committedDate": "2020-12-26T03:41:13Z", "message": "add sql upgrade script\ndelete alert column(show_type\u3001alert_type\u3001re\u3001cc)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b928e3d182220adc8f3b0fc10f7d13eca33cbdb", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/6b928e3d182220adc8f3b0fc10f7d13eca33cbdb", "committedDate": "2020-12-26T03:45:31Z", "message": "code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a535fc18f85b57c7d6990038eddcd2aa89efed0", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/1a535fc18f85b57c7d6990038eddcd2aa89efed0", "committedDate": "2020-12-26T03:53:26Z", "message": "update test\nNote the statement to delete the column, and provide related instructions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20ee7f3cd7ca8313efda706f47e8a5d0df486651", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/20ee7f3cd7ca8313efda706f47e8a5d0df486651", "committedDate": "2020-12-26T08:28:53Z", "message": "delete AlertGroup field(alert_type)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60bc2ebd320c1736b7ba5ccdb34f6595c85ed775", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/60bc2ebd320c1736b7ba5ccdb34f6595c85ed775", "committedDate": "2020-12-26T08:43:01Z", "message": "fix ut error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4264f59547a70feb1f084b5c49e51b18ffe3e0bf", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/4264f59547a70feb1f084b5c49e51b18ffe3e0bf", "committedDate": "2020-12-26T08:52:53Z", "message": "fix ut error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4048fbf89391a6ea91197ef668b9b87d1bddb5a", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/e4048fbf89391a6ea91197ef668b9b87d1bddb5a", "committedDate": "2020-12-26T09:03:36Z", "message": "fix ut error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8310b651598c2ce6f3a0490b88daad0c948d4aca", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/8310b651598c2ce6f3a0490b88daad0c948d4aca", "committedDate": "2020-12-26T10:28:24Z", "message": "code style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MzUzMTU5", "url": "https://github.com/apache/dolphinscheduler/pull/4303#pullrequestreview-559353159", "createdAt": "2020-12-29T01:56:35Z", "commit": {"oid": "8310b651598c2ce6f3a0490b88daad0c948d4aca"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMTo1NjozNVrOIMFTxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMjowNjo1MlrOIMFZ_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU0MDgwNw==", "bodyText": "Why is there still receivers and receiversCc here ?", "url": "https://github.com/apache/dolphinscheduler/pull/4303#discussion_r549540807", "createdAt": "2020-12-29T01:56:35Z", "author": {"login": "gaojun2048"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/ExecutorController.java", "diffHunk": "@@ -74,20 +90,20 @@\n      */\n     @ApiOperation(value = \"startProcessInstance\", notes = \"RUN_PROCESS_INSTANCE_NOTES\")\n     @ApiImplicitParams({\n-            @ApiImplicitParam(name = \"processDefinitionId\", value = \"PROCESS_DEFINITION_ID\", required = true, dataType = \"Int\", example = \"100\"),\n-            @ApiImplicitParam(name = \"scheduleTime\", value = \"SCHEDULE_TIME\", required = true, dataType = \"String\"),\n-            @ApiImplicitParam(name = \"failureStrategy\", value = \"FAILURE_STRATEGY\", required = true, dataType = \"FailureStrategy\"),\n-            @ApiImplicitParam(name = \"startNodeList\", value = \"START_NODE_LIST\", dataType = \"String\"),\n-            @ApiImplicitParam(name = \"taskDependType\", value = \"TASK_DEPEND_TYPE\", dataType = \"TaskDependType\"),\n-            @ApiImplicitParam(name = \"execType\", value = \"COMMAND_TYPE\", dataType = \"CommandType\"),\n-            @ApiImplicitParam(name = \"warningType\", value = \"WARNING_TYPE\", required = true, dataType = \"WarningType\"),\n-            @ApiImplicitParam(name = \"warningGroupId\", value = \"WARNING_GROUP_ID\", required = true, dataType = \"Int\", example = \"100\"),\n-            @ApiImplicitParam(name = \"receivers\", value = \"RECEIVERS\", dataType = \"String\"),\n-            @ApiImplicitParam(name = \"receiversCc\", value = \"RECEIVERS_CC\", dataType = \"String\"),\n-            @ApiImplicitParam(name = \"runMode\", value = \"RUN_MODE\", dataType = \"RunMode\"),\n-            @ApiImplicitParam(name = \"processInstancePriority\", value = \"PROCESS_INSTANCE_PRIORITY\", required = true, dataType = \"Priority\"),\n-            @ApiImplicitParam(name = \"workerGroup\", value = \"WORKER_GROUP\", dataType = \"String\", example = \"default\"),\n-            @ApiImplicitParam(name = \"timeout\", value = \"TIMEOUT\", dataType = \"Int\", example = \"100\"),\n+        @ApiImplicitParam(name = \"processDefinitionId\", value = \"PROCESS_DEFINITION_ID\", required = true, dataType = \"Int\", example = \"100\"),\n+        @ApiImplicitParam(name = \"scheduleTime\", value = \"SCHEDULE_TIME\", required = true, dataType = \"String\"),\n+        @ApiImplicitParam(name = \"failureStrategy\", value = \"FAILURE_STRATEGY\", required = true, dataType = \"FailureStrategy\"),\n+        @ApiImplicitParam(name = \"startNodeList\", value = \"START_NODE_LIST\", dataType = \"String\"),\n+        @ApiImplicitParam(name = \"taskDependType\", value = \"TASK_DEPEND_TYPE\", dataType = \"TaskDependType\"),\n+        @ApiImplicitParam(name = \"execType\", value = \"COMMAND_TYPE\", dataType = \"CommandType\"),\n+        @ApiImplicitParam(name = \"warningType\", value = \"WARNING_TYPE\", required = true, dataType = \"WarningType\"),\n+        @ApiImplicitParam(name = \"warningGroupId\", value = \"WARNING_GROUP_ID\", required = true, dataType = \"Int\", example = \"100\"),\n+        @ApiImplicitParam(name = \"receivers\", value = \"RECEIVERS\", dataType = \"String\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8310b651598c2ce6f3a0490b88daad0c948d4aca"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU0MTY5Mw==", "bodyText": "I think alert group and user no longer have any relationship in this feature. So this method need be delete.", "url": "https://github.com/apache/dolphinscheduler/pull/4303#discussion_r549541693", "createdAt": "2020-12-29T02:02:42Z", "author": {"login": "gaojun2048"}, "path": "dolphinscheduler-dao/src/main/java/org/apache/dolphinscheduler/dao/AlertDao.java", "diffHunk": "@@ -99,31 +97,31 @@ public int updateAlert(AlertStatus alertStatus, String log, int id) {\n     /**\n      * query user list by alert group id\n      *\n-     * @param alerGroupId alerGroupId\n+     * @param alertGroupId alertGroupId\n      * @return user list\n      */\n-    public List<User> queryUserByAlertGroupId(int alerGroupId) {\n+    public List<User> queryUserByAlertGroupId(int alertGroupId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8310b651598c2ce6f3a0490b88daad0c948d4aca"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU0MTk0MA==", "bodyText": "UserAlertGroupMapper need be delete in this feature.", "url": "https://github.com/apache/dolphinscheduler/pull/4303#discussion_r549541940", "createdAt": "2020-12-29T02:04:23Z", "author": {"login": "gaojun2048"}, "path": "dolphinscheduler-dao/src/main/java/org/apache/dolphinscheduler/dao/AlertDao.java", "diffHunk": "@@ -207,11 +193,11 @@ public void sendTaskTimeoutAlert(int alertgroupId, String receivers, String rece\n     /**\n      * list user information by alert group id\n      *\n-     * @param alertgroupId alertgroupId\n+     * @param alertGroupId alertGroupId\n      * @return user list\n      */\n-    public List<User> listUserByAlertgroupId(int alertgroupId) {\n-        return userAlertGroupMapper.listUserByAlertgroupId(alertgroupId);\n+    public List<User> listUserByAlertGroupId(int alertGroupId) {\n+        return userAlertGroupMapper.listUserByAlertGroupId(alertGroupId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8310b651598c2ce6f3a0490b88daad0c948d4aca"}, "originalPosition": 145}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU0MjM5OA==", "bodyText": "UserAlertGroupMapper is need be delete in this feature.", "url": "https://github.com/apache/dolphinscheduler/pull/4303#discussion_r549542398", "createdAt": "2020-12-29T02:06:52Z", "author": {"login": "gaojun2048"}, "path": "dolphinscheduler-dao/src/main/java/org/apache/dolphinscheduler/dao/mapper/UserAlertGroupMapper.java", "diffHunk": "@@ -30,16 +30,18 @@\n \n     /**\n      * delete user alertgroup relation by alertgroupId\n-     * @param alertgroupId alertgroupId\n+     *\n+     * @param alertGroupId alertGroupId\n      * @return delete result\n      */\n-    int deleteByAlertgroupId(@Param(\"alertgroupId\") int alertgroupId);\n+    int deleteByAlertGroupId(@Param(\"alertgroupId\") int alertGroupId);\n \n     /**\n-     *  list user by alertgroupId\n-     * @param alertgroupId alertgroupId\n+     * list user by alertgroupId\n+     *\n+     * @param alertGroupId alertgroupId\n      * @return user list\n      */\n-    List<User> listUserByAlertgroupId(@Param(\"alertgroupId\") int alertgroupId);\n+    List<User> listUserByAlertGroupId(@Param(\"alertgroupId\") int alertGroupId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8310b651598c2ce6f3a0490b88daad0c948d4aca"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eca4a5655f4a749cfd8461f7e7fde9968c1e5103", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/eca4a5655f4a749cfd8461f7e7fde9968c1e5103", "committedDate": "2020-12-29T02:35:56Z", "message": "delete api-doc receiverCC"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c112f06ac5286639e9076f1c564920bc8b7c077", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/9c112f06ac5286639e9076f1c564920bc8b7c077", "committedDate": "2020-12-29T02:48:21Z", "message": "delete UserAlertGroupMapper"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8dd917f547d093bdd2492fda3ab519b902bf425", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/f8dd917f547d093bdd2492fda3ab519b902bf425", "committedDate": "2020-12-29T03:12:54Z", "message": "delete UserAlertGroup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4385a0f5021d9e0110360c5909d5edbb52e6bfd8", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/4385a0f5021d9e0110360c5909d5edbb52e6bfd8", "committedDate": "2020-12-29T03:29:13Z", "message": "delete UserAlertGroupApi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7189e142114f418808959e1c4ecd99cc001aa132", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/7189e142114f418808959e1c4ecd99cc001aa132", "committedDate": "2020-12-29T04:04:10Z", "message": "alert group add coulmn user_id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "939ea80bd658daf98652035e5dac946d56837d26", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/939ea80bd658daf98652035e5dac946d56837d26", "committedDate": "2020-12-29T06:23:45Z", "message": "alter user_id to create_user_id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "958f802142445e217e05f32b657d215c5420a431", "author": {"user": {"login": "CalvinKirs", "name": "Kirs"}}, "url": "https://github.com/apache/dolphinscheduler/commit/958f802142445e217e05f32b657d215c5420a431", "committedDate": "2020-12-29T06:28:23Z", "message": "userinfo remove alert group info"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwMjQ4MDU0", "url": "https://github.com/apache/dolphinscheduler/pull/4303#pullrequestreview-560248054", "createdAt": "2020-12-31T02:18:33Z", "commit": {"oid": "958f802142445e217e05f32b657d215c5420a431"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2308, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}