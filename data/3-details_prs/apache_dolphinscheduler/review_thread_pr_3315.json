{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2ODY2NjM2", "number": 3315, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMjoyMjoyNFrOESXQAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1NDowOFrOETOCIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjkwNzUyOnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/ProcessInstanceController.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMjoyMjoyNFrOG3gF_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMjoyMjoyNFrOG3gF_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg1MDY4Ng==", "bodyText": "You should improve the handleEscapes method, this is a historical problem.  like this:return inputString.replace(\"%\", \"////%\").replaceAll(\"[\\n|\\r|\\t]\", \"_\");", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r460850686", "createdAt": "2020-07-27T12:22:24Z", "author": {"login": "CalvinKirs"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/ProcessInstanceController.java", "diffHunk": "@@ -204,6 +205,29 @@ public Result queryProcessInstanceById(@ApiIgnore @RequestAttribute(value = Cons\n         return returnDataList(result);\n     }\n \n+    @ApiOperation(value = \"queryTopNLongestRunningProcessInstance\", notes = \"QUERY_TOPN_LONGEST_RUNNING_PROCESS_INSTANCE_NOTES\")\n+    @ApiImplicitParams({\n+            @ApiImplicitParam(name = \"size\", value = \"PROCESS_INSTANCE_SIZE\", dataType = \"Int\", example = \"10\"),\n+            @ApiImplicitParam(name = \"startTime\", value = \"PROCESS_INSTANCE_START_TIME\", dataType = \"String\"),\n+            @ApiImplicitParam(name = \"endTime\", value = \"PROCESS_INSTANCE_END_TIME\", dataType = \"String\"),\n+    })\n+    @GetMapping(value = \"/top-n\")\n+    @ResponseStatus(HttpStatus.OK)\n+    @ApiException(QUERY_PROCESS_INSTANCE_BY_ID_ERROR)\n+    public Result<ProcessInstance> queryTopNLongestRunningProcessInstance(@ApiIgnore @RequestAttribute(value = Constants.SESSION_USER) User loginUser,\n+                                                         @ApiParam(name = \"projectName\", value = \"PROJECT_NAME\", required = true) @PathVariable String projectName,\n+                                                         @RequestParam(\"size\") Integer size,\n+                                                         @RequestParam(value = \"startTime\",required = true) String startTime,\n+                                                         @RequestParam(value = \"endTime\",required = true) String endTime\n+\n+    ){\n+        projectName=projectName.replaceAll(\"[\\n|\\r\\t]\", \"_\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "333add157d16d5667d0d7298091a25f2a24f2d84"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTg2NDUyOnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/ProcessInstanceController.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo0ODo1MlrOG400Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMjoxNjozNVrOG41tfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIzODcyMg==", "bodyText": "Hi,\nIt will be better to add the java docs like[1] here. can you do it?\n[1]", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462238722", "createdAt": "2020-07-29T11:48:52Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/ProcessInstanceController.java", "diffHunk": "@@ -204,6 +205,29 @@ public Result queryProcessInstanceById(@ApiIgnore @RequestAttribute(value = Cons\n         return returnDataList(result);\n     }\n \n+    @ApiOperation(value = \"queryTopNLongestRunningProcessInstance\", notes = \"QUERY_TOPN_LONGEST_RUNNING_PROCESS_INSTANCE_NOTES\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI1MzQzNg==", "bodyText": "ok , I will do it in next commit", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462253436", "createdAt": "2020-07-29T12:16:35Z", "author": {"login": "RedemptionC"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/ProcessInstanceController.java", "diffHunk": "@@ -204,6 +205,29 @@ public Result queryProcessInstanceById(@ApiIgnore @RequestAttribute(value = Cons\n         return returnDataList(result);\n     }\n \n+    @ApiOperation(value = \"queryTopNLongestRunningProcessInstance\", notes = \"QUERY_TOPN_LONGEST_RUNNING_PROCESS_INSTANCE_NOTES\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjIzODcyMg=="}, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTg3NDI0OnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ProcessInstanceService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1MTozNVrOG405qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1MTozNVrOG405qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI0MDE3MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Date end=DateUtils.stringToDate(endTime);\n          \n          \n            \n                    Date end = DateUtils.stringToDate(endTime);", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462240170", "createdAt": "2020-07-29T11:51:35Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ProcessInstanceService.java", "diffHunk": "@@ -98,6 +98,53 @@\n     @Autowired\n     UsersService usersService;\n \n+    /**\n+     * return top n SUCCESS process instance order by running time which started between startTime and endTime\n+     * @param loginUser\n+     * @param projectName\n+     * @param size\n+     * @param startTime\n+     * @param endTime\n+     * @return\n+     */\n+    public Map<String, Object> queryTopNLongestRunningProcessInstance(User loginUser,String projectName,int size, String startTime, String endTime) {\n+        Map<String, Object> result = new HashMap<>();\n+\n+        Project project = projectMapper.queryByName(projectName);\n+        Map<String, Object> checkResult = projectService.checkProjectAndAuth(loginUser, project, projectName);\n+        Status resultEnum = (Status) checkResult.get(Constants.STATUS);\n+        if (resultEnum != Status.SUCCESS) {\n+            return checkResult;\n+        }\n+\n+        if (0 > size) {\n+            putMsg(result, Status.NEGTIVE_SIZE_NUMBER_ERROR, size);\n+            return result;\n+        }\n+        if (Objects.isNull(startTime)) {\n+            putMsg(result, Status.DATA_IS_NULL, Constants.START_TIME);\n+            return result;\n+        }\n+        Date start=DateUtils.stringToDate(startTime);\n+        if (Objects.isNull(endTime)) {\n+            putMsg(result, Status.DATA_IS_NULL, Constants.END_TIME);\n+            return result;\n+        }\n+        Date end=DateUtils.stringToDate(endTime);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTg3NTIwOnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ProcessInstanceService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1MTo1MVrOG406Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1MTo1MVrOG406Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI0MDMwNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Date start=DateUtils.stringToDate(startTime);\n          \n          \n            \n                    Date start = DateUtils.stringToDate(startTime);", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462240307", "createdAt": "2020-07-29T11:51:51Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ProcessInstanceService.java", "diffHunk": "@@ -98,6 +98,53 @@\n     @Autowired\n     UsersService usersService;\n \n+    /**\n+     * return top n SUCCESS process instance order by running time which started between startTime and endTime\n+     * @param loginUser\n+     * @param projectName\n+     * @param size\n+     * @param startTime\n+     * @param endTime\n+     * @return\n+     */\n+    public Map<String, Object> queryTopNLongestRunningProcessInstance(User loginUser,String projectName,int size, String startTime, String endTime) {\n+        Map<String, Object> result = new HashMap<>();\n+\n+        Project project = projectMapper.queryByName(projectName);\n+        Map<String, Object> checkResult = projectService.checkProjectAndAuth(loginUser, project, projectName);\n+        Status resultEnum = (Status) checkResult.get(Constants.STATUS);\n+        if (resultEnum != Status.SUCCESS) {\n+            return checkResult;\n+        }\n+\n+        if (0 > size) {\n+            putMsg(result, Status.NEGTIVE_SIZE_NUMBER_ERROR, size);\n+            return result;\n+        }\n+        if (Objects.isNull(startTime)) {\n+            putMsg(result, Status.DATA_IS_NULL, Constants.START_TIME);\n+            return result;\n+        }\n+        Date start=DateUtils.stringToDate(startTime);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTg3NTk4OnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ProcessInstanceService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1MjowOFrOG406sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1MjowOFrOG406sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI0MDQzNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public Map<String, Object> queryTopNLongestRunningProcessInstance(User loginUser,String projectName,int size, String startTime, String endTime) {\n          \n          \n            \n                public Map<String, Object> queryTopNLongestRunningProcessInstance(User loginUser, String projectName, int size, String startTime, String endTime) {", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462240435", "createdAt": "2020-07-29T11:52:08Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ProcessInstanceService.java", "diffHunk": "@@ -98,6 +98,53 @@\n     @Autowired\n     UsersService usersService;\n \n+    /**\n+     * return top n SUCCESS process instance order by running time which started between startTime and endTime\n+     * @param loginUser\n+     * @param projectName\n+     * @param size\n+     * @param startTime\n+     * @param endTime\n+     * @return\n+     */\n+    public Map<String, Object> queryTopNLongestRunningProcessInstance(User loginUser,String projectName,int size, String startTime, String endTime) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTg3Nzc2OnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/Constants.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1Mjo0MFrOG4070Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1Mjo0MFrOG4070Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI0MDcyMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public static final String START_TIME=\"start time\";\n          \n          \n            \n                public static final String END_TIME=\"end time\";\n          \n          \n            \n                public static final String START_TIME = \"start time\";\n          \n          \n            \n                public static final String END_TIME = \"end time\";", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462240721", "createdAt": "2020-07-29T11:52:40Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/Constants.java", "diffHunk": "@@ -978,6 +978,8 @@ private Constants() {\n     public static final int NORAML_NODE_STATUS = 0;\n     public static final int ABNORMAL_NODE_STATUS = 1;\n \n+    public static final String START_TIME=\"start time\";\n+    public static final String END_TIME=\"end time\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTg4MTA2OnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-api/src/test/java/org/apache/dolphinscheduler/api/service/ProcessInstanceServiceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1MzozOFrOG409pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1MzozOFrOG409pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI0MTE5MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void testQueryTopNLongestRunningProcessInstance(){\n          \n          \n            \n                public void testQueryTopNLongestRunningProcessInstance() {", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462241191", "createdAt": "2020-07-29T11:53:38Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-api/src/test/java/org/apache/dolphinscheduler/api/service/ProcessInstanceServiceTest.java", "diffHunk": "@@ -147,6 +147,40 @@ public void testQueryProcessInstanceList() {\n \n     }\n \n+    @Test\n+    public void testQueryTopNLongestRunningProcessInstance(){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTg4MTY2OnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ProcessInstanceService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1Mzo0NlrOG40-Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1Mzo0NlrOG40-Cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI0MTI5MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(start == null || end == null){\n          \n          \n            \n                    if(start == null || end == null) {", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462241290", "createdAt": "2020-07-29T11:53:46Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ProcessInstanceService.java", "diffHunk": "@@ -98,6 +98,53 @@\n     @Autowired\n     UsersService usersService;\n \n+    /**\n+     * return top n SUCCESS process instance order by running time which started between startTime and endTime\n+     * @param loginUser\n+     * @param projectName\n+     * @param size\n+     * @param startTime\n+     * @param endTime\n+     * @return\n+     */\n+    public Map<String, Object> queryTopNLongestRunningProcessInstance(User loginUser,String projectName,int size, String startTime, String endTime) {\n+        Map<String, Object> result = new HashMap<>();\n+\n+        Project project = projectMapper.queryByName(projectName);\n+        Map<String, Object> checkResult = projectService.checkProjectAndAuth(loginUser, project, projectName);\n+        Status resultEnum = (Status) checkResult.get(Constants.STATUS);\n+        if (resultEnum != Status.SUCCESS) {\n+            return checkResult;\n+        }\n+\n+        if (0 > size) {\n+            putMsg(result, Status.NEGTIVE_SIZE_NUMBER_ERROR, size);\n+            return result;\n+        }\n+        if (Objects.isNull(startTime)) {\n+            putMsg(result, Status.DATA_IS_NULL, Constants.START_TIME);\n+            return result;\n+        }\n+        Date start=DateUtils.stringToDate(startTime);\n+        if (Objects.isNull(endTime)) {\n+            putMsg(result, Status.DATA_IS_NULL, Constants.END_TIME);\n+            return result;\n+        }\n+        Date end=DateUtils.stringToDate(endTime);\n+        if(start == null || end == null){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4NTg4MzIxOnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/ProcessInstanceController.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1NDowOVrOG40-2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxMTo1NDowOVrOG40-2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI0MTQ5OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                ){\n          \n          \n            \n                ) {", "url": "https://github.com/apache/dolphinscheduler/pull/3315#discussion_r462241499", "createdAt": "2020-07-29T11:54:09Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/ProcessInstanceController.java", "diffHunk": "@@ -204,6 +205,29 @@ public Result queryProcessInstanceById(@ApiIgnore @RequestAttribute(value = Cons\n         return returnDataList(result);\n     }\n \n+    @ApiOperation(value = \"queryTopNLongestRunningProcessInstance\", notes = \"QUERY_TOPN_LONGEST_RUNNING_PROCESS_INSTANCE_NOTES\")\n+    @ApiImplicitParams({\n+            @ApiImplicitParam(name = \"size\", value = \"PROCESS_INSTANCE_SIZE\", dataType = \"Int\", example = \"10\"),\n+            @ApiImplicitParam(name = \"startTime\", value = \"PROCESS_INSTANCE_START_TIME\", dataType = \"String\"),\n+            @ApiImplicitParam(name = \"endTime\", value = \"PROCESS_INSTANCE_END_TIME\", dataType = \"String\"),\n+    })\n+    @GetMapping(value = \"/top-n\")\n+    @ResponseStatus(HttpStatus.OK)\n+    @ApiException(QUERY_PROCESS_INSTANCE_BY_ID_ERROR)\n+    public Result<ProcessInstance> queryTopNLongestRunningProcessInstance(@ApiIgnore @RequestAttribute(value = Constants.SESSION_USER) User loginUser,\n+                                                         @ApiParam(name = \"projectName\", value = \"PROJECT_NAME\", required = true) @PathVariable String projectName,\n+                                                         @RequestParam(\"size\") Integer size,\n+                                                         @RequestParam(value = \"startTime\",required = true) String startTime,\n+                                                         @RequestParam(value = \"endTime\",required = true) String endTime\n+\n+    ){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5d0557bf30ee757e0c259a4aedc650ac37f4fd4"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3366, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}