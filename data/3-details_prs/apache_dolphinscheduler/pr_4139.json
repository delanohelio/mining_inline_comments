{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwMjI1NTk2", "number": 4139, "title": "[Feature-4138][Master] dispatch workgroup error add sleep time", "bodyText": "this close #4138\nIf the task group cannot be found when running a task, a large number of logs will be output\n\nIt is suggested to add sleep operation\nWhen there are tasks with assignment failure and the number of tasks in the current task queue is less than 10, sleep for 1 second\n\u5982\u679c\u8fd0\u884c\u4efb\u52a1\u7684\u65f6\u5019,\u4efb\u52a1\u7684\u5206\u7ec4\u627e\u4e0d\u5230,\u4f1a\u8f93\u51fa\u5927\u91cf\u7684\u65e5\u5fd7. cpu\u4f1a\u98d9\u5347\n\n\u5efa\u8bae\u589e\u52a0\u4f11\u7720\u64cd\u4f5c:\n\u5f53\u5b58\u5728\u5206\u914d\u5931\u8d25\u7684\u4efb\u52a1 , \u5e76\u4e14\u5f53\u524d\u4efb\u52a1\u961f\u5217[taskPriorityQueue]\u4e2d\u7684\u4efb\u52a1\u6570\u91cf\u5c0f\u4e8e10, \u4f11\u77201\u79d2.", "createdAt": "2020-12-01T11:12:28Z", "url": "https://github.com/apache/dolphinscheduler/pull/4139", "merged": true, "mergeCommit": {"oid": "b3120a74d2656f7ad2054ba8245262551063b549"}, "closed": true, "closedAt": "2020-12-11T07:35:40Z", "author": {"login": "BoYiZhang"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgkW6KgH2gAyNTMwMjI1NTk2Ojk2YjBhMzkzMTE2NGY1MjY1MTQwZDkzMTdiZjg4ZmZlZThiODViYTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdlC5m7AFqTU0OTg1ODQ1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "96b0a3931164f5265140d9317bf88ffee8b85ba1", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/96b0a3931164f5265140d9317bf88ffee8b85ba1", "committedDate": "2020-11-27T09:44:25Z", "message": "Merge pull request #25 from apache/dev\n\nupdate code from apache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "709c6c8b924bad932c726558bfe61420ed65a60e", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/709c6c8b924bad932c726558bfe61420ed65a60e", "committedDate": "2020-12-01T10:45:10Z", "message": "Merge pull request #26 from apache/dev\n\nupdate code from apache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc94cfd2fd303e72e2bda133200a811d22a9deed", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/fc94cfd2fd303e72e2bda133200a811d22a9deed", "committedDate": "2020-12-01T11:09:15Z", "message": "When there are tasks with assignment failure and the number of tasks in the current task queue is less than 10, sleep for 1 second"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "120b29d1d27d9584fa5a5d61ec213c82552cebd4", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/120b29d1d27d9584fa5a5d61ec213c82552cebd4", "committedDate": "2020-12-09T04:51:36Z", "message": "When there are tasks with assignment failure and the number of tasks in the current task queue is less than 10, sleep for 1 second"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f48373cc49312c5686fa948908732c7b22609449", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/f48373cc49312c5686fa948908732c7b22609449", "committedDate": "2020-12-09T05:14:13Z", "message": "fix code smell & code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e308595bc0c42f2f14bdf0f4bd73dd139f88117f", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/e308595bc0c42f2f14bdf0f4bd73dd139f88117f", "committedDate": "2020-12-09T05:17:49Z", "message": "fix code smell & code style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3OTM0NjQz", "url": "https://github.com/apache/dolphinscheduler/pull/4139#pullrequestreview-547934643", "createdAt": "2020-12-09T08:18:17Z", "commit": {"oid": "e308595bc0c42f2f14bdf0f4bd73dd139f88117f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwODoxODoxN1rOICH4kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwODoxODoxN1rOICH4kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTA5NzIzNQ==", "bodyText": "\"taskPriorityQueue.size() <= failedDispatchTasks.size()\" is better.", "url": "https://github.com/apache/dolphinscheduler/pull/4139#discussion_r539097235", "createdAt": "2020-12-09T08:18:17Z", "author": {"login": "lenboo"}, "path": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/consumer/TaskPriorityQueueConsumer.java", "diffHunk": "@@ -139,7 +140,13 @@ public void run() {\n                 for (String dispatchFailedTask : failedDispatchTasks) {\n                     taskPriorityQueue.put(dispatchFailedTask);\n                 }\n+                // If there are tasks in a cycle that cannot find the worker group,\n+                // sleep for 1 second\n+                if (!failedDispatchTasks.isEmpty()  && taskPriorityQueue.size() <= fetchTaskNum) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e308595bc0c42f2f14bdf0f4bd73dd139f88117f"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d633a7232ecfd24d061c052c5f89fe4c7d64ab33", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/d633a7232ecfd24d061c052c5f89fe4c7d64ab33", "committedDate": "2020-12-09T09:47:35Z", "message": "fix code smell"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d9979ddadcbd71d9332cea5520af41e3e0eea9d", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/9d9979ddadcbd71d9332cea5520af41e3e0eea9d", "committedDate": "2020-12-09T10:16:15Z", "message": "fix code smell"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c72d9d4b2b98601b2eaca857a2d99699a3f51141", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/c72d9d4b2b98601b2eaca857a2d99699a3f51141", "committedDate": "2020-12-09T13:32:50Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0deef66f44ad2148b3c1f7d3de020ce35c7ff67c", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/0deef66f44ad2148b3c1f7d3de020ce35c7ff67c", "committedDate": "2020-12-09T15:30:52Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b806cb56dabc382b218c3c656a6f265088b085b", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/5b806cb56dabc382b218c3c656a6f265088b085b", "committedDate": "2020-12-09T17:22:33Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b432dc4067086daef1c95f67052a8ea6eeec9cc", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/8b432dc4067086daef1c95f67052a8ea6eeec9cc", "committedDate": "2020-12-09T17:52:41Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41d08c27e10799e2bff9524dbd0e7f8e6e725e99", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/41d08c27e10799e2bff9524dbd0e7f8e6e725e99", "committedDate": "2020-12-09T17:56:34Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc830737737ba8c906f1485df4f270723f2b82a4", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/fc830737737ba8c906f1485df4f270723f2b82a4", "committedDate": "2020-12-09T18:11:53Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ca1e5cc6fe170ad0cada790fde6e0b9c66d5936", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/4ca1e5cc6fe170ad0cada790fde6e0b9c66d5936", "committedDate": "2020-12-09T18:45:46Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9658641abeebed5abd4488d709030718ff9f6a7", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/a9658641abeebed5abd4488d709030718ff9f6a7", "committedDate": "2020-12-09T18:46:42Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86ba5a5acd02e35a7bd8177d175ba235545f030d", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/86ba5a5acd02e35a7bd8177d175ba235545f030d", "committedDate": "2020-12-10T01:09:42Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4c6df57f9420b4118596e4a70a6897e363a2cc6", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/e4c6df57f9420b4118596e4a70a6897e363a2cc6", "committedDate": "2020-12-10T01:14:05Z", "message": "update ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "971d193dca6348ddfc84cac6d34500952c0ce75f", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/971d193dca6348ddfc84cac6d34500952c0ce75f", "committedDate": "2020-12-10T10:42:12Z", "message": "update rule"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "720c2e89bc348c08f29db75af3ef80d6cba67576", "author": {"user": {"login": "BoYiZhang", "name": null}}, "url": "https://github.com/apache/dolphinscheduler/commit/720c2e89bc348c08f29db75af3ef80d6cba67576", "committedDate": "2020-12-11T06:59:16Z", "message": "update rule"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5ODQ1OTkz", "url": "https://github.com/apache/dolphinscheduler/pull/4139#pullrequestreview-549845993", "createdAt": "2020-12-11T07:07:09Z", "commit": {"oid": "720c2e89bc348c08f29db75af3ef80d6cba67576"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5ODU4NDU3", "url": "https://github.com/apache/dolphinscheduler/pull/4139#pullrequestreview-549858457", "createdAt": "2020-12-11T07:35:10Z", "commit": {"oid": "720c2e89bc348c08f29db75af3ef80d6cba67576"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2272, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}