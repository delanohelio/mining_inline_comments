{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1MzgyMzI2", "number": 3940, "title": "[Improvement-3933][db operation] Improve the performance of sql query", "bodyText": "optimize mybatis dynamic sql", "createdAt": "2020-10-18T03:17:39Z", "url": "https://github.com/apache/dolphinscheduler/pull/3940", "merged": true, "mergeCommit": {"oid": "bd156b312da566bb474431caeedf073dfd4b26a4"}, "closed": true, "closedAt": "2020-11-28T13:41:01Z", "author": {"login": "hermeshephaestus"}, "timelineItems": {"totalCount": 33, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdTmzDQgH2gAyNTA1MzgyMzI2OjViYzBmNDU1NzRjYTlhMDY2ZjM0MjcyNDQ1ZWE2ZTUyNDEwOTdlNGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmUclkgFqTU1MjE0Mjg5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5bc0f45574ca9a066f34272445ea6e5241097e4a", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/5bc0f45574ca9a066f34272445ea6e5241097e4a", "committedDate": "2020-10-18T03:13:57Z", "message": "optimize select * case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61db5bdc672e175a7dee8516c43dfc15ba44890b", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/61db5bdc672e175a7dee8516c43dfc15ba44890b", "committedDate": "2020-10-18T03:22:02Z", "message": "emove redundancy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fd1039260abba1ec40a5483459b31ceed4ce053", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/2fd1039260abba1ec40a5483459b31ceed4ce053", "committedDate": "2020-10-18T03:29:58Z", "message": "optimize select * case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExMDM0ODA2", "url": "https://github.com/apache/dolphinscheduler/pull/3940#pullrequestreview-511034806", "createdAt": "2020-10-18T05:31:44Z", "commit": {"oid": "2fd1039260abba1ec40a5483459b31ceed4ce053"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQwNTozMTo0NFrOHjiA_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQwNTozMTo0NFrOHjiA_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAxOTUxNw==", "bodyText": "why remove\uff1f", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r507019517", "createdAt": "2020-10-18T05:31:44Z", "author": {"login": "zhuangchong"}, "path": "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/tenement/_source/createTenement.vue", "diffHunk": "@@ -146,13 +146,6 @@\n           this.$message.warning(`${i18n.$t('Please enter name')}`)\n           return false\n         }\n-        // Verify tenant name cannot contain special characters\n-        let isSpecial = /[~#^$@%&!*()<>\u300a\u300b:;'\"{}\u3010\u3011\t]/gi\n-        if (isSpecial.test(this.tenantName)) {\n-          this.$message.warning(`${i18n.$t('Please enter tenant name without special characters')}`)\n-          return false\n-        }\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fd1039260abba1ec40a5483459b31ceed4ce053"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExMDM0ODQy", "url": "https://github.com/apache/dolphinscheduler/pull/3940#pullrequestreview-511034842", "createdAt": "2020-10-18T05:32:32Z", "commit": {"oid": "2fd1039260abba1ec40a5483459b31ceed4ce053"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQwNTozMjozMlrOHjiBQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQwNTozMjozMlrOHjiBQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzAxOTU4NQ==", "bodyText": "why remove?", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r507019585", "createdAt": "2020-10-18T05:32:32Z", "author": {"login": "zhuangchong"}, "path": "dolphinscheduler-ui/src/js/module/i18n/locale/zh_CN.js", "diffHunk": "@@ -189,7 +189,6 @@ export default {\n   Queue: 'Yarn \u961f\u5217',\n   'Please enter the tenant code in English': '\u8bf7\u8f93\u5165\u79df\u6237\u7f16\u7801\u53ea\u5141\u8bb8\u82f1\u6587',\n   'Please enter tenant code in English': '\u8bf7\u8f93\u5165\u82f1\u6587\u79df\u6237\u7f16\u7801',\n-  'Please enter tenant name without special characters': '\u8bf7\u8f93\u5165\u4e0d\u5305\u542b\u7279\u6b8a\u5b57\u7b26\u7684\u79df\u6237\u540d\u79f0',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fd1039260abba1ec40a5483459b31ceed4ce053"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2f7a4e62173b6a965defc19d86a73af18d43fe5", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/c2f7a4e62173b6a965defc19d86a73af18d43fe5", "committedDate": "2020-10-18T13:21:30Z", "message": "bug fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExMzY3OTM3", "url": "https://github.com/apache/dolphinscheduler/pull/3940#pullrequestreview-511367937", "createdAt": "2020-10-19T01:57:15Z", "commit": {"oid": "c2f7a4e62173b6a965defc19d86a73af18d43fe5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwMTo1NzoxNVrOHj10nA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwMTo1NzoxNVrOHj10nA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzM0NDAyOA==", "bodyText": "This file modification should have nothing to do with this PR.", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r507344028", "createdAt": "2020-10-19T01:57:15Z", "author": {"login": "zhuangchong"}, "path": "dolphinscheduler-ui/src/js/module/i18n/locale/en_US.js", "diffHunk": "@@ -187,7 +187,6 @@ export default {\n   'Please select a queue': 'default is tenant association queue',\n   'Please enter the tenant code in English': 'Please enter the tenant code in English',\n   'Please enter tenant code in English': 'Please enter tenant code in English',\n-  'Please enter tenant name without special characters': 'Please enter tenant name without special characters',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2f7a4e62173b6a965defc19d86a73af18d43fe5"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99490ea86f13af205052621b9a2c7be753796c23", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/99490ea86f13af205052621b9a2c7be753796c23", "committedDate": "2020-10-24T08:12:46Z", "message": "Update en_US.js"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6228d090729d2a9ab199e1db13b3945f00db2e30", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/6228d090729d2a9ab199e1db13b3945f00db2e30", "committedDate": "2020-10-24T08:14:23Z", "message": "Update startup.sh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5fa8e9467cbfa9a91507560cddd5f7c71183af6", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/c5fa8e9467cbfa9a91507560cddd5f7c71183af6", "committedDate": "2020-10-27T00:35:56Z", "message": "optimize"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c280ba61dbbafab3fc88db2e7ab586d0b5b9494", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/8c280ba61dbbafab3fc88db2e7ab586d0b5b9494", "committedDate": "2020-10-27T00:36:04Z", "message": "Merge branch 'dev' of github.com:hermeshephaestus/incubator-dolphinscheduler into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "803ab3331cc3ce52f51d36f03d8bd349513881fa", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/803ab3331cc3ce52f51d36f03d8bd349513881fa", "committedDate": "2020-10-28T05:23:19Z", "message": "Merge remote-tracking branch 'upstream/dev' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba7363de918c7322e5ff7679847df5faa90145ee", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/ba7363de918c7322e5ff7679847df5faa90145ee", "committedDate": "2020-10-28T16:50:19Z", "message": "optimize code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60db7c90b542eb99846ef9ce5d18899db41d113e", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/60db7c90b542eb99846ef9ce5d18899db41d113e", "committedDate": "2020-10-29T01:59:29Z", "message": "optimize"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6316a715c14d5858a91f7646790efa7266a3487d", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/6316a715c14d5858a91f7646790efa7266a3487d", "committedDate": "2020-11-21T08:06:14Z", "message": "Merge branch 'dev' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e48a1bab0d4a014277ceab7404b2d9babc93b880", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/e48a1bab0d4a014277ceab7404b2d9babc93b880", "committedDate": "2020-11-21T08:14:53Z", "message": "bug fxied"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46a12484228afb1a2f17ab38f8e77c3d566dfe1a", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/46a12484228afb1a2f17ab38f8e77c3d566dfe1a", "committedDate": "2020-11-21T08:16:32Z", "message": "resolve conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54f1649e94ca4e77742c8f15f165167d29e689ad", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/54f1649e94ca4e77742c8f15f165167d29e689ad", "committedDate": "2020-11-21T08:40:25Z", "message": "bug fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "920f67d8b7507349f7cdd3ded4a6976d281dfb85", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/920f67d8b7507349f7cdd3ded4a6976d281dfb85", "committedDate": "2020-11-23T03:11:08Z", "message": "add ut"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9783aca6f35169ca0ee7d263c73c3ec709e636e", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/b9783aca6f35169ca0ee7d263c73c3ec709e636e", "committedDate": "2020-11-23T03:26:09Z", "message": "bug fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc4d84b8e70fc33f90f7bdc9823516700eb46431", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/cc4d84b8e70fc33f90f7bdc9823516700eb46431", "committedDate": "2020-11-23T04:02:47Z", "message": "bug fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05c69ca5ccfcadd4df0a8ce177a1ff477251a4ab", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/05c69ca5ccfcadd4df0a8ce177a1ff477251a4ab", "committedDate": "2020-11-23T04:03:38Z", "message": "bug fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c6e999879647899eb3a982a25785054312d79bd", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/3c6e999879647899eb3a982a25785054312d79bd", "committedDate": "2020-11-23T11:11:23Z", "message": "bug fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5ODU4MDE2", "url": "https://github.com/apache/dolphinscheduler/pull/3940#pullrequestreview-539858016", "createdAt": "2020-11-27T10:12:18Z", "commit": {"oid": "3c6e999879647899eb3a982a25785054312d79bd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5ODY2NDE4", "url": "https://github.com/apache/dolphinscheduler/pull/3940#pullrequestreview-539866418", "createdAt": "2020-11-27T10:24:27Z", "commit": {"oid": "3c6e999879647899eb3a982a25785054312d79bd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMDoyNDoyN1rOH643kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMDoyNTo0M1rOH646Zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUxMTE4Nw==", "bodyText": "Should keep the original format.", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r531511187", "createdAt": "2020-11-27T10:24:27Z", "author": {"login": "wen-hemin"}, "path": "dolphinscheduler-dao/src/main/resources/org/apache/dolphinscheduler/dao/mapper/WorkFlowLineageMapper.xml", "diffHunk": "@@ -24,23 +24,24 @@\n         left join t_ds_schedules tes on tepd.id = tes.process_definition_id\n         where tepd.project_id = #{projectId}\n         <if test=\"searchVal != null and searchVal != ''\">\n-            and  tepd.name like concat('%', #{searchVal}, '%')\n+            and tepd.name like concat('%', #{searchVal}, '%')\n         </if>\n     </select>\n     <select id=\"queryByIds\" resultType=\"org.apache.dolphinscheduler.dao.entity.WorkFlowLineage\" databaseId=\"mysql\">\n         select tepd.id as work_flow_id,tepd.name as work_flow_name,\n-               (case when json_extract(tepd.process_definition_json, '$**.dependItemList') is not null then 1 else 0 end) as is_depend_work_flow,\n-                          json_extract(tepd.process_definition_json, '$**.definitionId') as source_work_flow_id,\n-                          tepd.release_state as work_flow_publish_status,\n-                          tes.start_time as schedule_start_time,\n-                          tes.end_time as schedule_end_time,\n-                          tes.crontab as crontab,\n-                          tes.release_state as schedule_publish_status\n+        (case when json_extract(tepd.process_definition_json, '$**.dependItemList') is not null then 1 else 0 end) as", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c6e999879647899eb3a982a25785054312d79bd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUxMTQ0MQ==", "bodyText": "Should keep the original format.", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r531511441", "createdAt": "2020-11-27T10:24:56Z", "author": {"login": "wen-hemin"}, "path": "dolphinscheduler-dao/src/main/resources/org/apache/dolphinscheduler/dao/mapper/WorkFlowLineageMapper.xml", "diffHunk": "@@ -24,23 +24,24 @@\n         left join t_ds_schedules tes on tepd.id = tes.process_definition_id\n         where tepd.project_id = #{projectId}\n         <if test=\"searchVal != null and searchVal != ''\">\n-            and  tepd.name like concat('%', #{searchVal}, '%')\n+            and tepd.name like concat('%', #{searchVal}, '%')\n         </if>\n     </select>\n     <select id=\"queryByIds\" resultType=\"org.apache.dolphinscheduler.dao.entity.WorkFlowLineage\" databaseId=\"mysql\">\n         select tepd.id as work_flow_id,tepd.name as work_flow_name,\n-               (case when json_extract(tepd.process_definition_json, '$**.dependItemList') is not null then 1 else 0 end) as is_depend_work_flow,\n-                          json_extract(tepd.process_definition_json, '$**.definitionId') as source_work_flow_id,\n-                          tepd.release_state as work_flow_publish_status,\n-                          tes.start_time as schedule_start_time,\n-                          tes.end_time as schedule_end_time,\n-                          tes.crontab as crontab,\n-                          tes.release_state as schedule_publish_status\n+        (case when json_extract(tepd.process_definition_json, '$**.dependItemList') is not null then 1 else 0 end) as\n+        is_depend_work_flow,\n+        json_extract(tepd.process_definition_json, '$**.definitionId') as source_work_flow_id,\n+        tepd.release_state as work_flow_publish_status,\n+        tes.start_time as schedule_start_time,\n+        tes.end_time as schedule_end_time,\n+        tes.crontab as crontab,\n+        tes.release_state as schedule_publish_status", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c6e999879647899eb3a982a25785054312d79bd"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUxMTUyMg==", "bodyText": "Should keep the original format.", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r531511522", "createdAt": "2020-11-27T10:25:05Z", "author": {"login": "wen-hemin"}, "path": "dolphinscheduler-dao/src/main/resources/org/apache/dolphinscheduler/dao/mapper/WorkFlowLineageMapper.xml", "diffHunk": "@@ -49,39 +50,42 @@\n \n     <select id=\"queryByIds\" resultType=\"org.apache.dolphinscheduler.dao.entity.WorkFlowLineage\" databaseId=\"pg\">\n         select a.work_flow_id,\n-               a.work_flow_name,\n-               a.is_depend_work_flow,\n-               array_agg(a.source_id) as source_id,\n-               a.work_flow_publish_status,\n-               a.schedule_start_time,\n-               a.schedule_end_time,\n-               a.crontab,\n-               a.schedule_publish_status\n-         from (\n-               select tepd.id as work_flow_id,tepd.name as work_flow_name,\n-                      case when tepd.process_definition_json::json#>'{tasks,1,dependence}' is not null then 1 else 0 end as is_depend_work_flow,\n-                      (json_array_elements(tepd.process_definition_json::json#>'{tasks}')#>>'{dependence,dependTaskList,0,dependItemList,0,definitionId}') as source_id,\n-                      tepd.release_state as work_flow_publish_status,\n-                      tes.start_time as schedule_start_time,\n-                      tes.end_time as schedule_end_time,\n-                      tes.crontab as crontab,\n-                      tes.release_state as schedule_publish_status\n-                 from t_ds_process_definition tepd\n-                 left join t_ds_schedules tes on tepd.id = tes.process_definition_id\n-                 where tepd.project_id = #{projectId}\n-                 <if test=\"ids != null and ids.size()>0\">\n-                     and  tepd.id in\n-                     <foreach collection=\"ids\" index=\"index\" item=\"i\" open=\"(\" separator=\",\" close=\")\">\n-                     #{i}\n-                     </foreach>\n-                </if>\n-             ) a\n+        a.work_flow_name,\n+        a.is_depend_work_flow,\n+        array_agg(a.source_id) as source_id,\n+        a.work_flow_publish_status,\n+        a.schedule_start_time,\n+        a.schedule_end_time,\n+        a.crontab,\n+        a.schedule_publish_status\n+        from (\n+        select tepd.id as work_flow_id,tepd.name as work_flow_name,\n+        case when tepd.process_definition_json::json#>'{tasks,1,dependence}' is not null then 1 else 0 end as\n+        is_depend_work_flow,\n+        (json_array_elements(tepd.process_definition_json::json#>'{tasks}')#>>'{dependence,dependTaskList,0,dependItemList,0,definitionId}')\n+        as source_id,\n+        tepd.release_state as work_flow_publish_status,\n+        tes.start_time as schedule_start_time,\n+        tes.end_time as schedule_end_time,\n+        tes.crontab as crontab,\n+        tes.release_state as schedule_publish_status\n+        from t_ds_process_definition tepd\n+        left join t_ds_schedules tes on tepd.id = tes.process_definition_id\n+        where tepd.project_id = #{projectId}\n+        <if test=\"ids != null and ids.size()>0\">\n+            and tepd.id in\n+            <foreach collection=\"ids\" index=\"index\" item=\"i\" open=\"(\" separator=\",\" close=\")\">\n+                #{i}\n+            </foreach>\n+        </if>\n+        ) a", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c6e999879647899eb3a982a25785054312d79bd"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUxMTc0Nw==", "bodyText": "Should keep the original format.", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r531511747", "createdAt": "2020-11-27T10:25:28Z", "author": {"login": "wen-hemin"}, "path": "dolphinscheduler-dao/src/main/resources/org/apache/dolphinscheduler/dao/mapper/WorkFlowLineageMapper.xml", "diffHunk": "@@ -49,39 +50,42 @@\n \n     <select id=\"queryByIds\" resultType=\"org.apache.dolphinscheduler.dao.entity.WorkFlowLineage\" databaseId=\"pg\">\n         select a.work_flow_id,\n-               a.work_flow_name,\n-               a.is_depend_work_flow,\n-               array_agg(a.source_id) as source_id,\n-               a.work_flow_publish_status,\n-               a.schedule_start_time,\n-               a.schedule_end_time,\n-               a.crontab,\n-               a.schedule_publish_status\n-         from (\n-               select tepd.id as work_flow_id,tepd.name as work_flow_name,\n-                      case when tepd.process_definition_json::json#>'{tasks,1,dependence}' is not null then 1 else 0 end as is_depend_work_flow,\n-                      (json_array_elements(tepd.process_definition_json::json#>'{tasks}')#>>'{dependence,dependTaskList,0,dependItemList,0,definitionId}') as source_id,\n-                      tepd.release_state as work_flow_publish_status,\n-                      tes.start_time as schedule_start_time,\n-                      tes.end_time as schedule_end_time,\n-                      tes.crontab as crontab,\n-                      tes.release_state as schedule_publish_status\n-                 from t_ds_process_definition tepd\n-                 left join t_ds_schedules tes on tepd.id = tes.process_definition_id\n-                 where tepd.project_id = #{projectId}\n-                 <if test=\"ids != null and ids.size()>0\">\n-                     and  tepd.id in\n-                     <foreach collection=\"ids\" index=\"index\" item=\"i\" open=\"(\" separator=\",\" close=\")\">\n-                     #{i}\n-                     </foreach>\n-                </if>\n-             ) a\n+        a.work_flow_name,\n+        a.is_depend_work_flow,\n+        array_agg(a.source_id) as source_id,\n+        a.work_flow_publish_status,\n+        a.schedule_start_time,\n+        a.schedule_end_time,\n+        a.crontab,\n+        a.schedule_publish_status\n+        from (\n+        select tepd.id as work_flow_id,tepd.name as work_flow_name,\n+        case when tepd.process_definition_json::json#>'{tasks,1,dependence}' is not null then 1 else 0 end as\n+        is_depend_work_flow,\n+        (json_array_elements(tepd.process_definition_json::json#>'{tasks}')#>>'{dependence,dependTaskList,0,dependItemList,0,definitionId}')\n+        as source_id,\n+        tepd.release_state as work_flow_publish_status,\n+        tes.start_time as schedule_start_time,\n+        tes.end_time as schedule_end_time,\n+        tes.crontab as crontab,\n+        tes.release_state as schedule_publish_status\n+        from t_ds_process_definition tepd\n+        left join t_ds_schedules tes on tepd.id = tes.process_definition_id\n+        where tepd.project_id = #{projectId}\n+        <if test=\"ids != null and ids.size()>0\">\n+            and tepd.id in\n+            <foreach collection=\"ids\" index=\"index\" item=\"i\" open=\"(\" separator=\",\" close=\")\">\n+                #{i}\n+            </foreach>\n+        </if>\n+        ) a\n         where (a.is_depend_work_flow = 1 and source_id is not null) or (a.is_depend_work_flow = 0)\n         group by a.work_flow_id,a.work_flow_name,a.is_depend_work_flow,a.work_flow_publish_status,a.schedule_start_time,\n-                 a.schedule_end_time,a.crontab,a.schedule_publish_status\n+        a.schedule_end_time,a.crontab,a.schedule_publish_status", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c6e999879647899eb3a982a25785054312d79bd"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUxMTkxMQ==", "bodyText": "Should keep the original format.", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r531511911", "createdAt": "2020-11-27T10:25:43Z", "author": {"login": "wen-hemin"}, "path": "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/tenement/_source/createTenement.vue", "diffHunk": "@@ -1,36 +1,36 @@\n /*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *    http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n+* Licensed to the Apache Software Foundation (ASF) under one or more\n+* contributor license agreements.  See the NOTICE file distributed with\n+* this work for additional information regarding copyright ownership.\n+* The ASF licenses this file to You under the Apache License, Version 2.0\n+* (the \"License\"); you may not use this file except in compliance with\n+* the License.  You may obtain a copy of the License at\n+*\n+*    http://www.apache.org/licenses/LICENSE-2.0\n+*\n+* Unless required by applicable law or agreed to in writing, software\n+* distributed under the License is distributed on an \"AS IS\" BASIS,\n+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+* See the License for the specific language governing permissions and\n+* limitations under the License.\n+*/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c6e999879647899eb3a982a25785054312d79bd"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09f6ee6e67d37871a286c88727d92c4bddf435d1", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/09f6ee6e67d37871a286c88727d92c4bddf435d1", "committedDate": "2020-11-28T02:25:21Z", "message": "Delete WorkFlowLineageMapper.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76411b70ae892464350a895ea9f4cdb8fd908f00", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/76411b70ae892464350a895ea9f4cdb8fd908f00", "committedDate": "2020-11-28T02:26:31Z", "message": "Delete createTenement.vue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae7e1b755b3aa557985c9c68443f31270819a355", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/ae7e1b755b3aa557985c9c68443f31270819a355", "committedDate": "2020-11-28T04:25:57Z", "message": "Merge remote-tracking branch 'upstream/dev' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc47f168811f4ea48b7aca5c766030decd28fdc2", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/fc47f168811f4ea48b7aca5c766030decd28fdc2", "committedDate": "2020-11-28T04:37:25Z", "message": "recove wrongly deleted file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0603f6d9a3cde5c0c444abc0f8bd0f43bc2c0ab6", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/0603f6d9a3cde5c0c444abc0f8bd0f43bc2c0ab6", "committedDate": "2020-11-28T04:40:22Z", "message": "Update WorkFlowLineageMapper.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab81e656987ef982d6a943a54ba0c27156f9bec6", "author": {"user": {"login": "hermeshephaestus", "name": "Yarlung"}}, "url": "https://github.com/apache/dolphinscheduler/commit/ab81e656987ef982d6a943a54ba0c27156f9bec6", "committedDate": "2020-11-28T04:42:17Z", "message": "Update createTenement.vue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMzc2MTgz", "url": "https://github.com/apache/dolphinscheduler/pull/3940#pullrequestreview-540376183", "createdAt": "2020-11-28T13:40:42Z", "commit": {"oid": "ab81e656987ef982d6a943a54ba0c27156f9bec6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMTQyODk1", "url": "https://github.com/apache/dolphinscheduler/pull/3940#pullrequestreview-552142895", "createdAt": "2020-12-15T06:35:41Z", "commit": {"oid": "ab81e656987ef982d6a943a54ba0c27156f9bec6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNjozNTo0MVrOIF7JDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwNjozNTo0MVrOIF7JDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzA4Mjc2NQ==", "bodyText": "sql Grammar mistakes", "url": "https://github.com/apache/dolphinscheduler/pull/3940#discussion_r543082765", "createdAt": "2020-12-15T06:35:41Z", "author": {"login": "felix-thinkingdata"}, "path": "dolphinscheduler-dao/src/main/resources/org/apache/dolphinscheduler/dao/mapper/ProjectMapper.xml", "diffHunk": "@@ -50,23 +72,29 @@\n         order by p.create_time desc\n     </select>\n     <select id=\"queryAuthedProjectListByUserId\" resultType=\"org.apache.dolphinscheduler.dao.entity.Project\">\n-        select p.*\n+        select\n+        <include refid=\"baseSqlV2\">\n+            <property name=\"alias\" value=\"p\"/>\n+        </include>\n+        ,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab81e656987ef982d6a943a54ba0c27156f9bec6"}, "originalPosition": 68}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2329, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}