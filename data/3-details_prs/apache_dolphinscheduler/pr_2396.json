{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNzY0NTA4", "number": 2396, "title": "[optimization]\uff1aprevent repeated database updates", "bodyText": "What is the purpose of the pull request\nWhen the execution process instance is put into a stopped or suspended state, repeatedly access the data database.", "createdAt": "2020-04-10T05:31:42Z", "url": "https://github.com/apache/dolphinscheduler/pull/2396", "merged": true, "mergeCommit": {"oid": "f929c6f3b7a43b78db977206c3425d88ae3c357b"}, "closed": true, "closedAt": "2020-04-16T14:50:27Z", "author": {"login": "songquanhe-gitstudy"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPv2SjgH2gAyNDAxNzY0NTA4OmEzMTI2ZTZjMjZiNzY3OTRjNmVmNzY3ODI5MjgyMDUwOWE2ZDZkMDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYN4G_gFqTM5NDcxMjUwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a3126e6c26b76794c6ef7678292820509a6d6d01", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/a3126e6c26b76794c6ef7678292820509a6d6d01", "committedDate": "2020-03-21T07:19:47Z", "message": "sqlTask failed to run"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d1c6e9a3380f03367ba7f6e0e4cc31175227505", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/5d1c6e9a3380f03367ba7f6e0e4cc31175227505", "committedDate": "2020-03-24T17:27:11Z", "message": "Merge remote-tracking branch 'upstream/dev' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "145f13f084cb3ab3b9efaf3cfc8bbd7aa5912139", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/145f13f084cb3ab3b9efaf3cfc8bbd7aa5912139", "committedDate": "2020-03-28T02:17:17Z", "message": "Merge remote-tracking branch 'upstream/dev' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99c099947d226b53c44fc47b63a19f0018ccc152", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/99c099947d226b53c44fc47b63a19f0018ccc152", "committedDate": "2020-04-09T12:05:57Z", "message": "Merge remote-tracking branch 'upstream/dev' into merge4"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17199ee98f0cc4fdd0f962239f0287094f5b5c03", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/17199ee98f0cc4fdd0f962239f0287094f5b5c03", "committedDate": "2020-04-10T03:36:30Z", "message": "prevent repeated database updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b4a93acda89e14534dee19175ae85132a547f8e", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/5b4a93acda89e14534dee19175ae85132a547f8e", "committedDate": "2020-04-10T03:43:18Z", "message": "prevent repeated database updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04f5b331e92ddf39773691e46ea4e8625a7f7565", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/04f5b331e92ddf39773691e46ea4e8625a7f7565", "committedDate": "2020-04-10T05:19:44Z", "message": "Merge remote-tracking branch 'upstream/dev' into merge4"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9eb134d6829159ccfe9d973017336cb78ebfd7a", "author": {"user": null}, "url": "https://github.com/apache/dolphinscheduler/commit/b9eb134d6829159ccfe9d973017336cb78ebfd7a", "committedDate": "2020-04-10T05:27:58Z", "message": "prevent repeated database updates"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNDg1Mjcx", "url": "https://github.com/apache/dolphinscheduler/pull/2396#pullrequestreview-391485271", "createdAt": "2020-04-10T14:54:11Z", "commit": {"oid": "b9eb134d6829159ccfe9d973017336cb78ebfd7a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNDo1NDoxMVrOGD8uMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNDo1NDoxMVrOGD8uMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc5Mzc3Ng==", "bodyText": "method name called updateProcessInstanceState maybe better\uff1f because changed the database state\uff0chow do you think ?", "url": "https://github.com/apache/dolphinscheduler/pull/2396#discussion_r406793776", "createdAt": "2020-04-10T14:54:11Z", "author": {"login": "dailidong"}, "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ExecutorService.java", "diffHunk": "@@ -308,22 +302,27 @@ private boolean checkTenantSuitable(ProcessDefinition processDefinition) {\n     }\n \n     /**\n-     * update process instance state\n+     *  prepare to update process instance command type and status\n      *\n-     * @param processInstanceId process instance id\n+     * @param processInstance process instance\n+     * @param commandType command type\n      * @param executionStatus execute status\n      * @return update result\n      */\n-    private Map<String, Object> updateProcessInstanceState(Integer processInstanceId, ExecutionStatus executionStatus) {\n+    private Map<String, Object> updateProcessInstancePrepare(ProcessInstance processInstance, CommandType commandType, ExecutionStatus executionStatus) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9eb134d6829159ccfe9d973017336cb78ebfd7a"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26581544a1000d0c29f9bad076084978ab620a60", "author": {"user": {"login": "dailidong", "name": "lidongdai"}}, "url": "https://github.com/apache/dolphinscheduler/commit/26581544a1000d0c29f9bad076084978ab620a60", "committedDate": "2020-04-16T10:26:43Z", "message": "Merge branch 'dev' into merge4"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NzEyNTAy", "url": "https://github.com/apache/dolphinscheduler/pull/2396#pullrequestreview-394712502", "createdAt": "2020-04-16T14:50:19Z", "commit": {"oid": "26581544a1000d0c29f9bad076084978ab620a60"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2022, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}