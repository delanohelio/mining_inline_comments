{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYxODE2MTI3", "number": 3385, "title": "[Improvement][dao,server] unit test for ConditionsTask", "bodyText": "What is the purpose of the pull request\nrefactor the unit test for ConditionsTask\nBrief change log\n\nrefactor and enable the unit test for ConditionsTask\nadd FAILURE dependence test for ConditionsTask\nfix a potential NPE at TaskInstance.getDependence and add a unit test for it\nenable unit test for TaskInstance\n\nVerify this pull request\nThis change added tests and can be verified as follows:\n\nUpdated org.apache.dolphinscheduler.server.master.ConditionsTaskTest\nUpdated org.apache.dolphinscheduler.dao.entity.TaskInstanceTest\nTested locally", "createdAt": "2020-08-02T14:47:15Z", "url": "https://github.com/apache/dolphinscheduler/pull/3385", "merged": true, "mergeCommit": {"oid": "59610a56610a4c7131818e3d1c70366d2bdd25ab"}, "closed": true, "closedAt": "2020-08-18T06:46:01Z", "author": {"login": "hsupu"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7NRaeAFqTQ1OTgxOTY2Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdABRAdgFqTQ2OTAzMzc1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5ODE5NjY3", "url": "https://github.com/apache/dolphinscheduler/pull/3385#pullrequestreview-459819667", "createdAt": "2020-08-03T07:55:24Z", "commit": {"oid": "630c7873b356b5edb5d5b47ef934536c8a256cb5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNzo1NToyNFrOG6vpoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNzo1NToyNFrOG6vpoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI1MTI5Ng==", "bodyText": "Why change common.utils.JSONUtils to jackson.annotation.JsonFormat ?", "url": "https://github.com/apache/dolphinscheduler/pull/3385#discussion_r464251296", "createdAt": "2020-08-03T07:55:24Z", "author": {"login": "Jave-Chen"}, "path": "dolphinscheduler-dao/src/main/java/org/apache/dolphinscheduler/dao/entity/TaskInstance.java", "diffHunk": "@@ -16,19 +16,18 @@\n  */\n package org.apache.dolphinscheduler.dao.entity;\n \n-import com.baomidou.mybatisplus.annotation.IdType;\n-import com.baomidou.mybatisplus.annotation.TableField;\n-import com.fasterxml.jackson.annotation.JsonFormat;\n import org.apache.dolphinscheduler.common.enums.ExecutionStatus;\n import org.apache.dolphinscheduler.common.enums.Flag;\n import org.apache.dolphinscheduler.common.enums.Priority;\n import org.apache.dolphinscheduler.common.enums.TaskType;\n import org.apache.dolphinscheduler.common.model.TaskNode;\n-import org.apache.dolphinscheduler.common.utils.*;\n+import org.apache.dolphinscheduler.common.utils.JSONUtils;\n+\n import com.baomidou.mybatisplus.annotation.IdType;\n+import com.baomidou.mybatisplus.annotation.TableField;\n import com.baomidou.mybatisplus.annotation.TableId;\n import com.baomidou.mybatisplus.annotation.TableName;\n-import org.apache.dolphinscheduler.common.utils.JSONUtils;\n+import com.fasterxml.jackson.annotation.JsonFormat;\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "630c7873b356b5edb5d5b47ef934536c8a256cb5"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5ODI5OTkw", "url": "https://github.com/apache/dolphinscheduler/pull/3385#pullrequestreview-459829990", "createdAt": "2020-08-03T08:12:26Z", "commit": {"oid": "630c7873b356b5edb5d5b47ef934536c8a256cb5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwODoxMjoyNlrOG6wIng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwODoxMjoyNlrOG6wIng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI1OTIzMA==", "bodyText": "Hi,\nGood job, but there is no necessary to add the FLOWNODE_RUN_FLAG_NORMAL in Constants just for test case.\nIf you want to add the constant, you can directly add FLOWNODE_RUN_FLAG_NORMAL in ConditionsTaskTest", "url": "https://github.com/apache/dolphinscheduler/pull/3385#discussion_r464259230", "createdAt": "2020-08-03T08:12:26Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/Constants.java", "diffHunk": "@@ -391,7 +391,12 @@ private Constants() {\n     public static final int RPC_PORT = 50051;\n \n     /**\n-     * forbid running task\n+     * task can be run normally\n+     */\n+    public static final String FLOWNODE_RUN_FLAG_NORMAL = \"NORMAL\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "630c7873b356b5edb5d5b47ef934536c8a256cb5"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5ODQxODIy", "url": "https://github.com/apache/dolphinscheduler/pull/3385#pullrequestreview-459841822", "createdAt": "2020-08-03T08:30:28Z", "commit": {"oid": "630c7873b356b5edb5d5b47ef934536c8a256cb5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwODozMDoyOFrOG6wrzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwODozMDoyOFrOG6wrzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI2ODIzOQ==", "bodyText": "Hi,\nI checkout to your branch and found that the ConditionsTaskTest.java is not in the test case includer.\nPlease add the test to root pom.", "url": "https://github.com/apache/dolphinscheduler/pull/3385#discussion_r464268239", "createdAt": "2020-08-03T08:30:28Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-server/src/test/java/org/apache/dolphinscheduler/server/master/ConditionsTaskTest.java", "diffHunk": "@@ -17,7 +17,16 @@\n package org.apache.dolphinscheduler.server.master;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "630c7873b356b5edb5d5b47ef934536c8a256cb5"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cdb89776bc5ca03777c399cccbf6b27950a0970b", "author": {"user": {"login": "puxu-msft", "name": "Pu Xu (MSFT)"}}, "url": "https://github.com/apache/dolphinscheduler/commit/cdb89776bc5ca03777c399cccbf6b27950a0970b", "committedDate": "2020-08-03T08:39:25Z", "message": "enable test"}, "afterCommit": {"oid": "653871804eee1f26b598e8945bacbeb2f587405e", "author": {"user": {"login": "hsupu", "name": "Hsu Pu"}}, "url": "https://github.com/apache/dolphinscheduler/commit/653871804eee1f26b598e8945bacbeb2f587405e", "committedDate": "2020-08-03T08:42:09Z", "message": "enable test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwNjcwODgw", "url": "https://github.com/apache/dolphinscheduler/pull/3385#pullrequestreview-460670880", "createdAt": "2020-08-04T10:00:01Z", "commit": {"oid": "653871804eee1f26b598e8945bacbeb2f587405e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNDgwODc3", "url": "https://github.com/apache/dolphinscheduler/pull/3385#pullrequestreview-461480877", "createdAt": "2020-08-05T09:10:26Z", "commit": {"oid": "443cf37adf47c4a44dc6dcdd13ba04e32c8f87e9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwOToxMDoyNlrOG8BEwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwOToxMDoyNlrOG8BEwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU4NTM0NQ==", "bodyText": "Please revert the changes and just add your test.", "url": "https://github.com/apache/dolphinscheduler/pull/3385#discussion_r465585345", "createdAt": "2020-08-05T09:10:26Z", "author": {"login": "yangyichao-mango"}, "path": "pom.xml", "diffHunk": "@@ -783,12 +783,38 @@\n                         <include>**/common/utils/RetryerUtilsTest.java</include>\n                         <include>**/common/plugin/FilePluginManagerTest</include>\n                         <include>**/common/plugin/PluginClassLoaderTest</include>\n+                        <include>**/dao/AlertDaoTest.java</include>\n+                        <include>**/dao/datasource/OracleDataSourceTest.java</include>\n+                        <include>**/dao/datasource/HiveDataSourceTest.java</include>\n+                        <!--<include>**/dao/entity/ProcessDefinitionTest.java</include>-->\n+                        <include>**/dao/entity/TaskInstanceTest.java</include>\n+                        <include>**/dao/entity/UdfFuncTest.java</include>\n                         <include>**/dao/mapper/AccessTokenMapperTest.java</include>\n                         <include>**/dao/mapper/AlertGroupMapperTest.java</include>\n                         <include>**/dao/mapper/CommandMapperTest.java</include>\n                         <include>**/dao/mapper/ConnectionFactoryTest.java</include>\n                         <include>**/dao/mapper/DataSourceMapperTest.java</include>\n-                        <include>**/dao/entity/UdfFuncTest.java</include>\n+                        <include>**/dao/mapper/DataSourceUserMapperTest.java</include>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "443cf37adf47c4a44dc6dcdd13ba04e32c8f87e9"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNTI2NjIz", "url": "https://github.com/apache/dolphinscheduler/pull/3385#pullrequestreview-461526623", "createdAt": "2020-08-05T10:14:56Z", "commit": {"oid": "cc658c021e2a23e212f6b9eab066d4a1438ea0e9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "607c18090acdb1599f8ea8f39cbf874071dd4ffa", "author": {"user": {"login": "hsupu", "name": "Hsu Pu"}}, "url": "https://github.com/apache/dolphinscheduler/commit/607c18090acdb1599f8ea8f39cbf874071dd4ffa", "committedDate": "2020-08-08T16:06:10Z", "message": "@RunWith(MockitoJUnitRunner.class) instead"}, "afterCommit": {"oid": "d4b61ed1928de5466326a4a0406c542fce51b435", "author": {"user": {"login": "hsupu", "name": "Hsu Pu"}}, "url": "https://github.com/apache/dolphinscheduler/commit/d4b61ed1928de5466326a4a0406c542fce51b435", "committedDate": "2020-08-10T08:48:04Z", "message": "polish"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4b61ed1928de5466326a4a0406c542fce51b435", "author": {"user": {"login": "hsupu", "name": "Hsu Pu"}}, "url": "https://github.com/apache/dolphinscheduler/commit/d4b61ed1928de5466326a4a0406c542fce51b435", "committedDate": "2020-08-10T08:48:04Z", "message": "polish"}, "afterCommit": {"oid": "d8b63cb8c2b6fe3d977ae7a099608dee8db08e2f", "author": {"user": {"login": "hsupu", "name": "Hsu Pu"}}, "url": "https://github.com/apache/dolphinscheduler/commit/d8b63cb8c2b6fe3d977ae7a099608dee8db08e2f", "committedDate": "2020-08-18T02:35:11Z", "message": "merged"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8b63cb8c2b6fe3d977ae7a099608dee8db08e2f", "author": {"user": {"login": "hsupu", "name": "Hsu Pu"}}, "url": "https://github.com/apache/dolphinscheduler/commit/d8b63cb8c2b6fe3d977ae7a099608dee8db08e2f", "committedDate": "2020-08-18T02:35:11Z", "message": "merged"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a70cd323385ea86189607c5577cb381b44f7f1c", "author": {"user": {"login": "hsupu", "name": "Hsu Pu"}}, "url": "https://github.com/apache/dolphinscheduler/commit/4a70cd323385ea86189607c5577cb381b44f7f1c", "committedDate": "2020-08-18T02:53:50Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5MDMzNzU2", "url": "https://github.com/apache/dolphinscheduler/pull/3385#pullrequestreview-469033756", "createdAt": "2020-08-18T06:45:43Z", "commit": {"oid": "4a70cd323385ea86189607c5577cb381b44f7f1c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1823, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}