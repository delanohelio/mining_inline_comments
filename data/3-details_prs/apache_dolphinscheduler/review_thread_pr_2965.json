{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzOTk2NjE2", "number": 2965, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNDozMzowM1rOEHTNCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNDozMzowM1rOEHTNCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MDkwMTIyOnYy", "diffSide": "RIGHT", "path": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/FileUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNDozMzowM1rOGmm1iA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNDo0MjoxNVrOGmm4Lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzNTM2OA==", "bodyText": "why swallow exception\uff1f", "url": "https://github.com/apache/dolphinscheduler/pull/2965#discussion_r443135368", "createdAt": "2020-06-20T14:33:03Z", "author": {"login": "dailidong"}, "path": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/FileUtils.java", "diffHunk": "@@ -138,24 +153,39 @@ public static String getResourceViewSuffixs() {\n      * @param userName user name\n      * @throws IOException errors\n      */\n-    public static void createWorkDirAndUserIfAbsent(String execLocalPath, String userName) throws IOException{\n+    public static void createWorkDirAndUserIfAbsent(String execLocalPath, String userName) throws IOException {\n         //if work dir exists, first delete\n         File execLocalPathFile = new File(execLocalPath);\n \n-        if (execLocalPathFile.exists()){\n+        if (execLocalPathFile.exists()) {\n             org.apache.commons.io.FileUtils.forceDelete(execLocalPathFile);\n         }\n \n         //create work dir\n         org.apache.commons.io.FileUtils.forceMkdir(execLocalPathFile);\n-        logger.info(\"create dir success {}\" , execLocalPath);\n-\n+        String mkdirLog = \"create dir success \" + execLocalPath;\n+        LoggerUtils.logInfo(logger, taskLoggerThreadLocal::get, mkdirLog);\n \n         //if not exists this user,then create\n-        if (!OSUtils.getUserList().contains(userName)){\n-            OSUtils.createUser(userName);\n+        Logger taskLogger = taskLoggerThreadLocal.get();\n+        OSUtils.taskLoggerThreadLocal.set(taskLogger);\n+        try {\n+            if (!OSUtils.getUserList().contains(userName)) {\n+                boolean isSuccessCreateUser = OSUtils.createUser(userName);\n+\n+                if (isSuccessCreateUser) {\n+                    String infoLog = String.format(\"create user name success %s\", userName);\n+                    taskLogger.info(infoLog);\n+                    logger.info(infoLog);\n+                } else {\n+                    String infoLog = String.format(\"create user name fail %s\", userName);\n+                    taskLogger.error(infoLog);\n+                    logger.error(infoLog);\n+                }\n+            }\n+        } catch (Throwable ignored) {\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f36af5331ea3721f9c7d2a281ff4bcfaad679547"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzNjA0Ng==", "bodyText": "why swallow exception\uff1f\n\nThx a lot for your review @dailidong . I've removed the unused exception try catch clause.", "url": "https://github.com/apache/dolphinscheduler/pull/2965#discussion_r443136046", "createdAt": "2020-06-20T14:42:15Z", "author": {"login": "yangyichao-mango"}, "path": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/FileUtils.java", "diffHunk": "@@ -138,24 +153,39 @@ public static String getResourceViewSuffixs() {\n      * @param userName user name\n      * @throws IOException errors\n      */\n-    public static void createWorkDirAndUserIfAbsent(String execLocalPath, String userName) throws IOException{\n+    public static void createWorkDirAndUserIfAbsent(String execLocalPath, String userName) throws IOException {\n         //if work dir exists, first delete\n         File execLocalPathFile = new File(execLocalPath);\n \n-        if (execLocalPathFile.exists()){\n+        if (execLocalPathFile.exists()) {\n             org.apache.commons.io.FileUtils.forceDelete(execLocalPathFile);\n         }\n \n         //create work dir\n         org.apache.commons.io.FileUtils.forceMkdir(execLocalPathFile);\n-        logger.info(\"create dir success {}\" , execLocalPath);\n-\n+        String mkdirLog = \"create dir success \" + execLocalPath;\n+        LoggerUtils.logInfo(logger, taskLoggerThreadLocal::get, mkdirLog);\n \n         //if not exists this user,then create\n-        if (!OSUtils.getUserList().contains(userName)){\n-            OSUtils.createUser(userName);\n+        Logger taskLogger = taskLoggerThreadLocal.get();\n+        OSUtils.taskLoggerThreadLocal.set(taskLogger);\n+        try {\n+            if (!OSUtils.getUserList().contains(userName)) {\n+                boolean isSuccessCreateUser = OSUtils.createUser(userName);\n+\n+                if (isSuccessCreateUser) {\n+                    String infoLog = String.format(\"create user name success %s\", userName);\n+                    taskLogger.info(infoLog);\n+                    logger.info(infoLog);\n+                } else {\n+                    String infoLog = String.format(\"create user name fail %s\", userName);\n+                    taskLogger.error(infoLog);\n+                    logger.error(infoLog);\n+                }\n+            }\n+        } catch (Throwable ignored) {\n         }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzNTM2OA=="}, "originalCommit": {"oid": "f36af5331ea3721f9c7d2a281ff4bcfaad679547"}, "originalPosition": 97}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3513, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}