{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxMjY2MDQ2", "number": 407, "title": "KOGITO-2174  implement sorting by column functionality for the generic task list component", "bodyText": "Jira: https://issues.redhat.com/browse/KOGITO-2174\nThis PR contains the implementation of the sorting functionality of the DataTable component in the Common module.\nWhen user click the header of a column of the DataTable component, data should be sorted by that column.\nPlease note that:\n\nSorting should be handled in server side or it should be handled in the Container component.\nWhen the header of a column of the DataTable component is clicked, the DataTable component will pass the related sorting information to the Container component, and the DataTable will be updated according to the sorting result.\n\nMany thanks for submitting your Pull Request \u2764\ufe0f!\nPlease make sure that your PR meets the following requirements:\n\n You have read the contributors guide\n Pull Request title is properly formatted: KOGITO-XYZ Subject\n Pull Request title contains the target branch if not targeting master: [0.9.x] KOGITO-XYZ Subject\n Pull Request contains link to the JIRA issue\n Pull Request contains link to any dependent or related Pull Request\n Pull Request contains description of the issue\n Pull Request does not include fixes for issues other than the main ticket", "createdAt": "2020-08-20T22:08:10Z", "url": "https://github.com/kiegroup/kogito-apps/pull/407", "merged": true, "mergeCommit": {"oid": "047128947da673d1e82c2e437382a479461022c4"}, "closed": true, "closedAt": "2020-09-15T10:18:32Z", "author": {"login": "yzhao583"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdA23hMgH2gAyNDcxMjY2MDQ2Ojc5YTUyZGRhNWZkOGY5YThjMWQ0OGIyZDIwYWY5MTYwZTdkZTI3MDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJElvmAFqTQ4ODUwOTc2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "79a52dda5fd8f9a8c1d48b2d20af9160e7de2704", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/79a52dda5fd8f9a8c1d48b2d20af9160e7de2704", "committedDate": "2020-08-20T21:12:45Z", "message": "Implemented sorting by column functionality for DataTable component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "083c2591a3b82dbbfba15051272d886313f007f8", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/083c2591a3b82dbbfba15051272d886313f007f8", "committedDate": "2020-08-20T21:13:54Z", "message": "Clean up code format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5490579a02243bf3a998102df81852119247687f", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/5490579a02243bf3a998102df81852119247687f", "committedDate": "2020-08-20T21:15:37Z", "message": "implement sorting functionality for DataTable component in Common module"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad389f0ebb43f27cc839f6870ad6c8e8da1f1245", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/ad389f0ebb43f27cc839f6870ad6c8e8da1f1245", "committedDate": "2020-08-20T21:49:01Z", "message": "Update test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf0f210064f78f64d1df12610d65b7a1de714952", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/bf0f210064f78f64d1df12610d65b7a1de714952", "committedDate": "2020-08-20T21:53:10Z", "message": "update test cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0MzgyOTkz", "url": "https://github.com/kiegroup/kogito-apps/pull/407#pullrequestreview-474382993", "createdAt": "2020-08-25T11:25:47Z", "commit": {"oid": "bf0f210064f78f64d1df12610d65b7a1de714952"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMToyNTo0N1rOHGTizg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMToyNTo0N1rOHGTizg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjM3MzcxMA==", "bodyText": "I see here you are identifying the column by the target inner text, I think it reffers to the column label. Why not using the index to calculate the DataTableColumn from the cols and maybe pass that to the setOrderByObj func? Let's sync up today.", "url": "https://github.com/kiegroup/kogito-apps/pull/407#discussion_r476373710", "createdAt": "2020-08-25T11:25:47Z", "author": {"login": "pefernan"}, "path": "ui-packages/packages/common/src/components/Organisms/DataTable/DataTable.tsx", "diffHunk": "@@ -116,6 +125,12 @@ const DataTable: React.FC<IOwnProps> = ({\n     }\n   }, [columnList]);\n \n+  const onSort = (event, index, direction) => {\n+    const sortingColumn = event.target.innerText.toLowerCase();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf0f210064f78f64d1df12610d65b7a1de714952"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2ad7f10ef5df412bb6a14ada115633f737ff8d4", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/a2ad7f10ef5df412bb6a14ada115633f737ff8d4", "committedDate": "2020-08-31T19:04:33Z", "message": "Put sorting functionality into the container component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31642c8d20cb3f3fa2c4665649b85fad3ceb9b12", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/31642c8d20cb3f3fa2c4665649b85fad3ceb9b12", "committedDate": "2020-08-31T19:20:35Z", "message": "Merge branch 'master' into KOGITO-2174--Implement-sorting-by-colum-functionality-for-the-Generic-Task-List-Component"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9a4ca8440e946ab1eeb744e3062c376e03ef0d0", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/b9a4ca8440e946ab1eeb744e3062c376e03ef0d0", "committedDate": "2020-09-01T20:52:28Z", "message": "Reslove conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b432114fd442283febee4494acd07d29ee96bc0", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/3b432114fd442283febee4494acd07d29ee96bc0", "committedDate": "2020-09-01T23:05:11Z", "message": "update snapshot test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89b516d04c021e67d249ae90fd9f44cd22d4947d", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/89b516d04c021e67d249ae90fd9f44cd22d4947d", "committedDate": "2020-09-02T21:02:59Z", "message": "Small modification and update snapshot tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNDExNzc5", "url": "https://github.com/kiegroup/kogito-apps/pull/407#pullrequestreview-482411779", "createdAt": "2020-09-04T07:11:34Z", "commit": {"oid": "89b516d04c021e67d249ae90fd9f44cd22d4947d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNzoxMTozNVrOHNCSgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNzoxMzoyNVrOHNCVjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQzMTA0MQ==", "bodyText": "there is no test for the component.", "url": "https://github.com/kiegroup/kogito-apps/pull/407#discussion_r483431041", "createdAt": "2020-09-04T07:11:35Z", "author": {"login": "jstastny-cz"}, "path": "ui-packages/packages/task-console/src/components/Templates/DataListContainer/DataListContainer.tsx", "diffHunk": "@@ -0,0 +1,94 @@\n+import { Card, Grid, GridItem, PageSection } from '@patternfly/react-core';\n+import React, { useState, useEffect } from 'react';\n+import UserTaskPageHeader from '../../Molecules/UserTaskPageHeader/UserTaskPageHeader';\n+import DataToolbarComponent from '../../Molecules/DataListToolbar/DataListToolbar';\n+import './DataList.css';\n+import TaskList from '../../Organisms/TaskList/TaskList';\n+import {\n+  ouiaPageTypeAndObjectId,\n+  KogitoEmptyState,\n+  KogitoEmptyStateType,\n+  GraphQL,\n+  OUIAProps,\n+  componentOuiaProps\n+} from '@kogito-apps/common';\n+\n+const DataListContainer: React.FC<OUIAProps> = ({ ouiaId, ouiaSafe }) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89b516d04c021e67d249ae90fd9f44cd22d4947d"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQzMTgyMg==", "bodyText": "I think the loading hasn't yet finished here, see the snapshot - it's in loading.", "url": "https://github.com/kiegroup/kogito-apps/pull/407#discussion_r483431822", "createdAt": "2020-09-04T07:13:25Z", "author": {"login": "jstastny-cz"}, "path": "ui-packages/packages/task-console/src/components/Templates/UserTaskDataTableContainer/tests/UserTaskDataTableContainer.test.tsx", "diffHunk": "@@ -113,4 +114,32 @@ describe('UserTaskDataTableContainer component tests', () => {\n     expect(wrapper).toMatchSnapshot();\n     expect(GraphQL.useGetUserTasksByStatesQuery).toBeCalled();\n   });\n+\n+  it('The onSorting function should work correctly', async () => {\n+    GraphQL.useGetUserTasksByStatesQuery = jest.fn().mockReturnValue({\n+      loading: false,\n+      error: undefined,\n+      refetch: jest.fn(),\n+      networkStatus: 1\n+    });\n+\n+    const wrapper = await getWrapperAsync(\n+      <Router>\n+        <MockedProvider>\n+          <UserTaskDataTableContainer />\n+        </MockedProvider>\n+      </Router>,\n+      'UserTaskDataTableContainer'\n+    );\n+\n+    act(() => {\n+      wrapper\n+        .find(DataTable)\n+        .props()\n+        .onSorting(1, 'desc');\n+    });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89b516d04c021e67d249ae90fd9f44cd22d4947d"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e790c0eb5cfd68f55444ee2d37bf2d7765425954", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/e790c0eb5cfd68f55444ee2d37bf2d7765425954", "committedDate": "2020-09-09T21:45:07Z", "message": "update snapshot tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1NzU2Nzcz", "url": "https://github.com/kiegroup/kogito-apps/pull/407#pullrequestreview-485756773", "createdAt": "2020-09-10T09:36:14Z", "commit": {"oid": "e790c0eb5cfd68f55444ee2d37bf2d7765425954"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwOTozNjoxNFrOHPra6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwOTozNjoxNFrOHPra6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjIwMjA5MQ==", "bodyText": "@yzhao583 looks like the KogitoSpiner isn't used on the test,", "url": "https://github.com/kiegroup/kogito-apps/pull/407#discussion_r486202091", "createdAt": "2020-09-10T09:36:14Z", "author": {"login": "pefernan"}, "path": "ui-packages/packages/task-console/src/components/Templates/UserTaskDataTableContainer/tests/UserTaskDataTableContainer.test.tsx", "diffHunk": "@@ -1,8 +1,14 @@\n import React from 'react';\n import UserTaskDataTableContainer from '../UserTaskDataTableContainer';\n-import { getWrapperAsync, GraphQL } from '@kogito-apps/common';\n+import {\n+  getWrapperAsync,\n+  GraphQL,\n+  DataTable,\n+  KogitoSpinner", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e790c0eb5cfd68f55444ee2d37bf2d7765425954"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2402199442be54ecd6372022b3a1d5655930b044", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/2402199442be54ecd6372022b3a1d5655930b044", "committedDate": "2020-09-10T18:18:22Z", "message": "Update snapshot test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3NTU2NzAw", "url": "https://github.com/kiegroup/kogito-apps/pull/407#pullrequestreview-487556700", "createdAt": "2020-09-14T09:02:14Z", "commit": {"oid": "2402199442be54ecd6372022b3a1d5655930b044"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwOTowMjoxNVrOHRKfBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwOTowMjoxNVrOHRKfBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzc1OTYyMA==", "bodyText": "@yzhao583 this changes should be also present on queries.tsx, otherwise they will be lost next time we run yarn codegen. I sent you instructions on the chat!", "url": "https://github.com/kiegroup/kogito-apps/pull/407#discussion_r487759620", "createdAt": "2020-09-14T09:02:15Z", "author": {"login": "pefernan"}, "path": "ui-packages/packages/common/src/graphql/types.tsx", "diffHunk": "@@ -1677,8 +1678,11 @@ export namespace GraphQL {\n     GetInputFieldsFromTypeQueryVariables\n   >;\n   export const GetUserTasksByStatesDocument = gql`\n-    query getUserTasksByStates($state: [String!]) {\n-      UserTaskInstances(where: { state: { in: $state } }) {\n+    query getUserTasksByStates(\n+      $state: [String!]\n+      $orderBy: UserTaskInstanceOrderBy", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2402199442be54ecd6372022b3a1d5655930b044"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76a23c65c1f725599d6aeef1bf69c515de02cb9b", "author": {"user": {"login": "yzhao583", "name": "yu zhao"}}, "url": "https://github.com/kiegroup/kogito-apps/commit/76a23c65c1f725599d6aeef1bf69c515de02cb9b", "committedDate": "2020-09-14T20:40:55Z", "message": "modify query"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NDU4MDE2", "url": "https://github.com/kiegroup/kogito-apps/pull/407#pullrequestreview-488458016", "createdAt": "2020-09-15T08:42:17Z", "commit": {"oid": "76a23c65c1f725599d6aeef1bf69c515de02cb9b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NTA5NzYw", "url": "https://github.com/kiegroup/kogito-apps/pull/407#pullrequestreview-488509760", "createdAt": "2020-09-15T09:43:24Z", "commit": {"oid": "76a23c65c1f725599d6aeef1bf69c515de02cb9b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4707, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}