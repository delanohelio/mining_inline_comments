{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQwMzM0ODYw", "number": 570, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwODo1OTo1OVrOFGmOnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOTozNDozMVrOFGnK8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNDYyMTExOnYy", "diffSide": "RIGHT", "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEvent.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwODo1OTo1OVrOIHrN8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzozMDozMlrOIIApKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkxOTAyNw==", "bodyText": "While I favor using a separate classes for each purpose, maybe the duplication SonarCloud complains about could be reduced by introducing an abstract parent class?", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r544919027", "createdAt": "2020-12-17T08:59:59Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEvent.java", "diffHunk": "@@ -0,0 +1,262 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.time.ZonedDateTime;\n+import java.util.List;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import io.quarkus.runtime.annotations.RegisterForReflection;\n+\n+@RegisterForReflection\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+public class UserTaskEvent {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAyNTMyOQ==", "bodyText": "For this use case, I don't like to be forced to add an abstract class when I believe this classes has a different nature. But also, note that this two classes involves JSON deserialization from json strings that doesn't have exactly the same json field names. Since the UserTaskEvent is used for getting information in json format comming from the events, and the UserTaskInstance is used for getting information comming in the format returned by the data index.\nWhile very similar, those two formats are not exactly the same.\ne.g.\nthe event carries a json field:\n@JsonProperty(\"taskDescription\")\nprivate String description;\n\nwhile the data index query returns similar information but in a json field \"description\"\n//no spetial configuration is required here\nprivate String description;\nWell, to finish a too long explanation. I don't like to have to change my natural way to see it, just because sonar complained about this use case.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545025329", "createdAt": "2020-12-17T11:42:02Z", "author": {"login": "wmedvede"}, "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEvent.java", "diffHunk": "@@ -0,0 +1,262 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.time.ZonedDateTime;\n+import java.util.List;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import io.quarkus.runtime.annotations.RegisterForReflection;\n+\n+@RegisterForReflection\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+public class UserTaskEvent {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkxOTAyNw=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI3MDA1Ng==", "bodyText": "Sounds fair.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545270056", "createdAt": "2020-12-17T17:30:32Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEvent.java", "diffHunk": "@@ -0,0 +1,262 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.time.ZonedDateTime;\n+import java.util.List;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import io.quarkus.runtime.annotations.RegisterForReflection;\n+\n+@RegisterForReflection\n+@JsonIgnoreProperties(ignoreUnknown = true)\n+public class UserTaskEvent {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkxOTAyNw=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNDY2NzYyOnYy", "diffSide": "RIGHT", "path": "task-assigning/task-assigning-process-service-client/src/test/java/org/kie/kogito/taskassigning/messaging/ReactiveMessagingEventConsumerTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOToxMDozMlrOIHro6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOToxMDozMlrOIHro6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkyNTkzMA==", "bodyText": "Nitpicking: in the optaplanner repository, we usually use 10 seconds for test timeouts. Even if the test runs on desperately slow machine, there is enough buffer for it to pass. It's just a timeout, so it will take the 10 seconds only if there is an issue and then we know it's worth investigating.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r544925930", "createdAt": "2020-12-17T09:10:32Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/test/java/org/kie/kogito/taskassigning/messaging/ReactiveMessagingEventConsumerTest.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.util.concurrent.CompletionStage;\n+\n+import org.eclipse.microprofile.reactive.messaging.Message;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.Timeout;\n+\n+import static org.mockito.Mockito.spy;\n+import static org.mockito.Mockito.verify;\n+\n+class ReactiveMessagingEventConsumerTest {\n+\n+    @Test\n+    @Timeout(2)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNDY4ODk5OnYy", "diffSide": "RIGHT", "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEventMessage.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOToxNToxOFrOIHr1EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzoxMzoxM1rOIH_6Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkyOTA0MA==", "bodyText": "The RegisterForReflection annotation is there because of the (de)serialization  to/from JSON?", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r544929040", "createdAt": "2020-12-17T09:15:18Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEventMessage.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.net.URI;\n+import java.time.ZonedDateTime;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import io.quarkus.runtime.annotations.RegisterForReflection;\n+\n+@RegisterForReflection", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAwNDAzOA==", "bodyText": "This annotation is for making this class properly managed for the native image generation.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545004038", "createdAt": "2020-12-17T11:07:05Z", "author": {"login": "wmedvede"}, "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEventMessage.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.net.URI;\n+import java.time.ZonedDateTime;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import io.quarkus.runtime.annotations.RegisterForReflection;\n+\n+@RegisterForReflection", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkyOTA0MA=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI1Nzk5OQ==", "bodyText": "Yep, I was more interested in what is the reason for reflection there - and I guess it's the JSON serialization itself (through e.g. the jackson library).", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545257999", "createdAt": "2020-12-17T17:13:13Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEventMessage.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.net.URI;\n+import java.time.ZonedDateTime;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import io.quarkus.runtime.annotations.RegisterForReflection;\n+\n+@RegisterForReflection", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkyOTA0MA=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNDY5ODkzOnYy", "diffSide": "RIGHT", "path": "task-assigning/task-assigning-process-service-client/src/main/resources/META-INF/microprofile-config.properties", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOToxNzo0MlrOIHr7Fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzoxMzo1M1rOIH_76g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkzMDU4Mw==", "bodyText": "How does this microprofile-config.properties relate to Quarkus (and its application.properties)?", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r544930583", "createdAt": "2020-12-17T09:17:42Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/main/resources/META-INF/microprofile-config.properties", "diffHunk": "@@ -1,8 +1,17 @@\n quarkus.oidc.enabled=true\n quarkus.oidc.tenant-enabled=false\n-\n %keycloak.quarkus.oidc.tenant-enabled=true\n %keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito\n %keycloak.quarkus.oidc.client-id=kogito-task-assigning-service\n %keycloak.quarkus.oidc.application-type=service\n-%keycloak.quarkus.oidc.credentials.secret=secret\n\\ No newline at end of file\n+%keycloak.quarkus.oidc.credentials.secret=secret\n+\n+quarkus.kafka.bootstrap-servers=localhost:9092\n+\n+mp.messaging.incoming.kogito-usertaskinstances-events.connector=smallrye-kafka\n+mp.messaging.incoming.kogito-usertaskinstances-events.topic=kogito-usertaskinstances-events\n+mp.messaging.incoming.kogito-usertaskinstances-events.value.deserializer=org.kie.kogito.taskassigning.messaging.UserTaskEventDeserializer\n+mp.messaging.incoming.kogito-usertaskinstances-events.group.id=kogito-task-assigning-service\n+mp.messaging.incoming.kogito-usertaskinstances-events.enable.auto.commit=false\n+mp.messaging.incoming.kogito-usertaskinstances-events.auto.offset.reset=earliest\n+mp.messaging.incoming.kogito-usertaskinstances-events.isolation.level=read_committed", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxNTg2OQ==", "bodyText": "This properties are very close to the application.properties, since Quarkus is mostly based on eclipse microprofile/microprofile-config. So in general, many of the application.properties might define same things/configurations.\nSo this properties in the microprofile-config represent a kind of by default configurations for this kind of \"generic\" module I've tried to define. But I really have no Quarkus application/service yet.\nSo, in future step, when I incorporate the module that really defines my Quarkus application (the module that e.g. will take care of starting the solver and put all the pieces working), this properties will be taken as a by default configuration for this generic module, and might be overridden in the application.properties if needed. Most of them won't need any override.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545015869", "createdAt": "2020-12-17T11:26:14Z", "author": {"login": "wmedvede"}, "path": "task-assigning/task-assigning-process-service-client/src/main/resources/META-INF/microprofile-config.properties", "diffHunk": "@@ -1,8 +1,17 @@\n quarkus.oidc.enabled=true\n quarkus.oidc.tenant-enabled=false\n-\n %keycloak.quarkus.oidc.tenant-enabled=true\n %keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito\n %keycloak.quarkus.oidc.client-id=kogito-task-assigning-service\n %keycloak.quarkus.oidc.application-type=service\n-%keycloak.quarkus.oidc.credentials.secret=secret\n\\ No newline at end of file\n+%keycloak.quarkus.oidc.credentials.secret=secret\n+\n+quarkus.kafka.bootstrap-servers=localhost:9092\n+\n+mp.messaging.incoming.kogito-usertaskinstances-events.connector=smallrye-kafka\n+mp.messaging.incoming.kogito-usertaskinstances-events.topic=kogito-usertaskinstances-events\n+mp.messaging.incoming.kogito-usertaskinstances-events.value.deserializer=org.kie.kogito.taskassigning.messaging.UserTaskEventDeserializer\n+mp.messaging.incoming.kogito-usertaskinstances-events.group.id=kogito-task-assigning-service\n+mp.messaging.incoming.kogito-usertaskinstances-events.enable.auto.commit=false\n+mp.messaging.incoming.kogito-usertaskinstances-events.auto.offset.reset=earliest\n+mp.messaging.incoming.kogito-usertaskinstances-events.isolation.level=read_committed", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkzMDU4Mw=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI1ODQ3NA==", "bodyText": "Thanks for the explanation.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545258474", "createdAt": "2020-12-17T17:13:53Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/main/resources/META-INF/microprofile-config.properties", "diffHunk": "@@ -1,8 +1,17 @@\n quarkus.oidc.enabled=true\n quarkus.oidc.tenant-enabled=false\n-\n %keycloak.quarkus.oidc.tenant-enabled=true\n %keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito\n %keycloak.quarkus.oidc.client-id=kogito-task-assigning-service\n %keycloak.quarkus.oidc.application-type=service\n-%keycloak.quarkus.oidc.credentials.secret=secret\n\\ No newline at end of file\n+%keycloak.quarkus.oidc.credentials.secret=secret\n+\n+quarkus.kafka.bootstrap-servers=localhost:9092\n+\n+mp.messaging.incoming.kogito-usertaskinstances-events.connector=smallrye-kafka\n+mp.messaging.incoming.kogito-usertaskinstances-events.topic=kogito-usertaskinstances-events\n+mp.messaging.incoming.kogito-usertaskinstances-events.value.deserializer=org.kie.kogito.taskassigning.messaging.UserTaskEventDeserializer\n+mp.messaging.incoming.kogito-usertaskinstances-events.group.id=kogito-task-assigning-service\n+mp.messaging.incoming.kogito-usertaskinstances-events.enable.auto.commit=false\n+mp.messaging.incoming.kogito-usertaskinstances-events.auto.offset.reset=earliest\n+mp.messaging.incoming.kogito-usertaskinstances-events.isolation.level=read_committed", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkzMDU4Mw=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNDczNjkzOnYy", "diffSide": "RIGHT", "path": "task-assigning/task-assigning-process-service-client/src/test/java/org/kie/kogito/taskassigning/messaging/UserTaskEventDeserializerTest.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOToyNjoxNlrOIHsRuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzoyNDowN1rOIIAXhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkzNjM3Ng==", "bodyText": "I think this test case can be simplified a bit, depending on what you want to check:\nA) to check only the deserialization, prepare the expected object and use assertIsEqualToComparingFieldByFieldRecursively to make sure it's equal to the object deserialized from JSON\nB) in case you want to check also serialization, you can deserialize and again serialize the JSON and compare it as a String with the original JSON String. This way you check also formatting (not sure how much relevant it is in this case).", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r544936376", "createdAt": "2020-12-17T09:26:16Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/test/java/org/kie/kogito/taskassigning/messaging/UserTaskEventDeserializerTest.java", "diffHunk": "@@ -0,0 +1,126 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+import static org.kie.kogito.taskassigning.TestUtil.parseZonedDateTime;\n+\n+class UserTaskEventDeserializerTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTEyODI4NA==", "bodyText": "I've been looking at the signature of the suggested alternative A) method, see below, but honestly I don't like it and don't see it as a huge simplification. The package \"internal\" see org.assertj.core.internal.Objects dosen't look inspiring to use too. O the other hand this format is never used in all kogito-runtimes, kogito-apps or even OptaPlanner.\nI think current test is ok, what we are testing is a Deserializer, so it's intended to basically take a json  and return a pojo, and this is exactly what the test does.\nI'll will go with this format.\nvoid assertIsEqualToComparingFieldByFieldRecursively(AssertionInfo info,\nObject actual,\nObject other,\nMap<String,Comparator<?>> comparatorByPropertyOrField,\nTypeComparators comparatorByType)", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545128284", "createdAt": "2020-12-17T14:24:04Z", "author": {"login": "wmedvede"}, "path": "task-assigning/task-assigning-process-service-client/src/test/java/org/kie/kogito/taskassigning/messaging/UserTaskEventDeserializerTest.java", "diffHunk": "@@ -0,0 +1,126 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+import static org.kie.kogito.taskassigning.TestUtil.parseZonedDateTime;\n+\n+class UserTaskEventDeserializerTest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkzNjM3Ng=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2NTU0MQ==", "bodyText": "Sorry for a wrong link; it is the implementation hidden by the fluent API, where a similar method is available too: https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/AbstractObjectAssert.html#isEqualToComparingFieldByField-java.lang.Object-", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545265541", "createdAt": "2020-12-17T17:24:07Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/test/java/org/kie/kogito/taskassigning/messaging/UserTaskEventDeserializerTest.java", "diffHunk": "@@ -0,0 +1,126 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.assertThatThrownBy;\n+import static org.kie.kogito.taskassigning.TestUtil.parseZonedDateTime;\n+\n+class UserTaskEventDeserializerTest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkzNjM3Ng=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNDc0NDA0OnYy", "diffSide": "RIGHT", "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEventDeserializer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOToyNzo0MlrOIHsV2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMToyODozNVrOIHxN9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkzNzQzNA==", "bodyText": "What is the role of the endpoint in the event?", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r544937434", "createdAt": "2020-12-17T09:27:42Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEventDeserializer.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.io.IOException;\n+import java.net.URI;\n+import java.time.temporal.ChronoUnit;\n+\n+import com.google.common.net.UrlEscapers;\n+import org.apache.kafka.common.errors.SerializationException;\n+import org.apache.kafka.common.serialization.Deserializer;\n+\n+import static java.lang.String.format;\n+import static org.kie.kogito.taskassigning.util.JsonUtils.OBJECT_MAPPER;\n+\n+public class UserTaskEventDeserializer implements Deserializer<UserTaskEvent> {\n+\n+    @Override\n+    public UserTaskEvent deserialize(String topic, byte[] data) {\n+        try {\n+            if (data == null) {\n+                return null;\n+            }\n+            UserTaskEventMessage message = OBJECT_MAPPER.readValue(data, UserTaskEventMessage.class);\n+            UserTaskEvent event = message.getData();\n+            event.setEventTime(message.getTime());\n+            event.setLastUpdate(message.getTime().truncatedTo(ChronoUnit.MILLIS));\n+            event.setEndpoint(buildEndpoint(message.getSource(), event.getProcessInstanceId(), event.getName(), event.getId()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxNzMzNA==", "bodyText": "I you remember, in my Kogito tour presentation, I've showed how the events carries the url at where the process service live.  So by using this url, we can know how to invoke the referred process, etc.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545017334", "createdAt": "2020-12-17T11:28:35Z", "author": {"login": "wmedvede"}, "path": "task-assigning/task-assigning-process-service-client/src/main/java/org/kie/kogito/taskassigning/messaging/UserTaskEventDeserializer.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.kogito.taskassigning.messaging;\n+\n+import java.io.IOException;\n+import java.net.URI;\n+import java.time.temporal.ChronoUnit;\n+\n+import com.google.common.net.UrlEscapers;\n+import org.apache.kafka.common.errors.SerializationException;\n+import org.apache.kafka.common.serialization.Deserializer;\n+\n+import static java.lang.String.format;\n+import static org.kie.kogito.taskassigning.util.JsonUtils.OBJECT_MAPPER;\n+\n+public class UserTaskEventDeserializer implements Deserializer<UserTaskEvent> {\n+\n+    @Override\n+    public UserTaskEvent deserialize(String topic, byte[] data) {\n+        try {\n+            if (data == null) {\n+                return null;\n+            }\n+            UserTaskEventMessage message = OBJECT_MAPPER.readValue(data, UserTaskEventMessage.class);\n+            UserTaskEvent event = message.getData();\n+            event.setEventTime(message.getTime());\n+            event.setLastUpdate(message.getTime().truncatedTo(ChronoUnit.MILLIS));\n+            event.setEndpoint(buildEndpoint(message.getSource(), event.getProcessInstanceId(), event.getName(), event.getId()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkzNzQzNA=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNDc3NTU0OnYy", "diffSide": "RIGHT", "path": "task-assigning/task-assigning-process-service-client/pom.xml", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QwOTozNDozMVrOIHsoJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNzoyOTo1MVrOIIAnXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDk0MjExOA==", "bodyText": "If we use guava just to do HTML escaping, may I suggest using https://mvnrepository.com/artifact/org.apache.commons/commons-lang3 instead? It's memory footprint is ~5 times smaller.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r544942118", "createdAt": "2020-12-17T09:34:31Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/pom.xml", "diffHunk": "@@ -35,7 +35,19 @@\n       <groupId>org.slf4j</groupId>\n       <artifactId>slf4j-api</artifactId>\n     </dependency>\n-    \n+    <dependency>\n+      <groupId>io.quarkus</groupId>\n+      <artifactId>quarkus-smallrye-reactive-messaging-kafka</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.kafka</groupId>\n+      <artifactId>kafka-clients</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>com.google.guava</groupId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxODQ3MA==", "bodyText": "I prefer to not incorporate commons-lang3, since guava is already being used in the index-service and not commons-lang3. I've also checked that this this guava used class worked well in the native image.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545018470", "createdAt": "2020-12-17T11:30:24Z", "author": {"login": "wmedvede"}, "path": "task-assigning/task-assigning-process-service-client/pom.xml", "diffHunk": "@@ -35,7 +35,19 @@\n       <groupId>org.slf4j</groupId>\n       <artifactId>slf4j-api</artifactId>\n     </dependency>\n-    \n+    <dependency>\n+      <groupId>io.quarkus</groupId>\n+      <artifactId>quarkus-smallrye-reactive-messaging-kafka</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.kafka</groupId>\n+      <artifactId>kafka-clients</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>com.google.guava</groupId>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDk0MjExOA=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI2OTU5Ng==", "bodyText": "If we are going to use it for other purposes too, let's keep it. If the only reason is the html escaping, I think it's little value it brings for the memory footprint it has.", "url": "https://github.com/kiegroup/kogito-apps/pull/570#discussion_r545269596", "createdAt": "2020-12-17T17:29:51Z", "author": {"login": "rsynek"}, "path": "task-assigning/task-assigning-process-service-client/pom.xml", "diffHunk": "@@ -35,7 +35,19 @@\n       <groupId>org.slf4j</groupId>\n       <artifactId>slf4j-api</artifactId>\n     </dependency>\n-    \n+    <dependency>\n+      <groupId>io.quarkus</groupId>\n+      <artifactId>quarkus-smallrye-reactive-messaging-kafka</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.kafka</groupId>\n+      <artifactId>kafka-clients</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>com.google.guava</groupId>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDk0MjExOA=="}, "originalCommit": {"oid": "e42eb2bacde8df5dea1bbcb78f5124d9ee994982"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1123, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}