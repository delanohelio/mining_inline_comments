{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMzc4NjU1", "number": 370, "title": "FAI-241: Model definition endpoint - UI changes", "bodyText": "See https://issues.redhat.com/browse/FAI-241\nThis PR adds a Model's namespace to the information stored for executions (it is already in TraceEvent but was not being persisted). We can then lookup a Model's definition from the executionId (that internally looks up the modelName and modelNamespace associated with the executionId and subsequently model using the modelId). REST endpoints changed accordingly. Model is now looked up with v1/executions/{executiondId}/model (let me know if you want versioning of the REST endpoint added now I've added a new path, i.e. v2/executions/{executionId}/model.. but for now this is all internal so didn't think we needed to worry too much about versioning the endpoint atm).\nMany thanks for submitting your Pull Request \u2764\ufe0f!\nPlease make sure that your PR meets the following requirements:\n\n You have read the contributors guide\n Pull Request title is properly formatted: KOGITO-XYZ Subject\n Pull Request title contains the target branch if not targeting master: [0.9.x] KOGITO-XYZ Subject\n Pull Request contains link to the JIRA issue\n Pull Request contains link to any dependent or related Pull Request\n Pull Request contains description of the issue\n Pull Request does not include fixes for issues other than the main ticket", "createdAt": "2020-08-05T13:19:15Z", "url": "https://github.com/kiegroup/kogito-apps/pull/370", "merged": true, "mergeCommit": {"oid": "1e1ee7d2736e06c0a94e313d97cbd2e6241269f3"}, "closed": true, "closedAt": "2020-08-07T09:33:06Z", "author": {"login": "manstis"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc77JtUgBqjM2MjQ2NTA2ODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8g-h8AFqTQ2MzE2ODgwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "512b20de7699b7b67447043266bfb8ecca71ead2", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/512b20de7699b7b67447043266bfb8ecca71ead2", "committedDate": "2020-08-05T13:13:44Z", "message": "FAI-241: Model definition endpoint - UI changes"}, "afterCommit": {"oid": "41758c544601dfcefc9d9ca2d47252488b5a8b55", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/41758c544601dfcefc9d9ca2d47252488b5a8b55", "committedDate": "2020-08-05T13:22:23Z", "message": "FAI-241: Model definition endpoint - UI changes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "41758c544601dfcefc9d9ca2d47252488b5a8b55", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/41758c544601dfcefc9d9ca2d47252488b5a8b55", "committedDate": "2020-08-05T13:22:23Z", "message": "FAI-241: Model definition endpoint - UI changes"}, "afterCommit": {"oid": "afbce0d3afd028b0fcf94521240d72c682c09ac7", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/afbce0d3afd028b0fcf94521240d72c682c09ac7", "committedDate": "2020-08-05T13:25:29Z", "message": "FAI-241: Model definition endpoint - UI changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyMjc1OTcx", "url": "https://github.com/kiegroup/kogito-apps/pull/370#pullrequestreview-462275971", "createdAt": "2020-08-06T08:01:21Z", "commit": {"oid": "afbce0d3afd028b0fcf94521240d72c682c09ac7"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwODowMToyMVrOG8nwfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwODowMToyMVrOG8nwfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjIxOTEzMg==", "bodyText": "add TODO comment to replace null null?", "url": "https://github.com/kiegroup/kogito-apps/pull/370#discussion_r466219132", "createdAt": "2020-08-06T08:01:21Z", "author": {"login": "r00ta"}, "path": "trusty/trusty-service/src/main/java/org/kie/kogito/trusty/service/api/ExecutionsApiV1.java", "diffHunk": "@@ -142,4 +146,52 @@ private OffsetDateTime parseParameterDate(String date) {\n \n         return ZonedDateTime.parse(date, DateTimeFormatter.ISO_OFFSET_DATE_TIME).toOffsetDateTime();\n     }\n+\n+    /**\n+     * Gets the model associated with an execution.\n+     *\n+     * @param executionId The execution ID.\n+     * @return The model associated with the execution.\n+     */\n+    @GET\n+    @Path(\"/{executionId}/model\")\n+    @APIResponses(value = {\n+            @APIResponse(description = \"Gets the model associated with an execution.\", responseCode = \"200\", content = @Content(mediaType = MediaType.TEXT_PLAIN, schema = @Schema(type = SchemaType.STRING))),\n+            @APIResponse(description = \"Bad Request\", responseCode = \"400\", content = @Content(mediaType = MediaType.TEXT_PLAIN))\n+    }\n+    )\n+    @Operation(summary = \"Gets the model associated with an execution.\")\n+    @Produces(MediaType.TEXT_PLAIN)\n+    public Response getModel(\n+            @Parameter(\n+                    name = \"executionId\",\n+                    description = \"The execution ID.\",\n+                    required = true,\n+                    schema = @Schema(implementation = String.class)\n+            ) @PathParam(\"executionId\") String executionId) {\n+        return handleModelRequest(executionId);\n+    }\n+\n+    private Response handleModelRequest(String executionId) {\n+        return retrieveModel(executionId)\n+                .map(definition -> Response.ok(definition).build())\n+                .orElseGet(() -> Response.status(Response.Status.BAD_REQUEST.getStatusCode()).build());\n+    }\n+\n+    private Optional<String> retrieveModel(String executionId) {\n+        try {\n+            Optional<Decision> decision = retrieveDecision(executionId);\n+            return decision.map(d -> executionService.getModelById(ModelIdCreator.makeIdentifier(null, null, null, d.getExecutedModelName(), d.getExecutedModelNamespace())));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afbce0d3afd028b0fcf94521240d72c682c09ac7"}, "originalPosition": 61}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "afbce0d3afd028b0fcf94521240d72c682c09ac7", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/afbce0d3afd028b0fcf94521240d72c682c09ac7", "committedDate": "2020-08-05T13:25:29Z", "message": "FAI-241: Model definition endpoint - UI changes"}, "afterCommit": {"oid": "496ffb298c008b46093627f6e94a1d327fb6659c", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/496ffb298c008b46093627f6e94a1d327fb6659c", "committedDate": "2020-08-06T09:34:59Z", "message": "Add comment regarding GAV use in constructing modelId"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a48ecc9ce0101a1d90a0a645abee7113aee35b4", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/6a48ecc9ce0101a1d90a0a645abee7113aee35b4", "committedDate": "2020-08-07T07:18:41Z", "message": "FAI-241: Model definition endpoint - UI changes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "496ffb298c008b46093627f6e94a1d327fb6659c", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/496ffb298c008b46093627f6e94a1d327fb6659c", "committedDate": "2020-08-06T09:34:59Z", "message": "Add comment regarding GAV use in constructing modelId"}, "afterCommit": {"oid": "6a48ecc9ce0101a1d90a0a645abee7113aee35b4", "author": {"user": null}, "url": "https://github.com/kiegroup/kogito-apps/commit/6a48ecc9ce0101a1d90a0a645abee7113aee35b4", "committedDate": "2020-08-07T07:18:41Z", "message": "FAI-241: Model definition endpoint - UI changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMTQ0NjU2", "url": "https://github.com/kiegroup/kogito-apps/pull/370#pullrequestreview-463144656", "createdAt": "2020-08-07T08:51:28Z", "commit": {"oid": "6a48ecc9ce0101a1d90a0a645abee7113aee35b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMTU2MDcz", "url": "https://github.com/kiegroup/kogito-apps/pull/370#pullrequestreview-463156073", "createdAt": "2020-08-07T09:07:56Z", "commit": {"oid": "6a48ecc9ce0101a1d90a0a645abee7113aee35b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMTU4ODUw", "url": "https://github.com/kiegroup/kogito-apps/pull/370#pullrequestreview-463158850", "createdAt": "2020-08-07T09:12:02Z", "commit": {"oid": "6a48ecc9ce0101a1d90a0a645abee7113aee35b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMTY4ODA4", "url": "https://github.com/kiegroup/kogito-apps/pull/370#pullrequestreview-463168808", "createdAt": "2020-08-07T09:26:48Z", "commit": {"oid": "6a48ecc9ce0101a1d90a0a645abee7113aee35b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4975, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}