{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA5NjIzOTI0", "number": 7040, "title": "Fix Shared Database Tests", "bodyText": "Fix FieldChangeEvent Delta computation\nThe CoarseChangeFilter only reports delta >0 as Major change.\nThe problem is that when you codewise set new field content with the same exact length as before, but not the same content it still has a delta of 0 and therefore no DB sync is triggered.\nA more detailed explanation is #6862 (comment)\nFixes #6862\n\n\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-10-25T16:52:55Z", "url": "https://github.com/JabRef/jabref/pull/7040", "merged": true, "mergeCommit": {"oid": "b5bcea4506b034975de3363a12efb7d56caa9f01"}, "closed": true, "closedAt": "2020-11-03T18:54:55Z", "author": {"login": "Siedlerchr"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWCp63AH2gAyNTA5NjIzOTI0OjE4ODA1YjE0Mjk3NTlhMzA2OTQ4YTUyMDYzOTRjZmIyMTJlNTBhYWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY9FHigH2gAyNTA5NjIzOTI0OmJhYzlmZjlkOWY3NjNjNTZiY2YyYjM1NTBmZTk0MzhjOTIyNzYzM2U=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "18805b1429759a306948a5206394cfb212e50aae", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/18805b1429759a306948a5206394cfb212e50aae", "committedDate": "2020-10-25T16:49:10Z", "message": "Fix Shared Database Tests\n\nFix FieldChangeEvent Delta computation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2NjA4MzYy", "url": "https://github.com/JabRef/jabref/pull/7040#pullrequestreview-516608362", "createdAt": "2020-10-26T09:44:04Z", "commit": {"oid": "18805b1429759a306948a5206394cfb212e50aae"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQwOTo0NDowNFrOHoHsdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQwOTo0NjozNlrOHoHydg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgzMTE1Ng==", "bodyText": "why not newValue.length() == oldValue.length() ?", "url": "https://github.com/JabRef/jabref/pull/7040#discussion_r511831156", "createdAt": "2020-10-26T09:44:04Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/model/entry/event/FieldChangedEvent.java", "diffHunk": "@@ -61,10 +61,12 @@ public FieldChangedEvent(FieldChange fieldChange) {\n     private int computeDelta(String oldValue, String newValue) {\n         if (oldValue == newValue) {\n             return 0;\n-        } else if (oldValue == null && newValue != null) {\n+        } else if ((oldValue == null) && (newValue != null)) {\n             return newValue.length();\n-        } else if (newValue == null && oldValue != null) {\n+        } else if ((newValue == null) && (oldValue != null)) {\n             return oldValue.length();\n+        } else if ((Math.abs(newValue.length() - oldValue.length()) == 0) && !oldValue.equals(newValue)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18805b1429759a306948a5206394cfb212e50aae"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTgzMjY5NA==", "bodyText": "How is the delta value used? Maybe we need to calculate the actual difference between the strings here? I.e. the delta of aaaa and aabb is 2 and not 4", "url": "https://github.com/JabRef/jabref/pull/7040#discussion_r511832694", "createdAt": "2020-10-26T09:46:36Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/model/entry/event/FieldChangedEvent.java", "diffHunk": "@@ -61,10 +61,12 @@ public FieldChangedEvent(FieldChange fieldChange) {\n     private int computeDelta(String oldValue, String newValue) {\n         if (oldValue == newValue) {\n             return 0;\n-        } else if (oldValue == null && newValue != null) {\n+        } else if ((oldValue == null) && (newValue != null)) {\n             return newValue.length();\n-        } else if (newValue == null && oldValue != null) {\n+        } else if ((newValue == null) && (oldValue != null)) {\n             return oldValue.length();\n+        } else if ((Math.abs(newValue.length() - oldValue.length()) == 0) && !oldValue.equals(newValue)) {\n+            return newValue.length();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18805b1429759a306948a5206394cfb212e50aae"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b704e2d95699ee5f454c9ec76d5aa376099209d", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/7b704e2d95699ee5f454c9ec76d5aa376099209d", "committedDate": "2020-10-26T18:44:29Z", "message": "Use length directly foir comparision"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c4d410c05a9f7130d89c78071892d7eb544026c", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/0c4d410c05a9f7130d89c78071892d7eb544026c", "committedDate": "2020-10-28T07:30:19Z", "message": "Merge remote-tracking branch 'upstream/master' into sharedbtest\n\n* upstream/master:\n  Bump mockito-core from 3.5.13 to 3.5.15 (#7044)\n  Bump styfle/cancel-workflow-action from 0.5.0 to 0.6.0 (#7047)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b15ed5b37b4967d0bae2534105c1c1cb7461027", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/1b15ed5b37b4967d0bae2534105c1c1cb7461027", "committedDate": "2020-11-03T08:04:27Z", "message": "Merge remote-tracking branch 'upstream/master' into sharedbtest\n\n* upstream/master:\n  Fix 4040 link\n  Bump java-diff-utils from 4.8 to 4.9 (#7061)\n  Bump bcprov-jdk15on from 1.66 to 1.67 (#7063)\n  Bump checkstyle from 8.36.2 to 8.37 (#7064)\n  Bump mockito-core from 3.5.15 to 3.6.0 (#7067)\n  Bump controlsfx from 11.0.2 to 11.0.3 (#7066)\n  Squashed 'src/main/resources/csl-styles/' changes from 5297abd6fc..5c376b838b\n  add short date formatter (#7039)\n  Add awt native open commands (#7037)\n  Add online-link detection to FileFieldParser (#7043)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83fc123c56a7ef8ded0b58e797e35608a10475f3", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/83fc123c56a7ef8ded0b58e797e35608a10475f3", "committedDate": "2020-11-03T15:57:18Z", "message": "Merge remote-tracking branch 'upstream/master' into sharedbtest\n\n* upstream/master:\n  Bump unirest-java from 3.11.02 to 3.11.03 (#7060)\n  Bump xmlunit-matchers from 2.7.0 to 2.8.0 (#7062)\n  Bump xmlunit-core from 2.7.0 to 2.8.0 (#7065)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27674f358953bac903d9d77a749d67e1e1f1a1bd", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/27674f358953bac903d9d77a749d67e1e1f1a1bd", "committedDate": "2020-11-03T17:30:15Z", "message": "upgrade postgres to 13\nrename delta to majorCharacterChange"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bac9ff9d9f763c56bcf2b3550fe9438c9227633e", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/bac9ff9d9f763c56bcf2b3550fe9438c9227633e", "committedDate": "2020-11-03T18:01:13Z", "message": "revert unrelated change"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4948, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}