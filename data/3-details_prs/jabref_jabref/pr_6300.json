{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0NjgzNDE5", "number": 6300, "title": "Remove dash from illegal characters.", "bodyText": "Fixes #6295, Fixes #6257, Fixes #6252.\n\n\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-04-16T20:10:09Z", "url": "https://github.com/JabRef/jabref/pull/6300", "merged": true, "mergeCommit": {"oid": "2af41eb82353e37e2a6730485dc76276457fd4af"}, "closed": true, "closedAt": "2020-05-06T13:27:05Z", "author": {"login": "dextep"}, "timelineItems": {"totalCount": 47, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYSZkYgH2gAyNDA0NjgzNDE5OjJiN2ZhZDUzODYwNTRjZTkxZjBiOWZhYThlMWYwYmVkZWZlOGU4ZDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceoqpuAFqTQwNjYwOTQ0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2b7fad5386054ce91f0b9faa8e1f0bedefe8e8d5", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/2b7fad5386054ce91f0b9faa8e1f0bedefe8e8d5", "committedDate": "2020-04-16T20:06:29Z", "message": "Remove dash from illegal characters. Fix #6295 #6257 #6252"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0OTc1MTIx", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-394975121", "createdAt": "2020-04-16T20:28:50Z", "commit": {"oid": "2b7fad5386054ce91f0b9faa8e1f0bedefe8e8d5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMDoyODo1MFrOGG1-Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQyMDoyOTowN1rOGG1-2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTgyODkxMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),\\\\\\\"#~^:'`\u02b9\";\n          \n          \n            \n                private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),=\\\\\\\"#%~'`\u02b9\";\n          \n      \n    \n    \n  \n\nI read the linked issues and especially https://tex.stackexchange.com/a/408548/9075. I adaopted the list accordingly (added % and =; removed ^). Additionally, I left the quotes at the end.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r409828911", "createdAt": "2020-04-16T20:28:50Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -27,7 +27,7 @@\n      */\n     public static final String APPENDIX_CHARACTERS = \"abcdefghijklmnopqrstuvwxyz\";\n     private static final Logger LOGGER = LoggerFactory.getLogger(BibtexKeyGenerator.class);\n-    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),\\\\\\\"-#~^:'`\u02b9\";\n+    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),\\\\\\\"#~^:'`\u02b9\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b7fad5386054ce91f0b9faa8e1f0bedefe8e8d5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTgyOTA4Mw==", "bodyText": "Why didn't you remove the - it here?", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r409829083", "createdAt": "2020-04-16T20:29:07Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -27,7 +27,7 @@\n      */\n     public static final String APPENDIX_CHARACTERS = \"abcdefghijklmnopqrstuvwxyz\";\n     private static final Logger LOGGER = LoggerFactory.getLogger(BibtexKeyGenerator.class);\n-    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),\\\\\\\"-#~^:'`\u02b9\";\n+    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),\\\\\\\"#~^:'`\u02b9\";\n     private static final String KEY_UNWANTED_CHARACTERS = \"{}(),\\\\\\\"-\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b7fad5386054ce91f0b9faa8e1f0bedefe8e8d5"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f332e4245fa195c48d8ad7fb87ce9bcdd6e9de0a", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/f332e4245fa195c48d8ad7fb87ce9bcdd6e9de0a", "committedDate": "2020-04-17T13:10:24Z", "message": "Update bibtexkey incompatible characters.\n\nCo-Authored-By: Oliver Kopp <kopp.dev@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38687aa432d81f5ba933169da0891d28a0653dd6", "author": {"user": {"login": "mayrmt", "name": "Matthias Mayr"}}, "url": "https://github.com/JabRef/jabref/commit/38687aa432d81f5ba933169da0891d28a0653dd6", "committedDate": "2020-04-17T13:19:23Z", "message": "Add missing abbreviated journal names (#6292)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "feb6709427f81f72bd3ebdd95f53f04e6c8281b1", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/feb6709427f81f72bd3ebdd95f53f04e6c8281b1", "committedDate": "2020-04-17T13:38:26Z", "message": " Change in CHANGELOG.md described."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23d9720dc7673a7a541b284a400a97318c35190d", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/23d9720dc7673a7a541b284a400a97318c35190d", "committedDate": "2020-04-17T13:49:19Z", "message": "Revert \"Add missing abbreviated journal names (#6292)\"\n\nThis reverts commit 38687aa4"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NTkwMTk4", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-395590198", "createdAt": "2020-04-17T16:14:05Z", "commit": {"oid": "23d9720dc7673a7a541b284a400a97318c35190d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NzQyODcz", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-395742873", "createdAt": "2020-04-17T20:11:21Z", "commit": {"oid": "23d9720dc7673a7a541b284a400a97318c35190d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMDoxMToyMVrOGHbpwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMDoxMTo1MlrOGHbqkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ0NjI3NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - We fixed an issue with incompatible characters at BibTeX-Key [#6257](https://github.com/JabRef/jabref/issues/6257)\n          \n          \n            \n            - We fixed an issue with incompatible characters at BibTeX key [#6257](https://github.com/JabRef/jabref/issues/6257)", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r410446274", "createdAt": "2020-04-17T20:11:21Z", "author": {"login": "koppor"}, "path": "CHANGELOG.md", "diffHunk": "@@ -28,6 +28,8 @@ Note that this project **does not** adhere to [Semantic Versioning](http://semve\n \n ### Fixed\n \n+- We fixed an issue with incompatible characters at BibTeX-Key [#6257](https://github.com/JabRef/jabref/issues/6257)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23d9720dc7673a7a541b284a400a97318c35190d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ0NjQ4MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - We fixed an issue where dash was reported as illegal BibTeX-Key [#6295](https://github.com/JabRef/jabref/issues/6295)\n          \n          \n            \n            - We fixed an issue where dash (`-`) was reported as illegal BibTeX key [#6295](https://github.com/JabRef/jabref/issues/6295)", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r410446480", "createdAt": "2020-04-17T20:11:52Z", "author": {"login": "koppor"}, "path": "CHANGELOG.md", "diffHunk": "@@ -28,6 +28,8 @@ Note that this project **does not** adhere to [Semantic Versioning](http://semve\n \n ### Fixed\n \n+- We fixed an issue with incompatible characters at BibTeX-Key [#6257](https://github.com/JabRef/jabref/issues/6257)\n+- We fixed an issue where dash was reported as illegal BibTeX-Key [#6295](https://github.com/JabRef/jabref/issues/6295)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23d9720dc7673a7a541b284a400a97318c35190d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a90ac6049f904afe53e401b633a467b4f0b97f6f", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/a90ac6049f904afe53e401b633a467b4f0b97f6f", "committedDate": "2020-04-17T22:21:24Z", "message": "Update CHANGELOG.md\n\nCo-Authored-By: Oliver Kopp <kopp.dev@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed42ac17a0080734378b61bc82c8feec766143ed", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/ed42ac17a0080734378b61bc82c8feec766143ed", "committedDate": "2020-04-17T22:21:32Z", "message": "Update CHANGELOG.md\n\nCo-Authored-By: Oliver Kopp <kopp.dev@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fc964554b037782dd23338097c236c37ef71416", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/6fc964554b037782dd23338097c236c37ef71416", "committedDate": "2020-04-17T22:40:13Z", "message": "Renamed 'KEY_UNWANTED_CHARACTERS' to 'KEY_CHARACTERS_CAUSING_PARSING_ERRORS'."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1ODM3MDQx", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-395837041", "createdAt": "2020-04-18T00:36:25Z", "commit": {"oid": "6fc964554b037782dd23338097c236c37ef71416"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQwMDozNjoyNVrOGHge_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQwMDozNjo0M1rOGHgfMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUyNTQzOQ==", "bodyText": "Could you please add a comment here referencing https://tex.stackexchange.com/a/408548/9075?\nProposal:\n// Source of illegal characters: https://tex.stackexchange.com/a/408548/9075", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r410525439", "createdAt": "2020-04-18T00:36:25Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -24,11 +24,12 @@\n public class BibtexKeyGenerator extends BracketedPattern {\n     /*\n      * All single characters that we can use for extending a key to make it unique.\n+     * KEY_CHARACTERS_CAUSING_PARSING_ERRORS is a subset of KEY_ILLEGAL_CHARACTERS\n      */\n     public static final String APPENDIX_CHARACTERS = \"abcdefghijklmnopqrstuvwxyz\";\n     private static final Logger LOGGER = LoggerFactory.getLogger(BibtexKeyGenerator.class);\n-    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),\\\\\\\"-#~^:'`\u02b9\";\n-    private static final String KEY_UNWANTED_CHARACTERS = \"{}(),\\\\\\\"-\";\n+    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),=\\\\\\\"#%~'`\u02b9\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc964554b037782dd23338097c236c37ef71416"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUyNTQ4OQ==", "bodyText": "Please remove - here, too. Otherwise, the subset property does not hold.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r410525489", "createdAt": "2020-04-18T00:36:43Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -24,11 +24,12 @@\n public class BibtexKeyGenerator extends BracketedPattern {\n     /*\n      * All single characters that we can use for extending a key to make it unique.\n+     * KEY_CHARACTERS_CAUSING_PARSING_ERRORS is a subset of KEY_ILLEGAL_CHARACTERS\n      */\n     public static final String APPENDIX_CHARACTERS = \"abcdefghijklmnopqrstuvwxyz\";\n     private static final Logger LOGGER = LoggerFactory.getLogger(BibtexKeyGenerator.class);\n-    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),\\\\\\\"-#~^:'`\u02b9\";\n-    private static final String KEY_UNWANTED_CHARACTERS = \"{}(),\\\\\\\"-\";\n+    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),=\\\\\\\"#%~'`\u02b9\";\n+    private static final String KEY_CHARACTERS_CAUSING_PARSING_ERRORS = \"{}(),\\\\\\\"-\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc964554b037782dd23338097c236c37ef71416"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00f8c927c195c599e10f8df70a0edef605411418", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/00f8c927c195c599e10f8df70a0edef605411418", "committedDate": "2020-04-22T19:55:14Z", "message": "Merged illegal `KEY_ILLEGAL_CHARACTERS` and disallowed `KEY_CHARACTERS_CAUSING_PARSING_ERRORS` into `KEY_DISALLOWED_CHARACTERS` and removed: ` \u02b9.\nAdded new KEY_UNWANTED_CHARACTERS."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e39cca3362f88101a488c638aaf5c90217ae90a5", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/e39cca3362f88101a488c638aaf5c90217ae90a5", "committedDate": "2020-04-23T00:36:17Z", "message": "Adapted the tests according to code updates."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NzU2ODgw", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-398756880", "createdAt": "2020-04-23T04:50:07Z", "commit": {"oid": "e39cca3362f88101a488c638aaf5c90217ae90a5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNDo1MDowN1rOGKWb0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNDo1Mjo0NlrOGKWfPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzUwNjUxNQ==", "bodyText": "Oh, wow, did not expect that. See my review comment on allowing characters breaking the parsing of a .bib file.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r413506515", "createdAt": "2020-04-23T04:50:07Z", "author": {"login": "koppor"}, "path": "src/test/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGeneratorTest.java", "diffHunk": "@@ -943,14 +943,14 @@ void crossrefkeywordsNKeywordsSeparatedBySpace() {\n     @Test\n     void testCheckLegalKeyEnforceLegal() {\n         assertEquals(\"AAAA\", BibtexKeyGenerator.cleanKey(\"AA AA\", true));\n-        assertEquals(\"SPECIALCHARS\", BibtexKeyGenerator.cleanKey(\"SPECIAL CHARS#{\\\\\\\"}~,^\", true));\n+        assertEquals(\"SPECIALCHARS\", BibtexKeyGenerator.cleanKey(\"SPECIAL CHARS#{\\\\\\\"}~,\", true));\n         assertEquals(\"\", BibtexKeyGenerator.cleanKey(\"\\n\\t\\r\", true));\n     }\n \n     @Test\n     void testCheckLegalKeyDoNotEnforceLegal() {\n         assertEquals(\"AAAA\", BibtexKeyGenerator.cleanKey(\"AA AA\", false));\n-        assertEquals(\"SPECIALCHARS#~^\", BibtexKeyGenerator.cleanKey(\"SPECIAL CHARS#{\\\\\\\"}~,^\", false));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e39cca3362f88101a488c638aaf5c90217ae90a5"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzUwNzM4OQ==", "bodyText": "This change is strange. Arn read better than A\u00b4r. Unsure, what the other reviewers think here. -- On the one hand, this is an example that keeping as much characters as possible might not be good. On the other hand, we have the cleanup funtionality for BibTeX keys, which can be used by users.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r413507389", "createdAt": "2020-04-23T04:52:46Z", "author": {"login": "koppor"}, "path": "src/test/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGeneratorTest.java", "diffHunk": "@@ -239,7 +239,7 @@ void testMakeLabelAndCheckLegalKeysAccentGrave() throws ParseException {\n \n         entry0 = BibtexParser.singleFromString(\"@ARTICLE{kohn, author={Andr\u00e9s A\u02b9rnold}, year={2000}}\",\n                 importFormatPreferences, fileMonitor);\n-        assertEquals(\"Arn\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e39cca3362f88101a488c638aaf5c90217ae90a5"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNTE4MzE1", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-400518315", "createdAt": "2020-04-26T15:43:49Z", "commit": {"oid": "e39cca3362f88101a488c638aaf5c90217ae90a5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxNTo0Mzo0OVrOGMGPgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxNTo0Mzo0OVrOGMGPgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTMzODM3MA==", "bodyText": "Can you please convert this into a List<Character>. Should be slightly more readable as the characters are then clearly distinguishable from each other.\nAlso the KEY prefix seems unnecessary as we are in the KeyGenerator class anyway.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r415338370", "createdAt": "2020-04-26T15:43:49Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -27,8 +27,9 @@\n      */\n     public static final String APPENDIX_CHARACTERS = \"abcdefghijklmnopqrstuvwxyz\";\n     private static final Logger LOGGER = LoggerFactory.getLogger(BibtexKeyGenerator.class);\n-    private static final String KEY_ILLEGAL_CHARACTERS = \"{}(),\\\\\\\"-#~^:'`\u02b9\";\n-    private static final String KEY_UNWANTED_CHARACTERS = \"{}(),\\\\\\\"-\";\n+    // Source of DISALLOWED characters: https://tex.stackexchange.com/a/408548/9075\n+    private static final String KEY_DISALLOWED_CHARACTERS = \"{}(),=\\\\\\\"#%~'\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e39cca3362f88101a488c638aaf5c90217ae90a5"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "471ec0e11c71d74e0bfaaa4a9250f27b82a5d32c", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/471ec0e11c71d74e0bfaaa4a9250f27b82a5d32c", "committedDate": "2020-04-28T22:39:27Z", "message": "Removed 'enforceLegalKey'.\nChanged 'KEY_ILLEGAL_CHARACTERS' and 'KEY_UNWANTED_CHARACTERS'.\nUpdated tests.\nChanged error warning about disallowed characters."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/19e0879bd99349e48b3fb0e9c761b753e615795d", "committedDate": "2020-05-01T18:00:04Z", "message": "Removed \"Enforce legal characters in BibTeX keys\" option in the preferences (General tab).\nRemoved 'ENFORCE_LEGAL_BIBTEX_KEY' from JabRefPreferences.java.\nAdded \"Remove the following characters:\" field in \"BibTeX key generator\" tab in the preferences for the unwanted characters.\nAdded 'DEFAULT_UNWANTED_BIBTEX_KEY_CHARACTERS' to JabRefPreferences.java as defaults.\nRevert 'avoidOverwritingCiteKey' - mistakenly removed in previous commit from BibtexKeyPatternPreferences.java."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MzA4NjA0", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-404308604", "createdAt": "2020-05-01T18:03:37Z", "commit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxODowMzozOFrOGPRJnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxODowMzozOFrOGPRJnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY2MjgxMw==", "bodyText": "How should i pass UnwantedCharacters here?", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r418662813", "createdAt": "2020-05-01T18:03:38Z", "author": {"login": "dextep"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -54,7 +54,8 @@ static String generateKey(BibEntry entry, String pattern) {\n     static String generateKey(BibEntry entry, String pattern, BibDatabase database) {\n         GlobalBibtexKeyPattern keyPattern = new GlobalBibtexKeyPattern(Collections.emptyList());\n         keyPattern.setDefaultValue(\"[\" + pattern + \"]\");\n-        return new BibtexKeyGenerator(keyPattern, database, new BibtexKeyPatternPreferences(\"\", \"\", false, true, true, keyPattern, ','))\n+        String unwantedCharacters = \"-`\u02b9:!;?^+\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MzEyMzYx", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-404312361", "createdAt": "2020-05-01T18:10:21Z", "commit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxODoxMDoyMlrOGPRVVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxODoxMDoyMlrOGPRVVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY2NTgxMg==", "bodyText": "Here ValidBibtexKeyChecker cannot depend on org.jabref.Globals, but if i pass it using be BibtexKeyPatternPreferences.java, FieldCheckers class have to take BibtexKeyPatternPreferences instance also. would this solution be correct?", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r418665812", "createdAt": "2020-05-01T18:10:22Z", "author": {"login": "dextep"}, "path": "src/main/java/org/jabref/logic/integrity/ValidBibtexKeyChecker.java", "diffHunk": "@@ -17,7 +18,7 @@\n             return Optional.of(Localization.lang(\"empty BibTeX key\"));\n         }\n \n-        String cleaned = BibtexKeyGenerator.cleanKey(value);\n+        String cleaned = BibtexKeyGenerator.cleanKey(value, Globals.prefs.getUnwantedCharacters());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NDE5NDI0", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-404419424", "createdAt": "2020-05-01T21:53:06Z", "commit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQyMTo1MzowNlrOGPWtWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQyMjowMDo0NVrOGPW25A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc1Mzg4MQ==", "bodyText": "It's a bit ugly, but I guess it's ok to leave it like that because the two static methods shouldn't be used anyway. If you could be so nice, please add a @Deprecated annotation to them.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r418753881", "createdAt": "2020-05-01T21:53:06Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -54,7 +54,8 @@ static String generateKey(BibEntry entry, String pattern) {\n     static String generateKey(BibEntry entry, String pattern, BibDatabase database) {\n         GlobalBibtexKeyPattern keyPattern = new GlobalBibtexKeyPattern(Collections.emptyList());\n         keyPattern.setDefaultValue(\"[\" + pattern + \"]\");\n-        return new BibtexKeyGenerator(keyPattern, database, new BibtexKeyPatternPreferences(\"\", \"\", false, true, true, keyPattern, ','))\n+        String unwantedCharacters = \"-`\u02b9:!;?^+\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY2MjgxMw=="}, "originalCommit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc1NTA4Mw==", "bodyText": "I think you should use preferences.getBibtexKeyPatternPreferences().getUnwantedCharacters() here as the second argument, right?", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r418755083", "createdAt": "2020-05-01T21:56:48Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/importer/fileformat/EndnoteImporter.java", "diffHunk": "@@ -232,8 +232,7 @@ public ParserResult importDatabase(BufferedReader reader) throws IOException {\n                         type = StandardEntryType.MastersThesis;\n                     }\n                 } else if (\"F\".equals(prefix)) {\n-                    hm.put(InternalField.KEY_FIELD, BibtexKeyGenerator.cleanKey(val,\n-                            preferences.getBibtexKeyPatternPreferences().isEnforceLegalKey()));\n+                    hm.put(InternalField.KEY_FIELD, BibtexKeyGenerator.cleanKey(val, \"-`\u02b9:!;?^+\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc1NTY1NQ==", "bodyText": "Luckily, you can simply pass an empty string here since the integrity check shouldn't warn about unwanted characters. (This is what I meant with my somewhat cryptic text the other day).", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r418755655", "createdAt": "2020-05-01T21:58:38Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/integrity/ValidBibtexKeyChecker.java", "diffHunk": "@@ -17,7 +18,7 @@\n             return Optional.of(Localization.lang(\"empty BibTeX key\"));\n         }\n \n-        String cleaned = BibtexKeyGenerator.cleanKey(value);\n+        String cleaned = BibtexKeyGenerator.cleanKey(value, Globals.prefs.getUnwantedCharacters());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY2NTgxMg=="}, "originalCommit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc1NTk5MQ==", "bodyText": "Can you please remove the DEFAULT prefix (as it is not a default value for something, but the real thing).", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r418755991", "createdAt": "2020-05-01T21:59:37Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/preferences/JabRefPreferences.java", "diffHunk": "@@ -214,6 +214,7 @@\n     // Currently, it is not possible to specify defaults for specific entry types\n     // When this should be made possible, the code to inspect is org.jabref.gui.preferences.BibtexKeyPatternPrefTab.storeSettings() -> LabelPattern keypatterns = getCiteKeyPattern(); etc\n     public static final String DEFAULT_BIBTEX_KEY_PATTERN = \"defaultBibtexKeyPattern\";\n+    public static final String DEFAULT_UNWANTED_BIBTEX_KEY_CHARACTERS = \"defaultUnwantedBibtexKeyCharacters\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc1NjMyNA==", "bodyText": "I think the second argument can be replaced by preferences.getUnwantedCharacters().", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r418756324", "createdAt": "2020-05-01T22:00:45Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/gui/customizefields/CustomizeGeneralFieldsDialogViewModel.java", "diffHunk": "@@ -57,12 +58,13 @@ public void saveFields() {\n                 return;\n             }\n \n-            String testString = BibtexKeyGenerator.cleanKey(parts[1], preferences.getEnforceLegalKeys());\n+            String testString = BibtexKeyGenerator.cleanKey(parts[1], Globals.prefs.get(JabRefPreferences.DEFAULT_UNWANTED_BIBTEX_KEY_CHARACTERS));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19e0879bd99349e48b3fb0e9c761b753e615795d"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2161cd14de9ba04034f26f80d86ab4230f63b7dc", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/2161cd14de9ba04034f26f80d86ab4230f63b7dc", "committedDate": "2020-05-02T21:49:14Z", "message": "Changes related to the review."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae8b18394df222ced31150d5c32f4d8ab5220524", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/ae8b18394df222ced31150d5c32f4d8ab5220524", "committedDate": "2020-05-03T16:06:31Z", "message": "Remove dash from illegal characters. Fix #6295 #6257 #6252"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08257ffdde4ab0c76823672fa42e59914cf20853", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/08257ffdde4ab0c76823672fa42e59914cf20853", "committedDate": "2020-05-03T16:06:31Z", "message": "Update bibtexkey incompatible characters.\n\nCo-Authored-By: Oliver Kopp <kopp.dev@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0e52417387d1d31aaf2cb66cf0ef24cfa57acc3", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/d0e52417387d1d31aaf2cb66cf0ef24cfa57acc3", "committedDate": "2020-05-03T16:06:31Z", "message": " Change in CHANGELOG.md described."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a510e3dd9cca6020965f3ce64eb9d7cd5fc7d99", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/8a510e3dd9cca6020965f3ce64eb9d7cd5fc7d99", "committedDate": "2020-05-03T16:06:31Z", "message": "Revert \"Add missing abbreviated journal names (#6292)\"\n\nThis reverts commit 38687aa4"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7d5ac7bf79648fc1207c05d7491cd2485587f8b", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/d7d5ac7bf79648fc1207c05d7491cd2485587f8b", "committedDate": "2020-05-03T16:06:31Z", "message": "Update CHANGELOG.md\n\nCo-Authored-By: Oliver Kopp <kopp.dev@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dda32599b8b12155f24bef1ddbb11cff3fcf5d05", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/dda32599b8b12155f24bef1ddbb11cff3fcf5d05", "committedDate": "2020-05-03T16:06:31Z", "message": "Update CHANGELOG.md\n\nCo-Authored-By: Oliver Kopp <kopp.dev@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7362457ddc6a5818aff8d67906e436d80516087c", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/7362457ddc6a5818aff8d67906e436d80516087c", "committedDate": "2020-05-03T16:06:31Z", "message": "Renamed 'KEY_UNWANTED_CHARACTERS' to 'KEY_CHARACTERS_CAUSING_PARSING_ERRORS'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe430206717ed4266e85b807e157608bf68820ac", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/fe430206717ed4266e85b807e157608bf68820ac", "committedDate": "2020-05-03T16:06:31Z", "message": "Merged illegal `KEY_ILLEGAL_CHARACTERS` and disallowed `KEY_CHARACTERS_CAUSING_PARSING_ERRORS` into `KEY_DISALLOWED_CHARACTERS` and removed: ` \u02b9.\nAdded new KEY_UNWANTED_CHARACTERS."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aae2b0ed4d5d9252aa00f6e2879f7d66e2d6f7e0", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/aae2b0ed4d5d9252aa00f6e2879f7d66e2d6f7e0", "committedDate": "2020-05-03T16:06:31Z", "message": "Adapted the tests according to code updates."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4807493816ace90992943762d3201b243d1b87ed", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/4807493816ace90992943762d3201b243d1b87ed", "committedDate": "2020-05-03T16:10:43Z", "message": "Removed 'enforceLegalKey'.\nChanged 'KEY_ILLEGAL_CHARACTERS' and 'KEY_UNWANTED_CHARACTERS'.\nUpdated tests.\nChanged error warning about disallowed characters."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b1ca1a8379aaf81dde804f8c749dd0ede81af67", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/0b1ca1a8379aaf81dde804f8c749dd0ede81af67", "committedDate": "2020-05-03T16:21:15Z", "message": "Removed \"Enforce legal characters in BibTeX keys\" option in the preferences (General tab).\nRemoved 'ENFORCE_LEGAL_BIBTEX_KEY' from JabRefPreferences.java.\nAdded \"Remove the following characters:\" field in \"BibTeX key generator\" tab in the preferences for the unwanted characters.\nAdded 'DEFAULT_UNWANTED_BIBTEX_KEY_CHARACTERS' to JabRefPreferences.java as defaults.\nRevert 'avoidOverwritingCiteKey' - mistakenly removed in previous commit from BibtexKeyPatternPreferences.java."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d64b9118b11b8e9f74cf1a4072cc7b86b987d1af", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/d64b9118b11b8e9f74cf1a4072cc7b86b987d1af", "committedDate": "2020-05-03T16:21:15Z", "message": "Changes related to the review."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6032766d40eb6cd8423235052d95cd7b7c67499d", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/6032766d40eb6cd8423235052d95cd7b7c67499d", "committedDate": "2020-05-03T16:50:41Z", "message": "Changes related to the review."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "995ff608aa8b5e1d251fa62691878f134a300c36", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/995ff608aa8b5e1d251fa62691878f134a300c36", "committedDate": "2020-05-03T17:02:54Z", "message": "Merge branch 'remove-dash-from-illegal-chars' of https://github.com/dextep/jabref into remove-dash-from-illegal-chars\n\n# Conflicts:\n#\tsrc/main/java/org/jabref/gui/customizefields/CustomizeGeneralFieldsDialogViewModel.java\n#\tsrc/main/java/org/jabref/gui/integrity/IntegrityCheckAction.java\n#\tsrc/test/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGeneratorTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d3719579ff9a1a88f25825134b9dab8a3482efc", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/4d3719579ff9a1a88f25825134b9dab8a3482efc", "committedDate": "2020-05-04T19:17:07Z", "message": "Merge remote-tracking branch 'upstream/master' into remove-dash-from-illegal-chars"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00", "committedDate": "2020-05-05T01:48:31Z", "message": "Fix checkstyle.\nFix unit tests."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NTUxOTQw", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-405551940", "createdAt": "2020-05-05T07:33:12Z", "commit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwNzozMzoxMlrOGQdnHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwNzo0MToyN1rOGQd2dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxNTU1MQ==", "bodyText": "This line is a duplicate.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r419915551", "createdAt": "2020-05-05T07:33:12Z", "author": {"login": "tobiasdiez"}, "path": "CHANGELOG.md", "diffHunk": "@@ -33,6 +33,9 @@ Note that this project **does not** adhere to [Semantic Versioning](http://semve\n ### Fixed\n \n - We fixed wrong button order (Apply and Cancel) in ManageProtectedTermsDialog.\n+- We fixed an issue with incompatible characters at BibTeX-Key [#6257](https://github.com/JabRef/jabref/issues/6257)\n+- We fixed an issue with incompatible characters at BibTeX key [#6257](https://github.com/JabRef/jabref/issues/6257)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxNjAwNQ==", "bodyText": "Please add the removal of the \"enforce legal key\" option under \"Removed\".", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r419916005", "createdAt": "2020-05-05T07:34:07Z", "author": {"login": "tobiasdiez"}, "path": "CHANGELOG.md", "diffHunk": "@@ -33,6 +33,9 @@ Note that this project **does not** adhere to [Semantic Versioning](http://semve\n ### Fixed\n \n - We fixed wrong button order (Apply and Cancel) in ManageProtectedTermsDialog.\n+- We fixed an issue with incompatible characters at BibTeX-Key [#6257](https://github.com/JabRef/jabref/issues/6257)\n+- We fixed an issue with incompatible characters at BibTeX key [#6257](https://github.com/JabRef/jabref/issues/6257)\n+- We fixed an issue where dash (`-`) was reported as illegal BibTeX key [#6295](https://github.com/JabRef/jabref/issues/6295)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxNzQyNA==", "bodyText": "I think the changes in this file needs to be reverted, as they don't seem to be related to this PR (probably a merge problem).", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r419917424", "createdAt": "2020-05-05T07:37:15Z", "author": {"login": "tobiasdiez"}, "path": "src/main/resources/journals/journalList.csv", "diffHunk": "@@ -3310,7 +3308,7 @@ Climate Dynamics;Climate Dyn.;;\n Climate of the Past;Clim. Past;;\n Climate of the Past Discussion;Clim. Past Discuss.;;\n Climate Risk Management;Clim. Risk Manage.;;\n-Climatic Change;Clim. Change;;\n+Climatic Change;Climatic Change;;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxODE0OQ==", "bodyText": "Please extract \"-\u02b9:!;?^+\"to a public constantDEFAULT_UNWANTED_CHARACTERSinBibtexKeyGenerator` and use it everywhere.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r419918149", "createdAt": "2020-05-05T07:38:44Z", "author": {"login": "tobiasdiez"}, "path": "src/test/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGeneratorTest.java", "diffHunk": "@@ -73,7 +73,7 @@ void testCrossrefAndInAuthorNames() throws Exception {\n \n         assertEquals(\"Holland\",\n                 BibtexKeyGenerator.cleanKey(BibtexKeyGenerator.generateKey(entry1, \"auth\",\n-                        database), true));\n+                        database), \"-`\u02b9:!;?^+\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxODg5MA==", "bodyText": "These tests need to be adapted, at least there names.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r419918890", "createdAt": "2020-05-05T07:40:14Z", "author": {"login": "tobiasdiez"}, "path": "src/test/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGeneratorTest.java", "diffHunk": "@@ -942,22 +942,22 @@ void crossrefkeywordsNKeywordsSeparatedBySpace() {\n \n     @Test\n     void testCheckLegalKeyEnforceLegal() {\n-        assertEquals(\"AAAA\", BibtexKeyGenerator.cleanKey(\"AA AA\", true));\n-        assertEquals(\"SPECIALCHARS\", BibtexKeyGenerator.cleanKey(\"SPECIAL CHARS#{\\\\\\\"}~,^\", true));\n-        assertEquals(\"\", BibtexKeyGenerator.cleanKey(\"\\n\\t\\r\", true));\n+        assertEquals(\"AAAA\", BibtexKeyGenerator.cleanKey(\"AA AA\", \"-`\u02b9:!;?^+\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00"}, "originalPosition": 337}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxOTQ3OQ==", "bodyText": "I think it's better to use an empty string as the unwanted characters here, instead of changing the expected value. Otherwise this test is exactly the same as the previous.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r419919479", "createdAt": "2020-05-05T07:41:27Z", "author": {"login": "tobiasdiez"}, "path": "src/test/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGeneratorTest.java", "diffHunk": "@@ -942,22 +942,22 @@ void crossrefkeywordsNKeywordsSeparatedBySpace() {\n \n     @Test\n     void testCheckLegalKeyEnforceLegal() {\n-        assertEquals(\"AAAA\", BibtexKeyGenerator.cleanKey(\"AA AA\", true));\n-        assertEquals(\"SPECIALCHARS\", BibtexKeyGenerator.cleanKey(\"SPECIAL CHARS#{\\\\\\\"}~,^\", true));\n-        assertEquals(\"\", BibtexKeyGenerator.cleanKey(\"\\n\\t\\r\", true));\n+        assertEquals(\"AAAA\", BibtexKeyGenerator.cleanKey(\"AA AA\", \"-`\u02b9:!;?^+\"));\n+        assertEquals(\"SPECIALCHARS\", BibtexKeyGenerator.cleanKey(\"SPECIAL CHARS#{\\\\\\\"}~,\", \"-`\u02b9:!;?^+\"));\n+        assertEquals(\"\", BibtexKeyGenerator.cleanKey(\"\\n\\t\\r\", \"-`\u02b9:!;?^+\"));\n     }\n \n     @Test\n     void testCheckLegalKeyDoNotEnforceLegal() {\n-        assertEquals(\"AAAA\", BibtexKeyGenerator.cleanKey(\"AA AA\", false));\n-        assertEquals(\"SPECIALCHARS#~^\", BibtexKeyGenerator.cleanKey(\"SPECIAL CHARS#{\\\\\\\"}~,^\", false));\n-        assertEquals(\"\", BibtexKeyGenerator.cleanKey(\"\\n\\t\\r\", false));\n+        assertEquals(\"AAAA\", BibtexKeyGenerator.cleanKey(\"AA AA\", \"-`\u02b9:!;?^+\"));\n+        assertEquals(\"SPECIALCHARS\", BibtexKeyGenerator.cleanKey(\"SPECIAL CHARS#{\\\\\\\"}~,^\", \"-`\u02b9:!;?^+\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00"}, "originalPosition": 348}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6db1344b410eb133c436951df8211353fa66c633", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/6db1344b410eb133c436951df8211353fa66c633", "committedDate": "2020-05-05T19:27:45Z", "message": "Changes related to the review."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MTY2NTc4", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-406166578", "createdAt": "2020-05-05T21:24:51Z", "commit": {"oid": "6db1344b410eb133c436951df8211353fa66c633"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MzE5OTAz", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-406319903", "createdAt": "2020-05-06T05:56:55Z", "commit": {"oid": "6db1344b410eb133c436951df8211353fa66c633"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwNTo1Njo1NVrOGRE8hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwNzowMDozNlrOGRGQtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2MDAwNg==", "bodyText": "I miss this addition.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r420560006", "createdAt": "2020-05-06T05:56:55Z", "author": {"login": "koppor"}, "path": "CHANGELOG.md", "diffHunk": "@@ -33,6 +33,9 @@ Note that this project **does not** adhere to [Semantic Versioning](http://semve\n ### Fixed\n \n - We fixed wrong button order (Apply and Cancel) in ManageProtectedTermsDialog.\n+- We fixed an issue with incompatible characters at BibTeX-Key [#6257](https://github.com/JabRef/jabref/issues/6257)\n+- We fixed an issue with incompatible characters at BibTeX key [#6257](https://github.com/JabRef/jabref/issues/6257)\n+- We fixed an issue where dash (`-`) was reported as illegal BibTeX key [#6295](https://github.com/JabRef/jabref/issues/6295)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxNjAwNQ=="}, "originalCommit": {"oid": "3f5b2e58ba99ee3acd7d068d9dff14ddbd3fdc00"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU4MTU1Ng==", "bodyText": "Please replace the code:\n        String newKey = key.chars()\n                .filter(c -> unwantedCharacters.indexOf(c) == -1)\n                .filter(c -> !DISALLOWED_CHARACTERS.contains((char) c))\n                .collect(StringBuilder::new,\n                        StringBuilder::appendCodePoint, StringBuilder::append)\n                .toString();\n\nI came up while thinking as follows (and stack-overflow-ing for String filter characters, ...). Used answer: https://stackoverflow.com/a/20268845/873282\nWhy not a simple indexOf thing?\n\"abcdef\".indexOf('c') != -1;\nSee https://stackoverflow.com/a/506107/873282.\nSecond reason: Conversion into the list is IMHO more CPU consuming than the indexOf call. I know, that it is not critical, but I think, the conversion (plus the readble !unwantedChars.contains(c)) is less readable then a simple (unwantedChars.indexOf(c) >= 0)", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r420581556", "createdAt": "2020-05-06T07:00:36Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -73,36 +77,26 @@ private static String getAppendix(int number) {\n         }\n     }\n \n-    public static String removeUnwantedCharacters(String key, boolean enforceLegalKey) {\n-        if (!enforceLegalKey) {\n-            // User doesn't want us to enforce legal characters. We must still look\n-            // for whitespace and some characters such as commas, since these would\n-            // interfere with parsing:\n-            StringBuilder newKey = new StringBuilder();\n-            for (int i = 0; i < key.length(); i++) {\n-                char c = key.charAt(i);\n-                if (KEY_UNWANTED_CHARACTERS.indexOf(c) == -1) {\n-                    newKey.append(c);\n-                }\n-            }\n-            return newKey.toString();\n+    public static String removeUnwantedCharacters(String key, String unwantedCharacters) {\n+        List<Character> unwantedChars = new ArrayList<>();\n+        for (char ch : unwantedCharacters.toCharArray()) {\n+            unwantedChars.add(ch);\n         }\n \n         StringBuilder newKey = new StringBuilder();\n         for (int i = 0; i < key.length(); i++) {\n             char c = key.charAt(i);\n-            if (KEY_ILLEGAL_CHARACTERS.indexOf(c) == -1) {\n+            if (!DISALLOWED_CHARACTERS.contains(c) && !unwantedChars.contains(c)) {\n                 newKey.append(c);\n             }\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6db1344b410eb133c436951df8211353fa66c633"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1ec4add7fa8992d79185f0230329ee904bb6227", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/c1ec4add7fa8992d79185f0230329ee904bb6227", "committedDate": "2020-05-06T12:59:09Z", "message": "Changes related to the review."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NTk1MTUw", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-406595150", "createdAt": "2020-05-06T13:10:22Z", "commit": {"oid": "c1ec4add7fa8992d79185f0230329ee904bb6227"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NTk4NTg2", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-406598586", "createdAt": "2020-05-06T13:14:25Z", "commit": {"oid": "c1ec4add7fa8992d79185f0230329ee904bb6227"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxMzoxNDoyNVrOGRSWng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxMzoxNDoyNVrOGRSWng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDc3OTY3OA==", "bodyText": "We don't need the unwantedChars variable, do we? Can you please delete that for loop and the variable? --> the code on line 86 directly accesses the method parameter unwantedChararacters!\nSide note: This is an example why similar variable names can be mixed up.", "url": "https://github.com/JabRef/jabref/pull/6300#discussion_r420779678", "createdAt": "2020-05-06T13:14:25Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BibtexKeyGenerator.java", "diffHunk": "@@ -82,17 +82,15 @@ public static String removeUnwantedCharacters(String key, String unwantedCharact\n         for (char ch : unwantedCharacters.toCharArray()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1ec4add7fa8992d79185f0230329ee904bb6227"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfeea59722afa6ad4e8eda64fe4e63dd78dfc1b8", "author": {"user": {"login": "dextep", "name": "Grzegorz Popiel"}}, "url": "https://github.com/JabRef/jabref/commit/cfeea59722afa6ad4e8eda64fe4e63dd78dfc1b8", "committedDate": "2020-05-06T13:17:33Z", "message": "Changes related to the review."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NjA5NDQ1", "url": "https://github.com/JabRef/jabref/pull/6300#pullrequestreview-406609445", "createdAt": "2020-05-06T13:26:36Z", "commit": {"oid": "cfeea59722afa6ad4e8eda64fe4e63dd78dfc1b8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 335, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}