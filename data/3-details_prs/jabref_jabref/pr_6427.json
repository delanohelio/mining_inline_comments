{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNzM5MjQx", "number": 6427, "title": "Add truncate as a BibTex key modifier", "bodyText": "Fixes #3915. Adds a truncate modifier to the available BibTex key modifiers. For \"A Title\" the bracketed pattern [title:truncate3] produces the result \"A T\".\n\nThe syntax is truncateN ([title:truncate5]) to mimic the pattern of authN etc.\n\nRemaining\n\n See if layered expressions are reasonable to implement, e.g., [[auth][title]:truncate10]\n Update changelog\n Documentation\n\nThings I am not sure about\n\n Should truncate be a formatter(org.jabref/logic/formatter)? Currently, formatters does not accept arguments\n The interaction between BibTex key generation and truncate might lead to unexpected results as whitespaces are removed after truncation. Unless this is considered obvious, it should perhaps be mentioned in the documentation of truncate. E.g., for \"A Title\", [title:truncate3] will lead to the bibtexkey \"AT\"\n Should this be included in the changelog?\n There were a BracketedPatternTest in org.jabref/logic/util/. Is there a correct location for the BracketedPatternTest?\n\n\nOthers\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-05-05T20:35:08Z", "url": "https://github.com/JabRef/jabref/pull/6427", "merged": true, "mergeCommit": {"oid": "16d4938b72919e7454fb23633d3d8e53f16f38b5"}, "closed": true, "closedAt": "2020-05-13T07:38:26Z", "author": {"login": "k3KAW8Pnf7mkmdSMPHz27"}, "timelineItems": {"totalCount": 46, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceX1q9gH2gAyNDEzNzM5MjQxOjZhZTg1MGFiNjI4YmVjNjAwYTUzN2FhZDQ0N2QwNGE2OTU0NjVkMDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgz4QkAFqTQxMDY2Mjg2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6ae850ab628bec600a537aad447d04a695465d06", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/6ae850ab628bec600a537aad447d04a695465d06", "committedDate": "2020-05-05T17:50:15Z", "message": "Add modifier to truncate a BibTex key"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19fbbb379f549068bead2f19a53b6fe37efd770c", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/19fbbb379f549068bead2f19a53b6fe37efd770c", "committedDate": "2020-05-05T17:52:31Z", "message": "Add tests for the truncate BibTex key modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efb5e7268be478c80b8e5f32d94c578e9d9cb1db", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/efb5e7268be478c80b8e5f32d94c578e9d9cb1db", "committedDate": "2020-05-05T19:39:57Z", "message": "Revert \"Add tests for the truncate BibTex key modifier\"\n\nThis reverts commit 19fbbb37\n\nThe tests were placed in the wrong file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87b4bad72960c006415f78da42de8ad5f3b12dcb", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/87b4bad72960c006415f78da42de8ad5f3b12dcb", "committedDate": "2020-05-05T20:21:16Z", "message": "Add tests for the truncate bracketed pattern modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fb49e3315ff3649b2ed5ec1bd23d39929d6d3d4", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/8fb49e3315ff3649b2ed5ec1bd23d39929d6d3d4", "committedDate": "2020-05-05T20:32:11Z", "message": "Remove unnecessary imports in the test for the truncate bracketed pattern modifier"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MzE0MDg1", "url": "https://github.com/JabRef/jabref/pull/6427#pullrequestreview-406314085", "createdAt": "2020-05-06T05:37:15Z", "commit": {"oid": "8fb49e3315ff3649b2ed5ec1bd23d39929d6d3d4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwNTozNzoxNVrOGREn1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwNTozNzoxNVrOGREn1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU1NDcxMA==", "bodyText": "Check style will complain in Java, variables should be Lower camel case", "url": "https://github.com/JabRef/jabref/pull/6427#discussion_r420554710", "createdAt": "2020-05-06T05:37:15Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/logic/bibtexkeypattern/BracketedPattern.java", "diffHunk": "@@ -377,6 +377,11 @@ static String applyModifiers(final String label, final List<String> parts, final\n                     }\n                 }\n                 resultingLabel = abbreviateSB.toString();\n+            } else if (modifier.matches(\"truncate[\\\\d]+\")) {\n+                // Truncate by keeping the first N characters and remove trailing white spaces.\n+                int N = Integer.parseInt(modifier.substring(8));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8fb49e3315ff3649b2ed5ec1bd23d39929d6d3d4"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b39ec9881d88ecfca4b4e319d42143b0f89e8489", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/b39ec9881d88ecfca4b4e319d42143b0f89e8489", "committedDate": "2020-05-06T17:27:39Z", "message": "Fix code style of local variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "572f724de4db44a9834f719273199bde26080631", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/572f724de4db44a9834f719273199bde26080631", "committedDate": "2020-05-06T18:43:41Z", "message": "Refactor BracketedPatternTest to maintain a parallel directory structure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e52aff90ae38cd1e9d90673d796e53568f53140", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/7e52aff90ae38cd1e9d90673d796e53568f53140", "committedDate": "2020-05-06T20:24:09Z", "message": "Refactor test for the truncate BibTex key modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f23e888ba86d2dfe3a3f14cf8710c7b4a240a26e", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/f23e888ba86d2dfe3a3f14cf8710c7b4a240a26e", "committedDate": "2020-05-06T20:35:27Z", "message": "Drop unused and unnecessary imports from BracketedPatternTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "895f302610527cd2c5b5f22e8a628d75e5920756", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/895f302610527cd2c5b5f22e8a628d75e5920756", "committedDate": "2020-05-07T19:39:12Z", "message": "Refactor truncate modifier to be compatible with Formatters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e54476b1ffd41578657b902a3e6952a92939b72", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/4e54476b1ffd41578657b902a3e6952a92939b72", "committedDate": "2020-05-07T19:39:48Z", "message": "Fix type in truncate modifier test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3ODE2NDAw", "url": "https://github.com/JabRef/jabref/pull/6427#pullrequestreview-407816400", "createdAt": "2020-05-07T20:35:21Z", "commit": {"oid": "895f302610527cd2c5b5f22e8a628d75e5920756"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDozNToyMVrOGSPQOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDozNToyMVrOGSPQOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc3NzQ2NA==", "bodyText": "I don't understand if there is an advantage of making the key public static final rather than  private final as it is used for both equals and hashcode? Setting the KEY = \"truncate\" + truncateIndex as it is already handled as a separate case in Formatters.getFormatterForModifier(commented above).", "url": "https://github.com/JabRef/jabref/pull/6427#discussion_r421777464", "createdAt": "2020-05-07T20:35:21Z", "author": {"login": "k3KAW8Pnf7mkmdSMPHz27"}, "path": "src/main/java/org/jabref/logic/formatter/minifier/TruncateFormatter.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package org.jabref.logic.formatter.minifier;\n+\n+import org.jabref.logic.l10n.Localization;\n+import org.jabref.model.cleanup.Formatter;\n+\n+public class TruncateFormatter extends Formatter {\n+    public static final String KEY = \"truncate\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "895f302610527cd2c5b5f22e8a628d75e5920756"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3ODE3NDQ1", "url": "https://github.com/JabRef/jabref/pull/6427#pullrequestreview-407817445", "createdAt": "2020-05-07T20:36:56Z", "commit": {"oid": "895f302610527cd2c5b5f22e8a628d75e5920756"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDozNjo1NlrOGSPTZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMDozNjo1NlrOGSPTZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc3ODI3Ng==", "bodyText": "Special check because it requires numeric input.", "url": "https://github.com/JabRef/jabref/pull/6427#discussion_r421778276", "createdAt": "2020-05-07T20:36:56Z", "author": {"login": "k3KAW8Pnf7mkmdSMPHz27"}, "path": "src/main/java/org/jabref/logic/formatter/Formatters.java", "diffHunk": "@@ -102,6 +103,9 @@ private Formatters() {\n         if (modifier.startsWith(RegexFormatter.KEY)) {\n             String regex = modifier.substring(RegexFormatter.KEY.length());\n             return Optional.of(new RegexFormatter(regex));\n+        } else if (modifier.matches(TruncateFormatter.KEY + \"\\\\d+\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "895f302610527cd2c5b5f22e8a628d75e5920756"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ace66bf52212998a3e833f12984df9de50b125c", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/9ace66bf52212998a3e833f12984df9de50b125c", "committedDate": "2020-05-07T20:58:54Z", "message": "Add check for Null in format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cceb55d1223e5fc15c0816572b70a9ae7e02bd0a", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/cceb55d1223e5fc15c0816572b70a9ae7e02bd0a", "committedDate": "2020-05-08T14:30:09Z", "message": "Refactor tests for truncate modifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e35e79d10b868996c5564c506fec88ee502d7e20", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/e35e79d10b868996c5564c506fec88ee502d7e20", "committedDate": "2020-05-08T14:31:34Z", "message": "Add truncation for long directory names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b48bc4681ec44c142ce371633812dd062596b482", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/b48bc4681ec44c142ce371633812dd062596b482", "committedDate": "2020-05-08T14:47:03Z", "message": "Fix name and documentation of createDirNameFromPattern"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NDQzMTYy", "url": "https://github.com/JabRef/jabref/pull/6427#pullrequestreview-408443162", "createdAt": "2020-05-08T18:41:24Z", "commit": {"oid": "895f302610527cd2c5b5f22e8a628d75e5920756"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxODo0MToyNFrOGSvk4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxODo0MToyNFrOGSvk4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjMwNzA0Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public static final String KEY = \"truncate\";\n          \n          \n            \n                private static final String KEY = \"truncate\";", "url": "https://github.com/JabRef/jabref/pull/6427#discussion_r422307043", "createdAt": "2020-05-08T18:41:24Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/logic/formatter/minifier/TruncateFormatter.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package org.jabref.logic.formatter.minifier;\n+\n+import org.jabref.logic.l10n.Localization;\n+import org.jabref.model.cleanup.Formatter;\n+\n+public class TruncateFormatter extends Formatter {\n+    public static final String KEY = \"truncate\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "895f302610527cd2c5b5f22e8a628d75e5920756"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6f2bf9c8da72af56c0a7e6302d6d7c2c37b2636", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/d6f2bf9c8da72af56c0a7e6302d6d7c2c37b2636", "committedDate": "2020-05-08T18:48:30Z", "message": "Update src/main/java/org/jabref/logic/formatter/minifier/TruncateFormatter.java\n\nCo-authored-by: Christoph <cschwentker@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a04bf2655be123a6a5124d4c9f1a8d4c29f24ea", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/2a04bf2655be123a6a5124d4c9f1a8d4c29f24ea", "committedDate": "2020-05-08T20:39:57Z", "message": "Fix matching the modifier String to a TruncateFormatter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f8cc56a1c901c9f749e5a00c43b191a7653e1fc", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/5f8cc56a1c901c9f749e5a00c43b191a7653e1fc", "committedDate": "2020-05-08T20:42:13Z", "message": "Fix encapsulation and naming in TruncateFormatter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "544a05dd1320f0ffbf8b162032aac472ec2a5612", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/544a05dd1320f0ffbf8b162032aac472ec2a5612", "committedDate": "2020-05-08T20:42:31Z", "message": "Fix JavaDoc in TruncateFormatter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30a8688e71b3b501463b7962c87af53309537026", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/30a8688e71b3b501463b7962c87af53309537026", "committedDate": "2020-05-08T20:43:45Z", "message": "Merge branch 'fix-for-issue-3915' of https://github.com/k3KAW8Pnf7mkmdSMPHz27/jabref into fix-for-issue-3915\n\n\u0001 Conflicts:\n\u0001\tsrc/main/java/org/jabref/logic/formatter/minifier/TruncateFormatter.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "deeaf2b74b24198a17e68449181969b3d7ae1378", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/deeaf2b74b24198a17e68449181969b3d7ae1378", "committedDate": "2020-05-08T21:40:04Z", "message": "Add changes to CHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c518562c092af61c269adb1b4df2e5abad2d95d2", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/c518562c092af61c269adb1b4df2e5abad2d95d2", "committedDate": "2020-05-08T21:56:16Z", "message": "Merge branch 'master' into fix-for-issue-3915"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NTUxMzIw", "url": "https://github.com/JabRef/jabref/pull/6427#pullrequestreview-408551320", "createdAt": "2020-05-08T21:58:32Z", "commit": {"oid": "c518562c092af61c269adb1b4df2e5abad2d95d2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQyMTo1ODozMlrOGS088A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQyMTo1ODozMlrOGS088A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM5NTEyMA==", "bodyText": "maybe also add a test with invalid data and negative values", "url": "https://github.com/JabRef/jabref/pull/6427#discussion_r422395120", "createdAt": "2020-05-08T21:58:32Z", "author": {"login": "Siedlerchr"}, "path": "src/test/java/org/jabref/logic/formatter/minifier/TruncateFormatterTest.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.jabref.logic.formatter.minifier;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+/**\n+ * Tests in addition to the general tests from {@link org.jabref.logic.formatter.FormatterTest}\n+ */\n+public class TruncateFormatterTest {\n+    private final String TITLE = \"A Title\";\n+\n+    @Test\n+    void truncateModifierWorksWith0Length() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c518562c092af61c269adb1b4df2e5abad2d95d2"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1677b7736e49059023ae9c8332e743e3c14ae65", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/d1677b7736e49059023ae9c8332e743e3c14ae65", "committedDate": "2020-05-09T21:30:58Z", "message": "Fix createDirNameFromPattern to verify names of subfolders"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d1c54b5121809f45491818841edf5c1d58f5964", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/7d1c54b5121809f45491818841edf5c1d58f5964", "committedDate": "2020-05-09T21:32:11Z", "message": "Add tests for long directory names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6678568270ba4637d90513787a4a8bf9d17fe88", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/d6678568270ba4637d90513787a4a8bf9d17fe88", "committedDate": "2020-05-09T21:45:44Z", "message": "Fix truncate with negative integer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93470e28a11ee9a207547161630e9a855f8ef3a5", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/93470e28a11ee9a207547161630e9a855f8ef3a5", "committedDate": "2020-05-09T22:15:46Z", "message": "Add test with negative index"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d97d35f5b35daa2e82cd0854def248898b5a745", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/5d97d35f5b35daa2e82cd0854def248898b5a745", "committedDate": "2020-05-09T22:16:42Z", "message": "Add test with invalid data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47be1367dff64f2ebbb9b22dd24e9b54f57d2cba", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/47be1367dff64f2ebbb9b22dd24e9b54f57d2cba", "committedDate": "2020-05-09T22:18:43Z", "message": "Refactor names of truncate tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1af7775c884bf4db2f5c76978d9e350b6229822", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/b1af7775c884bf4db2f5c76978d9e350b6229822", "committedDate": "2020-05-11T13:23:49Z", "message": "Add TruncateFormatter to general Formatter tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20487a55be3adc9ae06e7a2cb94596413762215d", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/20487a55be3adc9ae06e7a2cb94596413762215d", "committedDate": "2020-05-11T13:24:38Z", "message": "Fix truncate with negative index"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d501d5d3aad012e74f4082ded92b5c10776af168", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/d501d5d3aad012e74f4082ded92b5c10776af168", "committedDate": "2020-05-11T13:28:38Z", "message": "Merge remote-tracking branch 'origin/fix-for-issue-3915' into fix-for-issue-3915"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MTg4MzM2", "url": "https://github.com/JabRef/jabref/pull/6427#pullrequestreview-409188336", "createdAt": "2020-05-11T13:47:48Z", "commit": {"oid": "d1677b7736e49059023ae9c8332e743e3c14ae65"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxMzo0Nzo0OVrOGTdCkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxMzo0Nzo0OVrOGTdCkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA1MTkyMA==", "bodyText": "Note that on my system the maximum filename and directory name is 255 characters long while the absolute pathname appears to be limited to 1024 characters on FAT32.\nWindows appear to have a default maximum path length of 260 which I'd consider an argument for not including these lines.", "url": "https://github.com/JabRef/jabref/pull/6427#discussion_r423051920", "createdAt": "2020-05-11T13:47:49Z", "author": {"login": "k3KAW8Pnf7mkmdSMPHz27"}, "path": "src/main/java/org/jabref/logic/util/io/FileUtil.java", "diffHunk": "@@ -286,11 +286,13 @@ public static String createDirNameFromPattern(BibDatabase database, BibEntry ent\n             targetName = entry.getCiteKeyOptional().orElse(\"default\");\n         }\n \n-        // Removes illegal characters from filename\n+        // Removes illegal characters from directory name\n         targetName = FileNameCleaner.cleanDirectoryName(targetName);\n \n-        // Truncates long directory names\n-        targetName = getValidFileName(targetName);\n+        // Only use valid filenames for the directories in the path\n+        targetName = Arrays.stream(targetName.split(Pattern.quote(File.separator)))\n+                            .map(FileUtil::getValidFileName)\n+                            .collect(Collectors.joining(File.separator));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1677b7736e49059023ae9c8332e743e3c14ae65"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f7f2eed346ff961e9856aa185caad910671cfd0", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/1f7f2eed346ff961e9856aa185caad910671cfd0", "committedDate": "2020-05-11T14:24:39Z", "message": "Drop truncation of long directory names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59c24652658c9d59e73dad6e567c148563a0e0fa", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/59c24652658c9d59e73dad6e567c148563a0e0fa", "committedDate": "2020-05-11T15:10:16Z", "message": "Fix mating truncate in Formatters.java\n\nChange to use a precompiled pattern for matching 'truncateN'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "452ad9606811cbe35b1441fe018c7937bcf6c667", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/452ad9606811cbe35b1441fe018c7937bcf6c667", "committedDate": "2020-05-11T15:12:27Z", "message": "Fix matching `truncateN` in Formatters.java\n\nChange to use a precompiled pattern for matching 'truncateN'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d9caa4eca82db34f45ede211c742483faaad6d8", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/9d9caa4eca82db34f45ede211c742483faaad6d8", "committedDate": "2020-05-11T15:12:56Z", "message": "Merge branch 'fix-for-issue-3915' of https://github.com/k3KAW8Pnf7mkmdSMPHz27/jabref into fix-for-issue-3915"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d96513a20ba92ffc7b9d364c96db9b0d8d27d65", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/7d96513a20ba92ffc7b9d364c96db9b0d8d27d65", "committedDate": "2020-05-12T13:36:49Z", "message": "Merge branch 'master' into fix-for-issue-3915\n\n# Conflicts:\n#\tsrc/test/java/org/jabref/logic/bibtexkeypattern/BracketedPatternTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a7a2119688bf57ebee2261a49ca4f688721eb0c", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/6a7a2119688bf57ebee2261a49ca4f688721eb0c", "committedDate": "2020-05-12T13:44:36Z", "message": "Resolve conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDY2MDU4", "url": "https://github.com/JabRef/jabref/pull/6427#pullrequestreview-410066058", "createdAt": "2020-05-12T13:54:41Z", "commit": {"oid": "6a7a2119688bf57ebee2261a49ca4f688721eb0c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "859493c96d6371d88f706d4d02f85dfa6cb7d21e", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/859493c96d6371d88f706d4d02f85dfa6cb7d21e", "committedDate": "2020-05-12T13:55:43Z", "message": "Refactor truncate tests in BracketedPatternTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNjYyODYx", "url": "https://github.com/JabRef/jabref/pull/6427#pullrequestreview-410662861", "createdAt": "2020-05-13T07:38:16Z", "commit": {"oid": "859493c96d6371d88f706d4d02f85dfa6cb7d21e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 242, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}