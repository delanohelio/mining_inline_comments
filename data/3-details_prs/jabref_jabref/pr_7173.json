{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0NTU5NTc5", "number": 7173, "title": "Updates to colored group indicator for cited entries", "bodyText": "Fixes #6394.\nAn entry can belong to a specific group depending on,\n\nField or type in the BibEntry\nThe settings of the specific group\n\nHence, any changes in a field or type in the BibEntry, or any change in the groups should reevaluation wether or not the entry is still in any given group.\nI am not very comfortable with the JavaFX/MVVC structure yet, so I have attempted an approach with as few structural changes as possible.\n\n\n Keep the count \"badge\" is up-to-date\n Refresh the selected groups\n\n Deal with ConcurrentModificationException\n Fix performance bottleneck\n\n Occurs when switching library and the group is selected\n\n\n\n\n Check for potential memory leaks,\n\n caused by extending Observable in TexGroup.java (how should the listeners be stored?)\n dependence on deprecated method GroupTreeNode#setGroup(AbstractGroup newGroup)\n use of EventBus without unregistering listener\n\n Make a WeakInvalidationListener adapter?\n\n\n\n\n JabRef believes the .bib file has changed when the .aux file changes\n\n Check if the isFilteredOut attribute of BibDatabaseContextChangedEvent is used to prevent saving\n\n Add JavaDoc\n\n\n\n\n How does the current GroupInvalidationEvent affect the hierarchical group structure? (should it be fired from elsewhere so that only partial recalculations of group colors are necessary)\n Replace unnecessary adapter class\n\n\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-12-08T16:13:54Z", "url": "https://github.com/JabRef/jabref/pull/7173", "merged": true, "mergeCommit": {"oid": "4d8e4f0e1782af33e6e95c6ad6990b06d4e37c32"}, "closed": true, "closedAt": "2021-01-13T09:08:55Z", "author": {"login": "k3KAW8Pnf7mkmdSMPHz27"}, "timelineItems": {"totalCount": 41, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjRtskgH2gAyNTM0NTU5NTc5OjQyZGM5N2JmMmM3Zjg4ZmRjMDdlYzIxOWQ1YTBkYzQ1MWM3MWY5YWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdvsAE9gFqTU2NzAxNzE4Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "42dc97bf2c7f88fdc07ec219d5a0dc451c71f9ad", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/42dc97bf2c7f88fdc07ec219d5a0dc451c71f9ad", "committedDate": "2020-12-05T19:42:53Z", "message": "Fix matched groups binding\n\nMatched groups should update both on changes in the BibEntry and changes\n in groups."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b2c9b1c805e0e4b2cf3b15c0e1534fb6df155a2", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/9b2c9b1c805e0e4b2cf3b15c0e1534fb6df155a2", "committedDate": "2020-12-07T13:39:37Z", "message": "Code style and typos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72e75b6ccdfe5d785e3e0da45a6709d35cbe47be", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/72e75b6ccdfe5d785e3e0da45a6709d35cbe47be", "committedDate": "2020-12-08T20:13:28Z", "message": "Extend TexGroup with Observable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca85073afe1dc3afeb130edda0dfeab9fe7fdaf3", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/ca85073afe1dc3afeb130edda0dfeab9fe7fdaf3", "committedDate": "2020-12-08T20:18:52Z", "message": "Add missed code style change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55845ceba6b6f1e59c46f42202b5b85a0b3eb86c", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/55845ceba6b6f1e59c46f42202b5b85a0b3eb86c", "committedDate": "2020-12-14T17:51:49Z", "message": "Revert parts of matched groups binding"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxODIxNTI1", "url": "https://github.com/JabRef/jabref/pull/7173#pullrequestreview-551821525", "createdAt": "2020-12-14T19:26:15Z", "commit": {"oid": "42dc97bf2c7f88fdc07ec219d5a0dc451c71f9ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxOToyNjoxNlrOIFiiAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxOToyNjoxNlrOIFiiAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjY3OTU1NA==", "bodyText": "Here we can change the dependence to only be on StandardField.GROUPS again. It could be argued that this change is out of the scope of this PR and has potential performance effects.", "url": "https://github.com/JabRef/jabref/pull/7173#discussion_r542679554", "createdAt": "2020-12-14T19:26:16Z", "author": {"login": "k3KAW8Pnf7mkmdSMPHz27"}, "path": "src/main/java/org/jabref/gui/maintable/BibEntryTableViewModel.java", "diffHunk": "@@ -68,18 +71,29 @@ public BibEntry getEntry() {\n     }\n \n     private static ObservableValue<List<AbstractGroup>> createMatchedGroupsBinding(BibDatabaseContext database, BibEntry entry) {\n-        Optional<GroupTreeNode> root = database.getMetaData().getGroups();\n-        if (root.isPresent()) {\n-            return EasyBind.map(entry.getFieldBinding(StandardField.GROUPS), field -> {\n-                List<AbstractGroup> groups = root.get().getMatchingGroups(entry)\n-                                                 .stream()\n-                                                 .map(GroupTreeNode::getGroup)\n-                                                 .collect(Collectors.toList());\n-                groups.remove(root.get().getGroup());\n-                return groups;\n-            });\n-        }\n-        return new SimpleObjectProperty<>(Collections.emptyList());\n+        ObservableValue<List<AbstractGroup>> groupsBinding = new ObjectBinding<List<AbstractGroup>>() {\n+            {\n+                bind(entry.getFieldsObservable(), entry.typeProperty());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42dc97bf2c7f88fdc07ec219d5a0dc451c71f9ad"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5324fabc51b7c430e7ff0db770852d1bc568e86", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/e5324fabc51b7c430e7ff0db770852d1bc568e86", "committedDate": "2020-12-16T15:00:45Z", "message": "Change data structure of stored listeners"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0520009bed766f41209bc32f3ee26fde81a4140a", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/0520009bed766f41209bc32f3ee26fde81a4140a", "committedDate": "2020-12-16T15:05:08Z", "message": "Fix managing listeners of Observable groups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "beb1a3e9fa1ba1fe43bc2800afb06e6f8994d2f4", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/beb1a3e9fa1ba1fe43bc2800afb06e6f8994d2f4", "committedDate": "2020-12-16T15:59:47Z", "message": "Fix display of group count when using TexGroups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee7296e49a656927c383b2f395a65cf84679db28", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/ee7296e49a656927c383b2f395a65cf84679db28", "committedDate": "2020-12-16T18:52:54Z", "message": "Fix use of deprecated setGroup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20d5e168ed2b923568a5888c551a1bbb3fd5cbe3", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/20d5e168ed2b923568a5888c551a1bbb3fd5cbe3", "committedDate": "2020-12-16T18:54:08Z", "message": "Remove check for null value"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68a0a5d6f59320a539a71e24079002a286d52daf", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/68a0a5d6f59320a539a71e24079002a286d52daf", "committedDate": "2020-12-16T21:32:40Z", "message": "Fix execution thread"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2972a964549f313f9bf80f0bc581cd1b4c101ac", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/a2972a964549f313f9bf80f0bc581cd1b4c101ac", "committedDate": "2020-12-16T21:49:40Z", "message": "Fix updating entries in selected groups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d24c670b28687901cbc12978beb014b77478e3d", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/3d24c670b28687901cbc12978beb014b77478e3d", "committedDate": "2020-12-16T22:08:36Z", "message": "Fix concurrent modification issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca0c800ab71e85e2ead8132f8bba9e59b2c989b6", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/ca0c800ab71e85e2ead8132f8bba9e59b2c989b6", "committedDate": "2020-12-21T22:37:31Z", "message": "Merge branch 'master' into fix-for-issue-6394"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21f7aae5398fd6d910a9ba53ba2552aed0978b25", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/21f7aae5398fd6d910a9ba53ba2552aed0978b25", "committedDate": "2020-12-23T13:28:39Z", "message": "Add MetaData GroupUpdatedEvent without saving"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8501704b6793a3ba5bb5567aa177dff6f9a89afb", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/8501704b6793a3ba5bb5567aa177dff6f9a89afb", "committedDate": "2020-12-23T13:28:59Z", "message": "Merge branch 'master' into fix-for-issue-6394"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "536c96ba94117fa32dc2edd7af20ca60cf0c7c71", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/536c96ba94117fa32dc2edd7af20ca60cf0c7c71", "committedDate": "2020-12-23T14:05:48Z", "message": "Add a GroupInvalidatedEvent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54c7e3d0af6e9e61dd5d1cfed3faec4856941860", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/54c7e3d0af6e9e61dd5d1cfed3faec4856941860", "committedDate": "2020-12-23T16:08:07Z", "message": "Update JavaDoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45d8c22f6630a189a9b9c5f7db48ae241809903c", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/45d8c22f6630a189a9b9c5f7db48ae241809903c", "committedDate": "2020-12-23T20:08:28Z", "message": "Add EventBus adapter\n\nThe intended use is to register javafx.beans.InvalidationListener to\nGroupUpdatedEvent and GroupInvalidatedEvent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98ca673501817e1a7f868032b2f183355f189c81", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/98ca673501817e1a7f868032b2f183355f189c81", "committedDate": "2020-12-23T20:09:25Z", "message": "Fix invalidation listener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "410b8fa389cad103246a1e59cc438e3c46a70ca6", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/410b8fa389cad103246a1e59cc438e3c46a70ca6", "committedDate": "2020-12-23T20:10:23Z", "message": "Fix minor mistakes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2353e4dd18ef64a0d93b1a4c1da2120db439c12b", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/2353e4dd18ef64a0d93b1a4c1da2120db439c12b", "committedDate": "2020-12-23T20:43:43Z", "message": "Fix GroupInvalidatedEvent\n\nPosting a GroupUpdatedEvent will now notify listeners of\nGroupInvalidatedEvent as well."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d754190c0f2a638a0773cef617af638c7140ccef", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/d754190c0f2a638a0773cef617af638c7140ccef", "committedDate": "2020-12-23T20:48:17Z", "message": "Fix GroupInvalidatedEvent\n\nMissed changes in MetaData"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7fb44e0f6ef4970378f395001afc995c2387c09", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/c7fb44e0f6ef4970378f395001afc995c2387c09", "committedDate": "2020-12-23T20:49:30Z", "message": "Refactoring for readability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "338af181de1b5879bd007e9345bd5f6c66e819d6", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/338af181de1b5879bd007e9345bd5f6c66e819d6", "committedDate": "2020-12-26T15:53:21Z", "message": "Remove empty class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ced6720216a08d057c8e6d30c6fc0c3c11006875", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/ced6720216a08d057c8e6d30c6fc0c3c11006875", "committedDate": "2020-12-26T16:00:17Z", "message": "Add JavaDoc to GroupInvalidatedEventBusAdapter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f64b2158f3d241f963c313d0a5db5582cd3f8d05", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/f64b2158f3d241f963c313d0a5db5582cd3f8d05", "committedDate": "2020-12-28T14:32:18Z", "message": "Fix CheckStyle\n\nMy CheckStyle preferences were changed. It is now based on the getting\nstarted documentation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "996b0fe1bb04e31f4a235a1c9fc3e6a099178b2f", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/996b0fe1bb04e31f4a235a1c9fc3e6a099178b2f", "committedDate": "2020-12-28T19:57:13Z", "message": "Fix using an ObservableOptional root group wrapper"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "996329fc136f6c2359e42722a74fa8821fbc9aec", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/996329fc136f6c2359e42722a74fa8821fbc9aec", "committedDate": "2020-12-28T20:07:03Z", "message": "Refactor for readability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "605b6bdce094282ee2064830b5c243264a80c188", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/605b6bdce094282ee2064830b5c243264a80c188", "committedDate": "2020-12-28T20:09:12Z", "message": "Drop update for groups other than TexGroup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73d9af99c25b1f07dfe70c0119c43f400a47568b", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/73d9af99c25b1f07dfe70c0119c43f400a47568b", "committedDate": "2020-12-28T21:29:08Z", "message": "Change where switch to JavaFX thread occurs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwMzUyNjgz", "url": "https://github.com/JabRef/jabref/pull/7173#pullrequestreview-560352683", "createdAt": "2020-12-31T13:41:05Z", "commit": {"oid": "73d9af99c25b1f07dfe70c0119c43f400a47568b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMVQxMzo0MTowNVrOIM--Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMVQxMzo0MTowNVrOIM--Ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQ4NTUwNg==", "bodyText": "In the best case, the invalidation would bubble up automatically from the group along the whole tree. So somehing along the following lines:\n\nMake each Group an observable value that is invalidated when it's properties change. Could be done by making AbstractGroup derive from PreboundBinding, change keysUsedInAux to an observable set, and invoke super(keysUsedInAux) in the constructor\nInvalidate the grouptreenode as soon as the group is invalidated. Should be possible by letting TreeNode derive from PreboundBinding, and then use an extractor here https://github.com/JabRef/jabref/blob/master/src/main/java/org/jabref/model/TreeNode.java#L59 to invalidate the list, when one of the nodes changes.\nThen the root should be invalidated whenever one of the groups reports that is invalidate/changed.\n\nHowever, that is more work, so I'm fine with this top-down-approach for now as well.", "url": "https://github.com/JabRef/jabref/pull/7173#discussion_r550485506", "createdAt": "2020-12-31T13:41:05Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/model/groups/TexGroup.java", "diffHunk": "@@ -119,6 +120,7 @@ public Path getFilePath() {\n     public void fileUpdated() {\n         // Reset previous parse result\n         keysUsedInAux = null;\n+        DefaultTaskExecutor.runInJavaFXThread(() -> metaData.groupsBinding().invalidate());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73d9af99c25b1f07dfe70c0119c43f400a47568b"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d4847c0160bea43c35d065bb5762451887dce7c", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/9d4847c0160bea43c35d065bb5762451887dce7c", "committedDate": "2021-01-03T20:58:16Z", "message": "Add UiThread wrapper for groupsRootBinding"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34c98b32c5c2794dc45cbd0e3a0d89a5e01d8236", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/34c98b32c5c2794dc45cbd0e3a0d89a5e01d8236", "committedDate": "2021-01-03T22:13:01Z", "message": "Updates CHANGELOG.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4d051d2893f16146fdfb2093386c6369588accf", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/f4d051d2893f16146fdfb2093386c6369588accf", "committedDate": "2021-01-03T23:35:04Z", "message": "Merge branch 'master' into fix-for-issue-6394"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY0Nzc4OTM0", "url": "https://github.com/JabRef/jabref/pull/7173#pullrequestreview-564778934", "createdAt": "2021-01-09T11:57:53Z", "commit": {"oid": "f4d051d2893f16146fdfb2093386c6369588accf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOVQxMTo1Nzo1M1rOIQuDAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOVQxMjowMjowMVrOIQuKmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDQwMjU2Mw==", "bodyText": "The model and logic packages need to be free of gui stuff. The wrapping on the JavaFX thread should happen right before it is displayed.", "url": "https://github.com/JabRef/jabref/pull/7173#discussion_r554402563", "createdAt": "2021-01-09T11:57:53Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/model/metadata/MetaData.java", "diffHunk": "@@ -9,7 +9,11 @@\n import java.util.Objects;\n import java.util.Optional;\n \n+import javafx.beans.property.ObjectProperty;\n+import javafx.beans.property.SimpleObjectProperty;\n+\n import org.jabref.architecture.AllowedToUseLogic;\n+import org.jabref.gui.util.uithreadaware.UiThreadOptionalBinding;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4d051d2893f16146fdfb2093386c6369588accf"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDQwMzU4MQ==", "bodyText": "I would make groupsRoot already an OptionalObjectProperty", "url": "https://github.com/JabRef/jabref/pull/7173#discussion_r554403581", "createdAt": "2021-01-09T11:59:55Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/model/metadata/MetaData.java", "diffHunk": "@@ -51,7 +57,8 @@\n     private final Map<EntryType, String> citeKeyPatterns = new HashMap<>(); // <BibType, Pattern>\n     private final Map<String, String> userFileDirectory = new HashMap<>(); // <User, FilePath>\n     private final Map<String, Path> laTexFileDirectory = new HashMap<>(); // <User, FilePath>\n-    private GroupTreeNode groupsRoot;\n+    private final ObjectProperty<GroupTreeNode> groupsRoot = new SimpleObjectProperty<>(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4d051d2893f16146fdfb2093386c6369588accf"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDQwNDUwNw==", "bodyText": "@JabRef/developers Our architecture tests don't work anymore?! This is clearly a violation but the tests pass.", "url": "https://github.com/JabRef/jabref/pull/7173#discussion_r554404507", "createdAt": "2021-01-09T12:02:01Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/model/metadata/MetaData.java", "diffHunk": "@@ -9,7 +9,11 @@\n import java.util.Objects;\n import java.util.Optional;\n \n+import javafx.beans.property.ObjectProperty;\n+import javafx.beans.property.SimpleObjectProperty;\n+\n import org.jabref.architecture.AllowedToUseLogic;\n+import org.jabref.gui.util.uithreadaware.UiThreadOptionalBinding;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDQwMjU2Mw=="}, "originalCommit": {"oid": "f4d051d2893f16146fdfb2093386c6369588accf"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c98807db4bbe878efb8278268f2a0dbf182ca59", "author": {"user": {"login": "k3KAW8Pnf7mkmdSMPHz27", "name": "Jonatan Asketorp"}}, "url": "https://github.com/JabRef/jabref/commit/6c98807db4bbe878efb8278268f2a0dbf182ca59", "committedDate": "2021-01-10T23:37:23Z", "message": "Move the UI thread switch to View-Model"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1NTI1MzYw", "url": "https://github.com/JabRef/jabref/pull/7173#pullrequestreview-565525360", "createdAt": "2021-01-11T16:25:50Z", "commit": {"oid": "6c98807db4bbe878efb8278268f2a0dbf182ca59"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMVQxNjoyNTo1MFrOIRdLVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMVQxNjoyNTo1MFrOIRdLVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTE3NDc0Mw==", "bodyText": "Should this binding be modified to depend on any changes in the bibentry? #7325 depends on keyword field, instead of group field. Free text search depends on all fields. Should it be in a different PR? Personally I'd prefer if createMatchedGroupsBinding could be changed to return a FilteredList, but that would likely take me a while to implement...", "url": "https://github.com/JabRef/jabref/pull/7173#discussion_r555174743", "createdAt": "2021-01-11T16:25:50Z", "author": {"login": "k3KAW8Pnf7mkmdSMPHz27"}, "path": "src/main/java/org/jabref/gui/maintable/BibEntryTableViewModel.java", "diffHunk": "@@ -67,19 +69,15 @@ public BibEntry getEntry() {\n         return entry;\n     }\n \n-    private static ObservableValue<List<AbstractGroup>> createMatchedGroupsBinding(BibDatabaseContext database, BibEntry entry) {\n-        Optional<GroupTreeNode> root = database.getMetaData().getGroups();\n-        if (root.isPresent()) {\n-            return EasyBind.map(entry.getFieldBinding(StandardField.GROUPS), field -> {\n-                List<AbstractGroup> groups = root.get().getMatchingGroups(entry)\n-                                                 .stream()\n-                                                 .map(GroupTreeNode::getGroup)\n-                                                 .collect(Collectors.toList());\n-                groups.remove(root.get().getGroup());\n-                return groups;\n-            });\n-        }\n-        return new SimpleObjectProperty<>(Collections.emptyList());\n+    private static Binding<List<AbstractGroup>> createMatchedGroupsBinding(BibDatabaseContext database, BibEntry entry) {\n+        return new UiThreadBinding<>(EasyBind.combine(entry.getFieldBinding(StandardField.GROUPS), database.getMetaData().groupsBinding(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c98807db4bbe878efb8278268f2a0dbf182ca59"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1NjkwMDAx", "url": "https://github.com/JabRef/jabref/pull/7173#pullrequestreview-565690001", "createdAt": "2021-01-11T19:55:54Z", "commit": {"oid": "6c98807db4bbe878efb8278268f2a0dbf182ca59"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY3MDE3MTg3", "url": "https://github.com/JabRef/jabref/pull/7173#pullrequestreview-567017187", "createdAt": "2021-01-13T09:07:35Z", "commit": {"oid": "6c98807db4bbe878efb8278268f2a0dbf182ca59"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4895, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}