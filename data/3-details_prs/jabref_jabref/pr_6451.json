{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NDU1MzEx", "number": 6451, "title": "Removed BIB file directory from search when preferences has option unchecked", "bodyText": "Fixes #5891\nFor \"Automatically set file links\" feature, the BIB file directory is always added for search, even though the checkbox is not clicked. If the checkbox is clicked, it is added at first position in list of directories to search, which is expected behaviour. However, it is still added to list of directories to search even when checkbox is left unselected, which is faulty. I fixed this by removing code which adds the directory when preference is set to false.\nAlso, changed the text of the file preferences in order to make it clear that files will be searched only when the checkbox \"Search for files relative to BIB file location\" is selected. Also changing user documentation to reflect this text change - JabRef/user-documentation#283\nBefore:\n\nAfter:\n\n\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-05-08T22:12:53Z", "url": "https://github.com/JabRef/jabref/pull/6451", "merged": true, "mergeCommit": {"oid": "ffa07cdc25085f5fef0a9d760fdcadfcc7525a4c"}, "closed": true, "closedAt": "2020-05-28T16:42:20Z", "author": {"login": "silverhorse"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfZTuDAH2gAyNDE1NDU1MzExOmM4ZGEyNTZkODk0YjEyNGNkZDZhN2E5OTg4NjJhN2M4NTNkMDlkNmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclwcAlgH2gAyNDE1NDU1MzExOjZhMTk0MGY3MzM3MmQxNzZhMDM0MzNiMmU1YmViMGZlMWNmZDBhYzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c8da256d894b124cdd6a7a998862a7c853d09d6f", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/c8da256d894b124cdd6a7a998862a7c853d09d6f", "committedDate": "2020-05-08T22:06:54Z", "message": "Partial fix for issue 5891"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce3335776aca522f3cf4333032bd23a96a6b9551", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/ce3335776aca522f3cf4333032bd23a96a6b9551", "committedDate": "2020-05-09T21:02:34Z", "message": "Added more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3df1342bdb84ae24cb8233039f4791d67650c4ec", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/3df1342bdb84ae24cb8233039f4791d67650c4ec", "committedDate": "2020-05-09T21:17:50Z", "message": "Added more tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5ODU0ODcy", "url": "https://github.com/JabRef/jabref/pull/6451#pullrequestreview-409854872", "createdAt": "2020-05-12T09:18:21Z", "commit": {"oid": "3df1342bdb84ae24cb8233039f4791d67650c4ec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwOToxODoyMVrOGT9vlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwOToxODoyMVrOGT9vlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU4NzczMw==", "bodyText": "Why did you move the mockings here?", "url": "https://github.com/JabRef/jabref/pull/6451#discussion_r423587733", "createdAt": "2020-05-12T09:18:21Z", "author": {"login": "Siedlerchr"}, "path": "src/test/java/org/jabref/gui/externalfiles/AutoSetFileLinksUtilTest.java", "diffHunk": "@@ -30,24 +30,33 @@\n     private final BibDatabaseContext databaseContext = mock(BibDatabaseContext.class);\n     private final ExternalFileTypes externalFileTypes = mock(ExternalFileTypes.class);\n     private final BibEntry entry = new BibEntry(StandardEntryType.Article);\n+    private Path path = null;\n \n     @BeforeEach\n     public void setUp(@TempDir Path folder) throws Exception {\n-        Path path = folder.resolve(\"CiteKey.pdf\");\n+        path = folder.resolve(\"CiteKey.pdf\");\n         Files.createFile(path);\n         entry.setCiteKey(\"CiteKey\");\n-        when(databaseContext.getFileDirectoriesAsPaths(any())).thenReturn(Collections.singletonList(path.getParent()));\n-        when(externalFileTypes.getExternalFileTypeSelection()).thenReturn(new TreeSet<>(ExternalFileTypes.getDefaultExternalFileTypes()));\n     }\n \n     @Test\n-    public void test() throws Exception {\n+    public void testFindAssociatedNotLinkedFilesSuccess() throws Exception {\n         // Due to mocking the externalFileType class, the file extension will not be found\n \n+        when(databaseContext.getFileDirectoriesAsPaths(any())).thenReturn(Collections.singletonList(path.getParent()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3df1342bdb84ae24cb8233039f4791d67650c4ec"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5454a091d5e151a50c44e358b0d4f3bad503aebf", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/5454a091d5e151a50c44e358b0d4f3bad503aebf", "committedDate": "2020-05-12T13:58:25Z", "message": "Added more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0669586457ff394843da7e234e08ae98ffd0d1e", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/e0669586457ff394843da7e234e08ae98ffd0d1e", "committedDate": "2020-05-12T13:59:48Z", "message": "Merge branch 'fix-for-issue-5891' of https://github.com/silverhorse/jabref into fix-for-issue-5891"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDc5Njk2", "url": "https://github.com/JabRef/jabref/pull/6451#pullrequestreview-410079696", "createdAt": "2020-05-12T14:08:03Z", "commit": {"oid": "e0669586457ff394843da7e234e08ae98ffd0d1e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MDY2Mzcx", "url": "https://github.com/JabRef/jabref/pull/6451#pullrequestreview-416066371", "createdAt": "2020-05-21T11:17:42Z", "commit": {"oid": "e0669586457ff394843da7e234e08ae98ffd0d1e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b997f8acf805cb440d95013be58fefe1f92d04f", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/4b997f8acf805cb440d95013be58fefe1f92d04f", "committedDate": "2020-05-28T03:47:34Z", "message": "updating text for checkbox"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5668049e6fef7a7c25d84cb9b8119da472a67090", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/5668049e6fef7a7c25d84cb9b8119da472a67090", "committedDate": "2020-05-28T13:57:00Z", "message": "reverting change from other properties files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62a6961ba65e78454e34a49e77f4295a2e3e1313", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/62a6961ba65e78454e34a49e77f4295a2e3e1313", "committedDate": "2020-05-28T14:36:16Z", "message": "Merge branch 'master' of https://github.com/JabRef/jabref into fix-for-issue-5891"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjY3ODA5", "url": "https://github.com/JabRef/jabref/pull/6451#pullrequestreview-420267809", "createdAt": "2020-05-28T16:06:12Z", "commit": {"oid": "5668049e6fef7a7c25d84cb9b8119da472a67090"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNjowNjoxMlrOGb8Thw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNjowNjoxMlrOGb8Thw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk1Mjc3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <CheckBox fx:id=\"useBibLocationAsPrimary\" text=\"%Search for files relative to BIB file location\">\n          \n          \n            \n                <CheckBox fx:id=\"useBibLocationAsPrimary\" text=\"%Search and store files relative to BIB file location\">", "url": "https://github.com/JabRef/jabref/pull/6451#discussion_r431952775", "createdAt": "2020-05-28T16:06:12Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/gui/preferences/FileTab.fxml", "diffHunk": "@@ -43,7 +43,7 @@\n         <TextField fx:id=\"mainFileDir\" HBox.hgrow=\"ALWAYS\"/>\n         <Button onAction=\"#mainFileDirBrowse\" text=\"%Browse\"/>\n     </HBox>\n-    <CheckBox fx:id=\"useBibLocationAsPrimary\" text=\"%Use the BIB file location as primary file directory\">\n+    <CheckBox fx:id=\"useBibLocationAsPrimary\" text=\"%Search for files relative to BIB file location\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5668049e6fef7a7c25d84cb9b8119da472a67090"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ce7c8f230ff2fc5cd92b101458f8da899a17444", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/0ce7c8f230ff2fc5cd92b101458f8da899a17444", "committedDate": "2020-05-28T16:24:22Z", "message": "updating text"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a1940f73372d176a03433b2e5beb0fe1cfd0ac2", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/6a1940f73372d176a03433b2e5beb0fe1cfd0ac2", "committedDate": "2020-05-28T16:27:19Z", "message": "updating text"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 260, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}