{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NTg1NzQ4", "number": 6567, "title": "Fix exception for unlinked files", "bodyText": "Fixes #5815 Exception when importing certain unlinked local files\n\nFor some certain files, they have metadata, but cannot find start or end tag, so cause exception. I added statements to check if can find start or end tag, and if the position of start tag before end tag in metadata.\nOriginal private List<Path> getFileListFromNode(CheckBoxTreeItem<FileNodeWrapper> node)  method just can find children nodes, so causes that files under subfolder cannot be found, then cannot be imported. I modified this method to iterate find all selected leaf nodes.\n\n\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-05-31T09:33:53Z", "url": "https://github.com/JabRef/jabref/pull/6567", "merged": true, "mergeCommit": {"oid": "9f673f6e0090fd1ab32306b2c19657bbe0e3549b"}, "closed": true, "closedAt": "2020-06-02T17:23:03Z", "author": {"login": "ZhouSky"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmoAb6gH2gAyNDI1NTg1NzQ4OmRjNjcyYzY0ODhjZmVhZTYyNTcyYTAzM2VhODhlN2Y1YjI5NmYyYzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnX4idAH2gAyNDI1NTg1NzQ4OmE3OGZmYTU2ZWEwYzNiNGUwZjZjZDE0ZDQ5Njg0ODY5Mzc2NDhhZTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dc672c6488cfeae62572a033ea88e7f5b296f2c6", "author": {"user": {"login": "ZhouSky", "name": null}}, "url": "https://github.com/JabRef/jabref/commit/dc672c6488cfeae62572a033ea88e7f5b296f2c6", "committedDate": "2020-05-31T09:11:53Z", "message": "check if metadata has start and end tag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f9a55cb337662186d911e6ec6d3e9de36c31a70", "author": {"user": {"login": "ZhouSky", "name": null}}, "url": "https://github.com/JabRef/jabref/commit/9f9a55cb337662186d911e6ec6d3e9de36c31a70", "committedDate": "2020-05-31T09:14:21Z", "message": "iterate to get all selected leaf nodes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDgzNDk2", "url": "https://github.com/JabRef/jabref/pull/6567#pullrequestreview-421483496", "createdAt": "2020-05-31T11:02:57Z", "commit": {"oid": "9f9a55cb337662186d911e6ec6d3e9de36c31a70"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxMTowMjo1OFrOGc4Q5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxMTowMjo1OFrOGc4Q5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkzNTE0Mw==", "bodyText": "It returns an empty list, not an optional. Please adjust thar javadoc comment\nOtherwise looks good", "url": "https://github.com/JabRef/jabref/pull/6567#discussion_r432935143", "createdAt": "2020-05-31T11:02:58Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/logic/xmp/XmpUtilReader.java", "diffHunk": "@@ -104,7 +104,7 @@ private XmpUtilReader() {\n      * <p/>\n      *\n      *\n-     * @return empty Optional if no metadata has been found\n+     * @return empty Optional if no metadata has been found, or cannot properly find start or end tag in metadata", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f9a55cb337662186d911e6ec6d3e9de36c31a70"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b18b3fab8ab8e39696dc832b94ec96e3d9078698", "author": {"user": {"login": "ZhouSky", "name": null}}, "url": "https://github.com/JabRef/jabref/commit/b18b3fab8ab8e39696dc832b94ec96e3d9078698", "committedDate": "2020-05-31T11:30:15Z", "message": "Correct return description in javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDg1NTI3", "url": "https://github.com/JabRef/jabref/pull/6567#pullrequestreview-421485527", "createdAt": "2020-05-31T11:32:36Z", "commit": {"oid": "b18b3fab8ab8e39696dc832b94ec96e3d9078698"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2291a76032c572970c924e4ffcd96a6e903c5193", "author": {"user": {"login": "ZhouSky", "name": null}}, "url": "https://github.com/JabRef/jabref/commit/2291a76032c572970c924e4ffcd96a6e903c5193", "committedDate": "2020-06-02T16:16:55Z", "message": "Add test for getXmpMetadata with no description"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyODY1NTQz", "url": "https://github.com/JabRef/jabref/pull/6567#pullrequestreview-422865543", "createdAt": "2020-06-02T16:42:53Z", "commit": {"oid": "2291a76032c572970c924e4ffcd96a6e903c5193"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNjo0Mjo1NFrOGd6lbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNjo0Mjo1NFrOGd6lbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAyMTc0MQ==", "bodyText": "You don't need reflection, the method getMetadata is implicitly caleld, you you can simple do this two lines:\n   List<BibEntry> entries = XmpUtilReader.readXmp(Path.of(XmpUtilShared.class.getResource(\"no_description_metadata.pdf\").toURI()), xmpPreferences);\n        assertEquals(Collections.emptyList(), entries);", "url": "https://github.com/JabRef/jabref/pull/6567#discussion_r434021741", "createdAt": "2020-06-02T16:42:54Z", "author": {"login": "Siedlerchr"}, "path": "src/test/java/org/jabref/logic/xmp/XmpUtilReaderTest.java", "diffHunk": "@@ -109,4 +112,16 @@ void testReadPDMetadata() throws IOException, URISyntaxException, ParseException\n \n         assertEquals(entryFromBibFile.get(), entries.get(0));\n     }\n+\n+    /**\n+     * Tests an pdf file with metadata which has no description section.\n+     */\n+    @Test\n+    void testGetXmpMetadataWithNoDescription() throws IOException, URISyntaxException, NoSuchMethodException, InvocationTargetException, IllegalAccessException {\n+        Method method = XmpUtilReader.class.getDeclaredMethod(\"getXmpMetadata\", PDDocument.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2291a76032c572970c924e4ffcd96a6e903c5193"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a78ffa56ea0c3b4e0f6cd14d4968486937648ae5", "author": {"user": {"login": "ZhouSky", "name": null}}, "url": "https://github.com/JabRef/jabref/commit/a78ffa56ea0c3b4e0f6cd14d4968486937648ae5", "committedDate": "2020-06-02T16:58:42Z", "message": "Make test concise"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 172, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}