{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MjI1OTE3", "number": 6233, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjozOTo1MFrODuCTjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxOToyNjo1NVrODut_Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NTk4ODYzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjozOTo1MVrOF_z3GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjo1NjoxNFrOGAHPYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQ1NDI5Nw==", "bodyText": "Please use the existing PreferencesService class, it is already a wrapper/it extends the JabRefPreferences class.\nJust add a method there for getting the preferences key", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402454297", "createdAt": "2020-04-02T16:39:51Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "diffHunk": "@@ -71,13 +72,15 @@\n \n     private GroupTreeViewModel viewModel;\n     private CustomLocalDragboard localDragboard;\n+    private JabRefPreferences preferences;\n \n     private DragExpansionHandler dragExpansionHandler;\n \n     @FXML\n     public void initialize() {\n         this.localDragboard = stateManager.getLocalDragboard();\n         viewModel = new GroupTreeViewModel(stateManager, dialogService, preferencesService, taskExecutor, localDragboard);\n+        preferences = JabRefPreferences.getInstance();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc2NzgwMA==", "bodyText": "Thank you for comment. Just want to make sure, that I understand you correctly:\n\ncreate a class for group preferences (like \"GeneralPreferences\", but for groups);\nadd a methods to PreferencesService interface: getGroupPreferences, storeGroupPreferences;\nimplement those methods in JabRefPreferences class;\nuse those methods in GroupTreeeView class to access preferences key;\n\nCorrect?", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402767800", "createdAt": "2020-04-03T06:45:36Z", "author": {"login": "Gena928"}, "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "diffHunk": "@@ -71,13 +72,15 @@\n \n     private GroupTreeViewModel viewModel;\n     private CustomLocalDragboard localDragboard;\n+    private JabRefPreferences preferences;\n \n     private DragExpansionHandler dragExpansionHandler;\n \n     @FXML\n     public void initialize() {\n         this.localDragboard = stateManager.getLocalDragboard();\n         viewModel = new GroupTreeViewModel(stateManager, dialogService, preferencesService, taskExecutor, localDragboard);\n+        preferences = JabRefPreferences.getInstance();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQ1NDI5Nw=="}, "originalCommit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc3MTgxMQ==", "bodyText": "Hi,\neven easier, no need for a GroupPreferences\n\nAdd a method like getDisplayGroupCount() to the PreferencesService Interface\nAdd the same method to JabRefPreferences (override annoation) and  simply return\nreturn getBoolean(JabRefPreferences.DISPLAY_GROUP_COUNT)\nIn GroupTreeView you call preferencesService.getDisplayGroupCount()\n\nI think renaming quantity to Count fit's better", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402771811", "createdAt": "2020-04-03T06:56:14Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "diffHunk": "@@ -71,13 +72,15 @@\n \n     private GroupTreeViewModel viewModel;\n     private CustomLocalDragboard localDragboard;\n+    private JabRefPreferences preferences;\n \n     private DragExpansionHandler dragExpansionHandler;\n \n     @FXML\n     public void initialize() {\n         this.localDragboard = stateManager.getLocalDragboard();\n         viewModel = new GroupTreeViewModel(stateManager, dialogService, preferencesService, taskExecutor, localDragboard);\n+        preferences = JabRefPreferences.getInstance();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQ1NDI5Nw=="}, "originalCommit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5ODAyMDUwOnYy", "diffSide": "RIGHT", "path": "src/main/resources/l10n/JabRef_da.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjo1NToyOFrOGAHOQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjo1NToyOFrOGAHOQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc3MTUyMA==", "bodyText": "Please remove the line here, it will be automatically synchronized with crowdin", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402771520", "createdAt": "2020-04-03T06:55:28Z", "author": {"login": "Siedlerchr"}, "path": "src/main/resources/l10n/JabRef_da.properties", "diffHunk": "@@ -1110,6 +1110,7 @@ Main\\ layout\\ file=Hoved-layoutfil\n \n Always\\ add\\ letter\\ (a,\\ b,\\ ...)\\ to\\ generated\\ keys=Tilf\u00f8j altid bogstav (a, b, ...) til genererede n\u00f8gler\n Default\\ pattern=Standardm\u00f8nster\n+Display\\ quantity\\ of\\ items\\ in\\ group=", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5ODUwMzU3OnYy", "diffSide": "RIGHT", "path": "src/main/resources/l10n/JabRef_da.properties", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwODo0MTozNFrOGALgBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMTo1ODoyOVrOGASVig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg0MTYwNQ==", "bodyText": "You only have to add this to en properties file", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402841605", "createdAt": "2020-04-03T08:41:34Z", "author": {"login": "Siedlerchr"}, "path": "src/main/resources/l10n/JabRef_da.properties", "diffHunk": "@@ -1110,7 +1110,8 @@ Main\\ layout\\ file=Hoved-layoutfil\n \n Always\\ add\\ letter\\ (a,\\ b,\\ ...)\\ to\\ generated\\ keys=Tilf\u00f8j altid bogstav (a, b, ...) til genererede n\u00f8gler\n Default\\ pattern=Standardm\u00f8nster\n-Display\\ quantity\\ of\\ items\\ in\\ group=\n+Display\\ count\\ of\\ items\\ in\\ group=", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09cded7cddf91136d5ad36e6cae28380f6efe1ba"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg1NjQ5Nw==", "bodyText": "Oh, sorry, sorry, sorry. Is it OK like this in \"en\" file?\nDisplay\\ count\\ of\\ items\\ in\\ group=Display count of items in group", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402856497", "createdAt": "2020-04-03T08:58:16Z", "author": {"login": "Gena928"}, "path": "src/main/resources/l10n/JabRef_da.properties", "diffHunk": "@@ -1110,7 +1110,8 @@ Main\\ layout\\ file=Hoved-layoutfil\n \n Always\\ add\\ letter\\ (a,\\ b,\\ ...)\\ to\\ generated\\ keys=Tilf\u00f8j altid bogstav (a, b, ...) til genererede n\u00f8gler\n Default\\ pattern=Standardm\u00f8nster\n-Display\\ quantity\\ of\\ items\\ in\\ group=\n+Display\\ count\\ of\\ items\\ in\\ group=", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg0MTYwNQ=="}, "originalCommit": {"oid": "09cded7cddf91136d5ad36e6cae28380f6efe1ba"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkxODkwNA==", "bodyText": "it's correct now! (you can check l10n correctness with the LocalizationConsistencyTest)", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402918904", "createdAt": "2020-04-03T10:45:24Z", "author": {"login": "Siedlerchr"}, "path": "src/main/resources/l10n/JabRef_da.properties", "diffHunk": "@@ -1110,7 +1110,8 @@ Main\\ layout\\ file=Hoved-layoutfil\n \n Always\\ add\\ letter\\ (a,\\ b,\\ ...)\\ to\\ generated\\ keys=Tilf\u00f8j altid bogstav (a, b, ...) til genererede n\u00f8gler\n Default\\ pattern=Standardm\u00f8nster\n-Display\\ quantity\\ of\\ items\\ in\\ group=\n+Display\\ count\\ of\\ items\\ in\\ group=", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg0MTYwNQ=="}, "originalCommit": {"oid": "09cded7cddf91136d5ad36e6cae28380f6efe1ba"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk1MzYxMA==", "bodyText": "Thanks.", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402953610", "createdAt": "2020-04-03T11:58:29Z", "author": {"login": "Gena928"}, "path": "src/main/resources/l10n/JabRef_da.properties", "diffHunk": "@@ -1110,7 +1110,8 @@ Main\\ layout\\ file=Hoved-layoutfil\n \n Always\\ add\\ letter\\ (a,\\ b,\\ ...)\\ to\\ generated\\ keys=Tilf\u00f8j altid bogstav (a, b, ...) til genererede n\u00f8gler\n Default\\ pattern=Standardm\u00f8nster\n-Display\\ quantity\\ of\\ items\\ in\\ group=\n+Display\\ count\\ of\\ items\\ in\\ group=", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg0MTYwNQ=="}, "originalCommit": {"oid": "09cded7cddf91136d5ad36e6cae28380f6efe1ba"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMzE0NTU0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxOToyNjo1NVrOGA0HwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQxMzoxNTo1MVrOGA_7NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwNzEzNg==", "bodyText": "As noted in the issue, the circle node should always be displayed because it is also used for the any/all selected status. Can you thus please add the if check only around the text here.", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r403507136", "createdAt": "2020-04-04T19:26:55Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "diffHunk": "@@ -120,27 +120,29 @@ public void initialize() {\n                 .withTooltip(GroupNodeViewModel::getDescription)\n                 .install(mainColumn);\n \n-        // Number of hits\n-        PseudoClass anySelected = PseudoClass.getPseudoClass(\"any-selected\");\n-        PseudoClass allSelected = PseudoClass.getPseudoClass(\"all-selected\");\n-        new ViewModelTreeTableCellFactory<GroupNodeViewModel>()\n-                .withGraphic(group -> {\n-                    final StackPane node = new StackPane();\n-                    node.getStyleClass().setAll(\"hits\");\n-                    if (!group.isRoot()) {\n-                        BindingsHelper.includePseudoClassWhen(node, anySelected,\n-                                group.anySelectedEntriesMatchedProperty());\n-                        BindingsHelper.includePseudoClassWhen(node, allSelected,\n-                                group.allSelectedEntriesMatchedProperty());\n-                    }\n-                    Text text = new Text();\n-                    text.textProperty().bind(group.getHits().asString());\n-                    text.getStyleClass().setAll(\"text\");\n-                    node.getChildren().add(text);\n-                    node.setMaxWidth(Control.USE_PREF_SIZE);\n-                    return node;\n-                })\n-                .install(numberColumn);\n+        // Number of hits (only if user wants to see them)\n+        if (preferencesService.getDisplayGroupCount()) {\n+            PseudoClass anySelected = PseudoClass.getPseudoClass(\"any-selected\");\n+            PseudoClass allSelected = PseudoClass.getPseudoClass(\"all-selected\");\n+            new ViewModelTreeTableCellFactory<GroupNodeViewModel>()\n+                    .withGraphic(group -> {\n+                        final StackPane node = new StackPane();\n+                        node.getStyleClass().setAll(\"hits\");\n+                        if (!group.isRoot()) {\n+                            BindingsHelper.includePseudoClassWhen(node, anySelected,\n+                                    group.anySelectedEntriesMatchedProperty());\n+                            BindingsHelper.includePseudoClassWhen(node, allSelected,\n+                                    group.allSelectedEntriesMatchedProperty());\n+                        }\n+                        Text text = new Text();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdc18a9c2923cf441e2a4e440063187e538adc48"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY4NDE1Ng==", "bodyText": "Done,\nplease see new GroupTreeeView.java. OK now?", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r403684156", "createdAt": "2020-04-05T10:52:00Z", "author": {"login": "Gena928"}, "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "diffHunk": "@@ -120,27 +120,29 @@ public void initialize() {\n                 .withTooltip(GroupNodeViewModel::getDescription)\n                 .install(mainColumn);\n \n-        // Number of hits\n-        PseudoClass anySelected = PseudoClass.getPseudoClass(\"any-selected\");\n-        PseudoClass allSelected = PseudoClass.getPseudoClass(\"all-selected\");\n-        new ViewModelTreeTableCellFactory<GroupNodeViewModel>()\n-                .withGraphic(group -> {\n-                    final StackPane node = new StackPane();\n-                    node.getStyleClass().setAll(\"hits\");\n-                    if (!group.isRoot()) {\n-                        BindingsHelper.includePseudoClassWhen(node, anySelected,\n-                                group.anySelectedEntriesMatchedProperty());\n-                        BindingsHelper.includePseudoClassWhen(node, allSelected,\n-                                group.allSelectedEntriesMatchedProperty());\n-                    }\n-                    Text text = new Text();\n-                    text.textProperty().bind(group.getHits().asString());\n-                    text.getStyleClass().setAll(\"text\");\n-                    node.getChildren().add(text);\n-                    node.setMaxWidth(Control.USE_PREF_SIZE);\n-                    return node;\n-                })\n-                .install(numberColumn);\n+        // Number of hits (only if user wants to see them)\n+        if (preferencesService.getDisplayGroupCount()) {\n+            PseudoClass anySelected = PseudoClass.getPseudoClass(\"any-selected\");\n+            PseudoClass allSelected = PseudoClass.getPseudoClass(\"all-selected\");\n+            new ViewModelTreeTableCellFactory<GroupNodeViewModel>()\n+                    .withGraphic(group -> {\n+                        final StackPane node = new StackPane();\n+                        node.getStyleClass().setAll(\"hits\");\n+                        if (!group.isRoot()) {\n+                            BindingsHelper.includePseudoClassWhen(node, anySelected,\n+                                    group.anySelectedEntriesMatchedProperty());\n+                            BindingsHelper.includePseudoClassWhen(node, allSelected,\n+                                    group.allSelectedEntriesMatchedProperty());\n+                        }\n+                        Text text = new Text();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwNzEzNg=="}, "originalCommit": {"oid": "cdc18a9c2923cf441e2a4e440063187e538adc48"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzcwMDUzMg==", "bodyText": "Thanks for quick follow-up! Looks good indeed.", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r403700532", "createdAt": "2020-04-05T13:15:51Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "diffHunk": "@@ -120,27 +120,29 @@ public void initialize() {\n                 .withTooltip(GroupNodeViewModel::getDescription)\n                 .install(mainColumn);\n \n-        // Number of hits\n-        PseudoClass anySelected = PseudoClass.getPseudoClass(\"any-selected\");\n-        PseudoClass allSelected = PseudoClass.getPseudoClass(\"all-selected\");\n-        new ViewModelTreeTableCellFactory<GroupNodeViewModel>()\n-                .withGraphic(group -> {\n-                    final StackPane node = new StackPane();\n-                    node.getStyleClass().setAll(\"hits\");\n-                    if (!group.isRoot()) {\n-                        BindingsHelper.includePseudoClassWhen(node, anySelected,\n-                                group.anySelectedEntriesMatchedProperty());\n-                        BindingsHelper.includePseudoClassWhen(node, allSelected,\n-                                group.allSelectedEntriesMatchedProperty());\n-                    }\n-                    Text text = new Text();\n-                    text.textProperty().bind(group.getHits().asString());\n-                    text.getStyleClass().setAll(\"text\");\n-                    node.getChildren().add(text);\n-                    node.setMaxWidth(Control.USE_PREF_SIZE);\n-                    return node;\n-                })\n-                .install(numberColumn);\n+        // Number of hits (only if user wants to see them)\n+        if (preferencesService.getDisplayGroupCount()) {\n+            PseudoClass anySelected = PseudoClass.getPseudoClass(\"any-selected\");\n+            PseudoClass allSelected = PseudoClass.getPseudoClass(\"all-selected\");\n+            new ViewModelTreeTableCellFactory<GroupNodeViewModel>()\n+                    .withGraphic(group -> {\n+                        final StackPane node = new StackPane();\n+                        node.getStyleClass().setAll(\"hits\");\n+                        if (!group.isRoot()) {\n+                            BindingsHelper.includePseudoClassWhen(node, anySelected,\n+                                    group.anySelectedEntriesMatchedProperty());\n+                            BindingsHelper.includePseudoClassWhen(node, allSelected,\n+                                    group.allSelectedEntriesMatchedProperty());\n+                        }\n+                        Text text = new Text();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwNzEzNg=="}, "originalCommit": {"oid": "cdc18a9c2923cf441e2a4e440063187e538adc48"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1874, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}