{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0NTc2OTQ5", "number": 6799, "title": "Feature/enable lucene query parsing", "bodyText": "This PR enables the conversion of user queries, formulated in a simplified lucene syntax (see ADR 0014), into complex search queries for fetchers. Refs koppor#456.\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-08-27T09:37:32Z", "url": "https://github.com/JabRef/jabref/pull/6799", "merged": true, "mergeCommit": {"oid": "dfefd4d6fc6751f21be36b4c9536895bb6edd339"}, "closed": true, "closedAt": "2020-08-31T11:41:41Z", "author": {"login": "DominikVoigt"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6fLcngH2gAyNDc0NTc2OTQ5OmM4ZWJjOTFkNDc5OWU1OTUxOGFjODg3ZjY5ZTU4NDA0MGNmMjk5OTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdERJsBAH2gAyNDc0NTc2OTQ5OmVjNjA3MzQwOTAyMDA4OTA2MDFjYTQ4NTNmYzk3N2RiMTI3Yzg2ZDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c8ebc91d4799e59518ac887f69e584040cf29994", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/c8ebc91d4799e59518ac887f69e584040cf29994", "committedDate": "2020-08-01T02:13:15Z", "message": "Squashed 'src/main/resources/csl-styles/' changes from bf698acec7..827b986621\n\n827b986621 add DOI preprint to american-society-for-microbiology.csl (#4946)\n7cab2f7d8a Create depro-ufs.csl (#4947)\n2fcda1fe03 Create journal-of-sport-science-and-medicine.csl (#4949)\ncd457d4bce Update american-marketing-association.csl (#4945)\ncacc4eefbd Create nejm-catalyst.csl (#4943)\nbd769b91da Update and rename dependent/chinese-medical-journal.csl to chinese-me\u2026 (#4941)\n1f706cda6c Update health-services-research.csl (#4939)\n76bcd1d9d7 Update journal-of-the-royal-society-of-western-australia.csl (#4932)\ne79640e74d Create afro-asia.csl (#4934)\nc601aa4e0f Update lancaster-university-harvard.csl (#4938)\n184fd90210 Update collection-du-centre-jean-berard.csl (#4936)\n82f9aec90f fix et-al & add DOI thyroid.csl (#4937)\n4af169fc11 Create universidade-estadual-de-alagoas-uneal-abnt (#4885)\n47165b3d5a Update and rename medical-physics.csl to dependent/medical-physics.csl (AMA) (#4905)\n3cab27dc1a Update thieme-german.csl (#4931)\neb2c9776e0 Create zeitschrift-fur-zahnarztliche-implantologie.csl (#4925)\n4adb1ea0be Create karstenia.csl (#4929)\n530a136786 Fix author substitute in Universita Cattolica\n\ngit-subtree-dir: src/main/resources/csl-styles\ngit-subtree-split: 827b986621348627f8e894d1b7f11191f905a8e2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5f02cf3ced81d19b74844b770abc1dba0b61fa1", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/f5f02cf3ced81d19b74844b770abc1dba0b61fa1", "committedDate": "2020-08-01T02:13:15Z", "message": "Merge commit 'c8ebc91d4799e59518ac887f69e584040cf29994'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37c2d64e449ef617bb98c0ad3b39a903d8f3d886", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/37c2d64e449ef617bb98c0ad3b39a903d8f3d886", "committedDate": "2020-08-15T02:17:10Z", "message": "Squashed 'src/main/resources/csl-styles/' changes from 827b986621..eb0d37e0ff\n\neb0d37e0ff Create natbib-plainnat-author-dat.csl (#4967)\nfb1592a1cd Update journal-of-fish-biology.csl (#4969)\nf6876cbe0f Update .travis.yml (#4970)\nd6d400b207 Create london-review-of-international-law.csl (#4966)\nd2a5ae1b16 Update harvard-stellenbosch-university.csl (#4965)\n9c62141a40 Create phytopathologia-mediterranea.csl (#4964)\n8ca2ea1a9c Update historical-materialism.csl (#4960)\n80456dc749 Update historical-materialism.csl\nbe2d91090c Update historical-materialism.csl\n1d1cf095a6 Create atlande.csl (#4930)\n89f41d404d Create juristische-zitierweise-oeffentliches-recht.csl (#4944)\n8c677a08c5 Create korean-journal-of-gastroenterology.csl (#4954)\neadb9508dd Create historical-materialism.csl (#4955)\n5553dcdc9c Create revista-materia.csl (#4957)\nd23a3abd79 Bug fix in APA 6 original publication macro (#4959)\n66f9974980 Always print publisher in APA 6th edition (#4899)\n868809c063 Create agora.csl (#4940)\n99c19c397e Update anthropologie-et-societes.csl (#4952)\nee17423a93 Create critical-reviews-in-solid-state-and-materials-science.csl (#4951)\n7a13a7d59e Create korean-journal-of-internal-medicine.csl (#4953)\n\ngit-subtree-dir: src/main/resources/csl-styles\ngit-subtree-split: eb0d37e0ff253e7c6d256b619e4831af306a28cf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b85ebe3e3f9b956f1ab56ef24bf2a1cd0b03d632", "author": {"user": null}, "url": "https://github.com/JabRef/jabref/commit/b85ebe3e3f9b956f1ab56ef24bf2a1cd0b03d632", "committedDate": "2020-08-15T02:17:10Z", "message": "Merge commit '37c2d64e449ef617bb98c0ad3b39a903d8f3d886' into master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f10ea5f1d86aed42a29b38d5b4683f60cb964c1c", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/f10ea5f1d86aed42a29b38d5b4683f60cb964c1c", "committedDate": "2020-08-25T19:10:13Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "172b11301d20b11d4ff3f22c1aa768b3fc6db9e4", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/172b11301d20b11d4ff3f22c1aa768b3fc6db9e4", "committedDate": "2020-08-26T19:31:00Z", "message": "Enable Query String into ComplexQuery parsing using lucene.\nFix some FetcherTests.\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90a629e1db45de25abb05d2fb849a85528c8de35", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/90a629e1db45de25abb05d2fb849a85528c8de35", "committedDate": "2020-08-27T08:44:31Z", "message": "Add ADR\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3af3781a00296847eb92188334250825189b9631", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/3af3781a00296847eb92188334250825189b9631", "committedDate": "2020-08-27T09:38:29Z", "message": "Add Changelog entry\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26851a75217eb6f4c4874538df11ca007cc91f4a", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/26851a75217eb6f4c4874538df11ca007cc91f4a", "committedDate": "2020-08-27T09:39:22Z", "message": "Merge remote-tracking branch 'upstream/master' into feature/enable-lucene-query-parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8468ad440b989cc67a3745ee3a690b0a2e6b3ef2", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/8468ad440b989cc67a3745ee3a690b0a2e6b3ef2", "committedDate": "2020-08-27T09:40:19Z", "message": "Move Changelog entry\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d592a47b853ae6978696d635776e32e8e105e478", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/d592a47b853ae6978696d635776e32e8e105e478", "committedDate": "2020-08-27T09:44:53Z", "message": "Increment ADR number\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NTc0ODI1", "url": "https://github.com/JabRef/jabref/pull/6799#pullrequestreview-476574825", "createdAt": "2020-08-27T10:09:25Z", "commit": {"oid": "d592a47b853ae6978696d635776e32e8e105e478"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMDowOToyNVrOHIJjIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMDoyMDo1N1rOHIJ6Eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwNzEwNw==", "bodyText": "I would call this QueryParser. I guess parser is more common for conversion from string to some object (its also the name used in Lucene).", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r478307107", "createdAt": "2020-08-27T10:09:25Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/importer/QueryConverter.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.jabref.logic.importer;\n+\n+import java.util.ArrayList;\n+import java.util.Comparator;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+\n+import org.jabref.logic.importer.fetcher.ComplexSearchQuery;\n+\n+import org.apache.lucene.index.Term;\n+import org.apache.lucene.queryparser.flexible.core.QueryNodeException;\n+import org.apache.lucene.queryparser.flexible.standard.StandardQueryParser;\n+import org.apache.lucene.search.Query;\n+import org.apache.lucene.search.QueryVisitor;\n+\n+/**\n+ * This class converts a query string written in lucene syntax into a complex search query.\n+ *\n+ * For simplicity this is limited to fielded data and the boolean AND operator.\n+ */\n+public class QueryConverter {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d592a47b853ae6978696d635776e32e8e105e478"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwODI1MA==", "bodyText": "Is the QueryNodeException helpful in diagnosing where the syntax error is, i.e. can it be converted to a meaningful error message shown to the user? If not, I would propose to catch it in the main body, change the return value to Optional<Query> and return an empty optional in case of a syntax error.", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r478308250", "createdAt": "2020-08-27T10:11:32Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/importer/QueryConverter.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.jabref.logic.importer;\n+\n+import java.util.ArrayList;\n+import java.util.Comparator;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+\n+import org.jabref.logic.importer.fetcher.ComplexSearchQuery;\n+\n+import org.apache.lucene.index.Term;\n+import org.apache.lucene.queryparser.flexible.core.QueryNodeException;\n+import org.apache.lucene.queryparser.flexible.standard.StandardQueryParser;\n+import org.apache.lucene.search.Query;\n+import org.apache.lucene.search.QueryVisitor;\n+\n+/**\n+ * This class converts a query string written in lucene syntax into a complex search query.\n+ *\n+ * For simplicity this is limited to fielded data and the boolean AND operator.\n+ */\n+public class QueryConverter {\n+\n+    /**\n+     * Converts the given query string into a complex query using lucene.\n+     * Note: For unique fields, the alphabetically first instance in the query string is used in the complex query.\n+     *\n+     * @param queryString The given query string\n+     * @return A complex query containing all fields of the query string\n+     * @throws QueryNodeException Error during parsing\n+     */\n+    public ComplexSearchQuery convertQueryStringIntoComplexQuery(String queryString) throws QueryNodeException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d592a47b853ae6978696d635776e32e8e105e478"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMwODY1Nw==", "bodyText": "It's considered bad practice to have an optional around a list. Just return an empty list, instead of an empty optional.", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r478308657", "createdAt": "2020-08-27T10:12:22Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/importer/fetcher/ComplexSearchQuery.java", "diffHunk": "@@ -28,7 +31,7 @@ private ComplexSearchQuery(String defaultField, List<String> authors, List<Strin\n         this.singleYear = singleYear;\n     }\n \n-    public Optional<String> getDefaultField() {\n+    public Optional<List<String>> getDefaultFieldPhrases() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d592a47b853ae6978696d635776e32e8e105e478"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMxMTQ2OQ==", "bodyText": "I would add this directly as a constructor, or if you want to have a more descriptive name as a static ComplexSearchQuery fromTerms(Collection<Term> terms) method in ComplexSearchQuery. The builder pattern is only useful if you have a lot of possible constructor arguments, and want to create a nice interface for it. I actually think the builder interface is mostly outdated since IDEs are now intelligent enough to show named constructor arguments, e.g", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r478311469", "createdAt": "2020-08-27T10:17:49Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/importer/fetcher/ComplexSearchQuery.java", "diffHunk": "@@ -135,6 +142,21 @@ public ComplexSearchQueryBuilder journal(String journal) {\n             return this;\n         }\n \n+        public ComplexSearchQueryBuilder terms(Collection<Term> terms) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d592a47b853ae6978696d635776e32e8e105e478"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMxMTk5NA==", "bodyText": "Reuse converter here and in the other tests.", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r478311994", "createdAt": "2020-08-27T10:18:59Z", "author": {"login": "tobiasdiez"}, "path": "src/test/java/org/jabref/logic/importer/QueryConverterTest.java", "diffHunk": "@@ -0,0 +1,59 @@\n+package org.jabref.logic.importer;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import org.jabref.logic.importer.fetcher.ComplexSearchQuery;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+class QueryConverterTest {\n+    QueryConverter converter = new QueryConverter();\n+\n+    @Test\n+    public void convertAuthorField() throws Exception {\n+        ComplexSearchQuery searchQuery = new QueryConverter().convertQueryStringIntoComplexQuery(\"author:\\\"Igor Steinmacher\\\"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d592a47b853ae6978696d635776e32e8e105e478"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODMxMjk3OA==", "bodyText": "Please create a new expected complex search query, and test against this. For example, the current test also passes if searchQuery has a non-empty title because this field is not checked in this test.", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r478312978", "createdAt": "2020-08-27T10:20:57Z", "author": {"login": "tobiasdiez"}, "path": "src/test/java/org/jabref/logic/importer/QueryConverterTest.java", "diffHunk": "@@ -0,0 +1,59 @@\n+package org.jabref.logic.importer;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import org.jabref.logic.importer.fetcher.ComplexSearchQuery;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+class QueryConverterTest {\n+    QueryConverter converter = new QueryConverter();\n+\n+    @Test\n+    public void convertAuthorField() throws Exception {\n+        ComplexSearchQuery searchQuery = new QueryConverter().convertQueryStringIntoComplexQuery(\"author:\\\"Igor Steinmacher\\\"\");\n+        assertEquals(List.of(\"\\\"Igor Steinmacher\\\"\"), searchQuery.getAuthors().get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d592a47b853ae6978696d635776e32e8e105e478"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4610451ff908accf977328100f4a5f578fed9dd7", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/4610451ff908accf977328100f4a5f578fed9dd7", "committedDate": "2020-08-27T12:46:08Z", "message": "Remove Optional from Lists\nRename QueryConverter to QueryParser\nModify parser tests to compare complex queries\nMake complex query construction from terms independent from normal building\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NzE2MTI5", "url": "https://github.com/JabRef/jabref/pull/6799#pullrequestreview-476716129", "createdAt": "2020-08-27T13:24:23Z", "commit": {"oid": "4610451ff908accf977328100f4a5f578fed9dd7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzoyNDoyM1rOHIQM5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMzoyNToxMVrOHIQPNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNjEwMw==", "bodyText": "rename to parser", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r478416103", "createdAt": "2020-08-27T13:24:23Z", "author": {"login": "tobiasdiez"}, "path": "src/test/java/org/jabref/logic/importer/QueryParserTest.java", "diffHunk": "@@ -0,0 +1,60 @@\n+package org.jabref.logic.importer;\n+\n+import org.jabref.logic.importer.fetcher.ComplexSearchQuery;\n+\n+import org.junit.jupiter.api.Test;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+class QueryParserTest {\n+    QueryParser converter = new QueryParser();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4610451ff908accf977328100f4a5f578fed9dd7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNjY5Mw==", "bodyText": "rename to parse?", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r478416693", "createdAt": "2020-08-27T13:25:11Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/importer/QueryParser.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package org.jabref.logic.importer;\n+\n+import java.util.ArrayList;\n+import java.util.Comparator;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Optional;\n+import java.util.Set;\n+\n+import org.jabref.logic.importer.fetcher.ComplexSearchQuery;\n+\n+import org.apache.lucene.index.Term;\n+import org.apache.lucene.queryparser.flexible.core.QueryNodeException;\n+import org.apache.lucene.queryparser.flexible.standard.StandardQueryParser;\n+import org.apache.lucene.search.Query;\n+import org.apache.lucene.search.QueryVisitor;\n+\n+/**\n+ * This class converts a query string written in lucene syntax into a complex search query.\n+ *\n+ * For simplicity this is limited to fielded data and the boolean AND operator.\n+ */\n+public class QueryParser {\n+\n+    /**\n+     * Converts the given query string into a complex query using lucene.\n+     * Note: For unique fields, the alphabetically first instance in the query string is used in the complex query.\n+     *\n+     * @param queryString The given query string\n+     * @return A complex query containing all fields of the query string\n+     * @throws QueryNodeException Error during parsing\n+     */\n+    public Optional<ComplexSearchQuery> convertQueryStringIntoComplexQuery(String queryString) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4610451ff908accf977328100f4a5f578fed9dd7"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86c65767484f8c3379c822fbd2eb97e1bf206e48", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/86c65767484f8c3379c822fbd2eb97e1bf206e48", "committedDate": "2020-08-27T14:59:10Z", "message": "Rename slipped occurences of converter\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3MTA4NDM5", "url": "https://github.com/JabRef/jabref/pull/6799#pullrequestreview-477108439", "createdAt": "2020-08-27T21:49:31Z", "commit": {"oid": "86c65767484f8c3379c822fbd2eb97e1bf206e48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NjkwNjQ1", "url": "https://github.com/JabRef/jabref/pull/6799#pullrequestreview-477690645", "createdAt": "2020-08-28T12:35:28Z", "commit": {"oid": "86c65767484f8c3379c822fbd2eb97e1bf206e48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2447f67987d9aa19f2a2631bec8822de093abfb", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/e2447f67987d9aa19f2a2631bec8822de093abfb", "committedDate": "2020-08-28T14:41:51Z", "message": "Merge remote-tracking branch 'upstream/master' into feature/enable-lucene-query-parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0642d49e208776d9bff095782b110061aacbf7d3", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/0642d49e208776d9bff095782b110061aacbf7d3", "committedDate": "2020-08-30T12:05:50Z", "message": "Mapping of unknown fields onto default field\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11afbe9f1e94e6058b0078bc2da1e62e98e65ca5", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/11afbe9f1e94e6058b0078bc2da1e62e98e65ca5", "committedDate": "2020-08-30T12:20:39Z", "message": "Ignores unknown fields\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fde8814c3cc45772689049697acd364b35c9de6", "author": {"user": {"login": "koppor", "name": "Oliver Kopp"}}, "url": "https://github.com/JabRef/jabref/commit/6fde8814c3cc45772689049697acd364b35c9de6", "committedDate": "2020-08-30T21:33:42Z", "message": "Merge branch 'master' into feature/enable-lucene-query-parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e27ebcc869ed3e9bfc390c061785442a790d9d49", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/e27ebcc869ed3e9bfc390c061785442a790d9d49", "committedDate": "2020-08-31T10:16:31Z", "message": "Merge remote-tracking branch 'upstream/master' into feature/enable-lucene-query-parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "239095e9e5b6d854435383caa5edc929719ecbc1", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/239095e9e5b6d854435383caa5edc929719ecbc1", "committedDate": "2020-08-31T10:36:52Z", "message": "Fix checkstyle issues\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec", "author": {"user": {"login": "koppor", "name": "Oliver Kopp"}}, "url": "https://github.com/JabRef/jabref/commit/467cbfc0171a789f8fff20506077948707eff8ec", "committedDate": "2020-08-31T10:54:27Z", "message": "Merge branch 'master' into feature/enable-lucene-query-parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff6a7d36becea42617bc23c4ec07a6bd0f1dba96", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/ff6a7d36becea42617bc23c4ec07a6bd0f1dba96", "committedDate": "2020-08-31T11:04:59Z", "message": "Merge branch 'feature/enable-lucene-query-parsing' of https://github.com/DominikVoigt/jabref into feature/enable-lucene-query-parsing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4NTE1NDQ4", "url": "https://github.com/JabRef/jabref/pull/6799#pullrequestreview-478515448", "createdAt": "2020-08-31T10:56:18Z", "commit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxMDo1NjoxOFrOHJz4gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxMTowMjo1OFrOHJ0Q2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA0OTI4Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              * \\[author:\"Igor Steinmacher\" author:\"Christoph Treude\" year:2017\\] will be converted to\n          \n          \n            \n              * `author:\"Igor Steinmacher\" author:\"Christoph Treude\" year:2017` will be converted to", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480049283", "createdAt": "2020-08-31T10:56:18Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author\n+  * title\n+  * journal\n+  * year (for single year)\n+  * year-range (for range e.g. year-range:2012-2015)\n+* The journal, year, and year-range fields should only be populated once in each query\n+* Example:\n+  * \\[author:\"Igor Steinmacher\" author:\"Christoph Treude\" year:2017\\] will be converted to", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA0OTM4NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              * \\[author:\"Igor Steinmacher\" AND author:\"Christoph Treude\" AND year:2017\\]\n          \n          \n            \n              * `author:\"Igor Steinmacher\" AND author:\"Christoph Treude\" AND year:2017`", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480049384", "createdAt": "2020-08-31T10:56:32Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author\n+  * title\n+  * journal\n+  * year (for single year)\n+  * year-range (for range e.g. year-range:2012-2015)\n+* The journal, year, and year-range fields should only be populated once in each query\n+* Example:\n+  * \\[author:\"Igor Steinmacher\" author:\"Christoph Treude\" year:2017\\] will be converted to\n+  * \\[author:\"Igor Steinmacher\" AND author:\"Christoph Treude\" AND year:2017\\]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA0OTQ2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * Well Known\n          \n          \n            \n            * Well known", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480049461", "createdAt": "2020-08-31T10:56:44Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author\n+  * title\n+  * journal\n+  * year (for single year)\n+  * year-range (for range e.g. year-range:2012-2015)\n+* The journal, year, and year-range fields should only be populated once in each query\n+* Example:\n+  * \\[author:\"Igor Steinmacher\" author:\"Christoph Treude\" year:2017\\] will be converted to\n+  * \\[author:\"Igor Steinmacher\" AND author:\"Christoph Treude\" AND year:2017\\]\n+\n+### Positive Consequences\n+\n+* Already tested\n+* Well Known", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA0OTYyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              * author\n          \n          \n            \n              * `author`", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480049624", "createdAt": "2020-08-31T10:57:00Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA0OTczNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              * title\n          \n          \n            \n              * `title`", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480049734", "createdAt": "2020-08-31T10:57:08Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author\n+  * title", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA0OTg5MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              * journal\n          \n          \n            \n              * `journal`", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480049890", "createdAt": "2020-08-31T10:57:17Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author\n+  * title\n+  * journal", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA1MDAxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              * year (for single year)\n          \n          \n            \n              * `year` (for single year)", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480050017", "createdAt": "2020-08-31T10:57:27Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author\n+  * title\n+  * journal\n+  * year (for single year)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA1MDQ2NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              * year-range (for range e.g. year-range:2012-2015)\n          \n          \n            \n              * `year-range` (for range e.g. `year-range:2012-2015`)", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480050464", "createdAt": "2020-08-31T10:57:55Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author\n+  * title\n+  * journal\n+  * year (for single year)\n+  * year-range (for range e.g. year-range:2012-2015)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA1MDc1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * The journal, year, and year-range fields should only be populated once in each query\n          \n          \n            \n            * The `journal`, `year`, and `year-range` fields should only be populated once in each query", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480050752", "createdAt": "2020-08-31T10:58:11Z", "author": {"login": "koppor"}, "path": "docs/adr/0015-support-an-abstract-query-syntax-for-query-conversion.md", "diffHunk": "@@ -0,0 +1,56 @@\n+# Query syntax design\n+\n+## Context and Problem Statement\n+\n+All libraries use their own query syntax for advanced search options. To increase usability, users should be able to formulate their (abstract) search queries in a query syntax that can be mapped to the library specific search queries. To achieve this, the query has to be parsed into an AST.\n+\n+Which query syntax should be used for the abstract queries?\n+Which features should the syntax support?\n+\n+## Considered Options\n+\n+* Use a simplified syntax that is derived of the [lucene](https://lucene.apache.org/core/8_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) query syntax\n+* Formulate a own query syntax\n+\n+## Decision Outcome\n+\n+Chosen option: \"Use a syntax that is derived of the lucene query syntax\", because only option that is already known, and easy to implemenent.\n+Furthermore parsers for lucene already exist and are tested.\n+For simplicitly, and lack of universal capabilities across fetchers, only basic query features and therefor syntax is supported:\n+\n+* All terms in the query are whitespace separated and will be ANDed\n+* Default and certain fielded terms are supported\n+* Fielded Terms:\n+  * author\n+  * title\n+  * journal\n+  * year (for single year)\n+  * year-range (for range e.g. year-range:2012-2015)\n+* The journal, year, and year-range fields should only be populated once in each query", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA1MjIyMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // Default Implementation behaves like perform search using the default field phrases as query\n          \n          \n            \n                    // Default implementation behaves as performSearch using the default field phrases as query", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480052222", "createdAt": "2020-08-31T10:59:36Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/importer/SearchBasedFetcher.java", "diffHunk": "@@ -26,7 +26,8 @@\n      * @return a list of {@link BibEntry}, which are matched by the query (may be empty)\n      */\n     default List<BibEntry> performComplexSearch(ComplexSearchQuery complexSearchQuery) throws FetcherException {\n-        // Default Implementation behaves like perform search using the default field as query\n-        return performSearch(complexSearchQuery.getDefaultField().orElse(\"\"));\n+        // Default Implementation behaves like perform search using the default field phrases as query", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA1MjU4NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // Default Implementation behaves like getURLForQuery using the default field phrases as query\n          \n          \n            \n                    // Default implementation behaves as getURLForQuery using the default field phrases as query", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480052585", "createdAt": "2020-08-31T10:59:57Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/importer/SearchBasedParserFetcher.java", "diffHunk": "@@ -83,8 +83,9 @@\n     }\n \n     default URL getComplexQueryURL(ComplexSearchQuery complexSearchQuery) throws URISyntaxException, MalformedURLException, FetcherException {\n-        // Default Implementation behaves like getURLForQuery using the default field as query\n-        return this.getURLForQuery(complexSearchQuery.getDefaultField().orElse(\"\"));\n+        // Default Implementation behaves like getURLForQuery using the default field phrases as query", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA1NTUxMg==", "bodyText": "NumberFormatException should be catched here.\nSee https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#valueOf(java.lang.String). I would use 0 and 9999 as default valuesto keep the search going.", "url": "https://github.com/JabRef/jabref/pull/6799#discussion_r480055512", "createdAt": "2020-08-31T11:02:58Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/importer/fetcher/ComplexSearchQuery.java", "diffHunk": "@@ -28,16 +31,32 @@ private ComplexSearchQuery(String defaultField, List<String> authors, List<Strin\n         this.singleYear = singleYear;\n     }\n \n-    public Optional<String> getDefaultField() {\n-        return Optional.ofNullable(defaultField);\n+    public static ComplexSearchQuery fromTerms(Collection<Term> terms) {\n+        ComplexSearchQueryBuilder builder = ComplexSearchQuery.builder();\n+        terms.forEach(term -> {\n+            String termText = term.text();\n+            switch (term.field().toLowerCase()) {\n+                case \"author\" -> builder.author(termText);\n+                case \"title\" -> builder.titlePhrase(termText);\n+                case \"journal\" -> builder.journal(termText);\n+                case \"year\" -> builder.singleYear(Integer.valueOf(termText));\n+                case \"year-range\" -> builder.fromYearAndToYear(Integer.valueOf(termText.split(\"-\")[0]), Integer.valueOf(termText.split(\"-\")[1]));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "467cbfc0171a789f8fff20506077948707eff8ec"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "542d3a7c521f81c99fc156bb9d23166154a4e9f9", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/542d3a7c521f81c99fc156bb9d23166154a4e9f9", "committedDate": "2020-08-31T11:11:26Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Oliver Kopp <kopp.dev@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b2ab98fce9cdbbbd04ffeb06cff909273fe54f3", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/4b2ab98fce9cdbbbd04ffeb06cff909273fe54f3", "committedDate": "2020-08-31T11:27:14Z", "message": "Handle year-range parsing in a more robust way\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b3b7cdd08f7926e7d758dccef5c71897132287d", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/8b3b7cdd08f7926e7d758dccef5c71897132287d", "committedDate": "2020-08-31T11:29:43Z", "message": "Move extracted method into builder\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec60734090200890601ca4853fc977db127c86d3", "author": {"user": {"login": "DominikVoigt", "name": "Dominik Voigt"}}, "url": "https://github.com/JabRef/jabref/commit/ec60734090200890601ca4853fc977db127c86d3", "committedDate": "2020-08-31T11:31:54Z", "message": "Merge branch 'feature/enable-lucene-query-parsing' of https://github.com/DominikVoigt/jabref into feature/enable-lucene-query-parsing"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 122, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}