{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3ODk4NDMz", "number": 6682, "title": "Rework search bar", "bodyText": "fixes #6625\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-07-12T13:11:00Z", "url": "https://github.com/JabRef/jabref/pull/6682", "merged": true, "mergeCommit": {"oid": "fadb430df86495241cc72a8dba566445e5e93080"}, "closed": true, "closedAt": "2020-07-17T15:15:36Z", "author": {"login": "calixtus"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcus1N-gH2gAyNDQ3ODk4NDMzOmJiM2NmYjlhNjVmZjIyYTdmZDc3MWQ1MTFhNGE1Y2IyZWI0YTFhZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1IhXOgFqTQ0ODg0NjYwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bb3cfb9a65ff22a7fd771d511a4a5cb2eb4a1ae3", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/bb3cfb9a65ff22a7fd771d511a4a5cb2eb4a1ae3", "committedDate": "2020-06-25T11:20:33Z", "message": "Reworked SearchPreferences"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "650c33ebd7f394f429e2a9be5c31cad867265c56", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/650c33ebd7f394f429e2a9be5c31cad867265c56", "committedDate": "2020-07-09T11:05:27Z", "message": "Merge remote-tracking branch 'upstream/master' into rework_search_bar\n\n# Conflicts:\n#\tsrc/main/java/org/jabref/preferences/PreferencesService.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d86800f4c5c7cbfaae5060448489016fdc5b9c8", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/6d86800f4c5c7cbfaae5060448489016fdc5b9c8", "committedDate": "2020-07-11T10:01:40Z", "message": "Fixed CSS for togglebuttons"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed443fed2ae8381bc7f7e1358b385fd097258d1b", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/ed443fed2ae8381bc7f7e1358b385fd097258d1b", "committedDate": "2020-07-11T10:12:33Z", "message": "Removed old disabled code fragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28633bd4127f541757021ae1b9e94a891608a722", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/28633bd4127f541757021ae1b9e94a891608a722", "committedDate": "2020-07-12T13:00:23Z", "message": "Split toolbar into small parts for better small screen ui"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfaa3833988348ac0ff45ace9421134ba4c4df82", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/bfaa3833988348ac0ff45ace9421134ba4c4df82", "committedDate": "2020-07-12T13:04:23Z", "message": "Moved search modifier buttons into search bar and removed searchModeButton"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODg2MzY1", "url": "https://github.com/JabRef/jabref/pull/6682#pullrequestreview-446886365", "createdAt": "2020-07-12T15:04:09Z", "commit": {"oid": "bfaa3833988348ac0ff45ace9421134ba4c4df82"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQxNTowNDowOVrOGwU7Eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMlQxNTowNDowOVrOGwU7Eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyNzYzNA==", "bodyText": "I think it would make sense to add it to the search preferences as well", "url": "https://github.com/JabRef/jabref/pull/6682#discussion_r453327634", "createdAt": "2020-07-12T15:04:09Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/gui/search/GlobalSearchBar.java", "diffHunk": "@@ -325,7 +322,7 @@ private void updateResults(int matched, TextFlow description, boolean grammarBas\n     }\n \n     private void setHintTooltip(TextFlow description) {\n-        if (Globals.prefs.getBoolean(JabRefPreferences.SHOW_ADVANCED_HINTS)) {\n+        if (preferencesService.getGeneralPreferences().shouldShowAdvancedHints()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bfaa3833988348ac0ff45ace9421134ba4c4df82"}, "originalPosition": 288}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a48cd0df2ba4c429aec320ded61ba4323b9506c4", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/a48cd0df2ba4c429aec320ded61ba4323b9506c4", "committedDate": "2020-07-13T19:06:41Z", "message": "Hides modifier buttons if search bar is not focused"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8734944bd6ffd7f5f2abbbe6f7d7c0eca670ad28", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/8734944bd6ffd7f5f2abbbe6f7d7c0eca670ad28", "committedDate": "2020-07-13T19:43:26Z", "message": "Added CHANGELOG"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MDY1MzU5", "url": "https://github.com/JabRef/jabref/pull/6682#pullrequestreview-448065359", "createdAt": "2020-07-14T12:37:43Z", "commit": {"oid": "8734944bd6ffd7f5f2abbbe6f7d7c0eca670ad28"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMjozNzo0M1rOGxRxuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMjozNzo0M1rOGxRxuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDMyNDY2Nw==", "bodyText": "Is the builder really necessary? I think the with* methods can be added directly to the main class without any problems.", "url": "https://github.com/JabRef/jabref/pull/6682#discussion_r454324667", "createdAt": "2020-07-14T12:37:43Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/preferences/SearchPreferences.java", "diffHunk": "@@ -1,103 +1,63 @@\n package org.jabref.preferences;\n \n-import java.util.Map;\n-import java.util.Objects;\n-\n import org.jabref.gui.search.SearchDisplayMode;\n \n public class SearchPreferences {\n \n-    private static final String SEARCH_DISPLAY_MODE = \"searchDisplayMode\";\n-    private static final String SEARCH_CASE_SENSITIVE = \"caseSensitiveSearch\";\n-    private static final String SEARCH_REG_EXP = \"regExpSearch\";\n-\n-    private static final String SEARCH_DIALOG_HEIGHT = \"searchDialogHeight\";\n-    private static final String SEARCH_DIALOG_WIDTH = \"searchDialogWidth\";\n-    private static final String SEARCH_DIALOG_POS_X = \"searchDialogPosX\";\n-    private static final String SEARCH_DIALOG_POS_Y = \"searchDialogPosY\";\n+    private final SearchDisplayMode searchDisplayMode;\n+    private final boolean isCaseSensitive;\n+    private final boolean isRegularExpression;\n \n-    private final JabRefPreferences preferences;\n-\n-    public SearchPreferences(JabRefPreferences preferences) {\n-        this.preferences = Objects.requireNonNull(preferences);\n+    public SearchPreferences(SearchDisplayMode searchDisplayMode, boolean isCaseSensitive, boolean isRegularExpression) {\n+        this.searchDisplayMode = searchDisplayMode;\n+        this.isCaseSensitive = isCaseSensitive;\n+        this.isRegularExpression = isRegularExpression;\n     }\n \n-    public static void putDefaults(Map<String, Object> defaults) {\n-        defaults.put(SEARCH_DISPLAY_MODE, SearchDisplayMode.FILTER.toString());\n-        defaults.put(SEARCH_CASE_SENSITIVE, Boolean.FALSE);\n-        defaults.put(SEARCH_REG_EXP, Boolean.FALSE);\n-\n-        defaults.put(SEARCH_DIALOG_WIDTH, 650);\n-        defaults.put(SEARCH_DIALOG_HEIGHT, 500);\n-        defaults.put(SEARCH_DIALOG_POS_X, 0);\n-        defaults.put(SEARCH_DIALOG_POS_Y, 0);\n-    }\n-\n-    public SearchDisplayMode getSearchMode() {\n-        try {\n-            return SearchDisplayMode.valueOf(preferences.get(SEARCH_DISPLAY_MODE));\n-        } catch (IllegalArgumentException ex) {\n-            // Should only occur when the searchmode is set directly via preferences.put and the enum was not used\n-            return SearchDisplayMode.valueOf((String) preferences.defaults.get(SEARCH_DISPLAY_MODE));\n-        }\n-    }\n-\n-    public SearchPreferences setSearchMode(SearchDisplayMode searchDisplayMode) {\n-        preferences.put(SEARCH_DISPLAY_MODE, Objects.requireNonNull(searchDisplayMode).toString());\n-        return this;\n+    public SearchDisplayMode getSearchDisplayMode() {\n+        return searchDisplayMode;\n     }\n \n     public boolean isCaseSensitive() {\n-        return preferences.getBoolean(SEARCH_CASE_SENSITIVE);\n-    }\n-\n-    public SearchPreferences setCaseSensitive(boolean isCaseSensitive) {\n-        preferences.putBoolean(SEARCH_CASE_SENSITIVE, isCaseSensitive);\n-        return this;\n+        return isCaseSensitive;\n     }\n \n     public boolean isRegularExpression() {\n-        return preferences.getBoolean(SEARCH_REG_EXP);\n+        return isRegularExpression;\n     }\n \n-    public SearchPreferences setRegularExpression(boolean isRegularExpression) {\n-        preferences.putBoolean(SEARCH_REG_EXP, isRegularExpression);\n-        return this;\n+    public Builder getBuilder() {\n+        return new Builder(this);\n     }\n \n-    public int getSeachDialogWidth() {\n-        return preferences.getInt(SEARCH_DIALOG_WIDTH);\n-    }\n+    public static class Builder {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8734944bd6ffd7f5f2abbbe6f7d7c0eca670ad28"}, "originalPosition": 84}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbba792d6ddf1de519631641df4fa09273553852", "author": {"user": {"login": "calixtus", "name": "Carl Christian Snethlage"}}, "url": "https://github.com/JabRef/jabref/commit/bbba792d6ddf1de519631641df4fa09273553852", "committedDate": "2020-07-14T19:07:20Z", "message": "Relaxed builder pattern in SearchPreferences"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4ODQ2NjAz", "url": "https://github.com/JabRef/jabref/pull/6682#pullrequestreview-448846603", "createdAt": "2020-07-15T10:59:45Z", "commit": {"oid": "bbba792d6ddf1de519631641df4fa09273553852"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDo1OTo0NVrOGx5B2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDo1OTo0NVrOGx5B2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk2Nzc3MQ==", "bodyText": "The get() Method already returns the default if no value:\n public String get(String key) {\n        return prefs.get(key, (String) defaults.get(key));\n    }", "url": "https://github.com/JabRef/jabref/pull/6682#discussion_r454967771", "createdAt": "2020-07-15T10:59:45Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/preferences/JabRefPreferences.java", "diffHunk": "@@ -2356,4 +2363,27 @@ public void storeSpecialFieldsPreferences(SpecialFieldsPreferences specialFields\n         putBoolean(AUTOSYNCSPECIALFIELDSTOKEYWORDS, specialFieldsPreferences.getAutoSyncSpecialFieldsToKeyWords());\n         putBoolean(SERIALIZESPECIALFIELDS, specialFieldsPreferences.getSerializeSpecialFields());\n     }\n+\n+    @Override\n+    public SearchPreferences getSearchPreferences() {\n+        SearchDisplayMode searchDisplayMode;\n+        try {\n+            searchDisplayMode = SearchDisplayMode.valueOf(get(SEARCH_DISPLAY_MODE));\n+        } catch (IllegalArgumentException ex) {\n+            // Should only occur when the searchmode is set directly via preferences.put and the enum was not used\n+            searchDisplayMode = SearchDisplayMode.valueOf((String) defaults.get(SEARCH_DISPLAY_MODE));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbba792d6ddf1de519631641df4fa09273553852"}, "originalPosition": 51}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 209, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}