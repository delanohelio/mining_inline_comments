{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyNjA4NzYw", "number": 6402, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQxNzoxMToyM1rOD64iFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQxNzoxMToyM1rOD64iFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzMDcwMjMxOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/jabref/gui/actions/ActionHelper.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQxNzoxMToyM1rOGS8p5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQxNzo1NTowNVrOGS88AA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUyMTMxNg==", "bodyText": "I think this does not update the status if a file is added to the currently selected entry. For this, the isAnyFieldSetForSelectedEntry method uses flatMap instead of map.", "url": "https://github.com/JabRef/jabref/pull/6402#discussion_r422521316", "createdAt": "2020-05-09T17:11:23Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/gui/actions/ActionHelper.java", "diffHunk": "@@ -50,18 +50,23 @@ public static BooleanExpression isAnyFieldSetForSelectedEntry(List<Field> fields\n     }\n \n     public static BooleanExpression isFilePresentForSelectedEntry(StateManager stateManager, PreferencesService preferencesService) {\n-        return Bindings.createBooleanBinding(() -> {\n-                    List<LinkedFile> files = stateManager.getSelectedEntries().get(0).getFiles();\n-                    if ((files.size() > 0) && stateManager.getActiveDatabase().isPresent()) {\n-                        Optional<Path> filename = FileHelper.find(\n-                                stateManager.getActiveDatabase().get(),\n-                                files.get(0).getLink(),\n-                                preferencesService.getFilePreferences());\n-                        return filename.isPresent();\n-                    } else {\n-                        return false;\n-                    }\n-                }, stateManager.getSelectedEntries(),\n-                stateManager.getSelectedEntries().get(0).getFieldBinding(StandardField.FILE));\n+\n+        ObservableList<BibEntry> selectedEntries = stateManager.getSelectedEntries();\n+        MonadicObservableValue<Boolean> fileIsPresent = EasyBind.monadic(Bindings.valueAt(selectedEntries, 0)).map(entry -> {\n+            List<LinkedFile> files = entry.getFiles();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3eff0c49c0c63c626f2a6a324b4459000fc7fca"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUyNTk1Mg==", "bodyText": "I just tested it, it works as well when I add or remove a file to an entry both the context menu and the View menu get updated with the correct status", "url": "https://github.com/JabRef/jabref/pull/6402#discussion_r422525952", "createdAt": "2020-05-09T17:55:05Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/gui/actions/ActionHelper.java", "diffHunk": "@@ -50,18 +50,23 @@ public static BooleanExpression isAnyFieldSetForSelectedEntry(List<Field> fields\n     }\n \n     public static BooleanExpression isFilePresentForSelectedEntry(StateManager stateManager, PreferencesService preferencesService) {\n-        return Bindings.createBooleanBinding(() -> {\n-                    List<LinkedFile> files = stateManager.getSelectedEntries().get(0).getFiles();\n-                    if ((files.size() > 0) && stateManager.getActiveDatabase().isPresent()) {\n-                        Optional<Path> filename = FileHelper.find(\n-                                stateManager.getActiveDatabase().get(),\n-                                files.get(0).getLink(),\n-                                preferencesService.getFilePreferences());\n-                        return filename.isPresent();\n-                    } else {\n-                        return false;\n-                    }\n-                }, stateManager.getSelectedEntries(),\n-                stateManager.getSelectedEntries().get(0).getFieldBinding(StandardField.FILE));\n+\n+        ObservableList<BibEntry> selectedEntries = stateManager.getSelectedEntries();\n+        MonadicObservableValue<Boolean> fileIsPresent = EasyBind.monadic(Bindings.valueAt(selectedEntries, 0)).map(entry -> {\n+            List<LinkedFile> files = entry.getFiles();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUyMTMxNg=="}, "originalCommit": {"oid": "a3eff0c49c0c63c626f2a6a324b4459000fc7fca"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1799, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}