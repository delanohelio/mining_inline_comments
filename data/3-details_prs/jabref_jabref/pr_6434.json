{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0Mzg5NDAw", "number": 6434, "title": "Fix clear year and month field when converting to biblatex", "bodyText": "Fixes #6224\nAfter Cleanup entries with the selected option -> \"Convert to biblatex format (for example, move the value of the 'journal' field to 'journal tile')\nShould have two behaviours:\n\nif the field date is filled: remains the date and removes the year and month fields;\nif the field date is blank: sets the date value and removes the year and month fields.\n\n\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-05-06T23:51:09Z", "url": "https://github.com/JabRef/jabref/pull/6434", "merged": true, "mergeCommit": {"oid": "09111be0d1b6c60de6de202c84387e158f7727b4"}, "closed": true, "closedAt": "2020-05-14T09:02:55Z", "author": {"login": "catarinagomespt"}, "timelineItems": {"totalCount": 37, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcexZcagH2gAyNDE0Mzg5NDAwOjc4OGYzOTViNGMwOGMyZmUzNTU5ZjBkMWYwODhlODM5N2MyYmMzYzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchJr7zgFqTQxMTYwNDgyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "788f395b4c08c2fe3559f0d1f088e8397c2bc3c9", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/788f395b4c08c2fe3559f0d1f088e8397c2bc3c9", "committedDate": "2020-05-06T23:36:57Z", "message": "ISSUE :: 6224 - allow merging of year and date if identical"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05518d2838c26a108b190c7f7f1f8bf9e0e66571", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/05518d2838c26a108b190c7f7f1f8bf9e0e66571", "committedDate": "2020-05-06T23:42:34Z", "message": "fix comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MzU3MjM1", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-407357235", "createdAt": "2020-05-07T10:48:36Z", "commit": {"oid": "05518d2838c26a108b190c7f7f1f8bf9e0e66571"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1cfa2509d4f523d3c37fdaf72d4b23d7274bd97", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/e1cfa2509d4f523d3c37fdaf72d4b23d7274bd97", "committedDate": "2020-05-07T11:30:26Z", "message": "Merge branch 'master' of github.com:JabRef/jabref into fix-for-issue-6224"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93de4bcdcd4f430fc2113f123be99c47879c0325", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/93de4bcdcd4f430fc2113f123be99c47879c0325", "committedDate": "2020-05-07T11:34:29Z", "message": "Updated Changelog.md file with fixed issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3NDExMDQ0", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-407411044", "createdAt": "2020-05-07T12:13:37Z", "commit": {"oid": "93de4bcdcd4f430fc2113f123be99c47879c0325"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMjoxMzozN1rOGR7pgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMjoxNTowNVrOGR7sxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ1NjI1OQ==", "bodyText": "I think there should also be a check that the information in the date field coincides with the one in year & month. For example, if date = {2004-05} but year = {2005} the year field shouldn't be deleted.", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r421456259", "createdAt": "2020-05-07T12:13:37Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/cleanup/ConvertToBiblatexCleanup.java", "diffHunk": "@@ -39,6 +39,12 @@\n                 entry.clearField(StandardField.YEAR).ifPresent(changes::add);\n                 entry.clearField(StandardField.MONTH).ifPresent(changes::add);\n             });\n+        } else {\n+            // If field date is filled it should be removed the year and month fields\n+            entry.getFieldOrAlias(StandardField.DATE).ifPresent(newDate -> {\n+                entry.clearField(StandardField.YEAR).ifPresent(changes::add);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93de4bcdcd4f430fc2113f123be99c47879c0325"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTQ1NzA5NA==", "bodyText": "maybe \"where year and month fields were not cleared\" ?", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r421457094", "createdAt": "2020-05-07T12:15:05Z", "author": {"login": "tobiasdiez"}, "path": "CHANGELOG.md", "diffHunk": "@@ -54,6 +54,7 @@ Note that this project **does not** adhere to [Semantic Versioning](http://semve\n - We fixed an issue where JabRef switched to discrete graphics under macOS [#5935](https://github.com/JabRef/jabref/issues/5935)\n - We fixed an issue where the Preferences entry preview will be unexpected modified leads to Value too long exception [#6198](https://github.com/JabRef/jabref/issues/6198)\n - We fixed an issue where custom jstyles for Open/LibreOffice would only be valid if a layout line for the entry type `default` was at the end of the layout section [#6303](https://github.com/JabRef/jabref/issues/6303)\n+- We fixed an issue where clear year and month field when converting to biblatex [#6224](https://github.com/JabRef/jabref/issues/6224)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93de4bcdcd4f430fc2113f123be99c47879c0325"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29ae438c8d9877897f706887b9b077cbfd60864d", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/29ae438c8d9877897f706887b9b077cbfd60864d", "committedDate": "2020-05-07T12:36:12Z", "message": "Fix changelog.md file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "559e7490cbb3ffcf56899b983296a92a82dda8b5", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/559e7490cbb3ffcf56899b983296a92a82dda8b5", "committedDate": "2020-05-08T00:17:13Z", "message": "Check If date field is filled and is equal to year it should be removed the year and month fields"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4a4b1563247fee1d768f8a577687c86e21f4579", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/c4a4b1563247fee1d768f8a577687c86e21f4579", "committedDate": "2020-05-08T00:19:10Z", "message": "Added unit test: Cleanup With Date Already Present And Equals To Year Removes Year And Month"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e810e1e22b7481b48cd8514bac77d5a0392b0d98", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/e810e1e22b7481b48cd8514bac77d5a0392b0d98", "committedDate": "2020-05-08T00:39:38Z", "message": "ISSUE :: 6224 - Removed Unused import - java.util.Optional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8750df7c83ccc3ab3c565d22e69d0d4ce2ff86ea", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/8750df7c83ccc3ab3c565d22e69d0d4ce2ff86ea", "committedDate": "2020-05-08T00:45:54Z", "message": "ISSUE :: 6224 - Separated org.jabref.model.FieldChange from previous imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "433e800178b821565de0de49a4bf577596475993", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/433e800178b821565de0de49a4bf577596475993", "committedDate": "2020-05-08T09:39:37Z", "message": "Merge branch 'master' of github.com:JabRef/jabref into fix-for-issue-6224"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf164595b211df427825ed84ce7d6909daf33536", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/bf164595b211df427825ed84ce7d6909daf33536", "committedDate": "2020-05-08T11:42:43Z", "message": "remove checkstyle warning"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4Mjk0Njg5", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-408294689", "createdAt": "2020-05-08T14:50:42Z", "commit": {"oid": "bf164595b211df427825ed84ce7d6909daf33536"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxNDo1MDo0M1rOGSoUJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOFQxNDo1MDo0M1rOGSoUJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE4ODA2OA==", "bodyText": "Can you give the variable year1 a more meaningful name? Sure, everybody understands that, but nevertheless, we try to write exemplary code in JabRef (I know, it's still a loooooong way to go).", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r422188068", "createdAt": "2020-05-08T14:50:43Z", "author": {"login": "calixtus"}, "path": "src/main/java/org/jabref/logic/cleanup/ConvertToBiblatexCleanup.java", "diffHunk": "@@ -39,8 +39,18 @@\n                 entry.clearField(StandardField.YEAR).ifPresent(changes::add);\n                 entry.clearField(StandardField.MONTH).ifPresent(changes::add);\n             });\n+        } else {\n+            // If date field is filled and is equal to year it should be removed the year and month fields\n+            entry.getFieldOrAlias(StandardField.DATE).ifPresent(date -> {\n+                entry.getFieldOrAlias(StandardField.YEAR).ifPresent(yearl -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf164595b211df427825ed84ce7d6909daf33536"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0eb590659ab54a9a8b3a70927e1b26524b980aeb", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/0eb590659ab54a9a8b3a70927e1b26524b980aeb", "committedDate": "2020-05-08T15:23:45Z", "message": "Change variable newYear name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4MzE5NjU5", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-408319659", "createdAt": "2020-05-08T15:26:34Z", "commit": {"oid": "0eb590659ab54a9a8b3a70927e1b26524b980aeb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NTY4NTAw", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-408568500", "createdAt": "2020-05-08T22:51:00Z", "commit": {"oid": "0eb590659ab54a9a8b3a70927e1b26524b980aeb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1628f21355fa3292a2919796bb9b7c5e8cd23c6e", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/1628f21355fa3292a2919796bb9b7c5e8cd23c6e", "committedDate": "2020-05-09T15:59:45Z", "message": "Merge branch 'master' of github.com:JabRef/jabref into fix-for-issue-6224"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b1c8529c7cbd5a35c0ac61be23884d3a5117883", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/5b1c8529c7cbd5a35c0ac61be23884d3a5117883", "committedDate": "2020-05-09T16:02:17Z", "message": "Update Changelog.md"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NjY2Nzkw", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-408666790", "createdAt": "2020-05-09T16:56:16Z", "commit": {"oid": "5b1c8529c7cbd5a35c0ac61be23884d3a5117883"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQxNjo1NjoxNlrOGS8jfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQxNjo1ODowMVrOGS8kMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUxOTY3OQ==", "bodyText": "This should be 2011-01 to include the month, right?", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r422519679", "createdAt": "2020-05-09T16:56:16Z", "author": {"login": "tobiasdiez"}, "path": "src/test/java/org/jabref/logic/cleanup/ConvertToBiblatexCleanupTest.java", "diffHunk": "@@ -46,6 +46,20 @@ public void cleanupWithDateAlreadyPresentDoesNothing() {\n         assertEquals(Optional.of(\"2012\"), entry.getField(StandardField.DATE));\n     }\n \n+    @Test\n+    public void cleanupWithDateAlreadyPresentAndEqualsToYearRemovesYearAndMonth() {\n+        BibEntry entry = new BibEntry();\n+        entry.setField(StandardField.YEAR, \"2011\");\n+        entry.setField(StandardField.MONTH, \"#jan#\");\n+        entry.setField(StandardField.DATE, \"2011\");\n+\n+        worker.cleanup(entry);\n+\n+        assertEquals(Optional.empty(), entry.getField(StandardField.YEAR));\n+        assertEquals(Optional.empty(), entry.getField(StandardField.MONTH));\n+        assertEquals(Optional.of(\"2011\"), entry.getField(StandardField.DATE));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1c8529c7cbd5a35c0ac61be23884d3a5117883"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUxOTg1OQ==", "bodyText": "Adding to @koppor's comment, we have a date class which you can use to parse the date in order to get the year AND the month.", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r422519859", "createdAt": "2020-05-09T16:58:01Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/logic/cleanup/ConvertToBiblatexCleanup.java", "diffHunk": "@@ -39,8 +39,18 @@\n                 entry.clearField(StandardField.YEAR).ifPresent(changes::add);\n                 entry.clearField(StandardField.MONTH).ifPresent(changes::add);\n             });\n+        } else {\n+            // If date field is filled and is equal to year it should be removed the year and month fields\n+            entry.getFieldOrAlias(StandardField.DATE).ifPresent(date -> {\n+                entry.getFieldOrAlias(StandardField.YEAR).ifPresent(checkYear -> {\n+                    // Get the year of the date field (4 digits).\n+                    if (date.substring(0, 4).equals(checkYear)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1c8529c7cbd5a35c0ac61be23884d3a5117883"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05c86c2428ef95a76ae758000189f55ef9e16570", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/05c86c2428ef95a76ae758000189f55ef9e16570", "committedDate": "2020-05-10T20:21:32Z", "message": "ISSUE :: 6224 - Added month validation and tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb75aa507fb06251808db3d8c790b82028e8e8c1", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/fb75aa507fb06251808db3d8c790b82028e8e8c1", "committedDate": "2020-05-12T19:24:19Z", "message": "ISSUE :: 6224 - For inconsistent data: Do not overwrite/move"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3541c2f96568650b25d04acc6bdf10faf55fa7e6", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/3541c2f96568650b25d04acc6bdf10faf55fa7e6", "committedDate": "2020-05-12T19:33:31Z", "message": "ISSUE :: 6224 - Fix Test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23b9878b3b3334a9d26a3f9f79cc3ab72e345141", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/23b9878b3b3334a9d26a3f9f79cc3ab72e345141", "committedDate": "2020-05-12T19:33:58Z", "message": "Merge branch 'master' of github.com:JabRef/jabref into fix-for-issue-6224"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "935f65616dbc3053eba514326aaea9c1fe13f81f", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/935f65616dbc3053eba514326aaea9c1fe13f81f", "committedDate": "2020-05-12T19:38:59Z", "message": "ISSUE :: 6224 - Added month checking Test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2b1950ef575e4f5b784d93e33c71b0ba3ad5645", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/c2b1950ef575e4f5b784d93e33c71b0ba3ad5645", "committedDate": "2020-05-12T19:47:42Z", "message": "ISSUE :: 6224 - Fix Test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzc2NjEw", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-410376610", "createdAt": "2020-05-12T19:58:08Z", "commit": {"oid": "5b1c8529c7cbd5a35c0ac61be23884d3a5117883"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxOTo1ODowOFrOGUWtOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxOTo1ODowOFrOGUWtOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5NjczMQ==", "bodyText": "Done.", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r423996731", "createdAt": "2020-05-12T19:58:08Z", "author": {"login": "catarinagomespt"}, "path": "src/test/java/org/jabref/logic/cleanup/ConvertToBiblatexCleanupTest.java", "diffHunk": "@@ -46,6 +46,20 @@ public void cleanupWithDateAlreadyPresentDoesNothing() {\n         assertEquals(Optional.of(\"2012\"), entry.getField(StandardField.DATE));\n     }\n \n+    @Test\n+    public void cleanupWithDateAlreadyPresentAndEqualsToYearRemovesYearAndMonth() {\n+        BibEntry entry = new BibEntry();\n+        entry.setField(StandardField.YEAR, \"2011\");\n+        entry.setField(StandardField.MONTH, \"#jan#\");\n+        entry.setField(StandardField.DATE, \"2011\");\n+\n+        worker.cleanup(entry);\n+\n+        assertEquals(Optional.empty(), entry.getField(StandardField.YEAR));\n+        assertEquals(Optional.empty(), entry.getField(StandardField.MONTH));\n+        assertEquals(Optional.of(\"2011\"), entry.getField(StandardField.DATE));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUxOTY3OQ=="}, "originalCommit": {"oid": "5b1c8529c7cbd5a35c0ac61be23884d3a5117883"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzgxNTU2", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-410381556", "createdAt": "2020-05-12T20:05:28Z", "commit": {"oid": "c2b1950ef575e4f5b784d93e33c71b0ba3ad5645"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwOTQ4NjMx", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-410948631", "createdAt": "2020-05-13T13:54:34Z", "commit": {"oid": "c2b1950ef575e4f5b784d93e33c71b0ba3ad5645"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMzo1NDozNFrOGUyxxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNDowOTowMFrOGUzcMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDQ1NjY0Ng==", "bodyText": "Could you please adjust the javadoc as well?", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r424456646", "createdAt": "2020-05-13T13:54:34Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/model/entry/Date.java", "diffHunk": "@@ -54,7 +54,8 @@ public Date(TemporalAccessor date) {\n                 \"MMMM d, uuuu\",\n                 \"MMMM, uuuu\",\n                 \"d.M.uuuu\",\n-                \"uuuu.M.d\", \"uuuu\");\n+                \"uuuu.M.d\", \"uuuu\",\n+                \"MMM, uuuu\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2b1950ef575e4f5b784d93e33c71b0ba3ad5645"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDQ2NzUwNg==", "bodyText": "One of the Date.parse method overloads accepts already Optional as parameter, so you can make your code a bit easier and remove the ifPressent checks for Year and month\nso you would have checkDate = Date.parse(entry.getFieldOrAlias(StandardField.YEAR),  entry.getFieldOrAlias(StandardField.Month), Optional.empty())", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r424467506", "createdAt": "2020-05-13T14:09:00Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/logic/cleanup/ConvertToBiblatexCleanup.java", "diffHunk": "@@ -39,8 +41,26 @@\n                 entry.clearField(StandardField.YEAR).ifPresent(changes::add);\n                 entry.clearField(StandardField.MONTH).ifPresent(changes::add);\n             });\n+        } else {\n+            // If the year from date field is filled and equal to year it should be removed the year field\n+            entry.getFieldOrAlias(StandardField.DATE).ifPresent(date -> {\n+                entry.getFieldOrAlias(StandardField.YEAR).ifPresent(year -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2b1950ef575e4f5b784d93e33c71b0ba3ad5645"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5604f3c6fcd157006e7a8606cc04f115f0aed4fb", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/5604f3c6fcd157006e7a8606cc04f115f0aed4fb", "committedDate": "2020-05-13T19:04:24Z", "message": "ISSUE :: 6224 - Change Date.parse"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28e9c6d50e4c7436b4d473086f1e4a472eeaa920", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/28e9c6d50e4c7436b4d473086f1e4a472eeaa920", "committedDate": "2020-05-13T19:16:51Z", "message": "ISSUE :: 6224 - Update Date class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c0d2a4caaab6b912252080bfaddf7787bf44276", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/3c0d2a4caaab6b912252080bfaddf7787bf44276", "committedDate": "2020-05-13T19:52:01Z", "message": "ISSUE :: 6224 - Fix Date"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMzAwMjMw", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-411300230", "createdAt": "2020-05-13T21:07:42Z", "commit": {"oid": "3c0d2a4caaab6b912252080bfaddf7787bf44276"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMTowNzo0MlrOGVDj2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMTowNzo0MlrOGVDj2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczMTYxMA==", "bodyText": "Just a quick note,\nThe Optional equals also returns true if both are empty.\nThat could be the case when there is a value in all fields, but it's invalid., eg maybe some random letters.\nCould you please add a test case for that as well. Then you should have all cases covered. I think in practice this doesn't matter but code wise it would be nice to have this edge case covered as well.\nOtherwise it's looking good to me! Thanks again for your ongoing contribution\nhttps://docs.oracle.com/javase/8/docs/api/java/util/Optional.html#equals-java.lang.Object-", "url": "https://github.com/JabRef/jabref/pull/6434#discussion_r424731610", "createdAt": "2020-05-13T21:07:42Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/logic/cleanup/ConvertToBiblatexCleanup.java", "diffHunk": "@@ -39,8 +41,19 @@\n                 entry.clearField(StandardField.YEAR).ifPresent(changes::add);\n                 entry.clearField(StandardField.MONTH).ifPresent(changes::add);\n             });\n+        } else {\n+            // If the year from date field is filled and equal to year it should be removed the year field\n+            entry.getFieldOrAlias(StandardField.DATE).ifPresent(date -> {\n+                Optional<Date> newDate = Date.parse(date);\n+                Optional<Date> checkDate = Date.parse(entry.getFieldOrAlias(StandardField.YEAR),\n+                        entry.getFieldOrAlias(StandardField.MONTH), Optional.empty());\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c0d2a4caaab6b912252080bfaddf7787bf44276"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b910f66b8b61a36cc4402b0e29cee7d599ebbba", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/3b910f66b8b61a36cc4402b0e29cee7d599ebbba", "committedDate": "2020-05-13T23:02:20Z", "message": "ISSUE :: 6224 - Added new test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "440db8822460e39df663356d5795c50e3f98bc6a", "author": {"user": {"login": "catarinagomespt", "name": "Catarina Gomes"}}, "url": "https://github.com/JabRef/jabref/commit/440db8822460e39df663356d5795c50e3f98bc6a", "committedDate": "2020-05-13T23:18:09Z", "message": "Merge branch 'master' of github.com:JabRef/jabref into fix-for-issue-6224"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNTAyNDY0", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-411502464", "createdAt": "2020-05-14T06:37:43Z", "commit": {"oid": "440db8822460e39df663356d5795c50e3f98bc6a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNjA0ODIz", "url": "https://github.com/JabRef/jabref/pull/6434#pullrequestreview-411604823", "createdAt": "2020-05-14T09:02:43Z", "commit": {"oid": "440db8822460e39df663356d5795c50e3f98bc6a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 248, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}