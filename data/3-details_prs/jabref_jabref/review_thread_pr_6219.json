{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1NTMxMTk5", "number": 6219, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxMDo0MjozMlrODsnSbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxMDo0MjozMlrODsnSbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MTA3NjMxOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/jabref/logic/integrity/EditionChecker.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxMDo0MjozMlrOF9jy8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxMTowMjo0N1rOF9kfGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDA5MzkzOQ==", "bodyText": "The error message says that the first LETTER should be capitalized.\nONLY_NUMBERALS tests for numbers. Numbers are not letters.\nThus, I think, testing for numbers is wrong here.\nThe old condidion in plain English (which is IMHO right):\nIn case the edition contains some letters, check that the first letter is capitalized.\nThe new condidion reads:\nIn case the text consists of numbers only, then check if nubmers are DISALLOWED.\n(In other words: If there are numbers and they are disabled)\nThen check whether the first letter is capitalized (side comment: A number is never capitalized (according to the regex at FIRST_LETTER_CAPITALIZED))\nI think, the new condidion does not make sense at it mixes numbers and letters.", "url": "https://github.com/JabRef/jabref/pull/6219#discussion_r400093939", "createdAt": "2020-03-30T10:42:32Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/integrity/EditionChecker.java", "diffHunk": "@@ -54,7 +52,7 @@ public EditionChecker(BibDatabaseContext bibDatabaseContext, boolean allowIntege\n             if (!isFirstCharDigit(value) && (!allowIntegerEdition) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {\n                 return Optional.of(Localization.lang(\"should have the first letter capitalized\"));\n             } else {\n-                if (!ONLY_NUMERALS.test(value.trim()) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {\n+                if (ONLY_NUMERALS.test(value.trim()) && (!allowIntegerEdition) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5cc71c0a8476a3b4ab5beb02b3c7b52b681d85f6"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDA5NDIwNQ==", "bodyText": "Does the code test still work if you revert the change?", "url": "https://github.com/JabRef/jabref/pull/6219#discussion_r400094205", "createdAt": "2020-03-30T10:43:03Z", "author": {"login": "koppor"}, "path": "src/main/java/org/jabref/logic/integrity/EditionChecker.java", "diffHunk": "@@ -54,7 +52,7 @@ public EditionChecker(BibDatabaseContext bibDatabaseContext, boolean allowIntege\n             if (!isFirstCharDigit(value) && (!allowIntegerEdition) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {\n                 return Optional.of(Localization.lang(\"should have the first letter capitalized\"));\n             } else {\n-                if (!ONLY_NUMERALS.test(value.trim()) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {\n+                if (ONLY_NUMERALS.test(value.trim()) && (!allowIntegerEdition) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDA5MzkzOQ=="}, "originalCommit": {"oid": "5cc71c0a8476a3b4ab5beb02b3c7b52b681d85f6"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDEwNTI0Mg==", "bodyText": "The test obviously didn't work. that's why I had to introduce this change and it's due to the short circuit operation.\n\nWe are  in bibtex mode and only have a number (2)\nisFirstCharDigit return true= > Short circuit to else branch\nOnly numerals checks if we have one or more numbers => true\n3.1 Do we  have=> no  => return error message\n3.2  Do we allow numbers?  yes => Is the first one capitalized? Obviously  not, cause it's a number^^ (okay, that can be removed\n\nThose were the failing tests:\n        assertWrong(withMode(createContext(StandardField.EDITION, \"2\"), BibDatabaseMode.BIBTEX));\n        assertCorrect(withMode(createContext(StandardField.EDITION, \"2\"), BibDatabaseMode.BIBTEX), true);", "url": "https://github.com/JabRef/jabref/pull/6219#discussion_r400105242", "createdAt": "2020-03-30T11:02:47Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/logic/integrity/EditionChecker.java", "diffHunk": "@@ -54,7 +52,7 @@ public EditionChecker(BibDatabaseContext bibDatabaseContext, boolean allowIntege\n             if (!isFirstCharDigit(value) && (!allowIntegerEdition) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {\n                 return Optional.of(Localization.lang(\"should have the first letter capitalized\"));\n             } else {\n-                if (!ONLY_NUMERALS.test(value.trim()) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {\n+                if (ONLY_NUMERALS.test(value.trim()) && (!allowIntegerEdition) && !FIRST_LETTER_CAPITALIZED.test(value.trim())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDA5MzkzOQ=="}, "originalCommit": {"oid": "5cc71c0a8476a3b4ab5beb02b3c7b52b681d85f6"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1868, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}