{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3MjI1OTE3", "number": 6233, "title": "Add disable/enable calculation of items in group", "bodyText": "fixes #6042\nThis is my first Pull Request to a project (new Java developer).\nAdd: disable/enable calculation of items in group\nI realized that GroupNodeViewModel.java class uses method \"calculateNumberOfMatches\" to get number of items. Looks like it uploads full database from disk every time you need to calculate No of items in group. Therefore, if you have 1 thousand groups, it will read the entire database 1 thousand times.\nUI changes:\n\nadded new checkbox in Preferences/Groups - \"Display quantity of items in group\";\nadded new property DISPLAY_GROUP_QUANTITY to JabRefPreferences.java file;\nconnected new checkbox with JabRefPreferences.java. I used another preferences as a sample;\n\nLogic changes:\n\nI added link to JabRefPreferences in GroupTreeView class.\nIf user wants to display groups quantity, a panel with quantity will be shown. Quantity is calculated when GroupNodeViewModel class is initialized, so I decided to wrap a panel into an \"if\" statement.\n\nTests passed.", "createdAt": "2020-04-01T20:50:43Z", "url": "https://github.com/JabRef/jabref/pull/6233", "merged": true, "mergeCommit": {"oid": "efc69be2a35ac3c4d536ab4836924d7aad7458de"}, "closed": true, "closedAt": "2020-04-05T13:17:01Z", "author": {"login": "Gena928"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSzjb7gH2gAyMzk3MjI1OTE3OjgzNGM2NWY5NzFiNzA5MDU5YjY3Y2YyNGNhYjg3NjI5MmMxYjhlYWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcUp8igAH2gAyMzk3MjI1OTE3OmJmYmZmZTAzYTRhZjBkY2E5ZDJjZWU4MDBkMjE2Mzc0NjNjNWQ4NjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "834c65f971b709059b67cf24cab876292c1b8ead", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/834c65f971b709059b67cf24cab876292c1b8ead", "committedDate": "2020-03-30T19:20:35Z", "message": "Init changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc03c034ff2df3d50535c79c56dfe631b52970fb", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/bc03c034ff2df3d50535c79c56dfe631b52970fb", "committedDate": "2020-03-30T19:21:11Z", "message": "Merge branch 'master' of https://github.com/JabRef/jabref"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f5b71829450e299f9a04f465481b881bf3c4694", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/6f5b71829450e299f9a04f465481b881bf3c4694", "committedDate": "2020-03-30T19:56:48Z", "message": "Init changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f25ec45d37df3177c3587b096cc99abfbd7144c2", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/f25ec45d37df3177c3587b096cc99abfbd7144c2", "committedDate": "2020-03-30T20:03:34Z", "message": "\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043c\u0430\u0441\u0442\u0435\u0440\u0430"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b7ce6d31823f35c116d6751a4e28d23b961f258", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/6b7ce6d31823f35c116d6751a4e28d23b961f258", "committedDate": "2020-03-30T20:23:25Z", "message": "\u041f\u0440\u043e\u0441\u0442\u043e \u043a\u043e\u043c\u043c\u0438\u0442"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d87baa3b7df2ca8bf0e644b4d1e0a9f061c8997", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/7d87baa3b7df2ca8bf0e644b4d1e0a9f061c8997", "committedDate": "2020-03-31T18:30:32Z", "message": "Merge branch 'master' of https://github.com/JabRef/jabref"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7df02e425dd6675644dc25f42d1aa36b553a73a4", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/7df02e425dd6675644dc25f42d1aa36b553a73a4", "committedDate": "2020-04-01T18:21:36Z", "message": "Merge branch 'master' of https://github.com/JabRef/jabref"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2862f2afaebf367327887396564d6a5d664f3e6c", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/2862f2afaebf367327887396564d6a5d664f3e6c", "committedDate": "2020-04-01T19:45:59Z", "message": "Issue #6042 fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/181f1e9b022e551409fb8360d7f6b32246be532c", "committedDate": "2020-04-01T20:13:20Z", "message": "Issue #6042 fixed\nCorrected resources file after not passing the test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NjA0MDYx", "url": "https://github.com/JabRef/jabref/pull/6233#pullrequestreview-386604061", "createdAt": "2020-04-02T16:39:50Z", "commit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjozOTo1MVrOF_z3GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjozOTo1MVrOF_z3GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQ1NDI5Nw==", "bodyText": "Please use the existing PreferencesService class, it is already a wrapper/it extends the JabRefPreferences class.\nJust add a method there for getting the preferences key", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402454297", "createdAt": "2020-04-02T16:39:51Z", "author": {"login": "Siedlerchr"}, "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "diffHunk": "@@ -71,13 +72,15 @@\n \n     private GroupTreeViewModel viewModel;\n     private CustomLocalDragboard localDragboard;\n+    private JabRefPreferences preferences;\n \n     private DragExpansionHandler dragExpansionHandler;\n \n     @FXML\n     public void initialize() {\n         this.localDragboard = stateManager.getLocalDragboard();\n         viewModel = new GroupTreeViewModel(stateManager, dialogService, preferencesService, taskExecutor, localDragboard);\n+        preferences = JabRefPreferences.getInstance();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2OTc2NjIw", "url": "https://github.com/JabRef/jabref/pull/6233#pullrequestreview-386976620", "createdAt": "2020-04-03T06:55:28Z", "commit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjo1NToyOFrOGAHOQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjo1NToyOFrOGAHOQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc3MTUyMA==", "bodyText": "Please remove the line here, it will be automatically synchronized with crowdin", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402771520", "createdAt": "2020-04-03T06:55:28Z", "author": {"login": "Siedlerchr"}, "path": "src/main/resources/l10n/JabRef_da.properties", "diffHunk": "@@ -1110,6 +1110,7 @@ Main\\ layout\\ file=Hoved-layoutfil\n \n Always\\ add\\ letter\\ (a,\\ b,\\ ...)\\ to\\ generated\\ keys=Tilf\u00f8j altid bogstav (a, b, ...) til genererede n\u00f8gler\n Default\\ pattern=Standardm\u00f8nster\n+Display\\ quantity\\ of\\ items\\ in\\ group=", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "181f1e9b022e551409fb8360d7f6b32246be532c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc4d4495eec7c3f930672aa815cf872a6572fdfb", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/cc4d4495eec7c3f930672aa815cf872a6572fdfb", "committedDate": "2020-04-03T08:23:41Z", "message": "- Added new property to PreferencesService and JabRefPreferences\n- Used this property in GroupsTabView\n- DisplayGroupQuantity renamed into DisplayGroupCount in GroupsTabView & GroupsTabViewModel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09cded7cddf91136d5ad36e6cae28380f6efe1ba", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/09cded7cddf91136d5ad36e6cae28380f6efe1ba", "committedDate": "2020-04-03T08:27:49Z", "message": "- removed line from JabRef_en.properties"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MDY0ODA3", "url": "https://github.com/JabRef/jabref/pull/6233#pullrequestreview-387064807", "createdAt": "2020-04-03T08:41:34Z", "commit": {"oid": "09cded7cddf91136d5ad36e6cae28380f6efe1ba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwODo0MTozNFrOGALgBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwODo0MTozNFrOGALgBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg0MTYwNQ==", "bodyText": "You only have to add this to en properties file", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r402841605", "createdAt": "2020-04-03T08:41:34Z", "author": {"login": "Siedlerchr"}, "path": "src/main/resources/l10n/JabRef_da.properties", "diffHunk": "@@ -1110,7 +1110,8 @@ Main\\ layout\\ file=Hoved-layoutfil\n \n Always\\ add\\ letter\\ (a,\\ b,\\ ...)\\ to\\ generated\\ keys=Tilf\u00f8j altid bogstav (a, b, ...) til genererede n\u00f8gler\n Default\\ pattern=Standardm\u00f8nster\n-Display\\ quantity\\ of\\ items\\ in\\ group=\n+Display\\ count\\ of\\ items\\ in\\ group=", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09cded7cddf91136d5ad36e6cae28380f6efe1ba"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdc18a9c2923cf441e2a4e440063187e538adc48", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/cdc18a9c2923cf441e2a4e440063187e538adc48", "committedDate": "2020-04-03T09:15:32Z", "message": "Updated Properties file\n- removed line from ...da.properties;\n- added line to ...en.properties;"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MTk5MDA2", "url": "https://github.com/JabRef/jabref/pull/6233#pullrequestreview-387199006", "createdAt": "2020-04-03T12:12:00Z", "commit": {"oid": "cdc18a9c2923cf441e2a4e440063187e538adc48"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NzI3NTcz", "url": "https://github.com/JabRef/jabref/pull/6233#pullrequestreview-387727573", "createdAt": "2020-04-04T19:26:54Z", "commit": {"oid": "cdc18a9c2923cf441e2a4e440063187e538adc48"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxOToyNjo1NVrOGA0HwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxOToyNjo1NVrOGA0HwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwNzEzNg==", "bodyText": "As noted in the issue, the circle node should always be displayed because it is also used for the any/all selected status. Can you thus please add the if check only around the text here.", "url": "https://github.com/JabRef/jabref/pull/6233#discussion_r403507136", "createdAt": "2020-04-04T19:26:55Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/gui/groups/GroupTreeView.java", "diffHunk": "@@ -120,27 +120,29 @@ public void initialize() {\n                 .withTooltip(GroupNodeViewModel::getDescription)\n                 .install(mainColumn);\n \n-        // Number of hits\n-        PseudoClass anySelected = PseudoClass.getPseudoClass(\"any-selected\");\n-        PseudoClass allSelected = PseudoClass.getPseudoClass(\"all-selected\");\n-        new ViewModelTreeTableCellFactory<GroupNodeViewModel>()\n-                .withGraphic(group -> {\n-                    final StackPane node = new StackPane();\n-                    node.getStyleClass().setAll(\"hits\");\n-                    if (!group.isRoot()) {\n-                        BindingsHelper.includePseudoClassWhen(node, anySelected,\n-                                group.anySelectedEntriesMatchedProperty());\n-                        BindingsHelper.includePseudoClassWhen(node, allSelected,\n-                                group.allSelectedEntriesMatchedProperty());\n-                    }\n-                    Text text = new Text();\n-                    text.textProperty().bind(group.getHits().asString());\n-                    text.getStyleClass().setAll(\"text\");\n-                    node.getChildren().add(text);\n-                    node.setMaxWidth(Control.USE_PREF_SIZE);\n-                    return node;\n-                })\n-                .install(numberColumn);\n+        // Number of hits (only if user wants to see them)\n+        if (preferencesService.getDisplayGroupCount()) {\n+            PseudoClass anySelected = PseudoClass.getPseudoClass(\"any-selected\");\n+            PseudoClass allSelected = PseudoClass.getPseudoClass(\"all-selected\");\n+            new ViewModelTreeTableCellFactory<GroupNodeViewModel>()\n+                    .withGraphic(group -> {\n+                        final StackPane node = new StackPane();\n+                        node.getStyleClass().setAll(\"hits\");\n+                        if (!group.isRoot()) {\n+                            BindingsHelper.includePseudoClassWhen(node, anySelected,\n+                                    group.anySelectedEntriesMatchedProperty());\n+                            BindingsHelper.includePseudoClassWhen(node, allSelected,\n+                                    group.allSelectedEntriesMatchedProperty());\n+                        }\n+                        Text text = new Text();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdc18a9c2923cf441e2a4e440063187e538adc48"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea19b70c6a26f3a34567f882efee7319d154d843", "author": {"user": {"login": "Gena928", "name": "Gennadiy"}}, "url": "https://github.com/JabRef/jabref/commit/ea19b70c6a26f3a34567f882efee7319d154d843", "committedDate": "2020-04-05T10:46:46Z", "message": "Changed GroupTreeView according to comments from Tobiasdiez\nMain task - disable calling \"group.getHits()\" method to avoid calculation of items in group."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfbffe03a4af0dca9d2cee800d21637463c5d862", "author": {"user": {"login": "tobiasdiez", "name": "Tobias Diez"}}, "url": "https://github.com/JabRef/jabref/commit/bfbffe03a4af0dca9d2cee800d21637463c5d862", "committedDate": "2020-04-05T13:16:48Z", "message": "Remove empty line"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 304, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}