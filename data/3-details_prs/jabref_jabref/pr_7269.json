{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2NDY3NDE4", "number": 7269, "title": "Only disable  move to file dir when path equals", "bodyText": "Fix equals in path method\nFixes #7194\nThe dialog is now only disable when the file is already in the file directory\n\n\n\n Change in CHANGELOG.md described (if applicable)\n Tests created for changes (if applicable)\n Manually tested changed features in running JabRef (always required)\n Screenshots added in PR description (for UI changes)\n Checked documentation: Is the information available and up to date? If not created an issue at https://github.com/JabRef/user-documentation/issues or, even better, submitted a pull request to the documentation repository.", "createdAt": "2020-12-29T12:33:55Z", "url": "https://github.com/JabRef/jabref/pull/7269", "merged": true, "mergeCommit": {"oid": "afdb1942c5ec2126e69c92c7f2660459a7bdbeae"}, "closed": true, "closedAt": "2020-12-30T12:43:04Z", "author": {"login": "Siedlerchr"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdq59TQAH2gAyNTQ2NDY3NDE4OjlkNjdhYWU3OTI2MDc0MjU1NDVlZDI0YzRiZGFkYTc4NDAxMzU1ZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdrA454AFqTU1OTY5MTkyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9d67aae792607425545ed24c4bdada78401355d7", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/9d67aae792607425545ed24c4bdada78401355d7", "committedDate": "2020-12-29T12:33:36Z", "message": "Only disable  move to file dir when path equals\n\nFix equals in path method\nFixes #7194"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57887baac14fd9102e10f009b4eb45439f735f36", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/57887baac14fd9102e10f009b4eb45439f735f36", "committedDate": "2020-12-29T12:38:48Z", "message": "fix checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NjEyMTQ2", "url": "https://github.com/JabRef/jabref/pull/7269#pullrequestreview-559612146", "createdAt": "2020-12-29T16:40:23Z", "commit": {"oid": "57887baac14fd9102e10f009b4eb45439f735f36"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxNjo0MDoyNFrOIMTYdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxNjo0Mjo1MVrOIMTbUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc3MTM4MA==", "bodyText": "The MOVE_FILE_TO_FOLDER_AND_RENAME should still be enabled if the file is already in the correct folder, but not of the correct name, or not?", "url": "https://github.com/JabRef/jabref/pull/7269#discussion_r549771380", "createdAt": "2020-12-29T16:40:24Z", "author": {"login": "tobiasdiez"}, "path": "src/main/java/org/jabref/gui/fieldeditors/LinkedFilesEditor.java", "diffHunk": "@@ -275,7 +275,7 @@ public ContextAction(StandardActions command, LinkedFileViewModel linkedFile, Pr\n                         case MOVE_FILE_TO_FOLDER_AND_RENAME, MOVE_FILE_TO_FOLDER -> Bindings.createBooleanBinding(\n                                 () -> !linkedFile.getFile().isOnlineLink()\n                                         && linkedFile.getFile().findIn(databaseContext, preferencesService.getFilePreferences()).isPresent()\n-                                        && linkedFile.isGeneratedPathSameAsOriginal(),\n+                                        && !linkedFile.isGeneratedPathSameAsOriginal(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57887baac14fd9102e10f009b4eb45439f735f36"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc3MjExNA==", "bodyText": "If it's hard to write tests, then it's a good indication that some refactoring should be done. Indeed, we use the mvvm pattern to make testing easy. Could you thus please add a constructor in the viewmodel that accepts a linkedFileHandler .", "url": "https://github.com/JabRef/jabref/pull/7269#discussion_r549772114", "createdAt": "2020-12-29T16:42:51Z", "author": {"login": "tobiasdiez"}, "path": "src/test/java/org/jabref/gui/fieldeditors/LinkedFileViewModelTest.java", "diffHunk": "@@ -170,4 +168,28 @@ void downloadDoesNotOverwriteFileTypeExtension() throws MalformedURLException {\n         task.onFailure(Assertions::fail);\n         new CurrentThreadTaskExecutor().execute(task);\n     }\n+\n+    @Test\n+    void isNotSamePath() {\n+        linkedFile = new LinkedFile(\"desc\", tempFile, \"pdf\");\n+        databaseContext = mock(BibDatabaseContext.class);\n+        when(filePreferences.getFileNamePattern()).thenReturn(\"[citationkey]\"); // use this variant, as we cannot mock the linkedFileHandler cause it's initialized inside the viewModel", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57887baac14fd9102e10f009b4eb45439f735f36"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46925314ce1d32af89efa6161b33b64f5e131c0d", "author": {"user": {"login": "Siedlerchr", "name": "Christoph"}}, "url": "https://github.com/JabRef/jabref/commit/46925314ce1d32af89efa6161b33b64f5e131c0d", "committedDate": "2020-12-29T17:23:38Z", "message": "Allow rename and move when in file dir"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NjkxOTI4", "url": "https://github.com/JabRef/jabref/pull/7269#pullrequestreview-559691928", "createdAt": "2020-12-29T20:38:09Z", "commit": {"oid": "46925314ce1d32af89efa6161b33b64f5e131c0d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4851, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}