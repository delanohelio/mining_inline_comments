{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI5NTk5ODQx", "number": 2307, "title": "GH-2306 more robust check for external bindings in FedXConnection", "bodyText": "GitHub issue resolved: #2306  \nBriefly describe the changes proposed in this PR:\n\nin FedXConnection, when checking if supplied bindings contain anything other than the \"special\" FedX bindings, do not assume we know the exact number of supplied FedX bindings, as it can vary.\nin SailUpdateExecutor, when merging result bindings with preset bindings, ensure a binding is not null before merging.\n\n\nPR Author Checklist (see the contributor guidelines for more details):\n\n my pull request is self-contained\n I've added tests for the changes I made\n I've applied code formatting (you can use mvn process-resources to format from the command line)\n every commit message starts with the issue number (GH-xxxx) followed by a meaningful description of the change\n every commit has been signed off\n\nNote: we merge all feature pull requests using squash and merge. See RDF4J git merge strategy for more details.", "createdAt": "2020-06-07T01:38:31Z", "url": "https://github.com/eclipse/rdf4j/pull/2307", "merged": true, "mergeCommit": {"oid": "38ec1080a9b89983961b804aa617df4df777f700"}, "closed": true, "closedAt": "2020-06-09T23:22:14Z", "author": {"login": "jeenbroekstra"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoxagOgH2gAyNDI5NTk5ODQxOjYxNDllMGZiMGVjNGQzZGYzYjhlODc5MGZmMGFlNzlmMGJlMjRiNzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpkJyZgFqTQyNzA4NTE0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6149e0fb0ec4d3df3b8e8790ff0ae79f0be24b70", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/6149e0fb0ec4d3df3b8e8790ff0ae79f0be24b70", "committedDate": "2020-06-07T01:17:21Z", "message": "GH-2306 verify Binding is not null before adding to merged set"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34a64dcc8f81b866d74a0ab78fc15c5da7e01f81", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/34a64dcc8f81b866d74a0ab78fc15c5da7e01f81", "committedDate": "2020-06-07T01:45:05Z", "message": "roll back on over-eager formatting"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fab23cbc01a0d9a7b845ad9935bdb632cb91fec3", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/fab23cbc01a0d9a7b845ad9935bdb632cb91fec3", "committedDate": "2020-06-07T01:44:05Z", "message": "roll back on over-eager formatting"}, "afterCommit": {"oid": "34a64dcc8f81b866d74a0ab78fc15c5da7e01f81", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/34a64dcc8f81b866d74a0ab78fc15c5da7e01f81", "committedDate": "2020-06-07T01:45:05Z", "message": "roll back on over-eager formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e59872339e7386d505af17b40180d4ab8b4f60b", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/0e59872339e7386d505af17b40180d4ab8b4f60b", "committedDate": "2020-06-09T05:52:48Z", "message": "GH-2306 more robust check for external bindings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2ODIyNzky", "url": "https://github.com/eclipse/rdf4j/pull/2307#pullrequestreview-426822792", "createdAt": "2020-06-09T06:27:48Z", "commit": {"oid": "0e59872339e7386d505af17b40180d4ab8b4f60b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwNjoyNzo0OFrOGg6dxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwNjoyNzo0OFrOGg6dxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE2NTUwOA==", "bodyText": "Fwiw I believe this is still a check worth doing as in most cases it will skip creating a new MapBindingSet, and instead just pass in the EmptyBindingSet singleton - which other parts of the engine have some optimizations for.", "url": "https://github.com/eclipse/rdf4j/pull/2307#discussion_r437165508", "createdAt": "2020-06-09T06:27:48Z", "author": {"login": "jeenbroekstra"}, "path": "tools/federation/src/main/java/org/eclipse/rdf4j/federated/FedXConnection.java", "diffHunk": "@@ -138,10 +138,8 @@ public FedXConnection(FedX federation, FederationContext federationContext)\n \n \t\ttry {\n \t\t\t// make sure to apply any external bindings\n-\t\t\t// Note: we use a conditional check for performance reasons.\n-\t\t\t// Further note that we subtract -1 from the size as the baseUri is optional\n \t\t\tBindingSet queryBindings = EmptyBindingSet.getInstance();\n-\t\t\tif (bindings.size() > FedXRepositoryConnection.FEDX_BINDINGS.size() - 1) {\n+\t\t\tif (!FedXRepositoryConnection.FEDX_BINDINGS.containsAll(bindings.getBindingNames())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e59872339e7386d505af17b40180d4ab8b4f60b"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MDg1MTQz", "url": "https://github.com/eclipse/rdf4j/pull/2307#pullrequestreview-427085143", "createdAt": "2020-06-09T12:22:53Z", "commit": {"oid": "0e59872339e7386d505af17b40180d4ab8b4f60b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMjoyMjo1M1rOGhGvUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMjoyMjo1M1rOGhGvUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM2NjYwOA==", "bodyText": "Good solution and way more robust. Should do the job as expected", "url": "https://github.com/eclipse/rdf4j/pull/2307#discussion_r437366608", "createdAt": "2020-06-09T12:22:53Z", "author": {"login": "aschwarte10"}, "path": "tools/federation/src/main/java/org/eclipse/rdf4j/federated/FedXConnection.java", "diffHunk": "@@ -138,10 +138,8 @@ public FedXConnection(FedX federation, FederationContext federationContext)\n \n \t\ttry {\n \t\t\t// make sure to apply any external bindings\n-\t\t\t// Note: we use a conditional check for performance reasons.\n-\t\t\t// Further note that we subtract -1 from the size as the baseUri is optional\n \t\t\tBindingSet queryBindings = EmptyBindingSet.getInstance();\n-\t\t\tif (bindings.size() > FedXRepositoryConnection.FEDX_BINDINGS.size() - 1) {\n+\t\t\tif (!FedXRepositoryConnection.FEDX_BINDINGS.containsAll(bindings.getBindingNames())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE2NTUwOA=="}, "originalCommit": {"oid": "0e59872339e7386d505af17b40180d4ab8b4f60b"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 123, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}