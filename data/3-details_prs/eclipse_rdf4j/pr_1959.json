{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyNDEyODQ0", "number": 1959, "title": "GH-1958: fix resource closing in federated service SilentIteration", "bodyText": "The SilenetIteration failed to close the inner iteration, thus resulting\nin resource leaks (e.g. pending connections).\nWithout this fix the attached unit tests takes 20s before forcefully\nclosing the connection. Now it correctly terminates immediately after\ntest execution.\nNote that additionally a TRACE logger has been introduced to give users\nthe chance to observe errors.\nGitHub issue resolved: #1958", "createdAt": "2020-03-02T14:23:44Z", "url": "https://github.com/eclipse/rdf4j/pull/1959", "merged": true, "mergeCommit": {"oid": "c212188a3a27bc4a8dbdb250d802521876a90075"}, "closed": true, "closedAt": "2020-03-03T15:20:06Z", "author": {"login": "aschwarte10"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJvOUrgFqTM2NzI3NTA3MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJ9W4SAFqTM2Nzc1NTY3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3Mjc1MDcx", "url": "https://github.com/eclipse/rdf4j/pull/1959#pullrequestreview-367275071", "createdAt": "2020-03-02T15:12:35Z", "commit": {"oid": "ab2dca0db55eb8dcd1c80c53c7a6b041c66eeb3f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToxMjozNVrOFwjGng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToxMjozNVrOFwjGng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ1MTEwMg==", "bodyText": "Should maybe this also fail silently?", "url": "https://github.com/eclipse/rdf4j/pull/1959#discussion_r386451102", "createdAt": "2020-03-02T15:12:35Z", "author": {"login": "hmottestad"}, "path": "core/repository/sparql/src/main/java/org/eclipse/rdf4j/repository/sparql/federation/SilentIteration.java", "diffHunk": "@@ -34,9 +39,20 @@ protected BindingSet getNextElement() throws QueryEvaluationException {\n \t\t\t\treturn iter.next();\n \t\t} catch (Exception e) {\n \t\t\t// suppress\n+\t\t\tif (logger.isTraceEnabled()) {\n+\t\t\t\tlogger.trace(\"Suppressed error in SILENT SERVICE: \" + e.getMessage(), e);\n+\t\t\t}\n \t\t}\n \n \t\treturn null;\n \t}\n \n+\t@Override\n+\tprotected void handleClose() throws QueryEvaluationException {\n+\t\ttry {\n+\t\t\tIterations.closeCloseable(iter);\n+\t\t} finally {\n+\t\t\tsuper.handleClose();\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab2dca0db55eb8dcd1c80c53c7a6b041c66eeb3f"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3Mjc2MjY0", "url": "https://github.com/eclipse/rdf4j/pull/1959#pullrequestreview-367276264", "createdAt": "2020-03-02T15:14:04Z", "commit": {"oid": "ab2dca0db55eb8dcd1c80c53c7a6b041c66eeb3f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToxNDowNFrOFwjKRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNToxNDowNFrOFwjKRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ1MjAzOQ==", "bodyText": "I know it's not required by our styleguide, but I do prefer using { } for if/else/while.", "url": "https://github.com/eclipse/rdf4j/pull/1959#discussion_r386452039", "createdAt": "2020-03-02T15:14:04Z", "author": {"login": "hmottestad"}, "path": "core/repository/sparql/src/main/java/org/eclipse/rdf4j/repository/sparql/federation/SilentIteration.java", "diffHunk": "@@ -34,9 +39,20 @@ protected BindingSet getNextElement() throws QueryEvaluationException {\n \t\t\t\treturn iter.next();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab2dca0db55eb8dcd1c80c53c7a6b041c66eeb3f"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NTgxNTI4", "url": "https://github.com/eclipse/rdf4j/pull/1959#pullrequestreview-367581528", "createdAt": "2020-03-02T22:37:46Z", "commit": {"oid": "e883abf2ec940f678aecac226728b5d3141da2d8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQyMjozNzo0NlrOFwx6sQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQyMjozNzo0NlrOFwx6sQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY5MzgwOQ==", "bodyText": "I only just noticed this after pushing an editorial fix, but apparently we have two SilentIteration classes:\n\norg.eclipse.rdf4j.repository.sparql.federation.SilentIteration\norg.eclipse.rdf4j.query.algebra.evaluation.iterator.SilentIteration\n\nThey look identical (barring the fixes you just did) - do we need both or can we get rid of the federated one?", "url": "https://github.com/eclipse/rdf4j/pull/1959#discussion_r386693809", "createdAt": "2020-03-02T22:37:46Z", "author": {"login": "jeenbroekstra"}, "path": "core/repository/sparql/src/main/java/org/eclipse/rdf4j/repository/sparql/federation/SilentIteration.java", "diffHunk": "@@ -19,6 +22,8 @@\n  */\n public class SilentIteration extends LookAheadIteration<BindingSet, QueryEvaluationException> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e883abf2ec940f678aecac226728b5d3141da2d8"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NjU1NzAx", "url": "https://github.com/eclipse/rdf4j/pull/1959#pullrequestreview-367655701", "createdAt": "2020-03-03T01:56:25Z", "commit": {"oid": "f1c30974bdc3b099809677bcdb52c1eab0eb6e26"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NzQ4ODM0", "url": "https://github.com/eclipse/rdf4j/pull/1959#pullrequestreview-367748834", "createdAt": "2020-03-03T07:26:07Z", "commit": {"oid": "f1c30974bdc3b099809677bcdb52c1eab0eb6e26"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "783bc4253347637d57ccd6eed9b9a842f6b0729a", "author": {"user": {"login": "aschwarte10", "name": "Andreas Schwarte"}}, "url": "https://github.com/eclipse/rdf4j/commit/783bc4253347637d57ccd6eed9b9a842f6b0729a", "committedDate": "2020-03-03T07:36:09Z", "message": "GH-1958: fix resource closing in federated service SilentIteration\n\nThe SilenetIteration failed to close the inner iteration, thus resulting\nin resource leaks (e.g. pending connections).\n\nWithout this fix the attached unit tests takes 20s before forcefully\nclosing the connection. Now it correctly terminates immediately after\ntest execution.\n\nNote that additionally a TRACE logger has been introduced to give users\nthe chance to observe errors.\n\nAdditional changes:\n\n* add braces\n* apply fixes to both copies of SilentIteration\n* cleaned up different SilentIteration impls"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1c30974bdc3b099809677bcdb52c1eab0eb6e26", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/f1c30974bdc3b099809677bcdb52c1eab0eb6e26", "committedDate": "2020-03-03T00:09:33Z", "message": "GH-1958 cleaned up different SilentIteration impls"}, "afterCommit": {"oid": "783bc4253347637d57ccd6eed9b9a842f6b0729a", "author": {"user": {"login": "aschwarte10", "name": "Andreas Schwarte"}}, "url": "https://github.com/eclipse/rdf4j/commit/783bc4253347637d57ccd6eed9b9a842f6b0729a", "committedDate": "2020-03-03T07:36:09Z", "message": "GH-1958: fix resource closing in federated service SilentIteration\n\nThe SilenetIteration failed to close the inner iteration, thus resulting\nin resource leaks (e.g. pending connections).\n\nWithout this fix the attached unit tests takes 20s before forcefully\nclosing the connection. Now it correctly terminates immediately after\ntest execution.\n\nNote that additionally a TRACE logger has been introduced to give users\nthe chance to observe errors.\n\nAdditional changes:\n\n* add braces\n* apply fixes to both copies of SilentIteration\n* cleaned up different SilentIteration impls"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NzU1Njc4", "url": "https://github.com/eclipse/rdf4j/pull/1959#pullrequestreview-367755678", "createdAt": "2020-03-03T07:40:36Z", "commit": {"oid": "783bc4253347637d57ccd6eed9b9a842f6b0729a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4994, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}