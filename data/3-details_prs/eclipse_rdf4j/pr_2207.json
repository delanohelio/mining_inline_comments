{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NTY3NzI4", "number": 2207, "title": "GH-2206 prettier plans by using box-drawing characters to group joins", "bodyText": "GitHub issue closing #2206 \nBriefly describe the changes proposed in this PR:\nUse box-drawing characters (https://en.wikipedia.org/wiki/Box-drawing_character) for making query plans easier to read.\n\nPR Author Checklist:\n\n my pull request is self-contained\n I've added tests for the changes I made\n every commit message starts with the issue number (GH-xxxx) followed by a meaningful description of the change\n every commit has been signed off\n\nNote: we merge all feature pull requests using squash and merge. See RDF4J git merge strategy for more details.", "createdAt": "2020-05-09T12:19:36Z", "url": "https://github.com/eclipse/rdf4j/pull/2207", "merged": true, "mergeCommit": {"oid": "705a98faf14504d59004e54f715ca8aaea479fb8"}, "closed": true, "closedAt": "2020-05-12T12:40:53Z", "author": {"login": "hmottestad"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcflfqEAH2gAyNDE1NTY3NzI4OjQ0NDFlMDY4YmJjNjdlOTBmYTEwZjExZDAwZjQ2YjZjMTE1NGViMmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgiS5IAFqTQwOTkzNDczOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4441e068bbc67e90fa10f11d00f46b6c1154eb2c", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/4441e068bbc67e90fa10f11d00f46b6c1154eb2c", "committedDate": "2020-05-09T12:18:48Z", "message": "GH-2206 prettier plans by using box-drawing characters to group joins\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4Njk3NDIw", "url": "https://github.com/eclipse/rdf4j/pull/2207#pullrequestreview-408697420", "createdAt": "2020-05-10T01:46:31Z", "commit": {"oid": "4441e068bbc67e90fa10f11d00f46b6c1154eb2c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwMTo0NjozMVrOGS_pug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQwMTo1MTo0MlrOGS_rjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjU3MDQyNg==", "bodyText": "Can you remind me - this is separate from what I would get if I did\n TupleQuery query = conn.prepareTupleQuery(....);\n System.out.println(query);\n\ncorrect? What I'm getting at is that this influences only the output of the Explanation serialization, not if we directly serialize a query algebra node to string. If so: that's good, I'd rather not change the original tupleExpr serialization too much (even if it's not, strictly speaking, a standardized format).", "url": "https://github.com/eclipse/rdf4j/pull/2207#discussion_r422570426", "createdAt": "2020-05-10T01:46:31Z", "author": {"login": "jeenbroekstra"}, "path": "core/query/src/main/java/org/eclipse/rdf4j/query/explanation/GenericPlanNode.java", "diffHunk": "@@ -217,14 +217,25 @@ public void setAlgorithm(String algorithm) {\n \t\tthis.algorithm = algorithm;\n \t}\n \n+\tprivate static int prettyBoxDrawingType = 0;\n+\n \t/**\n \t * Human readable string. Do not attempt to parse this.\n \t *\n \t * @return\n \t */\n \t@Override\n \tpublic String toString() {\n+\t\treturn getHumanReadable(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4441e068bbc67e90fa10f11d00f46b6c1154eb2c"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjU3MDg5Mg==", "bodyText": "If I understood correctly, the idea is to use the double lines for all nodes that have two (or more) children, single lines only for unary predicates. So why is the outer join here single lined, and the inner one double?", "url": "https://github.com/eclipse/rdf4j/pull/2207#discussion_r422570892", "createdAt": "2020-05-10T01:51:42Z", "author": {"login": "jeenbroekstra"}, "path": "core/sail/memory/src/test/java/org/eclipse/rdf4j/sail/memory/QueryPlanRetrievalTest.java", "diffHunk": "@@ -87,32 +87,32 @@ public void testTupleQuery() {\n \t\t\tString actual = query.explain(Explanation.Level.Unoptimized).toString();\n \n \t\t\tString expected = \"Projection\\n\" +\n-\t\t\t\t\t\"   ProjectionElemList\\n\" +\n-\t\t\t\t\t\"      ProjectionElem \\\"a\\\"\\n\" +\n-\t\t\t\t\t\"   Filter\\n\" +\n-\t\t\t\t\t\"      Compare (!=)\\n\" +\n-\t\t\t\t\t\"         Var (name=c)\\n\" +\n-\t\t\t\t\t\"         Var (name=d)\\n\" +\n-\t\t\t\t\t\"      LeftJoin\\n\" +\n-\t\t\t\t\t\"         Join\\n\" +\n-\t\t\t\t\t\"            Join\\n\" +\n-\t\t\t\t\t\"               LeftJoin (new scope)\\n\" +\n-\t\t\t\t\t\"                  SingletonSet\\n\" +\n-\t\t\t\t\t\"                  StatementPattern\\n\" +\n-\t\t\t\t\t\"                     Var (name=d)\\n\" +\n-\t\t\t\t\t\"                     Var (name=e)\\n\" +\n-\t\t\t\t\t\"                     Var (name=f)\\n\" +\n-\t\t\t\t\t\"               StatementPattern\\n\" +\n-\t\t\t\t\t\"                  Var (name=a)\\n\" +\n-\t\t\t\t\t\"                  Var (name=_const_f5e5585a_uri, value=http://www.w3.org/1999/02/22-rdf-syntax-ns#type, anonymous)\\n\"\n+\t\t\t\t\t\"\u2560\u2550\u2550ProjectionElemList\\n\" +\n+\t\t\t\t\t\"\u2551     ProjectionElem \\\"a\\\"\\n\" +\n+\t\t\t\t\t\"\u255a\u2550\u2550Filter\\n\" +\n+\t\t\t\t\t\"   \u251c\u2500\u2500Compare (!=)\\n\" +\n+\t\t\t\t\t\"   \u2502     Var (name=c)\\n\" +\n+\t\t\t\t\t\"   \u2502     Var (name=d)\\n\" +\n+\t\t\t\t\t\"   \u2514\u2500\u2500LeftJoin\\n\" +\n+\t\t\t\t\t\"      \u2560\u2550\u2550Join\\n\" +\n+\t\t\t\t\t\"      \u2551  \u251c\u2500\u2500Join\\n\" +\n+\t\t\t\t\t\"      \u2551  \u2502  \u2560\u2550\u2550LeftJoin (new scope)\\n\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4441e068bbc67e90fa10f11d00f46b6c1154eb2c"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5ODgzMTg5", "url": "https://github.com/eclipse/rdf4j/pull/2207#pullrequestreview-409883189", "createdAt": "2020-05-12T09:54:22Z", "commit": {"oid": "4441e068bbc67e90fa10f11d00f46b6c1154eb2c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5OTM0NzM4", "url": "https://github.com/eclipse/rdf4j/pull/2207#pullrequestreview-409934738", "createdAt": "2020-05-12T11:09:04Z", "commit": {"oid": "4441e068bbc67e90fa10f11d00f46b6c1154eb2c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 152, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}