{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMjExMjcx", "number": 1957, "title": "#1956 use DynamicModel more", "bodyText": "GitHub issue resolved: #1956  \nBriefly describe the changes proposed in this PR:\n\nuse DynamicModel more\nfix .equals bug in DynamicModel\nrename SimpleUpgradeableModel to DynamicModel", "createdAt": "2020-03-02T07:06:00Z", "url": "https://github.com/eclipse/rdf4j/pull/1957", "merged": true, "mergeCommit": {"oid": "d9a25e615cf0556be9a0f2a961ce245bd60bc00c"}, "closed": true, "closedAt": "2020-03-06T11:28:04Z", "author": {"login": "hmottestad"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJoQN5gH2gAyMzgyMjExMjcxOjIyNmU2NDAzMzMzNDg0NGRkYmNhYTJiNmJkOGNjZmNlNWNkNzhmNGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcK8hJXAFqTM3MDE3NzE5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "226e64033334844ddbcaa2b6bd8ccfce5cd78f4b", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/226e64033334844ddbcaa2b6bd8ccfce5cd78f4b", "committedDate": "2020-03-02T07:05:19Z", "message": "#1956 use SimpleUpgradeableModel in Rio for loading data\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0bd1ba8f07cd737386275459c633047feee2dafc", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/0bd1ba8f07cd737386275459c633047feee2dafc", "committedDate": "2020-03-02T15:06:37Z", "message": "#1956 model1.equals(model2) actually needs to check for isomorphic\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98bc873add4e2d702f9d3d302825da26d032d2fe", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/98bc873add4e2d702f9d3d302825da26d032d2fe", "committedDate": "2020-03-02T15:56:59Z", "message": "#1956 model collector should use simple upgradeable model too\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06d9c31164de7d70947db309c357bc44f62b7cf4", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/06d9c31164de7d70947db309c357bc44f62b7cf4", "committedDate": "2020-03-02T16:02:28Z", "message": "#1956 spin and old rdfs reasoner should use SimpleUpgradeableModel\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "813c2f3606f1067883dfb411e00326b993a165ef", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/813c2f3606f1067883dfb411e00326b993a165ef", "committedDate": "2020-03-02T16:02:51Z", "message": "#1956 query result asModel should use SimpleUpgradeableModel\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c79c33a1299fa6aabdd0bc967d72bdd8d732700", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/7c79c33a1299fa6aabdd0bc967d72bdd8d732700", "committedDate": "2020-03-02T16:03:16Z", "message": "#1956 SailSourceBranch should use SimpleUpgradeableModel\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NjMwMDUw", "url": "https://github.com/eclipse/rdf4j/pull/1957#pullrequestreview-367630050", "createdAt": "2020-03-03T00:36:40Z", "commit": {"oid": "7c79c33a1299fa6aabdd0bc967d72bdd8d732700"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwMDozNjo0MFrOFw0c3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwMDo0MDo0NFrOFw0hgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjczNTMyNQ==", "bodyText": "While we're at it, perhaps we could make the ModelFactory injectable here as well, by introducing a method overload. E.g. something like this:\npublic static Model asModel(CloseableIteration<? extends Statement, ? extends RDF4JException> iteration) {\n      return asModel(iteration, new SimpleUpgradeableModelFactory());\n }\n public static Model asModel(CloseableIteration<? extends Statement, ? extends RDF4JException> iteration, ModelFactory modelFactory) {\n                 Model model = modelFactory.createEmptyModel();\n                 ....", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r386735325", "createdAt": "2020-03-03T00:36:40Z", "author": {"login": "jeenbroekstra"}, "path": "core/query/src/main/java/org/eclipse/rdf4j/query/QueryResults.java", "diffHunk": "@@ -66,7 +68,7 @@\n \t */\n \tpublic static Model asModel(CloseableIteration<? extends Statement, ? extends RDF4JException> iteration)\n \t\t\tthrows QueryEvaluationException {\n-\t\tModel model = new LinkedHashModel();\n+\t\tModel model = new SimpleUpgradeableModel(new LinkedHashModelFactory());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79c33a1299fa6aabdd0bc967d72bdd8d732700"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjczNTc0NA==", "bodyText": "Same here - could we make it injectable?", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r386735744", "createdAt": "2020-03-03T00:37:59Z", "author": {"login": "jeenbroekstra"}, "path": "core/rio/api/src/main/java/org/eclipse/rdf4j/rio/Rio.java", "diffHunk": "@@ -258,12 +259,12 @@ public static Model parse(Reader reader, String baseURI, RDFFormat dataFormat, R\n \tpublic static Model parse(InputStream in, String baseURI, RDFFormat dataFormat, ParserConfig settings,\n \t\t\tValueFactory valueFactory, ParseErrorListener errors, Resource... contexts)\n \t\t\tthrows IOException, RDFParseException, UnsupportedRDFormatException {\n-\t\tModel result = new LinkedHashModel();\n+\t\tModel result = new SimpleUpgradeableModel(new LinkedHashModelFactory());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79c33a1299fa6aabdd0bc967d72bdd8d732700"}, "originalPosition": 141}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjczNjUxNQ==", "bodyText": "..and here as well", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r386736515", "createdAt": "2020-03-03T00:40:44Z", "author": {"login": "jeenbroekstra"}, "path": "core/rio/api/src/main/java/org/eclipse/rdf4j/rio/Rio.java", "diffHunk": "@@ -292,12 +293,12 @@ public static Model parse(InputStream in, String baseURI, RDFFormat dataFormat,\n \tpublic static Model parse(Reader reader, String baseURI, RDFFormat dataFormat, ParserConfig settings,\n \t\t\tValueFactory valueFactory, ParseErrorListener errors, Resource... contexts)\n \t\t\tthrows IOException, RDFParseException, UnsupportedRDFormatException {\n-\t\tModel result = new LinkedHashModel();\n+\t\tModel result = new SimpleUpgradeableModel(new LinkedHashModelFactory());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c79c33a1299fa6aabdd0bc967d72bdd8d732700"}, "originalPosition": 165}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73a7602570994354113892bb31b2f0284ad3dec2", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/73a7602570994354113892bb31b2f0284ad3dec2", "committedDate": "2020-03-03T08:46:42Z", "message": "renamed class\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce155e8957e226ca3bb13ebdb623efcb54df4262", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/ce155e8957e226ca3bb13ebdb623efcb54df4262", "committedDate": "2020-03-03T09:32:06Z", "message": "trying to make filter(...) apply directly if possible\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d359babf717918574ee44e8022c690df77fa9d9", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/6d359babf717918574ee44e8022c690df77fa9d9", "committedDate": "2020-03-03T09:31:11Z", "message": "trying to make filter(...) apply directly if possible\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}, "afterCommit": {"oid": "ce155e8957e226ca3bb13ebdb623efcb54df4262", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/ce155e8957e226ca3bb13ebdb623efcb54df4262", "committedDate": "2020-03-03T09:32:06Z", "message": "trying to make filter(...) apply directly if possible\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e63826e1e4a2a17a518cd3809c2a932264ca545d", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/e63826e1e4a2a17a518cd3809c2a932264ca545d", "committedDate": "2020-03-03T09:41:34Z", "message": "format\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3ODMxMzg2", "url": "https://github.com/eclipse/rdf4j/pull/1957#pullrequestreview-367831386", "createdAt": "2020-03-03T09:45:30Z", "commit": {"oid": "e63826e1e4a2a17a518cd3809c2a932264ca545d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwOTo0NTozMFrOFw-rRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwOTo0NTozMFrOFw-rRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjkwMjg1NQ==", "bodyText": "In order to get the most out of sails that use the notifying behaviour we need to implement simple support for filter. I read that the docs specify that filter(...) should return a view of the current model, rather than a new model or an unmodifiable model. Not sure how to implement this with the performance I want. Have you worked with the FilteredModel before @jeenbroekstra ?", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r386902855", "createdAt": "2020-03-03T09:45:30Z", "author": {"login": "hmottestad"}, "path": "core/model/src/main/java/org/eclipse/rdf4j/model/impl/DynamicModel.java", "diffHunk": "@@ -141,6 +142,35 @@ public boolean remove(Resource subj, IRI pred, Value obj, Resource... contexts)\n \n \t@Override\n \tpublic Model filter(Resource subj, IRI pred, Value obj, Resource... contexts) {\n+\t\tif (model == null && statements.size() == 0) {\n+\t\t\treturn new EmptyModel(this);\n+\t\t}\n+\n+\t\tif (model == null && subj != null && pred != null && obj != null && contexts.length == 1) {\n+\t\t\tStatement needle = SimpleValueFactory.getInstance().createStatement(subj, pred, obj, contexts[0]);\n+\t\t\tif (statements.size() == 1) {\n+\t\t\t\tStatement s = (Statement) statements.toArray()[0];\n+\n+\t\t\t\tDynamicModel ret = new DynamicModel(modelFactory);\n+\n+\t\t\t\tif (s.equals(needle)) {\n+\t\t\t\t\tret.add(s);\n+\t\t\t\t}\n+\n+\t\t\t\treturn ret;\n+\t\t\t}\n+\n+\t\t\tDynamicModel ret = new DynamicModel(modelFactory);\n+\t\t\tif (statements.contains(needle)) {\n+\t\t\t\tret.add(needle);\n+\t\t\t}\n+\t\t\treturn ret;\n+\t\t}\n+\n+\t\tif (subj == null && pred == null && obj == null && contexts.length == 0) {\n+\t\t\treturn this;\n+\t\t}\n+\n \t\tupgrade();\n \t\treturn model.filter(subj, pred, obj, contexts);\n \t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e63826e1e4a2a17a518cd3809c2a932264ca545d"}, "originalPosition": 80}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ecfb83c231162f3367a9687a6c1bda961fb571c", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/5ecfb83c231162f3367a9687a6c1bda961fb571c", "committedDate": "2020-03-03T09:55:21Z", "message": "Merge branch 'develop' into issues/1956_use_SimpleUpgradeableModel_Rio\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0e771c85ff4581b054e4cfd9b018bc19c673484", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/d0e771c85ff4581b054e4cfd9b018bc19c673484", "committedDate": "2020-03-03T14:17:35Z", "message": "updated tests to reflect that inferred statements are added to whatever context they are added to regardless of if they exist in other contexts\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a0787b53627d4c9bab6604825b59c571bc5f395", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/4a0787b53627d4c9bab6604825b59c571bc5f395", "committedDate": "2020-03-03T14:19:03Z", "message": "Merge branch 'develop' into issues/1956_use_SimpleUpgradeableModel_Rio\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NTAwODY1", "url": "https://github.com/eclipse/rdf4j/pull/1957#pullrequestreview-368500865", "createdAt": "2020-03-04T04:41:28Z", "commit": {"oid": "4a0787b53627d4c9bab6604825b59c571bc5f395"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwNDo0MToyOFrOFxf0WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwNDo1NDoyNVrOFxf-gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ0NTg0OA==", "bodyText": "This isn't valid - you can't return a new Model object as the result of the filter. If someone were to add something to this empty model, that should be reflected in the original.\nI'm a little surprised there are no failing tests for this to be honest. I thought James had created a comprehensive set of tests for Model behavior. This expectation should be reflected in the tests on the filter method.", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r387445848", "createdAt": "2020-03-04T04:41:28Z", "author": {"login": "jeenbroekstra"}, "path": "core/model/src/main/java/org/eclipse/rdf4j/model/impl/DynamicModel.java", "diffHunk": "@@ -141,6 +142,35 @@ public boolean remove(Resource subj, IRI pred, Value obj, Resource... contexts)\n \n \t@Override\n \tpublic Model filter(Resource subj, IRI pred, Value obj, Resource... contexts) {\n+\t\tif (model == null && statements.size() == 0) {\n+\t\t\treturn new EmptyModel(this);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a0787b53627d4c9bab6604825b59c571bc5f395"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ0NTkyOA==", "bodyText": "Same here.", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r387445928", "createdAt": "2020-03-04T04:41:50Z", "author": {"login": "jeenbroekstra"}, "path": "core/model/src/main/java/org/eclipse/rdf4j/model/impl/DynamicModel.java", "diffHunk": "@@ -141,6 +142,35 @@ public boolean remove(Resource subj, IRI pred, Value obj, Resource... contexts)\n \n \t@Override\n \tpublic Model filter(Resource subj, IRI pred, Value obj, Resource... contexts) {\n+\t\tif (model == null && statements.size() == 0) {\n+\t\t\treturn new EmptyModel(this);\n+\t\t}\n+\n+\t\tif (model == null && subj != null && pred != null && obj != null && contexts.length == 1) {\n+\t\t\tStatement needle = SimpleValueFactory.getInstance().createStatement(subj, pred, obj, contexts[0]);\n+\t\t\tif (statements.size() == 1) {\n+\t\t\t\tStatement s = (Statement) statements.toArray()[0];\n+\n+\t\t\t\tDynamicModel ret = new DynamicModel(modelFactory);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a0787b53627d4c9bab6604825b59c571bc5f395"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ0NzQ0OA==", "bodyText": "...and here as well.", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r387447448", "createdAt": "2020-03-04T04:49:38Z", "author": {"login": "jeenbroekstra"}, "path": "core/model/src/main/java/org/eclipse/rdf4j/model/impl/DynamicModel.java", "diffHunk": "@@ -141,6 +142,35 @@ public boolean remove(Resource subj, IRI pred, Value obj, Resource... contexts)\n \n \t@Override\n \tpublic Model filter(Resource subj, IRI pred, Value obj, Resource... contexts) {\n+\t\tif (model == null && statements.size() == 0) {\n+\t\t\treturn new EmptyModel(this);\n+\t\t}\n+\n+\t\tif (model == null && subj != null && pred != null && obj != null && contexts.length == 1) {\n+\t\t\tStatement needle = SimpleValueFactory.getInstance().createStatement(subj, pred, obj, contexts[0]);\n+\t\t\tif (statements.size() == 1) {\n+\t\t\t\tStatement s = (Statement) statements.toArray()[0];\n+\n+\t\t\t\tDynamicModel ret = new DynamicModel(modelFactory);\n+\n+\t\t\t\tif (s.equals(needle)) {\n+\t\t\t\t\tret.add(s);\n+\t\t\t\t}\n+\n+\t\t\t\treturn ret;\n+\t\t\t}\n+\n+\t\t\tDynamicModel ret = new DynamicModel(modelFactory);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a0787b53627d4c9bab6604825b59c571bc5f395"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ0ODQ1MA==", "bodyText": "I haven't thought this through fully, but if your idea is to somehow postpone upgrading when filtering by just using the original DynamicModel in corner cases, you could just do this by returning a new FilteredModel that internally creates an iterator, and put your filtering / upgrade logic in that iterator. As long as you make sure that what you return is a filtered view on the original Model, so that any future modifications of that result object get reflected in the original model, you're good.\nBut perhaps you shouldn't sweat over this too much right now. I get the feeling you're trying to push too many optimizations in one PR, and this change is really out of scope: it's supposed to be about using the DynamicModel in more places, not about optimizing the DynamicModel itself even further.", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r387448450", "createdAt": "2020-03-04T04:54:25Z", "author": {"login": "jeenbroekstra"}, "path": "core/model/src/main/java/org/eclipse/rdf4j/model/impl/DynamicModel.java", "diffHunk": "@@ -141,6 +142,35 @@ public boolean remove(Resource subj, IRI pred, Value obj, Resource... contexts)\n \n \t@Override\n \tpublic Model filter(Resource subj, IRI pred, Value obj, Resource... contexts) {\n+\t\tif (model == null && statements.size() == 0) {\n+\t\t\treturn new EmptyModel(this);\n+\t\t}\n+\n+\t\tif (model == null && subj != null && pred != null && obj != null && contexts.length == 1) {\n+\t\t\tStatement needle = SimpleValueFactory.getInstance().createStatement(subj, pred, obj, contexts[0]);\n+\t\t\tif (statements.size() == 1) {\n+\t\t\t\tStatement s = (Statement) statements.toArray()[0];\n+\n+\t\t\t\tDynamicModel ret = new DynamicModel(modelFactory);\n+\n+\t\t\t\tif (s.equals(needle)) {\n+\t\t\t\t\tret.add(s);\n+\t\t\t\t}\n+\n+\t\t\t\treturn ret;\n+\t\t\t}\n+\n+\t\t\tDynamicModel ret = new DynamicModel(modelFactory);\n+\t\t\tif (statements.contains(needle)) {\n+\t\t\t\tret.add(needle);\n+\t\t\t}\n+\t\t\treturn ret;\n+\t\t}\n+\n+\t\tif (subj == null && pred == null && obj == null && contexts.length == 0) {\n+\t\t\treturn this;\n+\t\t}\n+\n \t\tupgrade();\n \t\treturn model.filter(subj, pred, obj, contexts);\n \t}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjkwMjg1NQ=="}, "originalCommit": {"oid": "e63826e1e4a2a17a518cd3809c2a932264ca545d"}, "originalPosition": 80}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9372837c3030e35de1e78809b2b395d68a2cce85", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/9372837c3030e35de1e78809b2b395d68a2cce85", "committedDate": "2020-03-04T05:27:29Z", "message": "GH-1956 additional compliance tests for model.filter behavior"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "229722eb245889d155ba48fa21cad98a75eb955d", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/229722eb245889d155ba48fa21cad98a75eb955d", "committedDate": "2020-03-05T12:07:10Z", "message": "reverted filter method\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMDc3NjYw", "url": "https://github.com/eclipse/rdf4j/pull/1957#pullrequestreview-370077660", "createdAt": "2020-03-06T04:35:32Z", "commit": {"oid": "229722eb245889d155ba48fa21cad98a75eb955d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwNDozNTozM1rOFys7lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwNDozNTozM1rOFys7lQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODcwOTI2OQ==", "bodyText": "Just had a look at this after your remark. I'm not sure I follow the logic here to be honest. You've modified the check to only look in the null context. But what if the statement already existed (either inferred or explicit) in some other context? This adaptation will now report a new inferred statement even if in reality it might already have existed.", "url": "https://github.com/eclipse/rdf4j/pull/1957#discussion_r388709269", "createdAt": "2020-03-06T04:35:33Z", "author": {"login": "jeenbroekstra"}, "path": "core/sail/base/src/main/java/org/eclipse/rdf4j/sail/base/SailSourceConnection.java", "diffHunk": "@@ -544,9 +547,9 @@ public boolean addInferredStatement(Resource subj, IRI pred, Value obj, Resource\n \t\t\t}\n \t\t\tboolean modified = false;\n \t\t\tif (contexts.length == 0) {\n-\t\t\t\tif (!hasStatement(explicitOnlyDataset, subj, pred, obj)) {\n+\t\t\t\tif (!hasStatement(explicitOnlyDataset, subj, pred, obj, NULL_CTX)) {\n \t\t\t\t\t// only add inferred statements that aren't already explicit\n-\t\t\t\t\tif (!hasStatement(inferredOnlyDataset, subj, pred, obj)) {\n+\t\t\t\t\tif (!hasStatement(inferredOnlyDataset, subj, pred, obj, NULL_CTX)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "229722eb245889d155ba48fa21cad98a75eb955d"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMTU2MDQ4", "url": "https://github.com/eclipse/rdf4j/pull/1957#pullrequestreview-370156048", "createdAt": "2020-03-06T08:38:19Z", "commit": {"oid": "229722eb245889d155ba48fa21cad98a75eb955d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b446806637beb1207accb3bb5cbaa56c15398a68", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/b446806637beb1207accb3bb5cbaa56c15398a68", "committedDate": "2020-03-06T09:08:21Z", "message": "implemented methods that allows the user to override the model factories used in Rio and in QueryResults\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMTc3MTkx", "url": "https://github.com/eclipse/rdf4j/pull/1957#pullrequestreview-370177191", "createdAt": "2020-03-06T09:15:50Z", "commit": {"oid": "b446806637beb1207accb3bb5cbaa56c15398a68"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 73, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}