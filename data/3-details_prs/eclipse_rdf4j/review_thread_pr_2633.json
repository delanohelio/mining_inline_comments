{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1NjE0MjEy", "number": 2633, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMTo0MTowMlrOE1aCng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMTo0NDowNlrOE1aF_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NDM2NjM4OnYy", "diffSide": "RIGHT", "path": "core/sail/shacl/src/main/java/org/eclipse/rdf4j/sail/shacl/AST/AndPropertyShape.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMTo0MTowMlrOHtqrgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwNTo0NjoxN1rOHt0VMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY0NzIzNA==", "bodyText": "Typically variable names do not actually start with a question mark - in SPARQL they do of course but our query parsers all treat it like a marker prefix, not as part of the actual variable name.", "url": "https://github.com/eclipse/rdf4j/pull/2633#discussion_r517647234", "createdAt": "2020-11-04T21:41:02Z", "author": {"login": "jeenbroekstra"}, "path": "core/sail/shacl/src/main/java/org/eclipse/rdf4j/sail/shacl/AST/AndPropertyShape.java", "diffHunk": "@@ -288,9 +290,22 @@ public String buildSparqlValidNodes(String targetVar) {\n \n \t@Override\n \tpublic Stream<StatementPattern> getStatementPatterns() {\n-\t\treturn and\n-\t\t\t\t.stream()\n+\t\tStatementPattern subject = new StatementPattern(\n+\t\t\t\tnew Var(\"?this\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d6fafb14b19aede2a948c6235a2eed60631ff56"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzgwNTM2Mw==", "bodyText": "This PR is mostly to fix a bug in the old AST so that I can handel it properly in the new AST. This is essentially just copy-paste from other parts of the code that are built like this, so I don't want to start fixing it up now. I will take a look in the new AST and see if I prefix my vars with ? or not. And also check the random UUID thing you commented.", "url": "https://github.com/eclipse/rdf4j/pull/2633#discussion_r517805363", "createdAt": "2020-11-05T05:46:17Z", "author": {"login": "hmottestad"}, "path": "core/sail/shacl/src/main/java/org/eclipse/rdf4j/sail/shacl/AST/AndPropertyShape.java", "diffHunk": "@@ -288,9 +290,22 @@ public String buildSparqlValidNodes(String targetVar) {\n \n \t@Override\n \tpublic Stream<StatementPattern> getStatementPatterns() {\n-\t\treturn and\n-\t\t\t\t.stream()\n+\t\tStatementPattern subject = new StatementPattern(\n+\t\t\t\tnew Var(\"?this\"),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY0NzIzNA=="}, "originalCommit": {"oid": "7d6fafb14b19aede2a948c6235a2eed60631ff56"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NDM3NTAyOnYy", "diffSide": "RIGHT", "path": "core/sail/shacl/src/main/java/org/eclipse/rdf4j/sail/shacl/AST/AndPropertyShape.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMTo0NDowNlrOHtqw2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMTo0NDowNlrOHtqw2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY0ODYwMg==", "bodyText": "Are these randomly generated variable names ever serialized, for example as part of a SPARQL query? If so we'll need a more robust name assignement, because this will produce a variable name that won't be legal in SPARQL.\nI'm pretty sure we have ready-made code somewhere (in the query parser utils perhaps) for this kind of thing. There should be a single place where we generate these kind of anonymous vars, so that if we need to change the name-generation logic for any reason, we don't have to change it all over the place.", "url": "https://github.com/eclipse/rdf4j/pull/2633#discussion_r517648602", "createdAt": "2020-11-04T21:44:06Z", "author": {"login": "jeenbroekstra"}, "path": "core/sail/shacl/src/main/java/org/eclipse/rdf4j/sail/shacl/AST/AndPropertyShape.java", "diffHunk": "@@ -288,9 +290,22 @@ public String buildSparqlValidNodes(String targetVar) {\n \n \t@Override\n \tpublic Stream<StatementPattern> getStatementPatterns() {\n-\t\treturn and\n-\t\t\t\t.stream()\n+\t\tStatementPattern subject = new StatementPattern(\n+\t\t\t\tnew Var(\"?this\"),\n+\t\t\t\tnew Var(UUID.randomUUID().toString()),\n+\t\t\t\tnew Var(UUID.randomUUID().toString())\n+\t\t);\n+\n+\t\tStatementPattern object = new StatementPattern(\n+\t\t\t\tnew Var(UUID.randomUUID().toString()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d6fafb14b19aede2a948c6235a2eed60631ff56"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1322, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}