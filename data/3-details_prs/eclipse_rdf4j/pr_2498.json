{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2MzUwOTQx", "number": 2498, "title": "GH-2497 fix RDF collection processing for malformed collection structures", "bodyText": "GitHub issue resolved: #2497  \nBriefly describe the changes proposed in this PR:\n\nFix handling of malformed collection structures by checking beforehand, and falling back to serializing as regular RDF statements if the collection is not well-formed\nAdded several regression test cases for various kinds of malformedness.\n\n\nPR Author Checklist (see the contributor guidelines for more details):\n\n my pull request is self-contained\n I've added tests for the changes I made\n I've applied code formatting (you can use mvn process-resources to format from the command line)\n every commit message starts with the issue number (GH-xxxx) followed by a meaningful description of the change\n every commit has been signed off\n\nNote: we merge all feature pull requests using squash and merge. See RDF4J git merge strategy for more details.", "createdAt": "2020-09-14T05:59:05Z", "url": "https://github.com/eclipse/rdf4j/pull/2498", "merged": true, "mergeCommit": {"oid": "ea97a7db68aafd2d8710a47605b93a9cb10538f1"}, "closed": true, "closedAt": "2020-09-16T03:03:36Z", "author": {"login": "hmottestad"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdIswy6gH2gAyNDg2MzUwOTQxOmI3NGQyNzc3ZGFkNmY1Y2FlYjE1ZjNjNzRhNTVmM2NkMWU2ZmYwOTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJSGv8gH2gAyNDg2MzUwOTQxOmFlMTBkMGVlYzNiMGNkZTAyNWIzMDhkYjUyMjUwZmI1NDhlNzI1MmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b74d2777dad6f5caeb15f3c74a55f3cd1e6ff097", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/b74d2777dad6f5caeb15f3c74a55f3cd1e6ff097", "committedDate": "2020-09-14T05:57:45Z", "message": "GH-2497 test to reproduce issue\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8348bd0076f62515e1f5d54db9f0482aa3430f4c", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/8348bd0076f62515e1f5d54db9f0482aa3430f4c", "committedDate": "2020-09-14T06:25:41Z", "message": "simplified test\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3NDQ3NTA4", "url": "https://github.com/eclipse/rdf4j/pull/2498#pullrequestreview-487447508", "createdAt": "2020-09-14T06:27:48Z", "commit": {"oid": "8348bd0076f62515e1f5d54db9f0482aa3430f4c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNjoyNzo0OFrOHRFeyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNjoyNzo0OFrOHRFeyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY3NzY0Mg==", "bodyText": "This seems to be a representative example.", "url": "https://github.com/eclipse/rdf4j/pull/2498#discussion_r487677642", "createdAt": "2020-09-14T06:27:48Z", "author": {"login": "hmottestad"}, "path": "core/rio/turtle/src/test/java/org/eclipse/rdf4j/rio/turtle/TurtleWriterTest.java", "diffHunk": "@@ -194,4 +194,170 @@ public void testNoBuffering() throws Exception {\n \t\tModel actual = Rio.parse(new StringReader(stringWriter.toString()), \"\", RDFFormat.TURTLE);\n \t\tassertTrue(Models.isomorphic(expected, actual));\n \t}\n+\n+\t@Test\n+\tpublic void anotherBnodeTest() throws Exception {\n+\t\tString data = \"@prefix ex:    <http://example.com/ns#> .\\n\" +\n+\t\t\t\t\"@prefix sh:    <http://www.w3.org/ns/shacl#> .\\n\" +\n+\t\t\t\t\"@prefix rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .\\n\" +\n+\t\t\t\t\"@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .\\n\" +\n+\t\t\t\t\"@prefix rdfs:  <http://www.w3.org/2000/01/rdf-schema#> .\\n\" +\n+\t\t\t\t\"@prefix foaf:  <http://xmlns.com/foaf/0.1/> .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"_:b0    a        sh:PropertyShape ;\\n\" +\n+\t\t\t\t\"        sh:not   [ a       sh:NodeShape ;\\n\" +\n+\t\t\t\t\"                   sh:and  [ rdf:first  [ a       sh:NodeShape ;\\n\" +\n+\t\t\t\t\"                                          sh:in   ( ex:steve )\\n\" +\n+\t\t\t\t\"                                        ] ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        )\\n\" +\n+\t\t\t\t\"                           ]\\n\" +\n+\t\t\t\t\"                 ] ;\\n\" +\n+\t\t\t\t\"        sh:path  ex:knows .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"_:b1    a       sh:NodeShape ;\\n\" +\n+\t\t\t\t\"        sh:in   [ rdf:first  ex:pete ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve )\\n\" +\n+\t\t\t\t\"                ] .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"[ a            sh:ValidationReport ;\\n\" +\n+\t\t\t\t\"  <http://rdf4j.org/schema/rdf4j#truncated>\\n\" +\n+\t\t\t\t\"          false ;\\n\" +\n+\t\t\t\t\"  sh:conforms  false ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ]\\n\" +\n+\t\t\t\t\"] .\\n\";\n+\n+\t\tSystem.out.println(\"### EXPECTED ###\");\n+\t\tSystem.out.println(data);\n+\t\tSystem.out.println(\"#################\\n\");\n+\n+\t\tModel expected = Rio.parse(new StringReader(data), \"\", RDFFormat.TURTLE);\n+\n+\t\tStringWriter stringWriter = new StringWriter();\n+\t\tWriterConfig config = new WriterConfig();\n+\t\tconfig.set(BasicWriterSettings.INLINE_BLANK_NODES, true);\n+\t\tRio.write(expected, stringWriter, RDFFormat.TURTLE, config);\n+\n+\t\tSystem.out.println(\"### ACTUAL ###\");\n+\t\tSystem.out.println(stringWriter.toString());\n+\t\tSystem.out.println(\"#################\\n\");\n+\n+\t\tModel actual = Rio.parse(new StringReader(stringWriter.toString()), \"\", RDFFormat.TURTLE);\n+\t\tassertTrue(Models.isomorphic(expected, actual));\n+\t}\n+\n+\t@Test\n+\tpublic void anotherBnodeTestReduced() throws Exception {\n+\t\tString data = \"\" +\n+\t\t\t\t\"@prefix ex:    <http://example.com/ns#> .\\n\" +\n+\t\t\t\t\"@prefix sh:    <http://www.w3.org/ns/shacl#> .\\n\" +\n+\t\t\t\t\"@prefix rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .\\n\" +\n+\t\t\t\t\"@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .\\n\" +\n+\t\t\t\t\"@prefix rdfs:  <http://www.w3.org/2000/01/rdf-schema#> .\\n\" +\n+\t\t\t\t\"@prefix foaf:  <http://xmlns.com/foaf/0.1/> .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"ex:a  ex:list   (_:b0 _:b0) .\";\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8348bd0076f62515e1f5d54db9f0482aa3430f4c"}, "originalPosition": 151}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d84ebb221f5f0a745c3baf8df6f5d5e86e53b54", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/7d84ebb221f5f0a745c3baf8df6f5d5e86e53b54", "committedDate": "2020-09-14T07:24:51Z", "message": "GH-2479 partial fix for bnode inlining in collections\n\n- fixes simple case but not the more complex one"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bfc790cfecd287472a7f30479fc3a992820864a", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/9bfc790cfecd287472a7f30479fc3a992820864a", "committedDate": "2020-09-14T19:23:00Z", "message": "GH-2497 added another test case\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NDMxNTQw", "url": "https://github.com/eclipse/rdf4j/pull/2498#pullrequestreview-488431540", "createdAt": "2020-09-15T08:10:13Z", "commit": {"oid": "9bfc790cfecd287472a7f30479fc3a992820864a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODoxMDoxM1rOHR173A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwODoxMDoxM1rOHR173A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQ3MTUxNg==", "bodyText": "I am not sure this one really counts as a bug, to be honest - and even if it does it is a very exotic corner case.\nThis case is an invalid collection structure in the sense that it links a non-list related poperty (ex:abc) to a bnode that that is directly part of the list structure itself. We are not so much inlining that blank node as just removing it, because the list gets converted to a syntactical shortform where the blank nodes and (rdf:first/rest properties) are just erased.\nThe actual output for this is:\n@prefix ex: <http://example.com/ns#> .\n@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .\n\nex:ex1 ex:list ([]) .\n[] ex:abc ex:def .\n\nIn other words, one list with a single item (a blank node), and a statement with a blank node subject. The fact that in the original file that blank node was the same blank node as the one used in the internal collection structure is lost, but that does not make the output incorrect. There's also a strong whiff of \"what the heck are you even doing using a collection blank node like this?!\"\nWe could potentially handle this with a separate test to check if the collection is well-formed before serializing it, but it's going to be costly.", "url": "https://github.com/eclipse/rdf4j/pull/2498#discussion_r488471516", "createdAt": "2020-09-15T08:10:13Z", "author": {"login": "jeenbroekstra"}, "path": "core/rio/turtle/src/test/java/org/eclipse/rdf4j/rio/turtle/TurtleWriterTest.java", "diffHunk": "@@ -194,4 +194,196 @@ public void testNoBuffering() throws Exception {\n \t\tModel actual = Rio.parse(new StringReader(stringWriter.toString()), \"\", RDFFormat.TURTLE);\n \t\tassertTrue(Models.isomorphic(expected, actual));\n \t}\n+\n+\t@Test\n+\tpublic void anotherBnodeTest() throws Exception {\n+\t\tString data = \"@prefix ex:    <http://example.com/ns#> .\\n\" +\n+\t\t\t\t\"@prefix sh:    <http://www.w3.org/ns/shacl#> .\\n\" +\n+\t\t\t\t\"@prefix rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .\\n\" +\n+\t\t\t\t\"@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .\\n\" +\n+\t\t\t\t\"@prefix rdfs:  <http://www.w3.org/2000/01/rdf-schema#> .\\n\" +\n+\t\t\t\t\"@prefix foaf:  <http://xmlns.com/foaf/0.1/> .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"_:b0    a        sh:PropertyShape ;\\n\" +\n+\t\t\t\t\"        sh:not   [ a       sh:NodeShape ;\\n\" +\n+\t\t\t\t\"                   sh:and  [ rdf:first  [ a       sh:NodeShape ;\\n\" +\n+\t\t\t\t\"                                          sh:in   ( ex:steve )\\n\" +\n+\t\t\t\t\"                                        ] ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        ) ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   ( _:b1\\n\" +\n+\t\t\t\t\"                                        )\\n\" +\n+\t\t\t\t\"                           ]\\n\" +\n+\t\t\t\t\"                 ] ;\\n\" +\n+\t\t\t\t\"        sh:path  ex:knows .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"_:b1    a       sh:NodeShape ;\\n\" +\n+\t\t\t\t\"        sh:in   [ rdf:first  ex:pete ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve ) ;\\n\" +\n+\t\t\t\t\"                  rdf:rest   ( ex:steve )\\n\" +\n+\t\t\t\t\"                ] .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"[ a            sh:ValidationReport ;\\n\" +\n+\t\t\t\t\"  <http://rdf4j.org/schema/rdf4j#truncated>\\n\" +\n+\t\t\t\t\"          false ;\\n\" +\n+\t\t\t\t\"  sh:conforms  false ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ] ;\\n\" +\n+\t\t\t\t\"  sh:result    [ a                             sh:ValidationResult ;\\n\" +\n+\t\t\t\t\"                 sh:focusNode                  ex:validPerson1 ;\\n\" +\n+\t\t\t\t\"                 sh:resultPath                 ex:knows ;\\n\" +\n+\t\t\t\t\"                 sh:resultSeverity             sh:Violation ;\\n\" +\n+\t\t\t\t\"                 sh:sourceConstraintComponent  sh:NotConstraintComponent ;\\n\" +\n+\t\t\t\t\"                 sh:sourceShape                _:b0 ;\\n\" +\n+\t\t\t\t\"                 sh:value                      ex:steve\\n\" +\n+\t\t\t\t\"               ]\\n\" +\n+\t\t\t\t\"] .\\n\";\n+\n+\t\tSystem.out.println(\"### EXPECTED ###\");\n+\t\tSystem.out.println(data);\n+\t\tSystem.out.println(\"#################\\n\");\n+\n+\t\tModel expected = Rio.parse(new StringReader(data), \"\", RDFFormat.TURTLE);\n+\n+\t\tStringWriter stringWriter = new StringWriter();\n+\t\tWriterConfig config = new WriterConfig();\n+\t\tconfig.set(BasicWriterSettings.INLINE_BLANK_NODES, true);\n+\t\tRio.write(expected, stringWriter, RDFFormat.TURTLE, config);\n+\n+\t\tSystem.out.println(\"### ACTUAL ###\");\n+\t\tSystem.out.println(stringWriter.toString());\n+\t\tSystem.out.println(\"#################\\n\");\n+\n+\t\tModel actual = Rio.parse(new StringReader(stringWriter.toString()), \"\", RDFFormat.TURTLE);\n+\t\tassertTrue(Models.isomorphic(expected, actual));\n+\t}\n+\n+\t@Test\n+\tpublic void anotherBnodeTestReduced() throws Exception {\n+\t\tString data = \"\" +\n+\t\t\t\t\"@prefix ex:    <http://example.com/ns#> .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"ex:a  ex:list   (_:b0 _:b0) .\";\n+\n+\t\tSystem.out.println(\"### EXPECTED ###\");\n+\t\tSystem.out.println(data);\n+\t\tSystem.out.println(\"#################\\n\");\n+\n+\t\tModel expected = Rio.parse(new StringReader(data), \"\", RDFFormat.TURTLE);\n+\n+\t\tStringWriter stringWriter = new StringWriter();\n+\t\tWriterConfig config = new WriterConfig();\n+\t\tconfig.set(BasicWriterSettings.INLINE_BLANK_NODES, true);\n+\t\tRio.write(expected, stringWriter, RDFFormat.TURTLE, config);\n+\n+\t\tSystem.out.println(\"### ACTUAL ###\");\n+\t\tSystem.out.println(stringWriter.toString());\n+\t\tSystem.out.println(\"#################\\n\");\n+\n+\t\tModel actual = Rio.parse(new StringReader(stringWriter.toString()), \"\", RDFFormat.TURTLE);\n+\t\tassertTrue(Models.isomorphic(expected, actual));\n+\t}\n+\n+\t@Test\n+\tpublic void anotherBnodeTestReduced2() throws Exception {\n+\t\tString data = \"@prefix ex:    <http://example.com/ns#> .\\n\" +\n+\t\t\t\t\"@prefix rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .\\n\" +\n+\t\t\t\t\"\\n\" +\n+\t\t\t\t\"ex:ex1    ex:list  [ rdf:first  [  ] ;\\n\" +\n+\t\t\t\t\"                             rdf:rest   rdf:nil ;\\n\" +\n+\t\t\t\t\"                             ex:abc   ex:def\\n\" +\n+\t\t\t\t\"                           ]\\n\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9bfc790cfecd287472a7f30479fc3a992820864a"}, "originalPosition": 174}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10ee2afb51d85a81ef9efa9a89da28f74f96434b", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/10ee2afb51d85a81ef9efa9a89da28f74f96434b", "committedDate": "2020-09-15T14:54:44Z", "message": "Merge branch 'master' into GH-2497-bnode-inlining"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74b0925c034c0fca59839e03941ea2a901bbce73", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/74b0925c034c0fca59839e03941ea2a901bbce73", "committedDate": "2020-09-15T14:59:31Z", "message": "ignored failing tests\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc242aeafbb4bd47ebe7fa58b46b94336277636d", "author": {"user": {"login": "hmottestad", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/cc242aeafbb4bd47ebe7fa58b46b94336277636d", "committedDate": "2020-09-15T15:00:34Z", "message": "Merge branch 'master' into GH-2497-bnode-inlining"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae10d0eec3b0cde025b308db52250fb548e7252d", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/ae10d0eec3b0cde025b308db52250fb548e7252d", "committedDate": "2020-09-16T01:28:13Z", "message": "GH-2497 extensive check on rdf collections being wellformed\n\n- fixes all outstanding test cases"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 99, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}