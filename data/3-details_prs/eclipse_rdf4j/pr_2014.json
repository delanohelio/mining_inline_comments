{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwMzkwNDU4", "number": 2014, "title": "Fixes GH-2013 by traversing parents until sourceString is found", "bodyText": "Fixes GH-2013 by traversing parents until sourceString is found\nSigned-off-by: damyan.ognyanov damyan.ognyanov@ontotext.com\nGitHub issue resolved: #2013\n\nadded a simplified test case reproducing the issue\nfix in ASTServiceGraphPattern that traverse the node parents untl a sourceString is found", "createdAt": "2020-03-18T11:53:09Z", "url": "https://github.com/eclipse/rdf4j/pull/2014", "merged": true, "mergeCommit": {"oid": "670559d8d69f9b9fd05da244e58898d5184d146e"}, "closed": true, "closedAt": "2020-03-20T22:07:01Z", "author": {"login": "damyan-ognyanov"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPD_PMAFqTM3NzQxMjUxMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPn7dDgFqTM3ODgzNzUwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NDEyNTEx", "url": "https://github.com/eclipse/rdf4j/pull/2014#pullrequestreview-377412511", "createdAt": "2020-03-19T04:12:47Z", "commit": {"oid": "01204c00f18bdcd043293468726e83e641581edb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNDoxMjo0N1rOF4fibw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNDoxMjo0N1rOF4fibw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc4MTI5NQ==", "bodyText": "Editorial: could you add open and close brackets here and in other places where you have if/else constructions?", "url": "https://github.com/eclipse/rdf4j/pull/2014#discussion_r394781295", "createdAt": "2020-03-19T04:12:47Z", "author": {"login": "jeenbroekstra"}, "path": "core/queryparser/sparql/src/main/java/org/eclipse/rdf4j/query/parser/sparql/ast/ASTServiceGraphPattern.java", "diffHunk": "@@ -84,6 +81,24 @@ public String getPatternString() {\n \t\treturn patternString;\n \t}\n \n+\tprivate String getSourceString() {\n+\t\tNode theParent = getParentContainer(this);\n+\t\tString sourceString = null;\n+\t\tif (theParent instanceof ASTOperationContainer)\n+\t\t\tsourceString = ((ASTOperationContainer) theParent).getSourceString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01204c00f18bdcd043293468726e83e641581edb"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NTcxOTcy", "url": "https://github.com/eclipse/rdf4j/pull/2014#pullrequestreview-377571972", "createdAt": "2020-03-19T09:59:36Z", "commit": {"oid": "bb8c47520c3f37d5cc195961579018769f15fc06"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwOTo1OTozN1rOF4nZdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwOTo1OTozN1rOF4nZdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDkxMDA2OQ==", "bodyText": "I was wondering if maybe there could be a null check here, so that any exception is thrown when looking for the source string instead of when using the resulting string. Maybe return Objects.requireNonNull(sourceString);\nUnless of course there is a case where returning null from getSourceString() is acceptable.", "url": "https://github.com/eclipse/rdf4j/pull/2014#discussion_r394910069", "createdAt": "2020-03-19T09:59:37Z", "author": {"login": "hmottestad"}, "path": "core/queryparser/sparql/src/main/java/org/eclipse/rdf4j/query/parser/sparql/ast/ASTServiceGraphPattern.java", "diffHunk": "@@ -84,6 +81,27 @@ public String getPatternString() {\n \t\treturn patternString;\n \t}\n \n+\tprivate String getSourceString() {\n+\t\tNode theParent = getParentContainer(this);\n+\t\tString sourceString = null;\n+\t\tif (theParent instanceof ASTOperationContainer) {\n+\t\t\tsourceString = ((ASTOperationContainer) theParent).getSourceString();\n+\t\t} else if (theParent instanceof ASTUpdateSequence) {\n+\t\t\tsourceString = ((ASTUpdateSequence) theParent).getSourceString();\n+\t\t}\n+\n+\t\twhile (sourceString == null && theParent != null) {\n+\t\t\ttheParent = theParent.jjtGetParent();\n+\t\t\tif (theParent == null) {\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tif (theParent instanceof ASTUpdateSequence) {\n+\t\t\t\tsourceString = ((ASTUpdateSequence) theParent).getSourceString();\n+\t\t\t}\n+\t\t}\n+\t\treturn sourceString;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb8c47520c3f37d5cc195961579018769f15fc06"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4023a7a658cc39e8f7f7c74f89c77efb4d639883", "author": {"user": {"login": "damyan-ognyanov", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/4023a7a658cc39e8f7f7c74f89c77efb4d639883", "committedDate": "2020-03-20T05:38:09Z", "message": "Fixes GH-2013 by traversing parents until sourceString is found. Add test case\n\nSigned-off-by: damyan.ognyanov <damyan.ognyanov@ontotext.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb8c47520c3f37d5cc195961579018769f15fc06", "author": {"user": {"login": "damyan-ognyanov", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/bb8c47520c3f37d5cc195961579018769f15fc06", "committedDate": "2020-03-19T08:05:57Z", "message": "few more\n\nSigned-off-by: damyan.ognyanov <damyan.ognyanov@ontotext.com>"}, "afterCommit": {"oid": "4023a7a658cc39e8f7f7c74f89c77efb4d639883", "author": {"user": {"login": "damyan-ognyanov", "name": null}}, "url": "https://github.com/eclipse/rdf4j/commit/4023a7a658cc39e8f7f7c74f89c77efb4d639883", "committedDate": "2020-03-20T05:38:09Z", "message": "Fixes GH-2013 by traversing parents until sourceString is found. Add test case\n\nSigned-off-by: damyan.ognyanov <damyan.ognyanov@ontotext.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4ODM3NTA1", "url": "https://github.com/eclipse/rdf4j/pull/2014#pullrequestreview-378837505", "createdAt": "2020-03-20T22:06:11Z", "commit": {"oid": "4023a7a658cc39e8f7f7c74f89c77efb4d639883"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}