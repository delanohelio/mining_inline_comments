{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMTI2ODQ3", "number": 2146, "title": "GH-2145: named graph support in federation engine", "bodyText": "GH-2145: fix context retrieval in federation engine\n\ncontext IDs retrieved from the endpoints have to be materialized as\nthey are only available while the connection is open\nadd unit test infrastructure for named graph tests and define some\ntest data\n\nGH-2145: add named graph handling for #getStatements API\nAdd named graph support to the RepositoryConnection API using the\ngetStatements method. Also covered with various unit tests.\nNote that this change provides already the infrastructure to further add\nsupport for named graph queries.\nGH-2145: add named graph handling for simple federated SELECT patterns\n\n\nsupport GRAPH clause around single basic graph pattern\n\n\nsupport FROM clause in queries\n\n\nadd named graph handling for simple federated SELECT patterns\n** support GRAPH clause around single basic graph pattern\n** support FROM clause in queries\n\n\nfix handling of base URIs for query parsing in FedX\n\n\nadd named graph support for bound joins\n\n\nGH-2149 GH-2145 use new compliance test suite for testing of FedX\nGitHub issue resolved: #2145\n\nPR Author Checklist:\n\n my pull request is self-contained\n I've added tests for the changes I made\n every commit message starts with the issue number (GH-xxxx) followed by a meaningful description of the change\n every commit has been signed off\n\nNote: we merge all feature pull requests using squash and merge. See RDF4J git merge strategy for more details.", "createdAt": "2020-04-28T13:40:43Z", "url": "https://github.com/eclipse/rdf4j/pull/2146", "merged": true, "mergeCommit": {"oid": "1ec3b8524aa50df5842c077152a0729f96b31a8d"}, "closed": true, "closedAt": "2020-05-06T03:49:21Z", "author": {"login": "aschwarte10"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccQNftgFqTQwMjM0ODc2Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcegS7lgFqTQwNjI4NjcxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMzQ4NzY2", "url": "https://github.com/eclipse/rdf4j/pull/2146#pullrequestreview-402348766", "createdAt": "2020-04-29T03:49:11Z", "commit": {"oid": "55a06c277ab80be4e304556dcf4135c7e4f2ef99"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NzQ0MTc1", "url": "https://github.com/eclipse/rdf4j/pull/2146#pullrequestreview-404744175", "createdAt": "2020-05-04T07:00:15Z", "commit": {"oid": "498297b31e0a348cba7898da0a25c9e3678b63ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwNzowMDoxNVrOGP0jfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwNzowMDoxNVrOGP0jfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI0Mjg3OA==", "bodyText": "@aschwarte10 I could use your eyes on this problem. FedX is currently designed to instantiate the EvaluationStrategy once (unless the config changes). But in RDF4J Sails, it is generally assumed that each query gets its own EvaluationStategy - that is why the Dataset object is passed in on the constructor. I believe that this has caused some of the named graph queries to fail on FedX (basically because we don't pass the dataset along). I'd like to hear your opinion on the best way forward: can we just remove the assumption that the strategy is defined once and let FedX instantiate a new strategy for each query?\nI'm a little wary of doing something like just setting/overwriting the Dataset  assigned to the strategy on each query, as I'm not sure what the consequences would be in a multithreaded environment.", "url": "https://github.com/eclipse/rdf4j/pull/2146#discussion_r419242878", "createdAt": "2020-05-04T07:00:15Z", "author": {"login": "jeenbroekstra"}, "path": "tools/federation/src/main/java/org/eclipse/rdf4j/federated/FederationManager.java", "diffHunk": "@@ -332,7 +342,10 @@ public void updateStrategy() {\n \t\t}\n \n \t\tif (updated) {\n-\t\t\tstrategy = FederationEvaluationStrategyFactory.getEvaluationStrategy(type, federationContext);\n+\t\t\t// TODO problem here: we need to (optionally) inject a Dataset object into the EvaluationStrategy, which is\n+\t\t\t// query-specific and determines what parts of the store are relevant for the query. However this part of\n+\t\t\t// the code assumes that we can instantiate an EvaluationStrategy once and then reuse it for each query.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "498297b31e0a348cba7898da0a25c9e3678b63ef"}, "originalPosition": 101}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "498297b31e0a348cba7898da0a25c9e3678b63ef", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/498297b31e0a348cba7898da0a25c9e3678b63ef", "committedDate": "2020-05-04T06:54:26Z", "message": "GH-2145 pass Dataset object along to evaluation strategy [WIP]\n\nSee FederationManager line 344-351 for a design problem I've\nencountered."}, "afterCommit": {"oid": "2dc25b27ea066def5e380fb9b1f8584d5914773c", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/2dc25b27ea066def5e380fb9b1f8584d5914773c", "committedDate": "2020-05-04T15:58:22Z", "message": "GH-2145 pass Dataset object along to evaluation strategy [WIP]\n\nSee FederationManager line 344-351 for a design problem I've\nencountered."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7d7554db019466f795c2b2efc166e79f112505c", "author": {"user": {"login": "aschwarte10", "name": "Andreas Schwarte"}}, "url": "https://github.com/eclipse/rdf4j/commit/a7d7554db019466f795c2b2efc166e79f112505c", "committedDate": "2020-05-05T19:50:05Z", "message": "GH-2145: Add named graph support to FedX federation engine\n\n* fix context retrieval in federation engine\n** context IDs retrieved from the endpoints have to be materialized as\nthey are only available while the connection is open\n** add unit test infrastructure for named graph tests and define some\ntest data\n\n* add named graph handling for #getStatements API\n\n* add named graph handling for simple federated SELECT patterns\n** support GRAPH clause around single basic graph pattern\n** support FROM clause in queries\n\n* fix handling of base URIs for query parsing in FedX\n\n* add named graph support for bound joins"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbce4c2b70443d0e534e852029b7b1e7270c44de", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/dbce4c2b70443d0e534e852029b7b1e7270c44de", "committedDate": "2020-05-05T19:50:06Z", "message": "GH-2149 GH-2145 use new compliance test suite for testing of FedX"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38fd3db19dcdfa44ab73dbcd6f7c6265fe0c5fa6", "author": {"user": {"login": "aschwarte10", "name": "Andreas Schwarte"}}, "url": "https://github.com/eclipse/rdf4j/commit/38fd3db19dcdfa44ab73dbcd6f7c6265fe0c5fa6", "committedDate": "2020-05-05T18:52:43Z", "message": "GH-2145: workaround for bound join no longer required"}, "afterCommit": {"oid": "dbce4c2b70443d0e534e852029b7b1e7270c44de", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/dbce4c2b70443d0e534e852029b7b1e7270c44de", "committedDate": "2020-05-05T19:50:06Z", "message": "GH-2149 GH-2145 use new compliance test suite for testing of FedX"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef5fa507a790924a6fbac8634a5d1fc54d0aa402", "author": {"user": {"login": "jeenbroekstra", "name": "Jeen Broekstra"}}, "url": "https://github.com/eclipse/rdf4j/commit/ef5fa507a790924a6fbac8634a5d1fc54d0aa402", "committedDate": "2020-05-06T02:58:24Z", "message": "Merge branch 'develop' into issues/#2145-named-graph-support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2Mjg2NzE3", "url": "https://github.com/eclipse/rdf4j/pull/2146#pullrequestreview-406286717", "createdAt": "2020-05-06T03:41:27Z", "commit": {"oid": "ef5fa507a790924a6fbac8634a5d1fc54d0aa402"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 143, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}