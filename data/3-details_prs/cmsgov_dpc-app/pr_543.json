{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzODU3MzU3", "number": 543, "title": "DPC-813: Improve log format", "bodyText": "Why\nLogs are difficult to scan and search due to the current format, which complicates debugging.\nWhat Changed\nThis branch adds dropwizard-json-logging to format log output as JSON. General logging is configured in server.conf, and request logs are configured in individual applications' application.conf files.\n\n\n\nTickets closed:\nDPC-813\nFuture Work\nAdditional logging improvements will be made with DPC-835.\nChecklist\n\n All tests are passing via make ci-app (app change) and make ci-web (website change)\n Swagger documentation has been updated\n FHIR documentation has been updated\n Any required dpc-ops changes have a PR submitted and mentioned in this ticket\n Any manual migration steps are documented, scripts written (where applicable), and tested\n Before merging, any required dpc-ops changes have been approved and merged into master of the dpc-ops repo", "createdAt": "2020-01-16T21:33:21Z", "url": "https://github.com/CMSgov/dpc-app/pull/543", "merged": true, "mergeCommit": {"oid": "bb815ffa5df5d9e3d9a9b66d40056602006df7d8"}, "closed": true, "closedAt": "2020-01-17T14:57:09Z", "author": {"login": "em1"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7BGyngH2gAyMzYzODU3MzU3OjVhNjk2Y2YwNzEyZGIwMDczNjczOWYwMjhlMmMwYTI2MTY4ZWMxN2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb7PlgMAFqTM0NDYxMTQ1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5a696cf0712db00736739f028e2c0a26168ec17d", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/5a696cf0712db00736739f028e2c0a26168ec17d", "committedDate": "2020-01-16T21:33:47Z", "message": "Structured logging initial setup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "5a696cf0712db00736739f028e2c0a26168ec17d", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/5a696cf0712db00736739f028e2c0a26168ec17d", "committedDate": "2020-01-16T21:33:47Z", "message": "Structured logging initial setup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0MjY2MzQx", "url": "https://github.com/CMSgov/dpc-app/pull/543#pullrequestreview-344266341", "createdAt": "2020-01-16T22:44:20Z", "commit": {"oid": "5a696cf0712db00736739f028e2c0a26168ec17d"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQyMjo0NDoyMFrOFep76w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQyMjo1NTo0N1rOFeqJ_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY4ODY4Mw==", "bodyText": "Good. Should use UTC.", "url": "https://github.com/CMSgov/dpc-app/pull/543#discussion_r367688683", "createdAt": "2020-01-16T22:44:20Z", "author": {"login": "RickHawesUSDS"}, "path": "dpc-api/src/main/resources/application.conf", "diffHunk": "@@ -15,10 +15,15 @@ dpc.api {\n     }\n \n     server.requestLog.appenders = [{\n-        type: \"console\"\n+        type = console\n+        timeZone = UTC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a696cf0712db00736739f028e2c0a26168ec17d"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY5MjI4NQ==", "bodyText": "A question... I'm wondering if this will include x-request-id and authorization.", "url": "https://github.com/CMSgov/dpc-app/pull/543#discussion_r367692285", "createdAt": "2020-01-16T22:55:47Z", "author": {"login": "RickHawesUSDS"}, "path": "dpc-api/src/main/resources/application.conf", "diffHunk": "@@ -15,10 +15,15 @@ dpc.api {\n     }\n \n     server.requestLog.appenders = [{\n-        type: \"console\"\n+        type = console\n+        timeZone = UTC\n         filterFactories =[{\n-            type: token-filter-factory\n+            type = token-filter-factory\n         }]\n+        layout {\n+          type = access-json\n+          timestampFormat = \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"\n+        }\n     }]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a696cf0712db00736739f028e2c0a26168ec17d"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fa486eb8b8f6b55fa6401c7c82d6b896374db90", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/4fa486eb8b8f6b55fa6401c7c82d6b896374db90", "committedDate": "2020-01-17T13:50:07Z", "message": "Merge branch 'master' into emily/dpc-813-structured-logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27f0b97c615405b6762393d989b2c98ad332db3e", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/27f0b97c615405b6762393d989b2c98ad332db3e", "committedDate": "2020-01-17T14:21:51Z", "message": "Set JSON layout on consent service request logs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NjExNDUz", "url": "https://github.com/CMSgov/dpc-app/pull/543#pullrequestreview-344611453", "createdAt": "2020-01-17T14:26:00Z", "commit": {"oid": "27f0b97c615405b6762393d989b2c98ad332db3e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 207, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}