{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3MjkwMzA4", "number": 865, "title": "DPC-154: As an internal user I want buttons to easily add/remove users from an organization", "bodyText": "Why\nTo improve internal user experience, external users have a REMOVE button for easy removal from an organization. And if the user requested a specific organization, have them listed underneath with an ADD button.\nWhat Changed\n\nChoices Made\n\nAdd/Remove buttons on users listed under an organization.\nRefactored the prod_sbx? and account_params_id to private global methods in the application_controller file to\n\n\nmake the organization_controller a more reasonable length (less than 100 lines per code climate's requirements) and\nto make the application more DRY.\n\nTickets closed:\nDPC-154\nFuture Work\nN/A\nChecklist\n\n All tests are passing via make ci-app (app change) and make ci-web (website change)\n[] Swagger documentation has been updated\n[] FHIR documentation has been updated\n[] Any required dpc-ops changes have a PR submitted and mentioned in this ticket\n[] Any manual migration steps are documented, scripts written (where applicable), and tested\n[] Before merging, any required dpc-ops changes have been approved and merged into master of the dpc-ops repo", "createdAt": "2020-06-19T20:49:35Z", "url": "https://github.com/CMSgov/dpc-app/pull/865", "merged": true, "mergeCommit": {"oid": "02f71865c5d99ebba2fb14f6eac7037ed5482b69"}, "closed": true, "closedAt": "2020-06-23T18:32:56Z", "author": {"login": "Sun-Mountain"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfSRLFgH2gAyNDM3MjkwMzA4OjE4ZDQzMDg2Y2RiN2U5MGVjZDA1ZmY5OTIyYjU3ZmJhNGY4ZjMwY2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuJG-pAH2gAyNDM3MjkwMzA4OmU1NmJhMDVlMjBlZjUzZmZiMjcwNTlmZTVlZTI4NDA5MmJiYWU2Zjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "18d43086cdb7e90ecd05ff9922b57fba4f8f30cd", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/18d43086cdb7e90ecd05ff9922b57fba4f8f30cd", "committedDate": "2020-05-08T13:54:47Z", "message": "init"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c94b9b052de32bb55f9f9615325c6c39780967ce", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/c94b9b052de32bb55f9f9615325c6c39780967ce", "committedDate": "2020-05-11T13:41:00Z", "message": "Merge remote-tracking branch 'origin/master' into nzonnenberg/dpc-1366-add-remove-users"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "916dc2b5b927d51dc993b274bd3f80fb5c4be4c1", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/916dc2b5b927d51dc993b274bd3f80fb5c4be4c1", "committedDate": "2020-05-13T14:13:13Z", "message": "init"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59422c1948c8ecaae81bb8aa7a29311ccff50986", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/59422c1948c8ecaae81bb8aa7a29311ccff50986", "committedDate": "2020-05-13T16:29:17Z", "message": "added user"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78067fd4ca599d11e4fd5b05519fd0768a5ab4da", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/78067fd4ca599d11e4fd5b05519fd0768a5ab4da", "committedDate": "2020-05-15T19:39:39Z", "message": "Delete user from organization"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d9605764085ccf3228e807d1bf338f5ec983a59", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/1d9605764085ccf3228e807d1bf338f5ec983a59", "committedDate": "2020-05-15T19:57:14Z", "message": "Button styling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63366c7d0e5d3718acbd9c35a45c6b35e970b9c2", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/63366c7d0e5d3718acbd9c35a45c6b35e970b9c2", "committedDate": "2020-05-20T15:41:35Z", "message": "Adding js file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5371415e09bbccf45ab63404ed0fbf74a5e1954b", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/5371415e09bbccf45ab63404ed0fbf74a5e1954b", "committedDate": "2020-05-20T15:57:26Z", "message": "Can access javascript file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78cbdf53a2959edb4e3492cce2744a5a3a41c253", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/78cbdf53a2959edb4e3492cce2744a5a3a41c253", "committedDate": "2020-05-20T18:14:19Z", "message": "Dynamic search works"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba41f1cdd40f18f6a25f74366af3e4e9f1d79d8b", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/ba41f1cdd40f18f6a25f74366af3e4e9f1d79d8b", "committedDate": "2020-05-20T21:01:31Z", "message": "List only unassigned users"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11c855789a53dbe5d7448c3ee19e15d0175e9949", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/11c855789a53dbe5d7448c3ee19e15d0175e9949", "committedDate": "2020-05-21T12:28:37Z", "message": "Save progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfe16b5bc5881bc6abddd5c6664c52f6d6067d6e", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/dfe16b5bc5881bc6abddd5c6664c52f6d6067d6e", "committedDate": "2020-05-26T12:33:33Z", "message": "Counting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51591e78d705b8b8740ca006edcd6620d96db6d0", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/51591e78d705b8b8740ca006edcd6620d96db6d0", "committedDate": "2020-06-09T14:56:17Z", "message": "Merge branch 'master' into nzonnenberg/dpc-1366-add-remove-users"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cc31b90bdba7eb22ec385c79ac98d3d3efcfa84", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/4cc31b90bdba7eb22ec385c79ac98d3d3efcfa84", "committedDate": "2020-06-09T15:44:03Z", "message": "Scroll users"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0811d2988d3e8fbd24252efc67d86270f03e6479", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/0811d2988d3e8fbd24252efc67d86270f03e6479", "committedDate": "2020-06-19T16:07:50Z", "message": "Merge branch 'master' into nzonnenberg/dpc-1366-add-remove-users"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fe15dbaf968ac655ceea9295a3606c0219e356e", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/0fe15dbaf968ac655ceea9295a3606c0219e356e", "committedDate": "2020-06-19T17:19:24Z", "message": "Progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77fe6ff0a7c1dac664129e846d0d1cca05f1e757", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/77fe6ff0a7c1dac664129e846d0d1cca05f1e757", "committedDate": "2020-06-19T20:37:45Z", "message": "Filter update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MzM4MjUz", "url": "https://github.com/CMSgov/dpc-app/pull/865#pullrequestreview-434338253", "createdAt": "2020-06-19T20:58:30Z", "commit": {"oid": "77fe6ff0a7c1dac664129e846d0d1cca05f1e757"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQyMDo1ODozMFrOGmhFgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQyMDo1ODozMFrOGmhFgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA0MTE1Mg==", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "url": "https://github.com/CMSgov/dpc-app/pull/865#discussion_r443041152", "createdAt": "2020-06-19T20:58:30Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/controllers/internal/organizations_controller.rb", "diffHunk": "@@ -79,6 +81,32 @@ def destroy\n       end\n     end\n \n+    def add", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77fe6ff0a7c1dac664129e846d0d1cca05f1e757"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA0MTE1Mw==", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "url": "https://github.com/CMSgov/dpc-app/pull/865#discussion_r443041153", "createdAt": "2020-06-19T20:58:30Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/controllers/internal/organizations_controller.rb", "diffHunk": "@@ -79,6 +81,32 @@ def destroy\n       end\n     end\n \n+    def add\n+      @organization = Organization.find(params[:organization_id])\n+      @user = User.find(params[:organization][:id])\n+      add_user = @organization.users << @user\n+\n+      if add_user\n+        flash[:notice] = 'User has been successfully added to organization.'\n+        redirect_to internal_organization_path(@organization)\n+      else\n+        flash[:alert] = 'User could not be added to organization.'\n+      end\n+    end\n+\n+    def delete", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "77fe6ff0a7c1dac664129e846d0d1cca05f1e757"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41d90cd6a0b1188c073553c515152acff37bebfc", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/41d90cd6a0b1188c073553c515152acff37bebfc", "committedDate": "2020-06-22T12:58:06Z", "message": "Refactor add/delete"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "830e0a6af9cd0ba4e322c8f1e1ad3e75064cef7f", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/830e0a6af9cd0ba4e322c8f1e1ad3e75064cef7f", "committedDate": "2020-06-22T13:04:10Z", "message": "code climate update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea0111ce4020dc1d872dcd1eb397f8253cb8b08b", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/ea0111ce4020dc1d872dcd1eb397f8253cb8b08b", "committedDate": "2020-06-22T14:21:42Z", "message": "Trim org controller"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cedfcff89062d69d2486911bbfe3a8a10b44343", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/1cedfcff89062d69d2486911bbfe3a8a10b44343", "committedDate": "2020-06-22T15:05:53Z", "message": "Trim org controller"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf42afb42270f3e6ef135caa56e5252d2730518b", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/cf42afb42270f3e6ef135caa56e5252d2730518b", "committedDate": "2020-06-22T15:09:08Z", "message": "Get rid of spaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ed76107f1b18262f212d4e73c3bf4e942cef19a", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/5ed76107f1b18262f212d4e73c3bf4e942cef19a", "committedDate": "2020-06-22T15:21:09Z", "message": "Refactored methods with only 'params.require(:id)' to global private method in application controller.\n\nIn attempts to shorten the organization controller (per code climate recommendations), I moved the org_params method to a private global method in application controller.\n\nTo keep application DRY, any method that only had 'params.require(:id)' was refactored for the new globabl method."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2fd75830a86a2488a0a3076c47a2e143f9c83bc", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/a2fd75830a86a2488a0a3076c47a2e143f9c83bc", "committedDate": "2020-06-22T15:25:44Z", "message": "Remove unused routes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MjU5OTk1", "url": "https://github.com/CMSgov/dpc-app/pull/865#pullrequestreview-435259995", "createdAt": "2020-06-22T20:44:40Z", "commit": {"oid": "a2fd75830a86a2488a0a3076c47a2e143f9c83bc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMDo0NDo0MFrOGnQWUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQyMDo0NDo0MFrOGnQWUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzgxNTUwNQ==", "bodyText": "I see why you pulled this out since we use :id as an identifier a lot (obviously :P). However, the id can identify can signify a lot of different tables. I just want to make sure that account_param_id is a good identifier so, if this is used in a lot of controllers, its not confusing.", "url": "https://github.com/CMSgov/dpc-app/pull/865#discussion_r443815505", "createdAt": "2020-06-22T20:44:40Z", "author": {"login": "SMLuthi"}, "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -37,4 +37,14 @@ def append_info_to_payload(payload)\n                         'ERROR'\n                       end\n   end\n+\n+  private\n+\n+  def account_params_id", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2fd75830a86a2488a0a3076c47a2e143f9c83bc"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d46f823b88ba200d2d9bf488fec6d8baf5111360", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/d46f823b88ba200d2d9bf488fec6d8baf5111360", "committedDate": "2020-06-23T17:40:22Z", "message": "Change account_params_id to id_param"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MDEzNTcx", "url": "https://github.com/CMSgov/dpc-app/pull/865#pullrequestreview-436013571", "createdAt": "2020-06-23T17:42:45Z", "commit": {"oid": "d46f823b88ba200d2d9bf488fec6d8baf5111360"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e56ba05e20ef53ffb27059fe5ee284092bbae6f7", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/e56ba05e20ef53ffb27059fe5ee284092bbae6f7", "committedDate": "2020-06-23T17:43:22Z", "message": "Merge branch 'master' into nzonnenberg/dpc-1366-add-remove-users"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 502, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}