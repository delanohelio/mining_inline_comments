{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0Njg4NzMw", "number": 920, "title": "DPC-556 allows clients to set the _outputFormat parameter on a /Group/$export request to ndjson or application/json. ", "bodyText": "Fixes DPC-556\n\nProposed Changes and ### Change Details\nThis change allows clients to set the _outputFormat parameter on a /Group/$export request to ndjson or application/ndjson.  Currently only application/fhir+json is supported\nSecurity Implications\n\nNo\n\n new software dependencies\nn/a\n\n\n\n security controls or supporting software altered\n\n\n\n new data stored or transmitted\n\n\n\n security checklist is completed for this change\n\n\n\n requires more information or team discussion to evaluate security implications\n\n\n\n no PHI/PII is affected by this change\n\n\nAcceptance Validation\n\nno, this change should be tested via end to end tests and/or integration of BDT into the ci build .\n\nFeedback Requested\n\nhow to test this appropriately in the dpc build pipeline.", "createdAt": "2020-07-21T19:00:27Z", "url": "https://github.com/CMSgov/dpc-app/pull/920", "merged": true, "mergeCommit": {"oid": "462ac8f4b221b025e577075b2e025d5e06f5f8f2"}, "closed": true, "closedAt": "2020-10-30T16:47:15Z", "author": {"login": "richbraman"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3KF71gH2gAyNDU0Njg4NzMwOjk0OTVmNDM0ZmY5ZmNkZjA3NjdjNGFkNTFlYzJmZWRmZTVhNDhmNDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXpjjVAFqTUyMDg0NjI5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9495f434ff9fcdf0767c4ad51ec2fedfe5a48f44", "author": {"user": {"login": "richbraman", "name": "Richard Braman"}}, "url": "https://github.com/CMSgov/dpc-app/commit/9495f434ff9fcdf0767c4ad51ec2fedfe5a48f44", "committedDate": "2020-07-21T17:57:27Z", "message": "add application/ndjson and ndjson as acceptable _outputFormat parameter values"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfa206eca9fd31f16fb88bfd0abf17111801dd3c", "author": {"user": {"login": "richbraman", "name": "Richard Braman"}}, "url": "https://github.com/CMSgov/dpc-app/commit/dfa206eca9fd31f16fb88bfd0abf17111801dd3c", "committedDate": "2020-07-29T00:27:39Z", "message": "Merge branch 'master' into rb/DPC-556"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbc67fd145cf1c63b34d276f6b4718bd2797f955", "author": {"user": {"login": "richbraman", "name": "Richard Braman"}}, "url": "https://github.com/CMSgov/dpc-app/commit/dbc67fd145cf1c63b34d276f6b4718bd2797f955", "committedDate": "2020-07-29T16:09:57Z", "message": "Merge branch 'master' into rb/DPC-556"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NjgzMDY3", "url": "https://github.com/CMSgov/dpc-app/pull/920#pullrequestreview-457683067", "createdAt": "2020-07-29T16:19:10Z", "commit": {"oid": "dbc67fd145cf1c63b34d276f6b4718bd2797f955"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NjgyODc5", "url": "https://github.com/CMSgov/dpc-app/pull/920#pullrequestreview-457682879", "createdAt": "2020-07-29T16:18:57Z", "commit": {"oid": "dbc67fd145cf1c63b34d276f6b4718bd2797f955"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNjoxODo1N1rOG5AG5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNjoxODo1N1rOG5AG5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjQyMzc4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // _outputFormat only supports FHIR_NDJSON, APPLICATION_NDJON, or NDJSON\n          \n          \n            \n                    if (StringUtils.isNotEmpty(outputFormat) && (!FHIR_NDJSON.equals(outputFormat) && !APPLICATION_NDJSON.equals(outputFormat) && !NDJSON.equals(outputFormat) )) {\n          \n          \n            \n                        throw new BadRequestException(\"'_outputFormat' query parameter must be 'application/fhir+ndjson','application/ndjson', or 'ndjson' \");\n          \n          \n            \n                    // _outputFormat only supports FHIR_NDJSON, APPLICATION_NDJSON, or NDJSON\n          \n          \n            \n                    if (StringUtils.isNotEmpty(outputFormat) && (!FHIR_NDJSON.equals(outputFormat) && !APPLICATION_NDJSON.equals(outputFormat) && !NDJSON.equals(outputFormat) )) {\n          \n          \n            \n                        throw new BadRequestException(\"'_outputFormat' query parameter must be 'application/fhir+ndjson', 'application/ndjson', or 'ndjson' \");", "url": "https://github.com/CMSgov/dpc-app/pull/920#discussion_r462423782", "createdAt": "2020-07-29T16:18:57Z", "author": {"login": "em1"}, "path": "dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/GroupResource.java", "diffHunk": "@@ -351,10 +353,10 @@ private OffsetDateTime handleSinceQueryParam(String since) {\n      *\n      * @param outputFormat param to check\n      */\n-    private static void checkExportRequest(String outputFormat, String headerPrefer) {\n-        // _outputFormat only supports FHIR_NDJSON\n-        if (StringUtils.isNotEmpty(outputFormat) && !FHIR_NDJSON.equals(outputFormat)) {\n-            throw new BadRequestException(\"'_outputFormat' query parameter must be 'application/fhir+ndjson'\");\n+    private static void checkExportRequest(String outputFormat String headerPrefer) {\n+        // _outputFormat only supports FHIR_NDJSON, APPLICATION_NDJON, or NDJSON\n+        if (StringUtils.isNotEmpty(outputFormat) && (!FHIR_NDJSON.equals(outputFormat) && !APPLICATION_NDJSON.equals(outputFormat) && !NDJSON.equals(outputFormat) )) {\n+            throw new BadRequestException(\"'_outputFormat' query parameter must be 'application/fhir+ndjson','application/ndjson', or 'ndjson' \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbc67fd145cf1c63b34d276f6b4718bd2797f955"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3db99d147b88d833a30287f907af2efb576d238", "author": {"user": {"login": "richbraman", "name": "Richard Braman"}}, "url": "https://github.com/CMSgov/dpc-app/commit/a3db99d147b88d833a30287f907af2efb576d238", "committedDate": "2020-07-29T16:22:00Z", "message": "Update dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/GroupResource.java\n\nCo-authored-by: Emily Hart <1923441+embh@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3Njg4MDA5", "url": "https://github.com/CMSgov/dpc-app/pull/920#pullrequestreview-457688009", "createdAt": "2020-07-29T16:25:00Z", "commit": {"oid": "a3db99d147b88d833a30287f907af2efb576d238"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9df012a6d4a2ec43f376a1e8c8ec963da71e860f", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/9df012a6d4a2ec43f376a1e8c8ec963da71e860f", "committedDate": "2020-10-16T15:25:58Z", "message": "Merge branch 'master' into rb/DPC-556"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "175b477b6efb03c76bae440cf0bb932986d80ad9", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/175b477b6efb03c76bae440cf0bb932986d80ad9", "committedDate": "2020-10-16T18:51:13Z", "message": "add unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "085e9f8aae3827e12052c3379063283091eda1d3", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/085e9f8aae3827e12052c3379063283091eda1d3", "committedDate": "2020-10-20T05:50:37Z", "message": "Merge branch 'master' into rb/DPC-556"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af8a4cbfb4b8b51f09314e6bef6123a97b325d00", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/af8a4cbfb4b8b51f09314e6bef6123a97b325d00", "committedDate": "2020-10-20T15:57:13Z", "message": "simplify logic and add more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5721302cf46db1c21b13cb51cc2529419e1c2444", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/5721302cf46db1c21b13cb51cc2529419e1c2444", "committedDate": "2020-10-20T21:28:25Z", "message": "Merge branch 'master' into rb/DPC-556\n\n# Conflicts:\n#\tdpc-api/src/main/java/gov/cms/dpc/api/resources/v1/GroupResource.java\n#\tdpc-api/src/test/java/gov/cms/dpc/api/resources/v1/GroupResourceUnitTest.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNzgzODE0", "url": "https://github.com/CMSgov/dpc-app/pull/920#pullrequestreview-513783814", "createdAt": "2020-10-21T14:57:55Z", "commit": {"oid": "5721302cf46db1c21b13cb51cc2529419e1c2444"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNDo1Nzo1NVrOHlw9pA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxNDo1Nzo1NVrOHlw9pA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM2MTU3Mg==", "bodyText": "Should they be case insensitive?", "url": "https://github.com/CMSgov/dpc-app/pull/920#discussion_r509361572", "createdAt": "2020-10-21T14:57:55Z", "author": {"login": "MrMorie"}, "path": "dpc-api/src/main/java/gov/cms/dpc/api/resources/v1/GroupResource.java", "diffHunk": "@@ -369,8 +368,8 @@ private static void checkExportRequest(String outputFormat, List<Pair<String, St\n \n     private static void checkOutputFormat(String outputFormat) {\n         // _outputFormat only supports FHIR_NDJSON\n-        if (StringUtils.isNotEmpty(outputFormat) && !FHIR_NDJSON.equals(outputFormat)) {\n-            throw new BadRequestException(\"'_outputFormat' query parameter must be 'application/fhir+ndjson'\");\n+        if (!StringUtils.equalsAny(outputFormat, FHIR_NDJSON, APPLICATION_NDJSON, NDJSON)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5721302cf46db1c21b13cb51cc2529419e1c2444"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNzg1MDkw", "url": "https://github.com/CMSgov/dpc-app/pull/920#pullrequestreview-513785090", "createdAt": "2020-10-21T14:59:00Z", "commit": {"oid": "5721302cf46db1c21b13cb51cc2529419e1c2444"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "122af11f3749e12b758939baeeaee4a72d2792aa", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/122af11f3749e12b758939baeeaee4a72d2792aa", "committedDate": "2020-10-21T23:19:44Z", "message": "ignore case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "400f5750b422bbf06c3d3f86adf5ebc95a733240", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/400f5750b422bbf06c3d3f86adf5ebc95a733240", "committedDate": "2020-10-23T03:42:09Z", "message": "Merge branch 'master' into rb/DPC-556\n\n# Conflicts:\n#\tdpc-api/src/main/java/gov/cms/dpc/api/resources/v1/GroupResource.java\n#\tdpc-api/src/test/java/gov/cms/dpc/api/resources/v1/GroupResourceUnitTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6f2bafa0f4966d4885bcb1aa8a25973ceeabc15", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/e6f2bafa0f4966d4885bcb1aa8a25973ceeabc15", "committedDate": "2020-10-27T15:09:03Z", "message": "Merge branch 'master' into rb/DPC-556"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14739d4ade890e684cda480494e1f56f9e9a7da9", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/14739d4ade890e684cda480494e1f56f9e9a7da9", "committedDate": "2020-10-29T14:38:45Z", "message": "Merge branch 'master' into rb/DPC-556"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NzQwMzg4", "url": "https://github.com/CMSgov/dpc-app/pull/920#pullrequestreview-519740388", "createdAt": "2020-10-29T14:43:02Z", "commit": {"oid": "14739d4ade890e684cda480494e1f56f9e9a7da9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f183c05826a34d83feea30a6b3086d8afed059a", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/4f183c05826a34d83feea30a6b3086d8afed059a", "committedDate": "2020-10-29T15:46:46Z", "message": "Merge branch 'master' into rb/DPC-556"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "460284c0d40d23517bd54ce8b8ef7e7f6f7a10cb", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/460284c0d40d23517bd54ce8b8ef7e7f6f7a10cb", "committedDate": "2020-10-30T14:33:28Z", "message": "Merge branch 'master' into rb/DPC-556\n\n# Conflicts:\n#\tdpc-api/src/test/java/gov/cms/dpc/api/resources/v1/GroupResourceUnitTest.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwODQ2Mjk2", "url": "https://github.com/CMSgov/dpc-app/pull/920#pullrequestreview-520846296", "createdAt": "2020-10-30T16:42:26Z", "commit": {"oid": "460284c0d40d23517bd54ce8b8ef7e7f6f7a10cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 419, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}