{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NzQ0Mzc0", "number": 563, "title": "DPC-956: Modify BFD client to use excludeSAMHSA=true when making EOB requests", "bodyText": "Why\nData provided by DPC cannot include substance abuse and mental health claims.\nWhat Changed\n\nAdds excludeSAMHSA=true on ExplanationOfBenefit requests to BFD\nfetchBundle() in BlueButtonClientImpl now accepts a List of criteria (ICriterion objects); if more than one is provided, it is added to the query with and()\n\nTickets closed:\nDPC-956\nChecklist\n\n All tests are passing via make ci-app (app change) and make ci-web (website change)\n Swagger documentation has been updated\n FHIR documentation has been updated\n Any required dpc-ops changes have a PR submitted and mentioned in this ticket\n Any manual migration steps are documented, scripts written (where applicable), and tested\n Before merging, any required dpc-ops changes have been approved and merged into master of the dpc-ops repo", "createdAt": "2020-01-27T22:53:32Z", "url": "https://github.com/CMSgov/dpc-app/pull/563", "merged": true, "mergeCommit": {"oid": "1bb5ad208e2a0230be08f3958a8038fa3b9b577e"}, "closed": true, "closedAt": "2020-01-28T19:43:59Z", "author": {"login": "em1"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-x3QOAFqTM0OTM5NTEyNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-2E1JgFqTM0OTYyMjYyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5Mzk1MTI3", "url": "https://github.com/CMSgov/dpc-app/pull/563#pullrequestreview-349395127", "createdAt": "2020-01-28T14:02:26Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxNDowMjoyNlrOFimBCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxNDowMjoyNlrOFimBCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgxODc2MA==", "bodyText": "Can we use a range loop here? Usually a bit safer than a raw idx.", "url": "https://github.com/CMSgov/dpc-app/pull/563#discussion_r371818760", "createdAt": "2020-01-28T14:02:26Z", "author": {"login": "nickrobison-usds"}, "path": "dpc-bluebutton/src/main/java/gov/cms/dpc/bluebutton/client/BlueButtonClientImpl.java", "diffHunk": "@@ -192,17 +199,22 @@ public String hashMbi(String mbi) throws GeneralSecurityException {\n      * Read a FHIR Bundle from BlueButton. Limits the returned size by resourcesPerRequest.\n      *\n      * @param resourceClass - FHIR Resource class\n-     * @param criterion - For the resource class the correct criterion that matches the patientID\n+     * @param criteria - For the resource class the correct criteria that match the patientID\n      * @param patientID - id of patient\n      * @return FHIR Bundle resource\n      */\n     private <T extends IBaseResource> Bundle fetchBundle(Class<T> resourceClass,\n-                                                         ICriterion<ReferenceClientParam> criterion,\n+                                                         List<ICriterion<? extends IParam>> criteria,\n                                                          String patientID) {\n-        final Bundle bundle = client.search()\n+        IQuery<IBaseBundle> query = client.search()\n                 .forResource(resourceClass)\n-                .where(criterion)\n-                .count(config.getResourcesCount())\n+                .where(criteria.get(0));\n+\n+        for (int i = 1; i < criteria.size(); i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 68}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "758d4a09779870d7b48558c0422ed261753dc3d8", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/758d4a09779870d7b48558c0422ed261753dc3d8", "committedDate": "2020-01-28T17:13:23Z", "message": "excludeSAMHSA=true on BFD EOB requests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "056b381077f924c1c65656152bce74ff29c7bf77", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/056b381077f924c1c65656152bce74ff29c7bf77", "committedDate": "2020-01-28T17:13:27Z", "message": "PR changes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "056b381077f924c1c65656152bce74ff29c7bf77", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/056b381077f924c1c65656152bce74ff29c7bf77", "committedDate": "2020-01-28T17:13:27Z", "message": "PR changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NjIyNjI3", "url": "https://github.com/CMSgov/dpc-app/pull/563#pullrequestreview-349622627", "createdAt": "2020-01-28T18:58:23Z", "commit": {"oid": "056b381077f924c1c65656152bce74ff29c7bf77"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 229, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}