{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5NjQ5MjA0", "number": 1019, "title": "DPC-613: Build a basic performance test suite for attribution", "bodyText": "Fixes DPC-613\nIn order to measure our current performance, and prioritize and measure improvements, we need a performance and load test suite for our API.\nProposed Changes\nBegin setting up a performance and load testing suite.\nChange Details\n\nSets up a basic test suite using k6, including:\n\nTwo JavaScript files for testing the /metadata endpoint: one for performance, one for load\nShared /modules/config.js for configuring environment URL\nShell script for running both JS tests via Docker\nREADME.md with instructions to run with or without Docker\n\n\n\nSecurity Implications\nThis is a test suite and makes no changes to our application code.\n\n\n new software dependencies\n\n\n security controls or supporting software altered\n\n\n new data stored or transmitted\n\n\n security checklist is completed for this change\n\n\n requires more information or team discussion to evaluate security implications\n\n\n no PHI/PII is affected by this change\n\n\nAcceptance Validation\nSee README for instructions for running the tests. Sample output below.\n\n\n\nFeedback Requested\nWe can of course make adjustments as our test suite matures, but wondering about things like:\n\nShould the performance tests and load tests run from separate shell scripts?\nHow should we organize the JS files?\nWould it be helpful to have output somewhere other than stdout?", "createdAt": "2020-09-04T12:42:16Z", "url": "https://github.com/CMSgov/dpc-app/pull/1019", "merged": true, "mergeCommit": {"oid": "275edca5b45d5c2612698b039451ee1f1e8989cb"}, "closed": true, "closedAt": "2020-09-04T18:58:26Z", "author": {"login": "em1"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFktONAH2gAyNDc5NjQ5MjA0OmE3ZGFlYzdhZDMzOTA3ODU5NWRjMjQ4NGY2YjkzMDFlM2NlZjEzMDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFphPGAFqTQ4Mjg2Njk1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a7daec7ad339078595dc2484f6b9301e3cef1308", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/a7daec7ad339078595dc2484f6b9301e3cef1308", "committedDate": "2020-09-04T12:52:50Z", "message": "Basic performance and load test setup for metadata endpoint"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "a7daec7ad339078595dc2484f6b9301e3cef1308", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/a7daec7ad339078595dc2484f6b9301e3cef1308", "committedDate": "2020-09-04T12:52:50Z", "message": "Basic performance and load test setup for metadata endpoint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b15b4ad2a5a2a3647a3e6cd31c20dce34e85eab", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/5b15b4ad2a5a2a3647a3e6cd31c20dce34e85eab", "committedDate": "2020-09-04T13:50:20Z", "message": "Note environment options for running outside Docker"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNjY4NTUw", "url": "https://github.com/CMSgov/dpc-app/pull/1019#pullrequestreview-482668550", "createdAt": "2020-09-04T13:50:34Z", "commit": {"oid": "a7daec7ad339078595dc2484f6b9301e3cef1308"}, "state": "DISMISSED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMzo1MDozNVrOHNOUmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMzo1MzoyNFrOHNObFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyODE4Ng==", "bodyText": "This is a pretty picky comment, so feel free to ignore. The name of that script is pretty long. I wonder if dpc-load-test.sh would be descriptive enough? I suppose we could eventually create a make command for it as well.", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483628186", "createdAt": "2020-09-04T13:50:35Z", "author": {"login": "jonfulk"}, "path": "dpc-testing/performance/README.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# Performance and Load Tests\n+\n+DPC performance and load tests use [k6](https://k6.io/).\n+\n+## Running the tests\n+### Shell script\n+The performance and load tests may be run using the script `dpc-perf-load-test.sh`. This will run k6 with Docker. Specify the environment you wish to test by setting the environment variable `ENV`. The options are `docker`, `dev`, `test`, `sandbox`, and `prod`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7daec7ad339078595dc2484f6b9301e3cef1308"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyOTcwMg==", "bodyText": "is local also an option for the shell script, or only with k6?", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483629702", "createdAt": "2020-09-04T13:53:10Z", "author": {"login": "jonfulk"}, "path": "dpc-testing/performance/README.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# Performance and Load Tests\n+\n+DPC performance and load tests use [k6](https://k6.io/).\n+\n+## Running the tests\n+### Shell script\n+The performance and load tests may be run using the script `dpc-perf-load-test.sh`. This will run k6 with Docker. Specify the environment you wish to test by setting the environment variable `ENV`. The options are `docker`, `dev`, `test`, `sandbox`, and `prod`.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyODE4Ng=="}, "originalCommit": {"oid": "a7daec7ad339078595dc2484f6b9301e3cef1308"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyOTg0NA==", "bodyText": "is docker also an option here?", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483629844", "createdAt": "2020-09-04T13:53:24Z", "author": {"login": "jonfulk"}, "path": "dpc-testing/performance/README.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# Performance and Load Tests\n+\n+DPC performance and load tests use [k6](https://k6.io/).\n+\n+## Running the tests\n+### Shell script\n+The performance and load tests may be run using the script `dpc-perf-load-test.sh`. This will run k6 with Docker. Specify the environment you wish to test by setting the environment variable `ENV`. The options are `docker`, `dev`, `test`, `sandbox`, and `prod`.\n+```\n+ENV=docker ./dpc-perf-load-test.sh\n+```\n+\n+### With k6\n+After installing k6, you can run the tests directly. Specify the environment with the flag `-e env={environment}`, and the test script file. The environment options are `local`, `dev`, `test`, `sandbox`, and `prod`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b15b4ad2a5a2a3647a3e6cd31c20dce34e85eab"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "862e403495c82a6c3a60ebae3c2a4c8934020955", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/862e403495c82a6c3a60ebae3c2a4c8934020955", "committedDate": "2020-09-04T14:22:15Z", "message": "Append /api to dev, test, sandbox, and prod base URLs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b32a4a6ceaba4018d3ac649aa2abbaa36590f47", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/2b32a4a6ceaba4018d3ac649aa2abbaa36590f47", "committedDate": "2020-09-04T17:25:02Z", "message": "Tweak VUs and duration in load test, and request duration expectation in performance test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyODY2OTUw", "url": "https://github.com/CMSgov/dpc-app/pull/1019#pullrequestreview-482866950", "createdAt": "2020-09-04T18:29:16Z", "commit": {"oid": "2b32a4a6ceaba4018d3ac649aa2abbaa36590f47"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 377, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}