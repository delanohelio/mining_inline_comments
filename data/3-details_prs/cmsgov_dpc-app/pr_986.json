{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NjIzNjc0", "number": 986, "title": "DPC-389 adding more logs", "bodyText": "Fixes DPC-389\nAdd more logging to see the values in the fields look back is inspecting\nProposed Changes\nMore logs\nChange Details\nMore logs\nSecurity Implications\n\n\n new software dependencies\n\n\n\n security controls or supporting software altered\n\n\n\n new data stored or transmitted\n\n\n\n security checklist is completed for this change\n\n\n\n requires more information or team discussion to evaluate security implications\n\n\n\n no PHI/PII is affected by this change\n\n\nAcceptance Validation\n\n\nFeedback Requested", "createdAt": "2020-08-18T16:59:41Z", "url": "https://github.com/CMSgov/dpc-app/pull/986", "merged": true, "mergeCommit": {"oid": "8d6ae48b966c99300f27ba8c1431ee3bac833fd1"}, "closed": true, "closedAt": "2020-08-18T23:54:05Z", "author": {"login": "MrBilnon"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAKCwnAH2gAyNDY5NjIzNjc0OjdkMDE5MWUxNjg1NmEzNzRmZGQyZmU3YTI3MjFkYTIwYzFmMGYzMTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAP-ToAFqTQ2OTkwNTMwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7d0191e16856a374fdd2fe7a2721da20c1f0f315", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/7d0191e16856a374fdd2fe7a2721da20c1f0f315", "committedDate": "2020-08-18T16:59:18Z", "message": "adding more logs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjU3NjM4", "url": "https://github.com/CMSgov/dpc-app/pull/986#pullrequestreview-469657638", "createdAt": "2020-08-18T17:08:02Z", "commit": {"oid": "7d0191e16856a374fdd2fe7a2721da20c1f0f315"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzowODowMlrOHCd93Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzowODowMlrOHCd93Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1MDE3Mw==", "bodyText": "Should this be careTeam?", "url": "https://github.com/CMSgov/dpc-app/pull/986#discussion_r472350173", "createdAt": "2020-08-18T17:08:02Z", "author": {"login": "em1"}, "path": "dpc-aggregation/src/main/java/gov/cms/dpc/aggregation/service/LookBackServiceImpl.java", "diffHunk": "@@ -75,34 +88,50 @@ public boolean hasClaimWithin(ExplanationOfBenefit explanationOfBenefit, UUID or\n                 && eobContainsProvider\n                 && eobRelatedToOrganization;\n \n-        LOGGER.info(\"LookBack stats eobWithinLookBackLimit {}, eobContainsProvider {}, eobRelatedToOrganization {}, eobMonthsDifference {}, hasClaim {}\",\n+        LOGGER.info(\"LookBack stats eobWithinLookBackLimit={}, eobContainsProvider={}, eobRelatedToOrganization={}, eobMonthsDifference={}, hasClaim={}\",\n                 eobWithinLookBackLimit, eobContainsProvider, eobRelatedToOrganization, lookBackMonthsDifference, hasClaim);\n \n         return hasClaim;\n     }\n \n     private Set<String> extractPractionerNPIs(ExplanationOfBenefit explanationOfBenefit) {\n         Set<String> eobProviderNPIs = new HashSet<>();\n-        Optional.ofNullable(explanationOfBenefit)\n+        Optional<String> providerNPI = Optional.ofNullable(explanationOfBenefit)\n                 .map(ExplanationOfBenefit::getProvider)\n                 .map(Reference::getIdentifier)\n                 .filter(i -> DPCIdentifierSystem.NPPES.getSystem().equals(i.getSystem()))\n                 .map(Identifier::getValue)\n-                .filter(StringUtils::isNotBlank)\n-                .ifPresent(eobProviderNPIs::add);\n+                .filter(StringUtils::isNotBlank);\n+\n+        if (providerNPI.isEmpty()) {\n+            LOGGER.info(\"providerNPI=empty\");\n+        } else {\n+            LOGGER.info(\"providerNPI={}\", providerNPI.get());\n+            eobProviderNPIs.add(providerNPI.get());\n+        }\n \n-        Optional.ofNullable(explanationOfBenefit)\n-                .map(ExplanationOfBenefit::getCareTeam)\n+        Optional<List<ExplanationOfBenefit.CareTeamComponent>> careTeam = Optional.ofNullable(explanationOfBenefit)\n+                .map(ExplanationOfBenefit::getCareTeam);\n+\n+        if (providerNPI.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d0191e16856a374fdd2fe7a2721da20c1f0f315"}, "originalPosition": 62}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjY4NjY0", "url": "https://github.com/CMSgov/dpc-app/pull/986#pullrequestreview-469668664", "createdAt": "2020-08-18T17:22:50Z", "commit": {"oid": "7d0191e16856a374fdd2fe7a2721da20c1f0f315"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzoyMjo1MFrOHCejoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzoyMjo1MFrOHCejow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1OTg0MQ==", "bodyText": "Call \"eobOrganizationID.isPresent()\" before accessing the value.", "url": "https://github.com/CMSgov/dpc-app/pull/986#discussion_r472359841", "createdAt": "2020-08-18T17:22:50Z", "author": {"login": "codeclimate"}, "path": "dpc-aggregation/src/main/java/gov/cms/dpc/aggregation/service/LookBackServiceImpl.java", "diffHunk": "@@ -61,6 +62,18 @@ public boolean hasClaimWithin(ExplanationOfBenefit explanationOfBenefit, UUID or\n \n         Set<String> eobProviderNPIs = extractPractionerNPIs(explanationOfBenefit);\n \n+        if (billingPeriod.isEmpty()) {\n+            LOGGER.info(\"billingPeriod=empty\");\n+        } else {\n+            LOGGER.info(\"billingPeriod={}\", billingPeriod.get());\n+        }\n+\n+        if (eobOrganizationID.isEmpty()) {\n+            LOGGER.info(\"eobOrganizationID=empty\");\n+        } else {\n+            LOGGER.info(\"eobOrganizationID={}\", eobOrganizationID.get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d0191e16856a374fdd2fe7a2721da20c1f0f315"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1OTg0Mg==", "bodyText": "Call \"providerNPI.isPresent()\" before accessing the value.", "url": "https://github.com/CMSgov/dpc-app/pull/986#discussion_r472359842", "createdAt": "2020-08-18T17:22:50Z", "author": {"login": "codeclimate"}, "path": "dpc-aggregation/src/main/java/gov/cms/dpc/aggregation/service/LookBackServiceImpl.java", "diffHunk": "@@ -75,34 +88,50 @@ public boolean hasClaimWithin(ExplanationOfBenefit explanationOfBenefit, UUID or\n                 && eobContainsProvider\n                 && eobRelatedToOrganization;\n \n-        LOGGER.info(\"LookBack stats eobWithinLookBackLimit {}, eobContainsProvider {}, eobRelatedToOrganization {}, eobMonthsDifference {}, hasClaim {}\",\n+        LOGGER.info(\"LookBack stats eobWithinLookBackLimit={}, eobContainsProvider={}, eobRelatedToOrganization={}, eobMonthsDifference={}, hasClaim={}\",\n                 eobWithinLookBackLimit, eobContainsProvider, eobRelatedToOrganization, lookBackMonthsDifference, hasClaim);\n \n         return hasClaim;\n     }\n \n     private Set<String> extractPractionerNPIs(ExplanationOfBenefit explanationOfBenefit) {\n         Set<String> eobProviderNPIs = new HashSet<>();\n-        Optional.ofNullable(explanationOfBenefit)\n+        Optional<String> providerNPI = Optional.ofNullable(explanationOfBenefit)\n                 .map(ExplanationOfBenefit::getProvider)\n                 .map(Reference::getIdentifier)\n                 .filter(i -> DPCIdentifierSystem.NPPES.getSystem().equals(i.getSystem()))\n                 .map(Identifier::getValue)\n-                .filter(StringUtils::isNotBlank)\n-                .ifPresent(eobProviderNPIs::add);\n+                .filter(StringUtils::isNotBlank);\n+\n+        if (providerNPI.isEmpty()) {\n+            LOGGER.info(\"providerNPI=empty\");\n+        } else {\n+            LOGGER.info(\"providerNPI={}\", providerNPI.get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d0191e16856a374fdd2fe7a2721da20c1f0f315"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1OTg0Mw==", "bodyText": "Call \"billingPeriod.isPresent()\" before accessing the value.", "url": "https://github.com/CMSgov/dpc-app/pull/986#discussion_r472359843", "createdAt": "2020-08-18T17:22:50Z", "author": {"login": "codeclimate"}, "path": "dpc-aggregation/src/main/java/gov/cms/dpc/aggregation/service/LookBackServiceImpl.java", "diffHunk": "@@ -61,6 +62,18 @@ public boolean hasClaimWithin(ExplanationOfBenefit explanationOfBenefit, UUID or\n \n         Set<String> eobProviderNPIs = extractPractionerNPIs(explanationOfBenefit);\n \n+        if (billingPeriod.isEmpty()) {\n+            LOGGER.info(\"billingPeriod=empty\");\n+        } else {\n+            LOGGER.info(\"billingPeriod={}\", billingPeriod.get());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d0191e16856a374fdd2fe7a2721da20c1f0f315"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffbb74410f2d207d29be9afa42c26d1f0f85bc3a", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/ffbb74410f2d207d29be9afa42c26d1f0f85bc3a", "committedDate": "2020-08-18T17:41:56Z", "message": "fix field to look at"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5Njg3MDAw", "url": "https://github.com/CMSgov/dpc-app/pull/986#pullrequestreview-469687000", "createdAt": "2020-08-18T17:45:19Z", "commit": {"oid": "ffbb74410f2d207d29be9afa42c26d1f0f85bc3a"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fdac1ce7edfcea3aa14146d520ad37a20598269", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/7fdac1ce7edfcea3aa14146d520ad37a20598269", "committedDate": "2020-08-18T18:10:10Z", "message": "simplify optionals logic"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NzA4NTMy", "url": "https://github.com/CMSgov/dpc-app/pull/986#pullrequestreview-469708532", "createdAt": "2020-08-18T18:15:09Z", "commit": {"oid": "7fdac1ce7edfcea3aa14146d520ad37a20598269"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NzA5MDkz", "url": "https://github.com/CMSgov/dpc-app/pull/986#pullrequestreview-469709093", "createdAt": "2020-08-18T18:15:58Z", "commit": {"oid": "7fdac1ce7edfcea3aa14146d520ad37a20598269"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aea77c3fef996d95b603516150d7d69904bcf07d", "author": {"user": {"login": "dhgreene", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/aea77c3fef996d95b603516150d7d69904bcf07d", "committedDate": "2020-08-18T18:29:02Z", "message": "Merge branch 'master' into DPC-389-add-more-logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a35b6e0d1657fb2e4fc18fc2b02befb018c4d6e", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/2a35b6e0d1657fb2e4fc18fc2b02befb018c4d6e", "committedDate": "2020-08-18T19:45:06Z", "message": "add more logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a0a6889f2927d1be80bf3f374da47780017de5f", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/8a0a6889f2927d1be80bf3f374da47780017de5f", "committedDate": "2020-08-18T20:18:42Z", "message": "fix travis?"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5ad7a6472685015e145d7e88c27f3b755e37418", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/b5ad7a6472685015e145d7e88c27f3b755e37418", "committedDate": "2020-08-18T20:53:45Z", "message": "that didn't fix travis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39da84b5f5d04db72a90389a8a12d9def030fee0", "author": {"user": {"login": "dhgreene", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/39da84b5f5d04db72a90389a8a12d9def030fee0", "committedDate": "2020-08-18T23:27:27Z", "message": "Merge branch 'master' into DPC-389-add-more-logging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5OTA1MzA1", "url": "https://github.com/CMSgov/dpc-app/pull/986#pullrequestreview-469905305", "createdAt": "2020-08-18T23:53:52Z", "commit": {"oid": "39da84b5f5d04db72a90389a8a12d9def030fee0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 357, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}