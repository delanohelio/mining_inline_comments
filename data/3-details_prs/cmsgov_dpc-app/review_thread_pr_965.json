{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NTgzODY0", "number": 965, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo0Mzo1N1rOEXokHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo1Mzo0NVrOEXo1Rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMjE3MzA4OnYy", "diffSide": "RIGHT", "path": "dpc-web/app/controllers/client_tokens_controller.rb", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo0Mzo1N1rOG_h8Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo0Mzo1N1rOG_h8Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI2OTU4Nw==", "bodyText": "Having already tested for a missing parameter, should we remove the if/elsif here?", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469269587", "createdAt": "2020-08-12T13:43:57Z", "author": {"login": "dhgreene"}, "path": "dpc-web/app/controllers/client_tokens_controller.rb", "diffHunk": "@@ -11,9 +11,11 @@ def new\n \n   def create\n     @organization = current_user.organizations.find(params[:organization_id])\n+    return render_error('Must have a label.') if missing_params\n \n     reg_org = @organization.registered_organization\n     manager = ClientTokenManager.new(registered_organization: reg_org)\n+\n     if missing_params", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMjE4NTMxOnYy", "diffSide": "RIGHT", "path": "dpc-web/app/controllers/internal/organizations_controller.rb", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo0Njo0NVrOG_iD9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo0Njo0NVrOG_iD9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3MTU0Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return redirect_to internal_organization_path(@organization)\n          \n          \n            \n                    redirect_to internal_organization_path(@organization)", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469271543", "createdAt": "2020-08-12T13:46:45Z", "author": {"login": "dhgreene"}, "path": "dpc-web/app/controllers/internal/organizations_controller.rb", "diffHunk": "@@ -87,26 +89,33 @@ def add_or_delete\n       @organization = Organization.find(params[:organization_id])\n       @user = user_identify\n \n-      add_delete(params)\n+      if params[:_method] == 'add'\n+        add_user_to_org\n+      elsif params[:_method] == 'delete'\n+        delete_user_from_org\n+      else\n+        return redirect_to internal_organization_path(@organization)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMjIxMTA0OnYy", "diffSide": "RIGHT", "path": "dpc-web/app/controllers/internal/users_controller.rb", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo1MjoyNVrOG_iT5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNDowNjo1NlrOG_i87Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NTYyMA==", "bodyText": "Just double-checking: I don't see @organizations used directly by the view or partial.  What breaks if we don't have this line?", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469275620", "createdAt": "2020-08-12T13:52:25Z", "author": {"login": "dhgreene"}, "path": "dpc-web/app/controllers/internal/users_controller.rb", "diffHunk": "@@ -28,6 +28,7 @@ def update\n         flash[:notice] = 'User successfully updated.'\n         redirect_to internal_user_url(@user)\n       else\n+        @organizations = Organization.all", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI4NjEyNQ==", "bodyText": "It's in the partial _org_search.html.erb with There are <%= @organizations.count %> organizations available.\nIf I delete the line in the controller, I can replace it with Organization.all.", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469286125", "createdAt": "2020-08-12T14:06:56Z", "author": {"login": "Sun-Mountain"}, "path": "dpc-web/app/controllers/internal/users_controller.rb", "diffHunk": "@@ -28,6 +28,7 @@ def update\n         flash[:notice] = 'User successfully updated.'\n         redirect_to internal_user_url(@user)\n       else\n+        @organizations = Organization.all", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NTYyMA=="}, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMjIxNzAzOnYy", "diffSide": "RIGHT", "path": "dpc-web/config/initializers/devise-security.rb", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo1Mzo0NVrOG_iXxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo1Mzo0NVrOG_iXxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NjYxMg==", "bodyText": "The comment no longer seems true . . .", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469276612", "createdAt": "2020-08-12T13:53:45Z", "author": {"login": "dhgreene"}, "path": "dpc-web/config/initializers/devise-security.rb", "diffHunk": "@@ -9,15 +9,15 @@\n \n   # Need 1 char of A-Z, a-z and 0-9\n   config.password_complexity = { digit: 1, lower: 1, symbol: 1, upper: 1 }\n-  \n-  # How many passwords to keep in archives\n+\n+  # How many passwords to keep in archive\n   config.password_archiving_count = 12\n-  \n+\n   # Deny old passwords (true, false, number_of_old_passwords_to_check)\n   # Examples:\n   # config.deny_old_passwords = false # allow old passwords\n   # config.deny_old_passwords = true # will deny all the old passwords\n-  config.deny_old_passwords = 12 # will deny new passwords that matches with the last 12 passwords\n+  config.deny_old_passwords = 12 # will deny new passwords that matches with the last 3 passwords", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 144, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}