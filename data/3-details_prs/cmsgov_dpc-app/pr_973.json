{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3MDYzMjEy", "number": 973, "title": "DPC-445: Check provenance and group providers", "bodyText": "Fixes DPC-445\n\nIt was never required that the practitioner defined in provenance matches the provider in group\nProposed Changes\n\n\nextract the practitioner uuid from provenance header and get the practitioner from attribution\ncompare the practitioner NPI with the group practitioner NPI\n\nChange Details\n\nExtract the UUID of the practitioner from provenance header and get the NPI by calling attribution service and then compare it with the NPI in the group.\nSecurity Implications\n\n\n new software dependencies\n\n\n\n security controls or supporting software altered\n\n\n\n new data stored or transmitted\n\n\n\n security checklist is completed for this change\n\n\n\n requires more information or team discussion to evaluate security implications\n\n\n\n no PHI/PII is affected by this change\n\n\nAcceptance Validation\n\n\nFeedback Requested", "createdAt": "2020-08-12T23:47:26Z", "url": "https://github.com/CMSgov/dpc-app/pull/973", "merged": true, "mergeCommit": {"oid": "296d1f6027ffaa93a99613ace1069105c6066609"}, "closed": true, "closedAt": "2020-08-14T15:38:59Z", "author": {"login": "MrBilnon"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3MswmAH2gAyNDY3MDYzMjEyOmU4ZGMzYjc0MGYwMWFhNjI1NzFiNjFlZTdhMjQwZDY3YjU1MjUyNzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-1FJxgH2gAyNDY3MDYzMjEyOjM3YzY4ZGQxOWU3ODdiNjI3OWEzZmYzMDRiYmRhYzA2NmZlMjkxMzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e8dc3b740f01aa62571b61ee7a240d67b5525275", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/e8dc3b740f01aa62571b61ee7a240d67b5525275", "committedDate": "2020-07-21T20:59:40Z", "message": "check provider in provenence header and group match"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99b553fef276e25f6fa3ed7fdac482622d582297", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/99b553fef276e25f6fa3ed7fdac482622d582297", "committedDate": "2020-07-22T04:57:26Z", "message": "add test when provenance practitioner doesn't match group practitioner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92f8c7f4da5510b41437faa64060067e5c127f62", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/92f8c7f4da5510b41437faa64060067e5c127f62", "committedDate": "2020-07-22T05:00:47Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d98f3f4d884b8c54e90f82e38cb5025f55ecc62", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/1d98f3f4d884b8c54e90f82e38cb5025f55ecc62", "committedDate": "2020-07-27T15:25:56Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b70654a71666a67c25c4d9da553d3f747218419", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/0b70654a71666a67c25c4d9da553d3f747218419", "committedDate": "2020-07-29T15:46:11Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9db55a9a6e784e8f6fc5ce2b6eee39475a1978f3", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/9db55a9a6e784e8f6fc5ce2b6eee39475a1978f3", "committedDate": "2020-08-02T04:54:09Z", "message": "change status code to 422"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3ff9b77985b011359652d425d09d9e0abf91796", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/d3ff9b77985b011359652d425d09d9e0abf91796", "committedDate": "2020-08-02T04:54:19Z", "message": "Merge remote-tracking branch 'origin/wh/DPC-445-check-provenence-and-group-providers' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbe5b31d5eb8a43873c40b132d6000b5d19fc471", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/fbe5b31d5eb8a43873c40b132d6000b5d19fc471", "committedDate": "2020-08-02T04:54:44Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3200e8723870e4a93dbd5b9d544df602d90c3032", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/3200e8723870e4a93dbd5b9d544df602d90c3032", "committedDate": "2020-08-03T15:34:51Z", "message": "change to constant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f69190aaa458100dc73981296b705124e4eaeb4", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/5f69190aaa458100dc73981296b705124e4eaeb4", "committedDate": "2020-08-06T14:00:27Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d70aa704429a22db877ecaf7c8fb6ae40102785", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/6d70aa704429a22db877ecaf7c8fb6ae40102785", "committedDate": "2020-08-06T15:51:18Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12de3a48de9b7150e2b4802ecdc169e5f168cdd3", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/12de3a48de9b7150e2b4802ecdc169e5f168cdd3", "committedDate": "2020-08-12T02:14:24Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5db4c3ecf1e1a9dc80a0a2092d4a126ec8bc1ea6", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/5db4c3ecf1e1a9dc80a0a2092d4a126ec8bc1ea6", "committedDate": "2020-08-12T17:19:31Z", "message": "fix unit tests for creating roster with header matching"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02b6250616cd8fc96a7fdd7d0ded6d28e75a3e66", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/02b6250616cd8fc96a7fdd7d0ded6d28e75a3e66", "committedDate": "2020-08-12T17:21:39Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f48dcfc09b7fbdc201bd2d50f8560b319aebe3d9", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/f48dcfc09b7fbdc201bd2d50f8560b319aebe3d9", "committedDate": "2020-08-12T23:46:27Z", "message": "fix smoke tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7e380dfd183e8a7ec1dfdb3549e09ed18135d81", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/c7e380dfd183e8a7ec1dfdb3549e09ed18135d81", "committedDate": "2020-08-12T23:49:02Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bff349aab88b4fc7f148d7de0767da5d7a2ce38", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/6bff349aab88b4fc7f148d7de0767da5d7a2ce38", "committedDate": "2020-08-12T23:52:07Z", "message": "remove system.out"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f542813c15eda1f58f128b70bfa0dad6feab1554", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/f542813c15eda1f58f128b70bfa0dad6feab1554", "committedDate": "2020-08-12T23:52:17Z", "message": "Merge remote-tracking branch 'origin/wh/DPC-445-check-provenence-and-group-providers' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MzY4MTM3", "url": "https://github.com/CMSgov/dpc-app/pull/973#pullrequestreview-466368137", "createdAt": "2020-08-13T00:36:10Z", "commit": {"oid": "f542813c15eda1f58f128b70bfa0dad6feab1554"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwMDozNjoxMFrOG_3t9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwMDozNjoxMVrOG_3t-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYyNjM1OA==", "bodyText": "Method createRosterSubmission has 5 arguments (exceeds 4 allowed). Consider refactoring.", "url": "https://github.com/CMSgov/dpc-app/pull/973#discussion_r469626358", "createdAt": "2020-08-13T00:36:10Z", "author": {"login": "codeclimate"}, "path": "dpc-smoketest/src/main/java/gov/cms/dpc/testing/smoketests/ClientUtils.java", "diffHunk": "@@ -96,10 +96,16 @@ static void handleExportJob(IGenericClient exportClient, List<String> providerNP\n      * @param patientReferences - {@link Map} of patient's associated to a given provider\n      * @throws IOException - throws if unable to read the file\n      */\n-    private static void createRosterSubmission(IGenericClient client, InputStream resource, UUID organizationID, Map<String, Reference> patientReferences) throws IOException {\n+    private static void createRosterSubmission(IGenericClient client, InputStream resource, Bundle providerBundle, UUID organizationID, Map<String, Reference> patientReferences) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f542813c15eda1f58f128b70bfa0dad6feab1554"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYyNjM2MQ==", "bodyText": "Method createAndUploadRosters has 5 arguments (exceeds 4 allowed). Consider refactoring.", "url": "https://github.com/CMSgov/dpc-app/pull/973#discussion_r469626361", "createdAt": "2020-08-13T00:36:11Z", "author": {"login": "codeclimate"}, "path": "dpc-smoketest/src/main/java/gov/cms/dpc/testing/smoketests/ClientUtils.java", "diffHunk": "@@ -294,28 +300,20 @@ private static JobCompletionModel jobCompletionLambda(IGenericClient exportClien\n         return patientReferences;\n     }\n \n-    static List<String> submitPractitioners(String providerBundleFilename, Class<?> baseClass, FhirContext ctx, IGenericClient exportClient) throws IOException {\n+    static Bundle submitPractitioners(String providerBundleFilename, Class<?> baseClass, FhirContext ctx, IGenericClient exportClient) throws IOException {\n         final Bundle providerBundle;\n \n         System.out.println(\"Submitting practitioners\");\n         providerBundle = bundleSubmitter(baseClass, Practitioner.class, providerBundleFilename, ctx.newJsonParser(), exportClient);\n \n-        // Get the provider NPIs\n-        return providerBundle\n-                .getEntry()\n-                .stream()\n-                .map(Bundle.BundleEntryComponent::getResource)\n-                .map(resource -> (Practitioner) resource)\n-                .map(FHIRExtractors::getProviderNPI)\n-                .collect(Collectors.toList());\n+        return providerBundle;\n     }\n \n-    static void createAndUploadRosters(String seedsFile, IGenericClient client, UUID organizationID, Map<String, Reference> patientReferences) throws IOException {\n+    static void createAndUploadRosters(String seedsFile, Bundle providerBundle, IGenericClient client, UUID organizationID, Map<String, Reference> patientReferences) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f542813c15eda1f58f128b70bfa0dad6feab1554"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2OTkzNjcx", "url": "https://github.com/CMSgov/dpc-app/pull/973#pullrequestreview-466993671", "createdAt": "2020-08-13T17:42:36Z", "commit": {"oid": "f542813c15eda1f58f128b70bfa0dad6feab1554"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3604b407acaef65afeccb2ae348ea4250294d28a", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/3604b407acaef65afeccb2ae348ea4250294d28a", "committedDate": "2020-08-13T17:53:21Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7661c55a048ca6e043bce3d7f45e992ef12ddd49", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/7661c55a048ca6e043bce3d7f45e992ef12ddd49", "committedDate": "2020-08-13T20:07:49Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37c68dd19e787b6279a3ff304bbdac066fe29139", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/37c68dd19e787b6279a3ff304bbdac066fe29139", "committedDate": "2020-08-14T13:59:59Z", "message": "Merge branch 'master' into wh/DPC-445-check-provenence-and-group-providers"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 474, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}