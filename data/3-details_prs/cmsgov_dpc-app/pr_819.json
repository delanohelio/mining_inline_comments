{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzODE3MDc3", "number": 819, "title": "DPC-333: Update the website to request snippets of encrypted data from users to validate public keys", "bodyText": "REVIEW AFTER DPC-335 HAS BEEN MERGED\nWhy\nAC: On the public keys screen, create a field for the user to submit a snippet of data encrypted by their public key. Work with the API engineer also assigned to this story to define what that snippet should include and work with the H team to add instructions to the webpage\nUsing Crystal's design, the page now walks users through the creation of private and public keys and the signature snippet.\nWhat Changed\nPaired with DPC-335, external users can enter the required signature to verify their public key.\nChoices Made\n\n\nTickets closed:\nDPC-333 - Update the website to request snippets of encrypted data from users to validate public keys\nDPC-337 - Parse public key errors\nFuture Work\nTo successfully create a signature for the public key, the user will need a text file with This is the snippet used to verify a key pair in DPC. inside of it. <-- something to consider when talking thru the steps to create a key/signature pair. @EmBh suggested that we provide them with the text file. Not sure when we would do that.\nChecklist\n\n All tests are passing via make ci-app (app change) and make ci-web (website change)\n[/] Swagger documentation has been updated\n[/] FHIR documentation has been updated\n[/] Any required dpc-ops changes have a PR submitted and mentioned in this ticket\n[/] Any manual migration steps are documented, scripts written (where applicable), and tested\n[/] Before merging, any required dpc-ops changes have been approved and merged into master of the dpc-ops repo", "createdAt": "2020-05-27T12:28:54Z", "url": "https://github.com/CMSgov/dpc-app/pull/819", "merged": true, "mergeCommit": {"oid": "254ef91c469f2594f2c66125e6def251cd827932"}, "closed": true, "closedAt": "2020-06-09T15:36:49Z", "author": {"login": "Sun-Mountain"}, "timelineItems": {"totalCount": 66, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABci4FIqAH2gAyNDIzODE3MDc3OjZjYzRlODUxNjNhNWFhYzlkMTc5ZjNkYzRiOWI3NmQyM2QxYmYzMGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpmu22gFqTQyNzI3Nzk3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6cc4e85163a5aac9d179f3dc4b9b76d23d1bf30d", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/6cc4e85163a5aac9d179f3dc4b9b76d23d1bf30d", "committedDate": "2020-05-19T17:39:48Z", "message": "Groundwork for snippet_signature to be passed to the API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c1c50d9d064dadd1356236b907e57e4760ff895", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/2c1c50d9d064dadd1356236b907e57e4760ff895", "committedDate": "2020-05-19T20:41:11Z", "message": "Public key/signature verification in progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ed99d348c52e66216e9cea0bfb036237197d998", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/0ed99d348c52e66216e9cea0bfb036237197d998", "committedDate": "2020-05-21T15:53:23Z", "message": "Accept key and signature as JSON"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7199f8122c1d1c2624ec6f62053d725157bebef4", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/7199f8122c1d1c2624ec6f62053d725157bebef4", "committedDate": "2020-05-21T16:31:42Z", "message": "Accept signature with CLI key creation; skip ECC tests temporarily"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "068fb97817bea1fa987f8edb91e61715a6fec42a", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/068fb97817bea1fa987f8edb91e61715a6fec42a", "committedDate": "2020-05-21T17:39:25Z", "message": "Change public key to json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cfab9b9bb839aa9557cff3c6160057d987a959a", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/2cfab9b9bb839aa9557cff3c6160057d987a959a", "committedDate": "2020-05-22T14:42:31Z", "message": "Update public key to json format\n\npost_text_request now submits json public key that includes label, public key, and signature snippet.\n\nudpated tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44029d0cbbfcae757b29224e23c0454aad57c15a", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/44029d0cbbfcae757b29224e23c0454aad57c15a", "committedDate": "2020-05-22T16:45:19Z", "message": "save"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4cd0c7e7b343b7bab1a4663f30feae9401d4d15", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/e4cd0c7e7b343b7bab1a4663f30feae9401d4d15", "committedDate": "2020-05-22T20:51:18Z", "message": "CLI test fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "873ea4868cf9cf9918d4ff64198a682b9f9e3557", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/873ea4868cf9cf9918d4ff64198a682b9f9e3557", "committedDate": "2020-05-26T13:56:24Z", "message": "Save progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "599377637526d9f3b7b7f55f8a7ca0aeae3abc82", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/599377637526d9f3b7b7f55f8a7ca0aeae3abc82", "committedDate": "2020-05-26T14:00:35Z", "message": "Merge branch 'master' into nzonnenberg/dpc-333-encrypted-pubkey-form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f2f4be305e705e9c8ca4be7b6587961beeb5f91", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/6f2f4be305e705e9c8ca4be7b6587961beeb5f91", "committedDate": "2020-05-26T15:06:50Z", "message": "Merge branch 'emily/dpc-335-verify-signature' into nzonnenberg/dpc-333-encrypted-pubkey-form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7f3e6d2273bf4e96fad05b5251aafc7f4e4d55d", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/a7f3e6d2273bf4e96fad05b5251aafc7f4e4d55d", "committedDate": "2020-05-26T15:21:10Z", "message": "remove files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e8da15907ea93e807be1daf4102cbc67a2d9d37", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/1e8da15907ea93e807be1daf4102cbc67a2d9d37", "committedDate": "2020-05-26T17:44:38Z", "message": "Public key/signature verification in progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56a8525453c4e3a4a6166215b81c5f78c93585ad", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/56a8525453c4e3a4a6166215b81c5f78c93585ad", "committedDate": "2020-05-26T17:44:38Z", "message": "Accept key and signature as JSON"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8befc4cc6218dec9f99f7b5a6a1adf5533cc3217", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/8befc4cc6218dec9f99f7b5a6a1adf5533cc3217", "committedDate": "2020-05-26T17:44:38Z", "message": "Accept signature with CLI key creation; skip ECC tests temporarily"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d915e47875cf231d65d701215ffbbe29d8d74c4a", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/d915e47875cf231d65d701215ffbbe29d8d74c4a", "committedDate": "2020-05-26T17:44:38Z", "message": "CLI test fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2b1137fd21b846a708e4e80fccfba43e1db0901", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/b2b1137fd21b846a708e4e80fccfba43e1db0901", "committedDate": "2020-05-26T17:44:38Z", "message": "Address Code Climate exception message issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ee0ca4312f0cbaaa8000815849af64805ad6f92", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/3ee0ca4312f0cbaaa8000815849af64805ad6f92", "committedDate": "2020-05-26T17:44:38Z", "message": "Reject ECC keys (temporarily); testing cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9777db762fd6c7f660d9a2326e75273a364573a9", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/9777db762fd6c7f660d9a2326e75273a364573a9", "committedDate": "2020-05-26T18:51:58Z", "message": "merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7854286d9a3f9faf5d37d742ea7520db118e2f0", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/d7854286d9a3f9faf5d37d742ea7520db118e2f0", "committedDate": "2020-05-26T20:02:59Z", "message": "save"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MTYxNTcz", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-419161573", "createdAt": "2020-05-27T12:48:07Z", "commit": {"oid": "d7854286d9a3f9faf5d37d742ea7520db118e2f0"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMjo0ODowN1rOGbHqFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxMjo0ODowOFrOGbHqJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA5MDE5OA==", "bodyText": "Method uploadKey has 5 arguments (exceeds 4 allowed). Consider refactoring.", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r431090198", "createdAt": "2020-05-27T12:48:07Z", "author": {"login": "codeclimate"}, "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyUpload.java", "diffHunk": "@@ -59,25 +70,31 @@ public void run(Bootstrap<?> bootstrap, Namespace namespace) throws Exception {\n         System.out.println(String.format(\"Connecting to API service at: %s\", apiService));\n \n         // Read the file and parse it\n-        final Path filePath = FileSystems.getDefault().getPath(namespace.getString(KEY_FILE));\n-        final String pemFile = Files.readString(filePath);\n+        final Path keyFilePath = FileSystems.getDefault().getPath(namespace.getString(KEY_FILE));\n+        final String publicKey = Files.readString(keyFilePath);\n+\n+        final Path signaturePath = FileSystems.getDefault().getPath(namespace.getString(SIGNATURE_FILE));\n+        final String signature = Files.readString(signaturePath);\n \n         final Optional<String> label = Optional.ofNullable(namespace.getString(\"key-label\"));\n-        uploadKey(apiService, orgID.getIdPart(), label, pemFile);\n+        uploadKey(apiService, orgID.getIdPart(), label, publicKey, signature);\n     }\n \n     @SuppressWarnings(\"OptionalUsedAsFieldOrParameterType\")\n-    private void uploadKey(String apiService, String orgID, Optional<String> label, String pem) throws IOException, URISyntaxException {\n+    private void uploadKey(String apiService, String orgID, Optional<String> label, String pem, String signature) throws IOException, URISyntaxException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7854286d9a3f9faf5d37d742ea7520db118e2f0"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA5MDIwNA==", "bodyText": "Line is too long. [149/120]", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r431090204", "createdAt": "2020-05-27T12:48:08Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/controllers/public_keys_controller.rb", "diffHunk": "@@ -15,7 +15,7 @@ def create\n     reg_org = @organization.registered_organizations.find_by(api_env: params[:api_environment])\n     manager = PublicKeyManager.new(api_env: params[:api_environment], registered_organization: reg_org)\n \n-    new_public_key = manager.create_public_key(public_key: params[:public_key], label: params[:label])\n+    new_public_key = manager.create_public_key(public_key: params[:public_key], label: params[:label], snippet_signature: params[:snippet_signature])", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7854286d9a3f9faf5d37d742ea7520db118e2f0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA5MDIxMA==", "bodyText": "Line is too long. [152/120]", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r431090210", "createdAt": "2020-05-27T12:48:08Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/services/public_key_manager.rb", "diffHunk": "@@ -9,15 +9,16 @@ def initialize(api_env:, registered_organization:)\n     @errors = []\n   end\n \n-  def create_public_key(public_key:, label:)\n+  def create_public_key(public_key:, label:, snippet_signature:)\n     public_key = strip_carriage_returns(public_key)\n+\n     if invalid_encoding?(public_key)\n       return { response: false,\n                message: @errors[0] }\n     end\n \n     api_client = APIClient.new(api_env)\n-    api_client.create_public_key(registered_organization.api_id, params: { label: label, public_key: public_key })\n+    api_client.create_public_key(registered_organization.api_id, params: { label: label, public_key: public_key, snippet_signature: snippet_signature })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7854286d9a3f9faf5d37d742ea7520db118e2f0"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA5MDIxNA==", "bodyText": "Don't use parentheses around a literal.", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r431090214", "createdAt": "2020-05-27T12:48:08Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/services/api_client.rb", "diffHunk": "@@ -61,9 +61,14 @@ def get_client_tokens(reg_org_api_id)\n   def create_public_key(reg_org_api_id, params: {})\n     uri_string = base_url + '/Key'\n \n+    json = ({", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7854286d9a3f9faf5d37d742ea7520db118e2f0"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "892f4a88e97d399ac3f713ee07de91c345cfe9ab", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/892f4a88e97d399ac3f713ee07de91c345cfe9ab", "committedDate": "2020-05-28T12:46:03Z", "message": "Public key/signature verification in progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26da4a0e20dd3c03607e4acbcce127e8593f6f18", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/26da4a0e20dd3c03607e4acbcce127e8593f6f18", "committedDate": "2020-05-28T12:46:06Z", "message": "Accept key and signature as JSON"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d5a033bcdef7e18a7ea8f5c6fed0eb73bb323b2", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/9d5a033bcdef7e18a7ea8f5c6fed0eb73bb323b2", "committedDate": "2020-05-28T12:46:06Z", "message": "Accept signature with CLI key creation; skip ECC tests temporarily"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3b9016b04448554c3edb2786b547193f05bd2ac", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/f3b9016b04448554c3edb2786b547193f05bd2ac", "committedDate": "2020-05-28T12:46:06Z", "message": "CLI test fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7ac73fc59ddc9dca74a86c1c20885b0365a9ac8", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/d7ac73fc59ddc9dca74a86c1c20885b0365a9ac8", "committedDate": "2020-05-28T12:46:07Z", "message": "Address Code Climate exception message issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe2f4699a26feed6bad99bd213421d9a76614f5f", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/fe2f4699a26feed6bad99bd213421d9a76614f5f", "committedDate": "2020-05-28T12:46:07Z", "message": "Reject ECC keys (temporarily); testing cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "742e9a367a243c9aab1d80ddf20d967fbda66630", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/742e9a367a243c9aab1d80ddf20d967fbda66630", "committedDate": "2020-05-28T14:57:32Z", "message": "Merge branch 'emily/dpc-335-verify-signature' of github.com:CMSgov/dpc-app into emily/dpc-335-verify-signature"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "334b91e04d4c15ec69605f15015c106c95eb39c2", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/334b91e04d4c15ec69605f15015c106c95eb39c2", "committedDate": "2020-05-28T14:58:03Z", "message": "Merge branch 'emily/dpc-335-verify-signature' into nzonnenberg/dpc-333-encrypted-pubkey-form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e09e9a0f69f40a2200c7f1984af30e858d8b3124", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/e09e9a0f69f40a2200c7f1984af30e858d8b3124", "committedDate": "2020-05-28T15:09:48Z", "message": "Code climate fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38de5015e141068b31f1bf5987eb5af14da7ff15", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/38de5015e141068b31f1bf5987eb5af14da7ff15", "committedDate": "2020-05-28T15:16:06Z", "message": "Adjustment for Code Climate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjMzMTEw", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-420233110", "createdAt": "2020-05-28T15:31:07Z", "commit": {"oid": "e09e9a0f69f40a2200c7f1984af30e858d8b3124"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNTozMTowN1rOGb60EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNTozMTowN1rOGb60FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTkyODMzNg==", "bodyText": "Closing method call brace must be on the line after the last argument when opening brace is on a separate line from the first argument.", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r431928336", "createdAt": "2020-05-28T15:31:07Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/services/public_key_manager.rb", "diffHunk": "@@ -9,15 +9,22 @@ def initialize(api_env:, registered_organization:)\n     @errors = []\n   end\n \n-  def create_public_key(public_key:, label:)\n+  def create_public_key(public_key:, label:, snippet_signature:)\n     public_key = strip_carriage_returns(public_key)\n+\n     if invalid_encoding?(public_key)\n       return { response: false,\n                message: @errors[0] }\n     end\n \n     api_client = APIClient.new(api_env)\n-    api_client.create_public_key(registered_organization.api_id, params: { label: label, public_key: public_key })\n+    api_client.create_public_key(\n+      registered_organization.api_id, \n+      params: {\n+        label: label,\n+        public_key: public_key,\n+        snippet_signature: snippet_signature\n+      })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e09e9a0f69f40a2200c7f1984af30e858d8b3124"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTkyODM0MA==", "bodyText": "Trailing whitespace detected.", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r431928340", "createdAt": "2020-05-28T15:31:07Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/services/public_key_manager.rb", "diffHunk": "@@ -9,15 +9,22 @@ def initialize(api_env:, registered_organization:)\n     @errors = []\n   end\n \n-  def create_public_key(public_key:, label:)\n+  def create_public_key(public_key:, label:, snippet_signature:)\n     public_key = strip_carriage_returns(public_key)\n+\n     if invalid_encoding?(public_key)\n       return { response: false,\n                message: @errors[0] }\n     end\n \n     api_client = APIClient.new(api_env)\n-    api_client.create_public_key(registered_organization.api_id, params: { label: label, public_key: public_key })\n+    api_client.create_public_key(\n+      registered_organization.api_id, ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e09e9a0f69f40a2200c7f1984af30e858d8b3124"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f288e88e8e7962efee41bb4beb144ae71615357a", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/f288e88e8e7962efee41bb4beb144ae71615357a", "committedDate": "2020-05-28T15:35:14Z", "message": "Rspec test fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjYxNDAy", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-420261402", "createdAt": "2020-05-28T15:59:19Z", "commit": {"oid": "f288e88e8e7962efee41bb4beb144ae71615357a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNTo1OToxOVrOGb8BYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNTo1OToxOVrOGb8BYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk0ODEzMQ==", "bodyText": "Method has too many lines. [16/15]", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r431948131", "createdAt": "2020-05-28T15:59:19Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/services/public_key_manager.rb", "diffHunk": "@@ -9,15 +9,23 @@ def initialize(api_env:, registered_organization:)\n     @errors = []\n   end\n \n-  def create_public_key(public_key:, label:)\n+  def create_public_key(public_key:, label:, snippet_signature:)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f288e88e8e7962efee41bb4beb144ae71615357a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "930541c5d941bb8a34b0cbc537925db3a5f8b031", "author": {"user": {"login": "em1", "name": null}}, "url": "https://github.com/CMSgov/dpc-app/commit/930541c5d941bb8a34b0cbc537925db3a5f8b031", "committedDate": "2020-05-28T21:32:43Z", "message": "Change verifySignature() to throw an exception rather than returning false, to be consistent with other methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "820763eeed612038965b5ff951dfce86d904f433", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/820763eeed612038965b5ff951dfce86d904f433", "committedDate": "2020-05-29T12:39:07Z", "message": "Merge branch 'emily/dpc-335-verify-signature' of github.com:CMSgov/dpc-app into emily/dpc-335-verify-signature"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a4df774abbf6b4be207795cd78be2db377d6128", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/4a4df774abbf6b4be207795cd78be2db377d6128", "committedDate": "2020-05-29T12:41:19Z", "message": "Merge branch 'emily/dpc-335-verify-signature' into nzonnenberg/dpc-333-encrypted-pubkey-form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ff55536dfcf01bd1c0c954e96cd01dc2fc9355a", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/3ff55536dfcf01bd1c0c954e96cd01dc2fc9355a", "committedDate": "2020-05-29T16:31:39Z", "message": "Update snippet field"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMTIyNzQ5", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-421122749", "createdAt": "2020-05-29T16:52:23Z", "commit": {"oid": "3ff55536dfcf01bd1c0c954e96cd01dc2fc9355a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNjo1MjoyM1rOGckhkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNjo1MjoyM1rOGckhkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYxMTcyOA==", "bodyText": "Method has too many lines. [17/15]", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r432611728", "createdAt": "2020-05-29T16:52:23Z", "author": {"login": "codeclimate"}, "path": "dpc-web/app/services/public_key_manager.rb", "diffHunk": "@@ -9,15 +9,24 @@ def initialize(api_env:, registered_organization:)\n     @errors = []\n   end\n \n-  def create_public_key(public_key:, label:)\n+  def create_public_key(public_key:, label:, snippet_signature:)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ff55536dfcf01bd1c0c954e96cd01dc2fc9355a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ab3a422d80ad0608fdac667cc417cff7b916568", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/7ab3a422d80ad0608fdac667cc417cff7b916568", "committedDate": "2020-05-29T18:39:04Z", "message": "code climate fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0806cd2a18639972c5beb05b75927ddfabc62785", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/0806cd2a18639972c5beb05b75927ddfabc62785", "committedDate": "2020-05-29T18:51:34Z", "message": "Code climate fix 2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb1e83d579f4fa7e77db128c1e969fdc0f318573", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/cb1e83d579f4fa7e77db128c1e969fdc0f318573", "committedDate": "2020-05-29T18:54:17Z", "message": "code climate 3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccff5027dd040a82fd247ad0cc24299b70cb1a09", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/ccff5027dd040a82fd247ad0cc24299b70cb1a09", "committedDate": "2020-06-04T13:38:53Z", "message": "Merge branch 'master' into nzonnenberg/dpc-333-encrypted-pubkey-form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d0c721cec5cf4e937860d162e025bf6cfa7e57a", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/7d0c721cec5cf4e937860d162e025bf6cfa7e57a", "committedDate": "2020-06-04T14:54:54Z", "message": "Language rough draft"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fce080ce4c9d28bdcc3330f2ec30ce0cba3bb5d9", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/fce080ce4c9d28bdcc3330f2ec30ce0cba3bb5d9", "committedDate": "2020-06-04T14:55:10Z", "message": "Merge branch 'nzonnenberg/dpc-333-encrypted-pubkey-form' of github.com:CMSgov/dpc-app into nzonnenberg/dpc-333-encrypted-pubkey-form"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71057101aeb5f5c1c582ac34ce51e7dfc8d4dfd1", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/71057101aeb5f5c1c582ac34ce51e7dfc8d4dfd1", "committedDate": "2020-06-08T13:11:23Z", "message": "Add snippet.txt file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81cbc39da71df80bc855c79eee92179a70ffa83e", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/81cbc39da71df80bc855c79eee92179a70ffa83e", "committedDate": "2020-06-08T14:13:24Z", "message": "Download snippet.txt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d9ab28bc3ade3eee90e2d9d5ba68a9960871fab", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/3d9ab28bc3ade3eee90e2d9d5ba68a9960871fab", "committedDate": "2020-06-08T18:10:13Z", "message": "Styling progress save"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a16f1b7c5b80ecaccea3f1da9e53d6a5b8603cb7", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/a16f1b7c5b80ecaccea3f1da9e53d6a5b8603cb7", "committedDate": "2020-06-08T18:47:26Z", "message": "Styling progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de8b22986e5eb877df2a095214cb6bc74af176ef", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/de8b22986e5eb877df2a095214cb6bc74af176ef", "committedDate": "2020-06-08T19:46:01Z", "message": "Styling progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a07147bab0cadcac9f77c8d750010ccf16eebe7", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/6a07147bab0cadcac9f77c8d750010ccf16eebe7", "committedDate": "2020-06-08T20:21:21Z", "message": "Adding snippet download"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a325dbf0332e328b78f04aef5879e350f6529912", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/a325dbf0332e328b78f04aef5879e350f6529912", "committedDate": "2020-06-08T20:45:18Z", "message": "Styling progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bd9b3299a49956a3912ef1e652dc93d67ec7e48", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/1bd9b3299a49956a3912ef1e652dc93d67ec7e48", "committedDate": "2020-06-09T11:31:53Z", "message": "Styling progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d963ee5533890160fbe56e88c25744130ca98e8", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/0d963ee5533890160fbe56e88c25744130ca98e8", "committedDate": "2020-06-09T11:56:45Z", "message": "Styling progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f763e21279b695664a32ec48c68f38c1e96830fa", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/f763e21279b695664a32ec48c68f38c1e96830fa", "committedDate": "2020-06-09T12:11:28Z", "message": "Styling progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd9f044ed9069a11cae049800b7044b9d27456aa", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/fd9f044ed9069a11cae049800b7044b9d27456aa", "committedDate": "2020-06-09T12:49:35Z", "message": "download snippet fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8305bb762d3eee3314a148b3e0cab1c21a494b6", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/d8305bb762d3eee3314a148b3e0cab1c21a494b6", "committedDate": "2020-06-09T13:08:02Z", "message": "Styling progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1a2e39dd36ba0eef182ffb39ea6453353a543c0", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/e1a2e39dd36ba0eef182ffb39ea6453353a543c0", "committedDate": "2020-06-09T13:11:48Z", "message": "Styling progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e3b41ff064b368effb3cdd3d2fb269996edf7d0", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/7e3b41ff064b368effb3cdd3d2fb269996edf7d0", "committedDate": "2020-06-09T13:30:43Z", "message": "Deleted old public key page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fd145154e6af187821672de74be94032c9f1be9", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/0fd145154e6af187821672de74be94032c9f1be9", "committedDate": "2020-06-09T13:49:24Z", "message": "Styling update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MTcxMTIw", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-427171120", "createdAt": "2020-06-09T13:50:53Z", "commit": {"oid": "7e3b41ff064b368effb3cdd3d2fb269996edf7d0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMzo1MDo1M1rOGhK-qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMzo1MDo1M1rOGhK-qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQzNjA3NQ==", "bodyText": "Are we using application/zip to avoid encoding problems?  Have we tested what that does in various browsers/OS's?", "url": "https://github.com/CMSgov/dpc-app/pull/819#discussion_r437436075", "createdAt": "2020-06-09T13:50:53Z", "author": {"login": "dhgreene"}, "path": "dpc-web/app/controllers/public_keys_controller.rb", "diffHunk": "@@ -24,6 +29,10 @@ def create\n     end\n   end\n \n+  def download_snippet\n+    send_file 'public/snippet.txt', type: 'application/zip', status: 202", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e3b41ff064b368effb3cdd3d2fb269996edf7d0"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fcb9ca178fa8b452aa8deb3390071ee400817b7", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/7fcb9ca178fa8b452aa8deb3390071ee400817b7", "committedDate": "2020-06-09T13:56:42Z", "message": "Merge branch 'master' into nzonnenberg/dpc-333-encrypted-pubkey-form"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MTg1NDk5", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-427185499", "createdAt": "2020-06-09T14:04:44Z", "commit": {"oid": "7fcb9ca178fa8b452aa8deb3390071ee400817b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MTk5NTc1", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-427199575", "createdAt": "2020-06-09T14:18:31Z", "commit": {"oid": "7fcb9ca178fa8b452aa8deb3390071ee400817b7"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MjA3MTcz", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-427207173", "createdAt": "2020-06-09T14:25:47Z", "commit": {"oid": "7fcb9ca178fa8b452aa8deb3390071ee400817b7"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3Mjc3OTcw", "url": "https://github.com/CMSgov/dpc-app/pull/819#pullrequestreview-427277970", "createdAt": "2020-06-09T15:24:33Z", "commit": {"oid": "7fcb9ca178fa8b452aa8deb3390071ee400817b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 146, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}