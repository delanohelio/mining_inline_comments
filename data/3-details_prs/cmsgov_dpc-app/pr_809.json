{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwNTAwMzk1", "number": 809, "title": "fix smoke tests", "bodyText": "Why\nSmoke tests are broken\nWhat Changed\nGenerate a random NPI as it is a unique key constraint on the org table and also change one of the files that provides patient/provider pair to providers that are uploaded by the smoke test\nChoices Made\nJustify changes made and any reasons for why a given path was taken, as opposed to an alternative option.\nTickets closed:\nGive a list of tickets closed in this PR.\nFuture Work\nList any additional tickets that have either been created due to work in this PR, or existing tickets that expand upon the feature or provide additional fixes.\nChecklist\n\n All tests are passing via make ci-app (app change) and make ci-web (website change)\n Swagger documentation has been updated\n FHIR documentation has been updated\n Any required dpc-ops changes have a PR submitted and mentioned in this ticket\n Any manual migration steps are documented, scripts written (where applicable), and tested\n Before merging, any required dpc-ops changes have been approved and merged into master of the dpc-ops repo", "createdAt": "2020-05-20T04:36:09Z", "url": "https://github.com/CMSgov/dpc-app/pull/809", "merged": true, "mergeCommit": {"oid": "016c6287d6f03806540b8be9d2fb83c0813f931c"}, "closed": true, "closedAt": "2020-05-21T21:59:34Z", "author": {"login": "MrBilnon"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjBZsWAH2gAyNDIwNTAwMzk1Ojg2Y2QxYmYzYjllZjkyZTEyMzY0Y2VkMDU0MTM3NWQ5ZWMxMDNlNGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjjUxkAH2gAyNDIwNTAwMzk1OmUzM2E4NTRkNGY0YzAyNzk2NGE2NDU2MzY1YzU2MmZiMjM3MmNjOWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "86cd1bf3b9ef92e12364ced0541375d9ec103e4a", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/86cd1bf3b9ef92e12364ced0541375d9ec103e4a", "committedDate": "2020-05-20T04:31:24Z", "message": "fix smoke tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MzIxMDI4", "url": "https://github.com/CMSgov/dpc-app/pull/809#pullrequestreview-415321028", "createdAt": "2020-05-20T13:16:05Z", "commit": {"oid": "86cd1bf3b9ef92e12364ced0541375d9ec103e4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMzoxNjowNVrOGYLEmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMzoxNjowNVrOGYLEmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAwMDQwOA==", "bodyText": "What kinds of exceptions are possible here? Anything worth logging (even if just at DEBUG level)?", "url": "https://github.com/CMSgov/dpc-app/pull/809#discussion_r428000408", "createdAt": "2020-05-20T13:16:05Z", "author": {"login": "em1"}, "path": "dpc-common/src/main/java/gov/cms/dpc/fhir/helpers/FHIRHelpers.java", "diffHunk": "@@ -127,6 +128,19 @@ public static String createGoldenMacaroon(String taskURL) throws IOException {\n         }\n     }\n \n+    public static String generateNPI() {\n+        int randomNumber = (int) Math.floor(Math.random()*(999999999-100000000+1)+100000000);\n+        String checkDigit = null;\n+        do {\n+            try {\n+                checkDigit = LuhnCheckDigit.LUHN_CHECK_DIGIT.calculate(String.valueOf(randomNumber));\n+            } catch (Exception e) {\n+                //do nothing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86cd1bf3b9ef92e12364ced0541375d9ec103e4a"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MzIxOTkw", "url": "https://github.com/CMSgov/dpc-app/pull/809#pullrequestreview-415321990", "createdAt": "2020-05-20T13:17:04Z", "commit": {"oid": "86cd1bf3b9ef92e12364ced0541375d9ec103e4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMzoxNzowNFrOGYLHiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMzoxNzowNFrOGYLHiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAwMTE2MQ==", "bodyText": "Could we call this npi so no one mistakes it for a constant?", "url": "https://github.com/CMSgov/dpc-app/pull/809#discussion_r428001161", "createdAt": "2020-05-20T13:17:04Z", "author": {"login": "em1"}, "path": "dpc-smoketest/src/main/java/gov/cms/dpc/testing/smoketests/SmokeTest.java", "diffHunk": "@@ -138,7 +138,8 @@ public SampleResult runTest(JavaSamplerContext javaSamplerContext) {\n \n             orgRegistrationResult.sampleStart();\n             try {\n-                clientToken = FHIRHelpers.registerOrganization(adminClient, ctx.newJsonParser(), organizationID, \"1121111110\",adminURL);\n+                String NPI = FHIRHelpers.generateNPI();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86cd1bf3b9ef92e12364ced0541375d9ec103e4a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1af4a470f7fd08165216536c3d0dd63498720c69", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/1af4a470f7fd08165216536c3d0dd63498720c69", "committedDate": "2020-05-20T14:27:28Z", "message": "change variable to lower case and add log statement to generateNPI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5c52b36618869a031c39e56ea9fdef1b3ac313b", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/a5c52b36618869a031c39e56ea9fdef1b3ac313b", "committedDate": "2020-05-20T18:06:53Z", "message": "Merge branch 'master' into fix-smoke-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e77d0e72b24b49fda4b761629db9e038e55a1930", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/e77d0e72b24b49fda4b761629db9e038e55a1930", "committedDate": "2020-05-21T01:45:25Z", "message": "oops, generate correct NPI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "081625c8a0b37bc62f6a754ed1e3c256d794e942", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/081625c8a0b37bc62f6a754ed1e3c256d794e942", "committedDate": "2020-05-21T02:47:36Z", "message": "renamed NPIValidationUtil to NPIUtil and moved generate NPI to NPIUtil"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MjcyNDA5", "url": "https://github.com/CMSgov/dpc-app/pull/809#pullrequestreview-416272409", "createdAt": "2020-05-21T15:50:09Z", "commit": {"oid": "081625c8a0b37bc62f6a754ed1e3c256d794e942"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MjgyMTU5", "url": "https://github.com/CMSgov/dpc-app/pull/809#pullrequestreview-416282159", "createdAt": "2020-05-21T16:02:31Z", "commit": {"oid": "081625c8a0b37bc62f6a754ed1e3c256d794e942"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82b4d216f28f4fc6cb747134c5e0fd50d49bafb9", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/82b4d216f28f4fc6cb747134c5e0fd50d49bafb9", "committedDate": "2020-05-21T18:45:41Z", "message": "Merge branch 'master' into fix-smoke-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e33a854d4f4c027964a6456365c562fb2372cc9f", "author": {"user": {"login": "MrBilnon", "name": "Will H"}}, "url": "https://github.com/CMSgov/dpc-app/commit/e33a854d4f4c027964a6456365c562fb2372cc9f", "committedDate": "2020-05-21T20:02:48Z", "message": "Merge branch 'master' into fix-smoke-tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 141, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}