{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NTgzODY0", "number": 965, "title": "DPC-592: Fix rails app bug from password update", "bodyText": "Fixes DPC-592\nFixing bugs introduced to master in two previous PRs.\n\nBroken Javascript design transitions (nav bar, drop down from org select)\nBroken spec tests\n\nProposed Changes\n\nThis PR fixes the bug that didn't catch the broken spec tests\nFix spec tests to organization search from DPC-547\nReverted to an earlier PR and redid the Javascript that broke the design transitions\n\nChange Details\nSecurity Implications\n\n\n new software dependencies\n\n\n\n security controls or supporting software altered\n\n\n\n new data stored or transmitted\n\n\n\n security checklist is completed for this change\n\n\n\n requires more information or team discussion to evaluate security implications\n\n\n\n no PHI/PII is affected by this change\n\n\nAcceptance Validation\n\n\nFeedback Requested", "createdAt": "2020-08-10T15:47:18Z", "url": "https://github.com/CMSgov/dpc-app/pull/965", "merged": true, "mergeCommit": {"oid": "d025b0494a9717ff6b8bdf99d7b67351925e52b7"}, "closed": true, "closedAt": "2020-08-12T19:21:36Z", "author": {"login": "Sun-Mountain"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9j0STgH2gAyNDY1NTgzODY0OjkwMTg2ZWQ2NDFmODQ5NjUyNTEyNGQyOWI4YzMwYWRiZTE3M2YzZjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-QJJ4AH2gAyNDY1NTgzODY0OjZiOTE3NmMxZDQ1NjdiYjA2MzU1NTM1ZDhlZDU0NThmYzg3OWU1YTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "90186ed641f8496525124d29b8c30adbe173f3f6", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/90186ed641f8496525124d29b8c30adbe173f3f6", "committedDate": "2020-08-10T15:19:15Z", "message": "Revert \"DPC-109: Signup Password Policy for DPC (#926)\"\n\nThis reverts commit fc5d84b4665b85307590ac2df3fd67840e4186fa."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6a0b4b51eb390e74a253110274424a7a4664d29", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/b6a0b4b51eb390e74a253110274424a7a4664d29", "committedDate": "2020-08-10T15:35:17Z", "message": "Fix registrations accordion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2786388c4e07b526a655b38cb3cad2a2d63ffc7", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/d2786388c4e07b526a655b38cb3cad2a2d63ffc7", "committedDate": "2020-08-10T15:45:46Z", "message": "Init"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "374b2dbc748fb8a580e1fa7a979810b2add3f5e6", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/374b2dbc748fb8a580e1fa7a979810b2add3f5e6", "committedDate": "2020-08-10T16:12:01Z", "message": "Devise security gem added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c68760a276676598d04cb1b700353a7c4670b293", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/c68760a276676598d04cb1b700353a7c4670b293", "committedDate": "2020-08-10T16:24:55Z", "message": "Devise security set up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2de9854867289457d5bb7f6c8c4ce919f1e4450a", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/2de9854867289457d5bb7f6c8c4ce919f1e4450a", "committedDate": "2020-08-10T17:54:13Z", "message": "Updating user spec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d09a4eeba935453408cae632371dc6586700588", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/0d09a4eeba935453408cae632371dc6586700588", "committedDate": "2020-08-10T17:56:26Z", "message": "User managment spec fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9640028b740be493ffc44013ebbb912ddb235bb9", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/9640028b740be493ffc44013ebbb912ddb235bb9", "committedDate": "2020-08-10T19:11:31Z", "message": "Javascript complete"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ad1b959cdf086cc1861475c53d9f501abd0582c", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/7ad1b959cdf086cc1861475c53d9f501abd0582c", "committedDate": "2020-08-10T19:15:21Z", "message": "GUI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "699dc0a5766cb707bd827b4fb8cad5fbc26d301f", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/699dc0a5766cb707bd827b4fb8cad5fbc26d301f", "committedDate": "2020-08-10T19:32:14Z", "message": "GUI fin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ed26d4ebc395c9b55a7427c93fba8654f07343c", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/1ed26d4ebc395c9b55a7427c93fba8654f07343c", "committedDate": "2020-08-10T19:34:58Z", "message": "Migrations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "951a1c984339063a989e8dc45a0e321cfdf32a25", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/951a1c984339063a989e8dc45a0e321cfdf32a25", "committedDate": "2020-08-10T19:35:48Z", "message": "Migrations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c6b7d3ebd78005ee47d71491d0514a7a5cb3850", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/9c6b7d3ebd78005ee47d71491d0514a7a5cb3850", "committedDate": "2020-08-10T20:55:14Z", "message": "Migration update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/3121e9868e0f2dcdd036634929e8bd8e848dbe14", "committedDate": "2020-08-11T12:59:11Z", "message": "Update migrations"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1OTI5MzYz", "url": "https://github.com/CMSgov/dpc-app/pull/965#pullrequestreview-465929363", "createdAt": "2020-08-12T13:43:57Z", "commit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo0Mzo1N1rOG_h8Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxMzo1Mzo0NVrOG_iXxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI2OTU4Nw==", "bodyText": "Having already tested for a missing parameter, should we remove the if/elsif here?", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469269587", "createdAt": "2020-08-12T13:43:57Z", "author": {"login": "dhgreene"}, "path": "dpc-web/app/controllers/client_tokens_controller.rb", "diffHunk": "@@ -11,9 +11,11 @@ def new\n \n   def create\n     @organization = current_user.organizations.find(params[:organization_id])\n+    return render_error('Must have a label.') if missing_params\n \n     reg_org = @organization.registered_organization\n     manager = ClientTokenManager.new(registered_organization: reg_org)\n+\n     if missing_params", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3MTU0Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return redirect_to internal_organization_path(@organization)\n          \n          \n            \n                    redirect_to internal_organization_path(@organization)", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469271543", "createdAt": "2020-08-12T13:46:45Z", "author": {"login": "dhgreene"}, "path": "dpc-web/app/controllers/internal/organizations_controller.rb", "diffHunk": "@@ -87,26 +89,33 @@ def add_or_delete\n       @organization = Organization.find(params[:organization_id])\n       @user = user_identify\n \n-      add_delete(params)\n+      if params[:_method] == 'add'\n+        add_user_to_org\n+      elsif params[:_method] == 'delete'\n+        delete_user_from_org\n+      else\n+        return redirect_to internal_organization_path(@organization)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NTYyMA==", "bodyText": "Just double-checking: I don't see @organizations used directly by the view or partial.  What breaks if we don't have this line?", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469275620", "createdAt": "2020-08-12T13:52:25Z", "author": {"login": "dhgreene"}, "path": "dpc-web/app/controllers/internal/users_controller.rb", "diffHunk": "@@ -28,6 +28,7 @@ def update\n         flash[:notice] = 'User successfully updated.'\n         redirect_to internal_user_url(@user)\n       else\n+        @organizations = Organization.all", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3NjYxMg==", "bodyText": "The comment no longer seems true . . .", "url": "https://github.com/CMSgov/dpc-app/pull/965#discussion_r469276612", "createdAt": "2020-08-12T13:53:45Z", "author": {"login": "dhgreene"}, "path": "dpc-web/config/initializers/devise-security.rb", "diffHunk": "@@ -9,15 +9,15 @@\n \n   # Need 1 char of A-Z, a-z and 0-9\n   config.password_complexity = { digit: 1, lower: 1, symbol: 1, upper: 1 }\n-  \n-  # How many passwords to keep in archives\n+\n+  # How many passwords to keep in archive\n   config.password_archiving_count = 12\n-  \n+\n   # Deny old passwords (true, false, number_of_old_passwords_to_check)\n   # Examples:\n   # config.deny_old_passwords = false # allow old passwords\n   # config.deny_old_passwords = true # will deny all the old passwords\n-  config.deny_old_passwords = 12 # will deny new passwords that matches with the last 12 passwords\n+  config.deny_old_passwords = 12 # will deny new passwords that matches with the last 3 passwords", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3121e9868e0f2dcdd036634929e8bd8e848dbe14"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4af1769a27fd36ffc65f6e25254a18d93690c77", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/c4af1769a27fd36ffc65f6e25254a18d93690c77", "committedDate": "2020-08-12T14:19:14Z", "message": "Review notes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6e316d40600e502010b3920049c0085cff1573b", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/d6e316d40600e502010b3920049c0085cff1573b", "committedDate": "2020-08-12T14:19:58Z", "message": "Merge branch 'master' into nicole/dpc-592-bisect"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MTY3NzQ0", "url": "https://github.com/CMSgov/dpc-app/pull/965#pullrequestreview-466167744", "createdAt": "2020-08-12T18:26:48Z", "commit": {"oid": "d6e316d40600e502010b3920049c0085cff1573b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b9176c1d4567bb06355535d8ed5458fc879e5a2", "author": {"user": {"login": "Sun-Mountain", "name": "Nicole Zonnenberg"}}, "url": "https://github.com/CMSgov/dpc-app/commit/6b9176c1d4567bb06355535d8ed5458fc879e5a2", "committedDate": "2020-08-12T18:57:52Z", "message": "Merge branch 'master' into nicole/dpc-592-bisect"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 469, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}