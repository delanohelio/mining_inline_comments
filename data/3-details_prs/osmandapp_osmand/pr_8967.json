{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MTAxNDE3", "number": 8967, "title": "Fix default color favorites", "bodyText": "", "createdAt": "2020-05-14T16:16:26Z", "url": "https://github.com/osmandapp/OsmAnd/pull/8967", "merged": true, "mergeCommit": {"oid": "a7a1f620de0b7ada3819b61ba6d7d0ef2525f701"}, "closed": true, "closedAt": "2020-05-18T10:54:30Z", "author": {"login": "Dima-1"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchPwBsgH2gAyNDE4MTAxNDE3OmJlYjZhMTgwNWZmNTgwZTdhMzNhMDZjMDQ3ZjRhM2VlNmNmZDM1MzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcidBiZAH2gAyNDE4MTAxNDE3OjY0NzlhODY4NDA1Njg5YmMyOGY4NzdkZDA5Yzg1OGM0ZDEwZjA1MzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "beb6a1805ff580e7a33a06c047f4a3ee6cfd3533", "author": {"user": {"login": "Dima-1", "name": "Dmitry"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/beb6a1805ff580e7a33a06c047f4a3ee6cfd3533", "committedDate": "2020-05-14T16:06:37Z", "message": "Fix #8926 Default color of Favorites changed to black"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e5078dd4b157f7b94fb6ad58473f6af11acecc8", "author": {"user": {"login": "Dima-1", "name": "Dmitry"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/0e5078dd4b157f7b94fb6ad58473f6af11acecc8", "committedDate": "2020-05-14T16:14:12Z", "message": "Merge branch 'master' into Fix_default_color_favorites\n\n# Conflicts:\n#\tOsmAnd/src/net/osmand/plus/activities/FavoritesTreeFragment.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTc3Mzc0", "url": "https://github.com/osmandapp/OsmAnd/pull/8967#pullrequestreview-411977374", "createdAt": "2020-05-14T16:25:48Z", "commit": {"oid": "0e5078dd4b157f7b94fb6ad58473f6af11acecc8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyNTo0OVrOGVkZPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyNTo0OVrOGVkZPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2OTU2Ng==", "bodyText": "Looks bad\nWhy it is not simply prevAppVersion < VERSION_3_7_1", "url": "https://github.com/osmandapp/OsmAnd/pull/8967#discussion_r425269566", "createdAt": "2020-05-14T16:25:49Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/AppInitializer.java", "diffHunk": "@@ -228,8 +228,20 @@ public void onFinish(AppInitializer init) {\n \t\t\t\tapp.getSettings().migratePreferences();\n \t\t\t\tstartPrefs.edit().putInt(VERSION_INSTALLED_NUMBER, VERSION_3_6).commit();\n \t\t\t}\n-\t\t\tif (prevAppVersion < VERSION_3_7) {\n+\t\t\tif (prevAppVersion < VERSION_3_7 || Version.getAppVersion(app).equals(\"3.7.1\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e5078dd4b157f7b94fb6ad58473f6af11acecc8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTc5MjU2", "url": "https://github.com/osmandapp/OsmAnd/pull/8967#pullrequestreview-411979256", "createdAt": "2020-05-14T16:27:57Z", "commit": {"oid": "0e5078dd4b157f7b94fb6ad58473f6af11acecc8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyNzo1N1rOGVkgLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyNzo1N1rOGVkgLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3MTM0Mw==", "bodyText": "Is there a ready method for updating all listeners?", "url": "https://github.com/osmandapp/OsmAnd/pull/8967#discussion_r425271343", "createdAt": "2020-05-14T16:27:57Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/FavouritesDbHelper.java", "diffHunk": "@@ -183,6 +183,28 @@ public void run() {\n \t\t});\n \t}\n \n+\tvoid fixBlackBackground() {\n+\t\tflatGroups.clear();\n+\t\tfavoriteGroups.clear();\n+\t\tfor (FavouritePoint fp : cachedFavoritePoints) {\n+\t\t\tif (fp.getColor() == 0xFF000000) {\n+\t\t\t\tfp.setColor(0);\n+\t\t\t}\n+\t\t\tFavoriteGroup group = getOrCreateGroup(fp, 0);\n+\t\t\tgroup.points.add(fp);\n+\t\t}\n+\t\tsortAll();\n+\t\tsaveCurrentPointsIntoFile();\n+\t\tcontext.runInUIThread(new Runnable() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e5078dd4b157f7b94fb6ad58473f6af11acecc8"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48fb775f51ad48f6759a22219b6504a24c18890f", "author": {"user": {"login": "Dima-1", "name": "Dmitry"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/48fb775f51ad48f6759a22219b6504a24c18890f", "committedDate": "2020-05-15T08:49:54Z", "message": "Refactoring AppInitializer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07d0b438070f3f3bab8610aa4eb3ecc9e8443404", "author": {"user": {"login": "Dima-1", "name": "Dmitry"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/07d0b438070f3f3bab8610aa4eb3ecc9e8443404", "committedDate": "2020-05-15T08:50:59Z", "message": "Refactoring AppInitializer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "082a24a21a0174d261e944ce53730b36cc24c851", "author": {"user": {"login": "vshcherb", "name": null}}, "url": "https://github.com/osmandapp/OsmAnd/commit/082a24a21a0174d261e944ce53730b36cc24c851", "committedDate": "2020-05-15T13:51:54Z", "message": "Fix upgrade process"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5f40100c8ca15a49b4c46e02e4f78e3a5feef03", "author": {"user": {"login": "Dima-1", "name": "Dmitry"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/a5f40100c8ca15a49b4c46e02e4f78e3a5feef03", "committedDate": "2020-05-18T08:53:12Z", "message": "Fix favorites default icon and background"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8db838530c440317e45f0b28521156ff804f442", "author": {"user": {"login": "Dima-1", "name": "Dmitry"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/a8db838530c440317e45f0b28521156ff804f442", "committedDate": "2020-05-18T09:00:36Z", "message": "Merge branch 'master' into Fix_default_color_favorites\n\n# Conflicts:\n#\tOsmAnd/src/net/osmand/plus/activities/FavoritesTreeFragment.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6479a868405689bc28f877dd09c858c4d10f0534", "author": {"user": {"login": "Dima-1", "name": "Dmitry"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/6479a868405689bc28f877dd09c858c4d10f0534", "committedDate": "2020-05-18T10:08:26Z", "message": "Fix favorites default icon and background"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3520, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}