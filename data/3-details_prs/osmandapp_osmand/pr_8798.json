{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNTk4Mjcx", "number": 8798, "title": "Custom downloads", "bodyText": "", "createdAt": "2020-04-15T07:50:44Z", "url": "https://github.com/osmandapp/OsmAnd/pull/8798", "merged": true, "mergeCommit": {"oid": "7273372040b1d1629938c7cf5b5794f66104190d"}, "closed": true, "closedAt": "2020-04-21T11:22:36Z", "author": {"login": "Chumva"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcV8YNFAH2gAyNDAzNTk4MjcxOjIxYmNmZDVjNTM4MTE0YzBjOTRjODlmMDg1MDg2ZDAwNmE1ZWMxZDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZx0HuAH2gAyNDAzNTk4MjcxOjBlNjNkZjEwODAyM2YwNTllODM0ZjMxYmEyMDdlYThjZjIxYzVlMTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "21bcfd5c538114c0c94c89f085086d006a5ec1d2", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/21bcfd5c538114c0c94c89f085086d006a5ec1d2", "committedDate": "2020-04-09T13:19:14Z", "message": "Read suggested downloads"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1f56f6915c2a7433b45d996b7c960d95cf920c7", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/e1f56f6915c2a7433b45d996b7c960d95cf920c7", "committedDate": "2020-04-09T14:24:36Z", "message": "Suggested downloads initial commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70c907c010c61b42a7bc39cf1c65c65b549c6aab", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/70c907c010c61b42a7bc39cf1c65c65b549c6aab", "committedDate": "2020-04-09T14:25:30Z", "message": "Remove unnecessary changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5de11ab32b6d28a5c48b7dae08d9cf6f8093f209", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/5de11ab32b6d28a5c48b7dae08d9cf6f8093f209", "committedDate": "2020-04-10T16:24:46Z", "message": "Add custom downloads to settings helper"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44a4b93df17a531cd28e3a7e71ea3f895e89532d", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/44a4b93df17a531cd28e3a7e71ea3f895e89532d", "committedDate": "2020-04-14T13:23:09Z", "message": "Add downloads to ui initial commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac60edda8dc054ef443a4f8273052500cb31cd9c", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/ac60edda8dc054ef443a4f8273052500cb31cd9c", "committedDate": "2020-04-14T20:49:09Z", "message": "Add gpx download type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "946c22adfcb638f54d4a6c491e0648265682f436", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/946c22adfcb638f54d4a6c491e0648265682f436", "committedDate": "2020-04-15T10:59:50Z", "message": "Add subfolder to target file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ca1925ac5c4fcbbe9b688301f5ab564a88d19d4", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/4ca1925ac5c4fcbbe9b688301f5ab564a88d19d4", "committedDate": "2020-04-16T15:10:19Z", "message": "Merge branch 'master' of https://github.com/osmandapp/Osmand into custom_downloads\n\n# Conflicts:\n#\tOsmAnd/res/values/strings.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "043e24b8a3e51218ad949d70b34aa9e8fe4b8315", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/043e24b8a3e51218ad949d70b34aa9e8fe4b8315", "committedDate": "2020-04-16T16:08:16Z", "message": "Add custom sqlite downloads"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b1eef31806f69388706fb56504e964769970a51", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/2b1eef31806f69388706fb56504e964769970a51", "committedDate": "2020-04-16T16:40:40Z", "message": "Add localized names to custom index item"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d513237a6677bb8ea837a38208c183185eda4ef9", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/d513237a6677bb8ea837a38208c183185eda4ef9", "committedDate": "2020-04-16T16:52:18Z", "message": "Fix possible npe"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d13917570365645d97c05cad82ed54961164953", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/2d13917570365645d97c05cad82ed54961164953", "committedDate": "2020-04-17T11:51:14Z", "message": "Save custom downloads"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38d84faa9540d300ac644f725465e306d78ec09d", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/38d84faa9540d300ac644f725465e306d78ec09d", "committedDate": "2020-04-17T16:12:14Z", "message": "Custom downloads UI initial commit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2967b8f1407cd3c125766c70c2263cf6dff0fa7b", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/2967b8f1407cd3c125766c70c2263cf6dff0fa7b", "committedDate": "2020-04-20T14:12:05Z", "message": "Merge branch 'master' of https://github.com/osmandapp/Osmand into custom_downloads\n\n# Conflicts:\n#\tOsmAnd/res/values/strings.xml\n#\tOsmAnd/src/net/osmand/plus/settings/ConfigureMenuItemsFragment.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc15dcb8b1f3c0ce0f3405c4aa3bdf3244a4d77d", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/bc15dcb8b1f3c0ce0f3405c4aa3bdf3244a4d77d", "committedDate": "2020-04-20T19:40:46Z", "message": "Refactor custom downloads first part"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc5dbc127089220a0dff44f8cc78652cabfe5d03", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/bc5dbc127089220a0dff44f8cc78652cabfe5d03", "committedDate": "2020-04-21T10:30:43Z", "message": "Fix plugin icons"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MjAyNjA1", "url": "https://github.com/osmandapp/OsmAnd/pull/8798#pullrequestreview-397202605", "createdAt": "2020-04-21T10:34:15Z", "commit": {"oid": "bc5dbc127089220a0dff44f8cc78652cabfe5d03"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDozNDoxNVrOGI-unw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDo0NjozOVrOGI_MZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA2OTUzNQ==", "bodyText": "?", "url": "https://github.com/osmandapp/OsmAnd/pull/8798#discussion_r412069535", "createdAt": "2020-04-21T10:34:15Z", "author": {"login": "max-klaus"}, "path": "OsmAnd/src/net/osmand/plus/CustomOsmandPlugin.java", "diffHunk": "@@ -398,33 +415,120 @@ public void loadResources() {\n \t\t}\n \t}\n \n-\tprivate Drawable getIconForFile(String path, Map<String, String> fileNames) {\n-\t\tfor (Map.Entry<String, String> entry : fileNames.entrySet()) {\n-\t\t\tString value = entry.getValue();\n-\t\t\tif (value.startsWith(\"@\")) {\n-\t\t\t\tvalue = value.substring(1);\n+\tpublic void updateSuggestedDownloads(List<SuggestedDownloadItem> items) {\n+\t\tsuggestedDownloadItems = new ArrayList<>(items);\n+\t}\n+\n+\tpublic void updateDownloadItems(List<WorldRegion> items) {\n+\t\tcustomRegions = new ArrayList<>(items);\n+\t}\n+\n+\tprivate List<IndexItem> getMapsForType(LatLon latLon, DownloadActivityType type) {\n+\t\ttry {\n+\t\t\treturn DownloadResources.findIndexItemsAt(app, latLon, type);\n+\t\t} catch (IOException e) {\n+\t\t\te.printStackTrace();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc5dbc127089220a0dff44f8cc78652cabfe5d03"}, "originalPosition": 484}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA3NDMzOQ==", "bodyText": "getLocalizedResFromMap, jsonArrayToList, getLocalizedMapFromJson, writeStringListToJson, writeLocalizedMapToJson and similar should be moved to external class like JsonUtils", "url": "https://github.com/osmandapp/OsmAnd/pull/8798#discussion_r412074339", "createdAt": "2020-04-21T10:42:03Z", "author": {"login": "max-klaus"}, "path": "OsmAnd/src/net/osmand/plus/CustomOsmandPlugin.java", "diffHunk": "@@ -398,33 +415,120 @@ public void loadResources() {\n \t\t}\n \t}\n \n-\tprivate Drawable getIconForFile(String path, Map<String, String> fileNames) {\n-\t\tfor (Map.Entry<String, String> entry : fileNames.entrySet()) {\n-\t\t\tString value = entry.getValue();\n-\t\t\tif (value.startsWith(\"@\")) {\n-\t\t\t\tvalue = value.substring(1);\n+\tpublic void updateSuggestedDownloads(List<SuggestedDownloadItem> items) {\n+\t\tsuggestedDownloadItems = new ArrayList<>(items);\n+\t}\n+\n+\tpublic void updateDownloadItems(List<WorldRegion> items) {\n+\t\tcustomRegions = new ArrayList<>(items);\n+\t}\n+\n+\tprivate List<IndexItem> getMapsForType(LatLon latLon, DownloadActivityType type) {\n+\t\ttry {\n+\t\t\treturn DownloadResources.findIndexItemsAt(app, latLon, type);\n+\t\t} catch (IOException e) {\n+\t\t\te.printStackTrace();\n+\t\t}\n+\t\treturn Collections.emptyList();\n+\t}\n+\n+\tprivate List<IndexItem> getMapsForType(List<String> names, DownloadActivityType type, int limit) {\n+\t\treturn DownloadResources.findIndexItemsAt(app, names, type, false, limit);\n+\t}\n+\n+\tpublic static String getLocalizedResFromMap(Context ctx, Map<String, String> localizedMap, String defVal) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc5dbc127089220a0dff44f8cc78652cabfe5d03"}, "originalPosition": 493}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA3NzE1OA==", "bodyText": "gpx?", "url": "https://github.com/osmandapp/OsmAnd/pull/8798#discussion_r412077158", "createdAt": "2020-04-21T10:46:39Z", "author": {"login": "max-klaus"}, "path": "OsmAnd/src/net/osmand/plus/download/DownloadActivityType.java", "diffHunk": "@@ -136,6 +141,10 @@ public boolean isAccepted(String fileName) {\n \t\t\treturn fileName.endsWith(IndexConstants.SQLITE_EXT);\n \t\t} else if (DEPTH_CONTOUR_FILE == this) {\n \t\t\treturn fileName.endsWith(addVersionToExt(IndexConstants.BINARY_MAP_INDEX_EXT_ZIP, IndexConstants.BINARY_MAP_VERSION));\n+\t\t} else if (GPX_FILE == this) {\n+\t\t\treturn fileName.endsWith(IndexConstants.GPX_FILE_EXT);\n+\t\t} else if (SQLITE_FILE == this) {\n+\t\t\treturn fileName.endsWith(IndexConstants.GPX_FILE_EXT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc5dbc127089220a0dff44f8cc78652cabfe5d03"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e63df108023f059e834f31ba207ea8cf21c5e15", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/0e63df108023f059e834f31ba207ea8cf21c5e15", "committedDate": "2020-04-21T11:16:28Z", "message": "Create JsonUtils and remove duplicate gpx constant"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3549, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}