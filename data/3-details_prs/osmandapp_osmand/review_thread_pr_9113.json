{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1ODc2MjY0", "number": 9113, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMTo0NToyNlrOEBVcVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMTo0NjoyNlrOEBVdgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5ODM1MzUxOnYy", "diffSide": "RIGHT", "path": "OsmAnd/src/net/osmand/plus/poi/PoiFiltersHelper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMTo0NToyNlrOGdHsgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMTo0NToyNlrOGdHsgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE4Nzk2OQ==", "bodyText": "?", "url": "https://github.com/osmandapp/OsmAnd/pull/9113#discussion_r433187969", "createdAt": "2020-06-01T11:45:26Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/poi/PoiFiltersHelper.java", "diffHunk": "@@ -55,10 +55,10 @@\n \tprivate PoiUIFilter customPOIFilter;\n \tprivate PoiUIFilter showAllPOIFilter;\n \tprivate PoiUIFilter localWikiPoiFilter;\n-\tprivate PoiUIFilter globalWikiPoiFilter;\n+\tprivate PoiUIFilter topWikiPoiFilter;\n \tprivate List<PoiUIFilter> cacheTopStandardFilters;\n-\tprivate List<PoiUIFilter> cacheWikipediaFilters;\n-\tprivate Map<PoiTemplateList, Set<PoiUIFilter>> selectedPoiFilters = new TreeMap<>();\n+\tprivate Set<PoiUIFilter> selectedPoiFilters = new TreeSet<>();\n+\tprivate boolean updatePoiFiltersOnMap;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05eb4d701c76e17e11c2539768999dcf3529c25e"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5ODM1NjUwOnYy", "diffSide": "RIGHT", "path": "OsmAnd/src/net/osmand/plus/poi/PoiFiltersHelper.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMTo0NjoyNlrOGdHuLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMTo0NjoyNlrOGdHuLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE4ODM5OA==", "bodyText": "is this correct method?", "url": "https://github.com/osmandapp/OsmAnd/pull/9113#discussion_r433188398", "createdAt": "2020-06-01T11:46:26Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/poi/PoiFiltersHelper.java", "diffHunk": "@@ -139,56 +135,42 @@ public PoiUIFilter getLocalWikiPOIFilter() {\n \t\treturn localWikiPoiFilter;\n \t}\n \n-\tpublic PoiUIFilter getGlobalWikiPoiFilter() {\n-\t\tif (globalWikiPoiFilter == null) {\n-\t\t\tString wikiFilterId = PoiUIFilter.STD_PREFIX + \"osmwiki\";\n-\t\t\tfor (PoiUIFilter filter : getTopDefinedPoiFilters()) {\n-\t\t\t\tif (wikiFilterId.equals(filter.getFilterId())) {\n-\t\t\t\t\tglobalWikiPoiFilter = filter;\n-\t\t\t\t\tbreak;\n+\tpublic void prepareTopWikiFilter(@NonNull PoiUIFilter wiki) {\n+\t\tboolean prepareByDefault = true;\n+\t\tBundle wikiSettings = WikipediaPoiMenu.getWikiPoiSettings(application);\n+\t\tif (wikiSettings != null) {\n+\t\t\tboolean allLanguages = wikiSettings.getBoolean(GLOBAL_WIKI_POI_ENABLED_KEY);\n+\t\t\tList<String> languages = wikiSettings\n+\t\t\t\t\t.getStringArrayList(ENABLED_WIKI_POI_LANGUAGES_KEY);\n+\t\t\tif (!allLanguages && languages != null) {\n+\t\t\t\tprepareByDefault = false;\n+\t\t\t\tString wikiLang = \"wiki:lang:\";\n+\t\t\t\tStringBuilder sb = new StringBuilder();\n+\t\t\t\tfor (String lang : languages) {\n+\t\t\t\t\tif (sb.length() > 1) {\n+\t\t\t\t\t\tsb.append(\" \");\n+\t\t\t\t\t}\n+\t\t\t\t\tsb.append(wikiLang).append(lang);\n \t\t\t\t}\n+\t\t\t\twiki.setFilterByName(sb.toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05eb4d701c76e17e11c2539768999dcf3529c25e"}, "originalPosition": 74}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3484, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}