{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MjQ5MDgw", "number": 9266, "title": "Add Wikipedia Banner in search for free app version", "bodyText": "Add Wikipedia Banner in search for free app version\nAdd \"Download Wikipedia maps\" in search when no results and wiki maps for region are available", "createdAt": "2020-06-18T06:03:48Z", "url": "https://github.com/osmandapp/OsmAnd/pull/9266", "merged": true, "mergeCommit": {"oid": "df21ca4f57cd82c727a59f04668973040fd13293"}, "closed": true, "closedAt": "2020-07-03T21:18:50Z", "author": {"login": "nazar-kutz"}, "timelineItems": {"totalCount": 35, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsYFNtAH2gAyNDM2MjQ5MDgwOjczNDZlMjcyYmU1NTkxODIyNTQwZDFlYTA4N2QzOWM0MTAwMzgyYjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxaLn-AH2gAyNDM2MjQ5MDgwOjY5OTU4NDgxYWE1ZjEwZTIyOWI3MmU0ZTk1YjU4MGNhMDhlMmQ5MjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7346e272be5591822540d1ea087d39c4100382b6", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/7346e272be5591822540d1ea087d39c4100382b6", "committedDate": "2020-06-18T06:02:10Z", "message": "Add Wikipedia Banner in search for free app version\nAdd \"Download Wikipedia maps\" in search when no results and wiki maps for region available"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28247397caff355639f21b9ecd5e69c7aba9ee81", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/28247397caff355639f21b9ecd5e69c7aba9ee81", "committedDate": "2020-06-18T08:44:44Z", "message": "Show wikipedia articles in chosen language"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzOTkzNjQy", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-433993642", "createdAt": "2020-06-19T11:10:06Z", "commit": {"oid": "28247397caff355639f21b9ecd5e69c7aba9ee81"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMToxMDowNlrOGmRHag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMToxMDowNlrOGmRHag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjc3OTQ5OA==", "bodyText": "Static method and only used in different class? Doesn't look good", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r442779498", "createdAt": "2020-06-19T11:10:06Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/wikipedia/WikipediaPoiMenu.java", "diffHunk": "@@ -357,4 +360,38 @@ public static String getWikiArticleLanguage(@NonNull OsmandApplication app,\n \t\t}\n \t\treturn preferredLanguage;\n \t}\n+\n+\tpublic static void showDownloadWikiScreen(MapActivity mapActivity) {\n+\t\tOsmandMapTileView mv = mapActivity.getMapView();\n+\t\tDownloadedRegionsLayer dl = mv.getLayerByClass(DownloadedRegionsLayer.class);\n+\t\tString filter = dl.getFilter(new StringBuilder());\n+\t\tfinal Intent intent = new Intent(mapActivity,\n+\t\t\t\tmapActivity.getMyApplication().getAppCustomization().getDownloadIndexActivity());\n+\t\tintent.putExtra(DownloadActivity.FILTER_KEY, filter);\n+\t\tintent.putExtra(DownloadActivity.FILTER_CAT, DownloadActivityType.WIKIPEDIA_FILE.getTag());\n+\t\tintent.putExtra(DownloadActivity.TAB_TO_OPEN, DownloadActivity.DOWNLOAD_TAB);\n+\t\tmapActivity.startActivity(intent);\n+\t}\n+\n+\tpublic static boolean hasWikiMapsToDownload(MapActivity ma) {\n+\t\ttry {\n+\t\t\treturn DownloadResources.findIndexItemsAt(ma.getMyApplication(), ma.getMapLocation(),\n+\t\t\t\t\tDownloadActivityType.WIKIPEDIA_FILE, false, 1).size() > 0;\n+\t\t} catch (IOException e) {\n+\t\t\treturn false;\n+\t\t}\n+\t}\n+\n+\tpublic static boolean isWikiSearch(SearchPhrase phrase) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "28247397caff355639f21b9ecd5e69c7aba9ee81"}, "originalPosition": 75}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd3d2e33a194425a4b7284a3cf0dacf352b150cc", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/cd3d2e33a194425a4b7284a3cf0dacf352b150cc", "committedDate": "2020-06-22T06:55:09Z", "message": "add WikipediaPlugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63e2f5bbb2c971b86ef95e45113e2cce8b6eef5c", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/63e2f5bbb2c971b86ef95e45113e2cce8b6eef5c", "committedDate": "2020-06-22T07:06:00Z", "message": "small fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2357fb9bfbfaa3e34489eadcf84dccc71a9829be", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/2357fb9bfbfaa3e34489eadcf84dccc71a9829be", "committedDate": "2020-06-22T09:42:46Z", "message": "add icon and name to WikipediaPlugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fa3c0f31346190d4b2239d51b5c3791fee26b91", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/9fa3c0f31346190d4b2239d51b5c3791fee26b91", "committedDate": "2020-06-22T09:55:15Z", "message": "add description to WikipediaPlugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6aa58257fe72bb4d83e82741dad845788735e0a8", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/6aa58257fe72bb4d83e82741dad845788735e0a8", "committedDate": "2020-06-24T05:30:17Z", "message": "refactor SearchMoreListItem"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ffb95568dda193e0cdffa4e471f180208517bf3", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/2ffb95568dda193e0cdffa4e471f180208517bf3", "committedDate": "2020-06-24T12:39:15Z", "message": "fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4214d0afcfc8e10dc074b2eb757dd45f45b20c2", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/c4214d0afcfc8e10dc074b2eb757dd45f45b20c2", "committedDate": "2020-06-26T06:42:53Z", "message": "Move check in Search to Wikipedia Plugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1215c9a0c26d71931145f54ab1c3200d1591b67", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/a1215c9a0c26d71931145f54ab1c3200d1591b67", "committedDate": "2020-06-26T06:52:43Z", "message": "small fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/a3b5419b7a7cd935deb1d4816d070290269752d8", "committedDate": "2020-06-27T10:15:32Z", "message": "don't use ListView"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MDMwNjQz", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-439030643", "createdAt": "2020-06-29T11:08:41Z", "commit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMTowODo0MVrOGqL4ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMTowODo0MVrOGqL4ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4ODA5NA==", "bodyText": "Bad import by design", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r446888094", "createdAt": "2020-06-29T11:08:41Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/mapcontextmenu/controllers/AmenityMenuController.java", "diffHunk": "@@ -22,7 +22,7 @@\n import net.osmand.plus.render.RenderingIcons;\n import net.osmand.plus.transport.TransportStopRoute;\n import net.osmand.plus.wikipedia.WikipediaDialogFragment;\n-import net.osmand.plus.wikipedia.WikipediaPoiMenu;\n+import net.osmand.plus.wikipedia.WikipediaPlugin;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MDMxMzc4", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-439031378", "createdAt": "2020-06-29T11:09:42Z", "commit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMTowOTo0MlrOGqL6eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMTowOTo0MlrOGqL6eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4ODU3MA==", "bodyText": "We need to do it via OsmAndPlugin.prepareExtraTopPoiFilters and there specify all what we need for this feature.", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r446888570", "createdAt": "2020-06-29T11:09:42Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/mapcontextmenu/controllers/AmenityMenuController.java", "diffHunk": "@@ -160,10 +160,9 @@ public boolean displayDistanceDirection() {\n \tpublic String getNameStr() {\n \t\tString preferredLang = getPreferredMapLang();\n \t\tif (amenity.getType().isWiki()) {\n-\t\t\tMapActivity mapActivity = getMapActivity();\n-\t\t\tif (mapActivity != null) {\n-\t\t\t\tOsmandApplication app = mapActivity.getMyApplication();\n-\t\t\t\tpreferredLang = WikipediaPoiMenu.getWikiArticleLanguage(app,\n+\t\t\tWikipediaPlugin wikiPlugin = OsmandPlugin.getPlugin(WikipediaPlugin.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MDMxNDk5", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-439031499", "createdAt": "2020-06-29T11:09:52Z", "commit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMTowOTo1MlrOGqL61A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMTowOTo1MlrOGqL61A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4ODY2MA==", "bodyText": "We need to do it via OsmAndPlugin.prepareExtraTopPoiFilters and there specify all what we need for this feature.", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r446888660", "createdAt": "2020-06-29T11:09:52Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/poi/PoiFiltersHelper.java", "diffHunk": "@@ -121,23 +116,18 @@ public PoiUIFilter getCustomPOIFilter() {\n \n \tpublic void prepareTopWikiFilter(@NonNull PoiUIFilter wiki) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MDMxNzA2", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-439031706", "createdAt": "2020-06-29T11:10:08Z", "commit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMDowOFrOGqL7SQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMDowOFrOGqL7SQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4ODc3Nw==", "bodyText": "Bad import by design, should be done via OsmandPlugin", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r446888777", "createdAt": "2020-06-29T11:10:08Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/poi/PoiFiltersHelper.java", "diffHunk": "@@ -10,16 +10,15 @@\n import net.osmand.osm.AbstractPoiType;\n import net.osmand.osm.MapPoiTypes;\n import net.osmand.osm.PoiCategory;\n-import net.osmand.osm.PoiType;\n import net.osmand.plus.OsmandApplication;\n+import net.osmand.plus.OsmandPlugin;\n import net.osmand.plus.R;\n import net.osmand.plus.api.SQLiteAPI;\n import net.osmand.plus.api.SQLiteAPI.SQLiteConnection;\n import net.osmand.plus.api.SQLiteAPI.SQLiteCursor;\n import net.osmand.plus.api.SQLiteAPI.SQLiteStatement;\n import net.osmand.plus.settings.backend.ApplicationMode;\n-import net.osmand.plus.wikipedia.WikipediaPoiMenu;\n-import net.osmand.util.Algorithms;\n+import net.osmand.plus.wikipedia.WikipediaPlugin;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MDMxODI0", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-439031824", "createdAt": "2020-06-29T11:10:19Z", "commit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMDoyMFrOGqL7pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMDoyMFrOGqL7pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4ODg2OQ==", "bodyText": "Good!", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r446888869", "createdAt": "2020-06-29T11:10:20Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/search/QuickSearchDialogFragment.java", "diffHunk": "@@ -1969,21 +1971,23 @@ public void clearLastWord() {\n \t\t}\n \t}\n \n+\tprivate void onNothingFound(SearchPhrase phrase) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MDMyNTY1", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-439032565", "createdAt": "2020-06-29T11:11:27Z", "commit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMToyN1rOGqL9nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMToyN1rOGqL9nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4OTM3NQ==", "bodyText": "Bad import by design, should be done via OsmandPlugin", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r446889375", "createdAt": "2020-06-29T11:11:27Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/views/POIMapLayer.java", "diffHunk": "@@ -36,16 +36,16 @@\n import net.osmand.data.RotatedTileBox;\n import net.osmand.osm.PoiType;\n import net.osmand.plus.OsmandApplication;\n+import net.osmand.plus.OsmandPlugin;\n import net.osmand.plus.R;\n import net.osmand.plus.activities.MapActivity;\n import net.osmand.plus.helpers.WaypointHelper;\n-import net.osmand.plus.poi.PoiFiltersHelper;\n import net.osmand.plus.poi.PoiUIFilter;\n import net.osmand.plus.render.RenderingIcons;\n import net.osmand.plus.routing.IRouteInformationListener;\n import net.osmand.plus.routing.RoutingHelper;\n import net.osmand.plus.views.MapTextLayer.MapTextProvider;\n-import net.osmand.plus.wikipedia.WikipediaPoiMenu;\n+import net.osmand.plus.wikipedia.WikipediaPlugin;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MDMzNzYx", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-439033761", "createdAt": "2020-06-29T11:13:09Z", "commit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMzowOVrOGqMAtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMToxMzowOVrOGqMAtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg5MDE2NQ==", "bodyText": "Bad import by design, should be done via OsmandPlugin", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r446890165", "createdAt": "2020-06-29T11:13:09Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/mapcontextmenu/builders/AmenityMenuBuilder.java", "diffHunk": "@@ -44,6 +44,7 @@\n import net.osmand.plus.wikipedia.WikiArticleHelper;\n import net.osmand.plus.wikipedia.WikipediaArticleWikiLinkFragment;\n import net.osmand.plus.wikipedia.WikipediaDialogFragment;\n+import net.osmand.plus.wikipedia.WikipediaPlugin;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b5419b7a7cd935deb1d4816d070290269752d8"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93ae98625bf04351ffb546728df8920ddde2f7fe", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/93ae98625bf04351ffb546728df8920ddde2f7fe", "committedDate": "2020-06-30T07:21:54Z", "message": "Fix Wikipedia empty banner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5ce9587c0ee3dd7e8d8c1da1a76311c5449d9f3", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/a5ce9587c0ee3dd7e8d8c1da1a76311c5449d9f3", "committedDate": "2020-06-30T07:30:27Z", "message": "small fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49b329257466768405654a4e716d92c88972bc60", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/49b329257466768405654a4e716d92c88972bc60", "committedDate": "2020-06-30T14:51:04Z", "message": "refactor WikipediaPlugin imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "352c038ee9df0f1a2c2baf1468a494ec4760f74e", "author": {"user": {"login": "nazar-kutz", "name": null}}, "url": "https://github.com/osmandapp/OsmAnd/commit/352c038ee9df0f1a2c2baf1468a494ec4760f74e", "committedDate": "2020-06-30T14:58:54Z", "message": "Merge branch 'master' into WikipediaSearchBanner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f42a81c74fc9bc058d4a4888a1248b6193434a9c", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/f42a81c74fc9bc058d4a4888a1248b6193434a9c", "committedDate": "2020-06-30T15:16:25Z", "message": "small fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b", "committedDate": "2020-06-30T15:29:46Z", "message": "check local Wikipedia in search"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNTM4Mzgx", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-441538381", "createdAt": "2020-07-02T10:09:39Z", "commit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDowOTozOVrOGsGaVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDowOTozOVrOGsGaVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg5NTU3Mg==", "bodyText": "should be method\nOsmandPlugin.onGetMapObjectsLocale(Amienity, preferredLang)\nSo each plugin can deal with different object types", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r448895572", "createdAt": "2020-07-02T10:09:39Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/views/POIMapLayer.java", "diffHunk": "@@ -339,7 +339,7 @@ public PointDescription getObjectName(Object o) {\n \t\t\t\tif (Algorithms.isEmpty(preferredLang)) {\n \t\t\t\t\tpreferredLang = app.getLanguage();\n \t\t\t\t}\n-\t\t\t\tpreferredLang = WikipediaPoiMenu.getWikiArticleLanguage(app,\n+\t\t\t\tpreferredLang = OsmandPlugin.onGetMapObjectsLocale(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNTM4NTk2", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-441538596", "createdAt": "2020-07-02T10:09:58Z", "commit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDowOTo1OFrOGsGa5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDowOTo1OFrOGsGa5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg5NTcxOA==", "bodyText": "Plugin is not needed here cause we know it's wiki", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r448895718", "createdAt": "2020-07-02T10:09:58Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/wikipedia/WikipediaDialogFragment.java", "diffHunk": "@@ -282,8 +282,9 @@ public static boolean showInstance(@NonNull FragmentActivity activity, @NonNull\n \n \t\t\tWikipediaDialogFragment wikipediaDialogFragment = new WikipediaDialogFragment();\n \t\t\twikipediaDialogFragment.setAmenity(amenity);\n-\t\t\tlang = lang != null ? lang : WikipediaPoiMenu.getWikiArticleLanguage(app,\n-\t\t\t\t\tamenity.getSupportedContentLocales(), app.getSettings().MAP_PREFERRED_LOCALE.get());\n+\t\t\tlang = lang != null ? lang : OsmandPlugin.onGetMapObjectsLocale(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNTQwNTA2", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-441540506", "createdAt": "2020-07-02T10:12:49Z", "commit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoxMjo0OVrOGsGgwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoxMjo0OVrOGsGgwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg5NzIxNw==", "bodyText": "Wiki is here?", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r448897217", "createdAt": "2020-07-02T10:12:49Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/poi/PoiFiltersHelper.java", "diffHunk": "@@ -486,7 +460,7 @@ public boolean editPoiFilter(PoiUIFilter filter) {\n \n \tpublic void addSelectedPoiFilter(PoiUIFilter filter) {\n \t\tif (filter.isTopWikiFilter()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b"}, "originalPosition": 68}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNTQ1Nzky", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-441545792", "createdAt": "2020-07-02T10:20:30Z", "commit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoyMDozMFrOGsGw4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxMDoyMDozMFrOGsGw4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODkwMTM0NA==", "bodyText": "this line should be inside\nOsmandPlugin.getMapObjectPreferredLang(MapObject object, String defaultLanguage)", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r448901344", "createdAt": "2020-07-02T10:20:30Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/mapcontextmenu/controllers/AmenityMenuController.java", "diffHunk": "@@ -160,12 +159,8 @@ public boolean displayDistanceDirection() {\n \tpublic String getNameStr() {\n \t\tString preferredLang = getPreferredMapLang();\n \t\tif (amenity.getType().isWiki()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5f3d28ed6561b1a0e59edf6ee9d6ee903ebca9b"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d9f0c3cf959b40f9cd3a3be6b0ec6addfc598c7", "author": {"user": null}, "url": "https://github.com/osmandapp/OsmAnd/commit/9d9f0c3cf959b40f9cd3a3be6b0ec6addfc598c7", "committedDate": "2020-07-02T11:26:46Z", "message": "small fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "414ce3f2768361d7ad27a80002ae781f6909f0c8", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/414ce3f2768361d7ad27a80002ae781f6909f0c8", "committedDate": "2020-07-02T12:25:40Z", "message": "Fixes first part"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15a964f4bdd5b1cf4819f81fb36c93ca5293563a", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/15a964f4bdd5b1cf4819f81fb36c93ca5293563a", "committedDate": "2020-07-02T13:52:48Z", "message": "Merge branch 'master' into WikipediaSearchBanner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba5bb6dc9c0d88b34a2263826b430444447e1d24", "author": {"user": {"login": "Chumva", "name": "Vitaliy"}}, "url": "https://github.com/osmandapp/OsmAnd/commit/ba5bb6dc9c0d88b34a2263826b430444447e1d24", "committedDate": "2020-07-02T14:09:07Z", "message": "Move custom poi filters to plugin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNTYxMzMw", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#pullrequestreview-442561330", "createdAt": "2020-07-03T21:17:05Z", "commit": {"oid": "ba5bb6dc9c0d88b34a2263826b430444447e1d24"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QyMToxNzowNlrOGs31tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QyMToxNzowNlrOGs31tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTcwNTM5OA==", "bodyText": "no check for type is needed here", "url": "https://github.com/osmandapp/OsmAnd/pull/9266#discussion_r449705398", "createdAt": "2020-07-03T21:17:06Z", "author": {"login": "vshcherb"}, "path": "OsmAnd/src/net/osmand/plus/views/POIMapLayer.java", "diffHunk": "@@ -331,20 +331,19 @@ public void onClick(final View v) {\n \t@Override\n \tpublic PointDescription getObjectName(Object o) {\n \t\tif (o instanceof Amenity) {\n-\t\t\tAmenity a = (Amenity) o;\n+\t\t\tAmenity amenity = (Amenity) o;\n \t\t\tString preferredLang = app.getSettings().MAP_PREFERRED_LOCALE.get();\n \t\t\tboolean transliterateNames = app.getSettings().MAP_TRANSLITERATE_NAMES.get();\n \n-\t\t\tif (a.getType().isWiki()) {\n+\t\t\tif (amenity.getType().isWiki()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba5bb6dc9c0d88b34a2263826b430444447e1d24"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69958481aa5f10e229b72e4e95b580ca08e2d920", "author": {"user": {"login": "vshcherb", "name": null}}, "url": "https://github.com/osmandapp/OsmAnd/commit/69958481aa5f10e229b72e4e95b580ca08e2d920", "committedDate": "2020-07-03T21:18:36Z", "message": "Merge branch 'master' into WikipediaSearchBanner"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3493, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}