{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MjkwNjg3", "number": 6231, "title": "[2.19.x] DDF-6232 decrypt password parameter in SmtpClientImpl", "bodyText": "If a SmtpClientImpl config file is provided a bug occurs where the password parameter is sent to the smtp server still encrypted. Note: if no configuration file is provided and the configuration is instead performed through the admin ui - everything works properly. This change decrypts the password parameter in SmtpClientImpl when necessary.\nWho is reviewing it?\n\nSelect relevant component teams:\n\nAsk 2 committers to review/merge the PR and tag them here.\n\nHow should this be tested?\n\n\ncreate config file: org.codice.ddf.platform.email.impl.SmtpClientImpl.config\nwith a smtp server url, port, username, and password\ncause ddf to send an email. one way to do this is to check \"Enable Query Feedback\" in Admin UI > Catalog UI > Catalog UI Search; and supply a \"Query Feedback Email Destination\"\n\nAny background context you want to provide?\nWhat are the relevant tickets?\nFixes: #6232\nScreenshots\n\nChecklist:\n\n Documentation Updated\n Update / Add Threat Dragon models\n Update / Add Unit Tests\n Update / Add Integration Tests\n\nNotes on Review Process\nPlease see Notes on Review Process for further guidance on requirements for merging and abbreviated reviews.\nReview Comment Legend:\n\n\u270f\ufe0f (Pencil) This comment is a nitpick or style suggestion, no action required for approval. This comment should provide a suggestion either as an in line code snippet or a gist.\n\u2753 (Question Mark) This comment is to gain a clearer understanding of design or code choices, clarification is required but action may not be necessary for approval.\n\u2757 (Exclamation Mark) This comment is critical and requires clarification or action before approval.", "createdAt": "2020-08-06T22:19:16Z", "url": "https://github.com/codice/ddf/pull/6231", "merged": true, "mergeCommit": {"oid": "f4637a6c515050f68efaddc6eaf7d54b6655a119"}, "closed": true, "closedAt": "2020-08-17T15:40:00Z", "author": {"login": "rymach"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8XZ3AAH2gAyNDY0MjkwNjg3OmE0MTc0OTc5YWE5OTNmNzUxNDgxODRkYWE5Y2RmYzk2YjE4NjY5ZTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-7eVRgH2gAyNDY0MjkwNjg3OmQxN2M1MGNjMTdiNTYxOGZjNWM5YTQ3YTIxOGU2ZDllMDY3MjBjNTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2", "author": {"user": {"login": "rymach", "name": "Ryan Machado"}}, "url": "https://github.com/codice/ddf/commit/a4174979aa993f75148184daa9cdfc96b18669e2", "committedDate": "2020-08-06T22:17:36Z", "message": "always decrypt password parameter in SmtpClientImpl\n\nif a config file is provided a bug occurs where the password parameter is supplied still encrypted to the smtp server"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTI0MTEy", "url": "https://github.com/codice/ddf/pull/6231#pullrequestreview-462924112", "createdAt": "2020-08-06T22:43:53Z", "commit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMjo0Mzo1M1rOG9Gm9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMjo0Mzo1M1rOG9Gm9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjcyNDU5OA==", "bodyText": "i think this is default", "url": "https://github.com/codice/ddf/pull/6231#discussion_r466724598", "createdAt": "2020-08-06T22:43:53Z", "author": {"login": "bdeining"}, "path": "platform/email/platform-email-impl/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -18,7 +18,12 @@\n            xsi:schemaLocation=\"http://www.osgi.org/xmlns/blueprint/v1.0.0\n            http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd\">\n \n+    <reference id=\"encryptionService\"\n+        interface=\"ddf.security.encryption.EncryptionService\"\n+        availability=\"mandatory\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTI0MjA4", "url": "https://github.com/codice/ddf/pull/6231#pullrequestreview-462924208", "createdAt": "2020-08-06T22:44:10Z", "commit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NTY1Mzk1", "url": "https://github.com/codice/ddf/pull/6231#pullrequestreview-464565395", "createdAt": "2020-08-10T20:30:09Z", "commit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMDozMDowOVrOG-etfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMDozMDowOVrOG-etfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE2ODA2MA==", "bodyText": "\u2753 Do we want to keep the password encrypted in-memory and only decrypt on use?", "url": "https://github.com/codice/ddf/pull/6231#discussion_r468168060", "createdAt": "2020-08-10T20:30:09Z", "author": {"login": "Lambeaux"}, "path": "platform/email/platform-email-impl/src/main/java/org/codice/ddf/platform/email/impl/SmtpClientImpl.java", "diffHunk": "@@ -92,7 +99,7 @@ public void setUserName(@Nullable String userName) {\n    * @param password the password for the email server\n    */\n   public void setPassword(@Nullable String password) {\n-    this.password = password;\n+    this.password = encryptionService.decryptValue(password);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MjM4NTk2", "url": "https://github.com/codice/ddf/pull/6231#pullrequestreview-466238596", "createdAt": "2020-08-12T20:13:29Z", "commit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MzQwMTU2", "url": "https://github.com/codice/ddf/pull/6231#pullrequestreview-466340156", "createdAt": "2020-08-12T23:20:37Z", "commit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMzoyMDozN1rOG_2G3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMzoyMDozN1rOG_2G3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU5OTk2NA==", "bodyText": "Someone from the @codice/security team could probably help. Is it only accessible here? https://github.com/codice/ddf/blob/2.19.x/platform/email/platform-email-impl/src/main/java/org/codice/ddf/platform/email/impl/SmtpClientImpl.java#L162\nIf so then possible could decrypt it there so it isn't in memory. Not sure if that is better.", "url": "https://github.com/codice/ddf/pull/6231#discussion_r469599964", "createdAt": "2020-08-12T23:20:37Z", "author": {"login": "shaundmorris"}, "path": "platform/email/platform-email-impl/src/main/java/org/codice/ddf/platform/email/impl/SmtpClientImpl.java", "diffHunk": "@@ -92,7 +99,7 @@ public void setUserName(@Nullable String userName) {\n    * @param password the password for the email server\n    */\n   public void setPassword(@Nullable String password) {\n-    this.password = password;\n+    this.password = encryptionService.decryptValue(password);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE2ODA2MA=="}, "originalCommit": {"oid": "a4174979aa993f75148184daa9cdfc96b18669e2"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c335a013933162ff48fd0dad2f06c896033c8a85", "author": {"user": {"login": "rymach", "name": "Ryan Machado"}}, "url": "https://github.com/codice/ddf/commit/c335a013933162ff48fd0dad2f06c896033c8a85", "committedDate": "2020-08-14T20:57:17Z", "message": "wish me luck w/ ci"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d17c50cc17b5618fc5c9a47a218e6d9e06720c54", "author": {"user": {"login": "rymach", "name": "Ryan Machado"}}, "url": "https://github.com/codice/ddf/commit/d17c50cc17b5618fc5c9a47a218e6d9e06720c54", "committedDate": "2020-08-14T21:26:55Z", "message": "wish me luck w/ ci"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 849, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}