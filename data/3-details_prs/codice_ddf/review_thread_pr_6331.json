{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4OTUxNDQz", "number": 6331, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjoxNToyM1rOEkvpAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjoyOTo0OVrOEkv2YQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2OTY0NzM4OnYy", "diffSide": "RIGHT", "path": "distribution/ddf-common/src/main/resources-filtered/etc/custom.system.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjoxNToyM1rOHT3W8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjoxNToyM1rOHT3W8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU5MTk4Nw==", "bodyText": "I think we should include ext.extracted-text by default as well.", "url": "https://github.com/codice/ddf/pull/6331#discussion_r490591987", "createdAt": "2020-09-17T22:15:23Z", "author": {"login": "brendan-hofmann"}, "path": "distribution/ddf-common/src/main/resources-filtered/etc/custom.system.properties", "diffHunk": "@@ -87,7 +87,7 @@ solr.mem=2g\n solr.useBasicAuth=true\n solr.username=admin\n \n-\n+solr.query.anytext.fields=metadata,title,description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b51eee03961016b9b0d74ce2182a2955bf423fc0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2OTY2MjIyOnYy", "diffSide": "RIGHT", "path": "catalog/solr/catalog-solr-core/src/main/java/ddf/catalog/source/solr/DynamicSchemaResolver.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjoyMTozNlrOHT3f5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjo0NToxNVrOHT4B-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU5NDI3OA==", "bodyText": "\u2753  Should we filter blank strings to account for redundant commas in the system property?", "url": "https://github.com/codice/ddf/pull/6331#discussion_r490594278", "createdAt": "2020-09-17T22:21:36Z", "author": {"login": "Lambeaux"}, "path": "catalog/solr/catalog-solr-core/src/main/java/ddf/catalog/source/solr/DynamicSchemaResolver.java", "diffHunk": "@@ -906,7 +834,24 @@ String getSortKey(String field) {\n   }\n \n   Stream<String> anyTextFields() {\n-    return filteredAnyTextFieldsCache.stream();\n+    return anyTextFields.stream();\n+  }\n+\n+  private Set<String> getAnyTextFields() {\n+    String property =\n+        AccessController.doPrivileged(\n+            (PrivilegedAction<String>) () -> System.getProperty(SOLR_ANYTEXT_FIELDS, \"\"));\n+\n+    List<String> fields;\n+    if (property.isEmpty()) {\n+      fields = Arrays.asList(Metacard.METADATA, Metacard.TITLE, Metacard.DESCRIPTION);\n+    } else {\n+      fields = Arrays.asList(property.split(\",\"));\n+    }\n+\n+    return fields.stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b51eee03961016b9b0d74ce2182a2955bf423fc0"}, "originalPosition": 181}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU5NzU5Mg==", "bodyText": "\u2753 Would it be worth adding a test for that case as well?", "url": "https://github.com/codice/ddf/pull/6331#discussion_r490597592", "createdAt": "2020-09-17T22:30:39Z", "author": {"login": "Lambeaux"}, "path": "catalog/solr/catalog-solr-core/src/main/java/ddf/catalog/source/solr/DynamicSchemaResolver.java", "diffHunk": "@@ -906,7 +834,24 @@ String getSortKey(String field) {\n   }\n \n   Stream<String> anyTextFields() {\n-    return filteredAnyTextFieldsCache.stream();\n+    return anyTextFields.stream();\n+  }\n+\n+  private Set<String> getAnyTextFields() {\n+    String property =\n+        AccessController.doPrivileged(\n+            (PrivilegedAction<String>) () -> System.getProperty(SOLR_ANYTEXT_FIELDS, \"\"));\n+\n+    List<String> fields;\n+    if (property.isEmpty()) {\n+      fields = Arrays.asList(Metacard.METADATA, Metacard.TITLE, Metacard.DESCRIPTION);\n+    } else {\n+      fields = Arrays.asList(property.split(\",\"));\n+    }\n+\n+    return fields.stream()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU5NDI3OA=="}, "originalCommit": {"oid": "b51eee03961016b9b0d74ce2182a2955bf423fc0"}, "originalPosition": 181}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDYwMzAwMA==", "bodyText": "Probably not a bad idea.  I can also look at removing whitespace padding too if it is present.", "url": "https://github.com/codice/ddf/pull/6331#discussion_r490603000", "createdAt": "2020-09-17T22:45:15Z", "author": {"login": "pklinef"}, "path": "catalog/solr/catalog-solr-core/src/main/java/ddf/catalog/source/solr/DynamicSchemaResolver.java", "diffHunk": "@@ -906,7 +834,24 @@ String getSortKey(String field) {\n   }\n \n   Stream<String> anyTextFields() {\n-    return filteredAnyTextFieldsCache.stream();\n+    return anyTextFields.stream();\n+  }\n+\n+  private Set<String> getAnyTextFields() {\n+    String property =\n+        AccessController.doPrivileged(\n+            (PrivilegedAction<String>) () -> System.getProperty(SOLR_ANYTEXT_FIELDS, \"\"));\n+\n+    List<String> fields;\n+    if (property.isEmpty()) {\n+      fields = Arrays.asList(Metacard.METADATA, Metacard.TITLE, Metacard.DESCRIPTION);\n+    } else {\n+      fields = Arrays.asList(property.split(\",\"));\n+    }\n+\n+    return fields.stream()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU5NDI3OA=="}, "originalCommit": {"oid": "b51eee03961016b9b0d74ce2182a2955bf423fc0"}, "originalPosition": 181}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2OTY4MTYxOnYy", "diffSide": "LEFT", "path": "catalog/solr/catalog-solr-core/src/test/java/ddf/catalog/source/solr/provider/SolrProviderQuery.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjoyOTo0OVrOHT3riQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjo0MzozMlrOHT3_mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU5NzI1Nw==", "bodyText": "\u2753  Not sure how meaningful the implications are of not sending the spell check option to Solr. Worth writing a test for it?", "url": "https://github.com/codice/ddf/pull/6331#discussion_r490597257", "createdAt": "2020-09-17T22:29:49Z", "author": {"login": "Lambeaux"}, "path": "catalog/solr/catalog-solr-core/src/test/java/ddf/catalog/source/solr/provider/SolrProviderQuery.java", "diffHunk": "@@ -766,37 +763,6 @@ public void testContextualAnyText() throws Exception {\n         1, getFilterBuilder().attribute(Metacard.ANY_TEXT).is().like().text(soughtWord), provider);\n   }\n \n-  @Test\n-  public void testQueryExcludedAttributes() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b51eee03961016b9b0d74ce2182a2955bf423fc0"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDYwMjM5NQ==", "bodyText": "Not sending it is the default.  It is what we were doing before the spell check PR.\nhttps://lucene.apache.org/solr/guide/8_6/spell-checking.html#spell-check-parameters", "url": "https://github.com/codice/ddf/pull/6331#discussion_r490602395", "createdAt": "2020-09-17T22:43:32Z", "author": {"login": "pklinef"}, "path": "catalog/solr/catalog-solr-core/src/test/java/ddf/catalog/source/solr/provider/SolrProviderQuery.java", "diffHunk": "@@ -766,37 +763,6 @@ public void testContextualAnyText() throws Exception {\n         1, getFilterBuilder().attribute(Metacard.ANY_TEXT).is().like().text(soughtWord), provider);\n   }\n \n-  @Test\n-  public void testQueryExcludedAttributes() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDU5NzI1Nw=="}, "originalCommit": {"oid": "b51eee03961016b9b0d74ce2182a2955bf423fc0"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4458, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}