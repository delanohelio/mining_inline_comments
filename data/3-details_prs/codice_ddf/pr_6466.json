{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyMTcyNjIz", "number": 6466, "title": "[2.26.x] Add missing Jetty imports to solr-dependencies", "bodyText": "What does this PR do?\nAs of version 8.x, Solrj depends on Jetty. The solr-dependencies bundle was missing the Jetty imports, and it was causing an issue when trying to configure the Solr client to use basic auth. This PR adds them.\nWho is reviewing it?\n\n@pklinef @derekwilhelm\nSelect relevant component teams:\n\n@codice/solr\nHow should this be tested?\n\n\nStart a Solr server and configure it to use basic auth. You can do that by overwriting the security.json file with\n\n{\n    \"authentication\":{\n        \"class\":\"solr.BasicAuthPlugin\",\n        \"credentials\":{\"solr\":\"IV0EHq1OnNrj6gvRCwvFwTrZ1+z1oBbnQdiVC3otuq0= Ndd7LKvVBAaZIF0QAVi1ekCfAJXr1GGfLtRUXhgrF8c=\"},\n        \"blockUnknown\": true\n    },\n    \"authorization\":{\n        \"class\":\"solr.RuleBasedAuthorizationPlugin\",\n        \"user-role\":{\"solr\":\"admin\"},\n        \"permissions\":[{\"name\":\"all\",\n                        \"role\":\"admin\"}]\n    }\n}\n\n\nBuild and unzip DDF\nConfigure the Solr client in DDF to use basic auth to connect to Solr by adding the following properties to custom.system.properties:\n\nsolr.httpclient.builder.factory=org.apache.solr.client.solrj.impl.PreemptiveBasicAuthClientBuilderFactory\nsolr.httpclient.config=${ddf.etc}/solr/solr-client.config\n\n\nCreate a file ${DDF_HOME}/etc/solr/solr-client.config with the following contents:\n\nhttpBasicAuthUser=solr\nhttpBasicAuthPassword=SolrRocks\n\n\nAdd the following lines to the grant all block in the security policy file ${DDF_HOME}/security/default.policy. This will give the permission to all bundles (easier than specifying each individually):\n\npermission java.io.FilePermission \"${ddf.home.perm}etc${/}solr\", \"read\";\npermission java.io.FilePermission \"${ddf.home.perm}etc${/}solr${/}-\", \"read\";\n\n\nStart DDF and perform a standard install. Verify that the Solr client connects to Solr successfully.\n\nAny background context you want to provide?\nWhat are the relevant tickets?\nFixes: #____\nScreenshots\n\nChecklist:\n\n Documentation Updated\n Update / Add Threat Dragon models\n Update / Add Unit Tests\n Update / Add Integration Tests\n\nNotes on Review Process\nPlease see Notes on Review Process for further guidance on requirements for merging and abbreviated reviews.\nReview Comment Legend:\n\n\u270f\ufe0f (Pencil) This comment is a nitpick or style suggestion, no action required for approval. This comment should provide a suggestion either as an in line code snippet or a gist.\n\u2753 (Question Mark) This comment is to gain a clearer understanding of design or code choices, clarification is required but action may not be necessary for approval.\n\u2757 (Exclamation Mark) This comment is critical and requires clarification or action before approval.", "createdAt": "2020-12-17T22:29:40Z", "url": "https://github.com/codice/ddf/pull/6466", "merged": true, "mergeCommit": {"oid": "b7352ed4c56b006030d2ccdc0f4299403a0658a4"}, "closed": true, "closedAt": "2020-12-23T21:54:02Z", "author": {"login": "SmithJosh"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdnLW8hAFqTU1NTA0MTI1MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpBixegBqjQxNDQ3NjUzMjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MDQxMjUx", "url": "https://github.com/codice/ddf/pull/6466#pullrequestreview-555041251", "createdAt": "2020-12-17T22:34:18Z", "commit": {"oid": "3257d7e34388cfd67eab1f03bcf033df93e31ddf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMjozNDoxOFrOIILepQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMjozNDoxOFrOIILepQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTQ0NzU4OQ==", "bodyText": "Making these imports optional. The Solr client seems to work fine for the most part without them. We only ran into an error when we tried to configure it to use basic auth. It's a little hard to say what is and isn't required by Solrj as it marks nothing as optional dependencies. The http2 packages are definitely optional for us, though\nBnd will automatically append the supported version range to these imports. So these will become:\n\torg.eclipse.jetty.client;resolution:=optional;version=\"[9.4,10)\",\n\torg.eclipse.jetty.client.api;resolution:=optional;version=\"[9.4,10)\",\n\torg.eclipse.jetty.client.http;resolution:=optional;version=\"[9.4,10)\",\n\torg.eclipse.jetty.client.util;resolution:=optional;version=\"[9.4,10)\",\n\torg.eclipse.jetty.http;resolution:=optional;version=\"[9.4,10)\",\n\torg.eclipse.jetty.http2.client;resolution:=optional;version=\"[9.4,10)\",\n\torg.eclipse.jetty.http2.client.http;resolution:=optional;version=\"[9.4,10)\",\n\torg.eclipse.jetty.util;resolution:=optional;version=\"[9.4,10)\",\n\torg.eclipse.jetty.util.ssl;resolution:=optional;version=\"[9.4,10)\",", "url": "https://github.com/codice/ddf/pull/6466#discussion_r545447589", "createdAt": "2020-12-17T22:34:18Z", "author": {"login": "SmithJosh"}, "path": "platform/solr/solr-dependencies/pom.xml", "diffHunk": "@@ -214,6 +214,17 @@\n                             javax.xml.transform.stream,\n                             javax.xml.xpath,\n \n+                            <!--jetty-->\n+                            org.eclipse.jetty.client;resolution:=optional,\n+                            org.eclipse.jetty.client.api;resolution:=optional,\n+                            org.eclipse.jetty.client.http;resolution:=optional,\n+                            org.eclipse.jetty.client.util;resolution:=optional,\n+                            org.eclipse.jetty.http;resolution:=optional,\n+                            org.eclipse.jetty.http2.client;resolution:=optional,\n+                            org.eclipse.jetty.http2.client.http;resolution:=optional,\n+                            org.eclipse.jetty.util;resolution:=optional,\n+                            org.eclipse.jetty.util.ssl;resolution:=optional,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3257d7e34388cfd67eab1f03bcf033df93e31ddf"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MDQ2MDE0", "url": "https://github.com/codice/ddf/pull/6466#pullrequestreview-555046014", "createdAt": "2020-12-17T22:43:32Z", "commit": {"oid": "3257d7e34388cfd67eab1f03bcf033df93e31ddf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NzkxMDUx", "url": "https://github.com/codice/ddf/pull/6466#pullrequestreview-555791051", "createdAt": "2020-12-18T20:22:55Z", "commit": {"oid": "3257d7e34388cfd67eab1f03bcf033df93e31ddf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjM5NTk4", "url": "https://github.com/codice/ddf/pull/6466#pullrequestreview-557239598", "createdAt": "2020-12-22T17:21:04Z", "commit": {"oid": "3257d7e34388cfd67eab1f03bcf033df93e31ddf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6834b33ac2bb3717cb5e631328a5ccfb7ca1ce9", "author": {"user": {"login": "SmithJosh", "name": "Joshua Smith"}}, "url": "https://github.com/codice/ddf/commit/d6834b33ac2bb3717cb5e631328a5ccfb7ca1ce9", "committedDate": "2020-12-23T16:15:46Z", "message": "Add missing Jetty imports to solr-dependencies"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3257d7e34388cfd67eab1f03bcf033df93e31ddf", "author": {"user": {"login": "SmithJosh", "name": "Joshua Smith"}}, "url": "https://github.com/codice/ddf/commit/3257d7e34388cfd67eab1f03bcf033df93e31ddf", "committedDate": "2020-12-17T22:19:15Z", "message": "Add missing Jetty imports to solr-dependencies"}, "afterCommit": {"oid": "d6834b33ac2bb3717cb5e631328a5ccfb7ca1ce9", "author": {"user": {"login": "SmithJosh", "name": "Joshua Smith"}}, "url": "https://github.com/codice/ddf/commit/d6834b33ac2bb3717cb5e631328a5ccfb7ca1ce9", "committedDate": "2020-12-23T16:15:46Z", "message": "Add missing Jetty imports to solr-dependencies"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 704, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}