{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1MzM4MzA0", "number": 6453, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNzo1MDozNlrOFDDoiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNzowMzowN1rOFDlZtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NzQ5NTc2OnYy", "diffSide": "RIGHT", "path": "catalog/core/catalog-core-validator/src/main/java/ddf/catalog/validation/impl/validator/MatchAnyValidator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNzo1MDozNlrOIChqVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxODoyMjo1NVrOICjAIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTUxOTU3Mg==", "bodyText": "Would it make more sense to initialize this.validators as an empty List in this case? Unless the distinction between an empty validators and a null validators matters, I think that we could prevent complications down the line if we reduce the number of null values which our codebase permits.", "url": "https://github.com/codice/ddf/pull/6453#discussion_r539519572", "createdAt": "2020-12-09T17:50:36Z", "author": {"login": "kentmorrissey"}, "path": "catalog/core/catalog-core-validator/src/main/java/ddf/catalog/validation/impl/validator/MatchAnyValidator.java", "diffHunk": "@@ -34,11 +34,16 @@\n   private final List<AttributeValidator> validators;\n \n   public MatchAnyValidator(List<AttributeValidator> validators) {\n-    this.validators =\n-        validators\n-            .stream()\n-            .sorted(Comparator.comparingInt(Object::hashCode))\n-            .collect(Collectors.toList());\n+    // validators has to be initialized\n+    if (validators == null) {\n+      this.validators = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb0ad03a9f8c63218d78ba873bf8ccac3c0d9818"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU0MTUzNg==", "bodyText": "I do like the idea of empty list better. It seems the unit tests pass with empty list initialization so that seems to work. Initially I was trying to avoid the NPE.", "url": "https://github.com/codice/ddf/pull/6453#discussion_r539541536", "createdAt": "2020-12-09T18:22:55Z", "author": {"login": "shaundmorris"}, "path": "catalog/core/catalog-core-validator/src/main/java/ddf/catalog/validation/impl/validator/MatchAnyValidator.java", "diffHunk": "@@ -34,11 +34,16 @@\n   private final List<AttributeValidator> validators;\n \n   public MatchAnyValidator(List<AttributeValidator> validators) {\n-    this.validators =\n-        validators\n-            .stream()\n-            .sorted(Comparator.comparingInt(Object::hashCode))\n-            .collect(Collectors.toList());\n+    // validators has to be initialized\n+    if (validators == null) {\n+      this.validators = null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTUxOTU3Mg=="}, "originalCommit": {"oid": "cb0ad03a9f8c63218d78ba873bf8ccac3c0d9818"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5MzAyODM3OnYy", "diffSide": "RIGHT", "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "isResolved": false, "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNzowMzowN1rOIDTwVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxOTo0OToxOFrOIDahgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ==", "bodyText": "Does this change fix the issues which this PR's build has had?", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540340311", "createdAt": "2020-12-10T17:03:07Z", "author": {"login": "kentmorrissey"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MjU4OQ==", "bodyText": "yes, after fixing the first build issue, I ran into this one. So this was during DDF startup. The catalog-core-definitionparser bundle would not start causing DDF to have start-up issues. I made this optional since there are currently no bundles exporting ddf.catalog.validation.AttributeValidator in DDF. Seems to resolve this start issue and provide flexibility downstream.", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540342589", "createdAt": "2020-12-10T17:06:14Z", "author": {"login": "shaundmorris"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ=="}, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0NTMwOQ==", "bodyText": "Which issue do you mean by \"the first build issue\"? In case I encounter one of these issues in the future, I should learn what broke, why it broke, and how you solved it.", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540345309", "createdAt": "2020-12-10T17:09:50Z", "author": {"login": "kentmorrissey"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ=="}, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM2NTI1OA==", "bodyText": "The first build issues was the MatchAnyValidatorTest.testMatchAnyValidatorPassesWhenValidatorListIsNull was failing with a NullPointerException.", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540365258", "createdAt": "2020-12-10T17:37:46Z", "author": {"login": "shaundmorris"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ=="}, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM2NjkxMg==", "bodyText": "Oh, okay. Thanks. Do you think that your fix of the first issue caused the second issue?", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540366912", "createdAt": "2020-12-10T17:39:54Z", "author": {"login": "kentmorrissey"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ=="}, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM2OTc5MQ==", "bodyText": "The fixes are somewhat un-related other than being validator-related. With or without the first fix, the second issue would still be there because it has a required dependency that does not exist in DDF. I only really found it because I couldn't get my PR build to pass after fixing the first issue.", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540369791", "createdAt": "2020-12-10T17:43:13Z", "author": {"login": "shaundmorris"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ=="}, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM3MzU3Mw==", "bodyText": "That makes sense. So between the last successful build of 2.19.x and the creation of this PR, someone merged the removal of a required dependency?", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540373573", "createdAt": "2020-12-10T17:48:20Z", "author": {"login": "kentmorrissey"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ=="}, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDQ1MDI5OQ==", "bodyText": "It was more like a required dependency/argument was added which is never found.", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540450299", "createdAt": "2020-12-10T19:47:48Z", "author": {"login": "shaundmorris"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ=="}, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDQ1MTIwMg==", "bodyText": "Ah. Weird. Thanks!", "url": "https://github.com/codice/ddf/pull/6453#discussion_r540451202", "createdAt": "2020-12-10T19:49:18Z", "author": {"login": "kentmorrissey"}, "path": "catalog/core/catalog-core-definitionparser/src/main/resources/OSGI-INF/blueprint/blueprint.xml", "diffHunk": "@@ -28,7 +28,7 @@\n             <reference-list interface=\"ddf.catalog.data.MetacardType\" />\n         </argument>\n         <argument>\n-            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" />\n+            <reference-list interface=\"ddf.catalog.validation.AttributeValidator\" availability=\"optional\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDM0MDMxMQ=="}, "originalCommit": {"oid": "07afc08f89848be2d78b6cfb361275d986c499b1"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4416, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}