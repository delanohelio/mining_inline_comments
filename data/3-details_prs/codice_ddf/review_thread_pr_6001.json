{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0NzE3NjE2", "number": 6001, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNjowOTo0NlrOD12TpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNTo1NjowMFrOD3sVzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NzkwODg0OnYy", "diffSide": "RIGHT", "path": "platform/security/rest/security-rest-cxfwrapper/src/main/java/org/codice/ddf/cxf/oauth/OAuthSecurityImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNjowOTo0NlrOGLe5iA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNjowOTo0NlrOGLe5iA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY5Mzc2OA==", "bodyText": "This warning is still a little bit unclear but i am not sure how to make it clearer that the password should not be encrypted at this point.", "url": "https://github.com/codice/ddf/pull/6001#discussion_r414693768", "createdAt": "2020-04-24T16:09:46Z", "author": {"login": "ryeats"}, "path": "platform/security/rest/security-rest-cxfwrapper/src/main/java/org/codice/ddf/cxf/oauth/OAuthSecurityImpl.java", "diffHunk": "@@ -360,6 +369,23 @@ private String getNewAccessToken(\n     return accessToken;\n   }\n \n+  private void sanitizeFormParameters(Form formParam) {\n+    MultivaluedMap<String, String> formParamMap = formParam.asMap();\n+    List<String> passwords = formParamMap.get(PASSWORD);\n+    if (passwords != null && passwords.size() == 1) {\n+      String password = passwords.get(0);\n+      if (isEncrypted(password)) {\n+        LOGGER.warn(\"Trying to use an encrypted password to retrieve system access token.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eae2bdbe13b6f411dc1986dd6f3608f56c7babad"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5NzI0NzQ5OnYy", "diffSide": "RIGHT", "path": "platform/security/rest/security-rest-cxfwrapper/src/main/java/org/codice/ddf/cxf/oauth/OAuthSecurityImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNTo1NjowMFrOGOFsNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxNTo1NjowMFrOGOFsNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQyNjQ4Ng==", "bodyText": "\u270f\ufe0f There should probably still be a DEBUG message about the failure to receive the token and this trace message and the sanitizeFormParameters call should all be wrapped in a conditional check if LOGGER.isTraceEnabled(). Otherwise, we're going to sanitize every time this occurs but almost never log it.", "url": "https://github.com/codice/ddf/pull/6001#discussion_r417426486", "createdAt": "2020-04-29T15:56:00Z", "author": {"login": "coyotesqrl"}, "path": "platform/security/rest/security-rest-cxfwrapper/src/main/java/org/codice/ddf/cxf/oauth/OAuthSecurityImpl.java", "diffHunk": "@@ -326,7 +329,13 @@ private String getNewAccessToken(\n     }\n \n     if (response.getStatus() != HttpStatus.SC_OK) {\n-      LOGGER.debug(\"Unable to retrieve system access token. {}\", body);\n+      sanitizeFormParameters(formParam);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eae2bdbe13b6f411dc1986dd6f3608f56c7babad"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4730, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}