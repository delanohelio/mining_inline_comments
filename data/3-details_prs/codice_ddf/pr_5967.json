{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwODgyOTMy", "number": 5967, "title": "[2.19.x] DDF-UI-153 readonly result forms", "bodyText": "What does this PR do?\nCreates consistent behavior for read only result forms.\nSystem result forms and result forms shared to a user with only read permission will now allow you to click to open them, but all sections will be read-only and unmodifiable.\nWho is reviewing it?\n\n@hayleynorton @zta6 @andrewzimmer\nSelect relevant component teams:\n\n@codice/ui\nAsk 2 committers to review/merge the PR and tag them here.\n\nHow should this be tested?\n\n\nbuild/profile install/ load system result forms (add forms to etc/forms folder and run forms:load command)\nShare a result form with your user and make it read only\nverify that for both the system result form and the shared result form, you can open the result form and see its details, but not modify them, and no error toast messages pop up.\n\nAny background context you want to provide?\nWhat are the relevant tickets?\nFixes: codice/ddf-ui#153\nScreenshots\n\n\nChecklist:\n\n Documentation Updated\n Update / Add Threat Dragon models\n Update / Add Unit Tests\n Update / Add Integration Tests\n\nNotes on Review Process\nPlease see Notes on Review Process for further guidance on requirements for merging and abbreviated reviews.\nReview Comment Legend:\n\n\u270f\ufe0f (Pencil) This comment is a nitpick or style suggestion, no action required for approval. This comment should provide a suggestion either as an in line code snippet or a gist.\n\u2753 (Question Mark) This comment is to gain a clearer understanding of design or code choices, clarification is required but action may not be necessary for approval.\n\u2757 (Exclamation Mark) This comment is critical and requires clarification or action before approval.", "createdAt": "2020-04-08T14:24:49Z", "url": "https://github.com/codice/ddf/pull/5967", "merged": true, "mergeCommit": {"oid": "69cf3c5f0ee5ec03482d34890ba337dbda43e233"}, "closed": true, "closedAt": "2020-04-16T13:48:02Z", "author": {"login": "cassandrabailey293"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTwm0MgH2gAyNDAwODgyOTMyOjdkYzZmYzQ4Y2FhY2NlMmNhZDBmM2I0NjUyNjg1NzgwNjFhNjhjMjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXwe5iAFqTM5MzQ0OTk1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7dc6fc48caacce2cad0f3b465268578061a68c21", "author": {"user": null}, "url": "https://github.com/codice/ddf/commit/7dc6fc48caacce2cad0f3b465268578061a68c21", "committedDate": "2020-04-02T18:28:29Z", "message": "DDF-UI-153 use readonly property"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de1d1d3ec58fc1bc811997304db6dc35c2521839", "author": {"user": null}, "url": "https://github.com/codice/ddf/commit/de1d1d3ec58fc1bc811997304db6dc35c2521839", "committedDate": "2020-04-06T16:35:46Z", "message": "DDF-UI-153 handle system forms"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMDMzNjU5", "url": "https://github.com/codice/ddf/pull/5967#pullrequestreview-390033659", "createdAt": "2020-04-08T14:33:39Z", "commit": {"oid": "de1d1d3ec58fc1bc811997304db6dc35c2521839"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMDgwNjYx", "url": "https://github.com/codice/ddf/pull/5967#pullrequestreview-390080661", "createdAt": "2020-04-08T15:23:31Z", "commit": {"oid": "de1d1d3ec58fc1bc811997304db6dc35c2521839"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMTQzNDUy", "url": "https://github.com/codice/ddf/pull/5967#pullrequestreview-390143452", "createdAt": "2020-04-08T16:36:04Z", "commit": {"oid": "de1d1d3ec58fc1bc811997304db6dc35c2521839"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "717267870e26af40db00af30761c28de5742f125", "author": {"user": null}, "url": "https://github.com/codice/ddf/commit/717267870e26af40db00af30761c28de5742f125", "committedDate": "2020-04-08T20:30:03Z", "message": "DDF-UI-153 hide action buttons if read only"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0112ca208be357cbf3065db0404900045d069f96", "author": {"user": null}, "url": "https://github.com/codice/ddf/commit/0112ca208be357cbf3065db0404900045d069f96", "committedDate": "2020-04-08T20:41:28Z", "message": "DDF-UI-153 remove unnecessary code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3e12dd64446e504e04141dc07b599a387055fe7", "author": {"user": null}, "url": "https://github.com/codice/ddf/commit/a3e12dd64446e504e04141dc07b599a387055fe7", "committedDate": "2020-04-10T16:07:44Z", "message": "DDF-UI-153 rename for consistency"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNDQzMjc5", "url": "https://github.com/codice/ddf/pull/5967#pullrequestreview-392443279", "createdAt": "2020-04-13T21:12:20Z", "commit": {"oid": "a3e12dd64446e504e04141dc07b599a387055fe7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMToxMjoyMFrOGE1gwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMToxMjoyMFrOGE1gwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzcyNDIyNg==", "bodyText": "consider moving || this.model.get('createdBy') === 'system' into canWrite", "url": "https://github.com/codice/ddf/pull/5967#discussion_r407724226", "createdAt": "2020-04-13T21:12:20Z", "author": {"login": "rymach"}, "path": "ui/packages/catalog-ui-search/src/main/webapp/component/result-form/result-forms.view.js", "diffHunk": "@@ -18,28 +18,16 @@ const lightboxResultInstance = require('../lightbox/result/lightbox.result.view.\n const lightboxInstance = lightboxResultInstance.generateNewLightbox()\n const QueryResult = require('./result-form.view.js')\n const user = require('../singletons/user-instance')\n-const announcement = require('../announcement')\n \n module.exports = SearchFormViews.extend({\n   initialize() {\n     SearchFormViews.prototype.initialize.call(this)\n   },\n   changeView() {\n-    if (!user.canWrite(this.model)) {\n-      announcement.announce(\n-        {\n-          title: 'Error',\n-          message:\n-            'You have read-only permission on result form ' +\n-            this.model.get('title') +\n-            '.',\n-          type: 'error',\n-        },\n-        3000\n-      )\n-      return\n-    }\n-\n+    this.model.set({\n+      readOnly:\n+        !user.canWrite(this.model) || this.model.get('createdBy') === 'system',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3e12dd64446e504e04141dc07b599a387055fe7"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNDQ0MjAz", "url": "https://github.com/codice/ddf/pull/5967#pullrequestreview-392444203", "createdAt": "2020-04-13T21:13:46Z", "commit": {"oid": "a3e12dd64446e504e04141dc07b599a387055fe7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74627508cd9c221a32d5a1766b203da29914140a", "author": {"user": null}, "url": "https://github.com/codice/ddf/commit/74627508cd9c221a32d5a1766b203da29914140a", "committedDate": "2020-04-14T13:24:15Z", "message": "DDF-UI-153 move system logic into canWrite"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ac77b3697a755753691fd52604b0f2632229b0b", "author": {"user": null}, "url": "https://github.com/codice/ddf/commit/8ac77b3697a755753691fd52604b0f2632229b0b", "committedDate": "2020-04-14T13:41:47Z", "message": "DDF-UI-153 formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNDQ5OTU1", "url": "https://github.com/codice/ddf/pull/5967#pullrequestreview-393449955", "createdAt": "2020-04-15T04:35:32Z", "commit": {"oid": "8ac77b3697a755753691fd52604b0f2632229b0b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4899, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}