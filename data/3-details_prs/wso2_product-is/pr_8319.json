{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3MDgxNDk1", "number": 8319, "title": "Integration tests for SAML Metadata endpoint", "bodyText": "Description\nAdd integration tests for SAML Metadata endpoint. Tests for the following expected behaviors.\n\nFor Super Tenant Legacy Mode: No endpoint in the metadata document should have the tenant domain as a path param nor a query param\nFor Tenant Legacy Mode: All the endpoints in the metadata document except for the /samlartresove should append the tenant domain as a query param. /samlartresolve endpoint should not have the tenant domain as a path param nor a query param.\n\nResolves: #8524", "createdAt": "2020-05-13T02:49:36Z", "url": "https://github.com/wso2/product-is/pull/8319", "merged": true, "mergeCommit": {"oid": "49b4b5c49aabe5daa03e3644b20ddcf87d1ef82a"}, "closed": true, "closedAt": "2020-05-14T18:41:24Z", "author": {"login": "GANGANI"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcguwm1gH2gAyNDE3MDgxNDk1OmI2ZDlhNDdiYjBmMmM3NTMxMWIyODZmNDQ3MjFhMzBhYmQwZmUwN2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchKQbvgFqTQxMTYzNzAxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b6d9a47bb0f2c75311b286f44721a30abd0fe07b", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2/product-is/commit/b6d9a47bb0f2c75311b286f44721a30abd0fe07b", "committedDate": "2020-05-13T01:40:23Z", "message": "Integration tests for SAML Metadata endpoint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88a80f0cc87781ce03cb09df221d521ed3b0544d", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2/product-is/commit/88a80f0cc87781ce03cb09df221d521ed3b0544d", "committedDate": "2020-05-13T02:44:08Z", "message": "Format the code and rename some variables"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cae4f4964ebcf0f6196d01fb9eb36619f9ddbdc6", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2/product-is/commit/cae4f4964ebcf0f6196d01fb9eb36619f9ddbdc6", "committedDate": "2020-05-13T02:47:20Z", "message": "Change test description"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNTYyMjM2", "url": "https://github.com/wso2/product-is/pull/8319#pullrequestreview-410562236", "createdAt": "2020-05-13T03:25:21Z", "commit": {"oid": "cae4f4964ebcf0f6196d01fb9eb36619f9ddbdc6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwMzoyNToyMVrOGUgKmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwMzoyNToyMVrOGUgKmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE1MTcwNA==", "bodyText": "At the beginning of a for loop a new line is not required. Shall we remove this? WDYT?", "url": "https://github.com/wso2/product-is/pull/8319#discussion_r424151704", "createdAt": "2020-05-13T03:25:21Z", "author": {"login": "ShanChathusanda93"}, "path": "modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/saml/SAMLMetadataTestCase.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.wso2.identity.integration.test.saml;\n+\n+import org.apache.http.HttpResponse;\n+import org.apache.http.client.HttpClient;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.impl.client.HttpClientBuilder;\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.testng.Assert;\n+import org.testng.annotations.BeforeClass;\n+import org.testng.annotations.Test;\n+import org.wso2.carbon.tenant.mgt.stub.TenantMgtAdminServiceExceptionException;\n+import org.wso2.identity.integration.common.clients.TenantManagementServiceClient;\n+import org.wso2.identity.integration.common.utils.ISIntegrationTest;\n+import org.wso2.identity.integration.test.utils.DataExtractUtil;\n+import org.json.JSONObject;\n+import org.json.XML;\n+\n+import java.io.IOException;\n+\n+public class SAMLMetadataTestCase extends ISIntegrationTest {\n+\n+    private static final String SUPER_TENANT_URL = \"https://localhost:9853/identity/metadata/saml2\";\n+    private static final String TENANT_URL = \"https://localhost:9853/t/wso2.com/identity/metadata/saml2\";\n+    private static final String SAML_METADATA_ENDPOINT_TENANT = \"https://localhost:9853/samlsso?tenantDomain=wso2.com\";\n+    private static final String SAML_METADATA_ENDPOINT_SUPER_TENANT = \"https://localhost:9853/samlsso\";\n+    private static final String SAMLARTRESOLVE_ENDPOINT = \"https://localhost:9853/samlartresolve\";\n+    private TenantManagementServiceClient tenantServiceClient;\n+\n+    @BeforeClass(alwaysRun = true)\n+    public void testInit() throws Exception {\n+\n+        super.init();\n+        tenantServiceClient = new TenantManagementServiceClient(isServer.getContextUrls().getBackEndUrl(),\n+                sessionCookie);\n+    }\n+\n+    @Test(groups = \"wso2.is\", description = \"This test method will test SAML Metadata endpoints.\")\n+    public void getSAMLMetadata() throws IOException, TenantMgtAdminServiceExceptionException, JSONException {\n+\n+        testResponseContent(SUPER_TENANT_URL, SAML_METADATA_ENDPOINT_SUPER_TENANT);\n+        tenantServiceClient.addTenant(\"wso2.com\", \"John\", \"password\",\n+                \"john@friends.com\", \"John\", \"Smith\");\n+        testResponseContent(TENANT_URL, SAML_METADATA_ENDPOINT_TENANT);\n+    }\n+\n+    private void testResponseContent(String locationURL, String samlMetadataEndpoint)\n+            throws IOException, JSONException {\n+\n+        HttpClient client = HttpClientBuilder.create().build();\n+        HttpResponse httpResponse = sendGetRequest(client, locationURL);\n+        String content = DataExtractUtil.getContentData(httpResponse);\n+        Assert.assertNotNull(content);\n+        JSONArray singleLogoutServices = XML.toJSONObject(content).getJSONObject(\"EntityDescriptor\").getJSONObject(\n+                \"IDPSSODescriptor\").getJSONArray(\"SingleLogoutService\");\n+\n+        for (int i = 0; i < singleLogoutServices.length(); i++) {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cae4f4964ebcf0f6196d01fb9eb36619f9ddbdc6"}, "originalPosition": 76}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed4daeda51db12ad05cd8d718640a10f984fe877", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2/product-is/commit/ed4daeda51db12ad05cd8d718640a10f984fe877", "committedDate": "2020-05-13T03:43:39Z", "message": "Remove unwanted new lines"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNTc2NjMy", "url": "https://github.com/wso2/product-is/pull/8319#pullrequestreview-410576632", "createdAt": "2020-05-13T04:19:30Z", "commit": {"oid": "ed4daeda51db12ad05cd8d718640a10f984fe877"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDoxOTozMVrOGUg5wQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNDoxOTozMVrOGUg5wQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE2Mzc3Nw==", "bodyText": "private static final String SAML_METADATA_ENDPOINT_SUPER_TENANT = \"https://localhost:9853/samlsso\";\nBetter if we name this as SAML_SSO_ENDPOINT_SUPER_TENANT and change the TENANT_URL and SUPER_TENANT_URL to SAML_METADATA_ENDPOINT_TENANT and SAML_METADATA_ENDPOINT_SUPER_TENANT respectively", "url": "https://github.com/wso2/product-is/pull/8319#discussion_r424163777", "createdAt": "2020-05-13T04:19:31Z", "author": {"login": "chamathns"}, "path": "modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/saml/SAMLMetadataTestCase.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.wso2.identity.integration.test.saml;\n+\n+import org.apache.http.HttpResponse;\n+import org.apache.http.client.HttpClient;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.impl.client.HttpClientBuilder;\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.testng.Assert;\n+import org.testng.annotations.BeforeClass;\n+import org.testng.annotations.Test;\n+import org.wso2.carbon.tenant.mgt.stub.TenantMgtAdminServiceExceptionException;\n+import org.wso2.identity.integration.common.clients.TenantManagementServiceClient;\n+import org.wso2.identity.integration.common.utils.ISIntegrationTest;\n+import org.wso2.identity.integration.test.utils.DataExtractUtil;\n+import org.json.JSONObject;\n+import org.json.XML;\n+\n+import java.io.IOException;\n+\n+public class SAMLMetadataTestCase extends ISIntegrationTest {\n+\n+    private static final String SUPER_TENANT_URL = \"https://localhost:9853/identity/metadata/saml2\";\n+    private static final String TENANT_URL = \"https://localhost:9853/t/wso2.com/identity/metadata/saml2\";\n+    private static final String SAML_METADATA_ENDPOINT_TENANT = \"https://localhost:9853/samlsso?tenantDomain=wso2.com\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed4daeda51db12ad05cd8d718640a10f984fe877"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ab572585a54837ade63020646e1add912218583", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2/product-is/commit/6ab572585a54837ade63020646e1add912218583", "committedDate": "2020-05-13T04:43:32Z", "message": "Rename some variables"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNTk4MDI0", "url": "https://github.com/wso2/product-is/pull/8319#pullrequestreview-410598024", "createdAt": "2020-05-13T05:30:39Z", "commit": {"oid": "6ab572585a54837ade63020646e1add912218583"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNTozMDozOVrOGUh-OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QwNTozMDozOVrOGUh-OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE4MTMwNQ==", "bodyText": "IIRC, we can run the same test for tenant case, rather than adding a new tenant.\nThere are tenants already available.\n@ashensw @Abilashini can you help with this", "url": "https://github.com/wso2/product-is/pull/8319#discussion_r424181305", "createdAt": "2020-05-13T05:30:39Z", "author": {"login": "malithie"}, "path": "modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/saml/SAMLMetadataTestCase.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.wso2.identity.integration.test.saml;\n+\n+import org.apache.http.HttpResponse;\n+import org.apache.http.client.HttpClient;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.impl.client.HttpClientBuilder;\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.testng.Assert;\n+import org.testng.annotations.BeforeClass;\n+import org.testng.annotations.Test;\n+import org.wso2.carbon.tenant.mgt.stub.TenantMgtAdminServiceExceptionException;\n+import org.wso2.identity.integration.common.clients.TenantManagementServiceClient;\n+import org.wso2.identity.integration.common.utils.ISIntegrationTest;\n+import org.wso2.identity.integration.test.utils.DataExtractUtil;\n+import org.json.JSONObject;\n+import org.json.XML;\n+\n+import java.io.IOException;\n+\n+public class SAMLMetadataTestCase extends ISIntegrationTest {\n+\n+    private static final String SAML_METADATA_ENDPOINT_SUPER_TENANT = \"https://localhost:9853/identity/metadata/saml2\";\n+    private static final String SAML_METADATA_ENDPOINT_TENANT = \"https://localhost:9853/t/wso2.com/identity/metadata/saml2\";\n+    private static final String SAML_SSO_ENDPOINT_TENANT = \"https://localhost:9853/samlsso?tenantDomain=wso2.com\";\n+    private static final String SAML_SSO_ENDPOINT_SUPER_TENANT = \"https://localhost:9853/samlsso\";\n+    private static final String SAMLARTRESOLVE_ENDPOINT = \"https://localhost:9853/samlartresolve\";\n+    private TenantManagementServiceClient tenantServiceClient;\n+\n+    @BeforeClass(alwaysRun = true)\n+    public void testInit() throws Exception {\n+\n+        super.init();\n+        tenantServiceClient = new TenantManagementServiceClient(isServer.getContextUrls().getBackEndUrl(),\n+                sessionCookie);\n+    }\n+\n+    @Test(groups = \"wso2.is\", description = \"This test method will test SAML Metadata endpoints.\")\n+    public void getSAMLMetadata() throws IOException, TenantMgtAdminServiceExceptionException, JSONException {\n+\n+        testResponseContent(SAML_METADATA_ENDPOINT_SUPER_TENANT, SAML_SSO_ENDPOINT_SUPER_TENANT);\n+        tenantServiceClient.addTenant(\"wso2.com\", \"John\", \"password\",\n+                \"john@friends.com\", \"John\", \"Smith\");\n+        testResponseContent(SAML_METADATA_ENDPOINT_TENANT, SAML_SSO_ENDPOINT_TENANT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ab572585a54837ade63020646e1add912218583"}, "originalPosition": 62}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7205b2ba56c81240aaa592dd2aea29221f75c4b", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2/product-is/commit/e7205b2ba56c81240aaa592dd2aea29221f75c4b", "committedDate": "2020-05-13T08:48:04Z", "message": "Remove new tenant creation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84bbe62616f1cb3ec229e8949a650e7a85acf984", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2/product-is/commit/84bbe62616f1cb3ec229e8949a650e7a85acf984", "committedDate": "2020-05-13T10:18:29Z", "message": "Test SAML Metadata endpoint for super tenant with carbon.super path param"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwODM0MTQ3", "url": "https://github.com/wso2/product-is/pull/8319#pullrequestreview-410834147", "createdAt": "2020-05-13T11:33:24Z", "commit": {"oid": "84bbe62616f1cb3ec229e8949a650e7a85acf984"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMTozMzoyNFrOGUtU1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMTozMzoyNFrOGUtU1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM2NzMxNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"https://localhost:9853//t/carbon.super/identity/metadata/saml2\";\n          \n          \n            \n                        \"https://localhost:9853/t/carbon.super/identity/metadata/saml2\";", "url": "https://github.com/wso2/product-is/pull/8319#discussion_r424367316", "createdAt": "2020-05-13T11:33:24Z", "author": {"login": "mefarazath"}, "path": "modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/saml/SAMLMetadataTestCase.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.wso2.identity.integration.test.saml;\n+\n+import org.apache.http.HttpResponse;\n+import org.apache.http.client.HttpClient;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.impl.client.HttpClientBuilder;\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.testng.Assert;\n+import org.testng.annotations.Test;\n+import org.wso2.carbon.tenant.mgt.stub.TenantMgtAdminServiceExceptionException;\n+import org.wso2.identity.integration.common.utils.ISIntegrationTest;\n+import org.wso2.identity.integration.test.utils.DataExtractUtil;\n+import org.json.JSONObject;\n+import org.json.XML;\n+\n+import java.io.IOException;\n+\n+public class SAMLMetadataTestCase extends ISIntegrationTest {\n+\n+    private static final String SAML_METADATA_ENDPOINT_SUPER_TENANT = \"https://localhost:9853/identity/metadata/saml2\";\n+    private static final String SAML_METADATA_ENDPOINT_TENANT =\n+            \"https://localhost:9853/t/wso2.com/identity/metadata/saml2\";\n+    private static final String SAML_METADATA_ENDPOINT_WITH_SUPER_TENANT_AS_PATH_PARAM =\n+            \"https://localhost:9853//t/carbon.super/identity/metadata/saml2\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84bbe62616f1cb3ec229e8949a650e7a85acf984"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwODM5NzIz", "url": "https://github.com/wso2/product-is/pull/8319#pullrequestreview-410839723", "createdAt": "2020-05-13T11:41:51Z", "commit": {"oid": "84bbe62616f1cb3ec229e8949a650e7a85acf984"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMTo0MTo1MVrOGUtltQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMTo0MTo1MVrOGUtltQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM3MTYzNw==", "bodyText": "Shall we add a message for the null case", "url": "https://github.com/wso2/product-is/pull/8319#discussion_r424371637", "createdAt": "2020-05-13T11:41:51Z", "author": {"login": "Abilashini"}, "path": "modules/integration/tests-integration/tests-backend/src/test/java/org/wso2/identity/integration/test/saml/SAMLMetadataTestCase.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.wso2.identity.integration.test.saml;\n+\n+import org.apache.http.HttpResponse;\n+import org.apache.http.client.HttpClient;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.impl.client.HttpClientBuilder;\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.testng.Assert;\n+import org.testng.annotations.Test;\n+import org.wso2.carbon.tenant.mgt.stub.TenantMgtAdminServiceExceptionException;\n+import org.wso2.identity.integration.common.utils.ISIntegrationTest;\n+import org.wso2.identity.integration.test.utils.DataExtractUtil;\n+import org.json.JSONObject;\n+import org.json.XML;\n+\n+import java.io.IOException;\n+\n+public class SAMLMetadataTestCase extends ISIntegrationTest {\n+\n+    private static final String SAML_METADATA_ENDPOINT_SUPER_TENANT = \"https://localhost:9853/identity/metadata/saml2\";\n+    private static final String SAML_METADATA_ENDPOINT_TENANT =\n+            \"https://localhost:9853/t/wso2.com/identity/metadata/saml2\";\n+    private static final String SAML_METADATA_ENDPOINT_WITH_SUPER_TENANT_AS_PATH_PARAM =\n+            \"https://localhost:9853//t/carbon.super/identity/metadata/saml2\";\n+    private static final String SAML_SSO_ENDPOINT_TENANT = \"https://localhost:9853/samlsso?tenantDomain=wso2.com\";\n+    private static final String SAML_SSO_ENDPOINT_SUPER_TENANT = \"https://localhost:9853/samlsso\";\n+    private static final String SAMLARTRESOLVE_ENDPOINT = \"https://localhost:9853/samlartresolve\";\n+\n+    @Test(groups = \"wso2.is\", description = \"This test method will test SAML Metadata endpoints.\")\n+    public void getSAMLMetadata() throws IOException, TenantMgtAdminServiceExceptionException, JSONException {\n+\n+        testResponseContent(SAML_METADATA_ENDPOINT_SUPER_TENANT, SAML_SSO_ENDPOINT_SUPER_TENANT);\n+        testResponseContent(SAML_METADATA_ENDPOINT_WITH_SUPER_TENANT_AS_PATH_PARAM, SAML_SSO_ENDPOINT_SUPER_TENANT);\n+        testResponseContent(SAML_METADATA_ENDPOINT_TENANT, SAML_SSO_ENDPOINT_TENANT);\n+    }\n+\n+    private void testResponseContent(String samlMetadataEndpoint, String samlEndpoint)\n+            throws IOException, JSONException {\n+\n+        HttpClient client = HttpClientBuilder.create().build();\n+        HttpResponse httpResponse = sendGetRequest(client, samlMetadataEndpoint);\n+        String content = DataExtractUtil.getContentData(httpResponse);\n+        Assert.assertNotNull(content);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84bbe62616f1cb3ec229e8949a650e7a85acf984"}, "originalPosition": 62}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "615aad369e02f588fa1836383528faea0b3ca014", "author": {"user": {"login": "GANGANI", "name": "Gangani Chamika"}}, "url": "https://github.com/wso2/product-is/commit/615aad369e02f588fa1836383528faea0b3ca014", "committedDate": "2020-05-13T12:32:26Z", "message": "Correct url and add message for content null case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwODc3NDUx", "url": "https://github.com/wso2/product-is/pull/8319#pullrequestreview-410877451", "createdAt": "2020-05-13T12:35:36Z", "commit": {"oid": "615aad369e02f588fa1836383528faea0b3ca014"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNjM3MDEx", "url": "https://github.com/wso2/product-is/pull/8319#pullrequestreview-411637011", "createdAt": "2020-05-14T09:42:35Z", "commit": {"oid": "615aad369e02f588fa1836383528faea0b3ca014"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1273, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}