{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkxOTM0MTk0", "number": 13600, "title": "[WFLY-13807] EE: Add component class info to interface based proxy to preserve validation metadata", "bodyText": "JIRA: https://issues.redhat.com/browse/WFLY-13807\nThis PR supercedes #13526, and fixed the 2 test failures in #13526", "createdAt": "2020-09-23T17:34:46Z", "url": "https://github.com/wildfly/wildfly/pull/13600", "merged": true, "mergeCommit": {"oid": "18f94122d79aa9923fae7435c0689bb670ad45a2"}, "closed": true, "closedAt": "2020-09-26T01:55:18Z", "author": {"login": "chengfang"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLtUuXAH2gAyNDkxOTM0MTk0Ojg2ZDRkMWU4MzIwNWQ3MzFhMGFlOWRlY2ZmMGQxZDMyZjYzOWMzYzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMcBFPgFqTQ5NjgzNzA0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "86d4d1e83205d731a0ae9decff0d1d32f639c3c0", "author": {"user": {"login": "tadamski", "name": "Tomasz Adamski"}}, "url": "https://github.com/wildfly/wildfly/commit/86d4d1e83205d731a0ae9decff0d1d32f639c3c0", "committedDate": "2020-09-23T14:18:46Z", "message": "[WFLY-13807] EE: Add component class info to interface based proxy to preserve validation metadata"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9055bcef847df36666c819fe36623abdb76a1022", "author": {"user": {"login": "chengfang", "name": "Cheng Fang"}}, "url": "https://github.com/wildfly/wildfly/commit/9055bcef847df36666c819fe36623abdb76a1022", "committedDate": "2020-09-23T17:25:46Z", "message": "WFLY-13807 use Object as proxy super class if the component class has no default constructor; remove empty web.xml from EjbBeanValidationTestCase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MTYzMTg2", "url": "https://github.com/wildfly/wildfly/pull/13600#pullrequestreview-495163186", "createdAt": "2020-09-24T01:39:04Z", "commit": {"oid": "9055bcef847df36666c819fe36623abdb76a1022"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwMTozOTowNVrOHXGvnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwMTozOTowNVrOHXGvnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzk4OTc4OA==", "bodyText": "This is on the request path and should be optimized to a single map lookup.", "url": "https://github.com/wildfly/wildfly/pull/13600#discussion_r493989788", "createdAt": "2020-09-24T01:39:05Z", "author": {"login": "bstansberry"}, "path": "ee/src/main/java/org/jboss/as/ee/component/ViewService.java", "diffHunk": "@@ -193,11 +195,24 @@ public Object invoke(InterceptorContext interceptorContext) throws Exception {\n             if(component instanceof BasicComponent) {\n                 ((BasicComponent) component).waitForComponentStart();\n             }\n-            final Method method = interceptorContext.getMethod();\n+            final Method method = matchMethod(interceptorContext.getMethod());\n             final Interceptor interceptor = viewInterceptors.get(method);\n             return interceptor.processInvocation(interceptorContext);\n         }\n \n+        private Method matchMethod(Method invokedMethod) {\n+            if (invokedMethod.getDeclaringClass().isInterface()) {\n+                for (Method beanMethod : proxyFactory.getCachedMethods()) {\n+                    if (MethodIdentifier.getIdentifierForMethod(beanMethod).equals(MethodIdentifier.getIdentifierForMethod(invokedMethod))) {\n+                        return beanMethod;\n+                    }\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9055bcef847df36666c819fe36623abdb76a1022"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7340ad1a5b25be7638ef5d4c7eae43d49c20064", "author": {"user": {"login": "chengfang", "name": "Cheng Fang"}}, "url": "https://github.com/wildfly/wildfly/commit/a7340ad1a5b25be7638ef5d4c7eae43d49c20064", "committedDate": "2020-09-25T18:12:51Z", "message": "Use a map to match ejb invoked method to its view method in ViewService; catch generic Exception instead of NoSuchMethodException when calling getConstructor in DefaultComponentViewConfigurator"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2ODM3MDQx", "url": "https://github.com/wildfly/wildfly/pull/13600#pullrequestreview-496837041", "createdAt": "2020-09-25T20:42:51Z", "commit": {"oid": "a7340ad1a5b25be7638ef5d4c7eae43d49c20064"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3798, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}