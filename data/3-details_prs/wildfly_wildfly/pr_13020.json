{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3MjkzNTMw", "number": 13020, "title": "Fix for WFLY-13129, Example CLI script", "bodyText": "Issue: https://issues.redhat.com/browse/WFLY-13129\nCommunity doc is included in this PR.\nIntroduce a CLI script to apply to standalone configurations to contain microprofile, evolve security configuration to rely on elytron, remove security subsystem and ManagementRealm.", "createdAt": "2020-02-19T17:31:56Z", "url": "https://github.com/wildfly/wildfly/pull/13020", "merged": true, "mergeCommit": {"oid": "64ae9135948bfcf1ccfeb7ce0ac4c8f0ad435b86"}, "closed": true, "closedAt": "2020-04-29T14:48:34Z", "author": {"login": "jfdenise"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM9_yFgBqjMxMjM0OTI4NzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYHpaZABqjMyMzg1NzA0MDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "95d281574110dd0adf9cc91b7dc18edf3835bc36", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/95d281574110dd0adf9cc91b7dc18edf3835bc36", "committedDate": "2020-02-19T17:25:43Z", "message": "Fix for WFLY-13129, Example CLI script, testsuite/microprofile changes"}, "afterCommit": {"oid": "dc5b40b38fb1344b9450977a447a9227a86bdff3", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/dc5b40b38fb1344b9450977a447a9227a86bdff3", "committedDate": "2020-03-12T16:06:30Z", "message": "Fix for WFLY-13129, Example CLI script to evolve standalone configurations with microprofile"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MTU4MTU4", "url": "https://github.com/wildfly/wildfly/pull/13020#pullrequestreview-386158158", "createdAt": "2020-04-02T07:11:03Z", "commit": {"oid": "dc5b40b38fb1344b9450977a447a9227a86bdff3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQwNzoxMTowM1rOF_eCVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQwNzoxMTowM1rOF_eCVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5NjcyNQ==", "bodyText": "What about slimming the ApplicationRealm so it is just about default SSL, as Darran suggested in the analysis.", "url": "https://github.com/wildfly/wildfly/pull/13020#discussion_r402096725", "createdAt": "2020-04-02T07:11:03Z", "author": {"login": "OndrejKotek"}, "path": "galleon-pack/src/main/resources/packages/docs.examples/content/docs/examples/enable-microprofile.cli", "diffHunk": "@@ -0,0 +1,59 @@\n+# This CLI script allows to enable Microprofile for the standalone configurations.\n+# By default, standalone.xml is updated.\n+# Run it from JBOSS_HOME as:\n+# bin/jboss-cli.sh --file=docs/examples/enable-microprofile.cli [-Dconfig=<standalone-full.xml|standalone-ha.xml|standalone-full-ha.xml>]\n+\n+embed-server --server-config=${config:standalone.xml}\n+\n+echo INFO: Updating configuration to use elytron\n+\n+/subsystem=undertow/application-security-domain=other:add(security-domain=ApplicationDomain)\n+/subsystem=ejb3/application-security-domain=other:add(security-domain=ApplicationDomain)\n+/subsystem=batch-jberet:write-attribute(name=security-domain, value=ApplicationDomain)\n+\n+# This applies to full configurations only.\n+if (outcome == success) of /subsystem=messaging-activemq/server=default:read-resource\n+  /subsystem=messaging-activemq/server=default:undefine-attribute(name=security-domain)\n+  /subsystem=messaging-activemq/server=default:write-attribute(name=elytron-domain, value=ApplicationDomain)\n+end-if\n+\n+/subsystem=remoting/http-connector=http-remoting-connector:write-attribute(name=sasl-authentication-factory, value=application-sasl-authentication)\n+/subsystem=remoting/http-connector=http-remoting-connector:undefine-attribute(name=security-realm)\n+\n+/core-service=management/access=identity:add(security-domain=ManagementDomain)\n+/core-service=management/management-interface=http-interface:write-attribute(name=http-upgrade,value={enabled=true, sasl-authentication-factory=management-sasl-authentication})\n+/core-service=management/management-interface=http-interface:write-attribute(name=http-authentication-factory,value=management-http-authentication)\n+/core-service=management/management-interface=http-interface:undefine-attribute(name=security-realm)\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc5b40b38fb1344b9450977a447a9227a86bdff3"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fbcb21c00e513cc24658a9191b0a4afe92604d3", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/7fbcb21c00e513cc24658a9191b0a4afe92604d3", "committedDate": "2020-04-16T07:34:14Z", "message": "Fix for WFLY-13129, Example CLI script to evolve standalone configurations with microprofile"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc5b40b38fb1344b9450977a447a9227a86bdff3", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/dc5b40b38fb1344b9450977a447a9227a86bdff3", "committedDate": "2020-03-12T16:06:30Z", "message": "Fix for WFLY-13129, Example CLI script to evolve standalone configurations with microprofile"}, "afterCommit": {"oid": "7fbcb21c00e513cc24658a9191b0a4afe92604d3", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/7fbcb21c00e513cc24658a9191b0a4afe92604d3", "committedDate": "2020-04-16T07:34:14Z", "message": "Fix for WFLY-13129, Example CLI script to evolve standalone configurations with microprofile"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3623, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}