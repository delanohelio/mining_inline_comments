{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0OTY0MDkz", "number": 13510, "title": "[WFLY-13806] Add subsystem parsing of persistence.xml documents in th\u2026", "bodyText": "\u2026e EE 9 namespace\nhttps://issues.redhat.com/browse/WFLY-13806", "createdAt": "2020-08-27T21:35:04Z", "url": "https://github.com/wildfly/wildfly/pull/13510", "merged": true, "mergeCommit": {"oid": "396f80790cdbcd0ad4dd2c6e102cc142665d0be9"}, "closed": true, "closedAt": "2020-10-23T01:30:46Z", "author": {"login": "bstansberry"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDHgamgFqTQ3NzEwNTQ0OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVHpANAFqTUxNTA3NjUyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3MTA1NDQ5", "url": "https://github.com/wildfly/wildfly/pull/13510#pullrequestreview-477105449", "createdAt": "2020-08-27T21:43:45Z", "commit": {"oid": "c548c0c35ab9773cf75cdcfc9406ddf6efa468ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3MTA1NzIy", "url": "https://github.com/wildfly/wildfly/pull/13510#pullrequestreview-477105722", "createdAt": "2020-08-27T21:44:18Z", "commit": {"oid": "c548c0c35ab9773cf75cdcfc9406ddf6efa468ea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMTo0NDoxOFrOHIiUWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QyMTo0NDoxOFrOHIiUWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcxMjkyMw==", "bodyText": "Thanks for adding this cool test, great idea!", "url": "https://github.com/wildfly/wildfly/pull/13510#discussion_r478712923", "createdAt": "2020-08-27T21:44:18Z", "author": {"login": "scottmarlow"}, "path": "jpa/subsystem/src/test/java/org/jboss/as/jpa/puparser/PersistenceUnitXmlParserTestCase.java", "diffHunk": "@@ -59,4 +64,57 @@ public void testVersion() throws Exception {\n         String version = metadata.getPersistenceXMLSchemaVersion();\n         assertEquals(\"1.0\", version);\n     }\n+\n+    @Test", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c548c0c35ab9773cf75cdcfc9406ddf6efa468ea"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NzE1MjA2", "url": "https://github.com/wildfly/wildfly/pull/13510#pullrequestreview-477715206", "createdAt": "2020-08-28T13:11:29Z", "commit": {"oid": "c548c0c35ab9773cf75cdcfc9406ddf6efa468ea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMzoxMToyOVrOHJEifQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMzoxMToyOVrOHJEifQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTI3MzU5Nw==", "bodyText": "Good question, for EE 8 I would like to default to the equivalent Jakarta (EE 8) Persistence 2.2 (http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd) as parsePU() is doing.\nFor EE 9, I would like to default to 3.0 as you did below for parsePU().", "url": "https://github.com/wildfly/wildfly/pull/13510#discussion_r479273597", "createdAt": "2020-08-28T13:11:29Z", "author": {"login": "scottmarlow"}, "path": "jpa/subsystem/src/main/java/org/jboss/as/jpa/puparser/PersistenceUnitXmlParser.java", "diffHunk": "@@ -94,8 +94,10 @@ public static PersistenceUnitMetadataHolder parse(final XMLStreamReader reader,\n                 version = Version.JPA_2_2;\n             } else if (\"2\".equals(versionString)) {\n                 version = Version.JPA_2_0;\n+            } else if (\"3.0\".equals(versionString)) {\n+                version = Version.JPA_3_0;\n             } else {\n-                version = Version.JPA_2_1;\n+                version = Version.JPA_2_1; // TODO is this still the right default?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c548c0c35ab9773cf75cdcfc9406ddf6efa468ea"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e2e3c1fbad6b325e8494f763daa910f9027c15f", "author": {"user": {"login": "bstansberry", "name": " Brian Stansberry"}}, "url": "https://github.com/wildfly/wildfly/commit/0e2e3c1fbad6b325e8494f763daa910f9027c15f", "committedDate": "2020-08-28T23:47:01Z", "message": "[WFLY-13806] Add subsystem parsing of persistence.xml documents in the EE 9 namespace"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c548c0c35ab9773cf75cdcfc9406ddf6efa468ea", "author": {"user": {"login": "bstansberry", "name": " Brian Stansberry"}}, "url": "https://github.com/wildfly/wildfly/commit/c548c0c35ab9773cf75cdcfc9406ddf6efa468ea", "committedDate": "2020-08-27T21:34:30Z", "message": "[WFLY-13806] Add subsystem parsing of persistence.xml documents in the EE 9 namespace"}, "afterCommit": {"oid": "0e2e3c1fbad6b325e8494f763daa910f9027c15f", "author": {"user": {"login": "bstansberry", "name": " Brian Stansberry"}}, "url": "https://github.com/wildfly/wildfly/commit/0e2e3c1fbad6b325e8494f763daa910f9027c15f", "committedDate": "2020-08-28T23:47:01Z", "message": "[WFLY-13806] Add subsystem parsing of persistence.xml documents in the EE 9 namespace"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MDcxMjk4", "url": "https://github.com/wildfly/wildfly/pull/13510#pullrequestreview-515071298", "createdAt": "2020-10-22T19:56:23Z", "commit": {"oid": "0e2e3c1fbad6b325e8494f763daa910f9027c15f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTo1NjoyNFrOHmxjuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxOTo1NjoyNFrOHmxjuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQxOTg5Ng==", "bodyText": "Cool idea to detect the default as Jakarta EE 8 Persistence 2.2 versus EE 9 Persistence 3.0!", "url": "https://github.com/wildfly/wildfly/pull/13510#discussion_r510419896", "createdAt": "2020-10-22T19:56:24Z", "author": {"login": "scottmarlow"}, "path": "jpa/subsystem/src/main/java/org/jboss/as/jpa/puparser/PersistenceUnitXmlParser.java", "diffHunk": "@@ -49,6 +49,19 @@\n public class PersistenceUnitXmlParser extends MetaDataElementParser {\n     // cache the trace enabled flag\n     private static final boolean traceEnabled = ROOT_LOGGER.isTraceEnabled();\n+    private static final Version DEFAULT_VERSION;\n+\n+    static {\n+        Version defaultVersion;\n+        try {\n+            // Try and load a jakarta namespace JPA API class to see if we're EE 8 or a later EE\n+            PersistenceUnitXmlParser.class.getClassLoader().loadClass(\"jakarta.persistence.SharedCacheMode\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e2e3c1fbad6b325e8494f763daa910f9027c15f"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MDc2NTIx", "url": "https://github.com/wildfly/wildfly/pull/13510#pullrequestreview-515076521", "createdAt": "2020-10-22T20:03:46Z", "commit": {"oid": "0e2e3c1fbad6b325e8494f763daa910f9027c15f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3846, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}