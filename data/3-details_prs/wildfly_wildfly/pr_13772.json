{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxOTU1MDEw", "number": 13772, "title": "WFLY-13792 Test for JSF deployment failure due to UnsupportedOperationExceptio\u2026", "bodyText": "Issue: https://issues.redhat.com/browse/WFLY-13792", "createdAt": "2020-12-03T17:36:30Z", "url": "https://github.com/wildfly/wildfly/pull/13772", "merged": true, "mergeCommit": {"oid": "256f4947570a584a585c6d7356b155e5b6455c8d"}, "closed": true, "closedAt": "2020-12-07T15:59:06Z", "author": {"login": "RanabirChakraborty"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdi1ZcMgFqTU0NDgyNDI2Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdi23U_ABqjQwNzI0NjM1MjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0ODI0MjYz", "url": "https://github.com/wildfly/wildfly/pull/13772#pullrequestreview-544824263", "createdAt": "2020-12-04T10:13:43Z", "commit": {"oid": "925998011b7e893c41c22ee7c4fb7e84d591d464"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDoxMzo0M1rOH_KELg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMDo0MjowMFrOH_LJJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk4NzI0Ng==", "bodyText": "There are two httpclient.execute(httpget) requests here, which is unnecessary to perform this test.", "url": "https://github.com/wildfly/wildfly/pull/13772#discussion_r535987246", "createdAt": "2020-12-04T10:13:43Z", "author": {"login": "yersan"}, "path": "testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/jsf/unsupportedwar/FaceletsViewMappingsTestCase.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.jboss.as.test.integration.jsf.unsupportedwar;\n+\n+import java.net.URL;\n+import org.apache.http.HttpEntity;\n+import org.apache.http.HttpResponse;\n+import org.apache.http.HttpStatus;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.http.util.EntityUtils;\n+import org.hamcrest.CoreMatchers;\n+import org.jboss.arquillian.container.test.api.Deployment;\n+import org.jboss.arquillian.container.test.api.RunAsClient;\n+import org.jboss.arquillian.junit.Arquillian;\n+import org.jboss.arquillian.test.api.ArquillianResource;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+/**\n+ * <p>Tests the JSF deployment failure due to UnsupportedOperationException when\n+ * <em>javax.faces.FACELETS_VIEW_MAPPINGS</em> is defined with something that\n+ * does not include <em>*.xhtml</em>.</p>\n+ *\n+ * @author Ranabir Chakraborty <rchakrab@redhat.com>\n+ *\n+ */\n+@RunWith(Arquillian.class)\n+@RunAsClient\n+public class FaceletsViewMappingsTestCase {\n+\n+    private static final String DEPLOYMENT = FaceletsViewMappingsTestCase.class.getSimpleName();\n+\n+    @ArquillianResource\n+    private URL url;\n+\n+    @Deployment\n+    public static WebArchive deployment() {\n+        final Package DEPLOYMENT_PACKAGE = HelloBean.class.getPackage();\n+        WebArchive war = ShrinkWrap.create(WebArchive.class, DEPLOYMENT + \".war\");\n+        war.addClasses(HelloBean.class, ConfigurationBean.class);\n+        war.addAsWebInfResource(DEPLOYMENT_PACKAGE, \"web.xml\", \"web.xml\");\n+        war.addAsWebResource(DEPLOYMENT_PACKAGE, \"hello.jsf\", \"hello.jsf\");\n+        return war;\n+    }\n+\n+    @SuppressWarnings(\"deprecation\")\n+    @Test\n+    public void testHelloWorld() throws Exception {\n+        try (CloseableHttpClient httpclient = HttpClients.createDefault()) {\n+            String Url = url.toExternalForm();\n+            HttpGet httpget = new HttpGet(Url);\n+            httpclient.execute(httpget);\n+\n+            HttpResponse response = httpclient.execute(httpget);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "925998011b7e893c41c22ee7c4fb7e84d591d464"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk4OTI2OQ==", "bodyText": "Suggestion, instead of \"Operation failed\", could you add something more informative? that would helps if you are reviewing the logs. \"Operation failed\" sounds like there is a management operation involved. In addition, you could add the result of the response.getStatusLine().getStatusCode() so you can easily see in the logs what was returned by the previous HTTP request.", "url": "https://github.com/wildfly/wildfly/pull/13772#discussion_r535989269", "createdAt": "2020-12-04T10:16:59Z", "author": {"login": "yersan"}, "path": "testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/jsf/unsupportedwar/FaceletsViewMappingsTestCase.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.jboss.as.test.integration.jsf.unsupportedwar;\n+\n+import java.net.URL;\n+import org.apache.http.HttpEntity;\n+import org.apache.http.HttpResponse;\n+import org.apache.http.HttpStatus;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.http.util.EntityUtils;\n+import org.hamcrest.CoreMatchers;\n+import org.jboss.arquillian.container.test.api.Deployment;\n+import org.jboss.arquillian.container.test.api.RunAsClient;\n+import org.jboss.arquillian.junit.Arquillian;\n+import org.jboss.arquillian.test.api.ArquillianResource;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+/**\n+ * <p>Tests the JSF deployment failure due to UnsupportedOperationException when\n+ * <em>javax.faces.FACELETS_VIEW_MAPPINGS</em> is defined with something that\n+ * does not include <em>*.xhtml</em>.</p>\n+ *\n+ * @author Ranabir Chakraborty <rchakrab@redhat.com>\n+ *\n+ */\n+@RunWith(Arquillian.class)\n+@RunAsClient\n+public class FaceletsViewMappingsTestCase {\n+\n+    private static final String DEPLOYMENT = FaceletsViewMappingsTestCase.class.getSimpleName();\n+\n+    @ArquillianResource\n+    private URL url;\n+\n+    @Deployment\n+    public static WebArchive deployment() {\n+        final Package DEPLOYMENT_PACKAGE = HelloBean.class.getPackage();\n+        WebArchive war = ShrinkWrap.create(WebArchive.class, DEPLOYMENT + \".war\");\n+        war.addClasses(HelloBean.class, ConfigurationBean.class);\n+        war.addAsWebInfResource(DEPLOYMENT_PACKAGE, \"web.xml\", \"web.xml\");\n+        war.addAsWebResource(DEPLOYMENT_PACKAGE, \"hello.jsf\", \"hello.jsf\");\n+        return war;\n+    }\n+\n+    @SuppressWarnings(\"deprecation\")\n+    @Test\n+    public void testHelloWorld() throws Exception {\n+        try (CloseableHttpClient httpclient = HttpClients.createDefault()) {\n+            String Url = url.toExternalForm();\n+            HttpGet httpget = new HttpGet(Url);\n+            httpclient.execute(httpget);\n+\n+            HttpResponse response = httpclient.execute(httpget);\n+            Assert.assertEquals(\"Operation failed\", HttpStatus.SC_OK, response.getStatusLine().getStatusCode());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "925998011b7e893c41c22ee7c4fb7e84d591d464"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk5MDIxMQ==", "bodyText": "Harmless, but Serializable is not needed for RequestScope, feel free to remove it to make the code more clean.", "url": "https://github.com/wildfly/wildfly/pull/13772#discussion_r535990211", "createdAt": "2020-12-04T10:18:27Z", "author": {"login": "yersan"}, "path": "testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/jsf/unsupportedwar/HelloBean.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.jboss.as.test.integration.jsf.unsupportedwar;\n+\n+import java.io.Serializable;\n+import javax.enterprise.context.RequestScoped;\n+import javax.inject.Named;\n+\n+@Named(value = \"helloBean\")\n+@RequestScoped\n+public class HelloBean implements Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "925998011b7e893c41c22ee7c4fb7e84d591d464"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk5MzI3NA==", "bodyText": "tabs vs spaces, could you use spaces to be consistent?", "url": "https://github.com/wildfly/wildfly/pull/13772#discussion_r535993274", "createdAt": "2020-12-04T10:23:11Z", "author": {"login": "yersan"}, "path": "testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/jsf/unsupportedwar/web.xml", "diffHunk": "@@ -0,0 +1,34 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+    JBoss, Home of Professional Open Source\n+    Copyright 2020, Red Hat, Inc. and/or its affiliates, and individual\n+    contributors by the @authors tag. See the copyright.txt in the\n+    distribution for a full listing of individual contributors.\n+    Licensed under the Apache License, Version 2.0 (the \"License\");\n+    you may not use this file except in compliance with the License.\n+    You may obtain a copy of the License at\n+    http://www.apache.org/licenses/LICENSE-2.0\n+    Unless required by applicable law or agreed to in writing, software\n+    distributed under the License is distributed on an \"AS IS\" BASIS,\n+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+    See the License for the specific language governing permissions and\n+    limitations under the License.\n+-->\n+<web-app version=\"4.0\"\n+\txmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n+\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+\txsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd\">\n+\n+\t<context-param>\n+\t\t<param-name>javax.faces.DEFAULT_SUFFIX</param-name>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "925998011b7e893c41c22ee7c4fb7e84d591d464"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAwNDkwMg==", "bodyText": "Maybe this was only my impression, but when I read the javadoc of this test I was expecting that the test was going to assert that a deployment will fail with an UnsupportedOperationException when javax.faces.FACELETS_VIEW_MAPPINGS does not includes *.xhtml, I had to navigate to the Jira to understand it better.\nIf that is only my impression, that's fine, but my feeling was we can describe it differently. Something like verifies that an JSF application can be deployed if javax.faces.FACELETS_VIEW_MAPPINGS does not includes *.xhtml.", "url": "https://github.com/wildfly/wildfly/pull/13772#discussion_r536004902", "createdAt": "2020-12-04T10:42:00Z", "author": {"login": "yersan"}, "path": "testsuite/integration/basic/src/test/java/org/jboss/as/test/integration/jsf/unsupportedwar/FaceletsViewMappingsTestCase.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.jboss.as.test.integration.jsf.unsupportedwar;\n+\n+import java.net.URL;\n+import org.apache.http.HttpEntity;\n+import org.apache.http.HttpResponse;\n+import org.apache.http.HttpStatus;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.http.util.EntityUtils;\n+import org.hamcrest.CoreMatchers;\n+import org.jboss.arquillian.container.test.api.Deployment;\n+import org.jboss.arquillian.container.test.api.RunAsClient;\n+import org.jboss.arquillian.junit.Arquillian;\n+import org.jboss.arquillian.test.api.ArquillianResource;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.junit.Assert;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+/**\n+ * <p>Tests the JSF deployment failure due to UnsupportedOperationException when\n+ * <em>javax.faces.FACELETS_VIEW_MAPPINGS</em> is defined with something that\n+ * does not include <em>*.xhtml</em>.</p>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "925998011b7e893c41c22ee7c4fb7e84d591d464"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4c4e3e45f1d4c4d428a6f5425524abad5f92552", "author": {"user": {"login": "RanabirChakraborty", "name": "Ranabir Chakraborty"}}, "url": "https://github.com/wildfly/wildfly/commit/f4c4e3e45f1d4c4d428a6f5425524abad5f92552", "committedDate": "2020-12-04T12:25:25Z", "message": "WFLY-13792 JSF deployment failure due to UnsupportedOperationException when javax.faces.FACELETS_VIEW_MAPPINGS is defined"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "925998011b7e893c41c22ee7c4fb7e84d591d464", "author": {"user": {"login": "RanabirChakraborty", "name": "Ranabir Chakraborty"}}, "url": "https://github.com/wildfly/wildfly/commit/925998011b7e893c41c22ee7c4fb7e84d591d464", "committedDate": "2020-12-03T17:33:41Z", "message": "WFLY-13792 JSF deployment failure due to UnsupportedOperationException when javax.faces.FACELETS_VIEW_MAPPINGS is defined"}, "afterCommit": {"oid": "f4c4e3e45f1d4c4d428a6f5425524abad5f92552", "author": {"user": {"login": "RanabirChakraborty", "name": "Ranabir Chakraborty"}}, "url": "https://github.com/wildfly/wildfly/commit/f4c4e3e45f1d4c4d428a6f5425524abad5f92552", "committedDate": "2020-12-04T12:25:25Z", "message": "WFLY-13792 JSF deployment failure due to UnsupportedOperationException when javax.faces.FACELETS_VIEW_MAPPINGS is defined"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3783, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}