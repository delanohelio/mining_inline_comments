{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY4NzYxNDIx", "number": 13487, "title": "[WFLY-13150] Create a Galleon layer for distributable web", "bodyText": "Galleon layer to provide the distributable web subsystem configured with a local web container cache.\nJira issue: https://issues.redhat.com/browse/WFLY-13150\nWildFly proposal: wildfly/wildfly-proposals#340", "createdAt": "2020-08-17T11:06:57Z", "url": "https://github.com/wildfly/wildfly/pull/13487", "merged": true, "mergeCommit": {"oid": "50a0019480e54396b729c84f7fe04cd6f84b4167"}, "closed": true, "closedAt": "2020-12-16T02:29:12Z", "author": {"login": "yersan"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_wdhaAFqTQ2ODM3MTk4Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmg5IFgFqTU1Mjg3Mjk0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MzcxOTg3", "url": "https://github.com/wildfly/wildfly/pull/13487#pullrequestreview-468371987", "createdAt": "2020-08-17T11:11:00Z", "commit": {"oid": "6a09e7a935b998e1ffa764c1ba5c7113b5a3d432"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxMToxMTowMFrOHBkbPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxMToxMTowMFrOHBkbPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQwNzQyMQ==", "bodyText": "Hello @pferraro @rhusar ,\nCould you point me out to any missing test that should be included for this Galleon layer? The above list are the tests I found suitable to work with this kind of configuration but I want to be sure I'm not missing anything, I'm not very familiar with the clustering test suite. Thanks!", "url": "https://github.com/wildfly/wildfly/pull/13487#discussion_r471407421", "createdAt": "2020-08-17T11:11:00Z", "author": {"login": "yersan"}, "path": "testsuite/integration/clustering/pom.xml", "diffHunk": "@@ -832,6 +832,42 @@\n                                     </systemPropertyVariables>\n                                 </configuration>\n                             </execution>\n+\n+                            <execution>\n+                                <id>ts.surefire.clustering.web-passivation</id>\n+                                <!-- Disabled by default; other profiles turn it on -->\n+                                <phase>none</phase>\n+                                <goals>\n+                                    <goal>test</goal>\n+                                </goals>\n+                                <configuration>\n+                                    <!-- Tests to execute. -->\n+                                    <includes>\n+                                        <include>org/jboss/as/test/clustering/cluster/web/**/CoarseSessionPassivationTestCase.java</include>\n+                                        <include>org/jboss/as/test/clustering/cluster/web/**/FineSessionPassivationTestCase.java</include>\n+                                        <include>org/jboss/as/test/clustering/cluster/web/**/CoarseTransactionalSessionActivationTestCase.java</include>\n+                                        <include>org/jboss/as/test/clustering/cluster/web/**/NonDistributableTestCase.java</include>\n+                                        <include>org/jboss/as/test/clustering/cluster/web/**/FineTransactionalSessionActivationTestCase.java</include>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a09e7a935b998e1ffa764c1ba5c7113b5a3d432"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6a09e7a935b998e1ffa764c1ba5c7113b5a3d432", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/6a09e7a935b998e1ffa764c1ba5c7113b5a3d432", "committedDate": "2020-08-17T11:01:29Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web"}, "afterCommit": {"oid": "31209a386c91bc0c1f36e9f99a386d6485833167", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/31209a386c91bc0c1f36e9f99a386d6485833167", "committedDate": "2020-08-17T13:16:37Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31209a386c91bc0c1f36e9f99a386d6485833167", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/31209a386c91bc0c1f36e9f99a386d6485833167", "committedDate": "2020-08-17T13:16:37Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web"}, "afterCommit": {"oid": "af46a733ee9237d3f403a4737f1f0e878efd266c", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/af46a733ee9237d3f403a4737f1f0e878efd266c", "committedDate": "2020-10-19T15:33:20Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "af46a733ee9237d3f403a4737f1f0e878efd266c", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/af46a733ee9237d3f403a4737f1f0e878efd266c", "committedDate": "2020-10-19T15:33:20Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web"}, "afterCommit": {"oid": "5cbcff3fa477486b9fda25004a58c720e84f5141", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/5cbcff3fa477486b9fda25004a58c720e84f5141", "committedDate": "2020-10-26T16:55:02Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5cbcff3fa477486b9fda25004a58c720e84f5141", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/5cbcff3fa477486b9fda25004a58c720e84f5141", "committedDate": "2020-10-26T16:55:02Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web"}, "afterCommit": {"oid": "1105bcbce7d70ba1eb1788853e2c80589af4f8d3", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/1105bcbce7d70ba1eb1788853e2c80589af4f8d3", "committedDate": "2020-11-04T09:21:46Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1105bcbce7d70ba1eb1788853e2c80589af4f8d3", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/1105bcbce7d70ba1eb1788853e2c80589af4f8d3", "committedDate": "2020-11-04T09:21:46Z", "message": "WIP"}, "afterCommit": {"oid": "e8469708c53968ecacda64e8ab31625bb9f09045", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/e8469708c53968ecacda64e8ab31625bb9f09045", "committedDate": "2020-11-04T09:24:34Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e8469708c53968ecacda64e8ab31625bb9f09045", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/e8469708c53968ecacda64e8ab31625bb9f09045", "committedDate": "2020-11-04T09:24:34Z", "message": "WIP"}, "afterCommit": {"oid": "e15985f8133624beb3cb66a8f263287447439300", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/e15985f8133624beb3cb66a8f263287447439300", "committedDate": "2020-11-04T11:43:07Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e15985f8133624beb3cb66a8f263287447439300", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/e15985f8133624beb3cb66a8f263287447439300", "committedDate": "2020-11-04T11:43:07Z", "message": "WIP"}, "afterCommit": {"oid": "5e3685fceb1e021138bd0b40554c3ac81679dc16", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/5e3685fceb1e021138bd0b40554c3ac81679dc16", "committedDate": "2020-11-04T16:53:21Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5e3685fceb1e021138bd0b40554c3ac81679dc16", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/5e3685fceb1e021138bd0b40554c3ac81679dc16", "committedDate": "2020-11-04T16:53:21Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache"}, "afterCommit": {"oid": "148b2e1a951860decb766aee03162d4516123a5c", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/148b2e1a951860decb766aee03162d4516123a5c", "committedDate": "2020-11-09T11:27:26Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "148b2e1a951860decb766aee03162d4516123a5c", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/148b2e1a951860decb766aee03162d4516123a5c", "committedDate": "2020-11-09T11:27:26Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache"}, "afterCommit": {"oid": "d07123e4e6597224cbb470375fe4f8c3734574d8", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/d07123e4e6597224cbb470375fe4f8c3734574d8", "committedDate": "2020-11-12T09:12:33Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/25556c65189cf2968a0e50aedaca9402cf643c4c", "committedDate": "2020-11-13T09:27:11Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d07123e4e6597224cbb470375fe4f8c3734574d8", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/d07123e4e6597224cbb470375fe4f8c3734574d8", "committedDate": "2020-11-12T09:12:33Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache"}, "afterCommit": {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/25556c65189cf2968a0e50aedaca9402cf643c4c", "committedDate": "2020-11-13T09:27:11Z", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MTk2OTc0", "url": "https://github.com/wildfly/wildfly/pull/13487#pullrequestreview-544196974", "createdAt": "2020-12-03T17:20:02Z", "commit": {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNzoyMDowMlrOH-oGfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNzoyMDowMlrOH-oGfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQzMDc4MQ==", "bodyText": "Hi @yersan - I might be missing something here, but IIUC the deployment is operated by Arquillian only when ts.bootable is set. What happens for Galleon - i.e. when ts.layers is set?", "url": "https://github.com/wildfly/wildfly/pull/13487#discussion_r535430781", "createdAt": "2020-12-03T17:20:02Z", "author": {"login": "fabiobrz"}, "path": "testsuite/integration/clustering/src/test/java/org/jboss/as/test/clustering/single/web/NonHaWebSessionPersistenceTestCase.java", "diffHunk": "@@ -99,8 +103,11 @@ public void testSessionPersistence(@ArquillianResource(SimpleServlet.class) @Ope\n             Assert.assertFalse(Boolean.valueOf(response.getFirstHeader(\"serialized\").getValue()));\n             response.getEntity().getContent().close();\n \n-            stop(CONTAINER_SINGLE);\n-            start(CONTAINER_SINGLE);\n+            NodeUtil.stop(this.controller, CONTAINER_SINGLE);\n+            NodeUtil.start(this.controller, CONTAINER_SINGLE);\n+            if (Boolean.getBoolean(\"ts.bootable\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c"}, "originalPosition": 95}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MDU2Njc5", "url": "https://github.com/wildfly/wildfly/pull/13487#pullrequestreview-548056679", "createdAt": "2020-12-09T10:46:15Z", "commit": {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyODM2MDUx", "url": "https://github.com/wildfly/wildfly/pull/13487#pullrequestreview-552836051", "createdAt": "2020-12-15T20:20:13Z", "commit": {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMDoyMDoxM1rOIGeUcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQyMDoyMDoxM1rOIGeUcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY1OTEyMw==", "bodyText": "FYI - this should use the distributable-web-local feature-group, not distributable-web.\nCurrently, that feature-group is buggy, as it specifies parameters that are not valid.\nSee https://issues.redhat.com/browse/WFLY-14231", "url": "https://github.com/wildfly/wildfly/pull/13487#discussion_r543659123", "createdAt": "2020-12-15T20:20:13Z", "author": {"login": "pferraro"}, "path": "ee-feature-pack/galleon-common/src/main/resources/layers/standalone/web-passivation/layer-spec.xml", "diffHunk": "@@ -1,5 +1,5 @@\n <?xml version=\"1.0\" ?>\n-<layer-spec xmlns=\"urn:jboss:galleon:layer-spec:1.0\" name=\"distributable-web\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyODcyOTQ1", "url": "https://github.com/wildfly/wildfly/pull/13487#pullrequestreview-552872945", "createdAt": "2020-12-15T21:05:43Z", "commit": {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3963, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}