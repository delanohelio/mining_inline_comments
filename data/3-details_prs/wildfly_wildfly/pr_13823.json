{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5NDE3MjM1", "number": 13823, "title": "Fix for WFLY-14190, EE9 tests for bootable jar", "bodyText": "Issues: https://issues.redhat.com/browse/WFLY-14190\nUpgraded wildfly-jar-maven-plugin to 3.0.0.Beta1. Moved the version definition out of the ts.bootable profile to be shared by ts.bootable and ts.bootable.ee9\nCI Run with ts.bootable.ee9 enabled: https://ci.wildfly.org/buildConfiguration/WF_BootableJarLinuxJdk8/235026\nCI Run with ts.bootable enabled: https://ci.wildfly.org/buildConfiguration/WF_BootableJarLinuxJdk8/235025\nCI Run with ts.bootable enabled (Windows JDK11): https://ci.wildfly.org/buildConfiguration/WF_BootableJarWindowsJdk11/235028\nCI Run with ts.bootable.ee9 enabled (Windows JDK11): https://ci.wildfly.org/buildConfiguration/WF_BootableJarWindowsJdk11/235030\nI have also fixed a problem only showing-up in integration/microprofile with the profile ts.ee9", "createdAt": "2020-12-14T12:34:01Z", "url": "https://github.com/wildfly/wildfly/pull/13823", "merged": true, "mergeCommit": {"oid": "8d9b600a90380e9cdca086ce3d0efff3c122eb11"}, "closed": true, "closedAt": "2020-12-16T19:06:03Z", "author": {"login": "jfdenise"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmXQ9hABqjQxMTM2NjY5MTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmzx1ggFqTU1Mzk5NzcyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "020712a71d4fbe3570b91652056ecc70b804cedd", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/020712a71d4fbe3570b91652056ecc70b804cedd", "committedDate": "2020-12-14T12:30:52Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}, "afterCommit": {"oid": "31f92ff16b77e80a967f90d314f154311f951118", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/31f92ff16b77e80a967f90d314f154311f951118", "committedDate": "2020-12-15T09:51:54Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31f92ff16b77e80a967f90d314f154311f951118", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/31f92ff16b77e80a967f90d314f154311f951118", "committedDate": "2020-12-15T09:51:54Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}, "afterCommit": {"oid": "285da0e03a7c179ecaa2be538e704d122e272654", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/285da0e03a7c179ecaa2be538e704d122e272654", "committedDate": "2020-12-15T15:54:44Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "285da0e03a7c179ecaa2be538e704d122e272654", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/285da0e03a7c179ecaa2be538e704d122e272654", "committedDate": "2020-12-15T15:54:44Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}, "afterCommit": {"oid": "b70a5edcc73b5240cecfb560adc70988557c7cb3", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/b70a5edcc73b5240cecfb560adc70988557c7cb3", "committedDate": "2020-12-16T08:21:48Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzNDU2ODIx", "url": "https://github.com/wildfly/wildfly/pull/13823#pullrequestreview-553456821", "createdAt": "2020-12-16T08:33:06Z", "commit": {"oid": "b70a5edcc73b5240cecfb560adc70988557c7cb3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwODozMzowNlrOIG5mtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwODozNzozOVrOIG5xcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDEwNjE2Nw==", "bodyText": "these 3 excludes can be removed as the tests have been moved to testsuite/integration/microprofile", "url": "https://github.com/wildfly/wildfly/pull/13823#discussion_r544106167", "createdAt": "2020-12-16T08:33:06Z", "author": {"login": "jmesnil"}, "path": "testsuite/integration/basic/pom.xml", "diffHunk": "@@ -2873,371 +3255,283 @@\n                         </executions>\n                     </plugin>\n                     <plugin>\n-                        <artifactId>maven-jar-plugin</artifactId>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-surefire-plugin</artifactId>\n                         <executions>\n+                            <!-- Disable the standard test executions. -->\n                             <execution>\n-                                <id>create-module-testDriver</id>\n-                                <goals>\n-                                    <goal>jar</goal>\n-                                </goals>\n-                                <phase>process-test-classes</phase>\n-                                <configuration>\n-                                    <outputDirectory>${project.build.directory}/extraContent/modules/org/jboss/test/testDriver/main</outputDirectory>\n-                                    <classesDirectory>${project.build.testOutputDirectory}</classesDirectory>\n-                                    <includes>\n-                                        <include>**/org/jboss/as/test/integration/jca/classloading/ClassloadingDataSource.class</include>\n-                                        <include>**/org/jboss/as/test/integration/jca/classloading/ClassloadingDriver.class</include>\n-                                        <include>**/org/jboss/as/test/integration/jca/classloading/TestConnection.class</include>\n-                                        <include>**/org/jboss/as/test/integration/jca/classloading/ClassloadingXADataSource.class</include>\n-                                        <include>**/org/jboss/as/test/integration/jca/classloading/TestXAConnection.class</include>\n-                                        <include>**/META-INF/services/java.sql.Driver</include>\n-                                    </includes>\n-                                    <finalName>testDriver</finalName>\n-                                    <classifier>bootableJar</classifier>\n-                                </configuration>\n+                                <id>default-test</id>\n+                                <phase>none</phase>\n                             </execution>\n                             <execution>\n-                                <id>create-module-cidExtensionModule</id>\n-                                <goals>\n-                                    <goal>jar</goal>\n-                                </goals>\n-                                <phase>process-test-classes</phase>\n-                                <configuration>\n-                                    <outputDirectory>${project.build.directory}/extraContent/modules/cidExtensionModule/main</outputDirectory>\n-                                    <classesDirectory>${project.build.testOutputDirectory}</classesDirectory>\n-                                    <includes>\n-                                        <include>**/org/jboss/as/test/integration/weld/extensions/cdiportableextensions/FunExtension.class</include>\n-                                        <include>**/org/jboss/as/test/integration/weld/extensions/cdiportableextensions/Funny.class</include>\n-                                        <include>**/META-INF/services/javax.enterprise.inject.spi.Extension</include>\n-                                    </includes>\n-                                    <finalName>weldTest</finalName>\n-                                    <classifier>bootableJar</classifier>\n-                                </configuration>\n+                                <id>basic-integration-default-full.surefire</id>\n+                                <phase>none</phase>\n                             </execution>\n                             <execution>\n-                                <id>create-module-test-alpha</id>\n-                                <goals>\n-                                    <goal>jar</goal>\n-                                </goals>\n-                                <phase>process-test-classes</phase>\n-                                <configuration>\n-                                    <outputDirectory>${project.build.directory}/extraContent/modules/test/alpha/main</outputDirectory>\n-                                    <classesDirectory>${project.build.testOutputDirectory}</classesDirectory>\n-                                    <includes>\n-                                        <include>**/org/jboss/as/test/integration/weld/modules/AlphaBean.class</include>\n-                                        <include>**/org/jboss/as/test/integration/weld/modules/AlphaLookup.class</include>\n-                                        <include>**/META-INF/beans.xml</include>\n-                                    </includes>\n-                                    <finalName>alpha</finalName>\n-                                    <classifier>bootableJar</classifier>\n-                                </configuration>\n+                                <id>basic-integration-default-web.surefire</id>\n+                                <phase>none</phase>\n                             </execution>\n                             <execution>\n-                                <id>create-module-test-bravo</id>\n-                                <goals>\n-                                    <goal>jar</goal>\n-                                </goals>\n-                                <phase>process-test-classes</phase>\n-                                <configuration>\n-                                    <outputDirectory>${project.build.directory}/extraContent/modules/test/bravo/main</outputDirectory>\n-                                    <classesDirectory>${project.build.testOutputDirectory}</classesDirectory>\n-                                    <includes>\n-                                        <include>**/org/jboss/as/test/integration/weld/modules/BravoBean.class</include>\n-                                        <include>**/org/jboss/as/test/integration/weld/modules/BravoLookup.class</include>\n-                                        <include>**/META-INF/beans.xml</include>\n-                                    </includes>\n-                                    <finalName>bravo</finalName>\n-                                    <classifier>bootableJar</classifier>\n-                                </configuration>\n+                                <id>basic-integration-2nd.surefire</id>\n+                                <phase>none</phase>\n                             </execution>\n                             <execution>\n-                                <id>create-module-test-charlie</id>\n-                                <goals>\n-                                    <goal>jar</goal>\n-                                </goals>\n-                                <phase>process-test-classes</phase>\n-                                <configuration>\n-                                    <outputDirectory>${project.build.directory}/extraContent/modules/test/charlie/main</outputDirectory>\n-                                    <classesDirectory>${project.build.testOutputDirectory}</classesDirectory>\n-                                    <includes>\n-                                        <include>**/org/jboss/as/test/integration/weld/modules/CharlieBean.class</include>\n-                                        <include>**/org/jboss/as/test/integration/weld/modules/CharlieLookup.class</include>\n-                                        <include>**/META-INF/beans.xml</include>\n-                                    </includes>\n-                                    <finalName>charlie</finalName>\n-                                    <classifier>bootableJar</classifier>\n-                                </configuration>\n+                                <id>basic-integration-ldap.surefire</id>\n+                                <phase>none</phase>\n                             </execution>\n+\n+                            <!-- Tests against the cloud-server install without legacy security -->\n                             <execution>\n-                                <id>create-module-test-delta</id>\n+                                <!-- We reuse the microprofile.surefire execution used for testing standalone-microprofile.xml\n+                                     as the set of tests we want is the same -->\n+                                <id>microprofile.surefire</id>\n+                                <phase>test</phase>\n                                 <goals>\n-                                    <goal>jar</goal>\n+                                    <goal>test</goal>\n                                 </goals>\n-                                <phase>process-test-classes</phase>\n                                 <configuration>\n-                                    <outputDirectory>${project.build.directory}/extraContent/modules/test/delta/main</outputDirectory>\n-                                    <classesDirectory>${project.build.testOutputDirectory}</classesDirectory>\n-                                    <includes>\n-                                        <include>**/org/jboss/as/test/integration/weld/modules/DeltaBean.class</include>\n-                                        <include>**/org/jboss/as/test/integration/weld/modules/DeltaLookup.class</include>\n-                                        <include>**/META-INF/beans.xml</include>\n-                                    </includes>\n-                                    <finalName>delta</finalName>\n-                                    <classifier>bootableJar</classifier>\n+                                    <systemPropertyVariables>\n+                                        <install.dir>${project.build.directory}/wildfly</install.dir>\n+                                        <bootable.jar>${project.build.directory}/test-wildfly-cloud-profile.jar</bootable.jar>\n+                                        <arquillian.xml>arquillian-bootable.xml</arquillian.xml>\n+                                    </systemPropertyVariables>\n+                                    <redirectTestOutputToFile>${testLogToFile}</redirectTestOutputToFile>\n+                                    <classpathDependencyExcludes>\n+                                        <classpathDependencyExclude>\n+                                            org.wildfly.arquillian:wildfly-arquillian-container-managed\n+                                        </classpathDependencyExclude>\n+                                    </classpathDependencyExcludes>\n+                                    <excludes combine.children=\"append\">\n+                                        <!-- For bootable-jar, custom modules have to be prepared aside in the time of jar packinging,\n+                                        which is not sustainable for all tests. -->\n+                                        <exclude>org/jboss/as/test/integration/security/vault/ExternalPasswordCommandsTestCase.java</exclude>\n+                                        <exclude>org/jboss/as/test/integration/security/vault/ExternalPasswordByClassTestCase.java</exclude>\n+                                        <exclude>org/jboss/as/test/integration/weld/modules/deployment/ModuleBeanDiscoveryModeTest.java</exclude>\n+                                        <exclude>org/jboss/as/test/integration/weld/modules/export/ExportedModuleTestCase.java</exclude>\n+                                        <!-- Requires extra modules -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b70a5edcc73b5240cecfb560adc70988557c7cb3"}, "originalPosition": 600}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDEwODUxNw==", "bodyText": "maybe, we should also add the comments that explains why these tests are excluded (as they require the creation of a JBoss Module)", "url": "https://github.com/wildfly/wildfly/pull/13823#discussion_r544108517", "createdAt": "2020-12-16T08:37:01Z", "author": {"login": "jmesnil"}, "path": "testsuite/integration/microprofile/pom.xml", "diffHunk": "@@ -661,6 +782,12 @@\n                                             org.wildfly.arquillian:wildfly-arquillian-container-managed\n                                         </classpathDependencyExclude>\n                                     </classpathDependencyExcludes>\n+                                    <excludes>\n+                                        <exclude>org/wildfly/test/integration/microprofile/jwt/ejb/JWTEJBTestCase.java</exclude>\n+                                        <exclude>org/wildfly/test/integration/microprofile/config/smallrye/converter/MicroProfileConfigConvertersTestCase</exclude>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b70a5edcc73b5240cecfb560adc70988557c7cb3"}, "originalPosition": 213}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDEwODkxMw==", "bodyText": "is there a reason to get this version here (as opposed to the top-level pom.xml)?", "url": "https://github.com/wildfly/wildfly/pull/13823#discussion_r544108913", "createdAt": "2020-12-16T08:37:39Z", "author": {"login": "jmesnil"}, "path": "testsuite/integration/pom.xml", "diffHunk": "@@ -48,6 +48,8 @@\n \n         <ts.elytron.cli>../../shared/enable-elytron.cli</ts.elytron.cli>\n         <wildfly.dir>${project.build.directory}/wildfly</wildfly.dir>\n+        \n+        <version.org.wildfly.jar.plugin>3.0.0.Beta1</version.org.wildfly.jar.plugin>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b70a5edcc73b5240cecfb560adc70988557c7cb3"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b70a5edcc73b5240cecfb560adc70988557c7cb3", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/b70a5edcc73b5240cecfb560adc70988557c7cb3", "committedDate": "2020-12-16T08:21:48Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}, "afterCommit": {"oid": "4de5c7434e50898d0c4ae41c7af524aff7b4c908", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/4de5c7434e50898d0c4ae41c7af524aff7b4c908", "committedDate": "2020-12-16T11:06:42Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4de5c7434e50898d0c4ae41c7af524aff7b4c908", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/4de5c7434e50898d0c4ae41c7af524aff7b4c908", "committedDate": "2020-12-16T11:06:42Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}, "afterCommit": {"oid": "2f5f10b1c99072a8f061f1ff02a0e416ae5e0aca", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/2f5f10b1c99072a8f061f1ff02a0e416ae5e0aca", "committedDate": "2020-12-16T12:31:25Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f5f10b1c99072a8f061f1ff02a0e416ae5e0aca", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/2f5f10b1c99072a8f061f1ff02a0e416ae5e0aca", "committedDate": "2020-12-16T12:31:25Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}, "afterCommit": {"oid": "db5cb18888bc6fde51a3772afe39925910b21ead", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/db5cb18888bc6fde51a3772afe39925910b21ead", "committedDate": "2020-12-16T15:12:57Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "812dd5c8c625f861b9f51063ffa1adbdae89adb4", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/812dd5c8c625f861b9f51063ffa1adbdae89adb4", "committedDate": "2020-12-16T16:00:06Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "db5cb18888bc6fde51a3772afe39925910b21ead", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/db5cb18888bc6fde51a3772afe39925910b21ead", "committedDate": "2020-12-16T15:12:57Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}, "afterCommit": {"oid": "812dd5c8c625f861b9f51063ffa1adbdae89adb4", "author": {"user": {"login": "jfdenise", "name": "Jean-Fran\u00e7ois Denise "}}, "url": "https://github.com/wildfly/wildfly/commit/812dd5c8c625f861b9f51063ffa1adbdae89adb4", "committedDate": "2020-12-16T16:00:06Z", "message": "Fix for WFLY-14190, EE9 tests for bootable jar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzOTk3NzI1", "url": "https://github.com/wildfly/wildfly/pull/13823#pullrequestreview-553997725", "createdAt": "2020-12-16T19:05:57Z", "commit": {"oid": "812dd5c8c625f861b9f51063ffa1adbdae89adb4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3707, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}