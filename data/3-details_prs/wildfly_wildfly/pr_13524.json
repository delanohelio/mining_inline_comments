{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3NTYxNzYy", "number": 13524, "title": "WFLY-13354  Add Galleon layers for the EJB subsystem", "bodyText": "JIRA: https://issues.redhat.com/browse/WFLY-13354\nRelated JIRA: https://issues.redhat.com/browse/EAP7-1524\nAnalysis doc: wildfly/wildfly-proposals#317\nThis pull request implements Galleon layers for the EJB subsystems. It includes 2 main ejb3 layers: ejb-lite and ejb, and 2 ancillary layers: ejb-local-cache and ejb-dist-cache. This PR also includes basic testing configuration and community doc for this feature. The other 2 layers included in the original plan, ejb-iiop and iiop-openjdk will be implemented in the future.\nMDB-related configuration and tests is not included in this PR; instead it will be implemented and delivered as a separate follow-up feature (WFLY-13797 Add a Galleon layer for messaging integration with a remote ActiveMQ broker)\nThis request currently includes multiple commits over time. I'll squash them if so desired.", "createdAt": "2020-09-02T04:32:38Z", "url": "https://github.com/wildfly/wildfly/pull/13524", "merged": true, "mergeCommit": {"oid": "71c02584bb9de40517aa96ed84891e4b966df204"}, "closed": true, "closedAt": "2020-09-09T20:31:36Z", "author": {"login": "chengfang"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFTrxmAFqTQ4MjAzNjc3NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdGzCGbAFqTQ4Mzg5Mjk1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMDM2Nzc1", "url": "https://github.com/wildfly/wildfly/pull/13524#pullrequestreview-482036775", "createdAt": "2020-09-03T17:02:51Z", "commit": {"oid": "33fb6f42af3ff3c2b7bf8eff4c633e6d89948567"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNzowMjo1MlrOHMvyJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNzowMjo1MlrOHMvyJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzEyNzg0Nw==", "bodyText": "This feature-group uses 'security=\"identity\"' which AFAICT introduces a requirement for the legacy security subsytem. Which isn't ok; we don't want layers to require the legacy security subsystem", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483127847", "createdAt": "2020-09-03T17:02:52Z", "author": {"login": "bstansberry"}, "path": "ee-feature-pack/galleon-common/src/main/resources/layers/standalone/iiop-openjdk/layer-spec.xml", "diffHunk": "@@ -0,0 +1,21 @@\n+<?xml version=\"1.0\" ?>\n+<layer-spec xmlns=\"urn:jboss:galleon:layer-spec:1.0\" name=\"iiop-openjdk\">\n+    <dependencies>\n+        <layer name=\"naming\"/>\n+    </dependencies>\n+    <feature-group name=\"iiop-openjdk\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33fb6f42af3ff3c2b7bf8eff4c633e6d89948567"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMTk1ODk1", "url": "https://github.com/wildfly/wildfly/pull/13524#pullrequestreview-482195895", "createdAt": "2020-09-03T20:54:43Z", "commit": {"oid": "33fb6f42af3ff3c2b7bf8eff4c633e6d89948567"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMDo1NDo0M1rOHM3KMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMDo1NTozMFrOHM3L1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI0ODY4OQ==", "bodyText": "@chengfang This needs to be\n<groupId>${testsuite.ee.galleon.pack.groupId}</groupId>\n\nThis allows different test jobs to configure what feature pack is used to provision the server, i.e. the one that directly exposes the layer or a higher level one that exposes it transitively.", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483248689", "createdAt": "2020-09-03T20:54:43Z", "author": {"login": "bstansberry"}, "path": "testsuite/integration/basic/pom.xml", "diffHunk": "@@ -1197,8 +1235,127 @@\n                                 </configuration>\n                             </execution>\n \n+                            <!-- Provision a cloud-profile server with ejb3-lite -->\n+                            <execution>\n+                                <id>ejb3-lite-provisioning</id>\n+                                <goals>\n+                                    <goal>provision</goal>\n+                                </goals>\n+                                <phase>compile</phase>\n+                                <configuration>\n+                                    <install-dir>${project.build.directory}/wildfly-ejb3-lite</install-dir>\n+                                    <record-state>false</record-state>\n+                                    <log-time>${galleon.log.time}</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>\n+                                        <optional-packages>passive+</optional-packages>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>${project.groupId}</groupId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33fb6f42af3ff3c2b7bf8eff4c633e6d89948567"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI0OTEwOQ==", "bodyText": "@chengfang This needs to be\n<groupId>${testsuite.ee.galleon.pack.groupId}</groupId>", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483249109", "createdAt": "2020-09-03T20:55:30Z", "author": {"login": "bstansberry"}, "path": "testsuite/integration/basic/pom.xml", "diffHunk": "@@ -1197,8 +1235,127 @@\n                                 </configuration>\n                             </execution>\n \n+                            <!-- Provision a cloud-profile server with ejb3-lite -->\n+                            <execution>\n+                                <id>ejb3-lite-provisioning</id>\n+                                <goals>\n+                                    <goal>provision</goal>\n+                                </goals>\n+                                <phase>compile</phase>\n+                                <configuration>\n+                                    <install-dir>${project.build.directory}/wildfly-ejb3-lite</install-dir>\n+                                    <record-state>false</record-state>\n+                                    <log-time>${galleon.log.time}</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>\n+                                        <optional-packages>passive+</optional-packages>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>${project.groupId}</groupId>\n+                                            <artifactId>${testsuite.ee.galleon.pack.artifactId}</artifactId>\n+                                            <version>${testsuite.ee.galleon.pack.version}</version>\n+                                            <inherit-configs>false</inherit-configs>\n+                                            <inherit-packages>false</inherit-packages>\n+                                        </feature-pack>\n+                                    </feature-packs>\n+                                    <configurations>\n+                                        <config>\n+                                            <model>standalone</model>\n+                                            <name>standalone.xml</name>\n+                                            <layers>\n+                                                <layer>cloud-server</layer>\n+                                                <layer>h2-default-datasource</layer>\n+                                                <layer>ejb3-lite</layer>\n+                                            </layers>\n+                                        </config>\n+                                    </configurations>\n+                                </configuration>\n+                            </execution>\n+                            <!-- Provision a cloud-profile server with ejb3 -->\n+                            <execution>\n+                                <id>ejb3-provisioning</id>\n+                                <goals>\n+                                    <goal>provision</goal>\n+                                </goals>\n+                                <phase>compile</phase>\n+                                <configuration>\n+                                    <install-dir>${project.build.directory}/wildfly-ejb3</install-dir>\n+                                    <record-state>false</record-state>\n+                                    <log-time>${galleon.log.time}</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>\n+                                        <optional-packages>passive+</optional-packages>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>${project.groupId}</groupId>\n+                                            <artifactId>wildfly-test-galleon-pack</artifactId>\n+                                            <version>${ee.maven.version}</version>\n+                                            <inherit-configs>false</inherit-configs>\n+                                            <inherit-packages>false</inherit-packages>\n+                                        </feature-pack>\n+                                    </feature-packs>\n+                                    <configurations>\n+                                        <config>\n+                                            <model>standalone</model>\n+                                            <name>standalone.xml</name>\n+                                            <layers>\n+                                                <layer>cloud-server</layer>\n+                                                <layer>h2-default-datasource</layer>\n+                                                <layer>ejb3</layer>\n+                                                <layer>ejb-elytron-testsuite</layer>\n+                                            </layers>\n+                                        </config>\n+                                    </configurations>\n+                                </configuration>\n+                            </execution>\n+                            <!-- Provision a cloud-profile server with ejb3-iiop -->\n+                            <execution>\n+                                <id>ejb3-iiop-provisioning</id>\n+                                <goals>\n+                                    <goal>provision</goal>\n+                                </goals>\n+                                <phase>compile</phase>\n+                                <configuration>\n+                                    <install-dir>${project.build.directory}/wildfly-ejb3-iiop</install-dir>\n+                                    <record-state>false</record-state>\n+                                    <log-time>${galleon.log.time}</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>\n+                                        <optional-packages>passive+</optional-packages>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>${project.groupId}</groupId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33fb6f42af3ff3c2b7bf8eff4c633e6d89948567"}, "originalPosition": 156}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "773be0569d80667471dd784936045270f1365003", "author": {"user": {"login": "bstansberry", "name": " Brian Stansberry"}}, "url": "https://github.com/wildfly/wildfly/commit/773be0569d80667471dd784936045270f1365003", "committedDate": "2020-09-04T18:03:25Z", "message": "WFLY-13354 Add Galleon layers for the EJB subsystem"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "94e0032b63bcd188bf120130ec43af5d32b958d8", "author": {"user": {"login": "chengfang", "name": "Cheng Fang"}}, "url": "https://github.com/wildfly/wildfly/commit/94e0032b63bcd188bf120130ec43af5d32b958d8", "committedDate": "2020-09-03T22:30:51Z", "message": "WFLY-13354 (remove iiop-openjdk from Galleon_provisioning.adoc)"}, "afterCommit": {"oid": "773be0569d80667471dd784936045270f1365003", "author": {"user": {"login": "bstansberry", "name": " Brian Stansberry"}}, "url": "https://github.com/wildfly/wildfly/commit/773be0569d80667471dd784936045270f1365003", "committedDate": "2020-09-04T18:03:25Z", "message": "WFLY-13354 Add Galleon layers for the EJB subsystem"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyOTg2NTg2", "url": "https://github.com/wildfly/wildfly/pull/13524#pullrequestreview-482986586", "createdAt": "2020-09-04T21:59:07Z", "commit": {"oid": "773be0569d80667471dd784936045270f1365003"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzODkyOTU1", "url": "https://github.com/wildfly/wildfly/pull/13524#pullrequestreview-483892955", "createdAt": "2020-09-08T08:08:14Z", "commit": {"oid": "773be0569d80667471dd784936045270f1365003"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3852, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}