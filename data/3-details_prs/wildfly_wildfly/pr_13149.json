{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0Mjk0OTYy", "number": 13149, "title": "[WFLY-13293] When deploying \"ROOT.war\" in EAP7.x, the context root value output through jboss-cli is not valid", "bodyText": "Issue: https://issues.redhat.com/browse/WFLY-13293\nI have moved the final calculation of the app context from the info service to the deployment processor (this way both use the same context and teh issue is resolved). Let me know if you see something wrong.", "createdAt": "2020-03-26T16:56:00Z", "url": "https://github.com/wildfly/wildfly/pull/13149", "merged": true, "mergeCommit": {"oid": "1ae14bbb43985c67bcfe38f9e67224d51ba4980e"}, "closed": true, "closedAt": "2020-04-09T14:44:42Z", "author": {"login": "rmartinc"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRyk3fgFqTM4Mjk3MTU1MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVv9AgAFqTM5MDM4Mzg1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyOTcxNTUx", "url": "https://github.com/wildfly/wildfly/pull/13149#pullrequestreview-382971551", "createdAt": "2020-03-27T15:38:18Z", "commit": {"oid": "abbc908906ea9c1eb1c50bac31c2c16a84693b59"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNTozODoxOFrOF82sfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNTozODoxOFrOF82sfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM1NTAwNg==", "bodyText": "I don't have time to properly review this now, but this doesn't feel right. DUPs looking up services isn't great as it's only safe if the DeploymentUnitPhaseService running the DUP has a dependency on the service being looked up. Which is fragile.", "url": "https://github.com/wildfly/wildfly/pull/13149#discussion_r399355006", "createdAt": "2020-03-27T15:38:18Z", "author": {"login": "bstansberry"}, "path": "undertow/src/main/java/org/wildfly/extension/undertow/deployment/UndertowDeploymentProcessor.java", "diffHunk": "@@ -198,8 +199,15 @@ public void deploy(final DeploymentPhaseContext phaseContext) throws DeploymentU\n \n         String serverInstanceName = warMetaData.getMergedJBossWebMetaData().getServerInstanceName() == null ? defaultServerForDeployment : warMetaData.getMergedJBossWebMetaData().getServerInstanceName();\n         String hostName = hostNameOfDeployment(warMetaData, defaultHostForDeployment);\n+        CapabilityServiceSupport support = deploymentUnit.getAttachment(Attachments.CAPABILITY_SERVICE_SUPPORT);\n+        ServiceName hostServiceName = support.getCapabilityServiceName(Capabilities.CAPABILITY_HOST, serverInstanceName, hostName);\n+        ServiceController<?> hostService = phaseContext.getServiceRegistry().getService(hostServiceName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abbc908906ea9c1eb1c50bac31c2c16a84693b59"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be154ed721a48ca91dcc8b904c0aafab5a1082dd", "author": {"user": {"login": "rmartinc", "name": null}}, "url": "https://github.com/wildfly/wildfly/commit/be154ed721a48ca91dcc8b904c0aafab5a1082dd", "committedDate": "2020-04-06T07:43:30Z", "message": "[WFLY-13293] When deploying \"ROOT.war\" in EAP7.x, the context root value output through jboss-cli is not valid"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "abbc908906ea9c1eb1c50bac31c2c16a84693b59", "author": {"user": {"login": "rmartinc", "name": null}}, "url": "https://github.com/wildfly/wildfly/commit/abbc908906ea9c1eb1c50bac31c2c16a84693b59", "committedDate": "2020-03-26T14:10:03Z", "message": "[WFLY-13293] When deploying \"ROOT.war\" in EAP7.x, the context root value output through jboss-cli is not valid"}, "afterCommit": {"oid": "be154ed721a48ca91dcc8b904c0aafab5a1082dd", "author": {"user": {"login": "rmartinc", "name": null}}, "url": "https://github.com/wildfly/wildfly/commit/be154ed721a48ca91dcc8b904c0aafab5a1082dd", "committedDate": "2020-04-06T07:43:30Z", "message": "[WFLY-13293] When deploying \"ROOT.war\" in EAP7.x, the context root value output through jboss-cli is not valid"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMzgzODU2", "url": "https://github.com/wildfly/wildfly/pull/13149#pullrequestreview-390383856", "createdAt": "2020-04-08T22:50:40Z", "commit": {"oid": "be154ed721a48ca91dcc8b904c0aafab5a1082dd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3577, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}