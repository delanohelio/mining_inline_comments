{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQwOTQ3NTQx", "number": 13827, "title": "[WFLY-14219] Upgrade module descriptors to 1.9.", "bodyText": "Fixes WFLY-14219\nUpgrade module descriptor to 1.9:\nExceptions: 1) System property is in use 2) jdeps error.\nPlease find jdeps results as attachment in JIRA.", "createdAt": "2020-12-16T07:10:46Z", "url": "https://github.com/wildfly/wildfly/pull/13827", "merged": true, "mergeCommit": {"oid": "41c6ecb5a504df1f6bdec81749a3685c22ae0ade"}, "closed": true, "closedAt": "2021-01-20T23:43:15Z", "author": {"login": "boris-unckel"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdocA8rgFqTU1NjY0NjIzNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdyIuKvgFqTU3Mjc4ODAxNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2NjQ2MjM3", "url": "https://github.com/wildfly/wildfly/pull/13827#pullrequestreview-556646237", "createdAt": "2020-12-21T20:31:32Z", "commit": {"oid": "9a4f76ca07feab66f74e1936392c166561fe579e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQyMDozMTozM1rOIJlGUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQyMDozMTozM1rOIJlGUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkxNTkyMA==", "bodyText": "Everywhere you identified proper Java's module dependencies like in this case @boris-unckel\nyou can eliminate dependency on deprecated 'wrapper' javax.api module that\nwas bringing in all dependencies you identified here.", "url": "https://github.com/wildfly/wildfly/pull/13827#discussion_r546915920", "createdAt": "2020-12-21T20:31:33Z", "author": {"login": "ropalka"}, "path": "ee-feature-pack/common/src/main/resources/modules/system/layers/base/com/fasterxml/jackson/core/jackson-databind/main/module.xml", "diffHunk": "@@ -21,12 +21,16 @@\n   ~ Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n   ~ 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n   -->\n-<module xmlns=\"urn:jboss:module:1.5\" name=\"com.fasterxml.jackson.core.jackson-databind\">\n+<module xmlns=\"urn:jboss:module:1.9\" name=\"com.fasterxml.jackson.core.jackson-databind\">\n+\n      <resources>\n         <artifact name=\"${com.fasterxml.jackson.core:jackson-databind}\"/>\n     </resources>\n-\n     <dependencies>\n+        <module name=\"java.desktop\"/>\n+        <module name=\"java.logging\"/>\n+        <module name=\"java.sql\"/>\n+        <module name=\"java.xml\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a4f76ca07feab66f74e1936392c166561fe579e"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNTE0MjI0", "url": "https://github.com/wildfly/wildfly/pull/13827#pullrequestreview-560514224", "createdAt": "2020-12-31T16:34:44Z", "commit": {"oid": "5d61ec1269b0e84dad16fe63dbbe6d538c854ae2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMVQxNjozNDo0NFrOINCOow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMVQxNjozNDo0NFrOINCOow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDUzODkxNQ==", "bodyText": "This needs a dep on java.logging added. I tried that at #13840 and the many failures went away.", "url": "https://github.com/wildfly/wildfly/pull/13827#discussion_r550538915", "createdAt": "2020-12-31T16:34:44Z", "author": {"login": "bstansberry"}, "path": "ee-feature-pack/common/src/main/resources/modules/system/layers/base/org/infinispan/protostream/main/module.xml", "diffHunk": "@@ -32,8 +33,9 @@\n     </resources>\n \n     <dependencies>\n-        <module name=\"javax.api\"/>\n+        <!--WFLY-14219 Remove deprecated <module name=\"javax.api\"/> -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d61ec1269b0e84dad16fe63dbbe6d538c854ae2"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNTE0NDI0", "url": "https://github.com/wildfly/wildfly/pull/13827#pullrequestreview-560514424", "createdAt": "2020-12-31T16:35:56Z", "commit": {"oid": "5d61ec1269b0e84dad16fe63dbbe6d538c854ae2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMVQxNjozNTo1NlrOINCSMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMVQxNjozNTo1NlrOINCSMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDUzOTgyNg==", "bodyText": "Shouldn't the 'slot' value now be incorporated in the 'name'?  @ropalka ?", "url": "https://github.com/wildfly/wildfly/pull/13827#discussion_r550539826", "createdAt": "2020-12-31T16:35:56Z", "author": {"login": "bstansberry"}, "path": "servlet-feature-pack/galleon-feature-pack/src/main/resources/packages/product.conf/content/modules/system/layers/base/org/jboss/as/product/wildfly-web/module.xml", "diffHunk": "@@ -22,7 +22,7 @@\n   ~ 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n   -->\n \n-<module xmlns=\"urn:jboss:module:1.5\" name=\"org.jboss.as.product\" slot=\"wildfly-web\">\n+<module xmlns=\"urn:jboss:module:1.9\" name=\"org.jboss.as.product\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d61ec1269b0e84dad16fe63dbbe6d538c854ae2"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ec1195dcbcad6cafa804a8fa0a872f33c62d9d9", "author": {"user": {"login": "boris-unckel", "name": "Boris Unckel"}}, "url": "https://github.com/wildfly/wildfly/commit/3ec1195dcbcad6cafa804a8fa0a872f33c62d9d9", "committedDate": "2021-01-01T13:54:08Z", "message": "WFLY-14219 Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot"}, "afterCommit": {"oid": "b1a793134c2c09b588d25a0633d8684ecb65c4cb", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/b1a793134c2c09b588d25a0633d8684ecb65c4cb", "committedDate": "2021-01-02T13:32:58Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b1a793134c2c09b588d25a0633d8684ecb65c4cb", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/b1a793134c2c09b588d25a0633d8684ecb65c4cb", "committedDate": "2021-01-02T13:32:58Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}, "afterCommit": {"oid": "3e302aea7f1f4427b79287a728f55d05a7cb4007", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/3e302aea7f1f4427b79287a728f55d05a7cb4007", "committedDate": "2021-01-16T20:06:59Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcwODEyOTAz", "url": "https://github.com/wildfly/wildfly/pull/13827#pullrequestreview-570812903", "createdAt": "2021-01-18T22:54:23Z", "commit": {"oid": "3e302aea7f1f4427b79287a728f55d05a7cb4007"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOFQyMjo1NDoyNFrOIV5GYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOFQyMjo1NDoyNFrOIV5GYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTgyNjUzMA==", "bodyText": "The ee-9 variant of this has export=true:\n        <!-- java.instrument export due to jdeps result -->\n        <module name=\"java.instrument\" export=\"true\"/>\n\nI think that's needed here as ClassTransformer throws IllegalClassFormatException in JPA 2.2 as well:\nhttps://github.com/eclipse-ee4j/jpa-api/blob/2.2-2.2.3-RELEASE/api/src/main/java/javax/persistence/spi/ClassTransformer.java#L61", "url": "https://github.com/wildfly/wildfly/pull/13827#discussion_r559826530", "createdAt": "2021-01-18T22:54:24Z", "author": {"login": "bstansberry"}, "path": "ee-feature-pack/ee-8-api/src/main/resources/modules/system/layers/base/javax/persistence/api/main/module.xml", "diffHunk": "@@ -22,13 +22,17 @@\n   ~ 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n   -->\n \n-<module xmlns=\"urn:jboss:module:1.7\" name=\"javax.persistence.api\">\n-    <dependencies>\n-        <!-- PersistenceUnitInfo needs javax.sql.DataSource -->\n-        <module name=\"javax.api\" export=\"true\"/>\n-    </dependencies>\n+<module xmlns=\"urn:jboss:module:1.9\" name=\"javax.persistence.api\">\n \n     <resources>\n         <artifact name=\"${jakarta.persistence:jakarta.persistence-api}\"/>\n     </resources>\n+\n+    <dependencies>\n+        <module name=\"java.instrument\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e302aea7f1f4427b79287a728f55d05a7cb4007"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3e302aea7f1f4427b79287a728f55d05a7cb4007", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/3e302aea7f1f4427b79287a728f55d05a7cb4007", "committedDate": "2021-01-16T20:06:59Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}, "afterCommit": {"oid": "357878908e1dc5a015f55984a59f6035ef29f7e1", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/357878908e1dc5a015f55984a59f6035ef29f7e1", "committedDate": "2021-01-19T07:01:33Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcxMjQ4NzY2", "url": "https://github.com/wildfly/wildfly/pull/13827#pullrequestreview-571248766", "createdAt": "2021-01-19T13:38:18Z", "commit": {"oid": "357878908e1dc5a015f55984a59f6035ef29f7e1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "357878908e1dc5a015f55984a59f6035ef29f7e1", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/357878908e1dc5a015f55984a59f6035ef29f7e1", "committedDate": "2021-01-19T07:01:33Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}, "afterCommit": {"oid": "9894df9a5f8d092bf98d874dd7cdc5657605711c", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/9894df9a5f8d092bf98d874dd7cdc5657605711c", "committedDate": "2021-01-19T17:04:54Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d018ceb54d3cea3d37d15b55049afdc69f3b3695", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/d018ceb54d3cea3d37d15b55049afdc69f3b3695", "committedDate": "2021-01-20T05:25:01Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9894df9a5f8d092bf98d874dd7cdc5657605711c", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/9894df9a5f8d092bf98d874dd7cdc5657605711c", "committedDate": "2021-01-19T17:04:54Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}, "afterCommit": {"oid": "d018ceb54d3cea3d37d15b55049afdc69f3b3695", "author": {"user": null}, "url": "https://github.com/wildfly/wildfly/commit/d018ceb54d3cea3d37d15b55049afdc69f3b3695", "committedDate": "2021-01-20T05:25:01Z", "message": "WFLY-14219 Upgrade module descriptor 1.9. Check and add dependencies for modules already at 1.8 or 1.9. Remove javax.api including fixes to do so.\n Convert slot attribute to name with collon, Fix LayersTestCase corresponding to org.jboss.as.product:wildfly-web removing slot."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcyNzg4MDE1", "url": "https://github.com/wildfly/wildfly/pull/13827#pullrequestreview-572788015", "createdAt": "2021-01-20T23:43:07Z", "commit": {"oid": "d018ceb54d3cea3d37d15b55049afdc69f3b3695"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3711, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}