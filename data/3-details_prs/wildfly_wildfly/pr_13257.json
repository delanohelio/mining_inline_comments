{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExNzE1MjUy", "number": 13257, "title": "[WFLY-13298] Set up mixed domain testing against EAP 7.3", "bodyText": "supersedes #13253\nAdds mixed domain tests against EAP 7.3.0\nJira issue: https://issues.redhat.com/browse/WFLY-13298", "createdAt": "2020-04-30T16:55:38Z", "url": "https://github.com/wildfly/wildfly/pull/13257", "merged": true, "mergeCommit": {"oid": "420ffd70bb5b95263429f0bedda1ba9009c248f2"}, "closed": true, "closedAt": "2020-05-08T19:32:58Z", "author": {"login": "yersan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccreH9gH2gAyNDExNzE1MjUyOjVlNzEwMjkwYWY2YjMyODE3ZjkzMmM3Y2Y4ZmEzMWE2YjlmMmFlY2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfA9diAFqTQwNzY5NzUzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5e710290af6b32817f932c7cf8fa31a6b9f2aeca", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/5e710290af6b32817f932c7cf8fa31a6b9f2aeca", "committedDate": "2020-04-30T11:34:47Z", "message": "[WFLY-13420] Enable Elytron mixed domain test suites"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzOTYwMzg4", "url": "https://github.com/wildfly/wildfly/pull/13257#pullrequestreview-403960388", "createdAt": "2020-05-01T00:18:37Z", "commit": {"oid": "cd083b1a5e68871c0205a897ab50a1629ea11b64"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQwMDoxODozN1rOGO-nfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQwMDoxODozN1rOGO-nfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM1OTE2Ng==", "bodyText": "I don't understand this one. This resource exists in domain.xml for all versions from EAP 7.1 onward. Which is consistent with the comment above. So I'd think this method would be part of DomainAdjuster700.\nCurrently, it's here, it's also in DomainAdjuster720 (which means the removal gets run twice) and it's also left over as an unused method in DomainAdjuster710.", "url": "https://github.com/wildfly/wildfly/pull/13257#discussion_r418359166", "createdAt": "2020-05-01T00:18:37Z", "author": {"login": "bstansberry"}, "path": "testsuite/mixed-domain/src/test/java/org/jboss/as/test/integration/domain/mixed/eap730/DomainAdjuster730.java", "diffHunk": "@@ -43,16 +46,36 @@\n \n     @Override\n     protected List<ModelNode> adjustForVersion(final DomainClient client, PathAddress profileAddress, boolean withMasterServers) throws Exception {\n-        final List<ModelNode> list = new ArrayList<>();\n+        final List<ModelNode> ops = new ArrayList<>();\n \n-        removeMicroProfileJWT(list, profileAddress.append(SUBSYSTEM, \"microprofile-jwt-smallrye\"));\n+        removeMicroProfileJWT(ops, profileAddress.append(SUBSYSTEM, \"microprofile-jwt-smallrye\"));\n+        adjustUndertow(ops, profileAddress.append(SUBSYSTEM, \"undertow\"));\n+        adjustOpenTracing(ops, profileAddress.append(SUBSYSTEM, \"microprofile-opentracing-smallrye\"));\n \n-        return list;\n+        return ops;\n     }\n \n-    private void removeMicroProfileJWT(final List<ModelNode> list, final PathAddress subsystem) {\n-        list.add(createRemoveOperation(subsystem));\n-        list.add(createRemoveOperation(PathAddress.pathAddress(EXTENSION, \"org.wildfly.extension.microprofile.jwt-smallrye\")));\n+    private void removeMicroProfileJWT(final List<ModelNode> ops, final PathAddress subsystem) {\n+        ops.add(createRemoveOperation(subsystem));\n+        ops.add(createRemoveOperation(PathAddress.pathAddress(EXTENSION, \"org.wildfly.extension.microprofile.jwt-smallrye\")));\n     }\n \n+    private void adjustUndertow(final List<ModelNode> ops, final PathAddress subsystem) {\n+        // EAP 7.0 and earlier required explicit SSL configuration. Wildfly 10.1 added support\n+        // for SSL by default, which automatically generates certs.\n+        // This could be removed if all hosts were configured to contain a security domain with SSL\n+        // enabled.\n+        final PathAddress httpsListener = subsystem\n+                .append(\"server\", \"default-server\")\n+                .append(\"https-listener\", \"https\");\n+        ops.add(Util.getEmptyOperation(ModelDescriptionConstants.REMOVE, httpsListener.toModelNode()));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd083b1a5e68871c0205a897ab50a1629ea11b64"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "988045cf10caf766baf60cd13c3ad902fec92e52", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/988045cf10caf766baf60cd13c3ad902fec92e52", "committedDate": "2020-05-04T07:30:32Z", "message": "[WFLY-13298] Set up mixed domain testing against EAP 7.3\n\n[WFLY-13298] Add legacy configuration files for parse and marshal model tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cd083b1a5e68871c0205a897ab50a1629ea11b64", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/cd083b1a5e68871c0205a897ab50a1629ea11b64", "committedDate": "2020-04-30T16:50:39Z", "message": "[WFLY-13298] Set up mixed domain testing against EAP 7.3\n\n[WFLY-13298] Add legacy configuration files for parse and marshal model tests"}, "afterCommit": {"oid": "988045cf10caf766baf60cd13c3ad902fec92e52", "author": {"user": {"login": "yersan", "name": "Yeray Borges"}}, "url": "https://github.com/wildfly/wildfly/commit/988045cf10caf766baf60cd13c3ad902fec92e52", "committedDate": "2020-05-04T07:30:32Z", "message": "[WFLY-13298] Set up mixed domain testing against EAP 7.3\n\n[WFLY-13298] Add legacy configuration files for parse and marshal model tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3Njk3NTM5", "url": "https://github.com/wildfly/wildfly/pull/13257#pullrequestreview-407697539", "createdAt": "2020-05-07T17:44:52Z", "commit": {"oid": "988045cf10caf766baf60cd13c3ad902fec92e52"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3548, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}