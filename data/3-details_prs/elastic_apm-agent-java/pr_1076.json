{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0MjcwMzA5", "number": 1076, "title": "JAX-RS transaction name should be based on first annotated method", "bodyText": "What does this PR do?\n\nIntroduce new internal API that allows setting a span name with the same priority.\nChecklist\n\n\n My code follows the style guidelines of this project\n I have rebased my changes on top of the latest master branch\n\n\n\n I have added tests that prove my fix is effective or that my feature works\n New and existing unit tests pass locally with my changes\n\n\n\n I have updated CHANGELOG.asciidoc\n\nRelated issues\n\nCloses #1062\nUse cases\n\nJAX-RS-annotated method delegating to another JAX-RS-annotated method - since it is the same plugin (and instrumentation), both attempt to set the name with the same priority, but we prefer the first, rather than the second.", "createdAt": "2020-03-05T13:17:30Z", "url": "https://github.com/elastic/apm-agent-java/pull/1076", "merged": true, "mergeCommit": {"oid": "dfc996db709b34ac24ad481540e181fe081ad1a3"}, "closed": true, "closedAt": "2020-03-08T10:28:48Z", "author": {"login": "eyalkoren"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKrTbmAH2gAyMzg0MjcwMzA5OmIzNDY1NWVjN2Q3ZDdhN2VlMGZhZGU3MmM3ZGNmNmU3YWJiN2Y5NTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLk4lNAH2gAyMzg0MjcwMzA5OjVmNDQwMzJiYzU3YjBmMDliMDUzYzhjY2M4ZjkxNTM3ZTQ5Y2U0NDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b34655ec7d7d7a7ee0fade72c7dcf6e7abb7f950", "author": {"user": {"login": "eyalkoren", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/b34655ec7d7d7a7ee0fade72c7dcf6e7abb7f950", "committedDate": "2020-03-05T13:12:28Z", "message": "JAX-RS transaction name should be based on first annotated method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NjAwNTkx", "url": "https://github.com/elastic/apm-agent-java/pull/1076#pullrequestreview-369600591", "createdAt": "2020-03-05T14:14:21Z", "commit": {"oid": "b34655ec7d7d7a7ee0fade72c7dcf6e7abb7f950"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxNDoxNDoyMVrOFyVEmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxNDoxNDoyMVrOFyVEmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODMxODM2Mg==", "bodyText": "Note to self - adjust the return description and add description for the second parameter (copy + pasta)", "url": "https://github.com/elastic/apm-agent-java/pull/1076#discussion_r388318362", "createdAt": "2020-03-05T14:14:21Z", "author": {"login": "eyalkoren"}, "path": "apm-agent-core/src/main/java/co/elastic/apm/agent/impl/transaction/AbstractSpan.java", "diffHunk": "@@ -164,7 +164,22 @@ public StringBuilder getNameForSerialization() {\n      */\n     @Nullable\n     public StringBuilder getAndOverrideName(int namePriority) {\n-        if (namePriority >= this.namePriority) {\n+        return getAndOverrideName(namePriority, true);\n+    }\n+\n+    /**\n+     * Resets and returns the name {@link StringBuilder} if one of the following applies:\n+     *  1.  the provided priority is {@code >} {@link #namePriority}\n+     *  2.  the provided priority is {@code ==} {@link #namePriority} AND `overrideIfSamePriority` is `true`\n+     * Otherwise, returns {@code null}\n+     *\n+     * @param namePriority the priority for the name. See also the {@code AbstractSpan#PRIO_*} constants.\n+     * @return the name {@link StringBuilder} if the provided priority is {@code >=} {@link #namePriority}, {@code null} otherwise.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b34655ec7d7d7a7ee0fade72c7dcf6e7abb7f950"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NjY1NzUz", "url": "https://github.com/elastic/apm-agent-java/pull/1076#pullrequestreview-369665753", "createdAt": "2020-03-05T15:27:54Z", "commit": {"oid": "b34655ec7d7d7a7ee0fade72c7dcf6e7abb7f950"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f44032bc57b0f09b053c8ccc8f91537e49ce443", "author": {"user": {"login": "eyalkoren", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/5f44032bc57b0f09b053c8ccc8f91537e49ce443", "committedDate": "2020-03-08T08:17:38Z", "message": "Fix javadoc"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3875, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}