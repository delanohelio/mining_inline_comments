{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2Mzk0MTc3", "number": 1530, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNjoyODozNVrOE80dLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNjoyODozNVrOE80dLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyMjA5NDUyOnYy", "diffSide": "RIGHT", "path": "Jenkinsfile", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNjoyODozNVrOH5K-fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxNDo0Mzo1NFrOH52lIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcxMDcxOQ==", "bodyText": "where is that dir coming from? from the packer cache?", "url": "https://github.com/elastic/apm-agent-java/pull/1530#discussion_r529710719", "createdAt": "2020-11-24T16:28:35Z", "author": {"login": "felixbarny"}, "path": "Jenkinsfile", "diffHunk": "@@ -79,6 +79,10 @@ pipeline {\n             withGithubNotify(context: 'Build', tab: 'artifacts') {\n               deleteDir()\n               unstash 'source'\n+              // prepare m2 repository with the existing dependencies\n+              whenTrue(fileExists('/var/lib/jenkins/.m2/repository')) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22ebae03cca9d84f1bd8b4fa06a54e87628b5908"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcyNTYyNg==", "bodyText": "that's the default home directory for the linux CI Workers, in fact, they don't have a HOME env variable but that's where all the cached artifacts are stored.", "url": "https://github.com/elastic/apm-agent-java/pull/1530#discussion_r529725626", "createdAt": "2020-11-24T16:49:22Z", "author": {"login": "v1v"}, "path": "Jenkinsfile", "diffHunk": "@@ -79,6 +79,10 @@ pipeline {\n             withGithubNotify(context: 'Build', tab: 'artifacts') {\n               deleteDir()\n               unstash 'source'\n+              // prepare m2 repository with the existing dependencies\n+              whenTrue(fileExists('/var/lib/jenkins/.m2/repository')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcxMDcxOQ=="}, "originalCommit": {"oid": "22ebae03cca9d84f1bd8b4fa06a54e87628b5908"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM4MTk1Nw==", "bodyText": "This copies a cached folder to this build. But how does the /var/lib/jenkins/.m2/repository folder get populated? Wouldn't it always be empty?", "url": "https://github.com/elastic/apm-agent-java/pull/1530#discussion_r530381957", "createdAt": "2020-11-25T13:41:52Z", "author": {"login": "felixbarny"}, "path": "Jenkinsfile", "diffHunk": "@@ -79,6 +79,10 @@ pipeline {\n             withGithubNotify(context: 'Build', tab: 'artifacts') {\n               deleteDir()\n               unstash 'source'\n+              // prepare m2 repository with the existing dependencies\n+              whenTrue(fileExists('/var/lib/jenkins/.m2/repository')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcxMDcxOQ=="}, "originalCommit": {"oid": "22ebae03cca9d84f1bd8b4fa06a54e87628b5908"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM4OTA3OA==", "bodyText": "/var/lib/jenkins/.m2/repository gets populated every night when the daily images run the packer_cache.sh. It should not be empty, but it it was then it will not cause any issues at all", "url": "https://github.com/elastic/apm-agent-java/pull/1530#discussion_r530389078", "createdAt": "2020-11-25T13:52:56Z", "author": {"login": "v1v"}, "path": "Jenkinsfile", "diffHunk": "@@ -79,6 +79,10 @@ pipeline {\n             withGithubNotify(context: 'Build', tab: 'artifacts') {\n               deleteDir()\n               unstash 'source'\n+              // prepare m2 repository with the existing dependencies\n+              whenTrue(fileExists('/var/lib/jenkins/.m2/repository')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcxMDcxOQ=="}, "originalCommit": {"oid": "22ebae03cca9d84f1bd8b4fa06a54e87628b5908"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM5MzAwMw==", "bodyText": "got it, thanks. A minor suggestion: we could add a du -hs .m2 so that we can verify whether this directory is non-empty.", "url": "https://github.com/elastic/apm-agent-java/pull/1530#discussion_r530393003", "createdAt": "2020-11-25T13:58:37Z", "author": {"login": "felixbarny"}, "path": "Jenkinsfile", "diffHunk": "@@ -79,6 +79,10 @@ pipeline {\n             withGithubNotify(context: 'Build', tab: 'artifacts') {\n               deleteDir()\n               unstash 'source'\n+              // prepare m2 repository with the existing dependencies\n+              whenTrue(fileExists('/var/lib/jenkins/.m2/repository')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcxMDcxOQ=="}, "originalCommit": {"oid": "22ebae03cca9d84f1bd8b4fa06a54e87628b5908"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM5NDc2Mg==", "bodyText": "Do you mean temporarily?\nit was not empty when I tested it out:\nsee copy step that took 15 seconds ( the screenshots section in the PR description also shows that particular step details)", "url": "https://github.com/elastic/apm-agent-java/pull/1530#discussion_r530394762", "createdAt": "2020-11-25T14:01:14Z", "author": {"login": "v1v"}, "path": "Jenkinsfile", "diffHunk": "@@ -79,6 +79,10 @@ pipeline {\n             withGithubNotify(context: 'Build', tab: 'artifacts') {\n               deleteDir()\n               unstash 'source'\n+              // prepare m2 repository with the existing dependencies\n+              whenTrue(fileExists('/var/lib/jenkins/.m2/repository')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcxMDcxOQ=="}, "originalCommit": {"oid": "22ebae03cca9d84f1bd8b4fa06a54e87628b5908"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDQxMzI4MQ==", "bodyText": "21c44ba is there now", "url": "https://github.com/elastic/apm-agent-java/pull/1530#discussion_r530413281", "createdAt": "2020-11-25T14:27:38Z", "author": {"login": "v1v"}, "path": "Jenkinsfile", "diffHunk": "@@ -79,6 +79,10 @@ pipeline {\n             withGithubNotify(context: 'Build', tab: 'artifacts') {\n               deleteDir()\n               unstash 'source'\n+              // prepare m2 repository with the existing dependencies\n+              whenTrue(fileExists('/var/lib/jenkins/.m2/repository')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcxMDcxOQ=="}, "originalCommit": {"oid": "22ebae03cca9d84f1bd8b4fa06a54e87628b5908"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDQyNTEyMw==", "bodyText": "I guess it doesn't hurt to just stay in there", "url": "https://github.com/elastic/apm-agent-java/pull/1530#discussion_r530425123", "createdAt": "2020-11-25T14:43:54Z", "author": {"login": "felixbarny"}, "path": "Jenkinsfile", "diffHunk": "@@ -79,6 +79,10 @@ pipeline {\n             withGithubNotify(context: 'Build', tab: 'artifacts') {\n               deleteDir()\n               unstash 'source'\n+              // prepare m2 repository with the existing dependencies\n+              whenTrue(fileExists('/var/lib/jenkins/.m2/repository')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTcxMDcxOQ=="}, "originalCommit": {"oid": "22ebae03cca9d84f1bd8b4fa06a54e87628b5908"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4985, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}