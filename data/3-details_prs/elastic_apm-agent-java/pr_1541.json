{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4MTE0NTc5", "number": 1541, "title": "[load test] build test app with recent JDK", "bodyText": "We currently have 2 JDKs involved in load tests:\n\none (Java11) that is used to build the agent\none for the test application, which version is provided through a parameter that is used to build & run the test application.\n\nWhen trying to run test on old Java7 versions, like 7u111, we have maven that is unable to download dependencies due to TLS/certificate issues.\nThus, in this case we need to:\n\nuse Java 8 JDK to run maven, test application will still target and be compatible with Java 7.\nfor more recent versions, we will build and run the test application with the selected JDK.", "createdAt": "2020-11-26T14:33:35Z", "url": "https://github.com/elastic/apm-agent-java/pull/1541", "merged": true, "mergeCommit": {"oid": "a3d61ffcb7b73e56a9dcd8aabfc8256c73015db4"}, "closed": true, "closedAt": "2020-12-01T19:53:39Z", "author": {"login": "SylvainJuge"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgTzDHAH2gAyNTI4MTE0NTc5OjMyNTkyOWU4OGIxMmUyOWIyZjc3ZWM2ODRhMDVhMDJjYTYyNzIwZjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdh8D2rgH2gAyNTI4MTE0NTc5OmUwMzRhNjIwNjViNGYyYTMxZDY2MDFkMzdkNWI2ZDlhNDFhOGVlYWQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "325929e88b12e29b2f77ec684a05a02ca62720f3", "author": {"user": {"login": "SylvainJuge", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/325929e88b12e29b2f77ec684a05a02ca62720f3", "committedDate": "2020-11-26T14:26:46Z", "message": "build test app with recent JDK"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NDIxMjE5", "url": "https://github.com/elastic/apm-agent-java/pull/1541#pullrequestreview-539421219", "createdAt": "2020-11-26T15:47:08Z", "commit": {"oid": "325929e88b12e29b2f77ec684a05a02ca62720f3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNTo0NzowOFrOH6girA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNTo0NzowOFrOH6girA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTExMjYyMA==", "bodyText": "I am worried about this line because I think it has the potential to overwrite the JDK that we download here on L79.", "url": "https://github.com/elastic/apm-agent-java/pull/1541#discussion_r531112620", "createdAt": "2020-11-26T15:47:08Z", "author": {"login": "cachedout"}, "path": ".ci/load/Jenkinsfile", "diffHunk": "@@ -75,6 +79,15 @@ pipeline {\n                                 setEnvVar('JAVA_HOME', sh(script: \".ci/load/scripts/fetch_sdk.sh ${params.jvm_version}\", returnStdout: true).trim())\n                                 setEnvVar('JAVACMD', \"${env.JAVA_HOME}/bin/java\")\n                                 setEnvVar('PATH', \"${env.JAVA_HOME}/bin:$PATH\")\n+\n+                                def jdk_major = sh(script: \".ci/load/scripts/java_major.sh ${params.jvm_version}\", returnStdout: true).trim())\n+                                def app_build_jdk = \"${env.JAVA_HOME}\"\n+                                if(jdk_major == '7'){\n+                                    // build application with a more recent JDK that don't have TLS issues\n+                                    app_build_jdk = sh(script: \".ci/load/scripts/fetch_sdk.sh zulu-8.0.272-linux\", returnStdout: true).trim()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "325929e88b12e29b2f77ec684a05a02ca62720f3"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e07b58cf34c952f9c86620b8444d1a1296faaa4f", "author": {"user": {"login": "SylvainJuge", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/e07b58cf34c952f9c86620b8444d1a1296faaa4f", "committedDate": "2020-12-01T12:58:32Z", "message": "unpack jdk to random folder + use /tmp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "782e099684801419a2bf03e000a21ed00c2922c3", "author": {"user": {"login": "SylvainJuge", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/782e099684801419a2bf03e000a21ed00c2922c3", "committedDate": "2020-12-01T15:45:19Z", "message": "fix typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93b938a08dd6c179f9baa47a7b91d6e071817419", "author": {"user": {"login": "SylvainJuge", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/93b938a08dd6c179f9baa47a7b91d6e071817419", "committedDate": "2020-12-01T15:48:04Z", "message": "more typos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "639beff7d200fcbc5bed64c95b67579e96869106", "author": {"user": {"login": "SylvainJuge", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/639beff7d200fcbc5bed64c95b67579e96869106", "committedDate": "2020-12-01T15:53:04Z", "message": "same player plays again"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e034a62065b4f2a31d6601d37d5b6d9a41a8eead", "author": {"user": {"login": "SylvainJuge", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/e034a62065b4f2a31d6601d37d5b6d9a41a8eead", "committedDate": "2020-12-01T15:55:15Z", "message": "I love typos"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3618, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}