{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0NDk1NjIz", "number": 1300, "title": "Wrap project ver in dir for jenkins release job", "bodyText": "What does this PR do?\nFixes one more issue with an improper path in the Jenkins release job and also changes the call to mvnw to use the script shipped with the project.", "createdAt": "2020-07-21T13:12:49Z", "url": "https://github.com/elastic/apm-agent-java/pull/1300", "merged": true, "mergeCommit": {"oid": "4ade987f5e3dc2a9e4800e2d49b3f373a75d8b1a"}, "closed": true, "closedAt": "2020-07-21T13:14:11Z", "author": {"login": "cachedout"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3F_cCAH2gAyNDU0NDk1NjIzOmY5Y2U3NjkwM2Y2N2U3NjEwYmExZmRiOWZlOTFiZDI3OTQyOGFmMmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3GDrhAFqTQ1MjQ0MTgzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f9ce76903f67e7610ba1fdb9fe91bd279428af2e", "author": {"user": {"login": "cachedout", "name": null}}, "url": "https://github.com/elastic/apm-agent-java/commit/f9ce76903f67e7610ba1fdb9fe91bd279428af2e", "committedDate": "2020-07-21T13:10:44Z", "message": "Wrap project ver in dir for jenkins release job"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNDQwNTIw", "url": "https://github.com/elastic/apm-agent-java/pull/1300#pullrequestreview-452440520", "createdAt": "2020-07-21T13:13:53Z", "commit": {"oid": "f9ce76903f67e7610ba1fdb9fe91bd279428af2e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNDQxNzU2", "url": "https://github.com/elastic/apm-agent-java/pull/1300#pullrequestreview-452441756", "createdAt": "2020-07-21T13:15:16Z", "commit": {"oid": "f9ce76903f67e7610ba1fdb9fe91bd279428af2e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxMzoxNToxNlrOG03Xmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxMzoxNToxNlrOG03Xmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA4NjI5OA==", "bodyText": "NIT: include the version in the commit message?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                sh(script: \"git commit -a -m 'Version bump'\")\n          \n          \n            \n                                sh(script: \"git commit -a -m 'Version bump (${new_version})'\")", "url": "https://github.com/elastic/apm-agent-java/pull/1300#discussion_r458086298", "createdAt": "2020-07-21T13:15:16Z", "author": {"login": "v1v"}, "path": ".ci/release/Jenkinsfile", "diffHunk": "@@ -97,33 +97,35 @@ pipeline {\n         }\n         stage('Review project version') {\n           steps {\n-            script {\n-              def ver = mvnVersion(showQualifiers: true)\n-              def should_continue = input(message: \"Current version is ${ver}\", parameters: [\n-                [\n-                  $class: 'ChoiceParameterDefinition',\n-                  name: \"You are about to release version ${ver - '-SNAPSHOT'}. Do you wish to update the version?\",\n-                  \"choices\": [\"Yes\", \"No\"],\n-                  description: \"Selecting 'Yes' will allow you to select the new version in the next step.\"\n-                ]\n-              ])\n-              if (should_continue == 'Yes'){\n-                def new_version = input(message: \"Please enter version to change to:\", parameters:\n+            dir(\"${BASE_DIR}\"){\n+              script {\n+                def ver = mvnVersion(showQualifiers: true)\n+                def should_continue = input(message: \"Current version is ${ver}\", parameters: [\n                   [\n+                    $class: 'ChoiceParameterDefinition',\n+                    name: \"You are about to release version ${ver - '-SNAPSHOT'}. Do you wish to update the version?\",\n+                    \"choices\": [\"Yes\", \"No\"],\n+                    description: \"Selecting 'Yes' will allow you to select the new version in the next step.\"\n+                  ]\n+                ])\n+                if (should_continue == 'Yes'){\n+                  def new_version = input(message: \"Please enter version to change to:\", parameters:\n                     [\n-                      $class: 'StringParameterDefinition',\n-                      defaultValue: \"${ver}\",\n-                      description: 'We will update the project version in all pom.xml files. Set this to your desired <release-version>-SNAPSHOT (for example 1.2.3-SNAPSHOT if you want to release version 1.2.3).', name: 'New Version'\n+                      [\n+                        $class: 'StringParameterDefinition',\n+                        defaultValue: \"${ver}\",\n+                        description: 'We will update the project version in all pom.xml files. Set this to your desired <release-version>-SNAPSHOT (for example 1.2.3-SNAPSHOT if you want to release version 1.2.3).', name: 'New Version'\n+                      ]\n                     ]\n-                  ]\n-                )\n-                sh(name: \"mavenVersionUpdate\", script: \"mvn --batch-mode release:update-versions -DdevelopmentVersion=${new_version}\")\n-                withGitRelease() {\n-                  sh(script: \"git commit -a -m 'Version bump'\")\n-                  gitPush()\n+                  )\n+                  sh(name: \"mavenVersionUpdate\", script: \"./mvnw --batch-mode release:update-versions -DdevelopmentVersion=${new_version}\")\n+                  withGitRelease() {\n+                    sh(script: \"git commit -a -m 'Version bump'\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9ce76903f67e7610ba1fdb9fe91bd279428af2e"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNDQxODM5", "url": "https://github.com/elastic/apm-agent-java/pull/1300#pullrequestreview-452441839", "createdAt": "2020-07-21T13:15:23Z", "commit": {"oid": "f9ce76903f67e7610ba1fdb9fe91bd279428af2e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3802, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}