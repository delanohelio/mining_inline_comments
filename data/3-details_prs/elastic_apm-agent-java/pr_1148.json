{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MDUyOTEz", "number": 1148, "title": "Fix system metrics on J9", "bodyText": "fixes https://discuss.elastic.co/t/java-apm-agent-not-pushing-cpu-memory-metric-ibm-java-on-websphere-liberty/228064\nIf /proc/meminfo is available, prefer reading MemTotal for system.memory.total  rather than OperatingSystemMXBean#getSystemCpuLoad for better consistency.\nThis is in line with how the go agent/metricbeat collects the total memory:\nhttps://github.com/elastic/go-sysinfo/blob/2e4263c5c548ff5352fd86b0a29330fb08b5c98f/providers/linux/memory_linux.go#L40-L41", "createdAt": "2020-04-20T13:08:22Z", "url": "https://github.com/elastic/apm-agent-java/pull/1148", "merged": true, "mergeCommit": {"oid": "d10d713e857bd9fe9ce72414f77b7578718a2bbc"}, "closed": true, "closedAt": "2020-04-21T07:32:37Z", "author": {"login": "felixbarny"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZez42gH2gAyNDA2MDUyOTEzOmQzNGFlMDAzZWNlN2YyNDlkNjYyOGIzZTE2YmJkNDU5MzIzMzk5Mjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZfaBSAFqTM5NjQ2NzkxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d34ae003ece7f249d6628b3e16bbd45932339928", "author": {"user": {"login": "felixbarny", "name": "Felix Barnsteiner"}}, "url": "https://github.com/elastic/apm-agent-java/commit/d34ae003ece7f249d6628b3e16bbd45932339928", "committedDate": "2020-04-20T13:08:01Z", "message": "Fix system metrics on J9\n\nfixes https://discuss.elastic.co/t/java-apm-agent-not-pushing-cpu-memory-metric-ibm-java-on-websphere-liberty/228064"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NDY3OTE4", "url": "https://github.com/elastic/apm-agent-java/pull/1148#pullrequestreview-396467918", "createdAt": "2020-04-20T13:46:42Z", "commit": {"oid": "d34ae003ece7f249d6628b3e16bbd45932339928"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMzo0Njo0M1rOGIVRlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMzo0Njo0M1rOGIVRlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTM5MDM1OQ==", "bodyText": "\ud83e\udd26", "url": "https://github.com/elastic/apm-agent-java/pull/1148#discussion_r411390359", "createdAt": "2020-04-20T13:46:43Z", "author": {"login": "eyalkoren"}, "path": "apm-agent-core/src/main/java/co/elastic/apm/agent/metrics/builtin/SystemMetrics.java", "diffHunk": "@@ -99,27 +99,21 @@ public void start(ElasticApmTracer tracer) {\n     }\n \n     void bindTo(MetricRegistry metricRegistry) {\n-        metricRegistry.addUnlessNegative(\"system.cpu.total.norm.pct\", Labels.EMPTY, new DoubleSupplier() {\n+        // J9 always returns -1 on the first call", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d34ae003ece7f249d6628b3e16bbd45932339928"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3936, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}