{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxMDI2MTAx", "number": 5589, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQyMjo0MDo0MlrODwlxpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMjo0NDowMFrODwvH5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMjc3MTU4OnYy", "diffSide": "RIGHT", "path": "frameworks/PHP/fat-free/deploy/nginx.conf", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQyMjo0MDo0MlrOGDryFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQyMjo0NjoxMVrOGDr4wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxNjI0Ng==", "bodyText": "That change will be detrimental.\nIt's the number of keealive connections to the php-fpm, per worker processes (1 per cpu core).\n28 cores * 120 = 3,360 keepalive connections.\nphp-fpm only have 1.024 children processes.", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5589#discussion_r406516246", "createdAt": "2020-04-09T22:40:42Z", "author": {"login": "joanhey"}, "path": "frameworks/PHP/fat-free/deploy/nginx.conf", "diffHunk": "@@ -42,7 +45,7 @@ http {\n \n     upstream fastcgi_backend {\n         server unix:/var/run/php/php7.3-fpm.sock;\n-        keepalive 40;\n+        keepalive 120;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4a0a5ab26e91bd156be378ed232d4a0ba803fef"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxNzk1NA==", "bodyText": "@joanhey That could be true. I was testing it on my machine and it may be biased towards my machine than on another. I just noticed performance increased when I bumped this number up (but too much and performance sank again).", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5589#discussion_r406517954", "createdAt": "2020-04-09T22:46:11Z", "author": {"login": "n0nag0n"}, "path": "frameworks/PHP/fat-free/deploy/nginx.conf", "diffHunk": "@@ -42,7 +45,7 @@ http {\n \n     upstream fastcgi_backend {\n         server unix:/var/run/php/php7.3-fpm.sock;\n-        keepalive 40;\n+        keepalive 120;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxNjI0Ng=="}, "originalCommit": {"oid": "c4a0a5ab26e91bd156be378ed232d4a0ba803fef"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNDMwMzA5OnYy", "diffSide": "RIGHT", "path": "frameworks/PHP/fat-free/index.php", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMjo0NDowMFrOGD5f4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQwMDo0MzozM1rOGEI-mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc0MDk2Mg==", "bodyText": "Without persistent db connections will have less than 1K req/s.", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5589#discussion_r406740962", "createdAt": "2020-04-10T12:44:00Z", "author": {"login": "joanhey"}, "path": "frameworks/PHP/fat-free/index.php", "diffHunk": "@@ -1,36 +1,36 @@\n <?php\n // drop startup errors\n-if (function_exists('error_clear_last'))\n-    error_clear_last();\n+// if (function_exists('error_clear_last'))\n+//     error_clear_last();\n    \n-error_reporting(0);\n+// error_reporting(0);\n \n /** @var Base $f3 */\n $f3=require('src/base.php');\n \n error_reporting(-1);\n \n-$f3->set('DEBUG',2);\n+$f3->set('DEBUG',0);\n $f3->set('HIGHLIGHT',false);\n $f3->set('CACHE','folder=tmp/cache/');\n $f3->set('UI','ui/');\n $f3->set('ONERROR',function($f3){\n     echo $f3->get('ERROR.code').': '.$f3->get('ERROR.text').\"\\n\".$f3->get('ERROR.trace');\n });\n \n-$f3->set('DBS',array('mysql:host=tfb-database;port=3306;dbname=hello_world','benchmarkdbuser','benchmarkdbpass',[PDO::ATTR_PERSISTENT => true]));\n+$f3->set('DBS',array('mysql:host=tfb-database;port=3306;dbname=hello_world','benchmarkdbuser','benchmarkdbpass'));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4a0a5ab26e91bd156be378ed232d4a0ba803fef"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjgyODcxMQ==", "bodyText": "we can leave that, but it's actually not being used in the rest of the file. The other parts of the file explicitly declare persistent connections. I was just cleaning it up.", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5589#discussion_r406828711", "createdAt": "2020-04-10T16:14:22Z", "author": {"login": "n0nag0n"}, "path": "frameworks/PHP/fat-free/index.php", "diffHunk": "@@ -1,36 +1,36 @@\n <?php\n // drop startup errors\n-if (function_exists('error_clear_last'))\n-    error_clear_last();\n+// if (function_exists('error_clear_last'))\n+//     error_clear_last();\n    \n-error_reporting(0);\n+// error_reporting(0);\n \n /** @var Base $f3 */\n $f3=require('src/base.php');\n \n error_reporting(-1);\n \n-$f3->set('DEBUG',2);\n+$f3->set('DEBUG',0);\n $f3->set('HIGHLIGHT',false);\n $f3->set('CACHE','folder=tmp/cache/');\n $f3->set('UI','ui/');\n $f3->set('ONERROR',function($f3){\n     echo $f3->get('ERROR.code').': '.$f3->get('ERROR.text').\"\\n\".$f3->get('ERROR.trace');\n });\n \n-$f3->set('DBS',array('mysql:host=tfb-database;port=3306;dbname=hello_world','benchmarkdbuser','benchmarkdbpass',[PDO::ATTR_PERSISTENT => true]));\n+$f3->set('DBS',array('mysql:host=tfb-database;port=3306;dbname=hello_world','benchmarkdbuser','benchmarkdbpass'));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc0MDk2Mg=="}, "originalCommit": {"oid": "c4a0a5ab26e91bd156be378ed232d4a0ba803fef"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjk5NDU4NQ==", "bodyText": "DRY and delete it in the other parts.\nAlso use variadic to simplify the code.", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5589#discussion_r406994585", "createdAt": "2020-04-11T00:43:33Z", "author": {"login": "joanhey"}, "path": "frameworks/PHP/fat-free/index.php", "diffHunk": "@@ -1,36 +1,36 @@\n <?php\n // drop startup errors\n-if (function_exists('error_clear_last'))\n-    error_clear_last();\n+// if (function_exists('error_clear_last'))\n+//     error_clear_last();\n    \n-error_reporting(0);\n+// error_reporting(0);\n \n /** @var Base $f3 */\n $f3=require('src/base.php');\n \n error_reporting(-1);\n \n-$f3->set('DEBUG',2);\n+$f3->set('DEBUG',0);\n $f3->set('HIGHLIGHT',false);\n $f3->set('CACHE','folder=tmp/cache/');\n $f3->set('UI','ui/');\n $f3->set('ONERROR',function($f3){\n     echo $f3->get('ERROR.code').': '.$f3->get('ERROR.text').\"\\n\".$f3->get('ERROR.trace');\n });\n \n-$f3->set('DBS',array('mysql:host=tfb-database;port=3306;dbname=hello_world','benchmarkdbuser','benchmarkdbpass',[PDO::ATTR_PERSISTENT => true]));\n+$f3->set('DBS',array('mysql:host=tfb-database;port=3306;dbname=hello_world','benchmarkdbuser','benchmarkdbpass'));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjc0MDk2Mg=="}, "originalCommit": {"oid": "c4a0a5ab26e91bd156be378ed232d4a0ba803fef"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2666, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}