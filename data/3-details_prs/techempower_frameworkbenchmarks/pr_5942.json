{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxNzg4NTI4", "number": 5942, "title": "Chore/rails update logic", "bodyText": "Some house cleaning for Rails.\n\nWe're not using activerecord-import - so remove that gem (that functionality is builtin with Rails 6 anyway)\nWe're generating an array of 10k when we only need 500 - I've benchmarked that change here fyi - https://github.com/gregors/benchmarks/blob/master/random_sample.rb\nI noticed that we're using update_attribute which is deprecated. Then I was looking, since we don't have any model validations I suggest we use update_column which is what I have seen on various occasions.\n\nI'm seeing increases across the board from 1186 -> 1500 with 1 query to 109 -> 160 with 20 queries on my box.\nI'd be interested in revisiting single update query in the future at some point, but that's outside the scope of this. I'd also like to revisit that Rails 6 upgrade ticket or submit my own.", "createdAt": "2020-08-21T18:35:49Z", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5942", "merged": true, "mergeCommit": {"oid": "a5b04657fa939a514dd0732d9e5cf5dfa9413c0e"}, "closed": true, "closedAt": "2020-08-25T15:21:42Z", "author": {"login": "gregors"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdBJF5ogH2gAyNDcxNzg4NTI4OjcyYTQzYjhjYjI1YjA4MmYwZDUwOWE4MGMyYzdkZWFiYTE5ZmRmYmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCIodZgBqjM2ODcxMDc1OTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "72a43b8cb25b082f0d509a80c2c7deaba19fdfba", "author": {"user": {"login": "gregors", "name": "Gregory Ostermayr"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/72a43b8cb25b082f0d509a80c2c7deaba19fdfba", "committedDate": "2020-08-21T18:26:45Z", "message": "remove activerecord-import - not being used"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b14618f87261aa0527b230b32976b6e34c7c36d", "author": {"user": {"login": "gregors", "name": "Gregory Ostermayr"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/5b14618f87261aa0527b230b32976b6e34c7c36d", "committedDate": "2020-08-21T18:27:20Z", "message": "don't make an array of 10k when we only need 500"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd4f1a7dc139e8b073488dea411cebf1cddebcea", "author": {"user": {"login": "gregors", "name": "Gregory Ostermayr"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/fd4f1a7dc139e8b073488dea411cebf1cddebcea", "committedDate": "2020-08-21T18:55:39Z", "message": "no reason to run validations if we don't have any"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "300eef4d799457e45d37e09d7a865f626f0434ae", "author": {"user": {"login": "gregors", "name": "Gregory Ostermayr"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/300eef4d799457e45d37e09d7a865f626f0434ae", "committedDate": "2020-08-21T18:27:42Z", "message": "no reason to run validations, when do don't have any"}, "afterCommit": {"oid": "fd4f1a7dc139e8b073488dea411cebf1cddebcea", "author": {"user": {"login": "gregors", "name": "Gregory Ostermayr"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/fd4f1a7dc139e8b073488dea411cebf1cddebcea", "committedDate": "2020-08-21T18:55:39Z", "message": "no reason to run validations if we don't have any"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyODYwMzg2", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5942#pullrequestreview-472860386", "createdAt": "2020-08-21T23:06:50Z", "commit": {"oid": "fd4f1a7dc139e8b073488dea411cebf1cddebcea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQyMzowNjo1MFrOHE__7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQyMzowNjo1MFrOHE__7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwNDkxMQ==", "bodyText": "Same issue exists in #query, line 21.", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5942#discussion_r475004911", "createdAt": "2020-08-21T23:06:50Z", "author": {"login": "krankin"}, "path": "frameworks/Ruby/rails/app/controllers/hello_world_controller.rb", "diffHunk": "@@ -37,15 +37,14 @@ def update\n     queries = 1 if queries < 1\n     queries = 500 if queries > 500\n \n-    numbers = (1..10000).to_a.sample(queries).sort\n-    worlds = numbers.map do |id|\n+    worlds = queries.times.map{Random.rand(1..10_000)}.map do |id|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd4f1a7dc139e8b073488dea411cebf1cddebcea"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "053d601413cde80ea024ff43874ebac2ab4b56bc", "author": {"user": {"login": "gregors", "name": "Gregory Ostermayr"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/053d601413cde80ea024ff43874ebac2ab4b56bc", "committedDate": "2020-08-23T15:38:44Z", "message": "replace similar array logic"}, "afterCommit": {"oid": "fd4f1a7dc139e8b073488dea411cebf1cddebcea", "author": {"user": {"login": "gregors", "name": "Gregory Ostermayr"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/fd4f1a7dc139e8b073488dea411cebf1cddebcea", "committedDate": "2020-08-21T18:55:39Z", "message": "no reason to run validations if we don't have any"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3852, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}