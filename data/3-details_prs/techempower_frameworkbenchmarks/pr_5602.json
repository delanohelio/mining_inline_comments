{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNTE1Njc1", "number": 5602, "title": "Add 60 seconds sleep to clear host connections", "bodyText": "tl;dr We believe that some frameworks are hitting the OS limit for open connections and, if the next test spins up too fast, it may have trouble creating network connections. Because we're using --host, these connections are lingering on the host and stuck in a TIME_WAIT state that automatically close after a default of 60 seconds. Here, we're giving enough time for the host to close these connections before the next test starts.\n\ud83e\udd1e that this solves #4092\nEdit: Changed my mind about where to put this. Rather than before a test container starts, I put it in the __exit_test cleanup. This makes sure building database containers and all the other things that need to happen at the start of a test can reach the interwebs.", "createdAt": "2020-04-15T03:09:47Z", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5602", "merged": true, "mergeCommit": {"oid": "386cec43a13a3037ac563823b90c0a54b91cb8e7"}, "closed": true, "closedAt": "2020-04-15T06:33:37Z", "author": {"login": "nbrady-techempower"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXvJhqgH2gAyNDAzNTE1Njc1OmQxMzlhMDRmOWFkYWJhMTZmM2NhMzI0ODQzYzAxM2Q3NjljNzUyMmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXwHhcAH2gAyNDAzNTE1Njc1OjY2M2ZmZDI2YjI3NzliMmY1YTRiYzJmZTY1Y2NkZDVkZDE3ZTU4YmY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d139a04f9adaba16f3ca324843c013d769c7522b", "author": {"user": {"login": "nbrady-techempower", "name": "Nate"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/d139a04f9adaba16f3ca324843c013d769c7522b", "committedDate": "2020-04-15T03:02:17Z", "message": "Add 60 seconds sleep to clear host connections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf51e53874f38a7df1e07e975c7ba508907237b4", "author": {"user": {"login": "nbrady-techempower", "name": "Nate"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/bf51e53874f38a7df1e07e975c7ba508907237b4", "committedDate": "2020-04-15T03:25:06Z", "message": "Move the sleep to the end of any run test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNDM3MDUw", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5602#pullrequestreview-393437050", "createdAt": "2020-04-15T03:46:04Z", "commit": {"oid": "bf51e53874f38a7df1e07e975c7ba508907237b4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwMzo0NjowNFrOGFovZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwMzo0NjowNFrOGFovZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODU2MzU1OQ==", "bodyText": "Even if it's the only one to run?", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5602#discussion_r408563559", "createdAt": "2020-04-15T03:46:04Z", "author": {"login": "msmith-techempower"}, "path": "toolset/benchmark/benchmarker.py", "diffHunk": "@@ -92,6 +92,9 @@ def __exit_test(self, success, prefix, file, message=None):\n                 file=file,\n                 color=Fore.RED if success else '')\n         self.time_logger.log_test_end(log_prefix=prefix, file=file)\n+        # Sleep for 60 seconds to ensure all host connects are closed\n+        log(\"Clean up: Sleep 60 seconds...\", prefix=prefix, file=file)\n+        time.sleep(60)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf51e53874f38a7df1e07e975c7ba508907237b4"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e587b22995d3b49fef29a0f6b1f03ea8aa6a432", "author": {"user": {"login": "nbrady-techempower", "name": "Nate"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/9e587b22995d3b49fef29a0f6b1f03ea8aa6a432", "committedDate": "2020-04-15T03:56:43Z", "message": "whatever @msmith-techempower"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "663ffd26b2779b2f5a4bc2fe65ccdd5dd17e58bf", "author": {"user": {"login": "nbrady-techempower", "name": "Nate"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/663ffd26b2779b2f5a4bc2fe65ccdd5dd17e58bf", "committedDate": "2020-04-15T04:10:00Z", "message": "^ this is your fault."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3881, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}