{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2Mzk3MTgz", "number": 5427, "title": "Update lithium. Tune the number of SQL connections.", "bodyText": "", "createdAt": "2020-01-23T14:41:14Z", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5427", "merged": true, "mergeCommit": {"oid": "a46d4f22fd26efe8f4c7f09a17af5276ab44f96e"}, "closed": true, "closedAt": "2020-01-23T18:23:57Z", "author": {"login": "matt-42"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9LoMXAH2gAyMzY2Mzk3MTgzOmYyOGY4YjgzZThkODhlMDQzOTg3Njk3NDg5M2MzZmE4MDk0OGY3MzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9OaK_AH2gAyMzY2Mzk3MTgzOjU5NjVmNGNkYzMwNjY0NmI2OGIxNThjMThhOGNlMzQxOTNkMmE3YWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f28f8b83e8d88e0439876974893c3fa80948f733", "author": {"user": {"login": "matt-42", "name": "Matthieu Garrigues"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/f28f8b83e8d88e0439876974893c3fa80948f733", "committedDate": "2020-01-23T14:57:10Z", "message": "Update lithium. Tune the number of SQL connections."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f933b528aff2c0bf0ea05404b9dd2b3271b262e6", "author": {"user": {"login": "matt-42", "name": "Matthieu Garrigues"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/f933b528aff2c0bf0ea05404b9dd2b3271b262e6", "committedDate": "2020-01-23T15:13:33Z", "message": "Fix compilation."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NDE1MDk3", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5427#pullrequestreview-347415097", "createdAt": "2020-01-23T16:02:20Z", "commit": {"oid": "f933b528aff2c0bf0ea05404b9dd2b3271b262e6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNjowMjoyMFrOFhDqpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNjowMjoyMFrOFhDqpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDIwNzM5OA==", "bodyText": "Looks like I missed this before\n1 + rand() % 9999 -> 1 to 9999\nCould you update to 1 + rand() % 10000", "url": "https://github.com/TechEmpower/FrameworkBenchmarks/pull/5427#discussion_r370207398", "createdAt": "2020-01-23T16:02:20Z", "author": {"login": "nbrady-techempower"}, "path": "frameworks/C++/lithium/lithium.cc", "diffHunk": "@@ -89,49 +100,51 @@ int main(int argc, char* argv[]) {\n   };\n \n   my_api.get(\"/updates\") = [&](http_request& request, http_response& response) {\n+    set_max_sql_connections_per_thread(2);\n     std::string N_str = request.get_parameters(s::N = std::optional<std::string>()).N.value_or(\"1\");\n     int N = atoi(N_str.c_str());\n     N = std::max(1, std::min(N, 500));\n+    std::vector<decltype(random_numbers.all_fields())> numbers(N);\n \n-     \n-    auto c = random_numbers.connect(request.yield);\n-    auto& raw_c = c.backend_connection();\n+    {     \n+      auto c = random_numbers.connect(request.yield);\n+      auto& raw_c = c.backend_connection();\n \n-    std::vector<decltype(random_numbers.all_fields())> numbers(N);\n-    \n+      \n #if TFB_MYSQL\n-    raw_c(\"START TRANSACTION\");\n+      raw_c(\"START TRANSACTION\");\n #endif\n-    for (int i = 0; i < N; i++)\n-    {\n-      numbers[i] = c.find_one(s::id = 1 + rand() % 9999).value();\n-      numbers[i].randomNumber = 1 + rand() % 9999;\n-    }\n+      for (int i = 0; i < N; i++)\n+      {\n+        numbers[i] = c.find_one(s::id = 1 + rand() % 9999).value();\n+        numbers[i].randomNumber = 1 + rand() % 9999;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f933b528aff2c0bf0ea05404b9dd2b3271b262e6"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5965f4cdc306646b68b158c18a8ce34193d2a7ab", "author": {"user": {"login": "matt-42", "name": "Matthieu Garrigues"}}, "url": "https://github.com/TechEmpower/FrameworkBenchmarks/commit/5965f4cdc306646b68b158c18a8ce34193d2a7ab", "committedDate": "2020-01-23T18:11:34Z", "message": "Lithium: 9999 -> 10000"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3912, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}