{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5NDYwMDk5", "number": 12845, "title": "Add verbose property to print docId when set", "bodyText": "I confirm that this contribution is made under the terms of the license found in the root directory of this repository's source tree and that I have the authority necessary to make this contribution on behalf of its copyright owner.\n\nadd a property to enable printing docid when there is an error parsing the document", "createdAt": "2020-04-06T08:12:00Z", "url": "https://github.com/vespa-engine/vespa/pull/12845", "merged": true, "mergeCommit": {"oid": "56861b9653b1af6c7448d4900e67beb2c3947d4c"}, "closed": true, "closedAt": "2020-04-17T11:13:38Z", "author": {"login": "jingtinghuang"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcU6JLOgH2gAyMzk5NDYwMDk5OmQyMjBiYTU2MDhjODQ4ODMxZDQzMDRiYmMyMjk5OTMwMjBkZDAwNjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYfXfngFqTM5NTM2NjUwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d220ba5608c848831d4304bbc229993020dd0063", "author": {"user": {"login": "jingtinghuang", "name": "William"}}, "url": "https://github.com/vespa-engine/vespa/commit/d220ba5608c848831d4304bbc229993020dd0063", "committedDate": "2020-04-06T08:09:05Z", "message": "add print id when error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4MDMzOTMz", "url": "https://github.com/vespa-engine/vespa/pull/12845#pullrequestreview-388033933", "createdAt": "2020-04-06T08:29:05Z", "commit": {"oid": "d220ba5608c848831d4304bbc229993020dd0063"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwODoyOTowNVrOGBM-_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwODoyOTowNVrOGBM-_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzkxNDQ5NA==", "bodyText": "This should probably not be a system out here. Use the warnlog function. But, isn't this information already in the line below as the entire tuple is output to warnlog? If so, I don't see the point of adding additional output here. If not, rather change the exception out below to explicitly add the docid. No configuration should be necessary for this.", "url": "https://github.com/vespa-engine/vespa/pull/12845#discussion_r403914494", "createdAt": "2020-04-06T08:29:05Z", "author": {"login": "lesters"}, "path": "vespa-hadoop/src/main/java/com/yahoo/vespa/hadoop/pig/VespaDocumentOperation.java", "diffHunk": "@@ -157,6 +160,12 @@ public String exec(Tuple tuple) throws IOException {\n             if (statusReporter != null) {\n                 statusReporter.incrCounter(\"Vespa Document Operation Counters\", \"Document operation failed\", 1);\n             }\n+            if (printIdOnError) {\n+                Schema inputSchema = getInputSchema();\n+                Map<String, Object> fields = TupleTools.tupleMap(inputSchema, tuple);\n+                String docId = TupleTools.toString(fields, template);\n+                System.out.println(\"Error occur when processing document with docID: \" +docId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d220ba5608c848831d4304bbc229993020dd0063"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4MDM0NjQ5", "url": "https://github.com/vespa-engine/vespa/pull/12845#pullrequestreview-388034649", "createdAt": "2020-04-06T08:30:04Z", "commit": {"oid": "d220ba5608c848831d4304bbc229993020dd0063"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca", "author": {"user": {"login": "jingtinghuang", "name": "William"}}, "url": "https://github.com/vespa-engine/vespa/commit/1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca", "committedDate": "2020-04-08T02:54:23Z", "message": "add property verbose"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNzQ1NjI3", "url": "https://github.com/vespa-engine/vespa/pull/12845#pullrequestreview-392745627", "createdAt": "2020-04-14T09:14:53Z", "commit": {"oid": "1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwOToxNDo1M1rOGFFiLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwOToxNDo1M1rOGFFiLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzk4NjczNQ==", "bodyText": "To be consequent with other code here, move this to the section below for other properties that are retrieved, e.g. line 104ish. Also, make this a private final boolean, not a static. I guess, to be consequent, call this verbose so it can be used for other things as well. So, in sum, private final boolean verbose;.", "url": "https://github.com/vespa-engine/vespa/pull/12845#discussion_r407986735", "createdAt": "2020-04-14T09:14:53Z", "author": {"login": "lesters"}, "path": "vespa-hadoop/src/main/java/com/yahoo/vespa/hadoop/pig/VespaDocumentOperation.java", "diffHunk": "@@ -80,6 +81,7 @@ public static boolean valid(String text) {\n     private static final String PARTIAL_UPDATE_ASSIGN = \"assign\";\n     private static final String PARTIAL_UPDATE_ADD = \"add\";\n     private static final String PARTIAL_UPDATE_REMOVE = \"remove\";\n+    private static boolean printId;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNzQ1OTAy", "url": "https://github.com/vespa-engine/vespa/pull/12845#pullrequestreview-392745902", "createdAt": "2020-04-14T09:15:16Z", "commit": {"oid": "1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwOToxNToxNlrOGFFjEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwOToxNToxNlrOGFFjEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzk4Njk2MQ==", "bodyText": "if (verbose) {", "url": "https://github.com/vespa-engine/vespa/pull/12845#discussion_r407986961", "createdAt": "2020-04-14T09:15:16Z", "author": {"login": "lesters"}, "path": "vespa-hadoop/src/main/java/com/yahoo/vespa/hadoop/pig/VespaDocumentOperation.java", "diffHunk": "@@ -145,6 +148,9 @@ public String exec(Tuple tuple) throws IOException {\n             Schema inputSchema = getInputSchema();\n             Map<String, Object> fields = TupleTools.tupleMap(inputSchema, tuple);\n             String docId = TupleTools.toString(fields, template);\n+            if (printId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca"}, "originalPosition": 28}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "010a36c873a0df4e7d692d079ca97b140949675c", "author": {"user": {"login": "jingtinghuang", "name": "William"}}, "url": "https://github.com/vespa-engine/vespa/commit/010a36c873a0df4e7d692d079ca97b140949675c", "committedDate": "2020-04-16T07:43:40Z", "message": "Revert \"Merge branch 'master' of https://github.com/vespa-engine/vespa into add_print_ID_when_error\"\n\nThis reverts commit 981d589e4bd4562b1e9867ddc327e6553f9b7b96, reversing\nchanges made to 1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca."}, "afterCommit": {"oid": "1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca", "author": {"user": {"login": "jingtinghuang", "name": "William"}}, "url": "https://github.com/vespa-engine/vespa/commit/1c0ae314ffc19ad9f7a1e7d2e08b14df329c16ca", "committedDate": "2020-04-08T02:54:23Z", "message": "add property verbose"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c99c5ef7854433cd7e4e74ecf877d907b5e3187", "author": {"user": {"login": "jingtinghuang", "name": "William"}}, "url": "https://github.com/vespa-engine/vespa/commit/4c99c5ef7854433cd7e4e74ecf877d907b5e3187", "committedDate": "2020-04-16T08:07:10Z", "message": "change variable printId to verbose"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MzY2NTAz", "url": "https://github.com/vespa-engine/vespa/pull/12845#pullrequestreview-395366503", "createdAt": "2020-04-17T11:12:59Z", "commit": {"oid": "4c99c5ef7854433cd7e4e74ecf877d907b5e3187"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3438, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}