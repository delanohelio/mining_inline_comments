{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0ODk2Njc5", "number": 12182, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMTo1ODo0OFrODf3gSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMjowMDozM1rODf3huQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NzQxODM1OnYy", "diffSide": "RIGHT", "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMTo1ODo0OFrOFp0ZGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMTo1ODo0OFrOFp0ZGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5NDMzMA==", "bodyText": "must be \"fp =\" not \"*fp =\"", "url": "https://github.com/vespa-engine/vespa/pull/12182#discussion_r379394330", "createdAt": "2020-02-14T11:58:48Z", "author": {"login": "arnej27959"}, "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "diffHunk": "@@ -76,6 +77,17 @@ CfHandler::doConfigure()\n     fclose(fp);\n     rename(tmpPath.c_str(), path.c_str());\n \n+    path = cfFilePath(config.splunkHome, \"inputs.conf\");\n+    tmpPath = path + \".new\";\n+    *fp = fopen(tmpPath.c_str(), \"w\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0912fe7370a58b661e6edb58c69f8cb1585e8dd2"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NzQxOTIwOnYy", "diffSide": "RIGHT", "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMTo1OToxNVrOFp0ZsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMTo1OToxNVrOFp0ZsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5NDQ4MA==", "bodyText": "consider using VESPA_HOSTNAME instead?", "url": "https://github.com/vespa-engine/vespa/pull/12182#discussion_r379394480", "createdAt": "2020-02-14T11:59:15Z", "author": {"login": "arnej27959"}, "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "diffHunk": "@@ -76,6 +77,17 @@ CfHandler::doConfigure()\n     fclose(fp);\n     rename(tmpPath.c_str(), path.c_str());\n \n+    path = cfFilePath(config.splunkHome, \"inputs.conf\");\n+    tmpPath = path + \".new\";\n+    *fp = fopen(tmpPath.c_str(), \"w\");\n+    if (fp == NULL) return;\n+\n+    fprintf(fp, \"[default]\\n\");\n+    fprintf(fp, \"host = %s\\n\", getenv(\"HOSTNAME\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0912fe7370a58b661e6edb58c69f8cb1585e8dd2"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0NzQyMjAxOnYy", "diffSide": "RIGHT", "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMjowMDozM1rOFp0bjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMjowMDozM1rOFp0bjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5NDk1Ng==", "bodyText": "must be VESPA_APPLICATION here.\nalso, we should probably detect if any of these are unset (getenv returns null pointer), i guess...", "url": "https://github.com/vespa-engine/vespa/pull/12182#discussion_r379394956", "createdAt": "2020-02-14T12:00:33Z", "author": {"login": "arnej27959"}, "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "diffHunk": "@@ -76,6 +77,17 @@ CfHandler::doConfigure()\n     fclose(fp);\n     rename(tmpPath.c_str(), path.c_str());\n \n+    path = cfFilePath(config.splunkHome, \"inputs.conf\");\n+    tmpPath = path + \".new\";\n+    *fp = fopen(tmpPath.c_str(), \"w\");\n+    if (fp == NULL) return;\n+\n+    fprintf(fp, \"[default]\\n\");\n+    fprintf(fp, \"host = %s\\n\", getenv(\"HOSTNAME\"));\n+    fprintf(fp, \"_meta = vespa_tenant::%s vespa_application::%s vespa_instance::%s\\n\", getenv(\"VESPA_TENANT\"), getenv(\"VESPA_APPLICTAION\"), getenv(\"VESPA_INSTANCE\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0912fe7370a58b661e6edb58c69f8cb1585e8dd2"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2481, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}