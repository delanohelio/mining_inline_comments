{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NDE5MDcx", "number": 15529, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQwOTo0MDowNVrOE-kZJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxMDowODozNlrOE-lJgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MDQzNDMwOnYy", "diffSide": "RIGHT", "path": "ERRATA.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQwOTo0MDowNVrOH7y0Ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQwOTo0MDowNVrOH7y0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ2MDU5OA==", "bodyText": "It would be good to have the exact Vespa version ranges here", "url": "https://github.com/vespa-engine/vespa/pull/15529#discussion_r532460598", "createdAt": "2020-11-30T09:40:05Z", "author": {"login": "vekterli"}, "path": "ERRATA.md", "diffHunk": "@@ -0,0 +1,36 @@\n+<!-- Copyright verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root. -->\n+\n+## Errata\n+\n+### 2020-11-30: Document inconsistency\n+This bug existed between 2020-08-28 and 2020-09-23.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b0007aa0027276ab7c5d5c4a52b75fce7ed7f03"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MDQ1MjQ3OnYy", "diffSide": "RIGHT", "path": "ERRATA.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQwOTo0NDoyNFrOH7y-tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxMDoxODo1NFrOH70WDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ2MzI4NQ==", "bodyText": "I'm presuming this needed the old explicit visibility-delay option to be set explicitly to > 0? If so, consider mentioning that this was not the default setting.", "url": "https://github.com/vespa-engine/vespa/pull/15529#discussion_r532463285", "createdAt": "2020-11-30T09:44:24Z", "author": {"login": "vekterli"}, "path": "ERRATA.md", "diffHunk": "@@ -0,0 +1,36 @@\n+<!-- Copyright verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root. -->\n+\n+## Errata\n+\n+### 2020-11-30: Document inconsistency\n+This bug existed between 2020-08-28 and 2020-09-23.\n+The following needs to happen to trigger the bug:\n+\n+* Visibility delay is non-zero.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b0007aa0027276ab7c5d5c4a52b75fce7ed7f03"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ4NTY0Nw==", "bodyText": "yes, good clarification, will add", "url": "https://github.com/vespa-engine/vespa/pull/15529#discussion_r532485647", "createdAt": "2020-11-30T10:18:54Z", "author": {"login": "kkraune"}, "path": "ERRATA.md", "diffHunk": "@@ -0,0 +1,36 @@\n+<!-- Copyright verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root. -->\n+\n+## Errata\n+\n+### 2020-11-30: Document inconsistency\n+This bug existed between 2020-08-28 and 2020-09-23.\n+The following needs to happen to trigger the bug:\n+\n+* Visibility delay is non-zero.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ2MzI4NQ=="}, "originalCommit": {"oid": "4b0007aa0027276ab7c5d5c4a52b75fce7ed7f03"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MDU1NjkxOnYy", "diffSide": "RIGHT", "path": "ERRATA.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxMDowODoxNFrOH7z8OA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxMDoxNzo1NFrOH70ToA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ3OTAzMg==", "bodyText": "We should probably use versions here. Introduced in Vespa 7.277.38. Fixed in 7.292.82.", "url": "https://github.com/vespa-engine/vespa/pull/15529#discussion_r532479032", "createdAt": "2020-11-30T10:08:14Z", "author": {"login": "geirst"}, "path": "ERRATA.md", "diffHunk": "@@ -0,0 +1,36 @@\n+<!-- Copyright verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root. -->\n+\n+## Errata\n+\n+### 2020-11-30: Document inconsistency\n+This bug existed between 2020-08-28 and 2020-09-23.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b0007aa0027276ab7c5d5c4a52b75fce7ed7f03"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ4NTAyNA==", "bodyText": "better!", "url": "https://github.com/vespa-engine/vespa/pull/15529#discussion_r532485024", "createdAt": "2020-11-30T10:17:54Z", "author": {"login": "kkraune"}, "path": "ERRATA.md", "diffHunk": "@@ -0,0 +1,36 @@\n+<!-- Copyright verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root. -->\n+\n+## Errata\n+\n+### 2020-11-30: Document inconsistency\n+This bug existed between 2020-08-28 and 2020-09-23.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ3OTAzMg=="}, "originalCommit": {"oid": "4b0007aa0027276ab7c5d5c4a52b75fce7ed7f03"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MDU1ODA5OnYy", "diffSide": "RIGHT", "path": "ERRATA.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxMDowODozNlrOH7z8-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxMDowODozNlrOH7z8-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ3OTIyNw==", "bodyText": "This was fixed in 7.292.82.", "url": "https://github.com/vespa-engine/vespa/pull/15529#discussion_r532479227", "createdAt": "2020-11-30T10:08:36Z", "author": {"login": "geirst"}, "path": "ERRATA.md", "diffHunk": "@@ -0,0 +1,36 @@\n+<!-- Copyright verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root. -->\n+\n+## Errata\n+\n+### 2020-11-30: Document inconsistency\n+This bug existed between 2020-08-28 and 2020-09-23.\n+The following needs to happen to trigger the bug:\n+\n+* Visibility delay is non-zero.\n+* A new config change is deployed that contains changes to proton.\n+  This config snapshot is stored in the transaction log on the content node.\n+* vespa-proton-bin is restarted, and as part of the prepare for restart step,\n+  at least one attribute vector is not flushed to the current serial number.\n+* Due to the bug, replay of the transaction log will fail to replay feed operations to attributes after replaying the config change.\n+  The effect is that all attributes that were not flushed as part of prepare for restart\n+  will not get any of the updates since the last time they were flushed.\n+* If a document was previously removed, lid space compaction will move another document to that local document id.\n+  Due to later missing updates as part of restarting we might see values from the removed document for some of the attributes.\n+* When the problem attributes are later flushed this inconsistency will be permanent.\n+\n+Solution:\n+* Upgrade Vespa to at least vespa-7.306.19-1.el7.x86_64.rpm.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b0007aa0027276ab7c5d5c4a52b75fce7ed7f03"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 739, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}