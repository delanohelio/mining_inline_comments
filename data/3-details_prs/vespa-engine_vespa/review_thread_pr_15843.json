{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyMTQ4NTM1", "number": 15843, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMTozNTowOVrOFHJciA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMTozNTowOVrOFHJciA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDM5MTEyOnYy", "diffSide": "RIGHT", "path": "travis/travis-build.sh", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMTozNTowOVrOIIfdxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMTo0OTowNlrOIIf3zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc3NTA0Ng==", "bodyText": "Shouldn't this be bootstrap.sh full?", "url": "https://github.com/vespa-engine/vespa/pull/15843#discussion_r545775046", "createdAt": "2020-12-18T11:35:09Z", "author": {"login": "hmusum"}, "path": "travis/travis-build.sh", "diffHunk": "@@ -0,0 +1,49 @@\n+#!/bin/bash\n+# Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+set -e\n+\n+export SOURCE_DIR=/source\n+export NUM_THREADS=6\n+export MALLOC_ARENA_MAX=1\n+export MAVEN_OPTS=\"-Xss1m -Xms128m -Xmx2g\"\n+source /etc/profile.d/enable-devtoolset-9.sh\n+source /etc/profile.d/enable-rh-maven35.sh\n+\n+ccache --max-size=1600M\n+ccache --set-config=compression=true\n+ccache -p\n+\n+if ! source /source/travis/detect-what-to-build.sh; then\n+    echo \"Could not detect what to build.\"\n+    SHOULD_BUILD=all\n+fi\n+\n+echo \"Building: $SHOULD_BUILD\"\n+\n+cd ${SOURCE_DIR}\n+\n+case $SHOULD_BUILD in\n+  cpp)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh full\n+    cmake3 -DVESPA_UNPRIVILEGED=no .\n+    make -j ${NUM_THREADS}\n+    ctest3 --output-on-failure -j ${NUM_THREADS}\n+    ccache --show-stats\n+    ;;\n+  java)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh java\n+    mvn -V install --no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\n+    ;;\n+  *)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh java", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a121c888ea4b606f855890ebda936987a3e2a81f"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc3ODk1OA==", "bodyText": "When we build all, all the java artifacts will be built with Maven.  Using full here will work but the modules will be recompiled (waste) on the next line. The *) does exactly what we did for all PRs earlier.", "url": "https://github.com/vespa-engine/vespa/pull/15843#discussion_r545778958", "createdAt": "2020-12-18T11:43:30Z", "author": {"login": "aressem"}, "path": "travis/travis-build.sh", "diffHunk": "@@ -0,0 +1,49 @@\n+#!/bin/bash\n+# Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+set -e\n+\n+export SOURCE_DIR=/source\n+export NUM_THREADS=6\n+export MALLOC_ARENA_MAX=1\n+export MAVEN_OPTS=\"-Xss1m -Xms128m -Xmx2g\"\n+source /etc/profile.d/enable-devtoolset-9.sh\n+source /etc/profile.d/enable-rh-maven35.sh\n+\n+ccache --max-size=1600M\n+ccache --set-config=compression=true\n+ccache -p\n+\n+if ! source /source/travis/detect-what-to-build.sh; then\n+    echo \"Could not detect what to build.\"\n+    SHOULD_BUILD=all\n+fi\n+\n+echo \"Building: $SHOULD_BUILD\"\n+\n+cd ${SOURCE_DIR}\n+\n+case $SHOULD_BUILD in\n+  cpp)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh full\n+    cmake3 -DVESPA_UNPRIVILEGED=no .\n+    make -j ${NUM_THREADS}\n+    ctest3 --output-on-failure -j ${NUM_THREADS}\n+    ccache --show-stats\n+    ;;\n+  java)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh java\n+    mvn -V install --no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\n+    ;;\n+  *)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh java", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc3NTA0Ng=="}, "originalCommit": {"oid": "a121c888ea4b606f855890ebda936987a3e2a81f"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc4MTcwOA==", "bodyText": "Great!", "url": "https://github.com/vespa-engine/vespa/pull/15843#discussion_r545781708", "createdAt": "2020-12-18T11:49:06Z", "author": {"login": "hmusum"}, "path": "travis/travis-build.sh", "diffHunk": "@@ -0,0 +1,49 @@\n+#!/bin/bash\n+# Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+set -e\n+\n+export SOURCE_DIR=/source\n+export NUM_THREADS=6\n+export MALLOC_ARENA_MAX=1\n+export MAVEN_OPTS=\"-Xss1m -Xms128m -Xmx2g\"\n+source /etc/profile.d/enable-devtoolset-9.sh\n+source /etc/profile.d/enable-rh-maven35.sh\n+\n+ccache --max-size=1600M\n+ccache --set-config=compression=true\n+ccache -p\n+\n+if ! source /source/travis/detect-what-to-build.sh; then\n+    echo \"Could not detect what to build.\"\n+    SHOULD_BUILD=all\n+fi\n+\n+echo \"Building: $SHOULD_BUILD\"\n+\n+cd ${SOURCE_DIR}\n+\n+case $SHOULD_BUILD in\n+  cpp)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh full\n+    cmake3 -DVESPA_UNPRIVILEGED=no .\n+    make -j ${NUM_THREADS}\n+    ctest3 --output-on-failure -j ${NUM_THREADS}\n+    ccache --show-stats\n+    ;;\n+  java)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh java\n+    mvn -V install --no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\n+    ;;\n+  *)\n+    env VESPA_MAVEN_EXTRA_OPTS=\"--no-snapshot-updates --batch-mode --threads ${NUM_THREADS}\" sh ./bootstrap.sh java", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc3NTA0Ng=="}, "originalCommit": {"oid": "a121c888ea4b606f855890ebda936987a3e2a81f"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2066, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}