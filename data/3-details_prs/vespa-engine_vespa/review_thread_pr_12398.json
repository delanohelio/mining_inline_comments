{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyMzQ5MDI0", "number": 12398, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMjozMzo0NFrODkQAGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMjozMzo0NFrODkQAGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5MzM3NDk3OnYy", "diffSide": "RIGHT", "path": "config-provisioning/src/main/java/com/yahoo/config/provision/ClusterMembership.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMjozMzo0NFrOFwd58w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMjo1OToyNVrOFwemYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2NTkzOQ==", "bodyText": "During upgrade this will write a value with combined id that other instances that are not upgraded yet will not be able to read. Shouldn't we handle strings with combined id first and in a later version start writing it?", "url": "https://github.com/vespa-engine/vespa/pull/12398#discussion_r386365939", "createdAt": "2020-03-02T12:33:44Z", "author": {"login": "hmusum"}, "path": "config-provisioning/src/main/java/com/yahoo/config/provision/ClusterMembership.java", "diffHunk": "@@ -54,7 +59,8 @@ protected String toStringValue() {\n                (cluster.group().isPresent() ? \"/\" + cluster.group().get().index() : \"\") +\n                \"/\" + index +\n                ( cluster.isExclusive() ? \"/exclusive\" : \"\") +\n-               ( retired ? \"/retired\" : \"\");\n+               ( retired ? \"/retired\" : \"\") +\n+               ( cluster.combinedId().isPresent() ? \"/\" + cluster.combinedId().get().value() : \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8dc031111d0ec7ff77273a3a21e0f23c7d4aceca"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3MDc4Mw==", "bodyText": "Of course, thanks!", "url": "https://github.com/vespa-engine/vespa/pull/12398#discussion_r386370783", "createdAt": "2020-03-02T12:44:58Z", "author": {"login": "mpolden"}, "path": "config-provisioning/src/main/java/com/yahoo/config/provision/ClusterMembership.java", "diffHunk": "@@ -54,7 +59,8 @@ protected String toStringValue() {\n                (cluster.group().isPresent() ? \"/\" + cluster.group().get().index() : \"\") +\n                \"/\" + index +\n                ( cluster.isExclusive() ? \"/exclusive\" : \"\") +\n-               ( retired ? \"/retired\" : \"\");\n+               ( retired ? \"/retired\" : \"\") +\n+               ( cluster.combinedId().isPresent() ? \"/\" + cluster.combinedId().get().value() : \"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2NTkzOQ=="}, "originalCommit": {"oid": "8dc031111d0ec7ff77273a3a21e0f23c7d4aceca"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3Mjg3MQ==", "bodyText": "Actually, the existing code appears to handle this. It ignores trailing components of the serialized string that it does not explicitly handle.", "url": "https://github.com/vespa-engine/vespa/pull/12398#discussion_r386372871", "createdAt": "2020-03-02T12:49:42Z", "author": {"login": "mpolden"}, "path": "config-provisioning/src/main/java/com/yahoo/config/provision/ClusterMembership.java", "diffHunk": "@@ -54,7 +59,8 @@ protected String toStringValue() {\n                (cluster.group().isPresent() ? \"/\" + cluster.group().get().index() : \"\") +\n                \"/\" + index +\n                ( cluster.isExclusive() ? \"/exclusive\" : \"\") +\n-               ( retired ? \"/retired\" : \"\");\n+               ( retired ? \"/retired\" : \"\") +\n+               ( cluster.combinedId().isPresent() ? \"/\" + cluster.combinedId().get().value() : \"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2NTkzOQ=="}, "originalCommit": {"oid": "8dc031111d0ec7ff77273a3a21e0f23c7d4aceca"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3NzMxNQ==", "bodyText": "Yes, it might not be an issue here. As long as you don't need the combined id I guess that will work, but if you later rely upon this (e.g. in a later PR that goes in before this is released) something might break.", "url": "https://github.com/vespa-engine/vespa/pull/12398#discussion_r386377315", "createdAt": "2020-03-02T12:59:25Z", "author": {"login": "hmusum"}, "path": "config-provisioning/src/main/java/com/yahoo/config/provision/ClusterMembership.java", "diffHunk": "@@ -54,7 +59,8 @@ protected String toStringValue() {\n                (cluster.group().isPresent() ? \"/\" + cluster.group().get().index() : \"\") +\n                \"/\" + index +\n                ( cluster.isExclusive() ? \"/exclusive\" : \"\") +\n-               ( retired ? \"/retired\" : \"\");\n+               ( retired ? \"/retired\" : \"\") +\n+               ( cluster.combinedId().isPresent() ? \"/\" + cluster.combinedId().get().value() : \"\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2NTkzOQ=="}, "originalCommit": {"oid": "8dc031111d0ec7ff77273a3a21e0f23c7d4aceca"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2392, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}