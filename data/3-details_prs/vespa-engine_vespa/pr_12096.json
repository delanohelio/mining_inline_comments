{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxOTE3MzUz", "number": 12096, "title": "Simplify regexes generated from document selection glob patterns", "bodyText": "@geirst @baldersheim please review\nAttempts to simplify the resulting regex as much as possible to help\nminimize the number of possible catastrophic backtracking cases that\ncan be triggered by wildcard regexes.\nThe following simplifications are currently performed:\n\n'' -> /^$/   (empty string match)\n'*' -> //     (any string match)\n'*foo*' -> /foo/  (substring match)\n'*foo' -> /foo$/ (suffix match)\n'foo*' -> /^foo/ (prefix match)\ncollapsing runs of consecutive * wildcards into a single\nwildcard. *** is identical to ** which is identical to * etc,\nas all these match 0-n characters each. This also works with\nsimplification, i.e. ***foo*** -> /foo/ and *** -> //\n\nCould be further simplified still by moving '?' matches as far to the left\nas possible around wildcards, effectively turning *?*?*?* into ???,\nbut there are limits to how much we can do to avoid self foot vs. gun\ninteraction.\nThis relates to issue #12068", "createdAt": "2020-02-06T14:06:03Z", "url": "https://github.com/vespa-engine/vespa/pull/12096", "merged": true, "mergeCommit": {"oid": "9d2c5579408e08c1040000a88a4d80ccdf863f20"}, "closed": true, "closedAt": "2020-02-07T13:48:37Z", "author": {"login": "vekterli"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBq0iKAH2gAyMzcxOTE3MzUzOjdjNjEwZTEyMmIzNzRiYmRlMGI4NDdmNmVhYjAxNDk0YzgyNTNiMjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcB-e4VgH2gAyMzcxOTE3MzUzOmE0YjNiMTdkOTcxZjdjNTI4ZjE4MjBmNDQxYzRjN2UxMDMxYjBjZWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7c610e122b374bbde0b847f6eab01494c8253b27", "author": {"user": {"login": "vekterli", "name": "Tor Brede Vekterli"}}, "url": "https://github.com/vespa-engine/vespa/commit/7c610e122b374bbde0b847f6eab01494c8253b27", "committedDate": "2020-02-06T13:33:24Z", "message": "Simplify regexes generated from document selection glob patterns\n\nAttempts to simplify the resulting regex as much as possible to help\nminimize the number of possible catastrophic backtracking cases that\ncan be triggered by wildcard regexes.\n\nThe following simplifications are currently performed:\n* ''      -> /^$/   (empty string match)\n* '*'     -> //     (any string match)\n* '*foo*' -> /foo/  (substring match)\n* '*foo'  -> /foo$/ (suffix match)\n* 'foo*'  -> /^foo/ (prefix match)\n* collapsing runs of consecutive `*` wildcards into a single\n  wildcard. `***` is identical to `**` which is identical to `*` etc,\n  as all these match 0-n characters each. This also works with\n  simplification, i.e. `***foo***` -> /foo/ and `***` -> //\n\nThis relates to issue #12068"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0NTUyNTE4", "url": "https://github.com/vespa-engine/vespa/pull/12096#pullrequestreview-354552518", "createdAt": "2020-02-06T15:42:33Z", "commit": {"oid": "7c610e122b374bbde0b847f6eab01494c8253b27"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0OTg1NTY0", "url": "https://github.com/vespa-engine/vespa/pull/12096#pullrequestreview-354985564", "createdAt": "2020-02-07T08:08:55Z", "commit": {"oid": "7c610e122b374bbde0b847f6eab01494c8253b27"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODowODo1NlrOFm1CLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODowODo1NlrOFm1CLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjI1OTExNw==", "bodyText": "operators3 -> operators_3 for consistency?", "url": "https://github.com/vespa-engine/vespa/pull/12096#discussion_r376259117", "createdAt": "2020-02-07T08:08:56Z", "author": {"login": "geirst"}, "path": "document/src/tests/documentselectparsertest.cpp", "diffHunk": "@@ -637,7 +632,7 @@ void DocumentSelectParserTest::testOperators2()\n     PARSEI(\"id.group == \\\"xyzzy\\\"\", *_doc[10], True);\n }\n \n-void DocumentSelectParserTest::testOperators3()\n+TEST_F(DocumentSelectParserTest, operators3)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c610e122b374bbde0b847f6eab01494c8253b27"}, "originalPosition": 98}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4b3b17d971f7c528f1820f441c4c7e1031b0ceb", "author": {"user": {"login": "vekterli", "name": "Tor Brede Vekterli"}}, "url": "https://github.com/vespa-engine/vespa/commit/a4b3b17d971f7c528f1820f441c4c7e1031b0ceb", "committedDate": "2020-02-07T12:27:51Z", "message": "Consistent test naming"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3034, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}