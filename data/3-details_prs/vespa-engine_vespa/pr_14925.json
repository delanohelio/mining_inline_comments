{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0ODA1NjI1", "number": 14925, "title": "Temporarily setup old restapi handler w/o binding if new handler is e\u2026", "bodyText": "\u2026nabled\nI confirm that this contribution is made under the terms of the license found in the root directory of this repository's source tree and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-10-16T12:28:04Z", "url": "https://github.com/vespa-engine/vespa/pull/14925", "merged": true, "mergeCommit": {"oid": "b8656fa6b55f73285106f2d8bcfa9d1a3f1ab2b4"}, "closed": true, "closedAt": "2020-10-16T12:34:04Z", "author": {"login": "bjorncs"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdTFgXAAH2gAyNTA0ODA1NjI1OmU0OWZmNDYyMTY1M2RiNWY1YWFlNDk2OTYzYzM2ZDQ5YjJjNmY1MDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdTFnDtgFqTUxMDQyNTQwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e49ff4621653db5f5aae496963c36d49b2c6f507", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/e49ff4621653db5f5aae496963c36d49b2c6f507", "committedDate": "2020-10-16T12:26:40Z", "message": "Temporarily setup old restapi handler w/o binding if new handler is enabled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNDIyNzAx", "url": "https://github.com/vespa-engine/vespa/pull/14925#pullrequestreview-510422701", "createdAt": "2020-10-16T12:30:02Z", "commit": {"oid": "e49ff4621653db5f5aae496963c36d49b2c6f507"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjozMDowMlrOHi6Crw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjozMDowMlrOHi6Crw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM2NDU5MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // TODO(bjorncs,jvenstad) Cleanup once old restapi handler is gone\n          \n          \n            \n                    // TODO(bjorncs,jonmv) Cleanup once old restapi handler is gone", "url": "https://github.com/vespa-engine/vespa/pull/14925#discussion_r506364591", "createdAt": "2020-10-16T12:30:02Z", "author": {"login": "jonmv"}, "path": "config-model/src/main/java/com/yahoo/vespa/model/clients/ContainerDocumentApi.java", "diffHunk": "@@ -41,16 +41,21 @@ private static void addFeedHandler(ContainerCluster<?> cluster, Options options)\n \n \n     private static void addRestApiHandler(ContainerCluster<?> cluster, Options options) {\n-        String handlerClassName = options.useNewRestapiHandler\n-                ? \"com.yahoo.document.restapi.resource.DocumentV1ApiHandler\"\n-                : \"com.yahoo.document.restapi.resource.RestApi\";\n-        var handler = newVespaClientHandler(handlerClassName, \"/document/v1/*\", options);\n-        cluster.addComponent(handler);\n-        if (!options.useNewRestapiHandler) {\n-            var executor = new Threadpool(\n-                    \"restapi-handler\", cluster, options.restApiThreadpoolOptions, options.feedThreadPoolSizeFactor);\n-            handler.inject(executor);\n-            handler.addComponent(executor);\n+        // TODO(bjorncs,jvenstad) Cleanup once old restapi handler is gone", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e49ff4621653db5f5aae496963c36d49b2c6f507"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75eb94eec1a8d80ece788956d0612848918c704c", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/75eb94eec1a8d80ece788956d0612848918c704c", "committedDate": "2020-10-16T12:30:05Z", "message": "Update config-model/src/main/java/com/yahoo/vespa/model/clients/ContainerDocumentApi.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNDI0ODY5", "url": "https://github.com/vespa-engine/vespa/pull/14925#pullrequestreview-510424869", "createdAt": "2020-10-16T12:33:10Z", "commit": {"oid": "75eb94eec1a8d80ece788956d0612848918c704c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjozMzoxMVrOHi6LXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxMjozMzoxMVrOHi6LXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjM2NjgxNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (bindingSuffix == null) return handler; // TODO(bjorncs,jvenstad) Cleanup once old restapi handler is gone\n          \n          \n            \n                    if (bindingSuffix == null) return handler; // TODO(bjorncs,jonmv) Cleanup once old restapi handler is gone", "url": "https://github.com/vespa-engine/vespa/pull/14925#discussion_r506366815", "createdAt": "2020-10-16T12:33:11Z", "author": {"login": "jonmv"}, "path": "config-model/src/main/java/com/yahoo/vespa/model/clients/ContainerDocumentApi.java", "diffHunk": "@@ -60,6 +65,7 @@ private static void addRestApiHandler(ContainerCluster<?> cluster, Options optio\n             Options options) {\n         Handler<AbstractConfigProducer<?>> handler = new Handler<>(new ComponentModel(\n                 BundleInstantiationSpecification.getFromStrings(componentId, null, \"vespaclient-container-plugin\"), \"\"));\n+        if (bindingSuffix == null) return handler; // TODO(bjorncs,jvenstad) Cleanup once old restapi handler is gone", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75eb94eec1a8d80ece788956d0612848918c704c"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cbce598190a4c65cf02b22f1119935bf9783095", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/3cbce598190a4c65cf02b22f1119935bf9783095", "committedDate": "2020-10-16T12:33:14Z", "message": "Update config-model/src/main/java/com/yahoo/vespa/model/clients/ContainerDocumentApi.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNDI1NDA4", "url": "https://github.com/vespa-engine/vespa/pull/14925#pullrequestreview-510425408", "createdAt": "2020-10-16T12:33:59Z", "commit": {"oid": "3cbce598190a4c65cf02b22f1119935bf9783095"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2265, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}