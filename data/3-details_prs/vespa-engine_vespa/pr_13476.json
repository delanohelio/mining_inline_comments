{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MjY5ODIz", "number": 13476, "title": "Bjorncs/container thread pool", "bodyText": "I confirm that this contribution is made under the terms of the license found in the root directory of this repository's source tree and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-06-03T15:12:37Z", "url": "https://github.com/vespa-engine/vespa/pull/13476", "merged": true, "mergeCommit": {"oid": "f489483457969155f3b7483b3a865f131d556c8f"}, "closed": true, "closedAt": "2020-06-03T20:16:46Z", "author": {"login": "bjorncs"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnq7-ZgH2gAyNDI3MjY5ODIzOmE5YTNjYWRlZGJmNWM1MjcwZmNmODU0MWViMzdlOGVmNjllYTU3ZjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnvTJlgH2gAyNDI3MjY5ODIzOjY4NDA5NDY2YjFiNWRmODE3NWE5YWE2NzU3YzU5YzRhNWFhM2M5NjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a9a3cadedbf5c5270fcf8541eb37e8ef69ea57f0", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/a9a3cadedbf5c5270fcf8541eb37e8ef69ea57f0", "committedDate": "2020-06-03T15:10:39Z", "message": "Add config for thread pool name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2b874ebabfcecffbfeece5623048d9dca597e65", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/b2b874ebabfcecffbfeece5623048d9dca597e65", "committedDate": "2020-06-03T15:10:39Z", "message": "Add config for core pool size"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3166f8a263d9a64773a4edf2aa31f0229b5c8568", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/3166f8a263d9a64773a4edf2aa31f0229b5c8568", "committedDate": "2020-06-03T15:10:39Z", "message": "Add config for keep alive time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb07ffe8bd6cd9bce0db51f78826d88adb968a07", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/eb07ffe8bd6cd9bce0db51f78826d88adb968a07", "committedDate": "2020-06-03T15:10:39Z", "message": "Add thread pool name as dimension to metric values"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54c7d6419ed0702f4f6d23211a88051393551664", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/54c7d6419ed0702f4f6d23211a88051393551664", "committedDate": "2020-06-03T15:10:40Z", "message": "Update ABI spec for ThreadpoolConfig"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNzU4OTEw", "url": "https://github.com/vespa-engine/vespa/pull/13476#pullrequestreview-423758910", "createdAt": "2020-06-03T17:05:02Z", "commit": {"oid": "54c7d6419ed0702f4f6d23211a88051393551664"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNzowNTowM1rOGelWAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNzowNTowM1rOGelWAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcyMjMwNg==", "bodyText": "missing EOL", "url": "https://github.com/vespa-engine/vespa/pull/13476#discussion_r434722306", "createdAt": "2020-06-03T17:05:03Z", "author": {"login": "baldersheim"}, "path": "container-core/src/main/resources/configdefinitions/threadpool.def", "diffHunk": "@@ -16,3 +22,6 @@ queueSize int default=0\n # get out of a bad state. This should be set a bit higher than the expected max execution\n # time of each request when in a state of overload, i.e about \"worst case execution time*2\"\n maxThreadExecutionTimeSeconds int default=190\n+\n+# Prefix for the name of the threads\n+name string default=\"default-pool\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54c7d6419ed0702f4f6d23211a88051393551664"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNzU5Nzky", "url": "https://github.com/vespa-engine/vespa/pull/13476#pullrequestreview-423759792", "createdAt": "2020-06-03T17:06:13Z", "commit": {"oid": "54c7d6419ed0702f4f6d23211a88051393551664"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNzowNjoxNFrOGelYqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxNzowNjoxNFrOGelYqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcyMjk4Nw==", "bodyText": "I think the default should be more agressive. I was thinking 5s.", "url": "https://github.com/vespa-engine/vespa/pull/13476#discussion_r434722987", "createdAt": "2020-06-03T17:06:14Z", "author": {"login": "baldersheim"}, "path": "container-core/src/main/resources/configdefinitions/threadpool.def", "diffHunk": "@@ -2,10 +2,16 @@\n \n namespace=container.handler\n \n-## Num ber of thread in the thread pool\n+## Maximum number of thread in the thread pool\n ## Setting it to 0 or negative number will cause it to be set to #cores * 4\n maxthreads int default=500\n \n+# The number of threads to keep in the pool, even if they are idle\n+corePoolSize int default=500\n+\n+# The number of seconds that excess idle threads will wait for new tasks before terminating\n+keepAliveTime double default=60.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54c7d6419ed0702f4f6d23211a88051393551664"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNzYwMzg1", "url": "https://github.com/vespa-engine/vespa/pull/13476#pullrequestreview-423760385", "createdAt": "2020-06-03T17:07:04Z", "commit": {"oid": "54c7d6419ed0702f4f6d23211a88051393551664"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60feaaa998976c427570bea1f9138472249a4ffd", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/60feaaa998976c427570bea1f9138472249a4ffd", "committedDate": "2020-06-03T20:07:40Z", "message": "Fix noeol and set default idletime to 5s"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68409466b1b5df8175a9aa6757c59c4a5aa3c965", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/68409466b1b5df8175a9aa6757c59c4a5aa3c965", "committedDate": "2020-06-03T20:15:35Z", "message": "Annotate primary constructor with @Inject."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3676, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}