{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMTA5ODIx", "number": 12135, "title": "Hnsw simplifications with distance function interface", "bodyText": "@arnej27959 please review", "createdAt": "2020-02-10T12:33:48Z", "url": "https://github.com/vespa-engine/vespa/pull/12135", "merged": true, "mergeCommit": {"oid": "ebfcce139ce2d561bd820973f03be923440c91b4"}, "closed": true, "closedAt": "2020-02-11T13:05:18Z", "author": {"login": "geirst"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcC8DkcAH2gAyMzczMTA5ODIxOjgxNjRlNGE1YzQ5MTBhODc4ZTQ5NjYzNzMwZGU1YzJiMzEwZDU5NDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDQQFJAH2gAyMzczMTA5ODIxOmUzZTc3ZDMxMGUwY2E2MzYzYTZiNDU3MWNhNTVmODUzNTZkYjYwYWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8164e4a5c4910a878e49663730de5c2b310d5940", "author": {"user": {"login": "geirst", "name": "Geir Storli"}}, "url": "https://github.com/vespa-engine/vespa/commit/8164e4a5c4910a878e49663730de5c2b310d5940", "committedDate": "2020-02-10T12:12:08Z", "message": "Add interface used to calculate the distance between two n-dim vectors."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1debbb54c26ce0c146a1d0711beea55adef3173b", "author": {"user": {"login": "geirst", "name": "Geir Storli"}}, "url": "https://github.com/vespa-engine/vespa/commit/1debbb54c26ce0c146a1d0711beea55adef3173b", "committedDate": "2020-02-10T12:19:40Z", "message": "Move code to the hnsw index base class as we no longer depend on the float type."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9e867c4a20e9aa340dbdb110066083ebcc2a619", "author": {"user": {"login": "geirst", "name": "Geir Storli"}}, "url": "https://github.com/vespa-engine/vespa/commit/b9e867c4a20e9aa340dbdb110066083ebcc2a619", "committedDate": "2020-02-10T12:30:47Z", "message": "Rename HnswIndexBase -> HnswIndex and remove the templated class."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NDg1Njgx", "url": "https://github.com/vespa-engine/vespa/pull/12135#pullrequestreview-356485681", "createdAt": "2020-02-11T08:49:19Z", "commit": {"oid": "b9e867c4a20e9aa340dbdb110066083ebcc2a619"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwODo0OToxOVrOFoA3oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQwODo0OToxOVrOFoA3oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzUwMTYwMQ==", "bodyText": "i don't see that you should need \"template\" here...", "url": "https://github.com/vespa-engine/vespa/pull/12135#discussion_r377501601", "createdAt": "2020-02-11T08:49:19Z", "author": {"login": "arnej27959"}, "path": "searchlib/src/vespa/searchlib/tensor/distance_functions.h", "diffHunk": "@@ -0,0 +1,34 @@\n+// Copyright 2020 Oath Inc. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+#pragma once\n+\n+#include \"distance_function.h\"\n+\n+namespace search::tensor {\n+\n+// TODO: Make distance functions hardware optimized.\n+\n+/**\n+ * Calculates the square of the standard Euclidean distance.\n+ */\n+template <typename FloatType>\n+class SquaredEuclideanDistance : public DistanceFunction {\n+public:\n+    double calc(const vespalib::tensor::TypedCells& lhs, const vespalib::tensor::TypedCells& rhs) const override {\n+        auto lhs_vector = lhs.template typify<FloatType>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9e867c4a20e9aa340dbdb110066083ebcc2a619"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3e77d310e0ca6363a6b4571ca55f85356db60af", "author": {"user": {"login": "geirst", "name": "Geir Storli"}}, "url": "https://github.com/vespa-engine/vespa/commit/e3e77d310e0ca6363a6b4571ca55f85356db60af", "committedDate": "2020-02-11T11:43:54Z", "message": "Remove unneeded \"template\" keyword."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2963, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}