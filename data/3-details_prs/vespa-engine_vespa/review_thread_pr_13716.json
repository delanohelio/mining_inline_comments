{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNDA1OTQ5", "number": 13716, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNjozNTowMlrOEJBOuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNjozNTo0MFrOEJBPRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3ODkyNzk1OnYy", "diffSide": "RIGHT", "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/task/util/file/FileFinder.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNjozNTowMlrOGpVUDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNjo1NzowNVrOGpVzVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5Mzk5OQ==", "bodyText": "Why not use a for loop on line 118 instead to avoid this hack?", "url": "https://github.com/vespa-engine/vespa/pull/13716#discussion_r445993999", "createdAt": "2020-06-26T06:35:02Z", "author": {"login": "bratseth"}, "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/task/util/file/FileFinder.java", "diffHunk": "@@ -110,17 +110,19 @@ public FileFinder maxDepth(int maxDepth) {\n      * @return true iff anything was matched and deleted\n      */\n     public boolean deleteRecursively(TaskContext context) {\n+        final int limit = 20;\n+        int[] numDeleted = { 0 };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3107db1ddeba678b1fa9d8523d96b36b8f32003a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5NjYzNg==", "bodyText": "At its core, this class only has a way a method to run a lambda on a matching file via java.nio.file.Files::walkFileTree, I don't see any simple way to create an Iterable out of that?", "url": "https://github.com/vespa-engine/vespa/pull/13716#discussion_r445996636", "createdAt": "2020-06-26T06:42:37Z", "author": {"login": "freva"}, "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/task/util/file/FileFinder.java", "diffHunk": "@@ -110,17 +110,19 @@ public FileFinder maxDepth(int maxDepth) {\n      * @return true iff anything was matched and deleted\n      */\n     public boolean deleteRecursively(TaskContext context) {\n+        final int limit = 20;\n+        int[] numDeleted = { 0 };", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5Mzk5OQ=="}, "originalCommit": {"oid": "3107db1ddeba678b1fa9d8523d96b36b8f32003a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAwMjAwNQ==", "bodyText": "Ah, right. Didn't look at the context. Then I suggest adding a comment, or using MutableInteger.", "url": "https://github.com/vespa-engine/vespa/pull/13716#discussion_r446002005", "createdAt": "2020-06-26T06:57:05Z", "author": {"login": "bratseth"}, "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/task/util/file/FileFinder.java", "diffHunk": "@@ -110,17 +110,19 @@ public FileFinder maxDepth(int maxDepth) {\n      * @return true iff anything was matched and deleted\n      */\n     public boolean deleteRecursively(TaskContext context) {\n+        final int limit = 20;\n+        int[] numDeleted = { 0 };", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5Mzk5OQ=="}, "originalCommit": {"oid": "3107db1ddeba678b1fa9d8523d96b36b8f32003a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3ODkyOTM0OnYy", "diffSide": "RIGHT", "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/task/util/file/FileFinder.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNjozNTo0MFrOGpVU4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwNjo0NToyN1rOGpViVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5NDIxMQ==", "bodyText": "Maybe worth a comment saying why there is a limit?", "url": "https://github.com/vespa-engine/vespa/pull/13716#discussion_r445994211", "createdAt": "2020-06-26T06:35:40Z", "author": {"login": "bratseth"}, "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/task/util/file/FileFinder.java", "diffHunk": "@@ -110,17 +110,19 @@ public FileFinder maxDepth(int maxDepth) {\n      * @return true iff anything was matched and deleted\n      */\n     public boolean deleteRecursively(TaskContext context) {\n+        final int limit = 20;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3107db1ddeba678b1fa9d8523d96b36b8f32003a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5NzY1Mw==", "bodyText": "Renamed the variable to maxNumberOfDeletedPathsToLog", "url": "https://github.com/vespa-engine/vespa/pull/13716#discussion_r445997653", "createdAt": "2020-06-26T06:45:27Z", "author": {"login": "freva"}, "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/task/util/file/FileFinder.java", "diffHunk": "@@ -110,17 +110,19 @@ public FileFinder maxDepth(int maxDepth) {\n      * @return true iff anything was matched and deleted\n      */\n     public boolean deleteRecursively(TaskContext context) {\n+        final int limit = 20;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5NDIxMQ=="}, "originalCommit": {"oid": "3107db1ddeba678b1fa9d8523d96b36b8f32003a"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1899, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}