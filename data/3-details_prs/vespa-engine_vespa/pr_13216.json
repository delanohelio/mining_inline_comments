{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MjU2MjA1", "number": 13216, "title": "Account and limit number of lids per file to reduce spkies during com\u2026", "bodyText": "\u2026paction.\nThis is to avoid ending up with a very long listof lids that are removed but not compacted away due to lidspace compaction being disabled when\nremoves and delets are too frequent.\n@toregge and @geirst  PR", "createdAt": "2020-05-11T17:59:46Z", "url": "https://github.com/vespa-engine/vespa/pull/13216", "merged": true, "mergeCommit": {"oid": "3b9a4d250a93644e595472ea13851f454f3dc897"}, "closed": true, "closedAt": "2020-05-13T13:06:41Z", "author": {"login": "baldersheim"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgTbQ1AH2gAyNDE2MjU2MjA1Ojk4ZDdjOGYxYzFiZDM2MjAwZGI5NjFjMGI4NDhhODIwMDE0YWI2MWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcg4cFUgH2gAyNDE2MjU2MjA1OjUzMjM4ZWEyZDI1NGYzNWI1YjAwMzJjOTVjMWViMzQ3NmQwNjEzMTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "98d7c8f1c1bd36200db961c0b848a820014ab61f", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/98d7c8f1c1bd36200db961c0b848a820014ab61f", "committedDate": "2020-05-11T17:49:38Z", "message": "Account and limit number of lids per file to reduce spkies during compaction.\nThis is to avoid ending up with a very long listof lids that are removed but not compacted away due to lidspace compaction being disabled when\nremoves and delets are too frequent."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb40abca82046351a2a62258645ab09305d08c74", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/eb40abca82046351a2a62258645ab09305d08c74", "committedDate": "2020-05-11T21:14:48Z", "message": "Depends on scheduling order so range must be extended."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwODM5MDEx", "url": "https://github.com/vespa-engine/vespa/pull/13216#pullrequestreview-410839011", "createdAt": "2020-05-13T11:40:46Z", "commit": {"oid": "98d7c8f1c1bd36200db961c0b848a820014ab61f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMTo0MDo0NlrOGUtjeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMTo0MDo0NlrOGUtjeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM3MTA2Ng==", "bodyText": "Consider using search::test::DirectoryHandler (searchlib/test/directory_handler.h) instead.", "url": "https://github.com/vespa-engine/vespa/pull/13216#discussion_r424371066", "createdAt": "2020-05-13T11:40:46Z", "author": {"login": "geirst"}, "path": "searchlib/src/tests/docstore/logdatastore/logdatastore_test.cpp", "diffHunk": "@@ -202,15 +202,24 @@ TEST(\"test that DirectIOPadding works accordng to spec\") {\n }\n #endif\n \n-TEST(\"testGrowing\") {\n-    FastOS_File::EmptyAndRemoveDirectory(\"growing\");\n-    EXPECT_TRUE(FastOS_File::MakeDirectory(\"growing\"));\n-    LogDataStore::Config config; //(100000, 0.1, 3.0, 0.2, 8, true, CompressionConfig::LZ4,\n-                                // WriteableFileChunk::Config(CompressionConfig(CompressionConfig::LZ4, 9, 60), 1000));\n-    config.setMaxFileSize(100000).setMaxDiskBloatFactor(0.1).setMaxBucketSpread(3.0).setMinFileSizeFactor(0.2)\n-            .compactCompression({CompressionConfig::LZ4})\n-            .setFileConfig({{CompressionConfig::LZ4, 9, 60}, 1000});\n-    vespalib::ThreadStackExecutor executor(8, 128*1024);\n+class TmpDirectory {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98d7c8f1c1bd36200db961c0b848a820014ab61f"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwODUzNDIy", "url": "https://github.com/vespa-engine/vespa/pull/13216#pullrequestreview-410853422", "createdAt": "2020-05-13T12:02:30Z", "commit": {"oid": "eb40abca82046351a2a62258645ab09305d08c74"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53238ea2d254f35b5b0032c95c1eb3476d061318", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/53238ea2d254f35b5b0032c95c1eb3476d061318", "committedDate": "2020-05-13T12:57:01Z", "message": "Use DirectoryHandler to reduce code duplication."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3211, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}