{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5MzE1OTcx", "number": 14761, "title": "Destroy visitor session in other thread to avoid deadlock, and 1000 q\u2026", "bodyText": "@bjorncs please review. This will let us know early if there are more things to fix.", "createdAt": "2020-10-07T14:59:13Z", "url": "https://github.com/vespa-engine/vespa/pull/14761", "merged": true, "mergeCommit": {"oid": "5d553508808f890b80f910d48116a7423bb097f7"}, "closed": true, "closedAt": "2020-10-07T17:26:39Z", "author": {"login": "jonmv"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQOSCoAH2gAyNDk5MzE1OTcxOjMyMmYyYzFkMjllNTVhYTc5ODAzNzE5M2E0ZjEzYTQ4YTEzNzQ4NGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQQY6dgH2gAyNDk5MzE1OTcxOjEwZjNhODAzZTE5ODViN2JjMWMwOTMyM2Q4ZGE1MGYzZWIyYmJmZDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "322f2c1d29e55aa798037193a4f13a48a137484f", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/322f2c1d29e55aa798037193a4f13a48a137484f", "committedDate": "2020-10-07T14:58:24Z", "message": "Destroy visitor session in other thread to avoid deadlock, and 1000 queue size"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzOTk4MzA1", "url": "https://github.com/vespa-engine/vespa/pull/14761#pullrequestreview-503998305", "createdAt": "2020-10-07T15:22:01Z", "commit": {"oid": "322f2c1d29e55aa798037193a4f13a48a137484f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNToyMjowMVrOHd4xLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNToyMjowMVrOHd4xLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTEwMDg0Nw==", "bodyText": "The executor must be shutdown in close/deconstruct", "url": "https://github.com/vespa-engine/vespa/pull/14761#discussion_r501100847", "createdAt": "2020-10-07T15:22:01Z", "author": {"login": "bjorncs"}, "path": "vespaclient-container-plugin/src/main/java/com/yahoo/document/restapi/DocumentOperationExecutorImpl.java", "diffHunk": "@@ -85,6 +86,7 @@\n     private final DelayQueue throttled;\n     private final DelayQueue timeouts;\n     private final Map<VisitorControlHandler, VisitorSession> visits = new ConcurrentHashMap<>();\n+    private final Executor visitSessionShutdownExecutor = Executors.newSingleThreadExecutor();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "322f2c1d29e55aa798037193a4f13a48a137484f"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "958ff2da163fbe254b7baae7522c845ecfef38ad", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/958ff2da163fbe254b7baae7522c845ecfef38ad", "committedDate": "2020-10-07T15:25:55Z", "message": "Shut down executor and use named thread"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MDA0NTM1", "url": "https://github.com/vespa-engine/vespa/pull/14761#pullrequestreview-504004535", "createdAt": "2020-10-07T15:28:03Z", "commit": {"oid": "958ff2da163fbe254b7baae7522c845ecfef38ad"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10f3a803e1985b7bc1c09323d8da50f3eb2bbfd1", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/10f3a803e1985b7bc1c09323d8da50f3eb2bbfd1", "committedDate": "2020-10-07T17:25:43Z", "message": "Avoid wait(0)"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2470, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}