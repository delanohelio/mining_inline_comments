{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgyNzc5Mzkw", "number": 14334, "title": "Arnej/get memory usage from tensors ", "bodyText": "I confirm that this contribution is made under the terms of the license found in the root directory of this repository's source tree and that I have the authority necessary to make this contribution on behalf of its copyright owner.\n@geirst please review\n@havardpe please take a look at stash changes\n@baldersheim FYI\n@toregge FYI", "createdAt": "2020-09-09T11:36:55Z", "url": "https://github.com/vespa-engine/vespa/pull/14334", "merged": true, "mergeCommit": {"oid": "3bb45e2409538bb94078e441ec533fd7718f4926"}, "closed": true, "closedAt": "2020-09-10T09:00:58Z", "author": {"login": "arnej27959"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHJsqXAH2gAyNDgyNzc5MzkwOmNkMGU1ZmFlNTE1NjI5NDM1NGFkNTg5YjAxNDg4NTMyNjZjNzk1MDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHcyT6AFqTQ4NTcxNjcyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cd0e5fae5156294354ad589b0148853266c79500", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/cd0e5fae5156294354ad589b0148853266c79500", "committedDate": "2020-09-09T10:32:38Z", "message": "add methods to extract memory usage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30777d5b3d2f6f0fe921341ba04c7f68650e68f2", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/30777d5b3d2f6f0fe921341ba04c7f68650e68f2", "committedDate": "2020-09-09T10:32:38Z", "message": "add get_memory_usage for Stash"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c66f7b74eb6c1fdd672f6ba8c83df78bc1dabf3", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/3c66f7b74eb6c1fdd672f6ba8c83df78bc1dabf3", "committedDate": "2020-09-09T10:32:38Z", "message": "add get_memory_usage for tensor::Tensor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "472e6794ce4c74431b387f9783ee17467ca86a2c", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/472e6794ce4c74431b387f9783ee17467ca86a2c", "committedDate": "2020-09-09T10:32:39Z", "message": "use MemoryUsage from Tensor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e2654ea61067b11381c74ed5cb8689c5f69e225", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/8e2654ea61067b11381c74ed5cb8689c5f69e225", "committedDate": "2020-09-09T10:32:39Z", "message": "remove count_memory_used from Tensor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66e2767c871ebdfae2fe4411e90662750ce19d58", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/66e2767c871ebdfae2fe4411e90662750ce19d58", "committedDate": "2020-09-09T10:32:39Z", "message": "account for accounting info"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae03fd6023ca84571d2bca610ad93e45511e75e2", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/ae03fd6023ca84571d2bca610ad93e45511e75e2", "committedDate": "2020-09-09T11:03:07Z", "message": "better accounting in SimpleTensor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0OTUxNjc1", "url": "https://github.com/vespa-engine/vespa/pull/14334#pullrequestreview-484951675", "createdAt": "2020-09-09T12:23:33Z", "commit": {"oid": "ae03fd6023ca84571d2bca610ad93e45511e75e2"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMjoyMzozM1rOHPEvGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMjoyMzozM1rOHPEvGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTU2ODI4MQ==", "bodyText": "Consider rename tensor_memory_used to e.g tensor_memory. Applies further down in file as well.", "url": "https://github.com/vespa-engine/vespa/pull/14334#discussion_r485568281", "createdAt": "2020-09-09T12:23:33Z", "author": {"login": "geirst"}, "path": "searchlib/src/tests/tensor/direct_tensor_store/direct_tensor_store_test.cpp", "diffHunk": "@@ -61,11 +61,12 @@ TEST_F(DirectTensorStoreTest, heap_allocated_memory_is_tracked)\n     store.store_tensor(make_tensor(5));\n     auto mem_1 = store.getMemoryUsage();\n     auto ref = store.store_tensor(make_tensor(10));\n-    size_t tensor_memory_used = store.get_tensor(ref)->count_memory_used();\n+    auto tensor_memory_used = store.get_tensor(ref)->get_memory_usage();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae03fd6023ca84571d2bca610ad93e45511e75e2"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MDY0Njc5", "url": "https://github.com/vespa-engine/vespa/pull/14334#pullrequestreview-485064679", "createdAt": "2020-09-09T14:24:25Z", "commit": {"oid": "ae03fd6023ca84571d2bca610ad93e45511e75e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "949c4c0cb61e234823e247c1efe5582ca50e7448", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/949c4c0cb61e234823e247c1efe5582ca50e7448", "committedDate": "2020-09-10T07:32:04Z", "message": "memory_used -> mem_usage to reflect semantic change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1NzE2NzIz", "url": "https://github.com/vespa-engine/vespa/pull/14334#pullrequestreview-485716723", "createdAt": "2020-09-10T08:47:00Z", "commit": {"oid": "949c4c0cb61e234823e247c1efe5582ca50e7448"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4320, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}