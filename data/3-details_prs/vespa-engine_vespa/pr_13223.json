{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NjM1MDQx", "number": 13223, "title": "Distribute application package to other config servers", "bodyText": "", "createdAt": "2020-05-12T10:31:38Z", "url": "https://github.com/vespa-engine/vespa/pull/13223", "merged": true, "mergeCommit": {"oid": "41d4cea790f4779b2b64565b98664c18a13032f1"}, "closed": true, "closedAt": "2020-05-13T04:57:17Z", "author": {"login": "hmusum"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgdR7IgH2gAyNDE2NjM1MDQxOjI2ZmE1MzBhZWRmZjI1NGRjODg3MWY3Mzk1YjU0YzhkMzQ4N2YzMzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgs7pfAFqTQxMDQ3OTUzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "26fa530aedff254dc8871f7395b54c8d3487f336", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/26fa530aedff254dc8871f7395b54c8d3487f336", "committedDate": "2020-05-12T05:18:29Z", "message": "Distribute application package to other config servers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca4bdfb245899ff05b92dea67e78e8388c781f53", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/ca4bdfb245899ff05b92dea67e78e8388c781f53", "committedDate": "2020-05-12T10:30:18Z", "message": "Add flag to decide whether to distribute application package"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNDc5NTMw", "url": "https://github.com/vespa-engine/vespa/pull/13223#pullrequestreview-410479530", "createdAt": "2020-05-12T22:56:43Z", "commit": {"oid": "26fa530aedff254dc8871f7395b54c8d3487f336"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMjo1Njo0M1rOGUby3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMzoyNTowNlrOGUcXgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA4MDA5NQ==", "bodyText": "Is it correct to distribute before preprocessing? It probably is if the preprocessing will be done on the other configservers if/when they deploy the package. I don't know this code well enough yet, so I may be asking stupid questions here.", "url": "https://github.com/vespa-engine/vespa/pull/13223#discussion_r424080095", "createdAt": "2020-05-12T22:56:43Z", "author": {"login": "gjoranv"}, "path": "configserver/src/main/java/com/yahoo/vespa/config/server/session/SessionPreparer.java", "diffHunk": "@@ -112,6 +116,7 @@ public ConfigChangeActions prepare(SessionContext context, DeployLogger logger,\n                                        Optional<ApplicationSet> currentActiveApplicationSet, Path tenantPath, \n                                        Instant now) {\n         Preparation preparation = new Preparation(context, logger, params, currentActiveApplicationSet, tenantPath);\n+        preparation.distributeApplicationPackage();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26fa530aedff254dc8871f7395b54c8d3487f336"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA4OTQ3Mw==", "bodyText": "What does the empty string mean?", "url": "https://github.com/vespa-engine/vespa/pull/13223#discussion_r424089473", "createdAt": "2020-05-12T23:25:06Z", "author": {"login": "gjoranv"}, "path": "configserver/src/main/java/com/yahoo/vespa/config/server/session/SessionPreparer.java", "diffHunk": "@@ -221,6 +223,16 @@ void checkTimeout(String step) {\n             }\n         }\n \n+        void distributeApplicationPackage() {\n+            FileRegistry fileRegistry = fileDistributionProvider.getFileRegistry();\n+            FileReference fileReference = fileRegistry.addFile(\"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26fa530aedff254dc8871f7395b54c8d3487f336"}, "originalPosition": 96}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3226, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}