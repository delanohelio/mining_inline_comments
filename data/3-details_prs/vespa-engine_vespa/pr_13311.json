{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwMzUzNTQw", "number": 13311, "title": "Gjoranv/create registry from config", "bodyText": "@bratseth, please review the new constructor code carefully.\nNext, we can have this injected to SearchHandler instead of creating a new registry there.", "createdAt": "2020-05-19T20:39:58Z", "url": "https://github.com/vespa-engine/vespa/pull/13311", "merged": true, "mergeCommit": {"oid": "7b9fd033c405fdbd1fdc11b0223382e11c3931d2"}, "closed": true, "closedAt": "2020-05-20T10:03:44Z", "author": {"login": "gjoranv"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABci5Q6RAH2gAyNDIwMzUzNTQwOmY2OWQ0MTdlY2UzZGUzOGViMzdjYWIyNDUyZTZlOGI5OTBmMmJiOGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjE8JggFqTQxNTExMjE1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f69d417ece3de38eb37cab2452e6e8b990f2bb8b", "author": {"user": {"login": "gjoranv", "name": null}}, "url": "https://github.com/vespa-engine/vespa/commit/f69d417ece3de38eb37cab2452e6e8b990f2bb8b", "committedDate": "2020-05-19T19:02:34Z", "message": "Allow creating a CompiledQueryProfileRegistry from config."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bddef12ac48d0a57a3d7a51ba68f33a5883b9fe", "author": {"user": {"login": "gjoranv", "name": null}}, "url": "https://github.com/vespa-engine/vespa/commit/2bddef12ac48d0a57a3d7a51ba68f33a5883b9fe", "committedDate": "2020-05-19T20:35:20Z", "message": "Add CompiledQueryProfileRegistry component for injection."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d941547df66cdd4f52dad9e1f979ecb58e00c19", "author": {"user": {"login": "gjoranv", "name": null}}, "url": "https://github.com/vespa-engine/vespa/commit/2d941547df66cdd4f52dad9e1f979ecb58e00c19", "committedDate": "2020-05-19T20:42:09Z", "message": "Follow naming convention by using singular 'profileRegistry'"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0ODE2MzAw", "url": "https://github.com/vespa-engine/vespa/pull/13311#pullrequestreview-414816300", "createdAt": "2020-05-19T20:55:42Z", "commit": {"oid": "2d941547df66cdd4f52dad9e1f979ecb58e00c19"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0ODE2NTcx", "url": "https://github.com/vespa-engine/vespa/pull/13311#pullrequestreview-414816571", "createdAt": "2020-05-19T20:56:07Z", "commit": {"oid": "2d941547df66cdd4f52dad9e1f979ecb58e00c19"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31564ae8cce4125cb35990ec00fdb10206862cb2", "author": {"user": {"login": "gjoranv", "name": null}}, "url": "https://github.com/vespa-engine/vespa/commit/31564ae8cce4125cb35990ec00fdb10206862cb2", "committedDate": "2020-05-19T22:35:24Z", "message": "Make the main constructor take a CompiledQueryProfileRegistry\n\n.. instead of QueryProfilesConfig"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98bb2cb3bc92011776cf7ff285649aa565258c2a", "author": {"user": {"login": "gjoranv", "name": null}}, "url": "https://github.com/vespa-engine/vespa/commit/98bb2cb3bc92011776cf7ff285649aa565258c2a", "committedDate": "2020-05-19T23:23:33Z", "message": "Add the query profile registry to the set of test components\n\n.. for all integration style tests.\n\nNote that these tests were written before the DI framework, and\ntypically used the former 'handlers' config as only handlers\nand searchers could be configured at the time."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MDU3ODQx", "url": "https://github.com/vespa-engine/vespa/pull/13311#pullrequestreview-415057841", "createdAt": "2020-05-20T07:23:41Z", "commit": {"oid": "98bb2cb3bc92011776cf7ff285649aa565258c2a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTEyMTUy", "url": "https://github.com/vespa-engine/vespa/pull/13311#pullrequestreview-415112152", "createdAt": "2020-05-20T08:37:05Z", "commit": {"oid": "98bb2cb3bc92011776cf7ff285649aa565258c2a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwODozNzowNVrOGYBFlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwODozNzowNVrOGYBFlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzgzNjgyMQ==", "bodyText": "Why not just do\nQueryProfileCompiler.compile(registry)\nhere?", "url": "https://github.com/vespa-engine/vespa/pull/13311#discussion_r427836821", "createdAt": "2020-05-20T08:37:05Z", "author": {"login": "bratseth"}, "path": "container-search/src/main/java/com/yahoo/search/query/profile/compiled/CompiledQueryProfileRegistry.java", "diffHunk": "@@ -18,6 +23,15 @@\n     \n     private final QueryProfileTypeRegistry typeRegistry;\n \n+    @Inject\n+    public CompiledQueryProfileRegistry(QueryProfilesConfig config) {\n+        QueryProfileRegistry registry = QueryProfileConfigurer.createFromConfig(config);\n+        typeRegistry = registry.getTypeRegistry();\n+        for (QueryProfile inputProfile : registry.allComponents()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98bb2cb3bc92011776cf7ff285649aa565258c2a"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3156, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}