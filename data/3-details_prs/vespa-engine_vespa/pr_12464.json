{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0MzE4NDcw", "number": 12464, "title": "Balder/optimize bool executors rebased", "bodyText": "@havardpe PR\nOnly the  3 last PR's are new compared to #12322\nBest viewed individually I think (the last 3)", "createdAt": "2020-03-05T14:47:50Z", "url": "https://github.com/vespa-engine/vespa/pull/12464", "merged": true, "mergeCommit": {"oid": "b430a5c47af70c06e4374be2de8d69ab1c34492f"}, "closed": true, "closedAt": "2020-03-09T14:23:19Z", "author": {"login": "baldersheim"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKrMnEgH2gAyMzg0MzE4NDcwOjMxYTA1M2E3NGQyYjQ4MWM0NzcwY2NlMTE2ODY4MWU4YTcxYWFlM2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcL-sUJAH2gAyMzg0MzE4NDcwOjlmY2UxYzgyYWQxOWU1ZDk2YmVjOGUyMTUzODFlM2ZiNzM5ZTNiZjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "31a053a74d2b481c4770cce1168681e8a71aae3a", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/31a053a74d2b481c4770cce1168681e8a71aae3a", "committedDate": "2020-03-05T13:05:01Z", "message": "Optimize for bool attributes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f21bf723e19b774f7b8f07564e3672d21b0c431d", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/f21bf723e19b774f7b8f07564e3672d21b0c431d", "committedDate": "2020-03-05T13:05:01Z", "message": "Use number of outputs as sanity check when createing bool executor.\nUse a function for makeing purpose clear."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f9ebe010b78feb15b8866b27db615ef9281ee99", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/3f9ebe010b78feb15b8866b27db615ef9281ee99", "committedDate": "2020-03-05T13:05:01Z", "message": "Restructure and do sanity checking against num outputs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79eb4da646da25b9734a1ae8eb1222d44cc85061", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/79eb4da646da25b9734a1ae8eb1222d44cc85061", "committedDate": "2020-03-05T13:05:02Z", "message": "Restructure also for multivalue to reduce the number of dynamic cast."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea7621f3a4b46ff504bd9d24ee345e51046e5d39", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/ea7621f3a4b46ff504bd9d24ee345e51046e5d39", "committedDate": "2020-03-05T14:18:42Z", "message": "std::make_shared"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "533444f70616aa4c02d4bf7fa97e2b531acdb6d4", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/533444f70616aa4c02d4bf7fa97e2b531acdb6d4", "committedDate": "2020-03-05T14:20:30Z", "message": "After going though code I conclude that we can assert our assuptions here."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5a0a4fa7f5c48ca650579d79f1a459bc1d9828f", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/d5a0a4fa7f5c48ca650579d79f1a459bc1d9828f", "committedDate": "2020-03-05T14:44:42Z", "message": "Test must specify field type."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMjA5ODkz", "url": "https://github.com/vespa-engine/vespa/pull/12464#pullrequestreview-370209893", "createdAt": "2020-03-06T10:07:45Z", "commit": {"oid": "d5a0a4fa7f5c48ca650579d79f1a459bc1d9828f"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMDowNzo0NVrOFyzcrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMDoxMzoyNFrOFyzn1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODgxNjA0Ng==", "bodyText": "in the future: maybe we need to enforce passing the data type", "url": "https://github.com/vespa-engine/vespa/pull/12464#discussion_r388816046", "createdAt": "2020-03-06T10:07:45Z", "author": {"login": "havardpe"}, "path": "searchlib/src/tests/features/prod_features.cpp", "diffHunk": "@@ -410,8 +411,8 @@ Test::setupForAttributeTest(FtFeatureTest &ft, bool setup_env)\n             .addField(FieldType::ATTRIBUTE, CollectionType::SINGLE, \"slong\")\n             .addField(FieldType::ATTRIBUTE, CollectionType::SINGLE, \"sdouble\")\n             .addField(FieldType::ATTRIBUTE, CollectionType::SINGLE, \"sbyte\")\n-            .addField(FieldType::ATTRIBUTE, CollectionType::SINGLE, \"sbool\")\n-            .addField(FieldType::ATTRIBUTE, CollectionType::SINGLE, \"sebool\");\n+            .addField(FieldType::ATTRIBUTE, CollectionType::SINGLE, DataType::BOOL,\"sbool\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5a0a4fa7f5c48ca650579d79f1a459bc1d9828f"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODgxODA0Mg==", "bodyText": "should remove attr variable as well", "url": "https://github.com/vespa-engine/vespa/pull/12464#discussion_r388818042", "createdAt": "2020-03-06T10:11:46Z", "author": {"login": "havardpe"}, "path": "streamingvisitors/src/vespa/searchvisitor/searchvisitor.cpp", "diffHunk": "@@ -99,11 +99,11 @@ createAttribute(const vespalib::string & name, const document::FieldValue & fv)\n     AttributeVector::SP attr;\n \n     if (fv.inherits(document::ByteFieldValue::classId) || fv.inherits(document::IntFieldValue::classId) || fv.inherits(document::LongFieldValue::classId)) {\n-        attr.reset(new search::SingleIntegerExtAttribute(name));\n+        return std::make_shared<search::SingleIntegerExtAttribute>(name);\n     } else if (fv.inherits(document::DoubleFieldValue::classId) || fv.inherits(document::FloatFieldValue::classId)) {\n-        attr.reset(new search::SingleFloatExtAttribute(name));\n+        return std::make_shared<search::SingleFloatExtAttribute>(name);\n     } else if (fv.inherits(document::StringFieldValue::classId)) {\n-        attr.reset(new search::SingleStringExtAttribute(name));\n+        return std::make_shared<search::SingleStringExtAttribute>(name);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5a0a4fa7f5c48ca650579d79f1a459bc1d9828f"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODgxODkwMg==", "bodyText": "could just construct len directly from valueRef.size() instead of using a temporary", "url": "https://github.com/vespa-engine/vespa/pull/12464#discussion_r388818902", "createdAt": "2020-03-06T10:13:24Z", "author": {"login": "havardpe"}, "path": "streamingvisitors/src/vespa/searchvisitor/searchvisitor.cpp", "diffHunk": "@@ -240,9 +240,9 @@ void SearchVisitor::init(const Parameters & params)\n         LOG(debug, \"QFLAG_DUMP_FEATURES: %s\", _rankController.getDumpFeatures() ? \"true\" : \"false\");\n     }\n \n-    if (params.lookup(\"rankproperties\", valueRef) && valueRef.size() > 0) {\n+    if (params.lookup(\"rankproperties\", valueRef) && ! valueRef.empty()) {\n         LOG(spam, \"Received rank properties of %zd bytes\", valueRef.size());\n-        uint32_t len = static_cast<uint32_t>(valueRef.size());\n+        uint32_t len = uint32_t(valueRef.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5a0a4fa7f5c48ca650579d79f1a459bc1d9828f"}, "originalPosition": 59}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62a75e6a91a54e351a9f46af353598a2b68a06a5", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/62a75e6a91a54e351a9f46af353598a2b68a06a5", "committedDate": "2020-03-09T14:20:42Z", "message": "Use std::make_shared and remove cast not needed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fce1c82ad19e5d96bec8e215381e3fb739e3bf7", "author": {"user": {"login": "baldersheim", "name": "Henning Baldersheim"}}, "url": "https://github.com/vespa-engine/vespa/commit/9fce1c82ad19e5d96bec8e215381e3fb739e3bf7", "committedDate": "2020-03-09T14:21:46Z", "message": "Fix syntax errors."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2766, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}