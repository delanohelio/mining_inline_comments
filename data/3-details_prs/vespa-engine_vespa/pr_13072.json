{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5MTQ2MTAx", "number": 13072, "title": "Use fewer threads to get next generation of config", "bodyText": "Check for next config generation in one thread.\nSimplify Subscriber.\nUse a ConcurrentHashMap for active subscribers.\nReduces the number of threads used by config proxy from ~230 to ~30\nHad to reduce interval between nextGeneration calls down to 10 milliseconds to avoid slowdown getting config when running a system test\nPlease review only, will merge later.", "createdAt": "2020-04-26T19:46:08Z", "url": "https://github.com/vespa-engine/vespa/pull/13072", "merged": true, "mergeCommit": {"oid": "e4ec145b7597adec17295beea741b9f9f800dec5"}, "closed": true, "closedAt": "2020-04-27T04:50:39Z", "author": {"login": "hmusum"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbgD7AgH2gAyNDA5MTQ2MTAxOmM2ZjRjM2M1OGU4NWIwNTljYWViMzNiNjY1NGU3MTM5Nzc0MDhiM2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcbgq__AFqTQwMDU0NTY0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c6f4c3c58e85b059caeb33b6654e713977408b3d", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/c6f4c3c58e85b059caeb33b6654e713977408b3d", "committedDate": "2020-04-26T19:43:17Z", "message": "Use fewer threads to get next generation of config\n\nCheck for next config generation in one thread.\nSimplify Subscriber.\nUse a ConcurrentHashMap for active subscribers.\nReduces the number of threads used by config proxy from ~230 to ~30"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNTQ1NTMz", "url": "https://github.com/vespa-engine/vespa/pull/13072#pullrequestreview-400545533", "createdAt": "2020-04-26T20:24:57Z", "commit": {"oid": "c6f4c3c58e85b059caeb33b6654e713977408b3d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMDoyNDo1N1rOGMJl5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMDoyNDo1N1rOGMJl5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM5MzI1Mg==", "bodyText": "Every 10ms sounds like it is often enough :)", "url": "https://github.com/vespa-engine/vespa/pull/13072#discussion_r415393252", "createdAt": "2020-04-26T20:24:57Z", "author": {"login": "baldersheim"}, "path": "config-proxy/src/main/java/com/yahoo/vespa/config/proxy/RpcConfigSourceClient.java", "diffHunk": "@@ -69,14 +74,10 @@\n         this.memoryCache = memoryCache;\n         this.delayedResponses = new DelayedResponses();\n         checkConfigSources();\n-        exec = Executors.newCachedThreadPool(new DaemonThreadFactory(\"subscriber-\"));\n+        nextConfigFuture = nextConfigScheduler.scheduleAtFixedRate(this, 0, 10, MILLISECONDS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6f4c3c58e85b059caeb33b6654e713977408b3d"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNTQ1NjQz", "url": "https://github.com/vespa-engine/vespa/pull/13072#pullrequestreview-400545643", "createdAt": "2020-04-26T20:25:59Z", "commit": {"oid": "c6f4c3c58e85b059caeb33b6654e713977408b3d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3263, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}