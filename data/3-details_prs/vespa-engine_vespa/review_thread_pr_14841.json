{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMjMzNzUw", "number": 14841, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwODoyNjo0N1rOEtX3iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwODoyOTowMVrOEtX7IA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2MDEyNDI1OnYy", "diffSide": "RIGHT", "path": "vespaclient-container-plugin/src/main/java/com/yahoo/document/restapi/resource/DocumentV1ApiHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwODoyNjo0N1rOHhH43Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwODoyNjo0N1rOHhH43Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ5NDMwMQ==", "bodyText": "enqueued might be positive even when the actual queue is empty (when multiple threads executes enqueueAndDispatch simultaneously.", "url": "https://github.com/vespa-engine/vespa/pull/14841#discussion_r504494301", "createdAt": "2020-10-14T08:26:47Z", "author": {"login": "bjorncs"}, "path": "vespaclient-container-plugin/src/main/java/com/yahoo/document/restapi/resource/DocumentV1ApiHandler.java", "diffHunk": "@@ -406,18 +409,14 @@ private void enqueueAndDispatch(HttpRequest request, ResponseHandler handler, Su\n             return;\n         }\n         Operation operation = Operation.lazilyParsed(request, handler, operationParser);\n-        if (enqueued.get() == 0 && operation.dispatch()) // Bypass queue if it is empty.\n+        if (enqueued.get() == 1 && operation.dispatch()) // Bypass queue if it is empty.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53e68ede523a33a6f7e87f991ee7c392ee3a088e"}, "originalPosition": 109}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2MDEzMzQ0OnYy", "diffSide": "RIGHT", "path": "vespaclient-container-plugin/src/main/resources/configdefinitions/document-operation-executor.def", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwODoyOTowMVrOHhH-uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQwODozNjozMlrOHhISHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ5NTgwMw==", "bodyText": "We will probably want to control resender threads from ContainerThreadpool later on.", "url": "https://github.com/vespa-engine/vespa/pull/14841#discussion_r504495803", "createdAt": "2020-10-14T08:29:01Z", "author": {"login": "bjorncs"}, "path": "vespaclient-container-plugin/src/main/resources/configdefinitions/document-operation-executor.def", "diffHunk": "@@ -1,15 +1,15 @@\n # Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n package=com.yahoo.document.restapi\n \n-# Delay before a throttled operation is retried.\n-resendDelayMillis     int default=100\n-\n-# Time between a document operation is received and a timeout response is sent\n-defaultTimeoutSeconds int default=180\n-\n-# Time after which a visitor session times out\n-visitTimeoutSeconds   int default=120\n+# Duration for which resender thread sleeps after an operation is throttled\n+resendDelayMillis     int default=10\n \n # Bound on number of document operations to keep in retry queue \u2014\u00a0further operations are rejected\n maxThrottled          int default=1000\n \n+# Whether to perform dispatch from Jetty threads\n+doDispatchWithEnqueue bool default=true\n+\n+# Number of workers in the resender thread pool\n+resenderCount         int default=1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53e68ede523a33a6f7e87f991ee7c392ee3a088e"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDUwMDc2Ng==", "bodyText": "Yes, this isn't even used now >_< Let's clean up when we decide on how we do it.", "url": "https://github.com/vespa-engine/vespa/pull/14841#discussion_r504500766", "createdAt": "2020-10-14T08:36:32Z", "author": {"login": "jonmv"}, "path": "vespaclient-container-plugin/src/main/resources/configdefinitions/document-operation-executor.def", "diffHunk": "@@ -1,15 +1,15 @@\n # Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n package=com.yahoo.document.restapi\n \n-# Delay before a throttled operation is retried.\n-resendDelayMillis     int default=100\n-\n-# Time between a document operation is received and a timeout response is sent\n-defaultTimeoutSeconds int default=180\n-\n-# Time after which a visitor session times out\n-visitTimeoutSeconds   int default=120\n+# Duration for which resender thread sleeps after an operation is throttled\n+resendDelayMillis     int default=10\n \n # Bound on number of document operations to keep in retry queue \u2014\u00a0further operations are rejected\n maxThrottled          int default=1000\n \n+# Whether to perform dispatch from Jetty threads\n+doDispatchWithEnqueue bool default=true\n+\n+# Number of workers in the resender thread pool\n+resenderCount         int default=1", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ5NTgwMw=="}, "originalCommit": {"oid": "53e68ede523a33a6f7e87f991ee7c392ee3a088e"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1146, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}