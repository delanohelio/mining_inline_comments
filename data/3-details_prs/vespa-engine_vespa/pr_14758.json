{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5MjU5OTc0", "number": 14758, "title": "fast value to enable inlined sparse operations", "bodyText": "use full overlap sparse join as initial test of full inlining.\nalso improve simple sparse map performance by pre-calculating string\nhashes and using hash values for equality checks.\nI confirm that this contribution is made under the terms of the license found in the root directory of this repository's source tree and that I have the authority necessary to make this contribution on behalf of its copyright owner.\n@arnej27959 please review\n@geirst FYI\nNB: I think we want to fork the SimpleValue and FastValue implementations and use a string-based std::map for the simple one, and rename SimpleSparseMap to FastSparseMap. I will do that as a follow-up.", "createdAt": "2020-10-07T13:41:02Z", "url": "https://github.com/vespa-engine/vespa/pull/14758", "merged": true, "mergeCommit": {"oid": "15aca50e687167c0094183e547e549a78cb4bebd"}, "closed": true, "closedAt": "2020-10-08T08:51:52Z", "author": {"login": "havardpe"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQNDpDAH2gAyNDk5MjU5OTc0OjA0MjJiZDE0ZGQwZmZiNGQxYTQ2YWI1ZDQyNTRlNzdjNGZiMGY3YjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQcjuNgFqTUwNDQ5NTM3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0422bd14dd0ffb4d1a46ab5d4254e77c4fb0f7b0", "author": {"user": {"login": "havardpe", "name": "H\u00e5vard Pettersen"}}, "url": "https://github.com/vespa-engine/vespa/commit/0422bd14dd0ffb4d1a46ab5d4254e77c4fb0f7b0", "committedDate": "2020-10-07T13:32:46Z", "message": "fast value to enable inlined sparse operations\n\nuse full overlap sparse join as initial test of full inlining.\n\nalso improve simple sparse map performance by pre-calculating string\nhashes and using hash values for equality checks."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDk1Mzc1", "url": "https://github.com/vespa-engine/vespa/pull/14758#pullrequestreview-504495375", "createdAt": "2020-10-08T07:25:56Z", "commit": {"oid": "0422bd14dd0ffb4d1a46ab5d4254e77c4fb0f7b0"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNzoyNTo1NlrOHeRSHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwNzoyNTo1NlrOHeRSHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTUwMjQ5NQ==", "bodyText": "dumping to stderr should be temporary", "url": "https://github.com/vespa-engine/vespa/pull/14758#discussion_r501502495", "createdAt": "2020-10-08T07:25:56Z", "author": {"login": "arnej27959"}, "path": "eval/src/tests/eval/simple_sparse_map/simple_sparse_map_test.cpp", "diffHunk": "@@ -55,10 +55,12 @@ TEST(SimpleSparseMapTest, simple_sparse_map_basic_usage_works) {\n     EXPECT_EQ(map.lookup(a4.direct_ref()), map.npos());\n     EXPECT_EQ(map.lookup(a4.indirect_ref()), map.npos());\n     EXPECT_EQ(SimpleSparseMap::npos(), map.npos());\n-    SL expect_labels({\"a\",\"a\",\"a\",\n-                      \"a\",\"a\",\"b\",\n-                      \"a\",\"b\",\"a\"});\n-    EXPECT_EQ(map.labels(), expect_labels.direct_str());\n+    EXPECT_EQ(map.labels().size(), 9);\n+    auto dump = [&](auto addr_tag, auto subspace, auto hash) {\n+        auto addr = map.make_addr(addr_tag);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0422bd14dd0ffb4d1a46ab5d4254e77c4fb0f7b0"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2468, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}