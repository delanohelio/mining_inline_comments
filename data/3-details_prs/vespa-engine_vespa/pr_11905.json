{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2MzMyMTU3", "number": 11905, "title": "Propagate reservedTo", "bodyText": "", "createdAt": "2020-01-23T12:15:35Z", "url": "https://github.com/vespa-engine/vespa/pull/11905", "merged": true, "mergeCommit": {"oid": "5f8646439e24c83a0cb29f0b80173fa97344c704"}, "closed": true, "closedAt": "2020-01-23T13:21:18Z", "author": {"login": "bratseth"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9JR7LAH2gAyMzY2MzMyMTU3OjFjY2M5MTVjNTgxOTZhNWRmZjAxMTU3NzgxYWNlMWFhYzQxN2JhNjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9Jx-7gH2gAyMzY2MzMyMTU3OjIxZGFmNDYxY2M2ZDc4YWY2ZTE0NDI3NzVhMzFlZmE5MTUzMmJjYzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1ccc915c58196a5dff01157781ace1aac417ba66", "author": {"user": {"login": "vespa-headless", "name": null}}, "url": "https://github.com/vespa-engine/vespa/commit/1ccc915c58196a5dff01157781ace1aac417ba66", "committedDate": "2020-01-23T12:13:02Z", "message": "Propagate reservedTo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MjU2ODA1", "url": "https://github.com/vespa-engine/vespa/pull/11905#pullrequestreview-347256805", "createdAt": "2020-01-23T12:24:08Z", "commit": {"oid": "1ccc915c58196a5dff01157781ace1aac417ba66"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMjoyNDowOFrOFg8WVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxMjoyNTozMVrOFg8Yfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDA4NzUxMQ==", "bodyText": "This is exclusively for adding config-server/controllers...", "url": "https://github.com/vespa-engine/vespa/pull/11905#discussion_r370087511", "createdAt": "2020-01-23T12:24:08Z", "author": {"login": "freva"}, "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/configserver/noderepository/AddNode.java", "diffHunk": "@@ -19,26 +20,30 @@\n     public final Optional<String> nodeFlavor;\n     public final Optional<FlavorOverrides> flavorOverrides;\n     public final Optional<NodeResources> nodeResources;\n+    public final Optional<TenantName> reservedTo;\n     public final NodeType nodeType;\n     public final Set<String> ipAddresses;\n     public final Set<String> additionalIpAddresses;\n \n-    public static AddNode forHost(String hostname, String nodeFlavor, Optional<FlavorOverrides> flavorOverrides, NodeType nodeType, Set<String> ipAddresses, Set<String> additionalIpAddresses) {\n-        return new AddNode(hostname, Optional.empty(), Optional.of(nodeFlavor), flavorOverrides, Optional.empty(), nodeType, ipAddresses, additionalIpAddresses);\n+    public static AddNode forHost(String hostname, String nodeFlavor, Optional<FlavorOverrides> flavorOverrides, Optional<TenantName> reservedTo, NodeType nodeType, Set<String> ipAddresses, Set<String> additionalIpAddresses) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ccc915c58196a5dff01157781ace1aac417ba66"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDA4ODA2Mg==", "bodyText": "This is will only ever return allocated tenant nodes...", "url": "https://github.com/vespa-engine/vespa/pull/11905#discussion_r370088062", "createdAt": "2020-01-23T12:25:31Z", "author": {"login": "freva"}, "path": "controller-server/src/main/java/com/yahoo/vespa/hosted/controller/restapi/application/ApplicationApiHandler.java", "diffHunk": "@@ -600,6 +600,7 @@ private HttpResponse nodes(String tenantName, String applicationName, String ins\n             Cursor nodeObject = nodesArray.addObject();\n             nodeObject.setString(\"hostname\", node.hostname().value());\n             nodeObject.setString(\"state\", valueOf(node.state()));\n+            node.reservedTo().ifPresent(tenant -> nodeObject.setString(\"reservedTo\", tenant.value()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ccc915c58196a5dff01157781ace1aac417ba66"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21daf461cc6d78af6e1442775a31efa91532bcc9", "author": {"user": {"login": "vespa-headless", "name": null}}, "url": "https://github.com/vespa-engine/vespa/commit/21daf461cc6d78af6e1442775a31efa91532bcc9", "committedDate": "2020-01-23T12:48:03Z", "message": "empty, not null"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3981, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}