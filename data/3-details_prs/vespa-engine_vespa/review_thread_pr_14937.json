{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1NDU5ODI3", "number": 14937, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMDo1MDozOVrOEvQYlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozNDoyOFrOEvRThA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTg2OTY3OnYy", "diffSide": "RIGHT", "path": "storage/src/vespa/storage/persistence/persistenceutil.cpp", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMDo1MDozOVrOHkInXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozNzo0N1rOHkKJag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1MTkzMg==", "bodyText": "It's a bit philosophically questionable to have this const when it mutates state transitively, but I digress \ud83d\ude09", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507651932", "createdAt": "2020-10-19T10:50:39Z", "author": {"login": "vekterli"}, "path": "storage/src/vespa/storage/persistence/persistenceutil.cpp", "diffHunk": "@@ -157,26 +155,23 @@ MessageTracker::generateReply(api::StorageCommand& cmd)\n }\n \n PersistenceUtil::PersistenceUtil(\n-        const config::ConfigUri & configUri,\n         ServiceLayerComponent& component,\n         FileStorHandler& fileStorHandler,\n         FileStorThreadMetrics& metrics,\n         spi::PersistenceProvider& provider)\n-    : _config(*config::ConfigGetter<vespa::config::content::StorFilestorConfig>::getConfig(configUri.getConfigId(), configUri.getContext())),\n-      _component(component),\n+    : _component(component),\n       _fileStorHandler(fileStorHandler),\n       _nodeIndex(component.getIndex()),\n       _metrics(metrics),\n       _bucketFactory(component.getBucketIdFactory()),\n-      _repo(component.getTypeRepo()->documentTypeRepo),\n       _spi(provider)\n {\n }\n \n PersistenceUtil::~PersistenceUtil() = default;\n \n void\n-PersistenceUtil::updateBucketDatabase(const document::Bucket &bucket, const api::BucketInfo& i)\n+PersistenceUtil::updateBucketDatabase(const document::Bucket &bucket, const api::BucketInfo& i) const", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6a8e2c087d25335784c05a8d01e1c1b665d3b3d"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3NzAzNA==", "bodyText": ":)", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507677034", "createdAt": "2020-10-19T11:37:47Z", "author": {"login": "baldersheim"}, "path": "storage/src/vespa/storage/persistence/persistenceutil.cpp", "diffHunk": "@@ -157,26 +155,23 @@ MessageTracker::generateReply(api::StorageCommand& cmd)\n }\n \n PersistenceUtil::PersistenceUtil(\n-        const config::ConfigUri & configUri,\n         ServiceLayerComponent& component,\n         FileStorHandler& fileStorHandler,\n         FileStorThreadMetrics& metrics,\n         spi::PersistenceProvider& provider)\n-    : _config(*config::ConfigGetter<vespa::config::content::StorFilestorConfig>::getConfig(configUri.getConfigId(), configUri.getContext())),\n-      _component(component),\n+    : _component(component),\n       _fileStorHandler(fileStorHandler),\n       _nodeIndex(component.getIndex()),\n       _metrics(metrics),\n       _bucketFactory(component.getBucketIdFactory()),\n-      _repo(component.getTypeRepo()->documentTypeRepo),\n       _spi(provider)\n {\n }\n \n PersistenceUtil::~PersistenceUtil() = default;\n \n void\n-PersistenceUtil::updateBucketDatabase(const document::Bucket &bucket, const api::BucketInfo& i)\n+PersistenceUtil::updateBucketDatabase(const document::Bucket &bucket, const api::BucketInfo& i) const", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1MTkzMg=="}, "originalCommit": {"oid": "e6a8e2c087d25335784c05a8d01e1c1b665d3b3d"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTg4MzM1OnYy", "diffSide": "RIGHT", "path": "storage/src/vespa/storage/persistence/simplemessagehandler.h", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMDo1NDozMFrOHkIvsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozODowMVrOHkKJ2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1NDA2NQ==", "bodyText": "A class comment would be nice, especially for what \"simple\" means in this context", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507654065", "createdAt": "2020-10-19T10:54:30Z", "author": {"login": "vekterli"}, "path": "storage/src/vespa/storage/persistence/simplemessagehandler.h", "diffHunk": "@@ -0,0 +1,33 @@\n+// Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+#pragma once\n+\n+#include \"types.h\"\n+#include \"messages.h\"\n+#include <vespa/storage/common/bucketmessages.h>\n+#include <vespa/storageapi/message/persistence.h>\n+\n+namespace storage {\n+\n+namespace spi { struct PersistenceProvider; }\n+struct PersistenceUtil;\n+\n+class SimpleMessageHandler : public Types {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6a8e2c087d25335784c05a8d01e1c1b665d3b3d"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3NzE0NQ==", "bodyText": "Fixed", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507677145", "createdAt": "2020-10-19T11:38:01Z", "author": {"login": "baldersheim"}, "path": "storage/src/vespa/storage/persistence/simplemessagehandler.h", "diffHunk": "@@ -0,0 +1,33 @@\n+// Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+#pragma once\n+\n+#include \"types.h\"\n+#include \"messages.h\"\n+#include <vespa/storage/common/bucketmessages.h>\n+#include <vespa/storageapi/message/persistence.h>\n+\n+namespace storage {\n+\n+namespace spi { struct PersistenceProvider; }\n+struct PersistenceUtil;\n+\n+class SimpleMessageHandler : public Types {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1NDA2NQ=="}, "originalCommit": {"oid": "e6a8e2c087d25335784c05a8d01e1c1b665d3b3d"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTkyMDQzOnYy", "diffSide": "RIGHT", "path": "storage/src/vespa/storage/persistence/testandsethelper.cpp", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTowNToxMlrOHkJGRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozODowOVrOHkKKIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1OTg0NA==", "bodyText": "Nit: missing space before context", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507659844", "createdAt": "2020-10-19T11:05:12Z", "author": {"login": "vekterli"}, "path": "storage/src/vespa/storage/persistence/testandsethelper.cpp", "diffHunk": "@@ -35,7 +35,7 @@ void TestAndSetHelper::parseDocumentSelection(const document::DocumentTypeRepo &\n }\n \n spi::GetResult TestAndSetHelper::retrieveDocument(const document::FieldSet & fieldSet, spi::Context & context) {\n-    return _spi.get(_env.getBucket(_docId, _cmd.getBucket()), fieldSet,_cmd.getDocumentId(),context);\n+    return _spi.get(_env.getBucket(_docId, _cmd.getBucket()), fieldSet, _cmd.getDocumentId(),context);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6a8e2c087d25335784c05a8d01e1c1b665d3b3d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3NzIxOQ==", "bodyText": "Fixed", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507677219", "createdAt": "2020-10-19T11:38:09Z", "author": {"login": "baldersheim"}, "path": "storage/src/vespa/storage/persistence/testandsethelper.cpp", "diffHunk": "@@ -35,7 +35,7 @@ void TestAndSetHelper::parseDocumentSelection(const document::DocumentTypeRepo &\n }\n \n spi::GetResult TestAndSetHelper::retrieveDocument(const document::FieldSet & fieldSet, spi::Context & context) {\n-    return _spi.get(_env.getBucket(_docId, _cmd.getBucket()), fieldSet,_cmd.getDocumentId(),context);\n+    return _spi.get(_env.getBucket(_docId, _cmd.getBucket()), fieldSet, _cmd.getDocumentId(),context);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY1OTg0NA=="}, "originalCommit": {"oid": "e6a8e2c087d25335784c05a8d01e1c1b665d3b3d"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTk1NDQ4OnYy", "diffSide": "RIGHT", "path": "storage/src/vespa/storage/persistence/asynchandler.h", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMToxNToxMFrOHkJa7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozOTowNVrOHkKMFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY2NTEzMw==", "bodyText": "Nitpick: Missing '.' at the end. On the next sentence as well.", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507665133", "createdAt": "2020-10-19T11:15:10Z", "author": {"login": "geirst"}, "path": "storage/src/vespa/storage/persistence/asynchandler.h", "diffHunk": "@@ -13,8 +13,11 @@ namespace spi {\n }\n struct PersistenceUtil;\n \n+/**\n+ * Handle async operations that uses a sequenced executor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f34acff8f2f40938d97b5b20ed960101d6622eff"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3NzcxNg==", "bodyText": "Fixed", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507677716", "createdAt": "2020-10-19T11:39:05Z", "author": {"login": "baldersheim"}, "path": "storage/src/vespa/storage/persistence/asynchandler.h", "diffHunk": "@@ -13,8 +13,11 @@ namespace spi {\n }\n struct PersistenceUtil;\n \n+/**\n+ * Handle async operations that uses a sequenced executor", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY2NTEzMw=="}, "originalCommit": {"oid": "f34acff8f2f40938d97b5b20ed960101d6622eff"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTk2NTY1OnYy", "diffSide": "RIGHT", "path": "storage/src/vespa/storage/persistence/splitjoinhandler.h", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMToxODoyNlrOHkJhcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTo0MDowOFrOHkKOGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY2NjgwMg==", "bodyText": "There is something wrong with this sentence.\nNitpick: Missing '.' at the end. On the next sentence as well.", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507666802", "createdAt": "2020-10-19T11:18:26Z", "author": {"login": "geirst"}, "path": "storage/src/vespa/storage/persistence/splitjoinhandler.h", "diffHunk": "@@ -0,0 +1,32 @@\n+// Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+#pragma once\n+\n+#include \"types.h\"\n+#include <vespa/storageapi/message/bucketsplitting.h>\n+\n+namespace storage {\n+\n+namespace spi { struct PersistenceProvider; }\n+struct PersistenceUtil;\n+class BucketOwnershipNotifier;\n+class RecheckBucketInfoCommand;\n+\n+/**\n+ * Handle operations that uses changes bucket ownership operations", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f34acff8f2f40938d97b5b20ed960101d6622eff"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3ODIzNA==", "bodyText": "Fixed", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507678234", "createdAt": "2020-10-19T11:40:08Z", "author": {"login": "baldersheim"}, "path": "storage/src/vespa/storage/persistence/splitjoinhandler.h", "diffHunk": "@@ -0,0 +1,32 @@\n+// Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+#pragma once\n+\n+#include \"types.h\"\n+#include <vespa/storageapi/message/bucketsplitting.h>\n+\n+namespace storage {\n+\n+namespace spi { struct PersistenceProvider; }\n+struct PersistenceUtil;\n+class BucketOwnershipNotifier;\n+class RecheckBucketInfoCommand;\n+\n+/**\n+ * Handle operations that uses changes bucket ownership operations", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY2NjgwMg=="}, "originalCommit": {"oid": "f34acff8f2f40938d97b5b20ed960101d6622eff"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTk5NzAzOnYy", "diffSide": "RIGHT", "path": "storage/src/vespa/storage/persistence/mergehandler.cpp", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMToyNzo0NlrOHkJ0eA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTo0MToyNFrOHkKQ1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3MTY3Mg==", "bodyText": "Consider using const auto.", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507671672", "createdAt": "2020-10-19T11:27:46Z", "author": {"login": "geirst"}, "path": "storage/src/vespa/storage/persistence/mergehandler.cpp", "diffHunk": "@@ -426,6 +426,7 @@ MergeHandler::fetchLocalData(\n     }\n \n     document::BucketIdFactory idFactory;\n+    const std::shared_ptr<const document::DocumentTypeRepo> repo = _env._component.getTypeRepo()->documentTypeRepo;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f45c9843e197c5881ef67fa83e1d23c78daa17"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3ODkzMw==", "bodyText": "Fixed", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507678933", "createdAt": "2020-10-19T11:41:24Z", "author": {"login": "baldersheim"}, "path": "storage/src/vespa/storage/persistence/mergehandler.cpp", "diffHunk": "@@ -426,6 +426,7 @@ MergeHandler::fetchLocalData(\n     }\n \n     document::BucketIdFactory idFactory;\n+    const std::shared_ptr<const document::DocumentTypeRepo> repo = _env._component.getTypeRepo()->documentTypeRepo;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3MTY3Mg=="}, "originalCommit": {"oid": "a7f45c9843e197c5881ef67fa83e1d23c78daa17"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDAwODA2OnYy", "diffSide": "RIGHT", "path": "storage/src/vespa/storage/persistence/testandsethelper.cpp", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozMDo0MVrOHkJ6uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTo0MjozOFrOHkKTcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3MzI3NQ==", "bodyText": "Consider using const auto.", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507673275", "createdAt": "2020-10-19T11:30:41Z", "author": {"login": "geirst"}, "path": "storage/src/vespa/storage/persistence/testandsethelper.cpp", "diffHunk": "@@ -47,8 +47,9 @@ TestAndSetHelper::TestAndSetHelper(const PersistenceUtil & env, const spi::Persi\n       _docTypePtr(_cmd.getDocumentType()),\n       _missingDocumentImpliesMatch(missingDocumentImpliesMatch)\n {\n-    resolveDocumentType(*env._repo);\n-    parseDocumentSelection(*env._repo);\n+    const std::shared_ptr<const document::DocumentTypeRepo> _repo = _env._component.getTypeRepo()->documentTypeRepo;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7f45c9843e197c5881ef67fa83e1d23c78daa17"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3OTYwMw==", "bodyText": "Fixed", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507679603", "createdAt": "2020-10-19T11:42:38Z", "author": {"login": "baldersheim"}, "path": "storage/src/vespa/storage/persistence/testandsethelper.cpp", "diffHunk": "@@ -47,8 +47,9 @@ TestAndSetHelper::TestAndSetHelper(const PersistenceUtil & env, const spi::Persi\n       _docTypePtr(_cmd.getDocumentType()),\n       _missingDocumentImpliesMatch(missingDocumentImpliesMatch)\n {\n-    resolveDocumentType(*env._repo);\n-    parseDocumentSelection(*env._repo);\n+    const std::shared_ptr<const document::DocumentTypeRepo> _repo = _env._component.getTypeRepo()->documentTypeRepo;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3MzI3NQ=="}, "originalCommit": {"oid": "a7f45c9843e197c5881ef67fa83e1d23c78daa17"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MDAyMDUyOnYy", "diffSide": "RIGHT", "path": "storage/src/vespa/storage/persistence/simplemessagehandler.cpp", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTozNDoyOFrOHkKCTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxMTo0Mjo1M1rOHkKT8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3NTIxMw==", "bodyText": "Consider updating log target.", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507675213", "createdAt": "2020-10-19T11:34:28Z", "author": {"login": "geirst"}, "path": "storage/src/vespa/storage/persistence/simplemessagehandler.cpp", "diffHunk": "@@ -0,0 +1,241 @@\n+// Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+#include \"simplemessagehandler.h\"\n+#include \"persistenceutil.h\"\n+#include <vespa/persistence/spi/persistenceprovider.h>\n+#include <vespa/storage/common/bucketoperationlogger.h>\n+#include <vespa/document/base/exceptions.h>\n+#include <vespa/document/fieldset/fieldsetrepo.h>\n+\n+#include <vespa/log/log.h>\n+LOG_SETUP(\".persistence.processall\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6a8e2c087d25335784c05a8d01e1c1b665d3b3d"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3OTczMA==", "bodyText": "Fixed", "url": "https://github.com/vespa-engine/vespa/pull/14937#discussion_r507679730", "createdAt": "2020-10-19T11:42:53Z", "author": {"login": "baldersheim"}, "path": "storage/src/vespa/storage/persistence/simplemessagehandler.cpp", "diffHunk": "@@ -0,0 +1,241 @@\n+// Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+\n+#include \"simplemessagehandler.h\"\n+#include \"persistenceutil.h\"\n+#include <vespa/persistence/spi/persistenceprovider.h>\n+#include <vespa/storage/common/bucketoperationlogger.h>\n+#include <vespa/document/base/exceptions.h>\n+#include <vespa/document/fieldset/fieldsetrepo.h>\n+\n+#include <vespa/log/log.h>\n+LOG_SETUP(\".persistence.processall\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzY3NTIxMw=="}, "originalCommit": {"oid": "e6a8e2c087d25335784c05a8d01e1c1b665d3b3d"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1080, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}