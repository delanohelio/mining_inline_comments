{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzNjk2MTQ5", "number": 13571, "title": "use typify_invoke to select matmul implementation", "bodyText": "instead of a chain of select functions, use typify_invoke;\nuse partial specialization on a struct to handle the\ndoubledouble and floatfloat cases specially.\n\nI confirm that this contribution is made under the terms of the license found in the root directory of this repository's source tree and that I have the authority necessary to make this contribution on behalf of its copyright owner.\n@havardpe please review", "createdAt": "2020-06-12T13:57:15Z", "url": "https://github.com/vespa-engine/vespa/pull/13571", "merged": true, "mergeCommit": {"oid": "24a8b542e20c8758f2d5973fc21e979b80247dae"}, "closed": true, "closedAt": "2020-06-13T13:23:39Z", "author": {"login": "arnej27959"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqjLyLgH2gAyNDMzNjk2MTQ5OjUyMzNiNTMxODhhNDBiZmM1MWYzODk5MDE3M2Q1ZDkwNjUzNDQ5OWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcq09R_AH2gAyNDMzNjk2MTQ5OjIwODQzMjEwYzQ1MzQyMjM1MGQ0MjY1MmQ0YTIxZWY5NGNjZTVlYmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5233b53188a40bfc51f38990173d5d906534499a", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/5233b53188a40bfc51f38990173d5d906534499a", "committedDate": "2020-06-12T13:50:27Z", "message": "use typify_invoke to select matmul implementation\n\n* instead of a chain of select functions, use typify_invoke;\n  use partial specialization on a struct to handle the\n  double*double and float*float cases specially."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NzkxMDE1", "url": "https://github.com/vespa-engine/vespa/pull/13571#pullrequestreview-429791015", "createdAt": "2020-06-12T14:32:19Z", "commit": {"oid": "5233b53188a40bfc51f38990173d5d906534499a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNDozMjoxOVrOGjGPRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNDozMjoxOVrOGjGPRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ1NTU1Nw==", "bodyText": "can we eliminate this struct by letting the others capture the TypifyBool::Result instead of bool?", "url": "https://github.com/vespa-engine/vespa/pull/13571#discussion_r439455557", "createdAt": "2020-06-12T14:32:19Z", "author": {"login": "havardpe"}, "path": "eval/src/vespa/eval/tensor/dense/dense_matmul_function.cpp", "diffHunk": "@@ -160,6 +119,35 @@ const TensorFunction &create_matmul(const TensorFunction &a, const TensorFunctio\n     }\n }\n \n+template <typename LCT, typename RCT, bool lhs_common_inner, bool rhs_common_inner>\n+struct MyMatMulOp {\n+    static auto get_fun() {\n+        return my_matmul_op<LCT, RCT, lhs_common_inner, rhs_common_inner>;\n+    }\n+};\n+\n+template <bool lhs_common_inner, bool rhs_common_inner>\n+struct MyMatMulOp<double, double, lhs_common_inner, rhs_common_inner> {\n+    static auto get_fun() {\n+            return my_cblas_double_matmul_op<lhs_common_inner, rhs_common_inner>;\n+    }\n+};\n+\n+template <bool lhs_common_inner, bool rhs_common_inner>\n+struct MyMatMulOp<float, float, lhs_common_inner, rhs_common_inner> {\n+    static auto get_fun() {\n+        return my_cblas_float_matmul_op<lhs_common_inner, rhs_common_inner>;\n+    }\n+};\n+\n+struct MyTarget {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5233b53188a40bfc51f38990173d5d906534499a"}, "originalPosition": 73}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20843210c453422350d42652d4a21ef94cce5ebe", "author": {"user": {"login": "havardpe", "name": "H\u00e5vard Pettersen"}}, "url": "https://github.com/vespa-engine/vespa/commit/20843210c453422350d42652d4a21ef94cce5ebe", "committedDate": "2020-06-13T10:32:54Z", "message": "replace template magic with if statement"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3629, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}