{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2Njk1NDUy", "number": 12534, "title": "Bjorncs/jdisc metric unhandled exception", "bodyText": "", "createdAt": "2020-03-11T13:39:21Z", "url": "https://github.com/vespa-engine/vespa/pull/12534", "merged": true, "mergeCommit": {"oid": "e4253f68b134d16e48a1f6e3e6dbf9d909cf919a"}, "closed": true, "closedAt": "2020-03-16T10:13:19Z", "author": {"login": "bjorncs"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM5DsmAH2gAyMzg2Njk1NDUyOjY1Y2YyYWY0NTJkMGZjZGFlMjRlM2EyMTJjZjljYjgwMTk3OTNiYTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNOkPOgFqTM3NDIyNjE1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "65cf2af452d0fcdae24e3a212cf9cb8019793ba2", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/65cf2af452d0fcdae24e3a212cf9cb8019793ba2", "committedDate": "2020-03-12T10:21:48Z", "message": "Share common metric dimensions with package-local subclasses"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "010535d2d5695c4b5bf08976982640a9cee7ec47", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/010535d2d5695c4b5bf08976982640a9cee7ec47", "committedDate": "2020-03-12T10:25:00Z", "message": "Introduce metric for unhandled exceptions from request handlers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cb56ed899c987600263764cb00f9baf3e190ea1", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/9cb56ed899c987600263764cb00f9baf3e190ea1", "committedDate": "2020-03-12T10:35:24Z", "message": "Introduce metric for unhandled exceptions from jdisc thread pool"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a1cb0e89c7914ca77576f43cf4470e640b4791b", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/0a1cb0e89c7914ca77576f43cf4470e640b4791b", "committedDate": "2020-03-11T13:34:23Z", "message": "Introduce metric for unhandled exceptions from request handlers"}, "afterCommit": {"oid": "9cb56ed899c987600263764cb00f9baf3e190ea1", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/9cb56ed899c987600263764cb00f9baf3e190ea1", "committedDate": "2020-03-12T10:35:24Z", "message": "Introduce metric for unhandled exceptions from jdisc thread pool"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0907c88c0b4dec4ad0037c9c2d3dc1f1c61ab4c4", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/0907c88c0b4dec4ad0037c9c2d3dc1f1c61ab4c4", "committedDate": "2020-03-12T11:46:30Z", "message": "Add unit tests that verifies metric is propagated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNjUyNDk5", "url": "https://github.com/vespa-engine/vespa/pull/12534#pullrequestreview-373652499", "createdAt": "2020-03-12T15:20:26Z", "commit": {"oid": "65cf2af452d0fcdae24e3a212cf9cb8019793ba2"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNToyMDoyNlrOF1jNqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNToyMTozN1rOF1jQzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY5NTc4NA==", "bodyText": "What is the difference between Map.of() and Collections.emptyMap()?", "url": "https://github.com/vespa-engine/vespa/pull/12534#discussion_r391695784", "createdAt": "2020-03-12T15:20:26Z", "author": {"login": "gjoranv"}, "path": "container-core/src/main/java/com/yahoo/container/jdisc/ThreadedRequestHandler.java", "diffHunk": "@@ -97,9 +97,12 @@ protected ThreadedRequestHandler(Executor executor, Metric metric, boolean allow\n         dimensions.put(\"port\", Integer.toString(uri.getPort()));\n         String handlerClassName = getClass().getName();\n         dimensions.put(\"handler-name\", handlerClassName);\n+        dimensions.putAll(extraDimensions);\n         return this.metric.createContext(dimensions);\n     }\n \n+    private Metric.Context contextFor(Request request) { return contextFor(request, Map.of()); }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65cf2af452d0fcdae24e3a212cf9cb8019793ba2"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY5NjU5MA==", "bodyText": "Shouldn't it be ..unhandled_exceptions with the plural 's'? If so, also rename the constant.", "url": "https://github.com/vespa-engine/vespa/pull/12534#discussion_r391696590", "createdAt": "2020-03-12T15:21:37Z", "author": {"login": "gjoranv"}, "path": "container-core/src/main/java/com/yahoo/container/jdisc/ThreadedHttpRequestHandler.java", "diffHunk": "@@ -31,6 +32,7 @@\n \n     public static final String CONTENT_TYPE = \"Content-Type\";\n     private static final String RENDERING_ERRORS = \"rendering_errors\";\n+    private static final String UNHANDLED_EXCEPTION_METRIC = \"jdisc.http.handler.unhandled_exception\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "010535d2d5695c4b5bf08976982640a9cee7ec47"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c8ebb4735a6d97b13c221efb65adc18c75e66dd", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/0c8ebb4735a6d97b13c221efb65adc18c75e66dd", "committedDate": "2020-03-13T10:42:34Z", "message": "Use plural ending in new metric names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd08c1ef0ffa6e3b89ee4c3f621dc75e2be1e13e", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/bd08c1ef0ffa6e3b89ee4c3f621dc75e2be1e13e", "committedDate": "2020-03-13T10:46:28Z", "message": "Export new metrics for unhandled exceptions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MjE0NjA5", "url": "https://github.com/vespa-engine/vespa/pull/12534#pullrequestreview-374214609", "createdAt": "2020-03-13T11:04:09Z", "commit": {"oid": "bd08c1ef0ffa6e3b89ee4c3f621dc75e2be1e13e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0060db436df1b9e6084bcf97939ead48109af078", "author": {"user": {"login": "bjorncs", "name": "Bj\u00f8rn Christian Seime"}}, "url": "https://github.com/vespa-engine/vespa/commit/0060db436df1b9e6084bcf97939ead48109af078", "committedDate": "2020-03-13T11:20:32Z", "message": "Update method and constant names to match new metric name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0MjI2MTU4", "url": "https://github.com/vespa-engine/vespa/pull/12534#pullrequestreview-374226158", "createdAt": "2020-03-13T11:25:21Z", "commit": {"oid": "0060db436df1b9e6084bcf97939ead48109af078"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2656, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}