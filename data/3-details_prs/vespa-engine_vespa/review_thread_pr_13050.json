{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NDE2MjA0", "number": 13050, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOTowNzozMFrOD1rHBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMjowOVrOD1rPNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA3NDMwOnYy", "diffSide": "RIGHT", "path": "container-search/src/main/java/com/yahoo/prelude/querytransform/StemmingSearcher.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOTowNzozMFrOGLOFKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOTowNzozMFrOGLOFKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQxODIxNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        getLogger().log(LogLevel.DEBUG, \"Stem '\"+current.stringValue()+\"' mode \"+index.getStemMode()\n          \n          \n            \n                        getLogger().log(LogLevel.DEBUG, () -> \"Stem '\"+current.stringValue()+\"' mode \"+index.getStemMode()", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414418217", "createdAt": "2020-04-24T09:07:30Z", "author": {"login": "bratseth"}, "path": "container-search/src/main/java/com/yahoo/prelude/querytransform/StemmingSearcher.java", "diffHunk": "@@ -183,9 +184,20 @@ private Item stem(BlockItem current, StemContext context, Index index) {\n         Substring substring = getOffsets(current);\n \n         if (segments.size() == 1) {\n+            getLogger().log(LogLevel.DEBUG, \"Stem '\"+current.stringValue()+\"' mode \"+index.getStemMode()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA4MjUzOnYy", "diffSide": "RIGHT", "path": "container-search/src/main/java/com/yahoo/prelude/querytransform/StemmingSearcher.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOTowOToyMFrOGLOJ9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOTowOToyMFrOGLOJ9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQxOTQ0NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        getLogger().log(LogLevel.DEBUG, \"Stem to multiple segments '\"+segment+\"'\");\n          \n          \n            \n                        getLogger().log(LogLevel.DEBUG, () -> \"Stem to multiple segments '\"+segment+\"'\");", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414419445", "createdAt": "2020-04-24T09:09:20Z", "author": {"login": "bratseth"}, "path": "container-search/src/main/java/com/yahoo/prelude/querytransform/StemmingSearcher.java", "diffHunk": "@@ -194,6 +206,7 @@ private Item stem(BlockItem current, StemContext context, Index index) {\n             composite = chooseComposite(current, ((Item) current).getParent(), indexName);\n \n         for (StemList segment : segments) {\n+            getLogger().log(LogLevel.DEBUG, \"Stem to multiple segments '\"+segment+\"'\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA4NzI0OnYy", "diffSide": "RIGHT", "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OpenNlpTokenizer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMDoyMVrOGLOMuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMDoyMVrOGLOMuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyMDE1Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.log(Level.FINEST, \"getStemmerForLanguage '\"+language+\"' mode: \"+stemMode);\n          \n          \n            \n                    log.log(Level.FINEST, () -> \"getStemmerForLanguage '\"+language+\"' mode: \"+stemMode);", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414420153", "createdAt": "2020-04-24T09:10:21Z", "author": {"login": "bratseth"}, "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OpenNlpTokenizer.java", "diffHunk": "@@ -57,6 +60,7 @@ public OpenNlpTokenizer(Normalizer normalizer, Transformer transformer) {\n     }\n \n     private Stemmer getStemmerForLanguage(Language language, StemMode stemMode) {\n+        log.log(Level.FINEST, \"getStemmerForLanguage '\"+language+\"' mode: \"+stemMode);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA4OTA3OnYy", "diffSide": "RIGHT", "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OpenNlpTokenizer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMDo0M1rOGLONzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMDo0M1rOGLONzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyMDQyOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.log(Level.FINEST, \"processToken '\"+token+\"'\");\n          \n          \n            \n                    log.log(Level.FINEST, () -> \"processToken '\"+token+\"'\");", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414420429", "createdAt": "2020-04-24T09:10:43Z", "author": {"login": "bratseth"}, "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OpenNlpTokenizer.java", "diffHunk": "@@ -120,13 +124,17 @@ private Stemmer getStemmerForLanguage(Language language, StemMode stemMode) {\n \n     private String processToken(String token, Language language, StemMode stemMode, boolean removeAccents,\n                                 Stemmer stemmer) {\n+        log.log(Level.FINEST, \"processToken '\"+token+\"'\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA5MDI2OnYy", "diffSide": "RIGHT", "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OpenNlpTokenizer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMTowMlrOGLOOjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMTowMlrOGLOOjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyMDYyMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        log.log(Level.FINEST, \"stem '\"+oldToken+\"' to '\"+token+\"'\");\n          \n          \n            \n                        log.log(Level.FINEST, () -> \"stem '\"+oldToken+\"' to '\"+token+\"'\");", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414420620", "createdAt": "2020-04-24T09:11:02Z", "author": {"login": "bratseth"}, "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OpenNlpTokenizer.java", "diffHunk": "@@ -120,13 +124,17 @@ private Stemmer getStemmerForLanguage(Language language, StemMode stemMode) {\n \n     private String processToken(String token, Language language, StemMode stemMode, boolean removeAccents,\n                                 Stemmer stemmer) {\n+        log.log(Level.FINEST, \"processToken '\"+token+\"'\");\n         token = normalizer.normalize(token);\n         token = LinguisticsCase.toLowerCase(token);\n         if (removeAccents)\n             token = transformer.accentDrop(token, language);\n         if (stemMode != StemMode.NONE) {\n+            String oldToken = token;\n             token = doStemming(token, stemmer);\n+            log.log(Level.FINEST, \"stem '\"+oldToken+\"' to '\"+token+\"'\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA5MTYwOnYy", "diffSide": "RIGHT", "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OpenNlpTokenizer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMToyMFrOGLOPVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMToyMFrOGLOPVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyMDgyMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.log(Level.FINEST, \"processed token is: \"+token);\n          \n          \n            \n                    log.log(Level.FINEST, () -> \"processed token is: \"+token);", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414420822", "createdAt": "2020-04-24T09:11:20Z", "author": {"login": "bratseth"}, "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OpenNlpTokenizer.java", "diffHunk": "@@ -120,13 +124,17 @@ private Stemmer getStemmerForLanguage(Language language, StemMode stemMode) {\n \n     private String processToken(String token, Language language, StemMode stemMode, boolean removeAccents,\n                                 Stemmer stemmer) {\n+        log.log(Level.FINEST, \"processToken '\"+token+\"'\");\n         token = normalizer.normalize(token);\n         token = LinguisticsCase.toLowerCase(token);\n         if (removeAccents)\n             token = transformer.accentDrop(token, language);\n         if (stemMode != StemMode.NONE) {\n+            String oldToken = token;\n             token = doStemming(token, stemmer);\n+            log.log(Level.FINEST, \"stem '\"+oldToken+\"' to '\"+token+\"'\");\n         }\n+        log.log(Level.FINEST, \"processed token is: \"+token);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA5MzAyOnYy", "diffSide": "RIGHT", "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OptimaizeDetector.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMTozOVrOGLOQLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMTozOVrOGLOQLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyMTAzOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.log(Level.FINE, \"guessing language \"+result.get()+\" from input: \"+input);\n          \n          \n            \n                    log.log(Level.FINE, () -> \"guessing language \"+result.get()+\" from input: \"+input);", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414421038", "createdAt": "2020-04-24T09:11:39Z", "author": {"login": "bratseth"}, "path": "linguistics/src/main/java/com/yahoo/language/opennlp/OptimaizeDetector.java", "diffHunk": "@@ -96,6 +99,7 @@ public Language guessLanguage(String input) {\n     private static Language guessLanguageUsingOptimaize(String input) {\n         Optional<LdLocale> result = languageDetector.detect(textObjectFactory.forText(input));\n         if ( ! result.isPresent()) return Language.UNKNOWN;\n+        log.log(Level.FINE, \"guessing language \"+result.get()+\" from input: \"+input);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA5NDYyOnYy", "diffSide": "RIGHT", "path": "linguistics/src/main/java/com/yahoo/language/simple/SimpleTokenizer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMTo1N1rOGLORGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMTo1N1rOGLORGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyMTI3NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        log.log(Level.FINEST, \"stem '\"+oldToken+\"' to '\"+token+\"'\");\n          \n          \n            \n                        log.log(Level.FINEST, () -> \"stem '\"+oldToken+\"' to '\"+token+\"'\");", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414421274", "createdAt": "2020-04-24T09:11:57Z", "author": {"login": "bratseth"}, "path": "linguistics/src/main/java/com/yahoo/language/simple/SimpleTokenizer.java", "diffHunk": "@@ -64,12 +67,17 @@ public SimpleTokenizer(Normalizer normalizer, Transformer transformer) {\n     }\n \n     private String processToken(String token, Language language, StemMode stemMode, boolean removeAccents) {\n+        log.log(Level.FINEST, \"processToken '\"+token+\"'\");\n         token = normalizer.normalize(token);\n         token = LinguisticsCase.toLowerCase(token);\n         if (removeAccents)\n             token = transformer.accentDrop(token, language);\n-        if (stemMode != StemMode.NONE)\n+        if (stemMode != StemMode.NONE) {\n+            String oldToken = token;\n             token = stemmer.stem(token);\n+            log.log(Level.FINEST, \"stem '\"+oldToken+\"' to '\"+token+\"'\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjA5NTI3OnYy", "diffSide": "RIGHT", "path": "linguistics/src/main/java/com/yahoo/language/simple/SimpleTokenizer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMjowOVrOGLORkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwOToxMjowOVrOGLORkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyMTM5NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.log(Level.FINEST, \"processed token is: \"+token);\n          \n          \n            \n                    log.log(Level.FINEST, () -> \"processed token is: \"+token);", "url": "https://github.com/vespa-engine/vespa/pull/13050#discussion_r414421394", "createdAt": "2020-04-24T09:12:09Z", "author": {"login": "bratseth"}, "path": "linguistics/src/main/java/com/yahoo/language/simple/SimpleTokenizer.java", "diffHunk": "@@ -64,12 +67,17 @@ public SimpleTokenizer(Normalizer normalizer, Transformer transformer) {\n     }\n \n     private String processToken(String token, Language language, StemMode stemMode, boolean removeAccents) {\n+        log.log(Level.FINEST, \"processToken '\"+token+\"'\");\n         token = normalizer.normalize(token);\n         token = LinguisticsCase.toLowerCase(token);\n         if (removeAccents)\n             token = transformer.accentDrop(token, language);\n-        if (stemMode != StemMode.NONE)\n+        if (stemMode != StemMode.NONE) {\n+            String oldToken = token;\n             token = stemmer.stem(token);\n+            log.log(Level.FINEST, \"stem '\"+oldToken+\"' to '\"+token+\"'\");\n+        }\n+        log.log(Level.FINEST, \"processed token is: \"+token);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "976f28680df424bf028eb12a3f413049c17bf098"}, "originalPosition": 32}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1746, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}