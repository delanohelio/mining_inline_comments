{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3MTUxNTM0", "number": 13008, "title": "Bratseth/store autoscaling state", "bodyText": "", "createdAt": "2020-04-22T09:03:46Z", "url": "https://github.com/vespa-engine/vespa/pull/13008", "merged": true, "mergeCommit": {"oid": "5bb6e481137e7827415dc9766011c68aca67c17d"}, "closed": true, "closedAt": "2020-04-22T09:40:28Z", "author": {"login": "bratseth"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZyJTMAH2gAyNDA3MTUxNTM0OmYyM2NmOGIzYWZkOTI3ZjVjOTllNDc1ZDNlYjlkMDQzMzYwNDgzZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaFCXEgH2gAyNDA3MTUxNTM0OjU1YWE3MWQ2ZDc4YzQzODkwNTU1Y2I0YzgwNjk3NTFhZDRhOTNmMmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f23cf8b3afd927f5c99e475d3eb9d043360483d4", "author": {"user": {"login": "bratseth", "name": "Jon Bratseth"}}, "url": "https://github.com/vespa-engine/vespa/commit/f23cf8b3afd927f5c99e475d3eb9d043360483d4", "committedDate": "2020-04-21T11:39:36Z", "message": "Store application info in zk"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eec77fa0e5b00cb88f248346d19f9dedb4d295ae", "author": {"user": {"login": "bratseth", "name": "Jon Bratseth"}}, "url": "https://github.com/vespa-engine/vespa/commit/eec77fa0e5b00cb88f248346d19f9dedb4d295ae", "committedDate": "2020-04-21T11:50:20Z", "message": "Cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f6aceb9fd023a637d45b853ea5c998c1259dcd3", "author": {"user": {"login": "bratseth", "name": "Jon Bratseth"}}, "url": "https://github.com/vespa-engine/vespa/commit/5f6aceb9fd023a637d45b853ea5c998c1259dcd3", "committedDate": "2020-04-22T09:03:05Z", "message": "Remove applications on remove"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MDAyMTM5", "url": "https://github.com/vespa-engine/vespa/pull/13008#pullrequestreview-398002139", "createdAt": "2020-04-22T09:20:04Z", "commit": {"oid": "f23cf8b3afd927f5c99e475d3eb9d043360483d4"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwOToyMDowNFrOGJsW9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwOToyMDowNFrOGJsW9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjgxNzE0Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    System.out.println(\"original id: \" + original.id());\n          \n          \n            \n                    System.out.println(\"serialized id: \" + serialized.id());", "url": "https://github.com/vespa-engine/vespa/pull/13008#discussion_r412817143", "createdAt": "2020-04-22T09:20:04Z", "author": {"login": "freva"}, "path": "node-repository/src/test/java/com/yahoo/vespa/hosted/provision/persistence/ApplicationSerializerTest.java", "diffHunk": "@@ -0,0 +1,58 @@\n+// Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+package com.yahoo.vespa.hosted.provision.persistence;\n+\n+import com.yahoo.config.provision.ApplicationId;\n+import com.yahoo.config.provision.ClusterResources;\n+import com.yahoo.config.provision.ClusterSpec;\n+import com.yahoo.config.provision.NodeResources;\n+import com.yahoo.vespa.hosted.provision.applications.Application;\n+import com.yahoo.vespa.hosted.provision.applications.Cluster;\n+import org.junit.Test;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Optional;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertNotNull;\n+import static org.junit.Assert.assertNotSame;\n+\n+/**\n+ * @author bratseth\n+ */\n+public class ApplicationSerializerTest {\n+\n+    @Test\n+    public void testApplicationSerialization() {\n+        List<Cluster> clusters = new ArrayList<>();\n+        clusters.add(new Cluster(ClusterSpec.Id.from(\"c1\"),\n+                                 new ClusterResources( 8, 4, new NodeResources(1, 2,  3,  4)),\n+                                 new ClusterResources(12, 6, new NodeResources(3, 6, 21, 24)),\n+                                 Optional.empty()));\n+        clusters.add(new Cluster(ClusterSpec.Id.from(\"c2\"),\n+                                 new ClusterResources( 8, 4, new NodeResources(1, 2, 3, 4)),\n+                                 new ClusterResources(14, 7, new NodeResources(3, 6, 21, 24)),\n+                                 Optional.of(new ClusterResources(10, 5, new NodeResources(2, 4, 14, 16)))));\n+        Application original = new Application(ApplicationId.from(\"myTenant\", \"myApplication\", \"myInstance\"),\n+                                               clusters);\n+\n+        Application serialized = ApplicationSerializer.fromJson(ApplicationSerializer.toJson(original));\n+        assertNotSame(original, serialized);\n+        System.out.println(\"original id: \" + original.id());\n+        System.out.println(\"serialized id: \" + serialized.id());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f23cf8b3afd927f5c99e475d3eb9d043360483d4"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55aa71d6d78c43890555cb4c8069751ad4a93f2d", "author": {"user": {"login": "bratseth", "name": "Jon Bratseth"}}, "url": "https://github.com/vespa-engine/vespa/commit/55aa71d6d78c43890555cb4c8069751ad4a93f2d", "committedDate": "2020-04-22T09:40:13Z", "message": "Update node-repository/src/test/java/com/yahoo/vespa/hosted/provision/persistence/ApplicationSerializerTest.java\n\nCo-Authored-By: Valerij Fredriksen <freva@users.noreply.github.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3355, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}