{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwNzUwMzg5", "number": 13332, "title": "Hmusum/use remote session repo for finding active session", "bodyText": "This is a fix for issues seen where we do e.g. do not restart nodes when there are changes requiring it (we do not compare with previous deployment, since we do not find it).\n(First commit is from #13326)", "createdAt": "2020-05-20T13:26:55Z", "url": "https://github.com/vespa-engine/vespa/pull/13332", "merged": true, "mergeCommit": {"oid": "e559207b61df7ad4eb9227efdaad76969d3523c6"}, "closed": true, "closedAt": "2020-05-20T17:44:50Z", "author": {"login": "hmusum"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjIEkqAH2gAyNDIwNzUwMzg5OmEzNTBkZGJlNzM4NDgxNTY3NDk2NWYyMjQ2MWEwNDljZDBhMjljODY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjKfbygFqTQxNTQzNTMzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a350ddbe7384815674965f22461a049cd0a29c86", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/a350ddbe7384815674965f22461a049cd0a29c86", "committedDate": "2020-05-20T12:17:40Z", "message": "Move one test to another class and remove 2 tests that are tested elsewhere"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e354869c4ad9063c97e8c37417fc7c92673b3331", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/e354869c4ad9063c97e8c37417fc7c92673b3331", "committedDate": "2020-05-20T13:25:46Z", "message": "Use remote session repo to find active session\n\nActive session is not necessarily a local session, it might have been\ncreated on another config server."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NDMzOTcz", "url": "https://github.com/vespa-engine/vespa/pull/13332#pullrequestreview-415433973", "createdAt": "2020-05-20T15:05:29Z", "commit": {"oid": "e354869c4ad9063c97e8c37417fc7c92673b3331"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNTowNToyOVrOGYQZSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNTowNToyOVrOGYQZSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NzYyNw==", "bodyText": "Could probably remove most of these from LocalSession, if they're not to be used on that?", "url": "https://github.com/vespa-engine/vespa/pull/13332#discussion_r428087627", "createdAt": "2020-05-20T15:05:29Z", "author": {"login": "jonmv"}, "path": "configserver/src/main/java/com/yahoo/vespa/config/server/session/RemoteSession.java", "diffHunk": "@@ -135,4 +139,34 @@ public void delete() {\n         transaction.close();\n     }\n \n+    public ApplicationId getApplicationId() { return zooKeeperClient.readApplicationId(); }\n+\n+    public Optional<DockerImage> getDockerImageRepository() { return zooKeeperClient.readDockerImageRepository(); }\n+\n+    public Version getVespaVersion() { return zooKeeperClient.readVespaVersion(); }\n+\n+    public Optional<AthenzDomain> getAthenzDomain() { return zooKeeperClient.readAthenzDomain(); }\n+\n+    public AllocatedHosts getAllocatedHosts() {\n+        return zooKeeperClient.getAllocatedHosts();\n+    }\n+\n+    // Note: Assumes monotonically increasing session ids\n+    public boolean isNewerThan(long sessionId) {\n+        return getSessionId() > sessionId;\n+    }\n+\n+    public Transaction createDeactivateTransaction() {\n+        return createSetStatusTransaction(Status.DEACTIVATE);\n+    }\n+\n+    private Transaction createSetStatusTransaction(Status status) {\n+        return zooKeeperClient.createWriteStatusTransaction(status);\n+    }\n+\n+    public ApplicationMetaData getMetaData() {\n+        return zooKeeperClient.loadApplicationPackage().getMetaData();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e354869c4ad9063c97e8c37417fc7c92673b3331"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NDM1MzM1", "url": "https://github.com/vespa-engine/vespa/pull/13332#pullrequestreview-415435335", "createdAt": "2020-05-20T15:06:49Z", "commit": {"oid": "e354869c4ad9063c97e8c37417fc7c92673b3331"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3166, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}