{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxOTAyMDMy", "number": 14321, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwOTozMToxNFrOEhKXQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwOTozMToxNFrOEhKXQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzMjA4MjU2OnYy", "diffSide": "RIGHT", "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/autoscale/Autoscaler.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwOTozMToxNFrOHOUvhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwOTo1OToyNFrOHOVyXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDc4MTk1OA==", "bodyText": "The second part of this reads more like we don't require having any measurements from all nodes, instead of not requiring at least minimumMeasurementsPerNode for all nodes", "url": "https://github.com/vespa-engine/vespa/pull/14321#discussion_r484781958", "createdAt": "2020-09-08T09:31:14Z", "author": {"login": "freva"}, "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/autoscale/Autoscaler.java", "diffHunk": "@@ -113,8 +105,9 @@ private boolean similar(double r1, double r2, double threshold) {\n                                                           resource,\n                                                           clusterNodes.stream().map(Node::hostname).collect(Collectors.toList()));\n \n-        if (window.measurementCount() < minimumMeasurements) return Optional.empty();\n-        if (window.hostnames() != clusterNodes.size()) return Optional.empty(); // Regulate only when all nodes are measured\n+        // Require a total number of measurements scaling with the number of nodes but don't require them from all nodes", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8891a7d5574ee34c3f7663c964171ad15a8003ac"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDc5OTA2OA==", "bodyText": "Better now?", "url": "https://github.com/vespa-engine/vespa/pull/14321#discussion_r484799068", "createdAt": "2020-09-08T09:59:24Z", "author": {"login": "bratseth"}, "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/autoscale/Autoscaler.java", "diffHunk": "@@ -113,8 +105,9 @@ private boolean similar(double r1, double r2, double threshold) {\n                                                           resource,\n                                                           clusterNodes.stream().map(Node::hostname).collect(Collectors.toList()));\n \n-        if (window.measurementCount() < minimumMeasurements) return Optional.empty();\n-        if (window.hostnames() != clusterNodes.size()) return Optional.empty(); // Regulate only when all nodes are measured\n+        // Require a total number of measurements scaling with the number of nodes but don't require them from all nodes", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDc4MTk1OA=="}, "originalCommit": {"oid": "8891a7d5574ee34c3f7663c964171ad15a8003ac"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1396, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}