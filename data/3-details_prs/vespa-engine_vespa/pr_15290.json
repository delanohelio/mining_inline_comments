{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5MjU0NDEy", "number": 15290, "title": "Jonmv/reindexing status in application v2", "bodyText": "@bjorncs please review.", "createdAt": "2020-11-11T15:00:10Z", "url": "https://github.com/vespa-engine/vespa/pull/15290", "merged": true, "mergeCommit": {"oid": "24c35e915b8ed2c5afddd345225832058b5faa96"}, "closed": true, "closedAt": "2020-11-12T08:50:12Z", "author": {"login": "jonmv"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbg3fnAH2gAyNTE5MjU0NDEyOmRhMTRlOWQ5NWVhOTQ0MjdmNWU0NjFiYjEzZGEyYTVhNWNlYjBjZDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbulpwgH2gAyNTE5MjU0NDEyOjgxZGM3ZDVlNjYzNWI3NmMyYWQ4OTQ3N2I4OTg5NWVlZjYzYjJhNzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "da14e9d95ea94427f5e461bb13da2a5a5ceb0cd3", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/da14e9d95ea94427f5e461bb13da2a5a5ceb0cd3", "committedDate": "2020-11-11T16:50:46Z", "message": "Allow simultaneous pending and ready reindexing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbe19e992e7cec24647f2b799d6139346dbd47d6", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/fbe19e992e7cec24647f2b799d6139346dbd47d6", "committedDate": "2020-11-11T16:50:46Z", "message": "REST API for reindexing status on config server"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9916aa99cc2745fa598048445100d241d2f4faf7", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/9916aa99cc2745fa598048445100d241d2f4faf7", "committedDate": "2020-11-11T14:59:51Z", "message": "REST API for reindexing status on config server"}, "afterCommit": {"oid": "fbe19e992e7cec24647f2b799d6139346dbd47d6", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/fbe19e992e7cec24647f2b799d6139346dbd47d6", "committedDate": "2020-11-11T16:50:46Z", "message": "REST API for reindexing status on config server"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1076530529be8a178789476dbaf7f7b358f2214", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/b1076530529be8a178789476dbaf7f7b358f2214", "committedDate": "2020-11-11T17:35:58Z", "message": "Fix type and test pending type in handler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4ODYyOTc3", "url": "https://github.com/vespa-engine/vespa/pull/15290#pullrequestreview-528862977", "createdAt": "2020-11-12T08:45:18Z", "commit": {"oid": "fbe19e992e7cec24647f2b799d6139346dbd47d6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwODo0NToxOVrOHxwOtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwODo0NToxOVrOHxwOtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTkzMjQ2OQ==", "bodyText": "Debug code accidentally included?", "url": "https://github.com/vespa-engine/vespa/pull/15290#discussion_r521932469", "createdAt": "2020-11-12T08:45:19Z", "author": {"login": "bjorncs"}, "path": "configserver/src/test/java/com/yahoo/vespa/config/server/http/v2/ApplicationHandlerTest.java", "diffHunk": "@@ -408,21 +520,42 @@ private void assertApplicationExists(ApplicationId applicationId, Zone zone) thr\n                                                    GET);\n     }\n \n+    private void reindexing(ApplicationId application, Method method, String expectedBody) throws IOException {\n+        String reindexingUrl = toUrlPath(application, Zone.defaultZone(), true) + \"/reindexing\";\n+        HttpResponse response = createApplicationHandler().handle(createTestRequest(reindexingUrl, method));\n+        assertEquals(200, response.getStatus());\n+        if (expectedBody != null) {\n+            ByteArrayOutputStream out = new ByteArrayOutputStream();\n+            response.render(out);\n+            System.err.println(out);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fbe19e992e7cec24647f2b799d6139346dbd47d6"}, "originalPosition": 308}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4ODY2NTEy", "url": "https://github.com/vespa-engine/vespa/pull/15290#pullrequestreview-528866512", "createdAt": "2020-11-12T08:49:48Z", "commit": {"oid": "b1076530529be8a178789476dbaf7f7b358f2214"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwODo0OTo0OFrOHxwaCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwODo0OTo0OFrOHxwaCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTkzNTM2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        System.err.println(out);", "url": "https://github.com/vespa-engine/vespa/pull/15290#discussion_r521935368", "createdAt": "2020-11-12T08:49:48Z", "author": {"login": "jonmv"}, "path": "configserver/src/test/java/com/yahoo/vespa/config/server/http/v2/ApplicationHandlerTest.java", "diffHunk": "@@ -408,21 +527,42 @@ private void assertApplicationExists(ApplicationId applicationId, Zone zone) thr\n                                                    GET);\n     }\n \n+    private void reindexing(ApplicationId application, Method method, String expectedBody) throws IOException {\n+        String reindexingUrl = toUrlPath(application, Zone.defaultZone(), true) + \"/reindexing\";\n+        HttpResponse response = createApplicationHandler().handle(createTestRequest(reindexingUrl, method));\n+        assertEquals(200, response.getStatus());\n+        if (expectedBody != null) {\n+            ByteArrayOutputStream out = new ByteArrayOutputStream();\n+            response.render(out);\n+            System.err.println(out);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1076530529be8a178789476dbaf7f7b358f2214"}, "originalPosition": 315}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81dc7d5e6635b76c2ad89477b89895eef63b2a77", "author": {"user": {"login": "jonmv", "name": "Jon Marius Venstad"}}, "url": "https://github.com/vespa-engine/vespa/commit/81dc7d5e6635b76c2ad89477b89895eef63b2a77", "committedDate": "2020-11-12T08:49:57Z", "message": "Remove debug leftover"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2041, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}