{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MDE3MDYz", "number": 12323, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNToxOToyN1rODiXUzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNToyMDowMVrODiXVnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MzYwMzMyOnYy", "diffSide": "RIGHT", "path": "searchlib/src/tests/tensor/hnsw_index/hnsw_index_test.cpp", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNToxOToyN1rOFtkZuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNToxOToyN1rOFtkZuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzMyNjY1MQ==", "bodyText": "Also consider checking that doc 5 is connected to {1,2} on level 0 and {4} on level 1.", "url": "https://github.com/vespa-engine/vespa/pull/12323#discussion_r383326651", "createdAt": "2020-02-24T15:19:27Z", "author": {"login": "geirst"}, "path": "searchlib/src/tests/tensor/hnsw_index/hnsw_index_test.cpp", "diffHunk": "@@ -266,5 +266,33 @@ TEST_F(HnswIndexTest, 2d_vectors_inserted_in_hierarchic_graph_with_heuristic_sel\n     expect_level_0(7, {3, 6});\n }\n \n+TEST_F(HnswIndexTest, manual_insert)\n+{\n+    init(false);\n+\n+    std::vector<uint32_t> nbl;\n+    HnswNode empty{nbl};\n+    index->set_node(1, empty);\n+    index->set_node(2, empty);\n+\n+    HnswNode three{{1,2}};\n+    index->set_node(3, three);\n+    expect_level_0(1, {3});\n+    expect_level_0(2, {3});\n+    expect_level_0(3, {1,2});\n+\n+    expect_entry_point(1, 0);\n+\n+    HnswNode twolevels{{{1},nbl}};\n+    index->set_node(4, twolevels);\n+\n+    expect_entry_point(4, 1);\n+    expect_level_0(1, {3,4});\n+\n+    HnswNode five{{{1,2}, {4}}};\n+    index->set_node(5, five);\n+    expect_levels(4, {{1}, {5}});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1c838e6bb894e7a26203f99aa4c274bb4170baa"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MzYwNTQxOnYy", "diffSide": "RIGHT", "path": "searchlib/src/vespa/searchlib/tensor/hnsw_index.h", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNToyMDowMVrOFtkbAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxNToyMDowMVrOFtkbAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzMyNjk3OA==", "bodyText": "Even though this is just used for unit testing, consider passing HnswNode as const reference.", "url": "https://github.com/vespa-engine/vespa/pull/12323#discussion_r383326978", "createdAt": "2020-02-24T15:20:01Z", "author": {"login": "geirst"}, "path": "searchlib/src/vespa/searchlib/tensor/hnsw_index.h", "diffHunk": "@@ -145,8 +145,7 @@ class HnswIndex : public NearestNeighborIndex {\n \n     // Should only be used by unit tests.\n     HnswNode get_node(uint32_t docid) const;\n-\n-    // TODO: Implement set_node() as well for use in unit tests.\n+    void set_node(uint32_t docid, HnswNode node);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1c838e6bb894e7a26203f99aa4c274bb4170baa"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2344, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}