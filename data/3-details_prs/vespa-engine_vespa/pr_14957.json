{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2MDg3ODAy", "number": 14957, "title": "Remove allow host sharing", "bodyText": "", "createdAt": "2020-10-19T15:50:14Z", "url": "https://github.com/vespa-engine/vespa/pull/14957", "merged": true, "mergeCommit": {"oid": "18efc89af221c6bcc05764454ca363bed77e67aa"}, "closed": true, "closedAt": "2020-10-19T18:42:19Z", "author": {"login": "freva"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUGMuZgH2gAyNTA2MDg3ODAyOjFjY2Q3Njg1NzhlNWFlZjQwZDRkMTljNDM5ODdmYTQ2Y2U5OGUwNTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUIkI1AFqTUxMjA0NTQ4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1ccd768578e5aef40d4d19c43987fa46ce98e057", "author": {"user": {"login": "freva", "name": "Valerij Fredriksen"}}, "url": "https://github.com/vespa-engine/vespa/commit/1ccd768578e5aef40d4d19c43987fa46ce98e057", "committedDate": "2020-10-19T15:49:03Z", "message": "Remove allowHostSharing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "771cfd6c9bf3f537715acaa0f2bdb693f45164d6", "author": {"user": {"login": "freva", "name": "Valerij Fredriksen"}}, "url": "https://github.com/vespa-engine/vespa/commit/771cfd6c9bf3f537715acaa0f2bdb693f45164d6", "committedDate": "2020-10-19T15:49:03Z", "message": "Use dynamicProvisioning property"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea72fc4e53147f6bb03bca9237e1cacd0df468d1", "author": {"user": {"login": "freva", "name": "Valerij Fredriksen"}}, "url": "https://github.com/vespa-engine/vespa/commit/ea72fc4e53147f6bb03bca9237e1cacd0df468d1", "committedDate": "2020-10-19T15:49:03Z", "message": "Make sure HostProvisioner presence is 1-to-1 with dynamicProvisioning property"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMDQ1NDg4", "url": "https://github.com/vespa-engine/vespa/pull/14957#pullrequestreview-512045488", "createdAt": "2020-10-19T18:27:59Z", "commit": {"oid": "ea72fc4e53147f6bb03bca9237e1cacd0df468d1"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODoyNzo1OVrOHkcOiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODozMToyOVrOHkcW2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3MzI1OQ==", "bodyText": "\"not necessary\" is not correct - we hope to enable rebalancing even with dynamic provisioning, but it's a todo.", "url": "https://github.com/vespa-engine/vespa/pull/14957#discussion_r507973259", "createdAt": "2020-10-19T18:27:59Z", "author": {"login": "hakonhall"}, "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/maintenance/Rebalancer.java", "diffHunk": "@@ -35,7 +35,7 @@ public Rebalancer(Deployer deployer,\n     @Override\n     protected boolean maintain() {\n         boolean success = true;\n-        if ( ! nodeRepository().zone().getCloud().allowHostSharing()) return success; // Rebalancing not necessary\n+        if (nodeRepository().zone().getCloud().dynamicProvisioning()) return success; // Rebalancing not necessary", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea72fc4e53147f6bb03bca9237e1cacd0df468d1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3NTM4Ng==", "bodyText": "We'd like to maintain spare capacity in dynamically provisioned zones too - but it will depend on flags.", "url": "https://github.com/vespa-engine/vespa/pull/14957#discussion_r507975386", "createdAt": "2020-10-19T18:31:29Z", "author": {"login": "hakonhall"}, "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/maintenance/SpareCapacityMaintainer.java", "diffHunk": "@@ -68,7 +68,8 @@ public SpareCapacityMaintainer(Deployer deployer,\n     @Override\n     protected boolean maintain() {\n         boolean success = true;\n-        if ( ! nodeRepository().zone().getCloud().allowHostSharing()) return success;\n+        // Don't need to maintain spare capacity in dynamically provisioned zones; can provision more on demand.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea72fc4e53147f6bb03bca9237e1cacd0df468d1"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2288, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}