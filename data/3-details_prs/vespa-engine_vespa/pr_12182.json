{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0ODk2Njc5", "number": 12182, "title": "Splunk: Setting default application Id values in _meta", "bodyText": "I confirm that this contribution is made under the terms of the license found in the root directory of this repository's source tree and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-02-13T14:24:44Z", "url": "https://github.com/vespa-engine/vespa/pull/12182", "merged": true, "mergeCommit": {"oid": "0e77350cf98884bd98235a051873dc7074c629f9"}, "closed": true, "closedAt": "2020-02-14T13:23:58Z", "author": {"login": "bjormel"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcD7vRKgH2gAyMzc0ODk2Njc5OjA5MTJmZTczNzBhNThiNjYxZTZlZGI1OGM2OWY4Y2IxNTg1ZThkZDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcEPZkagFqTM1ODkzMzA4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0912fe7370a58b661e6edb58c69f8cb1585e8dd2", "author": {"user": {"login": "bjormel", "name": "Bj\u00f8rn Meland"}}, "url": "https://github.com/vespa-engine/vespa/commit/0912fe7370a58b661e6edb58c69f8cb1585e8dd2", "committedDate": "2020-02-13T14:23:53Z", "message": "Setting default application Id values in _meta"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4ODkzNTQy", "url": "https://github.com/vespa-engine/vespa/pull/12182#pullrequestreview-358893542", "createdAt": "2020-02-14T11:58:47Z", "commit": {"oid": "0912fe7370a58b661e6edb58c69f8cb1585e8dd2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMTo1ODo0OFrOFp0ZGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNFQxMjowMDozM1rOFp0bjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5NDMzMA==", "bodyText": "must be \"fp =\" not \"*fp =\"", "url": "https://github.com/vespa-engine/vespa/pull/12182#discussion_r379394330", "createdAt": "2020-02-14T11:58:48Z", "author": {"login": "arnej27959"}, "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "diffHunk": "@@ -76,6 +77,17 @@ CfHandler::doConfigure()\n     fclose(fp);\n     rename(tmpPath.c_str(), path.c_str());\n \n+    path = cfFilePath(config.splunkHome, \"inputs.conf\");\n+    tmpPath = path + \".new\";\n+    *fp = fopen(tmpPath.c_str(), \"w\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0912fe7370a58b661e6edb58c69f8cb1585e8dd2"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5NDQ4MA==", "bodyText": "consider using VESPA_HOSTNAME instead?", "url": "https://github.com/vespa-engine/vespa/pull/12182#discussion_r379394480", "createdAt": "2020-02-14T11:59:15Z", "author": {"login": "arnej27959"}, "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "diffHunk": "@@ -76,6 +77,17 @@ CfHandler::doConfigure()\n     fclose(fp);\n     rename(tmpPath.c_str(), path.c_str());\n \n+    path = cfFilePath(config.splunkHome, \"inputs.conf\");\n+    tmpPath = path + \".new\";\n+    *fp = fopen(tmpPath.c_str(), \"w\");\n+    if (fp == NULL) return;\n+\n+    fprintf(fp, \"[default]\\n\");\n+    fprintf(fp, \"host = %s\\n\", getenv(\"HOSTNAME\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0912fe7370a58b661e6edb58c69f8cb1585e8dd2"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTM5NDk1Ng==", "bodyText": "must be VESPA_APPLICATION here.\nalso, we should probably detect if any of these are unset (getenv returns null pointer), i guess...", "url": "https://github.com/vespa-engine/vespa/pull/12182#discussion_r379394956", "createdAt": "2020-02-14T12:00:33Z", "author": {"login": "arnej27959"}, "path": "logforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp", "diffHunk": "@@ -76,6 +77,17 @@ CfHandler::doConfigure()\n     fclose(fp);\n     rename(tmpPath.c_str(), path.c_str());\n \n+    path = cfFilePath(config.splunkHome, \"inputs.conf\");\n+    tmpPath = path + \".new\";\n+    *fp = fopen(tmpPath.c_str(), \"w\");\n+    if (fp == NULL) return;\n+\n+    fprintf(fp, \"[default]\\n\");\n+    fprintf(fp, \"host = %s\\n\", getenv(\"HOSTNAME\"));\n+    fprintf(fp, \"_meta = vespa_tenant::%s vespa_application::%s vespa_instance::%s\\n\", getenv(\"VESPA_TENANT\"), getenv(\"VESPA_APPLICTAION\"), getenv(\"VESPA_INSTANCE\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0912fe7370a58b661e6edb58c69f8cb1585e8dd2"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5f5a6b2faadf3ad22f9ead1e3ea48a19ac0e7cf", "author": {"user": {"login": "arnej27959", "name": "Arne H Juul"}}, "url": "https://github.com/vespa-engine/vespa/commit/e5f5a6b2faadf3ad22f9ead1e3ea48a19ac0e7cf", "committedDate": "2020-02-14T12:13:47Z", "message": "fix syntax and typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07965876cec40d5973defe13f0ed271ad3e33208", "author": {"user": {"login": "bjormel", "name": "Bj\u00f8rn Meland"}}, "url": "https://github.com/vespa-engine/vespa/commit/07965876cec40d5973defe13f0ed271ad3e33208", "committedDate": "2020-02-14T12:23:59Z", "message": "Safeguarding and fixing typos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e482a89addaac3507f20921527677e1be0b978e4", "author": {"user": {"login": "bjormel", "name": "Bj\u00f8rn Meland"}}, "url": "https://github.com/vespa-engine/vespa/commit/e482a89addaac3507f20921527677e1be0b978e4", "committedDate": "2020-02-14T12:24:58Z", "message": "Merge remote-tracking branch 'origin/bjormel/splunk-logforwarder-default-inputs.conf' into bjormel/splunk-logforwarder-default-inputs.conf\n\n# Conflicts:\n#\tlogforwarder/src/apps/vespa-logforwarder-start/cf-handler.cpp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5927c9f2374e8dcf7d00d2957bd22ed1c1a0d819", "author": {"user": {"login": "bjormel", "name": "Bj\u00f8rn Meland"}}, "url": "https://github.com/vespa-engine/vespa/commit/5927c9f2374e8dcf7d00d2957bd22ed1c1a0d819", "committedDate": "2020-02-14T12:29:17Z", "message": "Safeguarding"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4OTMzMDgz", "url": "https://github.com/vespa-engine/vespa/pull/12182#pullrequestreview-358933083", "createdAt": "2020-02-14T13:18:17Z", "commit": {"oid": "5927c9f2374e8dcf7d00d2957bd22ed1c1a0d819"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2985, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}