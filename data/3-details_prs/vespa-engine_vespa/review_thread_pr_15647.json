{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxOTgwNTQ5", "number": 15647, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMToyMVrOFAZYKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMjozMVrOFAZa6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTYwMTA0OnYy", "diffSide": "RIGHT", "path": "searchcore/src/vespa/searchcore/proton/matching/querylimiter.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMToyMVrOH-qy1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMToyMVrOH-qy1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ3NDkwMA==", "bodyText": "I think that it is better to remove volatile instead. It seems all use is while holding a lock.", "url": "https://github.com/vespa-engine/vespa/pull/15647#discussion_r535474900", "createdAt": "2020-12-03T18:21:21Z", "author": {"login": "baldersheim"}, "path": "searchcore/src/vespa/searchcore/proton/matching/querylimiter.cpp", "diffHunk": "@@ -25,14 +25,14 @@ QueryLimiter::grabToken(const Doom & doom)\n             _cond.wait_for(guard, left);\n         }\n     }\n-    _activeThreads++;\n+    _activeThreads = _activeThreads + 1;\n }\n \n void\n QueryLimiter::releaseToken()\n {\n     std::lock_guard<std::mutex> guard(_lock);\n-    _activeThreads--;\n+    _activeThreads = _activeThreads - 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54e2f0d40cad9ee1d442963e4dc765796fbac96b"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTYwNzQzOnYy", "diffSide": "RIGHT", "path": "vespalib/src/tests/array/array_test.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMjoyMlrOH-q2MQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMjoyMlrOH-q2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ3NTc2MQ==", "bodyText": "I think it is better to replace with an atomic instead.", "url": "https://github.com/vespa-engine/vespa/pull/15647#discussion_r535475761", "createdAt": "2020-12-03T18:22:22Z", "author": {"login": "baldersheim"}, "path": "vespalib/src/tests/array/array_test.cpp", "diffHunk": "@@ -27,16 +27,16 @@ std::ostream & operator << (std::ostream & os, const Array<T> & a)\n \n class Clever {\n public:\n-    Clever() : _counter(&_global) { (*_counter)++; }\n+    Clever() : _counter(&_global) { *_counter = *_counter + 1; }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54e2f0d40cad9ee1d442963e4dc765796fbac96b"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTYwODEwOnYy", "diffSide": "RIGHT", "path": "vespalib/src/tests/stllike/hash_test.cpp", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMjozMVrOH-q2oA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMjozMVrOH-q2oA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ3NTg3Mg==", "bodyText": "I think it is better to replace with an atomic instead.", "url": "https://github.com/vespa-engine/vespa/pull/15647#discussion_r535475872", "createdAt": "2020-12-03T18:22:31Z", "author": {"login": "baldersheim"}, "path": "vespalib/src/tests/stllike/hash_test.cpp", "diffHunk": "@@ -171,16 +171,16 @@ TEST(\"test hash map iterator stability\")\n \n class Clever {\n public:\n-    Clever() : _counter(&_global) { (*_counter)++; }\n+    Clever() : _counter(&_global) { *_counter = *_counter + 1; }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54e2f0d40cad9ee1d442963e4dc765796fbac96b"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2118, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}