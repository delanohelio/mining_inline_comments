{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxOTIwMDc2", "number": 13751, "title": "Add filter iterators for weak and blueprints.", "bodyText": "@geirst : please review\n@arnej27959 : FYI", "createdAt": "2020-06-30T10:01:45Z", "url": "https://github.com/vespa-engine/vespa/pull/13751", "merged": true, "mergeCommit": {"oid": "0c0ec3379aa3cc4295bedae70cb51eb362731b6d"}, "closed": true, "closedAt": "2020-06-30T19:06:45Z", "author": {"login": "toregge"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwSpVOgH2gAyNDQxOTIwMDc2OjU4NTI2MjFlMDNiMjZkOWUxMGQxMGE1ZDk0ZTZkOWE1NWYwZTZkNTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwYA0oAFqTQ0MDE3NTY2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5852621e03b26d9e10d10a5d94e6d9a55f0e6d53", "author": {"user": null}, "url": "https://github.com/vespa-engine/vespa/commit/5852621e03b26d9e10d10a5d94e6d9a55f0e6d53", "committedDate": "2020-06-30T09:57:53Z", "message": "Add filter iterators for weak and blueprints."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5OTAxNzQx", "url": "https://github.com/vespa-engine/vespa/pull/13751#pullrequestreview-439901741", "createdAt": "2020-06-30T10:55:53Z", "commit": {"oid": "5852621e03b26d9e10d10a5d94e6d9a55f0e6d53"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45a49659d89d66cbf4fe92c323f446a2160673b8", "author": {"user": null}, "url": "https://github.com/vespa-engine/vespa/commit/45a49659d89d66cbf4fe92c323f446a2160673b8", "committedDate": "2020-06-30T11:17:12Z", "message": "Add filter iterator for weak and blueprint."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5OTM5ODYw", "url": "https://github.com/vespa-engine/vespa/pull/13751#pullrequestreview-439939860", "createdAt": "2020-06-30T11:56:10Z", "commit": {"oid": "45a49659d89d66cbf4fe92c323f446a2160673b8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5OTc4MDgx", "url": "https://github.com/vespa-engine/vespa/pull/13751#pullrequestreview-439978081", "createdAt": "2020-06-30T12:48:23Z", "commit": {"oid": "45a49659d89d66cbf4fe92c323f446a2160673b8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMjo0ODoyM1rOGq6s9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMjo0ODoyM1rOGq6s9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzY1NTE1OQ==", "bodyText": "when constraint is LOWER_BOUND, all WeakAnd variants must create filter as if it's AND.", "url": "https://github.com/vespa-engine/vespa/pull/13751#discussion_r447655159", "createdAt": "2020-06-30T12:48:23Z", "author": {"login": "arnej27959"}, "path": "searchlib/src/vespa/searchlib/attribute/attribute_blueprint_factory.cpp", "diffHunk": "@@ -416,9 +416,21 @@ class DirectWandBlueprint : public queryeval::ComplexLeafBlueprint\n                         .setDocIdLimit(get_docid_limit()),\n                 _weights, _terms, _attr, strict);\n     }\n+    std::unique_ptr<SearchIterator> createFilterSearch(bool strict, FilterConstraint constraint) const override;\n     bool always_needs_unpack() const override { return true; }\n };\n \n+std::unique_ptr<SearchIterator>\n+DirectWandBlueprint::createFilterSearch(bool, FilterConstraint) const\n+{\n+    std::vector<DocumentWeightIterator> iterators;\n+    iterators.reserve(_terms.size());\n+    for (const IDocumentWeightAttribute::LookupResult &r : _terms) {\n+        _attr.create(r.posting_idx, iterators);\n+    }\n+    return attribute::DocumentWeightOrFilterSearch::create(std::move(iterators));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45a49659d89d66cbf4fe92c323f446a2160673b8"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c88dfb03753ea4292a163e249f386ed7e17e2e56", "author": {"user": null}, "url": "https://github.com/vespa-engine/vespa/commit/c88dfb03753ea4292a163e249f386ed7e17e2e56", "committedDate": "2020-06-30T13:50:17Z", "message": "Use empty search when filter constraint is lower bound for wand variants."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMTc1NjYx", "url": "https://github.com/vespa-engine/vespa/pull/13751#pullrequestreview-440175661", "createdAt": "2020-06-30T16:13:04Z", "commit": {"oid": "c88dfb03753ea4292a163e249f386ed7e17e2e56"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3607, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}