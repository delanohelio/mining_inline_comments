{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5OTc1NDYy", "number": 13708, "title": "Copy application package atomically", "bodyText": "Fix bug where we don't do this atomically, looks like this can happend\nwhen application package is copied at the same time as config server is shut down", "createdAt": "2020-06-25T12:04:17Z", "url": "https://github.com/vespa-engine/vespa/pull/13708", "merged": true, "mergeCommit": {"oid": "21b21e029359213038ca4ffbcb17e9687a10c64b"}, "closed": true, "closedAt": "2020-06-26T05:45:02Z", "author": {"login": "hmusum"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcutbVbgH2gAyNDM5OTc1NDYyOmI3MTIzYWFiMjcwNDgwNDkyOGQ5MDUwYTA1ZmViZjk1NTViYjZlMDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuwpjrAFqTQzNzYyNjU0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b7123aab2704804928d9050a05febf9555bb6e05", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/b7123aab2704804928d9050a05febf9555bb6e05", "committedDate": "2020-06-25T12:02:11Z", "message": "Copy application package atomically\n\nFix bug where we don't do this atomically, looks like this can happend\nwhen application package is copied at the same time as config server is shut down"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3NjI2NTQ5", "url": "https://github.com/vespa-engine/vespa/pull/13708#pullrequestreview-437626549", "createdAt": "2020-06-25T15:46:53Z", "commit": {"oid": "b7123aab2704804928d9050a05febf9555bb6e05"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNTo0Njo1M1rOGpAzRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNTo0Njo1M1rOGpAzRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTY1NzkyNA==", "bodyText": "remove 'it'?", "url": "https://github.com/vespa-engine/vespa/pull/13708#discussion_r445657924", "createdAt": "2020-06-25T15:46:53Z", "author": {"login": "gjoranv"}, "path": "configserver/src/main/java/com/yahoo/vespa/config/server/session/SessionRepository.java", "diffHunk": "@@ -515,6 +517,20 @@ private ApplicationPackage createApplicationPackage(File applicationFile, Applic\n         return applicationPackage;\n     }\n \n+    private void copyApp(File sourceDir, File destinationDir) throws IOException {\n+        if (destinationDir.exists())\n+            throw new RuntimeException(\"Destination dir \" + destinationDir + \" already exists\");\n+        if (! sourceDir.isDirectory())\n+            throw new IllegalArgumentException(sourceDir.getAbsolutePath() + \" is not a directory\");\n+\n+        // Copy app it atomically: Copy to default tmp dir and move to destination", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7123aab2704804928d9050a05febf9555bb6e05"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3573, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}