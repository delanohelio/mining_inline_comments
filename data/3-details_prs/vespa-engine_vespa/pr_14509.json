{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkxNzYzMDI0", "number": 14509, "title": "Run some maintainers with higher interval", "bodyText": "When deployments exist on all config servers each server will deploy,\nso do it with 3 times higher interval", "createdAt": "2020-09-23T12:58:05Z", "url": "https://github.com/vespa-engine/vespa/pull/14509", "merged": true, "mergeCommit": {"oid": "29d266ae1e5c95e25002b97822953fdd02b1451e"}, "closed": true, "closedAt": "2020-09-23T15:46:29Z", "author": {"login": "hmusum"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLsJaDAH2gAyNDkxNzYzMDI0OmVmYzYyZWJiNjdhZjU5YWE2NDEwZTk2MDQ5NjE3MjJkN2YwNDk1OGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLtgQpAFqTQ5NDcyNTM5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "efc62ebb67af59aa6410e9604961722d7f04958e", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/efc62ebb67af59aa6410e9604961722d7f04958e", "committedDate": "2020-09-23T12:56:30Z", "message": "Run some maintainers with higher interval\n\nWhen deployments exist on all config servers each server will deploy,\nso do it with 3 times higher interval"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NjcxMDk4", "url": "https://github.com/vespa-engine/vespa/pull/14509#pullrequestreview-494671098", "createdAt": "2020-09-23T13:40:09Z", "commit": {"oid": "efc62ebb67af59aa6410e9604961722d7f04958e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0Njc3ODMx", "url": "https://github.com/vespa-engine/vespa/pull/14509#pullrequestreview-494677831", "createdAt": "2020-09-23T13:46:38Z", "commit": {"oid": "efc62ebb67af59aa6410e9604961722d7f04958e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMzo0NjozOFrOHWvSbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxMzo0NjozOFrOHWvSbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYwNTQ4Nw==", "bodyText": "PeriodicApplicationMaintainer runs every minute (redeployMaintainerInterval), this is the minTimeBetweenRedeployments, so I don't think we should change this.", "url": "https://github.com/vespa-engine/vespa/pull/14509#discussion_r493605487", "createdAt": "2020-09-23T13:46:38Z", "author": {"login": "freva"}, "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/maintenance/NodeRepositoryMaintenance.java", "diffHunk": "@@ -178,14 +180,14 @@ public void deconstruct() {\n             nodeMetricsCollectionInterval = Duration.ofMinutes(1);\n             operatorChangeRedeployInterval = Duration.ofMinutes(1);\n             osUpgradeActivatorInterval = zone.system().isCd() ? Duration.ofSeconds(30) : Duration.ofMinutes(5);\n-            periodicRedeployInterval = Duration.ofMinutes(30);\n+            periodicRedeployInterval = deploymentExistsOnAllConfigServers ? Duration.ofMinutes(90) : Duration.ofMinutes(30);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efc62ebb67af59aa6410e9604961722d7f04958e"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae9af2ba9c3c476ef1e228a0bc36928c013ae3f3", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/ae9af2ba9c3c476ef1e228a0bc36928c013ae3f3", "committedDate": "2020-09-23T14:00:55Z", "message": "Redeploy interval should not change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0Njk5MTE0", "url": "https://github.com/vespa-engine/vespa/pull/14509#pullrequestreview-494699114", "createdAt": "2020-09-23T14:06:28Z", "commit": {"oid": "ae9af2ba9c3c476ef1e228a0bc36928c013ae3f3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNDowNjoyOFrOHWwRKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNDowNjoyOFrOHWwRKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYyMTU0Nw==", "bodyText": "This can also be reduced back now, it does not deploy (assume it was increased because of periodic interval change?)", "url": "https://github.com/vespa-engine/vespa/pull/14509#discussion_r493621547", "createdAt": "2020-09-23T14:06:28Z", "author": {"login": "freva"}, "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/maintenance/NodeRepositoryMaintenance.java", "diffHunk": "@@ -180,12 +181,12 @@ public void deconstruct() {\n             osUpgradeActivatorInterval = zone.system().isCd() ? Duration.ofSeconds(30) : Duration.ofMinutes(5);\n             periodicRedeployInterval = Duration.ofMinutes(30);\n             provisionedExpiry = Duration.ofHours(4);\n-            rebalancerInterval = Duration.ofMinutes(40);\n+            rebalancerInterval = deploymentExistsOnAllConfigServers ? Duration.ofMinutes(120) : Duration.ofMinutes(40);\n             redeployMaintainerInterval = Duration.ofMinutes(1);\n             // Need to be long enough for deployment to be finished for all config model versions\n             // Should be equal to timeout for deployments\n             reservationExpiry = zone.system().isCd() ? Duration.ofMinutes(5) : Duration.ofMinutes(30);\n-            scalingSuggestionsInterval = Duration.ofMinutes(31);\n+            scalingSuggestionsInterval = deploymentExistsOnAllConfigServers ? Duration.ofMinutes(91) : Duration.ofMinutes(31);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae9af2ba9c3c476ef1e228a0bc36928c013ae3f3"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "135ac2fce54089d30ef1328efeea80ba87123627", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/135ac2fce54089d30ef1328efeea80ba87123627", "committedDate": "2020-09-23T14:14:41Z", "message": "No need for different intervals, maintainer does not deploy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NzEzNTU3", "url": "https://github.com/vespa-engine/vespa/pull/14509#pullrequestreview-494713557", "createdAt": "2020-09-23T14:20:23Z", "commit": {"oid": "135ac2fce54089d30ef1328efeea80ba87123627"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94b206e75e62b6e0878f66b5a4f1f071c187ff73", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/94b206e75e62b6e0878f66b5a4f1f071c187ff73", "committedDate": "2020-09-23T14:25:03Z", "message": "Run some more maintainers with higher interval"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NzI1Mzk3", "url": "https://github.com/vespa-engine/vespa/pull/14509#pullrequestreview-494725397", "createdAt": "2020-09-23T14:31:22Z", "commit": {"oid": "94b206e75e62b6e0878f66b5a4f1f071c187ff73"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4182, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}