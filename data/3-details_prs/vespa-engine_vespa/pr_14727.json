{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3ODUwNTUy", "number": 14727, "title": "Log at lower level when moving file and file already exists", "bodyText": "No need to log at info level, this is not a filure and will happen\noccasionally. Also minor change so that we log if deleting a file\nfails.", "createdAt": "2020-10-05T13:21:31Z", "url": "https://github.com/vespa-engine/vespa/pull/14727", "merged": true, "mergeCommit": {"oid": "a9cb95fc8f3af354c0378333a65dafeddd39c90b"}, "closed": true, "closedAt": "2020-10-05T14:38:18Z", "author": {"login": "hmusum"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPjrAWgH2gAyNDk3ODUwNTUyOjQ2YzY3YmI3ODIwOWFkZDE1ODZiNDg4ZGEwNDFhOGY3NjI5MjZjNWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPjyxbAFqTUwMjA1NDMyMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "46c67bb78209add1586b488da041a8f762926c5a", "author": {"user": {"login": "hmusum", "name": "Harald Musum"}}, "url": "https://github.com/vespa-engine/vespa/commit/46c67bb78209add1586b488da041a8f762926c5a", "committedDate": "2020-10-05T13:19:45Z", "message": "Log at lower level when moving file and file already exists\n\nNo need to log at info level, this is not a filure and will happen\noccasionally. Also minor change so that we log if deleting a file\nfails."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMDU0MzIy", "url": "https://github.com/vespa-engine/vespa/pull/14727#pullrequestreview-502054322", "createdAt": "2020-10-05T13:27:30Z", "commit": {"oid": "46c67bb78209add1586b488da041a8f762926c5a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzoyNzozMVrOHcdA3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzoyNzozMVrOHcdA3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU5NzUzMw==", "bodyText": "Consider catching the particular subclass of IOException thrown when the file already exists (FileAlreadyExistsException?), and only try deletion etc then.", "url": "https://github.com/vespa-engine/vespa/pull/14727#discussion_r499597533", "createdAt": "2020-10-05T13:27:31Z", "author": {"login": "hakonhall"}, "path": "filedistribution/src/main/java/com/yahoo/vespa/filedistribution/FileReceiver.java", "diffHunk": "@@ -96,9 +96,12 @@ void addPart(int partId, byte [] part) {\n             try {\n                 Files.write(inprogressFile.toPath(), part, StandardOpenOption.WRITE, StandardOpenOption.APPEND);\n             } catch (IOException e) {\n-                log.log(Level.SEVERE, \"Failed writing to file (\" + inprogressFile.toPath() + \"): \" + e.getMessage(), e);\n-                inprogressFile.delete();\n-                throw new RuntimeException(\"Failed writing to file (\" + inprogressFile.toPath() + \"): \", e);\n+                String message = \"Failed writing to file (\" + inprogressFile.toPath() + \"): \";\n+                log.log(Level.SEVERE, message + e.getMessage(), e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46c67bb78209add1586b488da041a8f762926c5a"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2438, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}