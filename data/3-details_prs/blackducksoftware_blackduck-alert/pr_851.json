{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0MjkxNzM1", "number": 851, "title": "Ps properties factory", "bodyText": "Unit tests fail.  This is the first step in decoupling BlackDuckProperties as a component from objects.  The code compiles and runServer will start up alert.  More work is needed to further decouple provider properties in order to add multiple providers.", "createdAt": "2020-02-12T12:53:11Z", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851", "merged": true, "mergeCommit": {"oid": "a3b2da980e24fc6689f0565887e720a8abf0bb77"}, "closed": true, "closedAt": "2020-02-12T15:34:54Z", "author": {"login": "psantos1113"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDYTalgH2gAyMzc0MjkxNzM1OjQ5NjE0NWI5MjhiMTUyMzJmMmFkNTcwMTE2ZDM1OWZkMmY3ZmNhNTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDoGR5gH2gAyMzc0MjkxNzM1OjgzODMzN2VjMmNiOGQ3ZTNiZDcxZmVlYmU0OWFlZjEzNWJlYzVkMWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "496145b928b15232f2ad570116d359fd2f7fca53", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/496145b928b15232f2ad570116d359fd2f7fca53", "committedDate": "2020-02-11T21:06:47Z", "message": "feat(provider): Implement BlackDuckProperties creation via a factory."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/715d74441c355d86ae123e2aff969937a2eee993", "committedDate": "2020-02-12T12:50:50Z", "message": "refactor(provider): Decouple BlackDuckProperties from components."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDYxODc2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357461876", "createdAt": "2020-02-12T13:46:39Z", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0NjozOVrOFovGKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0NjozOVrOFovGKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI1ODk4NQ==", "bodyText": "Might want to add a TODO here.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378258985", "createdAt": "2020-02-12T13:46:39Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/workflow/processor/NotificationProcessor.java", "diffHunk": "@@ -82,7 +84,9 @@ public NotificationProcessor(ConfigurationAccessor configurationAccessor, List<P\n         }\n \n         Provider provider = providerKeyToProvider.get(job.getProviderName());\n-        ProviderDistributionFilter distributionFilter = provider.createDistributionFilter();\n+        ConfigurationModel providerConfig = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDYzNDEy", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357463412", "createdAt": "2020-02-12T13:48:37Z", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0ODozN1rOFovKoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0ODozN1rOFovKoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI2MDEyOA==", "bodyText": "I think we can get away without this. The implementing class should be able to specify the correct type.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378260128", "createdAt": "2020-02-12T13:48:37Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/provider/Provider.java", "diffHunk": "@@ -24,12 +24,13 @@\n \n import java.util.List;\n \n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n import com.synopsys.integration.alert.common.provider.lifecycle.ProviderTask;\n import com.synopsys.integration.alert.common.provider.notification.ProviderDistributionFilter;\n import com.synopsys.integration.alert.common.provider.notification.ProviderNotificationClassMap;\n import com.synopsys.integration.alert.common.workflow.processor.ProviderMessageContentCollector;\n \n-public abstract class Provider {\n+public abstract class Provider<T extends ProviderProperties> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDY0MzA2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357464306", "createdAt": "2020-02-12T13:49:46Z", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0OTo0NlrOFovNPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0OTo0NlrOFovNPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI2MDc5Ng==", "bodyText": "Should we add a TODO here?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378260796", "createdAt": "2020-02-12T13:49:46Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java", "diffHunk": "@@ -43,15 +41,13 @@\n import com.synopsys.integration.log.IntLogger;\n import com.synopsys.integration.log.Slf4jIntLogger;\n \n-@Component\n public class BlackDuckValidator extends ProviderValidator {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDY1MzIy", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357465322", "createdAt": "2020-02-12T13:51:07Z", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1MTowN1rOFovQOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1MTowN1rOFovQOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI2MTU2MA==", "bodyText": "Should the validate() method take a properties object rather than having a factory for it?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378261560", "createdAt": "2020-02-12T13:51:07Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckValidator.java", "diffHunk": "@@ -43,15 +41,13 @@\n import com.synopsys.integration.log.IntLogger;\n import com.synopsys.integration.log.Slf4jIntLogger;\n \n-@Component\n public class BlackDuckValidator extends ProviderValidator {\n     private static final Logger logger = LoggerFactory.getLogger(BlackDuckValidator.class);\n \n     private final AlertProperties alertProperties;\n     private final BlackDuckProperties blackDuckProperties;\n     private final SystemMessageUtility systemMessageUtility;\n \n-    @Autowired\n     public BlackDuckValidator(AlertProperties alertProperties, BlackDuckProperties blackDuckProperties, SystemMessageUtility systemMessageUtility) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDY2Mjkw", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357466290", "createdAt": "2020-02-12T13:52:27Z", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1MjoyN1rOFovTHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1MjoyN1rOFovTHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI2MjMwMQ==", "bodyText": "Should we also have a createProperties(...) method that takes a ConfigurationModel?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378262301", "createdAt": "2020-02-12T13:52:27Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/factories/BlackDuckPropertiesFactory.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/**\n+ * blackduck-alert\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.provider.blackduck.factories;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.google.gson.Gson;\n+import com.synopsys.integration.alert.common.AlertProperties;\n+import com.synopsys.integration.alert.common.persistence.accessor.FieldAccessor;\n+import com.synopsys.integration.alert.common.provider.lifecycle.ProviderPropertiesFactory;\n+import com.synopsys.integration.alert.common.rest.ProxyManager;\n+import com.synopsys.integration.alert.provider.blackduck.BlackDuckProperties;\n+\n+@Component\n+public class BlackDuckPropertiesFactory extends ProviderPropertiesFactory<BlackDuckProperties> {\n+    private final Gson gson;\n+    private final AlertProperties alertProperties;\n+    private final ProxyManager proxyManager;\n+\n+    @Autowired\n+    public BlackDuckPropertiesFactory(Gson gson, AlertProperties alertProperties, ProxyManager proxyManager) {\n+        this.gson = gson;\n+        this.alertProperties = alertProperties;\n+        this.proxyManager = proxyManager;\n+    }\n+\n+    @Override\n+    public BlackDuckProperties createProperties(Long configId, FieldAccessor fieldAccessor) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDY2NzY1", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357466765", "createdAt": "2020-02-12T13:53:04Z", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1MzowNFrOFovUnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1MzowNFrOFovUnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI2MjY4Nw==", "bodyText": "Can we put a TODO here to revisit this approach once we have everything else working?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378262687", "createdAt": "2020-02-12T13:53:04Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/factories/BlackDuckValidatorFactory.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/**\n+ * blackduck-alert\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.provider.blackduck.factories;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.AlertProperties;\n+import com.synopsys.integration.alert.common.persistence.accessor.SystemMessageUtility;\n+import com.synopsys.integration.alert.provider.blackduck.BlackDuckProperties;\n+import com.synopsys.integration.alert.provider.blackduck.BlackDuckValidator;\n+\n+@Component\n+public class BlackDuckValidatorFactory {\n+    private final AlertProperties alertProperties;\n+    private final SystemMessageUtility systemMessageUtility;\n+\n+    @Autowired\n+    public BlackDuckValidatorFactory(AlertProperties alertProperties, SystemMessageUtility systemMessageUtility) {\n+        this.alertProperties = alertProperties;\n+        this.systemMessageUtility = systemMessageUtility;\n+    }\n+\n+    public BlackDuckValidator createValidator(BlackDuckProperties properties) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDY4MjMz", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357468233", "createdAt": "2020-02-12T13:55:00Z", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1NTowMFrOFovZNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1NTowMFrOFovZNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI2Mzg2MQ==", "bodyText": "Can we Autowire the BlackDuckPropertiesFactory?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378263861", "createdAt": "2020-02-12T13:55:00Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/web/PolicyNotificationFilterCustomEndpoint.java", "diffHunk": "@@ -97,6 +96,8 @@ private boolean isFilterablePolicy(Collection<String> notificationTypes) {\n     }\n \n     private List<NotificationFilterModel> retrieveBlackDuckPolicyOptions() throws IntegrationException {\n+        //FIXME have to figure out how to create the properties for this endpoint.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NDY4ODg1", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357468885", "createdAt": "2020-02-12T13:55:53Z", "commit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1NTo1NFrOFovbfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo1NTo1NFrOFovbfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI2NDQ0NQ==", "bodyText": "Add a FIXME here.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378264445", "createdAt": "2020-02-12T13:55:54Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "diffHunk": "@@ -198,6 +197,7 @@ private PhoneHomeRequestBody addBDDataAndBuild(PhoneHomeRequestBody.Builder phon\n         String blackDuckUrl = PhoneHomeRequestBody.Builder.UNKNOWN_ID;\n         String blackDuckVersion = PhoneHomeRequestBody.Builder.UNKNOWN_ID;\n         try {\n+            BlackDuckProperties blackDuckProperties = new BlackDuckProperties(null, null, null, null, new FieldAccessor(Map.of()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "715d74441c355d86ae123e2aff969937a2eee993"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "317a4874e695b02a5b806e6adf55a615554f09ce", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/317a4874e695b02a5b806e6adf55a615554f09ce", "committedDate": "2020-02-12T15:10:51Z", "message": "refactor(provider): Implement PR feedback."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NTMzNDEx", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#pullrequestreview-357533411", "createdAt": "2020-02-12T15:13:50Z", "commit": {"oid": "317a4874e695b02a5b806e6adf55a615554f09ce"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxNToxMzo1MVrOFoyeIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxNToxMzo1MVrOFoyeIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODMxNDI3Mg==", "bodyText": "I'm not 100% sure that we need a generic here.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/851#discussion_r378314272", "createdAt": "2020-02-12T15:13:51Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/provider/ProviderValidator.java", "diffHunk": "@@ -22,7 +22,7 @@\n  */\n package com.synopsys.integration.alert.common.provider;\n \n-public abstract class ProviderValidator {\n+public abstract class ProviderValidator<T extends ProviderProperties> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "317a4874e695b02a5b806e6adf55a615554f09ce"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "838337ec2cb8d7e3bd71feebe49aef135bec5d1f", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/838337ec2cb8d7e3bd71feebe49aef135bec5d1f", "committedDate": "2020-02-12T15:30:55Z", "message": "Merge remote-tracking branch 'origin/feat_provider_lifecycle_management' into ps_properties_factory"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2805, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}