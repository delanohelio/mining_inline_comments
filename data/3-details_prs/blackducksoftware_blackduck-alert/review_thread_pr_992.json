{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzMzg0ODQw", "number": 992, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNjo0ODo1MlrOEA9tcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNTo1MzowOVrOEBay-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NDQ2NTE0OnYy", "diffSide": "RIGHT", "path": "buildSrc/docker.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNjo0ODo1MlrOGckaNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNTo1MjowMFrOGdQHfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYwOTg0Nw==", "bodyText": "Should this task be in the main gradle file since it is calling tasks from other gradle files?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/992#discussion_r432609847", "createdAt": "2020-05-29T16:48:52Z", "author": {"login": "psantos1113"}, "path": "buildSrc/docker.gradle", "diffHunk": "@@ -0,0 +1,55 @@\n+buildscript {\n+    repositories {\n+        mavenCentral()\n+    }\n+\n+    dependencies {\n+        classpath 'com.bmuschko:gradle-docker-plugin:6.4.0'\n+    }\n+}\n+\n+apply plugin: com.bmuschko.gradle.docker.DockerRemoteApiPlugin\n+\n+apply from: 'buildSrc/deploymentTasks.gradle'\n+\n+import com.bmuschko.gradle.docker.tasks.image.DockerBuildImage\n+\n+task untarArchiveForDocker(type: Copy, dependsOn: [build]) {\n+    from tarTree(\"${project.buildDir}/distributions/blackduck-alert-boot-${project.version}.tar\")\n+    into \"${project.buildDir}/docker\"\n+}\n+\n+task stageDocker(type: Copy, dependsOn: [untarArchiveForDocker]) {\n+    into \"${project.buildDir}/docker\"\n+    from(\"${project.projectDir}\") {\n+        include 'Dockerfile'\n+        include 'docker-entrypoint.sh'\n+    }\n+    from(\"${project.buildDir}/distributions\") {\n+        include \"blackduck-alert-boot-${project.version}.tar\"\n+    }\n+}\n+\n+task buildDockerImage(type: DockerBuildImage, dependsOn: [stageDocker]) {\n+    inputDir = file(\"${project.buildDir}/docker\")\n+    buildArgs = ['VERSION': \"${project.version}\"]\n+    images.add(\"blackducksoftware/${project.name}:${project.version}\")\n+}\n+\n+task dockerLogin(type: Exec) {\n+    commandLine \"docker\", \"login\", \"--username\", \"$System.env.DOCKER_INT_BLACKDUCK_USER\", \"--password\", \"$System.env.DOCKER_INT_BLACKDUCK_PASSWORD\"\n+}\n+\n+task pushImage(type: Exec, dependsOn: [buildDockerImage]) {\n+    commandLine \"docker\", \"push\", \"blackducksoftware/${project.name}:${project.version}\"\n+}\n+\n+task all(dependsOn: [build, helmValidation, createDeploymentZip, dockerLogin, buildDockerImage, pushImage]) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f4acae58247de8c7982ad05f198c2f0975fd9c1"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMyNTk1MA==", "bodyText": "Good suggestion! That also removed the inter-dependencies of the task files.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/992#discussion_r433325950", "createdAt": "2020-06-01T15:52:00Z", "author": {"login": "jamesrichard91"}, "path": "buildSrc/docker.gradle", "diffHunk": "@@ -0,0 +1,55 @@\n+buildscript {\n+    repositories {\n+        mavenCentral()\n+    }\n+\n+    dependencies {\n+        classpath 'com.bmuschko:gradle-docker-plugin:6.4.0'\n+    }\n+}\n+\n+apply plugin: com.bmuschko.gradle.docker.DockerRemoteApiPlugin\n+\n+apply from: 'buildSrc/deploymentTasks.gradle'\n+\n+import com.bmuschko.gradle.docker.tasks.image.DockerBuildImage\n+\n+task untarArchiveForDocker(type: Copy, dependsOn: [build]) {\n+    from tarTree(\"${project.buildDir}/distributions/blackduck-alert-boot-${project.version}.tar\")\n+    into \"${project.buildDir}/docker\"\n+}\n+\n+task stageDocker(type: Copy, dependsOn: [untarArchiveForDocker]) {\n+    into \"${project.buildDir}/docker\"\n+    from(\"${project.projectDir}\") {\n+        include 'Dockerfile'\n+        include 'docker-entrypoint.sh'\n+    }\n+    from(\"${project.buildDir}/distributions\") {\n+        include \"blackduck-alert-boot-${project.version}.tar\"\n+    }\n+}\n+\n+task buildDockerImage(type: DockerBuildImage, dependsOn: [stageDocker]) {\n+    inputDir = file(\"${project.buildDir}/docker\")\n+    buildArgs = ['VERSION': \"${project.version}\"]\n+    images.add(\"blackducksoftware/${project.name}:${project.version}\")\n+}\n+\n+task dockerLogin(type: Exec) {\n+    commandLine \"docker\", \"login\", \"--username\", \"$System.env.DOCKER_INT_BLACKDUCK_USER\", \"--password\", \"$System.env.DOCKER_INT_BLACKDUCK_PASSWORD\"\n+}\n+\n+task pushImage(type: Exec, dependsOn: [buildDockerImage]) {\n+    commandLine \"docker\", \"push\", \"blackducksoftware/${project.name}:${project.version}\"\n+}\n+\n+task all(dependsOn: [build, helmValidation, createDeploymentZip, dockerLogin, buildDockerImage, pushImage]) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYwOTg0Nw=="}, "originalCommit": {"oid": "3f4acae58247de8c7982ad05f198c2f0975fd9c1"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5OTIzMDY1OnYy", "diffSide": "RIGHT", "path": "build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNTo1MzowOVrOGdQLhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNTo1MzowOVrOGdQLhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMyNjk4MA==", "bodyText": "Let's move this comment down to the line declaring the tags.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/992#discussion_r433326980", "createdAt": "2020-06-01T15:53:09Z", "author": {"login": "gkillough"}, "path": "build.gradle", "diffHunk": "@@ -22,21 +22,28 @@ plugins {\n }\n \n // Copied from src/test/java - com.synopsys.integration.alert.TestTags", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "929a11b7e395c5c7752d1dc11aac0d5945ea0139"}, "originalPosition": 3}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2029, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}