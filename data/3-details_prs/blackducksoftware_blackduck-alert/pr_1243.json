{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2MzQyOTE3", "number": 1243, "title": "Refactoring of AuthorizationManager", "bodyText": "Refactoring of AuthorizationManager\nLink to github issue (if applicable):\n\nIALERT-1943\n\nIf nothing above, what is your reason for this pull request:\n\nAuthorizationManager currently only accepts a ConfigContextEnum and DescriptorKey in the form of String. This leads to calling ConfigContextEnum::name and DescriptorKey::getUniversalKey in many places.\n\nChanges proposed in this pull request:\n\nAllow AuthorizationManager to accept ConfigContextEnum and DescriptorKey objects.\nMethods in AuthorizationManager that still accept a String are deprecated.", "createdAt": "2020-11-05T21:11:11Z", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243", "merged": true, "mergeCommit": {"oid": "bf0903b00ea78988f4b0586acf713059b223fa3d"}, "closed": true, "closedAt": "2020-11-09T17:54:36Z", "author": {"login": "JakeMathews"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZo0uWAH2gAyNTE2MzQyOTE3OmZjMzlhMzUzYmFjNTBmNzNiZWQxNTE4YWU2NzIwOTg3ZDdmOTM2ZWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABda4d7DAH2gAyNTE2MzQyOTE3OjgyYTM3NWI1NWZlN2Y4MTM1NTYzYzM5MGUyYjJlZjVkY2I3NDBmZTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea", "author": {"user": {"login": "JakeMathews", "name": "Jake Mathews"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/fc39a353bac50f73bed1518ae6720987d7f936ea", "committedDate": "2020-11-05T20:59:08Z", "message": "refactor(AuthorizationManager): Refactored AuthorizationManager to accept DescriptorKey and a ConfigContextEnum objects."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0Njc2Njg0", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-524676684", "createdAt": "2020-11-05T21:14:00Z", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMToxNDowMFrOHuWrEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMToxNDowMFrOHuWrEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM2ODAxNg==", "bodyText": "We cannot use Mockito .any() here because it clashes with the deprecated String version of the method.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#discussion_r518368016", "createdAt": "2020-11-05T21:14:00Z", "author": {"login": "JakeMathews"}, "path": "component/src/test/java/com/synopsys/integration/alert/component/authentication/web/SamlMetadataFileUploadTest.java", "diffHunk": "@@ -51,7 +53,7 @@ public void cleanResource() throws Exception {\n     @Test\n     public void performUpload() {\n         SamlMetaDataFileUpload action = new SamlMetaDataFileUpload(descriptorKey, authorizationManager, filePersistenceUtil);\n-        Mockito.when(authorizationManager.hasUploadWritePermission(Mockito.anyString(), Mockito.anyString())).thenReturn(Boolean.TRUE);\n+        Mockito.when(authorizationManager.hasUploadWritePermission(Mockito.any(ConfigContextEnum.class), Mockito.any(DescriptorKey.class))).thenReturn(Boolean.TRUE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0Njc4MzYx", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-524678361", "createdAt": "2020-11-05T21:15:36Z", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMToxNTozNlrOHuWxMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMToxNTozNlrOHuWxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM2OTU4Nw==", "bodyText": "I added mocks for both methods here since the class being tested could call the deprecated methods. I was thinking of changing the mock to throw an exception when the deprecated methods are called. Thoughts?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#discussion_r518369587", "createdAt": "2020-11-05T21:15:36Z", "author": {"login": "JakeMathews"}, "path": "src/test/java/com/synopsys/integration/alert/component/users/web/role/RoleActionsTest.java", "diffHunk": "@@ -44,11 +45,17 @@ public void init() {\n         roleAccessor = Mockito.mock(RoleAccessor.class);\n         descriptorKey = createDescriptorKey(\"descriptorKey-test\");\n \n-        Mockito.when(authorizationManager.hasCreatePermission(Mockito.any(), Mockito.any())).thenReturn(true);\n-        Mockito.when(authorizationManager.hasReadPermission(Mockito.any(), Mockito.any())).thenReturn(true);\n-        Mockito.when(authorizationManager.hasDeletePermission(Mockito.any(), Mockito.any())).thenReturn(true);\n-        Mockito.when(authorizationManager.hasExecutePermission(Mockito.any(), Mockito.any())).thenReturn(true);\n-        Mockito.when(authorizationManager.hasWritePermission(Mockito.any(), Mockito.any())).thenReturn(true);\n+        Mockito.when(authorizationManager.hasCreatePermission(Mockito.any(ConfigContextEnum.class), Mockito.any(DescriptorKey.class))).thenReturn(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NjgxNjMz", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-524681633", "createdAt": "2020-11-05T21:20:44Z", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMToyMDo0NVrOHuXHhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQyMToyMDo0NVrOHuXHhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODM3NTMwMA==", "bodyText": "Some FieldModels are built using the ConfigContextEnum and DescriptorKey classes, but other FieldModel instantiations are from String sources. I can go through and attempt to convert most FieldModel instantiations to use ConfigContextEnum and DescriptorKey classes, but would need some help in the tricky spots.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#discussion_r518375300", "createdAt": "2020-11-05T21:20:45Z", "author": {"login": "JakeMathews"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/rest/model/FieldModel.java", "diffHunk": "@@ -30,6 +30,7 @@\n \n public class FieldModel extends Config {\n     private Map<String, FieldValueModel> keyToValues;\n+    // TODO DescriptorKey and a ConfigContextEnum should be available instead of Strings", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MTMzMTEx", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-525133111", "createdAt": "2020-11-06T13:08:04Z", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MTcyNTIx", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-525172521", "createdAt": "2020-11-06T14:00:41Z", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MjIzMTQ1", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-525223145", "createdAt": "2020-11-06T14:51:25Z", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MjU0Mzk4", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-525254398", "createdAt": "2020-11-06T15:25:12Z", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1NDMxMDc0", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-525431074", "createdAt": "2020-11-06T19:25:08Z", "commit": {"oid": "fc39a353bac50f73bed1518ae6720987d7f936ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0e266505ad5f958d748aadd0d95dbd884a5174a", "author": {"user": {"login": "JakeMathews", "name": "Jake Mathews"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a0e266505ad5f958d748aadd0d95dbd884a5174a", "committedDate": "2020-11-06T19:26:01Z", "message": "Merge branch 'master' into authorization-manager-refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "912e166c788b4f00a9f23f5401a8a9cd4fe3d9f0", "author": {"user": {"login": "JakeMathews", "name": "Jake Mathews"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/912e166c788b4f00a9f23f5401a8a9cd4fe3d9f0", "committedDate": "2020-11-09T17:37:31Z", "message": "refactor(deprecations): Removed more usages of deprecated methods."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60909d2bf01c0b6dabe651753246feac59fd9f6c", "author": {"user": {"login": "JakeMathews", "name": "Jake Mathews"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/60909d2bf01c0b6dabe651753246feac59fd9f6c", "committedDate": "2020-11-09T17:38:00Z", "message": "test-fix(deprecations): Fixed broken tests from refactor."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f8558e77cbba2bd0d4ca4329cbe2afea96a2054", "author": {"user": {"login": "JakeMathews", "name": "Jake Mathews"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/7f8558e77cbba2bd0d4ca4329cbe2afea96a2054", "committedDate": "2020-11-09T17:38:15Z", "message": "Merge branch 'master' into authorization-manager-refactor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2NDk3MTA1", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1243#pullrequestreview-526497105", "createdAt": "2020-11-09T17:39:40Z", "commit": {"oid": "7f8558e77cbba2bd0d4ca4329cbe2afea96a2054"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82a375b55fe7f8135563c390e2b2ef5dcb740fe0", "author": {"user": {"login": "JakeMathews", "name": "Jake Mathews"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/82a375b55fe7f8135563c390e2b2ef5dcb740fe0", "committedDate": "2020-11-09T17:46:38Z", "message": "fix(imports): Fixed broken imports from merge with master."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3052, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}