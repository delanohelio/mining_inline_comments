{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyMDA4MTYz", "number": 1285, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODo1Njo0NlrOFAaRng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozNTo1OFrOFAbe_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTc0ODE0OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODo1Njo0NlrOH-sMAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOToxNjoxMFrOH-s_xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ5NzczMQ==", "bodyText": "I was unsure if this is still necessary.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1285#discussion_r535497731", "createdAt": "2020-12-03T18:56:46Z", "author": {"login": "JakeMathews"}, "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "diffHunk": "@@ -182,26 +181,24 @@ private PhoneHomeService createPhoneHomeService(ExecutorService phoneHomeExecuto\n         return channelMetadata.toArray(String[]::new);\n     }\n \n-    private Set<String> retrieveChannelMetadataForJobs(List<ConfigurationJobModel> jobs) {\n+    private Set<String> retrieveChannelMetadataForJobs(List<DistributionJobModel> jobs) {\n         Map<String, Integer> createdDistributions = new HashMap<>();\n         String successKeyPart = \"::Successes\";\n-        for (ConfigurationJobModel job : jobs) {\n-            for (ConfigurationModel configuration : job.getCopyOfConfigurations()) {\n-                String channelName = configuration.getField(ChannelDistributionUIConfig.KEY_CHANNEL_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-                String providerName = configuration.getField(ChannelDistributionUIConfig.KEY_PROVIDER_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-\n-                if (StringUtils.isBlank(channelName) || StringUtils.isBlank(providerName)) {\n-                    // We want to specifically get the channel configuration here and the only way to determine that is if it has these fields.\n-                    continue;\n-                }\n+        for (DistributionJobModel job : jobs) {\n+            String channelName = job.getChannelDescriptorName();\n+            String providerName = new BlackDuckProviderKey().getUniversalKey();\n+\n+            if (StringUtils.isBlank(channelName)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7aceceb1a4af10f207c6da35000aecca659fa697"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUxMDk4Mw==", "bodyText": "The database does not allow null values for the channel descriptor name, so I'm inclined to think that this being blank would be a bug (if we are correctly validating the data that gets saved). So I think this can be removed.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1285#discussion_r535510983", "createdAt": "2020-12-03T19:16:10Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "diffHunk": "@@ -182,26 +181,24 @@ private PhoneHomeService createPhoneHomeService(ExecutorService phoneHomeExecuto\n         return channelMetadata.toArray(String[]::new);\n     }\n \n-    private Set<String> retrieveChannelMetadataForJobs(List<ConfigurationJobModel> jobs) {\n+    private Set<String> retrieveChannelMetadataForJobs(List<DistributionJobModel> jobs) {\n         Map<String, Integer> createdDistributions = new HashMap<>();\n         String successKeyPart = \"::Successes\";\n-        for (ConfigurationJobModel job : jobs) {\n-            for (ConfigurationModel configuration : job.getCopyOfConfigurations()) {\n-                String channelName = configuration.getField(ChannelDistributionUIConfig.KEY_CHANNEL_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-                String providerName = configuration.getField(ChannelDistributionUIConfig.KEY_PROVIDER_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-\n-                if (StringUtils.isBlank(channelName) || StringUtils.isBlank(providerName)) {\n-                    // We want to specifically get the channel configuration here and the only way to determine that is if it has these fields.\n-                    continue;\n-                }\n+        for (DistributionJobModel job : jobs) {\n+            String channelName = job.getChannelDescriptorName();\n+            String providerName = new BlackDuckProviderKey().getUniversalKey();\n+\n+            if (StringUtils.isBlank(channelName)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ5NzczMQ=="}, "originalCommit": {"oid": "7aceceb1a4af10f207c6da35000aecca659fa697"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTgzOTUxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOToxODowOFrOH-tEdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozNTowMlrOH-t_Pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUxMjE4MQ==", "bodyText": "Since this class is a component, you can autowire BlackDuckProviderKey.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1285#discussion_r535512181", "createdAt": "2020-12-03T19:18:08Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "diffHunk": "@@ -182,26 +181,24 @@ private PhoneHomeService createPhoneHomeService(ExecutorService phoneHomeExecuto\n         return channelMetadata.toArray(String[]::new);\n     }\n \n-    private Set<String> retrieveChannelMetadataForJobs(List<ConfigurationJobModel> jobs) {\n+    private Set<String> retrieveChannelMetadataForJobs(List<DistributionJobModel> jobs) {\n         Map<String, Integer> createdDistributions = new HashMap<>();\n         String successKeyPart = \"::Successes\";\n-        for (ConfigurationJobModel job : jobs) {\n-            for (ConfigurationModel configuration : job.getCopyOfConfigurations()) {\n-                String channelName = configuration.getField(ChannelDistributionUIConfig.KEY_CHANNEL_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-                String providerName = configuration.getField(ChannelDistributionUIConfig.KEY_PROVIDER_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-\n-                if (StringUtils.isBlank(channelName) || StringUtils.isBlank(providerName)) {\n-                    // We want to specifically get the channel configuration here and the only way to determine that is if it has these fields.\n-                    continue;\n-                }\n+        for (DistributionJobModel job : jobs) {\n+            String channelName = job.getChannelDescriptorName();\n+            String providerName = new BlackDuckProviderKey().getUniversalKey();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7aceceb1a4af10f207c6da35000aecca659fa697"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyMDkwMA==", "bodyText": "I went vague an autowired a ProviderKey if that's alright.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1285#discussion_r535520900", "createdAt": "2020-12-03T19:28:11Z", "author": {"login": "JakeMathews"}, "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "diffHunk": "@@ -182,26 +181,24 @@ private PhoneHomeService createPhoneHomeService(ExecutorService phoneHomeExecuto\n         return channelMetadata.toArray(String[]::new);\n     }\n \n-    private Set<String> retrieveChannelMetadataForJobs(List<ConfigurationJobModel> jobs) {\n+    private Set<String> retrieveChannelMetadataForJobs(List<DistributionJobModel> jobs) {\n         Map<String, Integer> createdDistributions = new HashMap<>();\n         String successKeyPart = \"::Successes\";\n-        for (ConfigurationJobModel job : jobs) {\n-            for (ConfigurationModel configuration : job.getCopyOfConfigurations()) {\n-                String channelName = configuration.getField(ChannelDistributionUIConfig.KEY_CHANNEL_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-                String providerName = configuration.getField(ChannelDistributionUIConfig.KEY_PROVIDER_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-\n-                if (StringUtils.isBlank(channelName) || StringUtils.isBlank(providerName)) {\n-                    // We want to specifically get the channel configuration here and the only way to determine that is if it has these fields.\n-                    continue;\n-                }\n+        for (DistributionJobModel job : jobs) {\n+            String channelName = job.getChannelDescriptorName();\n+            String providerName = new BlackDuckProviderKey().getUniversalKey();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUxMjE4MQ=="}, "originalCommit": {"oid": "7aceceb1a4af10f207c6da35000aecca659fa697"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyNzIzMQ==", "bodyText": "Yeah, that's fine. If we ever do need to refactor to multiple providers, it will be with ProviderKey.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1285#discussion_r535527231", "createdAt": "2020-12-03T19:35:02Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "diffHunk": "@@ -182,26 +181,24 @@ private PhoneHomeService createPhoneHomeService(ExecutorService phoneHomeExecuto\n         return channelMetadata.toArray(String[]::new);\n     }\n \n-    private Set<String> retrieveChannelMetadataForJobs(List<ConfigurationJobModel> jobs) {\n+    private Set<String> retrieveChannelMetadataForJobs(List<DistributionJobModel> jobs) {\n         Map<String, Integer> createdDistributions = new HashMap<>();\n         String successKeyPart = \"::Successes\";\n-        for (ConfigurationJobModel job : jobs) {\n-            for (ConfigurationModel configuration : job.getCopyOfConfigurations()) {\n-                String channelName = configuration.getField(ChannelDistributionUIConfig.KEY_CHANNEL_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-                String providerName = configuration.getField(ChannelDistributionUIConfig.KEY_PROVIDER_NAME).flatMap(ConfigurationFieldModel::getFieldValue).orElse(\"\");\n-\n-                if (StringUtils.isBlank(channelName) || StringUtils.isBlank(providerName)) {\n-                    // We want to specifically get the channel configuration here and the only way to determine that is if it has these fields.\n-                    continue;\n-                }\n+        for (DistributionJobModel job : jobs) {\n+            String channelName = job.getChannelDescriptorName();\n+            String providerName = new BlackDuckProviderKey().getUniversalKey();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUxMjE4MQ=="}, "originalCommit": {"oid": "7aceceb1a4af10f207c6da35000aecca659fa697"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTk0NjIzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozNTo1OFrOH-uCoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozNTo1OFrOH-uCoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyODA5Nw==", "bodyText": "While you're in here, can you make this a constant?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1285#discussion_r535528097", "createdAt": "2020-12-03T19:35:58Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/workflow/scheduled/PhoneHomeTask.java", "diffHunk": "@@ -182,26 +182,19 @@ private PhoneHomeService createPhoneHomeService(ExecutorService phoneHomeExecuto\n         return channelMetadata.toArray(String[]::new);\n     }\n \n-    private Set<String> retrieveChannelMetadataForJobs(List<ConfigurationJobModel> jobs) {\n+    private Set<String> retrieveChannelMetadataForJobs(List<DistributionJobModel> jobs) {\n         Map<String, Integer> createdDistributions = new HashMap<>();\n         String successKeyPart = \"::Successes\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be8eb4913b005bfbba31c56104aaf17c6701f063"}, "originalPosition": 89}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2233, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}