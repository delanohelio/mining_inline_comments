{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczODg3NjE1", "number": 850, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQyMToyMzoyMFrODe91zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0Mzo0OVrODfLnpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzNzk3MDcwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckProperties.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQyMToyMzoyMFrOFoZnPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQyMToyMzoyMFrOFoZnPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzkwNzAwNQ==", "bodyText": "The BlackDuckServicesFactory constructor now requires MediaTypeDiscovery", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/850#discussion_r377907005", "createdAt": "2020-02-11T21:23:20Z", "author": {"login": "jamesrichard91"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/BlackDuckProperties.java", "diffHunk": "@@ -81,49 +81,50 @@ public Integer getBlackDuckTimeout() {\n         return retrieveGlobalConfig();\n     }\n \n-    public BlackDuckServicesFactory createBlackDuckServicesFactory(final BlackDuckHttpClient blackDuckHttpClient, final IntLogger logger) {\n-        return new BlackDuckServicesFactory(new IntEnvironmentVariables(), gson, BlackDuckServicesFactory.createDefaultObjectMapper(), new NoThreadExecutorService(), blackDuckHttpClient, logger);\n+    public BlackDuckServicesFactory createBlackDuckServicesFactory(BlackDuckHttpClient blackDuckHttpClient, IntLogger logger) {\n+        return new BlackDuckServicesFactory(new IntEnvironmentVariables(), gson, BlackDuckServicesFactory.createDefaultObjectMapper(), new NoThreadExecutorService(), blackDuckHttpClient, logger,\n+            BlackDuckServicesFactory.createDefaultMediaTypeDiscovery());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a445d816ad0d95650d1a937bc1d13b8e4ec048"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzNzk3NDA2OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/collector/builder/BomEditMessageBuilder.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQyMToyNDoyN1rOFoZpXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQyMToyNDoyN1rOFoZpXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzkwNzU0OA==", "bodyText": "Moving the comment here from BlackDuckResponseCache  because the comment only applies to the Bom Edit notifications", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/850#discussion_r377907548", "createdAt": "2020-02-11T21:24:27Z", "author": {"login": "jamesrichard91"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/collector/builder/BomEditMessageBuilder.java", "diffHunk": "@@ -90,6 +90,9 @@ public String getNotificationType() {\n         BlackDuckResponseCache responseCache = new BlackDuckResponseCache(bucketService, blackDuckBucket, timeout);\n         BomEditNotificationContent bomEditContent = notificationView.getContent();\n         Optional<ProjectVersionComponentView> bomComponent = responseCache.getBomComponentView(bomEditContent.getBomComponent());\n+\n+        // TODO Stop using this when Black Duck supports going back to the project-version\n+        // blackduck-common-api 2019.12.0.4+ should have the project version link in the BomEditNotificationContent", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a445d816ad0d95650d1a937bc1d13b8e4ec048"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MDIyMTI5OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/collector/builder/VulnerabilityNotificationMessageBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0MTo1NlrOFou7_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0MTo1NlrOFou7_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI1NjM4MA==", "bodyText": "We could do Objects.requireNonNullElse(vulnerabilityItem.getSeverity(), \"UNKNOWN\")", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/850#discussion_r378256380", "createdAt": "2020-02-12T13:41:56Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/collector/builder/VulnerabilityNotificationMessageBuilder.java", "diffHunk": "@@ -148,14 +148,13 @@ public String getNotificationType() {\n         for (VulnerabilitySourceQualifiedId vulnerabilityItem : vulnerabilityList) {\n             String vulnerabilityId = vulnerabilityItem.getVulnerabilityId();\n             String vulnerabilityUrl = vulnerabilityItem.getVulnerability();\n-\n             LinkableItem vulnIdItem = new LinkableItem(MessageBuilderConstants.LABEL_VULNERABILITIES, vulnerabilityId, vulnerabilityUrl);\n-            // TODO in blackduck-common:45.1.2+ the VulnerabilitySourceQualifiedId includes the severity so we don't need to make a request to get it\n-            String notificationSeverity = blackDuckResponseCache.getSeverity(vulnerabilityUrl);\n-            if (vulnerabilityFilters.isEmpty() || vulnerabilityFilters.contains(notificationSeverity)) {\n+\n+            String notificationSeverity = vulnerabilityItem.getSeverity();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a445d816ad0d95650d1a937bc1d13b8e4ec048"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MDIyODIwOnYy", "diffSide": "RIGHT", "path": "src/test/resources/json/vulnerabilityNotificationComplex.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0Mzo0OVrOFovAHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzo0Mzo0OVrOFovAHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI1NzQzNg==", "bodyText": "We might want to add something with a null severity.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/850#discussion_r378257436", "createdAt": "2020-02-12T13:43:49Z", "author": {"login": "gkillough"}, "path": "src/test/resources/json/vulnerabilityNotificationComplex.json", "diffHunk": "@@ -10,81 +10,96 @@\n       {\n         \"source\": \"NVD\",\n         \"vulnerabilityId\": \"CVE-2018-0001\",\n-        \"vulnerability\": \"https://a-hub-server.blackduck.com/api/vulnerabilities/CVE-2018-0001\"\n+        \"vulnerability\": \"https://a-hub-server.blackduck.com/api/vulnerabilities/CVE-2018-0001\",\n+        \"severity\": \"HIGH\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5a445d816ad0d95650d1a937bc1d13b8e4ec048"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2094, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}