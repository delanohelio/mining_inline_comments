{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NTM4NTcx", "number": 1144, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxODoyODoxM1rOEd2Sjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxODozMjo1MFrOEd2Xsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5NzMzNjQ3OnYy", "diffSide": "RIGHT", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/UploadEndpointManager.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxODoyODoxM1rOHJQenQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxODoyODoxM1rOHJQenQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ2OTIxMw==", "bodyText": "Can we use the entire if statement in the throwNotImplementedException method? We perform this exact check multiple times. We'd just change the name of the throw method to throwNotImplementedExceptionIfTargetDoesntExist or something not as long", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1144#discussion_r479469213", "createdAt": "2020-08-28T18:28:13Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/UploadEndpointManager.java", "diffHunk": "@@ -90,83 +88,74 @@ public void unRegisterTarget(String targetKey) throws AlertException {\n         uploadTargets.remove(targetKey);\n     }\n \n-    public ResponseEntity<String> performUpload(String targetKey, Resource fileResource) {\n+    public void performUpload(String targetKey, Resource fileResource) {\n         if (!containsTarget(targetKey)) {\n-            return new ResponseEntity(NO_UPLOAD_FUNCTIONALITY_REGISTERED, HttpStatus.NOT_IMPLEMENTED);\n+            throwNotImplementedException();\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc9332310b5f648002c50be6ad19f53653ef2cd2"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5NzM0MTg3OnYy", "diffSide": "RIGHT", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/UploadEndpointManager.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxODozMDowN1rOHJQh-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxODo0NDoxNVrOHJQ6lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3MDA3NQ==", "bodyText": "I think these if statements can also be made into a throw method that is passed a function for which check to perform.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1144#discussion_r479470075", "createdAt": "2020-08-28T18:30:07Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/UploadEndpointManager.java", "diffHunk": "@@ -90,83 +88,74 @@ public void unRegisterTarget(String targetKey) throws AlertException {\n         uploadTargets.remove(targetKey);\n     }\n \n-    public ResponseEntity<String> performUpload(String targetKey, Resource fileResource) {\n+    public void performUpload(String targetKey, Resource fileResource) {\n         if (!containsTarget(targetKey)) {\n-            return new ResponseEntity(NO_UPLOAD_FUNCTIONALITY_REGISTERED, HttpStatus.NOT_IMPLEMENTED);\n+            throwNotImplementedException();\n         }\n \n         UploadTarget target = uploadTargets.get(targetKey);\n         if (!authorizationManager.hasUploadWritePermission(target.getContext().name(), target.getDescriptorKey().getUniversalKey())) {\n-            return responseFactory.createForbiddenResponse();\n+            throw ResponseFactory.createForbiddenException();\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc9332310b5f648002c50be6ad19f53653ef2cd2"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3MTc0MA==", "bodyText": "It looks like they're checking different permissions, so I'm gonna leave them.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1144#discussion_r479471740", "createdAt": "2020-08-28T18:33:56Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/UploadEndpointManager.java", "diffHunk": "@@ -90,83 +88,74 @@ public void unRegisterTarget(String targetKey) throws AlertException {\n         uploadTargets.remove(targetKey);\n     }\n \n-    public ResponseEntity<String> performUpload(String targetKey, Resource fileResource) {\n+    public void performUpload(String targetKey, Resource fileResource) {\n         if (!containsTarget(targetKey)) {\n-            return new ResponseEntity(NO_UPLOAD_FUNCTIONALITY_REGISTERED, HttpStatus.NOT_IMPLEMENTED);\n+            throwNotImplementedException();\n         }\n \n         UploadTarget target = uploadTargets.get(targetKey);\n         if (!authorizationManager.hasUploadWritePermission(target.getContext().name(), target.getDescriptorKey().getUniversalKey())) {\n-            return responseFactory.createForbiddenResponse();\n+            throw ResponseFactory.createForbiddenException();\n         }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3MDA3NQ=="}, "originalCommit": {"oid": "fc9332310b5f648002c50be6ad19f53653ef2cd2"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3NDEwNw==", "bodyText": "Sure, but I think something like this would look cleaner\nprivate blah(BiFunction<Boolean, String, String> checkPermission, Target target) {\n     if (!checkPermission.apply(target.getContext().name(), target.getDescriptorKey().getUniversalKey())) {\n         throw ResponseFactory.createForbiddenException();\n     }\n}\nthen just calling\nblah(authorizationManager::hasUploadWritePermission, target);", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1144#discussion_r479474107", "createdAt": "2020-08-28T18:39:15Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/UploadEndpointManager.java", "diffHunk": "@@ -90,83 +88,74 @@ public void unRegisterTarget(String targetKey) throws AlertException {\n         uploadTargets.remove(targetKey);\n     }\n \n-    public ResponseEntity<String> performUpload(String targetKey, Resource fileResource) {\n+    public void performUpload(String targetKey, Resource fileResource) {\n         if (!containsTarget(targetKey)) {\n-            return new ResponseEntity(NO_UPLOAD_FUNCTIONALITY_REGISTERED, HttpStatus.NOT_IMPLEMENTED);\n+            throwNotImplementedException();\n         }\n \n         UploadTarget target = uploadTargets.get(targetKey);\n         if (!authorizationManager.hasUploadWritePermission(target.getContext().name(), target.getDescriptorKey().getUniversalKey())) {\n-            return responseFactory.createForbiddenResponse();\n+            throw ResponseFactory.createForbiddenException();\n         }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3MDA3NQ=="}, "originalCommit": {"oid": "fc9332310b5f648002c50be6ad19f53653ef2cd2"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3NDIxMw==", "bodyText": "wow, didn't keep any formatting", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1144#discussion_r479474213", "createdAt": "2020-08-28T18:39:28Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/UploadEndpointManager.java", "diffHunk": "@@ -90,83 +88,74 @@ public void unRegisterTarget(String targetKey) throws AlertException {\n         uploadTargets.remove(targetKey);\n     }\n \n-    public ResponseEntity<String> performUpload(String targetKey, Resource fileResource) {\n+    public void performUpload(String targetKey, Resource fileResource) {\n         if (!containsTarget(targetKey)) {\n-            return new ResponseEntity(NO_UPLOAD_FUNCTIONALITY_REGISTERED, HttpStatus.NOT_IMPLEMENTED);\n+            throwNotImplementedException();\n         }\n \n         UploadTarget target = uploadTargets.get(targetKey);\n         if (!authorizationManager.hasUploadWritePermission(target.getContext().name(), target.getDescriptorKey().getUniversalKey())) {\n-            return responseFactory.createForbiddenResponse();\n+            throw ResponseFactory.createForbiddenException();\n         }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3MDA3NQ=="}, "originalCommit": {"oid": "fc9332310b5f648002c50be6ad19f53653ef2cd2"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3NjM3NA==", "bodyText": "Ok, fine. I was just being lazy.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1144#discussion_r479476374", "createdAt": "2020-08-28T18:44:15Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/action/UploadEndpointManager.java", "diffHunk": "@@ -90,83 +88,74 @@ public void unRegisterTarget(String targetKey) throws AlertException {\n         uploadTargets.remove(targetKey);\n     }\n \n-    public ResponseEntity<String> performUpload(String targetKey, Resource fileResource) {\n+    public void performUpload(String targetKey, Resource fileResource) {\n         if (!containsTarget(targetKey)) {\n-            return new ResponseEntity(NO_UPLOAD_FUNCTIONALITY_REGISTERED, HttpStatus.NOT_IMPLEMENTED);\n+            throwNotImplementedException();\n         }\n \n         UploadTarget target = uploadTargets.get(targetKey);\n         if (!authorizationManager.hasUploadWritePermission(target.getContext().name(), target.getDescriptorKey().getUniversalKey())) {\n-            return responseFactory.createForbiddenResponse();\n+            throw ResponseFactory.createForbiddenException();\n         }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3MDA3NQ=="}, "originalCommit": {"oid": "fc9332310b5f648002c50be6ad19f53653ef2cd2"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5NzM0OTYyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/alert/web/api/upload/UploadEndpointController.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxODozMjo1MFrOHJQmyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxODozMjo1MFrOHJQmyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ3MTMwNw==", "bodyText": "This class also has a number of duplicate if statements that can be put into the private method.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1144#discussion_r479471307", "createdAt": "2020-08-28T18:32:50Z", "author": {"login": "bamandel"}, "path": "src/main/java/com/synopsys/integration/alert/web/api/upload/UploadEndpointController.java", "diffHunk": "@@ -24,54 +24,61 @@\n \n import org.apache.commons.lang3.StringUtils;\n import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.http.ResponseEntity;\n+import org.springframework.http.HttpStatus;\n import org.springframework.web.bind.annotation.DeleteMapping;\n import org.springframework.web.bind.annotation.GetMapping;\n import org.springframework.web.bind.annotation.PathVariable;\n import org.springframework.web.bind.annotation.PostMapping;\n import org.springframework.web.bind.annotation.RequestMapping;\n import org.springframework.web.bind.annotation.RequestParam;\n+import org.springframework.web.bind.annotation.ResponseStatus;\n import org.springframework.web.bind.annotation.RestController;\n import org.springframework.web.multipart.MultipartFile;\n \n import com.synopsys.integration.alert.common.action.UploadEndpointManager;\n import com.synopsys.integration.alert.common.rest.ResponseFactory;\n+import com.synopsys.integration.alert.common.rest.model.ExistenceModel;\n \n @RestController\n @RequestMapping(UploadEndpointManager.UPLOAD_ENDPOINT_URL)\n public class UploadEndpointController {\n-\n     public static final String TARGET_KEY_MISSING = \"Must be given the key associated with the custom functionality.\";\n+\n     private final UploadEndpointManager uploadEndpointManager;\n-    private final ResponseFactory responseFactory;\n \n     @Autowired\n-    public UploadEndpointController(UploadEndpointManager uploadEndpointManager, ResponseFactory responseFactory) {\n+    public UploadEndpointController(UploadEndpointManager uploadEndpointManager) {\n         this.uploadEndpointManager = uploadEndpointManager;\n-        this.responseFactory = responseFactory;\n     }\n \n     @GetMapping(\"/{key}/exists\")\n-    public ResponseEntity<String> checkUploadedFileExists(@PathVariable String key) {\n+    public ExistenceModel checkUploadedFileExists(@PathVariable String key) {\n         if (StringUtils.isBlank(key)) {\n-            return responseFactory.createBadRequestResponse(\"\", TARGET_KEY_MISSING);\n+            throwTargetKeyMissingException();\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc9332310b5f648002c50be6ad19f53653ef2cd2"}, "originalPosition": 42}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1711, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}