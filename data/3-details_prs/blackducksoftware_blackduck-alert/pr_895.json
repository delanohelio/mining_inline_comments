{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNzk5NTU1", "number": 895, "title": "Fix issues found from a development smoke test", "bodyText": "", "createdAt": "2020-03-04T19:10:44Z", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895", "merged": true, "mergeCommit": {"oid": "41b381aa8952a60ee9c846f1feba75a3e45a9e5d"}, "closed": true, "closedAt": "2020-03-05T14:46:53Z", "author": {"login": "gkillough"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKXvlbgH2gAyMzgzNzk5NTU1OjcxNjlmZDhkZjY3NjgxNzgyZTg5ZWUzZjZjYTI5ZjkxNDBmZTMwMzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKqFpFAFqTM2OTUwMzc3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7169fd8df67681782e89ee3f6ca29f9140fe3036", "author": {"user": {"login": "gkillough", "name": "Gavin Killough"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/7169fd8df67681782e89ee3f6ca29f9140fe3036", "committedDate": "2020-03-04T14:25:07Z", "message": "Fix(Java): Fix task name logging and project-version notification url"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c9ca94004bbc2d1cf54a7a1c275ad8ba806e2a4", "author": {"user": {"login": "gkillough", "name": "Gavin Killough"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/4c9ca94004bbc2d1cf54a7a1c275ad8ba806e2a4", "committedDate": "2020-03-04T14:56:29Z", "message": "Fix(Java): Update message parser to exclude links in top level deletes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "034b531303ea219e5fd52f1a349c65538f8de99a", "author": {"user": {"login": "gkillough", "name": "Gavin Killough"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/034b531303ea219e5fd52f1a349c65538f8de99a", "committedDate": "2020-03-04T17:41:00Z", "message": "Fix(Java): Change the way to get tasks by class name to use isAssignable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067", "author": {"user": {"login": "gkillough", "name": "Gavin Killough"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/a591869033e8f08d2b6b4f9e6ac98397f5d85067", "committedDate": "2020-03-04T19:09:38Z", "message": "Fix(Java): Include the project url in project deleted messages"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MDYwMjYx", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#pullrequestreview-369060261", "createdAt": "2020-03-04T19:29:44Z", "commit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOToyOTo0NVrOFx6p2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOToyOTo0NVrOFx6p2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NTUyOA==", "bodyText": "Why not add @Nullable, javax.annotation.Nullable, to the nullableTopLevelAction?\npublic String getCommonTopic(MessageContentGroup messageContent, @Nullable ItemOperation nullableTopLevelAction) {", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387885528", "createdAt": "2020-03-04T19:29:45Z", "author": {"login": "jamesrichard91"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MDYwNjg5", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#pullrequestreview-369060689", "createdAt": "2020-03-04T19:30:19Z", "commit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTozMDoxOVrOFx6rKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTozMDoxOVrOFx6rKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NTg2Ng==", "bodyText": "Why not add @Nullable, javax.annotation.Nullable, to the nullableTopLevelAction?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387885866", "createdAt": "2020-03-04T19:30:19Z", "author": {"login": "jamesrichard91"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {\n+        LinkableItem commonTopic = messageContent.getCommonTopic();\n+        if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+            commonTopic = new LinkableItem(commonTopic.getName(), commonTopic.getValue());\n+        }\n+        return createLinkableItemString(commonTopic, true) + getLineSeparator();\n     }\n \n-    public String getComponentSubTopic(ProviderMessageContent messageContent) {\n-        return messageContent.getSubTopic()\n-                   .map(item -> createLinkableItemString(item, true))\n-                   .orElse(\"\");\n+    public String getComponentSubTopic(ProviderMessageContent messageContent, ItemOperation nullableTopLevelAction) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MDYxMzkz", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#pullrequestreview-369061393", "createdAt": "2020-03-04T19:31:17Z", "commit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTozMToxN1rOFx6tbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTozMToxN1rOFx6tbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NjQ0Ng==", "bodyText": "Why not add @Nullable, javax.annotation.Nullable, to the returned ItemOperation?\nprotected @Nullable ItemOperation getNullableTopLevelAction(MessageContentGroup messageContentGroup) {", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387886446", "createdAt": "2020-03-04T19:31:17Z", "author": {"login": "jamesrichard91"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -329,4 +341,14 @@ protected String createLinkableItemValueString(LinkableItem linkableItem) {\n                    .findAny();\n     }\n \n+    protected ItemOperation getNullableTopLevelAction(MessageContentGroup messageContentGroup) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MDc2MDk1", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#pullrequestreview-369076095", "createdAt": "2020-03-04T19:53:01Z", "commit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo1MzowMlrOFx7cew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo1MzowMlrOFx7cew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5ODQ5MQ==", "bodyText": "By removing the default \"-1\" aren't you opening this up to possible NPE's?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387898491", "createdAt": "2020-03-04T19:53:02Z", "author": {"login": "jamesrichard91"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/actions/BlackDuckGlobalApiAction.java", "diffHunk": "@@ -77,8 +81,8 @@ public void afterDeleteAction(FieldModel fieldModel) {\n         FieldValueModel fieldValueModel = keyToValues.get(ProviderDescriptor.KEY_PROVIDER_CONFIG_NAME);\n         String blackDuckGlobalConfigName = fieldValueModel.getValue().orElse(\"\");\n \n-        Long configId = Long.parseLong(Objects.requireNonNullElse(fieldModel.getId(), \"-1\"));\n-        providerLifecycleManager.unscheduleTasksForProviderConfig(blackDuckProvider, configId);\n+        Long configId = Long.parseLong(fieldModel.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MDY3OTIy", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#pullrequestreview-369067922", "createdAt": "2020-03-04T19:41:08Z", "commit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo0MTowOVrOFx7CXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo0MTo0MVrOFx7DlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5MTgwNw==", "bodyText": "When should we use the ternary operator vs something like this?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387891807", "createdAt": "2020-03-04T19:41:09Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {\n+        LinkableItem commonTopic = messageContent.getCommonTopic();\n+        if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+            commonTopic = new LinkableItem(commonTopic.getName(), commonTopic.getValue());\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5MjExNg==", "bodyText": "Another possible location for ternary operator", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387892116", "createdAt": "2020-03-04T19:41:41Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {\n+        LinkableItem commonTopic = messageContent.getCommonTopic();\n+        if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+            commonTopic = new LinkableItem(commonTopic.getName(), commonTopic.getValue());\n+        }\n+        return createLinkableItemString(commonTopic, true) + getLineSeparator();\n     }\n \n-    public String getComponentSubTopic(ProviderMessageContent messageContent) {\n-        return messageContent.getSubTopic()\n-                   .map(item -> createLinkableItemString(item, true))\n-                   .orElse(\"\");\n+    public String getComponentSubTopic(ProviderMessageContent messageContent, ItemOperation nullableTopLevelAction) {\n+        Optional<LinkableItem> optionalSubTopic = messageContent.getSubTopic();\n+        if (optionalSubTopic.isPresent()) {\n+            LinkableItem subTopic = optionalSubTopic.get();\n+            if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+                subTopic = new LinkableItem(subTopic.getName(), subTopic.getValue());\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fd6995e6d63b51c4053269f837cce951da9a68f", "author": {"user": {"login": "gkillough", "name": "Gavin Killough"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/6fd6995e6d63b51c4053269f837cce951da9a68f", "committedDate": "2020-03-04T20:26:13Z", "message": "Fix(Java): Return Optional rather than null and fix test errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MTE0MjU3", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#pullrequestreview-369114257", "createdAt": "2020-03-04T20:53:49Z", "commit": {"oid": "6fd6995e6d63b51c4053269f837cce951da9a68f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NTAzNzc0", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#pullrequestreview-369503774", "createdAt": "2020-03-05T11:47:30Z", "commit": {"oid": "6fd6995e6d63b51c4053269f837cce951da9a68f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2865, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}