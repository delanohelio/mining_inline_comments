{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2Njk5NDIy", "number": 1028, "title": "about descriptor fix", "bodyText": "Have the about model list all possible providers and channels\nHave the UI check if the user has Global context permissions and create a NavLink to that part of the UI if the user has permissions.\nTake the contents of the DescriptorController and refactor it into an Actions class\nAdd a method to generate DescriptorMetadata classes without any permission information.", "createdAt": "2020-06-18T18:46:57Z", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028", "merged": true, "mergeCommit": {"oid": "8702a17678e55992e1361a7daf9d495f06f84805"}, "closed": true, "closedAt": "2020-06-19T14:23:06Z", "author": {"login": "psantos1113"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsPgVxgH2gAyNDM2Njk5NDIyOmFmNjFhMDZiMjBiZjI0ZDFjYzMxMTJlYmUzODNhMzM5ODVmYjQ1NmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcszqr8AH2gAyNDM2Njk5NDIyOmJmZWNiZWFmYWZhN2I1YzY2NzFkNzkyN2MxOGM0Y2JiNzM0YzM3Zjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "af61a06b20bf24d1cc3112ebe383a33985fb456a", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/af61a06b20bf24d1cc3112ebe383a33985fb456a", "committedDate": "2020-06-17T20:02:39Z", "message": "Refactor: Add providers and channels to the about info."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "718caf51896f4d1b5f7317116d32c443402d99ba", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/718caf51896f4d1b5f7317116d32c443402d99ba", "committedDate": "2020-06-18T16:00:28Z", "message": "fix: Get all the descriptor metadata."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3482deb617a2181e9c2064fc3fd77fd70199b6f9", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/3482deb617a2181e9c2064fc3fd77fd70199b6f9", "committedDate": "2020-06-18T17:28:19Z", "message": "test: Fix the tests to compile and pass."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/d02074401dfcfd33c784bf64e6551bdc91f85d68", "committedDate": "2020-06-18T18:43:01Z", "message": "fix: Update the cache when roles are created or deleted."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTU1Mzk0", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433555394", "createdAt": "2020-06-18T18:47:35Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo0NzozNVrOGl75IQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo0NzozNVrOGl75IQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzMTc3Nw==", "bodyText": "Add the provider and channel descriptor information back into the about model like we used to in older versions of Alert.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442431777", "createdAt": "2020-06-18T18:47:35Z", "author": {"login": "psantos1113"}, "path": "src/main/java/com/synopsys/integration/alert/AboutReader.java", "diffHunk": "@@ -42,19 +46,23 @@\n     private final Logger logger = LoggerFactory.getLogger(AboutReader.class);\n     private final Gson gson;\n     private final SystemStatusUtility systemStatusUtility;\n+    private final DescriptorMetadataActions descriptorActions;\n \n     @Autowired\n-    public AboutReader(Gson gson, SystemStatusUtility systemStatusUtility) {\n+    public AboutReader(Gson gson, SystemStatusUtility systemStatusUtility, DescriptorMetadataActions descriptorActions) {\n         this.gson = gson;\n         this.systemStatusUtility = systemStatusUtility;\n+        this.descriptorActions = descriptorActions;\n     }\n \n     public AboutModel getAboutModel() {\n         try {\n             String aboutJson = ResourceUtil.getResourceAsString(getClass(), \"/about.txt\", StandardCharsets.UTF_8.toString());\n             AboutModel aboutModel = gson.fromJson(aboutJson, AboutModel.class);\n             String startupDate = systemStatusUtility.getStartupTime() != null ? DateUtils.formatDate(systemStatusUtility.getStartupTime(), RestConstants.JSON_DATE_FORMAT) : \"\";\n-            return new AboutModel(aboutModel.getVersion(), aboutModel.getCreated(), aboutModel.getDescription(), aboutModel.getProjectUrl(), systemStatusUtility.isSystemInitialized(), startupDate);\n+            Set<DescriptorMetadata> providers = descriptorActions.getDescriptors(null, DescriptorType.PROVIDER.name(), null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTU3MjQ3", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433557247", "createdAt": "2020-06-18T18:50:06Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1MDowNlrOGl7-gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1MDowNlrOGl7-gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzMzE1NA==", "bodyText": "This class contains the contents of the DescriptorController.  This provides methods to create the descriptor metadata to be used in both the about page and the user based descriptor data.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442433154", "createdAt": "2020-06-18T18:50:06Z", "author": {"login": "psantos1113"}, "path": "src/main/java/com/synopsys/integration/alert/web/actions/DescriptorMetadataActions.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTU3ODgy", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433557882", "createdAt": "2020-06-18T18:50:58Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1MDo1OVrOGl8Aeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1MDo1OVrOGl8Aeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzMzY1OA==", "bodyText": "Create all DescriptorMetadata objects regardless of user permission.  This is used by the AboutReader.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442433658", "createdAt": "2020-06-18T18:50:59Z", "author": {"login": "psantos1113"}, "path": "src/main/java/com/synopsys/integration/alert/web/actions/DescriptorMetadataActions.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**\n+ * blackduck-alert\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.web.actions;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.function.BiFunction;\n+import java.util.function.Predicate;\n+import java.util.stream.Collectors;\n+\n+import javax.annotation.Nullable;\n+\n+import org.apache.commons.lang3.EnumUtils;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.descriptor.Descriptor;\n+import com.synopsys.integration.alert.common.descriptor.config.ui.DescriptorMetadata;\n+import com.synopsys.integration.alert.common.enumeration.AccessOperation;\n+import com.synopsys.integration.alert.common.enumeration.ConfigContextEnum;\n+import com.synopsys.integration.alert.common.enumeration.DescriptorType;\n+import com.synopsys.integration.alert.common.security.authorization.AuthorizationManager;\n+\n+@Component\n+public class DescriptorMetadataActions {\n+    private final Collection<Descriptor> descriptors;\n+    private final AuthorizationManager authorizationManager;\n+\n+    @Autowired\n+    public DescriptorMetadataActions(Collection<Descriptor> descriptors, AuthorizationManager authorizationManager) {\n+        this.descriptors = descriptors;\n+        this.authorizationManager = authorizationManager;\n+    }\n+\n+    public Set<DescriptorMetadata> getDescriptors(@Nullable String name, @Nullable String type, @Nullable String context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTU4NTg2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433558586", "createdAt": "2020-06-18T18:51:57Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1MTo1N1rOGl8CcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1MTo1N1rOGl8CcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzNDE2MA==", "bodyText": "This is the method the DescriptorController uses.  Gets the DescriptorMetadata based on the user's permissions.  This is the same type of code that the controller executed in the past.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442434160", "createdAt": "2020-06-18T18:51:57Z", "author": {"login": "psantos1113"}, "path": "src/main/java/com/synopsys/integration/alert/web/actions/DescriptorMetadataActions.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**\n+ * blackduck-alert\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.web.actions;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.function.BiFunction;\n+import java.util.function.Predicate;\n+import java.util.stream.Collectors;\n+\n+import javax.annotation.Nullable;\n+\n+import org.apache.commons.lang3.EnumUtils;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.descriptor.Descriptor;\n+import com.synopsys.integration.alert.common.descriptor.config.ui.DescriptorMetadata;\n+import com.synopsys.integration.alert.common.enumeration.AccessOperation;\n+import com.synopsys.integration.alert.common.enumeration.ConfigContextEnum;\n+import com.synopsys.integration.alert.common.enumeration.DescriptorType;\n+import com.synopsys.integration.alert.common.security.authorization.AuthorizationManager;\n+\n+@Component\n+public class DescriptorMetadataActions {\n+    private final Collection<Descriptor> descriptors;\n+    private final AuthorizationManager authorizationManager;\n+\n+    @Autowired\n+    public DescriptorMetadataActions(Collection<Descriptor> descriptors, AuthorizationManager authorizationManager) {\n+        this.descriptors = descriptors;\n+        this.authorizationManager = authorizationManager;\n+    }\n+\n+    public Set<DescriptorMetadata> getDescriptors(@Nullable String name, @Nullable String type, @Nullable String context) {\n+        return getDescriptors(name, type, context, this::generateUIComponents);\n+    }\n+\n+    public Set<DescriptorMetadata> getDescriptorsByPermissions(@Nullable String name, @Nullable String type, @Nullable String context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 61}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTU5MDk3", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433559097", "createdAt": "2020-06-18T18:52:41Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1Mjo0MVrOGl8EBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1Mjo0MVrOGl8EBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzNDU2NQ==", "bodyText": "Create the metadata for all descriptors with UI Components.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442434565", "createdAt": "2020-06-18T18:52:41Z", "author": {"login": "psantos1113"}, "path": "src/main/java/com/synopsys/integration/alert/web/actions/DescriptorMetadataActions.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**\n+ * blackduck-alert\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.web.actions;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.function.BiFunction;\n+import java.util.function.Predicate;\n+import java.util.stream.Collectors;\n+\n+import javax.annotation.Nullable;\n+\n+import org.apache.commons.lang3.EnumUtils;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.descriptor.Descriptor;\n+import com.synopsys.integration.alert.common.descriptor.config.ui.DescriptorMetadata;\n+import com.synopsys.integration.alert.common.enumeration.AccessOperation;\n+import com.synopsys.integration.alert.common.enumeration.ConfigContextEnum;\n+import com.synopsys.integration.alert.common.enumeration.DescriptorType;\n+import com.synopsys.integration.alert.common.security.authorization.AuthorizationManager;\n+\n+@Component\n+public class DescriptorMetadataActions {\n+    private final Collection<Descriptor> descriptors;\n+    private final AuthorizationManager authorizationManager;\n+\n+    @Autowired\n+    public DescriptorMetadataActions(Collection<Descriptor> descriptors, AuthorizationManager authorizationManager) {\n+        this.descriptors = descriptors;\n+        this.authorizationManager = authorizationManager;\n+    }\n+\n+    public Set<DescriptorMetadata> getDescriptors(@Nullable String name, @Nullable String type, @Nullable String context) {\n+        return getDescriptors(name, type, context, this::generateUIComponents);\n+    }\n+\n+    public Set<DescriptorMetadata> getDescriptorsByPermissions(@Nullable String name, @Nullable String type, @Nullable String context) {\n+        return getDescriptors(name, type, context, this::generateUIComponentsByPermissions);\n+    }\n+\n+    private Set<DescriptorMetadata> getDescriptors(@Nullable String name, @Nullable String type, @Nullable String context,\n+        BiFunction<Set<Descriptor>, ConfigContextEnum, Set<DescriptorMetadata>> generatorFunction) {\n+        Predicate<Descriptor> filter = Descriptor::hasUIConfigs;\n+        if (name != null) {\n+            filter = filter.and(descriptor -> name.equalsIgnoreCase(descriptor.getDescriptorKey().getUniversalKey()));\n+        }\n+\n+        DescriptorType typeEnum = EnumUtils.getEnumIgnoreCase(DescriptorType.class, type);\n+        if (typeEnum != null) {\n+            filter = filter.and(descriptor -> typeEnum.equals(descriptor.getType()));\n+        } else if (type != null) {\n+            return Set.of();\n+        }\n+\n+        ConfigContextEnum contextEnum = EnumUtils.getEnumIgnoreCase(ConfigContextEnum.class, context);\n+        if (contextEnum != null) {\n+            filter = filter.and(descriptor -> descriptor.hasUIConfigForType(contextEnum));\n+        } else if (context != null) {\n+            return Set.of();\n+        }\n+\n+        Set<Descriptor> filteredDescriptors = filter(descriptors, filter);\n+        return generatorFunction.apply(filteredDescriptors, contextEnum);\n+    }\n+\n+    private Set<Descriptor> filter(Collection<Descriptor> descriptors, Predicate<Descriptor> predicate) {\n+        return descriptors\n+                   .stream()\n+                   .filter(predicate)\n+                   .collect(Collectors.toSet());\n+    }\n+\n+    private Set<DescriptorMetadata> generateUIComponents(Set<Descriptor> filteredDescriptors, ConfigContextEnum context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 97}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTYwMTM2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433560136", "createdAt": "2020-06-18T18:54:07Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1NDowN1rOGl8HAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1NDowN1rOGl8HAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzNTMzMA==", "bodyText": "Create the DescriptorMetadata based on the user permissions.  Refactored the code from the controller because we were making an extra method call that we didn't need.  Check the permissions here.  If the user has permissions then create the DescriptorMetadata objects.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442435330", "createdAt": "2020-06-18T18:54:07Z", "author": {"login": "psantos1113"}, "path": "src/main/java/com/synopsys/integration/alert/web/actions/DescriptorMetadataActions.java", "diffHunk": "@@ -0,0 +1,147 @@\n+/**\n+ * blackduck-alert\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.web.actions;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.function.BiFunction;\n+import java.util.function.Predicate;\n+import java.util.stream.Collectors;\n+\n+import javax.annotation.Nullable;\n+\n+import org.apache.commons.lang3.EnumUtils;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.descriptor.Descriptor;\n+import com.synopsys.integration.alert.common.descriptor.config.ui.DescriptorMetadata;\n+import com.synopsys.integration.alert.common.enumeration.AccessOperation;\n+import com.synopsys.integration.alert.common.enumeration.ConfigContextEnum;\n+import com.synopsys.integration.alert.common.enumeration.DescriptorType;\n+import com.synopsys.integration.alert.common.security.authorization.AuthorizationManager;\n+\n+@Component\n+public class DescriptorMetadataActions {\n+    private final Collection<Descriptor> descriptors;\n+    private final AuthorizationManager authorizationManager;\n+\n+    @Autowired\n+    public DescriptorMetadataActions(Collection<Descriptor> descriptors, AuthorizationManager authorizationManager) {\n+        this.descriptors = descriptors;\n+        this.authorizationManager = authorizationManager;\n+    }\n+\n+    public Set<DescriptorMetadata> getDescriptors(@Nullable String name, @Nullable String type, @Nullable String context) {\n+        return getDescriptors(name, type, context, this::generateUIComponents);\n+    }\n+\n+    public Set<DescriptorMetadata> getDescriptorsByPermissions(@Nullable String name, @Nullable String type, @Nullable String context) {\n+        return getDescriptors(name, type, context, this::generateUIComponentsByPermissions);\n+    }\n+\n+    private Set<DescriptorMetadata> getDescriptors(@Nullable String name, @Nullable String type, @Nullable String context,\n+        BiFunction<Set<Descriptor>, ConfigContextEnum, Set<DescriptorMetadata>> generatorFunction) {\n+        Predicate<Descriptor> filter = Descriptor::hasUIConfigs;\n+        if (name != null) {\n+            filter = filter.and(descriptor -> name.equalsIgnoreCase(descriptor.getDescriptorKey().getUniversalKey()));\n+        }\n+\n+        DescriptorType typeEnum = EnumUtils.getEnumIgnoreCase(DescriptorType.class, type);\n+        if (typeEnum != null) {\n+            filter = filter.and(descriptor -> typeEnum.equals(descriptor.getType()));\n+        } else if (type != null) {\n+            return Set.of();\n+        }\n+\n+        ConfigContextEnum contextEnum = EnumUtils.getEnumIgnoreCase(ConfigContextEnum.class, context);\n+        if (contextEnum != null) {\n+            filter = filter.and(descriptor -> descriptor.hasUIConfigForType(contextEnum));\n+        } else if (context != null) {\n+            return Set.of();\n+        }\n+\n+        Set<Descriptor> filteredDescriptors = filter(descriptors, filter);\n+        return generatorFunction.apply(filteredDescriptors, contextEnum);\n+    }\n+\n+    private Set<Descriptor> filter(Collection<Descriptor> descriptors, Predicate<Descriptor> predicate) {\n+        return descriptors\n+                   .stream()\n+                   .filter(predicate)\n+                   .collect(Collectors.toSet());\n+    }\n+\n+    private Set<DescriptorMetadata> generateUIComponents(Set<Descriptor> filteredDescriptors, ConfigContextEnum context) {\n+        ConfigContextEnum[] applicableContexts = (null != context) ? new ConfigContextEnum[] { context } : ConfigContextEnum.values();\n+        Set<DescriptorMetadata> descriptorMetadata = new HashSet<>();\n+        for (ConfigContextEnum applicableContext : applicableContexts) {\n+            for (Descriptor descriptor : filteredDescriptors) {\n+                descriptor.createMetaData(applicableContext)\n+                    .ifPresent(descriptorMetadata::add);\n+            }\n+        }\n+        return descriptorMetadata;\n+    }\n+\n+    private Set<DescriptorMetadata> generateUIComponentsByPermissions(Set<Descriptor> filteredDescriptors, ConfigContextEnum context) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 109}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTYwNTE4", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433560518", "createdAt": "2020-06-18T18:54:39Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1NDo0MFrOGl8IIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1NDo0MFrOGl8IIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzNTYxOA==", "bodyText": "Removed code from this class and moved it into DescriptorMetadataActions", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442435618", "createdAt": "2020-06-18T18:54:40Z", "author": {"login": "psantos1113"}, "path": "src/main/java/com/synopsys/integration/alert/web/controller/metadata/DescriptorController.java", "diffHunk": "@@ -22,117 +22,29 @@\n  */\n package com.synopsys.integration.alert.web.controller.metadata;\n \n-import java.util.Collection;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTY0MTM1", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433564135", "createdAt": "2020-06-18T18:59:33Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1OTozM1rOGl8THQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxODo1OTozM1rOGl8THQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzODQyOQ==", "bodyText": "This is a bug that might need to be patched in older versions.  The cache doesn't get updated when a new role is created.  Therefore this descriptor list for the user in the UI would be empty causing the original issue.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442438429", "createdAt": "2020-06-18T18:59:33Z", "author": {"login": "psantos1113"}, "path": "src/main/java/com/synopsys/integration/alert/web/user/RoleActions.java", "diffHunk": "@@ -84,7 +84,9 @@ public UserRoleModel createRole(RolePermissionModel rolePermissionModel) throws\n         Set<PermissionModel> permissions = rolePermissionModel.getPermissions();\n         validatePermissions(permissions);\n         PermissionMatrixModel permissionMatrixModel = convertToPermissionMatrixModel(permissions);\n-        return authorizationUtility.createRoleWithPermissions(roleName, permissionMatrixModel);\n+        UserRoleModel userRoleModel = authorizationUtility.createRoleWithPermissions(roleName, permissionMatrixModel);\n+        authorizationManager.loadPermissionsIntoCache();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTY1MTk2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433565196", "createdAt": "2020-06-18T19:01:05Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxOTowMTowNVrOGl8WlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxOTowMTowNVrOGl8WlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzOTMxNg==", "bodyText": "For each descriptor (providers or channels) check the users list of descriptors and see if they have permission for a Global UI context.  If they do then navigate will be true and the item in the table will be a link not just the name of the descriptor.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442439316", "createdAt": "2020-06-18T19:01:05Z", "author": {"login": "psantos1113"}, "path": "src/main/js/component/AboutInfo.js", "diffHunk": "@@ -57,59 +57,32 @@ class AboutInfo extends React.Component {\n         );\n     }\n \n-    createProviderTableData(globalDescriptors) {\n+    createTableData(userBasedDescriptors, descriptors) {\n         const data = [];\n-        for (let key in globalDescriptors) {\n-            const descriptor = globalDescriptors[key];\n-            if (!data.find(existing => existing.urlName === descriptor.urlName)) {\n+        for (let key in descriptors) {\n+            const descriptor = descriptors[key];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTY1NDcy", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433565472", "createdAt": "2020-06-18T19:01:30Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxOTowMTozMFrOGl8Xdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxOTowMTozMFrOGl8Xdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjQzOTU0Mw==", "bodyText": "Fix lint issues", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#discussion_r442439543", "createdAt": "2020-06-18T19:01:30Z", "author": {"login": "psantos1113"}, "path": "src/main/js/util/descriptorUtilities.js", "diffHunk": "@@ -35,7 +35,7 @@ export function findDescriptorByNameAndContext(descriptorList, descriptorName, c\n     if (!descriptorList) {\n         return null;\n     }\n-    const resultList = descriptorList.filter(descriptor => descriptor.name === descriptorName && descriptor.context === context);\n+    const resultList = descriptorList.filter((descriptor) => descriptor.name === descriptorName && descriptor.context === context);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTgyODA5", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433582809", "createdAt": "2020-06-18T19:28:05Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNTkwMzky", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1028#pullrequestreview-433590392", "createdAt": "2020-06-18T19:37:55Z", "commit": {"oid": "d02074401dfcfd33c784bf64e6551bdc91f85d68"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64e9fc6c9523b5fd07552d7e110b30c331b214b1", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/64e9fc6c9523b5fd07552d7e110b30c331b214b1", "committedDate": "2020-06-19T11:44:35Z", "message": "Merge remote-tracking branch 'origin/master' into ps_about_descriptor_fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfecbeafafa7b5c6671d7927c18c4cbb734c37f8", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/bfecbeafafa7b5c6671d7927c18c4cbb734c37f8", "committedDate": "2020-06-19T14:10:32Z", "message": "refactor: Implement PR suggestion to get by type only."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3562, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}