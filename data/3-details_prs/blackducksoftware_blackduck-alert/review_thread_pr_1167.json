{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3NTQxNzA1", "number": 1167, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDoyMjo1M1rOEjwu1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjowNTo0OVrOEkBfPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTM0MDM2OnYy", "diffSide": "RIGHT", "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDoyMjo1M1rOHSTLIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjoyNjoyMFrOHSuW6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1MDU2MQ==", "bodyText": "If the settings permissions happen to be set, unset them if the descriptor isn't 'Settings'.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1167#discussion_r488950561", "createdAt": "2020-09-15T20:22:53Z", "author": {"login": "gkillough"}, "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "diffHunk": "@@ -47,7 +48,15 @@ class PermissionTable extends Component {\n         const updatedValue = type === 'checkbox' ? checked.toString()\n             .toLowerCase() === 'true' : value;\n         const trimmedValue = (Array.isArray(updatedValue) && updatedValue.length > 0) ? updatedValue[0] : updatedValue;\n-        const newPermissions = Object.assign(permissionsData, { [name]: trimmedValue });\n+\n+        let newPermissions = Object.assign(permissionsData, { [name]: trimmedValue });\n+        if (newPermissions && newPermissions.descriptorName !== 'Settings') {\n+            newPermissions = Object.assign(newPermissions, {\n+                [PERMISSIONS_TABLE.UPLOAD_READ]: undefined,\n+                [PERMISSIONS_TABLE.UPLOAD_WRITE]: undefined,\n+                [PERMISSIONS_TABLE.UPLOAD_DELETE]: undefined\n+            });\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a3a47e7065d54637b090170fcb28cdbd38383c7"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM4MzUyMQ==", "bodyText": "SAML configuration is in Authentication not Settings.  I think you need to change the keyword from Settings to 'Authentication'", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1167#discussion_r489383521", "createdAt": "2020-09-16T12:04:33Z", "author": {"login": "psantos1113"}, "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "diffHunk": "@@ -47,7 +48,15 @@ class PermissionTable extends Component {\n         const updatedValue = type === 'checkbox' ? checked.toString()\n             .toLowerCase() === 'true' : value;\n         const trimmedValue = (Array.isArray(updatedValue) && updatedValue.length > 0) ? updatedValue[0] : updatedValue;\n-        const newPermissions = Object.assign(permissionsData, { [name]: trimmedValue });\n+\n+        let newPermissions = Object.assign(permissionsData, { [name]: trimmedValue });\n+        if (newPermissions && newPermissions.descriptorName !== 'Settings') {\n+            newPermissions = Object.assign(newPermissions, {\n+                [PERMISSIONS_TABLE.UPLOAD_READ]: undefined,\n+                [PERMISSIONS_TABLE.UPLOAD_WRITE]: undefined,\n+                [PERMISSIONS_TABLE.UPLOAD_DELETE]: undefined\n+            });\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1MDU2MQ=="}, "originalCommit": {"oid": "8a3a47e7065d54637b090170fcb28cdbd38383c7"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5NTk0NQ==", "bodyText": "Oof, good catch.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1167#discussion_r489395945", "createdAt": "2020-09-16T12:26:20Z", "author": {"login": "gkillough"}, "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "diffHunk": "@@ -47,7 +48,15 @@ class PermissionTable extends Component {\n         const updatedValue = type === 'checkbox' ? checked.toString()\n             .toLowerCase() === 'true' : value;\n         const trimmedValue = (Array.isArray(updatedValue) && updatedValue.length > 0) ? updatedValue[0] : updatedValue;\n-        const newPermissions = Object.assign(permissionsData, { [name]: trimmedValue });\n+\n+        let newPermissions = Object.assign(permissionsData, { [name]: trimmedValue });\n+        if (newPermissions && newPermissions.descriptorName !== 'Settings') {\n+            newPermissions = Object.assign(newPermissions, {\n+                [PERMISSIONS_TABLE.UPLOAD_READ]: undefined,\n+                [PERMISSIONS_TABLE.UPLOAD_WRITE]: undefined,\n+                [PERMISSIONS_TABLE.UPLOAD_DELETE]: undefined\n+            });\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1MDU2MQ=="}, "originalCommit": {"oid": "8a3a47e7065d54637b090170fcb28cdbd38383c7"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTM0MzMxOnYy", "diffSide": "RIGHT", "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDoyMzo1MVrOHSTNFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDoyMzo1MVrOHSTNFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1MTA2Mw==", "bodyText": "If the user changes descriptors, clear the context if it is no longer relevant to the new descriptor.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1167#discussion_r488951063", "createdAt": "2020-09-15T20:23:51Z", "author": {"login": "gkillough"}, "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "diffHunk": "@@ -147,13 +156,30 @@ class PermissionTable extends Component {\n     }\n \n     createContextOptions() {\n-        return [{\n-            label: CONTEXT_TYPE.DISTRIBUTION,\n-            value: CONTEXT_TYPE.DISTRIBUTION\n-        }, {\n-            label: CONTEXT_TYPE.GLOBAL,\n-            value: CONTEXT_TYPE.GLOBAL\n-        }];\n+        const { permissionsData } = this.state;\n+        const { descriptors } = this.props;\n+\n+        const availableContexts = [];\n+        if (permissionsData && permissionsData.descriptorName) {\n+            descriptors.forEach((descriptor) => {\n+                if (descriptor.label === permissionsData.descriptorName) {\n+                    availableContexts.push(descriptor.context);\n+                }\n+            });\n+\n+            if (permissionsData.context && !availableContexts.includes(permissionsData.context)) {\n+                this.setState({\n+                    permissionsData: {\n+                        descriptorName: permissionsData.descriptorName\n+                    }\n+                });\n+            }\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a3a47e7065d54637b090170fcb28cdbd38383c7"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTM4MDIxOnYy", "diffSide": "RIGHT", "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMDozNDo1N1rOHSTj_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjowMjozN1rOHStijQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1NjkyNg==", "bodyText": "This import should be absolute not relative", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1167#discussion_r488956926", "createdAt": "2020-09-15T20:34:57Z", "author": {"login": "jamesrichard91"}, "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "diffHunk": "@@ -4,6 +4,7 @@ import TableDisplay from 'field/TableDisplay';\n import DynamicSelectInput from 'field/input/DynamicSelect';\n import CheckboxInput from 'field/input/CheckboxInput';\n import { CONTEXT_TYPE } from 'util/descriptorUtilities';\n+import StatusMessage from '../../../field/StatusMessage';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a3a47e7065d54637b090170fcb28cdbd38383c7"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk2NjIwMg==", "bodyText": "Do our lint settings cover this?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1167#discussion_r488966202", "createdAt": "2020-09-15T20:52:58Z", "author": {"login": "bamandel"}, "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "diffHunk": "@@ -4,6 +4,7 @@ import TableDisplay from 'field/TableDisplay';\n import DynamicSelectInput from 'field/input/DynamicSelect';\n import CheckboxInput from 'field/input/CheckboxInput';\n import { CONTEXT_TYPE } from 'util/descriptorUtilities';\n+import StatusMessage from '../../../field/StatusMessage';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1NjkyNg=="}, "originalCommit": {"oid": "8a3a47e7065d54637b090170fcb28cdbd38383c7"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM4MjU0MQ==", "bodyText": "The linting thinks that the absolute paths are wrong because it cannot resolve the path from the current location where the file is located.  Currently it does not catch this.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1167#discussion_r489382541", "createdAt": "2020-09-16T12:02:37Z", "author": {"login": "psantos1113"}, "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "diffHunk": "@@ -4,6 +4,7 @@ import TableDisplay from 'field/TableDisplay';\n import DynamicSelectInput from 'field/input/DynamicSelect';\n import CheckboxInput from 'field/input/CheckboxInput';\n import { CONTEXT_TYPE } from 'util/descriptorUtilities';\n+import StatusMessage from '../../../field/StatusMessage';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk1NjkyNg=="}, "originalCommit": {"oid": "8a3a47e7065d54637b090170fcb28cdbd38383c7"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MjA4NTc1OnYy", "diffSide": "RIGHT", "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjowNTo0OVrOHStpDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMjowNTo0OVrOHStpDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM4NDIwNQ==", "bodyText": "Same as above use 'Authentication' not 'Settings'", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1167#discussion_r489384205", "createdAt": "2020-09-16T12:05:49Z", "author": {"login": "psantos1113"}, "path": "src/main/js/dynamic/loaded/users/PermissionTable.js", "diffHunk": "@@ -178,11 +204,44 @@ class PermissionTable extends Component {\n     }\n \n     createPermissionsModal() {\n-        const { permissionsData } = this.state;\n+        const { permissionsData, errorMessage } = this.state;\n+\n+        let uploadInputs;\n+        // Currently, there does not seem to be a good way to filter this dynamically.\n+        // For now, restrict upload permissions to 'Settings'.\n+        if (permissionsData && permissionsData.descriptorName === 'Settings') {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a3a47e7065d54637b090170fcb28cdbd38383c7"}, "originalPosition": 73}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1748, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}