{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzNzk5NTU1", "number": 895, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOToyOTo0NVrODlLH-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo1MzowMlrODlLnKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzA2MTcwOnYy", "diffSide": "RIGHT", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOToyOTo0NVrOFx6p2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo1NjozN1rOFx7j4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NTUyOA==", "bodyText": "Why not add @Nullable, javax.annotation.Nullable, to the nullableTopLevelAction?\npublic String getCommonTopic(MessageContentGroup messageContent, @Nullable ItemOperation nullableTopLevelAction) {", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387885528", "createdAt": "2020-03-04T19:29:45Z", "author": {"login": "jamesrichard91"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkwMDM4NA==", "bodyText": "We don't have a standardized use of this and even if it is null, it is used in a null-safe way.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387900384", "createdAt": "2020-03-04T19:56:37Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NTUyOA=="}, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzA2MzcyOnYy", "diffSide": "RIGHT", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTozMDoxOVrOFx6rKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTozMDoxOVrOFx6rKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NTg2Ng==", "bodyText": "Why not add @Nullable, javax.annotation.Nullable, to the nullableTopLevelAction?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387885866", "createdAt": "2020-03-04T19:30:19Z", "author": {"login": "jamesrichard91"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {\n+        LinkableItem commonTopic = messageContent.getCommonTopic();\n+        if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+            commonTopic = new LinkableItem(commonTopic.getName(), commonTopic.getValue());\n+        }\n+        return createLinkableItemString(commonTopic, true) + getLineSeparator();\n     }\n \n-    public String getComponentSubTopic(ProviderMessageContent messageContent) {\n-        return messageContent.getSubTopic()\n-                   .map(item -> createLinkableItemString(item, true))\n-                   .orElse(\"\");\n+    public String getComponentSubTopic(ProviderMessageContent messageContent, ItemOperation nullableTopLevelAction) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzA2NzM4OnYy", "diffSide": "RIGHT", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTozMToxN1rOFx6tbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMDowNzozNlrOFx76FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NjQ0Ng==", "bodyText": "Why not add @Nullable, javax.annotation.Nullable, to the returned ItemOperation?\nprotected @Nullable ItemOperation getNullableTopLevelAction(MessageContentGroup messageContentGroup) {", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387886446", "createdAt": "2020-03-04T19:31:17Z", "author": {"login": "jamesrichard91"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -329,4 +341,14 @@ protected String createLinkableItemValueString(LinkableItem linkableItem) {\n                    .findAny();\n     }\n \n+    protected ItemOperation getNullableTopLevelAction(MessageContentGroup messageContentGroup) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkwMjEyOQ==", "bodyText": "Or the return type should be Optional<ItemOperation>", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387902129", "createdAt": "2020-03-04T19:59:44Z", "author": {"login": "jamesrichard91"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -329,4 +341,14 @@ protected String createLinkableItemValueString(LinkableItem linkableItem) {\n                    .findAny();\n     }\n \n+    protected ItemOperation getNullableTopLevelAction(MessageContentGroup messageContentGroup) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NjQ0Ng=="}, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkwNjA2OA==", "bodyText": "Perhaps.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387906068", "createdAt": "2020-03-04T20:07:36Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -329,4 +341,14 @@ protected String createLinkableItemValueString(LinkableItem linkableItem) {\n                    .findAny();\n     }\n \n+    protected ItemOperation getNullableTopLevelAction(MessageContentGroup messageContentGroup) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg4NjQ0Ng=="}, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzEwMDcyOnYy", "diffSide": "RIGHT", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo0MTowOVrOFx7CXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxNDozNzozNlrOFyV_Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5MTgwNw==", "bodyText": "When should we use the ternary operator vs something like this?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387891807", "createdAt": "2020-03-04T19:41:09Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {\n+        LinkableItem commonTopic = messageContent.getCommonTopic();\n+        if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+            commonTopic = new LinkableItem(commonTopic.getName(), commonTopic.getValue());\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODMzMjUwNQ==", "bodyText": "This is gonna sound weird, but I think a \"three dot\" maximum should be the rule of thumb. If dereferencing is happening more than three times, it should not be part of a ternary operation.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r388332505", "createdAt": "2020-03-05T14:36:16Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {\n+        LinkableItem commonTopic = messageContent.getCommonTopic();\n+        if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+            commonTopic = new LinkableItem(commonTopic.getName(), commonTopic.getValue());\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5MTgwNw=="}, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODMzMzM1OQ==", "bodyText": "That goes for the calling class as well, think of method calls as this.doSomething().", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r388333359", "createdAt": "2020-03-05T14:37:36Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {\n+        LinkableItem commonTopic = messageContent.getCommonTopic();\n+        if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+            commonTopic = new LinkableItem(commonTopic.getName(), commonTopic.getValue());\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5MTgwNw=="}, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzEwMjY3OnYy", "diffSide": "RIGHT", "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo0MTo0MVrOFx7DlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo0MTo0MVrOFx7DlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5MjExNg==", "bodyText": "Another possible location for ternary operator", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387892116", "createdAt": "2020-03-04T19:41:41Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/channel/message/ChannelMessageParser.java", "diffHunk": "@@ -77,14 +79,24 @@ public String createHeader(MessageContentGroup messageContentGroup) {\n         return headerSeparator;\n     }\n \n-    public String getCommonTopic(MessageContentGroup messageContentGroup) {\n-        return createLinkableItemString(messageContentGroup.getCommonTopic(), true) + getLineSeparator();\n+    public String getCommonTopic(MessageContentGroup messageContent, ItemOperation nullableTopLevelAction) {\n+        LinkableItem commonTopic = messageContent.getCommonTopic();\n+        if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+            commonTopic = new LinkableItem(commonTopic.getName(), commonTopic.getValue());\n+        }\n+        return createLinkableItemString(commonTopic, true) + getLineSeparator();\n     }\n \n-    public String getComponentSubTopic(ProviderMessageContent messageContent) {\n-        return messageContent.getSubTopic()\n-                   .map(item -> createLinkableItemString(item, true))\n-                   .orElse(\"\");\n+    public String getComponentSubTopic(ProviderMessageContent messageContent, ItemOperation nullableTopLevelAction) {\n+        Optional<LinkableItem> optionalSubTopic = messageContent.getSubTopic();\n+        if (optionalSubTopic.isPresent()) {\n+            LinkableItem subTopic = optionalSubTopic.get();\n+            if (ItemOperation.DELETE.equals(nullableTopLevelAction)) {\n+                subTopic = new LinkableItem(subTopic.getName(), subTopic.getValue());\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzE0MTU1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/actions/BlackDuckGlobalApiAction.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo1MzowMlrOFx7cew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxOTo1ODozN1rOFx7oQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5ODQ5MQ==", "bodyText": "By removing the default \"-1\" aren't you opening this up to possible NPE's?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387898491", "createdAt": "2020-03-04T19:53:02Z", "author": {"login": "jamesrichard91"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/actions/BlackDuckGlobalApiAction.java", "diffHunk": "@@ -77,8 +81,8 @@ public void afterDeleteAction(FieldModel fieldModel) {\n         FieldValueModel fieldValueModel = keyToValues.get(ProviderDescriptor.KEY_PROVIDER_CONFIG_NAME);\n         String blackDuckGlobalConfigName = fieldValueModel.getValue().orElse(\"\");\n \n-        Long configId = Long.parseLong(Objects.requireNonNullElse(fieldModel.getId(), \"-1\"));\n-        providerLifecycleManager.unscheduleTasksForProviderConfig(blackDuckProvider, configId);\n+        Long configId = Long.parseLong(fieldModel.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkwMTUwNw==", "bodyText": "There is no way for this config to be deleted without the id, so it will always be present or error out before it gets here.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/895#discussion_r387901507", "createdAt": "2020-03-04T19:58:37Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/provider/blackduck/actions/BlackDuckGlobalApiAction.java", "diffHunk": "@@ -77,8 +81,8 @@ public void afterDeleteAction(FieldModel fieldModel) {\n         FieldValueModel fieldValueModel = keyToValues.get(ProviderDescriptor.KEY_PROVIDER_CONFIG_NAME);\n         String blackDuckGlobalConfigName = fieldValueModel.getValue().orElse(\"\");\n \n-        Long configId = Long.parseLong(Objects.requireNonNullElse(fieldModel.getId(), \"-1\"));\n-        providerLifecycleManager.unscheduleTasksForProviderConfig(blackDuckProvider, configId);\n+        Long configId = Long.parseLong(fieldModel.getId());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg5ODQ5MQ=="}, "originalCommit": {"oid": "a591869033e8f08d2b6b4f9e6ac98397f5d85067"}, "originalPosition": 52}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2163, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}