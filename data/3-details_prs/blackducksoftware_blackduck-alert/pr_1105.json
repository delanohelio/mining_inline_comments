{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MTc4MTI4", "number": 1105, "title": "Azure AD SAML Fixes", "bodyText": "Fix the SAML functionality to work with Azure AD SAML.  Needed to disable signature verification to avoid the certificate errors.  Then needed to add an additional metadata provider to create the SAML hand shake.", "createdAt": "2020-08-06T17:52:42Z", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1105", "merged": true, "mergeCommit": {"oid": "1734716e64b19bad5dede6ef58cec2bafd1c7711"}, "closed": true, "closedAt": "2020-08-07T13:43:20Z", "author": {"login": "psantos1113"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6azGPAH2gAyNDY0MTc4MTI4OmYwOWQzYjBkNDM5MTg5OGQ5ODhhOTYxMGY4MTQwNjllMGE3MTk2Mjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8T2G1AFqTQ2Mjc2MDI0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f09d3b0d4391898d988a9610f814069e0a719628", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f09d3b0d4391898d988a9610f814069e0a719628", "committedDate": "2020-07-31T21:07:02Z", "message": "fix: Use the same keystore for SAML certificates."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5b968d157e05b59bc23e610112da91770f3f865", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/f5b968d157e05b59bc23e610112da91770f3f865", "committedDate": "2020-08-03T18:03:18Z", "message": "fix: Disable trust check on metadata"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b62685627bd766751fb8867beec98bf2b26f7131", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/b62685627bd766751fb8867beec98bf2b26f7131", "committedDate": "2020-08-04T18:08:23Z", "message": "Merge remote-tracking branch 'origin/master' into ps_saml_keymanager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db11e4f8679dd46d7e93c5a8228518cb540921cd", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/db11e4f8679dd46d7e93c5a8228518cb540921cd", "committedDate": "2020-08-06T12:53:35Z", "message": "fix: Add the in memory metadata provider for Azure support."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "368e743c5b08762a27ad1ac84af5514d84cae07b", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/368e743c5b08762a27ad1ac84af5514d84cae07b", "committedDate": "2020-08-06T14:03:41Z", "message": "build: update the version to be unique for testing."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0e65bac6cd84c6d98834b663b44b6020b538e67", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/b0e65bac6cd84c6d98834b663b44b6020b538e67", "committedDate": "2020-08-06T17:21:09Z", "message": "chore: Add a comment indicating the fix for Azure SAML."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69efd53e05f7f036312a0df39e011925df9a7f2a", "author": {"user": {"login": "psantos1113", "name": null}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/69efd53e05f7f036312a0df39e011925df9a7f2a", "committedDate": "2020-08-06T17:28:04Z", "message": "refactor: Remove certificate utility."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNzUwNjkx", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1105#pullrequestreview-462750691", "createdAt": "2020-08-06T17:55:37Z", "commit": {"oid": "69efd53e05f7f036312a0df39e011925df9a7f2a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNzUzNjE5", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1105#pullrequestreview-462753619", "createdAt": "2020-08-06T17:59:28Z", "commit": {"oid": "69efd53e05f7f036312a0df39e011925df9a7f2a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNzo1OToyOFrOG8-Z7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxNzo1OToyOFrOG8-Z7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5MDE4OA==", "bodyText": "Is there something Alert can do to act as a proxy for this check (i.e. if Alert has the certificate imported) or is this not an SSL trust check?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1105#discussion_r466590188", "createdAt": "2020-08-06T17:59:28Z", "author": {"login": "gkillough"}, "path": "src/main/java/com/synopsys/integration/alert/web/security/authentication/saml/SAMLManager.java", "diffHunk": "@@ -142,10 +147,23 @@ public void setupMetadataManager(String metadataURL, String entityId, String ent\n         return Optional.of(createDelegate(provider));\n     }\n \n+    // This needs to be created in order for Azure AD SAML configuration to work. The entity id in the metadata is different\n+    // than the entity id configured in Azure.  This allows the the entity id to get mapped and found correctly for the application.\n+    private Optional<ExtendedMetadataDelegate> createMemoryProvider() throws MetadataProviderException {\n+        EntityDescriptor descriptor = metadataGenerator.generateMetadata();\n+        MetadataMemoryProvider provider = new MetadataMemoryProvider(descriptor);\n+        provider.initialize();\n+        return Optional.of(createDelegate(provider));\n+    }\n+\n     private ExtendedMetadataDelegate createDelegate(MetadataProvider provider) {\n         ExtendedMetadataDelegate delegate = new ExtendedMetadataDelegate(provider, extendedMetadata);\n-        delegate.setMetadataTrustCheck(true);\n+        delegate.setMetadataTrustCheck(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69efd53e05f7f036312a0df39e011925df9a7f2a"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNzU2MDIy", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1105#pullrequestreview-462756022", "createdAt": "2020-08-06T18:02:51Z", "commit": {"oid": "69efd53e05f7f036312a0df39e011925df9a7f2a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNzYwMjQ2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1105#pullrequestreview-462760246", "createdAt": "2020-08-06T18:08:50Z", "commit": {"oid": "69efd53e05f7f036312a0df39e011925df9a7f2a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3383, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}