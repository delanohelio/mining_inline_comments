{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4MTA3NTQy", "number": 1250, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMTo1MDoyM1rOE3MNjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNToyODo1OVrOE3R7Rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzA3MjE0OnYy", "diffSide": "RIGHT", "path": "alert-database/src/main/java/com/synopsys/integration/alert/database/api/DefaultProviderDataAccessor.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMTo1MDoyM1rOHwZBFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDoyMDowMFrOHwevHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDUwMzU3Mw==", "bodyText": "Can this class be deleted since the BlackDuckProviderDataAccessor now exists.  And in the past DefaultProviderDataAccessor was the only ProviderDataAccessor implementation once we removed support for Polaris.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1250#discussion_r520503573", "createdAt": "2020-11-10T11:50:23Z", "author": {"login": "psantos1113"}, "path": "alert-database/src/main/java/com/synopsys/integration/alert/database/api/DefaultProviderDataAccessor.java", "diffHunk": "@@ -54,7 +53,8 @@\n \n @Component\n @Transactional\n-public class DefaultProviderDataAccessor implements ProviderDataAccessor {\n+public class DefaultProviderDataAccessor {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f336df3339ac89bed293d17a33b3edccde4ca78"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU4NjU3MA==", "bodyText": "We want to keep this class around along with the provider data tables. The changes I made to this class for now should render this class unused until we decide to delete it.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1250#discussion_r520586570", "createdAt": "2020-11-10T14:05:44Z", "author": {"login": "jamesrichard91"}, "path": "alert-database/src/main/java/com/synopsys/integration/alert/database/api/DefaultProviderDataAccessor.java", "diffHunk": "@@ -54,7 +53,8 @@\n \n @Component\n @Transactional\n-public class DefaultProviderDataAccessor implements ProviderDataAccessor {\n+public class DefaultProviderDataAccessor {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDUwMzU3Mw=="}, "originalCommit": {"oid": "0f336df3339ac89bed293d17a33b3edccde4ca78"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5NzI3Nw==", "bodyText": "I do think we want to add @Deprecated here just to make sure people don't try to use this whether in tests or production.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1250#discussion_r520597277", "createdAt": "2020-11-10T14:20:00Z", "author": {"login": "gkillough"}, "path": "alert-database/src/main/java/com/synopsys/integration/alert/database/api/DefaultProviderDataAccessor.java", "diffHunk": "@@ -54,7 +53,8 @@\n \n @Component\n @Transactional\n-public class DefaultProviderDataAccessor implements ProviderDataAccessor {\n+public class DefaultProviderDataAccessor {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDUwMzU3Mw=="}, "originalCommit": {"oid": "0f336df3339ac89bed293d17a33b3edccde4ca78"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzQ4Nzc5OnYy", "diffSide": "RIGHT", "path": "channel/src/main/java/com/synopsys/integration/alert/channel/email/EmailAddressHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzo0MDoyN1rOHwc_Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzo0MDoyN1rOHwc_Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2ODYzMQ==", "bodyText": "providerConfigID and providerConfigId are both used in this class. We should stick to one capitalization strategy.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1250#discussion_r520568631", "createdAt": "2020-11-10T13:40:27Z", "author": {"login": "gkillough"}, "path": "channel/src/main/java/com/synopsys/integration/alert/channel/email/EmailAddressHandler.java", "diffHunk": "@@ -93,7 +93,7 @@ public FieldUtility updateEmailAddresses(Long providerConfigId, MessageContentGr\n         return new FieldUtility(fieldMap);\n     }\n \n-    public Set<String> getEmailAddressesForProject(ProviderProject project, boolean projectOwnerOnly) {\n+    public Set<String> getEmailAddressesForProject(Long providerConfigID, ProviderProject project, boolean projectOwnerOnly) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f336df3339ac89bed293d17a33b3edccde4ca78"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzQ5NTk0OnYy", "diffSide": "RIGHT", "path": "alert-database/src/main/java/com/synopsys/integration/alert/database/api/DefaultProviderDataAccessor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzo0MjowOVrOHwdD8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzo0MjowOVrOHwdD8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2OTg0Mw==", "bodyText": "We should delete all of these commented annotations and worry about re-adding them if we ever want to implement the interface again.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1250#discussion_r520569843", "createdAt": "2020-11-10T13:42:09Z", "author": {"login": "gkillough"}, "path": "alert-database/src/main/java/com/synopsys/integration/alert/database/api/DefaultProviderDataAccessor.java", "diffHunk": "@@ -73,7 +73,7 @@ public DefaultProviderDataAccessor(ProviderProjectRepository providerProjectRepo\n         this.configurationAccessor = configurationAccessor;\n     }\n \n-    @Override\n+    //    @Override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f336df3339ac89bed293d17a33b3edccde4ca78"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2Mzk5NTM3OnYy", "diffSide": "RIGHT", "path": "provider/src/main/java/com/synopsys/integration/alert/database/api/BlackDuckProviderDataAccessor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNToyNjoxNlrOHwh7NA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNTozMTo0M1rOHwiMow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY0OTUyNA==", "bodyText": "For API's we have a response NOT_IMPLEMENTED. is there some similar runtime exception we could throw here?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1250#discussion_r520649524", "createdAt": "2020-11-10T15:26:16Z", "author": {"login": "bamandel"}, "path": "provider/src/main/java/com/synopsys/integration/alert/database/api/BlackDuckProviderDataAccessor.java", "diffHunk": "@@ -0,0 +1,220 @@\n+/**\n+ * provider\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.database.api;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.persistence.accessor.ConfigurationAccessor;\n+import com.synopsys.integration.alert.common.persistence.accessor.ProviderDataAccessor;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n+import com.synopsys.integration.alert.common.persistence.model.ProviderProject;\n+import com.synopsys.integration.alert.common.persistence.model.ProviderUserModel;\n+import com.synopsys.integration.alert.provider.blackduck.BlackDuckProperties;\n+import com.synopsys.integration.alert.provider.blackduck.factory.BlackDuckPropertiesFactory;\n+import com.synopsys.integration.blackduck.api.generated.discovery.ApiDiscovery;\n+import com.synopsys.integration.blackduck.api.generated.view.ProjectView;\n+import com.synopsys.integration.blackduck.api.generated.view.UserView;\n+import com.synopsys.integration.blackduck.http.client.BlackDuckHttpClient;\n+import com.synopsys.integration.blackduck.service.BlackDuckService;\n+import com.synopsys.integration.blackduck.service.BlackDuckServicesFactory;\n+import com.synopsys.integration.blackduck.service.dataservice.ProjectService;\n+import com.synopsys.integration.blackduck.service.dataservice.ProjectUsersService;\n+import com.synopsys.integration.exception.IntegrationException;\n+import com.synopsys.integration.log.IntLogger;\n+import com.synopsys.integration.log.Slf4jIntLogger;\n+import com.synopsys.integration.rest.HttpUrl;\n+\n+@Component\n+public class BlackDuckProviderDataAccessor implements ProviderDataAccessor {\n+    private final IntLogger logger = new Slf4jIntLogger(LoggerFactory.getLogger(BlackDuckProviderDataAccessor.class));\n+    private final ConfigurationAccessor configurationAccessor;\n+    private final BlackDuckPropertiesFactory blackDuckPropertiesFactory;\n+\n+    @Autowired\n+    public BlackDuckProviderDataAccessor(ConfigurationAccessor configurationAccessor, BlackDuckPropertiesFactory blackDuckPropertiesFactory) {\n+        this.configurationAccessor = configurationAccessor;\n+        this.blackDuckPropertiesFactory = blackDuckPropertiesFactory;\n+    }\n+\n+    @Override\n+    public List<ProviderProject> getProjectsByProviderConfigName(String providerConfigName) {\n+        try {\n+            Optional<ConfigurationModel> providerConfigOptional = configurationAccessor.getProviderConfigurationByName(providerConfigName);\n+            if (providerConfigOptional.isPresent()) {\n+                return getProjectsForProvider(providerConfigOptional.get());\n+            }\n+        } catch (IntegrationException e) {\n+            logger.error(String.format(\"Could not get the project for the provider '%s'. %s\", providerConfigName, e.getMessage()));\n+            logger.debug(e.getMessage(), e);\n+        }\n+        return List.of();\n+    }\n+\n+    @Override\n+    public List<ProviderProject> getProjectsByProviderConfigId(Long providerConfigId) {\n+        try {\n+            Optional<ConfigurationModel> providerConfigOptional = configurationAccessor.getConfigurationById(providerConfigId);\n+            if (providerConfigOptional.isPresent()) {\n+                return getProjectsForProvider(providerConfigOptional.get());\n+            }\n+        } catch (IntegrationException e) {\n+            logger.error(String.format(\"Could not get the project for the provider with id '%s'. %s\", providerConfigId, e.getMessage()));\n+            logger.debug(e.getMessage(), e);\n+        }\n+        return List.of();\n+    }\n+\n+    private List<ProviderProject> getProjectsForProvider(ConfigurationModel blackDuckConfigurationModel) throws IntegrationException {\n+        BlackDuckProperties properties = blackDuckPropertiesFactory.createProperties(blackDuckConfigurationModel);\n+        BlackDuckHttpClient blackDuckHttpClient = properties.createBlackDuckHttpClient(logger);\n+        BlackDuckServicesFactory blackDuckServicesFactory = properties.createBlackDuckServicesFactory(blackDuckHttpClient, logger);\n+        ProjectService projectService = blackDuckServicesFactory.createProjectService();\n+        List<ProjectView> allProjects = projectService.getAllProjects();\n+        return convertBlackDuckProjects(allProjects, blackDuckServicesFactory.getBlackDuckService());\n+    }\n+\n+    @Override\n+    public void deleteProjects(Collection<ProviderProject> providerProjects) {\n+        //ignored since we are not using the database", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a7a52a086c5e9aa07cbeff150c5a658a96bc97b"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY1Mzk4Nw==", "bodyText": "We don't want this to throw an exception. We want this class to be used in place of the DefaultProviderDataAccessor so that it will have minimal impact", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1250#discussion_r520653987", "createdAt": "2020-11-10T15:31:43Z", "author": {"login": "jamesrichard91"}, "path": "provider/src/main/java/com/synopsys/integration/alert/database/api/BlackDuckProviderDataAccessor.java", "diffHunk": "@@ -0,0 +1,220 @@\n+/**\n+ * provider\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.database.api;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.persistence.accessor.ConfigurationAccessor;\n+import com.synopsys.integration.alert.common.persistence.accessor.ProviderDataAccessor;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n+import com.synopsys.integration.alert.common.persistence.model.ProviderProject;\n+import com.synopsys.integration.alert.common.persistence.model.ProviderUserModel;\n+import com.synopsys.integration.alert.provider.blackduck.BlackDuckProperties;\n+import com.synopsys.integration.alert.provider.blackduck.factory.BlackDuckPropertiesFactory;\n+import com.synopsys.integration.blackduck.api.generated.discovery.ApiDiscovery;\n+import com.synopsys.integration.blackduck.api.generated.view.ProjectView;\n+import com.synopsys.integration.blackduck.api.generated.view.UserView;\n+import com.synopsys.integration.blackduck.http.client.BlackDuckHttpClient;\n+import com.synopsys.integration.blackduck.service.BlackDuckService;\n+import com.synopsys.integration.blackduck.service.BlackDuckServicesFactory;\n+import com.synopsys.integration.blackduck.service.dataservice.ProjectService;\n+import com.synopsys.integration.blackduck.service.dataservice.ProjectUsersService;\n+import com.synopsys.integration.exception.IntegrationException;\n+import com.synopsys.integration.log.IntLogger;\n+import com.synopsys.integration.log.Slf4jIntLogger;\n+import com.synopsys.integration.rest.HttpUrl;\n+\n+@Component\n+public class BlackDuckProviderDataAccessor implements ProviderDataAccessor {\n+    private final IntLogger logger = new Slf4jIntLogger(LoggerFactory.getLogger(BlackDuckProviderDataAccessor.class));\n+    private final ConfigurationAccessor configurationAccessor;\n+    private final BlackDuckPropertiesFactory blackDuckPropertiesFactory;\n+\n+    @Autowired\n+    public BlackDuckProviderDataAccessor(ConfigurationAccessor configurationAccessor, BlackDuckPropertiesFactory blackDuckPropertiesFactory) {\n+        this.configurationAccessor = configurationAccessor;\n+        this.blackDuckPropertiesFactory = blackDuckPropertiesFactory;\n+    }\n+\n+    @Override\n+    public List<ProviderProject> getProjectsByProviderConfigName(String providerConfigName) {\n+        try {\n+            Optional<ConfigurationModel> providerConfigOptional = configurationAccessor.getProviderConfigurationByName(providerConfigName);\n+            if (providerConfigOptional.isPresent()) {\n+                return getProjectsForProvider(providerConfigOptional.get());\n+            }\n+        } catch (IntegrationException e) {\n+            logger.error(String.format(\"Could not get the project for the provider '%s'. %s\", providerConfigName, e.getMessage()));\n+            logger.debug(e.getMessage(), e);\n+        }\n+        return List.of();\n+    }\n+\n+    @Override\n+    public List<ProviderProject> getProjectsByProviderConfigId(Long providerConfigId) {\n+        try {\n+            Optional<ConfigurationModel> providerConfigOptional = configurationAccessor.getConfigurationById(providerConfigId);\n+            if (providerConfigOptional.isPresent()) {\n+                return getProjectsForProvider(providerConfigOptional.get());\n+            }\n+        } catch (IntegrationException e) {\n+            logger.error(String.format(\"Could not get the project for the provider with id '%s'. %s\", providerConfigId, e.getMessage()));\n+            logger.debug(e.getMessage(), e);\n+        }\n+        return List.of();\n+    }\n+\n+    private List<ProviderProject> getProjectsForProvider(ConfigurationModel blackDuckConfigurationModel) throws IntegrationException {\n+        BlackDuckProperties properties = blackDuckPropertiesFactory.createProperties(blackDuckConfigurationModel);\n+        BlackDuckHttpClient blackDuckHttpClient = properties.createBlackDuckHttpClient(logger);\n+        BlackDuckServicesFactory blackDuckServicesFactory = properties.createBlackDuckServicesFactory(blackDuckHttpClient, logger);\n+        ProjectService projectService = blackDuckServicesFactory.createProjectService();\n+        List<ProjectView> allProjects = projectService.getAllProjects();\n+        return convertBlackDuckProjects(allProjects, blackDuckServicesFactory.getBlackDuckService());\n+    }\n+\n+    @Override\n+    public void deleteProjects(Collection<ProviderProject> providerProjects) {\n+        //ignored since we are not using the database", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY0OTUyNA=="}, "originalCommit": {"oid": "9a7a52a086c5e9aa07cbeff150c5a658a96bc97b"}, "originalPosition": 109}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NDAwODM5OnYy", "diffSide": "RIGHT", "path": "provider/src/main/java/com/synopsys/integration/alert/database/api/BlackDuckProviderDataAccessor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNToyODo1OVrOHwiDhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNToyODo1OVrOHwiDhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY1MTY1NQ==", "bodyText": "All other methods return a List. Why is this one specifically a set? I feel we should return all lists or all sets to be consistent", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1250#discussion_r520651655", "createdAt": "2020-11-10T15:28:59Z", "author": {"login": "bamandel"}, "path": "provider/src/main/java/com/synopsys/integration/alert/database/api/BlackDuckProviderDataAccessor.java", "diffHunk": "@@ -0,0 +1,220 @@\n+/**\n+ * provider\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.database.api;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+import com.synopsys.integration.alert.common.persistence.accessor.ConfigurationAccessor;\n+import com.synopsys.integration.alert.common.persistence.accessor.ProviderDataAccessor;\n+import com.synopsys.integration.alert.common.persistence.model.ConfigurationModel;\n+import com.synopsys.integration.alert.common.persistence.model.ProviderProject;\n+import com.synopsys.integration.alert.common.persistence.model.ProviderUserModel;\n+import com.synopsys.integration.alert.provider.blackduck.BlackDuckProperties;\n+import com.synopsys.integration.alert.provider.blackduck.factory.BlackDuckPropertiesFactory;\n+import com.synopsys.integration.blackduck.api.generated.discovery.ApiDiscovery;\n+import com.synopsys.integration.blackduck.api.generated.view.ProjectView;\n+import com.synopsys.integration.blackduck.api.generated.view.UserView;\n+import com.synopsys.integration.blackduck.http.client.BlackDuckHttpClient;\n+import com.synopsys.integration.blackduck.service.BlackDuckService;\n+import com.synopsys.integration.blackduck.service.BlackDuckServicesFactory;\n+import com.synopsys.integration.blackduck.service.dataservice.ProjectService;\n+import com.synopsys.integration.blackduck.service.dataservice.ProjectUsersService;\n+import com.synopsys.integration.exception.IntegrationException;\n+import com.synopsys.integration.log.IntLogger;\n+import com.synopsys.integration.log.Slf4jIntLogger;\n+import com.synopsys.integration.rest.HttpUrl;\n+\n+@Component\n+public class BlackDuckProviderDataAccessor implements ProviderDataAccessor {\n+    private final IntLogger logger = new Slf4jIntLogger(LoggerFactory.getLogger(BlackDuckProviderDataAccessor.class));\n+    private final ConfigurationAccessor configurationAccessor;\n+    private final BlackDuckPropertiesFactory blackDuckPropertiesFactory;\n+\n+    @Autowired\n+    public BlackDuckProviderDataAccessor(ConfigurationAccessor configurationAccessor, BlackDuckPropertiesFactory blackDuckPropertiesFactory) {\n+        this.configurationAccessor = configurationAccessor;\n+        this.blackDuckPropertiesFactory = blackDuckPropertiesFactory;\n+    }\n+\n+    @Override\n+    public List<ProviderProject> getProjectsByProviderConfigName(String providerConfigName) {\n+        try {\n+            Optional<ConfigurationModel> providerConfigOptional = configurationAccessor.getProviderConfigurationByName(providerConfigName);\n+            if (providerConfigOptional.isPresent()) {\n+                return getProjectsForProvider(providerConfigOptional.get());\n+            }\n+        } catch (IntegrationException e) {\n+            logger.error(String.format(\"Could not get the project for the provider '%s'. %s\", providerConfigName, e.getMessage()));\n+            logger.debug(e.getMessage(), e);\n+        }\n+        return List.of();\n+    }\n+\n+    @Override\n+    public List<ProviderProject> getProjectsByProviderConfigId(Long providerConfigId) {\n+        try {\n+            Optional<ConfigurationModel> providerConfigOptional = configurationAccessor.getConfigurationById(providerConfigId);\n+            if (providerConfigOptional.isPresent()) {\n+                return getProjectsForProvider(providerConfigOptional.get());\n+            }\n+        } catch (IntegrationException e) {\n+            logger.error(String.format(\"Could not get the project for the provider with id '%s'. %s\", providerConfigId, e.getMessage()));\n+            logger.debug(e.getMessage(), e);\n+        }\n+        return List.of();\n+    }\n+\n+    private List<ProviderProject> getProjectsForProvider(ConfigurationModel blackDuckConfigurationModel) throws IntegrationException {\n+        BlackDuckProperties properties = blackDuckPropertiesFactory.createProperties(blackDuckConfigurationModel);\n+        BlackDuckHttpClient blackDuckHttpClient = properties.createBlackDuckHttpClient(logger);\n+        BlackDuckServicesFactory blackDuckServicesFactory = properties.createBlackDuckServicesFactory(blackDuckHttpClient, logger);\n+        ProjectService projectService = blackDuckServicesFactory.createProjectService();\n+        List<ProjectView> allProjects = projectService.getAllProjects();\n+        return convertBlackDuckProjects(allProjects, blackDuckServicesFactory.getBlackDuckService());\n+    }\n+\n+    @Override\n+    public void deleteProjects(Collection<ProviderProject> providerProjects) {\n+        //ignored since we are not using the database\n+    }\n+\n+    @Override\n+    public Set<String> getEmailAddressesForProjectHref(Long providerConfigId, String projectHref) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a7a52a086c5e9aa07cbeff150c5a658a96bc97b"}, "originalPosition": 113}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2187, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}