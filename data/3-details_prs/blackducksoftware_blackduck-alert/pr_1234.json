{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExNjM0MTE5", "number": 1234, "title": "Add an additional audit logger for Alert", "bodyText": "The focus of this branch was to create additional logging around users and roles due to issues in the past with customers changing user/role permissions and encountering issues that support ends up missing. With this change we are introducing a new AlertLoggerFactory that creates a new AlertCompositeLogger which is 2 loggers working in tandem but outputting to different locations. The messages created by the \"alertAudit\" logger will always be logged at the trace level and be output into a new alertAudit.log file under the log directory. This way the user will still be able to preserve the blackduck-alert.log and console logs to the levels they have provided in the application.properties.\nThis should have no impact on the existing base logger that spring is using and will only be used by classes using the AlertLoggerFactory rather than LoggerFactory.", "createdAt": "2020-10-28T15:26:45Z", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234", "merged": true, "mergeCommit": {"oid": "3efe6cc057fa7304e9b0c559078934eff8159551"}, "closed": true, "closedAt": "2020-10-29T18:52:24Z", "author": {"login": "ChomickiM"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdS26gZgH2gAyNTExNjM0MTE5OjA2NTc4NmRmZmRkMDk3YmUzZmFlYTY0MjY0ODYwODI3MDhjZTkzZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXSRj9AH2gAyNTExNjM0MTE5OjdkOWYwMDhkZDFhMGQ4NmE4NTk1YmYyZDJiMDBkZGVjY2I0YzcxZTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "065786dffdd097be3faea6426486082708ce93e3", "author": {"user": {"login": "ChomickiM", "name": "Martin"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/065786dffdd097be3faea6426486082708ce93e3", "committedDate": "2020-10-15T19:26:39Z", "message": "feat: Add AlertLoggerFactory to log additional trace level messages into an audit log"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7038314b3d3a39f0472a20628939c43132d9300", "author": {"user": {"login": "ChomickiM", "name": "Martin"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/c7038314b3d3a39f0472a20628939c43132d9300", "committedDate": "2020-10-15T19:32:17Z", "message": "Merge branch 'master' into mc_audit_logger_refactor\n\n# Conflicts:\n#\talert-common/src/main/java/com/synopsys/integration/alert/common/action/api/AbstractResourceActions.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d", "author": {"user": {"login": "ChomickiM", "name": "Martin"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/9f543990d4449b1d052331da8adb1b236e0b253d", "committedDate": "2020-10-28T14:19:07Z", "message": "Merge branch 'master' into mc_audit_logger_refactor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4Nzk2MTM2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-518796136", "createdAt": "2020-10-28T15:33:17Z", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTozMzoxN1rOHpwJGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTozMzoxN1rOHpwJGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU0MjQyNg==", "bodyText": "This blank line can be removed.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#discussion_r513542426", "createdAt": "2020-10-28T15:33:17Z", "author": {"login": "gkillough"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/logging/AlertLoggerFactory.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/**\n+ * alert-common\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.common.logging;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class AlertLoggerFactory {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4ODAwOTM2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-518800936", "createdAt": "2020-10-28T15:37:31Z", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTozNzozMVrOHpwW4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTozNzozMVrOHpwW4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU0NTk1NQ==", "bodyText": "This seems a little small. What made you choose this default value? I realized that it's a rolling log file, but it seems like this size could produce a lot of files. I would expect somewhere between 50MB and 250MB.", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#discussion_r513545955", "createdAt": "2020-10-28T15:37:31Z", "author": {"login": "gkillough"}, "path": "src/main/resources/logback-spring.xml", "diffHunk": "@@ -0,0 +1,24 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<configuration>\n+\n+    <include resource=\"org/springframework/boot/logging/logback/base.xml\"/>\n+\n+    <appender name=\"ALERT_AUDIT\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\">\n+        <encoder>\n+\t\t\t<pattern>${FILE_LOG_PATTERN}</pattern>\n+\t\t</encoder>\n+\t\t<file>log/alertAudit.log</file>\n+\t\t<rollingPolicy class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy\">\n+\t\t\t<cleanHistoryOnStart>${LOG_FILE_CLEAN_HISTORY_ON_START:-false}</cleanHistoryOnStart>\n+\t\t\t<fileNamePattern>${ROLLING_FILE_NAME_PATTERN:-log/alertAudit.log.%d{yyyy-MM-dd}.%i.gz}</fileNamePattern>\n+\t\t\t<maxFileSize>${LOG_FILE_MAX_SIZE:-10MB}</maxFileSize>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4ODAxODc2", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-518801876", "createdAt": "2020-10-28T15:38:22Z", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTozODoyMlrOHpwZXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTozODoyMlrOHpwZXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU0NjU5MQ==", "bodyText": "Will zero here prevent us from logging at all or is it \"unlimited\"?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#discussion_r513546591", "createdAt": "2020-10-28T15:38:22Z", "author": {"login": "gkillough"}, "path": "src/main/resources/logback-spring.xml", "diffHunk": "@@ -0,0 +1,24 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<configuration>\n+\n+    <include resource=\"org/springframework/boot/logging/logback/base.xml\"/>\n+\n+    <appender name=\"ALERT_AUDIT\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\">\n+        <encoder>\n+\t\t\t<pattern>${FILE_LOG_PATTERN}</pattern>\n+\t\t</encoder>\n+\t\t<file>log/alertAudit.log</file>\n+\t\t<rollingPolicy class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy\">\n+\t\t\t<cleanHistoryOnStart>${LOG_FILE_CLEAN_HISTORY_ON_START:-false}</cleanHistoryOnStart>\n+\t\t\t<fileNamePattern>${ROLLING_FILE_NAME_PATTERN:-log/alertAudit.log.%d{yyyy-MM-dd}.%i.gz}</fileNamePattern>\n+\t\t\t<maxFileSize>${LOG_FILE_MAX_SIZE:-10MB}</maxFileSize>\n+\t\t\t<maxHistory>${LOG_FILE_MAX_HISTORY:-7}</maxHistory>\n+\t\t\t<totalSizeCap>${LOG_FILE_TOTAL_SIZE_CAP:-0}</totalSizeCap>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4ODE2MjQy", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-518816242", "createdAt": "2020-10-28T15:51:38Z", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTo1MTozOVrOHpxDnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTo1MTozOVrOHpxDnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU1NzQwNA==", "bodyText": "This is the value that will appear in the logs, correct? If so, I don't think it should be camel case. Perhaps match the class format?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#discussion_r513557404", "createdAt": "2020-10-28T15:51:39Z", "author": {"login": "bamandel"}, "path": "alert-common/src/main/java/com/synopsys/integration/alert/common/logging/AlertLoggerFactory.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/**\n+ * alert-common\n+ *\n+ * Copyright (c) 2020 Synopsys, Inc.\n+ *\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.synopsys.integration.alert.common.logging;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class AlertLoggerFactory {\n+\n+    public static final String ALERT_AUDIT_LOGGER = \"alertAudit\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4ODE5MzUw", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-518819350", "createdAt": "2020-10-28T15:54:32Z", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTo1NDozMlrOHpxMgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTo1NDozMlrOHpxMgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU1OTY4MQ==", "bodyText": "Is the format strange here? I'm not sure if it's github or if it's actually offset", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#discussion_r513559681", "createdAt": "2020-10-28T15:54:32Z", "author": {"login": "bamandel"}, "path": "src/main/resources/logback-spring.xml", "diffHunk": "@@ -0,0 +1,24 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<configuration>\n+\n+    <include resource=\"org/springframework/boot/logging/logback/base.xml\"/>\n+\n+    <appender name=\"ALERT_AUDIT\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\">\n+        <encoder>\n+\t\t\t<pattern>${FILE_LOG_PATTERN}</pattern>\n+\t\t</encoder>\n+\t\t<file>log/alertAudit.log</file>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4ODIxNjk4", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-518821698", "createdAt": "2020-10-28T15:56:40Z", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTo1Njo0MVrOHpxTVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNTo1Njo0MVrOHpxTVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU2MTQzMQ==", "bodyText": "I think this would need to change if we change the logger name in my other comment?", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#discussion_r513561431", "createdAt": "2020-10-28T15:56:41Z", "author": {"login": "bamandel"}, "path": "src/main/resources/logback-spring.xml", "diffHunk": "@@ -0,0 +1,24 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<configuration>\n+\n+    <include resource=\"org/springframework/boot/logging/logback/base.xml\"/>\n+\n+    <appender name=\"ALERT_AUDIT\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\">\n+        <encoder>\n+\t\t\t<pattern>${FILE_LOG_PATTERN}</pattern>\n+\t\t</encoder>\n+\t\t<file>log/alertAudit.log</file>\n+\t\t<rollingPolicy class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy\">\n+\t\t\t<cleanHistoryOnStart>${LOG_FILE_CLEAN_HISTORY_ON_START:-false}</cleanHistoryOnStart>\n+\t\t\t<fileNamePattern>${ROLLING_FILE_NAME_PATTERN:-log/alertAudit.log.%d{yyyy-MM-dd}.%i.gz}</fileNamePattern>\n+\t\t\t<maxFileSize>${LOG_FILE_MAX_SIZE:-10MB}</maxFileSize>\n+\t\t\t<maxHistory>${LOG_FILE_MAX_HISTORY:-7}</maxHistory>\n+\t\t\t<totalSizeCap>${LOG_FILE_TOTAL_SIZE_CAP:-0}</totalSizeCap>\n+\t\t</rollingPolicy>\n+    </appender>\n+\n+\t<logger name=\"alertAudit\" level=\"trace\" additivity=\"false\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4ODIxODM3", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-518821837", "createdAt": "2020-10-28T15:56:47Z", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4OTI0NjI4", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-518924628", "createdAt": "2020-10-28T17:37:36Z", "commit": {"oid": "9f543990d4449b1d052331da8adb1b236e0b253d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0734fbdf510f52f6fc101b156ea7ae7eb92cdbc9", "author": {"user": {"login": "ChomickiM", "name": "Martin"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/0734fbdf510f52f6fc101b156ea7ae7eb92cdbc9", "committedDate": "2020-10-28T17:38:00Z", "message": "style: Change logger name to Alert Audit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "402ca66586b893f751d7b97e89f539459783313b", "author": {"user": {"login": "ChomickiM", "name": "Martin"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/402ca66586b893f751d7b97e89f539459783313b", "committedDate": "2020-10-28T18:30:21Z", "message": "refactor: Updating totalSizeCap for auditLog to max at 1GB"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MDExNTM1", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-519011535", "createdAt": "2020-10-28T19:25:25Z", "commit": {"oid": "402ca66586b893f751d7b97e89f539459783313b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5NjI4MDYx", "url": "https://github.com/blackducksoftware/blackduck-alert/pull/1234#pullrequestreview-519628061", "createdAt": "2020-10-29T12:49:06Z", "commit": {"oid": "402ca66586b893f751d7b97e89f539459783313b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d9f008dd1a0d86a8595bf2d2b00ddeccb4c71e0", "author": {"user": {"login": "ChomickiM", "name": "Martin"}}, "url": "https://github.com/blackducksoftware/blackduck-alert/commit/7d9f008dd1a0d86a8595bf2d2b00ddeccb4c71e0", "committedDate": "2020-10-29T13:34:58Z", "message": "style: Renaming log file to alert_audit and exposing logging.file.max-size in application,.properties"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3034, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}