{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5NDk5NzU5", "number": 7313, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QyMDo0MDozNlrOErWWYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QyMTowMTowM1rOErWxnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzODkwNDAyOnYy", "diffSide": "RIGHT", "path": "src/main/java/edu/harvard/iq/dataverse/ingest/tabulardata/impl/plugins/dta/DTAFileReaderSpi.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QyMDo0MDozNlrOHeEsjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwMDoxODo0MVrOHeJ3zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI5NjI3MA==", "bodyText": "guessing this method could/should close it but I didn't see where it was getting called.", "url": "https://github.com/IQSS/dataverse/pull/7313#discussion_r501296270", "createdAt": "2020-10-07T20:40:36Z", "author": {"login": "qqmyers"}, "path": "src/main/java/edu/harvard/iq/dataverse/ingest/tabulardata/impl/plugins/dta/DTAFileReaderSpi.java", "diffHunk": "@@ -131,6 +131,7 @@ public boolean canDecodeInput(Object source) throws IOException {\n \n     @Override\n     public boolean canDecodeInput(BufferedInputStream stream) throws IOException {\n+    \t//who closes this stream?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec791bd79cd52076ae9f80942c62eba59a9f5918"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM4MTA3MQ==", "bodyText": "We are not calling these methods at this time. They are part of a builtin infrastructure for automatically matching ingest plugins to specific file types... We are not using it now, but we may go back to it.\nIt would be the responsibility of the code that calls these methods to close the streams.", "url": "https://github.com/IQSS/dataverse/pull/7313#discussion_r501381071", "createdAt": "2020-10-08T00:18:41Z", "author": {"login": "landreev"}, "path": "src/main/java/edu/harvard/iq/dataverse/ingest/tabulardata/impl/plugins/dta/DTAFileReaderSpi.java", "diffHunk": "@@ -131,6 +131,7 @@ public boolean canDecodeInput(Object source) throws IOException {\n \n     @Override\n     public boolean canDecodeInput(BufferedInputStream stream) throws IOException {\n+    \t//who closes this stream?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI5NjI3MA=="}, "originalCommit": {"oid": "ec791bd79cd52076ae9f80942c62eba59a9f5918"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzODk3MzcyOnYy", "diffSide": "RIGHT", "path": "src/main/java/edu/harvard/iq/dataverse/ingest/IngestServiceBean.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QyMTowMTowM1rOHeFX3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQwMDoxMzoxNVrOHeJyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMwNzM1OQ==", "bodyText": "FWIW - this private method doesn't get used according to eclipse - do we need it?", "url": "https://github.com/IQSS/dataverse/pull/7313#discussion_r501307359", "createdAt": "2020-10-07T21:01:03Z", "author": {"login": "qqmyers"}, "path": "src/main/java/edu/harvard/iq/dataverse/ingest/IngestServiceBean.java", "diffHunk": "@@ -1056,12 +1061,11 @@ private BufferedInputStream openFile(DataFile dataFile) throws IOException {\n         if (storageIO.isLocalFile()) {\n             inputStream = new BufferedInputStream(storageIO.getInputStream());\n         } else {\n-            ReadableByteChannel dataFileChannel = storageIO.getReadChannel();\n-            File tempFile = File.createTempFile(\"tempIngestSourceFile\", \".tmp\");\n-            FileChannel tempIngestSourceChannel = new FileOutputStream(tempFile).getChannel();\n-            \n-            tempIngestSourceChannel.transferFrom(dataFileChannel, 0, storageIO.getSize());\n-            \n+        \tFile tempFile = File.createTempFile(\"tempIngestSourceFile\", \".tmp\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec791bd79cd52076ae9f80942c62eba59a9f5918"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM3OTYzOQ==", "bodyText": "It really appears an unused leftover method.", "url": "https://github.com/IQSS/dataverse/pull/7313#discussion_r501379639", "createdAt": "2020-10-08T00:13:15Z", "author": {"login": "landreev"}, "path": "src/main/java/edu/harvard/iq/dataverse/ingest/IngestServiceBean.java", "diffHunk": "@@ -1056,12 +1061,11 @@ private BufferedInputStream openFile(DataFile dataFile) throws IOException {\n         if (storageIO.isLocalFile()) {\n             inputStream = new BufferedInputStream(storageIO.getInputStream());\n         } else {\n-            ReadableByteChannel dataFileChannel = storageIO.getReadChannel();\n-            File tempFile = File.createTempFile(\"tempIngestSourceFile\", \".tmp\");\n-            FileChannel tempIngestSourceChannel = new FileOutputStream(tempFile).getChannel();\n-            \n-            tempIngestSourceChannel.transferFrom(dataFileChannel, 0, storageIO.getSize());\n-            \n+        \tFile tempFile = File.createTempFile(\"tempIngestSourceFile\", \".tmp\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMwNzM1OQ=="}, "originalCommit": {"oid": "ec791bd79cd52076ae9f80942c62eba59a9f5918"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2406, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}