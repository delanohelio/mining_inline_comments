{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwNjQ3OTE1", "number": 7320, "title": "persist debug=true in session, toggle with query parameter #7273", "bodyText": "What this PR does / why we need it:\nShowing debug information on a page is useful but currently requires you to add debug=true as a query parameter each time you load the page. The only page this works on is the dataverse page (and this pull request doesn't change that).\nThis pull request allows you to add debug=true as a query parameter once and have the boolean remain true for your session.\nWhich issue(s) this PR closes:\nCloses #7273\nSpecial notes for your reviewer:\nI didn't touch the existing logic in SearchIncludeFragment:\n\ndebug is only true if you are a superuser\nanother way for debug to be true is the undocumented \":Debug\" database setting. 2020-10-14 update: we decided to remove this in a4582f0.\n\nSuggestions on how to test this:\n\nLog in as a superuser.\nGo to http://localhost:8080/?debug=true (or the equivalent siteUrl) to set enable debugging for your session.\nNavigate around, observing that the extra debugging information is only available on on the dataverse page and relates to Solr (screenshot below) and is only available to superusers.\nGo to http://localhost:8080/?debug=false to disable debugging.\nPlay around with the undocumented \":Debug\" database setting, setting it to true and false and observe that it acts the same was as the debug query parameter.\n\nDoes this PR introduce a user interface change? If mockups are available, please link/include them here:\nHow the debugging on the dataverse page looks hasn't changed but here's what it looks like:\n\nIs there a release notes update needed for this change?:\nMaybe? I'm happy to add one.\nAdditional documentation:\nNone. I'm happy to add some. I documented the boolean within the code, at least.", "createdAt": "2020-10-09T14:57:26Z", "url": "https://github.com/IQSS/dataverse/pull/7320", "merged": true, "mergeCommit": {"oid": "769819fa113b1c154e60dd8de045d3dc031f342f"}, "closed": true, "closedAt": "2020-10-15T20:05:16Z", "author": {"login": "pdurbin"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQ3OMFAH2gAyNTAwNjQ3OTE1OjQ1MTcyNDY5ZTJmNzA0MmJjMjE4Mzk1N2I4NzY0NTJlYWNlZTBjMDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSzEu6AFqTUwOTQ3NTI4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "45172469e2f7042bc2183957b876452eacee0c04", "author": {"user": {"login": "pdurbin", "name": "Philip Durbin"}}, "url": "https://github.com/IQSS/dataverse/commit/45172469e2f7042bc2183957b876452eacee0c04", "committedDate": "2020-10-09T14:40:18Z", "message": "persist debug=true in session, toggle with query parameter #7273"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MzgzNjM0", "url": "https://github.com/IQSS/dataverse/pull/7320#pullrequestreview-508383634", "createdAt": "2020-10-14T14:05:13Z", "commit": {"oid": "45172469e2f7042bc2183957b876452eacee0c04"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NDU2MjUy", "url": "https://github.com/IQSS/dataverse/pull/7320#pullrequestreview-508456252", "createdAt": "2020-10-14T15:14:10Z", "commit": {"oid": "45172469e2f7042bc2183957b876452eacee0c04"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNToxNDoxMFrOHhYI_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxNToxNToxM1rOHhYMLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2MDU3NA==", "bodyText": "why not still isDebug?", "url": "https://github.com/IQSS/dataverse/pull/7320#discussion_r504760574", "createdAt": "2020-10-14T15:14:10Z", "author": {"login": "scolapasta"}, "path": "src/main/java/edu/harvard/iq/dataverse/search/SearchIncludeFragment.java", "diffHunk": "@@ -1017,13 +1017,15 @@ public void setRootDv(boolean rootDv) {\n         this.rootDv = rootDv;\n     }\n \n-    public boolean isDebug() {\n-        return (debug && session.getUser().isSuperuser())\n+    public Boolean getDebug() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45172469e2f7042bc2183957b876452eacee0c04"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2MTM5MQ==", "bodyText": "Should all this logic go to the session? i.e. to use in other future pages it would be easier to not have to repeat the superuser check or the settings check?", "url": "https://github.com/IQSS/dataverse/pull/7320#discussion_r504761391", "createdAt": "2020-10-14T15:15:13Z", "author": {"login": "scolapasta"}, "path": "src/main/java/edu/harvard/iq/dataverse/search/SearchIncludeFragment.java", "diffHunk": "@@ -1017,13 +1017,15 @@ public void setRootDv(boolean rootDv) {\n         this.rootDv = rootDv;\n     }\n \n-    public boolean isDebug() {\n-        return (debug && session.getUser().isSuperuser())\n+    public Boolean getDebug() {\n+        return (session.isDebug() && session.getUser().isSuperuser())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45172469e2f7042bc2183957b876452eacee0c04"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4582f05e18a95f744c0db39b26afed4d1ed45bb", "author": {"user": {"login": "pdurbin", "name": "Philip Durbin"}}, "url": "https://github.com/IQSS/dataverse/commit/a4582f05e18a95f744c0db39b26afed4d1ed45bb", "committedDate": "2020-10-14T17:45:57Z", "message": "consolidate logic, remove :Debug database setting #7273"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce78897f7c630dca5261f5b9bba42a9b3537db0e", "author": {"user": {"login": "pdurbin", "name": "Philip Durbin"}}, "url": "https://github.com/IQSS/dataverse/commit/ce78897f7c630dca5261f5b9bba42a9b3537db0e", "committedDate": "2020-10-14T20:09:32Z", "message": "switch to getters and setters in session bean #7273"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NDc1Mjg4", "url": "https://github.com/IQSS/dataverse/pull/7320#pullrequestreview-509475288", "createdAt": "2020-10-15T14:58:12Z", "commit": {"oid": "ce78897f7c630dca5261f5b9bba42a9b3537db0e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 790, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}