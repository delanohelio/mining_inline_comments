{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExMDY5NDAz", "number": 7363, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDo0MDowOVrOEzeVlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDo0MDo1MVrOEzeWeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNDA5ODc4OnYy", "diffSide": "RIGHT", "path": "scripts/dev/dev-rebuild.sh", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDo0MDowOVrOHqtzLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDo1OTo0NlrOHqucow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1MjYyMg==", "bodyText": "since you can change this location, can this be determined from the jvm option instead of hardcoded?", "url": "https://github.com/IQSS/dataverse/pull/7363#discussion_r514552622", "createdAt": "2020-10-29T20:40:09Z", "author": {"login": "scolapasta"}, "path": "scripts/dev/dev-rebuild.sh", "diffHunk": "@@ -0,0 +1,71 @@\n+#!/bin/sh\n+PAYARA_DIR=/usr/local/payara5\n+ASADMIN=$PAYARA_DIR/glassfish/bin/asadmin\n+DB_NAME=dvndb\n+DB_USER=dvnapp\n+\n+echo \"Checking if there is a war file to undeploy...\"\n+LIST_APP=$($ASADMIN list-applications -t)\n+OLD_WAR=$(echo $LIST_APP | awk '{print $1}')\n+NEW_WAR=target/dataverse*.war\n+if [ ! -z $OLD_WAR ]; then\n+  $ASADMIN undeploy $OLD_WAR\n+fi\n+\n+echo \"Stopping app server...\"\n+$ASADMIN stop-domain\n+\n+echo \"Deleting \\\"generated\\\" directory...\"\n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/generated\n+\n+echo \"Deleting ALL DATA FILES uploaded to Dataverse...\" \n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/files", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b5e946917204c7f76893780ed74f1da59122e23"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1NzM1Ng==", "bodyText": "I had that thought, that perhaps some devs keep their data files somewhere other than default (domain1/files). I figured I'd wait until there's demand to make this configurable. We could either add a variable to the top called something like DATA_FILES_DIR or yes, perhaps pull it out from asadmin list-jvm-options.", "url": "https://github.com/IQSS/dataverse/pull/7363#discussion_r514557356", "createdAt": "2020-10-29T20:48:55Z", "author": {"login": "pdurbin"}, "path": "scripts/dev/dev-rebuild.sh", "diffHunk": "@@ -0,0 +1,71 @@\n+#!/bin/sh\n+PAYARA_DIR=/usr/local/payara5\n+ASADMIN=$PAYARA_DIR/glassfish/bin/asadmin\n+DB_NAME=dvndb\n+DB_USER=dvnapp\n+\n+echo \"Checking if there is a war file to undeploy...\"\n+LIST_APP=$($ASADMIN list-applications -t)\n+OLD_WAR=$(echo $LIST_APP | awk '{print $1}')\n+NEW_WAR=target/dataverse*.war\n+if [ ! -z $OLD_WAR ]; then\n+  $ASADMIN undeploy $OLD_WAR\n+fi\n+\n+echo \"Stopping app server...\"\n+$ASADMIN stop-domain\n+\n+echo \"Deleting \\\"generated\\\" directory...\"\n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/generated\n+\n+echo \"Deleting ALL DATA FILES uploaded to Dataverse...\" \n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/files", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1MjYyMg=="}, "originalCommit": {"oid": "5b5e946917204c7f76893780ed74f1da59122e23"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1ODY2Ng==", "bodyText": "OK, I'm fine with pushing that to later. Could you a) add that as a todo comment and b) add a note in the docs to point out that files would have to be in the default location?", "url": "https://github.com/IQSS/dataverse/pull/7363#discussion_r514558666", "createdAt": "2020-10-29T20:51:03Z", "author": {"login": "scolapasta"}, "path": "scripts/dev/dev-rebuild.sh", "diffHunk": "@@ -0,0 +1,71 @@\n+#!/bin/sh\n+PAYARA_DIR=/usr/local/payara5\n+ASADMIN=$PAYARA_DIR/glassfish/bin/asadmin\n+DB_NAME=dvndb\n+DB_USER=dvnapp\n+\n+echo \"Checking if there is a war file to undeploy...\"\n+LIST_APP=$($ASADMIN list-applications -t)\n+OLD_WAR=$(echo $LIST_APP | awk '{print $1}')\n+NEW_WAR=target/dataverse*.war\n+if [ ! -z $OLD_WAR ]; then\n+  $ASADMIN undeploy $OLD_WAR\n+fi\n+\n+echo \"Stopping app server...\"\n+$ASADMIN stop-domain\n+\n+echo \"Deleting \\\"generated\\\" directory...\"\n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/generated\n+\n+echo \"Deleting ALL DATA FILES uploaded to Dataverse...\" \n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/files", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1MjYyMg=="}, "originalCommit": {"oid": "5b5e946917204c7f76893780ed74f1da59122e23"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU2MzIzNQ==", "bodyText": "Sure, fixed in ecde956.", "url": "https://github.com/IQSS/dataverse/pull/7363#discussion_r514563235", "createdAt": "2020-10-29T20:59:46Z", "author": {"login": "pdurbin"}, "path": "scripts/dev/dev-rebuild.sh", "diffHunk": "@@ -0,0 +1,71 @@\n+#!/bin/sh\n+PAYARA_DIR=/usr/local/payara5\n+ASADMIN=$PAYARA_DIR/glassfish/bin/asadmin\n+DB_NAME=dvndb\n+DB_USER=dvnapp\n+\n+echo \"Checking if there is a war file to undeploy...\"\n+LIST_APP=$($ASADMIN list-applications -t)\n+OLD_WAR=$(echo $LIST_APP | awk '{print $1}')\n+NEW_WAR=target/dataverse*.war\n+if [ ! -z $OLD_WAR ]; then\n+  $ASADMIN undeploy $OLD_WAR\n+fi\n+\n+echo \"Stopping app server...\"\n+$ASADMIN stop-domain\n+\n+echo \"Deleting \\\"generated\\\" directory...\"\n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/generated\n+\n+echo \"Deleting ALL DATA FILES uploaded to Dataverse...\" \n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/files", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1MjYyMg=="}, "originalCommit": {"oid": "5b5e946917204c7f76893780ed74f1da59122e23"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNDEwMTA0OnYy", "diffSide": "RIGHT", "path": "scripts/dev/dev-rebuild.sh", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDo0MDo1MVrOHqt0pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMTowMjowNFrOHquhSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1Mjk5OA==", "bodyText": "just because I'm curious, what does this do?", "url": "https://github.com/IQSS/dataverse/pull/7363#discussion_r514552998", "createdAt": "2020-10-29T20:40:51Z", "author": {"login": "scolapasta"}, "path": "scripts/dev/dev-rebuild.sh", "diffHunk": "@@ -0,0 +1,71 @@\n+#!/bin/sh\n+PAYARA_DIR=/usr/local/payara5\n+ASADMIN=$PAYARA_DIR/glassfish/bin/asadmin\n+DB_NAME=dvndb\n+DB_USER=dvnapp\n+\n+echo \"Checking if there is a war file to undeploy...\"\n+LIST_APP=$($ASADMIN list-applications -t)\n+OLD_WAR=$(echo $LIST_APP | awk '{print $1}')\n+NEW_WAR=target/dataverse*.war\n+if [ ! -z $OLD_WAR ]; then\n+  $ASADMIN undeploy $OLD_WAR\n+fi\n+\n+echo \"Stopping app server...\"\n+$ASADMIN stop-domain\n+\n+echo \"Deleting \\\"generated\\\" directory...\"\n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/generated\n+\n+echo \"Deleting ALL DATA FILES uploaded to Dataverse...\" \n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/files\n+\n+echo \"Terminating database settings so we can drop the database...\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b5e946917204c7f76893780ed74f1da59122e23"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1ODg4MQ==", "bodyText": "I'm assuming you mean the pg_terminate_backend stuff. It's just a SQL statement I found online somewhere. I didn't dig into it. In practice, it's sometimes necessary to terminate all sessions because you've got a session or two left over from pgAdmin or a terminal. In my experience, you can drop a database with open sessions.", "url": "https://github.com/IQSS/dataverse/pull/7363#discussion_r514558881", "createdAt": "2020-10-29T20:51:20Z", "author": {"login": "pdurbin"}, "path": "scripts/dev/dev-rebuild.sh", "diffHunk": "@@ -0,0 +1,71 @@\n+#!/bin/sh\n+PAYARA_DIR=/usr/local/payara5\n+ASADMIN=$PAYARA_DIR/glassfish/bin/asadmin\n+DB_NAME=dvndb\n+DB_USER=dvnapp\n+\n+echo \"Checking if there is a war file to undeploy...\"\n+LIST_APP=$($ASADMIN list-applications -t)\n+OLD_WAR=$(echo $LIST_APP | awk '{print $1}')\n+NEW_WAR=target/dataverse*.war\n+if [ ! -z $OLD_WAR ]; then\n+  $ASADMIN undeploy $OLD_WAR\n+fi\n+\n+echo \"Stopping app server...\"\n+$ASADMIN stop-domain\n+\n+echo \"Deleting \\\"generated\\\" directory...\"\n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/generated\n+\n+echo \"Deleting ALL DATA FILES uploaded to Dataverse...\" \n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/files\n+\n+echo \"Terminating database settings so we can drop the database...\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1Mjk5OA=="}, "originalCommit": {"oid": "5b5e946917204c7f76893780ed74f1da59122e23"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU2MTY5Ng==", "bodyText": "Ah, makes sense. I was confused by \"Terminating database settings\". I think that's a typo and should be \"sessions\".", "url": "https://github.com/IQSS/dataverse/pull/7363#discussion_r514561696", "createdAt": "2020-10-29T20:56:52Z", "author": {"login": "scolapasta"}, "path": "scripts/dev/dev-rebuild.sh", "diffHunk": "@@ -0,0 +1,71 @@\n+#!/bin/sh\n+PAYARA_DIR=/usr/local/payara5\n+ASADMIN=$PAYARA_DIR/glassfish/bin/asadmin\n+DB_NAME=dvndb\n+DB_USER=dvnapp\n+\n+echo \"Checking if there is a war file to undeploy...\"\n+LIST_APP=$($ASADMIN list-applications -t)\n+OLD_WAR=$(echo $LIST_APP | awk '{print $1}')\n+NEW_WAR=target/dataverse*.war\n+if [ ! -z $OLD_WAR ]; then\n+  $ASADMIN undeploy $OLD_WAR\n+fi\n+\n+echo \"Stopping app server...\"\n+$ASADMIN stop-domain\n+\n+echo \"Deleting \\\"generated\\\" directory...\"\n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/generated\n+\n+echo \"Deleting ALL DATA FILES uploaded to Dataverse...\" \n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/files\n+\n+echo \"Terminating database settings so we can drop the database...\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1Mjk5OA=="}, "originalCommit": {"oid": "5b5e946917204c7f76893780ed74f1da59122e23"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU2NDQyNQ==", "bodyText": "Oh, a typo. I meant sessions, not settings. Fixed in d3778f3.", "url": "https://github.com/IQSS/dataverse/pull/7363#discussion_r514564425", "createdAt": "2020-10-29T21:02:04Z", "author": {"login": "pdurbin"}, "path": "scripts/dev/dev-rebuild.sh", "diffHunk": "@@ -0,0 +1,71 @@\n+#!/bin/sh\n+PAYARA_DIR=/usr/local/payara5\n+ASADMIN=$PAYARA_DIR/glassfish/bin/asadmin\n+DB_NAME=dvndb\n+DB_USER=dvnapp\n+\n+echo \"Checking if there is a war file to undeploy...\"\n+LIST_APP=$($ASADMIN list-applications -t)\n+OLD_WAR=$(echo $LIST_APP | awk '{print $1}')\n+NEW_WAR=target/dataverse*.war\n+if [ ! -z $OLD_WAR ]; then\n+  $ASADMIN undeploy $OLD_WAR\n+fi\n+\n+echo \"Stopping app server...\"\n+$ASADMIN stop-domain\n+\n+echo \"Deleting \\\"generated\\\" directory...\"\n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/generated\n+\n+echo \"Deleting ALL DATA FILES uploaded to Dataverse...\" \n+rm -rf $PAYARA_DIR/glassfish/domains/domain1/files\n+\n+echo \"Terminating database settings so we can drop the database...\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU1Mjk5OA=="}, "originalCommit": {"oid": "5b5e946917204c7f76893780ed74f1da59122e23"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3187, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}