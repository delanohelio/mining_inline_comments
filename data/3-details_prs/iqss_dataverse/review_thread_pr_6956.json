{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2Nzg3NzYz", "number": 6956, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMDoxNjo1NFrOEB5-nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMjo0Mjo1OFrOECItiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNDMzOTUxOnYy", "diffSide": "RIGHT", "path": "src/main/java/edu/harvard/iq/dataverse/settings/SettingsServiceBean.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMDoxNjo1NFrOGeCdVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwNzo0MDowNVrOGePy8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE1MDc0MA==", "bodyText": "ShibAttributeCharacterSetConversionEnabled should be documented in https://github.com/IQSS/dataverse/blob/develop/doc/sphinx-guides/source/installation/config.rst", "url": "https://github.com/IQSS/dataverse/pull/6956#discussion_r434150740", "createdAt": "2020-06-02T20:16:54Z", "author": {"login": "pdurbin"}, "path": "src/main/java/edu/harvard/iq/dataverse/settings/SettingsServiceBean.java", "diffHunk": "@@ -422,7 +422,13 @@ Whether Harvesting (OAI) service is enabled\n         /**\n          * Shibboleth affiliation attribute which holds information about the affiliation of the user (e.g. ou)\n          */\n-        ShibAffiliationAttribute\n+        ShibAffiliationAttribute,\n+        /*Convert shibboleth AJP attributes from ISO-8859-1 to UTF-8 */\n+        ShibAttributeCharacterSetConversionEnabled,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee7e94d97f3b606ae9cc68e7508f219f14754015"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM2OTI2NQ==", "bodyText": "I finished the documentation and cleaned up code formatting. I hope this will be OK.", "url": "https://github.com/IQSS/dataverse/pull/6956#discussion_r434369265", "createdAt": "2020-06-03T07:40:05Z", "author": {"login": "pallinger"}, "path": "src/main/java/edu/harvard/iq/dataverse/settings/SettingsServiceBean.java", "diffHunk": "@@ -422,7 +422,13 @@ Whether Harvesting (OAI) service is enabled\n         /**\n          * Shibboleth affiliation attribute which holds information about the affiliation of the user (e.g. ou)\n          */\n-        ShibAffiliationAttribute\n+        ShibAffiliationAttribute,\n+        /*Convert shibboleth AJP attributes from ISO-8859-1 to UTF-8 */\n+        ShibAttributeCharacterSetConversionEnabled,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE1MDc0MA=="}, "originalCommit": {"oid": "ee7e94d97f3b606ae9cc68e7508f219f14754015"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNDM0MDk1OnYy", "diffSide": "RIGHT", "path": "src/main/java/edu/harvard/iq/dataverse/settings/SettingsServiceBean.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMDoxNzoyMVrOGeCeQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwNzozNzo0N1rOGePuOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE1MDk3OQ==", "bodyText": "Why was FileValidationOnPublishEnabled added? I'm confused.", "url": "https://github.com/IQSS/dataverse/pull/6956#discussion_r434150979", "createdAt": "2020-06-02T20:17:21Z", "author": {"login": "pdurbin"}, "path": "src/main/java/edu/harvard/iq/dataverse/settings/SettingsServiceBean.java", "diffHunk": "@@ -422,7 +422,13 @@ Whether Harvesting (OAI) service is enabled\n         /**\n          * Shibboleth affiliation attribute which holds information about the affiliation of the user (e.g. ou)\n          */\n-        ShibAffiliationAttribute\n+        ShibAffiliationAttribute,\n+        /*Convert shibboleth AJP attributes from ISO-8859-1 to UTF-8 */\n+        ShibAttributeCharacterSetConversionEnabled,\n+        /**\n+         * Validate physical files for all the datafiles in the dataset when publishing\n+         */\n+        FileValidationOnPublishEnabled", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee7e94d97f3b606ae9cc68e7508f219f14754015"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM1MjM4Mw==", "bodyText": "I may have forked from a different branch, where FileValidationOnPublishEnabled was there. I will try a new pull request if I cannot salvage this.", "url": "https://github.com/IQSS/dataverse/pull/6956#discussion_r434352383", "createdAt": "2020-06-03T07:08:20Z", "author": {"login": "pallinger"}, "path": "src/main/java/edu/harvard/iq/dataverse/settings/SettingsServiceBean.java", "diffHunk": "@@ -422,7 +422,13 @@ Whether Harvesting (OAI) service is enabled\n         /**\n          * Shibboleth affiliation attribute which holds information about the affiliation of the user (e.g. ou)\n          */\n-        ShibAffiliationAttribute\n+        ShibAffiliationAttribute,\n+        /*Convert shibboleth AJP attributes from ISO-8859-1 to UTF-8 */\n+        ShibAttributeCharacterSetConversionEnabled,\n+        /**\n+         * Validate physical files for all the datafiles in the dataset when publishing\n+         */\n+        FileValidationOnPublishEnabled", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE1MDk3OQ=="}, "originalCommit": {"oid": "ee7e94d97f3b606ae9cc68e7508f219f14754015"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM2ODA1Ng==", "bodyText": "I see that FileValidationOnPublishEnabled is in IQSS/develop already, not sure why the diff shows up that way.", "url": "https://github.com/IQSS/dataverse/pull/6956#discussion_r434368056", "createdAt": "2020-06-03T07:37:47Z", "author": {"login": "pallinger"}, "path": "src/main/java/edu/harvard/iq/dataverse/settings/SettingsServiceBean.java", "diffHunk": "@@ -422,7 +422,13 @@ Whether Harvesting (OAI) service is enabled\n         /**\n          * Shibboleth affiliation attribute which holds information about the affiliation of the user (e.g. ou)\n          */\n-        ShibAffiliationAttribute\n+        ShibAffiliationAttribute,\n+        /*Convert shibboleth AJP attributes from ISO-8859-1 to UTF-8 */\n+        ShibAttributeCharacterSetConversionEnabled,\n+        /**\n+         * Validate physical files for all the datafiles in the dataset when publishing\n+         */\n+        FileValidationOnPublishEnabled", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE1MDk3OQ=="}, "originalCommit": {"oid": "ee7e94d97f3b606ae9cc68e7508f219f14754015"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNjc1MzM5OnYy", "diffSide": "RIGHT", "path": "doc/sphinx-guides/source/installation/config.rst", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMjo0Mjo1OFrOGeaCew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QxMjo0Mjo1OFrOGeaCew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDUzNzA4Mw==", "bodyText": "@pallinger overall, these docs are looking great. They should be above  .. _:ComputeBaseUrl: which is an anchor. Also, since we're moving from Glassfish to Payara, if you could change \"Glassfish\" to \"the application server\" (or \"your application server\") as appropriate, it would be great.", "url": "https://github.com/IQSS/dataverse/pull/6956#discussion_r434537083", "createdAt": "2020-06-03T12:42:58Z", "author": {"login": "pdurbin"}, "path": "doc/sphinx-guides/source/installation/config.rst", "diffHunk": "@@ -1875,6 +1875,17 @@ To check the current value of ``:ShibAffiliationAttribute``:\n \n .. _:ComputeBaseUrl:\n \n+:ShibAttributeCharacterSetConversionEnabled\n++++++++++++++++++++++++++++++++++++++++++++\n+\n+It seems that Glassfish will interpret all Shibboleth attributes that come through AJP as ISO-8859-1, even if they where originally UTF-8.\n+To circumvent that, we re-encode all received Shibboleth attributes manually as UTF-8 by default. \n+In the case you get garbled characters in Shibboleth-supplied fields (e.g. given name, surname, affiliation), you can disable this behaviour by setting ShibAttributeCharacterSetConversionEnabled to false:\n+\n+``curl -X PUT -d false http://localhost:8080/api/admin/settings/:ShibAttributeCharacterSetConversionEnabled``\n+\n+If you managed to get correct accented characters from shibboleth while this setting is _false_, please contact us with your Glassfish and Shibboleth configuration!\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97634050e256521089aa8499d677327e04414dfb"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3210, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}