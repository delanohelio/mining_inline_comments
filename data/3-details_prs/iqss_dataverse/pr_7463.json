{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0MDM2Mzgx", "number": 7463, "title": "7457 introduce mpconfig", "bodyText": "What this PR does / why we need it:\nThis PR paves the ground to finally enable using MicroProfile Config API within the application.\nBy providing two special config sources, we can rename settings but still stay backward compatible.\nWe can also start to migrate database settings to MPCONFIG where we see fit and still be backward compatible.\nIt will log using a deprecated setting, so we can stay with a setting for a while before removing it.\nWhich issue(s) this PR closes:\nCloses #7457\nSpecial notes for your reviewer:\nNone.\nSuggestions on how to test this:\nActually this is not introducing a change, as we don't have aliases yet nor are we migrating a database setting here. This will be done for #7424 (PR forthcoming).\nFor now, you can take a look at the added unit tests and running a testcontainers test via mvn -P tc verify.\nDoes this PR introduce a user interface change? If mockups are available, please link/include them here:\nNope.\nIs there a release notes update needed for this change?:\n\ud83d\udd0b included.\nAdditional documentation:\nNone so far.", "createdAt": "2020-12-08T00:30:54Z", "url": "https://github.com/IQSS/dataverse/pull/7463", "merged": true, "mergeCommit": {"oid": "c715a8478c24056bd26d0babe7fcce6c201c4ec4"}, "closed": true, "closedAt": "2020-12-10T16:40:16Z", "author": {"login": "poikilotherm"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdi24nBAH2gAyNTM0MDM2MzgxOjc0ZjM1ZDgyY2ZkMjlmOGEyZWNhZmYyOTgyMjA3ZTYzZWVhNGFmYzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkjH00AFqTU0ODQ4NDIyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "74f35d82cfd29f8a2ecaff2982207e63eea4afc5", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/74f35d82cfd29f8a2ecaff2982207e63eea4afc5", "committedDate": "2020-12-04T12:27:22Z", "message": "Introduce Eclipse MicroProfile Config API to the project. #7000"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13447f9cd3e27b78834b41520449424c57f3b6f4", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/13447f9cd3e27b78834b41520449424c57f3b6f4", "committedDate": "2020-12-04T12:30:59Z", "message": "Add MicroBean MicroProfile Config API implementation as a test dependency to enable unit and integration testing without deployments. #7000"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a74cc52331cee3a7fa58497dfa0f99b6ec33d6d3", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/a74cc52331cee3a7fa58497dfa0f99b6ec33d6d3", "committedDate": "2020-12-04T12:31:26Z", "message": "Update Testcontainers to 1.15.0."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a535ce84583dbbe461e2a20a5b1437fdc1506457", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/a535ce84583dbbe461e2a20a5b1437fdc1506457", "committedDate": "2020-12-07T21:14:28Z", "message": "Introducing an MPCONFIG alias config source. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cd0ee99d5d729319d7e6ff1bd131869003d597d", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/5cd0ee99d5d729319d7e6ff1bd131869003d597d", "committedDate": "2020-12-07T21:15:10Z", "message": "Merge branch 'develop' into 7457-introduce-mpconfig"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a2433eb32559203be94ac872b43b7ee1cef5081", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/7a2433eb32559203be94ac872b43b7ee1cef5081", "committedDate": "2020-12-07T22:06:44Z", "message": "Add missing name to AliasConfigSource. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7407e359c5fd64d32ef7a64bcc575783667a8e9", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/f7407e359c5fd64d32ef7a64bcc575783667a8e9", "committedDate": "2020-12-07T22:09:05Z", "message": "Adding a config source to retrieve Dataverse DB settings from MicroProfile Config API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "620e9abb8d52741786217ec84fd0a8a9cf9bcd51", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/620e9abb8d52741786217ec84fd0a8a9cf9bcd51", "committedDate": "2020-12-07T22:35:08Z", "message": "Refactor AliasConfigSource to be more testable and rename aliases file to microprofile-aliases.properties. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebf83e22ab8681ece09d45b9a957abb4a7aeaf12", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/ebf83e22ab8681ece09d45b9a957abb4a7aeaf12", "committedDate": "2020-12-07T22:55:41Z", "message": "Fix error in AliasConfigSource, not looking at keys but values of the map. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1cb339b8650629ca93381d8e50479af6ecaa488", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/e1cb339b8650629ca93381d8e50479af6ecaa488", "committedDate": "2020-12-07T22:56:05Z", "message": "Add tests for AliasConfigSource. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdb043d82e77e4c5a8c65d1ab448f4ba83a1cc3f", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/fdb043d82e77e4c5a8c65d1ab448f4ba83a1cc3f", "committedDate": "2020-12-08T00:39:52Z", "message": "Add integration testing for DbSettingConfigSource to ensure data retrieval works. Fixing a typo, too. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1ea8463e7bd2a499c59d58cee8c6130148cf4a1", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/b1ea8463e7bd2a499c59d58cee8c6130148cf4a1", "committedDate": "2020-12-08T00:40:42Z", "message": "Change pom.xml to include the MicroProfile Config API SPI definitions. #7457"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8790313dfb0420b3105313ee6ad24def0f09da5e", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/8790313dfb0420b3105313ee6ad24def0f09da5e", "committedDate": "2020-12-08T00:23:38Z", "message": "Add integration testing for DbSettingConfigSource to ensure data retrieval works. Fixing a typo, too. #7457"}, "afterCommit": {"oid": "b1ea8463e7bd2a499c59d58cee8c6130148cf4a1", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/b1ea8463e7bd2a499c59d58cee8c6130148cf4a1", "committedDate": "2020-12-08T00:40:42Z", "message": "Change pom.xml to include the MicroProfile Config API SPI definitions. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "429ea21f911313b22bbd5c13f14b1a4023aebb61", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/429ea21f911313b22bbd5c13f14b1a4023aebb61", "committedDate": "2020-12-08T00:55:40Z", "message": "Add some docs about introducing MPCONFIG to the dev guide."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NDE4MDQ5", "url": "https://github.com/IQSS/dataverse/pull/7463#pullrequestreview-547418049", "createdAt": "2020-12-08T16:41:18Z", "commit": {"oid": "429ea21f911313b22bbd5c13f14b1a4023aebb61"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxNjo0MToxOFrOIBobHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxNjo0NjozN1rOIBoyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODU4MTc4OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            and developers it get's much easier to provide their configuration.\n          \n          \n            \n            and developers it gets much easier to provide their configuration.", "url": "https://github.com/IQSS/dataverse/pull/7463#discussion_r538581789", "createdAt": "2020-12-08T16:41:18Z", "author": {"login": "pdurbin"}, "path": "doc/sphinx-guides/source/developers/configuration.rst", "diffHunk": "@@ -0,0 +1,12 @@\n+Consuming Configuration\n+=======================\n+\n+By using `MicroProfile Config <https://github.com/eclipse/microprofile-config>`_, we start to move away from\n+direct ``System.getProperty()`` calls, replacing it with either injected or programmatic config retrieval.\n+\n+The API of MPCONFIG allows for great flexibility, type-safety, defaults etc. For system administrators\n+and developers it get's much easier to provide their configuration.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "429ea21f911313b22bbd5c13f14b1a4023aebb61"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODU4NzY5Nw==", "bodyText": "Should this postgres server version be moved up to be near the client version (around line 30)?", "url": "https://github.com/IQSS/dataverse/pull/7463#discussion_r538587697", "createdAt": "2020-12-08T16:46:37Z", "author": {"login": "pdurbin"}, "path": "pom.xml", "diffHunk": "@@ -844,6 +861,7 @@\n             <id>tc</id>\n             <properties>\n                 <skipUnitTests>true</skipUnitTests>\n+                <postgresql.server.version>9.6</postgresql.server.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "429ea21f911313b22bbd5c13f14b1a4023aebb61"}, "originalPosition": 60}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f73b45a6822083265e4226f8589000c03076a1c", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/5f73b45a6822083265e4226f8589000c03076a1c", "committedDate": "2020-12-08T18:42:06Z", "message": "Extend dev docs about MPCONFIG. #7457"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NTU5NDQx", "url": "https://github.com/IQSS/dataverse/pull/7463#pullrequestreview-547559441", "createdAt": "2020-12-08T19:26:49Z", "commit": {"oid": "5f73b45a6822083265e4226f8589000c03076a1c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ffa4c120852b42752ebe47e6978355584123ac5", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/2ffa4c120852b42752ebe47e6978355584123ac5", "committedDate": "2020-12-08T19:59:09Z", "message": "Fix DbSettingConfigSource not to throw an exception if the DataSource JNDI could not be found or injected. Will result empty properties for this source. #7457"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NjU1NzQz", "url": "https://github.com/IQSS/dataverse/pull/7463#pullrequestreview-547655743", "createdAt": "2020-12-08T21:41:17Z", "commit": {"oid": "2ffa4c120852b42752ebe47e6978355584123ac5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a44b0a413438c606098c06aada910aa3813b25ed", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/a44b0a413438c606098c06aada910aa3813b25ed", "committedDate": "2020-12-08T22:18:25Z", "message": "Refactor DbSettingConfigSource to rely on the SettingsServiceBean, injected by a singleton on startup."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecc277c999b861a2953b4c456626b5788e8021bf", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/ecc277c999b861a2953b4c456626b5788e8021bf", "committedDate": "2020-12-08T22:44:32Z", "message": "Log warning message for DbSettingConfigSource if the settings service has not been injected yet, but values are requested already."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6f38ee3abd6a4bf43664fce03cb51356100c6f5", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/e6f38ee3abd6a4bf43664fce03cb51356100c6f5", "committedDate": "2020-12-08T23:08:17Z", "message": "More dev documentation of MPCONFIG usage and sources. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffe775ef82a36fcc7c83375583214914c690b415", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/ffe775ef82a36fcc7c83375583214914c690b415", "committedDate": "2020-12-08T23:13:43Z", "message": "Add release notes for #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00b95335e0fd312bc4649c116a06ca6470391e8e", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/00b95335e0fd312bc4649c116a06ca6470391e8e", "committedDate": "2020-12-08T23:18:33Z", "message": "Add javadoc about what is DbSettingConfigHelper. #7457"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4a88a12d0e995994e3e7fd589baadf861040cc5", "author": {"user": {"login": "poikilotherm", "name": "Oliver Bertuch"}}, "url": "https://github.com/IQSS/dataverse/commit/f4a88a12d0e995994e3e7fd589baadf861040cc5", "committedDate": "2020-12-09T17:48:25Z", "message": "Make Sphinx happy by removing a redundant space in dev docs about configuration."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1350509d37f9fcb4c7993f45cc61dc28151806f", "author": {"user": {"login": "pdurbin", "name": "Philip Durbin"}}, "url": "https://github.com/IQSS/dataverse/commit/f1350509d37f9fcb4c7993f45cc61dc28151806f", "committedDate": "2020-12-09T18:29:45Z", "message": "add toc #7457"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NDg0MjI5", "url": "https://github.com/IQSS/dataverse/pull/7463#pullrequestreview-548484229", "createdAt": "2020-12-09T18:33:44Z", "commit": {"oid": "f1350509d37f9fcb4c7993f45cc61dc28151806f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 709, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}