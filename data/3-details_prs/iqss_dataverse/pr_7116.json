{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1MzE4MzIz", "number": 7116, "title": "global update of doi:mdcbaseurlstring and doi.baseurlstringnext", "bodyText": "to doi.dataciterestapiurlstring\nWhat this PR does / why we need it: Consolidates the existing jvm option for configuring Make Data Count queries to DataCite and the new one for the /pids API/reserving DOIs into a single option with a neutral (not-mdc-centric) name\nWhich issue(s) this PR closes:\nCloses #7113\nSpecial notes for your reviewer: If there are issues with the name, this PR may need a few global search/replaces, but I hope I've caught all the places a change is needed.\nSuggestions on how to test this: Set the jvm option incorrectly and verify that the /pids?persistentId= and the /admin/makeDataCount/{id}/updateCitationsForDataset API calls fail (showing that both are picking up the new jvm option) and then set it to https://api.test.datacite.org to verify that these calls work. To test the defaults, you can make sure old doi.mdcbaseurlstring jvm option is set. The changes to the install scripts should result in this new jvm option being set instead of the old doi.mdcbaseurlstring option.\nDoes this PR introduce a user interface change? If mockups are available, please link/include them here: no\nIs there a release notes update needed for this change?: yes - we're changing the name of/replacing a jvm option defined since 4.18\nAdditional documentation:", "createdAt": "2020-07-22T19:44:01Z", "url": "https://github.com/IQSS/dataverse/pull/7116", "merged": true, "mergeCommit": {"oid": "2d632aef83e92022b9773eb6c43ae63ea24c152a"}, "closed": true, "closedAt": "2020-08-11T22:01:20Z", "author": {"login": "qqmyers"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3gDjzAH2gAyNDU1MzE4MzIzOjE4NTA0NDY0MGE4NDY5NDZmZjU1MWM2YmE4YzZhZDVkNjU0MTkwYWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9nEvIAFqTQ2NDQ5ODAzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "185044640a846946ff551c6ba8c6ad5d654190af", "author": {"user": {"login": "qqmyers", "name": null}}, "url": "https://github.com/IQSS/dataverse/commit/185044640a846946ff551c6ba8c6ad5d654190af", "committedDate": "2020-07-22T19:32:46Z", "message": "global update of doi:mdcbaseurlstring and doi.baseurlstringnext\n\nto doi.dataciterestapiurlstring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "946080f3e22f700cb9e71d2df5e1a25d23afc275", "author": {"user": {"login": "djbrooke", "name": "Danny Brooke"}}, "url": "https://github.com/IQSS/dataverse/commit/946080f3e22f700cb9e71d2df5e1a25d23afc275", "committedDate": "2020-07-23T13:59:22Z", "message": "rename release note file so I update at release time"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDQxNzI4", "url": "https://github.com/IQSS/dataverse/pull/7116#pullrequestreview-464441728", "createdAt": "2020-08-10T17:44:23Z", "commit": {"oid": "946080f3e22f700cb9e71d2df5e1a25d23afc275"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNzo0NDoyM1rOG-Y3mA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNzo0NDoyM1rOG-Y3mA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA3MjM0NA==", "bodyText": "So this API endpoint only supports DataCite?", "url": "https://github.com/IQSS/dataverse/pull/7116#discussion_r468072344", "createdAt": "2020-08-10T17:44:23Z", "author": {"login": "sekmiller"}, "path": "src/main/java/edu/harvard/iq/dataverse/api/Pids.java", "diffHunk": "@@ -45,7 +45,7 @@ public Response getPid(@QueryParam(\"persistentId\") String persistentId) {\n         } catch (WrappedResponse ex) {\n             return error(Response.Status.FORBIDDEN, BundleUtil.getStringFromBundle(\"api.errors.invalidApiToken\"));\n         }\n-        String baseUrl = System.getProperty(\"doi.baseurlstringnext\");\n+        String baseUrl = systemConfig.getDataCiteRestApiUrlString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "946080f3e22f700cb9e71d2df5e1a25d23afc275"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDUwNzUz", "url": "https://github.com/IQSS/dataverse/pull/7116#pullrequestreview-464450753", "createdAt": "2020-08-10T17:55:47Z", "commit": {"oid": "946080f3e22f700cb9e71d2df5e1a25d23afc275"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNzo1NTo0OFrOG-ZRjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNzo1NTo0OFrOG-ZRjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA3ODk4OQ==", "bodyText": "Again, surprised that this command only supports DataCite, but it was like this previously.", "url": "https://github.com/IQSS/dataverse/pull/7116#discussion_r468078989", "createdAt": "2020-08-10T17:55:48Z", "author": {"login": "sekmiller"}, "path": "src/main/java/edu/harvard/iq/dataverse/engine/command/impl/DeletePidCommand.java", "diffHunk": "@@ -47,7 +47,7 @@ protected void executeImpl(CommandContext ctxt) throws CommandException {\n         GlobalIdServiceBean idServiceBean = GlobalIdServiceBean.getBean(protocol, ctxt);\n         try {\n             // idServiceBean.deleteIdentifier(dataset); // didn't work\n-            String baseUrl = System.getProperty(\"doi.baseurlstringnext\");\n+            String baseUrl = ctxt.systemConfig().getDataCiteRestApiUrlString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "946080f3e22f700cb9e71d2df5e1a25d23afc275"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDU0MzAw", "url": "https://github.com/IQSS/dataverse/pull/7116#pullrequestreview-464454300", "createdAt": "2020-08-10T18:00:38Z", "commit": {"oid": "946080f3e22f700cb9e71d2df5e1a25d23afc275"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e20a52fd5e0c3498df9e2a023f86417f079acdfb", "author": {"user": {"login": "qqmyers", "name": null}}, "url": "https://github.com/IQSS/dataverse/commit/e20a52fd5e0c3498df9e2a023f86417f079acdfb", "committedDate": "2020-08-10T18:19:09Z", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/7113\n\n-consolidate_datacite_jvm_options\n\nConflicts:\n\tsrc/main/java/edu/harvard/iq/dataverse/DOIDataCiteServiceBean.java\n\tsrc/main/java/edu/harvard/iq/dataverse/engine/command/impl/DeletePidCommand.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "990c6597a915563b6eb4e9617a371f587a75b4d5", "author": {"user": {"login": "qqmyers", "name": null}}, "url": "https://github.com/IQSS/dataverse/commit/990c6597a915563b6eb4e9617a371f587a75b4d5", "committedDate": "2020-08-10T18:25:30Z", "message": "Merge remote-tracking branch 'origin/IQSS/7113-consolidate_datacite_jvm_options' into IQSS/7113-consolidate_datacite_jvm_options"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDk4MDM0", "url": "https://github.com/IQSS/dataverse/pull/7116#pullrequestreview-464498034", "createdAt": "2020-08-10T19:06:56Z", "commit": {"oid": "990c6597a915563b6eb4e9617a371f587a75b4d5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 902, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}