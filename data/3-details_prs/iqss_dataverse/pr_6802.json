{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNTQ4MTQ5", "number": 6802, "title": "6781 my data render", "bodyText": "What this PR does / why we need it:\nFixes MyData rendering\nWhich issue(s) this PR closes:\nCloses #6781\nSpecial notes for your reviewer:\nGets dataset version based on the versionId saved in the SolrSearchResult\nSuggestions on how to test this:\nCannot be a super user. Also try oddball cases like only a draft and/or all versions deaccessioned.\nDoes this PR introduce a user interface change?:\nNo\nIs there a release notes update needed for this change?:\nNo\nAdditional documentation:\nNone", "createdAt": "2020-04-09T17:19:07Z", "url": "https://github.com/IQSS/dataverse/pull/6802", "merged": true, "mergeCommit": {"oid": "47ca3c36e4b2c2bb9954f75f554068d21264545f"}, "closed": true, "closedAt": "2020-04-10T21:41:48Z", "author": {"login": "sekmiller"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcV93rbgH2gAyNDAxNTQ4MTQ5OmY1NGU1OGMzMDdjODllNzdmNmMzYmI0YWVjMGYyMjhjZDQxMTU2MWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWCKWiAFqTM5MTA5NDAwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f54e58c307c89e77f6c3bb4aec0f228cd411561b", "author": {"user": {"login": "sekmiller", "name": "Stephen Kraffmiller"}}, "url": "https://github.com/IQSS/dataverse/commit/f54e58c307c89e77f6c3bb4aec0f228cd411561b", "committedDate": "2020-04-09T15:03:31Z", "message": "#6781 test for version before adding details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13edb2f262c34e355cc5e8c3931a760222e9af2e", "author": {"user": {"login": "sekmiller", "name": "Stephen Kraffmiller"}}, "url": "https://github.com/IQSS/dataverse/commit/13edb2f262c34e355cc5e8c3931a760222e9af2e", "committedDate": "2020-04-09T17:10:11Z", "message": "#6781 rely on versionId to get correct version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5e586dfdde2731e319f0846e110f2ac084d7203", "author": {"user": {"login": "sekmiller", "name": "Stephen Kraffmiller"}}, "url": "https://github.com/IQSS/dataverse/commit/f5e586dfdde2731e319f0846e110f2ac084d7203", "committedDate": "2020-04-09T17:20:41Z", "message": "#6781 source format"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMDMwNzkx", "url": "https://github.com/IQSS/dataverse/pull/6802#pullrequestreview-391030791", "createdAt": "2020-04-09T18:26:07Z", "commit": {"oid": "f5e586dfdde2731e319f0846e110f2ac084d7203"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxODoyNjowN1rOGDkXQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxODoyNjowN1rOGDkXQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM5NDY4OQ==", "bodyText": "This is good, but let's move this logic onto a method on Dataset (in case we need to use it elsewhere some time, and then it makes this fewer lines, ie.\nDatasetVersion dv = ds.getVersion(this.datasetVersionId);", "url": "https://github.com/IQSS/dataverse/pull/6802#discussion_r406394689", "createdAt": "2020-04-09T18:26:07Z", "author": {"login": "scolapasta"}, "path": "src/main/java/edu/harvard/iq/dataverse/search/SolrSearchResult.java", "diffHunk": "@@ -560,16 +560,18 @@ public JsonObjectBuilder json(boolean showRelevance, boolean showEntityIds, bool\n         }\n         \n         if (this.entity == null) {\n-            \n+\n         } else {\n             if (this.entity.isInstanceofDataset()) {\n                 nullSafeJsonBuilder.add(\"storageIdentifier\", this.entity.getStorageIdentifier());\n                 Dataset ds = (Dataset) this.entity;\n-                DatasetVersion dv;\n-                if (this.isDraftState()) {\n-                    dv = ds.getLatestVersion();\n-                } else {\n-                    dv = ds.getReleasedVersion();\n+                DatasetVersion dv = null;\n+\n+                for (DatasetVersion v : ds.getVersions()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5e586dfdde2731e319f0846e110f2ac084d7203"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d80b448d1d8a6e91c083f3c2ee31140704774721", "author": {"user": {"login": "sekmiller", "name": "Stephen Kraffmiller"}}, "url": "https://github.com/IQSS/dataverse/commit/d80b448d1d8a6e91c083f3c2ee31140704774721", "committedDate": "2020-04-09T19:52:59Z", "message": "#6781 move getVersion to ds object"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMDk0MDAw", "url": "https://github.com/IQSS/dataverse/pull/6802#pullrequestreview-391094000", "createdAt": "2020-04-09T20:03:32Z", "commit": {"oid": "d80b448d1d8a6e91c083f3c2ee31140704774721"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 966, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}