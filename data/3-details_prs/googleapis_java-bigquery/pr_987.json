{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMTExMjYy", "number": 987, "title": "feat: set requestId for fast query path in QueryRequestInfo instead of QueryJobConfiguration", "bodyText": "As requested @epavan", "createdAt": "2020-12-02T15:50:51Z", "url": "https://github.com/googleapis/java-bigquery/pull/987", "merged": true, "mergeCommit": {"oid": "e2cd4f63ccc543e144f90e06eaadb2e96ce94943"}, "closed": true, "closedAt": "2020-12-05T00:42:04Z", "author": {"login": "stephaniewang526"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjAXOQgFqTU0NTM2MjY5Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdjBPvcgBqjQwNzQ5NjY4OTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MzYyNjk2", "url": "https://github.com/googleapis/java-bigquery/pull/987#pullrequestreview-545362696", "createdAt": "2020-12-04T23:29:57Z", "commit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzoyOTo1N1rOH_l7Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzoyOTo1N1rOH_l7Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ0MzY5OQ==", "bodyText": "Need to validate that what is captured is actually what we expect to see (except the requestId).", "url": "https://github.com/googleapis/java-bigquery/pull/987#discussion_r536443699", "createdAt": "2020-12-04T23:29:57Z", "author": {"login": "epavan123"}, "path": "google-cloud-bigquery/src/test/java/com/google/cloud/bigquery/BigQueryImplTest.java", "diffHunk": "@@ -1885,9 +1885,8 @@ public void testFastQueryRequestCompleted() throws InterruptedException {\n             .setTotalBytesProcessed(42L)\n             .setTotalRows(BigInteger.valueOf(1L));\n \n-    QueryRequestInfo requestInfo = new QueryRequestInfo(QUERY_JOB_CONFIGURATION_FOR_QUERY);\n-\n-    when(bigqueryRpcMock.queryRpc(PROJECT, requestInfo.toPb())).thenReturn(queryResponsePb);\n+    when(bigqueryRpcMock.queryRpc(eq(PROJECT), requestPbCapture.capture()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MzY1OTI5", "url": "https://github.com/googleapis/java-bigquery/pull/987#pullrequestreview-545365929", "createdAt": "2020-12-04T23:41:22Z", "commit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzo0MToyMlrOH_mInQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzo0MToyMlrOH_mInQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ0NzEzMw==", "bodyText": "Are there any cases where a QueryRequestInfo may get reused? Such usage may indicate we set this at time of sending the request (outside of the retry wrapper) rather than time of instantiating the request.", "url": "https://github.com/googleapis/java-bigquery/pull/987#discussion_r536447133", "createdAt": "2020-12-04T23:41:22Z", "author": {"login": "shollyman"}, "path": "google-cloud-bigquery/src/main/java/com/google/cloud/bigquery/QueryRequestInfo.java", "diffHunk": "@@ -49,9 +50,9 @@\n     this.maxResults = config.getMaxResults();\n     this.query = config.getQuery();\n     this.queryParameters = config.toPb().getQuery().getQueryParameters();\n+    this.requestId = UUID.randomUUID().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1Mzc0ODY4", "url": "https://github.com/googleapis/java-bigquery/pull/987#pullrequestreview-545374868", "createdAt": "2020-12-05T00:17:28Z", "commit": {"oid": "7123195d9a91fc50456020ed08fa8a33fd493084"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1Mzc3NjA4", "url": "https://github.com/googleapis/java-bigquery/pull/987#pullrequestreview-545377608", "createdAt": "2020-12-05T00:29:58Z", "commit": {"oid": "7123195d9a91fc50456020ed08fa8a33fd493084"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "988a2ba4924463999882f7ba88bad2984a4b1421", "author": {"user": {"login": "stephaniewang526", "name": "Stephanie Wang"}}, "url": "https://github.com/googleapis/java-bigquery/commit/988a2ba4924463999882f7ba88bad2984a4b1421", "committedDate": "2020-12-05T00:31:24Z", "message": "feat: set requestId for fast query path in QueryRequestInfo instead of QueryJobConfiguration."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0d7254f48f64f4dd8c8c943a1bee24d4911774f", "author": {"user": {"login": "stephaniewang526", "name": "Stephanie Wang"}}, "url": "https://github.com/googleapis/java-bigquery/commit/d0d7254f48f64f4dd8c8c943a1bee24d4911774f", "committedDate": "2020-12-05T00:31:31Z", "message": "push more changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c4439a280534aa6c2a1003bb3914f00cd7b4fdf", "author": {"user": {"login": "stephaniewang526", "name": "Stephanie Wang"}}, "url": "https://github.com/googleapis/java-bigquery/commit/8c4439a280534aa6c2a1003bb3914f00cd7b4fdf", "committedDate": "2020-12-05T00:31:31Z", "message": "fix: toEquals() test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "030135a21737e28b1ce1fc6da9d0aa675223dabe", "author": {"user": {"login": "stephaniewang526", "name": "Stephanie Wang"}}, "url": "https://github.com/googleapis/java-bigquery/commit/030135a21737e28b1ce1fc6da9d0aa675223dabe", "committedDate": "2020-12-05T00:31:31Z", "message": "update to use ArgumentCaptor to avoid Matcher issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71c46ae85da282aa27b21050a5c015aa09a9d58c", "author": {"user": {"login": "stephaniewang526", "name": "Stephanie Wang"}}, "url": "https://github.com/googleapis/java-bigquery/commit/71c46ae85da282aa27b21050a5c015aa09a9d58c", "committedDate": "2020-12-05T00:31:31Z", "message": "nit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91e1fb9ef6a03e2b083440906bd76e0ac4521807", "author": {"user": {"login": "stephaniewang526", "name": "Stephanie Wang"}}, "url": "https://github.com/googleapis/java-bigquery/commit/91e1fb9ef6a03e2b083440906bd76e0ac4521807", "committedDate": "2020-12-05T00:31:32Z", "message": "add check for QueryRequestCapture against QueryJobConfiguration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7123195d9a91fc50456020ed08fa8a33fd493084", "author": {"user": {"login": "stephaniewang526", "name": "Stephanie Wang"}}, "url": "https://github.com/googleapis/java-bigquery/commit/7123195d9a91fc50456020ed08fa8a33fd493084", "committedDate": "2020-12-04T23:54:28Z", "message": "add check for QueryRequestCapture against QueryJobConfiguration"}, "afterCommit": {"oid": "91e1fb9ef6a03e2b083440906bd76e0ac4521807", "author": {"user": {"login": "stephaniewang526", "name": "Stephanie Wang"}}, "url": "https://github.com/googleapis/java-bigquery/commit/91e1fb9ef6a03e2b083440906bd76e0ac4521807", "committedDate": "2020-12-05T00:31:32Z", "message": "add check for QueryRequestCapture against QueryJobConfiguration"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1296, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}