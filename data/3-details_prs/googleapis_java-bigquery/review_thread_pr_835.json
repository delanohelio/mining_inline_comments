{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3MTIzNDQ0", "number": 835, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQyMzowNTozMlrOEwAlkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQyMzoxMDoxNVrOEwApew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4Nzc2NzIxOnYy", "diffSide": "RIGHT", "path": "samples/snippets/src/main/java/com/example/bigquery/QueryExternalTableAws.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQyMzowNTozMlrOHlUPsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQyMzozMTozMlrOHlUw-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5MTA1OA==", "bodyText": "Should you explain what this SQL statement does?", "url": "https://github.com/googleapis/java-bigquery/pull/835#discussion_r508891058", "createdAt": "2020-10-20T23:05:32Z", "author": {"login": "lesv"}, "path": "samples/snippets/src/main/java/com/example/bigquery/QueryExternalTableAws.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_omni_query_external_aws_s3]\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.CsvOptions;\n+import com.google.cloud.bigquery.DatasetId;\n+import com.google.cloud.bigquery.ExternalTableDefinition;\n+import com.google.cloud.bigquery.Field;\n+import com.google.cloud.bigquery.QueryJobConfiguration;\n+import com.google.cloud.bigquery.Schema;\n+import com.google.cloud.bigquery.StandardSQLTypeName;\n+import com.google.cloud.bigquery.TableId;\n+import com.google.cloud.bigquery.TableInfo;\n+import com.google.cloud.bigquery.TableResult;\n+\n+// Sample to queries an external data source aws s3 using a permanent table\n+public class QueryExternalTableAws {\n+\n+  public static void main(String[] args) {\n+    // TODO(developer): Replace these variables before running the sample.\n+    String projectId = \"MY_PROJECT_ID\";\n+    String datasetName = \"MY_DATASET_NAME\";\n+    String externalTableName = \"MY_EXTERNAL_TABLE_NAME\";\n+    String query =\n+        String.format(\n+            \"SELECT * FROM s%.%s.%s WHERE name LIKE 'W%%'\",\n+            projectId, datasetName, externalTableName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7242c725e280a4cd9a853d2a8d036b1bf172c8ce"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5OTU3OQ==", "bodyText": "Yes - excellent idea! Thank you!\nDone!", "url": "https://github.com/googleapis/java-bigquery/pull/835#discussion_r508899579", "createdAt": "2020-10-20T23:31:32Z", "author": {"login": "stephaniewang526"}, "path": "samples/snippets/src/main/java/com/example/bigquery/QueryExternalTableAws.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_omni_query_external_aws_s3]\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.CsvOptions;\n+import com.google.cloud.bigquery.DatasetId;\n+import com.google.cloud.bigquery.ExternalTableDefinition;\n+import com.google.cloud.bigquery.Field;\n+import com.google.cloud.bigquery.QueryJobConfiguration;\n+import com.google.cloud.bigquery.Schema;\n+import com.google.cloud.bigquery.StandardSQLTypeName;\n+import com.google.cloud.bigquery.TableId;\n+import com.google.cloud.bigquery.TableInfo;\n+import com.google.cloud.bigquery.TableResult;\n+\n+// Sample to queries an external data source aws s3 using a permanent table\n+public class QueryExternalTableAws {\n+\n+  public static void main(String[] args) {\n+    // TODO(developer): Replace these variables before running the sample.\n+    String projectId = \"MY_PROJECT_ID\";\n+    String datasetName = \"MY_DATASET_NAME\";\n+    String externalTableName = \"MY_EXTERNAL_TABLE_NAME\";\n+    String query =\n+        String.format(\n+            \"SELECT * FROM s%.%s.%s WHERE name LIKE 'W%%'\",\n+            projectId, datasetName, externalTableName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5MTA1OA=="}, "originalCommit": {"oid": "7242c725e280a4cd9a853d2a8d036b1bf172c8ce"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4Nzc3NTAxOnYy", "diffSide": "RIGHT", "path": "samples/snippets/src/main/java/com/example/bigquery/QueryExternalTableAws.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQyMzowOToxNVrOHlUUfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQyMzozMToyOFrOHlUw4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5MjI4Ng==", "bodyText": "Should these be caught?  Perhaps just mention them or let them propagate?  NOTE - BigQueryException is a RuntimeException and InterruptedException is not.", "url": "https://github.com/googleapis/java-bigquery/pull/835#discussion_r508892286", "createdAt": "2020-10-20T23:09:15Z", "author": {"login": "lesv"}, "path": "samples/snippets/src/main/java/com/example/bigquery/QueryExternalTableAws.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_omni_query_external_aws_s3]\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.CsvOptions;\n+import com.google.cloud.bigquery.DatasetId;\n+import com.google.cloud.bigquery.ExternalTableDefinition;\n+import com.google.cloud.bigquery.Field;\n+import com.google.cloud.bigquery.QueryJobConfiguration;\n+import com.google.cloud.bigquery.Schema;\n+import com.google.cloud.bigquery.StandardSQLTypeName;\n+import com.google.cloud.bigquery.TableId;\n+import com.google.cloud.bigquery.TableInfo;\n+import com.google.cloud.bigquery.TableResult;\n+\n+// Sample to queries an external data source aws s3 using a permanent table\n+public class QueryExternalTableAws {\n+\n+  public static void main(String[] args) {\n+    // TODO(developer): Replace these variables before running the sample.\n+    String projectId = \"MY_PROJECT_ID\";\n+    String datasetName = \"MY_DATASET_NAME\";\n+    String externalTableName = \"MY_EXTERNAL_TABLE_NAME\";\n+    String query =\n+        String.format(\n+            \"SELECT * FROM s%.%s.%s WHERE name LIKE 'W%%'\",\n+            projectId, datasetName, externalTableName);\n+    queryExternalTableAws(query);\n+  }\n+\n+  public static void queryExternalTableAws(String query) {\n+    try {\n+      // Initialize client that will be used to send requests. This client only needs to be created\n+      // once, and can be reused for multiple requests.\n+      BigQuery bigquery = BigQueryOptions.getDefaultInstance().getService();\n+\n+      // Example query to find states starting with 'W'\n+      TableResult results = bigquery.query(QueryJobConfiguration.of(query));\n+\n+      results\n+          .iterateAll()\n+          .forEach(row -> row.forEach(val -> System.out.printf(\"%s,\", val.toString())));\n+\n+      System.out.println(\"Query on aws external permanent table performed successfully.\");\n+    } catch (BigQueryException | InterruptedException e) {\n+      System.out.println(\"Query not performed \\n\" + e.toString());\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7242c725e280a4cd9a853d2a8d036b1bf172c8ce"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5MjQzMQ==", "bodyText": "More important is why might these have been thrown and what should a user really do with them?", "url": "https://github.com/googleapis/java-bigquery/pull/835#discussion_r508892431", "createdAt": "2020-10-20T23:09:42Z", "author": {"login": "lesv"}, "path": "samples/snippets/src/main/java/com/example/bigquery/QueryExternalTableAws.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_omni_query_external_aws_s3]\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.CsvOptions;\n+import com.google.cloud.bigquery.DatasetId;\n+import com.google.cloud.bigquery.ExternalTableDefinition;\n+import com.google.cloud.bigquery.Field;\n+import com.google.cloud.bigquery.QueryJobConfiguration;\n+import com.google.cloud.bigquery.Schema;\n+import com.google.cloud.bigquery.StandardSQLTypeName;\n+import com.google.cloud.bigquery.TableId;\n+import com.google.cloud.bigquery.TableInfo;\n+import com.google.cloud.bigquery.TableResult;\n+\n+// Sample to queries an external data source aws s3 using a permanent table\n+public class QueryExternalTableAws {\n+\n+  public static void main(String[] args) {\n+    // TODO(developer): Replace these variables before running the sample.\n+    String projectId = \"MY_PROJECT_ID\";\n+    String datasetName = \"MY_DATASET_NAME\";\n+    String externalTableName = \"MY_EXTERNAL_TABLE_NAME\";\n+    String query =\n+        String.format(\n+            \"SELECT * FROM s%.%s.%s WHERE name LIKE 'W%%'\",\n+            projectId, datasetName, externalTableName);\n+    queryExternalTableAws(query);\n+  }\n+\n+  public static void queryExternalTableAws(String query) {\n+    try {\n+      // Initialize client that will be used to send requests. This client only needs to be created\n+      // once, and can be reused for multiple requests.\n+      BigQuery bigquery = BigQueryOptions.getDefaultInstance().getService();\n+\n+      // Example query to find states starting with 'W'\n+      TableResult results = bigquery.query(QueryJobConfiguration.of(query));\n+\n+      results\n+          .iterateAll()\n+          .forEach(row -> row.forEach(val -> System.out.printf(\"%s,\", val.toString())));\n+\n+      System.out.println(\"Query on aws external permanent table performed successfully.\");\n+    } catch (BigQueryException | InterruptedException e) {\n+      System.out.println(\"Query not performed \\n\" + e.toString());\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5MjI4Ng=="}, "originalCommit": {"oid": "7242c725e280a4cd9a853d2a8d036b1bf172c8ce"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5OTU1NA==", "bodyText": "I think we will catch BigQueryException and not InterruptedException.\nUpdated!", "url": "https://github.com/googleapis/java-bigquery/pull/835#discussion_r508899554", "createdAt": "2020-10-20T23:31:28Z", "author": {"login": "stephaniewang526"}, "path": "samples/snippets/src/main/java/com/example/bigquery/QueryExternalTableAws.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_omni_query_external_aws_s3]\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.CsvOptions;\n+import com.google.cloud.bigquery.DatasetId;\n+import com.google.cloud.bigquery.ExternalTableDefinition;\n+import com.google.cloud.bigquery.Field;\n+import com.google.cloud.bigquery.QueryJobConfiguration;\n+import com.google.cloud.bigquery.Schema;\n+import com.google.cloud.bigquery.StandardSQLTypeName;\n+import com.google.cloud.bigquery.TableId;\n+import com.google.cloud.bigquery.TableInfo;\n+import com.google.cloud.bigquery.TableResult;\n+\n+// Sample to queries an external data source aws s3 using a permanent table\n+public class QueryExternalTableAws {\n+\n+  public static void main(String[] args) {\n+    // TODO(developer): Replace these variables before running the sample.\n+    String projectId = \"MY_PROJECT_ID\";\n+    String datasetName = \"MY_DATASET_NAME\";\n+    String externalTableName = \"MY_EXTERNAL_TABLE_NAME\";\n+    String query =\n+        String.format(\n+            \"SELECT * FROM s%.%s.%s WHERE name LIKE 'W%%'\",\n+            projectId, datasetName, externalTableName);\n+    queryExternalTableAws(query);\n+  }\n+\n+  public static void queryExternalTableAws(String query) {\n+    try {\n+      // Initialize client that will be used to send requests. This client only needs to be created\n+      // once, and can be reused for multiple requests.\n+      BigQuery bigquery = BigQueryOptions.getDefaultInstance().getService();\n+\n+      // Example query to find states starting with 'W'\n+      TableResult results = bigquery.query(QueryJobConfiguration.of(query));\n+\n+      results\n+          .iterateAll()\n+          .forEach(row -> row.forEach(val -> System.out.printf(\"%s,\", val.toString())));\n+\n+      System.out.println(\"Query on aws external permanent table performed successfully.\");\n+    } catch (BigQueryException | InterruptedException e) {\n+      System.out.println(\"Query not performed \\n\" + e.toString());\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5MjI4Ng=="}, "originalCommit": {"oid": "7242c725e280a4cd9a853d2a8d036b1bf172c8ce"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4Nzc3NzIzOnYy", "diffSide": "RIGHT", "path": "samples/snippets/src/test/java/com/example/bigquery/CreateExternalTableAwsIT.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQyMzoxMDoxNVrOHlUVyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQyMzozMTowOVrOHlUwaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5MjYxNw==", "bodyText": "Might not be your best final choice for a bucket name.", "url": "https://github.com/googleapis/java-bigquery/pull/835#discussion_r508892617", "createdAt": "2020-10-20T23:10:15Z", "author": {"login": "lesv"}, "path": "samples/snippets/src/test/java/com/example/bigquery/CreateExternalTableAwsIT.java", "diffHunk": "@@ -120,18 +90,19 @@ public void tearDown() throws IOException {\n \n   @Test\n   public void testCreateExternalTableAws() {\n-    String sourceUri = \"s3://cloud-samples-tests/us-states.csv\";\n+    String sourceUri = \"s3://steph-omni-test-bucket/us-states.csv\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7242c725e280a4cd9a853d2a8d036b1bf172c8ce"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5OTQzMg==", "bodyText": "Yes - you're right. Created a new bucket for devrel sampels testing. Thank you!", "url": "https://github.com/googleapis/java-bigquery/pull/835#discussion_r508899432", "createdAt": "2020-10-20T23:31:09Z", "author": {"login": "stephaniewang526"}, "path": "samples/snippets/src/test/java/com/example/bigquery/CreateExternalTableAwsIT.java", "diffHunk": "@@ -120,18 +90,19 @@ public void tearDown() throws IOException {\n \n   @Test\n   public void testCreateExternalTableAws() {\n-    String sourceUri = \"s3://cloud-samples-tests/us-states.csv\";\n+    String sourceUri = \"s3://steph-omni-test-bucket/us-states.csv\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODg5MjYxNw=="}, "originalCommit": {"oid": "7242c725e280a4cd9a853d2a8d036b1bf172c8ce"}, "originalPosition": 79}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3588, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}