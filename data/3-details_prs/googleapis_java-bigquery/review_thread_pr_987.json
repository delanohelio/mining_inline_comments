{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMTExMjYy", "number": 987, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzoyOTo1N1rOFBBZRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzo0MToyMlrOFBBjPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2NjE1NzQ4OnYy", "diffSide": "RIGHT", "path": "google-cloud-bigquery/src/test/java/com/google/cloud/bigquery/BigQueryImplTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzoyOTo1N1rOH_l7Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzo1NTowN1rOH_mXbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ0MzY5OQ==", "bodyText": "Need to validate that what is captured is actually what we expect to see (except the requestId).", "url": "https://github.com/googleapis/java-bigquery/pull/987#discussion_r536443699", "createdAt": "2020-12-04T23:29:57Z", "author": {"login": "epavan123"}, "path": "google-cloud-bigquery/src/test/java/com/google/cloud/bigquery/BigQueryImplTest.java", "diffHunk": "@@ -1885,9 +1885,8 @@ public void testFastQueryRequestCompleted() throws InterruptedException {\n             .setTotalBytesProcessed(42L)\n             .setTotalRows(BigInteger.valueOf(1L));\n \n-    QueryRequestInfo requestInfo = new QueryRequestInfo(QUERY_JOB_CONFIGURATION_FOR_QUERY);\n-\n-    when(bigqueryRpcMock.queryRpc(PROJECT, requestInfo.toPb())).thenReturn(queryResponsePb);\n+    when(bigqueryRpcMock.queryRpc(eq(PROJECT), requestPbCapture.capture()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ1MDkyNw==", "bodyText": "Done: 7123195", "url": "https://github.com/googleapis/java-bigquery/pull/987#discussion_r536450927", "createdAt": "2020-12-04T23:55:07Z", "author": {"login": "stephaniewang526"}, "path": "google-cloud-bigquery/src/test/java/com/google/cloud/bigquery/BigQueryImplTest.java", "diffHunk": "@@ -1885,9 +1885,8 @@ public void testFastQueryRequestCompleted() throws InterruptedException {\n             .setTotalBytesProcessed(42L)\n             .setTotalRows(BigInteger.valueOf(1L));\n \n-    QueryRequestInfo requestInfo = new QueryRequestInfo(QUERY_JOB_CONFIGURATION_FOR_QUERY);\n-\n-    when(bigqueryRpcMock.queryRpc(PROJECT, requestInfo.toPb())).thenReturn(queryResponsePb);\n+    when(bigqueryRpcMock.queryRpc(eq(PROJECT), requestPbCapture.capture()))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ0MzY5OQ=="}, "originalCommit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2NjE4MzAzOnYy", "diffSide": "RIGHT", "path": "google-cloud-bigquery/src/main/java/com/google/cloud/bigquery/QueryRequestInfo.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMzo0MToyMlrOH_mInQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMDoyMzoyNlrOH_m1Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ0NzEzMw==", "bodyText": "Are there any cases where a QueryRequestInfo may get reused? Such usage may indicate we set this at time of sending the request (outside of the retry wrapper) rather than time of instantiating the request.", "url": "https://github.com/googleapis/java-bigquery/pull/987#discussion_r536447133", "createdAt": "2020-12-04T23:41:22Z", "author": {"login": "shollyman"}, "path": "google-cloud-bigquery/src/main/java/com/google/cloud/bigquery/QueryRequestInfo.java", "diffHunk": "@@ -49,9 +50,9 @@\n     this.maxResults = config.getMaxResults();\n     this.query = config.getQuery();\n     this.queryParameters = config.toPb().getQuery().getQueryParameters();\n+    this.requestId = UUID.randomUUID().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ1NDE3Mg==", "bodyText": "Yes -- we decided to design it to set this requestId at the time of instantiating the request object which means when a user runs the same QueryJobConfiguration twice, they will be sending two requestIds.", "url": "https://github.com/googleapis/java-bigquery/pull/987#discussion_r536454172", "createdAt": "2020-12-05T00:06:53Z", "author": {"login": "stephaniewang526"}, "path": "google-cloud-bigquery/src/main/java/com/google/cloud/bigquery/QueryRequestInfo.java", "diffHunk": "@@ -49,9 +50,9 @@\n     this.maxResults = config.getMaxResults();\n     this.query = config.getQuery();\n     this.queryParameters = config.toPb().getQuery().getQueryParameters();\n+    this.requestId = UUID.randomUUID().toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ0NzEzMw=="}, "originalCommit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ1Njk3MA==", "bodyText": "Thanks for clarifying.  My worry was mostly around cases where someone may retain a reference and use this in unexpected ways.", "url": "https://github.com/googleapis/java-bigquery/pull/987#discussion_r536456970", "createdAt": "2020-12-05T00:17:23Z", "author": {"login": "shollyman"}, "path": "google-cloud-bigquery/src/main/java/com/google/cloud/bigquery/QueryRequestInfo.java", "diffHunk": "@@ -49,9 +50,9 @@\n     this.maxResults = config.getMaxResults();\n     this.query = config.getQuery();\n     this.queryParameters = config.toPb().getQuery().getQueryParameters();\n+    this.requestId = UUID.randomUUID().toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ0NzEzMw=="}, "originalCommit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ1ODUxOQ==", "bodyText": "Noted -- thank you!", "url": "https://github.com/googleapis/java-bigquery/pull/987#discussion_r536458519", "createdAt": "2020-12-05T00:23:26Z", "author": {"login": "stephaniewang526"}, "path": "google-cloud-bigquery/src/main/java/com/google/cloud/bigquery/QueryRequestInfo.java", "diffHunk": "@@ -49,9 +50,9 @@\n     this.maxResults = config.getMaxResults();\n     this.query = config.getQuery();\n     this.queryParameters = config.toPb().getQuery().getQueryParameters();\n+    this.requestId = UUID.randomUUID().toString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ0NzEzMw=="}, "originalCommit": {"oid": "df941a18009b6f3ced5798cc432117f0a2622518"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3564, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}