{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNDgyNzMx", "number": 1551, "title": "Fetch insertSpaces and tabSize options from the client preferences", "bodyText": "Relates to redhat-developer/vscode-java#1572\nSigned-off-by: Snjezana Peco snjezana.peco@redhat.com", "createdAt": "2020-09-21T18:31:35Z", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551", "merged": true, "mergeCommit": {"oid": "f667fb57b9252c033ddf21780415252dc1e02b18"}, "closed": true, "closedAt": "2021-02-25T01:30:12Z", "author": {"login": "snjeza"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLXtHlAFqTQ5MzQzODQ2OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABd9M3B5gFqTU5NzIyNzI3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNDM4NDY4", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#pullrequestreview-493438468", "createdAt": "2020-09-22T13:07:29Z", "commit": {"oid": "484963df822fe0aa7b78d9d6c01ddaca27bf1559"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMzowNzozMFrOHV5HUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMzowNzozMFrOHV5HUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcxNzkwNQ==", "bodyText": "can we move preference settings to the preference manager?", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#discussion_r492717905", "createdAt": "2020-09-22T13:07:30Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/BaseInitHandler.java", "diffHunk": "@@ -114,6 +117,14 @@ public InitializeResult initialize(InitializeParams param) {\n \t\t\tPreferences prefs = Preferences.createFrom((Map<String, Object>) settings);\n \t\t\tprefs.setRootPaths(rootPaths);\n \t\t\tpreferenceManager.update(prefs);\n+\t\t\tHashtable<String, String> eclipseOptions = JavaCore.getOptions();\n+\t\t\tint tabSize = prefs.getTabSize();\n+\t\t\tif (tabSize > 0) {\n+\t\t\t\teclipseOptions.put(DefaultCodeFormatterConstants.FORMATTER_TAB_SIZE, String.valueOf(tabSize));\n+\t\t\t}\n+\t\t\tboolean insertSpaces = prefs.isInsertSpaces();\n+\t\t\teclipseOptions.put(DefaultCodeFormatterConstants.FORMATTER_TAB_CHAR, insertSpaces ? JavaCore.SPACE : JavaCore.TAB);\n+\t\t\tJavaCore.setOptions(eclipseOptions);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "484963df822fe0aa7b78d9d6c01ddaca27bf1559"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNDM5NjY3", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#pullrequestreview-493439667", "createdAt": "2020-09-22T13:08:44Z", "commit": {"oid": "484963df822fe0aa7b78d9d6c01ddaca27bf1559"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMzowODo0NFrOHV5Kpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxMzoxMDozNlrOHV5Pjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcxODc1OA==", "bodyText": "java.format.insertSpaces would be more consistent IMO", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#discussion_r492718758", "createdAt": "2020-09-22T13:08:44Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -57,6 +57,14 @@\n \t * Specifies the folder path to the JDK .\n \t */\n \tpublic static final String JAVA_HOME = \"java.home\";\n+\t/**\n+\t * Insert spaces when pressing Tab\n+\t */\n+\tpublic static final String JAVA_CONFIGURATION_INSERTSPACES = \"java.editor.insertSpaces\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "484963df822fe0aa7b78d9d6c01ddaca27bf1559"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcxODkwMg==", "bodyText": "java.format. tabSize would be more consistent IMO", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#discussion_r492718902", "createdAt": "2020-09-22T13:08:59Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -57,6 +57,14 @@\n \t * Specifies the folder path to the JDK .\n \t */\n \tpublic static final String JAVA_HOME = \"java.home\";\n+\t/**\n+\t * Insert spaces when pressing Tab\n+\t */\n+\tpublic static final String JAVA_CONFIGURATION_INSERTSPACES = \"java.editor.insertSpaces\";\n+\t/**\n+\t * Tab Size\n+\t */\n+\tpublic static final String JAVA_CONFIGURATION_TABSIZE = \"java.editor.tabSize\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "484963df822fe0aa7b78d9d6c01ddaca27bf1559"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcyMDAxNQ==", "bodyText": "you'd expect the settings to be updated after the server starts (onDidChangeConfiguration)", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#discussion_r492720015", "createdAt": "2020-09-22T13:10:36Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/BaseInitHandler.java", "diffHunk": "@@ -114,6 +117,14 @@ public InitializeResult initialize(InitializeParams param) {\n \t\t\tPreferences prefs = Preferences.createFrom((Map<String, Object>) settings);\n \t\t\tprefs.setRootPaths(rootPaths);\n \t\t\tpreferenceManager.update(prefs);\n+\t\t\tHashtable<String, String> eclipseOptions = JavaCore.getOptions();\n+\t\t\tint tabSize = prefs.getTabSize();\n+\t\t\tif (tabSize > 0) {\n+\t\t\t\teclipseOptions.put(DefaultCodeFormatterConstants.FORMATTER_TAB_SIZE, String.valueOf(tabSize));\n+\t\t\t}\n+\t\t\tboolean insertSpaces = prefs.isInsertSpaces();\n+\t\t\teclipseOptions.put(DefaultCodeFormatterConstants.FORMATTER_TAB_CHAR, insertSpaces ? JavaCore.SPACE : JavaCore.TAB);\n+\t\t\tJavaCore.setOptions(eclipseOptions);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcxNzkwNQ=="}, "originalCommit": {"oid": "484963df822fe0aa7b78d9d6c01ddaca27bf1559"}, "originalPosition": 28}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "484963df822fe0aa7b78d9d6c01ddaca27bf1559", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/484963df822fe0aa7b78d9d6c01ddaca27bf1559", "committedDate": "2020-09-21T18:25:29Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "4b831cbb5f7a98ecb8bd534c6d0c7fb9dab26ea2", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/4b831cbb5f7a98ecb8bd534c6d0c7fb9dab26ea2", "committedDate": "2020-09-22T19:10:35Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2Mzg4MjM2", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#pullrequestreview-496388236", "createdAt": "2020-09-25T12:49:36Z", "commit": {"oid": "4b831cbb5f7a98ecb8bd534c6d0c7fb9dab26ea2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxMjo0OTozNlrOHYCO_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxMjo1MjoyNVrOHYCVJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk2NDQ3OQ==", "bodyText": "this is inconsistent with https://github.com/eclipse/eclipse.jdt.ls/pull/1551/files#diff-3feb2f2158f1898f0a00165abf820e3dR643", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#discussion_r494964479", "createdAt": "2020-09-25T12:49:36Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/PreferenceManager.java", "diffHunk": "@@ -130,6 +129,8 @@ public static void initializeJavaCoreOptions() {\n \t\tjavaCoreOptions.put(JavaCore.COMPILER_PB_UNHANDLED_WARNING_TOKEN, JavaCore.IGNORE);\n \t\tjavaCoreOptions.put(JavaCore.COMPILER_PB_REDUNDANT_SUPERINTERFACE, JavaCore.WARNING);\n \t\tjavaCoreOptions.put(JavaCore.CODEASSIST_SUBWORD_MATCH, JavaCore.DISABLED);\n+\t\tjavaCoreOptions.put(DefaultCodeFormatterConstants.FORMATTER_TAB_CHAR, JavaCore.TAB);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b831cbb5f7a98ecb8bd534c6d0c7fb9dab26ea2"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk2NTkwOA==", "bodyText": "use a constant:\ntabSize = DEFAULT_TAB_SIZE;", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#discussion_r494965908", "createdAt": "2020-09-25T12:52:11Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -630,6 +640,8 @@ public Preferences() {\n \t\tstaticImportOnDemandThreshold = IMPORTS_STATIC_ONDEMANDTHRESHOLD_DEFAULT;\n \t\treferencedLibraries = JAVA_PROJECT_REFERENCED_LIBRARIES_DEFAULT;\n \t\tresourceFilters = JAVA_RESOURCE_FILTERS_DEFAULT;\n+\t\tinsertSpaces = true;\n+\t\ttabSize = 4;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b831cbb5f7a98ecb8bd534c6d0c7fb9dab26ea2"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk2NjA1NA==", "bodyText": "s/4/DEFAULT_TAB_SIZE", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#discussion_r494966054", "createdAt": "2020-09-25T12:52:25Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/Preferences.java", "diffHunk": "@@ -652,6 +664,10 @@ public static Preferences createFrom(Map<String, Object> configuration) {\n \n \t\tboolean importGradleEnabled = getBoolean(configuration, IMPORT_GRADLE_ENABLED, true);\n \t\tprefs.setImportGradleEnabled(importGradleEnabled);\n+\t\tboolean insertSpaces = getBoolean(configuration, JAVA_CONFIGURATION_INSERTSPACES, true);\n+\t\tprefs.setInsertSpaces(insertSpaces);\n+\t\tint tabSize = getInt(configuration, JAVA_CONFIGURATION_TABSIZE, 4);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b831cbb5f7a98ecb8bd534c6d0c7fb9dab26ea2"}, "originalPosition": 39}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b831cbb5f7a98ecb8bd534c6d0c7fb9dab26ea2", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/4b831cbb5f7a98ecb8bd534c6d0c7fb9dab26ea2", "committedDate": "2020-09-22T19:10:35Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "2f3b6db2aeb0ed7339564309a090ea0af8cfa6e4", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/2f3b6db2aeb0ed7339564309a090ea0af8cfa6e4", "committedDate": "2020-09-25T17:41:41Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f3b6db2aeb0ed7339564309a090ea0af8cfa6e4", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/2f3b6db2aeb0ed7339564309a090ea0af8cfa6e4", "committedDate": "2020-09-25T17:41:41Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "6ea90565035fbae0583f658bbbb0917494bc04ed", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/6ea90565035fbae0583f658bbbb0917494bc04ed", "committedDate": "2020-09-27T19:50:48Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b5d65399dbd9a59c40f96e44bd9d2a068f75015", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/8b5d65399dbd9a59c40f96e44bd9d2a068f75015", "committedDate": "2021-02-24T04:28:24Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6ea90565035fbae0583f658bbbb0917494bc04ed", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/6ea90565035fbae0583f658bbbb0917494bc04ed", "committedDate": "2020-09-27T19:50:48Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "8b5d65399dbd9a59c40f96e44bd9d2a068f75015", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/8b5d65399dbd9a59c40f96e44bd9d2a068f75015", "committedDate": "2021-02-24T04:28:24Z", "message": "Surround with try/catch reformats document\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk3MjI3Mjcx", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1551#pullrequestreview-597227271", "createdAt": "2021-02-24T08:45:35Z", "commit": {"oid": "8b5d65399dbd9a59c40f96e44bd9d2a068f75015"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1000, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}