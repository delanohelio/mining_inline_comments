{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyODcxMjg2", "number": 1476, "title": "Wait for jobs to complete when resolving the classpaths", "bodyText": "When I'm working for this PR: redhat-developer/vscode-java#1484, I found that the test case getClasspath will randomly fail, see: https://travis-ci.org/github/redhat-developer/vscode-java/jobs/697117335\nIt's because if we try to get the classpath when the m2e is updating the projects, the return results might only contain the source classes without dependency jars. so I add a wait here.\nSigned-off-by: Sheng Chen sheche@microsoft.com", "createdAt": "2020-06-11T06:38:39Z", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1476", "merged": true, "mergeCommit": {"oid": "e048ffa86047e7b362577a8f166639a1786043db"}, "closed": true, "closedAt": "2020-06-16T13:23:15Z", "author": {"login": "jdneo"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqIje_AFqTQyODYzNDU5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrsxEtgBqjM0NDcwNTg5NDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NjM0NTk5", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1476#pullrequestreview-428634599", "createdAt": "2020-06-11T06:48:39Z", "commit": {"oid": "bf97d944bcae579999694e5d0f7c155a29e3e3a9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjo0ODozOVrOGiQkzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwNjo0ODozOVrOGiQkzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU3NjMzNQ==", "bodyText": "That's too broad. You'll wait for unrelated jobs to finish", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1476#discussion_r438576335", "createdAt": "2020-06-11T06:48:39Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/commands/ProjectCommand.java", "diffHunk": "@@ -108,8 +110,10 @@\n \t *         modulepaths.\n \t * @throws CoreException\n \t * @throws URISyntaxException\n+\t * @throws InterruptedException\n \t */\n-\tpublic static ClasspathResult getClasspaths(String uri, ClasspathOptions options) throws CoreException, URISyntaxException {\n+\tpublic static ClasspathResult getClasspaths(String uri, ClasspathOptions options) throws CoreException, URISyntaxException, InterruptedException {\n+\t\tJobHelpers.waitForJobsToComplete(new NullProgressMonitor());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf97d944bcae579999694e5d0f7c155a29e3e3a9"}, "originalPosition": 24}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "00005c320312d9c0bd7f701397987ac930c7aba0", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/00005c320312d9c0bd7f701397987ac930c7aba0", "committedDate": "2020-06-12T02:48:22Z", "message": "Wrap the invocation of getting classpaths into workspace runnable\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}, "afterCommit": {"oid": "38b1a59ff53c2166f4b3637beb3e5817290e0c0f", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/38b1a59ff53c2166f4b3637beb3e5817290e0c0f", "committedDate": "2020-06-12T03:21:34Z", "message": "Wrap the invocation of getting classpaths into workspace runnable\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38b1a59ff53c2166f4b3637beb3e5817290e0c0f", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/38b1a59ff53c2166f4b3637beb3e5817290e0c0f", "committedDate": "2020-06-12T03:21:34Z", "message": "Wrap the invocation of getting classpaths into workspace runnable\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}, "afterCommit": {"oid": "901d0af112c4e3ce748886ca5dcbf979f5bc6d3c", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/901d0af112c4e3ce748886ca5dcbf979f5bc6d3c", "committedDate": "2020-06-12T03:23:44Z", "message": "Wrap the invocation of getting classpaths into workspace runnable\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNTQ1MjA5", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1476#pullrequestreview-430545209", "createdAt": "2020-06-15T11:13:39Z", "commit": {"oid": "901d0af112c4e3ce748886ca5dcbf979f5bc6d3c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxMToxMzozOVrOGjtucA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxMToxMzozOVrOGjtucA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDEwMjUxMg==", "bodyText": "move out of loop", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1476#discussion_r440102512", "createdAt": "2020-06-15T11:13:39Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.tests/src/org/eclipse/jdt/ls/core/internal/commands/ProjectCommandTest.java", "diffHunk": "@@ -116,6 +116,27 @@ public void testGetClasspathsForMaven() throws Exception {\n         assertTrue(containsJunit);\n     }\n \n+    @Test\n+    public void testGetClasspathsForMavenWhenUpdating() throws Exception {\n+        importProjects(\"maven/classpathtest\");\n+        IProject project = WorkspaceHelper.getProject(\"classpathtest\");\n+        String uriString = project.getFile(\"src/main/java/main/App.java\").getLocationURI().toString();\n+        ClasspathOptions options = new ClasspathOptions();\n+\n+        projectsManager.updateProject(project, true);\n+\n+        for (int i = 0; i < 10; i++) {\n+            options.scope = \"test\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "901d0af112c4e3ce748886ca5dcbf979f5bc6d3c"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d98c27752043d931f69823ab2b4930c3f772082", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/2d98c27752043d931f69823ab2b4930c3f772082", "committedDate": "2020-06-16T03:33:57Z", "message": "Wrap the invocation of getting classpaths into workspace runnable\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "901d0af112c4e3ce748886ca5dcbf979f5bc6d3c", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/901d0af112c4e3ce748886ca5dcbf979f5bc6d3c", "committedDate": "2020-06-12T03:23:44Z", "message": "Wrap the invocation of getting classpaths into workspace runnable\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}, "afterCommit": {"oid": "2d98c27752043d931f69823ab2b4930c3f772082", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/2d98c27752043d931f69823ab2b4930c3f772082", "committedDate": "2020-06-16T03:33:57Z", "message": "Wrap the invocation of getting classpaths into workspace runnable\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1146, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}