{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1NTI0MzQ1", "number": 1484, "title": "Optimize default VM management to avoid unnecessary project updates", "bodyText": "With the previous code, the java.home was initially prepared to be used as default VM, even though there was a default runtime set, potentially triggering unnecessary full builds", "createdAt": "2020-06-16T23:51:25Z", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1484", "merged": true, "mergeCommit": {"oid": "5bebe70b286244022a71d42586a42aba47e5942d"}, "closed": true, "closedAt": "2020-06-17T16:40:30Z", "author": {"login": "fbricon"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcr-KWtgH2gAyNDM1NTI0MzQ1OjdjYTJiZTk5ZjllNTcyOWM3ZTBkOWVhNmMzZTQwMmEwMWQ2M2NmZmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsMRK_AFqTQzMjU2MTc1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7ca2be99f9e5729c7e0d9ea6c3e402a01d63cffa", "author": {"user": {"login": "fbricon", "name": "Fred Bricon"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/7ca2be99f9e5729c7e0d9ea6c3e402a01d63cffa", "committedDate": "2020-06-16T23:50:15Z", "message": "Optimize default VM management to avoid unnecessary project updates\n\nSigned-off-by: Fred Bricon <fbricon@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxOTY5OTg3", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1484#pullrequestreview-431969987", "createdAt": "2020-06-17T00:00:14Z", "commit": {"oid": "7ca2be99f9e5729c7e0d9ea6c3e402a01d63cffa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMDowMDoxNFrOGkxF5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwMDowMDoxNFrOGkxF5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTIwNjI0NA==", "bodyText": "this caused full builds even though there was already a default runtime environment", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1484#discussion_r441206244", "createdAt": "2020-06-17T00:00:14Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/JVMConfigurator.java", "diffHunk": "@@ -52,55 +52,45 @@\n  */\n public class JVMConfigurator implements IVMInstallChangedListener {\n \n-\tpublic static boolean configureDefaultVM(Preferences preferences) throws CoreException {\n-\t\tif (preferences == null) {\n+\tpublic static boolean configureDefaultVM(String javaHome) throws CoreException {\n+\t\tif (StringUtils.isBlank(javaHome)) {\n \t\t\treturn false;\n \t\t}\n-\t\tString javaHome = preferences.getJavaHome();\n-\t\tboolean changed = false;\n-\t\tif (javaHome != null) {\n-\t\t\tFile jvmHome = new File(javaHome);\n-\t\t\tif (jvmHome.isDirectory()) {\n-\t\t\t\tIVMInstall vm = findVM(jvmHome, null);\n-\t\t\t\tif (vm == null) {\n-\t\t\t\t\tIVMInstallType installType = JavaRuntime.getVMInstallType(StandardVMType.ID_STANDARD_VM_TYPE);\n-\t\t\t\t\tlong unique = System.currentTimeMillis();\n-\t\t\t\t\twhile (installType.findVMInstall(String.valueOf(unique)) != null) {\n-\t\t\t\t\t\tunique++;\n-\t\t\t\t\t}\n-\t\t\t\t\tString vmId = String.valueOf(unique);\n-\t\t\t\t\tVMStandin vmStandin = new VMStandin(installType, vmId);\n-\t\t\t\t\tString name = StringUtils.defaultIfBlank(jvmHome.getName(), \"JRE\");\n-\t\t\t\t\tvmStandin.setName(name);\n-\t\t\t\t\tvmStandin.setInstallLocation(jvmHome);\n-\t\t\t\t\tvm = vmStandin.convertToRealVM();\n-\t\t\t\t\tJDTUtils.setCompatibleVMs(vm.getId());\n-\t\t\t\t\tchanged = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ca2be99f9e5729c7e0d9ea6c3e402a01d63cffa"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNTYxNzUw", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1484#pullrequestreview-432561750", "createdAt": "2020-06-17T16:16:22Z", "commit": {"oid": "7ca2be99f9e5729c7e0d9ea6c3e402a01d63cffa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1154, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}