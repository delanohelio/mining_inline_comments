{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NjUzNzI0", "number": 1389, "title": "Update the root path on workspace folder change event", "bodyText": "fix #1388\nSigned-off-by: Sheng Chen sheche@microsoft.com", "createdAt": "2020-03-17T06:41:35Z", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1389", "merged": true, "mergeCommit": {"oid": "a398271f14cb1acc67869d2c03c1f1c4440773dd"}, "closed": true, "closedAt": "2020-03-20T10:31:55Z", "author": {"login": "jdneo"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOjC6kgH2gAyMzg5NjUzNzI0OmQzOTMyM2IyN2UyNTE2NmI4NWNkOGZlZGVmNjg5NmQ3ZGM5MDg4OTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPIAZMgH2gAyMzg5NjUzNzI0OmIxZTc0MTg5ZmMwMzc0M2IwNmMzN2I2ZTIxYmRjNTM5ZWIzYWM5MGM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d39323b27e25166b85cd8fedef6896d7dc908896", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/d39323b27e25166b85cd8fedef6896d7dc908896", "committedDate": "2020-03-17T13:50:53Z", "message": "Update the root path on workspace folder change event\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "072c26192464d3a36e70aa7e6cdd0e3f4fdf34ed", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/072c26192464d3a36e70aa7e6cdd0e3f4fdf34ed", "committedDate": "2020-03-17T06:40:29Z", "message": "Update the root path on workspace folder change event\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}, "afterCommit": {"oid": "d39323b27e25166b85cd8fedef6896d7dc908896", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/d39323b27e25166b85cd8fedef6896d7dc908896", "committedDate": "2020-03-17T13:50:53Z", "message": "Update the root path on workspace folder change event\n\nSigned-off-by: Sheng Chen <sheche@microsoft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NDgwNjM0", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1389#pullrequestreview-377480634", "createdAt": "2020-03-19T07:40:23Z", "commit": {"oid": "d39323b27e25166b85cd8fedef6896d7dc908896"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzo0MDoyM1rOF4i-HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwNzo0MDoyM1rOF4i-HA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzNzUzMg==", "bodyText": "why not use rootPathSet.addAll() api directly?", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1389#discussion_r394837532", "createdAt": "2020-03-19T07:40:23Z", "author": {"login": "testforstephen"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/WorkspaceFolderChangeHandler.java", "diffHunk": "@@ -44,6 +49,24 @@ public void update(DidChangeWorkspaceFoldersParams params) {\n \t\t\t\tremovedRootPaths.add(rootPath);\n \t\t\t}\n \t\t}\n+\t\tupdateRootPaths(addedRootPaths, removedRootPaths);\n \t\tprojectManager.updateWorkspaceFolders(addedRootPaths, removedRootPaths);\n \t}\n+\n+\tprivate void updateRootPaths(Collection<IPath> addedRootPaths, Collection<IPath> removedRootPaths) {\n+\t\tSet<IPath> rootPathSet = new HashSet<>(preferenceManager.getPreferences().getRootPaths());\n+\n+\t\tSet<IPath> removedSet = new HashSet<>(removedRootPaths);\n+\t\tfor (IPath removed : removedSet) {\n+\t\t\tif (rootPathSet.contains(removed)) {\n+\t\t\t\trootPathSet.remove(removed);\n+\t\t\t}\n+\t\t}\n+\n+\t\tSet<IPath> addedSet = new HashSet<>(addedRootPaths);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d39323b27e25166b85cd8fedef6896d7dc908896"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1e74189fc03743b06c37b6e21bdc539eb3ac90c", "author": {"user": {"login": "jdneo", "name": "Sheng Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/b1e74189fc03743b06c37b6e21bdc539eb3ac90c", "committedDate": "2020-03-19T08:54:37Z", "message": "Use removeAll() and addAll()"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1082, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}