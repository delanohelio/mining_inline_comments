{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwMjIzNjg5", "number": 1367, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMjo1MToxNlrODjED5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjoxMDowOVrODjg9Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MDkzMjg3OnYy", "diffSide": "RIGHT", "path": "org.eclipse.jdt.ls.tests/src/org/eclipse/jdt/ls/core/internal/handlers/CompletionHandlerTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMjo1MToxNlrOFuqRag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMjo1MToxNlrOFuqRag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ3MTQwMg==", "bodyText": "This case was to ensure that label is of the format \"SimpleName - PackageName\", nothing to do with filterText. Now since InsertText is set to the SimpleName as a fallback, I'm simply using it instead.\nIn the below line, I add a case to ensure filterText starts with the prefix, which is calculated from textEdit.range", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1367#discussion_r384471402", "createdAt": "2020-02-26T12:51:16Z", "author": {"login": "Eskibear"}, "path": "org.eclipse.jdt.ls.tests/src/org/eclipse/jdt/ls/core/internal/handlers/CompletionHandlerTest.java", "diffHunk": "@@ -237,7 +237,8 @@ public void testCompletion_object() throws Exception{\n \t\t\tassertTrue(isNotBlank(item.getInsertText()));\n \t\t\tassertNotNull(item.getFilterText());\n \t\t\tassertFalse(item.getFilterText().contains(\" \"));\n-\t\t\tassertTrue(item.getLabel().startsWith(item.getFilterText()));\n+\t\t\tassertTrue(item.getLabel().startsWith(item.getInsertText()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "975aacde21f1265be1894d7bd1edf3f8735d4154"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NTY2NzE0OnYy", "diffSide": "RIGHT", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/contentassist/CompletionProposalRequestor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjoxMDowOVrOFvXU8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjoxMDowOVrOFvXU8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTIwOTU4Nw==", "bodyText": "Here to minimize the risk and avoid unexpected behaviors, I only apply it to TYPE_REF kind. In fact, if I remove proposal.getKind() == CompletionProposal.TYPE_REF condition, and update the filterText for all items, current test cases are also passed.", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1367#discussion_r385209587", "createdAt": "2020-02-27T16:10:09Z", "author": {"login": "Eskibear"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/contentassist/CompletionProposalRequestor.java", "diffHunk": "@@ -266,6 +266,11 @@ public CompletionItem toCompletionItem(CompletionProposal proposal, int index) {\n \t\t\t}\n \t\t}\n \t\tproposalProvider.updateReplacement(proposal, $, '\\0');\n+\t\t// Make sure `filterText` matches `textEdit`\n+\t\t// See https://github.com/eclipse/eclipse.jdt.ls/issues/1348\n+\t\tif (proposal.getKind() == CompletionProposal.TYPE_REF && $.getTextEdit() != null && $.getTextEdit().getRange() != null && $.getTextEdit().getNewText() != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "975aacde21f1265be1894d7bd1edf3f8735d4154"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3523, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}