{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1NjQ0NTYw", "number": 1575, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTowMTo0NFrOEvNy9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTowMTo0NFrOEvNy9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3OTQ0NTY2OnYy", "diffSide": "RIGHT", "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/corrections/RefactorProcessor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTowMTo0NFrOHkEmUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwOTowOTo0M1rOHkE6Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzU4NjEzMA==", "bodyText": "@CsCherrYY Below is a corner case. The change group will be 2 (1 for remove imports, 1 for remove the declaration) even though no references are using the constant field. The \"Inline\" menu won't be hidden.\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class Hello {\n    public static final Map map = new HashMap<>();\n}", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1575#discussion_r507586130", "createdAt": "2020-10-19T09:01:44Z", "author": {"login": "testforstephen"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/corrections/RefactorProcessor.java", "diffHunk": "@@ -327,6 +330,15 @@ private boolean getInlineProposal(IInvocationContext context, ASTNode node, Coll\n \t\t\t\t\t\t\tCheckConditionsOperation check = new CheckConditionsOperation(refactoring, CheckConditionsOperation.FINAL_CONDITIONS);\n \t\t\t\t\t\t\tfinal CreateChangeOperation create = new CreateChangeOperation(check, RefactoringStatus.FATAL);\n \t\t\t\t\t\t\tcreate.run(new NullProgressMonitor());\n+\t\t\t\t\t\t\tint referenceCount = 0;\n+\t\t\t\t\t\t\tChange change = create.getChange();\n+\t\t\t\t\t\t\tChange[] refactoringChanges = ((DynamicValidationRefactoringChange)change).getChildren();\n+\t\t\t\t\t\t\tfor (Change refactoringChange : refactoringChanges) {\n+\t\t\t\t\t\t\t\treferenceCount += ((CompilationUnitChange)refactoringChange).getChangeGroups().length;\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\tif (referenceCount <= 1 && refactoring.isDeclarationSelected()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e958eb3eac8eab3bf37af362bdb41b59f923934"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzU5MTE5OA==", "bodyText": "@testforstephen Thanks a lot for kind reminding, I would like to implement this clearer and avoid corner case like this by changing some APIs in jdt later.", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1575#discussion_r507591198", "createdAt": "2020-10-19T09:09:43Z", "author": {"login": "CsCherrYY"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/corrections/RefactorProcessor.java", "diffHunk": "@@ -327,6 +330,15 @@ private boolean getInlineProposal(IInvocationContext context, ASTNode node, Coll\n \t\t\t\t\t\t\tCheckConditionsOperation check = new CheckConditionsOperation(refactoring, CheckConditionsOperation.FINAL_CONDITIONS);\n \t\t\t\t\t\t\tfinal CreateChangeOperation create = new CreateChangeOperation(check, RefactoringStatus.FATAL);\n \t\t\t\t\t\t\tcreate.run(new NullProgressMonitor());\n+\t\t\t\t\t\t\tint referenceCount = 0;\n+\t\t\t\t\t\t\tChange change = create.getChange();\n+\t\t\t\t\t\t\tChange[] refactoringChanges = ((DynamicValidationRefactoringChange)change).getChildren();\n+\t\t\t\t\t\t\tfor (Change refactoringChange : refactoringChanges) {\n+\t\t\t\t\t\t\t\treferenceCount += ((CompilationUnitChange)refactoringChange).getChangeGroups().length;\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\tif (referenceCount <= 1 && refactoring.isDeclarationSelected()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzU4NjEzMA=="}, "originalCommit": {"oid": "1e958eb3eac8eab3bf37af362bdb41b59f923934"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3480, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}