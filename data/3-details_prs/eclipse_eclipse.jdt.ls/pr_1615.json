{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3Nzg3OTgy", "number": 1615, "title": "Support inferSelection when extract to variable", "bodyText": "Relates to redhat-developer/vscode-java#1717\nAdd support to extractVariable In inferSelectionSupport capability, making it possible to infer selections if there is no selection range when extract to variable.\nSigned-off-by: Shi Chen chenshi@microsoft.com", "createdAt": "2020-11-26T02:45:10Z", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1615", "merged": true, "mergeCommit": {"oid": "7e776afd4cf95b40e4511557a9e33d7e6aced16a"}, "closed": true, "closedAt": "2020-12-01T11:31:29Z", "author": {"login": "CsCherrYY"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdhhGktgH2gAyNTI3Nzg3OTgyOjg3MmM5YWY1OGFmNGViOWZkNWIzMTg5YTI0M2RlM2FmODZiZTlkZjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdh4R8QgFqTU0MTgwNjM0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "872c9af58af4eb9fd5b3189a243de3af86be9df6", "author": {"user": {"login": "CsCherrYY", "name": "Shi Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/872c9af58af4eb9fd5b3189a243de3af86be9df6", "committedDate": "2020-11-30T08:30:47Z", "message": "Support inferSelection when extract to variable\n\nSigned-off-by: Shi Chen <chenshi@microsoft.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b6f5f2cd84060c112e14b1d43739c5433bf6c2ce", "author": {"user": {"login": "CsCherrYY", "name": "Shi Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/b6f5f2cd84060c112e14b1d43739c5433bf6c2ce", "committedDate": "2020-11-30T08:23:30Z", "message": "Fix wording to avoid conflicts\n\nSigned-off-by: Shi Chen <chenshi@microsoft.com>"}, "afterCommit": {"oid": "872c9af58af4eb9fd5b3189a243de3af86be9df6", "author": {"user": {"login": "CsCherrYY", "name": "Shi Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/872c9af58af4eb9fd5b3189a243de3af86be9df6", "committedDate": "2020-11-30T08:30:47Z", "message": "Support inferSelection when extract to variable\n\nSigned-off-by: Shi Chen <chenshi@microsoft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxNTQ5MDQ5", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1615#pullrequestreview-541549049", "createdAt": "2020-12-01T07:30:12Z", "commit": {"oid": "872c9af58af4eb9fd5b3189a243de3af86be9df6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNzozMDoxM1rOH8bO-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNzozMDoxM1rOH8bO-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEyMjgxMA==", "bodyText": "Since this method is a public static method, it's kind of API, i prefer not to change its signature frequently, but add a new overriding method with your new extra parameter there.", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1615#discussion_r533122810", "createdAt": "2020-12-01T07:30:13Z", "author": {"login": "testforstephen"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/text/correction/RefactorProposalUtility.java", "diffHunk": "@@ -315,20 +315,34 @@ private static boolean supportsExtractVariable(IInvocationContext context) {\n \t\treturn true;\n \t}\n \n-\tpublic static CUCorrectionProposal getExtractVariableAllOccurrenceProposal(CodeActionParams params, IInvocationContext context, boolean problemsAtLocation, Map formatterOptions, boolean returnAsCommand) throws CoreException {\n+\tpublic static CUCorrectionProposal getExtractVariableAllOccurrenceProposal(CodeActionParams params, IInvocationContext context, boolean problemsAtLocation, Map formatterOptions, boolean returnAsCommand, boolean inferSelectionSupport) throws CoreException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "872c9af58af4eb9fd5b3189a243de3af86be9df6"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b098da3385a07a5074efdd9848b2da9f7ea2b3f", "author": {"user": {"login": "CsCherrYY", "name": "Shi Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/9b098da3385a07a5074efdd9848b2da9f7ea2b3f", "committedDate": "2020-12-01T08:50:39Z", "message": "Resolve comments\n\nSigned-off-by: Shi Chen <chenshi@microsoft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxNjc3MDUx", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1615#pullrequestreview-541677051", "createdAt": "2020-12-01T09:02:48Z", "commit": {"oid": "9b098da3385a07a5074efdd9848b2da9f7ea2b3f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwOTowMjo0OVrOH8e2AA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwOTowMjo0OVrOH8e2AA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzE4MTk1Mg==", "bodyText": "Indentation is wrong for the new block.", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1615#discussion_r533181952", "createdAt": "2020-12-01T09:02:49Z", "author": {"login": "testforstephen"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/GetRefactorEditHandler.java", "diffHunk": "@@ -68,7 +68,11 @@ public static RefactorWorkspaceEdit getEditsForRefactor(GetRefactorEditParams pa\n \t\t\tLinkedCorrectionProposal proposal = null;\n \t\t\tif (RefactorProposalUtility.EXTRACT_VARIABLE_COMMAND.equals(params.command) || RefactorProposalUtility.EXTRACT_VARIABLE_ALL_OCCURRENCE_COMMAND.equals(params.command)\n \t\t\t\t\t|| RefactorProposalUtility.EXTRACT_CONSTANT_COMMAND.equals(params.command)) {\n-\t\t\t\tproposal = (LinkedCorrectionProposal) getExtractVariableProposal(params.context, context, problemsAtLocation, params.command, formatterOptions);\n+\t\t\t\t\t\tSelectionInfo info = (params.commandArguments != null && !params.commandArguments.isEmpty()) ? JSONUtility.toModel(params.commandArguments.get(0), SelectionInfo.class) : null;\n+\t\t\t\t\t\tif (info != null) {\n+\t\t\t\t\t\t\tcontext = new InnovationContext(unit, info.offset, info.length);\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\tproposal = (LinkedCorrectionProposal) getExtractVariableProposal(params.context, context, problemsAtLocation, params.command, formatterOptions);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b098da3385a07a5074efdd9848b2da9f7ea2b3f"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b25f9b08afc25639014606f67902df115957a9b7", "author": {"user": {"login": "CsCherrYY", "name": "Shi Chen"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/b25f9b08afc25639014606f67902df115957a9b7", "committedDate": "2020-12-01T09:43:31Z", "message": "Fix indentation\n\nSigned-off-by: Shi Chen <chenshi@microsoft.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxODA2MzQ0", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1615#pullrequestreview-541806344", "createdAt": "2020-12-01T11:31:01Z", "commit": {"oid": "b25f9b08afc25639014606f67902df115957a9b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1049, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}