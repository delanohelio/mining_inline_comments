{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDQwNjk3", "number": 1507, "title": "Add 'Introduce Parameter...' code action", "bodyText": "Fixes #1420\nRequires redhat-developer/vscode-java#1521\nSigned-off-by: Snjezana Peco snjezana.peco@redhat.com", "createdAt": "2020-07-13T19:17:53Z", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507", "merged": true, "mergeCommit": {"oid": "f64a7e7cae01e185fd1c6b3d16ba370389ebcf64"}, "closed": true, "closedAt": "2020-07-17T22:43:40Z", "author": {"login": "snjeza"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0sCOkABqjM1NDIwNzYwODM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc17jRyABqjM1NjAwNzM2Njk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cec91e6e4ae560f2596259bc42545ba04dcce749", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/cec91e6e4ae560f2596259bc42545ba04dcce749", "committedDate": "2020-07-13T19:13:08Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/36012a47d8726b27c949477bb3d7457ae5a8abd6", "committedDate": "2020-07-14T01:48:02Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNzkyNzk0", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507#pullrequestreview-450792794", "createdAt": "2020-07-17T16:23:07Z", "commit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNjoyMzowN1rOGzZQqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNjoyMzowN1rOGzZQqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU0NDQyNg==", "bodyText": "Why is this needed? there's no need for clients to implement a UI mechanism behind, all should be able to use this feature without extra config", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507#discussion_r456544426", "createdAt": "2020-07-17T16:23:07Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/preferences/ClientPreferences.java", "diffHunk": "@@ -209,6 +209,10 @@ public boolean isAdvancedExtractRefactoringSupported() {\n \t\treturn Boolean.parseBoolean(extendedClientCapabilities.getOrDefault(\"advancedExtractRefactoringSupport\", \"false\").toString());\n \t}\n \n+\tpublic boolean isAdvancedIntroduceParameterRefactoringSupported() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNzkzODE0", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507#pullrequestreview-450793814", "createdAt": "2020-07-17T16:24:45Z", "commit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNjoyNDo0NVrOGzZTtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNjoyNDo0NVrOGzZTtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU0NTIwNw==", "bodyText": "that seems unnecessary", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507#discussion_r456545207", "createdAt": "2020-07-17T16:24:45Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/text/correction/RefactorProposalUtility.java", "diffHunk": "@@ -663,6 +666,26 @@ public static CUCorrectionProposal getExtractMethodProposal(CodeActionParams par\n \t\treturn null;\n \t}\n \n+\tpublic static CUCorrectionProposal getIntroduceParameterRefactoringProposals(CodeActionParams params, IInvocationContext context, ASTNode coveringNode, boolean returnAsCommand, IProblemLocationCore[] problemLocations)\n+\t\t\tthrows CoreException {\n+\t\tfinal ICompilationUnit cu = context.getCompilationUnit();\n+\t\tfinal IntroduceParameterRefactoring introduceParameterRefactoring = new IntroduceParameterRefactoring(cu, context.getSelectionOffset(), context.getSelectionLength());\n+\t\tLinkedProposalModelCore linkedProposalModel = new LinkedProposalModelCore();\n+\t\tintroduceParameterRefactoring.setLinkedProposalModel(linkedProposalModel);\n+\t\tif (introduceParameterRefactoring.checkInitialConditions(new NullProgressMonitor()).isOK()) {\n+\t\t\tintroduceParameterRefactoring.setParameterName(introduceParameterRefactoring.guessedParameterName());\n+\t\t\tString label = RefactoringCoreMessages.IntroduceParameterRefactoring_name + \"...\";\n+\t\t\tint relevance = (problemLocations != null && problemLocations.length > 0) ? IProposalRelevance.EXTRACT_CONSTANT_ERROR : IProposalRelevance.EXTRACT_CONSTANT;\n+\t\t\tif (returnAsCommand) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6"}, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwOTM4NTg5", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507#pullrequestreview-450938589", "createdAt": "2020-07-17T20:28:31Z", "commit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QyMDoyODozMVrOGzgRkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QyMDozNDozNlrOGzgbGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY1OTM0Nw==", "bodyText": "do we need to keep jdt.ui ?", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507#discussion_r456659347", "createdAt": "2020-07-17T20:28:31Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/plugin.xml", "diffHunk": "@@ -140,4 +140,10 @@\n \t     \torder=\"2000\"\n \t     \tclass=\"org.eclipse.jdt.ls.core.internal.managers.EclipseBuildSupport\" />\n    </extension>\n+   <extension\n+         point=\"org.eclipse.ltk.core.refactoring.refactoringContributions\">\n+      <contribution\n+            class=\"org.eclipse.jdt.ls.core.internal.corext.refactoring.ChangeMethodSignatureRefactoringContribution\"\n+            id=\"org.eclipse.jdt.ui.change.method.signature\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY2MDU0Mw==", "bodyText": "or return resultingCollections.add(proposal);?", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507#discussion_r456660543", "createdAt": "2020-07-17T20:31:29Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/corrections/RefactorProcessor.java", "diffHunk": "@@ -153,12 +153,25 @@ public RefactorProcessor(PreferenceManager preferenceManager) {\n \n \t\t\t\tgetConvertForLoopProposal(context, coveringNode, proposals);\n \t\t\t\tgetAssignToVariableProposals(context, coveringNode, locations, proposals, params);\n+\t\t\t\tgetIntroduceParameterProposals(params, context, coveringNode, locations, proposals);\n \t\t\t}\n \t\t\treturn proposals;\n \t\t}\n \t\treturn Collections.emptyList();\n \t}\n \n+\tprivate boolean getIntroduceParameterProposals(CodeActionParams params, IInvocationContext context, ASTNode coveringNode, IProblemLocationCore[] locations, ArrayList<ChangeCorrectionProposal> resultingCollections) throws CoreException {\n+\t\tif (resultingCollections == null) {\n+\t\t\treturn false;\n+\t\t}\n+\t\tCUCorrectionProposal proposal = RefactorProposalUtility.getIntroduceParameterRefactoringProposals(params, context, coveringNode, this.preferenceManager.getClientPreferences().isAdvancedIntroduceParameterRefactoringSupported(), locations);\n+\t\tif (proposal != null) {\n+\t\t\tresultingCollections.add(proposal);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY2MTc4NA==", "bodyText": "unnecessary change. only declare the variable when you need it. here is too early.", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1507#discussion_r456661784", "createdAt": "2020-07-17T20:34:36Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/GetRefactorEditHandler.java", "diffHunk": "@@ -58,6 +61,7 @@ public static RefactorWorkspaceEdit getEditsForRefactor(GetRefactorEditParams pa\n \t\tIProblemLocationCore[] locations = CodeActionHandler.getProblemLocationCores(unit, params.context.getContext().getDiagnostics());\n \t\tboolean problemsAtLocation = locations.length != 0;\n \t\tString positionKey = DEFAULT_POSITION_KEY;\n+\t\tCommand additionalCommand = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "36012a47d8726b27c949477bb3d7457ae5a8abd6", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/36012a47d8726b27c949477bb3d7457ae5a8abd6", "committedDate": "2020-07-14T01:48:02Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "f312c4e12c807dbe54c683e7062bef92bfc7964b", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/f312c4e12c807dbe54c683e7062bef92bfc7964b", "committedDate": "2020-07-17T21:39:02Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f312c4e12c807dbe54c683e7062bef92bfc7964b", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/f312c4e12c807dbe54c683e7062bef92bfc7964b", "committedDate": "2020-07-17T21:39:02Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "4cc055da961bb5026d22371b01180dc6b25e412f", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/4cc055da961bb5026d22371b01180dc6b25e412f", "committedDate": "2020-07-17T21:42:12Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0faf44c67f107b5cade08080f8c802a1e76649cd", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/0faf44c67f107b5cade08080f8c802a1e76649cd", "committedDate": "2020-07-17T22:26:44Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4cc055da961bb5026d22371b01180dc6b25e412f", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/4cc055da961bb5026d22371b01180dc6b25e412f", "committedDate": "2020-07-17T21:42:12Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "0faf44c67f107b5cade08080f8c802a1e76649cd", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/0faf44c67f107b5cade08080f8c802a1e76649cd", "committedDate": "2020-07-17T22:26:44Z", "message": "Add 'Introduce Parameter...' code action\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1169, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}