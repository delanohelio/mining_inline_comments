{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxOTkyOTgz", "number": 1475, "title": "Java runtimes should be configured before projects are imported", "bodyText": "Fixes #1474\nSigned-off-by: Snjezana Peco snjezana.peco@redhat.com", "createdAt": "2020-06-09T18:39:03Z", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475", "merged": true, "mergeCommit": {"oid": "7a0872bdef3ef7751da9a90021c43e14ee85e446"}, "closed": true, "closedAt": "2020-06-15T19:04:28Z", "author": {"login": "snjeza"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpqOPugFqTQyNzQ3NDgyMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrijP_ABqjM0NDUwMTU2Nzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NDc0ODIx", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#pullrequestreview-427474821", "createdAt": "2020-06-09T19:28:33Z", "commit": {"oid": "954fcc1be07eba8068f817980190e4eabde7941a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxOToyODozM1rOGhZFAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxOToyODozM1rOGhZFAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY2NzA3Mw==", "bodyText": "nope. We need the very 1st time the \"Workspace\" is opened/initialized, i.e. when .metadata is created", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r437667073", "createdAt": "2020-06-09T19:28:33Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/BaseInitHandler.java", "diffHunk": "@@ -103,6 +111,15 @@ public InitializeResult initialize(InitializeParams param) {\n \t\t\tPreferences prefs = Preferences.createFrom((Map<String, Object>) settings);\n \t\t\tprefs.setRootPaths(rootPaths);\n \t\t\tpreferenceManager.update(prefs);\n+\t\t\tif (!firstTimeWorkspaceIsOpened) {\n+\t\t\t\t// We don't care about triggering a full build here, like in onDidChangeConfiguration\n+\t\t\t\ttry {\n+\t\t\t\t\tJVMConfigurator.configureJVMs(prefs);\n+\t\t\t\t\tfirstTimeWorkspaceIsOpened = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "954fcc1be07eba8068f817980190e4eabde7941a"}, "originalPosition": 40}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "954fcc1be07eba8068f817980190e4eabde7941a", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/954fcc1be07eba8068f817980190e4eabde7941a", "committedDate": "2020-06-09T18:37:28Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "c72ed666c52ee4890c724f243778aac3a462b04f", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/c72ed666c52ee4890c724f243778aac3a462b04f", "committedDate": "2020-06-09T20:38:31Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NzAzMDkx", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#pullrequestreview-428703091", "createdAt": "2020-06-11T08:33:59Z", "commit": {"oid": "c72ed666c52ee4890c724f243778aac3a462b04f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwODozMzo1OVrOGiTv2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQxNDo1MzowNVrOGihAZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYyODMxNA==", "bodyText": "WORKSPACE_INITIALIZED=\"workspaceInitialized\"", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r438628314", "createdAt": "2020-06-11T08:33:59Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/IConstants.java", "diffHunk": "@@ -24,6 +24,13 @@\n \t */\n \tpublic static final String PLUGIN_ID = \"org.eclipse.jdt.ls.core\";\n \n+\t/**\n+\t * Is workspace created for the first time\n+\t */\n+\tpublic static final String FIRST_TIME_WORKSPACE_IS_CREATED = \"firstTimeWorkspaceIsCreated\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c72ed666c52ee4890c724f243778aac3a462b04f"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYyODc3MA==", "bodyText": "registerWorkspaceInitialized", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r438628770", "createdAt": "2020-06-11T08:34:57Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/BaseInitHandler.java", "diffHunk": "@@ -126,6 +146,21 @@ public InitializeResult initialize(InitializeParams param) {\n \t\treturn initializationOptions;\n \t}\n \n+\tprivate void registerWorkspaceCreated() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c72ed666c52ee4890c724f243778aac3a462b04f"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYyOTA4MA==", "bodyText": "prefs.putBoolean(IConstants.WORKSPACE_INITIALIZED, true);", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r438629080", "createdAt": "2020-06-11T08:35:29Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/BaseInitHandler.java", "diffHunk": "@@ -126,6 +146,21 @@ public InitializeResult initialize(InitializeParams param) {\n \t\treturn initializationOptions;\n \t}\n \n+\tprivate void registerWorkspaceCreated() {\n+\t\tIEclipsePreferences prefs = InstanceScope.INSTANCE.getNode(IConstants.PLUGIN_ID);\n+\t\tprefs.putBoolean(IConstants.FIRST_TIME_WORKSPACE_IS_CREATED, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c72ed666c52ee4890c724f243778aac3a462b04f"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYyOTgwMA==", "bodyText": "not necessary", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r438629800", "createdAt": "2020-06-11T08:36:44Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/IConstants.java", "diffHunk": "@@ -24,6 +24,13 @@\n \t */\n \tpublic static final String PLUGIN_ID = \"org.eclipse.jdt.ls.core\";\n \n+\t/**\n+\t * Is workspace created for the first time\n+\t */\n+\tpublic static final String FIRST_TIME_WORKSPACE_IS_CREATED = \"firstTimeWorkspaceIsCreated\";\n+\n+\tpublic static final boolean FIRST_TIME_WORKSPACE_IS_CREATED_DEFAULT = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c72ed666c52ee4890c724f243778aac3a462b04f"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg0NTU0Mw==", "bodyText": "prefs.getBoolean(IConstants.WORKSPACE_INITIALIZED, false);", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r438845543", "createdAt": "2020-06-11T14:53:05Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/BaseInitHandler.java", "diffHunk": "@@ -126,6 +146,21 @@ public InitializeResult initialize(InitializeParams param) {\n \t\treturn initializationOptions;\n \t}\n \n+\tprivate void registerWorkspaceCreated() {\n+\t\tIEclipsePreferences prefs = InstanceScope.INSTANCE.getNode(IConstants.PLUGIN_ID);\n+\t\tprefs.putBoolean(IConstants.FIRST_TIME_WORKSPACE_IS_CREATED, false);\n+\t\ttry {\n+\t\t\tprefs.flush();\n+\t\t} catch (BackingStoreException e) {\n+\t\t\tJavaLanguageServerPlugin.logException(e.getMessage(), e);\n+\t\t}\n+\t}\n+\n+\tprivate boolean firstTimeWorkspaceIsCreated() {\n+\t\tIEclipsePreferences prefs = InstanceScope.INSTANCE.getNode(IConstants.PLUGIN_ID);\n+\t\treturn prefs.getBoolean(IConstants.FIRST_TIME_WORKSPACE_IS_CREATED, IConstants.FIRST_TIME_WORKSPACE_IS_CREATED_DEFAULT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c72ed666c52ee4890c724f243778aac3a462b04f"}, "originalPosition": 69}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c72ed666c52ee4890c724f243778aac3a462b04f", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/c72ed666c52ee4890c724f243778aac3a462b04f", "committedDate": "2020-06-09T20:38:31Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "7d1e3c73bc7809dc3f0f07798ff149ef4486e22d", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/7d1e3c73bc7809dc3f0f07798ff149ef4486e22d", "committedDate": "2020-06-11T18:07:37Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7d1e3c73bc7809dc3f0f07798ff149ef4486e22d", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/7d1e3c73bc7809dc3f0f07798ff149ef4486e22d", "committedDate": "2020-06-11T18:07:37Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "6b78503403d35c12ae6541a3cac1773c9d810f32", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/6b78503403d35c12ae6541a3cac1773c9d810f32", "committedDate": "2020-06-12T17:52:20Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMjIwNDEx", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#pullrequestreview-430220411", "createdAt": "2020-06-14T13:42:20Z", "commit": {"oid": "6b78503403d35c12ae6541a3cac1773c9d810f32"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQxMzo0MjoyMFrOGjdLCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQxMzo1MTowNVrOGjdOAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzMTMwNQ==", "bodyText": "extra ; here.", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r439831305", "createdAt": "2020-06-14T13:42:20Z", "author": {"login": "testforstephen"}, "path": "org.eclipse.jdt.ls.core/src/org/eclipse/jdt/ls/core/internal/handlers/BaseInitHandler.java", "diffHunk": "@@ -103,6 +114,16 @@ public InitializeResult initialize(InitializeParams param) {\n \t\t\tPreferences prefs = Preferences.createFrom((Map<String, Object>) settings);\n \t\t\tprefs.setRootPaths(rootPaths);\n \t\t\tpreferenceManager.update(prefs);\n+\t\t\tif (!isWorkspaceInitialized()) {\n+\t\t\t\t// We don't care about triggering a full build here, like in onDidChangeConfiguration\n+\t\t\t\ttry {\n+\t\t\t\t\tJVMConfigurator.configureJVMs(prefs);\n+\t\t\t\t\tregisterWorkspaceInitialized();\n+\t\t\t\t\t;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b78503403d35c12ae6541a3cac1773c9d810f32"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzMjA2NQ==", "bodyText": "variable name is same as method name, not good. Rename to oldInitializedStatus?", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r439832065", "createdAt": "2020-06-14T13:51:05Z", "author": {"login": "testforstephen"}, "path": "org.eclipse.jdt.ls.tests/src/org/eclipse/jdt/ls/core/internal/handlers/InitHandlerTest.java", "diffHunk": "@@ -210,6 +213,29 @@ public void testRegisterDelayedCapability() throws Exception {\n \t\tverify(client, times(9)).registerCapability(any());\n \t}\n \n+\t@Test\n+\tpublic void testConfigureJVMs() throws Exception {\n+\t\tInitHandler handler = new InitHandler(projectsManager, preferenceManager, server.getClientConnection(), commandHandler);\n+\t\tIEclipsePreferences prefs = InstanceScope.INSTANCE.getNode(IConstants.PLUGIN_ID);\n+\t\tboolean isWorkspaceInitialized = isWorkspaceInitialized(prefs);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b78503403d35c12ae6541a3cac1773c9d810f32"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMjQ0NTEx", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#pullrequestreview-430244511", "createdAt": "2020-06-14T19:21:09Z", "commit": {"oid": "6b78503403d35c12ae6541a3cac1773c9d810f32"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQxOToyMTowOVrOGje6Tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQxOToyMTowOVrOGje6Tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1OTc5MQ==", "bodyText": "This test actually does not check the JVMs have been configured, as it's supposed to", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r439859791", "createdAt": "2020-06-14T19:21:09Z", "author": {"login": "fbricon"}, "path": "org.eclipse.jdt.ls.tests/src/org/eclipse/jdt/ls/core/internal/handlers/InitHandlerTest.java", "diffHunk": "@@ -210,6 +213,29 @@ public void testRegisterDelayedCapability() throws Exception {\n \t\tverify(client, times(9)).registerCapability(any());\n \t}\n \n+\t@Test\n+\tpublic void testConfigureJVMs() throws Exception {\n+\t\tInitHandler handler = new InitHandler(projectsManager, preferenceManager, server.getClientConnection(), commandHandler);\n+\t\tIEclipsePreferences prefs = InstanceScope.INSTANCE.getNode(IConstants.PLUGIN_ID);\n+\t\tboolean isWorkspaceInitialized = isWorkspaceInitialized(prefs);\n+\t\ttry {\n+\t\t\tprefs.putBoolean(IConstants.WORKSPACE_INITIALIZED, false);\n+\t\t\tInitializeParams params = new InitializeParams();\n+\t\t\tMap<String, Object> initializationOptions = new HashMap<>();\n+\t\t\tinitializationOptions.put(InitHandler.SETTINGS_KEY, new HashMap<>());\n+\t\t\tparams.setInitializationOptions(initializationOptions);\n+\t\t\tassertFalse(isWorkspaceInitialized(prefs));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b78503403d35c12ae6541a3cac1773c9d810f32"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b78503403d35c12ae6541a3cac1773c9d810f32", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/6b78503403d35c12ae6541a3cac1773c9d810f32", "committedDate": "2020-06-12T17:52:20Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "7779b1e5a34d3c44df0d311a26475a4437419b5f", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/7779b1e5a34d3c44df0d311a26475a4437419b5f", "committedDate": "2020-06-14T20:08:28Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7779b1e5a34d3c44df0d311a26475a4437419b5f", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/7779b1e5a34d3c44df0d311a26475a4437419b5f", "committedDate": "2020-06-14T20:08:28Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "93e2db553fca740648dd8404618de69362cd9890", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/93e2db553fca740648dd8404618de69362cd9890", "committedDate": "2020-06-14T21:02:28Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93e2db553fca740648dd8404618de69362cd9890", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/93e2db553fca740648dd8404618de69362cd9890", "committedDate": "2020-06-14T21:02:28Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "6cb5e0d7f0fef5b829c8f06d2c06fe7b3b0f5e52", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/6cb5e0d7f0fef5b829c8f06d2c06fe7b3b0f5e52", "committedDate": "2020-06-14T21:12:16Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMzExOTE2", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#pullrequestreview-430311916", "createdAt": "2020-06-15T04:15:27Z", "commit": {"oid": "6cb5e0d7f0fef5b829c8f06d2c06fe7b3b0f5e52"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwNDoxNToyN1rOGjit4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwNDoxNToyN1rOGjit4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTkyMjE0Nw==", "bodyText": "Call handler.handleInitializationOptions(params) twice and verify JVM not changed at the second time.", "url": "https://github.com/eclipse/eclipse.jdt.ls/pull/1475#discussion_r439922147", "createdAt": "2020-06-15T04:15:27Z", "author": {"login": "testforstephen"}, "path": "org.eclipse.jdt.ls.tests/src/org/eclipse/jdt/ls/core/internal/handlers/InitHandlerTest.java", "diffHunk": "@@ -210,6 +219,58 @@ public void testRegisterDelayedCapability() throws Exception {\n \t\tverify(client, times(9)).registerCapability(any());\n \t}\n \n+\t@Test\n+\tpublic void testConfigureJVMs() throws Exception {\n+\t\tInitHandler handler = new InitHandler(projectsManager, preferenceManager, server.getClientConnection(), commandHandler);\n+\t\tIEclipsePreferences prefs = InstanceScope.INSTANCE.getNode(IConstants.PLUGIN_ID);\n+\t\tboolean isWorkspaceInitialized = isWorkspaceInitialized(prefs);\n+\t\tboolean[] changed = new boolean[] { false };\n+\t\tIVMInstall defaultVM = JavaRuntime.getDefaultVMInstall();\n+\t\tIVMInstallChangedListener listener = new IVMInstallChangedListener() {\n+\n+\t\t\t@Override\n+\t\t\tpublic void defaultVMInstallChanged(IVMInstall previous, IVMInstall current) {\n+\t\t\t\tchanged[0] = true;\n+\t\t\t}\n+\n+\t\t\t@Override\n+\t\t\tpublic void vmChanged(PropertyChangeEvent event) {\n+\t\t\t}\n+\n+\t\t\t@Override\n+\t\t\tpublic void vmAdded(IVMInstall vm) {\n+\t\t\t}\n+\n+\t\t\t@Override\n+\t\t\tpublic void vmRemoved(IVMInstall vm) {\n+\t\t\t}\n+\n+\t\t};\n+\t\ttry {\n+\t\t\tprefs.putBoolean(IConstants.WORKSPACE_INITIALIZED, false);\n+\t\t\tInitializeParams params = new InitializeParams();\n+\t\t\tMap<String, Object> initializationOptions = new HashMap<>();\n+\t\t\tString javaHome = new File(TestVMType.getFakeJDKsLocation(), \"9\").getAbsolutePath();\n+\t\t\tHashMap<String, Object> homeMap = getMap(\"home\", javaHome);\n+\t\t\tMap<String, Object> javaMap = getMap(\"java\", homeMap);\n+\t\t\tinitializationOptions.put(InitHandler.SETTINGS_KEY, javaMap);\n+\t\t\tparams.setInitializationOptions(initializationOptions);\n+\t\t\tassertFalse(isWorkspaceInitialized(prefs));\n+\t\t\tJavaRuntime.addVMInstallChangedListener(listener);\n+\t\t\thandler.handleInitializationOptions(params);\n+\t\t\tassertTrue(isWorkspaceInitialized(prefs));\n+\t\t\tassertTrue(changed[0]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cb5e0d7f0fef5b829c8f06d2c06fe7b3b0f5e52"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3e69c18e4a7414e84bf3b142b292fac820b8d82", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/d3e69c18e4a7414e84bf3b142b292fac820b8d82", "committedDate": "2020-06-15T15:39:48Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6cb5e0d7f0fef5b829c8f06d2c06fe7b3b0f5e52", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/6cb5e0d7f0fef5b829c8f06d2c06fe7b3b0f5e52", "committedDate": "2020-06-14T21:12:16Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}, "afterCommit": {"oid": "d3e69c18e4a7414e84bf3b142b292fac820b8d82", "author": {"user": {"login": "snjeza", "name": "Snjeza"}}, "url": "https://github.com/eclipse/eclipse.jdt.ls/commit/d3e69c18e4a7414e84bf3b142b292fac820b8d82", "committedDate": "2020-06-15T15:39:48Z", "message": "Java runtimes should be configured before projects are imported\n\nSigned-off-by: Snjezana Peco <snjezana.peco@redhat.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1143, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}