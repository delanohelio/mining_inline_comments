{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwMjMzMTIx", "number": 4463, "title": "Issue #4433 - Implement ServletContext.addJspFile", "bodyText": "Implement servlet 4.0 ServletContext.addJspFile.\nCloses #4433", "createdAt": "2020-01-08T00:39:50Z", "url": "https://github.com/eclipse/jetty.project/pull/4463", "merged": true, "mergeCommit": {"oid": "b520ca6d30521ace1f2ed31d593051a5c3ba4164"}, "closed": true, "closedAt": "2020-01-20T08:45:36Z", "author": {"login": "janbartel"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4J6vwAH2gAyMzYwMjMzMTIxOjYwODMzYTkxYWE0Mjk2MmFhZDgyOTllNmU3MjRlOGJmNjZiOGY0ODE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8Id-bAFqTM0NTE0NjUyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "60833a91aa42962aad8299e6e724e8bf66b8f481", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/60833a91aa42962aad8299e6e724e8bf66b8f481", "committedDate": "2020-01-08T00:08:00Z", "message": "Issue #4433 Implement ServletContext.addJspFile\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fc82bf4f4b22529efefb922e5129129488bddcd", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/8fc82bf4f4b22529efefb922e5129129488bddcd", "committedDate": "2020-01-08T00:35:12Z", "message": "Issue #4433 remove todo\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNDM4Mzgx", "url": "https://github.com/eclipse/jetty.project/pull/4463#pullrequestreview-340438381", "createdAt": "2020-01-09T10:55:43Z", "commit": {"oid": "8fc82bf4f4b22529efefb922e5129129488bddcd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDo1NTo0M1rOFbyE2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxMDo1Njo0N1rOFbyGzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY3NjMxMg==", "bodyText": "All other tests in this class have code that actually make a HTTP request to test the functionality.\nThis new test only adds the dynamic JSP but does not test that making a HTTP request to it works.\nIs that intended?", "url": "https://github.com/eclipse/jetty.project/pull/4463#discussion_r364676312", "createdAt": "2020-01-09T10:55:43Z", "author": {"login": "sbordet"}, "path": "jetty-servlet/src/test/java/org/eclipse/jetty/servlet/ServletContextHandlerTest.java", "diffHunk": "@@ -884,6 +884,38 @@ public void onStartup(Set<Class<?>> c, ServletContext ctx) throws ServletExcepti\n         assertThat(\"Response\", response, containsString(\"Hello World\"));\n     }\n \n+    @Test\n+    public void testAddJspFile() throws Exception\n+    {\n+        ContextHandlerCollection contexts = new ContextHandlerCollection();\n+        _server.setHandler(contexts);\n+\n+        ServletContextHandler root = new ServletContextHandler(contexts, \"/\");\n+        ServletHolder jspServlet = new ServletHolder();\n+        jspServlet.setName(\"jsp\");\n+        jspServlet.setHeldClass(FakeJspServlet.class);\n+        root.addServlet(jspServlet, \"*.jsp\");\n+        class JSPAddingSCI implements ServletContainerInitializer\n+        {\n+            @Override\n+            public void onStartup(Set<Class<?>> c, ServletContext ctx) throws ServletException\n+            {\n+                try\n+                {\n+                    ServletRegistration rego = ctx.addJspFile(\"some.jsp\", \"/path/to/some.jsp\");\n+                    rego.addMapping(\"/somejsp/*\");\n+                }\n+                catch (Exception e)\n+                {\n+                    fail(e);\n+                }\n+            }\n+        }\n+        \n+        root.addBean(new MySCIStarter(root.getServletContext(), new JSPAddingSCI()), true);\n+        _server.start();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8fc82bf4f4b22529efefb922e5129129488bddcd"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY3NjgxMg==", "bodyText": "Also, should we not have 3 tests for this functionality? No mapping, partial mapping, existing mapping?", "url": "https://github.com/eclipse/jetty.project/pull/4463#discussion_r364676812", "createdAt": "2020-01-09T10:56:47Z", "author": {"login": "sbordet"}, "path": "jetty-servlet/src/test/java/org/eclipse/jetty/servlet/ServletContextHandlerTest.java", "diffHunk": "@@ -884,6 +884,38 @@ public void onStartup(Set<Class<?>> c, ServletContext ctx) throws ServletExcepti\n         assertThat(\"Response\", response, containsString(\"Hello World\"));\n     }\n \n+    @Test\n+    public void testAddJspFile() throws Exception\n+    {\n+        ContextHandlerCollection contexts = new ContextHandlerCollection();\n+        _server.setHandler(contexts);\n+\n+        ServletContextHandler root = new ServletContextHandler(contexts, \"/\");\n+        ServletHolder jspServlet = new ServletHolder();\n+        jspServlet.setName(\"jsp\");\n+        jspServlet.setHeldClass(FakeJspServlet.class);\n+        root.addServlet(jspServlet, \"*.jsp\");\n+        class JSPAddingSCI implements ServletContainerInitializer\n+        {\n+            @Override\n+            public void onStartup(Set<Class<?>> c, ServletContext ctx) throws ServletException\n+            {\n+                try\n+                {\n+                    ServletRegistration rego = ctx.addJspFile(\"some.jsp\", \"/path/to/some.jsp\");\n+                    rego.addMapping(\"/somejsp/*\");\n+                }\n+                catch (Exception e)\n+                {\n+                    fail(e);\n+                }\n+            }\n+        }\n+        \n+        root.addBean(new MySCIStarter(root.getServletContext(), new JSPAddingSCI()), true);\n+        _server.start();\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY3NjMxMg=="}, "originalCommit": {"oid": "8fc82bf4f4b22529efefb922e5129129488bddcd"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbeb4861bb492447176c97585f87509fb4df4e76", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/dbeb4861bb492447176c97585f87509fb4df4e76", "committedDate": "2020-01-16T14:12:59Z", "message": "Issue #4433 Add extra tests\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0Mzg5MjY1", "url": "https://github.com/eclipse/jetty.project/pull/4463#pullrequestreview-344389265", "createdAt": "2020-01-17T06:49:37Z", "commit": {"oid": "dbeb4861bb492447176c97585f87509fb4df4e76"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwNjo0OTozN1rOFewJOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwNjo0OTozN1rOFewJOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc5MDM5NQ==", "bodyText": "Can we add a jspFile via this API in the test-spec webapp as an integration test?", "url": "https://github.com/eclipse/jetty.project/pull/4463#discussion_r367790395", "createdAt": "2020-01-17T06:49:37Z", "author": {"login": "gregw"}, "path": "jetty-servlet/src/test/java/org/eclipse/jetty/servlet/ServletContextHandlerTest.java", "diffHunk": "@@ -884,6 +884,38 @@ public void onStartup(Set<Class<?>> c, ServletContext ctx) throws ServletExcepti\n         assertThat(\"Response\", response, containsString(\"Hello World\"));\n     }\n \n+    @Test\n+    public void testAddJspFile() throws Exception\n+    {\n+        ContextHandlerCollection contexts = new ContextHandlerCollection();\n+        _server.setHandler(contexts);\n+\n+        ServletContextHandler root = new ServletContextHandler(contexts, \"/\");\n+        ServletHolder jspServlet = new ServletHolder();\n+        jspServlet.setName(\"jsp\");\n+        jspServlet.setHeldClass(FakeJspServlet.class);\n+        root.addServlet(jspServlet, \"*.jsp\");\n+        class JSPAddingSCI implements ServletContainerInitializer\n+        {\n+            @Override\n+            public void onStartup(Set<Class<?>> c, ServletContext ctx) throws ServletException\n+            {\n+                try\n+                {\n+                    ServletRegistration rego = ctx.addJspFile(\"some.jsp\", \"/path/to/some.jsp\");\n+                    rego.addMapping(\"/somejsp/*\");\n+                }\n+                catch (Exception e)\n+                {\n+                    fail(e);\n+                }\n+            }\n+        }\n+        \n+        root.addBean(new MySCIStarter(root.getServletContext(), new JSPAddingSCI()), true);\n+        _server.start();\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDY3NjMxMg=="}, "originalCommit": {"oid": "8fc82bf4f4b22529efefb922e5129129488bddcd"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0040f55b9250c649aa26c8e2d2f77f70a60c0a1b", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/0040f55b9250c649aa26c8e2d2f77f70a60c0a1b", "committedDate": "2020-01-17T08:10:04Z", "message": "Issue #4433 Add demo base test for addJsp\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NDkyNzg0", "url": "https://github.com/eclipse/jetty.project/pull/4463#pullrequestreview-344492784", "createdAt": "2020-01-17T10:37:13Z", "commit": {"oid": "0040f55b9250c649aa26c8e2d2f77f70a60c0a1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MTQ2NTI5", "url": "https://github.com/eclipse/jetty.project/pull/4463#pullrequestreview-345146529", "createdAt": "2020-01-20T08:42:22Z", "commit": {"oid": "0040f55b9250c649aa26c8e2d2f77f70a60c0a1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 539, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}