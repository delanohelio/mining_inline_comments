{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwMTEwNjc3", "number": 4604, "title": "Fix NPE in HouseKeeper.stopScavenging", "bodyText": "HouseKeeper.stopScavenging throws NPE when called twice.\nTo reproduce this issue, call setIntervalSec(0) before shutting down the server.\nServer server = new Server(8080);\nserver.setSessionIdManager(new DefaultSessionIdManager(server));\nserver.start();\nserver.getSessionIdManager().getSessionHouseKeeper().setIntervalSec(0L);\nserver.stop();\nSigned-off-by: Hirotaka Ikoma hikoma@gmail.com", "createdAt": "2020-02-26T09:35:51Z", "url": "https://github.com/eclipse/jetty.project/pull/4604", "merged": true, "mergeCommit": {"oid": "65a22e5e809ecbd20b3475cd8644fdf7aa5e8490"}, "closed": true, "closedAt": "2020-02-26T15:38:51Z", "author": {"login": "hikoma"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIDMacgH2gAyMzgwMTEwNjc3OjNiNWZkY2Y1NTQxOGY4OGVhNzdhYzAwNzE4MjY5MDYxZGZiZGUxMWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIImCkAFqTM2NTAwMzg4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3b5fdcf55418f88ea77ac00718269061dfbde11b", "author": {"user": {"login": "hikoma", "name": "Hirotaka Ikoma"}}, "url": "https://github.com/eclipse/jetty.project/commit/3b5fdcf55418f88ea77ac00718269061dfbde11b", "committedDate": "2020-02-26T09:20:45Z", "message": "Fix NPE in HouseKeeper.stopScavenging\n\nSigned-off-by: Hirotaka Ikoma <hikoma@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0Nzc5OTI3", "url": "https://github.com/eclipse/jetty.project/pull/4604#pullrequestreview-364779927", "createdAt": "2020-02-26T10:22:38Z", "commit": {"oid": "3b5fdcf55418f88ea77ac00718269061dfbde11b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMDoyMjozOFrOFul62w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMDoyMjozOFrOFul62w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQwMDA5MQ==", "bodyText": "I think the fix is to set _ownScheduler = false here after line 164. That way _ownScheduler and _scheduler are kept in sync.", "url": "https://github.com/eclipse/jetty.project/pull/4604#discussion_r384400091", "createdAt": "2020-02-26T10:22:38Z", "author": {"login": "janbartel"}, "path": "jetty-server/src/main/java/org/eclipse/jetty/server/session/HouseKeeper.java", "diffHunk": "@@ -158,7 +158,7 @@ protected void stopScavenging() throws Exception\n                 LOG.info(\"{} Stopped scavenging\", _sessionIdManager.getWorkerName());\n             }\n             _task = null;\n-            if (_ownScheduler)\n+            if (_ownScheduler && _scheduler != null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b5fdcf55418f88ea77ac00718269061dfbde11b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "723a58ce19315209feae891ec96c032f2ece2f7a", "author": {"user": {"login": "hikoma", "name": "Hirotaka Ikoma"}}, "url": "https://github.com/eclipse/jetty.project/commit/723a58ce19315209feae891ec96c032f2ece2f7a", "committedDate": "2020-02-26T11:23:34Z", "message": "Make _ownScheduler false to keep a consistency with _scheduler\n\nSigned-off-by: Hirotaka Ikoma <hikoma@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MDAzODg4", "url": "https://github.com/eclipse/jetty.project/pull/4604#pullrequestreview-365003888", "createdAt": "2020-02-26T15:38:16Z", "commit": {"oid": "723a58ce19315209feae891ec96c032f2ece2f7a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 471, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}