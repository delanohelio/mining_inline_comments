{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwNzIyMzkz", "number": 4757, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwOTowOTozOVrODv50LA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzozNjoyMFrODx80Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNTU2OTA4OnYy", "diffSide": "RIGHT", "path": "tests/test-integration/src/test/resources/RFC2616Base.xml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwOTowOTozOVrOGCmFuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwNzozODoyNlrOGFB7zA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTM3NDM5NQ==", "bodyText": "@olamy the structure of this XML is a bit strange. Not sure why the two Contexts are not under the ContextHandlerCollection?", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r405374395", "createdAt": "2020-04-08T09:09:39Z", "author": {"login": "gregw"}, "path": "tests/test-integration/src/test/resources/RFC2616Base.xml", "diffHunk": "@@ -33,7 +33,7 @@\n     <!-- Set handler Collection Structure                            -->\n     <!-- =========================================================== -->\n     <Set name=\"handler\">\n-      <New id=\"Handlers\" class=\"org.eclipse.jetty.server.handler.HandlerCollection\">\n+      <New id=\"Handlers\" class=\"org.eclipse.jetty.server.handler.HandlerList\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "407f6d005acabf372b336eda08cf0959d3f70454"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEzMDQ4MQ==", "bodyText": "No idea but I agree it's really strange and need to be fixed", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r406130481", "createdAt": "2020-04-09T11:11:26Z", "author": {"login": "olamy"}, "path": "tests/test-integration/src/test/resources/RFC2616Base.xml", "diffHunk": "@@ -33,7 +33,7 @@\n     <!-- Set handler Collection Structure                            -->\n     <!-- =========================================================== -->\n     <Set name=\"handler\">\n-      <New id=\"Handlers\" class=\"org.eclipse.jetty.server.handler.HandlerCollection\">\n+      <New id=\"Handlers\" class=\"org.eclipse.jetty.server.handler.HandlerList\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTM3NDM5NQ=="}, "originalCommit": {"oid": "407f6d005acabf372b336eda08cf0959d3f70454"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzkyNzc1Ng==", "bodyText": "OK - will do in a separate PR", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r407927756", "createdAt": "2020-04-14T07:38:26Z", "author": {"login": "gregw"}, "path": "tests/test-integration/src/test/resources/RFC2616Base.xml", "diffHunk": "@@ -33,7 +33,7 @@\n     <!-- Set handler Collection Structure                            -->\n     <!-- =========================================================== -->\n     <Set name=\"handler\">\n-      <New id=\"Handlers\" class=\"org.eclipse.jetty.server.handler.HandlerCollection\">\n+      <New id=\"Handlers\" class=\"org.eclipse.jetty.server.handler.HandlerList\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTM3NDM5NQ=="}, "originalCommit": {"oid": "407f6d005acabf372b336eda08cf0959d3f70454"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTA3MzM1OnYy", "diffSide": "RIGHT", "path": "examples/embedded/src/main/java/org/eclipse/jetty/embedded/WebSocketJsrServer.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODowOTowNlrOGFa2kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzoyNDozNVrOGFtAmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNjAxOQ==", "bodyText": "Meh.\nI like the HandlerList + addHandler view of the original.", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408336019", "createdAt": "2020-04-14T18:09:06Z", "author": {"login": "joakime"}, "path": "examples/embedded/src/main/java/org/eclipse/jetty/embedded/WebSocketJsrServer.java", "diffHunk": "@@ -65,8 +62,7 @@ public static Server createServer(int port)\n             }\n         );\n \n-        handlers.addHandler(new DefaultHandler());\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(context, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODYyNzc1Mg==", "bodyText": "I think there is value in reducing 4 lines of code to 1, specially as the structure was previous spread over 15 lines.", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408627752", "createdAt": "2020-04-15T07:13:27Z", "author": {"login": "gregw"}, "path": "examples/embedded/src/main/java/org/eclipse/jetty/embedded/WebSocketJsrServer.java", "diffHunk": "@@ -65,8 +62,7 @@ public static Server createServer(int port)\n             }\n         );\n \n-        handlers.addHandler(new DefaultHandler());\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(context, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNjAxOQ=="}, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODYzMzQ5Nw==", "bodyText": "Since ServletContextHandler is a terminal Handler, what's the point of having a DefaultHandler afterwards?", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408633497", "createdAt": "2020-04-15T07:24:35Z", "author": {"login": "sbordet"}, "path": "examples/embedded/src/main/java/org/eclipse/jetty/embedded/WebSocketJsrServer.java", "diffHunk": "@@ -65,8 +62,7 @@ public static Server createServer(int port)\n             }\n         );\n \n-        handlers.addHandler(new DefaultHandler());\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(context, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNjAxOQ=="}, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTA4OTgzOnYy", "diffSide": "RIGHT", "path": "jetty-server/src/test/java/org/eclipse/jetty/server/handler/SecuredRedirectHandlerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoxMzo0NVrOGFbBRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzoxMToyM1rOGFsmUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzODc1OQ==", "bodyText": "We shouldn't get rid of all of our usages of addHandler(Handler).\nThat needs to be tested as well.", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408338759", "createdAt": "2020-04-14T18:13:45Z", "author": {"login": "joakime"}, "path": "jetty-server/src/test/java/org/eclipse/jetty/server/handler/SecuredRedirectHandlerTest.java", "diffHunk": "@@ -126,11 +126,7 @@ public static void startServer() throws Exception\n         contextHandlers.setHandlers(new Handler[]{redirectHandler, rootContext, test1Context, test2Context});\n \n         // Create server level handler tree\n-        HandlerList handlers = new HandlerList();\n-        handlers.addHandler(contextHandlers);\n-        handlers.addHandler(new DefaultHandler()); // round things out\n-\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(contextHandlers, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODYyNjc3MA==", "bodyText": "There are still many usage examples and tests.  Specially when the handlers are complex or variable.", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408626770", "createdAt": "2020-04-15T07:11:23Z", "author": {"login": "gregw"}, "path": "jetty-server/src/test/java/org/eclipse/jetty/server/handler/SecuredRedirectHandlerTest.java", "diffHunk": "@@ -126,11 +126,7 @@ public static void startServer() throws Exception\n         contextHandlers.setHandlers(new Handler[]{redirectHandler, rootContext, test1Context, test2Context});\n \n         // Create server level handler tree\n-        HandlerList handlers = new HandlerList();\n-        handlers.addHandler(contextHandlers);\n-        handlers.addHandler(new DefaultHandler()); // round things out\n-\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(contextHandlers, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzODc1OQ=="}, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNzAyOTM4OnYy", "diffSide": "RIGHT", "path": "jetty-websocket/websocket-javax-tests/src/test/java/org/eclipse/jetty/websocket/javax/tests/RestartContextTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzozNToyNFrOGFtXDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwOToyNDo0NlrOGFxR9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODYzOTI0NQ==", "bodyText": "Again, is DefaultHandler ever called since ServletContextHandler is a terminal handler?", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408639245", "createdAt": "2020-04-15T07:35:24Z", "author": {"login": "sbordet"}, "path": "jetty-websocket/websocket-javax-tests/src/test/java/org/eclipse/jetty/websocket/javax/tests/RestartContextTest.java", "diffHunk": "@@ -72,12 +72,7 @@ public void testStartStopStartServletContextListener() throws Exception\n         context.addEventListener(new AddEndpointListener());\n \n         // Setup handler tree\n-        HandlerList handlers = new HandlerList();\n-        handlers.addHandler(context);\n-        handlers.addHandler(new DefaultHandler());\n-\n-        // Add handler tree to server\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(context, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODcwMzQ3OQ==", "bodyText": "@sbordet ServletContextHandler is not always a terminal handler.\nAll ContextHandler must first match a request before they continue handling it. They reject a match because of context path and/or virtual host and/or named connector.  Even if a request matches the context, it can still be returned unhandled if the ServletHandler is configured to have no default.", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408703479", "createdAt": "2020-04-15T09:24:46Z", "author": {"login": "gregw"}, "path": "jetty-websocket/websocket-javax-tests/src/test/java/org/eclipse/jetty/websocket/javax/tests/RestartContextTest.java", "diffHunk": "@@ -72,12 +72,7 @@ public void testStartStopStartServletContextListener() throws Exception\n         context.addEventListener(new AddEndpointListener());\n \n         // Setup handler tree\n-        HandlerList handlers = new HandlerList();\n-        handlers.addHandler(context);\n-        handlers.addHandler(new DefaultHandler());\n-\n-        // Add handler tree to server\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(context, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODYzOTI0NQ=="}, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNzAzMDY5OnYy", "diffSide": "RIGHT", "path": "jetty-websocket/websocket-javax-tests/src/test/java/org/eclipse/jetty/websocket/javax/tests/RestartContextTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzozNTo0OFrOGFtX4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzozNTo0OFrOGFtX4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODYzOTQ1Ng==", "bodyText": "Ditto.", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408639456", "createdAt": "2020-04-15T07:35:48Z", "author": {"login": "sbordet"}, "path": "jetty-websocket/websocket-javax-tests/src/test/java/org/eclipse/jetty/websocket/javax/tests/RestartContextTest.java", "diffHunk": "@@ -114,9 +109,7 @@ public void testStartStopStartConfigurator() throws Exception\n         });\n \n         // Setup handler tree\n-        HandlerList handlers = new HandlerList();\n-        handlers.addHandler(context);\n-        handlers.addHandler(new DefaultHandler());\n+        HandlerList handlers = new HandlerList(context, new DefaultHandler());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNzAzMTQ2OnYy", "diffSide": "RIGHT", "path": "jetty-websocket/websocket-jetty-server/src/test/java/org/eclipse/jetty/websocket/server/browser/BrowserDebugTool.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzozNjowNFrOGFtYXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzozNjowNFrOGFtYXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODYzOTU4Mw==", "bodyText": "Ditto", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408639583", "createdAt": "2020-04-15T07:36:04Z", "author": {"login": "sbordet"}, "path": "jetty-websocket/websocket-jetty-server/src/test/java/org/eclipse/jetty/websocket/server/browser/BrowserDebugTool.java", "diffHunk": "@@ -114,11 +114,7 @@ public void prepare(int port)\n         ServletHolder defHolder = new ServletHolder(\"default\", DefaultServlet.class);\n         context.addServlet(defHolder, \"/\");\n \n-        HandlerList handlers = new HandlerList();\n-        handlers.addHandler(context);\n-        handlers.addHandler(new DefaultHandler());\n-\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(context, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNzAzMjE4OnYy", "diffSide": "RIGHT", "path": "jetty-websocket/websocket-jetty-tests/src/test/java/org/eclipse/jetty/websocket/tests/client/BadNetworkTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzozNjoyMFrOGFtY2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwNzozNjoyMFrOGFtY2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODYzOTcwNw==", "bodyText": "Ditto.", "url": "https://github.com/eclipse/jetty.project/pull/4757#discussion_r408639707", "createdAt": "2020-04-15T07:36:20Z", "author": {"login": "sbordet"}, "path": "jetty-websocket/websocket-jetty-tests/src/test/java/org/eclipse/jetty/websocket/tests/client/BadNetworkTest.java", "diffHunk": "@@ -86,10 +86,7 @@ public void configure(JettyWebSocketServletFactory factory)\n         });\n         context.addServlet(holder, \"/ws\");\n \n-        HandlerList handlers = new HandlerList();\n-        handlers.addHandler(context);\n-        handlers.addHandler(new DefaultHandler());\n-        server.setHandler(handlers);\n+        server.setHandler(new HandlerList(context, new DefaultHandler()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6367a8b9d954ab2c04a904e399e5bdb9931bc5a0"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2732, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}