{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0NjE4Nzg4", "number": 5128, "title": "Fixes #5079 - :authority header for IPv6 address not having square br\u2026", "bodyText": "\u2026ackets.\nOn the client:\n\nOrigin.Address.host is passed through HostPort.normalizeHost(),\nso that if it is IPv6 is bracketed.\nNow the ipv6 address passed to an HttClient request is bracketed.\nHttpRequest was de-bracketing the host, but now it does not anymore.\n\nOn the server:\n\nRequest.getLocalAddr(), getLocalName(), getRemoteAddr(),\ngetRemoteHost(), getServerName(), when dealing with an IPv6 address,\nreturn it bracketed.\nThe reason to return bracketed IPv6 also from *Addr() methods is that\nif it is used with InetAddress/InetSocketAddress it still works, but\noften it is interpreted as a URI host so brackets are necessary.\nDoSFilter was blindly bracketing - now it does not.\n\nAdded a number of test cases, and fixed those that expected\nnon-bracketed IPv6.\nSigned-off-by: Simone Bordet simone.bordet@gmail.com", "createdAt": "2020-08-07T13:54:17Z", "url": "https://github.com/eclipse/jetty.project/pull/5128", "merged": true, "mergeCommit": {"oid": "f73b282050fa08a1f59cce9f3178df73d92105b9"}, "closed": true, "closedAt": "2020-08-11T18:04:47Z", "author": {"login": "sbordet"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8kyiJgH2gAyNDY0NjE4Nzg4OmQ1M2Q5ZDhhMWRiMWRlOTNiZjgyM2VlNTk4MDU5NDBhYzFhMmU0Zjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc96xNDAH2gAyNDY0NjE4Nzg4OjJlNzNmODBkMzRkNzk0NmMxMzQ1MWJhZjdmNTI4MGJiODNhY2E1MGM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d53d9d8a1db1de93bf823ee59805940ac1a2e4f9", "author": {"user": {"login": "sbordet", "name": "Simone Bordet"}}, "url": "https://github.com/eclipse/jetty.project/commit/d53d9d8a1db1de93bf823ee59805940ac1a2e4f9", "committedDate": "2020-08-07T13:53:19Z", "message": "Fixes #5079 - :authority header for IPv6 address not having square brackets.\n\nOn the client:\n* Origin.Address.host is passed through HostPort.normalizeHost(),\nso that if it is IPv6 is bracketed.\nNow the ipv6 address passed to an `HttClient` request is bracketed.\n* HttpRequest was de-bracketing the host, but now it does not anymore.\n\nOn the server:\n* Request.getLocalAddr(), getLocalName(), getRemoteAddr(),\ngetRemoteHost(), getServerName(), when dealing with an IPv6 address,\nreturn it bracketed.\nThe reason to return bracketed IPv6 also from *Addr() methods is that\nif it is used with InetAddress/InetSocketAddress it still works, but\noften it is interpreted as a URI host so brackets are necessary.\n* DoSFilter was blindly bracketing - now it does not.\n\nAdded a number of test cases, and fixed those that expected\nnon-bracketed IPv6.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd4c1dbac0cf67748ff1454724cd39e15ee8cfbb", "author": {"user": {"login": "sbordet", "name": "Simone Bordet"}}, "url": "https://github.com/eclipse/jetty.project/commit/dd4c1dbac0cf67748ff1454724cd39e15ee8cfbb", "committedDate": "2020-08-08T21:21:14Z", "message": "Merged branch 'jetty-9.4.x' into 'jetty-9.4.x-5079-ipv6_brackets'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "867621af89650b380350ddb625f711ee62ea3a13", "author": {"user": {"login": "sbordet", "name": "Simone Bordet"}}, "url": "https://github.com/eclipse/jetty.project/commit/867621af89650b380350ddb625f711ee62ea3a13", "committedDate": "2020-08-10T12:52:57Z", "message": "Fixes #5079 - :authority header for IPv6 address not having square brackets.\n\nFixed Jenkins failures by disabling tests that require IPv6 if it is not available.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0OTAwNzY2", "url": "https://github.com/eclipse/jetty.project/pull/5128#pullrequestreview-464900766", "createdAt": "2020-08-11T09:30:35Z", "commit": {"oid": "867621af89650b380350ddb625f711ee62ea3a13"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwOTozMDozNVrOG-v5fA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwOTozMDozNVrOG-v5fA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ0OTY2MA==", "bodyText": "should the impl at least call HostPort.normalize so that it works if somebody does call it?", "url": "https://github.com/eclipse/jetty.project/pull/5128#discussion_r468449660", "createdAt": "2020-08-11T09:30:35Z", "author": {"login": "gregw"}, "path": "jetty-client/src/main/java/org/eclipse/jetty/client/HttpClient.java", "diffHunk": "@@ -1155,10 +1155,14 @@ protected HttpField getAcceptEncodingField()\n         return encodingField;\n     }\n \n+    /**\n+     * @param host the host to normalize\n+     * @return the host itself\n+     * @deprecated no replacement, do not use it\n+     */\n+    @Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "867621af89650b380350ddb625f711ee62ea3a13"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "897e766f24becb5c1a3ddc0b0d3970e45c08d134", "author": {"user": {"login": "sbordet", "name": "Simone Bordet"}}, "url": "https://github.com/eclipse/jetty.project/commit/897e766f24becb5c1a3ddc0b0d3970e45c08d134", "committedDate": "2020-08-11T17:18:11Z", "message": "Fixes #5079 - :authority header for IPv6 address not having square brackets.\n\nUpdates after review.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e73f80d34d7946c13451baf7f5280bb83aca50c", "author": {"user": {"login": "sbordet", "name": "Simone Bordet"}}, "url": "https://github.com/eclipse/jetty.project/commit/2e73f80d34d7946c13451baf7f5280bb83aca50c", "committedDate": "2020-08-11T18:03:42Z", "message": "Fixes #5079 - :authority header for IPv6 address not having square brackets.\n\nReverted code changes to HttpClient.normalizeHost().\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 279, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}