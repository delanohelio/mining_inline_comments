{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4NDkxOTEz", "number": 5736, "title": "Tries improvements", "bodyText": "WIP on better selection of trie based on alphabet\nAlso some ideas on how to improve impls in TODOs\nSigned-off-by: Greg Wilkins gregw@webtide.com", "createdAt": "2020-11-27T09:18:42Z", "url": "https://github.com/eclipse/jetty.project/pull/5736", "merged": true, "mergeCommit": {"oid": "51120b1f0bda1a61e60079a8ab4d73d50700aa51"}, "closed": true, "closedAt": "2021-01-05T11:52:35Z", "author": {"login": "gregw"}, "timelineItems": {"totalCount": 49, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgj-NHAH2gAyNTI4NDkxOTEzOjgxMTFmOTk1MjA0ODNjMTEzM2RjZDNiZTBlZWM3YTkwZjk4N2Y5OTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABds4wlLgFqTU2MTE1NTg1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8111f99520483c1133dcd3be0eec7a90f987f990", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/8111f99520483c1133dcd3be0eec7a90f987f990", "committedDate": "2020-11-27T09:17:26Z", "message": "Tries improvements\n\nWIP on better selection of trie based on alphabet\nAlso some ideas on how to improve impls in TODOs\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ca6e5aae5ad73bbf0015b68008c0171fd09e6eb", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/4ca6e5aae5ad73bbf0015b68008c0171fd09e6eb", "committedDate": "2020-11-28T21:28:36Z", "message": "WIP\n\n+ CaseSensitive ArrayTrie\n+ Better space efficiency in big lookups\n+ Better test cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNzE1MjIz", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-540715223", "createdAt": "2020-11-30T09:10:39Z", "commit": {"oid": "4ca6e5aae5ad73bbf0015b68008c0171fd09e6eb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQwOToxMDozOVrOH7xt2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQwOToxMDozOVrOH7xt2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjQ0MjU4Nw==", "bodyText": "It's certainly worth measuring the space & time difference between row sizes of 32 and 48.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r532442587", "createdAt": "2020-11-30T09:10:39Z", "author": {"login": "lorban"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/ArrayTrie.java", "diffHunk": "@@ -56,7 +56,8 @@\n      * 32 to cover case insensitive alphabet and a few other common\n      * characters.\n      */\n-    private static final int ROW_SIZE = 32;\n+    private static final int ROW_SIZE = 48;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ca6e5aae5ad73bbf0015b68008c0171fd09e6eb"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a329677890a35cc589e39522581ecd5a50597ba", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/6a329677890a35cc589e39522581ecd5a50597ba", "committedDate": "2020-12-07T11:21:46Z", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-trie-selection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44120d6186e535dca71b58e0648d4ebf2b61a9ec", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/44120d6186e535dca71b58e0648d4ebf2b61a9ec", "committedDate": "2020-12-07T11:44:01Z", "message": "WIP\n\nAdded test for empty key"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "397ea6c2bb33f2512bcd573a07c74d0ba9ab4f15", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/397ea6c2bb33f2512bcd573a07c74d0ba9ab4f15", "committedDate": "2020-12-07T11:53:19Z", "message": "WIP\n\nAdded more tests for exceptional values"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ceda7e4a61ade1eca8ea08a60fb44a3326e8ca2", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/4ceda7e4a61ade1eca8ea08a60fb44a3326e8ca2", "committedDate": "2020-12-07T13:40:17Z", "message": "Issue #5304 HTTP2 Host Header\n\nrefactored common code\nfast alphabet lookup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "408a4d7adf53b1098dc95be471b17ce30c420a93", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/408a4d7adf53b1098dc95be471b17ce30c420a93", "committedDate": "2020-12-07T14:21:38Z", "message": "WIP\n\nbig cleanup of code to reduce parallel array lookups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f61c8a6d9ee6d14c3a6174fbe22f8ec48632838f", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/f61c8a6d9ee6d14c3a6174fbe22f8ec48632838f", "committedDate": "2020-12-07T15:41:00Z", "message": "WIP\n\ntail recursion fix for required node calculation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0712c3acbb7ae0fbec76a5457e1c04b55dc0f5b", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/f0712c3acbb7ae0fbec76a5457e1c04b55dc0f5b", "committedDate": "2020-12-07T16:55:44Z", "message": "WIP\n\nmore tests\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2ODQ4MzM3", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-546848337", "createdAt": "2020-12-08T08:23:06Z", "commit": {"oid": "f61c8a6d9ee6d14c3a6174fbe22f8ec48632838f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwODoyMzowNlrOIBM1Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQwODozMzowN1rOIBNRLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODEyOTcxMQ==", "bodyText": "Why did you get rid of this check? IMHO building an index both pre-loaded with some contents and a max capacity of zero looks like a programming mistake we want to catch.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r538129711", "createdAt": "2020-12-08T08:23:06Z", "author": {"login": "lorban"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/Index.java", "diffHunk": "@@ -193,42 +226,55 @@\n                 return this;\n             }\n \n+            public Builder<V> alphabet(String alphabetString)\n+            {\n+                alphabet = new HashSet<>();\n+                alphabetString.chars().forEach(c -> alphabet.add((char)c));\n+                return this;\n+            }\n+\n+            public Builder<V> alphabet(Set<Character> alphabet)\n+            {\n+                this.alphabet = alphabet;\n+                return this;\n+            }\n+\n             /**\n              * Build a {@link Mutable} instance.\n              * @return a {@link Mutable} instance.\n              */\n             public Mutable<V> build()\n             {\n-                if (contents != null && maxCapacity == 0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f61c8a6d9ee6d14c3a6174fbe22f8ec48632838f"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODEzMDIwMQ==", "bodyText": "Should we define a default alphabet instead of throwing here?", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r538130201", "createdAt": "2020-12-08T08:23:51Z", "author": {"login": "lorban"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/Index.java", "diffHunk": "@@ -193,42 +226,55 @@\n                 return this;\n             }\n \n+            public Builder<V> alphabet(String alphabetString)\n+            {\n+                alphabet = new HashSet<>();\n+                alphabetString.chars().forEach(c -> alphabet.add((char)c));\n+                return this;\n+            }\n+\n+            public Builder<V> alphabet(Set<Character> alphabet)\n+            {\n+                this.alphabet = alphabet;\n+                return this;\n+            }\n+\n             /**\n              * Build a {@link Mutable} instance.\n              * @return a {@link Mutable} instance.\n              */\n             public Mutable<V> build()\n             {\n-                if (contents != null && maxCapacity == 0)\n-                    throw new IllegalStateException(\"Cannot create a mutable index with maxCapacity=0 and some contents\");\n+                if (maxCapacity == 0)\n+                    return EmptyTrie.instance(caseSensitive);\n \n-                // TODO we need to consider large size and alphabet when picking a trie impl\n-                Mutable<V> result;\n-                if (maxCapacity > 0)\n+                if (alphabet == null)\n                 {\n-                    result = new ArrayTernaryTrie<>(!caseSensitive, maxCapacity);\n-                }\n-                else if (maxCapacity < 0)\n-                {\n-                    if (caseSensitive)\n-                        result = new ArrayTernaryTrie.Growing<>(false, 512, 512);\n-                    else\n-                        result = new TreeTrie<>();\n-                }\n-                else\n-                {\n-                    result = EmptyTrie.instance(caseSensitive);\n+                    if (contents != null)\n+                        throw new IllegalStateException(\"Cannot create a mutable index without alphabet or some contents\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f61c8a6d9ee6d14c3a6174fbe22f8ec48632838f"}, "originalPosition": 146}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODEzMzk5MQ==", "bodyText": "I do not like this constant very much, I would prefer an extra helper method on the builder:\n public Builder<V> withVisibleAsciiAlphabet()\n {\n  alphabet = Collections.unmodifiableSet(...);\n  return this;\n }", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r538133991", "createdAt": "2020-12-08T08:28:40Z", "author": {"login": "lorban"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/Index.java", "diffHunk": "@@ -19,18 +19,26 @@\n package org.eclipse.jetty.util;\n \n import java.nio.ByteBuffer;\n+import java.util.Collections;\n+import java.util.HashSet;\n import java.util.LinkedHashMap;\n import java.util.Map;\n import java.util.Set;\n import java.util.function.Function;\n import java.util.function.Supplier;\n+import java.util.stream.Collectors;\n+import java.util.stream.IntStream;\n \n /**\n  * An immutable String lookup data structure.\n  * @param <V> the entry type\n  */\n public interface Index<V>\n {\n+    Set<Character> VISIBLE_ASCII_ALPHABET = Collections.unmodifiableSet(IntStream.range(0x20, 0x7f)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f61c8a6d9ee6d14c3a6174fbe22f8ec48632838f"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODEzNjg3OQ==", "bodyText": "You should throw IllegalStateException here, like the mutable builder does.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r538136879", "createdAt": "2020-12-08T08:33:07Z", "author": {"login": "lorban"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/Index.java", "diffHunk": "@@ -354,11 +401,26 @@ public Builder()\n             if (contents == null)\n                 return EmptyTrie.instance(caseSensitive);\n \n-            // TODO we need to consider large size and alphabet when picking a trie impl\n-            if (caseSensitive)\n-                return new ArrayTernaryTrie<>(false, contents);\n-            else\n-                return new ArrayTrie<>(contents);\n+            Set<Character> alphabet = new HashSet<>();\n+            int capacity = AbstractTrie.requiredCapacity(contents.keySet(), caseSensitive, alphabet);\n+\n+            AbstractTrie<V> trie = ArrayTrie.from(capacity, capacity, caseSensitive, alphabet, contents);\n+            if (trie != null)\n+                return trie;\n+            trie = ArrayTernaryTrie.from(capacity, capacity, caseSensitive, alphabet, contents);\n+            if (trie != null)\n+                return trie;\n+            trie = TreeTrie.from(capacity, capacity, caseSensitive, alphabet, contents);\n+            if (trie != null)\n+                return trie;\n+\n+            throw new UnsupportedOperationException(\"No suitable Trie implementation : \" + this);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f61c8a6d9ee6d14c3a6174fbe22f8ec48632838f"}, "originalPosition": 214}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79ac278b8d5a880bcd1396d550656ee196854485", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/79ac278b8d5a880bcd1396d550656ee196854485", "committedDate": "2020-12-08T12:50:09Z", "message": "WIP transfer machines\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b0847eb230f8a81b53612bfc4b88ffb28dadf8e", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/7b0847eb230f8a81b53612bfc4b88ffb28dadf8e", "committedDate": "2020-12-08T19:03:44Z", "message": "WIP\n\nTernaryTrie mostly working"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe885db869653860b548ff28f22c2761682a753a", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/fe885db869653860b548ff28f22c2761682a753a", "committedDate": "2020-12-08T20:22:16Z", "message": "WIP\n\ngrowby of TernaryTrie\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0f3118d472daa6e92eda90002d743b6570769e3", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/c0f3118d472daa6e92eda90002d743b6570769e3", "committedDate": "2020-12-08T20:29:54Z", "message": "WIP\n\nupdate from review\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37f81beb4f6c8e0bd5ef67c6b191af09cb664d1a", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/37f81beb4f6c8e0bd5ef67c6b191af09cb664d1a", "committedDate": "2020-12-08T20:59:02Z", "message": "WIP\n\nupdate javadoc\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa2226b63d369429c88f121b179c530991d8e628", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/aa2226b63d369429c88f121b179c530991d8e628", "committedDate": "2020-12-09T08:34:33Z", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-trie-selection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbe0788c5908b747dad8935d809939e9bfbc2481", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/dbe0788c5908b747dad8935d809939e9bfbc2481", "committedDate": "2020-12-09T09:05:36Z", "message": "WIP\n\nFixed some issues with alphabets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ac421b91c9b94de6b5abe7ae887568aa5dde79c", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/7ac421b91c9b94de6b5abe7ae887568aa5dde79c", "committedDate": "2020-12-09T09:11:38Z", "message": "WIP\n\nFixed null value tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b149d640eca7600ca7e878cbd5171ca6f7cb54db", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/b149d640eca7600ca7e878cbd5171ca6f7cb54db", "committedDate": "2020-12-09T11:33:03Z", "message": "WIP\n\nDon't use an Index for HTTP2Cipher"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2694806ff35b2d257397e7dc50029ee056f1802d", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/2694806ff35b2d257397e7dc50029ee056f1802d", "committedDate": "2020-12-09T11:41:31Z", "message": "WIP\n\nObeying the orders of my IDE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "901a415a99399542919d38c36d3a599215c42c8d", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/901a415a99399542919d38c36d3a599215c42c8d", "committedDate": "2020-12-09T11:43:07Z", "message": "WIP\n\nremoved test main"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MTAyMjY4", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-548102268", "createdAt": "2020-12-09T11:46:46Z", "commit": {"oid": "b149d640eca7600ca7e878cbd5171ca6f7cb54db"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMTo0Njo0NlrOICQkGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxMTo0ODowM1rOICQnWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTIzOTQ0OQ==", "bodyText": "This String::toUpperCase uses system default locale.\nThis will produce undesired side effects on on some, non-US, systems.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r539239449", "createdAt": "2020-12-09T11:46:46Z", "author": {"login": "joakime"}, "path": "jetty-http2/http2-common/src/main/java/org/eclipse/jetty/http2/HTTP2Cipher.java", "diffHunk": "@@ -19,311 +19,310 @@\n package org.eclipse.jetty.http2;\n \n import java.util.Comparator;\n-\n-import org.eclipse.jetty.util.Index;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n \n public class HTTP2Cipher\n {\n     public static final Comparator<String> COMPARATOR = new CipherComparator();\n \n-    private static final Index<Boolean> __blackProtocols = new Index.Builder<Boolean>()\n-        .caseSensitive(false)\n-        .with(\"TLSv1.2\", Boolean.TRUE)\n-        .with(\"TLSv1.1\", Boolean.TRUE)\n-        .with(\"TLSv1\", Boolean.TRUE)\n-        .with(\"SSL\", Boolean.TRUE)\n-        .with(\"SSLv2\", Boolean.TRUE)\n-        .with(\"SSLv3\", Boolean.TRUE)\n-        .build();\n+    private static final Set<String> __blackProtocols = Stream.of(\n+        \"TLSv1.2\",\n+        \"TLSv1.1\",\n+        \"TLSv1\",\n+        \"SSL\",\n+        \"SSLv2\",\n+        \"SSLv3\"\n+    ).map(String::toUpperCase).collect(Collectors.toSet());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b149d640eca7600ca7e878cbd5171ca6f7cb54db"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTIzOTU1OQ==", "bodyText": "This String::toUpperCase uses system default locale.\nThis will produce undesired side effects on on some, non-US, systems.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r539239559", "createdAt": "2020-12-09T11:46:56Z", "author": {"login": "joakime"}, "path": "jetty-http2/http2-common/src/main/java/org/eclipse/jetty/http2/HTTP2Cipher.java", "diffHunk": "@@ -19,311 +19,310 @@\n package org.eclipse.jetty.http2;\n \n import java.util.Comparator;\n-\n-import org.eclipse.jetty.util.Index;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n \n public class HTTP2Cipher\n {\n     public static final Comparator<String> COMPARATOR = new CipherComparator();\n \n-    private static final Index<Boolean> __blackProtocols = new Index.Builder<Boolean>()\n-        .caseSensitive(false)\n-        .with(\"TLSv1.2\", Boolean.TRUE)\n-        .with(\"TLSv1.1\", Boolean.TRUE)\n-        .with(\"TLSv1\", Boolean.TRUE)\n-        .with(\"SSL\", Boolean.TRUE)\n-        .with(\"SSLv2\", Boolean.TRUE)\n-        .with(\"SSLv3\", Boolean.TRUE)\n-        .build();\n+    private static final Set<String> __blackProtocols = Stream.of(\n+        \"TLSv1.2\",\n+        \"TLSv1.1\",\n+        \"TLSv1\",\n+        \"SSL\",\n+        \"SSLv2\",\n+        \"SSLv3\"\n+    ).map(String::toUpperCase).collect(Collectors.toSet());\n \n-    private static final Index<Boolean> __blackCiphers = new Index.Builder<Boolean>()\n-        .caseSensitive(false)\n-        .with(\"TLS_NULL_WITH_NULL_NULL\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_IDEA_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_IDEA_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_DES_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_3DES_EDE_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_IDEA_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC4_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_EMPTY_RENEGOTIATION_INFO_SCSV\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CCM\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CCM\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CCM\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CCM\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CCM_8\", Boolean.TRUE)\n-        .build();\n+    private static final Set<String> __blackCiphers = Stream.of(\n+        \"TLS_NULL_WITH_NULL_NULL\",\n+        \"TLS_RSA_WITH_NULL_MD5\",\n+        \"TLS_RSA_WITH_NULL_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_RSA_WITH_RC4_128_MD5\",\n+        \"TLS_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5\",\n+        \"TLS_RSA_WITH_IDEA_CBC_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_DES_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_anon_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_DH_anon_WITH_RC4_128_MD5\",\n+        \"TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_KRB5_WITH_DES_CBC_SHA\",\n+        \"TLS_KRB5_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_KRB5_WITH_RC4_128_SHA\",\n+        \"TLS_KRB5_WITH_IDEA_CBC_SHA\",\n+        \"TLS_KRB5_WITH_DES_CBC_MD5\",\n+        \"TLS_KRB5_WITH_3DES_EDE_CBC_MD5\",\n+        \"TLS_KRB5_WITH_RC4_128_MD5\",\n+        \"TLS_KRB5_WITH_IDEA_CBC_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_RC4_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_PSK_WITH_NULL_SHA\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_AES_128_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_WITH_NULL_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_SEED_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_SEED_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_PSK_WITH_NULL_SHA256\",\n+        \"TLS_PSK_WITH_NULL_SHA384\",\n+        \"TLS_DHE_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA256\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA256\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_EMPTY_RENEGOTIATION_INFO_SCSV\",\n+        \"TLS_ECDH_ECDSA_WITH_NULL_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_NULL_SHA\",\n+        \"TLS_ECDH_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_NULL_SHA\",\n+        \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_anon_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_PSK_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_AES_128_CCM\",\n+        \"TLS_RSA_WITH_AES_256_CCM\",\n+        \"TLS_RSA_WITH_AES_128_CCM_8\",\n+        \"TLS_RSA_WITH_AES_256_CCM_8\",\n+        \"TLS_PSK_WITH_AES_128_CCM\",\n+        \"TLS_PSK_WITH_AES_256_CCM\",\n+        \"TLS_PSK_WITH_AES_128_CCM_8\",\n+        \"TLS_PSK_WITH_AES_256_CCM_8\"\n+    ).map(String::toUpperCase).collect(Collectors.toSet());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b149d640eca7600ca7e878cbd5171ca6f7cb54db"}, "originalPosition": 588}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI0MDIxMg==", "bodyText": "This uses system default locale.\nChange to tlsProtocol.toUpperCase(Locale.US).\nThis will produce undesired side effects on on some, non-US, systems.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r539240212", "createdAt": "2020-12-09T11:47:58Z", "author": {"login": "joakime"}, "path": "jetty-http2/http2-common/src/main/java/org/eclipse/jetty/http2/HTTP2Cipher.java", "diffHunk": "@@ -19,311 +19,310 @@\n package org.eclipse.jetty.http2;\n \n import java.util.Comparator;\n-\n-import org.eclipse.jetty.util.Index;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n \n public class HTTP2Cipher\n {\n     public static final Comparator<String> COMPARATOR = new CipherComparator();\n \n-    private static final Index<Boolean> __blackProtocols = new Index.Builder<Boolean>()\n-        .caseSensitive(false)\n-        .with(\"TLSv1.2\", Boolean.TRUE)\n-        .with(\"TLSv1.1\", Boolean.TRUE)\n-        .with(\"TLSv1\", Boolean.TRUE)\n-        .with(\"SSL\", Boolean.TRUE)\n-        .with(\"SSLv2\", Boolean.TRUE)\n-        .with(\"SSLv3\", Boolean.TRUE)\n-        .build();\n+    private static final Set<String> __blackProtocols = Stream.of(\n+        \"TLSv1.2\",\n+        \"TLSv1.1\",\n+        \"TLSv1\",\n+        \"SSL\",\n+        \"SSLv2\",\n+        \"SSLv3\"\n+    ).map(String::toUpperCase).collect(Collectors.toSet());\n \n-    private static final Index<Boolean> __blackCiphers = new Index.Builder<Boolean>()\n-        .caseSensitive(false)\n-        .with(\"TLS_NULL_WITH_NULL_NULL\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_IDEA_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_IDEA_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_DES_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_3DES_EDE_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_IDEA_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC4_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_EMPTY_RENEGOTIATION_INFO_SCSV\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CCM\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CCM\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CCM\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CCM\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CCM_8\", Boolean.TRUE)\n-        .build();\n+    private static final Set<String> __blackCiphers = Stream.of(\n+        \"TLS_NULL_WITH_NULL_NULL\",\n+        \"TLS_RSA_WITH_NULL_MD5\",\n+        \"TLS_RSA_WITH_NULL_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_RSA_WITH_RC4_128_MD5\",\n+        \"TLS_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5\",\n+        \"TLS_RSA_WITH_IDEA_CBC_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_DES_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_anon_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_DH_anon_WITH_RC4_128_MD5\",\n+        \"TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_KRB5_WITH_DES_CBC_SHA\",\n+        \"TLS_KRB5_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_KRB5_WITH_RC4_128_SHA\",\n+        \"TLS_KRB5_WITH_IDEA_CBC_SHA\",\n+        \"TLS_KRB5_WITH_DES_CBC_MD5\",\n+        \"TLS_KRB5_WITH_3DES_EDE_CBC_MD5\",\n+        \"TLS_KRB5_WITH_RC4_128_MD5\",\n+        \"TLS_KRB5_WITH_IDEA_CBC_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_RC4_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_PSK_WITH_NULL_SHA\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_AES_128_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_WITH_NULL_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_SEED_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_SEED_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_PSK_WITH_NULL_SHA256\",\n+        \"TLS_PSK_WITH_NULL_SHA384\",\n+        \"TLS_DHE_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA256\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA256\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_EMPTY_RENEGOTIATION_INFO_SCSV\",\n+        \"TLS_ECDH_ECDSA_WITH_NULL_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_NULL_SHA\",\n+        \"TLS_ECDH_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_NULL_SHA\",\n+        \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_anon_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_PSK_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_AES_128_CCM\",\n+        \"TLS_RSA_WITH_AES_256_CCM\",\n+        \"TLS_RSA_WITH_AES_128_CCM_8\",\n+        \"TLS_RSA_WITH_AES_256_CCM_8\",\n+        \"TLS_PSK_WITH_AES_128_CCM\",\n+        \"TLS_PSK_WITH_AES_256_CCM\",\n+        \"TLS_PSK_WITH_AES_128_CCM_8\",\n+        \"TLS_PSK_WITH_AES_256_CCM_8\"\n+    ).map(String::toUpperCase).collect(Collectors.toSet());\n \n     public static boolean isBlackListProtocol(String tlsProtocol)\n     {\n-        return __blackProtocols.get(tlsProtocol) != null;\n+        return __blackProtocols.contains(tlsProtocol.toUpperCase());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b149d640eca7600ca7e878cbd5171ca6f7cb54db"}, "originalPosition": 593}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI0MDI4MA==", "bodyText": "This uses system default locale.\nChange to tlsProtocol.toUpperCase(Locale.US).\nThis will produce undesired side effects on on some, non-US, systems.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r539240280", "createdAt": "2020-12-09T11:48:03Z", "author": {"login": "joakime"}, "path": "jetty-http2/http2-common/src/main/java/org/eclipse/jetty/http2/HTTP2Cipher.java", "diffHunk": "@@ -19,311 +19,310 @@\n package org.eclipse.jetty.http2;\n \n import java.util.Comparator;\n-\n-import org.eclipse.jetty.util.Index;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n \n public class HTTP2Cipher\n {\n     public static final Comparator<String> COMPARATOR = new CipherComparator();\n \n-    private static final Index<Boolean> __blackProtocols = new Index.Builder<Boolean>()\n-        .caseSensitive(false)\n-        .with(\"TLSv1.2\", Boolean.TRUE)\n-        .with(\"TLSv1.1\", Boolean.TRUE)\n-        .with(\"TLSv1\", Boolean.TRUE)\n-        .with(\"SSL\", Boolean.TRUE)\n-        .with(\"SSLv2\", Boolean.TRUE)\n-        .with(\"SSLv3\", Boolean.TRUE)\n-        .build();\n+    private static final Set<String> __blackProtocols = Stream.of(\n+        \"TLSv1.2\",\n+        \"TLSv1.1\",\n+        \"TLSv1\",\n+        \"SSL\",\n+        \"SSLv2\",\n+        \"SSLv3\"\n+    ).map(String::toUpperCase).collect(Collectors.toSet());\n \n-    private static final Index<Boolean> __blackCiphers = new Index.Builder<Boolean>()\n-        .caseSensitive(false)\n-        .with(\"TLS_NULL_WITH_NULL_NULL\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_IDEA_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_DES_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_IDEA_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_DES_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_3DES_EDE_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_RC4_128_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_WITH_IDEA_CBC_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC4_40_SHA\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_KRB5_EXPORT_WITH_RC4_40_MD5\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_SEED_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_EMPTY_RENEGOTIATION_INFO_SCSV\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_RC4_128_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_NULL_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\", Boolean.TRUE)\n-        .with(\"TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CCM\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CCM\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_128_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_RSA_WITH_AES_256_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CCM\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CCM\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_128_CCM_8\", Boolean.TRUE)\n-        .with(\"TLS_PSK_WITH_AES_256_CCM_8\", Boolean.TRUE)\n-        .build();\n+    private static final Set<String> __blackCiphers = Stream.of(\n+        \"TLS_NULL_WITH_NULL_NULL\",\n+        \"TLS_RSA_WITH_NULL_MD5\",\n+        \"TLS_RSA_WITH_NULL_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_RSA_WITH_RC4_128_MD5\",\n+        \"TLS_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5\",\n+        \"TLS_RSA_WITH_IDEA_CBC_SHA\",\n+        \"TLS_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_DES_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_DES_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DH_anon_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_DH_anon_WITH_RC4_128_MD5\",\n+        \"TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_DES_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_KRB5_WITH_DES_CBC_SHA\",\n+        \"TLS_KRB5_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_KRB5_WITH_RC4_128_SHA\",\n+        \"TLS_KRB5_WITH_IDEA_CBC_SHA\",\n+        \"TLS_KRB5_WITH_DES_CBC_MD5\",\n+        \"TLS_KRB5_WITH_3DES_EDE_CBC_MD5\",\n+        \"TLS_KRB5_WITH_RC4_128_MD5\",\n+        \"TLS_KRB5_WITH_IDEA_CBC_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_RC4_40_SHA\",\n+        \"TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5\",\n+        \"TLS_KRB5_EXPORT_WITH_RC4_40_MD5\",\n+        \"TLS_PSK_WITH_NULL_SHA\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_AES_128_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_WITH_NULL_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA\",\n+        \"TLS_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_DHE_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_RSA_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_DSS_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_SEED_CBC_SHA\",\n+        \"TLS_DHE_RSA_WITH_SEED_CBC_SHA\",\n+        \"TLS_DH_anon_WITH_SEED_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_PSK_WITH_NULL_SHA256\",\n+        \"TLS_PSK_WITH_NULL_SHA384\",\n+        \"TLS_DHE_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA256\",\n+        \"TLS_DHE_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA256\",\n+        \"TLS_RSA_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256\",\n+        \"TLS_EMPTY_RENEGOTIATION_INFO_SCSV\",\n+        \"TLS_ECDH_ECDSA_WITH_NULL_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_NULL_SHA\",\n+        \"TLS_ECDH_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_NULL_SHA\",\n+        \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n+        \"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA\",\n+        \"TLS_SRP_SHA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_NULL_SHA384\",\n+        \"TLS_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DH_anon_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DH_anon_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_PSK_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384\",\n+        \"TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256\",\n+        \"TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384\",\n+        \"TLS_RSA_WITH_AES_128_CCM\",\n+        \"TLS_RSA_WITH_AES_256_CCM\",\n+        \"TLS_RSA_WITH_AES_128_CCM_8\",\n+        \"TLS_RSA_WITH_AES_256_CCM_8\",\n+        \"TLS_PSK_WITH_AES_128_CCM\",\n+        \"TLS_PSK_WITH_AES_256_CCM\",\n+        \"TLS_PSK_WITH_AES_128_CCM_8\",\n+        \"TLS_PSK_WITH_AES_256_CCM_8\"\n+    ).map(String::toUpperCase).collect(Collectors.toSet());\n \n     public static boolean isBlackListProtocol(String tlsProtocol)\n     {\n-        return __blackProtocols.get(tlsProtocol) != null;\n+        return __blackProtocols.contains(tlsProtocol.toUpperCase());\n     }\n \n     public static boolean isBlackListCipher(String tlsCipher)\n     {\n-        return __blackCiphers.get(tlsCipher) != null;\n+        return __blackCiphers.contains(tlsCipher.toUpperCase());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b149d640eca7600ca7e878cbd5171ca6f7cb54db"}, "originalPosition": 599}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9efafddb4a8c1ad1f14814e116584ca99b33ec4a", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/9efafddb4a8c1ad1f14814e116584ca99b33ec4a", "committedDate": "2020-12-09T12:05:09Z", "message": "WIP\n\nremoved locale issue with case conversion."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MjM1MTI3", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-548235127", "createdAt": "2020-12-09T14:26:05Z", "commit": {"oid": "9efafddb4a8c1ad1f14814e116584ca99b33ec4a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDoyNjowNVrOICXRpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDoyNjowNVrOICXRpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM0OTQxNQ==", "bodyText": "This call isn't needed anymore.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r539349415", "createdAt": "2020-12-09T14:26:05Z", "author": {"login": "lorban"}, "path": "jetty-http/src/main/java/org/eclipse/jetty/http/HttpParser.java", "diffHunk": "@@ -1064,18 +1063,20 @@ else if (_endOfContent == EndOfContent.CHUNKED_CONTENT)\n                 {\n                     if (_fieldCache == null)\n                     {\n+                        // TODO should we bypass the builder in this case?\n                         _fieldCache = (getHeaderCacheSize() > 0 && (_version != null && _version == HttpVersion.HTTP_1_1))\n-                            ? new Index.Builder<HttpField>()\n+                            ? new Index.Mutable.Builder<HttpField>()\n                             .caseSensitive(false)\n                             .mutable()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9efafddb4a8c1ad1f14814e116584ca99b33ec4a"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4OTUxMjY2", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-548951266", "createdAt": "2020-12-10T08:27:02Z", "commit": {"oid": "9efafddb4a8c1ad1f14814e116584ca99b33ec4a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwODoyNzowM1rOIC9B_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwODoyNzowM1rOIC9B_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk2Nzk5OA==", "bodyText": "Looking at the changes made to this class, two things pop into my mind:\n\nDo those maps need to be case-insensitive?\nAren't there other classes that make use of Index that should instead use a Map?", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r539967998", "createdAt": "2020-12-10T08:27:03Z", "author": {"login": "lorban"}, "path": "jetty-http2/http2-common/src/main/java/org/eclipse/jetty/http2/HTTP2Cipher.java", "diffHunk": "@@ -19,311 +19,312 @@\n package org.eclipse.jetty.http2;\n \n import java.util.Comparator;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n \n-import org.eclipse.jetty.util.Index;\n+import org.eclipse.jetty.util.StringUtil;\n \n public class HTTP2Cipher", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9efafddb4a8c1ad1f14814e116584ca99b33ec4a"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4OTUzNTA1", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-548953505", "createdAt": "2020-12-10T08:30:10Z", "commit": {"oid": "9efafddb4a8c1ad1f14814e116584ca99b33ec4a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2451697185342be56fd8372f215137b0b290873a", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/2451697185342be56fd8372f215137b0b290873a", "committedDate": "2020-12-10T11:58:56Z", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-trie-selection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d87be4357ade1290c363986adbe6afc6ef70feec", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/d87be4357ade1290c363986adbe6afc6ef70feec", "committedDate": "2020-12-10T12:35:20Z", "message": "Updates from Review\n\n + Remove public mutable builder constructor\n + align caseInsensitive vs caseSensitive"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ef17d477e1ceac79f1cc2bdd56466438165b74b", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/3ef17d477e1ceac79f1cc2bdd56466438165b74b", "committedDate": "2020-12-10T12:46:58Z", "message": "fix javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bd309622d63958be0980c1da31f0ca4dd77a0f3", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/9bd309622d63958be0980c1da31f0ca4dd77a0f3", "committedDate": "2020-12-10T14:26:05Z", "message": "wip\n\nAdded a list parser to Index so that getBest can be used rather than clumsy calls to best"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8f482bd524265c59bd54d6d377b57147dc6aedd", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/a8f482bd524265c59bd54d6d377b57147dc6aedd", "committedDate": "2020-12-13T20:05:16Z", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-trie-selection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa7b9897fc83578be5490683a4972f8299940fc2", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/aa7b9897fc83578be5490683a4972f8299940fc2", "committedDate": "2020-12-13T20:09:12Z", "message": "Fix header\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e241fae5b71b29d8f3a975275abeab37be65699b", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/e241fae5b71b29d8f3a975275abeab37be65699b", "committedDate": "2020-12-15T16:33:25Z", "message": "WIP\n\nAdded benchmark along with simple HashTrie for comparison."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b69e7d42eeb67c9b5f17f33e89481819cd0dd672", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/b69e7d42eeb67c9b5f17f33e89481819cd0dd672", "committedDate": "2020-12-15T17:35:40Z", "message": "WIP\n\nreinstated TreeTrie and ArrayTernaryTrie"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "151c615e20fb1939b43e0135849a769b659a5780", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/151c615e20fb1939b43e0135849a769b659a5780", "committedDate": "2020-12-16T22:34:45Z", "message": "WIP\n\nArrayTrie with unlimited alphabet"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eacc849d24e4011edf9a8941a6318145bda617fd", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/eacc849d24e4011edf9a8941a6318145bda617fd", "committedDate": "2020-12-17T17:10:57Z", "message": "WIP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d48ff75efc4fdb15522bc4f2a12cf5309d3339e", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/8d48ff75efc4fdb15522bc4f2a12cf5309d3339e", "committedDate": "2020-12-18T08:22:30Z", "message": "WIP\n\nFixed otherChars"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92007ee8330cd43bd9110e1e3cef7960cb730f72", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/92007ee8330cd43bd9110e1e3cef7960cb730f72", "committedDate": "2020-12-19T07:36:41Z", "message": "WIP\n\nRemoved TErnaryTrie\nInclude null key in capacity calculations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99a3b094237bf7c7dc9603fd051264f168676446", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/99a3b094237bf7c7dc9603fd051264f168676446", "committedDate": "2020-12-19T15:32:48Z", "message": "WIP\n\nmisc cleanups"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c03f1841d30419aca1e66d00f38490743c2d5789", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/c03f1841d30419aca1e66d00f38490743c2d5789", "committedDate": "2020-12-21T07:36:18Z", "message": "Misc cleanups\n\nfound by IDE code analysis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0803e81b6cce3971d7dcc7e7942895b0620a8cbc", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/0803e81b6cce3971d7dcc7e7942895b0620a8cbc", "committedDate": "2020-12-22T19:45:07Z", "message": "Merge branch 'jetty-10.0.x' into jetty-10.0.x-trie-selection"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwOTA1MTYy", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-560905162", "createdAt": "2021-01-04T10:01:07Z", "commit": {"oid": "0803e81b6cce3971d7dcc7e7942895b0620a8cbc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxMDowMTowN1rOINrrXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxMDoxNTo0OVrOINsIwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIxODAxNQ==", "bodyText": "That increment should be documented.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r551218015", "createdAt": "2021-01-04T10:01:07Z", "author": {"login": "lorban"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/ArrayTernaryTrie.java", "diffHunk": "@@ -96,10 +97,28 @@\n      */\n     private char _rows;\n \n+    public static <V> AbstractTrie<V> from(int capacity, int maxCapacity, boolean caseSensitive, Set<Character> alphabet, Map<String, V> contents)\n+    {\n+        // Can't grow\n+        if (maxCapacity < 0)\n+            return null;\n+        if (capacity < maxCapacity)\n+            capacity = maxCapacity;\n+        capacity++;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0803e81b6cce3971d7dcc7e7942895b0620a8cbc"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIyMTk4MA==", "bodyText": "Is AbstractTrie.requiredCapacity reporting the exact amount of required bytes for each and every trie implementation? Otherwise we have a problem.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r551221980", "createdAt": "2021-01-04T10:09:01Z", "author": {"login": "lorban"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/Index.java", "diffHunk": "@@ -188,42 +269,42 @@\n                 return this;\n             }\n \n+            /**\n+             * Configure the index to be mutable.\n+             *\n+             * @return a {@link Mutable.Builder} configured like this builder.\n+             */\n+            public Mutable.Builder<V> mutable()\n+            {\n+                return this;\n+            }\n+\n             /**\n              * Build a {@link Mutable} instance.\n              * @return a {@link Mutable} instance.\n              */\n             public Mutable<V> build()\n             {\n-                if (contents != null && maxCapacity == 0)\n-                    throw new IllegalStateException(\"Cannot create a mutable index with maxCapacity=0 and some contents\");\n-\n-                // TODO we need to consider large size and alphabet when picking a trie impl\n-                Mutable<V> result;\n-                if (maxCapacity > 0)\n-                {\n-                    result = new ArrayTernaryTrie<>(!caseSensitive, maxCapacity);\n-                }\n-                else if (maxCapacity < 0)\n-                {\n-                    if (caseSensitive)\n-                        result = new ArrayTernaryTrie.Growing<>(false, 512, 512);\n-                    else\n-                        result = new TreeTrie<>();\n-                }\n-                else\n-                {\n-                    result = EmptyTrie.instance(caseSensitive);\n-                }\n-\n-                if (contents != null)\n-                {\n-                    for (Map.Entry<String, V> entry : contents.entrySet())\n-                    {\n-                        if (!result.put(entry.getKey(), entry.getValue()))\n-                            throw new AssertionError(\"Index capacity exceeded at \" + entry.getKey());\n-                    }\n-                }\n-                return result;\n+                if (maxCapacity == 0)\n+                    return EmptyTrie.instance(caseSensitive);\n+\n+                // Work out needed capacity\n+                int capacity = (contents == null) ? 0 : AbstractTrie.requiredCapacity(contents.keySet(), caseSensitive);\n+\n+                // check capacities\n+                if (maxCapacity >= 0 && capacity > maxCapacity)\n+                    throw new IllegalStateException(\"Insufficient maxCapacity for contents\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0803e81b6cce3971d7dcc7e7942895b0620a8cbc"}, "originalPosition": 224}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIyMzAzMQ==", "bodyText": "If maxCapacity is greater than ArrayTrie.MAX_CAPACITY you're going to return an empty trie. This breaks the principle of least surprise IMHO.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r551223031", "createdAt": "2021-01-04T10:11:04Z", "author": {"login": "lorban"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/Index.java", "diffHunk": "@@ -251,6 +333,21 @@ public Builder()\n             this.contents = contents;\n         }\n \n+        /**\n+         * A special purpose static builder for fast creation of specific Index type\n+         * @param maxCapacity The max capacity of the index\n+         * @param <V> The type of the index\n+         * @return A case sensitive mutable Index tacking visible ASCII alphabet to a max capacity.\n+         */\n+        public static <V> Mutable<V> buildCaseSensitiveMutableVisibleAsciiAlphabet(int maxCapacity)\n+        {\n+            if (maxCapacity <= 0)\n+                return EmptyTrie.instance(true);\n+            if (maxCapacity <= ArrayTrie.MAX_CAPACITY)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0803e81b6cce3971d7dcc7e7942895b0620a8cbc"}, "originalPosition": 263}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIyNDYwNg==", "bodyText": "The parseCsvIndex method looks very specific to the HttpChannelOverHttp. It feels like it should be moved into this class.", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r551224606", "createdAt": "2021-01-04T10:14:06Z", "author": {"login": "lorban"}, "path": "jetty-server/src/main/java/org/eclipse/jetty/server/HttpChannelOverHttp.java", "diffHunk": "@@ -500,31 +501,24 @@ public void parsedHeader(HttpField field)\n \n                 case EXPECT:\n                 {\n-                    if (HttpVersion.HTTP_1_1.equals(_requestBuilder.version()))\n+                    if (!Index.parseCsvIndex(HttpHeaderValue.CACHE, value, t ->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0803e81b6cce3971d7dcc7e7942895b0620a8cbc"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIyNTUzOA==", "bodyText": "The version should be moved up in the root pom's dependencyManagement. But it also looks like you're not sizing objects in the benchmark you added - is that an overlook or something you don't care about?", "url": "https://github.com/eclipse/jetty.project/pull/5736#discussion_r551225538", "createdAt": "2021-01-04T10:15:49Z", "author": {"login": "lorban"}, "path": "tests/jetty-jmh/pom.xml", "diffHunk": "@@ -72,6 +72,11 @@\n   </build>\n \n   <dependencies>\n+    <dependency>\n+      <groupId>org.openjdk.jol</groupId>\n+      <artifactId>jol-core</artifactId>\n+      <version>0.14</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0803e81b6cce3971d7dcc7e7942895b0620a8cbc"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab915c5f48a7dc23f5b031626bc7bfd38ab0c8ae", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/ab915c5f48a7dc23f5b031626bc7bfd38ab0c8ae", "committedDate": "2021-01-04T12:53:15Z", "message": "Merge branch 'jetty-10.0.x' into jetty-10.0.x-trie-selection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ee7577cc4f3f6d02d8169b12dccbfbfd7b2dc75", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/1ee7577cc4f3f6d02d8169b12dccbfbfd7b2dc75", "committedDate": "2021-01-04T14:19:58Z", "message": "Updates from review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0eed2cc58148cf13389b76c06b7f46078e411e0e", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/0eed2cc58148cf13389b76c06b7f46078e411e0e", "committedDate": "2021-01-04T14:23:29Z", "message": "Updates from review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a7de8807d9145032c942092536948adddad6444", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/5a7de8807d9145032c942092536948adddad6444", "committedDate": "2021-01-04T14:33:36Z", "message": "Updates from review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxMTMwNzk0", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-561130794", "createdAt": "2021-01-04T15:44:43Z", "commit": {"oid": "5a7de8807d9145032c942092536948adddad6444"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxMTU1ODU4", "url": "https://github.com/eclipse/jetty.project/pull/5736#pullrequestreview-561155858", "createdAt": "2021-01-04T16:17:39Z", "commit": {"oid": "5a7de8807d9145032c942092536948adddad6444"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4977, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}