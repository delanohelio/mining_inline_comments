{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2MzQ1MTI0", "number": 5215, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxMTo0MlrOEfFOpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxMTo0MlrOEfFOpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxMDI2OTgwOnYy", "diffSide": "RIGHT", "path": "jetty-webapp/src/test/java/org/eclipse/jetty/webapp/HugeResourceTest.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxMTo0MlrOHLIZ5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxMDo1NjoyM1rOHLpyyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQzNDA4Ng==", "bodyText": "responseListener.get() only waits for the headers, so to be sure here I would also do (maybe in a try-with-resources):\nassertEquals(-1, response.getInputStream().read());\nwhich would guarantee that the HEAD response really came without body, as it should be.", "url": "https://github.com/eclipse/jetty.project/pull/5215#discussion_r481434086", "createdAt": "2020-09-01T21:11:42Z", "author": {"login": "sbordet"}, "path": "jetty-webapp/src/test/java/org/eclipse/jetty/webapp/HugeResourceTest.java", "diffHunk": "@@ -244,6 +244,26 @@ public void testDownload(String filename, long expectedSize) throws Exception\n         }\n     }\n \n+    @ParameterizedTest\n+    @MethodSource(\"staticFiles\")\n+    public void testHead(String filename, long expectedSize) throws Exception\n+    {\n+        URI destUri = server.getURI().resolve(\"/\" + filename);\n+        InputStreamResponseListener responseListener = new InputStreamResponseListener();\n+\n+        Request request = client.newRequest(destUri)\n+            .method(HttpMethod.HEAD);\n+        request.send(responseListener);\n+        Response response = responseListener.get(5, TimeUnit.SECONDS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a6b7f73019a3cd7b5ba6a382179e25312ad6520c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ1NTkwNg==", "bodyText": "Good point.\nBut if that fails, does that mean that both jetty server and jetty client have bugs then? ;-)", "url": "https://github.com/eclipse/jetty.project/pull/5215#discussion_r481455906", "createdAt": "2020-09-01T21:59:40Z", "author": {"login": "joakime"}, "path": "jetty-webapp/src/test/java/org/eclipse/jetty/webapp/HugeResourceTest.java", "diffHunk": "@@ -244,6 +244,26 @@ public void testDownload(String filename, long expectedSize) throws Exception\n         }\n     }\n \n+    @ParameterizedTest\n+    @MethodSource(\"staticFiles\")\n+    public void testHead(String filename, long expectedSize) throws Exception\n+    {\n+        URI destUri = server.getURI().resolve(\"/\" + filename);\n+        InputStreamResponseListener responseListener = new InputStreamResponseListener();\n+\n+        Request request = client.newRequest(destUri)\n+            .method(HttpMethod.HEAD);\n+        request.send(responseListener);\n+        Response response = responseListener.get(5, TimeUnit.SECONDS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQzNDA4Ng=="}, "originalCommit": {"oid": "a6b7f73019a3cd7b5ba6a382179e25312ad6520c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ2NzI2Mg==", "bodyText": "Does not matter - we will have a failed test and we'll investigate :)", "url": "https://github.com/eclipse/jetty.project/pull/5215#discussion_r481467262", "createdAt": "2020-09-01T22:28:21Z", "author": {"login": "sbordet"}, "path": "jetty-webapp/src/test/java/org/eclipse/jetty/webapp/HugeResourceTest.java", "diffHunk": "@@ -244,6 +244,26 @@ public void testDownload(String filename, long expectedSize) throws Exception\n         }\n     }\n \n+    @ParameterizedTest\n+    @MethodSource(\"staticFiles\")\n+    public void testHead(String filename, long expectedSize) throws Exception\n+    {\n+        URI destUri = server.getURI().resolve(\"/\" + filename);\n+        InputStreamResponseListener responseListener = new InputStreamResponseListener();\n+\n+        Request request = client.newRequest(destUri)\n+            .method(HttpMethod.HEAD);\n+        request.send(responseListener);\n+        Response response = responseListener.get(5, TimeUnit.SECONDS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQzNDA4Ng=="}, "originalCommit": {"oid": "a6b7f73019a3cd7b5ba6a382179e25312ad6520c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk4MTEzMQ==", "bodyText": "@joakime I'll fix this to get this merged ASAP.", "url": "https://github.com/eclipse/jetty.project/pull/5215#discussion_r481981131", "createdAt": "2020-09-02T10:56:23Z", "author": {"login": "gregw"}, "path": "jetty-webapp/src/test/java/org/eclipse/jetty/webapp/HugeResourceTest.java", "diffHunk": "@@ -244,6 +244,26 @@ public void testDownload(String filename, long expectedSize) throws Exception\n         }\n     }\n \n+    @ParameterizedTest\n+    @MethodSource(\"staticFiles\")\n+    public void testHead(String filename, long expectedSize) throws Exception\n+    {\n+        URI destUri = server.getURI().resolve(\"/\" + filename);\n+        InputStreamResponseListener responseListener = new InputStreamResponseListener();\n+\n+        Request request = client.newRequest(destUri)\n+            .method(HttpMethod.HEAD);\n+        request.send(responseListener);\n+        Response response = responseListener.get(5, TimeUnit.SECONDS);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQzNDA4Ng=="}, "originalCommit": {"oid": "a6b7f73019a3cd7b5ba6a382179e25312ad6520c"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2351, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}