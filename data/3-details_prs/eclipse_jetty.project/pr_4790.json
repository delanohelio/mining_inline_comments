{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1NTIyMzc3", "number": 4790, "title": "Fixes #4778 - Enforcing SNI when there are only non-wildcards certifi\u2026", "bodyText": "\u2026cates.\nIf SNI is required, wrap the KeyManagers with SniX509ExtendedKeyManager.\nUpdated the main keystore file to only have one certificate (instead of two),\nsince there never was the need for two certificates in the tests.\nSigned-off-by: Simone Bordet simone.bordet@gmail.com\nCloses #4778.", "createdAt": "2020-04-18T16:15:53Z", "url": "https://github.com/eclipse/jetty.project/pull/4790", "merged": true, "mergeCommit": {"oid": "2fa161c515eb8d45593c9f5662505efa916ec32c"}, "closed": true, "closedAt": "2020-05-04T09:35:06Z", "author": {"login": "sbordet"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcY4SZ1gH2gAyNDA1NTIyMzc3OjQyNmM4MGJmNmRlNGQ3OTQ0ZTNjZTY2OWE0NDI5NDc1N2ZhNWQ5NWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccCRUGgFqTQwMTc0NzI5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "426c80bf6de4d7944e3ce669a44294757fa5d95a", "author": {"user": {"login": "sbordet", "name": "Simone Bordet"}}, "url": "https://github.com/eclipse/jetty.project/commit/426c80bf6de4d7944e3ce669a44294757fa5d95a", "committedDate": "2020-04-18T16:15:03Z", "message": "Fixes #4778 - Enforcing SNI when there are only non-wildcards certificates.\n\nIf SNI is required, wrap the KeyManagers with SniX509ExtendedKeyManager.\nUpdated the main keystore file to only have one certificate (instead of two),\nsince there never was the need for two certificates in the tests.\n\nSigned-off-by: Simone Bordet <simone.bordet@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1OTU1MTIx", "url": "https://github.com/eclipse/jetty.project/pull/4790#pullrequestreview-395955121", "createdAt": "2020-04-18T22:06:17Z", "commit": {"oid": "426c80bf6de4d7944e3ce669a44294757fa5d95a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQyMjowNjoxN1rOGHuqnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQyMjowNjoxN1rOGHuqnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDc1Nzc4OA==", "bodyText": "Maybe a stupid question, but is it possible to move newSniX509ExtendedKeyManager wrapping to a Server.getKeyManagers method?", "url": "https://github.com/eclipse/jetty.project/pull/4790#discussion_r410757788", "createdAt": "2020-04-18T22:06:17Z", "author": {"login": "rnd4222"}, "path": "jetty-util/src/main/java/org/eclipse/jetty/util/ssl/SslContextFactory.java", "diffHunk": "@@ -1247,14 +1247,13 @@ protected KeyStore loadTrustStore(Resource resource) throws Exception\n                 }\n \n                 // Is SNI needed to select a certificate?\n-                if (!_certWilds.isEmpty() || _certHosts.size() > 1 || (_certHosts.size() == 1 && _aliasX509.size() > 1))\n+                boolean sniRequired = (this instanceof Server) && ((Server)this).isSniRequired();\n+                if (sniRequired || !_certWilds.isEmpty() || _certHosts.size() > 1 || (_certHosts.size() == 1 && _aliasX509.size() > 1))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426c80bf6de4d7944e3ce669a44294757fa5d95a"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzQ3Mjkw", "url": "https://github.com/eclipse/jetty.project/pull/4790#pullrequestreview-401747290", "createdAt": "2020-04-28T11:34:41Z", "commit": {"oid": "426c80bf6de4d7944e3ce669a44294757fa5d95a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 351, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}