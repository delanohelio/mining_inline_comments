{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2MzQ1MTI0", "number": 5215, "title": "Issue #5214 - Servlet HEAD doesn't support content-length over Integer.MAX_VALUE", "bodyText": "", "createdAt": "2020-08-31T14:44:53Z", "url": "https://github.com/eclipse/jetty.project/pull/5215", "merged": true, "mergeCommit": {"oid": "5fef14019a2fb8667e3e3cdd3c69120ce4dd2b89"}, "closed": true, "closedAt": "2020-09-02T17:54:39Z", "author": {"login": "joakime"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEToRbgH2gAyNDc2MzQ1MTI0OjExNjg3MTM2MmJmNDExMTViZGEzNTIyZDI0NDExMmQ1ZGFlMmZiYTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdE8dN8gFqTQ4MDg0ODY2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "116871362bf41115bda3522d244112d5dae2fba1", "author": {"user": {"login": "joakime", "name": "Joakim Erdfelt"}}, "url": "https://github.com/eclipse/jetty.project/commit/116871362bf41115bda3522d244112d5dae2fba1", "committedDate": "2020-08-31T14:25:07Z", "message": "Issue #5214 - Replicating HEAD Content-Length failure for huge files\n\nSigned-off-by: Joakim Erdfelt <joakim.erdfelt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eba360f66247784057c452c7e944b6f53575d9b9", "author": {"user": {"login": "joakime", "name": "Joakim Erdfelt"}}, "url": "https://github.com/eclipse/jetty.project/commit/eba360f66247784057c452c7e944b6f53575d9b9", "committedDate": "2020-08-31T14:43:04Z", "message": "Issue #5214 - Use known content_length when in bypass write\n\n+ In the case of HEAD, the servlet-api response is a wrapper\n  of javax.servlet.http.HttpServlet$NoBodyResponse\n  We know the content_length, use it.\n\nSigned-off-by: Joakim Erdfelt <joakim.erdfelt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcb06d3c35c26e634c173d4fbcad20e6289128d7", "author": {"user": {"login": "joakime", "name": "Joakim Erdfelt"}}, "url": "https://github.com/eclipse/jetty.project/commit/dcb06d3c35c26e634c173d4fbcad20e6289128d7", "committedDate": "2020-08-31T16:03:49Z", "message": "Issue #5214 - Use known content_length when in HEAD mode\n\n+ Adding DefaultServlet.doHead() to avoid servlet wrapping\n+ Making ResourceService HEAD aware\n\nSigned-off-by: Joakim Erdfelt <joakim.erdfelt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9128fc48e4921b72441f3c909151f7b5591cef3f", "author": {"user": {"login": "joakime", "name": "Joakim Erdfelt"}}, "url": "https://github.com/eclipse/jetty.project/commit/9128fc48e4921b72441f3c909151f7b5591cef3f", "committedDate": "2020-08-31T16:16:22Z", "message": "Cleanup dead code in ResourceService\n\nSigned-off-by: Joakim Erdfelt <joakim.erdfelt@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e326fe5202e060a5f1726f093ae9db31c8dc203", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/9e326fe5202e060a5f1726f093ae9db31c8dc203", "committedDate": "2020-08-31T16:19:11Z", "message": "+ improved sentinels values for content-length\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6b7f73019a3cd7b5ba6a382179e25312ad6520c", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/a6b7f73019a3cd7b5ba6a382179e25312ad6520c", "committedDate": "2020-08-31T16:22:10Z", "message": "Merge branch 'jetty-9.4.x-5214-head-huge-static' of https://github.com/eclipse/jetty.project into jetty-9.4.x-5214-head-huge-static"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4Nzc3NjM3", "url": "https://github.com/eclipse/jetty.project/pull/5215#pullrequestreview-478777637", "createdAt": "2020-08-31T16:50:36Z", "commit": {"oid": "a6b7f73019a3cd7b5ba6a382179e25312ad6520c"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTE4Nzcx", "url": "https://github.com/eclipse/jetty.project/pull/5215#pullrequestreview-480118771", "createdAt": "2020-09-01T21:11:42Z", "commit": {"oid": "a6b7f73019a3cd7b5ba6a382179e25312ad6520c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxMTo0MlrOHLIZ5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMToxMTo0MlrOHLIZ5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQzNDA4Ng==", "bodyText": "responseListener.get() only waits for the headers, so to be sure here I would also do (maybe in a try-with-resources):\nassertEquals(-1, response.getInputStream().read());\nwhich would guarantee that the HEAD response really came without body, as it should be.", "url": "https://github.com/eclipse/jetty.project/pull/5215#discussion_r481434086", "createdAt": "2020-09-01T21:11:42Z", "author": {"login": "sbordet"}, "path": "jetty-webapp/src/test/java/org/eclipse/jetty/webapp/HugeResourceTest.java", "diffHunk": "@@ -244,6 +244,26 @@ public void testDownload(String filename, long expectedSize) throws Exception\n         }\n     }\n \n+    @ParameterizedTest\n+    @MethodSource(\"staticFiles\")\n+    public void testHead(String filename, long expectedSize) throws Exception\n+    {\n+        URI destUri = server.getURI().resolve(\"/\" + filename);\n+        InputStreamResponseListener responseListener = new InputStreamResponseListener();\n+\n+        Request request = client.newRequest(destUri)\n+            .method(HttpMethod.HEAD);\n+        request.send(responseListener);\n+        Response response = responseListener.get(5, TimeUnit.SECONDS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a6b7f73019a3cd7b5ba6a382179e25312ad6520c"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "418093af28df8627301d6aee8d23dc843265367c", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/418093af28df8627301d6aee8d23dc843265367c", "committedDate": "2020-09-02T11:01:20Z", "message": "Feedback from review:\n\n + check no content in HEAD response"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwODQ4NjYw", "url": "https://github.com/eclipse/jetty.project/pull/5215#pullrequestreview-480848660", "createdAt": "2020-09-02T13:59:09Z", "commit": {"oid": "418093af28df8627301d6aee8d23dc843265367c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 315, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}