{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3MzI0MDIy", "number": 5148, "title": "Issue #5095 - XmlConfiguration Parser Pool", "bodyText": "For #5095", "createdAt": "2020-08-13T11:27:09Z", "url": "https://github.com/eclipse/jetty.project/pull/5148", "merged": true, "mergeCommit": {"oid": "1159fa399f2abaf011926a234acce3a44673ba13"}, "closed": true, "closedAt": "2020-08-24T16:00:29Z", "author": {"login": "gregw"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7lD2_gH2gAyNDY3MzI0MDIyOmViYjMwMTc5NGRkMGYyZTYwMTU1YzJlZTgyMzQ5ZWM3ZTg3MDRjM2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCDvl9gFqTQ3MzU2Nzc3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ebb301794dd0f2e60155c2ee82349ec7e8704c3a", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/ebb301794dd0f2e60155c2ee82349ec7e8704c3a", "committedDate": "2020-08-04T11:38:19Z", "message": "Issue #5095 XmlConfiguration Parser Pool\n\nUse a pool of parsers rather than a shared static\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1436b0c3e2da420cec9d3865072d7ed26a62f186", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/1436b0c3e2da420cec9d3865072d7ed26a62f186", "committedDate": "2020-08-04T16:23:33Z", "message": "Some updates to the new Pool class:\n\n + fixed a race with pending reservations\n + use a pending counter\n + Reservation API to simplify Entry API\n + removed public methods on Entry API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5a35a2eac4ce20b64ba71edcc1800a926cadde4", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/f5a35a2eac4ce20b64ba71edcc1800a926cadde4", "committedDate": "2020-08-05T09:22:49Z", "message": "Some updates to the new Pool class:\n\n + fixed a race with pending reservations\n + use a pending counter\n + Reservation API to simplify Entry API\n + removed public methods on Entry API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37a9f88fb7f8104364db7856f285460b02781db8", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/37a9f88fb7f8104364db7856f285460b02781db8", "committedDate": "2020-08-05T15:17:09Z", "message": "Updates from review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be7bb00a2633de913b7014b7b511fee0094c9a15", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/be7bb00a2633de913b7014b7b511fee0094c9a15", "committedDate": "2020-08-05T16:44:54Z", "message": "Updates from review\nTests for cache size and acquire with creator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2eb669757f63098c41bdcfa34438c9afc9af22cc", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/2eb669757f63098c41bdcfa34438c9afc9af22cc", "committedDate": "2020-08-10T07:56:01Z", "message": "Merge remote-tracking branch 'origin/jetty-9.4.x' into jetty-9.4.x-PoolCleaning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ac922b3f4b0a1fe1df0e8606ec70b22805bb5a3", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/1ac922b3f4b0a1fe1df0e8606ec70b22805bb5a3", "committedDate": "2020-08-10T08:05:27Z", "message": "Method no longer required with Reservation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8b28e435ac41438cb18c307f6f5257934e99c00", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/d8b28e435ac41438cb18c307f6f5257934e99c00", "committedDate": "2020-08-10T13:31:31Z", "message": "update from the feedback on the feedback of the feedback from the review.\n\nMoved enable to Entry, removed Reservation class and clarified usage in javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "746323320fc45a3033dffc8b515380ff3515fa2b", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/746323320fc45a3033dffc8b515380ff3515fa2b", "committedDate": "2020-08-10T13:33:40Z", "message": "Issue #5095 XmlConfiguration locking  Use pool instead of static shared instance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92fde37248dbc4fb5fb829917ee34d8296212a34", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/92fde37248dbc4fb5fb829917ee34d8296212a34", "committedDate": "2020-08-13T09:54:16Z", "message": "Merge branch 'jetty-9.4.x-5095-XmlConfigurationParserPool' of https://github.com/eclipse/jetty.project into jetty-9.4.x-5095-XmlConfigurationParserPool\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf07df4da775e4e8fb4a2728393571d128ee07a9", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/bf07df4da775e4e8fb4a2728393571d128ee07a9", "committedDate": "2020-08-13T11:25:31Z", "message": "Merge remote-tracking branch 'origin/jetty-9.4.x' into jetty-9.4.x-5095-XmlConfigurationParserPool\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6058ffb147f2bfb644345930ad22ce4777192525", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/6058ffb147f2bfb644345930ad22ce4777192525", "committedDate": "2020-08-13T11:26:00Z", "message": "removed fake test\n\nSigned-off-by: Greg Wilkins <gregw@webtide.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MjU4MTcx", "url": "https://github.com/eclipse/jetty.project/pull/5148#pullrequestreview-468258171", "createdAt": "2020-08-17T08:16:46Z", "commit": {"oid": "6058ffb147f2bfb644345930ad22ce4777192525"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwODoxNjo0N1rOHBe2JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QwODoxNjo0N1rOHBe2JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTMxNjAwNA==", "bodyText": "I would cap that Runtime.getRuntime().availableProcessors() up to a reasonable number (8? 16? 32?) as I don't think we could use 128+ parsers (which is becoming a more and more common HW thread count) in parallel in practice. Or could we?", "url": "https://github.com/eclipse/jetty.project/pull/5148#discussion_r471316004", "createdAt": "2020-08-17T08:16:47Z", "author": {"login": "lorban"}, "path": "jetty-xml/src/main/java/org/eclipse/jetty/xml/XmlConfiguration.java", "diffHunk": "@@ -99,7 +100,7 @@\n             ArrayList.class, HashSet.class, Queue.class, List.class, Set.class, Collection.class\n         };\n     private static final Iterable<ConfigurationProcessorFactory> __factoryLoader = ServiceLoader.load(ConfigurationProcessorFactory.class);\n-    private static final XmlParser __parser = initParser();\n+    private static final Pool<ConfigurationParser> __parsers = new Pool<>(Runtime.getRuntime().availableProcessors(),1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6058ffb147f2bfb644345930ad22ce4777192525"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca9bc68ccf7d6447329ce03d55201d49334662a4", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/ca9bc68ccf7d6447329ce03d55201d49334662a4", "committedDate": "2020-08-17T08:26:57Z", "message": "Merge branch 'jetty-9.4.x' into jetty-9.4.x-5095-XmlConfigurationParserPool"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64066b7a4afd4ac7edcd22f05de02b3ac0d3d59b", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/64066b7a4afd4ac7edcd22f05de02b3ac0d3d59b", "committedDate": "2020-08-17T08:31:44Z", "message": "Issue #5095 XmlConfiguration locking  Use pool instead of static shared instance\n\nupdates from review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTY3Nzcz", "url": "https://github.com/eclipse/jetty.project/pull/5148#pullrequestreview-473567773", "createdAt": "2020-08-24T14:46:47Z", "commit": {"oid": "64066b7a4afd4ac7edcd22f05de02b3ac0d3d59b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 288, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}