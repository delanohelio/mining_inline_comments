{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5NDc3MDIx", "number": 5643, "title": "Cleanup request/response recycle #4711", "bodyText": "Reordered recycle in request and response to field order so that we can check that all fields are recycled for #4711", "createdAt": "2020-11-11T22:06:04Z", "url": "https://github.com/eclipse/jetty.project/pull/5643", "merged": true, "mergeCommit": {"oid": "850a0330ff25da42b1b1cbdbdca0fcc0c40e47e9"}, "closed": true, "closedAt": "2020-11-16T10:48:34Z", "author": {"login": "gregw"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdblXRlAH2gAyNTE5NDc3MDIxOmE5OWFiMDRmZTViY2NkZDk0M2M4ZWJhODkyYTljMzAyNzU2ODljZWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddBqTYgFqTUzMTE1MjM0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a99ab04fe5bccdd943c8eba892a9c30275689cea", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/a99ab04fe5bccdd943c8eba892a9c30275689cea", "committedDate": "2020-11-11T22:05:06Z", "message": "Cleanup request/response recycle #4711\n\nReordered recycle in request and response to field order so that we can check that all fields are recycled."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7467071eb4f549f524c85c462d6bb48204403b9", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/b7467071eb4f549f524c85c462d6bb48204403b9", "committedDate": "2020-11-12T10:45:27Z", "message": "Fixed ordering of reader consumption"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMTMzNzEx", "url": "https://github.com/eclipse/jetty.project/pull/5643#pullrequestreview-531133711", "createdAt": "2020-11-16T09:13:13Z", "commit": {"oid": "b7467071eb4f549f524c85c462d6bb48204403b9"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwOToxMzoxM1rOHzuqug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQwOToxNDoxM1rOHzuvBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDAwNDAyNg==", "bodyText": "while loops require braces for checkstyle.", "url": "https://github.com/eclipse/jetty.project/pull/5643#discussion_r524004026", "createdAt": "2020-11-16T09:13:13Z", "author": {"login": "sbordet"}, "path": "jetty-server/src/main/java/org/eclipse/jetty/server/Request.java", "diffHunk": "@@ -1857,37 +1857,40 @@ public boolean hasMetaData()\n \n     protected void recycle()\n     {\n-        _metaData = null;\n-        _originalURI = null;\n-\n         if (_context != null)\n             throw new IllegalStateException(\"Request in context!\");\n-\n-        if (_inputState == INPUT_READER)\n+        if (_reader != null && _inputState == INPUT_READER)\n         {\n             try\n             {\n                 int r = _reader.read();\n                 while (r != -1)\n-                {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7467071eb4f549f524c85c462d6bb48204403b9"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDAwNTEyNQ==", "bodyText": "Unnecessary newline.", "url": "https://github.com/eclipse/jetty.project/pull/5643#discussion_r524005125", "createdAt": "2020-11-16T09:14:13Z", "author": {"login": "sbordet"}, "path": "jetty-server/src/main/java/org/eclipse/jetty/server/Request.java", "diffHunk": "@@ -1857,37 +1857,40 @@ public boolean hasMetaData()\n \n     protected void recycle()\n     {\n-        _metaData = null;\n-        _originalURI = null;\n-\n         if (_context != null)\n             throw new IllegalStateException(\"Request in context!\");\n-\n-        if (_inputState == INPUT_READER)\n+        if (_reader != null && _inputState == INPUT_READER)\n         {\n             try\n             {\n                 int r = _reader.read();\n                 while (r != -1)\n-                {\n                     r = _reader.read();\n-                }\n             }\n             catch (Exception e)\n             {\n                 LOG.ignore(e);\n                 _reader = null;\n+                _readerEncoding = null;\n             }\n         }\n \n-        _dispatcherType = null;\n-        setAuthentication(Authentication.NOT_CHECKED);\n         getHttpChannelState().recycle();\n-        if (_async != null)\n-            _async.reset();\n-        _async = null;\n+        _requestAttributeListeners.clear();\n+        _input.recycle();\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7467071eb4f549f524c85c462d6bb48204403b9"}, "originalPosition": 62}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aee2f386247febc7ddb925c4fdb1840309517d69", "author": {"user": {"login": "gregw", "name": "Greg Wilkins"}}, "url": "https://github.com/eclipse/jetty.project/commit/aee2f386247febc7ddb925c4fdb1840309517d69", "committedDate": "2020-11-16T09:30:10Z", "message": "update from review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMTUyMzQ5", "url": "https://github.com/eclipse/jetty.project/pull/5643#pullrequestreview-531152349", "createdAt": "2020-11-16T09:37:10Z", "commit": {"oid": "aee2f386247febc7ddb925c4fdb1840309517d69"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4966, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}