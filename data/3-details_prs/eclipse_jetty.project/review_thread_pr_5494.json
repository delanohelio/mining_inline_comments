{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4NDQ1MTUx", "number": 5494, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzo0MzozNlrOExFy8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xNlQxMDoyNDo0OVrOFa0kaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5OTEwNjQzOnYy", "diffSide": "RIGHT", "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNzo0MzozNlrOHnCYtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xNVQxOToxMDo0NFrOIlrlBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NTYwNw==", "bodyText": "As discussed, I won't add features that we don't use -- keep only java.feature.alpn.\nFor example, loom won't be available in 16 AFAIK, and other features may be available only with --enable-preview so it's not only the java version, we may need to sniff the existence of classes/methods, etc.", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r510695607", "createdAt": "2020-10-23T07:43:36Z", "author": {"login": "sbordet"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,12 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                properties.setProperty(\"java.feature.alpn\", Boolean.toString(ver.getPlatform() >= 9), source);\n+                properties.setProperty(\"java.feature.jpms\", Boolean.toString(ver.getPlatform() >= 9), source);\n+                properties.setProperty(\"java.feature.loom\", Boolean.toString(ver.getPlatform() >= 16), source);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ddd1a1a8c7ced537fdb470113e520b37a033a2c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjM4MjIxNA==", "bodyText": "Removed loom entirely.\nLeft jpms (in 9.4.x) as it has a use there. (no valid use in 10.0.x+)", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r576382214", "createdAt": "2021-02-15T19:10:44Z", "author": {"login": "joakime"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,12 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                properties.setProperty(\"java.feature.alpn\", Boolean.toString(ver.getPlatform() >= 9), source);\n+                properties.setProperty(\"java.feature.jpms\", Boolean.toString(ver.getPlatform() >= 9), source);\n+                properties.setProperty(\"java.feature.loom\", Boolean.toString(ver.getPlatform() >= 16), source);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY5NTYwNw=="}, "originalCommit": {"oid": "4ddd1a1a8c7ced537fdb470113e520b37a033a2c"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwODYyOTI2OnYy", "diffSide": "RIGHT", "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNjo1OTo1OVrOHoZc8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMjo1MzoxM1rOHo6pow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMjA5Nw==", "bodyText": "Does \"feature\" add much?\nHow about just \"java.alpn\" ?", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r512122097", "createdAt": "2020-10-26T16:59:59Z", "author": {"login": "gregw"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,12 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                properties.setProperty(\"java.feature.alpn\", Boolean.toString(ver.getPlatform() >= 9), source);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ddd1a1a8c7ced537fdb470113e520b37a033a2c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE1NTIzNQ==", "bodyText": "If I saw java.alpn I would assume it's a alpn configuration, to tweak alpn behavior.\nA different name I'm open to.\nPerhaps we should probably make the prefix something that might not conflict in the future.\nStay away from the java. prefix?\nPerhaps jvm.feature.alpn ?\nor runtime.feature.alpn ?", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r512155235", "createdAt": "2020-10-26T17:48:51Z", "author": {"login": "joakime"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,12 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                properties.setProperty(\"java.feature.alpn\", Boolean.toString(ver.getPlatform() >= 9), source);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMjA5Nw=="}, "originalCommit": {"oid": "4ddd1a1a8c7ced537fdb470113e520b37a033a2c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ2NzI3OQ==", "bodyText": "OK, I can live with \"feature\".    I think I have a slight preference for \"jvm.feature\" rather than \"java.feature\"", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r512467279", "createdAt": "2020-10-27T07:33:14Z", "author": {"login": "gregw"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,12 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                properties.setProperty(\"java.feature.alpn\", Boolean.toString(ver.getPlatform() >= 9), source);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMjA5Nw=="}, "originalCommit": {"oid": "4ddd1a1a8c7ced537fdb470113e520b37a033a2c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MjYyOA==", "bodyText": "But it's not a JVM feature - like a GC or JIT is.\nIt's really a Java API feature, so I think it should remain java.feature.alpn.", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r512592628", "createdAt": "2020-10-27T10:56:19Z", "author": {"login": "sbordet"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,12 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                properties.setProperty(\"java.feature.alpn\", Boolean.toString(ver.getPlatform() >= 9), source);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMjA5Nw=="}, "originalCommit": {"oid": "4ddd1a1a8c7ced537fdb470113e520b37a033a2c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjYzNjA3NA==", "bodyText": "Before I change anything here, I'm going to let this conversation simmer for a few days to see what develops.  See if opinions change (or not).", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r512636074", "createdAt": "2020-10-27T12:03:11Z", "author": {"login": "joakime"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,12 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                properties.setProperty(\"java.feature.alpn\", Boolean.toString(ver.getPlatform() >= 9), source);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMjA5Nw=="}, "originalCommit": {"oid": "4ddd1a1a8c7ced537fdb470113e520b37a033a2c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY2NjAxOQ==", "bodyText": "I'm happy for you to leave the names as they are.", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r512666019", "createdAt": "2020-10-27T12:53:13Z", "author": {"login": "gregw"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,12 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                properties.setProperty(\"java.feature.alpn\", Boolean.toString(ver.getPlatform() >= 9), source);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjEyMjA5Nw=="}, "originalCommit": {"oid": "4ddd1a1a8c7ced537fdb470113e520b37a033a2c"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzYzNjY4NTg0OnYy", "diffSide": "RIGHT", "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xNlQxMDoyNDo0OVrOIl_rSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xNlQxMDoyNDo0OVrOIl_rSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjcxMTQ5Ng==", "bodyText": "*.feature.jpms is not used, so I would remove it -- no need to leave in the code unnecessary stuff.", "url": "https://github.com/eclipse/jetty.project/pull/5494#discussion_r576711496", "createdAt": "2021-02-16T10:24:49Z", "author": {"login": "sbordet"}, "path": "jetty-start/src/main/java/org/eclipse/jetty/start/StartArgs.java", "diffHunk": "@@ -1505,6 +1505,13 @@ public void setProperty(String key, String value, String source)\n             {\n                 JavaVersion ver = JavaVersion.parse(value);\n                 properties.setProperty(\"java.version.platform\", Integer.toString(ver.getPlatform()), source);\n+\n+                // features built into java.\n+                // In Jetty 10+ these will always be true, but still need to stick around for users that\n+                // want to move between Jetty 9.4.x and 10.0.x+\n+                properties.setProperty(\"runtime.feature.alpn\", Boolean.toString(isMethodAvailable(javax.net.ssl.SSLParameters.class, \"getApplicationProtocols\", null)), source);\n+                properties.setProperty(\"runtime.feature.jpms\", Boolean.toString(isClassAvailable(\"java.lang.ModuleLayer\")), source);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ed68d068133cc8ce54d68cda4f8ce8cf27f3827"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2185, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}