{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NDIzMzAw", "number": 5167, "title": "Issue #4996 - Regularlize logging", "bodyText": "Closes #4996\nBumper clean up of logging statements.\n\nfixed up a few logging statements that were missing parameter subtsitutions\nsimplified some logging statements that were unnecessarily doing multiple LOG statements just to ouptut a bunch of different parameters\nguarded more LOG.debug with LOG.isDebugEnabled()\nchanged LOG.warn, LOG.debug, LOG.info statements that have args something like (\"blah \" + foo, throwable) to be (\"blah {}\", foo, throwable) as the logging system supports the interpretation of the last arg always as a throwable.\nmodified a few logging statements to conform to the recently agreed logging standards\nadded the logging standards to the contribution documentation", "createdAt": "2020-08-18T11:05:14Z", "url": "https://github.com/eclipse/jetty.project/pull/5167", "merged": true, "mergeCommit": {"oid": "77779ed6d8247536473d8c644cf8d13f78f543ca"}, "closed": true, "closedAt": "2020-08-24T15:15:13Z", "author": {"login": "janbartel"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc76AUDgH2gAyNDY5NDIzMzAwOjZmZmNmNDA0OTU3Njg4NGVjOTYwZTMwNmRmYjhiNWJiODNiYTA0MzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCEHA_AH2gAyNDY5NDIzMzAwOjI4NjhkNWFlODcyNGJhMGMzMmVjYmMzZDk2Mzc5ZjYyODQ3NzAwYjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6ffcf4049576884ec960e306dfb8b5bb83ba0433", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/6ffcf4049576884ec960e306dfb8b5bb83ba0433", "committedDate": "2020-08-05T12:02:27Z", "message": "Issue #4996 Regularize logging\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1aaeb5305cfa212e23a1f7695881e433f8207eb", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/b1aaeb5305cfa212e23a1f7695881e433f8207eb", "committedDate": "2020-08-05T13:32:48Z", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4996-regularlize-logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9ede176ee6aa872dece7e6ee19dc96e7dbddb71", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/e9ede176ee6aa872dece7e6ee19dc96e7dbddb71", "committedDate": "2020-08-17T09:31:42Z", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4996-regularlize-logging\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3b69b2523088435ec5d2e4472e6781a87c55cd8", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/b3b69b2523088435ec5d2e4472e6781a87c55cd8", "committedDate": "2020-08-17T09:44:18Z", "message": "Issue # 4996 update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8bef172b788da7a65a6327a02a2d3e78ba1948c", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/d8bef172b788da7a65a6327a02a2d3e78ba1948c", "committedDate": "2020-08-17T10:01:15Z", "message": "Issue #4996 update\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14cc593c69a064833ee4c99c64d7de95eb6ef1d3", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/14cc593c69a064833ee4c99c64d7de95eb6ef1d3", "committedDate": "2020-08-17T10:25:39Z", "message": "Issue #4996 Add doco\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fd67f302dd64ccc6a45071fd4cac22bf6e05073", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/6fd67f302dd64ccc6a45071fd4cac22bf6e05073", "committedDate": "2020-08-18T09:32:03Z", "message": "Issue #4996 Finish fixing LOG.debug statements\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4f5ec472d0766ca383e7931650f2bf37b27b7c2", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/a4f5ec472d0766ca383e7931650f2bf37b27b7c2", "committedDate": "2020-08-18T10:20:11Z", "message": "Issue #4996 Fix LOG.info statements\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5363cad55c506a5fb91e6f11ad855802bddab12e", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/5363cad55c506a5fb91e6f11ad855802bddab12e", "committedDate": "2020-08-18T10:44:13Z", "message": "Issue #4996 Fix LOG.warns\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "461a7ebde5fa8ead524f0f35584b66d7f4168e00", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/461a7ebde5fa8ead524f0f35584b66d7f4168e00", "committedDate": "2020-08-18T10:58:05Z", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4996-regularlize-logging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5MzM5Mjg0", "url": "https://github.com/eclipse/jetty.project/pull/5167#pullrequestreview-469339284", "createdAt": "2020-08-18T12:01:18Z", "commit": {"oid": "461a7ebde5fa8ead524f0f35584b66d7f4168e00"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe68ba1b2640396a5a8957f5d25dd05e28f981fc", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/fe68ba1b2640396a5a8957f5d25dd05e28f981fc", "committedDate": "2020-08-19T10:13:32Z", "message": "Issue #4996 More fixes\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725", "author": {"user": {"login": "joakime", "name": "Joakim Erdfelt"}}, "url": "https://github.com/eclipse/jetty.project/commit/a79b1c812fc7dc5e182080a6631e312a31b35725", "committedDate": "2020-08-20T19:28:42Z", "message": "Issue #4996 - Fixing Logging parameter usage (mismatched counts)\n\nSigned-off-by: Joakim Erdfelt <joakim.erdfelt@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxOTIzOTgy", "url": "https://github.com/eclipse/jetty.project/pull/5167#pullrequestreview-471923982", "createdAt": "2020-08-20T19:30:10Z", "commit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTozMDoxMFrOHEQHMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTozMDoxMFrOHEQHMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMDMzNg==", "bodyText": "This last parameter was just a guess.", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474220336", "createdAt": "2020-08-20T19:30:10Z", "author": {"login": "joakime"}, "path": "jetty-http2/http2-hpack/src/main/java/org/eclipse/jetty/http2/hpack/HpackEncoder.java", "diffHunk": "@@ -265,7 +265,7 @@ else if (metadata.isResponse())\n             // Check size\n             if (_maxHeaderListSize > 0 && _headerListSize > _maxHeaderListSize)\n             {\n-                LOG.warn(\"Header list size too large {} > {} for {}\", _headerListSize, _maxHeaderListSize);\n+                LOG.warn(\"Header list size too large {} > {} for {}\", _headerListSize, _maxHeaderListSize, metadata);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxOTI0NzM5", "url": "https://github.com/eclipse/jetty.project/pull/5167#pullrequestreview-471924739", "createdAt": "2020-08-20T19:30:40Z", "commit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTozMDo0MFrOHEQIsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTozMDo0MFrOHEQIsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMDcyMA==", "bodyText": "I got rid of c={}, as I have no idea what c could have been.", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474220720", "createdAt": "2020-08-20T19:30:40Z", "author": {"login": "joakime"}, "path": "jetty-server/src/main/java/org/eclipse/jetty/server/PushBuilderImpl.java", "diffHunk": "@@ -68,7 +68,7 @@ public PushBuilderImpl(Request request, HttpFields fields, String method, String\n         _sessionId = sessionId;\n         _fields.add(JETTY_PUSH);\n         if (LOG.isDebugEnabled())\n-            LOG.debug(\"PushBuilder({} {}?{} s={} c={})\", _method, _request.getRequestURI(), _queryString, _sessionId);\n+            LOG.debug(\"PushBuilder({} {}?{} s={})\", _method, _request.getRequestURI(), _queryString, _sessionId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxOTI1ODc0", "url": "https://github.com/eclipse/jetty.project/pull/5167#pullrequestreview-471925874", "createdAt": "2020-08-20T19:32:24Z", "commit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTozMjoyNFrOHEQOmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTozMjoyNFrOHEQOmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMjIzNQ==", "bodyText": "This one had base vs context resource, then resourcebase, then path.  Not sure what the correct step here should have been.\nAlmost thinking it should just be ...\nLOG.debug(\"getResource({}) baseResource={}, context={}\", path, _baseResource, _context);\nWDYT?", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474222235", "createdAt": "2020-08-20T19:32:24Z", "author": {"login": "joakime"}, "path": "jetty-server/src/main/java/org/eclipse/jetty/server/handler/ResourceHandler.java", "diffHunk": "@@ -143,7 +143,7 @@ public MimeTypes getMimeTypes()\n     public Resource getResource(String path)\n     {\n         if (LOG.isDebugEnabled())\n-            LOG.debug(\"{} getResource({})\", _context == null ? _baseResource : _context, _baseResource, path);\n+            LOG.debug(\"{} getResource({})\", _context == null ? _baseResource : _context, path);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyMzE3ODE1", "url": "https://github.com/eclipse/jetty.project/pull/5167#pullrequestreview-472317815", "createdAt": "2020-08-21T08:51:20Z", "commit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwODo1MToyMFrOHEjqFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwODo1NDo0NlrOHEj3kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDU0MDU2NA==", "bodyText": "It looks like the intent was only to output the metadata if debug was enabled, so how about this instead:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (LOG.isDebugEnabled())\n          \n          \n            \n                            if (LOG.isDebugEnabled())\n          \n          \n            \n                               LOG.warn(\"Header list size too large {} > {} metadata={}\", _headerListSize, _maxHeaderListSize, metadata);\n          \n          \n            \n                            else\n          \n          \n            \n                                LOG.warn(\"Header list size too large {} > {}\", _headerListSize, _maxHeaderListSize);", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474540564", "createdAt": "2020-08-21T08:51:20Z", "author": {"login": "janbartel"}, "path": "jetty-http2/http2-hpack/src/main/java/org/eclipse/jetty/http2/hpack/HpackEncoder.java", "diffHunk": "@@ -265,7 +265,7 @@ else if (metadata.isResponse())\n             // Check size\n             if (_maxHeaderListSize > 0 && _headerListSize > _maxHeaderListSize)\n             {\n-                LOG.warn(\"Header list size too large {} > {} for {}\", _headerListSize, _maxHeaderListSize);\n+                LOG.warn(\"Header list size too large {} > {} for {}\", _headerListSize, _maxHeaderListSize, metadata);\n                 if (LOG.isDebugEnabled())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDU0NDAxOA==", "bodyText": "I'm thinking it looks like we just want either the context, if there is one, or the baseResource otherwise, plus the path arg to the method, so the change in your commit is correct.", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474544018", "createdAt": "2020-08-21T08:54:46Z", "author": {"login": "janbartel"}, "path": "jetty-server/src/main/java/org/eclipse/jetty/server/handler/ResourceHandler.java", "diffHunk": "@@ -143,7 +143,7 @@ public MimeTypes getMimeTypes()\n     public Resource getResource(String path)\n     {\n         if (LOG.isDebugEnabled())\n-            LOG.debug(\"{} getResource({})\", _context == null ? _baseResource : _context, _baseResource, path);\n+            LOG.debug(\"{} getResource({})\", _context == null ? _baseResource : _context, path);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMjIzNQ=="}, "originalCommit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNDE3MzUz", "url": "https://github.com/eclipse/jetty.project/pull/5167#pullrequestreview-473417353", "createdAt": "2020-08-24T12:31:20Z", "commit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMjozMToyMFrOHFiIzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMjozNzo1NFrOHFiWoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU2NDIzNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * we should not call more than one LOG method for a single event: otherwise log messages may be interleaved and more confusing\n          \n          \n            \n            * we should not call more than one LOG method for a single event: otherwise log messages may be interleaved and more confusing\n          \n          \n            \n            * we should never LOG.warn and then throw that exception, as that will result in double handling.\n          \n          \n            \n            * we should seldom LOG.debug and then throw as that will make debug verbose and add little information.", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r475564237", "createdAt": "2020-08-24T12:31:20Z", "author": {"login": "gregw"}, "path": "jetty-documentation/src/main/asciidoc/contribution-guide/3-source.adoc", "diffHunk": "@@ -163,6 +163,60 @@ Intellectual Property is a hallmark concern of the Eclipse Foundation so you are\n As much as we would like to accept a tremendous pull request, without the proper chain of events being completed our hands are tied.\n That being said, the steps are not particularly onerous and we are happy to work with you to get them accomplished.\n \n+==== Logging Conventions\n+\n+When deciding when and what to log, bear in mind a few things:\n+\n+* never use `LOG.debug` without a preceding `if (LOG.isDebugEnabled())`\n+* we don't want to pollute the log with very long stacktraces unless necessary\n+* we don't want to routinely produce logging events in response to data sent by a user\n+* we should not call more than one LOG method for a single event: otherwise log messages may be interleaved and more confusing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU2Nzc3Nw==", "bodyText": "Maybe just enumerate these once, rather than have short list then long list.", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r475567777", "createdAt": "2020-08-24T12:37:54Z", "author": {"login": "gregw"}, "path": "jetty-documentation/src/main/asciidoc/contribution-guide/3-source.adoc", "diffHunk": "@@ -163,6 +163,60 @@ Intellectual Property is a hallmark concern of the Eclipse Foundation so you are\n As much as we would like to accept a tremendous pull request, without the proper chain of events being completed our hands are tied.\n That being said, the steps are not particularly onerous and we are happy to work with you to get them accomplished.\n \n+==== Logging Conventions\n+\n+When deciding when and what to log, bear in mind a few things:\n+\n+* never use `LOG.debug` without a preceding `if (LOG.isDebugEnabled())`\n+* we don't want to pollute the log with very long stacktraces unless necessary\n+* we don't want to routinely produce logging events in response to data sent by a user\n+* we should not call more than one LOG method for a single event: otherwise log messages may be interleaved and more confusing\n+\n+Specifically:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a63fa5997ae24d72b756a89fecd09f634b6a7bf", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/1a63fa5997ae24d72b756a89fecd09f634b6a7bf", "committedDate": "2020-08-24T14:45:41Z", "message": "Issue #4996 Updates post review.\n\nSigned-off-by: Jan Bartel <janb@webtide.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTgxMTE3", "url": "https://github.com/eclipse/jetty.project/pull/5167#pullrequestreview-473581117", "createdAt": "2020-08-24T14:53:45Z", "commit": {"oid": "1a63fa5997ae24d72b756a89fecd09f634b6a7bf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2868d5ae8724ba0c32ecbc3d96379f62847700b0", "author": {"user": {"login": "janbartel", "name": "Jan Bartel"}}, "url": "https://github.com/eclipse/jetty.project/commit/2868d5ae8724ba0c32ecbc3d96379f62847700b0", "committedDate": "2020-08-24T15:12:22Z", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4996-regularlize-logging"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 292, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}