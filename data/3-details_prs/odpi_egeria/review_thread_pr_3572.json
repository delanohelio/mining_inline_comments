{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwNDc2Nzkx", "number": 3572, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzo1MDoxM1rOEk-oFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNDowMDoyOFrOEk-4pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjEwMjYzOnYy", "diffSide": "RIGHT", "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzo1MDoxM1rOHUOAhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDowMTowMFrOHUaOMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2MzA3OA==", "bodyText": "why change a specific import to a wildcard ?", "url": "https://github.com/odpi/egeria/pull/3572#discussion_r490963078", "createdAt": "2020-09-18T13:50:13Z", "author": {"login": "wbittles"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "diffHunk": "@@ -3,14 +3,14 @@\n package org.odpi.openmetadata.adapters.eventbus.topic.kafka;\r\n \r\n import java.time.Duration;\r\n-import java.util.ArrayDeque;\r\n import java.util.Collection;\r\n import java.util.Collections;\r\n import java.util.HashMap;\r\n import java.util.Map;\r\n import java.util.Properties;\r\n import java.util.Queue;\r\n-import java.util.concurrent.TimeUnit;\r\n+import java.util.concurrent.*;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eb71ab9327642699dcddf1f651569d40cdd4b59"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk3NzgzMw==", "bodyText": "This idea was made automatically I just did not pay attention. But resole it is easily.", "url": "https://github.com/odpi/egeria/pull/3572#discussion_r490977833", "createdAt": "2020-09-18T14:12:47Z", "author": {"login": "immmus"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "diffHunk": "@@ -3,14 +3,14 @@\n package org.odpi.openmetadata.adapters.eventbus.topic.kafka;\r\n \r\n import java.time.Duration;\r\n-import java.util.ArrayDeque;\r\n import java.util.Collection;\r\n import java.util.Collections;\r\n import java.util.HashMap;\r\n import java.util.Map;\r\n import java.util.Properties;\r\n import java.util.Queue;\r\n-import java.util.concurrent.TimeUnit;\r\n+import java.util.concurrent.*;\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2MzA3OA=="}, "originalCommit": {"oid": "6eb71ab9327642699dcddf1f651569d40cdd4b59"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE0Mzc5MA==", "bodyText": "Good spot @wbittles - certainly we should not use wildcards.", "url": "https://github.com/odpi/egeria/pull/3572#discussion_r491143790", "createdAt": "2020-09-18T19:16:04Z", "author": {"login": "planetf1"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "diffHunk": "@@ -3,14 +3,14 @@\n package org.odpi.openmetadata.adapters.eventbus.topic.kafka;\r\n \r\n import java.time.Duration;\r\n-import java.util.ArrayDeque;\r\n import java.util.Collection;\r\n import java.util.Collections;\r\n import java.util.HashMap;\r\n import java.util.Map;\r\n import java.util.Properties;\r\n import java.util.Queue;\r\n-import java.util.concurrent.TimeUnit;\r\n+import java.util.concurrent.*;\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2MzA3OA=="}, "originalCommit": {"oid": "6eb71ab9327642699dcddf1f651569d40cdd4b59"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE2MzE4NQ==", "bodyText": "Yes, I will remove it . I am just on vocation now:)", "url": "https://github.com/odpi/egeria/pull/3572#discussion_r491163185", "createdAt": "2020-09-18T20:01:00Z", "author": {"login": "immmus"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "diffHunk": "@@ -3,14 +3,14 @@\n package org.odpi.openmetadata.adapters.eventbus.topic.kafka;\r\n \r\n import java.time.Duration;\r\n-import java.util.ArrayDeque;\r\n import java.util.Collection;\r\n import java.util.Collections;\r\n import java.util.HashMap;\r\n import java.util.Map;\r\n import java.util.Properties;\r\n import java.util.Queue;\r\n-import java.util.concurrent.TimeUnit;\r\n+import java.util.concurrent.*;\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2MzA3OA=="}, "originalCommit": {"oid": "6eb71ab9327642699dcddf1f651569d40cdd4b59"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjEyOTg0OnYy", "diffSide": "RIGHT", "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzo1Njo0M1rOHUORbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNDoxMzoyNFrOHUO7og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2NzQwNw==", "bodyText": "If the intention of this change is to modernise the code, then should these calls to currentTimeMillis() not be replaced with the more modern time classes, especially as duration is used below", "url": "https://github.com/odpi/egeria/pull/3572#discussion_r490967407", "createdAt": "2020-09-18T13:56:43Z", "author": {"login": "wbittles"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "diffHunk": "@@ -142,7 +141,7 @@ public void run()\n                 \r\n             \t//if we are close to the timeout, force a poll to avoid having the consumer\r\n             \t//be marked as dead because we have not polled often enough\r\n-            \tboolean pollRequired = System.currentTimeMillis() > maxNextPollTimestampToAvoidConsumerTimeout;\r\n+            \tfinal boolean pollRequired = System.currentTimeMillis() > maxNextPollTimestampToAvoidConsumerTimeout;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eb71ab9327642699dcddf1f651569d40cdd4b59"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk3ODIxMA==", "bodyText": "In this case it has no meaning)", "url": "https://github.com/odpi/egeria/pull/3572#discussion_r490978210", "createdAt": "2020-09-18T14:13:24Z", "author": {"login": "immmus"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "diffHunk": "@@ -142,7 +141,7 @@ public void run()\n                 \r\n             \t//if we are close to the timeout, force a poll to avoid having the consumer\r\n             \t//be marked as dead because we have not polled often enough\r\n-            \tboolean pollRequired = System.currentTimeMillis() > maxNextPollTimestampToAvoidConsumerTimeout;\r\n+            \tfinal boolean pollRequired = System.currentTimeMillis() > maxNextPollTimestampToAvoidConsumerTimeout;\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2NzQwNw=="}, "originalCommit": {"oid": "6eb71ab9327642699dcddf1f651569d40cdd4b59"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjE0NTAxOnYy", "diffSide": "LEFT", "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNDowMDoyOFrOHUObBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxNDoyNjoxOVrOHUPf-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2OTg2MA==", "bodyText": "If it's faster , do we still need this mapToCheck HashMap, it would be far more efficient not to actually make a copy.\nIt would be useful to understand any problem with locking the unprocessedEventQueues", "url": "https://github.com/odpi/egeria/pull/3572#discussion_r490969860", "createdAt": "2020-09-18T14:00:28Z", "author": {"login": "wbittles"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "diffHunk": "@@ -338,20 +334,10 @@ private boolean checkForFullyProcessedMessages() {\n         }\r\n         log.info(\"Checking for fully processed messages whose offsets need to be committed\");\r\n \r\n-        Map<TopicPartition, Queue<KafkaIncomingEvent>> mapToCheck = null;\r\n-        \r\n-        //Make a copy to minimize the amount of time we need to spent\r\n-        //holding a lock on the map.  If we do not synchronize here, a\r\n-        //concurrent modification exception will be thrown if an\r\n-        //attempt is made to update the map while we are iterating though it\r\n-        synchronized(unprocessedEventQueues) {\r\n-            mapToCheck = new HashMap<TopicPartition, Queue<KafkaIncomingEvent>>(unprocessedEventQueues);\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6eb71ab9327642699dcddf1f651569d40cdd4b59"}, "originalPosition": 137}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk4NzUxNQ==", "bodyText": "That's exactly that we don't need it, I deleted this code. And we also dont need this lock, in principle, when working atomic collections and therefore I removed it.", "url": "https://github.com/odpi/egeria/pull/3572#discussion_r490987515", "createdAt": "2020-09-18T14:26:19Z", "author": {"login": "immmus"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventConsumer.java", "diffHunk": "@@ -338,20 +334,10 @@ private boolean checkForFullyProcessedMessages() {\n         }\r\n         log.info(\"Checking for fully processed messages whose offsets need to be committed\");\r\n \r\n-        Map<TopicPartition, Queue<KafkaIncomingEvent>> mapToCheck = null;\r\n-        \r\n-        //Make a copy to minimize the amount of time we need to spent\r\n-        //holding a lock on the map.  If we do not synchronize here, a\r\n-        //concurrent modification exception will be thrown if an\r\n-        //attempt is made to update the map while we are iterating though it\r\n-        synchronized(unprocessedEventQueues) {\r\n-            mapToCheck = new HashMap<TopicPartition, Queue<KafkaIncomingEvent>>(unprocessedEventQueues);\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk2OTg2MA=="}, "originalCommit": {"oid": "6eb71ab9327642699dcddf1f651569d40cdd4b59"}, "originalPosition": 137}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2593, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}