{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MDA1Mjgy", "number": 3459, "title": "#3453 amendments to allow the Subject Area FVT to run with the Graph Repo", "bodyText": "", "createdAt": "2020-08-06T12:47:54Z", "url": "https://github.com/odpi/egeria/pull/3459", "merged": true, "mergeCommit": {"oid": "0ea8562aa9a1bd439e0df471cf0d7cb9d910ee45"}, "closed": true, "closedAt": "2020-08-11T15:20:31Z", "author": {"login": "davidradl"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8BqSdAH2gAyNDY0MDA1MjgyOjM3NzY5NjVkMWQ1NDA2ZmUzZTM3Yzg0NjY2N2VlN2ZiM2Q3NTg5ZTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc93dC7AH2gAyNDY0MDA1MjgyOjlmYzUxMDc0MjNiMWM3N2EwZjJmNGQ5MjY3MjgyOTU1YTlhYzg1NzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3776965d1d5406fe3e37c846667ee7fb3d7589e9", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/3776965d1d5406fe3e37c846667ee7fb3d7589e9", "committedDate": "2020-08-05T20:57:38Z", "message": "#3453 Include classification type on classifications supplied with term create\n\nSigned-off-by: David Radley <david_radley@uk.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7371e6b76e45818452a9c106cec620403bb3e7b", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/e7371e6b76e45818452a9c106cec620403bb3e7b", "committedDate": "2020-08-06T10:42:33Z", "message": "comment out TermFVT test\n\nSigned-off-by: David Radley <david_radley@uk.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cb1635d6439a5fad8ab464940da4c28fbdf0aea", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/5cb1635d6439a5fad8ab464940da4c28fbdf0aea", "committedDate": "2020-08-06T10:45:44Z", "message": "remove unwanted changes\n\nSigned-off-by: David Radley <david_radley@uk.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0e700b138020c534b949255960487f731173eba", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/c0e700b138020c534b949255960487f731173eba", "committedDate": "2020-08-06T10:47:35Z", "message": "prevent concurrent modification exception in graph repo during declassify entity\n\nSigned-off-by: David Radley <david_radley@uk.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9d8ac5b4851b82bc57c44363bc507300b412d0b", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/a9d8ac5b4851b82bc57c44363bc507300b412d0b", "committedDate": "2020-08-06T12:45:12Z", "message": "Self protect in the FVT if there is existing content\n\nSigned-off-by: David Radley <david_radley@uk.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d64f0afa6cc7a972f1465de245d870e0a5d10fc0", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/d64f0afa6cc7a972f1465de245d870e0a5d10fc0", "committedDate": "2020-08-06T12:50:38Z", "message": "Merge branch 'master' into git3453"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNTIzMTQw", "url": "https://github.com/odpi/egeria/pull/3459#pullrequestreview-462523140", "createdAt": "2020-08-06T13:34:31Z", "commit": {"oid": "d64f0afa6cc7a972f1465de245d870e0a5d10fc0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMzozNDozMVrOG8zw8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMzozNDozMVrOG8zw8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQxNTg1Ng==", "bodyText": "Could you use the RepositoryHelper's getSkeletonClassification method here instea? It looks like it could save quite a bit of this construction code.", "url": "https://github.com/odpi/egeria/pull/3459#discussion_r466415856", "createdAt": "2020-08-06T13:34:31Z", "author": {"login": "grahamwallis"}, "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/server/mappers/classifications/ClassificationMapper.java", "diffHunk": "@@ -106,10 +108,18 @@ public Classification mapBeanToOmrs(org.odpi.openmetadata.accessservices.subject\n          org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification omrsClassification = new org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification();\n          SubjectAreaUtils.populateSystemAttributesForInstanceAuditHeader(systemAttributes, omrsClassification);\n          // copy over the classification name\n-         omrsClassification.setName(omasClassification.getClassificationName());\n+         String classificationName = omasClassification.getClassificationName();\n+         omrsClassification.setName(classificationName);\n+         // copy over the classification type\n+         OpenMetadataTypesArchiveAccessor archiveAccessor = OpenMetadataTypesArchiveAccessor.getInstance();\n+         String classificationTypeGuid = archiveAccessor.getClassificationDefByName(classificationName).getGUID();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d64f0afa6cc7a972f1465de245d870e0a5d10fc0"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNTI4MDIw", "url": "https://github.com/odpi/egeria/pull/3459#pullrequestreview-462528020", "createdAt": "2020-08-06T13:39:53Z", "commit": {"oid": "d64f0afa6cc7a972f1465de245d870e0a5d10fc0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMzozOTo1M1rOG8z-sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMzozOTo1M1rOG8z-sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQxOTM3OA==", "bodyText": "I don't see why this helps. I may be missing something but I can't see what's wrong with removing the unwanted classification as soon as it is identified, i.e. within the loop.\nIf there's a good reason for this change, does it not also apply to the classifier edges that need to be removed?\nI'm not sure what behaviour occurred that prompted this change. Is it possible that there's a problem with the order of the remove operations?", "url": "https://github.com/odpi/egeria/pull/3459#discussion_r466419378", "createdAt": "2020-08-06T13:39:53Z", "author": {"login": "grahamwallis"}, "path": "open-metadata-implementation/adapters/open-connectors/repository-services-connectors/open-metadata-collection-store-connectors/graph-repository-connector/src/main/java/org/odpi/openmetadata/adapters/repositoryservices/graphrepository/repositoryconnector/GraphOMRSMetadataStore.java", "diffHunk": "@@ -1146,12 +1147,16 @@ private void updateEntityClassifications(EntitySummary entity, Vertex vertex, Gr\n                 log.debug(\"{} entity remove classification: {}\", methodName, existingName);\n                 Vertex classificationVertex = existingClassificationVerticesByName.get(existingName);\n                 classificationVertex.remove();\n-                existingClassificationVerticesByName.remove(existingName);\n+                namesToRemoveSet.add(existingName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d64f0afa6cc7a972f1465de245d870e0a5d10fc0"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNTI4ODQ0", "url": "https://github.com/odpi/egeria/pull/3459#pullrequestreview-462528844", "createdAt": "2020-08-06T13:40:48Z", "commit": {"oid": "d64f0afa6cc7a972f1465de245d870e0a5d10fc0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMzo0MDo0OFrOG80BOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMzo0MDo0OFrOG80BOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQyMDAyNw==", "bodyText": "Minor: string still contains a superfluous space.", "url": "https://github.com/odpi/egeria/pull/3459#discussion_r466420027", "createdAt": "2020-08-06T13:40:48Z", "author": {"login": "grahamwallis"}, "path": "open-metadata-test/open-metadata-fvt/access-services-fvt/subject-area-fvt/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/fvt/TermFVT.java", "diffHunk": "@@ -135,7 +135,7 @@ public void run() throws SubjectAreaFVTCheckedException, InvalidParameterExcepti\n             throw new SubjectAreaFVTCheckedException(\"ERROR: Governance actions retention not returned  as expected\");\n         }\n         if (!governanceActions.getCriticality().getLevel().equals(term3.getGovernanceActions().getCriticality().getLevel())) {\n-            throw new SubjectAreaFVTCheckedException(\"ERROR: Governance actions criticality not returned  as expected\");\n+            throw new SubjectAreaFVTCheckedException(\"ERROR: Governance actions criticality not returned  as expected. \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d64f0afa6cc7a972f1465de245d870e0a5d10fc0"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98aa506c7a6cc2eafb78e0c8762b904f03d79293", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/98aa506c7a6cc2eafb78e0c8762b904f03d79293", "committedDate": "2020-08-07T08:00:49Z", "message": "Merge branch 'master' into git3453"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMTE0MTc5", "url": "https://github.com/odpi/egeria/pull/3459#pullrequestreview-463114179", "createdAt": "2020-08-07T08:04:07Z", "commit": {"oid": "98aa506c7a6cc2eafb78e0c8762b904f03d79293"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb76b531ba671a87bd16a88dda90e7b7386055e1", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/eb76b531ba671a87bd16a88dda90e7b7386055e1", "committedDate": "2020-08-07T10:27:42Z", "message": "Merge branch 'master' into git3453"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0MDA1OTUx", "url": "https://github.com/odpi/egeria/pull/3459#pullrequestreview-464005951", "createdAt": "2020-08-10T07:27:07Z", "commit": {"oid": "eb76b531ba671a87bd16a88dda90e7b7386055e1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fc5107423b1c77a0f2f4d9267282955a9ac8572", "author": {"user": {"login": "davidradl", "name": "David Radley"}}, "url": "https://github.com/odpi/egeria/commit/9fc5107423b1c77a0f2f4d9267282955a9ac8572", "committedDate": "2020-08-11T14:11:58Z", "message": "Merge branch 'master' into git3453"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3921, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}