{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1NDQyMzQ2", "number": 3715, "title": "Adds registration constructor to Integraton and Solution View Service\u2026", "bodyText": "\u2026 Config classes and modifies createViewServiceConfig to create subclasses\nSigned-off-by: Graham Wallis graham_wallis@uk.ibm.com", "createdAt": "2020-09-30T11:30:43Z", "url": "https://github.com/odpi/egeria/pull/3715", "merged": true, "mergeCommit": {"oid": "861a67de1e479369c118bee0a87be08d0d46d723"}, "closed": true, "closedAt": "2020-09-30T13:05:59Z", "author": {"login": "grahamwallis"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdN7FHLAH2gAyNDk1NDQyMzQ2OmY0ODIxYTgzYjAzOGRkOThkMDQyMzNhOGIyOTU4OWI5NGMwZTc0MTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN7_70gFqTQ5OTM2OTcyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411", "author": {"user": {"login": "grahamwallis", "name": "Graham Wallis"}}, "url": "https://github.com/odpi/egeria/commit/f4821a83b038dd98d04233a8b29589b94c0e7411", "committedDate": "2020-09-30T11:28:14Z", "message": "Adds registration constructor to Integraton and Solution View Service Config classes and modifies createViewServiceConfig to create subclasses\n\nSigned-off-by: Graham Wallis <graham_wallis@uk.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MzY5NzI0", "url": "https://github.com/odpi/egeria/pull/3715#pullrequestreview-499369724", "createdAt": "2020-09-30T12:22:01Z", "commit": {"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMjoyMjowMlrOHaa2Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMjozMDozM1rOHabKMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NDkxMA==", "bodyText": "registration not description", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497464910", "createdAt": "2020-09-30T12:22:02Z", "author": {"login": "davidradl"}, "path": "open-metadata-implementation/admin-services/admin-services-api/src/main/java/org/odpi/openmetadata/adminservices/configuration/properties/IntegrationViewServiceConfig.java", "diffHunk": "@@ -49,6 +50,17 @@ public IntegrationViewServiceConfig(IntegrationViewServiceConfig template)\n         }\n     }\n \n+    /**\n+     * Call the superclass to set up the default values for a view service using a view service description.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NTE2MA==", "bodyText": "registration", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497465160", "createdAt": "2020-09-30T12:22:31Z", "author": {"login": "davidradl"}, "path": "open-metadata-implementation/admin-services/admin-services-api/src/main/java/org/odpi/openmetadata/adminservices/configuration/properties/SolutionViewServiceConfig.java", "diffHunk": "@@ -29,6 +31,17 @@ public SolutionViewServiceConfig(SolutionViewServiceConfig template)\n         /* There is nothing else to copy yet... */\n     }\n \n+    /**\n+     * Call the superclass to set up the default values for a view service using a view service description.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NjYyMA==", "bodyText": "I suggested in #3662 that we could have a type of the view service - that we could interrogate rather than using reflection.", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497466620", "createdAt": "2020-09-30T12:25:01Z", "author": {"login": "davidradl"}, "path": "open-metadata-implementation/admin-services/admin-services-server/src/main/java/org/odpi/openmetadata/adminservices/OMAGServerAdminForViewServices.java", "diffHunk": "@@ -313,11 +315,44 @@ public VoidResponse configureAllViewServices(String userId,\n     private ViewServiceConfig createViewServiceConfig(ViewServiceRegistration     registration,\n                                                       ViewServiceConfig           requestedViewServiceConfig)\n     {\n-        ViewServiceConfig viewServiceConfig = new ViewServiceConfig(registration);\n+\n+        ViewServiceConfig viewServiceConfig = null;\n+\n+        if (requestedViewServiceConfig instanceof IntegrationViewServiceConfig) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2NzcyMQ==", "bodyText": "this line and next line could be moved out of the ifs -as these fields exist in ViewServiceConfig. They can be removed from the integration service code as well.", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497467721", "createdAt": "2020-09-30T12:26:45Z", "author": {"login": "davidradl"}, "path": "open-metadata-implementation/admin-services/admin-services-server/src/main/java/org/odpi/openmetadata/adminservices/OMAGServerAdminForViewServices.java", "diffHunk": "@@ -313,11 +315,44 @@ public VoidResponse configureAllViewServices(String userId,\n     private ViewServiceConfig createViewServiceConfig(ViewServiceRegistration     registration,\n                                                       ViewServiceConfig           requestedViewServiceConfig)\n     {\n-        ViewServiceConfig viewServiceConfig = new ViewServiceConfig(registration);\n+\n+        ViewServiceConfig viewServiceConfig = null;\n+\n+        if (requestedViewServiceConfig instanceof IntegrationViewServiceConfig) {\n+            /*\n+             * The requested configuration is for an Integration View Service\n+             */\n+            IntegrationViewServiceConfig requestedIntegrationViewServiceConfig = (IntegrationViewServiceConfig)requestedViewServiceConfig;\n+            IntegrationViewServiceConfig createdViewServiceConfig = new IntegrationViewServiceConfig(registration);\n+            createdViewServiceConfig.setResourceEndpoints(requestedIntegrationViewServiceConfig.getResourceEndpoints());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else if (requestedViewServiceConfig instanceof SolutionViewServiceConfig) {\n+            /*\n+             * The requested configuration is for a Solution View Service\n+             */\n+            SolutionViewServiceConfig requestedSolutionViewServiceConfig = (SolutionViewServiceConfig)requestedViewServiceConfig;\n+            SolutionViewServiceConfig createdViewServiceConfig = new SolutionViewServiceConfig(registration);\n+            createdViewServiceConfig.setOMAGServerPlatformRootURL(requestedSolutionViewServiceConfig.getOMAGServerPlatformRootURL());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2Nzk0NA==", "bodyText": "I suggest we fail the request if we do not recognise the view service as one of the 2 types we support", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497467944", "createdAt": "2020-09-30T12:27:08Z", "author": {"login": "davidradl"}, "path": "open-metadata-implementation/admin-services/admin-services-server/src/main/java/org/odpi/openmetadata/adminservices/OMAGServerAdminForViewServices.java", "diffHunk": "@@ -313,11 +315,44 @@ public VoidResponse configureAllViewServices(String userId,\n     private ViewServiceConfig createViewServiceConfig(ViewServiceRegistration     registration,\n                                                       ViewServiceConfig           requestedViewServiceConfig)\n     {\n-        ViewServiceConfig viewServiceConfig = new ViewServiceConfig(registration);\n+\n+        ViewServiceConfig viewServiceConfig = null;\n+\n+        if (requestedViewServiceConfig instanceof IntegrationViewServiceConfig) {\n+            /*\n+             * The requested configuration is for an Integration View Service\n+             */\n+            IntegrationViewServiceConfig requestedIntegrationViewServiceConfig = (IntegrationViewServiceConfig)requestedViewServiceConfig;\n+            IntegrationViewServiceConfig createdViewServiceConfig = new IntegrationViewServiceConfig(registration);\n+            createdViewServiceConfig.setResourceEndpoints(requestedIntegrationViewServiceConfig.getResourceEndpoints());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else if (requestedViewServiceConfig instanceof SolutionViewServiceConfig) {\n+            /*\n+             * The requested configuration is for a Solution View Service\n+             */\n+            SolutionViewServiceConfig requestedSolutionViewServiceConfig = (SolutionViewServiceConfig)requestedViewServiceConfig;\n+            SolutionViewServiceConfig createdViewServiceConfig = new SolutionViewServiceConfig(registration);\n+            createdViewServiceConfig.setOMAGServerPlatformRootURL(requestedSolutionViewServiceConfig.getOMAGServerPlatformRootURL());\n+            createdViewServiceConfig.setOMAGServerName(requestedSolutionViewServiceConfig.getOMAGServerName());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else {\n+            /*\n+             * Assume that the requested configuration is a vanilla view service configuration", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3MDAwMg==", "bodyText": "why do we need to delete these lines - they should work where they are; unless I am missing something", "url": "https://github.com/odpi/egeria/pull/3715#discussion_r497470002", "createdAt": "2020-09-30T12:30:33Z", "author": {"login": "davidradl"}, "path": "open-metadata-implementation/admin-services/admin-services-server/src/main/java/org/odpi/openmetadata/adminservices/OMAGServerAdminForViewServices.java", "diffHunk": "@@ -313,11 +315,44 @@ public VoidResponse configureAllViewServices(String userId,\n     private ViewServiceConfig createViewServiceConfig(ViewServiceRegistration     registration,\n                                                       ViewServiceConfig           requestedViewServiceConfig)\n     {\n-        ViewServiceConfig viewServiceConfig = new ViewServiceConfig(registration);\n+\n+        ViewServiceConfig viewServiceConfig = null;\n+\n+        if (requestedViewServiceConfig instanceof IntegrationViewServiceConfig) {\n+            /*\n+             * The requested configuration is for an Integration View Service\n+             */\n+            IntegrationViewServiceConfig requestedIntegrationViewServiceConfig = (IntegrationViewServiceConfig)requestedViewServiceConfig;\n+            IntegrationViewServiceConfig createdViewServiceConfig = new IntegrationViewServiceConfig(registration);\n+            createdViewServiceConfig.setResourceEndpoints(requestedIntegrationViewServiceConfig.getResourceEndpoints());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else if (requestedViewServiceConfig instanceof SolutionViewServiceConfig) {\n+            /*\n+             * The requested configuration is for a Solution View Service\n+             */\n+            SolutionViewServiceConfig requestedSolutionViewServiceConfig = (SolutionViewServiceConfig)requestedViewServiceConfig;\n+            SolutionViewServiceConfig createdViewServiceConfig = new SolutionViewServiceConfig(registration);\n+            createdViewServiceConfig.setOMAGServerPlatformRootURL(requestedSolutionViewServiceConfig.getOMAGServerPlatformRootURL());\n+            createdViewServiceConfig.setOMAGServerName(requestedSolutionViewServiceConfig.getOMAGServerName());\n+            viewServiceConfig = (ViewServiceConfig) createdViewServiceConfig;\n+        }\n+        else {\n+            /*\n+             * Assume that the requested configuration is a vanilla view service configuration\n+             */\n+            ViewServiceConfig createdViewServiceConfig = new ViewServiceConfig(registration);\n+            createdViewServiceConfig.setOMAGServerPlatformRootURL(requestedViewServiceConfig.getOMAGServerPlatformRootURL());\n+            createdViewServiceConfig.setOMAGServerName(requestedViewServiceConfig.getOMAGServerName());\n+            viewServiceConfig = createdViewServiceConfig;\n+        }\n+\n+        /*\n+         * Always copy the view service options if any are present\n+         */\n         Map<String, Object> viewOptions = requestedViewServiceConfig.getViewServiceOptions();\n         viewServiceConfig.setViewServiceOptions(viewOptions);\n-        viewServiceConfig.setOMAGServerPlatformRootURL(requestedViewServiceConfig.getOMAGServerPlatformRootURL());\n-        viewServiceConfig.setOMAGServerName(requestedViewServiceConfig.getOMAGServerName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4821a83b038dd98d04233a8b29589b94c0e7411"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3911, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}