{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MDkwMDkx", "number": 2725, "title": "It infrastructure", "bodyText": "The change moves the control of the kafka producer lifecycle to inside a single method, now Producer are created when needed and closed on Error. I've also added more debug so we can track the lifecycle of the producer more closely.", "createdAt": "2020-03-10T11:55:23Z", "url": "https://github.com/odpi/egeria/pull/2725", "merged": true, "mergeCommit": {"oid": "a8ae304f2a3864f37845fc6295c80b0b0460eb99"}, "closed": true, "closedAt": "2020-03-11T18:26:17Z", "author": {"login": "wbittles"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMQal5AH2gAyMzg2MDkwMDkxOmY0OThhOWIxYjExNjczYmNjNDBmZmUwNDAwZjdkYWJiMGYzOWYzNGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMq5ggAH2gAyMzg2MDkwMDkxOjNlMDQxMDQ3YjQxN2RlMTA1OWJhMDg3OTlhMTBiZTMyZWI2ZjE4NTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f498a9b1b11673bcc40ffe0400f7dabb0f39f34a", "author": {"user": {"login": "wbittles", "name": "William Bittles"}}, "url": "https://github.com/odpi/egeria/commit/f498a9b1b11673bcc40ffe0400f7dabb0f39f34a", "committedDate": "2020-03-10T11:00:42Z", "message": "Changes to kafka producer lifecycle and debug logging\n\nSigned-off-by: William Bittles <wbittles@uk.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f058d25bf77acccd4e9c4618c6c4016f8f1a7fe", "author": {"user": {"login": "wbittles", "name": "William Bittles"}}, "url": "https://github.com/odpi/egeria/commit/0f058d25bf77acccd4e9c4618c6c4016f8f1a7fe", "committedDate": "2020-03-10T11:44:59Z", "message": "merge conflicts\n\nSigned-off-by: William Bittles <wbittles@uk.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxOTQxNTE2", "url": "https://github.com/odpi/egeria/pull/2725#pullrequestreview-371941516", "createdAt": "2020-03-10T13:19:34Z", "commit": {"oid": "0f058d25bf77acccd4e9c4618c6c4016f8f1a7fe"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxMzoxOTozNFrOF0OYPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxMzoyMjo1NVrOF0OgNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMwNTg1Mw==", "bodyText": "Do we need this file?  I would have expected that we would let Git manage the change history for us, rather than having .orig files scattered around (?)", "url": "https://github.com/odpi/egeria/pull/2725#discussion_r390305853", "createdAt": "2020-03-10T13:19:34Z", "author": {"login": "cmgrote"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventProducer.java.orig", "diffHunk": "@@ -0,0 +1,548 @@\n+/* SPDX-License-Identifier: Apache 2.0 */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f058d25bf77acccd4e9c4618c6c4016f8f1a7fe"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMwNjY3MQ==", "bodyText": "Formatting isn't following the convention already present in the code:\nif (producer == null)\n{\n   // ...\n}", "url": "https://github.com/odpi/egeria/pull/2725#discussion_r390306671", "createdAt": "2020-03-10T13:20:53Z", "author": {"login": "cmgrote"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventProducer.java", "diffHunk": "@@ -99,6 +100,10 @@ private void publishEvent(String event) throws ConnectorCheckedException\n         boolean                  eventSent = false;\n         long                     eventRetryCount = 0;\n \n+        if( producer == null){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f058d25bf77acccd4e9c4618c6c4016f8f1a7fe"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMwNzg5Mg==", "bodyText": "I don't think we need to log an error here given that we're throwing an exception in the lines immediately following?", "url": "https://github.com/odpi/egeria/pull/2725#discussion_r390307892", "createdAt": "2020-03-10T13:22:55Z", "author": {"login": "cmgrote"}, "path": "open-metadata-implementation/adapters/open-connectors/event-bus-connectors/open-metadata-topic-connectors/kafka-open-metadata-topic-connector/src/main/java/org/odpi/openmetadata/adapters/eventbus/topic/kafka/KafkaOpenMetadataEventProducer.java", "diffHunk": "@@ -119,7 +124,11 @@ private void publishEvent(String event) throws ConnectorCheckedException\n                 if( !isExceptionRetryable(error)) {\n                     /* kafka thinks this isn't a retryable problem */\n                     /* so let the caller try */\n-                    log.error(\"Exception in sendEvent \" + error.toString());\n+\n+                    producer.close();\n+                    producer = null;\n+\n+                    log.error(\"Execution Exception closed producer \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f058d25bf77acccd4e9c4618c6c4016f8f1a7fe"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fa14b90ac59b6a449c65d218c5b124f809018df", "author": {"user": {"login": "wbittles", "name": "William Bittles"}}, "url": "https://github.com/odpi/egeria/commit/4fa14b90ac59b6a449c65d218c5b124f809018df", "committedDate": "2020-03-10T14:27:00Z", "message": "Addressing review comments by cmgrote\n\nSigned-off-by: William Bittles <wbittles@uk.ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMDYxNDI3", "url": "https://github.com/odpi/egeria/pull/2725#pullrequestreview-372061427", "createdAt": "2020-03-10T15:27:11Z", "commit": {"oid": "4fa14b90ac59b6a449c65d218c5b124f809018df"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMTg2MTU0", "url": "https://github.com/odpi/egeria/pull/2725#pullrequestreview-372186154", "createdAt": "2020-03-10T17:49:19Z", "commit": {"oid": "4fa14b90ac59b6a449c65d218c5b124f809018df"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4bcb5ecee79ee4748b72611a21fd2ab2ddc1cf7", "author": {"user": {"login": "wbittles", "name": "William Bittles"}}, "url": "https://github.com/odpi/egeria/commit/c4bcb5ecee79ee4748b72611a21fd2ab2ddc1cf7", "committedDate": "2020-03-11T17:07:39Z", "message": "cleaning up if statements\n\nSigned-off-by: William Bittles <wbittles@uk.ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e041047b417de1059ba08799a10be32eb6f1851", "author": {"user": {"login": "cmgrote", "name": "Christopher Grote"}}, "url": "https://github.com/odpi/egeria/commit/3e041047b417de1059ba08799a10be32eb6f1851", "committedDate": "2020-03-11T17:52:00Z", "message": "Merge branch 'master' into it-infrastructure"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3742, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}