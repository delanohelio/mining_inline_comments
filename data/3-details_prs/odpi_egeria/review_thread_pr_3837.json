{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwMDIyOTQ3", "number": 3837, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoxODozOFrOEsXiBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoyOToyMVrOEsXlSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0OTU4MzQzOnYy", "diffSide": "RIGHT", "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/handlers/SubjectAreaTermHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoxODozOFrOHfmTMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoxODozOFrOHfmTMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg5NTQxMQ==", "bodyText": "Could you split all of this big logic on a few methods? Otherwise this method is very big and hard to read", "url": "https://github.com/odpi/egeria/pull/3837#discussion_r502895411", "createdAt": "2020-10-11T10:18:38Z", "author": {"login": "immmus"}, "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/handlers/SubjectAreaTermHandler.java", "diffHunk": "@@ -295,17 +387,60 @@ private void setGlossary(String userId, Term term, String methodName) throws Sub\n                             oMRSAPIHelper.callOMRSDeClassifyEntity(methodName, userId, guid, deClassifyName);\n                         }\n                     }\n+\n+                    List<CategorySummary> suppliedCategories = suppliedTerm.getCategories();\n+                    if (suppliedCategories==null && !isReplace) {\n+                        // in the update case with null categories supplied then do not change anything.\n+                    } else {\n+                        Set<String> deleteCategorizationGuidSet = new HashSet<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c707911e06d7b2721627d862c1017c0708a1a09e"}, "originalPosition": 239}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0OTU4NDMxOnYy", "diffSide": "RIGHT", "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/handlers/SubjectAreaTermHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoxOTo0M1rOHfmTow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoxOTo0M1rOHfmTow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg5NTUyMw==", "bodyText": "Please make these fields to final.", "url": "https://github.com/odpi/egeria/pull/3837#discussion_r502895523", "createdAt": "2020-10-11T10:19:43Z", "author": {"login": "immmus"}, "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/handlers/SubjectAreaTermHandler.java", "diffHunk": "@@ -38,6 +40,9 @@\n  */\n public class SubjectAreaTermHandler extends SubjectAreaHandler {\n     private static final String className = SubjectAreaTermHandler.class.getName();\n+    private TermAnchorMapper termAnchorMapper;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c707911e06d7b2721627d862c1017c0708a1a09e"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0OTU4NTg2OnYy", "diffSide": "RIGHT", "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/handlers/SubjectAreaTermHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoyMToyOFrOHfmUZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoyMToyOFrOHfmUZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg5NTcxOA==", "bodyText": "Please move this logic to another method.", "url": "https://github.com/odpi/egeria/pull/3837#discussion_r502895718", "createdAt": "2020-10-11T10:21:28Z", "author": {"login": "immmus"}, "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/handlers/SubjectAreaTermHandler.java", "diffHunk": "@@ -95,17 +104,34 @@ public SubjectAreaTermHandler(OMRSAPIHelper oMRSAPIHelper) {\n                 TermMapper termMapper = mappersFactory.get(TermMapper.class);\n                 EntityDetail termEntityDetail = termMapper.map(suppliedTerm);\n                 GlossarySummary suppliedGlossary = suppliedTerm.getGlossary();\n+                List<CategorySummary> suppliedCategorysummaries = suppliedTerm.getCategories();\n \n                 String glossaryGuid = validateGlossarySummaryDuringCreation(userId, methodName, suppliedGlossary);\n+                validateCategoriesDuringCreation(userId,methodName,suppliedCategorysummaries);\n                 createdTermGuid = oMRSAPIHelper.callOMRSAddEntity(methodName, userId, termEntityDetail);\n                 if (createdTermGuid != null) {\n                     TermAnchor termAnchor = new TermAnchor();\n                     termAnchor.getEnd1().setNodeGuid(glossaryGuid);\n                     termAnchor.getEnd2().setNodeGuid(createdTermGuid);\n-                    TermAnchorMapper termAnchorMapper = mappersFactory.get(TermAnchorMapper.class);\n+\n                     Relationship relationship = termAnchorMapper.map(termAnchor);\n                     oMRSAPIHelper.callOMRSAddRelationship(methodName, userId, relationship);\n                     response = getTermByGuid(userId, createdTermGuid);\n+                    if (response.getRelatedHTTPCode() == 200) {\n+                        if (suppliedCategorysummaries != null && suppliedCategorysummaries.size() >0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c707911e06d7b2721627d862c1017c0708a1a09e"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0OTU5MTc2OnYy", "diffSide": "RIGHT", "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/utilities/SubjectAreaUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxMDoyOToyMVrOHfmXgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwODozMDoxOFrOHf0VeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg5NjUxNQ==", "bodyText": "This method is not used. Please remove it.", "url": "https://github.com/odpi/egeria/pull/3837#discussion_r502896515", "createdAt": "2020-10-11T10:29:21Z", "author": {"login": "immmus"}, "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/utilities/SubjectAreaUtils.java", "diffHunk": "@@ -151,6 +151,19 @@ public static GlossarySummary extractGlossarySummaryFromGlossary(Glossary glossa\n         extractNodeSummary(glossary, line, glossarySummary);\n         return glossarySummary;\n     }\n+    /**\n+     * Extract category Summary\n+     *\n+     * @param category the category that is to be summarised\n+     * @param line     the line to the category, which feeds part of the node summary\n+     * @return Category Summary or null\n+     */\n+    public static CategorySummary extractGlossarySummaryFromGlossary(Category category, Line line) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c707911e06d7b2721627d862c1017c0708a1a09e"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEyNTM2OQ==", "bodyText": "Removed.", "url": "https://github.com/odpi/egeria/pull/3837#discussion_r503125369", "createdAt": "2020-10-12T08:30:18Z", "author": {"login": "davidradl"}, "path": "open-metadata-implementation/access-services/subject-area/subject-area-server/src/main/java/org/odpi/openmetadata/accessservices/subjectarea/utilities/SubjectAreaUtils.java", "diffHunk": "@@ -151,6 +151,19 @@ public static GlossarySummary extractGlossarySummaryFromGlossary(Glossary glossa\n         extractNodeSummary(glossary, line, glossarySummary);\n         return glossarySummary;\n     }\n+    /**\n+     * Extract category Summary\n+     *\n+     * @param category the category that is to be summarised\n+     * @param line     the line to the category, which feeds part of the node summary\n+     * @return Category Summary or null\n+     */\n+    public static CategorySummary extractGlossarySummaryFromGlossary(Category category, Line line) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg5NjUxNQ=="}, "originalCommit": {"oid": "c707911e06d7b2721627d862c1017c0708a1a09e"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2515, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}