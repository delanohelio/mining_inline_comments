{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxMTk3NDEx", "number": 1433, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQwNjo0MTo1MVrOEJjhyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQwNjo0MTo1MVrOEJjhyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc4NDU0NzMwOnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/apache/iotdb/db/qp/physical/crud/InsertPlan.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQwNjo0MTo1MVrOGqGvhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNjowODo1MlrOGqX_4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjgwMzg0NQ==", "bodyText": "maybe you should use \"markFailedMeasurementInsertion\"", "url": "https://github.com/apache/iotdb/pull/1433#discussion_r446803845", "createdAt": "2020-06-29T06:41:51Z", "author": {"login": "SilverNarcissus"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/physical/crud/InsertPlan.java", "diffHunk": "@@ -369,97 +81,16 @@ public int getFailedMeasurementNumber() {\n     return failedMeasurements == null ? 0 : failedMeasurements.size();\n   }\n \n-  public TSDataType[] getTypes() {\n-    return types;\n-  }\n-\n-  public void setTypes(TSDataType[] types) {\n-    this.types = types;\n-  }\n-\n-  public void setValues(ByteBuffer buffer) throws QueryProcessException {\n-    for (int i = 0; i < measurements.length; i++) {\n-      types[i] = ReadWriteIOUtils.readDataType(buffer);\n-      switch (types[i]) {\n-        case BOOLEAN:\n-          values[i] = ReadWriteIOUtils.readBool(buffer);\n-          break;\n-        case INT32:\n-          values[i] = ReadWriteIOUtils.readInt(buffer);\n-          break;\n-        case INT64:\n-          values[i] = ReadWriteIOUtils.readLong(buffer);\n-          break;\n-        case FLOAT:\n-          values[i] = ReadWriteIOUtils.readFloat(buffer);\n-          break;\n-        case DOUBLE:\n-          values[i] = ReadWriteIOUtils.readDouble(buffer);\n-          break;\n-        case TEXT:\n-          values[i] = ReadWriteIOUtils.readBinary(buffer);\n-          break;\n-        default:\n-          throw new QueryProcessException(\"Unsupported data type:\" + types[i]);\n-      }\n-    }\n-  }\n-\n-  @Override\n-  public void serialize(ByteBuffer buffer) {\n-    int type = PhysicalPlanType.INSERT.ordinal();\n-    buffer.put((byte) type);\n-    buffer.putLong(time);\n-\n-    putString(buffer, deviceId);\n-\n-    buffer.putInt(measurements.length - (failedMeasurements == null ? 0 : failedMeasurements.size()));\n-\n-    for (String measurement : measurements) {\n-      if (measurement != null) {\n-        putString(buffer, measurement);\n-      }\n-    }\n-\n-    try {\n-      putValues(buffer);\n-    } catch (QueryProcessException e) {\n-      e.printStackTrace();\n-    }\n-  }\n-\n-  @Override\n-  public void deserialize(ByteBuffer buffer) {\n-    this.time = buffer.getLong();\n-    this.deviceId = readString(buffer);\n-\n-    int measurementSize = buffer.getInt();\n-\n-    this.measurements = new String[measurementSize];\n-    for (int i = 0; i < measurementSize; i++) {\n-      measurements[i] = readString(buffer);\n-    }\n-\n-    this.types = new TSDataType[measurementSize];\n-    this.values = new Object[measurementSize];\n-    try {\n-      setValues(buffer);\n-    } catch (QueryProcessException e) {\n-      e.printStackTrace();\n+  /**\n+   * @param index failed measurement index\n+   */\n+  public void markMeasurementInsertionFailed(int index) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb3efa85fec76531e99051ef1f61131227f4660d"}, "originalPosition": 448}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA4NjU2MQ==", "bodyText": "OK~", "url": "https://github.com/apache/iotdb/pull/1433#discussion_r447086561", "createdAt": "2020-06-29T16:08:52Z", "author": {"login": "LebronAl"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/physical/crud/InsertPlan.java", "diffHunk": "@@ -369,97 +81,16 @@ public int getFailedMeasurementNumber() {\n     return failedMeasurements == null ? 0 : failedMeasurements.size();\n   }\n \n-  public TSDataType[] getTypes() {\n-    return types;\n-  }\n-\n-  public void setTypes(TSDataType[] types) {\n-    this.types = types;\n-  }\n-\n-  public void setValues(ByteBuffer buffer) throws QueryProcessException {\n-    for (int i = 0; i < measurements.length; i++) {\n-      types[i] = ReadWriteIOUtils.readDataType(buffer);\n-      switch (types[i]) {\n-        case BOOLEAN:\n-          values[i] = ReadWriteIOUtils.readBool(buffer);\n-          break;\n-        case INT32:\n-          values[i] = ReadWriteIOUtils.readInt(buffer);\n-          break;\n-        case INT64:\n-          values[i] = ReadWriteIOUtils.readLong(buffer);\n-          break;\n-        case FLOAT:\n-          values[i] = ReadWriteIOUtils.readFloat(buffer);\n-          break;\n-        case DOUBLE:\n-          values[i] = ReadWriteIOUtils.readDouble(buffer);\n-          break;\n-        case TEXT:\n-          values[i] = ReadWriteIOUtils.readBinary(buffer);\n-          break;\n-        default:\n-          throw new QueryProcessException(\"Unsupported data type:\" + types[i]);\n-      }\n-    }\n-  }\n-\n-  @Override\n-  public void serialize(ByteBuffer buffer) {\n-    int type = PhysicalPlanType.INSERT.ordinal();\n-    buffer.put((byte) type);\n-    buffer.putLong(time);\n-\n-    putString(buffer, deviceId);\n-\n-    buffer.putInt(measurements.length - (failedMeasurements == null ? 0 : failedMeasurements.size()));\n-\n-    for (String measurement : measurements) {\n-      if (measurement != null) {\n-        putString(buffer, measurement);\n-      }\n-    }\n-\n-    try {\n-      putValues(buffer);\n-    } catch (QueryProcessException e) {\n-      e.printStackTrace();\n-    }\n-  }\n-\n-  @Override\n-  public void deserialize(ByteBuffer buffer) {\n-    this.time = buffer.getLong();\n-    this.deviceId = readString(buffer);\n-\n-    int measurementSize = buffer.getInt();\n-\n-    this.measurements = new String[measurementSize];\n-    for (int i = 0; i < measurementSize; i++) {\n-      measurements[i] = readString(buffer);\n-    }\n-\n-    this.types = new TSDataType[measurementSize];\n-    this.values = new Object[measurementSize];\n-    try {\n-      setValues(buffer);\n-    } catch (QueryProcessException e) {\n-      e.printStackTrace();\n+  /**\n+   * @param index failed measurement index\n+   */\n+  public void markMeasurementInsertionFailed(int index) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjgwMzg0NQ=="}, "originalCommit": {"oid": "eb3efa85fec76531e99051ef1f61131227f4660d"}, "originalPosition": 448}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4839, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}