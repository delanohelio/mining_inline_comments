{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2NDIwODk0", "number": 1836, "title": "[IOTDB-948] Use binary search when checking the follower's match index when catchup\t", "bodyText": "Now, when the follower lags behind the leader a lot, one catchup task will be triggered. When catchup, it will judge whether a certain log saved in the leader's memory is consistent with the follower. If so, the leader can use logs in its memory to catch up. If the leader cannot find a log in memory that matches the follower, the leader needs to send snapshots.\nWhen checking whether the leader's log match with the follower's, the current implementation starts from the largest index of the stored log in memory, and traverses from large to small to see whether it is consistent with the follower. However, each traversal will send one RPC. Since the maximum number of logs in memory is 1000, there may be 1000 times of RPC, and the time is O( n ). If it becomes a binary search, it only needs O(log n), and 1000 logs only need 10 RPC communications, it'll save communication cost.", "createdAt": "2020-10-20T02:54:17Z", "url": "https://github.com/apache/iotdb/pull/1836", "merged": true, "mergeCommit": {"oid": "8b75116aeaa97098fc1e0834eafd77b8fbd6ceec"}, "closed": true, "closedAt": "2020-10-27T01:31:06Z", "author": {"login": "neuyilan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUWhsVABqjM4OTc5OTIxMDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVUYMFAFqTUxNTU1Nzk1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b3a11744d5a8d3fc3ff778a8a8b8efd2b568b0ae", "author": {"user": {"login": "neuyilan", "name": "Houliang Qi"}}, "url": "https://github.com/apache/iotdb/commit/b3a11744d5a8d3fc3ff778a8a8b8efd2b568b0ae", "committedDate": "2020-10-20T06:44:40Z", "message": "fix IT bug"}, "afterCommit": {"oid": "a40db06b7e9ed78c48037bf6b2e98f6959f14d3d", "author": {"user": {"login": "neuyilan", "name": "Houliang Qi"}}, "url": "https://github.com/apache/iotdb/commit/a40db06b7e9ed78c48037bf6b2e98f6959f14d3d", "committedDate": "2020-10-20T10:49:57Z", "message": "fix IT bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MjMxNzI0", "url": "https://github.com/apache/iotdb/pull/1836#pullrequestreview-515231724", "createdAt": "2020-10-23T02:09:05Z", "commit": {"oid": "a40db06b7e9ed78c48037bf6b2e98f6959f14d3d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwMjowOTowNVrOHm5z4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwMjowOTowNVrOHm5z4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU1NTEwNA==", "bodyText": "Could you please explain this?", "url": "https://github.com/apache/iotdb/pull/1836#discussion_r510555104", "createdAt": "2020-10-23T02:09:05Z", "author": {"login": "jt2594838"}, "path": "server/src/main/java/org/apache/iotdb/db/service/TSServiceImpl.java", "diffHunk": "@@ -1691,7 +1693,7 @@ protected TSStatus executeNonQueryPlan(PhysicalPlan plan) {\n     } catch (QueryProcessException e) {\n       logger.error(\"meet error while processing non-query. \", e);\n       Throwable cause = e;\n-      while (cause.getCause() != null){\n+      while (cause.getCause() != null && cause.getCause().getCause() != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a40db06b7e9ed78c48037bf6b2e98f6959f14d3d"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c4de8d7fbe532141f2fc4319dfd6eaa09995211", "author": {"user": {"login": "neuyilan", "name": "Houliang Qi"}}, "url": "https://github.com/apache/iotdb/commit/3c4de8d7fbe532141f2fc4319dfd6eaa09995211", "committedDate": "2020-10-23T05:38:55Z", "message": "use binary search when check the matched index when snapshot"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab84384c6d00cf6330973a789f90b960259ae753", "author": {"user": {"login": "neuyilan", "name": "Houliang Qi"}}, "url": "https://github.com/apache/iotdb/commit/ab84384c6d00cf6330973a789f90b960259ae753", "committedDate": "2020-10-23T05:48:43Z", "message": "fix conflict"}, "afterCommit": {"oid": "3c4de8d7fbe532141f2fc4319dfd6eaa09995211", "author": {"user": {"login": "neuyilan", "name": "Houliang Qi"}}, "url": "https://github.com/apache/iotdb/commit/3c4de8d7fbe532141f2fc4319dfd6eaa09995211", "committedDate": "2020-10-23T05:38:55Z", "message": "use binary search when check the matched index when snapshot"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1NTU3OTUy", "url": "https://github.com/apache/iotdb/pull/1836#pullrequestreview-515557952", "createdAt": "2020-10-23T10:54:10Z", "commit": {"oid": "3c4de8d7fbe532141f2fc4319dfd6eaa09995211"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3706, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}