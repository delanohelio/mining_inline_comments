{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1MjIyMzA1", "number": 1783, "title": "[IOTDB-943]  Fix cpu usage too high by removing unnecessary lock in MManager", "bodyText": "There is an unnecessary lock in MManager. I have removed this in this PR.", "createdAt": "2020-09-30T03:07:16Z", "url": "https://github.com/apache/iotdb/pull/1783", "merged": true, "mergeCommit": {"oid": "df8f876a0172b48f38f96f94319ed9e2ec2bfd7b"}, "closed": true, "closedAt": "2020-10-08T07:18:31Z", "author": {"login": "SilverNarcissus"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNz48AAH2gAyNDk1MjIyMzA1OmJjNDk0MDcwNzgyNmZhZDY3NzUyOWQ0YzI4NmZkMWMxZjgzY2JiNTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQb7NcAH2gAyNDk1MjIyMzA1OmNmMmM5YmNkZTYwMDI2ZTM3OTdjOWZkZWNhZGY5ZjQ2ZGEzYTZmOTY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bc4940707826fad677529d4c286fd1c1f83cbb51", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/bc4940707826fad677529d4c286fd1c1f83cbb51", "committedDate": "2020-09-30T03:05:36Z", "message": "remove unnecessary lock"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58e4037a6006cbe00b644203cfd91dbd7b6c2fc2", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/58e4037a6006cbe00b644203cfd91dbd7b6c2fc2", "committedDate": "2020-09-30T03:06:50Z", "message": "format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f5f010b02fd554c6ba6dd06cdbcf82ff884dde6", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/1f5f010b02fd554c6ba6dd06cdbcf82ff884dde6", "committedDate": "2020-09-30T03:08:38Z", "message": "format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4afd1c6d35e82c73493faeb4ae1e1ce7988d7d5f", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/4afd1c6d35e82c73493faeb4ae1e1ce7988d7d5f", "committedDate": "2020-09-30T13:38:13Z", "message": "remove lock in both MManager and MNode, use concurrent hash map to sync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4459b7da3ea6ffd536a14061fd099ef1e570a92", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/e4459b7da3ea6ffd536a14061fd099ef1e570a92", "committedDate": "2020-10-01T01:35:47Z", "message": "add comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38f27ecc17dc10ef6c8a5d81caf78f519ca10cde", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/38f27ecc17dc10ef6c8a5d81caf78f519ca10cde", "committedDate": "2020-10-03T18:38:07Z", "message": "fix tests in IoTDBAlignByDeviceIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17bb6b5293b96c8a104f9f32f22e98382dc0fd6c", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/17bb6b5293b96c8a104f9f32f22e98382dc0fd6c", "committedDate": "2020-10-03T18:56:29Z", "message": "fix tests in TTLTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f76ee4657ffac635a541375765940b9cbe91cd13", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/f76ee4657ffac635a541375765940b9cbe91cd13", "committedDate": "2020-10-03T19:42:53Z", "message": "fix tests in IoTDBCreateSnapshotIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "295ccfa00272505e73b28e65f6da823cf7872c4a", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/295ccfa00272505e73b28e65f6da823cf7872c4a", "committedDate": "2020-10-03T20:27:59Z", "message": "fix tests in IoTDBQueryDemoIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84d00c5700cbae9d1d642c556035cf31825b8140", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/84d00c5700cbae9d1d642c556035cf31825b8140", "committedDate": "2020-10-03T20:47:02Z", "message": "fix tests in IoTDBLastIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f175ed403451e2bff10fb5712a8cd21b8e3436b", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/3f175ed403451e2bff10fb5712a8cd21b8e3436b", "committedDate": "2020-10-04T06:07:58Z", "message": "fix loadTsFileTestWithAutoCreateSchema in IoTDBLoadExternalTsfileIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc2683b96b1cbf104b0c808b105a7d5184474452", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/fc2683b96b1cbf104b0c808b105a7d5184474452", "committedDate": "2020-10-04T06:22:01Z", "message": "fix testShowTimeseriesWithLimitOffset in IoTDBSimpleQueryIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcf492b2d138f196fd5a33b5dca0ee2abcb6b9ea", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/fcf492b2d138f196fd5a33b5dca0ee2abcb6b9ea", "committedDate": "2020-10-04T07:35:25Z", "message": "fix tests in IoTDBMetadataFetchIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "308eea1beaa0bd64bd693cc26b6575f0b3d7564d", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/308eea1beaa0bd64bd693cc26b6575f0b3d7564d", "committedDate": "2020-10-04T07:47:02Z", "message": "fix tests in IoTDBTtlIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "199a8a1ddbe5dcc16a5023d492fc7cb402558746", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/199a8a1ddbe5dcc16a5023d492fc7cb402558746", "committedDate": "2020-10-04T08:23:35Z", "message": "fix tests in IoTDBTagIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "600f5528fff0383985267791a6ba8d9db84706f9", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/600f5528fff0383985267791a6ba8d9db84706f9", "committedDate": "2020-10-04T08:59:37Z", "message": "fix tests in IoTDBSortedShowTimeseriesIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1516d4bab7b1a2407e47d47909e6474c916e4909", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/1516d4bab7b1a2407e47d47909e6474c916e4909", "committedDate": "2020-10-04T10:47:58Z", "message": "fix tests in IoTDBDisableAlignIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d18a587ebfe55ac3894952853d386074e63eb63e", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/d18a587ebfe55ac3894952853d386074e63eb63e", "committedDate": "2020-10-04T11:43:43Z", "message": "improve code style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24366254f1f188c82cffb3d2400df03cb515083b", "author": {"user": {"login": "SteveYurongSu", "name": "Steve Yurong Su"}}, "url": "https://github.com/apache/iotdb/commit/24366254f1f188c82cffb3d2400df03cb515083b", "committedDate": "2020-10-04T13:17:17Z", "message": "fix all tests in session"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebadece8bf4b9c5c488d0b49a811a0cc51af7811", "author": {"user": {"login": "JackieTien97", "name": "Jackie Tien"}}, "url": "https://github.com/apache/iotdb/commit/ebadece8bf4b9c5c488d0b49a811a0cc51af7811", "committedDate": "2020-10-05T01:17:48Z", "message": "Merge pull request #1794 from SteveYurongSu/KF\n\nFix tests after removing locks from MManager and MNode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNjM5NTMw", "url": "https://github.com/apache/iotdb/pull/1783#pullrequestreview-502639530", "createdAt": "2020-10-06T07:07:43Z", "commit": {"oid": "ebadece8bf4b9c5c488d0b49a811a0cc51af7811"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwNzowNzo0M1rOHc4pqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwNzoxODoxMVrOHc49fQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA1MDM0Ng==", "bodyText": "If there is no read lock anymore, what about change the method name to getDeviceNodeWithAutoCreate?", "url": "https://github.com/apache/iotdb/pull/1783#discussion_r500050346", "createdAt": "2020-10-06T07:07:43Z", "author": {"login": "HTHou"}, "path": "server/src/main/java/org/apache/iotdb/db/metadata/MManager.java", "diffHunk": "@@ -1121,7 +970,6 @@ public StorageGroupMNode getStorageGroupNodeByPath(PartialPath path) throws Meta\n    */\n   public MNode getDeviceNodeWithAutoCreateAndReadLock(\n       PartialPath path, boolean autoCreateSchema, int sgLevel) throws MetadataException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebadece8bf4b9c5c488d0b49a811a0cc51af7811"}, "originalPosition": 795}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDA1NTQyMQ==", "bodyText": "Remove it?", "url": "https://github.com/apache/iotdb/pull/1783#discussion_r500055421", "createdAt": "2020-10-06T07:18:11Z", "author": {"login": "HTHou"}, "path": "server/src/main/java/org/apache/iotdb/db/metadata/MManager.java", "diffHunk": "@@ -1205,25 +1039,16 @@ public String getDeviceId(PartialPath path) {\n     return device;\n   }\n \n+  // concurrent warning: you should get parent read lock before calling this method", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebadece8bf4b9c5c488d0b49a811a0cc51af7811"}, "originalPosition": 847}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74c4aa42341e63aa02e4378647d5c8e1fcb87169", "author": {"user": {"login": "HTHou", "name": "Haonan"}}, "url": "https://github.com/apache/iotdb/commit/74c4aa42341e63aa02e4378647d5c8e1fcb87169", "committedDate": "2020-10-07T07:59:53Z", "message": "Merge branch 'master' into KF"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c04354ff0f0a6e9d40395b4b2aa7cf734d9d671a", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/c04354ff0f0a6e9d40395b4b2aa7cf734d9d671a", "committedDate": "2020-10-07T08:28:30Z", "message": "Merge branch 'master' of https://github.com/apache/incubator-iotdb into KF\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/qp/executor/PlanExecutor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb16327cc225d15d4fb27831afe63956d2ebb404", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/fb16327cc225d15d4fb27831afe63956d2ebb404", "committedDate": "2020-10-07T08:39:25Z", "message": "Merge branch 'KF' of https://github.com/apache/incubator-iotdb into KF\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/qp/executor/PlanExecutor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d96a7b278861dca60e87947daf51f529a2770ed7", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/d96a7b278861dca60e87947daf51f529a2770ed7", "committedDate": "2020-10-08T03:08:46Z", "message": "fix bug and add comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1380343ede85d68c357e79ac405a01b7e66243ca", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/1380343ede85d68c357e79ac405a01b7e66243ca", "committedDate": "2020-10-08T03:19:31Z", "message": "fix smell"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9af4c40362ebadf58dca5b491455886fd218ed6", "author": {"user": {"login": "qiaojialin", "name": "Jialin Qiao"}}, "url": "https://github.com/apache/iotdb/commit/a9af4c40362ebadf58dca5b491455886fd218ed6", "committedDate": "2020-10-08T04:09:47Z", "message": "fix review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e942a5476ae008eb89411e6e6260f821c6ebf477", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/e942a5476ae008eb89411e6e6260f821c6ebf477", "committedDate": "2020-10-08T06:29:24Z", "message": "fix smell"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDY0Nzc3", "url": "https://github.com/apache/iotdb/pull/1783#pullrequestreview-504464777", "createdAt": "2020-10-08T06:33:57Z", "commit": {"oid": "a9af4c40362ebadf58dca5b491455886fd218ed6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDcwMDAz", "url": "https://github.com/apache/iotdb/pull/1783#pullrequestreview-504470003", "createdAt": "2020-10-08T06:44:05Z", "commit": {"oid": "e942a5476ae008eb89411e6e6260f821c6ebf477"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf2c9bcde60026e3797c9fdecadf9f46da3a6f96", "author": {"user": {"login": "SilverNarcissus", "name": null}}, "url": "https://github.com/apache/iotdb/commit/cf2c9bcde60026e3797c9fdecadf9f46da3a6f96", "committedDate": "2020-10-08T06:52:08Z", "message": "suppress warning"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3907, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}