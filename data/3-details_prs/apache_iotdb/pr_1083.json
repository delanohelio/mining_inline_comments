{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2NjM4ODg1", "number": 1083, "title": "Add modified flag in Metadatas and remove canUseStatistics()", "bodyText": "This PR adds a boolean flag in TimeseriesMetadata, ChunkMetadata and PageHeader to identify if their data is integral or modified.\nPreviously we use canUseStatistics() in Statistics for this reason, therefore remove it in this PR.", "createdAt": "2020-04-21T12:21:00Z", "url": "https://github.com/apache/iotdb/pull/1083", "merged": true, "mergeCommit": {"oid": "11949b8957685abd98627ad7029ce3f9220be2c0"}, "closed": true, "closedAt": "2020-04-22T06:36:54Z", "author": {"login": "wshao08"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZyeYzAH2gAyNDA2NjM4ODg1Ojk4OGRlYzRhOWMzYzQ1NmNjYmVkOGYyNWRmNmY1ZGIwNWMzOTllZDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaAsHdAFqTM5NzgzNzM5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "988dec4a9c3c456ccbed8f25df6f5db05c399ed5", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/988dec4a9c3c456ccbed8f25df6f5db05c399ed5", "committedDate": "2020-04-21T12:02:38Z", "message": "Add hasModification() in Metadatas and remove canUseStatistics() in Statistics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb", "committedDate": "2020-04-21T12:02:54Z", "message": "Merge remote-tracking branch 'upstream/master' into use_stats"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3Nzk4MjA2", "url": "https://github.com/apache/iotdb/pull/1083#pullrequestreview-397798206", "createdAt": "2020-04-22T02:23:17Z", "commit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMjoyMzoxN1rOGJgYpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMjozNTozMVrOGJgoQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMDk2Nw==", "bodyText": "if firstPageReader is null, throw exception", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412620967", "createdAt": "2020-04-22T02:23:17Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/query/reader/series/SeriesReader.java", "diffHunk": "@@ -402,6 +410,13 @@ Statistics currentPageStatistics() {\n     return firstPageReader.getStatistics();\n   }\n \n+  boolean currentPageModified() {\n+    if (firstPageReader == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMTA0MQ==", "bodyText": "if firstChunkMetadata is null, throw exception", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412621041", "createdAt": "2020-04-22T02:23:33Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/query/reader/series/SeriesReader.java", "diffHunk": "@@ -266,6 +270,10 @@ Statistics currentChunkStatistics() {\n     return firstChunkMetadata.getStatistics();\n   }\n \n+  boolean currentChunkModified() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMTEwOQ==", "bodyText": "if firstTimeSeriesMetadata is null, throw exception", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412621109", "createdAt": "2020-04-22T02:23:44Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/query/reader/series/SeriesReader.java", "diffHunk": "@@ -184,6 +184,10 @@ Statistics currentFileStatistics() {\n     return firstTimeSeriesMetadata.getStatistics();\n   }\n \n+  boolean currentFileModified() {\n+    return firstTimeSeriesMetadata.hasModification();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyMzYwMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  return data.hasModification();\n          \n          \n            \n                  return pageReader.hasModification();", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412623601", "createdAt": "2020-04-22T02:31:19Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/query/reader/series/SeriesReader.java", "diffHunk": "@@ -693,5 +708,9 @@ BatchData getAllSatisfiedPageData() throws IOException {\n     void setFilter(Filter filter) {\n       data.setFilter(filter);\n     }\n+\n+    boolean hasModification() {\n+      return data.hasModification();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyNDAyMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private boolean pageModified;\n          \n          \n            \n              private boolean modified;", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412624020", "createdAt": "2020-04-22T02:32:47Z", "author": {"login": "qiaojialin"}, "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/file/header/PageHeader.java", "diffHunk": "@@ -33,6 +33,7 @@\n   private int uncompressedSize;\n   private int compressedSize;\n   private Statistics statistics;\n+  private boolean pageModified;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyNDEyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private boolean chunkModified;\n          \n          \n            \n              private boolean modified;", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412624124", "createdAt": "2020-04-22T02:33:05Z", "author": {"login": "qiaojialin"}, "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/file/metadata/ChunkMetadata.java", "diffHunk": "@@ -53,6 +53,8 @@\n    */\n   private long deletedAt = Long.MIN_VALUE;\n \n+  private boolean chunkModified;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyNDU1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            // modified is true when there are modifications of the series, or from unseq file", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412624552", "createdAt": "2020-04-22T02:34:21Z", "author": {"login": "qiaojialin"}, "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/file/metadata/TimeseriesMetadata.java", "diffHunk": "@@ -39,6 +39,7 @@\n   \n   private Statistics<?> statistics;\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyNDY1Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public boolean hasModification() {\n          \n          \n            \n              public boolean isModified() {", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412624656", "createdAt": "2020-04-22T02:34:38Z", "author": {"login": "qiaojialin"}, "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/file/metadata/TimeseriesMetadata.java", "diffHunk": "@@ -116,4 +117,12 @@ public void setChunkMetadataLoader(IChunkMetadataLoader chunkMetadataLoader) {\n   public List<ChunkMetadata> loadChunkMetadataList() throws IOException {\n     return chunkMetadataLoader.loadChunkMetadataList();\n   }\n+\n+  public boolean hasModification() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyNDg3OA==", "bodyText": "remove the  canUseStatistics field in this class", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412624878", "createdAt": "2020-04-22T02:35:15Z", "author": {"login": "qiaojialin"}, "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/file/metadata/statistics/Statistics.java", "diffHunk": "@@ -416,14 +416,6 @@ public void setCount(long count) {\n     this.count = count;\n   }\n \n-  public boolean canUseStatistics() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjYyNDk2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              boolean hasModification();\n          \n          \n            \n              boolean isModified();", "url": "https://github.com/apache/iotdb/pull/1083#discussion_r412624960", "createdAt": "2020-04-22T02:35:31Z", "author": {"login": "qiaojialin"}, "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/read/reader/IPageReader.java", "diffHunk": "@@ -31,4 +31,6 @@\n   Statistics getStatistics();\n \n   void setFilter(Filter filter);\n+\n+  boolean hasModification();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2f805e6d46c83654f1ded317ab61cb5bc3ba7eb"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6571d441ce859f66967315883001af12327f2739", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/6571d441ce859f66967315883001af12327f2739", "committedDate": "2020-04-22T03:25:20Z", "message": "formalize namings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edfe6bdb424456c7ac2a3d66c90428aab41e389f", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/edfe6bdb424456c7ac2a3d66c90428aab41e389f", "committedDate": "2020-04-22T03:27:51Z", "message": "Update tsfile/src/main/java/org/apache/iotdb/tsfile/file/metadata/TimeseriesMetadata.java\n\nCo-Authored-By: Jialin Qiao <qjl16@mails.tsinghua.edu.cn>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3ODM3Mzkx", "url": "https://github.com/apache/iotdb/pull/1083#pullrequestreview-397837391", "createdAt": "2020-04-22T04:36:19Z", "commit": {"oid": "edfe6bdb424456c7ac2a3d66c90428aab41e389f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2958, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}