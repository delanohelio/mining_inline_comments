{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgwNjc5OTEy", "number": 1694, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNlQxMToxODo1NVrOEgsB4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNlQxMToxODo1NVrOEgsB4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNzExMjY2OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/apache/iotdb/db/metadata/MTree.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNlQxMToxODo1NVrOHNoe0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QwMTozNzo0OVrOHNt1Lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDA1Njc4NA==", "bodyText": "Hi, please put these into one or two lines.", "url": "https://github.com/apache/iotdb/pull/1694#discussion_r484056784", "createdAt": "2020-09-06T11:18:55Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/metadata/MTree.java", "diffHunk": "@@ -502,6 +502,54 @@ private void findStorageGroup(\n     return res;\n   }\n \n+  /**\n+   * Get all storage group under give path\n+   *\n+   * @return a list contains all storage group names under give path\n+   */\n+  List<PartialPath> getStorageGroupPaths(PartialPath prefixPath) throws MetadataException {\n+    String[] nodes = prefixPath.getNodes();\n+    if (nodes.length == 0 || !nodes[0].equals(root.getName())) {\n+      throw new IllegalPathException(prefixPath.getFullPath());\n+    }\n+    List<PartialPath> storageGroupPaths = new ArrayList<>();\n+    findStorageGroupPaths(root, nodes, 1, \"\", storageGroupPaths);\n+    return storageGroupPaths;\n+  }\n+\n+  /**\n+   * Traverse the MTree to match all storage group with prefix path.\n+   *\n+   * @param node              the current traversing node\n+   * @param nodes             split the prefix path with '.'\n+   * @param idx               the current index of array nodes\n+   * @param parent            current parent path\n+   * @param storageGroupPaths store all matched storage group names\n+   */\n+  private void findStorageGroupPaths(MNode node, String[] nodes, int idx, String parent,\n+      List<PartialPath> storageGroupPaths) {\n+    if (node instanceof StorageGroupMNode) {\n+      storageGroupPaths.add(node.getPartialPath());\n+      return;\n+    }\n+    String nodeReg = MetaUtils.getNodeRegByIdx(idx, nodes);\n+    if (!(PATH_WILDCARD).equals(nodeReg)) {\n+      if (node.hasChild(nodeReg)) {\n+        findStorageGroupPaths(\n+            node.getChild(nodeReg),\n+            nodes,\n+            idx + 1,\n+            parent + node.getName() + PATH_SEPARATOR,\n+            storageGroupPaths);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d77fa24f65db82eb33a02116a76b9212c21fcf3d"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE0NDQzMA==", "bodyText": "Copy that. I'll change it", "url": "https://github.com/apache/iotdb/pull/1694#discussion_r484144430", "createdAt": "2020-09-07T01:37:49Z", "author": {"login": "yanhongwangg"}, "path": "server/src/main/java/org/apache/iotdb/db/metadata/MTree.java", "diffHunk": "@@ -502,6 +502,54 @@ private void findStorageGroup(\n     return res;\n   }\n \n+  /**\n+   * Get all storage group under give path\n+   *\n+   * @return a list contains all storage group names under give path\n+   */\n+  List<PartialPath> getStorageGroupPaths(PartialPath prefixPath) throws MetadataException {\n+    String[] nodes = prefixPath.getNodes();\n+    if (nodes.length == 0 || !nodes[0].equals(root.getName())) {\n+      throw new IllegalPathException(prefixPath.getFullPath());\n+    }\n+    List<PartialPath> storageGroupPaths = new ArrayList<>();\n+    findStorageGroupPaths(root, nodes, 1, \"\", storageGroupPaths);\n+    return storageGroupPaths;\n+  }\n+\n+  /**\n+   * Traverse the MTree to match all storage group with prefix path.\n+   *\n+   * @param node              the current traversing node\n+   * @param nodes             split the prefix path with '.'\n+   * @param idx               the current index of array nodes\n+   * @param parent            current parent path\n+   * @param storageGroupPaths store all matched storage group names\n+   */\n+  private void findStorageGroupPaths(MNode node, String[] nodes, int idx, String parent,\n+      List<PartialPath> storageGroupPaths) {\n+    if (node instanceof StorageGroupMNode) {\n+      storageGroupPaths.add(node.getPartialPath());\n+      return;\n+    }\n+    String nodeReg = MetaUtils.getNodeRegByIdx(idx, nodes);\n+    if (!(PATH_WILDCARD).equals(nodeReg)) {\n+      if (node.hasChild(nodeReg)) {\n+        findStorageGroupPaths(\n+            node.getChild(nodeReg),\n+            nodes,\n+            idx + 1,\n+            parent + node.getName() + PATH_SEPARATOR,\n+            storageGroupPaths);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDA1Njc4NA=="}, "originalCommit": {"oid": "d77fa24f65db82eb33a02116a76b9212c21fcf3d"}, "originalPosition": 42}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4708, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}