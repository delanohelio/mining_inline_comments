{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3ODQ3ODIy", "number": 1621, "title": "[New feature] Add the alias and show it as column name when querying", "bodyText": "select s1 as d1_temperature form root.sg.d1\nThe result will be like:\n| Time | d1_temperature |\n|   ...    |            ....             |\nselect count(s1) as s1_num from root.sg.d1\nThe result will be like:\n|    s1_num    |\n|         ....        |\nYou can see the detail:\nAdd the alias and show it as column name when querying", "createdAt": "2020-08-14T08:27:05Z", "url": "https://github.com/apache/iotdb/pull/1621", "merged": true, "mergeCommit": {"oid": "393a91f48bc016ba2e3690dc1156573309316028"}, "closed": true, "closedAt": "2020-09-02T13:56:28Z", "author": {"login": "Alima777"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-atSVgH2gAyNDY3ODQ3ODIyOmExNjNmNTU3NDhkZDFiNWEyOWEyNzgwOThjYmQwYjhjZjJlZTI0MzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdE796CgH2gAyNDY3ODQ3ODIyOmI5YjFmZDc4OGU0ZmRlOGRhOTBlY2IyY2E1MTkxZDQ5YjI1NTNlZDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a163f55748dd1b5a29a278098cbd0b8cf2ee2436", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/a163f55748dd1b5a29a278098cbd0b8cf2ee2436", "committedDate": "2020-08-13T07:16:23Z", "message": "Remove select const element"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fec5f9150932265db489ce5da792ba7444a8aab6", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/fec5f9150932265db489ce5da792ba7444a8aab6", "committedDate": "2020-08-13T14:38:03Z", "message": "implement raw data query"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfa2051bbeeaaf9a86d0b0d9dc6293b9a1c7a37e", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/cfa2051bbeeaaf9a86d0b0d9dc6293b9a1c7a37e", "committedDate": "2020-08-14T07:04:34Z", "message": "support align by device"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34d015fef0def5e0ec4a10a6a9006d7fef64c35b", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/34d015fef0def5e0ec4a10a6a9006d7fef64c35b", "committedDate": "2020-08-14T08:18:05Z", "message": "support aggregation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b8a5d0e0e5b1ad1771d76152fb43a819eedca17", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/0b8a5d0e0e5b1ad1771d76152fb43a819eedca17", "committedDate": "2020-08-14T09:20:00Z", "message": "support last"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwMTExODYy", "url": "https://github.com/apache/iotdb/pull/1621#pullrequestreview-470111862", "createdAt": "2020-08-19T04:12:29Z", "commit": {"oid": "0b8a5d0e0e5b1ad1771d76152fb43a819eedca17"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyMTY0ODE4", "url": "https://github.com/apache/iotdb/pull/1621#pullrequestreview-472164818", "createdAt": "2020-08-21T06:04:03Z", "commit": {"oid": "0b8a5d0e0e5b1ad1771d76152fb43a819eedca17"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNjowNDowM1rOHEcrGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNjo0ODo1MFrOHEdmww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQyNjEzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String column = path.getTsAlias() != null ? path.getTsAlias() : null;\n          \n          \n            \n                    String column = path.getTsAlias();", "url": "https://github.com/apache/iotdb/pull/1621#discussion_r474426139", "createdAt": "2020-08-21T06:04:03Z", "author": {"login": "JackieTien97"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/strategy/PhysicalGenerator.java", "diffHunk": "@@ -664,11 +674,9 @@ private void deduplicate(QueryPlan queryPlan) throws MetadataException {\n     if (queryPlan instanceof LastQueryPlan) {\n       for (int i = 0; i < paths.size(); i++) {\n         Path path = paths.get(i);\n-        String column;\n-        if (path.getAlias() != null) {\n-          column = path.getFullPathWithAlias();\n-        } else {\n-          column = path.toString();\n+        String column = path.getTsAlias() != null ? path.getTsAlias() : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b8a5d0e0e5b1ad1771d76152fb43a819eedca17"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQyNzk1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  String column = indexedPath.left.getTsAlias() != null ? indexedPath.left.getTsAlias() : null;\n          \n          \n            \n                  String column = indexedPath.left.getTsAlias();", "url": "https://github.com/apache/iotdb/pull/1621#discussion_r474427951", "createdAt": "2020-08-21T06:09:30Z", "author": {"login": "JackieTien97"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/strategy/PhysicalGenerator.java", "diffHunk": "@@ -689,14 +697,14 @@ private void deduplicate(QueryPlan queryPlan) throws MetadataException {\n \n     int index = 0;\n     for (Pair<Path, Integer> indexedPath : indexedPaths) {\n-      String column;\n-      if (indexedPath.left.getAlias() != null) {\n-        column = indexedPath.left.getFullPathWithAlias();\n-      } else {\n-        column = indexedPath.left.toString();\n-      }\n-      if (queryPlan instanceof AggregationPlan) {\n-        column = queryPlan.getAggregations().get(indexedPath.right) + \"(\" + column + \")\";\n+      // judge whether as clause is used or not first\n+      String column = indexedPath.left.getTsAlias() != null ? indexedPath.left.getTsAlias() : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b8a5d0e0e5b1ad1771d76152fb43a819eedca17"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ0MTQxMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      String column = path.getTsAlias() != null ? path.getTsAlias() : null;\n          \n          \n            \n                      String column = path.getTsAlias();", "url": "https://github.com/apache/iotdb/pull/1621#discussion_r474441411", "createdAt": "2020-08-21T06:48:50Z", "author": {"login": "JackieTien97"}, "path": "server/src/main/java/org/apache/iotdb/db/service/TSServiceImpl.java", "diffHunk": "@@ -788,11 +787,15 @@ private void getWideQueryHeaders(\n           }\n         }\n         for (int i = 0; i < paths.size(); i++) {\n-          if (paths.get(i).getAlias() != null) {\n-            respColumns.add(aggregations.get(i) + \"(\" + paths.get(i).getFullPathWithAlias() + \")\");\n-          } else {\n-            respColumns.add(aggregations.get(i) + \"(\" + paths.get(i).getFullPath() + \")\");\n+          Path path = paths.get(i);\n+          // judge whether as clause is used or not first\n+          String column = path.getTsAlias() != null ? path.getTsAlias() : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b8a5d0e0e5b1ad1771d76152fb43a819eedca17"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "223c942a0e8abfb4cc10a60f36a2593229e61e26", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/223c942a0e8abfb4cc10a60f36a2593229e61e26", "committedDate": "2020-08-21T07:05:25Z", "message": "fix code style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NjU5OTk5", "url": "https://github.com/apache/iotdb/pull/1621#pullrequestreview-476659999", "createdAt": "2020-08-27T12:15:44Z", "commit": {"oid": "223c942a0e8abfb4cc10a60f36a2593229e61e26"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3MTkxOTc2", "url": "https://github.com/apache/iotdb/pull/1621#pullrequestreview-477191976", "createdAt": "2020-08-28T01:55:03Z", "commit": {"oid": "223c942a0e8abfb4cc10a60f36a2593229e61e26"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQwMTo1NTowM1rOHIm5cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQwMTo1NTowM1rOHIm5cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODc4Nzk1Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      // judge whether as clause is used or not first\n          \n          \n            \n                      String column = path.getTsAlias() != null ? path.getTsAlias() : null;\n          \n          \n            \n                      // judge whether as clause is used or not first\n          \n          \n            \n                      String column = path.getTsAlias();", "url": "https://github.com/apache/iotdb/pull/1621#discussion_r478787953", "createdAt": "2020-08-28T01:55:03Z", "author": {"login": "HTHou"}, "path": "server/src/main/java/org/apache/iotdb/db/service/TSServiceImpl.java", "diffHunk": "@@ -761,22 +759,23 @@ private TSExecuteStatementResp getQueryColumnHeaders(PhysicalPlan physicalPlan,\n   // wide means not align by device\n   private void getWideQueryHeaders(\n       QueryPlan plan, List<String> respColumns, List<String> columnTypes)\n-      throws TException, QueryProcessException, MetadataException {\n+      throws TException, MetadataException {\n     // Restore column header of aggregate to func(column_name), only\n     // support single aggregate function for now\n     List<Path> paths = plan.getPaths();\n-    List<TSDataType> seriesTypes;\n+    List<TSDataType> seriesTypes = new ArrayList<>();\n     switch (plan.getOperatorType()) {\n       case QUERY:\n       case FILL:\n         for (Path path : paths) {\n-          if (path.getAlias() != null) {\n-            respColumns.add(path.getFullPathWithAlias());\n-          } else {\n-            respColumns.add(path.getFullPath());\n+          // judge whether as clause is used or not first\n+          String column = path.getTsAlias() != null ? path.getTsAlias() : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "223c942a0e8abfb4cc10a60f36a2593229e61e26"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "508acdc753a8d0d26d273d1fcad15cc89a222536", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/508acdc753a8d0d26d273d1fcad15cc89a222536", "committedDate": "2020-08-28T03:35:53Z", "message": "Update server/src/main/java/org/apache/iotdb/db/service/TSServiceImpl.java\r\n\r\nfix code style\n\nCo-authored-by: Haonan <hhaonan@outlook.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ad386d080507a95c1c8712fcc0ee97ae7fc4c8f", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/2ad386d080507a95c1c8712fcc0ee97ae7fc4c8f", "committedDate": "2020-08-28T09:31:52Z", "message": "Merge branch 'asFunction' of https://github.com/Alima777/incubator-iotdb into asFunction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85160f4c544a6f1611b121d11b0e512696d3588e", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/85160f4c544a6f1611b121d11b0e512696d3588e", "committedDate": "2020-08-30T06:35:44Z", "message": "fix conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2657168cfa0a5f9cd1f10b38c102a654a79969d7", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/2657168cfa0a5f9cd1f10b38c102a654a79969d7", "committedDate": "2020-08-30T07:10:39Z", "message": "optimize align by device"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7604913099a74fea226af5e543e672c0f3221cec", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/7604913099a74fea226af5e543e672c0f3221cec", "committedDate": "2020-08-30T08:18:07Z", "message": "fix doc style"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b415cb0a43caaf61abb1847d43ca644db976a1a2", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/b415cb0a43caaf61abb1847d43ca644db976a1a2", "committedDate": "2020-08-30T07:58:41Z", "message": "Add user guide doc"}, "afterCommit": {"oid": "7604913099a74fea226af5e543e672c0f3221cec", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/7604913099a74fea226af5e543e672c0f3221cec", "committedDate": "2020-08-30T08:18:07Z", "message": "fix doc style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5NTUzMzY1", "url": "https://github.com/apache/iotdb/pull/1621#pullrequestreview-479553365", "createdAt": "2020-09-01T09:21:25Z", "commit": {"oid": "7604913099a74fea226af5e543e672c0f3221cec"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwOToyMToyNVrOHKtn6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQwOToyODoyM1rOHKt4GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDk5NTMwNA==", "bodyText": "measurementAlias", "url": "https://github.com/apache/iotdb/pull/1621#discussion_r480995304", "createdAt": "2020-09-01T09:21:25Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/metadata/PartialPath.java", "diffHunk": "@@ -31,7 +31,10 @@\n public class PartialPath extends Path implements Comparable<Path> {\n \n   private String[] nodes;\n-  private String alias;\n+  // alias of sensor\n+  private String alias = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7604913099a74fea226af5e543e672c0f3221cec"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDk5NTQ1OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              // alias of sensor\n          \n          \n            \n              // alias of measurement", "url": "https://github.com/apache/iotdb/pull/1621#discussion_r480995459", "createdAt": "2020-09-01T09:21:42Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/metadata/PartialPath.java", "diffHunk": "@@ -31,7 +31,10 @@\n public class PartialPath extends Path implements Comparable<Path> {\n \n   private String[] nodes;\n-  private String alias;\n+  // alias of sensor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7604913099a74fea226af5e543e672c0f3221cec"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDk5OTQ0OQ==", "bodyText": "what is not first?", "url": "https://github.com/apache/iotdb/pull/1621#discussion_r480999449", "createdAt": "2020-09-01T09:28:23Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/strategy/PhysicalGenerator.java", "diffHunk": "@@ -690,14 +700,14 @@ private void deduplicate(QueryPlan queryPlan) throws MetadataException {\n \n     int index = 0;\n     for (Pair<PartialPath, Integer> indexedPath : indexedPaths) {\n-      String column;\n-      if (indexedPath.left.getAlias() != null) {\n-        column = indexedPath.left.getFullPathWithAlias();\n-      } else {\n-        column = indexedPath.left.getFullPath();\n-      }\n-      if (queryPlan instanceof AggregationPlan) {\n-        column = queryPlan.getAggregations().get(indexedPath.right) + \"(\" + column + \")\";\n+      // judge whether as clause is used or not first", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7604913099a74fea226af5e543e672c0f3221cec"}, "originalPosition": 67}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "713e2aab9e0c7f8972ff4783380819321b4d7ecf", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/713e2aab9e0c7f8972ff4783380819321b4d7ecf", "committedDate": "2020-09-01T13:02:51Z", "message": "rename alias as measurementAlias"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "289ecb2c832a91a509ec2aea3672b7f0aeaa7760", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/289ecb2c832a91a509ec2aea3672b7f0aeaa7760", "committedDate": "2020-09-02T10:56:41Z", "message": "fix align by device bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe08fedcb41429d1fe44625971479ccf48a60023", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/fe08fedcb41429d1fe44625971479ccf48a60023", "committedDate": "2020-09-02T12:06:32Z", "message": "remove comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9b1fd788e4fde8da90ecb2ca5191d49b2553ed2", "author": {"user": {"login": "Alima777", "name": "Xiangwei Wei"}}, "url": "https://github.com/apache/iotdb/commit/b9b1fd788e4fde8da90ecb2ca5191d49b2553ed2", "committedDate": "2020-09-02T13:24:57Z", "message": "remove redundant comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3378, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}