{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1MTA3NjAy", "number": 1290, "title": "[IOTDB-718]Fix wrong time precision of NOW()", "bodyText": "JIRA issue: https://issues.apache.org/jira/browse/IOTDB-718", "createdAt": "2020-05-29T13:35:56Z", "url": "https://github.com/apache/iotdb/pull/1290", "merged": true, "mergeCommit": {"oid": "fccbadd322f849e775e8e52cd382603998f8d211"}, "closed": true, "closedAt": "2020-06-01T05:47:54Z", "author": {"login": "wshao08"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmCkjAAH2gAyNDI1MTA3NjAyOjNhZmQxMmY0YWFhYjIxNTI3Y2ExMmM5NmIzNWE5ZDkxZDM5ZjQwYzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcm5i41AFqTQyMTYwMzE1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3afd12f4aaab21527ca12c96b35a9d91d39f40c1", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/3afd12f4aaab21527ca12c96b35a9d91d39f40c1", "committedDate": "2020-05-29T13:34:56Z", "message": "Fix wrong time precision of NOW()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c028c0379eac6c3017a1e1b191ceb04d3db58a6f", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/c028c0379eac6c3017a1e1b191ceb04d3db58a6f", "committedDate": "2020-05-29T14:02:07Z", "message": "add test cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMzcwMjg3", "url": "https://github.com/apache/iotdb/pull/1290#pullrequestreview-421370287", "createdAt": "2020-05-30T02:26:31Z", "commit": {"oid": "c028c0379eac6c3017a1e1b191ceb04d3db58a6f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQwMjoyNjozMlrOGcwIkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQwMjoyNjozMlrOGcwIkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjgwMTkzOQ==", "bodyText": "I'm just a little bit curious why don't you use System.nanoTime() here.", "url": "https://github.com/apache/iotdb/pull/1290#discussion_r432801939", "createdAt": "2020-05-30T02:26:32Z", "author": {"login": "HTHou"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/strategy/LogicalGenerator.java", "diffHunk": "@@ -1475,7 +1475,15 @@ long parseTimeFormat(String timestampStr) throws SQLParserException {\n       throw new SQLParserException(\"input timestamp cannot be empty\");\n     }\n     if (timestampStr.equalsIgnoreCase(SQLConstant.NOW_FUNC)) {\n-      return System.currentTimeMillis();\n+      String timePrecision = IoTDBDescriptor.getInstance().getConfig().getTimestampPrecision();\n+      switch (timePrecision) {\n+        case \"ns\":\n+          return System.currentTimeMillis() * 1000_000L;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c028c0379eac6c3017a1e1b191ceb04d3db58a6f"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79ddb8f404877d685b47c8c58bafd8e0359b416a", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/79ddb8f404877d685b47c8c58bafd8e0359b416a", "committedDate": "2020-05-31T10:20:15Z", "message": "fix test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3ae85187a7c6458ba6ba26a57bc77ca00c2493f", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/c3ae85187a7c6458ba6ba26a57bc77ca00c2493f", "committedDate": "2020-05-31T10:58:47Z", "message": "use Instant to generate nanoseconds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79f355cb87881f43947d29dfaa9d488da9691e9e", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/79f355cb87881f43947d29dfaa9d488da9691e9e", "committedDate": "2020-06-01T03:27:14Z", "message": "Use System.nanoTime() to get precise nanoseconds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "185267b97b869dcca306259ecf6fc2d9ba36a045", "author": {"user": {"login": "wshao08", "name": null}}, "url": "https://github.com/apache/iotdb/commit/185267b97b869dcca306259ecf6fc2d9ba36a045", "committedDate": "2020-06-01T03:46:39Z", "message": "Fix us calculation bug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNTk3MDc2", "url": "https://github.com/apache/iotdb/pull/1290#pullrequestreview-421597076", "createdAt": "2020-06-01T05:15:28Z", "commit": {"oid": "185267b97b869dcca306259ecf6fc2d9ba36a045"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNjAzMTUy", "url": "https://github.com/apache/iotdb/pull/1290#pullrequestreview-421603152", "createdAt": "2020-06-01T05:37:54Z", "commit": {"oid": "185267b97b869dcca306259ecf6fc2d9ba36a045"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3727, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}