{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxMjA1MjE3", "number": 769, "title": "[IOTDB-452] Do all aggregations of one series at one pass in GroupBy", "bodyText": "Do all aggregations of one series at one pass in GroupBy", "createdAt": "2020-02-05T06:28:24Z", "url": "https://github.com/apache/iotdb/pull/769", "merged": true, "mergeCommit": {"oid": "b71fd95722519d8048401da82a87eb2126d29591"}, "closed": true, "closedAt": "2020-02-06T12:00:36Z", "author": {"login": "samperson1997"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBQ3ZqAFqTM1MzUwNTc2OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBpfEbgFqTM1NDM5NzAzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNTA1NzY4", "url": "https://github.com/apache/iotdb/pull/769#pullrequestreview-353505768", "createdAt": "2020-02-05T07:19:00Z", "commit": {"oid": "f20f9ce5e8502b9b81949009eb63ad92588f2de5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNzoxOTowMFrOFltxwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQwNzoxOTowMFrOFltxwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA5MTY0OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private Map<Path, List<Integer>> seriesReaders;\n          \n          \n            \n              private Map<Path, List<Integer>> pathToAggrIndexes;", "url": "https://github.com/apache/iotdb/pull/769#discussion_r375091649", "createdAt": "2020-02-05T07:19:00Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/query/dataset/groupby/GroupByWithoutValueFilterDataSet.java", "diffHunk": "@@ -43,7 +46,17 @@\n \n public class GroupByWithoutValueFilterDataSet extends GroupByEngineDataSet {\n \n-  private List<IAggregateReader> seriesReaders;\n+  /**\n+   * Merges same series to one map. For example: Given: paths: s1, s2, s3, s1 and aggregations:\n+   * count, sum, count, sum seriesMap: s1 -> 0, 3; s2 -> 2; s3 -> 3\n+   */\n+  private Map<Path, List<Integer>> seriesReaders;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f20f9ce5e8502b9b81949009eb63ad92588f2de5"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c311b36e5ddde3734e2d7bf18347ba56fa457483", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/c311b36e5ddde3734e2d7bf18347ba56fa457483", "committedDate": "2020-02-05T08:34:34Z", "message": "Merge new_series_reader and solve conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e291c91c5c6bd557b101678611b80776da452b78", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/e291c91c5c6bd557b101678611b80776da452b78", "committedDate": "2020-02-05T08:43:50Z", "message": "Rename"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f20f9ce5e8502b9b81949009eb63ad92588f2de5", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/f20f9ce5e8502b9b81949009eb63ad92588f2de5", "committedDate": "2020-02-05T06:33:23Z", "message": "Solve conflicts"}, "afterCommit": {"oid": "e291c91c5c6bd557b101678611b80776da452b78", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/e291c91c5c6bd557b101678611b80776da452b78", "committedDate": "2020-02-05T08:43:50Z", "message": "Rename"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "132fe564c906fedd0b8bd5b18e9ada6f2bb8ce36", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/132fe564c906fedd0b8bd5b18e9ada6f2bb8ce36", "committedDate": "2020-02-05T08:49:51Z", "message": "Merge remote-tracking branch 'upstream/new_series_reader' into new_series_reader\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/query/dataset/groupby/GroupByWithoutValueFilterDataSet.java\n#\tserver/src/main/java/org/apache/iotdb/db/query/executor/AggregationExecutor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7715c3b9afc793c3374adf88033815472f081ab8", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/7715c3b9afc793c3374adf88033815472f081ab8", "committedDate": "2020-02-05T08:51:50Z", "message": "Solve conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03e18f74b7c4b635af56f68c6372ea1566055ea4", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/03e18f74b7c4b635af56f68c6372ea1566055ea4", "committedDate": "2020-02-05T15:00:36Z", "message": "Add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a06b8d762fc77925a27082b3bfa098e1742e10a", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/5a06b8d762fc77925a27082b3bfa098e1742e10a", "committedDate": "2020-02-06T00:25:27Z", "message": "Add test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b06b1ff789eb660964ffe39f39015193b45453a", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/3b06b1ff789eb660964ffe39f39015193b45453a", "committedDate": "2020-02-06T02:42:23Z", "message": "Extract series test util"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7e4a549afc4e53d0999ae404544cc3ca69c7841", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/d7e4a549afc4e53d0999ae404544cc3ca69c7841", "committedDate": "2020-02-06T02:45:38Z", "message": "Merge remote-tracking branch 'upstream/new_series_reader' into new_series_reader"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5570ec2b4ad9b6b9f18dc359667c2b534ea164ef", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/5570ec2b4ad9b6b9f18dc359667c2b534ea164ef", "committedDate": "2020-02-06T04:16:07Z", "message": "Add license"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e998ab35ad9a2294d81af6ba70c4867b2f257fb", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/4e998ab35ad9a2294d81af6ba70c4867b2f257fb", "committedDate": "2020-02-06T09:53:54Z", "message": "Merge remote-tracking branch 'upstream/new_series_reader' into new_series_reader"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MzI3NzEz", "url": "https://github.com/apache/iotdb/pull/769#pullrequestreview-354327713", "createdAt": "2020-02-06T10:03:30Z", "commit": {"oid": "5570ec2b4ad9b6b9f18dc359667c2b534ea164ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMDowMzozMFrOFmVb3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMDowMzozMFrOFmVb3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTc0MTQwNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public class SeriesTestUtil {\n          \n          \n            \n            public class SeriesReaderTestUtil {", "url": "https://github.com/apache/iotdb/pull/769#discussion_r375741407", "createdAt": "2020-02-06T10:03:30Z", "author": {"login": "qiaojialin"}, "path": "server/src/test/java/org/apache/iotdb/db/query/reader/series/SeriesTestUtil.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.iotdb.db.query.reader.series;\n+\n+import static org.apache.iotdb.db.conf.IoTDBConstant.PATH_SEPARATOR;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.List;\n+import org.apache.iotdb.db.conf.IoTDBConstant;\n+import org.apache.iotdb.db.constant.TestConstant;\n+import org.apache.iotdb.db.engine.cache.DeviceMetaDataCache;\n+import org.apache.iotdb.db.engine.cache.TsFileMetaDataCache;\n+import org.apache.iotdb.db.engine.merge.manage.MergeManager;\n+import org.apache.iotdb.db.engine.storagegroup.TsFileResource;\n+import org.apache.iotdb.db.exception.metadata.MetadataException;\n+import org.apache.iotdb.db.exception.path.PathException;\n+import org.apache.iotdb.db.metadata.MManager;\n+import org.apache.iotdb.db.query.control.FileReaderManager;\n+import org.apache.iotdb.db.utils.EnvironmentUtils;\n+import org.apache.iotdb.tsfile.exception.write.WriteProcessException;\n+import org.apache.iotdb.tsfile.file.metadata.enums.CompressionType;\n+import org.apache.iotdb.tsfile.file.metadata.enums.TSDataType;\n+import org.apache.iotdb.tsfile.file.metadata.enums.TSEncoding;\n+import org.apache.iotdb.tsfile.write.TsFileWriter;\n+import org.apache.iotdb.tsfile.write.record.TSRecord;\n+import org.apache.iotdb.tsfile.write.record.datapoint.DataPoint;\n+import org.apache.iotdb.tsfile.write.schema.MeasurementSchema;\n+\n+public class SeriesTestUtil {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5570ec2b4ad9b6b9f18dc359667c2b534ea164ef"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88f5a669a26f1abab44416cfdc4b3630d6738bdc", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/88f5a669a26f1abab44416cfdc4b3630d6738bdc", "committedDate": "2020-02-06T10:21:23Z", "message": "Enhance IT test for aggregation query with more than one functions on one series"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "838953099a39cec502bf2708e5eeb6d5f34e859e", "author": {"user": {"login": "samperson1997", "name": "Zesong Sun"}}, "url": "https://github.com/apache/iotdb/commit/838953099a39cec502bf2708e5eeb6d5f34e859e", "committedDate": "2020-02-06T10:37:06Z", "message": "Rename"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0Mzk3MDM0", "url": "https://github.com/apache/iotdb/pull/769#pullrequestreview-354397034", "createdAt": "2020-02-06T12:00:03Z", "commit": {"oid": "838953099a39cec502bf2708e5eeb6d5f34e859e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3282, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}