{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA5OTc4MjMw", "number": 1866, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwMTo0NDowMlrOEyJoBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwMjowMzoxNlrOEyJ1-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMDIxOTU4OnYy", "diffSide": "RIGHT", "path": "server/src/main/java/org/apache/iotdb/db/qp/executor/PlanExecutor.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwMTo0NDowMlrOHooY3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNzoxOToxMVrOHouKBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM2NjgxMw==", "bodyText": "Sorry, I'm a little confused about when will this method throw a IndexOutOfBoundsException?", "url": "https://github.com/apache/iotdb/pull/1866#discussion_r512366813", "createdAt": "2020-10-27T01:44:02Z", "author": {"login": "LebronAl"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/executor/PlanExecutor.java", "diffHunk": "@@ -371,7 +374,12 @@ protected QueryDataSet processDataQuery(QueryPlan queryPlan, QueryContext contex\n       } else if (queryPlan instanceof LastQueryPlan) {\n         queryDataSet = queryRouter.lastQuery((LastQueryPlan) queryPlan, context);\n       } else {\n-        queryDataSet = queryRouter.rawDataQuery((RawDataQueryPlan) queryPlan, context);\n+        try {\n+          queryDataSet = queryRouter.rawDataQuery((RawDataQueryPlan) queryPlan, context);\n+        } catch (IndexOutOfBoundsException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8b3876b5ed4ce16bf5f4918321d4d07693e5fe3"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM2ODcxOA==", "bodyText": "When we have some nonsense predicates, such as\n\nselect status, temperature from root.ln.wf01.wt01 where time < 2017-11-01T00:05:00.000 and time > 2017-11-01T00:12:00.000", "url": "https://github.com/apache/iotdb/pull/1866#discussion_r512368718", "createdAt": "2020-10-27T01:50:36Z", "author": {"login": "Ring-k"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/executor/PlanExecutor.java", "diffHunk": "@@ -371,7 +374,12 @@ protected QueryDataSet processDataQuery(QueryPlan queryPlan, QueryContext contex\n       } else if (queryPlan instanceof LastQueryPlan) {\n         queryDataSet = queryRouter.lastQuery((LastQueryPlan) queryPlan, context);\n       } else {\n-        queryDataSet = queryRouter.rawDataQuery((RawDataQueryPlan) queryPlan, context);\n+        try {\n+          queryDataSet = queryRouter.rawDataQuery((RawDataQueryPlan) queryPlan, context);\n+        } catch (IndexOutOfBoundsException e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM2NjgxMw=="}, "originalCommit": {"oid": "e8b3876b5ed4ce16bf5f4918321d4d07693e5fe3"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM3MDY1Nw==", "bodyText": "I believe this is a misuse, since it does not involve any index, and I would prefer creating a new Exception like IllegalTimeRangeException of IllegalPredicateException. You may correct it within this PR or just create an issue about it.", "url": "https://github.com/apache/iotdb/pull/1866#discussion_r512370657", "createdAt": "2020-10-27T01:57:42Z", "author": {"login": "jt2594838"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/executor/PlanExecutor.java", "diffHunk": "@@ -371,7 +374,12 @@ protected QueryDataSet processDataQuery(QueryPlan queryPlan, QueryContext contex\n       } else if (queryPlan instanceof LastQueryPlan) {\n         queryDataSet = queryRouter.lastQuery((LastQueryPlan) queryPlan, context);\n       } else {\n-        queryDataSet = queryRouter.rawDataQuery((RawDataQueryPlan) queryPlan, context);\n+        try {\n+          queryDataSet = queryRouter.rawDataQuery((RawDataQueryPlan) queryPlan, context);\n+        } catch (IndexOutOfBoundsException e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM2NjgxMw=="}, "originalCommit": {"oid": "e8b3876b5ed4ce16bf5f4918321d4d07693e5fe3"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ2MTMxNw==", "bodyText": "To make it more clear, I created EmptyIntervalException.", "url": "https://github.com/apache/iotdb/pull/1866#discussion_r512461317", "createdAt": "2020-10-27T07:19:11Z", "author": {"login": "Ring-k"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/executor/PlanExecutor.java", "diffHunk": "@@ -371,7 +374,12 @@ protected QueryDataSet processDataQuery(QueryPlan queryPlan, QueryContext contex\n       } else if (queryPlan instanceof LastQueryPlan) {\n         queryDataSet = queryRouter.lastQuery((LastQueryPlan) queryPlan, context);\n       } else {\n-        queryDataSet = queryRouter.rawDataQuery((RawDataQueryPlan) queryPlan, context);\n+        try {\n+          queryDataSet = queryRouter.rawDataQuery((RawDataQueryPlan) queryPlan, context);\n+        } catch (IndexOutOfBoundsException e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM2NjgxMw=="}, "originalCommit": {"oid": "e8b3876b5ed4ce16bf5f4918321d4d07693e5fe3"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMDI1NTI4OnYy", "diffSide": "RIGHT", "path": "cluster/src/main/java/org/apache/iotdb/cluster/server/member/RaftMember.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwMjowMzoxNlrOHootwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwMjoyMjoyMFrOHopByQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM3MjE2MQ==", "bodyText": "This is not relevant to this PR, but it occurs to me that RunTimeExceptions sometimes does not provide useful messages, and it would difficult to locate the problem.\nSo please add this:\nif (cause instanceof RunTimeException) {\n  logger.error(\"RuntimeException during executing {}\", log , cause);\n}", "url": "https://github.com/apache/iotdb/pull/1866#discussion_r512372161", "createdAt": "2020-10-27T02:03:16Z", "author": {"login": "jt2594838"}, "path": "cluster/src/main/java/org/apache/iotdb/cluster/server/member/RaftMember.java", "diffHunk": "@@ -1334,7 +1338,7 @@ private TSStatus handleLogExecutionException(\n           .getStatus(Arrays.asList(((BatchInsertionException) cause).getFailingStatus()));\n     }\n     TSStatus tsStatus = StatusUtils.getStatus(StatusUtils.EXECUTE_STATEMENT_ERROR,\n-        cause.getClass().getName() + \":\" + cause.getMessage());\n+        cause.getMessage());\n     if (cause instanceof IoTDBException) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8b3876b5ed4ce16bf5f4918321d4d07693e5fe3"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM3NzI4OQ==", "bodyText": "That's a good idea.", "url": "https://github.com/apache/iotdb/pull/1866#discussion_r512377289", "createdAt": "2020-10-27T02:22:20Z", "author": {"login": "Ring-k"}, "path": "cluster/src/main/java/org/apache/iotdb/cluster/server/member/RaftMember.java", "diffHunk": "@@ -1334,7 +1338,7 @@ private TSStatus handleLogExecutionException(\n           .getStatus(Arrays.asList(((BatchInsertionException) cause).getFailingStatus()));\n     }\n     TSStatus tsStatus = StatusUtils.getStatus(StatusUtils.EXECUTE_STATEMENT_ERROR,\n-        cause.getClass().getName() + \":\" + cause.getMessage());\n+        cause.getMessage());\n     if (cause instanceof IoTDBException) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjM3MjE2MQ=="}, "originalCommit": {"oid": "e8b3876b5ed4ce16bf5f4918321d4d07693e5fe3"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 661, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}