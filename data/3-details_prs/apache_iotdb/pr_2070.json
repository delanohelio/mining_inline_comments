{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzMDE0MjQy", "number": 2070, "title": "Update level compaction delete and change list lock", "bodyText": "", "createdAt": "2020-11-18T08:35:29Z", "url": "https://github.com/apache/iotdb/pull/2070", "merged": true, "mergeCommit": {"oid": "344c3875c4325c07bb14c0b2a95a9073714eb8cc"}, "closed": true, "closedAt": "2020-11-19T00:56:05Z", "author": {"login": "zhanglingzhe0820"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZ1SrrgH2gAyNTIzMDE0MjQyOjA5Mjg4Y2RmYTY4OTkyMWZhZGQ2Zjc5NDg4NDUxNWRjOTA5MzAyYWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddut2QgH2gAyNTIzMDE0MjQyOjM0MjRmMzkxMDZiZmRjYmMwZGZkNjAwYjllNTM5ZjJmOTAyMGIzODg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "09288cdfa689921fadd6f794884515dc909302aa", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/09288cdfa689921fadd6f794884515dc909302aa", "committedDate": "2020-11-06T11:30:43Z", "message": "add enable unseq compaction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49fab34ba14c60d99f540297a3113295eee3a08f", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/49fab34ba14c60d99f540297a3113295eee3a08f", "committedDate": "2020-11-07T06:18:17Z", "message": "Merge branch 'master' of https://github.com/apache/iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2854f931acefe3bca3d9548ddcf5b37760473980", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/2854f931acefe3bca3d9548ddcf5b37760473980", "committedDate": "2020-11-07T10:43:36Z", "message": "Merge branch 'master' of https://github.com/apache/iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ba681617dab53da7e51865d9aee14dd6ebbe335", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/9ba681617dab53da7e51865d9aee14dd6ebbe335", "committedDate": "2020-11-08T08:34:09Z", "message": "Merge branches 'master' and 'master' of https://github.com/apache/iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9da683521fabfb7ad05f84d319d9b504c71a4f2b", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/9da683521fabfb7ad05f84d319d9b504c71a4f2b", "committedDate": "2020-11-10T05:54:00Z", "message": "Merge branch 'master' of https://github.com/apache/iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f438705f15d0e2eea26ed27f5348414f2e58f231", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/f438705f15d0e2eea26ed27f5348414f2e58f231", "committedDate": "2020-11-11T03:13:16Z", "message": "Merge branch 'master' of https://github.com/apache/iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5a17d52eea06efa2650921ecb1d104e00309415", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/b5a17d52eea06efa2650921ecb1d104e00309415", "committedDate": "2020-11-12T02:03:02Z", "message": "Merge branch 'master' of https://github.com/apache/iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae79d884d1c520da33dba51a4f1ef84ee52a70a8", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/ae79d884d1c520da33dba51a4f1ef84ee52a70a8", "committedDate": "2020-11-12T10:33:05Z", "message": "Merge branch 'master' of https://github.com/apache/iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97a2b13f188a81b9f6228fd599e18a818fcf331a", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/97a2b13f188a81b9f6228fd599e18a818fcf331a", "committedDate": "2020-11-13T02:41:57Z", "message": "Merge branch 'master' of https://github.com/apache/iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b80249f4cc9d090ce560146d5c86197be7f217ac", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/b80249f4cc9d090ce560146d5c86197be7f217ac", "committedDate": "2020-11-18T06:23:54Z", "message": "Merge branch 'master' of https://github.com/zhanglingzhe0820/incubator-iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91271f011d1e01f124cb5ee52c284342a0fa3b73", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/91271f011d1e01f124cb5ee52c284342a0fa3b73", "committedDate": "2020-11-18T08:32:46Z", "message": "update level compaction delete and change list lock"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDE0OTEy", "url": "https://github.com/apache/iotdb/pull/2070#pullrequestreview-533414912", "createdAt": "2020-11-18T12:53:49Z", "commit": {"oid": "91271f011d1e01f124cb5ee52c284342a0fa3b73"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDIyMzcw", "url": "https://github.com/apache/iotdb/pull/2070#pullrequestreview-533422370", "createdAt": "2020-11-18T13:03:27Z", "commit": {"oid": "91271f011d1e01f124cb5ee52c284342a0fa3b73"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDI1MTE0", "url": "https://github.com/apache/iotdb/pull/2070#pullrequestreview-533425114", "createdAt": "2020-11-18T13:07:04Z", "commit": {"oid": "91271f011d1e01f124cb5ee52c284342a0fa3b73"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMzowNzowNFrOH1s18g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMzowNzowNFrOH1s18g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA3MTI4Mg==", "bodyText": "Why not combine these two statements into one function, because most of the time they appear at the same time", "url": "https://github.com/apache/iotdb/pull/2070#discussion_r526071282", "createdAt": "2020-11-18T13:07:04Z", "author": {"login": "EJTTianYu"}, "path": "server/src/main/java/org/apache/iotdb/db/engine/compaction/level/LevelCompactionTsFileManagement.java", "diffHunk": "@@ -338,12 +342,14 @@ public void recover() {\n             if (isSeq) {\n               for (TreeSet<TsFileResource> currMergeFile : sequenceTsFileResources\n                   .get(timePartition)) {\n-                deleteLevelFiles(timePartition, currMergeFile);\n+                deleteLevelFilesInDisk(currMergeFile);\n+                deleteLevelFilesInList(timePartition, currMergeFile);\n               }\n             } else {\n               for (List<TsFileResource> currMergeFile : unSequenceTsFileResources\n                   .get(timePartition)) {\n-                deleteLevelFiles(timePartition, currMergeFile);\n+                deleteLevelFilesInDisk(currMergeFile);\n+                deleteLevelFilesInList(timePartition, currMergeFile);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91271f011d1e01f124cb5ee52c284342a0fa3b73"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNDI3NTMx", "url": "https://github.com/apache/iotdb/pull/2070#pullrequestreview-533427531", "createdAt": "2020-11-18T13:10:10Z", "commit": {"oid": "91271f011d1e01f124cb5ee52c284342a0fa3b73"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3424f39106bfdcbc0dfd600b9e539f2f9020b388", "author": {"user": {"login": "zhanglingzhe0820", "name": null}}, "url": "https://github.com/apache/iotdb/commit/3424f39106bfdcbc0dfd600b9e539f2f9020b388", "committedDate": "2020-11-18T14:06:45Z", "message": "rebase master"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4145, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}