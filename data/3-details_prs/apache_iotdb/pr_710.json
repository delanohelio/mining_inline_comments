{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5OTg2ODE5", "number": 710, "title": "[IOTDB-406] refactor environmentutils and IoTDBConfig", "bodyText": "for test in server module, use test/resource/iotdb-engine.properties as the configuration file.\nrefactor environmentUtils to shield the IoTDB daemon.\nset ThriftServer awaitTime for close to 0 second.\nfix bugs that modification files are not closed.\nFix concurrency exception in QueryContext.", "createdAt": "2020-01-07T13:21:54Z", "url": "https://github.com/apache/iotdb/pull/710", "merged": true, "mergeCommit": {"oid": "e8e1b7bb73ce62a2eb162704a6c83b22126564a7"}, "closed": true, "closedAt": "2020-01-10T01:29:33Z", "author": {"login": "jixuan1989"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb3oXqqgH2gAyMzU5OTg2ODE5OjVhNGUyMjU1NWVkMTQxOGMwOTliNmE4MzIxOWM5ZjVmMzQ2MTQ0Y2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb40PDyAFqTM0MDkxMjA3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5a4e22555ed1418c099b6a83219c9f5f346144cb", "author": {"user": {"login": "HTHou", "name": "Haonan"}}, "url": "https://github.com/apache/iotdb/commit/5a4e22555ed1418c099b6a83219c9f5f346144cb", "committedDate": "2020-01-06T09:02:49Z", "message": "fix a bug when recover the last crashed file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec64d27af2b0735f5d8588f709834bdfbc720897", "author": {"user": {"login": "HTHou", "name": "Haonan"}}, "url": "https://github.com/apache/iotdb/commit/ec64d27af2b0735f5d8588f709834bdfbc720897", "committedDate": "2020-01-06T09:22:59Z", "message": "add exception for something gets wrong"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68296fc4de495b85829ddb6e511ad3b875727f38", "author": {"user": {"login": "HTHou", "name": "Haonan"}}, "url": "https://github.com/apache/iotdb/commit/68296fc4de495b85829ddb6e511ad3b875727f38", "committedDate": "2020-01-06T12:36:13Z", "message": "fix test errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba57aaba1803fef32309073e134c881c58f4c5ab", "author": {"user": {"login": "HTHou", "name": "Haonan"}}, "url": "https://github.com/apache/iotdb/commit/ba57aaba1803fef32309073e134c881c58f4c5ab", "committedDate": "2020-01-07T08:28:43Z", "message": "change the comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07fc93f13d9fe283d4e39a95d33aa3fa10505dbf", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/07fc93f13d9fe283d4e39a95d33aa3fa10505dbf", "committedDate": "2020-01-07T12:08:02Z", "message": "fix concurrent error of cache in QueryContext"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f93f819aa6e3ae2da02508507f9e16835478d7a", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/7f93f819aa6e3ae2da02508507f9e16835478d7a", "committedDate": "2020-01-07T13:15:56Z", "message": "move IoTDB daemon to EnvironmentUtils; allow iotdb-engine.properties providing incomplete parameters for hdfs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c570bdc9e39065a1b5afeaf6a827abe7c107dc92", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/c570bdc9e39065a1b5afeaf6a827abe7c107dc92", "committedDate": "2020-01-07T13:22:43Z", "message": "delete unused codes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c284e9ed058082390e6e8fa6c355b31406e8e0a", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/5c284e9ed058082390e6e8fa6c355b31406e8e0a", "committedDate": "2020-01-07T15:37:48Z", "message": "fix unit test (actually they are ITs) and session Test (now there is a duplicate EnvironmentUtils)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70253ac5d39e768b1ac600e624ca3fab1411f2ff", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/70253ac5d39e768b1ac600e624ca3fab1411f2ff", "committedDate": "2020-01-07T15:41:16Z", "message": "fix code smell and Vulnerability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6773d6c0752576b2a310cde4b308952946d01fe5", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/6773d6c0752576b2a310cde4b308952946d01fe5", "committedDate": "2020-01-07T16:42:19Z", "message": "try to close  MetricService timely in Tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f3f7bc8424452c8724aa310af4640112e2b6f97", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/5f3f7bc8424452c8724aa310af4640112e2b6f97", "committedDate": "2020-01-07T17:05:37Z", "message": "fix code smell for thrift and metric stop timeout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49a4adc30ab741b3c3956974ee53cf48855c9a2a", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/49a4adc30ab741b3c3956974ee53cf48855c9a2a", "committedDate": "2020-01-08T01:01:24Z", "message": "set stopTime of MetricService in Tests as 1 (can not be 0)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "124efa62f032ae9863c7a11ac0d2bb29a18a69fe", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/124efa62f032ae9863c7a11ac0d2bb29a18a69fe", "committedDate": "2020-01-08T01:15:07Z", "message": "stop iot daemon first and then delete files; remove duplicated EnvironmentUtils"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5NjExODYy", "url": "https://github.com/apache/iotdb/pull/710#pullrequestreview-339611862", "createdAt": "2020-01-08T02:00:17Z", "commit": {"oid": "124efa62f032ae9863c7a11ac0d2bb29a18a69fe"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMjowMDoxN1rOFbK-Bw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQwMjowMDoxN1rOFbK-Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDAzNTU5MQ==", "bodyText": "Use a logger.", "url": "https://github.com/apache/iotdb/pull/710#discussion_r364035591", "createdAt": "2020-01-08T02:00:17Z", "author": {"login": "jt2594838"}, "path": "server/src/test/java/org/apache/iotdb/db/utils/EnvironmentUtils.java", "diffHunk": "@@ -188,6 +181,12 @@ private static void createAllDir() {\n     for (String dataDir : config.getDataDirs()) {\n       createDir(dataDir);\n     }\n+    //create user and roles folder\n+    try {\n+      LocalFileAuthorizer.getInstance().reset();\n+    } catch (AuthException e) {\n+      e.printStackTrace();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "124efa62f032ae9863c7a11ac0d2bb29a18a69fe"}, "originalPosition": 123}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c0584440270453a0345f73bb97ab59c9842d2cc", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/3c0584440270453a0345f73bb97ab59c9842d2cc", "committedDate": "2020-01-08T02:24:20Z", "message": "sync files before delete sg files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65fe0080061d7dabe366bd9b37ef1bfb43aec324", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/65fe0080061d7dabe366bd9b37ef1bfb43aec324", "committedDate": "2020-01-08T02:59:29Z", "message": "revert to give more time for closing MetricService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "454f38cf72ef5e141804b8c65781126093277aae", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/454f38cf72ef5e141804b8c65781126093277aae", "committedDate": "2020-01-08T04:36:47Z", "message": "generate test-jar for session test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d5942a20ff1b039b963619dbf0b07fe6e916047", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/5d5942a20ff1b039b963619dbf0b07fe6e916047", "committedDate": "2020-01-08T08:32:09Z", "message": "change start order of IServices; and stop IoTDB Daemon first"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "995ecbc68b6e9d683d860367905ffeaf194d25b0", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/995ecbc68b6e9d683d860367905ffeaf194d25b0", "committedDate": "2020-01-08T17:55:35Z", "message": "catch MetricService start failed exception; try to fix some ModificationFile not closed issue"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0574dbc31a70a3e428d66a6eeb3d9f7e2ad5973", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/b0574dbc31a70a3e428d66a6eeb3d9f7e2ad5973", "committedDate": "2020-01-08T18:18:58Z", "message": "close mod files when stop StorageEngine"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0233b469eb637a0a2efb78c17273620a40ba9881", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/0233b469eb637a0a2efb78c17273620a40ba9881", "committedDate": "2020-01-08T18:35:45Z", "message": "avoid create a mod file if there is no modifications"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb40bc74f50c0cda7af2cb2083177d6d3f35bf14", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/cb40bc74f50c0cda7af2cb2083177d6d3f35bf14", "committedDate": "2020-01-08T18:43:07Z", "message": "close MergingModifications for a test trace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0edb7ee00676f825640fe116fc1ba949bd0d14ef", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/0edb7ee00676f825640fe116fc1ba949bd0d14ef", "committedDate": "2020-01-08T18:58:34Z", "message": "fix cmode smell reported by sonar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c913525381f565dd1234c0c74fda8bf64088cb6", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/8c913525381f565dd1234c0c74fda8bf64088cb6", "committedDate": "2020-01-09T02:51:37Z", "message": "Terminate flush task when interrupted"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f59f2bb9a77d3ff8182f259e55fd5ec930eac06f", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/f59f2bb9a77d3ff8182f259e55fd5ec930eac06f", "committedDate": "2020-01-09T10:48:31Z", "message": "ignore some sonar warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e23b6210c2178c616c5124f5a6bd4c7ce4961fcd", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/e23b6210c2178c616c5124f5a6bd4c7ce4961fcd", "committedDate": "2020-01-09T12:52:44Z", "message": "skip PerformanceTests; merge with master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwOTEyMDcw", "url": "https://github.com/apache/iotdb/pull/710#pullrequestreview-340912070", "createdAt": "2020-01-10T01:26:13Z", "commit": {"oid": "e23b6210c2178c616c5124f5a6bd4c7ce4961fcd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3203, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}