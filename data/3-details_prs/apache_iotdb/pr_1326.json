{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMwOTQwMTE1", "number": 1326, "title": "premerge for the distributed version", "bodyText": "", "createdAt": "2020-06-08T08:45:01Z", "url": "https://github.com/apache/iotdb/pull/1326", "merged": true, "mergeCommit": {"oid": "1e2c3e9674a91edfb27f10f91cebb1c6d1173e93"}, "closed": true, "closedAt": "2020-07-07T03:07:56Z", "author": {"login": "jt2594838"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpMZvMgH2gAyNDMwOTQwMTE1Ojc4ZjhkOWJmYzE3YzI0ODNkYTA4YjU5YjU5NzA4ZWJlMWYyYTg2YzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyc9v6gFqTQ0MzUzMTQ3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "78f8d9bfc17c2483da08b59b59708ebe1f2a86c1", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/78f8d9bfc17c2483da08b59b59708ebe1f2a86c1", "committedDate": "2020-06-08T08:43:57Z", "message": "next premerge for the distributed version"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MDI2NDM3", "url": "https://github.com/apache/iotdb/pull/1326#pullrequestreview-426026437", "createdAt": "2020-06-08T08:46:38Z", "commit": {"oid": "78f8d9bfc17c2483da08b59b59708ebe1f2a86c1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwODo0NjozOFrOGgUeJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwODo0NjozOFrOGgUeJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU0MzAxMw==", "bodyText": "This may prevent \"class not found\" when using git bash in windows to run this script.", "url": "https://github.com/apache/iotdb/pull/1326#discussion_r436543013", "createdAt": "2020-06-08T08:46:38Z", "author": {"login": "jt2594838"}, "path": "cli/src/assembly/resources/sbin/start-cli.sh", "diffHunk": "@@ -29,7 +29,7 @@ fi\n MAIN_CLASS=org.apache.iotdb.cli.Cli\n \n \n-CLASSPATH=\"\"\n+CLASSPATH=\".\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78f8d9bfc17c2483da08b59b59708ebe1f2a86c1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MDQzNTE0", "url": "https://github.com/apache/iotdb/pull/1326#pullrequestreview-426043514", "createdAt": "2020-06-08T09:08:55Z", "commit": {"oid": "78f8d9bfc17c2483da08b59b59708ebe1f2a86c1"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "389c3f1a0d506906855b4e3487928dee24e559ed", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/389c3f1a0d506906855b4e3487928dee24e559ed", "committedDate": "2020-06-08T09:10:05Z", "message": "fix by self-review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "297ab12d0dddfcb26cfb9a64b68fecc72d419a56", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/297ab12d0dddfcb26cfb9a64b68fecc72d419a56", "committedDate": "2020-06-10T09:05:19Z", "message": "Merge branch 'master' into cluster_premerge2\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/metadata/MManager.java\n#\tserver/src/main/java/org/apache/iotdb/db/query/executor/LastQueryExecutor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91d5222ca5f64be9e363c009c00f823d7bcf2515", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/91d5222ca5f64be9e363c009c00f823d7bcf2515", "committedDate": "2020-06-11T02:36:59Z", "message": "Merge branch 'master' into cluster_premerge2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58d18dca0c62f50296b1fa1939eddc4389f9a0af", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/58d18dca0c62f50296b1fa1939eddc4389f9a0af", "committedDate": "2020-06-12T03:11:40Z", "message": "Merge branch 'master' into cluster_premerge2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2b4a97a3670b86563392f9327b5e909025a3a71", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/f2b4a97a3670b86563392f9327b5e909025a3a71", "committedDate": "2020-06-17T07:51:51Z", "message": "Merge branch 'master' into cluster_premerge2\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/service/TSServiceImpl.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a4efd7c1841cb5e44a0a224b4c8484f999bad37", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/7a4efd7c1841cb5e44a0a224b4c8484f999bad37", "committedDate": "2020-06-18T02:09:11Z", "message": "Merge branch 'master' into cluster_premerge2\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/metadata/MManager.java\n#\tserver/src/main/java/org/apache/iotdb/db/metadata/MTree.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c8c700943d6a0b15ae504efce9f1ef3a31b59ad", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/0c8c700943d6a0b15ae504efce9f1ef3a31b59ad", "committedDate": "2020-06-22T02:34:49Z", "message": "Merge branch 'master' into cluster_premerge2\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/qp/physical/crud/InsertTabletPlan.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "304c8938e59206a4563fcb35dd1246ef0c03e6c0", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/304c8938e59206a4563fcb35dd1246ef0c03e6c0", "committedDate": "2020-06-28T02:34:36Z", "message": "Merge branch 'master' into cluster_premerge2\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/metadata/MManager.java\n#\tserver/src/main/java/org/apache/iotdb/db/qp/physical/crud/InsertTabletPlan.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c1795e2ef1df8f5b3ee02f69346994ada98c726", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/8c1795e2ef1df8f5b3ee02f69346994ada98c726", "committedDate": "2020-06-28T03:43:54Z", "message": "fix vunerability and remove duplication"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c95abfeb73d93b991fa7fa8ff2cf71ec9376577a", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/c95abfeb73d93b991fa7fa8ff2cf71ec9376577a", "committedDate": "2020-06-28T08:59:30Z", "message": "Merge branch 'master' into cluster_premerge2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37c8f5a227fe77171b92bb3d2e12a292a096c53d", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/37c8f5a227fe77171b92bb3d2e12a292a096c53d", "committedDate": "2020-06-29T01:58:20Z", "message": "add sync thread interruption"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "436a52409f76a6fc44001192a2b7703a0efd41b5", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/436a52409f76a6fc44001192a2b7703a0efd41b5", "committedDate": "2020-06-29T08:09:51Z", "message": "Merge branch 'master' into cluster_premerge2\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/engine/StorageEngine.java\n#\tserver/src/main/java/org/apache/iotdb/db/query/executor/QueryRouter.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed8ebef2e6865d82e0dc45ea5b08ded9e4a634c7", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/ed8ebef2e6865d82e0dc45ea5b08ded9e4a634c7", "committedDate": "2020-06-30T02:34:50Z", "message": "Merge branch 'master' into cluster_premerge2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "332d51b5b8dba3596eae3516dda0d279288ed6fd", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/332d51b5b8dba3596eae3516dda0d279288ed6fd", "committedDate": "2020-06-30T08:52:40Z", "message": "fix variable name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4ODUzMTg2", "url": "https://github.com/apache/iotdb/pull/1326#pullrequestreview-438853186", "createdAt": "2020-06-29T02:36:29Z", "commit": {"oid": "37c8f5a227fe77171b92bb3d2e12a292a096c53d"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQwMjozNjoyOVrOGqC82A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwODowNDozNlrOGrbRSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njc0MTcyMA==", "bodyText": "remove this?", "url": "https://github.com/apache/iotdb/pull/1326#discussion_r446741720", "createdAt": "2020-06-29T02:36:29Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/engine/version/VersionController.java", "diffHunk": "@@ -19,6 +19,8 @@\n \n package org.apache.iotdb.db.engine.version;\n \n+import java.io.IOException;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37c8f5a227fe77171b92bb3d2e12a292a096c53d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3NjM0Ng==", "bodyText": "what does the previous code do?", "url": "https://github.com/apache/iotdb/pull/1326#discussion_r448076346", "createdAt": "2020-07-01T02:09:55Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/engine/version/SimpleFileVersionController.java", "diffHunk": "@@ -144,7 +142,9 @@ private void restore() throws IOException {\n     } else {\n       versionFile = SystemFileFactory.INSTANCE.getFile(directory, FILE_PREFIX + \"0\");\n       prevVersion = 0;\n-      new FileOutputStream(versionFile).close();\n+      if (!versionFile.createNewFile()) {\n+        logger.warn(\"Cannot create new version file {}\", versionFile);\n+      }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "332d51b5b8dba3596eae3516dda0d279288ed6fd"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3NjQ3Nw==", "bodyText": "remove", "url": "https://github.com/apache/iotdb/pull/1326#discussion_r448076477", "createdAt": "2020-07-01T02:10:26Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/metadata/MManager.java", "diffHunk": "@@ -1133,9 +1138,15 @@ public MNode getDeviceNode(String path) throws MetadataException {\n   }\n \n   /**\n+<<<<<<< HEAD\n+   * To reduce the String number in memory, \n+   * use the deviceId from MManager instead of the deviceId read from disk\n+   * \n+=======", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "332d51b5b8dba3596eae3516dda0d279288ed6fd"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3NjUxMg==", "bodyText": "remove", "url": "https://github.com/apache/iotdb/pull/1326#discussion_r448076512", "createdAt": "2020-07-01T02:10:35Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/metadata/MManager.java", "diffHunk": "@@ -1133,9 +1138,15 @@ public MNode getDeviceNode(String path) throws MetadataException {\n   }\n \n   /**\n+<<<<<<< HEAD\n+   * To reduce the String number in memory, \n+   * use the deviceId from MManager instead of the deviceId read from disk\n+   * \n+=======\n    * To reduce the String number in memory, use the deviceId from MManager instead of the deviceId\n    * read from disk\n    *\n+>>>>>>> master", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "332d51b5b8dba3596eae3516dda0d279288ed6fd"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3NzcwNA==", "bodyText": "Could we reuse the MeasurementSchema?", "url": "https://github.com/apache/iotdb/pull/1326#discussion_r448077704", "createdAt": "2020-07-01T02:15:19Z", "author": {"login": "qiaojialin"}, "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/write/schema/TimeseriesSchema.java", "diffHunk": "@@ -0,0 +1,265 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.iotdb.tsfile.write.schema;\n+\n+import java.io.IOException;\n+import java.io.OutputStream;\n+import java.io.Serializable;\n+import java.nio.ByteBuffer;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+import org.apache.iotdb.tsfile.common.conf.TSFileDescriptor;\n+import org.apache.iotdb.tsfile.encoding.encoder.Encoder;\n+import org.apache.iotdb.tsfile.encoding.encoder.TSEncodingBuilder;\n+import org.apache.iotdb.tsfile.file.metadata.enums.CompressionType;\n+import org.apache.iotdb.tsfile.file.metadata.enums.TSDataType;\n+import org.apache.iotdb.tsfile.file.metadata.enums.TSEncoding;\n+import org.apache.iotdb.tsfile.utils.ReadWriteIOUtils;\n+import org.apache.iotdb.tsfile.utils.StringContainer;\n+\n+/**\n+ * TimeseriesSchema is like MeasurementSchema, but instead of measurementId, it stores the full\n+ * path.\n+ */\n+public class TimeseriesSchema implements Comparable<TimeseriesSchema>, Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "332d51b5b8dba3596eae3516dda0d279288ed6fd"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3ODA0Ng==", "bodyText": "add some javadoc, give an example of str", "url": "https://github.com/apache/iotdb/pull/1326#discussion_r448078046", "createdAt": "2020-07-01T02:16:39Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/utils/SerializeUtils.java", "diffHunk": "@@ -494,4 +494,21 @@ public static ByteBuffer serializeLongs(long[] longs) {\n     }\n     return ret;\n   }\n+\n+  public static Node stringToNode(String str) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "332d51b5b8dba3596eae3516dda0d279288ed6fd"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE4ODc0Ng==", "bodyText": "Extract -1 to a constant?", "url": "https://github.com/apache/iotdb/pull/1326#discussion_r448188746", "createdAt": "2020-07-01T08:04:36Z", "author": {"login": "qiaojialin"}, "path": "server/src/main/java/org/apache/iotdb/db/qp/physical/crud/InsertPlan.java", "diffHunk": "@@ -301,9 +296,14 @@ public void serialize(DataOutputStream stream) throws IOException {\n \n   private void putValues(DataOutputStream outputStream) throws QueryProcessException, IOException {\n     for (int i = 0; i < values.length; i++) {\n-      if (types[i] == null) {\n+      // types are not determined, the situation mainly occurs when the plan uses string values\n+      // and is forwarded to other nodes\n+      if (types == null || types[i] == null) {\n+        ReadWriteIOUtils.write((short) -1, outputStream);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "332d51b5b8dba3596eae3516dda0d279288ed6fd"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7b7bdcc167b581dfc5668677ae16abf6204dd42", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/f7b7bdcc167b581dfc5668677ae16abf6204dd42", "committedDate": "2020-07-01T08:52:44Z", "message": "fix review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2de26fe2b76178343613663296f33f506b1e6d30", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/2de26fe2b76178343613663296f33f506b1e6d30", "committedDate": "2020-07-01T13:09:24Z", "message": "Merge branch 'master' into cluster_premerge2\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java\n#\tserver/src/main/java/org/apache/iotdb/db/qp/physical/crud/InsertPlan.java\n#\tserver/src/main/java/org/apache/iotdb/db/qp/physical/crud/InsertTabletPlan.java\n#\tserver/src/test/java/org/apache/iotdb/db/tools/WalCheckerTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03634d75651e38dcb39fa64cfee1d6b7c926d4af", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/03634d75651e38dcb39fa64cfee1d6b7c926d4af", "committedDate": "2020-07-02T02:24:44Z", "message": "Merge branch 'master' into cluster_premerge2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55d7fdcf5de68128393c3c930fb9e39314c305d0", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/55d7fdcf5de68128393c3c930fb9e39314c305d0", "committedDate": "2020-07-02T08:40:51Z", "message": "fix dead wait in SyncServerManager and add retry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f8e68ddb67214d886f31c6f731a1ad35d837668", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/6f8e68ddb67214d886f31c6f731a1ad35d837668", "committedDate": "2020-07-03T01:53:29Z", "message": "Merge branch 'master' into cluster_premerge2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "beb9c6f94425d8bd01cec6de904e9f61c4335f37", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/beb9c6f94425d8bd01cec6de904e9f61c4335f37", "committedDate": "2020-07-03T02:06:06Z", "message": "fix method name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddd67904e0a5f69002ba4bee5be401ddca5fb2ec", "author": {"user": {"login": "jt2594838", "name": "Jiang Tian"}}, "url": "https://github.com/apache/iotdb/commit/ddd67904e0a5f69002ba4bee5be401ddca5fb2ec", "committedDate": "2020-07-06T02:04:45Z", "message": "Merge branch 'master' into cluster_premerge2\n\n# Conflicts:\n#\tserver/src/main/java/org/apache/iotdb/db/sync/receiver/SyncServerManager.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNTMxNDc2", "url": "https://github.com/apache/iotdb/pull/1326#pullrequestreview-443531476", "createdAt": "2020-07-07T03:07:05Z", "commit": {"oid": "ddd67904e0a5f69002ba4bee5be401ddca5fb2ec"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3777, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}