{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0ODYyOTU1", "number": 2222, "title": "[Distributed] fix session cache leader interface and docs ", "bodyText": "As cluster_new is  merged into master, It is better not to open the leader cache by default and give an parameter interface for distributed IoTDB, otherwise it will cause unnecessary performance waste to the stand-alone IoTDB.", "createdAt": "2020-12-09T03:08:57Z", "url": "https://github.com/apache/iotdb/pull/2222", "merged": true, "mergeCommit": {"oid": "af20b89d04e601c098349639ddd04ae7444e72f9"}, "closed": true, "closedAt": "2021-01-22T02:09:12Z", "author": {"login": "LebronAl"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkoplcAFqTU0ODczODc2Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdxp_74AH2gAyNTM0ODYyOTU1OjY2YzIzZjAzNjA1OTYwZmJmZTJlZDIwOTg2MGJkZjk2ZWZlNzlkNDU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NzM4NzY3", "url": "https://github.com/apache/iotdb/pull/2222#pullrequestreview-548738767", "createdAt": "2020-12-10T01:00:04Z", "commit": {"oid": "593d9ec8beb824fc9142fbea4bd40a47bb561a06"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwMTowMDowNFrOICwjHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwMTowMDowNFrOICwjHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTc2MzQ4NA==", "bodyText": "Where is this set?", "url": "https://github.com/apache/iotdb/pull/2222#discussion_r539763484", "createdAt": "2020-12-10T01:00:04Z", "author": {"login": "jt2594838"}, "path": "session/src/main/java/org/apache/iotdb/session/pool/SessionPool.java", "diffHunk": "@@ -75,6 +75,7 @@\n   private long timeout; //ms\n   private static int FINAL_RETRY = RETRY - 1;\n   private boolean enableCompression = false;\n+  private boolean enableCacheLeader = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "593d9ec8beb824fc9142fbea4bd40a47bb561a06"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5Nzg4MDgx", "url": "https://github.com/apache/iotdb/pull/2222#pullrequestreview-549788081", "createdAt": "2020-12-11T04:08:04Z", "commit": {"oid": "aff21fc6ad4df4c2e1fe02e30af9a224f66f1026"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNDowODowNFrOIDoPng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNDowODo1NFrOIDoQkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDY3NTk5OA==", "bodyText": "false -> Config.DEFAULT_CACHE_LEADER_MODE", "url": "https://github.com/apache/iotdb/pull/2222#discussion_r540675998", "createdAt": "2020-12-11T04:08:04Z", "author": {"login": "jixuan1989"}, "path": "session/src/main/java/org/apache/iotdb/session/pool/SessionPool.java", "diffHunk": "@@ -74,29 +74,36 @@\n   private int fetchSize;\n   private long timeout; //ms\n   private static int FINAL_RETRY = RETRY - 1;\n-  private boolean enableCompression = false;\n+  private boolean enableCompression;\n+  private boolean enableCacheLeader;\n   private ZoneId zoneId;\n \n   private boolean closed;//whether the queue is closed.\n \n   public SessionPool(String ip, int port, String user, String password, int maxSize) {\n-    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, false, null);\n+    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, false, null, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aff21fc6ad4df4c2e1fe02e30af9a224f66f1026"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDY3NjAzNw==", "bodyText": "false -> Config.DEFAULT_CACHE_LEADER_MODE", "url": "https://github.com/apache/iotdb/pull/2222#discussion_r540676037", "createdAt": "2020-12-11T04:08:09Z", "author": {"login": "jixuan1989"}, "path": "session/src/main/java/org/apache/iotdb/session/pool/SessionPool.java", "diffHunk": "@@ -74,29 +74,36 @@\n   private int fetchSize;\n   private long timeout; //ms\n   private static int FINAL_RETRY = RETRY - 1;\n-  private boolean enableCompression = false;\n+  private boolean enableCompression;\n+  private boolean enableCacheLeader;\n   private ZoneId zoneId;\n \n   private boolean closed;//whether the queue is closed.\n \n   public SessionPool(String ip, int port, String user, String password, int maxSize) {\n-    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, false, null);\n+    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, false, null, false);\n   }\n \n   public SessionPool(String ip, int port, String user, String password, int maxSize,\n       boolean enableCompression) {\n     this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, enableCompression,\n-        null);\n+        null, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aff21fc6ad4df4c2e1fe02e30af9a224f66f1026"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDY3NjA4Mg==", "bodyText": "false -> Config.DEFAULT_CACHE_LEADER_MODE", "url": "https://github.com/apache/iotdb/pull/2222#discussion_r540676082", "createdAt": "2020-12-11T04:08:23Z", "author": {"login": "jixuan1989"}, "path": "session/src/main/java/org/apache/iotdb/session/pool/SessionPool.java", "diffHunk": "@@ -74,29 +74,36 @@\n   private int fetchSize;\n   private long timeout; //ms\n   private static int FINAL_RETRY = RETRY - 1;\n-  private boolean enableCompression = false;\n+  private boolean enableCompression;\n+  private boolean enableCacheLeader;\n   private ZoneId zoneId;\n \n   private boolean closed;//whether the queue is closed.\n \n   public SessionPool(String ip, int port, String user, String password, int maxSize) {\n-    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, false, null);\n+    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, false, null, false);\n   }\n \n   public SessionPool(String ip, int port, String user, String password, int maxSize,\n       boolean enableCompression) {\n     this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, enableCompression,\n-        null);\n+        null, false);\n+  }\n+\n+  public SessionPool(String ip, int port, String user, String password, int maxSize,\n+      boolean enableCompression, boolean enableCacheLeader) {\n+    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, enableCompression,\n+        null, enableCacheLeader);\n   }\n \n   public SessionPool(String ip, int port, String user, String password, int maxSize,\n       ZoneId zoneId) {\n-    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, false, zoneId);\n+    this(ip, port, user, password, maxSize, Config.DEFAULT_FETCH_SIZE, 60_000, false, zoneId, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aff21fc6ad4df4c2e1fe02e30af9a224f66f1026"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDY3NjI0Mg==", "bodyText": "Is there some UT for set the enableCache as true?", "url": "https://github.com/apache/iotdb/pull/2222#discussion_r540676242", "createdAt": "2020-12-11T04:08:54Z", "author": {"login": "jixuan1989"}, "path": "session/src/test/java/org/apache/iotdb/session/pool/SessionPoolTest.java", "diffHunk": "@@ -164,7 +164,7 @@ private void correctQuery(SessionPool pool) {\n \n   @Test\n   public void tryIfTheServerIsRestart() {\n-    SessionPool pool = new SessionPool(\"127.0.0.1\", 6667, \"root\", \"root\", 3, 1, 6000, false, null);\n+    SessionPool pool = new SessionPool(\"127.0.0.1\", 6667, \"root\", \"root\", 3, 1, 6000, false, null, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aff21fc6ad4df4c2e1fe02e30af9a224f66f1026"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2b32eb8093d8ef0a18e8bb7f4201123d5bc499e", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/e2b32eb8093d8ef0a18e8bb7f4201123d5bc499e", "committedDate": "2020-12-28T03:27:39Z", "message": "fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e0b65a76b84ac1d650d1ec9966bb3fec2e1a455", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/5e0b65a76b84ac1d650d1ec9966bb3fec2e1a455", "committedDate": "2020-12-28T03:27:39Z", "message": "fix session pool"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bc85ab5e8a5ccba7f0716028e7abd46664b9452", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/2bc85ab5e8a5ccba7f0716028e7abd46664b9452", "committedDate": "2020-12-28T03:27:40Z", "message": "change default cacheLeader"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25714a3ce5d50488f663de616ce3219b070e5c60", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/25714a3ce5d50488f663de616ce3219b070e5c60", "committedDate": "2020-12-28T09:11:58Z", "message": "fix zeeppelin session init"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3140d0e67723bc51719260e5becc066de67808b", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/a3140d0e67723bc51719260e5becc066de67808b", "committedDate": "2021-01-11T02:49:34Z", "message": "Merge branch 'master' of github.com:Apache/incubator-iotdb into cluster_fix_session"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cf3f601e3b657de0bdd995ac7ba5bd9ee86da1d6", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/cf3f601e3b657de0bdd995ac7ba5bd9ee86da1d6", "committedDate": "2020-12-11T12:57:51Z", "message": "change default cacheLeader"}, "afterCommit": {"oid": "a3140d0e67723bc51719260e5becc066de67808b", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/a3140d0e67723bc51719260e5becc066de67808b", "committedDate": "2021-01-11T02:49:34Z", "message": "Merge branch 'master' of github.com:Apache/incubator-iotdb into cluster_fix_session"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0dfa37dddf127608560e9513c8a745136d032fd7", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/0dfa37dddf127608560e9513c8a745136d032fd7", "committedDate": "2021-01-11T09:45:33Z", "message": "add cache leader UT && fix inserTablets judgement error"}, "afterCommit": {"oid": "1fa0887e008f4cbad7e264747bd04e001c3e84ce", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/1fa0887e008f4cbad7e264747bd04e001c3e84ce", "committedDate": "2021-01-11T09:46:33Z", "message": "add cache leader UT && fix inserTablets judgement error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c41ec775ddcc622f3ac39cfae2d5124a9afb4843", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/c41ec775ddcc622f3ac39cfae2d5124a9afb4843", "committedDate": "2021-01-11T09:57:47Z", "message": "add cache leader UT && fix inserTablets judgement error"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1fa0887e008f4cbad7e264747bd04e001c3e84ce", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/1fa0887e008f4cbad7e264747bd04e001c3e84ce", "committedDate": "2021-01-11T09:46:33Z", "message": "add cache leader UT && fix inserTablets judgement error"}, "afterCommit": {"oid": "c41ec775ddcc622f3ac39cfae2d5124a9afb4843", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/c41ec775ddcc622f3ac39cfae2d5124a9afb4843", "committedDate": "2021-01-11T09:57:47Z", "message": "add cache leader UT && fix inserTablets judgement error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8be30f75e6ae2eecc54cb5a3670004cbf1b2a571", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/8be30f75e6ae2eecc54cb5a3670004cbf1b2a571", "committedDate": "2021-01-14T07:49:19Z", "message": "Merge branch 'master' of github.com:Apache/incubator-iotdb into cluster_fix_session"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac0ed556fd9a44481ae48793238bac9dcff8b705", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/ac0ed556fd9a44481ae48793238bac9dcff8b705", "committedDate": "2021-01-14T07:57:51Z", "message": "delete useless doc && revert inserttablets redirection"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8cc200c3bcddfe5300c95cc67105affc99691a0b", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/8cc200c3bcddfe5300c95cc67105affc99691a0b", "committedDate": "2021-01-14T07:52:02Z", "message": "delete useless doc && revert inserttablets redirection"}, "afterCommit": {"oid": "ac0ed556fd9a44481ae48793238bac9dcff8b705", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/ac0ed556fd9a44481ae48793238bac9dcff8b705", "committedDate": "2021-01-14T07:57:51Z", "message": "delete useless doc && revert inserttablets redirection"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcwMTI5MzQ1", "url": "https://github.com/apache/iotdb/pull/2222#pullrequestreview-570129345", "createdAt": "2021-01-18T02:01:51Z", "commit": {"oid": "ac0ed556fd9a44481ae48793238bac9dcff8b705"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOFQwMjowMTo1MVrOIVXu9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOFQwMjowMTo1MVrOIVXu9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTI3OTg2Mg==", "bodyText": "It would be better to use an annotation, and please format the code.", "url": "https://github.com/apache/iotdb/pull/2222#discussion_r559279862", "createdAt": "2021-01-18T02:01:51Z", "author": {"login": "jt2594838"}, "path": "session/src/main/java/org/apache/iotdb/session/SessionConnection.java", "diffHunk": "@@ -67,6 +67,9 @@\n   private ZoneId zoneId;\n   private EndPoint endPoint;\n \n+  //TestOnly\n+  public SessionConnection(){}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac0ed556fd9a44481ae48793238bac9dcff8b705"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7a10f73d49ad5250d76806fa97dd25e5b69428a", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/e7a10f73d49ad5250d76806fa97dd25e5b69428a", "committedDate": "2021-01-18T06:10:09Z", "message": "format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c65e74b1921c0dc118d684def29269d4a92870f", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/7c65e74b1921c0dc118d684def29269d4a92870f", "committedDate": "2021-01-18T06:27:36Z", "message": "Merge branch 'master' of github.com:Apache/incubator-iotdb into cluster_fix_session"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66c23f03605960fbfe2ed209860bdf96efe79d45", "author": {"user": {"login": "LebronAl", "name": "Potato"}}, "url": "https://github.com/apache/iotdb/commit/66c23f03605960fbfe2ed209860bdf96efe79d45", "committedDate": "2021-01-19T11:55:28Z", "message": "Merge branch 'master' of github.com:Apache/incubator-iotdb into cluster_fix_session"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4079, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}