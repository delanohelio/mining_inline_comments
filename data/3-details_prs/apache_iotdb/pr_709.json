{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5NTUyMTMx", "number": 709, "title": "[IOTDB-401]Correct the calculation of a chunk if there is no data in the chunk", "bodyText": "when flushing a chunk, tsfile will calculate the size of the chunk and compare the size and the actual data size in the output stream.\nWhen calculating the size, the chunk header is calculated (which has the measurement id and therefore the size always > 0 ). However, if we find the chunk has no data points, we do not flush anything.\nIn this case, the size ( >0 ) != the actual size (=0).\nThis PR fixes the above case.", "createdAt": "2020-01-06T13:51:54Z", "url": "https://github.com/apache/iotdb/pull/709", "merged": true, "mergeCommit": {"oid": "8a2205bec5d79d910fa938572db7962671c76f82"}, "closed": true, "closedAt": "2020-01-09T01:03:14Z", "author": {"login": "jixuan1989"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb3sb75AH2gAyMzU5NTUyMTMxOjZkNjViNzQzZDYyYTI2MDAxNTliNWNkMWEyNDZmYWE0MjI1NjU0MjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4Rt7BAH2gAyMzU5NTUyMTMxOmMwNzRjOWEyMWI4MmNjYWFjOGRiOTU4OThiODVjZWE3YmEyYTc3YjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6d65b743d62a2600159b5cd1a246faa422565424", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/6d65b743d62a2600159b5cd1a246faa422565424", "committedDate": "2020-01-06T13:47:06Z", "message": "IOTDB-401, skip the size of a chunk header if the chunk has no data points"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99f9ef9e2390750425623159dad4d7d6768d1a4d", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/99f9ef9e2390750425623159dad4d7d6768d1a4d", "committedDate": "2020-01-06T13:47:36Z", "message": "Merge branch 'master' of github.com:apache/incubator-iotdb"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30e562f7573284f427f94f8910e3ebe171915839", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/30e562f7573284f427f94f8910e3ebe171915839", "committedDate": "2020-01-06T14:09:09Z", "message": "support jdk8"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "661d27bc06ffaec7f776b9921df1f6838c04d925", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/661d27bc06ffaec7f776b9921df1f6838c04d925", "committedDate": "2020-01-06T14:21:16Z", "message": "fix code smell"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5MDg5NTM5", "url": "https://github.com/apache/iotdb/pull/709#pullrequestreview-339089539", "createdAt": "2020-01-07T08:27:48Z", "commit": {"oid": "661d27bc06ffaec7f776b9921df1f6838c04d925"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QwODoyNzo0OFrOFaynXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QwODoyNzo0OFrOFaynXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzYzNjU3Mg==", "bodyText": "Is this check necessary?", "url": "https://github.com/apache/iotdb/pull/709#discussion_r363636572", "createdAt": "2020-01-07T08:27:48Z", "author": {"login": "qiaojialin"}, "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/write/chunk/ChunkWriterImpl.java", "diffHunk": "@@ -231,6 +231,9 @@ public long estimateMaxSeriesMemSize() {\n \n   @Override\n   public long getCurrentChunkSize() {\n+    if (this.getCurrentDataSize() == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "661d27bc06ffaec7f776b9921df1f6838c04d925"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1b833d16192f0ab8eef8e726ed4d1288d706f33", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/d1b833d16192f0ab8eef8e726ed4d1288d706f33", "committedDate": "2020-01-07T16:58:22Z", "message": "in ChunkWriterImpl, use pageBuffer.size() to replace ChunkWriterImpl"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c074c9a21b82ccaac8db95898b85cea7ba2a77b0", "author": {"user": null}, "url": "https://github.com/apache/iotdb/commit/c074c9a21b82ccaac8db95898b85cea7ba2a77b0", "committedDate": "2020-01-08T09:13:14Z", "message": "fix sonarCloud reported bug"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3200, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}