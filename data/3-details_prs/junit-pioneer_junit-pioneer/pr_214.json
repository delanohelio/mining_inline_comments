{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2ODAzOTk1", "number": 214, "title": "Improve GitHub Actions workflow", "bodyText": "Improves the current GitHub Actions workflow by several means:\n\nCache Gradle and Sonar files, see Travis example e.g. here.\nFetch unshallow to enable blame for Sonar, see warning e.g. here.\nUse step names consistently.\n\nAlso note that according to the SonarCloud GitHub Action, we should not use the action itself but the SonarQube plugin for Gradle during the build. I'm a Gradle noob, but can have a look later on if nobody is quicker?\nRealized that this is already done. \ud83d\udc4d\nProposed commit message:\nImprove GitHub Actions workflow\n\n* Cache Gradle and Sonar files.\n* Fetch unshallow to enable blame for Sonar.\n* Use step names consistently.\n\nPR: 214\n\n\nI hereby agree to the terms of the JUnit Pioneer Contributor License Agreement.", "createdAt": "2020-04-01T07:13:17Z", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/214", "merged": true, "mergeCommit": {"oid": "9460563ee1a7b2fb1234ed2898394feb8eef0e71"}, "closed": true, "closedAt": "2020-04-07T14:57:14Z", "author": {"login": "beatngu13"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTSA9dgH2gAyMzk2ODAzOTk1OjQ0MDkxZDVkZDkyZjlmYzkwYjU3OWFmZWJjMGIwN2MxZjgyYTljZDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTYRYagFqTM4NTYyMDYzNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "44091d5dd92f9fc90b579afebc0b07c1f82a9cd2", "author": {"user": {"login": "beatngu13", "name": "Daniel Kraus"}}, "url": "https://github.com/junit-pioneer/junit-pioneer/commit/44091d5dd92f9fc90b579afebc0b07c1f82a9cd2", "committedDate": "2020-04-01T06:49:59Z", "message": "Cache Sonar files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9883bae8aae518e260d433ca03b5ba819f85609", "author": {"user": {"login": "beatngu13", "name": "Daniel Kraus"}}, "url": "https://github.com/junit-pioneer/junit-pioneer/commit/d9883bae8aae518e260d433ca03b5ba819f85609", "committedDate": "2020-04-01T06:52:53Z", "message": "Fetch unshallow to enable blame for Sonar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb20a768e235c766ae14f1e3551dea2b39a8df11", "author": {"user": {"login": "beatngu13", "name": "Daniel Kraus"}}, "url": "https://github.com/junit-pioneer/junit-pioneer/commit/fb20a768e235c766ae14f1e3551dea2b39a8df11", "committedDate": "2020-04-01T06:54:23Z", "message": "Use name consistently for all steps"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7939d4576e8daef617c16c36ae414b601c2289cb", "author": {"user": {"login": "beatngu13", "name": "Daniel Kraus"}}, "url": "https://github.com/junit-pioneer/junit-pioneer/commit/7939d4576e8daef617c16c36ae414b601c2289cb", "committedDate": "2020-04-01T07:16:42Z", "message": "Cache Gradle files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c3d94591eba9d08fa43c30a4e7983a0c041f028", "author": {"user": {"login": "beatngu13", "name": "Daniel Kraus"}}, "url": "https://github.com/junit-pioneer/junit-pioneer/commit/8c3d94591eba9d08fa43c30a4e7983a0c041f028", "committedDate": "2020-04-01T09:08:00Z", "message": "Always build on push\n\nAccording to the docs:\n\n* https://help.github.com/en/actions/reference/events-that-trigger-workflows#pull-request-event-pull_request\n* https://help.github.com/en/actions/reference/events-that-trigger-workflows#push-event-push\n\n`pull_request` is for PRs from forked repos. `push` is for pushes to any branch, which I think is helpful for contributors to check there own builds."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NDc5MjEw", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/214#pullrequestreview-385479210", "createdAt": "2020-04-01T11:02:03Z", "commit": {"oid": "8c3d94591eba9d08fa43c30a4e7983a0c041f028"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMTowMjowM1rOF-7jHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMTowMjowM1rOF-7jHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUzMTY3Ng==", "bodyText": "i do not think that we really need a build on each push to all branches. master alone is fine. Based on shipkit we also do not want build on tags i think.", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/214#discussion_r401531676", "createdAt": "2020-04-01T11:02:03Z", "author": {"login": "aepfli"}, "path": ".github/workflows/actions.yml", "diffHunk": "@@ -3,11 +3,7 @@\n \n name: JUnit Pioneer Flow\n \n-on:\n-  push:\n-    branches: [ master ]\n-  pull_request:\n-    branches: '*'\n+on: [push, pull_request]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c3d94591eba9d08fa43c30a4e7983a0c041f028"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NDgzODM5", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/214#pullrequestreview-385483839", "createdAt": "2020-04-01T11:09:36Z", "commit": {"oid": "8c3d94591eba9d08fa43c30a4e7983a0c041f028"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMTowOTozNlrOF-7xLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMTowOTozNlrOF-7xLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUzNTI3Nw==", "bodyText": "not sure if we need an extra step we could also inline this into the checkout step - https://github.com/actions/checkout#fetch-all-history-for-all-tags-and-branches", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/214#discussion_r401535277", "createdAt": "2020-04-01T11:09:36Z", "author": {"login": "aepfli"}, "path": ".github/workflows/actions.yml", "diffHunk": "@@ -19,11 +15,26 @@ jobs:\n         os: [ubuntu-latest, windows-latest, macos-latest]\n     name: ${{ matrix.os }} - Java ${{ matrix.java }}\n     steps:\n-      - uses: actions/checkout@v2\n+      - name: Check out repo\n+        uses: actions/checkout@v2\n+        # fetch unshallow to enable blame for Sonar\n+      - name: Fetch unshallow", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c3d94591eba9d08fa43c30a4e7983a0c041f028"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NDg1ODgy", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/214#pullrequestreview-385485882", "createdAt": "2020-04-01T11:12:40Z", "commit": {"oid": "8c3d94591eba9d08fa43c30a4e7983a0c041f028"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMToxMjo0MVrOF-73Zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMToxMjo0MVrOF-73Zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUzNjg3MA==", "bodyText": "sonar only runs on ubuntu and only on one JDK - maybe we should take this into consideration.", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/214#discussion_r401536870", "createdAt": "2020-04-01T11:12:41Z", "author": {"login": "aepfli"}, "path": ".github/workflows/actions.yml", "diffHunk": "@@ -19,11 +15,26 @@ jobs:\n         os: [ubuntu-latest, windows-latest, macos-latest]\n     name: ${{ matrix.os }} - Java ${{ matrix.java }}\n     steps:\n-      - uses: actions/checkout@v2\n+      - name: Check out repo\n+        uses: actions/checkout@v2\n+        # fetch unshallow to enable blame for Sonar\n+      - name: Fetch unshallow\n+        run: git fetch --prune --unshallow\n       - name: Setup java\n         uses: actions/setup-java@v1\n         with:\n           java-version: ${{ matrix.java }}\n+      - name: Cache Gradle\n+        uses: actions/cache@v1\n+        with:\n+          path: ~/.gradle/caches/\n+          key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}\n+          restore-keys: ${{ runner.os }}-gradle-\n+      - name: Cache Sonar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c3d94591eba9d08fa43c30a4e7983a0c041f028"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba0cd52fec84eae7f8b2aad8628c254ee7793187", "author": {"user": {"login": "beatngu13", "name": "Daniel Kraus"}}, "url": "https://github.com/junit-pioneer/junit-pioneer/commit/ba0cd52fec84eae7f8b2aad8628c254ee7793187", "committedDate": "2020-04-01T13:30:52Z", "message": "Revert \"Always build on push\"\n\nThis reverts commit 8c3d94591eba9d08fa43c30a4e7983a0c041f028."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73604de1a3fef4e2b73961d5fdcf6f676653367a", "author": {"user": {"login": "beatngu13", "name": "Daniel Kraus"}}, "url": "https://github.com/junit-pioneer/junit-pioneer/commit/73604de1a3fef4e2b73961d5fdcf6f676653367a", "committedDate": "2020-04-01T13:34:50Z", "message": "Cache conditionally\n\nAnd move `if` from \"Sonarqube\" step upwards, similar to \"Upload Release to GitHub\"."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NjIwNjM2", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/214#pullrequestreview-385620636", "createdAt": "2020-04-01T14:07:21Z", "commit": {"oid": "73604de1a3fef4e2b73961d5fdcf6f676653367a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3738, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}