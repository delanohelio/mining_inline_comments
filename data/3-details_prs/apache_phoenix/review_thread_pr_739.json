{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxOTIwMTc4", "number": 739, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNTozODo1MVrODqPaSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNTozODo1MVrODqPaSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NjE5Mjc1OnYy", "diffSide": "RIGHT", "path": "phoenix-core/src/main/java/org/apache/phoenix/hbase/index/IndexRegionObserver.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNTozODo1MVrOF53fVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNjoxMToyMlrOF538Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIyMjI5NQ==", "bodyText": "@kadirozde Are the immutable table/indexes inherently doing these delete mutations on both data and index since they don't check for presence anyways?", "url": "https://github.com/apache/phoenix/pull/739#discussion_r396222295", "createdAt": "2020-03-23T05:38:51Z", "author": {"login": "priyankporwal"}, "path": "phoenix-core/src/main/java/org/apache/phoenix/hbase/index/IndexRegionObserver.java", "diffHunk": "@@ -517,6 +517,11 @@ private void applyPendingDeleteMutations(MiniBatchOperationInProgress<Mutation>\n             }\n             Put nextDataRowState = dataRowState.getSecond();\n             if (nextDataRowState == null) {\n+                if (dataRowState.getFirst() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0363b3ca4ffe653f44306d817d337553e33efe1"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIyOTY0Mw==", "bodyText": "Initially, I thought deleting a non-existing row would lead to false invalid row detection and filed this JIRA. Later I found that actually deleting a non-existing row does not confuse the IndexTool verification. This PR is just not to confuse humans when they inspect the raw mutations for mutable data and index tables as they would see a delete mutation on the data table and but no corresponding mutation on the index table. The check for non-existing row is done on the server side and thus it is not for immutable tables as you observed. The potential confusion for immutable table will be still there. I thought we should at least remove this possible confusion for mutable tables.", "url": "https://github.com/apache/phoenix/pull/739#discussion_r396229643", "createdAt": "2020-03-23T06:11:22Z", "author": {"login": "kadirozde"}, "path": "phoenix-core/src/main/java/org/apache/phoenix/hbase/index/IndexRegionObserver.java", "diffHunk": "@@ -517,6 +517,11 @@ private void applyPendingDeleteMutations(MiniBatchOperationInProgress<Mutation>\n             }\n             Put nextDataRowState = dataRowState.getSecond();\n             if (nextDataRowState == null) {\n+                if (dataRowState.getFirst() == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIyMjI5NQ=="}, "originalCommit": {"oid": "f0363b3ca4ffe653f44306d817d337553e33efe1"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4636, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}