{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA5MTAxMjgz", "number": 937, "title": "PHOENIX-6198 Add option to IndexTool to specify the source table for scan", "bodyText": "Part of PHOENIX-6182\nNew option -fi or --from-index added. When specified, use the index table as the source for verification. Inly works with -vBEFORE and -vONLY options.", "createdAt": "2020-10-23T17:14:53Z", "url": "https://github.com/apache/phoenix/pull/937", "merged": true, "mergeCommit": {"oid": "0d33ce934d4405a1e534264875abaec7e5ee82f1"}, "closed": true, "closedAt": "2020-11-09T17:54:18Z", "author": {"login": "tkhurana"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVZuADgH2gAyNTA5MTAxMjgzOmJhMmY1YTAxYjgzNGU1ZTBhMjEwMGJlNWNlNTdhNTkzODEzMmUzNDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABda4kTQAFqTUyNjUwODMyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ba2f5a01b834e5e0a2100be5ce57a5938132e345", "author": {"user": {"login": "tkhurana", "name": null}}, "url": "https://github.com/apache/phoenix/commit/ba2f5a01b834e5e0a2100be5ce57a5938132e345", "committedDate": "2020-10-23T17:07:31Z", "message": "PHOENIX-6198 Add option to IndexTool to specify the source table for scan"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1ODY2MDg0", "url": "https://github.com/apache/phoenix/pull/937#pullrequestreview-515866084", "createdAt": "2020-10-23T17:25:55Z", "commit": {"oid": "ba2f5a01b834e5e0a2100be5ce57a5938132e345"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNzoyNTo1NVrOHnW5BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNzoyODo0OFrOHnW-uA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAzMTU1Nw==", "bodyText": "nit: We have a similar enum in the IndexScrutinyTool. Can we re use it?", "url": "https://github.com/apache/phoenix/pull/937#discussion_r511031557", "createdAt": "2020-10-23T17:25:55Z", "author": {"login": "gokceni"}, "path": "phoenix-core/src/main/java/org/apache/phoenix/mapreduce/index/IndexTool.java", "diffHunk": "@@ -192,6 +191,14 @@ public static IndexDisableLoggingType fromValue(byte[] value) {\n         }\n     }\n \n+    /**\n+     * Which table to use as the source table\n+     */\n+    public enum SourceTable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba2f5a01b834e5e0a2100be5ce57a5938132e345"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAzMzAxNg==", "bodyText": "I think stating this is clearer: This option is applicable only when -v ONLY or -v BEFORE is provided.", "url": "https://github.com/apache/phoenix/pull/937#discussion_r511033016", "createdAt": "2020-10-23T17:28:48Z", "author": {"login": "gokceni"}, "path": "phoenix-core/src/main/java/org/apache/phoenix/mapreduce/index/IndexTool.java", "diffHunk": "@@ -285,6 +293,11 @@ public static IndexDisableLoggingType fromValue(byte[] value) {\n         , \"Disable logging of failed verification rows for BEFORE, \" +\n         \"AFTER, or BOTH verify jobs\");\n \n+    private static final Option USE_INDEX_TABLE_AS_SOURCE_OPTION =\n+        new Option(\"fi\", \"from-index\", false,\n+            \"To verify every row in the index table has a corresponding row in the data table. \" +\n+                \"Only supported for global indexes. This option is applicable to BEFORE and ONLY type verification jobs\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba2f5a01b834e5e0a2100be5ce57a5938132e345"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d77d0121c67e27ec84420fe2a829f2ddcee5de0", "author": {"user": {"login": "tkhurana", "name": null}}, "url": "https://github.com/apache/phoenix/commit/9d77d0121c67e27ec84420fe2a829f2ddcee5de0", "committedDate": "2020-10-29T07:39:27Z", "message": "Addressed feedback for PHOENIX-6198\n\nExtended the `-from-index` option to support -vBOTH, -vAFTER and -vNONE.\nAdded the disclaimer for -vAFTER. Also, using the source table enum from\nIndexScrutinyTool."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMTIyMDkx", "url": "https://github.com/apache/phoenix/pull/937#pullrequestreview-520122091", "createdAt": "2020-10-29T22:05:02Z", "commit": {"oid": "9d77d0121c67e27ec84420fe2a829f2ddcee5de0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMjowNTowMlrOHqwXPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMjowNTowMlrOHqwXPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU5NDYyMQ==", "bodyText": "IndexScrutinyTool.SourceTable.DATA_TABLE_SOURCE.name() the default value?", "url": "https://github.com/apache/phoenix/pull/937#discussion_r514594621", "createdAt": "2020-10-29T22:05:02Z", "author": {"login": "priyankporwal"}, "path": "phoenix-core/src/main/java/org/apache/phoenix/mapreduce/util/PhoenixConfigurationUtil.java", "diffHunk": "@@ -660,6 +663,19 @@ public static String getIndexToolIndexTableName(Configuration configuration) {\n         return configuration.get(INDEX_TOOL_INDEX_TABLE_NAME);\n     }\n \n+    public static void setIndexToolSourceTable(Configuration configuration,\n+            IndexScrutinyTool.SourceTable sourceTable) {\n+        Preconditions.checkNotNull(configuration);\n+        Preconditions.checkNotNull(sourceTable);\n+        configuration.set(INDEX_TOOL_SOURCE_TABLE, sourceTable.name());\n+    }\n+\n+    public static IndexScrutinyTool.SourceTable getIndexToolSourceTable(Configuration configuration) {\n+        Preconditions.checkNotNull(configuration);\n+        return IndexScrutinyTool.SourceTable.valueOf(configuration.get(INDEX_TOOL_SOURCE_TABLE,\n+            IndexScrutinyTool.SourceTable.DATA_TABLE_SOURCE.name()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d77d0121c67e27ec84420fe2a829f2ddcee5de0"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNzI2NDM4", "url": "https://github.com/apache/phoenix/pull/937#pullrequestreview-523726438", "createdAt": "2020-11-04T20:53:11Z", "commit": {"oid": "9d77d0121c67e27ec84420fe2a829f2ddcee5de0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2NTA4MzI0", "url": "https://github.com/apache/phoenix/pull/937#pullrequestreview-526508324", "createdAt": "2020-11-09T17:53:36Z", "commit": {"oid": "9d77d0121c67e27ec84420fe2a829f2ddcee5de0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1809, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}