{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxOTcxMzMz", "number": 1384, "title": "Build Block Blooms Database (2.2.0)", "bodyText": "fit: 2.2-rc\nDescription\nUsing a new configuration option, the build and save of block blooms data could be executed within the normal operation of the node. This data is used to retrieve log information efficiently.\nMotivation and Context\nUsually, this block blooms information is used only in nodes that has JSON RPC open, and log query operation enabled. And with the first query, the data is build and saved. But even with this feature, the operation could take many minutes and resources from the node.\nSo, this new code allow the build of the same data along the blockchain node normal processing, ie, during long synchronization or normal synchronization. To do this, a new internal service was added, and it is activated by configuration (the default value is not activated),\nHow Has This Been Tested?\nIt has code tests, and also was tested running a long sync against testnet network,\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to not work as expected)\n\nChecklist:\n\n\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n Tests for the changes have been added (for bug fixes / features)\n Requires Activation Code (Hard Fork)\n\n\nOther information:", "createdAt": "2020-12-03T18:00:19Z", "url": "https://github.com/rsksmart/rskj/pull/1384", "merged": true, "mergeCommit": {"oid": "911e9f86ed30d4c3beb26d0b34d726b83107f8d9"}, "closed": true, "closedAt": "2020-12-23T18:29:09Z", "author": {"login": "ajlopezrsk"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdlOQEFgFqTU1MDU2NTQwOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpDJNJAFqTU1ODE1Mzc1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwNTY1NDA4", "url": "https://github.com/rsksmart/rskj/pull/1384#pullrequestreview-550565408", "createdAt": "2020-12-11T20:44:48Z", "commit": {"oid": "bd5ee2ec65782112391fc46a2b565828fad76469"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQyMDo0NDo0OFrOIEMgXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQyMDo0NDo0OFrOIEMgXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTI3MDEwOA==", "bodyText": "Why in nano?", "url": "https://github.com/rsksmart/rskj/pull/1384#discussion_r541270108", "createdAt": "2020-12-11T20:44:48Z", "author": {"login": "patogallaiovlabs"}, "path": "rskj-core/src/main/java/co/rsk/core/bc/BlockChainFlusher.java", "diffHunk": "@@ -110,18 +107,16 @@ private void flushAll() {\n         totalTime = System.nanoTime() - saveTime;\n \n         if (logger.isTraceEnabled()) {\n-            logger.trace(\"receiptstore flush: [{}]seconds\", FormatUtils.formatNanosecondsToSeconds(totalTime));\n+            logger.trace(\"receiptstore flush: [{}]nano\", totalTime);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd5ee2ec65782112391fc46a2b565828fad76469"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "240dde7d722b088bf7737e7de94aaf2043701f01", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/240dde7d722b088bf7737e7de94aaf2043701f01", "committedDate": "2020-12-03T19:53:06Z", "message": "Fix BlockStore, BlockChainFlusher"}, "afterCommit": {"oid": "9e739b221d734350772d75a025cb35909a0b4e88", "author": {"user": {"login": "fedejinich", "name": "Fede Jinich"}}, "url": "https://github.com/rsksmart/rskj/commit/9e739b221d734350772d75a025cb35909a0b4e88", "committedDate": "2020-12-11T21:53:24Z", "message": "extracted methods for BlocksBloomProcessor"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cbd7cabbe826d8064c57453a6b8a19f25fa63759", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/cbd7cabbe826d8064c57453a6b8a19f25fa63759", "committedDate": "2020-12-14T14:34:02Z", "message": "Removing unused imports"}, "afterCommit": {"oid": "4f4631f5a3e0e0eb7e33c0214ef78c7701b680fa", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/4f4631f5a3e0e0eb7e33c0214ef78c7701b680fa", "committedDate": "2020-12-21T19:45:52Z", "message": "Removing unused imports"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f4631f5a3e0e0eb7e33c0214ef78c7701b680fa", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/4f4631f5a3e0e0eb7e33c0214ef78c7701b680fa", "committedDate": "2020-12-21T19:45:52Z", "message": "Removing unused imports"}, "afterCommit": {"oid": "5809896375872ab70f8e94405793eaf798c19b51", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/5809896375872ab70f8e94405793eaf798c19b51", "committedDate": "2020-12-22T14:10:59Z", "message": "Removing unused imports"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5809896375872ab70f8e94405793eaf798c19b51", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/5809896375872ab70f8e94405793eaf798c19b51", "committedDate": "2020-12-22T14:10:59Z", "message": "Removing unused imports"}, "afterCommit": {"oid": "06c311caa9499055d42193f3ffbb3a63d432d8b0", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/06c311caa9499055d42193f3ffbb3a63d432d8b0", "committedDate": "2020-12-23T15:37:28Z", "message": "Removing unused imports"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "06c311caa9499055d42193f3ffbb3a63d432d8b0", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/06c311caa9499055d42193f3ffbb3a63d432d8b0", "committedDate": "2020-12-23T15:37:28Z", "message": "Removing unused imports"}, "afterCommit": {"oid": "6443014df222d2cd6f8c23970f22a2955df2cfc7", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/6443014df222d2cd6f8c23970f22a2955df2cfc7", "committedDate": "2020-12-23T16:27:27Z", "message": "Removing unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9e010cc36a3c4fb43e8db7a26ff828f006ffcbd", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/b9e010cc36a3c4fb43e8db7a26ff828f006ffcbd", "committedDate": "2020-12-23T17:44:58Z", "message": "Adding blocks to BlocksBloomBuilder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a450fc99364e57db84c56b191b1ddc0a9639cf74", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/a450fc99364e57db84c56b191b1ddc0a9639cf74", "committedDate": "2020-12-23T17:44:58Z", "message": "BlocksBloomBuilder saves BlocksBloom in process"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0655a43726c865fab81a2587058e964f6035a42", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/f0655a43726c865fab81a2587058e964f6035a42", "committedDate": "2020-12-23T17:44:58Z", "message": "Bloom blocks configuration, service, synchronized store"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a158fed698b86cc9e7dd20bbbf9787231c7beae4", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/a158fed698b86cc9e7dd20bbbf9787231c7beae4", "committedDate": "2020-12-23T17:44:58Z", "message": "Set default no of blocks to 64; logging messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "143068fa81ae5745c68f41e0381748fcdfdd5692", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/143068fa81ae5745c68f41e0381748fcdfdd5692", "committedDate": "2020-12-23T17:44:58Z", "message": "Remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4ae3610611bbe2f79883ddf9e357552f5a193d2", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/d4ae3610611bbe2f79883ddf9e357552f5a193d2", "committedDate": "2020-12-23T17:44:59Z", "message": "Rename BlocksBloomBuilder to BlocksBloomProcessor; rename setBlocksBloom method to addBlocksBloom; rename blocksBloom private variable to blocksBloomCache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "056198db1569aa3933f6be6b4d8e0e47cdba82ec", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/056198db1569aa3933f6be6b4d8e0e47cdba82ec", "committedDate": "2020-12-23T17:44:59Z", "message": "Fix bug and refactor method BlocksBloomStore hasBlockNumber"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1595742ba87202dd34f96d93b3dd3954b0a57d0a", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/1595742ba87202dd34f96d93b3dd3954b0a57d0a", "committedDate": "2020-12-23T17:44:59Z", "message": "Avoid processing negative block number; adding synchronization; adding visibility for testing; use HashMap instead of ConcurrentHashMap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5babc64d13811c3e7f7b8746ff042a5c164c361", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/a5babc64d13811c3e7f7b8746ff042a5c164c361", "committedDate": "2020-12-23T17:44:59Z", "message": "Adding comments to classes and methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8d5dcba4de55bdacc48587c5b37093042b532aa", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/b8d5dcba4de55bdacc48587c5b37093042b532aa", "committedDate": "2020-12-23T17:44:59Z", "message": "Adding null checks to BlocksBloomStore dataSource"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c97f7a804922c6c9696b7eb82fc023c6dd27469", "author": {"user": {"login": "fedejinich", "name": "Fede Jinich"}}, "url": "https://github.com/rsksmart/rskj/commit/0c97f7a804922c6c9696b7eb82fc023c6dd27469", "committedDate": "2020-12-23T17:44:59Z", "message": "extracted methods for BlocksBloomProcessor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bac5b812ac95a989de7d0eedf7705d76a5aa5c0", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/7bac5b812ac95a989de7d0eedf7705d76a5aa5c0", "committedDate": "2020-12-23T17:45:00Z", "message": "Time in nanoseconds in BlockChainFlusher (FormatUtils is still not present in 2.2.0-rc)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11dc6b8fbb077b605596822452763ad2324f75a7", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/11dc6b8fbb077b605596822452763ad2324f75a7", "committedDate": "2020-12-23T17:45:00Z", "message": "Removing unused imports"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6443014df222d2cd6f8c23970f22a2955df2cfc7", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/6443014df222d2cd6f8c23970f22a2955df2cfc7", "committedDate": "2020-12-23T16:27:27Z", "message": "Removing unused imports"}, "afterCommit": {"oid": "11dc6b8fbb077b605596822452763ad2324f75a7", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/11dc6b8fbb077b605596822452763ad2324f75a7", "committedDate": "2020-12-23T17:45:00Z", "message": "Removing unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03ba92fe684453bfaee29dc42633375b716501bb", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/03ba92fe684453bfaee29dc42633375b716501bb", "committedDate": "2020-12-23T17:47:16Z", "message": "Improve reference.conf declaration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4MTUzNzU3", "url": "https://github.com/rsksmart/rskj/pull/1384#pullrequestreview-558153757", "createdAt": "2020-12-23T18:07:54Z", "commit": {"oid": "03ba92fe684453bfaee29dc42633375b716501bb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 447, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}