{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzMjYwMDI2", "number": 1366, "title": "Content type in JSON RPC response", "bodyText": "Description\nAdd a Content-Type header to JSON RPC responses, with value application/json to solve #1365 1365\nMotivation and Context\n\n\nCurrent code does not returns the content type header in the responses to JSON RPC invocations.\nHow Has This Been Tested?\n\n\n\nIt was tested using curl\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to not work as expected)\n\nChecklist:\n\n\n\n My code follows the code style of this project.\n My change requires a change to the documentation.\n I have updated the documentation accordingly.\n Tests for the changes have been added (for bug fixes / features)\n Requires Activation Code (Hard Fork)\n\n\nOther information:", "createdAt": "2020-11-18T15:19:39Z", "url": "https://github.com/rsksmart/rskj/pull/1366", "merged": true, "mergeCommit": {"oid": "dd87e6090167a251293a278ed3785de2e4241657"}, "closed": true, "closedAt": "2020-12-21T14:50:39Z", "author": {"login": "ajlopez"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddx4fAgFqTUzMzcxOTA0Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdoWM9EAFqTU1NjM4OTQ2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzE5MDQy", "url": "https://github.com/rsksmart/rskj/pull/1366#pullrequestreview-533719042", "createdAt": "2020-11-18T17:46:04Z", "commit": {"oid": "86730a66f302c1ad65bbb378094add9d1c5ed3bc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0NjowNFrOH16mPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxNzo0NjowNFrOH16mPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI5NjYzOA==", "bodyText": "You can use:\nimport static io.netty.handler.codec.http.HttpHeaders.Names.CONTENT_TYPE;\nimport static io.netty.handler.codec.http.HttpHeaders.Values.APPLICATION_JSON;", "url": "https://github.com/rsksmart/rskj/pull/1366#discussion_r526296638", "createdAt": "2020-11-18T17:46:04Z", "author": {"login": "patogallaiovlabs"}, "path": "rskj-core/src/main/java/co/rsk/rpc/netty/Web3ResultHttpResponseHandler.java", "diffHunk": "@@ -29,11 +29,15 @@\n \n     @Override\n     protected void channelRead0(ChannelHandlerContext ctx, Web3Result msg) {\n-        ctx.write(new DefaultFullHttpResponse(\n-            HttpVersion.HTTP_1_1,\n-            HttpResponseStatus.valueOf(DefaultHttpStatusCodeProvider.INSTANCE.getHttpStatusCode(msg.getCode())),\n-            msg.getContent()\n-        )).addListener(ChannelFutureListener.CLOSE);\n+        DefaultFullHttpResponse response = new DefaultFullHttpResponse(\n+                HttpVersion.HTTP_1_1,\n+                HttpResponseStatus.valueOf(DefaultHttpStatusCodeProvider.INSTANCE.getHttpStatusCode(msg.getCode())),\n+                msg.getContent()\n+        );\n+\n+        response.headers().add(\"Content-Type\", \"application/json\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86730a66f302c1ad65bbb378094add9d1c5ed3bc"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86730a66f302c1ad65bbb378094add9d1c5ed3bc", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/86730a66f302c1ad65bbb378094add9d1c5ed3bc", "committedDate": "2020-11-18T15:14:30Z", "message": "Content type in JSON RPC response"}, "afterCommit": {"oid": "8a4d73ac49290663b4cca983d3eb92e361e783da", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/8a4d73ac49290663b4cca983d3eb92e361e783da", "committedDate": "2020-11-18T19:09:55Z", "message": "Content type in JSON RPC response"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a2d12338b4d462af4cd891351f03d56b1bccc40", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/4a2d12338b4d462af4cd891351f03d56b1bccc40", "committedDate": "2020-11-27T14:34:42Z", "message": "Using constants in Web3ResultHttpResponseHandler"}, "afterCommit": {"oid": "03ce2ed2bdb2747a3a846774a9dbff9189c36b9e", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/03ce2ed2bdb2747a3a846774a9dbff9189c36b9e", "committedDate": "2020-11-27T19:03:26Z", "message": "Using constants in Web3ResultHttpResponseHandler"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03ce2ed2bdb2747a3a846774a9dbff9189c36b9e", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/03ce2ed2bdb2747a3a846774a9dbff9189c36b9e", "committedDate": "2020-11-27T19:03:26Z", "message": "Using constants in Web3ResultHttpResponseHandler"}, "afterCommit": {"oid": "b2dddb90b439ec86796ae50ba215b87338e6a050", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/b2dddb90b439ec86796ae50ba215b87338e6a050", "committedDate": "2020-11-30T21:02:55Z", "message": "Using constants in Web3ResultHttpResponseHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxODg0MjQ2", "url": "https://github.com/rsksmart/rskj/pull/1366#pullrequestreview-541884246", "createdAt": "2020-12-01T13:18:36Z", "commit": {"oid": "b2dddb90b439ec86796ae50ba215b87338e6a050"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2dddb90b439ec86796ae50ba215b87338e6a050", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/b2dddb90b439ec86796ae50ba215b87338e6a050", "committedDate": "2020-11-30T21:02:55Z", "message": "Using constants in Web3ResultHttpResponseHandler"}, "afterCommit": {"oid": "b44f6c67aa0bf95dad337c0e304356714603e81b", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/b44f6c67aa0bf95dad337c0e304356714603e81b", "committedDate": "2020-12-10T10:57:33Z", "message": "Using constants in Web3ResultHttpResponseHandler"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b44f6c67aa0bf95dad337c0e304356714603e81b", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/b44f6c67aa0bf95dad337c0e304356714603e81b", "committedDate": "2020-12-10T10:57:33Z", "message": "Using constants in Web3ResultHttpResponseHandler"}, "afterCommit": {"oid": "34804c0bf5915b739b756dd92065d0c83de98afd", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/34804c0bf5915b739b756dd92065d0c83de98afd", "committedDate": "2020-12-17T18:00:17Z", "message": "Using constants in Web3ResultHttpResponseHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2MzgyNTM1", "url": "https://github.com/rsksmart/rskj/pull/1366#pullrequestreview-556382535", "createdAt": "2020-12-21T13:35:25Z", "commit": {"oid": "34804c0bf5915b739b756dd92065d0c83de98afd"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2040b34fc73fcb0685d7674627f118ed1a5dd360", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/2040b34fc73fcb0685d7674627f118ed1a5dd360", "committedDate": "2020-12-21T13:42:54Z", "message": "Content type in JSON RPC response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dec27e185f149a7b320fbb9bec8572f8211cb99", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/6dec27e185f149a7b320fbb9bec8572f8211cb99", "committedDate": "2020-12-21T13:42:54Z", "message": "Using constants in Web3ResultHttpResponseHandler"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "34804c0bf5915b739b756dd92065d0c83de98afd", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/34804c0bf5915b739b756dd92065d0c83de98afd", "committedDate": "2020-12-17T18:00:17Z", "message": "Using constants in Web3ResultHttpResponseHandler"}, "afterCommit": {"oid": "6dec27e185f149a7b320fbb9bec8572f8211cb99", "author": {"user": {"login": "ajlopez", "name": null}}, "url": "https://github.com/rsksmart/rskj/commit/6dec27e185f149a7b320fbb9bec8572f8211cb99", "committedDate": "2020-12-21T13:42:54Z", "message": "Using constants in Web3ResultHttpResponseHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2Mzg5NDYw", "url": "https://github.com/rsksmart/rskj/pull/1366#pullrequestreview-556389460", "createdAt": "2020-12-21T13:46:16Z", "commit": {"oid": "6dec27e185f149a7b320fbb9bec8572f8211cb99"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 633, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}