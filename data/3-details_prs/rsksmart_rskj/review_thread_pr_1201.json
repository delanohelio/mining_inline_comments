{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1NjI5NTg0", "number": 1201, "reviewThreads": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNzoxNToxOVrODsxcHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNTo0NTo0N1rODxSOYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MjczOTQ5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/resources/reference.conf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNzoxNToxOVrOF9z7ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODo0MToyM1rOF-2ggg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM1ODMzOQ==", "bodyText": "reference.conf is used by convention :\nhttps://github.com/lightbend/config#standard-behavior", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r400358339", "createdAt": "2020-03-30T17:15:19Z", "author": {"login": "patogalla"}, "path": "rskj-core/src/main/resources/reference.conf", "diffHunk": "@@ -3,6 +3,20 @@ blockchain.config.hardforkActivationHeights.papyrus200 = -1\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ0OTA5MA==", "bodyText": "Thanks @patogalla", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401449090", "createdAt": "2020-04-01T08:41:23Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/resources/reference.conf", "diffHunk": "@@ -3,6 +3,20 @@ blockchain.config.hardforkActivationHeights.papyrus200 = -1\n ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM1ODMzOQ=="}, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4Mjc1ODcxOnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNzoxOTo1NlrOF90H1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwODo1OTozMVrOGDP4Tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM2MTQzMQ==", "bodyText": "I would suggest doing like : \"Enum.VALUE.equals(value)\",\ngood practice", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r400361431", "createdAt": "2020-03-30T17:19:56Z", "author": {"login": "patogalla"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +150,52 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String key, @Nullable ConfigValue expectedValue, ConfigValue actualValue) {\n+        if (expectedValue == null) {\n+            throw unexpectedKeyException(key, actualValue);\n+        }\n+\n+        switch (actualValue.valueType()) {\n+            case OBJECT:\n+                if (!expectedValue.valueType().equals(ConfigValueType.OBJECT)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjA1OTA4Nw==", "bodyText": "well.. there're pros and cons.. people from sonarsource suggest using == - https://rules.sonarsource.com/java/RSPEC-4551.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r406059087", "createdAt": "2020-04-09T08:59:31Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +150,52 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String key, @Nullable ConfigValue expectedValue, ConfigValue actualValue) {\n+        if (expectedValue == null) {\n+            throw unexpectedKeyException(key, actualValue);\n+        }\n+\n+        switch (actualValue.valueType()) {\n+            case OBJECT:\n+                if (!expectedValue.valueType().equals(ConfigValueType.OBJECT)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM2MTQzMQ=="}, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4Mjc2ODA4OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNzoyMjoyN1rOF90N1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODo0MDo1OFrOF-2fjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM2Mjk2NA==", "bodyText": "Isnt a way to compare types before going to the switch, it seems redundant to me, asking in each switch statement for the equal type. Whats the logic there?", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r400362964", "createdAt": "2020-03-30T17:22:27Z", "author": {"login": "patogalla"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +150,52 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String key, @Nullable ConfigValue expectedValue, ConfigValue actualValue) {\n+        if (expectedValue == null) {\n+            throw unexpectedKeyException(key, actualValue);\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ0ODg0Ng==", "bodyText": "I've updated the code a bit.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401448846", "createdAt": "2020-04-01T08:40:58Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +150,52 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String key, @Nullable ConfigValue expectedValue, ConfigValue actualValue) {\n+        if (expectedValue == null) {\n+            throw unexpectedKeyException(key, actualValue);\n+        }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM2Mjk2NA=="}, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MjgwNTk5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNzozMTo0NFrOF90liw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwODo1OTozOVrOGDP4kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM2OTAzNQ==", "bodyText": "\"(key.isEmpty() ? \"\" : key + \".\")\" logic should be outside \"for\", no need to ask in each iteration.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r400369035", "createdAt": "2020-03-30T17:31:44Z", "author": {"login": "patogalla"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +150,52 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String key, @Nullable ConfigValue expectedValue, ConfigValue actualValue) {\n+        if (expectedValue == null) {\n+            throw unexpectedKeyException(key, actualValue);\n+        }\n+\n+        switch (actualValue.valueType()) {\n+            case OBJECT:\n+                if (!expectedValue.valueType().equals(ConfigValueType.OBJECT)) {\n+                    throw typeMismatchException(key, expectedValue, actualValue);\n+                }\n+                for (Map.Entry<String, ConfigValue> actualEntry : ((ConfigObject) actualValue).entrySet()) {\n+                    ConfigValue expectedEntryValue = ((ConfigObject) expectedValue).get(actualEntry.getKey());\n+                    verify((key.isEmpty() ? \"\" : key + \".\") + actualEntry.getKey(), expectedEntryValue, actualEntry.getValue());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjA1OTE1NQ==", "bodyText": "done", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r406059155", "createdAt": "2020-04-09T08:59:39Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +150,52 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String key, @Nullable ConfigValue expectedValue, ConfigValue actualValue) {\n+        if (expectedValue == null) {\n+            throw unexpectedKeyException(key, actualValue);\n+        }\n+\n+        switch (actualValue.valueType()) {\n+            case OBJECT:\n+                if (!expectedValue.valueType().equals(ConfigValueType.OBJECT)) {\n+                    throw typeMismatchException(key, expectedValue, actualValue);\n+                }\n+                for (Map.Entry<String, ConfigValue> actualEntry : ((ConfigObject) actualValue).entrySet()) {\n+                    ConfigValue expectedEntryValue = ((ConfigObject) expectedValue).get(actualEntry.getKey());\n+                    verify((key.isEmpty() ? \"\" : key + \".\") + actualEntry.getKey(), expectedEntryValue, actualEntry.getValue());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM2OTAzNQ=="}, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 81}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MjgxNDQ5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNzozMzozN1rOF90qlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwODo1OTo0OVrOGDP48w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM3MDMyNw==", "bodyText": "instead of throwing, it would be nice to collect them, and throw/log them all at once.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r400370327", "createdAt": "2020-03-30T17:33:37Z", "author": {"login": "patogalla"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +150,52 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String key, @Nullable ConfigValue expectedValue, ConfigValue actualValue) {\n+        if (expectedValue == null) {\n+            throw unexpectedKeyException(key, actualValue);\n+        }\n+\n+        switch (actualValue.valueType()) {\n+            case OBJECT:\n+                if (!expectedValue.valueType().equals(ConfigValueType.OBJECT)) {\n+                    throw typeMismatchException(key, expectedValue, actualValue);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjA1OTI1MQ==", "bodyText": "done", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r406059251", "createdAt": "2020-04-09T08:59:49Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +150,52 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String key, @Nullable ConfigValue expectedValue, ConfigValue actualValue) {\n+        if (expectedValue == null) {\n+            throw unexpectedKeyException(key, actualValue);\n+        }\n+\n+        switch (actualValue.valueType()) {\n+            case OBJECT:\n+                if (!expectedValue.valueType().equals(ConfigValueType.OBJECT)) {\n+                    throw typeMismatchException(key, expectedValue, actualValue);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM3MDMyNw=="}, "originalCommit": {"oid": "537c435f42504606be9060cc8309bdde0a349596"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4OTY4MDc1OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODo0NDo0NlrOF-2ocA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo0MDo1OFrOF_BJtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ1MTEyMA==", "bodyText": "Config without systemPropsConfig and systemEnvConfig which are out of our interest", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401451120", "createdAt": "2020-04-01T08:44:46Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -56,13 +59,38 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n     }\n \n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {\n+            Config expectedConfig = ConfigFactory.load(EXPECTED_RESOURCE_PATH);\n+            Config actualConfig = ConfigFactory.empty()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYyMzQ3OA==", "bodyText": "can you add this as a comment on the code directly?", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401623478", "createdAt": "2020-04-01T13:40:58Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -56,13 +59,38 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n     }\n \n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {\n+            Config expectedConfig = ConfigFactory.load(EXPECTED_RESOURCE_PATH);\n+            Config actualConfig = ConfigFactory.empty()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ1MTEyMA=="}, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4OTY4NzU4OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/resources/expected.conf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODo0Njo0MFrOF-2s2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo0Mzo1N1rOF_BSaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ1MjI0OA==", "bodyText": "The idea is that the expected.conf file should contain all possible config settings which are expected by the node", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401452248", "createdAt": "2020-04-01T08:46:40Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/resources/expected.conf", "diffHunk": "@@ -0,0 +1,458 @@\n+# disable wasabi+1 consensus rules by default for every network", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYyNTcwNQ==", "bodyText": "same as before, can you add this as a header comment on the expected.conf file, to explain what the file is about?", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401625705", "createdAt": "2020-04-01T13:43:57Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/resources/expected.conf", "diffHunk": "@@ -0,0 +1,458 @@\n+# disable wasabi+1 consensus rules by default for every network", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ1MjI0OA=="}, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDc3OTI5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/resources/expected.conf", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo0NToxM1rOF_BWAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo0NToxM1rOF_BWAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYyNjYyNg==", "bodyText": "maybe we can flesh out these entries so it gets validated?", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401626626", "createdAt": "2020-04-01T13:45:13Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/resources/expected.conf", "diffHunk": "@@ -0,0 +1,458 @@\n+# disable wasabi+1 consensus rules by default for every network\n+blockchain.config.hardforkActivationHeights.papyrus200 = -1\n+\n+blockchain = {\n+    config = {\n+        name = main\n+\n+        # Flag that forces to verify whether a node is started with unknown configuration property names.\n+        # Whole list of possible property names is defined in the reference.conf file.\n+        verify = false\n+\n+        hardforkActivationHeights = {\n+            bahamas = 3397,\n+            afterBridgeSync = 370000,\n+            orchid = 729000,\n+            orchid060 = 1052700,\n+            wasabi100 = 1591000,\n+            twoToThree = 2018000\n+        }\n+        consensusRules = {\n+            areBridgeTxsPaid = afterBridgeSync,\n+            rskip85 = orchid,\n+            rskip87 = orchid,\n+            rskip88 = orchid,\n+            rskip89 = orchid,\n+            rskip90 = orchid,\n+            rskip91 = orchid,\n+            rskip92 = orchid,\n+            rskip97 = orchid,\n+            rskip98 = orchid,\n+            rskip103 = orchid060,\n+            rskip106 = wasabi100,\n+            rskip110 = wasabi100,\n+            rskip119 = wasabi100,\n+            rskip120 = wasabi100,\n+            rskip122 = wasabi100,\n+            rskip123 = wasabi100,\n+            rskip124 = wasabi100,\n+            rskip125 = wasabi100,\n+            rskip126 = wasabi100,\n+            rskip132 = wasabi100,\n+            rskip134 = papyrus200,\n+            rskip136 = bahamas,\n+            rskip137 = papyrus200,\n+            rskip140 = papyrus200,\n+            rskip143 = papyrus200,\n+            rskip146 = papyrus200,\n+            rskip150 = twoToThree,\n+            rskip151 = papyrus200,\n+            rskip152 = papyrus200\n+            rskip156 = papyrus200\n+            rskipUMM = papyrus200\n+        }\n+    }\n+    gc = {\n+        enabled = false\n+        epochs = 3\n+        blocksPerEpoch = 20000\n+    }\n+}\n+\n+peer {\n+    # Boot node list\n+    # Use to connect to specific nodes\n+    active = [ ]\n+\n+    # list of trusted peers the incoming connections is always accepted from. Even if the max amount of connections is reached\n+    # This is used to create a filter of Trusted peers\n+    trusted = [\n+        # Sample entries:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDc4MTU5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo0NTozOVrOF_BXZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwODo0OTozNFrOGDPhSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYyNjk4MA==", "bodyText": "This is the original case? When a misspelled property will be warned... am i right?", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401626980", "createdAt": "2020-04-01T13:45:39Z", "author": {"login": "patogalla"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +156,66 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String keyPath, @Nullable ConfigValue expectedValue, ConfigValue actualValue, List<String> problems) {\n+        Objects.requireNonNull(keyPath);\n+        Objects.requireNonNull(actualValue);\n+        ConfigValueType actualValueType = Objects.requireNonNull(actualValue.valueType());\n+\n+        if (expectedValue == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NjU1MA==", "bodyText": "This seems to be my original case presented in #1192. Maybe a comment explaining how we got here can help.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405486550", "createdAt": "2020-04-08T12:29:45Z", "author": {"login": "lucasvuotto"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +156,66 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String keyPath, @Nullable ConfigValue expectedValue, ConfigValue actualValue, List<String> problems) {\n+        Objects.requireNonNull(keyPath);\n+        Objects.requireNonNull(actualValue);\n+        ConfigValueType actualValueType = Objects.requireNonNull(actualValue.valueType());\n+\n+        if (expectedValue == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYyNjk4MA=="}, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUyMjkzMA==", "bodyText": "agree, I would add a comment here.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405522930", "createdAt": "2020-04-08T13:26:16Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +156,66 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String keyPath, @Nullable ConfigValue expectedValue, ConfigValue actualValue, List<String> problems) {\n+        Objects.requireNonNull(keyPath);\n+        Objects.requireNonNull(actualValue);\n+        ConfigValueType actualValueType = Objects.requireNonNull(actualValue.valueType());\n+\n+        if (expectedValue == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYyNjk4MA=="}, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjA1MzE5NQ==", "bodyText": "Yes, the verify method is recursive one and expectedValue could be null during recursive iterations when an appropriate matching key path is to found.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r406053195", "createdAt": "2020-04-09T08:49:34Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -128,4 +156,66 @@ private Config getNetworkDefaultConfig(Config userConfig) {\n         logger.info(\"Network not set, using mainnet by default\");\n         return ConfigFactory.load(MAINNET_RESOURCE_PATH);\n     }\n+\n+    private static void verify(String keyPath, @Nullable ConfigValue expectedValue, ConfigValue actualValue, List<String> problems) {\n+        Objects.requireNonNull(keyPath);\n+        Objects.requireNonNull(actualValue);\n+        ConfigValueType actualValueType = Objects.requireNonNull(actualValue.valueType());\n+\n+        if (expectedValue == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYyNjk4MA=="}, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 81}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDg0NzUzOnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/resources/expected.conf", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo1OTo1MlrOF_CBkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzo1OTo1MlrOF_CBkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzNzc3Ng==", "bodyText": "for clarity I would replace this with dummy data", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401637776", "createdAt": "2020-04-01T13:59:52Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/resources/expected.conf", "diffHunk": "@@ -0,0 +1,458 @@\n+# disable wasabi+1 consensus rules by default for every network\n+blockchain.config.hardforkActivationHeights.papyrus200 = -1\n+\n+blockchain = {\n+    config = {\n+        name = main\n+\n+        # Flag that forces to verify whether a node is started with unknown configuration property names.\n+        # Whole list of possible property names is defined in the reference.conf file.\n+        verify = false\n+\n+        hardforkActivationHeights = {\n+            bahamas = 3397,\n+            afterBridgeSync = 370000,\n+            orchid = 729000,\n+            orchid060 = 1052700,\n+            wasabi100 = 1591000,\n+            twoToThree = 2018000\n+        }\n+        consensusRules = {\n+            areBridgeTxsPaid = afterBridgeSync,\n+            rskip85 = orchid,\n+            rskip87 = orchid,\n+            rskip88 = orchid,\n+            rskip89 = orchid,\n+            rskip90 = orchid,\n+            rskip91 = orchid,\n+            rskip92 = orchid,\n+            rskip97 = orchid,\n+            rskip98 = orchid,\n+            rskip103 = orchid060,\n+            rskip106 = wasabi100,\n+            rskip110 = wasabi100,\n+            rskip119 = wasabi100,\n+            rskip120 = wasabi100,\n+            rskip122 = wasabi100,\n+            rskip123 = wasabi100,\n+            rskip124 = wasabi100,\n+            rskip125 = wasabi100,\n+            rskip126 = wasabi100,\n+            rskip132 = wasabi100,\n+            rskip134 = papyrus200,\n+            rskip136 = bahamas,\n+            rskip137 = papyrus200,\n+            rskip140 = papyrus200,\n+            rskip143 = papyrus200,\n+            rskip146 = papyrus200,\n+            rskip150 = twoToThree,\n+            rskip151 = papyrus200,\n+            rskip152 = papyrus200\n+            rskip156 = papyrus200\n+            rskipUMM = papyrus200\n+        }\n+    }\n+    gc = {\n+        enabled = false\n+        epochs = 3\n+        blocksPerEpoch = 20000\n+    }\n+}\n+\n+peer {\n+    # Boot node list\n+    # Use to connect to specific nodes\n+    active = [ ]\n+\n+    # list of trusted peers the incoming connections is always accepted from. Even if the max amount of connections is reached\n+    # This is used to create a filter of Trusted peers\n+    trusted = [\n+        # Sample entries:\n+        # {nodeId = \"e437a4836b77ad9d9ffe73ee782ef2614e6d8370fcf62191a6e488276e23717147073a7ce0b444d485fff5a0c34c4577251a7a990cf80d8542e21b95aa8c5e6c\"},\n+        # {ip = \"11.22.33.44\"},\n+        # {ip = \"11.22.33.*\"},\n+        # {\n+        #   nodeId = \"e437a4836b77ad9d9ffe73ee782ef2614e6d8370fcf62191a6e488276e23717147073a7ce0b444d485fff5a0c34c4577251a7a990cf80d8542e21b95aa8c5e6c\"\n+        #   ip = \"11.22.33.44\"\n+        # }\n+    ]\n+\n+    # connection timeout for trying to connect to a peer [seconds]\n+    connection.timeout = 2\n+\n+    # the parameter specifies how much time we will wait for a message to come before closing the channel\n+    channel.read.timeout = 300\n+\n+    # Private key of the peer\n+    # nodeId = <NODE_ID>\n+    # privateKey = <PRIVATE_KEY>\n+\n+    p2p {\n+        # max frame size in bytes when framing is enabled\n+        framing.maxSize = 32768\n+\n+        # forces peer to send Handshake message in format defined by EIP-8,\n+        # see https://github.com/ethereum/EIPs/blob/master/EIPS/eip-8.md\n+        eip8 = true\n+\n+        # the time in seconds to ping other peers on the network\n+        pingInterval = 5\n+    }\n+\n+    # max number of active peers our node will maintain\n+    # extra peers trying to connect us will be dropped with TOO_MANY_PEERS message\n+    # the incoming connection from the peer matching 'peer.trusted' entry is always accepted\n+    maxActivePeers = 30\n+\n+    # address blocks are defined to allow or restrict access from ip ranges\n+    filter {\n+        # max number of connections allowed on a single address block\n+        maxConnections = 16\n+        # the cidr bits used to define a subnet in IPV4 - i.e. 32 bits is a full address\n+        networkCidr = 24\n+    }\n+\n+    discovery = {\n+        # if peer discovery is off\n+        # the peer window will show\n+        # only what retrieved by active\n+        # peer [true/false]\n+        enabled = true\n+\n+        # List of the peers to start\n+        # the search of the online peers\n+        # values: [ip:port]\n+        ip.list = [\n+            \"bootstrap01.rsk.co:5050\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 126}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDg0OTI0OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/resources/expected.conf", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMDoxNlrOF_CCsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMDoxNlrOF_CCsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzODA2NQ==", "bodyText": "same here, and everything else related to mainnet, I would put dummy data.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401638065", "createdAt": "2020-04-01T14:00:16Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/resources/expected.conf", "diffHunk": "@@ -0,0 +1,458 @@\n+# disable wasabi+1 consensus rules by default for every network\n+blockchain.config.hardforkActivationHeights.papyrus200 = -1\n+\n+blockchain = {\n+    config = {\n+        name = main\n+\n+        # Flag that forces to verify whether a node is started with unknown configuration property names.\n+        # Whole list of possible property names is defined in the reference.conf file.\n+        verify = false\n+\n+        hardforkActivationHeights = {\n+            bahamas = 3397,\n+            afterBridgeSync = 370000,\n+            orchid = 729000,\n+            orchid060 = 1052700,\n+            wasabi100 = 1591000,\n+            twoToThree = 2018000\n+        }\n+        consensusRules = {\n+            areBridgeTxsPaid = afterBridgeSync,\n+            rskip85 = orchid,\n+            rskip87 = orchid,\n+            rskip88 = orchid,\n+            rskip89 = orchid,\n+            rskip90 = orchid,\n+            rskip91 = orchid,\n+            rskip92 = orchid,\n+            rskip97 = orchid,\n+            rskip98 = orchid,\n+            rskip103 = orchid060,\n+            rskip106 = wasabi100,\n+            rskip110 = wasabi100,\n+            rskip119 = wasabi100,\n+            rskip120 = wasabi100,\n+            rskip122 = wasabi100,\n+            rskip123 = wasabi100,\n+            rskip124 = wasabi100,\n+            rskip125 = wasabi100,\n+            rskip126 = wasabi100,\n+            rskip132 = wasabi100,\n+            rskip134 = papyrus200,\n+            rskip136 = bahamas,\n+            rskip137 = papyrus200,\n+            rskip140 = papyrus200,\n+            rskip143 = papyrus200,\n+            rskip146 = papyrus200,\n+            rskip150 = twoToThree,\n+            rskip151 = papyrus200,\n+            rskip152 = papyrus200\n+            rskip156 = papyrus200\n+            rskipUMM = papyrus200\n+        }\n+    }\n+    gc = {\n+        enabled = false\n+        epochs = 3\n+        blocksPerEpoch = 20000\n+    }\n+}\n+\n+peer {\n+    # Boot node list\n+    # Use to connect to specific nodes\n+    active = [ ]\n+\n+    # list of trusted peers the incoming connections is always accepted from. Even if the max amount of connections is reached\n+    # This is used to create a filter of Trusted peers\n+    trusted = [\n+        # Sample entries:\n+        # {nodeId = \"e437a4836b77ad9d9ffe73ee782ef2614e6d8370fcf62191a6e488276e23717147073a7ce0b444d485fff5a0c34c4577251a7a990cf80d8542e21b95aa8c5e6c\"},\n+        # {ip = \"11.22.33.44\"},\n+        # {ip = \"11.22.33.*\"},\n+        # {\n+        #   nodeId = \"e437a4836b77ad9d9ffe73ee782ef2614e6d8370fcf62191a6e488276e23717147073a7ce0b444d485fff5a0c34c4577251a7a990cf80d8542e21b95aa8c5e6c\"\n+        #   ip = \"11.22.33.44\"\n+        # }\n+    ]\n+\n+    # connection timeout for trying to connect to a peer [seconds]\n+    connection.timeout = 2\n+\n+    # the parameter specifies how much time we will wait for a message to come before closing the channel\n+    channel.read.timeout = 300\n+\n+    # Private key of the peer\n+    # nodeId = <NODE_ID>\n+    # privateKey = <PRIVATE_KEY>\n+\n+    p2p {\n+        # max frame size in bytes when framing is enabled\n+        framing.maxSize = 32768\n+\n+        # forces peer to send Handshake message in format defined by EIP-8,\n+        # see https://github.com/ethereum/EIPs/blob/master/EIPS/eip-8.md\n+        eip8 = true\n+\n+        # the time in seconds to ping other peers on the network\n+        pingInterval = 5\n+    }\n+\n+    # max number of active peers our node will maintain\n+    # extra peers trying to connect us will be dropped with TOO_MANY_PEERS message\n+    # the incoming connection from the peer matching 'peer.trusted' entry is always accepted\n+    maxActivePeers = 30\n+\n+    # address blocks are defined to allow or restrict access from ip ranges\n+    filter {\n+        # max number of connections allowed on a single address block\n+        maxConnections = 16\n+        # the cidr bits used to define a subnet in IPV4 - i.e. 32 bits is a full address\n+        networkCidr = 24\n+    }\n+\n+    discovery = {\n+        # if peer discovery is off\n+        # the peer window will show\n+        # only what retrieved by active\n+        # peer [true/false]\n+        enabled = true\n+\n+        # List of the peers to start\n+        # the search of the online peers\n+        # values: [ip:port]\n+        ip.list = [\n+            \"bootstrap01.rsk.co:5050\",\n+            \"bootstrap02.rsk.co:5050\",\n+            \"bootstrap03.rsk.co:5050\",\n+            \"bootstrap04.rsk.co:5050\",\n+            \"bootstrap05.rsk.co:5050\",\n+            \"bootstrap06.rsk.co:5050\",\n+            \"bootstrap07.rsk.co:5050\",\n+            \"bootstrap08.rsk.co:5050\",\n+            \"bootstrap09.rsk.co:5050\",\n+            \"bootstrap10.rsk.co:5050\",\n+            \"bootstrap11.rsk.co:5050\",\n+            \"bootstrap12.rsk.co:5050\",\n+            \"bootstrap13.rsk.co:5050\",\n+            \"bootstrap14.rsk.co:5050\",\n+            \"bootstrap15.rsk.co:5050\",\n+            \"bootstrap16.rsk.co:5050\"\n+        ]\n+    }\n+\n+    # Port for server to listen for incoming connections\n+    port = 5050\n+\n+    # Network id\n+    networkId = 775\n+}\n+\n+# the folder resources/genesis contains several versions of genesis configuration according to the network the peer will run on\n+genesis = rsk-mainnet.json", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 153}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDg2MDA5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/resources/reference.conf", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMjo0NFrOF_CJoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNDowMjo0NFrOF_CJoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYzOTg0MA==", "bodyText": "replace reference.conf in comment with expected.conf", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r401639840", "createdAt": "2020-04-01T14:02:44Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/resources/reference.conf", "diffHunk": "@@ -3,6 +3,10 @@ blockchain.config.hardforkActivationHeights.papyrus200 = -1\n \n blockchain = {\n     config = {\n+        # Flag that forces to verify whether a node is started with unknown configuration property names.\n+        # Whole list of possible property names is defined in the reference.conf file.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a1da5be6f455f3323d6b829cb3764a504f48cd2"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjI1NjI3OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyNjowM1rOGCszuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwODo0NTozMFrOGDPYOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NDQ3NQ==", "bodyText": "I can see this getting overly verbose and quite difficult to read and search for problems, should multiple configuration problems be present. I suggest making verify return a boolean instead, signaling if the verification was successful, and logging each of the misconfigurations instead of pushing them into problems.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405484475", "createdAt": "2020-04-08T12:26:03Z", "author": {"login": "lucasvuotto"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -55,14 +51,59 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n         this.cliArgs = Objects.requireNonNull(cliArgs);\n     }\n \n+    /**\n+     * Loads configurations from different sources with the following precedence:\n+     * 1. Command line arguments\n+     * 2. Environment variables\n+     * 3. System properties\n+     * 4. User configuration file\n+     * 5. Installer configuration file\n+     * 6. Default settings per network in resources/[network].conf\n+     * 7. Default settings for all networks in resources/reference.conf\n+     *\n+     * <p>\n+     * If the <b><blockchain.config.verify/b> setting is {@code true} (either set in a .conf file or via <b>--verify-config</b> command line flag),\n+     * then the loaded config wll be tested against the setting names defined in the expected.conf config file.\n+     *\n+     * Note:\n+     *  1. The <b><blockchain.config.verify/b> setting is {@code false} by default.\n+     *  2. Config verification process of matching actual and expected configs is recursive and takes into account appropriate setting names\n+     *      and values which are collections of other settings (LIST's and OBJECT's).\n+     *\n+     * @throws RskConfigurationException on configuration errors\n+     *\n+     * @see ConfigProblems\n+     */\n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {\n+            Config expectedConfig = ConfigFactory.parseResourcesAnySyntax(EXPECTED_RESOURCE_PATH)\n+                    .withFallback(systemPropsConfig)\n+                    .withFallback(systemEnvConfig);\n+\n+            ArrayList<String> problems = new ArrayList<>();\n+            verify(\"\", expectedConfig.root(), unifiedConfig.root(), problems);\n+            if (!problems.isEmpty()) {\n+                throw new RskConfigurationException(\"Verification of node configs has failed. The following problems were found: \"\n+                        + String.join(\"; \", problems));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTYwNTI5Mw==", "bodyText": "I agree and disagree.\nAgree: I would iterate over problems and log each of them as a separate line.\nDisagree: I think the method works fine as it is, right now we don't unit test it directly, but it could be directly unit tested, and it's a richer interface to have it return a problems array instead of a boolean. What I would add is an overload:\n private static List<String> verify(ConfigValue expectedRoot, ConfigValue actualRoot) {\n    ArrayList<String> problems = new ArrayList<>();\n    verify(\"\", expectedConfig.root(), unifiedConfig.root(), problems);\n    return problems;\n}\n\nIMHO it's nice to add an overload in such cases to make the calling code more oblivious to the internal details of the recursive method.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405605293", "createdAt": "2020-04-08T15:18:52Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -55,14 +51,59 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n         this.cliArgs = Objects.requireNonNull(cliArgs);\n     }\n \n+    /**\n+     * Loads configurations from different sources with the following precedence:\n+     * 1. Command line arguments\n+     * 2. Environment variables\n+     * 3. System properties\n+     * 4. User configuration file\n+     * 5. Installer configuration file\n+     * 6. Default settings per network in resources/[network].conf\n+     * 7. Default settings for all networks in resources/reference.conf\n+     *\n+     * <p>\n+     * If the <b><blockchain.config.verify/b> setting is {@code true} (either set in a .conf file or via <b>--verify-config</b> command line flag),\n+     * then the loaded config wll be tested against the setting names defined in the expected.conf config file.\n+     *\n+     * Note:\n+     *  1. The <b><blockchain.config.verify/b> setting is {@code false} by default.\n+     *  2. Config verification process of matching actual and expected configs is recursive and takes into account appropriate setting names\n+     *      and values which are collections of other settings (LIST's and OBJECT's).\n+     *\n+     * @throws RskConfigurationException on configuration errors\n+     *\n+     * @see ConfigProblems\n+     */\n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {\n+            Config expectedConfig = ConfigFactory.parseResourcesAnySyntax(EXPECTED_RESOURCE_PATH)\n+                    .withFallback(systemPropsConfig)\n+                    .withFallback(systemEnvConfig);\n+\n+            ArrayList<String> problems = new ArrayList<>();\n+            verify(\"\", expectedConfig.root(), unifiedConfig.root(), problems);\n+            if (!problems.isEmpty()) {\n+                throw new RskConfigurationException(\"Verification of node configs has failed. The following problems were found: \"\n+                        + String.join(\"; \", problems));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NDQ3NQ=="}, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjA1MDg3Mw==", "bodyText": "I just don't want to overarchitect this solution. Good point about doing verification all the time and only throwing an exception if the flag is present.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r406050873", "createdAt": "2020-04-09T08:45:30Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -55,14 +51,59 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n         this.cliArgs = Objects.requireNonNull(cliArgs);\n     }\n \n+    /**\n+     * Loads configurations from different sources with the following precedence:\n+     * 1. Command line arguments\n+     * 2. Environment variables\n+     * 3. System properties\n+     * 4. User configuration file\n+     * 5. Installer configuration file\n+     * 6. Default settings per network in resources/[network].conf\n+     * 7. Default settings for all networks in resources/reference.conf\n+     *\n+     * <p>\n+     * If the <b><blockchain.config.verify/b> setting is {@code true} (either set in a .conf file or via <b>--verify-config</b> command line flag),\n+     * then the loaded config wll be tested against the setting names defined in the expected.conf config file.\n+     *\n+     * Note:\n+     *  1. The <b><blockchain.config.verify/b> setting is {@code false} by default.\n+     *  2. Config verification process of matching actual and expected configs is recursive and takes into account appropriate setting names\n+     *      and values which are collections of other settings (LIST's and OBJECT's).\n+     *\n+     * @throws RskConfigurationException on configuration errors\n+     *\n+     * @see ConfigProblems\n+     */\n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {\n+            Config expectedConfig = ConfigFactory.parseResourcesAnySyntax(EXPECTED_RESOURCE_PATH)\n+                    .withFallback(systemPropsConfig)\n+                    .withFallback(systemEnvConfig);\n+\n+            ArrayList<String> problems = new ArrayList<>();\n+            verify(\"\", expectedConfig.root(), unifiedConfig.root(), problems);\n+            if (!problems.isEmpty()) {\n+                throw new RskConfigurationException(\"Verification of node configs has failed. The following problems were found: \"\n+                        + String.join(\"; \", problems));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NDQ3NQ=="}, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjI2MDQ5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjoyNzoxMVrOGCs2Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNToxMTo0N1rOGCz3Bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NTEyMw==", "bodyText": "Can't we run the config verification always and just abort execution only when this flag is set?", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405485123", "createdAt": "2020-04-08T12:27:11Z", "author": {"login": "lucasvuotto"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -55,14 +51,59 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n         this.cliArgs = Objects.requireNonNull(cliArgs);\n     }\n \n+    /**\n+     * Loads configurations from different sources with the following precedence:\n+     * 1. Command line arguments\n+     * 2. Environment variables\n+     * 3. System properties\n+     * 4. User configuration file\n+     * 5. Installer configuration file\n+     * 6. Default settings per network in resources/[network].conf\n+     * 7. Default settings for all networks in resources/reference.conf\n+     *\n+     * <p>\n+     * If the <b><blockchain.config.verify/b> setting is {@code true} (either set in a .conf file or via <b>--verify-config</b> command line flag),\n+     * then the loaded config wll be tested against the setting names defined in the expected.conf config file.\n+     *\n+     * Note:\n+     *  1. The <b><blockchain.config.verify/b> setting is {@code false} by default.\n+     *  2. Config verification process of matching actual and expected configs is recursive and takes into account appropriate setting names\n+     *      and values which are collections of other settings (LIST's and OBJECT's).\n+     *\n+     * @throws RskConfigurationException on configuration errors\n+     *\n+     * @see ConfigProblems\n+     */\n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUyMjE4Mw==", "bodyText": "that would be interesting. In which case we catch the exception and only log it?", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405522183", "createdAt": "2020-04-08T13:25:05Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -55,14 +51,59 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n         this.cliArgs = Objects.requireNonNull(cliArgs);\n     }\n \n+    /**\n+     * Loads configurations from different sources with the following precedence:\n+     * 1. Command line arguments\n+     * 2. Environment variables\n+     * 3. System properties\n+     * 4. User configuration file\n+     * 5. Installer configuration file\n+     * 6. Default settings per network in resources/[network].conf\n+     * 7. Default settings for all networks in resources/reference.conf\n+     *\n+     * <p>\n+     * If the <b><blockchain.config.verify/b> setting is {@code true} (either set in a .conf file or via <b>--verify-config</b> command line flag),\n+     * then the loaded config wll be tested against the setting names defined in the expected.conf config file.\n+     *\n+     * Note:\n+     *  1. The <b><blockchain.config.verify/b> setting is {@code false} by default.\n+     *  2. Config verification process of matching actual and expected configs is recursive and takes into account appropriate setting names\n+     *      and values which are collections of other settings (LIST's and OBJECT's).\n+     *\n+     * @throws RskConfigurationException on configuration errors\n+     *\n+     * @see ConfigProblems\n+     */\n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NTEyMw=="}, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUyOTY1Ng==", "bodyText": "About what exception are we talking? I only see verify throwing an exception if there is a malformed entry in expected.conf.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405529656", "createdAt": "2020-04-08T13:35:40Z", "author": {"login": "lucasvuotto"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -55,14 +51,59 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n         this.cliArgs = Objects.requireNonNull(cliArgs);\n     }\n \n+    /**\n+     * Loads configurations from different sources with the following precedence:\n+     * 1. Command line arguments\n+     * 2. Environment variables\n+     * 3. System properties\n+     * 4. User configuration file\n+     * 5. Installer configuration file\n+     * 6. Default settings per network in resources/[network].conf\n+     * 7. Default settings for all networks in resources/reference.conf\n+     *\n+     * <p>\n+     * If the <b><blockchain.config.verify/b> setting is {@code true} (either set in a .conf file or via <b>--verify-config</b> command line flag),\n+     * then the loaded config wll be tested against the setting names defined in the expected.conf config file.\n+     *\n+     * Note:\n+     *  1. The <b><blockchain.config.verify/b> setting is {@code false} by default.\n+     *  2. Config verification process of matching actual and expected configs is recursive and takes into account appropriate setting names\n+     *      and values which are collections of other settings (LIST's and OBJECT's).\n+     *\n+     * @throws RskConfigurationException on configuration errors\n+     *\n+     * @see ConfigProblems\n+     */\n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NTEyMw=="}, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTYwMDAwNg==", "bodyText": "sorry, I did not read the code carefully between all the changes. Right now this method throws the exception, it could skip throwing the exception if the flag is not set.", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405600006", "createdAt": "2020-04-08T15:11:47Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/java/co/rsk/config/ConfigLoader.java", "diffHunk": "@@ -55,14 +51,59 @@ public ConfigLoader(CliArgs<NodeCliOptions, NodeCliFlags> cliArgs) {\n         this.cliArgs = Objects.requireNonNull(cliArgs);\n     }\n \n+    /**\n+     * Loads configurations from different sources with the following precedence:\n+     * 1. Command line arguments\n+     * 2. Environment variables\n+     * 3. System properties\n+     * 4. User configuration file\n+     * 5. Installer configuration file\n+     * 6. Default settings per network in resources/[network].conf\n+     * 7. Default settings for all networks in resources/reference.conf\n+     *\n+     * <p>\n+     * If the <b><blockchain.config.verify/b> setting is {@code true} (either set in a .conf file or via <b>--verify-config</b> command line flag),\n+     * then the loaded config wll be tested against the setting names defined in the expected.conf config file.\n+     *\n+     * Note:\n+     *  1. The <b><blockchain.config.verify/b> setting is {@code false} by default.\n+     *  2. Config verification process of matching actual and expected configs is recursive and takes into account appropriate setting names\n+     *      and values which are collections of other settings (LIST's and OBJECT's).\n+     *\n+     * @throws RskConfigurationException on configuration errors\n+     *\n+     * @see ConfigProblems\n+     */\n     public Config getConfig() {\n-        Config userConfig = getConfigFromCliArgs()\n-                .withFallback(ConfigFactory.systemProperties())\n-                .withFallback(ConfigFactory.systemEnvironment())\n-                .withFallback(getUserCustomConfig())\n-                .withFallback(getInstallerConfig());\n+        Config cliConfig = getConfigFromCliArgs();\n+        Config systemPropsConfig = ConfigFactory.systemProperties();\n+        Config systemEnvConfig = ConfigFactory.systemEnvironment();\n+        Config userCustomConfig = getUserCustomConfig();\n+        Config installerConfig = getInstallerConfig();\n+\n+        Config userConfig = ConfigFactory.empty()\n+                .withFallback(cliConfig)\n+                .withFallback(systemPropsConfig)\n+                .withFallback(systemEnvConfig)\n+                .withFallback(userCustomConfig)\n+                .withFallback(installerConfig);\n         Config networkBaseConfig = getNetworkDefaultConfig(userConfig);\n-        return userConfig.withFallback(networkBaseConfig);\n+        Config unifiedConfig = userConfig.withFallback(networkBaseConfig);\n+\n+        if (unifiedConfig.getBoolean(SystemProperties.PROPERTY_BC_VERIFY)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ4NTEyMw=="}, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjMxOTc5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/resources/expected.conf", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo0MzoyMFrOGCtarQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwODo1MDoxNlrOGDPixQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ5NDQ0NQ==", "bodyText": "You're missing a key in here:\n            methods = {\n                enabled = []\n                disabled = []\n            }\n\n(cf \n  \n    \n      rskj/rskj-core/src/main/java/co/rsk/config/RskSystemProperties.java\n    \n    \n         Line 238\n      in\n      1e842d8\n    \n    \n    \n    \n\n        \n          \n           if (configElement.hasPath(\"methods.enabled\")) { \n        \n    \n  \n\n)", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r405494445", "createdAt": "2020-04-08T12:43:20Z", "author": {"login": "lucasvuotto"}, "path": "rskj-core/src/main/resources/expected.conf", "diffHunk": "@@ -0,0 +1,160 @@\n+blockchain = {\n+    config = {\n+        name = <name>\n+        verify = <verify>\n+        hardforkActivationHeights = { }\n+        consensusRules = { }\n+    }\n+    gc = {\n+        enabled = <enabled>\n+        epochs = <epochs>\n+        blocksPerEpoch = <blocksPerEpoch>\n+    }\n+}\n+peer = {\n+    active = [ ]\n+    trusted = [ ]\n+    connection.timeout = <timeout>\n+    channel.read.timeout = <timeout>\n+    p2p = {\n+        framing.maxSize = <maxSize>\n+        eip8 = <eip8>\n+        pingInterval = <pingInterval>\n+    }\n+    maxActivePeers = <maxActivePeers>\n+    filter = {\n+        maxConnections = <maxConnections>\n+        networkCidr = <networkCidr>\n+    }\n+    discovery = {\n+        enabled = <enabled>\n+        ip.list = [<ip>]\n+    }\n+    port = <port>\n+    networkId = <networkId>\n+}\n+genesis = <genesis>\n+database = {\n+    dir = <dir>\n+    import = {\n+        url = <url>\n+        trusted-keys = [<trusted-key>]\n+    }\n+}\n+hello.phrase = <phrase>\n+wallet = {\n+    enabled = <enabled>\n+    accounts = [<accounts>]\n+}\n+miner = {\n+    minGasPrice = <minGasPrice>\n+    server = {\n+        enabled = <enabled>\n+        isFixedClock = <isFixedClock>\n+    }\n+    client = {\n+        enabled = <enabled>\n+        autoMine = <autoMine>\n+        delayBetweenBlocks = <delayBetweenBlocks>\n+        delayBetweenRefreshes = <delayBetweenRefreshes>\n+    }\n+    coinbase.secret = <secret>\n+}\n+database = {\n+    reset = <reset>\n+    import = {\n+        enabled = <enabled>\n+        trusted-keys = [<trusted-key>]\n+    }\n+}\n+bind_address = <bind_address>\n+public = {\n+    ipCheckService = <ipCheckService>\n+}\n+transaction = {\n+    outdated = {\n+        threshold = <threshold>\n+        timeout = <timeout>\n+    }\n+    gasPriceBump = <gasPriceBump>\n+}\n+dump = {\n+    full = <full>\n+    dir = <dir>\n+    block = <block>\n+    style = <style>\n+    clean.on.restart = <restart>\n+}\n+vm = {\n+    executionStackSize = <executionStackSize>\n+    structured = {\n+        trace = <trace>\n+        traceOptions = <traceOptions>\n+        dir = <dir>\n+        compressed = <compressed>\n+        initStorageLimit = <initStorageLimit>\n+    }\n+}\n+play.vm = <vm>\n+keyvalue.datasource = <datasource>\n+sync = {\n+    enabled = <enabled>\n+    max.hashes.ask = <ask>\n+    peer.count = <count>\n+    expectedPeers = <expectedPeers>\n+    timeoutWaitingPeers = <timeoutWaitingPeers>\n+    timeoutWaitingRequest = <timeoutWaitingRequest>\n+    expirationTimePeerStatus = <expirationTimePeerStatus>\n+    maxSkeletonChunks = <maxSkeletonChunks>\n+    maxRequestedBodies = <maxRequestedBodies>\n+    longSyncLimit = <longSyncLimit>\n+    chunkSize = <chunkSize>\n+}\n+rpc = {\n+    providers = {\n+        web = {\n+            cors = <cors>\n+            http = {\n+                enabled = <enabled>\n+                bind_address = <bind_address>\n+                hosts = []\n+                port = <port>\n+                linger_time = <linger_time>\n+            }\n+            ws = {\n+                enabled = <enabled>\n+                bind_address = <bind_address>\n+                port = <port>\n+            }\n+        }\n+    }\n+    modules = [\n+        {\n+            name = <name>\n+            version = <version>\n+            enabled = <enabled>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 135}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjA1MzU3Mw==", "bodyText": "thanks", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r406053573", "createdAt": "2020-04-09T08:50:16Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/resources/expected.conf", "diffHunk": "@@ -0,0 +1,160 @@\n+blockchain = {\n+    config = {\n+        name = <name>\n+        verify = <verify>\n+        hardforkActivationHeights = { }\n+        consensusRules = { }\n+    }\n+    gc = {\n+        enabled = <enabled>\n+        epochs = <epochs>\n+        blocksPerEpoch = <blocksPerEpoch>\n+    }\n+}\n+peer = {\n+    active = [ ]\n+    trusted = [ ]\n+    connection.timeout = <timeout>\n+    channel.read.timeout = <timeout>\n+    p2p = {\n+        framing.maxSize = <maxSize>\n+        eip8 = <eip8>\n+        pingInterval = <pingInterval>\n+    }\n+    maxActivePeers = <maxActivePeers>\n+    filter = {\n+        maxConnections = <maxConnections>\n+        networkCidr = <networkCidr>\n+    }\n+    discovery = {\n+        enabled = <enabled>\n+        ip.list = [<ip>]\n+    }\n+    port = <port>\n+    networkId = <networkId>\n+}\n+genesis = <genesis>\n+database = {\n+    dir = <dir>\n+    import = {\n+        url = <url>\n+        trusted-keys = [<trusted-key>]\n+    }\n+}\n+hello.phrase = <phrase>\n+wallet = {\n+    enabled = <enabled>\n+    accounts = [<accounts>]\n+}\n+miner = {\n+    minGasPrice = <minGasPrice>\n+    server = {\n+        enabled = <enabled>\n+        isFixedClock = <isFixedClock>\n+    }\n+    client = {\n+        enabled = <enabled>\n+        autoMine = <autoMine>\n+        delayBetweenBlocks = <delayBetweenBlocks>\n+        delayBetweenRefreshes = <delayBetweenRefreshes>\n+    }\n+    coinbase.secret = <secret>\n+}\n+database = {\n+    reset = <reset>\n+    import = {\n+        enabled = <enabled>\n+        trusted-keys = [<trusted-key>]\n+    }\n+}\n+bind_address = <bind_address>\n+public = {\n+    ipCheckService = <ipCheckService>\n+}\n+transaction = {\n+    outdated = {\n+        threshold = <threshold>\n+        timeout = <timeout>\n+    }\n+    gasPriceBump = <gasPriceBump>\n+}\n+dump = {\n+    full = <full>\n+    dir = <dir>\n+    block = <block>\n+    style = <style>\n+    clean.on.restart = <restart>\n+}\n+vm = {\n+    executionStackSize = <executionStackSize>\n+    structured = {\n+        trace = <trace>\n+        traceOptions = <traceOptions>\n+        dir = <dir>\n+        compressed = <compressed>\n+        initStorageLimit = <initStorageLimit>\n+    }\n+}\n+play.vm = <vm>\n+keyvalue.datasource = <datasource>\n+sync = {\n+    enabled = <enabled>\n+    max.hashes.ask = <ask>\n+    peer.count = <count>\n+    expectedPeers = <expectedPeers>\n+    timeoutWaitingPeers = <timeoutWaitingPeers>\n+    timeoutWaitingRequest = <timeoutWaitingRequest>\n+    expirationTimePeerStatus = <expirationTimePeerStatus>\n+    maxSkeletonChunks = <maxSkeletonChunks>\n+    maxRequestedBodies = <maxRequestedBodies>\n+    longSyncLimit = <longSyncLimit>\n+    chunkSize = <chunkSize>\n+}\n+rpc = {\n+    providers = {\n+        web = {\n+            cors = <cors>\n+            http = {\n+                enabled = <enabled>\n+                bind_address = <bind_address>\n+                hosts = []\n+                port = <port>\n+                linger_time = <linger_time>\n+            }\n+            ws = {\n+                enabled = <enabled>\n+                bind_address = <bind_address>\n+                port = <port>\n+            }\n+        }\n+    }\n+    modules = [\n+        {\n+            name = <name>\n+            version = <version>\n+            enabled = <enabled>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ5NDQ0NQ=="}, "originalCommit": {"oid": "a3429f938f36f89216300c8563644aa9dacb412e"}, "originalPosition": 135}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzMDA1NDA4OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/test/java/co/rsk/config/ConfigLoaderTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNTo0NTo0N1rOGEqvNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNTo0NTo0N1rOGEqvNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU0NzcwMw==", "bodyText": "with the latest change, this test and the one above it is not making any assertion", "url": "https://github.com/rsksmart/rskj/pull/1201#discussion_r407547703", "createdAt": "2020-04-13T15:45:47Z", "author": {"login": "nicops"}, "path": "rskj-core/src/test/java/co/rsk/config/ConfigLoaderTest.java", "diffHunk": "@@ -181,13 +168,7 @@ public void detectExpectedScalarValueProblemInList() {\n \n         mockConfigFactory(defaultConfig, expectedConfig);\n \n-        try {\n-            loader.getConfig();\n-        } catch (RskConfigurationException e) {\n-            assertThat(e.getMessage(), containsString(ConfigProblems.expectedScalarValueProblem(\"expectedKey[0]\", EMPTY_LIST_VALUE)));\n-\n-            throw e;\n-        }\n+        loader.getConfig();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b0e4a2cd7a608df26a52f6dacb745d816fd0b78"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4582, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}