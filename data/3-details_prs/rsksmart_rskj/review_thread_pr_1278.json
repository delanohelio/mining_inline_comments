{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1MTc5MzA1", "number": 1278, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQyMTowOTo1NFrOER94ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzoxODoyOVrOEVgWBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Mjc1MTQ2OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/rpc/modules/personal/PersonalModuleWalletEnabled.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQyMTowOTo1NFrOG2916A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwODowMTo1NVrOG4BNGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI4OTUxMg==", "bodyText": "I think we could fix this at this point. assigning \"s\" while returning makes no sense, am i right?", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r460289512", "createdAt": "2020-07-24T21:09:54Z", "author": {"login": "patogallaiovlabs"}, "path": "rskj-core/src/main/java/co/rsk/rpc/modules/personal/PersonalModuleWalletEnabled.java", "diffHunk": "@@ -172,7 +173,7 @@ public String dumpRawKey(String address) throws Exception {\n                 throw new Exception(\"Address private key is locked or could not be found in this node\");\n             }\n \n-            return s = TypeConverter.toJsonHex(Hex.toHexString(account.getEcKey().getPrivKeyBytes()));\n+            return s = TypeConverter.toJsonHex(ByteUtil.toHexString(account.getEcKey().getPrivKeyBytes()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c5e81a2c251dd86b13169feb86fa4df054a44a3"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5MzE3OQ==", "bodyText": "s is being used below in the final block for logging. This style of coding with the s and final block is used in multiple places in the code, not only here. Not sure we should address this sort of refactoring in scope of this pull request (as this pr is already pretty big).", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r461393179", "createdAt": "2020-07-28T08:01:55Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/co/rsk/rpc/modules/personal/PersonalModuleWalletEnabled.java", "diffHunk": "@@ -172,7 +173,7 @@ public String dumpRawKey(String address) throws Exception {\n                 throw new Exception(\"Address private key is locked or could not be found in this node\");\n             }\n \n-            return s = TypeConverter.toJsonHex(Hex.toHexString(account.getEcKey().getPrivKeyBytes()));\n+            return s = TypeConverter.toJsonHex(ByteUtil.toHexString(account.getEcKey().getPrivKeyBytes()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI4OTUxMg=="}, "originalCommit": {"oid": "0c5e81a2c251dd86b13169feb86fa4df054a44a3"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3ODIxMzM2OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/test/java/org/ethereum/core/LogInfoTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNzozMjo1OFrOG3sjkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwODowNToxMVrOG4BUNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1NDg2NA==", "bodyText": "Are ignored tests?", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r461054864", "createdAt": "2020-07-27T17:32:58Z", "author": {"login": "patogallaiovlabs"}, "path": "rskj-core/src/test/java/org/ethereum/core/LogInfoTest.java", "diffHunk": "@@ -19,16 +19,14 @@\n \n package org.ethereum.core;\n \n+import org.bouncycastle.util.encoders.Hex;\n+import org.ethereum.util.ByteUtil;\n import org.ethereum.vm.LogInfo;\n-\n+import org.junit.Ignore;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c5e81a2c251dd86b13169feb86fa4df054a44a3"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5NDk5OQ==", "bodyText": "yes, correct. One test is ignored in this class.", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r461394999", "createdAt": "2020-07-28T08:05:11Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/test/java/org/ethereum/core/LogInfoTest.java", "diffHunk": "@@ -19,16 +19,14 @@\n \n package org.ethereum.core;\n \n+import org.bouncycastle.util.encoders.Hex;\n+import org.ethereum.util.ByteUtil;\n import org.ethereum.vm.LogInfo;\n-\n+import org.junit.Ignore;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA1NDg2NA=="}, "originalCommit": {"oid": "0c5e81a2c251dd86b13169feb86fa4df054a44a3"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NDc4MjAxOnYy", "diffSide": "RIGHT", "path": "rskj-core/src/test/java/org/ethereum/core/TransactionTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxMzo1NzoyMlrOG6Ji4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxMzo1NzoyMlrOG6Ji4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYyNjk3OQ==", "bodyText": "Would be nice to have at least 1 assert. I understand that you are testing that this doesn't fail, but would be better if we are clear on that.", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r463626979", "createdAt": "2020-07-31T13:57:22Z", "author": {"login": "patogallaiovlabs"}, "path": "rskj-core/src/test/java/org/ethereum/core/TransactionTest.java", "diffHunk": "@@ -712,6 +712,32 @@ function doIt(address invokedAddress) {\n         Assert.assertEquals(1, executor.getVMLogs().size());\n     }\n \n+    @Test\n+    public void verifyTx_noSignature() {\n+        BigInteger value = new BigInteger(\"1000000000000000000000\");\n+        byte[] privKey = HashUtil.keccak256(\"cat\".getBytes());\n+        ECKey ecKey = ECKey.fromPrivate(privKey);\n+        byte[] gasPrice = Hex.decode(\"09184e72a000\");\n+        byte[] gas = Hex.decode(\"4255\");\n+\n+        Transaction tx = new Transaction(new byte[0], gasPrice, gas, ecKey.getAddress(), value.toByteArray(),null);\n+        tx.verify();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "454466e31c2cb0caed9a0b69b76d2ab8f37dfc51"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NDc4NzY3OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/test/java/org/ethereum/core/TransactionTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxMzo1ODo1OFrOG6JmhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwOTozMjoyMVrOG6ys5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYyNzkwOQ==", "bodyText": "Same here.", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r463627909", "createdAt": "2020-07-31T13:58:58Z", "author": {"login": "patogallaiovlabs"}, "path": "rskj-core/src/test/java/org/ethereum/core/TransactionTest.java", "diffHunk": "@@ -712,6 +712,32 @@ function doIt(address invokedAddress) {\n         Assert.assertEquals(1, executor.getVMLogs().size());\n     }\n \n+    @Test\n+    public void verifyTx_noSignature() {\n+        BigInteger value = new BigInteger(\"1000000000000000000000\");\n+        byte[] privKey = HashUtil.keccak256(\"cat\".getBytes());\n+        ECKey ecKey = ECKey.fromPrivate(privKey);\n+        byte[] gasPrice = Hex.decode(\"09184e72a000\");\n+        byte[] gas = Hex.decode(\"4255\");\n+\n+        Transaction tx = new Transaction(new byte[0], gasPrice, gas, ecKey.getAddress(), value.toByteArray(),null);\n+        tx.verify();\n+    }\n+\n+    @Test\n+    public void verifyTx_withSignature() {\n+        BigInteger value = new BigInteger(\"1000000000000000000000\");\n+        byte[] senderPrivKey = HashUtil.keccak256(\"cow\".getBytes());\n+        byte[] privKey = HashUtil.keccak256(\"cat\".getBytes());\n+        ECKey ecKey = ECKey.fromPrivate(privKey);\n+        byte[] gasPrice = Hex.decode(\"09184e72a000\");\n+        byte[] gas = Hex.decode(\"4255\");\n+\n+        Transaction tx = new Transaction(new byte[0], gasPrice, gas, ecKey.getAddress(), value.toByteArray(),null);\n+        tx.sign(senderPrivKey);\n+        tx.verify();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "454466e31c2cb0caed9a0b69b76d2ab8f37dfc51"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwMTI4Ng==", "bodyText": "done", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r464301286", "createdAt": "2020-08-03T09:32:21Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/test/java/org/ethereum/core/TransactionTest.java", "diffHunk": "@@ -712,6 +712,32 @@ function doIt(address invokedAddress) {\n         Assert.assertEquals(1, executor.getVMLogs().size());\n     }\n \n+    @Test\n+    public void verifyTx_noSignature() {\n+        BigInteger value = new BigInteger(\"1000000000000000000000\");\n+        byte[] privKey = HashUtil.keccak256(\"cat\".getBytes());\n+        ECKey ecKey = ECKey.fromPrivate(privKey);\n+        byte[] gasPrice = Hex.decode(\"09184e72a000\");\n+        byte[] gas = Hex.decode(\"4255\");\n+\n+        Transaction tx = new Transaction(new byte[0], gasPrice, gas, ecKey.getAddress(), value.toByteArray(),null);\n+        tx.verify();\n+    }\n+\n+    @Test\n+    public void verifyTx_withSignature() {\n+        BigInteger value = new BigInteger(\"1000000000000000000000\");\n+        byte[] senderPrivKey = HashUtil.keccak256(\"cow\".getBytes());\n+        byte[] privKey = HashUtil.keccak256(\"cat\".getBytes());\n+        ECKey ecKey = ECKey.fromPrivate(privKey);\n+        byte[] gasPrice = Hex.decode(\"09184e72a000\");\n+        byte[] gas = Hex.decode(\"4255\");\n+\n+        Transaction tx = new Transaction(new byte[0], gasPrice, gas, ecKey.getAddress(), value.toByteArray(),null);\n+        tx.sign(senderPrivKey);\n+        tx.verify();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYyNzkwOQ=="}, "originalCommit": {"oid": "454466e31c2cb0caed9a0b69b76d2ab8f37dfc51"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwOTg1NDc5OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/org/ethereum/core/TransactionReceipt.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzoxODoyOVrOG8TNsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwODoyMDo1NFrOG8ocrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg4MjU0NA==", "bodyText": "fix indentation?", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r465882544", "createdAt": "2020-08-05T17:18:29Z", "author": {"login": "nicops"}, "path": "rskj-core/src/main/java/org/ethereum/core/TransactionReceipt.java", "diffHunk": "@@ -19,21 +19,17 @@\n \n package org.ethereum.core;\n \n-import org.bouncycastle.util.BigIntegers;\n-import org.bouncycastle.util.encoders.Hex;\n-import org.ethereum.util.RLP;\n-import org.ethereum.util.RLPElement;\n-import org.ethereum.util.RLPItem;\n-import org.ethereum.util.RLPList;\n-import org.ethereum.vm.LogInfo;\n-\n-import java.math.BigInteger;\n-import java.util.ArrayList;\n-import java.util.Arrays;\n-import java.util.List;\n-\n-import static co.rsk.util.ListArrayUtil.nullToEmpty;\n-import static org.ethereum.util.ByteUtil.EMPTY_BYTE_ARRAY;\n+    import org.bouncycastle.util.BigIntegers;\n+    import org.ethereum.util.*;\n+    import org.ethereum.vm.LogInfo;\n+\n+    import java.math.BigInteger;\n+    import java.util.ArrayList;\n+    import java.util.Arrays;\n+    import java.util.List;\n+\n+    import static co.rsk.util.ListArrayUtil.nullToEmpty;\n+    import static org.ethereum.util.ByteUtil.EMPTY_BYTE_ARRAY;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccca6d9ca34d87bdd340b0b0ec8592b1a2a41083"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjIzMDQ0NA==", "bodyText": "Not sure I've got the question. This was done automatically by an IDE (Optimize Imports command)", "url": "https://github.com/rsksmart/rskj/pull/1278#discussion_r466230444", "createdAt": "2020-08-06T08:20:54Z", "author": {"login": "Vovchyk"}, "path": "rskj-core/src/main/java/org/ethereum/core/TransactionReceipt.java", "diffHunk": "@@ -19,21 +19,17 @@\n \n package org.ethereum.core;\n \n-import org.bouncycastle.util.BigIntegers;\n-import org.bouncycastle.util.encoders.Hex;\n-import org.ethereum.util.RLP;\n-import org.ethereum.util.RLPElement;\n-import org.ethereum.util.RLPItem;\n-import org.ethereum.util.RLPList;\n-import org.ethereum.vm.LogInfo;\n-\n-import java.math.BigInteger;\n-import java.util.ArrayList;\n-import java.util.Arrays;\n-import java.util.List;\n-\n-import static co.rsk.util.ListArrayUtil.nullToEmpty;\n-import static org.ethereum.util.ByteUtil.EMPTY_BYTE_ARRAY;\n+    import org.bouncycastle.util.BigIntegers;\n+    import org.ethereum.util.*;\n+    import org.ethereum.vm.LogInfo;\n+\n+    import java.math.BigInteger;\n+    import java.util.ArrayList;\n+    import java.util.Arrays;\n+    import java.util.List;\n+\n+    import static co.rsk.util.ListArrayUtil.nullToEmpty;\n+    import static org.ethereum.util.ByteUtil.EMPTY_BYTE_ARRAY;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg4MjU0NA=="}, "originalCommit": {"oid": "ccca6d9ca34d87bdd340b0b0ec8592b1a2a41083"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4444, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}