{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MDc2MTU4", "number": 1166, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNToyMToyMVrODb9DdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNTo0OToyMlrODb9t9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjM4NDUyOnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/core/DifficultyCalculator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNToyMToyMVrOFju5hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNToyMToyMVrOFju5hw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAxMjg3MQ==", "bodyText": "Since the method is no longer static I think the constants parameter could be dropped", "url": "https://github.com/rsksmart/rskj/pull/1166#discussion_r373012871", "createdAt": "2020-01-30T15:21:21Z", "author": {"login": "M-Picco"}, "path": "rskj-core/src/main/java/co/rsk/core/DifficultyCalculator.java", "diffHunk": "@@ -48,7 +48,7 @@ public BlockDifficulty calcDifficulty(BlockHeader header, BlockHeader parentHead\n         return getBlockDifficulty(header, parentHeader, constants);\n     }\n \n-    private static BlockDifficulty getBlockDifficulty(\n+    private BlockDifficulty getBlockDifficulty(\n             BlockHeader curBlockHeader,\n             BlockHeader parent,\n             Constants constants) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b0e99e071247ee95de74513821a8879f919de5f"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjM5MzE2OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/core/DifficultyCalculator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNToyMzozNVrOFju-7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNToyMzozNVrOFju-7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAxNDI1Mg==", "bodyText": "Could a constant be introduced for the value 400?", "url": "https://github.com/rsksmart/rskj/pull/1166#discussion_r373014252", "createdAt": "2020-01-30T15:23:35Z", "author": {"login": "M-Picco"}, "path": "rskj-core/src/main/java/co/rsk/core/DifficultyCalculator.java", "diffHunk": "@@ -58,6 +58,11 @@ private static BlockDifficulty getBlockDifficulty(\n         long curBlockTS = curBlockHeader.getTimestamp();\n         int duration = constants.getDurationLimit();\n         BigInteger difDivisor = constants.getDifficultyBoundDivisor();\n+        if (activationConfig.isActive(ConsensusRule.RSKIP156, curBlockHeader.getNumber())\n+            && constants.getChainId() != Constants.REGTEST_CHAIN_ID) {\n+            // Unless we are in regtest, this RSKIP increments the difficulty divisor from 50 to 400\n+            difDivisor = BigInteger.valueOf(400);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b0e99e071247ee95de74513821a8879f919de5f"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjM5ODQ3OnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/co/rsk/core/DifficultyCalculator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNToyNDo1MVrOFjvCVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNToyNDo1MVrOFjvCVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAxNTEyNA==", "bodyText": "This new block could be moved to a private method which returns the final divisor in order to improve legibility.", "url": "https://github.com/rsksmart/rskj/pull/1166#discussion_r373015124", "createdAt": "2020-01-30T15:24:51Z", "author": {"login": "M-Picco"}, "path": "rskj-core/src/main/java/co/rsk/core/DifficultyCalculator.java", "diffHunk": "@@ -58,6 +58,11 @@ private static BlockDifficulty getBlockDifficulty(\n         long curBlockTS = curBlockHeader.getTimestamp();\n         int duration = constants.getDurationLimit();\n         BigInteger difDivisor = constants.getDifficultyBoundDivisor();\n+        if (activationConfig.isActive(ConsensusRule.RSKIP156, curBlockHeader.getNumber())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b0e99e071247ee95de74513821a8879f919de5f"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjQ5MzMzOnYy", "diffSide": "RIGHT", "path": "rskj-core/src/main/java/org/ethereum/config/Constants.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNTo0OToyMlrOFjv-cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNTo0OToyMlrOFjv-cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAzMDUxMw==", "bodyText": "Since this \"constant\" is no longer constant maybe we should find a way to remove it from here", "url": "https://github.com/rsksmart/rskj/pull/1166#discussion_r373030513", "createdAt": "2020-01-30T15:49:22Z", "author": {"login": "M-Picco"}, "path": "rskj-core/src/main/java/org/ethereum/config/Constants.java", "diffHunk": "@@ -89,6 +89,7 @@ public BlockDifficulty getFallbackMiningDifficulty() {\n     }\n \n     public BigInteger getDifficultyBoundDivisor() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b0e99e071247ee95de74513821a8879f919de5f"}, "originalPosition": 3}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4552, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}