{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3NTAzMzk1", "number": 1376, "title": "Save data of Fast Bridge in Storage", "bodyText": "", "createdAt": "2020-11-25T14:54:33Z", "url": "https://github.com/rsksmart/rskj/pull/1376", "merged": true, "mergeCommit": {"oid": "c214a53f86fb188f4f161e63f1f32d6aa0afb0a4"}, "closed": true, "closedAt": "2020-11-27T13:28:36Z", "author": {"login": "pamgonzalez"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdf_6fwAH2gAyNTI3NTAzMzk1OjFlYTc2M2M3OWI0ZGFiZGUwNzQ5ODNmMzdiNjI2ZmQyNTZhMDYyMWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgV4eLAFqTUzOTQ1ODg0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1ea763c79b4dabde074983f37b626fd256a0621b", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/1ea763c79b4dabde074983f37b626fd256a0621b", "committedDate": "2020-11-25T15:16:48Z", "message": "Save data of Fast Bridge in Storage"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f4f8e4d0f8231532f7f15338f28a934dff42544", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/2f4f8e4d0f8231532f7f15338f28a934dff42544", "committedDate": "2020-11-25T14:48:45Z", "message": "Save data of Fast Bridge in Storage"}, "afterCommit": {"oid": "1ea763c79b4dabde074983f37b626fd256a0621b", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/1ea763c79b4dabde074983f37b626fd256a0621b", "committedDate": "2020-11-25T15:16:48Z", "message": "Save data of Fast Bridge in Storage"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4NjA1NTgw", "url": "https://github.com/rsksmart/rskj/pull/1376#pullrequestreview-538605580", "createdAt": "2020-11-25T15:20:51Z", "commit": {"oid": "1ea763c79b4dabde074983f37b626fd256a0621b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "167ae434b861cd52d8767c0baff6d12ce99e3511", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/167ae434b861cd52d8767c0baff6d12ce99e3511", "committedDate": "2020-11-25T19:31:35Z", "message": "Modify the validation if the transaction was processed, consulting the storageProvider.\n\nThis check is performed both with the hash of the transaction with or without witness."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "79c2852b64b93a01e928bf362e1f3acf6beceec9", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/79c2852b64b93a01e928bf362e1f3acf6beceec9", "committedDate": "2020-11-25T18:52:41Z", "message": "Modify the validation if the transaction was processed, consulting the storageProvider.\n\nThis check is performed both with the hash of the transaction with or without witness."}, "afterCommit": {"oid": "167ae434b861cd52d8767c0baff6d12ce99e3511", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/167ae434b861cd52d8767c0baff6d12ce99e3511", "committedDate": "2020-11-25T19:31:35Z", "message": "Modify the validation if the transaction was processed, consulting the storageProvider.\n\nThis check is performed both with the hash of the transaction with or without witness."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4Nzk5NzQ4", "url": "https://github.com/rsksmart/rskj/pull/1376#pullrequestreview-538799748", "createdAt": "2020-11-25T19:39:42Z", "commit": {"oid": "167ae434b861cd52d8767c0baff6d12ce99e3511"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxOTozOTo0M1rOH6Bh6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxOTozOTo0M1rOH6Bh6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDYwNDUyMA==", "bodyText": "remove thenReturn(false)", "url": "https://github.com/rsksmart/rskj/pull/1376#discussion_r530604520", "createdAt": "2020-11-25T19:39:43Z", "author": {"login": "guidohernan93"}, "path": "rskj-core/src/test/java/co/rsk/peg/BridgeSupportTest.java", "diffHunk": "@@ -5134,6 +5183,65 @@ public void registerFastBridgeBtcTransaction_amount_sent_is_0()\n         Assert.assertEquals(BridgeSupport.FAST_BRIDGE_UNPROCESSABLE_TX_VALUE_ZERO_ERROR, result);\n     }\n \n+    @Test\n+    public void registerFastBridgeBtcTransaction_TxWitnessAlreadySavedInStorage_returnsError()\n+            throws BlockStoreException, IOException {\n+        ActivationConfig.ForBlock activations = mock(ActivationConfig.ForBlock.class);\n+        when(activations.isActive(ConsensusRule.RSKIP176)).thenReturn(true);\n+\n+        Context btcContext = mock(Context.class);\n+        when(btcContext.getParams()).thenReturn(bridgeConstants.getBtcParams());\n+\n+        BridgeStorageProvider provider = mock(BridgeStorageProvider.class);\n+        when(provider.isFastBridgeFederationDerivationHashUsed(any(), any())).thenReturn(false).thenReturn(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "167ae434b861cd52d8767c0baff6d12ce99e3511"}, "originalPosition": 88}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NDU4ODQ4", "url": "https://github.com/rsksmart/rskj/pull/1376#pullrequestreview-539458848", "createdAt": "2020-11-26T16:45:21Z", "commit": {"oid": "167ae434b861cd52d8767c0baff6d12ce99e3511"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNjo0NToyMVrOH6iZQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNjo0NToyMVrOH6iZQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE0Mjk3Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               // This method will be used by registerBtcTransfer to save all the data required on storage (utxos, btcTxHash-derivationHash),\n          \n          \n            \n               // This method will be used by registerFastBridgeBtcTransaction to save all the data required on storage (utxos, btcTxHash-derivationHash),\n          \n      \n    \n    \n  \n\nI think the comment could be completely deleted", "url": "https://github.com/rsksmart/rskj/pull/1376#discussion_r531142976", "createdAt": "2020-11-26T16:45:21Z", "author": {"login": "josedahlquist"}, "path": "rskj-core/src/main/java/co/rsk/peg/BridgeSupport.java", "diffHunk": "@@ -2292,6 +2295,20 @@ protected Coin getAmountSentToAddress(BtcTransaction btcTx, Address btcAddress)\n         return v;\n     }\n \n+   // This method will be used by registerBtcTransfer to save all the data required on storage (utxos, btcTxHash-derivationHash),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "167ae434b861cd52d8767c0baff6d12ce99e3511"}, "originalPosition": 61}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 435, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}