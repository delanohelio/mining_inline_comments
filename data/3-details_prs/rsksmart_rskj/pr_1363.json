{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxODM4Nzgw", "number": 1363, "title": "Changes in signature of the function of FastBridgeTransaction", "bodyText": "", "createdAt": "2020-11-16T18:09:26Z", "url": "https://github.com/rsksmart/rskj/pull/1363", "merged": true, "mergeCommit": {"oid": "6477d9f330feb5de55a7e4729dd7ed844f853115"}, "closed": true, "closedAt": "2020-11-19T14:27:45Z", "author": {"login": "pamgonzalez"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddJLdVAFqTUzMTU4NjkzMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeDmFygBqjQwMTYxMjU0Njc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNTg2OTMz", "url": "https://github.com/rsksmart/rskj/pull/1363#pullrequestreview-531586933", "createdAt": "2020-11-16T18:20:09Z", "commit": {"oid": "fc02bfbfce90e610bffc1bc060e17df8fb6a9f6b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxODoyMDowOVrOH0Ln-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxODoyMjoyMlrOH0LtKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQ3ODQ1OA==", "bodyText": "Coukld we check if the argument is really an address? Now, the code discard the \"left-most\" bytes, that could contain anything.", "url": "https://github.com/rsksmart/rskj/pull/1363#discussion_r524478458", "createdAt": "2020-11-16T18:20:09Z", "author": {"login": "ajlopezrsk"}, "path": "rskj-core/src/main/java/co/rsk/peg/Bridge.java", "diffHunk": "@@ -1094,20 +1095,20 @@ public boolean hasBtcBlockCoinbaseTransactionInformation(Object[] args) {\n         return bridgeSupport.hasBtcBlockCoinbaseTransactionInformation(blockHash);\n     }\n \n-    public int registerBtcTransfer(Object[] args) {\n-        logger.trace(\"registerBtcTransfer\");\n-\n-        byte[] btcTxSerialized = (byte[]) args[0];\n-        int height = ((BigInteger) args[1]).intValue();\n-        byte[] pmtSerialized = (byte[]) args[2];\n-        Sha256Hash derivationArgumentsHash = Sha256Hash.wrap((byte[]) args[3]);\n-        Address userRefundAddress = new Address(bridgeConstants.getBtcParams(), (byte[]) args[4]);\n-        RskAddress lbcAddress = new RskAddress((String) args[5]);\n-        Address lpBtcAddress = new Address(bridgeConstants.getBtcParams(), (byte[]) args[6]);\n-        boolean executionStatus = (Boolean) args[7];\n+    public int registerFastBridgeBtcTransaction(Object[] args) {\n+        logger.trace(\"registerFastBridgeBtcTransaction\");\n \n         try {\n-            return bridgeSupport.registerBtcTransfer(\n+            byte[] btcTxSerialized = (byte[]) args[0];\n+            int height = ((BigInteger) args[1]).intValue();\n+            byte[] pmtSerialized = (byte[]) args[2];\n+            Sha256Hash derivationArgumentsHash = Sha256Hash.wrap((byte[]) args[3]);\n+            Address userRefundAddress = new Address(bridgeConstants.getBtcParams(), (byte[]) args[4]);\n+            RskAddress lbcAddress = new RskAddress(((DataWord)args[5]).getLast20Bytes());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc02bfbfce90e610bffc1bc060e17df8fb6a9f6b"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQ3OTc4NA==", "bodyText": "Why this change is NOT A HARD FORK? AFAIK, this change doesn't rerun previous sent transactions", "url": "https://github.com/rsksmart/rskj/pull/1363#discussion_r524479784", "createdAt": "2020-11-16T18:22:22Z", "author": {"login": "ajlopezrsk"}, "path": "rskj-core/src/main/java/co/rsk/peg/BridgeMethods.java", "diffHunk": "@@ -577,14 +577,14 @@\n             activations -> activations.isActive(RSKIP143),\n             false\n     ),\n-    REGISTER_BTC_TRANSFER(\n+    REGISTER_FAST_BRIDGE_BTC_TRANSACTION(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc02bfbfce90e610bffc1bc060e17df8fb6a9f6b"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc02bfbfce90e610bffc1bc060e17df8fb6a9f6b", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/fc02bfbfce90e610bffc1bc060e17df8fb6a9f6b", "committedDate": "2020-11-16T17:49:28Z", "message": "Changes in signature of the function of FastBridgeTransaction\n\nFunction named registerBtcTransfer has been renamed by registerFastBridgeBtcTransaction.\nParameter shouldTransferToContract (boolean type) has been replaced by transferToValue (Coin type)."}, "afterCommit": {"oid": "d4bd7cdc025258f2dbfe866d9b19758b7c11a1df", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/d4bd7cdc025258f2dbfe866d9b19758b7c11a1df", "committedDate": "2020-11-16T19:21:39Z", "message": "Changes in signature of the function of FastBridgeTransaction\n\nFunction named registerBtcTransfer has been renamed by registerFastBridgeBtcTransaction.\nParameter shouldTransferToContract (boolean type) has been replaced by transferToValue (Coin type)."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNDI3NjQ5", "url": "https://github.com/rsksmart/rskj/pull/1363#pullrequestreview-532427649", "createdAt": "2020-11-17T14:38:57Z", "commit": {"oid": "d4bd7cdc025258f2dbfe866d9b19758b7c11a1df"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDozODo1N1rOH0366w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDozODo1N1rOH0366w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIwNDIwMw==", "bodyText": "RegisterBtcTransactionException should not be needed I think", "url": "https://github.com/rsksmart/rskj/pull/1363#discussion_r525204203", "createdAt": "2020-11-17T14:38:57Z", "author": {"login": "guidohernan93"}, "path": "rskj-core/src/main/java/co/rsk/peg/Bridge.java", "diffHunk": "@@ -1116,10 +1117,11 @@ public int registerBtcTransfer(Object[] args) {\n                 userRefundAddress,\n                 lbcAddress,\n                 lpBtcAddress,\n-                executionStatus);\n-        } catch (BlockStoreException | RegisterBtcTransferException | IOException | RegisterBtcTransactionException e) {\n-            logger.warn(\"Exception in registerBtcTransfer\", e);\n-            throw new RuntimeException(\"Exception in registerBtcTransfer\", e);\n+                valueToTransfer\n+            );\n+        } catch (BlockStoreException | RegisterFastBridgeBtcTransactionException | IOException | RegisterBtcTransactionException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4bd7cdc025258f2dbfe866d9b19758b7c11a1df"}, "originalPosition": 60}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4bd7cdc025258f2dbfe866d9b19758b7c11a1df", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/d4bd7cdc025258f2dbfe866d9b19758b7c11a1df", "committedDate": "2020-11-16T19:21:39Z", "message": "Changes in signature of the function of FastBridgeTransaction\n\nFunction named registerBtcTransfer has been renamed by registerFastBridgeBtcTransaction.\nParameter shouldTransferToContract (boolean type) has been replaced by transferToValue (Coin type)."}, "afterCommit": {"oid": "f2e185430e95e3fd524d44c27f2c4c69000df74d", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/f2e185430e95e3fd524d44c27f2c4c69000df74d", "committedDate": "2020-11-18T16:27:38Z", "message": "Changes in signature of the function of FastBridgeTransaction\n\nFunction named registerBtcTransfer has been renamed by registerFastBridgeBtcTransaction.\nParameter shouldTransferToContract (boolean type) has been replaced by transferToValue (Coin type)."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzNzExNjg2", "url": "https://github.com/rsksmart/rskj/pull/1363#pullrequestreview-533711686", "createdAt": "2020-11-18T17:37:36Z", "commit": {"oid": "f2e185430e95e3fd524d44c27f2c4c69000df74d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NDg5Mjcx", "url": "https://github.com/rsksmart/rskj/pull/1363#pullrequestreview-534489271", "createdAt": "2020-11-19T14:18:00Z", "commit": {"oid": "f2e185430e95e3fd524d44c27f2c4c69000df74d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54deb6a737adb2022076c92cca0fe6a1ef53ec2c", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/54deb6a737adb2022076c92cca0fe6a1ef53ec2c", "committedDate": "2020-11-19T14:25:11Z", "message": "Changes in signature of the function of FastBridgeTransaction\n\nFunction named registerBtcTransfer has been renamed by registerFastBridgeBtcTransaction.\nParameter shouldTransferToContract (boolean type) has been replaced by transferToValue (Coin type)."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f2e185430e95e3fd524d44c27f2c4c69000df74d", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/f2e185430e95e3fd524d44c27f2c4c69000df74d", "committedDate": "2020-11-18T16:27:38Z", "message": "Changes in signature of the function of FastBridgeTransaction\n\nFunction named registerBtcTransfer has been renamed by registerFastBridgeBtcTransaction.\nParameter shouldTransferToContract (boolean type) has been replaced by transferToValue (Coin type)."}, "afterCommit": {"oid": "54deb6a737adb2022076c92cca0fe6a1ef53ec2c", "author": {"user": null}, "url": "https://github.com/rsksmart/rskj/commit/54deb6a737adb2022076c92cca0fe6a1ef53ec2c", "committedDate": "2020-11-19T14:25:11Z", "message": "Changes in signature of the function of FastBridgeTransaction\n\nFunction named registerBtcTransfer has been renamed by registerFastBridgeBtcTransaction.\nParameter shouldTransferToContract (boolean type) has been replaced by transferToValue (Coin type)."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 630, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}