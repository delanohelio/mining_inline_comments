{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxNTcxNTE0", "number": 340, "title": "Fix the issue in semantic analyzer.", "bodyText": "Change the return Type of the LOG function.\nAdd the support of CAST function.\n\nIssue #, if available:\nDescription of changes:\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-01-10T18:31:10Z", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/340", "merged": true, "mergeCommit": {"oid": "4b729a11f28cdfeace2556338600f3e92a989395"}, "closed": true, "closedAt": "2020-01-13T17:21:35Z", "author": {"login": "penghuo"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb5C2PWAH2gAyMzYxNTcxNTE0OjIxZGU2MTgyN2Y0MjM3MTAwYmViZjExNTk2YWE2ZTRkNmUxNzQyOWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb5_sPKgH2gAyMzYxNTcxNTE0OjNmZTFiZWQ0NzI0YzJjNDA5NTRmZTE0NTg5YzA5ZTBmMjhhNmE1NTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "21de61827f4237100bebf11596aa6e4d6e17429d", "author": {"user": {"login": "penghuo", "name": "Peng Huo"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/21de61827f4237100bebf11596aa6e4d6e17429d", "committedDate": "2020-01-10T18:27:40Z", "message": "Fix the issue in sematic analyaer\n1. Change the return Type of the LOG function.\n2. Add the support of CAST function."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNDU5NzA3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/340#pullrequestreview-341459707", "createdAt": "2020-01-10T22:38:46Z", "commit": {"oid": "21de61827f4237100bebf11596aa6e4d6e17429d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNDcxMTM3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/340#pullrequestreview-341471137", "createdAt": "2020-01-10T23:19:12Z", "commit": {"oid": "21de61827f4237100bebf11596aa6e4d6e17429d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQyMzoxOToxMlrOFciZPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQyMzoxOToxMlrOFciZPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ2Nzk2Ng==", "bodyText": "David's PR reminds me that some type in convertedDataType doesn't have corresponding type in ESDateType, such as DATETIME and INT. Could you verify if it's an issue or not? I guess UNKNOWN is returned in this case. It is fine for type checking but it may be not what you expect.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/340#discussion_r365467966", "createdAt": "2020-01-10T23:19:12Z", "author": {"login": "dai-chen"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/sql/antlr/semantic/visitor/TypeChecker.java", "diffHunk": "@@ -173,6 +173,11 @@ public Type visitNull() {\n         return UNKNOWN;\n     }\n \n+    @Override\n+    public Type visitConvertedType(String text) {\n+        return ESDataType.typeOf(text);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21de61827f4237100bebf11596aa6e4d6e17429d"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNDg0NDQ3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/340#pullrequestreview-341484447", "createdAt": "2020-01-11T00:21:02Z", "commit": {"oid": "21de61827f4237100bebf11596aa6e4d6e17429d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMVQwMDoyMTowMlrOFcjE_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMVQwMDoyMTowMlrOFcjE_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ3OTE2NA==", "bodyText": "is there a need for test cases going the other way around (e.g assertEquals(LONG, LOG.construct(singletonList(DOUBLE))) ?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/340#discussion_r365479164", "createdAt": "2020-01-11T00:21:02Z", "author": {"login": "davidcui1225"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/sql/antlr/semantic/types/GenericTypeTest.java", "diffHunk": "@@ -34,17 +35,17 @@\n \n     @Test\n     public void passNumberArgToLogShouldReturnNumber() {\n-        assertEquals(NUMBER, LOG.construct(singletonList(NUMBER)));\n+        assertEquals(DOUBLE, LOG.construct(singletonList(NUMBER)));\n     }\n \n     @Test\n     public void passIntegerArgToLogShouldReturnInteger() {\n-        assertEquals(INTEGER, LOG.construct(singletonList(INTEGER)));\n+        assertEquals(DOUBLE, LOG.construct(singletonList(INTEGER)));\n     }\n \n     @Test\n     public void passLongArgToLogShouldReturnLong() {\n-        assertEquals(LONG, LOG.construct(singletonList(LONG)));\n+        assertEquals(DOUBLE, LOG.construct(singletonList(LONG)));\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21de61827f4237100bebf11596aa6e4d6e17429d"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fe1bed4724c2c40954fe14589c09e0f28a6a558", "author": {"user": {"login": "penghuo", "name": "Peng Huo"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/3fe1bed4724c2c40954fe14589c09e0f28a6a558", "committedDate": "2020-01-13T17:20:57Z", "message": "update"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 728, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}