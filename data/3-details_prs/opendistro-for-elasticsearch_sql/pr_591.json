{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxNDg1ODgz", "number": 591, "title": "Support mathematical functions rand and constants e, pi", "bodyText": "Issue #, if available:\nDescription of changes:\n\n\nRAND\nUsage: rand()/rand(N) returns a random floating-point value in the range 0 <= value < 1.0. If integer N is specified, the seed is initialized prior to execution. One implication of this behavior is with identical argument N, rand(N) returns the same value each time, and thus produces a repeatable sequence of column values.\nArgument type: x: STRING, a: INTEGER, b: INTEGER\nReturn type: STRING\n\n\nE\nUsage: e() returns the Euler's number\nReturn type: DOUBLE\n\n\nPI\nUsage: pi() returns the constant pi\nReturn type: DOUBLE\n\n\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-07-17T21:51:10Z", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591", "merged": true, "mergeCommit": {"oid": "78a51a45364e86f49f62b24b18f85319876d55b1"}, "closed": true, "closedAt": "2020-07-22T17:06:44Z", "author": {"login": "chloe-zh"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc16vy3AH2gAyNDUxNDg1ODgzOjQ2ZjcyNWIyNGYzODQxMzMwODExMTc2NTBkMDc3ZmJmMTdjMDA3NTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3ccREAFqTQ1MzQyNDQzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "46f725b24f384133081117650d077fbf17c00755", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/46f725b24f384133081117650d077fbf17c00755", "committedDate": "2020-07-17T21:30:46Z", "message": "support e, pi, rand"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bb1317f49f236284a3f4cc7be1d2bb3539147e2", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/9bb1317f49f236284a3f4cc7be1d2bb3539147e2", "committedDate": "2020-07-20T17:37:25Z", "message": "Merge branch 'develop' into math3\n\n# Conflicts:\n#\tcore/src/main/java/com/amazon/opendistroforelasticsearch/sql/expression/DSL.java\n#\tcore/src/main/java/com/amazon/opendistroforelasticsearch/sql/expression/function/BuiltinFunctionName.java\n#\tcore/src/main/java/com/amazon/opendistroforelasticsearch/sql/expression/operator/arthmetic/MathematicalFunction.java\n#\tcore/src/test/java/com/amazon/opendistroforelasticsearch/sql/expression/operator/arthmetic/MathematicalFunctionTest.java\n#\tinteg-test/src/test/java/com/amazon/opendistroforelasticsearch/sql/ppl/MathematicalFunctionIT.java\n#\tinteg-test/src/test/resources/correctness/expressions/functions.txt\n#\tppl/src/main/antlr/OpenDistroPPLLexer.g4\n#\tppl/src/main/antlr/OpenDistroPPLParser.g4\n#\tsql/src/main/antlr/OpenDistroSQLParser.g4"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbb7df29e2f9b33196405e73790662ad353f11ac", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/dbb7df29e2f9b33196405e73790662ad353f11ac", "committedDate": "2020-07-20T19:04:27Z", "message": "updated doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "901aed6d27a1d5b3a3a70d7bd43ba4f2c096ef64", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/901aed6d27a1d5b3a3a70d7bd43ba4f2c096ef64", "committedDate": "2020-07-20T19:38:01Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "075551350f29253263d38fd5071c1e73891743b6", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/075551350f29253263d38fd5071c1e73891743b6", "committedDate": "2020-07-20T20:13:01Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxOTY2Mjky", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591#pullrequestreview-451966292", "createdAt": "2020-07-20T21:17:48Z", "commit": {"oid": "075551350f29253263d38fd5071c1e73891743b6"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMToxNzo0OFrOG0fnoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQyMToyNDo0OVrOG0f0pA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5NzE4NQ==", "bodyText": "is this not necessary because of functionArgs? in functionCall? And I think it's more appropriate to mark this optional in functionCall for PPL too?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591#discussion_r457697185", "createdAt": "2020-07-20T21:17:48Z", "author": {"login": "dai-chen"}, "path": "sql/src/main/antlr/OpenDistroSQLParser.g4", "diffHunk": "@@ -166,16 +166,16 @@ scalarFunctionName\n     ;\n \n mathematicalFunctionName\n-    : ABS | CEIL | CEILING | CONV | CRC32 | EXP | FLOOR | LN | LOG | LOG10 | LOG2 | MOD | POW | POWER\n-    | ROUND | SIGN | SQRT | TRUNCATE\n+    : ABS | CEIL | CEILING | CONV | CRC32 | E | EXP | FLOOR | LN | LOG | LOG10 | LOG2 | MOD | PI | POW | POWER\n+    | RAND | ROUND | SIGN | SQRT | TRUNCATE\n     ;\n \n dateTimeFunctionName\n     : DAYOFMONTH\n     ;\n \n functionArgs\n-    : functionArg (COMMA functionArg)*\n+    : (functionArg (COMMA functionArg)*)?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "075551350f29253263d38fd5071c1e73891743b6"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5ODg0NQ==", "bodyText": "return type is float?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591#discussion_r457698845", "createdAt": "2020-07-20T21:21:27Z", "author": {"login": "dai-chen"}, "path": "docs/user/dql/functions.rst", "diffHunk": "@@ -616,10 +636,21 @@ RAND\n Description\n -----------\n \n-Specifications: \n+Usage: RAND()/RAND(N) returns a random floating-point value in the range 0 <= value < 1.0. If integer N is specified, the seed is initialized prior to execution. One implication of this behavior is with identical argument N, rand(N) returns the same value each time, and thus produces a repeatable sequence of column values.\n+\n+Argument type: x: STRING, a: INTEGER, b: INTEGER\n \n-1. RAND() -> NUMBER\n-2. RAND(NUMBER T) -> T\n+Return type: STRING", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "075551350f29253263d38fd5071c1e73891743b6"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzcwMDUxNg==", "bodyText": "what does this mean?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591#discussion_r457700516", "createdAt": "2020-07-20T21:24:49Z", "author": {"login": "dai-chen"}, "path": "docs/user/dql/functions.rst", "diffHunk": "@@ -616,10 +636,21 @@ RAND\n Description\n -----------\n \n-Specifications: \n+Usage: RAND()/RAND(N) returns a random floating-point value in the range 0 <= value < 1.0. If integer N is specified, the seed is initialized prior to execution. One implication of this behavior is with identical argument N, rand(N) returns the same value each time, and thus produces a repeatable sequence of column values.\n+\n+Argument type: x: STRING, a: INTEGER, b: INTEGER", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "075551350f29253263d38fd5071c1e73891743b6"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e99698b5407b52a68ebddb6d238407ad35e70a18", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/e99698b5407b52a68ebddb6d238407ad35e70a18", "committedDate": "2020-07-21T16:47:51Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNzU4NjY0", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591#pullrequestreview-452758664", "createdAt": "2020-07-21T19:19:45Z", "commit": {"oid": "e99698b5407b52a68ebddb6d238407ad35e70a18"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxOToxOTo0NVrOG1GXdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxOToxOTo0NVrOG1GXdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMzMjAyMA==", "bodyText": "Sorry for last minute comment. Since we haven't added many functions yet, could you check if the column name required to be all upper case (ex. E(), PI()) or not? In MySQL or SQL standard.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591#discussion_r458332020", "createdAt": "2020-07-21T19:19:45Z", "author": {"login": "dai-chen"}, "path": "docs/user/dql/functions.rst", "diffHunk": "@@ -291,9 +291,19 @@ E\n Description\n -----------\n \n-Specifications: \n+Usage: E() returns the Euler's number\n \n-1. E() -> DOUBLE\n+Return type: DOUBLE\n+\n+Example::\n+\n+    od> SELECT E()\n+    fetched rows / total rows = 1/1\n+    +-------------------+\n+    | e()               |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e99698b5407b52a68ebddb6d238407ad35e70a18"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyODU0MTM3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591#pullrequestreview-452854137", "createdAt": "2020-07-21T21:48:51Z", "commit": {"oid": "e99698b5407b52a68ebddb6d238407ad35e70a18"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNDI0NDM4", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/591#pullrequestreview-453424438", "createdAt": "2020-07-22T15:20:08Z", "commit": {"oid": "e99698b5407b52a68ebddb6d238407ad35e70a18"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 592, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}