{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY4MjM0NjQw", "number": 687, "title": "Add temporal interval data type and support interval clause as function", "bodyText": "Issue #, if available:\nDescription of changes:\nDoc: https://github.com/chloe-zh/sql/blob/interval/docs/user/general/datatypes.rst\n\n\nAdded INTERVAL data type in the SQL language structure. Syntax: INTERVAL expr unit. The corresponding expression value is ExprIntervalValue that can encapsulate the temporal amount as the property value.\n\n\nQuantity expression expr in interval clause can be any value expression, including the basic numeric values, field expression, functions etc. which has been revealed in the parser.\n\n\nInterval units to support for phase 1: microsecond, second, minute, hour, day, week, month, quarter, year.\n\n\nAdded docs for date and time data types.\n\n\n[TODO] Current PR does not contain examples of date and time types in the reference manual yet. These examples will be added in the coming PR for datetime functions where functions date, time, datetime, timestamp and interval are implemented.\n\n\nNote:\nInterval data type maps to TemporalAmount in Java runtime, it has two types of amount Duration subclass that can be mapped with microseconds to days, where all amount would be converted to a value with second as the unit; and another amount Period can be mapped with days to years, where the values would be converted to some value with day as the the unit. This rule is similar to H2: https://www.h2database.com/html/datatypes.html#interval_type\nIn this PR, these two types are sharing the same syntax, but will differ in the storage method, and is only comparable with the same type of interval. For example, the comparison between INTERVAL 1 week with INTERVAL 1 month will result in 1 week is shorter than 1 month, but an attempt to compare INTERVAL 1 week with INTERVAL 1 minute will fail and throw an exception. Which is also similar to H2 behavior.\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-08-15T00:39:46Z", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687", "merged": true, "mergeCommit": {"oid": "e52db25a59168d26cdd45e3d8246f48421905a1f"}, "closed": true, "closedAt": "2020-08-20T23:05:04Z", "author": {"login": "chloe-zh"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc--MTEAH2gAyNDY4MjM0NjQwOmYwNzM1MmM5M2U5MWE0YTRjZTkyMjllNDZiYjA3M2MyMzY1YTY5YjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdA4Tf6gH2gAyNDY4MjM0NjQwOjQ5MjAwN2JmMTZjNWVmYTgwMDViOGEzZTc5YTI4YmMxNTIxYzA0MjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f07352c93e91a4a4ce9229e46bb073c2365a69b2", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/f07352c93e91a4a4ce9229e46bb073c2365a69b2", "committedDate": "2020-08-15T00:36:56Z", "message": "add interval type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "703ce05e095c1e1298a88a7590fffd614825bc34", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/703ce05e095c1e1298a88a7590fffd614825bc34", "committedDate": "2020-08-15T00:37:10Z", "message": "Merge remote-tracking branch 'upstream/develop' into interval"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99253c88988ea6a62a7ca08eb1e3cd0bca6c535d", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/99253c88988ea6a62a7ca08eb1e3cd0bca6c535d", "committedDate": "2020-08-15T00:41:35Z", "message": "add interval type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10084ad0cf8c1c6bbfa8f770bc889e61b4c5ea61", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/10084ad0cf8c1c6bbfa8f770bc889e61b4c5ea61", "committedDate": "2020-08-17T21:17:13Z", "message": "added docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29e9d4c44bb4f6b3b183c80a04615a5b427780de", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/29e9d4c44bb4f6b3b183c80a04615a5b427780de", "committedDate": "2020-08-17T21:35:47Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60a6da0a9aae1d38455391b7702bd7761f98c8d3", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/60a6da0a9aae1d38455391b7702bd7761f98c8d3", "committedDate": "2020-08-17T21:44:40Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/7ba1c60001a030fee5f39928e06478e8ad57ffd5", "committedDate": "2020-08-17T22:56:01Z", "message": "Merge remote-tracking branch 'upstream/develop' into interval"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjIwMjU3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#pullrequestreview-469620257", "createdAt": "2020-08-18T16:22:20Z", "commit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjoyMVrOHCcNbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjoyMVrOHCcNbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyMTM5MQ==", "bodyText": "Typo, Bides -> ?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#discussion_r472321391", "createdAt": "2020-08-18T16:22:21Z", "author": {"login": "penghuo"}, "path": "docs/user/general/datatypes.rst", "diffHunk": "@@ -0,0 +1,206 @@\n+\n+==========\n+Data Types\n+==========\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+   :depth: 2\n+\n+\n+Overview\n+========\n+\n+ODFE SQL Data Types\n+-------------------\n+\n+The ODFE SQL Engine support the following data types.\n+\n++---------------+\n+| ODFE SQL Type |\n++===============+\n+| boolean       |\n++---------------+\n+| integer       |\n++---------------+\n+| long          |\n++---------------+\n+| float         |\n++---------------+\n+| double        |\n++---------------+\n+| string        |\n++---------------+\n+| text          |\n++---------------+\n+| timestamp     |\n++---------------+\n+| datetime      |\n++---------------+\n+| date          |\n++---------------+\n+| time          |\n++---------------+\n+| interval      |\n++---------------+\n+| struct        |\n++---------------+\n+| array         |\n++---------------+\n+\n+Data Types Mapping\n+------------------\n+\n+The table below list the mapping between Elasticsearch Data Type, ODFE SQL Data Type and SQL Type.\n+\n++--------------------+---------------+-----------+\n+| Elasticsearch Type | ODFE SQL Type | SQL Type  |\n++====================+===============+===========+\n+| boolean            | boolean       | BOOLEAN   |\n++--------------------+---------------+-----------+\n+| integer            | integer       | INTEGER   |\n++--------------------+---------------+-----------+\n+| long               | long          | LONG      |\n++--------------------+---------------+-----------+\n+| float              | float         | FLOAT     |\n++--------------------+---------------+-----------+\n+| double             | double        | DOUBLE    |\n++--------------------+---------------+-----------+\n+| keyword            | string        | VARCHAR   |\n++--------------------+---------------+-----------+\n+| text               | text          | VARCHAR   |\n++--------------------+---------------+-----------+\n+| date               | timestamp     | TIMESTAMP |\n++--------------------+---------------+-----------+\n+| object             | struct        | STRUCT    |\n++--------------------+---------------+-----------+\n+| nested             | array         | TBD       |\n++--------------------+---------------+-----------+\n+\n+Notes: Not all the ODFE SQL Type has correspond Elasticsearch Type. e.g. data and time. To use function which required such data type, user should explict convert the data type.\n+\n+\n+\n+Numeric Data Types\n+==================\n+\n+TODO\n+\n+\n+Date and Time Data Types\n+========================\n+\n+The date and time data types are the types that represent temporal values and SQL plugin supports types including DATE, TIME, DATETIME, TIMESTAMP and INTERVAL. By default, the Elasticsearch DSL uses date type as the only date and time related type, which has contained all information about an absolute time point. To integrate with SQL language, each of the types other than timestamp is holding part of temporal or timezone information, and the usage to explicitly clarify the date and time types is reflected in the datetime functions (see `Functions <functions.rst>`_ for details), where some functions might have restrictions in the input argument type.\n+\n+\n+Date\n+----\n+\n+Date represents the calendar date regardless of the time zone. A given date value represents a 24-hour period, or say a day, but this period varies in different timezones and might have flexible hours during Daylight Savings Time programs. Besides, the date type does not contain time information as well. The supported range is '1000-01-01' to '9999-12-31'.\n+\n++------+--------------+------------------------------+\n+| Type | Syntax       | Range                        |\n++======+==============+==============================+\n+| Date | 'yyyy-MM-dd' | '0001-01-01' to '9999-12-31' |\n++------+--------------+------------------------------+\n+\n+\n+Time\n+----\n+\n+Time represents the time on the clock or watch with no regard for which timezone it might be related with. Time type data does not have date information.\n+\n++------+-----------------------+----------------------------------------+\n+| Type | Syntax                | Range                                  |\n++======+=======================+========================================+\n+| Time | 'hh:mm:ss[.fraction]' | '00:00:00.000000' to '23:59:59.999999' |\n++------+-----------------------+----------------------------------------+\n+\n+\n+Datetime\n+--------\n+\n+Datetime type is the combination of date and time. The conversion rule of date or time to datetime is described in `Conversion between date and time types`_. Datetime type does not contain timezone information. For an absolute time point that contains both date time and timezone information, see `Timestamp`_.\n+\n++----------+----------------------------------+--------------------------------------------------------------+\n+| Type     | Syntax                           | Range                                                        |\n++==========+==================================+==============================================================+\n+| Datetime | 'yyyy-MM-dd hh:mm:ss[.fraction]' | '0001-01-01 00:00:00.000000' to '9999-12-31 23:59:59.999999' |\n++----------+----------------------------------+--------------------------------------------------------------+\n+\n+\n+\n+Timestamp\n+---------\n+\n+A timestamp instance is an absolute instant independent of timezone or convention. For example, for a given point of time, if we set the timestamp of this time point into another timezone, the value should also be different accordingly. Bides, the storage of timestamp type is also different from the other types. The timestamp is converted from the current timezone to UTC for storage, and is converted back to the set timezone from UTC when retrieving.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "originalPosition": 138}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjM4Njk3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#pullrequestreview-469638697", "createdAt": "2020-08-18T16:44:57Z", "commit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjo0NDo1N1rOHCdGTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjo0NDo1N1rOHCdGTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMzNTk0OQ==", "bodyText": "do we need this method?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#discussion_r472335949", "createdAt": "2020-08-18T16:44:57Z", "author": {"login": "penghuo"}, "path": "core/src/main/java/com/amazon/opendistroforelasticsearch/sql/data/model/ExprValueUtils.java", "diffHunk": "@@ -172,4 +171,8 @@ public static Boolean getBooleanValue(ExprValue exprValue) {\n   public static ZonedDateTime getDateValue(ExprValue exprValue) {\n     return exprValue.dateValue();\n   }\n+\n+  public static TemporalAmount getIntervalValue(ExprValue exprValue) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjQ3NDc1", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#pullrequestreview-469647475", "createdAt": "2020-08-18T16:56:08Z", "commit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjo1NjowOFrOHCdhEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjo1NjowOFrOHCdhEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM0MjgwMw==", "bodyText": "Datetime is not implemented yet?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#discussion_r472342803", "createdAt": "2020-08-18T16:56:08Z", "author": {"login": "penghuo"}, "path": "core/src/main/java/com/amazon/opendistroforelasticsearch/sql/ast/expression/DataType.java", "diffHunk": "@@ -29,13 +29,15 @@\n   NULL(ExprCoreType.UNKNOWN),\n \n   INTEGER(ExprCoreType.INTEGER),\n+  LONG(ExprCoreType.LONG),\n   DOUBLE(ExprCoreType.DOUBLE),\n   STRING(ExprCoreType.STRING),\n   BOOLEAN(ExprCoreType.BOOLEAN),\n \n   DATE(ExprCoreType.DATE),\n   TIME(ExprCoreType.TIME),\n-  TIMESTAMP(ExprCoreType.TIMESTAMP);\n+  TIMESTAMP(ExprCoreType.TIMESTAMP),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjU1MzIy", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#pullrequestreview-469655322", "createdAt": "2020-08-18T17:06:18Z", "commit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzowNjoxOVrOHCd53w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzowNjoxOVrOHCd53w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM0OTE1MQ==", "bodyText": "@UtilityClass will add static automatically.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#discussion_r472349151", "createdAt": "2020-08-18T17:06:19Z", "author": {"login": "penghuo"}, "path": "core/src/main/java/com/amazon/opendistroforelasticsearch/sql/expression/function/FunctionDSL.java", "diffHunk": "@@ -56,7 +57,7 @@ public FunctionResolver define(FunctionName functionName,\n    * @param functions    a list of function implementation.\n    * @return FunctionResolver.\n    */\n-  public FunctionResolver define(FunctionName functionName,\n+  public static FunctionResolver define(FunctionName functionName,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjYyNTYy", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#pullrequestreview-469662562", "createdAt": "2020-08-18T17:14:40Z", "commit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzoxNDo0MVrOHCeQ5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNzoxNDo0MVrOHCeQ5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM1NTA0Nw==", "bodyText": "could we reuse the FunctionDSL.impl?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#discussion_r472355047", "createdAt": "2020-08-18T17:14:41Z", "author": {"login": "penghuo"}, "path": "core/src/main/java/com/amazon/opendistroforelasticsearch/sql/expression/datetime/IntervalClause.java", "diffHunk": "@@ -0,0 +1,172 @@\n+/*\n+ *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.expression.datetime;\n+\n+import static com.amazon.opendistroforelasticsearch.sql.data.model.ExprValueUtils.getIntegerValue;\n+import static com.amazon.opendistroforelasticsearch.sql.data.model.ExprValueUtils.getLongValue;\n+import static com.amazon.opendistroforelasticsearch.sql.data.model.ExprValueUtils.getStringValue;\n+import static com.amazon.opendistroforelasticsearch.sql.data.type.ExprCoreType.DOUBLE;\n+import static com.amazon.opendistroforelasticsearch.sql.data.type.ExprCoreType.FLOAT;\n+import static com.amazon.opendistroforelasticsearch.sql.data.type.ExprCoreType.INTEGER;\n+import static com.amazon.opendistroforelasticsearch.sql.data.type.ExprCoreType.LONG;\n+import static com.amazon.opendistroforelasticsearch.sql.expression.function.FunctionDSL.define;\n+\n+import com.amazon.opendistroforelasticsearch.sql.common.utils.StringUtils;\n+import com.amazon.opendistroforelasticsearch.sql.data.model.ExprIntervalValue;\n+import com.amazon.opendistroforelasticsearch.sql.data.model.ExprValue;\n+import com.amazon.opendistroforelasticsearch.sql.data.type.ExprCoreType;\n+import com.amazon.opendistroforelasticsearch.sql.data.type.ExprType;\n+import com.amazon.opendistroforelasticsearch.sql.exception.ExpressionEvaluationException;\n+import com.amazon.opendistroforelasticsearch.sql.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.expression.FunctionExpression;\n+import com.amazon.opendistroforelasticsearch.sql.expression.env.Environment;\n+import com.amazon.opendistroforelasticsearch.sql.expression.function.BuiltinFunctionName;\n+import com.amazon.opendistroforelasticsearch.sql.expression.function.BuiltinFunctionRepository;\n+import com.amazon.opendistroforelasticsearch.sql.expression.function.FunctionBuilder;\n+import com.amazon.opendistroforelasticsearch.sql.expression.function.FunctionName;\n+import com.amazon.opendistroforelasticsearch.sql.expression.function.FunctionResolver;\n+import com.amazon.opendistroforelasticsearch.sql.expression.function.FunctionSignature;\n+import com.amazon.opendistroforelasticsearch.sql.expression.function.SerializableBiFunction;\n+import com.amazon.opendistroforelasticsearch.sql.expression.function.SerializableFunction;\n+import java.time.Duration;\n+import java.time.Period;\n+import java.util.Arrays;\n+import lombok.experimental.UtilityClass;\n+import org.apache.commons.lang3.tuple.Pair;\n+\n+@UtilityClass\n+public class IntervalClause {\n+\n+  private static final String MICRO_SECOND = \"microsecond\";\n+  private static final String SECOND = \"second\";\n+  private static final String MINUTE = \"minute\";\n+  private static final String HOUR = \"hour\";\n+  private static final String DAY = \"day\";\n+  private static final String WEEK = \"week\";\n+  private static final String MONTH = \"month\";\n+  private static final String QUARTER = \"quarter\";\n+  private static final String YEAR = \"year\";\n+\n+  public void register(BuiltinFunctionRepository repository) {\n+    repository.register(interval());\n+  }\n+\n+  private FunctionResolver interval() {\n+    return define(BuiltinFunctionName.INTERVAL.getName(),\n+        intervalImp(IntervalClause::interval, INTEGER),\n+        intervalImp(IntervalClause::interval, LONG),\n+        intervalImp(IntervalClause::interval, FLOAT),\n+        intervalImp(IntervalClause::interval, DOUBLE));\n+  }\n+\n+  private ExprValue interval(ExprValue value, ExprValue unit) {\n+    switch (getStringValue(unit).toLowerCase()) {\n+      case MICRO_SECOND:\n+        return microsecond(value);\n+      case SECOND:\n+        return second(value);\n+      case MINUTE:\n+        return minute(value);\n+      case HOUR:\n+        return hour(value);\n+      case DAY:\n+        return day(value);\n+      case WEEK:\n+        return week(value);\n+      case MONTH:\n+        return month(value);\n+      case QUARTER:\n+        return quarter(value);\n+      case YEAR:\n+        return year(value);\n+      default:\n+        throw new ExpressionEvaluationException(\n+            String.format(\"interval unit %s is not supported\", getStringValue(unit)));\n+    }\n+  }\n+\n+  private ExprValue microsecond(ExprValue value) {\n+    return new ExprIntervalValue(Duration.ofNanos(getLongValue(value) * 1000));\n+  }\n+\n+  private ExprValue second(ExprValue value) {\n+    return new ExprIntervalValue(Duration.ofSeconds(getLongValue(value)));\n+  }\n+\n+  private ExprValue minute(ExprValue value) {\n+    return new ExprIntervalValue(Duration.ofMinutes(getLongValue(value)));\n+  }\n+\n+  private ExprValue hour(ExprValue value) {\n+    return new ExprIntervalValue(Duration.ofHours(getLongValue(value)));\n+  }\n+\n+  private ExprValue day(ExprValue value) {\n+    return new ExprIntervalValue(Duration.ofDays(getIntegerValue(value)));\n+  }\n+\n+  private ExprValue week(ExprValue value) {\n+    return new ExprIntervalValue(Period.ofWeeks(getIntegerValue(value)));\n+  }\n+\n+  private ExprValue month(ExprValue value) {\n+    return new ExprIntervalValue(Period.ofMonths(getIntegerValue(value)));\n+  }\n+\n+  private ExprValue quarter(ExprValue value) {\n+    return new ExprIntervalValue(Period.ofMonths(getIntegerValue(value) * 3));\n+  }\n+\n+  private ExprValue year(ExprValue value) {\n+    return new ExprIntervalValue(Period.ofYears(getIntegerValue(value)));\n+  }\n+\n+  /**\n+   * Interval argument implementation as function.\n+   */\n+  private static SerializableFunction", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ba1c60001a030fee5f39928e06478e8ad57ffd5"}, "originalPosition": 140}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8dd6fb9b5d43848aab236e1d49de646d3485a4a1", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/8dd6fb9b5d43848aab236e1d49de646d3485a4a1", "committedDate": "2020-08-18T19:30:55Z", "message": "corrected typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "790465e7ea50edd906f93601b66ad826f69938a4", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/790465e7ea50edd906f93601b66ad826f69938a4", "committedDate": "2020-08-18T22:12:13Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "557b95a4e176d8fe448e192fc62d29a7a961a0b6", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/557b95a4e176d8fe448e192fc62d29a7a961a0b6", "committedDate": "2020-08-19T00:50:44Z", "message": "added interval in sql parser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5307dc0d9f6e51169d42a82de1b405a8a9bbb6d", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/d5307dc0d9f6e51169d42a82de1b405a8a9bbb6d", "committedDate": "2020-08-19T21:51:47Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwOTk3OTE3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#pullrequestreview-470997917", "createdAt": "2020-08-19T22:05:50Z", "commit": {"oid": "d5307dc0d9f6e51169d42a82de1b405a8a9bbb6d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxMDIyMzEz", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/687#pullrequestreview-471022313", "createdAt": "2020-08-19T23:04:41Z", "commit": {"oid": "d5307dc0d9f6e51169d42a82de1b405a8a9bbb6d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "492007bf16c5efa8005b8a3e79a28bc1521c0426", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/492007bf16c5efa8005b8a3e79a28bc1521c0426", "committedDate": "2020-08-20T22:53:13Z", "message": "Merge remote-tracking branch 'upstream/develop' into interval\n\n# Conflicts:\n#\tsql/src/main/java/com/amazon/opendistroforelasticsearch/sql/sql/parser/AstExpressionBuilder.java\n#\tsql/src/test/java/com/amazon/opendistroforelasticsearch/sql/sql/parser/AstExpressionBuilderTest.java"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 620, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}