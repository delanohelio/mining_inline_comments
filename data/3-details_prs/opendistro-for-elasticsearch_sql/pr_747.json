{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5NTkwMjk4", "number": 747, "title": "Fix: let keywords eligible to be parsed as identifiers", "bodyText": "Issue #, if available:\n#745\nDescription of changes:\n\nFixed the data type conversion of JDBC date and time types\nAdded keywords as eligible identifiers in SQL and PPL ANTLR parser\nExcluded AggregationExpressionIT in legacy integration test due to inconsistency in JDBC schema between old engine and new engine\n\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-09-19T00:13:49Z", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/747", "merged": true, "mergeCommit": {"oid": "76b75b94341d1f088fd953835540d22e40b8f0b7"}, "closed": true, "closedAt": "2020-09-28T20:50:08Z", "author": {"login": "chloe-zh"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKJqCCAH2gAyNDg5NTkwMjk4OjVjODU0N2MzNWMwMmJmNGFiYTZlODBhMzY4OWVhMDkwYzdjYWFjNzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNZkx3gFqTQ5Nzg2OTM5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5c8547c35c02bf4aba6e80a3689ea090c7caac78", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/5c8547c35c02bf4aba6e80a3689ea090c7caac78", "committedDate": "2020-09-18T18:11:32Z", "message": "added keyword as id in parser"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "924935235fbed03f18913087c6ab3d6def84eb73", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/924935235fbed03f18913087c6ab3d6def84eb73", "committedDate": "2020-09-18T19:53:45Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a107d02f1990e28b37b92dfbcacd962d1edaa1b8", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/a107d02f1990e28b37b92dfbcacd962d1edaa1b8", "committedDate": "2020-09-18T21:50:11Z", "message": "Merge remote-tracking branch 'upstream/develop' into fix-keyword"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e32ece0c8a1dc5c958605c224d1b8c7f57802172", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/e32ece0c8a1dc5c958605c224d1b8c7f57802172", "committedDate": "2020-09-22T20:58:44Z", "message": "excluded failed test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d99709f96c78b17afea729c6c8b8de4a64d1634", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/1d99709f96c78b17afea729c6c8b8de4a64d1634", "committedDate": "2020-09-23T21:12:04Z", "message": "Merge remote-tracking branch 'upstream/develop' into fix-keyword"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "814889428c6812cee16faf812c1cd1b2fd1e2fa6", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/814889428c6812cee16faf812c1cd1b2fd1e2fa6", "committedDate": "2020-09-23T23:15:35Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1OTA3NDAy", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/747#pullrequestreview-495907402", "createdAt": "2020-09-24T19:58:46Z", "commit": {"oid": "814889428c6812cee16faf812c1cd1b2fd1e2fa6"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxOTo1ODo0NlrOHXqikQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQyMDowNTozOFrOHXqwYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU3NjI3Mw==", "bodyText": "np: we can label the alternatives in rule (ex. | keywordsCanBeId  #keywordId) and move this to individual method generated.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/747#discussion_r494576273", "createdAt": "2020-09-24T19:58:46Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilder.java", "diffHunk": "@@ -191,6 +191,9 @@ public UnresolvedExpression visitEvalFunctionCall(EvalFunctionCallContext ctx) {\n    */\n   @Override\n   public UnresolvedExpression visitQualifiedName(QualifiedNameContext ctx) {\n+    if (ctx.keywordsCanBeId() != null) {\n+      return new QualifiedName(ctx.keywordsCanBeId().getText());\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "814889428c6812cee16faf812c1cd1b2fd1e2fa6"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU3ODUzNg==", "bodyText": "Can we also add functionNameBase here as before? https://github.com/opendistro-for-elasticsearch/sql/blob/master/legacy/src/main/antlr/OpenDistroSqlParser.g4#L237. Although this is a separate g4 file, I guess it may have access to rules in parent g4.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/747#discussion_r494578536", "createdAt": "2020-09-24T20:03:07Z", "author": {"login": "dai-chen"}, "path": "sql/src/main/antlr/OpenDistroSQLIdentifierParser.g4", "diffHunk": "@@ -44,10 +44,18 @@ alias\n \n qualifiedName\n     : ident (DOT ident)*\n+    | keywordsCanBeId", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "814889428c6812cee16faf812c1cd1b2fd1e2fa6"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU3OTgwOA==", "bodyText": "Are the changes in UT meant for this? I can see we're changing date type in test data and code to timestamp in UT?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/747#discussion_r494579808", "createdAt": "2020-09-24T20:05:38Z", "author": {"login": "dai-chen"}, "path": "sql-jdbc/src/main/java/com/amazon/opendistroforelasticsearch/jdbc/types/ElasticsearchType.java", "diffHunk": "@@ -72,7 +72,7 @@\n     IP(JDBCType.VARCHAR, String.class, 15, 0, false),\n     NESTED(JDBCType.STRUCT, null, 0, 0, false),\n     OBJECT(JDBCType.STRUCT, null, 0, 0, false),\n-    DATE(JDBCType.TIMESTAMP, Timestamp.class, 24, 24, false),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "814889428c6812cee16faf812c1cd1b2fd1e2fa6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c06880d1e2a2f9a42b41b8a04f00b617c2badb00", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/c06880d1e2a2f9a42b41b8a04f00b617c2badb00", "committedDate": "2020-09-24T21:02:37Z", "message": "address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a751fb20feb36f0f1553ed7882f80879bc76a21", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/2a751fb20feb36f0f1553ed7882f80879bc76a21", "committedDate": "2020-09-24T21:30:31Z", "message": "address comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1OTk2NjU3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/747#pullrequestreview-495996657", "createdAt": "2020-09-24T22:36:59Z", "commit": {"oid": "2a751fb20feb36f0f1553ed7882f80879bc76a21"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3ODY5Mzk1", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/747#pullrequestreview-497869395", "createdAt": "2020-09-28T20:26:03Z", "commit": {"oid": "2a751fb20feb36f0f1553ed7882f80879bc76a21"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 647, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}