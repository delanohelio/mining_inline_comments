{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyOTY1ODIz", "number": 429, "reviewThreads": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDo0Njo0MFrODxritw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjowOToyM1rOD1WuNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDIwMjE1OnYy", "diffSide": "RIGHT", "path": "ppl/build.gradle", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDo0Njo0MFrOGFSQwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDo0Njo0MFrOGFSQwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE5NTI2NQ==", "bodyText": "why ppl need the org.elasticsearch as the dependency?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408195265", "createdAt": "2020-04-14T14:46:40Z", "author": {"login": "penghuo"}, "path": "ppl/build.gradle", "diffHunk": "@@ -25,6 +25,9 @@ dependencies {\n     antlr \"org.antlr:antlr4:4.7.1\"\n \n     compile \"org.antlr:antlr4-runtime:4.7.1\"\n+    compile group: 'com.google.guava', name: 'guava', version:'15.0'\n+    compile group: 'org.elasticsearch', name: 'elasticsearch', version:\"${es_version}\"\n+    compile group: 'org.elasticsearch', name: 'elasticsearch-x-content', version:\"${es_version}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c45b24b366fb80b3aa67e5dd68ede0f3d765d83"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDIwOTg0OnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/node/NodeVisitor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDo0ODoxOVrOGFSV2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNjozOTo1NVrOGFXbSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE5NjU2OQ==", "bodyText": "Remove unused imports", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408196569", "createdAt": "2020-04-14T14:48:19Z", "author": {"login": "penghuo"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/node/NodeVisitor.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.node;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c45b24b366fb80b3aa67e5dd68ede0f3d765d83"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODI3OTg4MQ==", "bodyText": "done, thanks!", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408279881", "createdAt": "2020-04-14T16:39:55Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/node/NodeVisitor.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.node;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE5NjU2OQ=="}, "originalCommit": {"oid": "8c45b24b366fb80b3aa67e5dd68ede0f3d765d83"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTA0NDMzOnYy", "diffSide": "RIGHT", "path": "ppl/src/main/antlr/OpenDistroPPLParser.g4", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODowMTowM1rOGFaj0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxODowNDoyOVrOGHX96w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzMTIxOA==", "bodyText": "Just a reminder, we may want to avoid those issues regarding index name in SQL since the very beginning of this project, such as index name with dot or colon (some user reported CloudWatch generates such index).", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408331218", "createdAt": "2020-04-14T18:01:03Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/antlr/OpenDistroPPLParser.g4", "diffHunk": "@@ -26,32 +26,31 @@ pplStatement\n     : searchCommand (PIPE commands)*\n     ;\n \n-\n /** commands */\n commands\n     : whereCommand | fieldsCommand | renameCommand | statsCommand | dedupCommand | sortCommand | evalCommand\n     ;\n \n searchCommand\n-    : (SEARCH)? fromClause                                          #searchWithoutFilter\n-    | (SEARCH)? fromClause logicalExpression                        #searchFromClauseLogicExpr\n-    | (SEARCH)? logicalExpression fromClause                        #searchLogicExprFromClause\n+    : (SEARCH)? fromClause                                          #searchFrom", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM4NTg5OQ==", "bodyText": "Yes that's a good point. Thanks for your reminder. I've added these special cases now. They are refracted in tableSource item in the parser file.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410385899", "createdAt": "2020-04-17T18:04:29Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/antlr/OpenDistroPPLParser.g4", "diffHunk": "@@ -26,32 +26,31 @@ pplStatement\n     : searchCommand (PIPE commands)*\n     ;\n \n-\n /** commands */\n commands\n     : whereCommand | fieldsCommand | renameCommand | statsCommand | dedupCommand | sortCommand | evalCommand\n     ;\n \n searchCommand\n-    : (SEARCH)? fromClause                                          #searchWithoutFilter\n-    | (SEARCH)? fromClause logicalExpression                        #searchFromClauseLogicExpr\n-    | (SEARCH)? logicalExpression fromClause                        #searchLogicExprFromClause\n+    : (SEARCH)? fromClause                                          #searchFrom", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzMTIxOA=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTA1Mjk3OnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/node/AbstractNodeVisitor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODowMzozMlrOGFapkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxODowNTowNVrOGHX_Ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzMjY5MQ==", "bodyText": "Could you add JavaDoc for all public classes to document their abstractions and responsibilities?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408332691", "createdAt": "2020-04-14T18:03:32Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/node/AbstractNodeVisitor.java", "diffHunk": "@@ -0,0 +1,102 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.node;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AggregateFunction;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.And;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeList;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeReference;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.EqualTo;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Function;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.In;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Map;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Not;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Or;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.UnresolvedAttribute;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Aggregation;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Filter;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Project;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Relation;\n+\n+public class AbstractNodeVisitor<T> implements NodeVisitor<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM4NjIzNQ==", "bodyText": "Sure will do, thanks!", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410386235", "createdAt": "2020-04-17T18:05:05Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/node/AbstractNodeVisitor.java", "diffHunk": "@@ -0,0 +1,102 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.node;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AggregateFunction;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.And;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeList;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeReference;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.EqualTo;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Function;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.In;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Map;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Not;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Or;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.UnresolvedAttribute;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Aggregation;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Filter;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Project;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Relation;\n+\n+public class AbstractNodeVisitor<T> implements NodeVisitor<T> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzMjY5MQ=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTA4MTk2OnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoxMTozNVrOGFa8LA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMTozMjozMlrOGHduFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNzQ1Mg==", "bodyText": "Np: using static import can make this class cleaner.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408337452", "createdAt": "2020-04-14T18:11:35Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilder.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Map;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Aggregation;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Filter;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.LogicalPlan;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Project;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Relation;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.stream.Collectors;\n+import lombok.RequiredArgsConstructor;\n+import org.antlr.v4.runtime.tree.ParseTree;\n+\n+@RequiredArgsConstructor\n+public class AstBuilder extends OpenDistroPPLParserBaseVisitor<LogicalPlan> {\n+    private final AstExpressionBuilder expressionBuilder;\n+\n+    @Override\n+    public LogicalPlan visitPplStatement(OpenDistroPPLParser.PplStatementContext ctx) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ4MDE0OA==", "bodyText": "Yes that's what I would like to do but the IDEA was not able to automatically add them as the static methods. I will manually replace them", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410480148", "createdAt": "2020-04-17T21:32:32Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilder.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Map;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Aggregation;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Filter;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.LogicalPlan;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Project;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Relation;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.stream.Collectors;\n+import lombok.RequiredArgsConstructor;\n+import org.antlr.v4.runtime.tree.ParseTree;\n+\n+@RequiredArgsConstructor\n+public class AstBuilder extends OpenDistroPPLParserBaseVisitor<LogicalPlan> {\n+    private final AstExpressionBuilder expressionBuilder;\n+\n+    @Override\n+    public LogicalPlan visitPplStatement(OpenDistroPPLParser.PplStatementContext ctx) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNzQ1Mg=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTA5NzMzOnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoxNTo1OVrOGFbGCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMTozMzozMFrOGHdveA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzOTk3Ng==", "bodyText": "Is this necessary? I assume parser has handled this?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408339976", "createdAt": "2020-04-14T18:15:59Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilder.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AggregateFunction;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.And;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeList;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.DataType;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.EqualTo;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Function;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.In;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Not;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Or;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.UnresolvedAttribute;\n+import java.util.stream.Collectors;\n+\n+public class AstExpressionBuilder extends OpenDistroPPLParserBaseVisitor<Expression> {\n+    /** Logical expression excluding boolean, eval, comparison */\n+    @Override\n+    public Expression visitLogicalNot(OpenDistroPPLParser.LogicalNotContext ctx) {\n+        return new Not(visit(ctx.logicalExpression()));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalOr(OpenDistroPPLParser.LogicalOrContext ctx) {\n+        return new Or(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalAnd(OpenDistroPPLParser.LogicalAndContext ctx) {\n+        return new And(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+\n+    /** Eval expression */\n+    @Override\n+    public Expression visitEvalExpression(OpenDistroPPLParser.EvalExpressionContext ctx) {\n+        Expression field = visit(ctx.fieldExpression());\n+        Expression evalFunctionCall = visit(ctx.evalFunctionCall());\n+        return new EqualTo(field, evalFunctionCall);\n+    }\n+\n+    /** Comparison expression */\n+    @Override\n+    public Expression visitCompareExpr(OpenDistroPPLParser.CompareExprContext ctx) {\n+        Expression field = visit(ctx.left);\n+        Expression value = visit(ctx.right);\n+        String operator = ctx.comparisonOperator().getText();\n+        switch (operator.replaceAll(\"\\\\s\",\"\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ4MDUwNA==", "bodyText": "Yeah makes sense, I overthought the cases. I will remove it. Thanks!", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410480504", "createdAt": "2020-04-17T21:33:30Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilder.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AggregateFunction;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.And;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeList;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.DataType;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.EqualTo;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Function;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.In;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Not;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Or;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.UnresolvedAttribute;\n+import java.util.stream.Collectors;\n+\n+public class AstExpressionBuilder extends OpenDistroPPLParserBaseVisitor<Expression> {\n+    /** Logical expression excluding boolean, eval, comparison */\n+    @Override\n+    public Expression visitLogicalNot(OpenDistroPPLParser.LogicalNotContext ctx) {\n+        return new Not(visit(ctx.logicalExpression()));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalOr(OpenDistroPPLParser.LogicalOrContext ctx) {\n+        return new Or(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalAnd(OpenDistroPPLParser.LogicalAndContext ctx) {\n+        return new And(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+\n+    /** Eval expression */\n+    @Override\n+    public Expression visitEvalExpression(OpenDistroPPLParser.EvalExpressionContext ctx) {\n+        Expression field = visit(ctx.fieldExpression());\n+        Expression evalFunctionCall = visit(ctx.evalFunctionCall());\n+        return new EqualTo(field, evalFunctionCall);\n+    }\n+\n+    /** Comparison expression */\n+    @Override\n+    public Expression visitCompareExpr(OpenDistroPPLParser.CompareExprContext ctx) {\n+        Expression field = visit(ctx.left);\n+        Expression value = visit(ctx.right);\n+        String operator = ctx.comparisonOperator().getText();\n+        switch (operator.replaceAll(\"\\\\s\",\"\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzOTk3Ng=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTA5OTQ1OnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilder.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoxNjozOFrOGFbHYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOFQwMDowOToyNVrOGHgOrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0MDMyMg==", "bodyText": "Why not just remove it from grammar?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408340322", "createdAt": "2020-04-14T18:16:38Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilder.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AggregateFunction;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.And;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeList;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.DataType;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.EqualTo;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Function;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.In;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Not;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Or;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.UnresolvedAttribute;\n+import java.util.stream.Collectors;\n+\n+public class AstExpressionBuilder extends OpenDistroPPLParserBaseVisitor<Expression> {\n+    /** Logical expression excluding boolean, eval, comparison */\n+    @Override\n+    public Expression visitLogicalNot(OpenDistroPPLParser.LogicalNotContext ctx) {\n+        return new Not(visit(ctx.logicalExpression()));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalOr(OpenDistroPPLParser.LogicalOrContext ctx) {\n+        return new Or(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalAnd(OpenDistroPPLParser.LogicalAndContext ctx) {\n+        return new And(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+\n+    /** Eval expression */\n+    @Override\n+    public Expression visitEvalExpression(OpenDistroPPLParser.EvalExpressionContext ctx) {\n+        Expression field = visit(ctx.fieldExpression());\n+        Expression evalFunctionCall = visit(ctx.evalFunctionCall());\n+        return new EqualTo(field, evalFunctionCall);\n+    }\n+\n+    /** Comparison expression */\n+    @Override\n+    public Expression visitCompareExpr(OpenDistroPPLParser.CompareExprContext ctx) {\n+        Expression field = visit(ctx.left);\n+        Expression value = visit(ctx.right);\n+        String operator = ctx.comparisonOperator().getText();\n+        switch (operator.replaceAll(\"\\\\s\",\"\")) {\n+            case \"==\":\n+            case \"=\":\n+                return new EqualTo(field, value);\n+            default:\n+                throw new UnsupportedOperationException(String.format(\"unsupported operator [%s]\", operator));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ4MTM3Mg==", "bodyText": "This was a temporary solution here, because we still have a couple of binary operators to add. I will finish them in next PR, which is to supplement all the optional arguments in commands of phase0.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410481372", "createdAt": "2020-04-17T21:35:50Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilder.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AggregateFunction;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.And;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeList;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.DataType;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.EqualTo;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Function;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.In;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Not;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Or;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.UnresolvedAttribute;\n+import java.util.stream.Collectors;\n+\n+public class AstExpressionBuilder extends OpenDistroPPLParserBaseVisitor<Expression> {\n+    /** Logical expression excluding boolean, eval, comparison */\n+    @Override\n+    public Expression visitLogicalNot(OpenDistroPPLParser.LogicalNotContext ctx) {\n+        return new Not(visit(ctx.logicalExpression()));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalOr(OpenDistroPPLParser.LogicalOrContext ctx) {\n+        return new Or(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalAnd(OpenDistroPPLParser.LogicalAndContext ctx) {\n+        return new And(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+\n+    /** Eval expression */\n+    @Override\n+    public Expression visitEvalExpression(OpenDistroPPLParser.EvalExpressionContext ctx) {\n+        Expression field = visit(ctx.fieldExpression());\n+        Expression evalFunctionCall = visit(ctx.evalFunctionCall());\n+        return new EqualTo(field, evalFunctionCall);\n+    }\n+\n+    /** Comparison expression */\n+    @Override\n+    public Expression visitCompareExpr(OpenDistroPPLParser.CompareExprContext ctx) {\n+        Expression field = visit(ctx.left);\n+        Expression value = visit(ctx.right);\n+        String operator = ctx.comparisonOperator().getText();\n+        switch (operator.replaceAll(\"\\\\s\",\"\")) {\n+            case \"==\":\n+            case \"=\":\n+                return new EqualTo(field, value);\n+            default:\n+                throw new UnsupportedOperationException(String.format(\"unsupported operator [%s]\", operator));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0MDMyMg=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUyMTI2Mg==", "bodyText": "Got it. Thanks!", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410521262", "createdAt": "2020-04-18T00:09:25Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilder.java", "diffHunk": "@@ -0,0 +1,177 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AggregateFunction;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.And;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.AttributeList;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.DataType;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.EqualTo;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Function;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.In;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Literal;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Not;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Or;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.UnresolvedAttribute;\n+import java.util.stream.Collectors;\n+\n+public class AstExpressionBuilder extends OpenDistroPPLParserBaseVisitor<Expression> {\n+    /** Logical expression excluding boolean, eval, comparison */\n+    @Override\n+    public Expression visitLogicalNot(OpenDistroPPLParser.LogicalNotContext ctx) {\n+        return new Not(visit(ctx.logicalExpression()));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalOr(OpenDistroPPLParser.LogicalOrContext ctx) {\n+        return new Or(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+    @Override\n+    public Expression visitLogicalAnd(OpenDistroPPLParser.LogicalAndContext ctx) {\n+        return new And(visit(ctx.left), visit(ctx.right));\n+    }\n+\n+\n+    /** Eval expression */\n+    @Override\n+    public Expression visitEvalExpression(OpenDistroPPLParser.EvalExpressionContext ctx) {\n+        Expression field = visit(ctx.fieldExpression());\n+        Expression evalFunctionCall = visit(ctx.evalFunctionCall());\n+        return new EqualTo(field, evalFunctionCall);\n+    }\n+\n+    /** Comparison expression */\n+    @Override\n+    public Expression visitCompareExpr(OpenDistroPPLParser.CompareExprContext ctx) {\n+        Expression field = visit(ctx.left);\n+        Expression value = visit(ctx.right);\n+        String operator = ctx.comparisonOperator().getText();\n+        switch (operator.replaceAll(\"\\\\s\",\"\")) {\n+            case \"==\":\n+            case \"=\":\n+                return new EqualTo(field, value);\n+            default:\n+                throw new UnsupportedOperationException(String.format(\"unsupported operator [%s]\", operator));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0MDMyMg=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 71}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTExNzAxOnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/expression/And.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoyMToyN1rOGFbSdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMjoyNDoxMVrOGHez7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0MzE1OA==", "bodyText": "return left and right? And same for other getChild().", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408343158", "createdAt": "2020-04-14T18:21:27Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/expression/And.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.AbstractNodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.NodeVisitor;\n+import com.google.common.collect.ImmutableList;\n+import java.util.List;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.RequiredArgsConstructor;\n+import lombok.ToString;\n+\n+@Getter\n+@ToString\n+@EqualsAndHashCode\n+@RequiredArgsConstructor\n+public class And extends Expression {\n+    private final Expression left;\n+    private final Expression right;\n+\n+    @Override\n+    public List<Expression> getChild() {\n+        return ImmutableList.of();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ5ODAyOA==", "bodyText": "Yes exactly, will do. Thanks!", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410498028", "createdAt": "2020-04-17T22:24:11Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/expression/And.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.AbstractNodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.NodeVisitor;\n+import com.google.common.collect.ImmutableList;\n+import java.util.List;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.RequiredArgsConstructor;\n+import lombok.ToString;\n+\n+@Getter\n+@ToString\n+@EqualsAndHashCode\n+@RequiredArgsConstructor\n+public class And extends Expression {\n+    private final Expression left;\n+    private final Expression right;\n+\n+    @Override\n+    public List<Expression> getChild() {\n+        return ImmutableList.of();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0MzE1OA=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTEyODg4OnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/expression/AggregateFunction.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoyNDozMlrOGFbZ9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoyNDozMlrOGFbZ9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0NTA3OQ==", "bodyText": "I see a pattern for all accept methods. We can think about how to make it clean.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408345079", "createdAt": "2020-04-14T18:24:32Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/expression/AggregateFunction.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.AbstractNodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.NodeVisitor;\n+import com.google.common.collect.ImmutableList;\n+import java.util.List;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.RequiredArgsConstructor;\n+import lombok.ToString;\n+\n+@Getter\n+@ToString\n+@EqualsAndHashCode\n+@RequiredArgsConstructor\n+public class AggregateFunction extends Expression {\n+    private final Expression funcName;\n+    private final Expression field;\n+\n+    @Override\n+    public List<Expression> getChild() {\n+        return ImmutableList.of();\n+    }\n+\n+    @Override\n+    public <R> R accept(NodeVisitor<R> nodeVisitor) {\n+        if (nodeVisitor instanceof AbstractNodeVisitor) {\n+            return ((AbstractNodeVisitor<R>) nodeVisitor).visitAggregateFunction(this);\n+        } else {\n+            return nodeVisitor.visitChildren(this);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTEzODQyOnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/Aggregation.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoyNzowNVrOGFbf3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMTo1MDozNlrOGHeIzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0NjU5MA==", "bodyText": "The class is already annotated by @Getter?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408346590", "createdAt": "2020-04-14T18:27:05Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/Aggregation.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.AbstractNodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.NodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.google.common.collect.ImmutableList;\n+import java.util.List;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Getter\n+@ToString\n+@EqualsAndHashCode\n+public class Aggregation extends LogicalPlan {\n+    @Getter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ4Njk4OQ==", "bodyText": "Removed, thanks!", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410486989", "createdAt": "2020-04-17T21:50:36Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/Aggregation.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.AbstractNodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.NodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.google.common.collect.ImmutableList;\n+import java.util.List;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Getter\n+@ToString\n+@EqualsAndHashCode\n+public class Aggregation extends LogicalPlan {\n+    @Getter", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0NjU5MA=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNTE0NDUzOnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/HasInput.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODoyODo0NlrOGFbjxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNToxNTo0NlrOGIZpCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0NzU5MA==", "bodyText": "Please add JavaDoc for generic type too.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r408347590", "createdAt": "2020-04-14T18:28:46Z", "author": {"login": "dai-chen"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/HasInput.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical;\n+\n+public interface HasInput<T, R> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ4OTk5Mw==", "bodyText": "Ok will do, thanks!", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410489993", "createdAt": "2020-04-17T21:58:37Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/HasInput.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical;\n+\n+public interface HasInput<T, R> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0NzU5MA=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ2MTg5OA==", "bodyText": "could we make the node Immutable by using the context to maintain the current parent command?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411461898", "createdAt": "2020-04-20T15:15:46Z", "author": {"login": "penghuo"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/HasInput.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical;\n+\n+public interface HasInput<T, R> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0NzU5MA=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0ODQ4MDAzOnYy", "diffSide": "RIGHT", "path": "ppl/src/test/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilderTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMDo1NDoxOVrOGHcxyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMTo1OToxN1rOGHeVbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ2NDcxMw==", "bodyText": "should it be \"Keyword\" instead of \"KeyWord\"", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410464713", "createdAt": "2020-04-17T20:54:19Z", "author": {"login": "zhongnansu"}, "path": "ppl/src/test/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilderTest.java", "diffHunk": "@@ -0,0 +1,190 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import java.util.Collections;\n+import org.junit.Test;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.agg;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.aggregate;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.and;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.doubleLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.equalTo;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.filter;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.function;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.in;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.intLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.not;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.or;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.project;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.relation;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.stringLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.unresolvedAttr;\n+\n+public class AstExpressionBuilderTest extends AstBuilderTest{\n+\n+    @Test\n+    public void testLogicalNotExpr() {\n+        assertEqual(\"source=t not a=1\",\n+                filter(\n+                        relation(\"t\"),\n+                        not(\n+                                equalTo(unresolvedAttr(\"a\"), intLiteral(1))\n+                        )\n+                ));\n+    }\n+\n+    @Test\n+    public void testLogicalOrExpr() {\n+        assertEqual(\"source=t a=1 or b=2\",\n+                filter(\n+                        relation(\"t\"),\n+                        or(\n+                                equalTo(unresolvedAttr(\"a\"), intLiteral(1)),\n+                                equalTo(unresolvedAttr(\"b\"), intLiteral(2))\n+                        )\n+                ));\n+    }\n+\n+    @Test\n+    public void testLogicalAndExpr() {\n+        assertEqual(\"source=t a=1 and b=2\",\n+                filter(\n+                        relation(\"t\"),\n+                        and(\n+                                equalTo(unresolvedAttr(\"a\"), intLiteral(1)),\n+                                equalTo(unresolvedAttr(\"b\"), intLiteral(2))\n+                        )\n+                ));\n+    }\n+\n+    @Test\n+    public void testLogicalAndExprWithoutKeyWordAnd() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ5MDIyMQ==", "bodyText": "Will do, thanks!", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r410490221", "createdAt": "2020-04-17T21:59:17Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/test/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstExpressionBuilderTest.java", "diffHunk": "@@ -0,0 +1,190 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import java.util.Collections;\n+import org.junit.Test;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.agg;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.aggregate;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.and;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.doubleLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.equalTo;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.filter;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.function;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.in;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.intLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.not;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.or;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.project;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.relation;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.stringLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.unresolvedAttr;\n+\n+public class AstExpressionBuilderTest extends AstBuilderTest{\n+\n+    @Test\n+    public void testLogicalNotExpr() {\n+        assertEqual(\"source=t not a=1\",\n+                filter(\n+                        relation(\"t\"),\n+                        not(\n+                                equalTo(unresolvedAttr(\"a\"), intLiteral(1))\n+                        )\n+                ));\n+    }\n+\n+    @Test\n+    public void testLogicalOrExpr() {\n+        assertEqual(\"source=t a=1 or b=2\",\n+                filter(\n+                        relation(\"t\"),\n+                        or(\n+                                equalTo(unresolvedAttr(\"a\"), intLiteral(1)),\n+                                equalTo(unresolvedAttr(\"b\"), intLiteral(2))\n+                        )\n+                ));\n+    }\n+\n+    @Test\n+    public void testLogicalAndExpr() {\n+        assertEqual(\"source=t a=1 and b=2\",\n+                filter(\n+                        relation(\"t\"),\n+                        and(\n+                                equalTo(unresolvedAttr(\"a\"), intLiteral(1)),\n+                                equalTo(unresolvedAttr(\"b\"), intLiteral(2))\n+                        )\n+                ));\n+    }\n+\n+    @Test\n+    public void testLogicalAndExprWithoutKeyWordAnd() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ2NDcxMw=="}, "originalCommit": {"oid": "6b542eb5496b0034f8506a8b15e53071d56686ad"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NjIxMTcyOnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/LogicalPlan.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNToxNDozNFrOGIZlLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozMDoxNVrOGIfqZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ2MDkxMA==", "bodyText": "change LogicalPlan to UnresolvedPlan. In case all the object is from literal query string which is not resolved with env yet.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411460910", "createdAt": "2020-04-20T15:14:34Z", "author": {"login": "penghuo"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/LogicalPlan.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.Node;\n+\n+public abstract class LogicalPlan implements Node<LogicalPlan>, HasInput<LogicalPlan, LogicalPlan> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MDU0OQ==", "bodyText": "Ok will do", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411560549", "createdAt": "2020-04-20T17:30:15Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/LogicalPlan.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.Node;\n+\n+public abstract class LogicalPlan implements Node<LogicalPlan>, HasInput<LogicalPlan, LogicalPlan> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ2MDkxMA=="}, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NjI3NzI3OnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilder.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNToyNzoyMlrOGIaNOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozMDowM1rOGIfp3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3MTE2MA==", "bodyText": "Why we want to different SearchFromFilter and SearchFilterFrom?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411471160", "createdAt": "2020-04-20T15:27:22Z", "author": {"login": "penghuo"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilder.java", "diffHunk": "@@ -0,0 +1,194 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Map;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Aggregation;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Filter;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.LogicalPlan;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Project;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Relation;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import lombok.RequiredArgsConstructor;\n+import org.antlr.v4.runtime.tree.ParseTree;\n+\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.DedupCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.EvalCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.FieldsCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.FromClauseContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.PplStatementContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.RenameCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.SearchFilterFromContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.SearchFromContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.SearchFromFilterContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.SortCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.StatsCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.WhereCommandContext;\n+\n+/**\n+ * Class of walking the AST\n+ * Refines the visit path and build the LogicalPlan and Expression nodes interface\n+ */\n+@RequiredArgsConstructor\n+public class AstBuilder extends OpenDistroPPLParserBaseVisitor<LogicalPlan> {\n+    private final AstExpressionBuilder expressionBuilder;\n+\n+    @Override\n+    public LogicalPlan visitPplStatement(PplStatementContext ctx) {\n+        LogicalPlan search = visit(ctx.searchCommand());\n+        LogicalPlan reduce = ctx.commands().stream().map(this::visit).reduce(search, (r, e) -> e.withInput(r));\n+        return reduce;\n+    }\n+\n+    /** Search command */\n+    @Override\n+    public LogicalPlan visitSearchFrom(SearchFromContext ctx) {\n+        return visitFromClause(ctx.fromClause());\n+    }\n+\n+    @Override\n+    public LogicalPlan visitSearchFromFilter(SearchFromFilterContext ctx) {\n+        return new Filter(visitExpression(ctx.logicalExpression())).withInput(visit(ctx.fromClause()));\n+    }\n+\n+    @Override\n+    public LogicalPlan visitSearchFilterFrom(SearchFilterFromContext ctx) {\n+        return new Filter(visitExpression(ctx.logicalExpression())).withInput(visit(ctx.fromClause()));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MDQxMg==", "bodyText": "It was only the matter of the order in grammar file", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411560412", "createdAt": "2020-04-20T17:30:03Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilder.java", "diffHunk": "@@ -0,0 +1,194 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParserBaseVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Map;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Aggregation;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Filter;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.LogicalPlan;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Project;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.Relation;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import lombok.RequiredArgsConstructor;\n+import org.antlr.v4.runtime.tree.ParseTree;\n+\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.DedupCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.EvalCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.FieldsCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.FromClauseContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.PplStatementContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.RenameCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.SearchFilterFromContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.SearchFromContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.SearchFromFilterContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.SortCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.StatsCommandContext;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.antlr.parser.OpenDistroPPLParser.WhereCommandContext;\n+\n+/**\n+ * Class of walking the AST\n+ * Refines the visit path and build the LogicalPlan and Expression nodes interface\n+ */\n+@RequiredArgsConstructor\n+public class AstBuilder extends OpenDistroPPLParserBaseVisitor<LogicalPlan> {\n+    private final AstExpressionBuilder expressionBuilder;\n+\n+    @Override\n+    public LogicalPlan visitPplStatement(PplStatementContext ctx) {\n+        LogicalPlan search = visit(ctx.searchCommand());\n+        LogicalPlan reduce = ctx.commands().stream().map(this::visit).reduce(search, (r, e) -> e.withInput(r));\n+        return reduce;\n+    }\n+\n+    /** Search command */\n+    @Override\n+    public LogicalPlan visitSearchFrom(SearchFromContext ctx) {\n+        return visitFromClause(ctx.fromClause());\n+    }\n+\n+    @Override\n+    public LogicalPlan visitSearchFromFilter(SearchFromFilterContext ctx) {\n+        return new Filter(visitExpression(ctx.logicalExpression())).withInput(visit(ctx.fromClause()));\n+    }\n+\n+    @Override\n+    public LogicalPlan visitSearchFilterFrom(SearchFilterFromContext ctx) {\n+        return new Filter(visitExpression(ctx.logicalExpression())).withInput(visit(ctx.fromClause()));\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3MTE2MA=="}, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NjI4NDU1OnYy", "diffSide": "RIGHT", "path": "ppl/src/main/antlr/OpenDistroPPLParser.g4", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNToyODo0M1rOGIaRlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzoyOTo0NVrOGIfpKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3MjI3OQ==", "bodyText": "what is the difference between constant and literal", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411472279", "createdAt": "2020-04-20T15:28:43Z", "author": {"login": "penghuo"}, "path": "ppl/src/main/antlr/OpenDistroPPLParser.g4", "diffHunk": "@@ -283,32 +300,16 @@ valueList\n     : LT_PRTHS literalValue (COMMA literalValue)* RT_PRTHS\n     ;\n \n-fullColumnName\n-    : simpleId DOT_ID*\n-    ;\n-\n constant", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 222}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MDIzMw==", "bodyText": "The constant includes literal, and also includes negative constants and Boolean constants. It is used as an argument in functions. We could say the constant is more like used in the mathematical situation", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411560233", "createdAt": "2020-04-20T17:29:45Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/antlr/OpenDistroPPLParser.g4", "diffHunk": "@@ -283,32 +300,16 @@ valueList\n     : LT_PRTHS literalValue (COMMA literalValue)* RT_PRTHS\n     ;\n \n-fullColumnName\n-    : simpleId DOT_ID*\n-    ;\n-\n constant", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3MjI3OQ=="}, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 222}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NjMyNDQxOnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/expression/Function.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTozNjoxOFrOGIapbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzoyNzowOVrOGIfiOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3ODM4Mg==", "bodyText": "I think funcName is just Name instead of Expression.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411478382", "createdAt": "2020-04-20T15:36:18Z", "author": {"login": "penghuo"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/expression/Function.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.AbstractNodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.NodeVisitor;\n+import java.util.Arrays;\n+import java.util.List;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.RequiredArgsConstructor;\n+import lombok.ToString;\n+\n+/**\n+ * Expression node of scalar function\n+ * Params include function name (@funcName) and function arguments (@funcArgs)\n+ */\n+@Getter\n+@ToString\n+@EqualsAndHashCode\n+@RequiredArgsConstructor\n+public class Function extends Expression {\n+    private final Expression funcName;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU1ODQ1Nw==", "bodyText": "Ok yes that sounds better", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411558457", "createdAt": "2020-04-20T17:27:09Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/expression/Function.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.AbstractNodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.NodeVisitor;\n+import java.util.Arrays;\n+import java.util.List;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.RequiredArgsConstructor;\n+import lombok.ToString;\n+\n+/**\n+ * Expression node of scalar function\n+ * Params include function name (@funcName) and function arguments (@funcArgs)\n+ */\n+@Getter\n+@ToString\n+@EqualsAndHashCode\n+@RequiredArgsConstructor\n+public class Function extends Expression {\n+    private final Expression funcName;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3ODM4Mg=="}, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NjM0MDA3OnYy", "diffSide": "RIGHT", "path": "ppl/src/test/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilderTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTozOToyMlrOGIay1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzoyNjozNlrOGIfg1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ4MDc5MQ==", "bodyText": "could u add test case for qualified index name, \"log.2020.04.20.\"", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411480791", "createdAt": "2020-04-20T15:39:22Z", "author": {"login": "penghuo"}, "path": "ppl/src/test/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilderTest.java", "diffHunk": "@@ -0,0 +1,155 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.PPLSyntaxParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.Node;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import org.junit.Test;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.agg;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.aggregate;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.equalTo;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.filter;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.function;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.intLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.map;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.project;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.relation;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.stringLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.unresolvedAttr;\n+import static org.junit.Assert.assertEquals;\n+\n+public class AstBuilderTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU1ODEwMg==", "bodyText": "Ok sure, one question: shall we unquote the (single/double/backticks) quoted identifiers in this module?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r411558102", "createdAt": "2020-04-20T17:26:36Z", "author": {"login": "chloe-zh"}, "path": "ppl/src/test/java/com/amazon/opendistroforelasticsearch/sql/ppl/parser/AstBuilderTest.java", "diffHunk": "@@ -0,0 +1,155 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.parser;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.antlr.PPLSyntaxParser;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.Node;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import org.junit.Test;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.agg;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.aggregate;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.equalTo;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.filter;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.function;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.intLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.map;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.project;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.relation;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.stringLiteral;\n+import static com.amazon.opendistroforelasticsearch.sql.ppl.plans.dsl.DSL.unresolvedAttr;\n+import static org.junit.Assert.assertEquals;\n+\n+public class AstBuilderTest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ4MDc5MQ=="}, "originalCommit": {"oid": "c251f030006ab69ee24a1aa8c7b1d905d2701703"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MjczMzk5OnYy", "diffSide": "RIGHT", "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/Aggregation.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjowOToyM1rOGKwPWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjowOToyM1rOGKwPWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzkyOTMwNg==", "bodyText": "lombok has Buiilder annotation, could you use it?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/429#discussion_r413929306", "createdAt": "2020-04-23T16:09:23Z", "author": {"login": "penghuo"}, "path": "ppl/src/main/java/com/amazon/opendistroforelasticsearch/sql/ppl/plans/logical/Aggregation.java", "diffHunk": "@@ -0,0 +1,84 @@\n+/*\n+ *   Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical;\n+\n+import com.amazon.opendistroforelasticsearch.sql.ppl.node.AbstractNodeVisitor;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.expression.Expression;\n+import com.amazon.opendistroforelasticsearch.sql.ppl.plans.logical.builder.UnresolvedPlanBuilder;\n+import com.google.common.collect.ImmutableList;\n+import java.util.List;\n+import lombok.AllArgsConstructor;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+/**\n+ * Logical plan node of Aggregation, the interface for building aggregation actions in queries\n+ */\n+@Getter\n+@Setter\n+@ToString\n+@EqualsAndHashCode(callSuper = false)\n+@AllArgsConstructor\n+public class Aggregation extends UnresolvedPlan {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acb157508ae78ee1fa08975d7bbbbfc36aa45576"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2046, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}