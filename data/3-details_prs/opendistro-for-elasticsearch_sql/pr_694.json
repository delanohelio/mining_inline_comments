{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5Njc3MzE4", "number": 694, "title": "Added datetime data type and basic functions for the conversion from string type to date and time types", "bodyText": "Issue #, if available:\nDescription of changes:\n\nAdded datetime type\nModified the properties and methods in expression values of date, time, timestamp types\nAdded function date, datetime, time, timestamp as the conversion method to convert string to date and time types\n\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-08-18T18:54:33Z", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694", "merged": true, "mergeCommit": {"oid": "8c8ad611002fc87573625e5c8ed5c1c43101ff89"}, "closed": true, "closedAt": "2020-08-26T16:53:08Z", "author": {"login": "chloe-zh"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_-kK8AH2gAyNDY5Njc3MzE4OjllNDgxNWEwZjAwYWE3MzBjYjQyMjI0YzBiZmVmZjdmMjU0NDllYTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCuZAlAFqTQ3NTY1ODQ5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9e4815a0f00aa730cb42224c0bfeff7f25449ea9", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/9e4815a0f00aa730cb42224c0bfeff7f25449ea9", "committedDate": "2020-08-18T03:36:56Z", "message": "added datetime type, modified date, time, timestamp types, added tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdce3c81dffd3b07cd8fb202db8f306c2063ef72", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/cdce3c81dffd3b07cd8fb202db8f306c2063ef72", "committedDate": "2020-08-18T18:49:28Z", "message": "added test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38f84d05c9a3a725f8c014ada737c4604d72ec5e", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/38f84d05c9a3a725f8c014ada737c4604d72ec5e", "committedDate": "2020-08-18T20:18:48Z", "message": "Merge remote-tracking branch 'upstream/develop' into dt1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "808e38207e23f5c5f085b94a50f547f32ce51b5d", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/808e38207e23f5c5f085b94a50f547f32ce51b5d", "committedDate": "2020-08-19T01:41:46Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4fc48bc5d2dcacb21b56613984e3259f7f80278", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/d4fc48bc5d2dcacb21b56613984e3259f7f80278", "committedDate": "2020-08-19T01:51:37Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71ed2cf5c0e434c6e1058141d52cea6f3be12088", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/71ed2cf5c0e434c6e1058141d52cea6f3be12088", "committedDate": "2020-08-20T23:03:37Z", "message": "Added java doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72f91bdb3713800bdb2b8e1fc2261e546ed071f0", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/72f91bdb3713800bdb2b8e1fc2261e546ed071f0", "committedDate": "2020-08-20T23:09:54Z", "message": "Merge remote-tracking branch 'upstream/develop' into dt1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "832e2e320366cc655eb4b36724de783b0ae604e8", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/832e2e320366cc655eb4b36724de783b0ae604e8", "committedDate": "2020-08-20T23:15:25Z", "message": "Merge remote-tracking branch 'upstream/develop' into dt1\n\n# Conflicts:\n#\tcore/src/main/java/com/amazon/opendistroforelasticsearch/sql/data/model/ExprValue.java\n#\tcore/src/main/java/com/amazon/opendistroforelasticsearch/sql/data/model/ExprValueUtils.java\n#\tcore/src/main/java/com/amazon/opendistroforelasticsearch/sql/data/type/ExprCoreType.java\n#\tcore/src/test/java/com/amazon/opendistroforelasticsearch/sql/data/model/ExprValueUtilsTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "804d78afaef88efc780ab6925f4a992353623ef1", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/804d78afaef88efc780ab6925f4a992353623ef1", "committedDate": "2020-08-21T22:23:05Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f22e1fc40ecfc13bf628a8a6dc5ed6a0e9bfdc70", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/f22e1fc40ecfc13bf628a8a6dc5ed6a0e9bfdc70", "committedDate": "2020-08-22T02:17:36Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0535ae58f44f3c1d2e38bf87aceed10f2bd911cc", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/0535ae58f44f3c1d2e38bf87aceed10f2bd911cc", "committedDate": "2020-08-24T20:40:18Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaf4a1a57308a5afccbc299318816ba3c19ec8ac", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/aaf4a1a57308a5afccbc299318816ba3c19ec8ac", "committedDate": "2020-08-24T20:44:31Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20315f03227a081c71e178f1379b6ee798348640", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/20315f03227a081c71e178f1379b6ee798348640", "committedDate": "2020-08-25T17:57:45Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea7360e195b57c62261bbdb2ad62a5ca8bcadda8", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/ea7360e195b57c62261bbdb2ad62a5ca8bcadda8", "committedDate": "2020-08-25T18:17:04Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0OTM0MjYz", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694#pullrequestreview-474934263", "createdAt": "2020-08-25T21:43:11Z", "commit": {"oid": "ea7360e195b57c62261bbdb2ad62a5ca8bcadda8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMTo0MzoxMVrOHGra1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMTo0MzoxMVrOHGra1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njc2NDg4NA==", "bodyText": "suggest to use exprValue.string() in future to get rid of the static getStringValue method.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694#discussion_r476764884", "createdAt": "2020-08-25T21:43:11Z", "author": {"login": "penghuo"}, "path": "core/src/main/java/com/amazon/opendistroforelasticsearch/sql/expression/datetime/DateTimeFunction.java", "diffHunk": "@@ -58,4 +135,30 @@ private FunctionResolver dayOfMonth() {\n   private ExprValue exprDayOfMonth(ExprValue date) {\n     return new ExprIntegerValue(getDateValue(date).getMonthValue());\n   }\n+\n+  /**\n+   * Time implementation for ExprValue.\n+   * @param exprValue ExprValue of Time type or String.\n+   * @return ExprValue.\n+   */\n+  private ExprValue exprTime(ExprValue exprValue) {\n+    if (exprValue instanceof ExprStringValue) {\n+      return new ExprTimeValue(getStringValue(exprValue));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea7360e195b57c62261bbdb2ad62a5ca8bcadda8"}, "originalPosition": 128}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0OTQ0MjMw", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694#pullrequestreview-474944230", "createdAt": "2020-08-25T22:02:17Z", "commit": {"oid": "ea7360e195b57c62261bbdb2ad62a5ca8bcadda8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMjowMjoxOFrOHGsYXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMjowMjoxOFrOHGsYXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njc4MDYzOQ==", "bodyText": "could we get rid of the static method incase we already have the method impl in ExprValue.", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694#discussion_r476780639", "createdAt": "2020-08-25T22:02:18Z", "author": {"login": "penghuo"}, "path": "core/src/main/java/com/amazon/opendistroforelasticsearch/sql/data/model/ExprValueUtils.java", "diffHunk": "@@ -166,12 +173,33 @@ public static Boolean getBooleanValue(ExprValue exprValue) {\n   }\n \n   /**\n-   * Get {@link ZonedDateTime} from ExprValue of Date type.\n+   * Get {@link LocalDate} from ExprValue of Date type.\n    */\n-  public static ZonedDateTime getDateValue(ExprValue exprValue) {\n+  public static LocalDate getDateValue(ExprValue exprValue) {\n     return exprValue.dateValue();\n   }\n \n+  /**\n+   * Get {@link LocalTime} from ExprValue of Time type.\n+   */\n+  public static LocalTime getTimeValue(ExprValue exprValue) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea7360e195b57c62261bbdb2ad62a5ca8bcadda8"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MDUxMTY2", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694#pullrequestreview-475051166", "createdAt": "2020-08-25T23:25:18Z", "commit": {"oid": "ea7360e195b57c62261bbdb2ad62a5ca8bcadda8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMzoyNToxOFrOHGwxyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMzoyNToxOFrOHGwxyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njg1MjY4Mw==", "bodyText": "Just wonder any reason not use lombok annotation for equal and hashCode?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694#discussion_r476852683", "createdAt": "2020-08-25T23:25:18Z", "author": {"login": "dai-chen"}, "path": "core/src/main/java/com/amazon/opendistroforelasticsearch/sql/data/model/ExprDatetimeValue.java", "diffHunk": "@@ -0,0 +1,100 @@\n+/*\n+ *   Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *   Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *   You may not use this file except in compliance with the License.\n+ *   A copy of the License is located at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *   or in the \"license\" file accompanying this file. This file is distributed\n+ *   on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *   express or implied. See the License for the specific language governing\n+ *   permissions and limitations under the License.\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.data.model;\n+\n+import com.amazon.opendistroforelasticsearch.sql.data.type.ExprCoreType;\n+import com.amazon.opendistroforelasticsearch.sql.data.type.ExprType;\n+import com.amazon.opendistroforelasticsearch.sql.exception.SemanticCheckException;\n+import com.google.common.base.Objects;\n+import java.time.Instant;\n+import java.time.LocalDate;\n+import java.time.LocalDateTime;\n+import java.time.LocalTime;\n+import java.time.ZoneId;\n+import java.time.ZonedDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.time.format.DateTimeParseException;\n+import lombok.RequiredArgsConstructor;\n+\n+@RequiredArgsConstructor\n+public class ExprDatetimeValue extends AbstractExprValue {\n+  private static final DateTimeFormatter formatter = DateTimeFormatter\n+      .ofPattern(\"yyyy-MM-dd HH:mm:ss\");\n+  private final LocalDateTime datetime;\n+\n+  /**\n+   * Constructor with datetime string as input.\n+   */\n+  public ExprDatetimeValue(String datetime) {\n+    try {\n+      this.datetime = LocalDateTime.parse(datetime, formatter);\n+    } catch (DateTimeParseException e) {\n+      throw new SemanticCheckException(String.format(\"datetime:%s in unsupported format, please \"\n+          + \"use yyyy-MM-dd HH:mm:ss\", datetime));\n+    }\n+  }\n+\n+  @Override\n+  public LocalDateTime datetimeValue() {\n+    return datetime;\n+  }\n+\n+  @Override\n+  public LocalDate dateValue() {\n+    return datetime.toLocalDate();\n+  }\n+\n+  @Override\n+  public LocalTime timeValue() {\n+    return datetime.toLocalTime();\n+  }\n+\n+  @Override\n+  public Instant timestampValue() {\n+    return ZonedDateTime.of(datetime, ZoneId.of(\"UTC\")).toInstant();\n+  }\n+\n+  @Override\n+  public int compare(ExprValue other) {\n+    return datetime.compareTo(other.datetimeValue());\n+  }\n+\n+  @Override\n+  public boolean equal(ExprValue other) {\n+    return datetime.equals(other.datetimeValue());\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea7360e195b57c62261bbdb2ad62a5ca8bcadda8"}, "originalPosition": 78}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23ffebcf409bc10d460892e11fe22f8add0b9e1a", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/23ffebcf409bc10d460892e11fe22f8add0b9e1a", "committedDate": "2020-08-26T00:50:51Z", "message": "update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25e3773195be7112c29900152a7630313478834a", "author": {"user": {"login": "chloe-zh", "name": "Chloe"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/25e3773195be7112c29900152a7630313478834a", "committedDate": "2020-08-26T00:54:23Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NTk0MTA3", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694#pullrequestreview-475594107", "createdAt": "2020-08-26T15:15:53Z", "commit": {"oid": "25e3773195be7112c29900152a7630313478834a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NjU4NDk2", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/694#pullrequestreview-475658496", "createdAt": "2020-08-26T16:28:02Z", "commit": {"oid": "25e3773195be7112c29900152a7630313478834a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 622, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}