{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2NTMzMTUx", "number": 526, "title": "Move the index mapping definitions to standalone json files", "bodyText": "Issue #, if available: #138\nDescription of changes:\nMove the test index mapping definition, which directly written in code, to standalone json files.\nName of these json files are made referring to the function name.\nI referred this code to load each json file placed in `resources/mappings/**'\nBy submitting this pull request, I confirm that my contribution is made under the terms of the Apache 2.0 license.", "createdAt": "2020-06-18T14:58:43Z", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/526", "merged": true, "mergeCommit": {"oid": "d42dcbdffaf9c1f5486f438a075eddce42cb0e2e"}, "closed": true, "closedAt": "2020-06-23T18:56:14Z", "author": {"login": "pakio"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcs0SQKgFqTQzNDE0MDUyOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABct2Ev2AFqTQzNTIxNDU2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MTQwNTI4", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/526#pullrequestreview-434140528", "createdAt": "2020-06-19T14:53:45Z", "commit": {"oid": "d2e7491452cfd063e5787cbe83b6fe5e39b08933"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNDo1Mzo0NVrOGmXpug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNDo1Mzo0NVrOGmXpug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjg4NjU4Ng==", "bodyText": "all the method have almost same implementation, the only different is mappingFile name, could you simply it?", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/526#discussion_r442886586", "createdAt": "2020-06-19T14:53:45Z", "author": {"login": "penghuo"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/sql/esintgtest/TestUtils.java", "diffHunk": "@@ -127,566 +130,196 @@ public static Response performRequest(RestClient client, Request request) {\n     }\n \n     public static String getAccountIndexMapping() {\n-        return \"{  \\\"mappings\\\": {\" +\n-                \" \\\"properties\\\": {\\n\" +\n-                \"          \\\"gender\\\": {\\n\" +\n-                \"            \\\"type\\\": \\\"text\\\",\\n\" +\n-                \"            \\\"fielddata\\\": true\\n\" +\n-                \"          },\" +\n-                \"          \\\"address\\\": {\\n\" +\n-                \"            \\\"type\\\": \\\"text\\\",\\n\" +\n-                \"            \\\"fielddata\\\": true\\n\" +\n-                \"          },\" +\n-                \"          \\\"firstname\\\": {\\n\" +\n-                \"            \\\"type\\\": \\\"text\\\",\\n\" +\n-                \"            \\\"fielddata\\\": true,\\n\" +\n-                \"            \\\"fields\\\": {\\n\" +\n-                \"              \\\"keyword\\\": {\\n\" +\n-                \"                \\\"type\\\": \\\"keyword\\\",\\n\" +\n-                \"                \\\"ignore_above\\\": 256\\n\" +\n-                \"              }\" +\n-                \"            }\" +\n-                \"          },\" +\n-                \"          \\\"lastname\\\": {\\n\" +\n-                \"            \\\"type\\\": \\\"text\\\",\\n\" +\n-                \"            \\\"fielddata\\\": true,\\n\" +\n-                \"            \\\"fields\\\": {\\n\" +\n-                \"              \\\"keyword\\\": {\\n\" +\n-                \"                \\\"type\\\": \\\"keyword\\\",\\n\" +\n-                \"                \\\"ignore_above\\\": 256\\n\" +\n-                \"              }\" +\n-                \"            }\" +\n-                \"          },\" +\n-                \"          \\\"state\\\": {\\n\" +\n-                \"            \\\"type\\\": \\\"text\\\",\\n\" +\n-                \"            \\\"fielddata\\\": true,\\n\" +\n-                \"            \\\"fields\\\": {\\n\" +\n-                \"              \\\"keyword\\\": {\\n\" +\n-                \"                \\\"type\\\": \\\"keyword\\\",\\n\" +\n-                \"                \\\"ignore_above\\\": 256\\n\" +\n-                \"              }\" +\n-                \"            }\" +\n-                \"          }\" +\n-                \"       }\"+\n-                \"   }\" +\n-                \"}\";\n+        String mappingFile = \"mappings/account_index_mapping.json\";\n+        URL url = Resources.getResource(mappingFile);\n+        try {\n+            return Resources.toString(url, Charsets.UTF_8);\n+        } catch(Exception e) {\n+            return null;\n+        }\n     }\n \n     public static String getPhraseIndexMapping() {\n-        return \"{  \\\"mappings\\\": {\" +\n-                \" \\\"properties\\\": {\\n\" +\n-                \"          \\\"phrase\\\": {\\n\" +\n-                \"            \\\"type\\\": \\\"text\\\",\\n\" +\n-                \"            \\\"store\\\": true\\n\" +\n-                \"          }\" +\n-                \"       }\"+\n-                \"   }\" +\n-                \"}\";\n+        String mappingFile = \"mappings/phrase_index_mapping.json\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2e7491452cfd063e5787cbe83b6fe5e39b08933"}, "originalPosition": 83}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dab77dbfa4d28d907dad9514d18c9de9285d28d", "author": {"user": {"login": "pakio", "name": "Kazuma Arimura"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/9dab77dbfa4d28d907dad9514d18c9de9285d28d", "committedDate": "2020-06-19T23:39:23Z", "message": "move index mapping definition to standalone json files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f65122aa99dcc54a0f8501d4441fea046504d1bb", "author": {"user": {"login": "pakio", "name": "Kazuma Arimura"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/f65122aa99dcc54a0f8501d4441fea046504d1bb", "committedDate": "2020-06-19T23:39:24Z", "message": "Migrate functions to use mapping json file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b73ad7024aefdd0afddab9e3dfebac30cc3627bd", "author": {"user": {"login": "pakio", "name": "Kazuma Arimura"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/b73ad7024aefdd0afddab9e3dfebac30cc3627bd", "committedDate": "2020-06-19T23:39:24Z", "message": "simply code to load mapping file"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d2e7491452cfd063e5787cbe83b6fe5e39b08933", "author": {"user": {"login": "pakio", "name": "Kazuma Arimura"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/d2e7491452cfd063e5787cbe83b6fe5e39b08933", "committedDate": "2020-06-18T14:57:33Z", "message": "Migrate functions to use mapping json file"}, "afterCommit": {"oid": "b73ad7024aefdd0afddab9e3dfebac30cc3627bd", "author": {"user": {"login": "pakio", "name": "Kazuma Arimura"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/b73ad7024aefdd0afddab9e3dfebac30cc3627bd", "committedDate": "2020-06-19T23:39:24Z", "message": "simply code to load mapping file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "792365737ee4d2f590eb1ae87968d3a7427c2eb1", "author": {"user": {"login": "pakio", "name": "Kazuma Arimura"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/792365737ee4d2f590eb1ae87968d3a7427c2eb1", "committedDate": "2020-06-20T12:48:28Z", "message": "split index mapping definition into separated file for legacy integTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3021c7994cfbbf24f430907e7f6b0862ff899eb7", "author": {"user": {"login": "pakio", "name": "Kazuma Arimura"}}, "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/3021c7994cfbbf24f430907e7f6b0862ff899eb7", "committedDate": "2020-06-20T12:50:06Z", "message": "Revert changes for legacy/../TestUtils.java\n\nThis reverts commit b73ad7024aefdd0afddab9e3dfebac30cc3627bd.\nThis reverts commit f65122aa99dcc54a0f8501d4441fea046504d1bb."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NTMzMDQ4", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/526#pullrequestreview-434533048", "createdAt": "2020-06-21T21:11:20Z", "commit": {"oid": "3021c7994cfbbf24f430907e7f6b0862ff899eb7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MjE0NTY5", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/526#pullrequestreview-435214569", "createdAt": "2020-06-22T19:32:44Z", "commit": {"oid": "3021c7994cfbbf24f430907e7f6b0862ff899eb7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 697, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}