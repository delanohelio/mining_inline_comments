{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2MDI3NDcz", "number": 304, "title": "uploader validation QA comments", "bodyText": "QA Comments for CCS 3600 fixes:\n1.) When 'canonical' is missing from pantheon2.yml default value of canonical is set as True in the backend\n2.) When value of canonical is blank in pantheon2.yml, 500 server error is displayed. Proper error message should be displayed instead\n3.)  Value of canonical is saved as True in the backed, when its value is undefined in panthon2.yml\n4.) Also observed that, when we try to upload the same repo twice, the last modified time is not updated.\n5.) If a user does not update the pantheon2.yml (keeps it the previous format)  then he should get an error for missing fields which is not the case currently", "createdAt": "2020-06-01T14:51:32Z", "url": "https://github.com/redhataccess/pantheon/pull/304", "merged": true, "mergeCommit": {"oid": "7fe90330db1fa7be46e00bbc83d954746993d3fa"}, "closed": true, "closedAt": "2020-06-02T12:51:24Z", "author": {"login": "rednitish"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnBZ8JAH2gAyNDI2MDI3NDczOmI2YzdjYmZmNzFmZDA1NjQ3OTQyMmI4NWM5NjU3ODljOWJkOTRlNjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnT5NogFqTQyMjYxODM2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b6c7cbff71fd056479422b85c965789c9bd94e60", "author": {"user": {"login": "rednitish", "name": "Nitish Sharma"}}, "url": "https://github.com/redhataccess/pantheon/commit/b6c7cbff71fd056479422b85c965789c9bd94e60", "committedDate": "2020-06-01T14:47:22Z", "message": "uploader validation QA comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxOTc2NzEw", "url": "https://github.com/redhataccess/pantheon/pull/304#pullrequestreview-421976710", "createdAt": "2020-06-01T16:03:50Z", "commit": {"oid": "b6c7cbff71fd056479422b85c965789c9bd94e60"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNjowMzo1MVrOGdQoSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxNjowMzo1MVrOGdQoSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzMzNDM0Ng==", "bodyText": "Do we need update the jcr:lastModified timestamp. My understanding is that sling populates for us by default", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433334346", "createdAt": "2020-06-01T16:03:51Z", "author": {"login": "xdavidson"}, "path": "uploader/pantheon.py", "diffHunk": "@@ -299,22 +300,26 @@ def process_workspace(path):\n     logger.debug('url: %s', url)\n     workspace = {}\n     workspace['jcr:primaryType'] = 'pant:workspace'\n+    workspace['jcr:lastModified'] = datetime.now().strftime(\"%Y-%m-%dT%H:%m:%S\") #SimpleDateFormat:yyyy-MM-dd'T'HH:mm:ss", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6c7cbff71fd056479422b85c965789c9bd94e60"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca441c48e8e43b63899698905566e4a03933f653", "author": {"user": {"login": "rednitish", "name": "Nitish Sharma"}}, "url": "https://github.com/redhataccess/pantheon/commit/ca441c48e8e43b63899698905566e4a03933f653", "committedDate": "2020-06-02T02:51:43Z", "message": "CCS-3600 validation related to changes in JCR syntax, ist to utc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyMzg1NzYy", "url": "https://github.com/redhataccess/pantheon/pull/304#pullrequestreview-422385762", "createdAt": "2020-06-02T06:48:03Z", "commit": {"oid": "ca441c48e8e43b63899698905566e4a03933f653"}, "state": "DISMISSED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNjo0ODowNFrOGdkNzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNzowMDoxNFrOGdki1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1NTI0NQ==", "bodyText": "Hey Nitish, can you confirm if \"yyyy-MM-dd\" is the format same as that being used consistently in the Pantheon App?", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433655245", "createdAt": "2020-06-02T06:48:04Z", "author": {"login": "anknite"}, "path": "uploader/pantheon.py", "diffHunk": "@@ -299,22 +301,26 @@ def process_workspace(path):\n     logger.debug('url: %s', url)\n     workspace = {}\n     workspace['jcr:primaryType'] = 'pant:workspace'\n+    workspace['jcr:lastModified'] = datetime.now().utcnow().strftime(\"%Y-%m-%dT%H:%m:%S\") #SimpleDateFormat:yyyy-MM-dd'T'HH:mm:ss", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca441c48e8e43b63899698905566e4a03933f653"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1Njk3Ng==", "bodyText": "There seems to be a warning here, nothing major just a uniformity check for new line I guess. Could you please add it.", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433656976", "createdAt": "2020-06-02T06:51:56Z", "author": {"login": "anknite"}, "path": "uploader/pantheon.py", "diffHunk": "@@ -483,5 +493,6 @@ def process_attributes_as_resources(variants):\n         _warn(f'{leftoverFiles} additional files detected but not uploaded. Only files specified in '\n               + CONFIG_FILE\n               + ' are handled for upload.')\n-\n+else:\n+    sys.exit('Modules and resources not found, please check yaml syntax')\n print('Finished!')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca441c48e8e43b63899698905566e4a03933f653"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1ODg2Ng==", "bodyText": "I see that cannonicalPresent is being initialized to False and not being used further. Is there a reason this was left off?", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433658866", "createdAt": "2020-06-02T06:56:20Z", "author": {"login": "anknite"}, "path": "uploader/pantheon.py", "diffHunk": "@@ -299,22 +301,26 @@ def process_workspace(path):\n     logger.debug('url: %s', url)\n     workspace = {}\n     workspace['jcr:primaryType'] = 'pant:workspace'\n+    workspace['jcr:lastModified'] = datetime.now().utcnow().strftime(\"%Y-%m-%dT%H:%m:%S\") #SimpleDateFormat:yyyy-MM-dd'T'HH:mm:ss\n     # Process variants. variants is a list of dictionaries\n \n     data = {}\n+    cannonicalPresent = False", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca441c48e8e43b63899698905566e4a03933f653"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1OTM0NQ==", "bodyText": "Similar to my earlier comment cannonicalPresent is now 'true' however its not being used. Am I missing something?", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433659345", "createdAt": "2020-06-02T06:57:20Z", "author": {"login": "anknite"}, "path": "uploader/pantheon.py", "diffHunk": "@@ -299,22 +301,26 @@ def process_workspace(path):\n     logger.debug('url: %s', url)\n     workspace = {}\n     workspace['jcr:primaryType'] = 'pant:workspace'\n+    workspace['jcr:lastModified'] = datetime.now().utcnow().strftime(\"%Y-%m-%dT%H:%m:%S\") #SimpleDateFormat:yyyy-MM-dd'T'HH:mm:ss\n     # Process variants. variants is a list of dictionaries\n \n     data = {}\n+    cannonicalPresent = False\n     if variants:\n         validateVariants()\n         for variant in variants:\n             # Each variant is of type dictionary. Rename the keys to match ModuleVariantDefinition\n             module_variants = {}\n+            module_variants['pant:canonical'] = 'false'\n             for key, value in variant.items():\n                 if key.lower() == 'name':\n                     module_variants['pant:name'] = value\n                 if key.lower() == 'path':\n                     module_variants['pant:attributesFilePath'] = value\n                 if key.lower() == 'canonical':\n                     module_variants['pant:canonical'] = value\n-            if 'pant:canonical' not in module_variants:\n+                    cannonicalPresent = 'true'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca441c48e8e43b63899698905566e4a03933f653"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY2MDYyOQ==", "bodyText": "Should we be adding a warning/error message if 'canonical' not in variant\nessentially an else of this if", "url": "https://github.com/redhataccess/pantheon/pull/304#discussion_r433660629", "createdAt": "2020-06-02T07:00:14Z", "author": {"login": "anknite"}, "path": "uploader/pantheon.py", "diffHunk": "@@ -338,8 +344,11 @@ def validateVariants():\n             sys.exit(\"Variant (name) missing, please correct variant name \")\n         if 'path' not in variant or  variant['path'] is None:  # path is mandatory for variant, throw errors in case of missing\n             sys.exit(\"Variant (path) missing, please correct variant path \")\n-        if 'canonical' in variant and variant['canonical'] is not None:\n-            isCannonicalList.append(variant['canonical'])\n+        if 'canonical' in variant:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca441c48e8e43b63899698905566e4a03933f653"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab0dc0fb3d0d681ddbb127932d8cc240e291c5be", "author": {"user": {"login": "rednitish", "name": "Nitish Sharma"}}, "url": "https://github.com/redhataccess/pantheon/commit/ab0dc0fb3d0d681ddbb127932d8cc240e291c5be", "committedDate": "2020-06-02T10:43:49Z", "message": "CCS-3600 validation related to changes in JCR syntax, ankit reviews"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2683ec505561520959b788e9720726831997b34", "author": {"user": {"login": "rednitish", "name": "Nitish Sharma"}}, "url": "https://github.com/redhataccess/pantheon/commit/c2683ec505561520959b788e9720726831997b34", "committedDate": "2020-06-02T10:46:54Z", "message": "CCS-3600 validation related to changes in JCR syntax, ankit reviews"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "213bd7e42b2c2024854a9764274754b2fd8f287e", "author": {"user": {"login": "rednitish", "name": "Nitish Sharma"}}, "url": "https://github.com/redhataccess/pantheon/commit/213bd7e42b2c2024854a9764274754b2fd8f287e", "committedDate": "2020-06-02T10:48:54Z", "message": "CCS-3600 validation related to changes in JCR syntax, ankit reviews"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNjE4MzYz", "url": "https://github.com/redhataccess/pantheon/pull/304#pullrequestreview-422618363", "createdAt": "2020-06-02T12:19:49Z", "commit": {"oid": "213bd7e42b2c2024854a9764274754b2fd8f287e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2125, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}