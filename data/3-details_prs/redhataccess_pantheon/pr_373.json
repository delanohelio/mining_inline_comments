{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NzIzNTIw", "number": 373, "title": "UI change for assebmly details and Patternfly/React upgrade", "bodyText": "This PR introduces the following changes:\n\nUpgrade Patternfly 3.16 to 4.32\nIntroduce the new UI for assembly\nUpdate module details screen", "createdAt": "2020-08-18T20:20:52Z", "url": "https://github.com/redhataccess/pantheon/pull/373", "merged": true, "mergeCommit": {"oid": "503b5942a5e477d6dff307a6fd0b8a22ff7a791a"}, "closed": true, "closedAt": "2020-08-19T20:13:01Z", "author": {"login": "xdavidson"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8Vd_RAH2gAyNDY5NzIzNTIwOjhlMGFmNzhiMGUyMjc4MmFhOGZjMjZhNmFlZjExMGRjNzUyNzc0ZTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAhCgBAFqTQ3MDc5NjAzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8e0af78b0e22782aa8fc26a6aef110dc752774e5", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/8e0af78b0e22782aa8fc26a6aef110dc752774e5", "committedDate": "2020-08-06T20:02:18Z", "message": "update headers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff138302f0a056b0ea40ebd7568a8189925af92b", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/ff138302f0a056b0ea40ebd7568a8189925af92b", "committedDate": "2020-08-11T13:20:27Z", "message": "upgrade patternfly to the latest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "246a8c98f75f5f98a4e91577aff438982edff67c", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/246a8c98f75f5f98a4e91577aff438982edff67c", "committedDate": "2020-08-12T13:26:20Z", "message": "remove datalist"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88e73c111736f65e07962bbf0a1857c0a662052b", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/88e73c111736f65e07962bbf0a1857c0a662052b", "committedDate": "2020-08-12T21:13:37Z", "message": "merge with master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f3b9e94514cd07a6800a156007a8df359c78c37", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/8f3b9e94514cd07a6800a156007a8df359c78c37", "committedDate": "2020-08-12T21:16:38Z", "message": "ensure html is rerendered"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f13a8d26e2bbe0047fa0a5775134ad8c9065eeef", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/f13a8d26e2bbe0047fa0a5775134ad8c9065eeef", "committedDate": "2020-08-17T13:46:35Z", "message": "update module display"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b6da851d6efec4021bf5a6eabf985d3cd484107", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/3b6da851d6efec4021bf5a6eabf985d3cd484107", "committedDate": "2020-08-17T15:55:15Z", "message": "fix nav"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e8bd7a26f31cac41c9b7a284e2dd53ca042e838", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/1e8bd7a26f31cac41c9b7a284e2dd53ca042e838", "committedDate": "2020-08-17T15:55:28Z", "message": "Merge branch 'master' of github.com:redhataccess/pantheon into CCS-3663-assebmly_details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f836094d0de215a5f3c2563576bbe725b0733883", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/f836094d0de215a5f3c2563576bbe725b0733883", "committedDate": "2020-08-17T21:18:59Z", "message": "add handlePublishButton logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "721373b09ae00043caa89e656df611bdbe1654d7", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/721373b09ae00043caa89e656df611bdbe1654d7", "committedDate": "2020-08-18T19:41:44Z", "message": "update tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1d6f4e25ab1de19b851bcda65a15307e11fc2de", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/b1d6f4e25ab1de19b851bcda65a15307e11fc2de", "committedDate": "2020-08-18T19:43:32Z", "message": "remove unused tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ceaa98c964535510666dffde7c7c581821be0f11", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/ceaa98c964535510666dffde7c7c581821be0f11", "committedDate": "2020-08-18T19:51:21Z", "message": "fix failed tests after patternfly upgrade"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f717a7a3cb50805fdf8010d99e8b57ebebdf64df", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/f717a7a3cb50805fdf8010d99e8b57ebebdf64df", "committedDate": "2020-08-18T19:54:11Z", "message": "remove unused files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d9229868ae8a3fd55b9cdac33080c0169aec647", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/9d9229868ae8a3fd55b9cdac33080c0169aec647", "committedDate": "2020-08-18T21:04:37Z", "message": "fix searchfilter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d27b6eaea85d25eb9be0c09370ebc4a8853fe45f", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/d27b6eaea85d25eb9be0c09370ebc4a8853fe45f", "committedDate": "2020-08-18T21:20:11Z", "message": "add comments to css"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNjg2NDYz", "url": "https://github.com/redhataccess/pantheon/pull/373#pullrequestreview-470686463", "createdAt": "2020-08-19T17:25:07Z", "commit": {"oid": "d27b6eaea85d25eb9be0c09370ebc4a8853fe45f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxNzoyNTowOFrOHDR9hA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxNzoyNzo0M1rOHDSC8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzIwMjA1Mg==", "bodyText": "Tagging this at the bottom, but this entire file looks substantially similar to the assemblyDisplay.tsx file. Can we combine them to reduce duplication?", "url": "https://github.com/redhataccess/pantheon/pull/373#discussion_r473202052", "createdAt": "2020-08-19T17:25:08Z", "author": {"login": "benradey"}, "path": "pantheon-bundle/frontend/src/app/moduleDisplay.tsx", "diffHunk": "@@ -335,6 +360,31 @@ class ModuleDisplay extends Component<any, any, any> {\n         }\n     }\n \n+    private fetchAttributesFilePath = async (data) => {\n+        await this.getVariantParam()\n+        const path = data.location.pathname.substring(PathPrefixes.MODULE_PATH_PREFIX.length)\n+        // console.log(\"[fetchAttributesFilePath] path =>\", path)\n+        let repo = ''\n+        const group = path.split(\"/\")\n+        repo = group[2]\n+        fetch('/content/repositories/' + repo + '/module_variants/' + this.state.variant + '.harray.json')\n+            .then((response) => {\n+                if (response.ok) {\n+                    return response.json()\n+                } else {\n+                    throw new Error(response.statusText)\n+                }\n+            })\n+            .then(responseJSON => {\n+                if (responseJSON[\"pant:attributesFilePath\"] !== undefined) {\n+                    this.setState({ attributesFilePath: responseJSON[\"pant:attributesFilePath\"] })\n+                }\n+            })\n+            .catch((error) => {\n+                console.log(error)\n+            })\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d27b6eaea85d25eb9be0c09370ebc4a8853fe45f"}, "originalPosition": 346}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzIwMzQ0Mg==", "bodyText": "It looks like you've commented out this entire file. Was that intentional? Will the commented code be coming back at some point?\nIIRC, versions.tsx is responsible for displaying most of the document details pages. I would guess that you've reworked most of that and that the old tests are now obsolete. If that's true, please remove them rather than commenting them.", "url": "https://github.com/redhataccess/pantheon/pull/373#discussion_r473203442", "createdAt": "2020-08-19T17:27:43Z", "author": {"login": "benradey"}, "path": "pantheon-bundle/frontend/src/app/versions.test.tsx", "diffHunk": "@@ -304,39 +283,39 @@ describe('Versions tests', () => {\n         expect(state.versionModulePath).toEqual('versionPath')\n     })\n \n-    test('changePublishState click', () => {\n-        const wrapper = mount(<Versions {...props} />)\n-        const instance = wrapper.instance()\n-        wrapper.setState({ 'login': true })\n-        wrapper.setState({\n-            'results': [[{ \"type\": \"draft\", \"icon\": \"BlankImage\", \"path\": \"/modules/test\", \"version\": \"Version 1\", \"publishedState\": 'Not published', \"updatedDate\": \"\", \"firstButtonType\": 'primary', \"secondButtonType\": 'secondary', \"firstButtonText\": 'Publish', \"secondButtonText\": 'Preview', \"isDropdownOpen\": false, \"isArchiveDropDownOpen\": false, \"metadata\": '' }]],\n-        })\n-        const spy = sinon.spy(instance, 'changePublishState')\n-        wrapper.find(Button).at(2).simulate('click')\n-        sinon.assert.called(spy)\n-    })\n-\n-    it('test fetchProducts function', () => {\n-        const wrapper = renderer.create(<Versions {...props} />)\n-        const inst = wrapper.getInstance()\n-        const spy = sinon.spy(inst, 'fetchProducts')\n-        inst.componentDidMount()\n-        sinon.assert.called(spy)\n-    })\n-\n-    it('test fetchVersions function', () => {\n-        const wrapper = renderer.create(<Versions {...props} />)\n-        const inst = wrapper.getInstance()\n-        const spy = sinon.spy(inst, 'fetchVersions')\n-        inst.fetchVersions()\n-        sinon.assert.called(spy)\n-    })\n-\n-    it('test changePublishState function', () => {\n-        const wrapper = renderer.create(<Versions {...props} />)\n-        const inst = wrapper.getInstance()\n-        const spy = sinon.spy(inst, 'changePublishState')\n-        inst.changePublishState(\"ds\")\n-        sinon.assert.called(spy)\n-    })\n+    // test('changePublishState click', () => {\n+    //     const wrapper = mount(<Versions {...props} />)\n+    //     const instance = wrapper.instance()\n+    //     wrapper.setState({ 'login': true })\n+    //     wrapper.setState({\n+    //         'results': [[{ \"type\": \"draft\", \"icon\": \"BlankImage\", \"path\": \"/modules/test\", \"version\": \"Version 1\", \"publishedState\": 'Not published', \"updatedDate\": \"\", \"firstButtonType\": 'primary', \"secondButtonType\": 'secondary', \"firstButtonText\": 'Publish', \"secondButtonText\": 'Preview', \"isDropdownOpen\": false, \"isArchiveDropDownOpen\": false, \"metadata\": '' }]],\n+    //     })\n+    //     const spy = sinon.spy(instance, 'changePublishState')\n+    //     wrapper.find(Button).at(2).simulate('click')\n+    //     sinon.assert.called(spy)\n+    // })\n+\n+    // it('test fetchProducts function', () => {\n+    //     const wrapper = renderer.create(<Versions {...props} />)\n+    //     const inst = wrapper.getInstance()\n+    //     const spy = sinon.spy(inst, 'fetchProducts')\n+    //     inst.componentDidMount()\n+    //     sinon.assert.called(spy)\n+    // })\n+\n+    // it('test fetchVersions function', () => {\n+    //     const wrapper = renderer.create(<Versions {...props} />)\n+    //     const inst = wrapper.getInstance()\n+    //     const spy = sinon.spy(inst, 'fetchVersions')\n+    //     inst.fetchVersions()\n+    //     sinon.assert.called(spy)\n+    // })\n+\n+    // it('test changePublishState function', () => {\n+    //     const wrapper = renderer.create(<Versions {...props} />)\n+    //     const inst = wrapper.getInstance()\n+    //     const spy = sinon.spy(inst, 'changePublishState')\n+    //     inst.changePublishState(\"ds\")\n+    //     sinon.assert.called(spy)\n+    // })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d27b6eaea85d25eb9be0c09370ebc4a8853fe45f"}, "originalPosition": 559}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "314539c0585de64a05148d3e035844caa06bd9db", "author": {"user": {"login": "xdavidson", "name": "Lisa Davidson"}}, "url": "https://github.com/redhataccess/pantheon/commit/314539c0585de64a05148d3e035844caa06bd9db", "committedDate": "2020-08-19T19:13:34Z", "message": "fix versions tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNzk2MDM4", "url": "https://github.com/redhataccess/pantheon/pull/373#pullrequestreview-470796038", "createdAt": "2020-08-19T19:46:50Z", "commit": {"oid": "314539c0585de64a05148d3e035844caa06bd9db"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1998, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}