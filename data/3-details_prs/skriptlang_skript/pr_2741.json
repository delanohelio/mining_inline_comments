{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4OTQ1NzI1", "number": 2741, "title": "EffBan - add an optional time span to temp ban a player", "bodyText": "Description\nThis PR adds an option time span to the ban effect to allow users to temp ban players.\n\nTarget Minecraft Versions: any\nRequirements: none\nRelated Issues: #2667\nSpecial note:\nI tried to do a test for this one, but for true testing I need to do a wait. The testing environment appears to ignore waits in testing.", "createdAt": "2020-01-03T10:43:14Z", "url": "https://github.com/SkriptLang/Skript/pull/2741", "merged": true, "mergeCommit": {"oid": "433aeabfc33689c22aed77c2684415f494b5538c"}, "closed": true, "closedAt": "2020-01-11T15:25:48Z", "author": {"login": "ShaneBeee"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2r-vMgH2gAyMzU4OTQ1NzI1OmE1YzY1ZmQ0Y2JjM2I2ZmVkMDNmYTA0OTgyMGJhNjk5ZmU3M2ZmZDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb5U1VRAFqTM0MTUyNzI3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a5c65fd4cbc3b6fed03fa049820ba699fe73ffd0", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/a5c65fd4cbc3b6fed03fa049820ba699fe73ffd0", "committedDate": "2020-01-03T10:41:17Z", "message": "EffBan - add an optional time span to temp ban a player"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MjEwNDM0", "url": "https://github.com/SkriptLang/Skript/pull/2741#pullrequestreview-338210434", "createdAt": "2020-01-03T18:24:23Z", "commit": {"oid": "a5c65fd4cbc3b6fed03fa049820ba699fe73ffd0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wM1QxODoyNDoyM1rOFaGUpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wM1QxODoyNDoyM1rOFaGUpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjkxMDg4NQ==", "bodyText": "getSingle may be null, so it's not safe to call getMS right away", "url": "https://github.com/SkriptLang/Skript/pull/2741#discussion_r362910885", "createdAt": "2020-01-03T18:24:23Z", "author": {"login": "Pikachu920"}, "path": "src/main/java/ch/njol/skript/effects/EffBan.java", "diffHunk": "@@ -73,15 +76,17 @@\n \tpublic boolean init(final Expression<?>[] exprs, final int matchedPattern, final Kleenean isDelayed, final ParseResult parseResult) {\r\n \t\tplayers = exprs[0];\r\n \t\treason = exprs.length > 1 ? (Expression<String>) exprs[1] : null;\r\n+\t\texpires = exprs.length > 1 ? (Expression<Timespan>) exprs[2] : null;\r\n \t\tban = matchedPattern % 2 == 0;\r\n \t\tipBan = matchedPattern >= 2;\r\n \t\treturn true;\r\n \t}\r\n \t\r\n+\t@SuppressWarnings(\"null\")\r\n \t@Override\r\n \tprotected void execute(final Event e) {\r\n \t\tfinal String reason = this.reason != null ? this.reason.getSingle(e) : null; // don't check for null, just ignore an invalid reason\r\n-\t\tfinal Date expires = null;\r\n+\t\tfinal Date expires = this.expires != null ? new Date(System.currentTimeMillis() + this.expires.getSingle(e).getMilliSeconds()) : null;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5c65fd4cbc3b6fed03fa049820ba699fe73ffd0"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MjE0NDkw", "url": "https://github.com/SkriptLang/Skript/pull/2741#pullrequestreview-338214490", "createdAt": "2020-01-03T18:34:26Z", "commit": {"oid": "a5c65fd4cbc3b6fed03fa049820ba699fe73ffd0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13f94e693bfb3b160f7501fb0d5d01a4887795bf", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/13f94e693bfb3b160f7501fb0d5d01a4887795bf", "committedDate": "2020-01-03T19:37:24Z", "message": "EffBan - Prevent null from timespan"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22f1b688a34e58cd935997c9b06bc6fefb447083", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/22f1b688a34e58cd935997c9b06bc6fefb447083", "committedDate": "2020-01-03T19:38:45Z", "message": "Revert \"EffBan - Prevent null from timespan\"\n\nThis reverts commit 13f94e69"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7545b4f071bf62eeb0af5f363a8ed3a66914132c", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/7545b4f071bf62eeb0af5f363a8ed3a66914132c", "committedDate": "2020-01-03T19:39:31Z", "message": "EffBan - Prevent null from timespan"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMTQ0MjI5", "url": "https://github.com/SkriptLang/Skript/pull/2741#pullrequestreview-340144229", "createdAt": "2020-01-08T21:05:35Z", "commit": {"oid": "7545b4f071bf62eeb0af5f363a8ed3a66914132c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNTozNVrOFbj0Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNTozNVrOFbj0Rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MjY5NA==", "bodyText": "is it really a good idea to permaban people if the timespan happened to be not set?", "url": "https://github.com/SkriptLang/Skript/pull/2741#discussion_r364442694", "createdAt": "2020-01-08T21:05:35Z", "author": {"login": "Pikachu920"}, "path": "src/main/java/ch/njol/skript/effects/EffBan.java", "diffHunk": "@@ -73,15 +76,18 @@\n \tpublic boolean init(final Expression<?>[] exprs, final int matchedPattern, final Kleenean isDelayed, final ParseResult parseResult) {\r\n \t\tplayers = exprs[0];\r\n \t\treason = exprs.length > 1 ? (Expression<String>) exprs[1] : null;\r\n+\t\texpires = exprs.length > 1 ? (Expression<Timespan>) exprs[2] : null;\r\n \t\tban = matchedPattern % 2 == 0;\r\n \t\tipBan = matchedPattern >= 2;\r\n \t\treturn true;\r\n \t}\r\n \t\r\n+\t@SuppressWarnings(\"null\")\r\n \t@Override\r\n \tprotected void execute(final Event e) {\r\n \t\tfinal String reason = this.reason != null ? this.reason.getSingle(e) : null; // don't check for null, just ignore an invalid reason\r\n-\t\tfinal Date expires = null;\r\n+\t\tTimespan ts = this.expires != null ? this.expires.getSingle(e) : null;\r\n+\t\tfinal Date expires = ts != null ? new Date(System.currentTimeMillis() + ts.getMilliSeconds()) : null;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7545b4f071bf62eeb0af5f363a8ed3a66914132c"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3911d0e79874b913681be8afad3d902fa260efae", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/3911d0e79874b913681be8afad3d902fa260efae", "committedDate": "2020-01-10T03:29:57Z", "message": "EffBan - prevent perma banning if timespan = null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7e9148dc84f9471e995986c1bd116f7b70f351e", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/f7e9148dc84f9471e995986c1bd116f7b70f351e", "committedDate": "2020-01-10T22:30:45Z", "message": "EffBan - removed error message, revert back to perm ban if timespan = null, updated description to let users know of this"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNTI3Mjc3", "url": "https://github.com/SkriptLang/Skript/pull/2741#pullrequestreview-341527277", "createdAt": "2020-01-11T15:24:58Z", "commit": {"oid": "f7e9148dc84f9471e995986c1bd116f7b70f351e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3121, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}