{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NTQ0NDQ3", "number": 2782, "title": "Explosive Entity Yield Expressions", "bodyText": "Description\nThis PR is the same as #2776 but for the other explosive entities and for the explosion prime event. Right now, the syntax will conflict with that PR so we will need to decide what to do about that.\n\nTarget Minecraft Versions:     Any\nRequirements:     None\nRelated Issues:     None", "createdAt": "2020-01-19T15:13:40Z", "url": "https://github.com/SkriptLang/Skript/pull/2782", "merged": true, "mergeCommit": {"oid": "e0477a503694eb53ec7434bd59ccdb4f6cd5b62c"}, "closed": true, "closedAt": "2020-07-20T20:00:15Z", "author": {"login": "APickledWalrus"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb75b2QAH2gAyMzY0NTQ0NDQ3OmQ2ZGJlMmY5NmVjYTg5Njg5NjA4MThhZmYyYTAyMzA1MWYwMTFkZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc23KaugH2gAyMzY0NTQ0NDQ3OjMxNzYwM2YxYjM5OWY5ODBlY2VmN2E3YWJjYTA3ZGM4YTYxZTg1N2M=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d6dbe2f96eca8968960818aff2a023051f011dfc", "author": {"user": {"login": "APickledWalrus", "name": null}}, "url": "https://github.com/SkriptLang/Skript/commit/d6dbe2f96eca8968960818aff2a023051f011dfc", "committedDate": "2020-01-19T15:11:28Z", "message": "Add expressions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc5a7047ec5bd5d419935296174b3ae76dfb6b49", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/bc5a7047ec5bd5d419935296174b3ae76dfb6b49", "committedDate": "2020-03-05T05:55:41Z", "message": "Merge branch 'master' into APickledWalrus-expr-explosiveyield"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwOTk2NTU5", "url": "https://github.com/SkriptLang/Skript/pull/2782#pullrequestreview-370996559", "createdAt": "2020-03-09T08:56:45Z", "commit": {"oid": "bc5a7047ec5bd5d419935296174b3ae76dfb6b49"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwODo1Njo0NVrOFze7bg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwOTowNTo1NVrOFzfLvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTUyODQzMA==", "bodyText": "Since this expression is only usable within the explosion prime event, my suggestion would be to add an event to the example, just to showcase proper usage and cut down on confusion.", "url": "https://github.com/SkriptLang/Skript/pull/2782#discussion_r389528430", "createdAt": "2020-03-09T08:56:45Z", "author": {"login": "ShaneBeee"}, "path": "src/main/java/ch/njol/skript/expressions/ExprExplosionPrimeEventYield.java", "diffHunk": "@@ -0,0 +1,119 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.event.Event;\n+import org.bukkit.event.entity.ExplosionPrimeEvent;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.ScriptLoader;\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Events;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.ExpressionType;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.lang.util.SimpleExpression;\n+import ch.njol.skript.log.ErrorQuality;\n+import ch.njol.util.Kleenean;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Explosion Prime Event Explosion Yield\")\n+@Description(\"The yield/radius of the explosion in an explosion prime event.\")\n+@Events(\"explosion prime\")\n+@Examples(\"set the explosion radius to 10\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc5a7047ec5bd5d419935296174b3ae76dfb6b49"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTUzMjYwNg==", "bodyText": "Correct me if I'm wrong, but since this is a void method, I don't think this is needed here.", "url": "https://github.com/SkriptLang/Skript/pull/2782#discussion_r389532606", "createdAt": "2020-03-09T09:05:55Z", "author": {"login": "ShaneBeee"}, "path": "src/main/java/ch/njol/skript/expressions/ExprExplosionPrimeEventYield.java", "diffHunk": "@@ -0,0 +1,119 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.event.Event;\n+import org.bukkit.event.entity.ExplosionPrimeEvent;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.ScriptLoader;\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Events;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.ExpressionType;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.lang.util.SimpleExpression;\n+import ch.njol.skript.log.ErrorQuality;\n+import ch.njol.util.Kleenean;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Explosion Prime Event Explosion Yield\")\n+@Description(\"The yield/radius of the explosion in an explosion prime event.\")\n+@Events(\"explosion prime\")\n+@Examples(\"set the explosion radius to 10\")\n+@Since(\"INSERT VERSION\")\n+public class ExprExplosionPrimeEventYield extends SimpleExpression<Number> {\n+\n+\tstatic {\n+\t\tSkript.registerExpression(ExprExplosionPrimeEventYield.class, Number.class, ExpressionType.PROPERTY, \"[the] explosion (radius|size|yield)\");\n+\t}\n+\n+\t@Override\n+\tpublic boolean init(Expression<?>[] exprs, int matchedPattern, Kleenean isDelayed, ParseResult parseResult) {\n+\t\tif (!ScriptLoader.isCurrentEvent(ExplosionPrimeEvent.class)) {\n+\t\t\tSkript.error(\"The explosion radius is only usable in explosion prime events\", ErrorQuality.SEMANTIC_ERROR);\n+\t\t\treturn false;\n+\t\t}\n+\t\treturn true;\n+\t}\n+\n+\t@Override\n+\t@Nullable\n+\tprotected Number[] get(Event e) {\n+\t\treturn CollectionUtils.array(((ExplosionPrimeEvent) e).getRadius());\n+\t}\n+\n+\t@Override\n+\t@Nullable\n+\tpublic Class<?>[] acceptChange(final ChangeMode mode) {\n+\t\tif (mode == ChangeMode.REMOVE_ALL || mode == ChangeMode.RESET)\n+\t\t\treturn null;\n+\t\treturn CollectionUtils.array(Number.class);\n+\t}\n+\n+\t@Override\n+\tpublic void change(final Event event, final @Nullable Object[] delta, final ChangeMode mode) {\n+\t\tfloat f = delta == null ? 0 : ((Number) delta[0]).floatValue();\n+\t\tExplosionPrimeEvent e = (ExplosionPrimeEvent) event;\n+\t\tswitch (mode) {\n+\t\t\tcase SET:\n+\t\t\t\te.setRadius(f);\n+\t\t\t\tbreak;\n+\t\t\tcase ADD:\n+\t\t\t\tfloat add = e.getRadius() + f;\n+\t\t\t\tif (add < 0) add = 0;\n+\t\t\t\te.setRadius(add);\n+\t\t\t\tbreak;\n+\t\t\tcase REMOVE:\n+\t\t\t\tfloat subtract = e.getRadius() - f;\n+\t\t\t\tif (subtract < 0) subtract = 0;\n+\t\t\t\te.setRadius(subtract);\n+\t\t\t\tbreak;\n+\t\t\tcase DELETE:\n+\t\t\t\te.setRadius(0);\n+\t\t\t\tbreak;\n+\t\t\tcase REMOVE_ALL:\n+\t\t\t\tassert false;\n+\t\t\tcase RESET:\n+\t\t\t\tassert false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc5a7047ec5bd5d419935296174b3ae76dfb6b49"}, "originalPosition": 100}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49cb4dc560dc2d8a0228719d110f5ac83c6a945a", "author": {"user": {"login": "APickledWalrus", "name": null}}, "url": "https://github.com/SkriptLang/Skript/commit/49cb4dc560dc2d8a0228719d110f5ac83c6a945a", "committedDate": "2020-03-22T23:58:05Z", "message": "Creeper Support / Suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5OTY4MTgx", "url": "https://github.com/SkriptLang/Skript/pull/2782#pullrequestreview-389968181", "createdAt": "2020-04-08T13:22:34Z", "commit": {"oid": "49cb4dc560dc2d8a0228719d110f5ac83c6a945a"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMzoyMjozNFrOGCu_ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMzoyMjozNFrOGCu_ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUyMDI4Ng==", "bodyText": "wouldn't delta be null if it's delete? did you test that", "url": "https://github.com/SkriptLang/Skript/pull/2782#discussion_r405520286", "createdAt": "2020-04-08T13:22:34Z", "author": {"login": "Pikachu920"}, "path": "src/main/java/ch/njol/skript/expressions/ExprExplosiveEntityYield.java", "diffHunk": "@@ -0,0 +1,136 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.entity.Creeper;\n+import org.bukkit.entity.Entity;\n+import org.bukkit.entity.Explosive;\n+import org.bukkit.event.Event;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.RequiredPlugins;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Explosive Entity Explosion Yield\")\n+@Description(\"The yield/radius of an explosive (creeper, primed tnt, fireball, etc.). This is how big of an explosion is caused by the entity.\")\n+@Examples(\"set the explosive radius of the event-entity to 10\")\n+@RequiredPlugins(\"Minecraft 1.12 or newer for creepers\")\n+@Since(\"INSERT VERSION\")\n+public class ExprExplosiveEntityYield extends SimplePropertyExpression<Entity, Number> {\n+\n+\tstatic {\n+\t\tregister(ExprExplosiveEntityYield.class, Number.class, \"explosi(ve|on) (radius|size|yield)\", \"entities\");\n+\t}\n+\n+\tprivate final boolean creeperUsable = Skript.methodExists(Creeper.class, \"getExplosionRadius\");\n+\n+\t@Override\n+\tpublic Number convert(Entity e) {\n+\t\tif (e instanceof Explosive)\n+\t\t\treturn ((Explosive) e).getYield();\n+\t\tif (e instanceof Creeper && creeperUsable)\n+\t\t\treturn ((Creeper) e).getExplosionRadius();\n+\t\treturn 0;\n+\t}\n+\n+\t@Override\n+\t@Nullable\n+\tpublic Class<?>[] acceptChange(final ChangeMode mode) {\n+\t\tif (mode == ChangeMode.REMOVE_ALL || mode == ChangeMode.RESET)\n+\t\t\treturn null;\n+\t\treturn CollectionUtils.array(Number.class);\n+\t}\n+\n+\t@Override\n+\tpublic void change(final Event event, final @Nullable Object[] delta, final ChangeMode mode) {\n+\t\tif (delta == null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49cb4dc560dc2d8a0228719d110f5ac83c6a945a"}, "originalPosition": 71}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9108c81c9e2af131fb47ce83187550fa14a7e71", "author": {"user": {"login": "APickledWalrus", "name": null}}, "url": "https://github.com/SkriptLang/Skript/commit/c9108c81c9e2af131fb47ce83187550fa14a7e71", "committedDate": "2020-04-27T11:59:57Z", "message": "Make Requested Changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a777b21322d5a64f30021801ce9b75f9cfdb6cf8", "author": {"user": {"login": "APickledWalrus", "name": null}}, "url": "https://github.com/SkriptLang/Skript/commit/a777b21322d5a64f30021801ce9b75f9cfdb6cf8", "committedDate": "2020-04-27T12:00:12Z", "message": "Merge branch 'master' into APickledWalrus-expr-explosiveyield"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff496a9ed5905881a9b6b52ba820c912dbec5522", "author": {"user": {"login": "APickledWalrus", "name": null}}, "url": "https://github.com/SkriptLang/Skript/commit/ff496a9ed5905881a9b6b52ba820c912dbec5522", "committedDate": "2020-07-19T18:53:43Z", "message": "Cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "326f183f835fc195d3a50a1cdc7f8266cf20d828", "author": {"user": {"login": "APickledWalrus", "name": null}}, "url": "https://github.com/SkriptLang/Skript/commit/326f183f835fc195d3a50a1cdc7f8266cf20d828", "committedDate": "2020-07-19T20:07:03Z", "message": "Rename element files and update formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxOTEyOTA3", "url": "https://github.com/SkriptLang/Skript/pull/2782#pullrequestreview-451912907", "createdAt": "2020-07-20T19:54:04Z", "commit": {"oid": "326f183f835fc195d3a50a1cdc7f8266cf20d828"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "317603f1b399f980ecef7a7abca07dc8a61e857c", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/317603f1b399f980ecef7a7abca07dc8a61e857c", "committedDate": "2020-07-20T19:54:09Z", "message": "Merge branch 'master' into APickledWalrus-expr-explosiveyield"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3143, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}