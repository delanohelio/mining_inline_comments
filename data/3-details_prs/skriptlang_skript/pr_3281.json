{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0Mjc2Nzk5", "number": 3281, "title": "Fix setting item amount of slots", "bodyText": "Description\nThis PR aims to fix an issue with setting item amounts of slots,\nie: set item amount of player's tool to 10\nAlso, to make things cleaner, added get/set amount methods to Slot\n\nTarget Minecraft Versions: none\nRequirements: none\nRelated Issues: #2707", "createdAt": "2020-08-06T21:38:27Z", "url": "https://github.com/SkriptLang/Skript/pull/3281", "merged": true, "mergeCommit": {"oid": "8bf2770ffa0827785d3a76fb738f2cf4f804a63d"}, "closed": true, "closedAt": "2020-08-09T07:06:06Z", "author": {"login": "ShaneBeee"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7NgC_gH2gAyNDY0Mjc2Nzk5OjA1YmU5MDY2ODZkMGY3NDJhM2ViNjU3MGRhNTY1YzkzNWE4YjRhMzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8wGYUgFqTQ2MzcxMjg4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "05be906686d0f742a3eb6570da565c935a8b4a37", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/05be906686d0f742a3eb6570da565c935a8b4a37", "committedDate": "2020-08-03T08:11:23Z", "message": "Introducing block state modification"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ea350b47773ff6ebaf48bf6a3c44833778e7838", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/2ea350b47773ff6ebaf48bf6a3c44833778e7838", "committedDate": "2020-08-03T08:24:46Z", "message": "Revert \"Introducing block state modification\"\n\nThis reverts commit 05be9066"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29a0869b3b6553fc1043066413d30c2ffe486916", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/29a0869b3b6553fc1043066413d30c2ffe486916", "committedDate": "2020-08-06T18:58:31Z", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23785c76083b6eca9c26a3c9cd0d7674def09aa8", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/23785c76083b6eca9c26a3c9cd0d7674def09aa8", "committedDate": "2020-08-06T20:48:52Z", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7214afcc167507530f1c281db2de13fcf20054b8", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/7214afcc167507530f1c281db2de13fcf20054b8", "committedDate": "2020-08-06T21:33:03Z", "message": "Slot - add methods to get/set amount"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c38b485890abfc34c98e8a912ae57dd0faf5dfe3", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/c38b485890abfc34c98e8a912ae57dd0faf5dfe3", "committedDate": "2020-08-06T21:33:35Z", "message": "ExprItemAmount - add \"slot\" as an option to get/set item amount for slots"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0184696b1041a5667e353939200ee3b68b52908", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/f0184696b1041a5667e353939200ee3b68b52908", "committedDate": "2020-08-06T21:34:29Z", "message": "InventorySlot - revert line endings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTY3MzI4", "url": "https://github.com/SkriptLang/Skript/pull/3281#pullrequestreview-462967328", "createdAt": "2020-08-07T00:49:28Z", "commit": {"oid": "f0184696b1041a5667e353939200ee3b68b52908"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMDo0OToyOVrOG9Iz_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMDo1MzozOFrOG9I3_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MDcwMw==", "bodyText": "Considering the behaviour of the item amount syntax, shouldn't this properly set the item's amount?", "url": "https://github.com/SkriptLang/Skript/pull/3281#discussion_r466760703", "createdAt": "2020-08-07T00:49:29Z", "author": {"login": "FranKusmiruk"}, "path": "src/main/java/ch/njol/skript/util/slot/ItemFrameSlot.java", "diffHunk": "@@ -48,6 +48,14 @@ public void setItem(@Nullable ItemStack item) {\n \t\tframe.setItem(item);\n \t}\n \t\n+\t@Override\n+\tpublic int getAmount() {\n+\t\treturn 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0184696b1041a5667e353939200ee3b68b52908"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MDc2Ng==", "bodyText": "Is updating the inventory needed?", "url": "https://github.com/SkriptLang/Skript/pull/3281#discussion_r466760766", "createdAt": "2020-08-07T00:49:46Z", "author": {"login": "FranKusmiruk"}, "path": "src/main/java/ch/njol/skript/util/slot/EquipmentSlot.java", "diffHunk": "@@ -185,6 +185,21 @@ public void setItem(final @Nullable ItemStack item) {\n \t\t\tPlayerUtils.updateInventory((Player) e.getHolder());\n \t}\n \t\n+\t@Override\n+\tpublic int getAmount() {\n+\t\tItemStack item = slot.get(e);\n+\t\treturn item != null ? item.getAmount() : 0;\n+\t}\n+\t\n+\t@Override\n+\tpublic void setAmount(int amount) {\n+\t\tItemStack item = slot.get(e);\n+\t\tif (item != null)\n+\t\t\titem.setAmount(amount);\n+\t\tif (e.getHolder() instanceof Player)\n+\t\t\tPlayerUtils.updateInventory((Player) e.getHolder());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0184696b1041a5667e353939200ee3b68b52908"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc2MTcyNA==", "bodyText": "Does this actually set the amount of the ItemStack? Bukkit has this habit of passing a clone of the original object instead of the reference to keep immutability, kinda stupid but it's done practically everywhere so just making sure.", "url": "https://github.com/SkriptLang/Skript/pull/3281#discussion_r466761724", "createdAt": "2020-08-07T00:53:38Z", "author": {"login": "FranKusmiruk"}, "path": "src/main/java/ch/njol/skript/util/slot/DroppedItemSlot.java", "diffHunk": "@@ -48,7 +48,17 @@ public void setItem(@Nullable ItemStack item) {\n \t\tassert item != null;\n \t\tentity.setItemStack(item);\n \t}\n-\n+\t\n+\t@Override\n+\tpublic int getAmount() {\n+\t\treturn entity.getItemStack().getAmount();\n+\t}\n+\t\n+\t@Override\n+\tpublic void setAmount(int amount) {\n+\t\tentity.getItemStack().setAmount(amount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0184696b1041a5667e353939200ee3b68b52908"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e24335b50e1ef17193cd0a82592756b1716679c8", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/e24335b50e1ef17193cd0a82592756b1716679c8", "committedDate": "2020-08-07T01:02:56Z", "message": "EquipmentSlot - remove unneeded inventory update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45681b4d675efbe9a81110a316be99fbb3bdd1f6", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/45681b4d675efbe9a81110a316be99fbb3bdd1f6", "committedDate": "2020-08-07T01:03:26Z", "message": "Merge branch 'master' into fix/item-amount-in-slots"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTc0NDk0", "url": "https://github.com/SkriptLang/Skript/pull/3281#pullrequestreview-462974494", "createdAt": "2020-08-07T01:14:40Z", "commit": {"oid": "45681b4d675efbe9a81110a316be99fbb3bdd1f6"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79485333753eea53dbe8e43221694a49862757cd", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/79485333753eea53dbe8e43221694a49862757cd", "committedDate": "2020-08-07T01:38:57Z", "message": "EquipmentSlot - set the item again (with entities, the item amount was not updating)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96845569f9a392f8c5f5182ee4d23f623e311c37", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/96845569f9a392f8c5f5182ee4d23f623e311c37", "committedDate": "2020-08-07T01:39:06Z", "message": "add regression test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "454cd6d0b8d68755414964220343ef668fb4073c", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/454cd6d0b8d68755414964220343ef668fb4073c", "committedDate": "2020-08-07T01:39:34Z", "message": "Merge remote-tracking branch 'origin/fix/item-amount-in-slots' into fix/item-amount-in-slots"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c8acb1f9ea1d382ce3a3d13c678f0b8936746c3", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/2c8acb1f9ea1d382ce3a3d13c678f0b8936746c3", "committedDate": "2020-08-07T01:45:00Z", "message": "Merge branch 'master' into fix/item-amount-in-slots"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNzA2Nzg0", "url": "https://github.com/SkriptLang/Skript/pull/3281#pullrequestreview-463706784", "createdAt": "2020-08-08T01:32:40Z", "commit": {"oid": "2c8acb1f9ea1d382ce3a3d13c678f0b8936746c3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwMTozMjo0MFrOG9sfAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwMTozMjo0MFrOG9sfAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0NTE1Mg==", "bodyText": "Don't think we need an else here right? Actually you could probably just use a ternary for this", "url": "https://github.com/SkriptLang/Skript/pull/3281#discussion_r467345152", "createdAt": "2020-08-08T01:32:40Z", "author": {"login": "Wealthyturtle"}, "path": "src/main/java/ch/njol/skript/expressions/ExprItemAmount.java", "diffHunk": "@@ -57,8 +56,11 @@ protected String getPropertyName() {\n \t}\n \t\n \t@Override\n-\tpublic Number convert(final ItemType item) {\n-\t\treturn item.getAmount();\n+\tpublic Number convert(final Object item) {\n+    \tif (item instanceof ItemType)\n+    \t\treturn ((ItemType) item).getAmount();\n+    \telse", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c8acb1f9ea1d382ce3a3d13c678f0b8936746c3"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd82a34218ac2b904858a012023edd4e02b1845a", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/cd82a34218ac2b904858a012023edd4e02b1845a", "committedDate": "2020-08-08T02:34:45Z", "message": "ExprItemAmount - shorter return line"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNzEyNzI1", "url": "https://github.com/SkriptLang/Skript/pull/3281#pullrequestreview-463712725", "createdAt": "2020-08-08T03:01:06Z", "commit": {"oid": "cd82a34218ac2b904858a012023edd4e02b1845a"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNzEyODgz", "url": "https://github.com/SkriptLang/Skript/pull/3281#pullrequestreview-463712883", "createdAt": "2020-08-08T03:03:57Z", "commit": {"oid": "cd82a34218ac2b904858a012023edd4e02b1845a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2965, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}