{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyMjA3Mjc2", "number": 3270, "title": "Implement 'decimals between' in ExprNumbers", "bodyText": "Description\nThis PR implements the 'decimals between' syntax discussed in #2608 and suggested in #2601\nDetails:\n\nThe increment is decided by the numeric precision of the first number. If it is above the number accuracy defined in config.sk, the configuration option will be used instead. (That is, it selects the minimum between the numeric precision of start and the number accuracy of the configuration)\nThe changes are non-breaking, as both integers between and numbers between still return the same results (although the implementation is changed to give space for decimals between.\nThe changes were only tested on git-Paper-130 of MC 1.16.1, but they shouldn't be version-specific.\ni read the code conventions pls no ban\n\n\nTarget Minecraft Versions: any\nRelated Issues: #2608, #2601", "createdAt": "2020-08-03T14:20:54Z", "url": "https://github.com/SkriptLang/Skript/pull/3270", "merged": true, "mergeCommit": {"oid": "c96b42c2713fc3f0bd936b046bc0277ff80d1ada"}, "closed": true, "closedAt": "2020-10-05T07:08:32Z", "author": {"login": "bluelhf"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7R8BzAH2gAyNDYyMjA3Mjc2OjUyY2Y1MzgwNTY1NzZmMDkxOTA3NzM4MWRmZjVmN2M3NDc4YjgxY2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPeVydgFqTUwMTc2OTA0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "52cf538056576f0919077381dff5f7c7478b81cb", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/52cf538056576f0919077381dff5f7c7478b81cb", "committedDate": "2020-08-03T13:21:34Z", "message": "Add decimals between to ExprNumbers.java\n\nAdds a 'decimals between' mode to the numbers expression"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f8ecd3ebc7370392318c4c782b8071c9f90f26e", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/1f8ecd3ebc7370392318c4c782b8071c9f90f26e", "committedDate": "2020-08-03T14:03:36Z", "message": "Update 'decimals between'\n\nSome fixes to decimals between, tested on git-Paper-130 (1.16.1)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a24fbe93deae3b3a6812f82561af270cba65be1", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/9a24fbe93deae3b3a6812f82561af270cba65be1", "committedDate": "2020-08-03T14:11:46Z", "message": "Update ExprNumbers to follow code conventions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "785093819f413a7657e8a82738ed698ac693de1d", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/785093819f413a7657e8a82738ed698ac693de1d", "committedDate": "2020-08-03T14:28:39Z", "message": "Oops, forgot a semicolon"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5749b81f08313d573eac15956e2d012085fcc78", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/f5749b81f08313d573eac15956e2d012085fcc78", "committedDate": "2020-08-03T18:47:01Z", "message": "Merge branch 'master' into bluelhf-numbers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "639b645136ac06c653c982db135687336c75555c", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/639b645136ac06c653c982db135687336c75555c", "committedDate": "2020-08-04T21:00:50Z", "message": "Merge branch 'master' into bluelhf-numbers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5745bf8da6684523a628b9641460ea7b6e999bc", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/c5745bf8da6684523a628b9641460ea7b6e999bc", "committedDate": "2020-08-10T21:35:03Z", "message": "Merge branch 'master' into bluelhf-numbers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f42b9212de6b9133c2096fa6f2f05b27937f7269", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/f42b9212de6b9133c2096fa6f2f05b27937f7269", "committedDate": "2020-08-15T15:24:15Z", "message": "Merge branch 'master' into bluelhf-numbers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60729a8d1bbb3e1ab4a34b931bf8850ab1669bb3", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/60729a8d1bbb3e1ab4a34b931bf8850ab1669bb3", "committedDate": "2020-08-15T21:00:47Z", "message": "Merge branch 'master' into bluelhf-numbers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/0fd8e4f556c5068aebc614e597713d6533779f35", "committedDate": "2020-09-02T18:27:09Z", "message": "Merge branch 'master' into bluelhf-numbers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDE5ODc3", "url": "https://github.com/SkriptLang/Skript/pull/3270#pullrequestreview-497019877", "createdAt": "2020-09-26T17:35:12Z", "commit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozNToxMlrOHYhmvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozODowMVrOHYhnnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODQ2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tint mode = -1;\n          \n          \n            \n            \tprivate int mode;", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495478461", "createdAt": "2020-09-26T17:35:12Z", "author": {"login": "APickledWalrus"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -45,26 +46,28 @@\n @Name(\"Numbers\")\r\n @Description({\"All numbers between two given numbers, useful for looping.\",\r\n \t\t\"Use 'numbers' if your start is not an integer and you want to keep the fractional part of the start number constant, or use 'integers' if you only want to loop integers.\",\r\n+\t\t\"You may also use 'decimals' if you want to use the decimal precision of the start number.\",\r\n \t\t\"You may want to use the 'times' expression instead, for instance 'loop 5 times:'\"})\r\n @Examples({\"loop numbers from 2.5 to 5.5: # loops 2.5, 3.5, 4.5, 5.5\",\r\n-\t\t\"loop integers from 2.9 to 5.1: # same as '3 to 5', i.e. loops 3, 4, 5\"})\r\n-@Since(\"1.4.6\")\r\n+\t\t\"loop integers from 2.9 to 5.1: # same as '3 to 5', i.e. loops 3, 4, 5\",\r\n+\t\t\"loop decimals from 3.94 to 4: # loops 3.94, 3.95, 3.96, 3.97, 3.98, 3.99, 4\"})\r\n+@Since(\"1.4.6 (integers & numbers), INSERT VERSION (decimals)\")\r\n public class ExprNumbers extends SimpleExpression<Number> {\r\n \tstatic {\r\n \t\tSkript.registerExpression(ExprNumbers.class, Number.class, ExpressionType.COMBINED,\r\n-\t\t\t\t\"[(all [[of] the]|the)] (numbers|1\u00a6integers) (between|from) %number% (and|to) %number%\");\r\n+\t\t\t\t\"[(all [[of] the]|the)] (numbers|1\u00a6integers|2\u00a6decimals) (between|from) %number% (and|to) %number%\");\r\n \t}\r\n \t\r\n \t@SuppressWarnings(\"null\")\r\n \tprivate Expression<Number> start, end;\r\n-\tboolean integer;\r\n+\tint mode = -1;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODUyOQ==", "bodyText": "Suggested change", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495478529", "createdAt": "2020-09-26T17:36:03Z", "author": {"login": "APickledWalrus"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -106,34 +127,63 @@ public boolean init(final Expression<?>[] exprs, final int matchedPattern, final\n \t\t\tf = temp;\r\n \t\t}\r\n \t\tfinal Number starting = s, finish = f;\r\n-\t\treturn new Iterator<Number>() {\r\n-\t\t\tdouble i = integer ? Math.ceil(starting.doubleValue()) : starting.doubleValue(), max = integer ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n-\t\t\t\r\n-\t\t\t@Override\r\n-\t\t\tpublic boolean hasNext() {\r\n-\t\t\t\treturn i <= max;\r\n-\t\t\t}\r\n+\t\tif (mode < 2) {\r\n+\t\t\treturn new Iterator<Number>() {\r\n+\t\t\t\tdouble i = mode == 1 ? Math.ceil(starting.doubleValue()) : starting.doubleValue();\r\n+\t\t\t\tdouble max = mode == 1 ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n+\t\t\t\t\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODYzMg==", "bodyText": "Small nitpick \ud83d\ude05\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t}\n          \n          \n            \n            \t}", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495478632", "createdAt": "2020-09-26T17:37:29Z", "author": {"login": "APickledWalrus"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -143,6 +193,6 @@ public boolean isSingle() {\n \t\r\n \t@Override\r\n \tpublic Class<? extends Number> getReturnType() {\r\n-\t\treturn integer ? Long.class : Double.class;\r\n+\t\treturn mode == 1 ? Long.class : Double.class;\r\n \t}\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODY4NQ==", "bodyText": "Not that this is on you, but since you're already editing this expression can you move toString to the bottom of the file?", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495478685", "createdAt": "2020-09-26T17:38:01Z", "author": {"login": "APickledWalrus"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -106,34 +127,63 @@ public boolean init(final Expression<?>[] exprs, final int matchedPattern, final\n \t\t\tf = temp;\r\n \t\t}\r\n \t\tfinal Number starting = s, finish = f;\r\n-\t\treturn new Iterator<Number>() {\r\n-\t\t\tdouble i = integer ? Math.ceil(starting.doubleValue()) : starting.doubleValue(), max = integer ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n-\t\t\t\r\n-\t\t\t@Override\r\n-\t\t\tpublic boolean hasNext() {\r\n-\t\t\t\treturn i <= max;\r\n-\t\t\t}\r\n+\t\tif (mode < 2) {\r\n+\t\t\treturn new Iterator<Number>() {\r\n+\t\t\t\tdouble i = mode == 1 ? Math.ceil(starting.doubleValue()) : starting.doubleValue();\r\n+\t\t\t\tdouble max = mode == 1 ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n+\t\t\t\t\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic boolean hasNext() {\r\n+\t\t\t\t\treturn i <= max;\r\n+\t\t\t\t}\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic Number next() {\r\n+\t\t\t\t\tif (!hasNext())\r\n+\t\t\t\t\t\tthrow new NoSuchElementException();\r\n+\t\t\t\t\tif (mode == 1)\r\n+\t\t\t\t\t\treturn (long) (reverse ? max-- : i++);\r\n+\t\t\t\t\telse\r\n+\t\t\t\t\t\treturn reverse ? max-- : i++;\r\n+\t\t\t\t}\r\n+\t\t\t};\r\n+\t\t} else {\r\n+\t\t\treturn new Iterator<Number>() {\r\n+\t\t\t\tfinal double start = starting.doubleValue();\r\n+\t\t\t\tfinal double max = finish.doubleValue();\r\n+\t\t\t\tfinal String[] split = starting.toString().split(\"\\\\.\");\r\n+\t\t\t\tfinal int precision = split.length > 0 ? split[1].length() : 0;\r\n \t\t\t\r\n-\t\t\t@Override\r\n-\t\t\tpublic Number next() {\r\n-\t\t\t\tif (!hasNext())\r\n-\t\t\t\t\tthrow new NoSuchElementException();\r\n-\t\t\t\tif (integer)\r\n-\t\t\t\t\treturn (long) (reverse ? max-- : i++);\r\n-\t\t\t\telse\r\n-\t\t\t\t\treturn reverse ? max-- : i++;\r\n-\t\t\t}\r\n-\t\t};\r\n+\t\t\t\tfinal double multiplier = Math.pow(10, precision);\r\n+\t\t\t\tint current = reverse ? (int) (max * multiplier - 1) : (int) (start * multiplier);\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic boolean hasNext() {\r\n+\t\t\t\t\treturn reverse ? current > start : current < max * multiplier;\r\n+\t\t\t\t}\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic Number next() {\r\n+\t\t\t\t\tif (!hasNext())\r\n+\t\t\t\t\t\tthrow new NoSuchElementException();\r\n+\t\t\t\t\tdouble value = start + current / multiplier;\r\n+\t\t\t\t\tcurrent = reverse ? current - 1 : current + 1;\r\n+\t\t\t\t\treturn value;\r\n+\t\t\t\t}\r\n+\t\t\t};\r\n+\t\t}\r\n \t}\r\n \t\r\n \t@Override\r\n \tpublic String toString(final @Nullable Event e, final boolean debug) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 152}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89cc13fc4f1aabd118264071e47c6fe3078382b9", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/89cc13fc4f1aabd118264071e47c6fe3078382b9", "committedDate": "2020-09-27T14:32:42Z", "message": "Move toString to the end of ExprNumbers.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea6a9eb0a2bf7d895e3fdf87bcda972c5b4c259f", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/ea6a9eb0a2bf7d895e3fdf87bcda972c5b4c259f", "committedDate": "2020-09-27T14:33:38Z", "message": "Apply suggestions from PickedWalrus' review\n\nCo-authored-by: APickledWalrus <apickledwalrus@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a545986b4bbe3e796e558a390d945727c586feae", "author": {"user": {"login": "bluelhf", "name": "Ilari Suhonen"}}, "url": "https://github.com/SkriptLang/Skript/commit/a545986b4bbe3e796e558a390d945727c586feae", "committedDate": "2020-09-27T14:34:41Z", "message": "Teeny-tiny formatting changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDk5MDI5", "url": "https://github.com/SkriptLang/Skript/pull/3270#pullrequestreview-497099029", "createdAt": "2020-09-27T18:00:32Z", "commit": {"oid": "a545986b4bbe3e796e558a390d945727c586feae"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MTA5MjMx", "url": "https://github.com/SkriptLang/Skript/pull/3270#pullrequestreview-497109231", "createdAt": "2020-09-27T20:36:39Z", "commit": {"oid": "a545986b4bbe3e796e558a390d945727c586feae"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e2a7de053e60c94e456ddc5d26a9b5bab1842ff", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/0e2a7de053e60c94e456ddc5d26a9b5bab1842ff", "committedDate": "2020-10-05T06:56:55Z", "message": "ExprNumbers - update license header and line endings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fd9011752699f82535267cc4a7c05329131639f", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/2fd9011752699f82535267cc4a7c05329131639f", "committedDate": "2020-10-05T07:01:21Z", "message": "ExprNumbers - remove extra line in header"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae77745809e73903a3953bfa3f385ac543f51ef5", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/ae77745809e73903a3953bfa3f385ac543f51ef5", "committedDate": "2020-10-05T07:02:48Z", "message": "Merge remote-tracking branch 'upstream/dev-2.5' into bluelhf-numbers\n\n# Conflicts:\n#\tsrc/main/java/ch/njol/skript/expressions/ExprNumbers.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5adf8665c6756e6aa23cca2b11096eb39693ea27", "author": {"user": {"login": "ShaneBeee", "name": "Shane Bee"}}, "url": "https://github.com/SkriptLang/Skript/commit/5adf8665c6756e6aa23cca2b11096eb39693ea27", "committedDate": "2020-10-05T07:03:21Z", "message": "Merge branch 'dev-2.5' into bluelhf-numbers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNzY5MDQx", "url": "https://github.com/SkriptLang/Skript/pull/3270#pullrequestreview-501769041", "createdAt": "2020-10-05T07:07:03Z", "commit": {"oid": "5adf8665c6756e6aa23cca2b11096eb39693ea27"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2963, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}