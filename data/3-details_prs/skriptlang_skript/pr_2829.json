{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4NjcyMDI0", "number": 2829, "title": "Fix the infamous #1415 issue (Default Expressions)", "bodyText": "Description\nFixes the ancient bug where sending a message without a defined command sender in a damage event would not yield an error message, I also did some code cleaning, micro performance boosts, and improved how event values are found/grabbed.\nTarget Minecraft Versions: any\nRelated Issues: #1415 #2218 probably fixed some other issues too with default expressions.\nAdditional information: Two things, 1.) another way of fixing this could be adding an after and before state of another event value, similar to ClassInfos, this pull has fixed the solution though. 2.) I posted a comment on the original issue explaining how this bug happens in details.\nNo issues found in testing, everything works again. Here is a script explaining in sudo code what didn't work before this fix.\non damage of player:\n\tmessage \"1\" # sends to no one.\n\tmessage \"2\" to event-player # errors properly\n\tmessage \"3\" to victim # sends to victim fine.\n\tattacker is set\n\tmessage \"4\" to attacker # sends to attacker fine.\n\nThis fix makes it so the first message effect errors again.", "createdAt": "2020-02-23T07:11:46Z", "url": "https://github.com/SkriptLang/Skript/pull/2829", "merged": true, "mergeCommit": {"oid": "2cadc1633884fa47b7e1c5bdd78b54021f999a46"}, "closed": true, "closedAt": "2020-07-15T21:30:02Z", "author": {"login": "TheLimeGlass"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHDZUFgH2gAyMzc4NjcyMDI0OmVlNmRhNmQ3ZGMyYTZlZTIwZTJiMWFiODg2NmQ0NjA3ZTk2NThjYTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1Rh2vAFqTQ0OTM1NzY2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ee6da6d7dc2a6ee20e2b1ab8866d4607e9658ca8", "author": {"user": {"login": "TheLimeGlass", "name": "LimeGlass"}}, "url": "https://github.com/SkriptLang/Skript/commit/ee6da6d7dc2a6ee20e2b1ab8866d4607e9658ca8", "committedDate": "2020-02-23T07:00:55Z", "message": "Fix #1415 and prevent future event-value conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9572730926e26679611d3048a7fed9ef6e34e07c", "author": {"user": {"login": "TheLimeGlass", "name": "LimeGlass"}}, "url": "https://github.com/SkriptLang/Skript/commit/9572730926e26679611d3048a7fed9ef6e34e07c", "committedDate": "2020-02-23T07:03:01Z", "message": "Remove debug message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMTEyNDc0", "url": "https://github.com/SkriptLang/Skript/pull/2829#pullrequestreview-363112474", "createdAt": "2020-02-23T18:09:17Z", "commit": {"oid": "9572730926e26679611d3048a7fed9ef6e34e07c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QxODowOToxN1rOFtSDIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QxODowOToxN1rOFtSDIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAyNTk1Mg==", "bodyText": "Did you mean to do this?", "url": "https://github.com/SkriptLang/Skript/pull/2829#discussion_r383025952", "createdAt": "2020-02-23T18:09:17Z", "author": {"login": "APickledWalrus"}, "path": ".classpath", "diffHunk": "@@ -24,7 +24,6 @@\n \t\t\t<attribute name=\"gradle_used_by_scope\" value=\"test\"/>\n \t\t</attributes>\n \t</classpathentry>\n-\t<classpathentry kind=\"src\" path=\"src/test/skript\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9572730926e26679611d3048a7fed9ef6e34e07c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e86af28919e09a44a40fe14b5ab1543172e40304", "author": {"user": {"login": "TheLimeGlass", "name": "LimeGlass"}}, "url": "https://github.com/SkriptLang/Skript/commit/e86af28919e09a44a40fe14b5ab1543172e40304", "committedDate": "2020-02-24T22:58:35Z", "message": "Revert whatever Eclipse changed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2Nzk0MzE3", "url": "https://github.com/SkriptLang/Skript/pull/2829#pullrequestreview-366794317", "createdAt": "2020-02-29T11:57:21Z", "commit": {"oid": "e86af28919e09a44a40fe14b5ab1543172e40304"}, "state": "DISMISSED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQxMTo1NzoyMVrOFwI_aA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQxMjowNDoyN1rOFwJA9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjAyMzI3Mg==", "bodyText": "Please get rid of Eclipse configuration files for subprojects. They're coming to .gitignore soon, when my PR is merged.", "url": "https://github.com/SkriptLang/Skript/pull/2829#discussion_r386023272", "createdAt": "2020-02-29T11:57:21Z", "author": {"login": "bensku"}, "path": "skript-worldguard6/.classpath", "diffHunk": "@@ -0,0 +1,12 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e86af28919e09a44a40fe14b5ab1543172e40304"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjAyMzM5MQ==", "bodyText": "Don't just suppress heap pollution warnings. It would be better to manually verify that this occasion is safe and add @SafeVarargs to method.", "url": "https://github.com/SkriptLang/Skript/pull/2829#discussion_r386023391", "createdAt": "2020-02-29T12:00:03Z", "author": {"login": "bensku"}, "path": "src/main/java/ch/njol/skript/registrations/EventValues.java", "diffHunk": "@@ -101,22 +96,17 @@ public EventValueInfo(final Class<E> event, final Class<T> c, final Getter<T, E>\n \t * @param time\r\n \t * @param excludes Subclasses of the event for which this event value should not be registered for\r\n \t */\r\n-\tpublic static <T, E extends Event> void registerEventValue(final Class<E> e, final Class<T> c, final Getter<T, E> g, final int time, final @Nullable String excludeErrorMessage, final @Nullable Class<? extends E>... excludes) {\r\n+\tpublic static <T, E extends Event> void registerEventValue(Class<E> e, Class<T> c, Getter<T, E> g, int time, @Nullable String excludeErrorMessage, @SuppressWarnings(\"unchecked\") @Nullable Class<? extends E>... excludes) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e86af28919e09a44a40fe14b5ab1543172e40304"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjAyMzQ4Ng==", "bodyText": "When adding missing Javadoc, please follow code conventions with the formatting.", "url": "https://github.com/SkriptLang/Skript/pull/2829#discussion_r386023486", "createdAt": "2020-02-29T12:01:30Z", "author": {"login": "bensku"}, "path": "src/main/java/ch/njol/skript/registrations/EventValues.java", "diffHunk": "@@ -125,98 +115,123 @@ public EventValueInfo(final Class<E> event, final Class<T> c, final Getter<T, E>\n \t * It is recommended to use {@link EventValues#getEventValueGetter(Class, Class, int)} or {@link EventValueExpression#EventValueExpression(Class)} instead of invoking this\r\n \t * method repeatedly.\r\n \t * \r\n-\t * @param e\r\n-\t * @param c\r\n-\t * @param time\r\n+\t * @param e event\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e86af28919e09a44a40fe14b5ab1543172e40304"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjAyMzUyOA==", "bodyText": "Return type of getter?", "url": "https://github.com/SkriptLang/Skript/pull/2829#discussion_r386023528", "createdAt": "2020-02-29T12:02:16Z", "author": {"login": "bensku"}, "path": "src/main/java/ch/njol/skript/registrations/EventValues.java", "diffHunk": "@@ -125,98 +115,123 @@ public EventValueInfo(final Class<E> event, final Class<T> c, final Getter<T, E>\n \t * It is recommended to use {@link EventValues#getEventValueGetter(Class, Class, int)} or {@link EventValueExpression#EventValueExpression(Class)} instead of invoking this\r\n \t * method repeatedly.\r\n \t * \r\n-\t * @param e\r\n-\t * @param c\r\n-\t * @param time\r\n+\t * @param e event\r\n+\t * @param c type of getter\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e86af28919e09a44a40fe14b5ab1543172e40304"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjAyMzU5MQ==", "bodyText": "Unfortunately, this argument is int. You'll need to provide some hints about acceptable values, otherwise Javadoc is not very useful.", "url": "https://github.com/SkriptLang/Skript/pull/2829#discussion_r386023591", "createdAt": "2020-02-29T12:03:18Z", "author": {"login": "bensku"}, "path": "src/main/java/ch/njol/skript/registrations/EventValues.java", "diffHunk": "@@ -125,98 +115,123 @@ public EventValueInfo(final Class<E> event, final Class<T> c, final Getter<T, E>\n \t * It is recommended to use {@link EventValues#getEventValueGetter(Class, Class, int)} or {@link EventValueExpression#EventValueExpression(Class)} instead of invoking this\r\n \t * method repeatedly.\r\n \t * \r\n-\t * @param e\r\n-\t * @param c\r\n-\t * @param time\r\n+\t * @param e event\r\n+\t * @param c type of getter\r\n+\t * @param time the event-value's time\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e86af28919e09a44a40fe14b5ab1543172e40304"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjAyMzY2OQ==", "bodyText": "Might be grammatical error here, please check. If it is not, please elaborate a bit instead. I'm not sure what this means.", "url": "https://github.com/SkriptLang/Skript/pull/2829#discussion_r386023669", "createdAt": "2020-02-29T12:04:27Z", "author": {"login": "bensku"}, "path": "src/main/java/ch/njol/skript/registrations/EventValues.java", "diffHunk": "@@ -125,98 +115,123 @@ public EventValueInfo(final Class<E> event, final Class<T> c, final Getter<T, E>\n \t * It is recommended to use {@link EventValues#getEventValueGetter(Class, Class, int)} or {@link EventValueExpression#EventValueExpression(Class)} instead of invoking this\r\n \t * method repeatedly.\r\n \t * \r\n-\t * @param e\r\n-\t * @param c\r\n-\t * @param time\r\n+\t * @param e event\r\n+\t * @param c type of getter\r\n+\t * @param time the event-value's time\r\n \t * @return The event's value\r\n \t * @see #registerEventValue(Class, Class, Getter, int)\r\n \t */\r\n \t@Nullable\r\n-\tpublic static <T, E extends Event> T getEventValue(final E e, final Class<T> c, final int time) {\r\n-\t\t@SuppressWarnings({\"null\", \"unchecked\"})\r\n-\t\tfinal Getter<? extends T, ? super E> g = EventValues.getEventValueGetter((Class<E>) e.getClass(), c, time);\r\n-\t\tif (g == null)\r\n+\tpublic static <T, E extends Event> T getEventValue(E e, Class<T> c, int time) {\r\n+\t\t@SuppressWarnings(\"unchecked\")\r\n+\t\tGetter<? extends T, ? super E> getter = getEventValueGetter((Class<E>) e.getClass(), c, time);\r\n+\t\tif (getter == null)\r\n \t\t\treturn null;\r\n-\t\treturn g.get(e);\r\n+\t\treturn getter.get(e);\r\n \t}\r\n \t\r\n \t/**\r\n \t * Returns a getter to get a value from an event.\r\n \t * <p>\r\n \t * Can print an error if the event value is blocked for the given event.\r\n \t * \r\n-\t * @param e\r\n-\t * @param c\r\n-\t * @param time\r\n+\t * @param e event class runtime calling\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e86af28919e09a44a40fe14b5ab1543172e40304"}, "originalPosition": 105}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "176ef56dc5e5de8da56c48af0a4c31c6ee8924a4", "author": {"user": {"login": "TheLimeGlass", "name": "LimeGlass"}}, "url": "https://github.com/SkriptLang/Skript/commit/176ef56dc5e5de8da56c48af0a4c31c6ee8924a4", "committedDate": "2020-06-29T03:36:39Z", "message": "Remove eclipse stuff"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b905c704c1615557cb2d5a10017b2dba10e480df", "author": {"user": {"login": "TheLimeGlass", "name": "LimeGlass"}}, "url": "https://github.com/SkriptLang/Skript/commit/b905c704c1615557cb2d5a10017b2dba10e480df", "committedDate": "2020-06-29T03:47:54Z", "message": "Fix Javadoc changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32864a9efea37ef8794f053bc633b68d81137e44", "author": {"user": {"login": "TheLimeGlass", "name": "LimeGlass"}}, "url": "https://github.com/SkriptLang/Skript/commit/32864a9efea37ef8794f053bc633b68d81137e44", "committedDate": "2020-06-29T03:50:09Z", "message": "Fix Javadoc changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa34f12bf8de479426d1647c8b8eafd92ba31062", "author": {"user": {"login": "TheLimeGlass", "name": "LimeGlass"}}, "url": "https://github.com/SkriptLang/Skript/commit/aa34f12bf8de479426d1647c8b8eafd92ba31062", "committedDate": "2020-06-29T07:09:04Z", "message": "Remove eclipse stuff"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db4bc6c5bb4dba066e0b2dacb4564ef1b434a4bb", "author": {"user": {"login": "FranKusmiruk", "name": "Frank Kusmiruk"}}, "url": "https://github.com/SkriptLang/Skript/commit/db4bc6c5bb4dba066e0b2dacb4564ef1b434a4bb", "committedDate": "2020-06-29T08:05:11Z", "message": "Merge branch 'master' into fix1415"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84e44d0debf8d866cc5a99a4fd0fca4074e8fab6", "author": {"user": {"login": "TheLimeGlass", "name": "LimeGlass"}}, "url": "https://github.com/SkriptLang/Skript/commit/84e44d0debf8d866cc5a99a4fd0fca4074e8fab6", "committedDate": "2020-07-15T20:59:39Z", "message": "Merge branch 'master' into fix1415"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5MzU3NjYz", "url": "https://github.com/SkriptLang/Skript/pull/2829#pullrequestreview-449357663", "createdAt": "2020-07-15T21:29:26Z", "commit": {"oid": "84e44d0debf8d866cc5a99a4fd0fca4074e8fab6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3156, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}