{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyMjA3Mjc2", "number": 3270, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozNToxMlrOEnwzKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozODowMVrOEnwz6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMTI5NDQ5OnYy", "diffSide": "RIGHT", "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozNToxMlrOHYhmvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozNToxMlrOHYhmvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODQ2MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tint mode = -1;\n          \n          \n            \n            \tprivate int mode;", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495478461", "createdAt": "2020-09-26T17:35:12Z", "author": {"login": "APickledWalrus"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -45,26 +46,28 @@\n @Name(\"Numbers\")\r\n @Description({\"All numbers between two given numbers, useful for looping.\",\r\n \t\t\"Use 'numbers' if your start is not an integer and you want to keep the fractional part of the start number constant, or use 'integers' if you only want to loop integers.\",\r\n+\t\t\"You may also use 'decimals' if you want to use the decimal precision of the start number.\",\r\n \t\t\"You may want to use the 'times' expression instead, for instance 'loop 5 times:'\"})\r\n @Examples({\"loop numbers from 2.5 to 5.5: # loops 2.5, 3.5, 4.5, 5.5\",\r\n-\t\t\"loop integers from 2.9 to 5.1: # same as '3 to 5', i.e. loops 3, 4, 5\"})\r\n-@Since(\"1.4.6\")\r\n+\t\t\"loop integers from 2.9 to 5.1: # same as '3 to 5', i.e. loops 3, 4, 5\",\r\n+\t\t\"loop decimals from 3.94 to 4: # loops 3.94, 3.95, 3.96, 3.97, 3.98, 3.99, 4\"})\r\n+@Since(\"1.4.6 (integers & numbers), INSERT VERSION (decimals)\")\r\n public class ExprNumbers extends SimpleExpression<Number> {\r\n \tstatic {\r\n \t\tSkript.registerExpression(ExprNumbers.class, Number.class, ExpressionType.COMBINED,\r\n-\t\t\t\t\"[(all [[of] the]|the)] (numbers|1\u00a6integers) (between|from) %number% (and|to) %number%\");\r\n+\t\t\t\t\"[(all [[of] the]|the)] (numbers|1\u00a6integers|2\u00a6decimals) (between|from) %number% (and|to) %number%\");\r\n \t}\r\n \t\r\n \t@SuppressWarnings(\"null\")\r\n \tprivate Expression<Number> start, end;\r\n-\tboolean integer;\r\n+\tint mode = -1;\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMTI5NTA3OnYy", "diffSide": "RIGHT", "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozNjowM1rOHYhnAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozNjowM1rOHYhnAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODUyOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495478529", "createdAt": "2020-09-26T17:36:03Z", "author": {"login": "APickledWalrus"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -106,34 +127,63 @@ public boolean init(final Expression<?>[] exprs, final int matchedPattern, final\n \t\t\tf = temp;\r\n \t\t}\r\n \t\tfinal Number starting = s, finish = f;\r\n-\t\treturn new Iterator<Number>() {\r\n-\t\t\tdouble i = integer ? Math.ceil(starting.doubleValue()) : starting.doubleValue(), max = integer ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n-\t\t\t\r\n-\t\t\t@Override\r\n-\t\t\tpublic boolean hasNext() {\r\n-\t\t\t\treturn i <= max;\r\n-\t\t\t}\r\n+\t\tif (mode < 2) {\r\n+\t\t\treturn new Iterator<Number>() {\r\n+\t\t\t\tdouble i = mode == 1 ? Math.ceil(starting.doubleValue()) : starting.doubleValue();\r\n+\t\t\t\tdouble max = mode == 1 ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n+\t\t\t\t\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMTI5NTk5OnYy", "diffSide": "RIGHT", "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozNzoyOVrOHYhnaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozNzoyOVrOHYhnaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODYzMg==", "bodyText": "Small nitpick \ud83d\ude05\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t}\n          \n          \n            \n            \t}", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495478632", "createdAt": "2020-09-26T17:37:29Z", "author": {"login": "APickledWalrus"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -143,6 +193,6 @@ public boolean isSingle() {\n \t\r\n \t@Override\r\n \tpublic Class<? extends Number> getReturnType() {\r\n-\t\treturn integer ? Long.class : Double.class;\r\n+\t\treturn mode == 1 ? Long.class : Double.class;\r\n \t}\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 171}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMTI5NjQzOnYy", "diffSide": "RIGHT", "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNzozODowMVrOHYhnnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QxNDozNTozNFrOHYnw9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODY4NQ==", "bodyText": "Not that this is on you, but since you're already editing this expression can you move toString to the bottom of the file?", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495478685", "createdAt": "2020-09-26T17:38:01Z", "author": {"login": "APickledWalrus"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -106,34 +127,63 @@ public boolean init(final Expression<?>[] exprs, final int matchedPattern, final\n \t\t\tf = temp;\r\n \t\t}\r\n \t\tfinal Number starting = s, finish = f;\r\n-\t\treturn new Iterator<Number>() {\r\n-\t\t\tdouble i = integer ? Math.ceil(starting.doubleValue()) : starting.doubleValue(), max = integer ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n-\t\t\t\r\n-\t\t\t@Override\r\n-\t\t\tpublic boolean hasNext() {\r\n-\t\t\t\treturn i <= max;\r\n-\t\t\t}\r\n+\t\tif (mode < 2) {\r\n+\t\t\treturn new Iterator<Number>() {\r\n+\t\t\t\tdouble i = mode == 1 ? Math.ceil(starting.doubleValue()) : starting.doubleValue();\r\n+\t\t\t\tdouble max = mode == 1 ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n+\t\t\t\t\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic boolean hasNext() {\r\n+\t\t\t\t\treturn i <= max;\r\n+\t\t\t\t}\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic Number next() {\r\n+\t\t\t\t\tif (!hasNext())\r\n+\t\t\t\t\t\tthrow new NoSuchElementException();\r\n+\t\t\t\t\tif (mode == 1)\r\n+\t\t\t\t\t\treturn (long) (reverse ? max-- : i++);\r\n+\t\t\t\t\telse\r\n+\t\t\t\t\t\treturn reverse ? max-- : i++;\r\n+\t\t\t\t}\r\n+\t\t\t};\r\n+\t\t} else {\r\n+\t\t\treturn new Iterator<Number>() {\r\n+\t\t\t\tfinal double start = starting.doubleValue();\r\n+\t\t\t\tfinal double max = finish.doubleValue();\r\n+\t\t\t\tfinal String[] split = starting.toString().split(\"\\\\.\");\r\n+\t\t\t\tfinal int precision = split.length > 0 ? split[1].length() : 0;\r\n \t\t\t\r\n-\t\t\t@Override\r\n-\t\t\tpublic Number next() {\r\n-\t\t\t\tif (!hasNext())\r\n-\t\t\t\t\tthrow new NoSuchElementException();\r\n-\t\t\t\tif (integer)\r\n-\t\t\t\t\treturn (long) (reverse ? max-- : i++);\r\n-\t\t\t\telse\r\n-\t\t\t\t\treturn reverse ? max-- : i++;\r\n-\t\t\t}\r\n-\t\t};\r\n+\t\t\t\tfinal double multiplier = Math.pow(10, precision);\r\n+\t\t\t\tint current = reverse ? (int) (max * multiplier - 1) : (int) (start * multiplier);\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic boolean hasNext() {\r\n+\t\t\t\t\treturn reverse ? current > start : current < max * multiplier;\r\n+\t\t\t\t}\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic Number next() {\r\n+\t\t\t\t\tif (!hasNext())\r\n+\t\t\t\t\t\tthrow new NoSuchElementException();\r\n+\t\t\t\t\tdouble value = start + current / multiplier;\r\n+\t\t\t\t\tcurrent = reverse ? current - 1 : current + 1;\r\n+\t\t\t\t\treturn value;\r\n+\t\t\t\t}\r\n+\t\t\t};\r\n+\t\t}\r\n \t}\r\n \t\r\n \t@Override\r\n \tpublic String toString(final @Nullable Event e, final boolean debug) {\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 152}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU3OTM4Mw==", "bodyText": "Done! :)", "url": "https://github.com/SkriptLang/Skript/pull/3270#discussion_r495579383", "createdAt": "2020-09-27T14:35:34Z", "author": {"login": "bluelhf"}, "path": "src/main/java/ch/njol/skript/expressions/ExprNumbers.java", "diffHunk": "@@ -106,34 +127,63 @@ public boolean init(final Expression<?>[] exprs, final int matchedPattern, final\n \t\t\tf = temp;\r\n \t\t}\r\n \t\tfinal Number starting = s, finish = f;\r\n-\t\treturn new Iterator<Number>() {\r\n-\t\t\tdouble i = integer ? Math.ceil(starting.doubleValue()) : starting.doubleValue(), max = integer ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n-\t\t\t\r\n-\t\t\t@Override\r\n-\t\t\tpublic boolean hasNext() {\r\n-\t\t\t\treturn i <= max;\r\n-\t\t\t}\r\n+\t\tif (mode < 2) {\r\n+\t\t\treturn new Iterator<Number>() {\r\n+\t\t\t\tdouble i = mode == 1 ? Math.ceil(starting.doubleValue()) : starting.doubleValue();\r\n+\t\t\t\tdouble max = mode == 1 ? Math.floor(finish.doubleValue()) : finish.doubleValue();\r\n+\t\t\t\t\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic boolean hasNext() {\r\n+\t\t\t\t\treturn i <= max;\r\n+\t\t\t\t}\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic Number next() {\r\n+\t\t\t\t\tif (!hasNext())\r\n+\t\t\t\t\t\tthrow new NoSuchElementException();\r\n+\t\t\t\t\tif (mode == 1)\r\n+\t\t\t\t\t\treturn (long) (reverse ? max-- : i++);\r\n+\t\t\t\t\telse\r\n+\t\t\t\t\t\treturn reverse ? max-- : i++;\r\n+\t\t\t\t}\r\n+\t\t\t};\r\n+\t\t} else {\r\n+\t\t\treturn new Iterator<Number>() {\r\n+\t\t\t\tfinal double start = starting.doubleValue();\r\n+\t\t\t\tfinal double max = finish.doubleValue();\r\n+\t\t\t\tfinal String[] split = starting.toString().split(\"\\\\.\");\r\n+\t\t\t\tfinal int precision = split.length > 0 ? split[1].length() : 0;\r\n \t\t\t\r\n-\t\t\t@Override\r\n-\t\t\tpublic Number next() {\r\n-\t\t\t\tif (!hasNext())\r\n-\t\t\t\t\tthrow new NoSuchElementException();\r\n-\t\t\t\tif (integer)\r\n-\t\t\t\t\treturn (long) (reverse ? max-- : i++);\r\n-\t\t\t\telse\r\n-\t\t\t\t\treturn reverse ? max-- : i++;\r\n-\t\t\t}\r\n-\t\t};\r\n+\t\t\t\tfinal double multiplier = Math.pow(10, precision);\r\n+\t\t\t\tint current = reverse ? (int) (max * multiplier - 1) : (int) (start * multiplier);\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic boolean hasNext() {\r\n+\t\t\t\t\treturn reverse ? current > start : current < max * multiplier;\r\n+\t\t\t\t}\r\n+\t\t\t\t\r\n+\t\t\t\t@Override\r\n+\t\t\t\tpublic Number next() {\r\n+\t\t\t\t\tif (!hasNext())\r\n+\t\t\t\t\t\tthrow new NoSuchElementException();\r\n+\t\t\t\t\tdouble value = start + current / multiplier;\r\n+\t\t\t\t\tcurrent = reverse ? current - 1 : current + 1;\r\n+\t\t\t\t\treturn value;\r\n+\t\t\t\t}\r\n+\t\t\t};\r\n+\t\t}\r\n \t}\r\n \t\r\n \t@Override\r\n \tpublic String toString(final @Nullable Event e, final boolean debug) {\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ3ODY4NQ=="}, "originalCommit": {"oid": "0fd8e4f556c5068aebc614e597713d6533779f35"}, "originalPosition": 152}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 985, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}