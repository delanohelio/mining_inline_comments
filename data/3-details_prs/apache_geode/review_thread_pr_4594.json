{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyODc5Nzk4", "number": 4594, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQyMzowNDozOVrODYBDlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQyMzowNToyMFrODYBEEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NTA5NzE5OnYy", "diffSide": "LEFT", "path": "geode-core/src/test/java/org/apache/geode/distributed/internal/membership/MembershipDependenciesJUnitTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQyMzowNDozOVrOFdorOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQyMzowNDozOVrOFdorOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjYxOTQ1MA==", "bodyText": "Now that we have eliminated all the spurious dependencies (except the test package one), this ArchRule is no longer needed as a baseline.", "url": "https://github.com/apache/geode/pull/4594#discussion_r366619450", "createdAt": "2020-01-14T23:04:39Z", "author": {"login": "Bill"}, "path": "geode-core/src/test/java/org/apache/geode/distributed/internal/membership/MembershipDependenciesJUnitTest.java", "diffHunk": "@@ -20,65 +20,29 @@\n \n import com.tngtech.archunit.core.importer.ImportOption;\n import com.tngtech.archunit.junit.AnalyzeClasses;\n-import com.tngtech.archunit.junit.ArchIgnore;\n import com.tngtech.archunit.junit.ArchTest;\n import com.tngtech.archunit.junit.ArchUnitRunner;\n import com.tngtech.archunit.junit.CacheMode;\n import com.tngtech.archunit.lang.ArchRule;\n import org.junit.runner.RunWith;\n \n-\n @RunWith(ArchUnitRunner.class)\n @AnalyzeClasses(packages = \"org.apache.geode.distributed.internal.membership.gms..\",\n     cacheMode = CacheMode.PER_CLASS,\n     importOptions = ImportOption.DoNotIncludeArchives.class)\n public class MembershipDependenciesJUnitTest {\n \n   /*\n-   * This test verifies that the membership component (which is currently made up of classes\n-   * inside the geode-core module, but which may someday reside in a separate module)\n-   * depends only on packages within itself (within the membership component) or packages\n-   * outside apache.geode.\n-   *\n-   * For purposes of this test, classes in the membership...adapter package are not considered.\n-   * They will eventually become part of geode-core.\n+   * This test verifies that packages defined in the geode-membership module depend only on\n+   * packages defined within that module or on packages defined outside the geode-core module\n+   * (org.apache.geode packages) or on packages defined in a handful of small \"leaf\" modules.\n    *\n-   * While this rule is ignored, comment-out the ignore annotation to run it periodically to get\n-   * the current count of deviations.\n-   */\n-  // TODO: remove ignore once membershipDoesntDependOnCoreProvisional matches this rule exactly\n-  @ArchIgnore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b783f3f5f07de615b20461b203cbf2deede30edc"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NTA5ODQzOnYy", "diffSide": "LEFT", "path": "geode-core/src/integrationTest/java/org/apache/geode/distributed/internal/membership/api/CoreOnlyUsesMembershipAPIArchUnitTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQyMzowNToyMFrOFdosDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQyMzowNToyMFrOFdosDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjYxOTY2MQ==", "bodyText": "The \"adapter\" layer should not be able to access \"internal\", so I removed the former.", "url": "https://github.com/apache/geode/pull/4594#discussion_r366619661", "createdAt": "2020-01-14T23:05:20Z", "author": {"login": "Bill"}, "path": "geode-core/src/integrationTest/java/org/apache/geode/distributed/internal/membership/api/CoreOnlyUsesMembershipAPIArchUnitTest.java", "diffHunk": "@@ -105,12 +105,10 @@ public void miscCoreClassesDoNotUseMembershipInternals() {\n \n   private void checkMembershipAPIUse(JavaClasses importedClasses) {\n     ArchRule myRule = layeredArchitecture()\n-        .layer(\"adapter\")\n-        .definedBy(resideInAPackage(\"org.apache.geode.distributed.internal.membership.adapter\"))\n         .layer(\"internal\")\n         .definedBy(resideInAPackage(\"org.apache.geode.distributed.internal.membership.gms..\"))\n         .layer(\"api\").definedBy(\"org.apache.geode.distributed.internal.membership.api\")\n-        .whereLayer(\"internal\").mayOnlyBeAccessedByLayers(\"api\", \"adapter\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b783f3f5f07de615b20461b203cbf2deede30edc"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3830, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}