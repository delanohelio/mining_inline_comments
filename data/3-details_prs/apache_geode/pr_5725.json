{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NDQ4Mzkz", "number": 5725, "title": "GEODE-8664: Nest errors in DistributionImpl.start", "bodyText": "If while calling DistributionImpl.start there was either a\nMembershipConfigurationException or MemberStartupException exceptions, its\noriginal cause was not propagated, therefore being unable to properly\ntackling issues on startup.\nThis commit propagates the cause for both exceptions.\nAlso 2 JUint test were added to make sure this is working.\n\n\nThank you for submitting a contribution to Apache Geode.\nIn order to streamline the review of the contribution we ask you\nto ensure the following steps have been taken:\nFor all changes:\n\n\n Is there a JIRA ticket associated with this PR? Is it referenced in the commit message?\n\n\n Has your PR been rebased against the latest commit within the target branch (typically develop)?\n\n\n Is your initial contribution a single, squashed commit?\n\n\n Does gradlew build run cleanly?\n\n\n Have you written or updated unit tests to verify your changes?\n\n\n (N/A) If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under ASF 2.0?\n\n\nNote:\nPlease ensure that once the PR is submitted, check Concourse for build issues and\nsubmit an update to your PR as soon as possible. If you need help, please send an\nemail to dev@geode.apache.org.", "createdAt": "2020-11-10T12:17:35Z", "url": "https://github.com/apache/geode/pull/5725", "merged": true, "mergeCommit": {"oid": "f6605e0820ba9b858b8128cd31a03a29067b7710"}, "closed": true, "closedAt": "2020-11-12T14:27:59Z", "author": {"login": "gaussianrecurrence"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbI2O2AH2gAyNTE4NDQ4MzkzOmQ0NGM3MWNkMTJjYWJiNTNlYzA3YTRmNzdmZDBlYWRkYWQ1Y2VkZGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbmAx1AH2gAyNTE4NDQ4MzkzOjlkMzg4MGM1NTk0OGEyYjNkZmMzMjIwNzhiMjE0NzFhYTUzYjE2MTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d44c71cd12cabb53ec07a4f77fd0eaddad5ceddc", "author": {"user": {"login": "gaussianrecurrence", "name": "Mario Salazar de Torres"}}, "url": "https://github.com/apache/geode/commit/d44c71cd12cabb53ec07a4f77fd0eaddad5ceddc", "committedDate": "2020-11-10T12:51:40Z", "message": "GEODE-8664: Nest errors in DistributionImpl.start\n\n - If while calling DistributionImpl.start there was either a\n   MembershipConfigurationException or MemberStartupException exceptions, its\n   original cause was not propagated, therefore being unable to properly\n   tackling issues on startup.\n - This commit propagates the cause for both exceptions.\n - Also 2 JUint test were added to make sure this is working."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0f2ceb3d5862243cf080de89b8ed226720b755e1", "author": {"user": {"login": "gaussianrecurrence", "name": "Mario Salazar de Torres"}}, "url": "https://github.com/apache/geode/commit/0f2ceb3d5862243cf080de89b8ed226720b755e1", "committedDate": "2020-11-10T12:15:47Z", "message": "GEODE-8664: Nest errors in DistributionImpl.start\n\n - If while calling DistributionImpl.start there was either a\n   MembershipConfigurationException or MemberStartupException exceptions, its\n   original cause was not propagated, therefore being unable to properly\n   tackling issues on startup.\n - This commit propagates the cause for both exceptions.\n - Also 2 JUint test were added to make sure this is working."}, "afterCommit": {"oid": "d44c71cd12cabb53ec07a4f77fd0eaddad5ceddc", "author": {"user": {"login": "gaussianrecurrence", "name": "Mario Salazar de Torres"}}, "url": "https://github.com/apache/geode/commit/d44c71cd12cabb53ec07a4f77fd0eaddad5ceddc", "committedDate": "2020-11-10T12:51:40Z", "message": "GEODE-8664: Nest errors in DistributionImpl.start\n\n - If while calling DistributionImpl.start there was either a\n   MembershipConfigurationException or MemberStartupException exceptions, its\n   original cause was not propagated, therefore being unable to properly\n   tackling issues on startup.\n - This commit propagates the cause for both exceptions.\n - Also 2 JUint test were added to make sure this is working."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3NDQzNTkx", "url": "https://github.com/apache/geode/pull/5725#pullrequestreview-527443591", "createdAt": "2020-11-10T17:33:01Z", "commit": {"oid": "d44c71cd12cabb53ec07a4f77fd0eaddad5ceddc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNzozMzowMVrOHwnstQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNzozMzowMVrOHwnstQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc0NDExNw==", "bodyText": "JUnit has ExpectedException which I think works better than try catch statements.  There are some examples in the Geode code base if you want some inspiration", "url": "https://github.com/apache/geode/pull/5725#discussion_r520744117", "createdAt": "2020-11-10T17:33:01Z", "author": {"login": "moleske"}, "path": "geode-core/src/test/java/org/apache/geode/distributed/internal/DistributionTest.java", "diffHunk": "@@ -204,4 +207,30 @@ public void testSendToEmptyListIsRejected() throws Exception {\n     distribution.send(emptyList, m);\n     verify(membership, never()).send(any(), any());\n   }\n+\n+  @Test\n+  public void testExceptionNestedOnStartConfigError() throws Exception {\n+    Throwable cause = new RuntimeException(\"Exception cause\");\n+    Throwable exception = new MembershipConfigurationException(\"Test exception\", cause);\n+    doThrow(exception).when(membership).start();\n+    try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d44c71cd12cabb53ec07a4f77fd0eaddad5ceddc"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bcccc932b678041a857bd4eb339cb016f36ccfe", "author": {"user": {"login": "gaussianrecurrence", "name": "Mario Salazar de Torres"}}, "url": "https://github.com/apache/geode/commit/7bcccc932b678041a857bd4eb339cb016f36ccfe", "committedDate": "2020-11-10T21:48:27Z", "message": "GEODE-8664: Revision 2\n\n - Replaced try/catch blocks by AssertJ semantics, leading to a much more clear\n   unit test."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MzM5OTc5", "url": "https://github.com/apache/geode/pull/5725#pullrequestreview-528339979", "createdAt": "2020-11-11T16:35:19Z", "commit": {"oid": "7bcccc932b678041a857bd4eb339cb016f36ccfe"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNjozNToxOVrOHxU9xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNjozNTozMFrOHxU-SA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ4NTc2NA==", "bodyText": "You should just use the exception here instead of e.getCause() otherwise you're discarding one of the stack frames in the exception chain.", "url": "https://github.com/apache/geode/pull/5725#discussion_r521485764", "createdAt": "2020-11-11T16:35:19Z", "author": {"login": "jdeppe-pivotal"}, "path": "geode-core/src/main/java/org/apache/geode/distributed/internal/DistributionImpl.java", "diffHunk": "@@ -181,9 +181,9 @@ public void start() {\n       throw new GemFireSecurityException(e.getMessage(),\n           e);\n     } catch (MembershipConfigurationException e) {\n-      throw new GemFireConfigException(e.getMessage());\n+      throw new GemFireConfigException(e.getMessage(), e.getCause());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bcccc932b678041a857bd4eb339cb016f36ccfe"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ4NTg5Ng==", "bodyText": "Ditto", "url": "https://github.com/apache/geode/pull/5725#discussion_r521485896", "createdAt": "2020-11-11T16:35:30Z", "author": {"login": "jdeppe-pivotal"}, "path": "geode-core/src/main/java/org/apache/geode/distributed/internal/DistributionImpl.java", "diffHunk": "@@ -181,9 +181,9 @@ public void start() {\n       throw new GemFireSecurityException(e.getMessage(),\n           e);\n     } catch (MembershipConfigurationException e) {\n-      throw new GemFireConfigException(e.getMessage());\n+      throw new GemFireConfigException(e.getMessage(), e.getCause());\n     } catch (MemberStartupException e) {\n-      throw new SystemConnectException(e.getMessage());\n+      throw new SystemConnectException(e.getMessage(), e.getCause());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bcccc932b678041a857bd4eb339cb016f36ccfe"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d3880c55948a2b3dfc322078b21471aa53b1615", "author": {"user": {"login": "gaussianrecurrence", "name": "Mario Salazar de Torres"}}, "url": "https://github.com/apache/geode/commit/9d3880c55948a2b3dfc322078b21471aa53b1615", "committedDate": "2020-11-11T22:50:26Z", "message": "GEODE-8664: Revision 3\n\n - Changing exception nesting so the actual exception is propagated, rather than\n   its cause.\n - JUnit tests have been changed accordingly."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4015, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}