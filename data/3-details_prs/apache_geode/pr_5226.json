{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxNDEzMjcy", "number": 5226, "title": "GEODE-8205: Feature flag unsupported Redis commands", "bodyText": "Added log message and redis --enable-unsupported-commands gfsh command.\nCo-authored-by: Murtuza Boxwala mboxwala@pivotal.io\nCo-authored-by: Darrel Schneider dschneider@pivotal.io\nCo-authored-by: Jens Deppe jdeppe@pivotal.io", "createdAt": "2020-06-08T21:44:18Z", "url": "https://github.com/apache/geode/pull/5226", "merged": true, "mergeCommit": {"oid": "1231db1c70632c3f822a63cbd6a4e662d542c961"}, "closed": true, "closedAt": "2020-06-10T16:04:26Z", "author": {"login": "sabbey37"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpZQWqAFqTQyNjY5Mzc0Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp725IAFqTQyODIwNTk0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NjkzNzQz", "url": "https://github.com/apache/geode/pull/5226#pullrequestreview-426693743", "createdAt": "2020-06-08T23:42:28Z", "commit": {"oid": "245220b6f16f2e5431aa79ef40f5c14c5fc731fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NzAyMjI2", "url": "https://github.com/apache/geode/pull/5226#pullrequestreview-426702226", "createdAt": "2020-06-09T00:05:00Z", "commit": {"oid": "245220b6f16f2e5431aa79ef40f5c14c5fc731fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MjIwODYw", "url": "https://github.com/apache/geode/pull/5226#pullrequestreview-427220860", "createdAt": "2020-06-09T14:38:57Z", "commit": {"oid": "f910d9f8352351ec0d0d0f83fdf445395782bc34"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDozODo1N1rOGhNW1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDo0MToyN1rOGhNe6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ3NTAzMA==", "bodyText": "We should also add some security meta data here:\n@ResourceOperation(resource = ResourcePermission.Resource.DATA, operation = ResourcePermission.Operation.MANAGE);", "url": "https://github.com/apache/geode/pull/5226#discussion_r437475030", "createdAt": "2020-06-09T14:38:57Z", "author": {"login": "jdeppe-pivotal"}, "path": "geode-redis/src/main/java/org/apache/geode/redis/internal/gfsh/RedisCommand.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package org.apache.geode.redis.internal.gfsh;\n+\n+import java.util.List;\n+import java.util.Set;\n+\n+import org.springframework.shell.core.annotation.CliCommand;\n+import org.springframework.shell.core.annotation.CliOption;\n+\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.management.cli.SingleGfshCommand;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.management.internal.functions.CliFunctionResult;\n+\n+public class RedisCommand extends SingleGfshCommand {\n+  public static final String REDIS = \"redis\";\n+  public static final String REDIS__HELP =\n+      \"Commands related to the Redis API for Geode.\";\n+  public static final String REDIS__ENABLE_UNSUPPORTED_COMMANDS = \"enable-unsupported-commands\";\n+  public static final String REDIS__ENABLE_UNSUPPORTED_COMMANDS__HELP =\n+      \"Boolean value to determine \"\n+          + \"whether or not to enable unsupported commands. Unsupported commands have not been fully tested.\";\n+\n+  @CliCommand(value = {REDIS}, help = REDIS__HELP)\n+  public ResultModel enableUnsupportedCommands(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f910d9f8352351ec0d0d0f83fdf445395782bc34"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ3NzA5OA==", "bodyText": "For consistency with other cli-related functions we should extend CliFunction instead of implements Function. That class exposes an execute that just needs to return a CliFunctionResult. CliFunction also extends InternalFunction which is more secure (it cannot be user-invoked in any way - for example via gfsh).", "url": "https://github.com/apache/geode/pull/5226#discussion_r437477098", "createdAt": "2020-06-09T14:41:27Z", "author": {"login": "jdeppe-pivotal"}, "path": "geode-redis/src/main/java/org/apache/geode/redis/internal/gfsh/RedisCommandFunction.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package org.apache.geode.redis.internal.gfsh;\n+\n+import org.apache.geode.cache.execute.Function;\n+import org.apache.geode.cache.execute.FunctionContext;\n+import org.apache.geode.cache.execute.FunctionService;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.internal.functions.CliFunctionResult;\n+import org.apache.geode.redis.internal.GeodeRedisService;\n+\n+public class RedisCommandFunction implements Function<Boolean> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f910d9f8352351ec0d0d0f83fdf445395782bc34"}, "originalPosition": 24}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56e9dd7b048b95543d50c10bca2fc844900dac9d", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/56e9dd7b048b95543d50c10bca2fc844900dac9d", "committedDate": "2020-06-09T21:10:45Z", "message": "PR review changes"}, "afterCommit": {"oid": "2d0b1c3769f73bd3f311e570fa3adfc1f09298e9", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/2d0b1c3769f73bd3f311e570fa3adfc1f09298e9", "committedDate": "2020-06-09T21:43:10Z", "message": "WIP"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "375a4eb6e49df348ecae1bc5d80b097b7e11eaf1", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/375a4eb6e49df348ecae1bc5d80b097b7e11eaf1", "committedDate": "2020-06-09T21:46:13Z", "message": "GEODE-8205: Feature flag unsupported Redis commands\n\nAdded log message and redis --enable-unsupported-commands gfsh command."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2d0b1c3769f73bd3f311e570fa3adfc1f09298e9", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/2d0b1c3769f73bd3f311e570fa3adfc1f09298e9", "committedDate": "2020-06-09T21:43:10Z", "message": "WIP"}, "afterCommit": {"oid": "375a4eb6e49df348ecae1bc5d80b097b7e11eaf1", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/375a4eb6e49df348ecae1bc5d80b097b7e11eaf1", "committedDate": "2020-06-09T21:46:13Z", "message": "GEODE-8205: Feature flag unsupported Redis commands\n\nAdded log message and redis --enable-unsupported-commands gfsh command."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3Njk2Nzcy", "url": "https://github.com/apache/geode/pull/5226#pullrequestreview-427696772", "createdAt": "2020-06-10T04:08:35Z", "commit": {"oid": "375a4eb6e49df348ecae1bc5d80b097b7e11eaf1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f474fdf5da0e30b0d73ddb315dcb53130e3c97f9", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/f474fdf5da0e30b0d73ddb315dcb53130e3c97f9", "committedDate": "2020-06-10T13:29:32Z", "message": "Adds command type back to unsupported command error message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4MjA1OTQ1", "url": "https://github.com/apache/geode/pull/5226#pullrequestreview-428205945", "createdAt": "2020-06-10T16:01:20Z", "commit": {"oid": "f474fdf5da0e30b0d73ddb315dcb53130e3c97f9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4442, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}