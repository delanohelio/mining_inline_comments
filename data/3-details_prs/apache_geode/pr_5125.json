{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4ODk4ODI0", "number": 5125, "title": "GEODE-8170: Change all hash and set commands to use function+delta", "bodyText": "In addition to the hash commands this branch also changes smove to use functions.\nThank you for submitting a contribution to Apache Geode.\nIn order to streamline the review of the contribution we ask you\nto ensure the following steps have been taken:\nFor all changes:\n\n\n Is there a JIRA ticket associated with this PR? Is it referenced in the commit message?\n\n\n Has your PR been rebased against the latest commit within the target branch (typically develop)?\n\n\n Is your initial contribution a single, squashed commit?\n\n\n Does gradlew build run cleanly?\n\n\n Have you written or updated unit tests to verify your changes?\n\n\n If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under ASF 2.0?\n\n\nNote:\nPlease ensure that once the PR is submitted, check Concourse for build issues and\nsubmit an update to your PR as soon as possible. If you need help, please send an\nemail to dev@geode.apache.org.", "createdAt": "2020-05-16T02:02:33Z", "url": "https://github.com/apache/geode/pull/5125", "merged": true, "mergeCommit": {"oid": "9a0563ef1061ca2834db257b50c3a80c1941fb07"}, "closed": true, "closedAt": "2020-05-21T18:42:07Z", "author": {"login": "dschneider-pivotal"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcihcLQgFqTQxMzY5NDE0MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjgKWfAFqTQxNjI5NzIwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNjk0MTQx", "url": "https://github.com/apache/geode/pull/5125#pullrequestreview-413694141", "createdAt": "2020-05-18T15:17:09Z", "commit": {"oid": "011864416cad9c589e3a39ef76b8be10e0cc4711"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNToxNzowOVrOGW73_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNToxNzowOVrOGW73_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcwMjg0Nw==", "bodyText": "Do we still need this class? I'm not sure I fully understand it's usage since when I switched RedisHash.EMPTY to new RedisHash(Collections.emptyList()), HashesIntegrationTest still passes.", "url": "https://github.com/apache/geode/pull/5125#discussion_r426702847", "createdAt": "2020-05-18T15:17:09Z", "author": {"login": "jdeppe-pivotal"}, "path": "geode-redis/src/main/java/org/apache/geode/redis/internal/executor/EmptyRedisHash.java", "diffHunk": "@@ -26,41 +25,26 @@\n import org.apache.geode.redis.internal.executor.hash.RedisHash;\n \n public class EmptyRedisHash extends RedisHash {\n-  @Override\n-  public synchronized int hset(Region<ByteArrayWrapper, RedisData> region, ByteArrayWrapper key,\n-      List<ByteArrayWrapper> fieldsToSet, boolean nx) {\n-    throw new UnsupportedOperationException();\n-  }\n-\n-  @Override\n-  public synchronized int hdel(Region<ByteArrayWrapper, RedisData> region, ByteArrayWrapper key,\n-      List<ByteArrayWrapper> fieldsToRemove) {\n-    return 0;\n-  }\n-\n-  @Override\n-  public synchronized Collection<ByteArrayWrapper> hgetall() {\n-    return emptyList();\n+  public EmptyRedisHash() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "011864416cad9c589e3a39ef76b8be10e0cc4711"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNjk1MjQ0", "url": "https://github.com/apache/geode/pull/5125#pullrequestreview-413695244", "createdAt": "2020-05-18T15:18:24Z", "commit": {"oid": "011864416cad9c589e3a39ef76b8be10e0cc4711"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNToxODoyNFrOGW77Mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNToxODoyNFrOGW77Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjcwMzY2Ng==", "bodyText": "How is this used / invoked?", "url": "https://github.com/apache/geode/pull/5125#discussion_r426703666", "createdAt": "2020-05-18T15:18:24Z", "author": {"login": "jdeppe-pivotal"}, "path": "geode-redis/src/main/java/org/apache/geode/redis/internal/executor/CommandFunction.java", "diffHunk": "@@ -117,6 +118,32 @@ protected Object compute(Region localRegion, ByteArrayWrapper key,\n             () -> new RedisSetInRegion(localRegion).sscan(key, matchPattern, count, cursor);\n         break;\n       }\n+      case SCREATE: {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "011864416cad9c589e3a39ef76b8be10e0cc4711"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdc649b556d175add5e2a4b7c64af9bcb46b62d1", "author": {"user": {"login": "dschneider-pivotal", "name": "Darrel Schneider"}}, "url": "https://github.com/apache/geode/commit/fdc649b556d175add5e2a4b7c64af9bcb46b62d1", "committedDate": "2020-05-21T06:46:03Z", "message": "hexists now uses function\n\nhget now uses function\n\nhlen now uses function\n\nhmget now uses function\n\nhvals now uses function\n\nhkeys now uses function\n\nsmove now uses the srem and sadd functions\n\nhscan now uses function\n\nhincrby now uses function\n\nhincrbyfloat now uses function\n\ncleaned up hash impls by getting rid of synchronized\nand adding a createRedisHashCommmands method\n\nAdd the set commands now use functions\n\ndisabled some tests that fail because of GEODE-8143"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9f9feeeddb2d0fb5a5b18f6d41e0e8bc4c411d74", "author": {"user": {"login": "dschneider-pivotal", "name": "Darrel Schneider"}}, "url": "https://github.com/apache/geode/commit/9f9feeeddb2d0fb5a5b18f6d41e0e8bc4c411d74", "committedDate": "2020-05-19T15:51:39Z", "message": "removed one more screate missed in last checkin"}, "afterCommit": {"oid": "fdc649b556d175add5e2a4b7c64af9bcb46b62d1", "author": {"user": {"login": "dschneider-pivotal", "name": "Darrel Schneider"}}, "url": "https://github.com/apache/geode/commit/fdc649b556d175add5e2a4b7c64af9bcb46b62d1", "committedDate": "2020-05-21T06:46:03Z", "message": "hexists now uses function\n\nhget now uses function\n\nhlen now uses function\n\nhmget now uses function\n\nhvals now uses function\n\nhkeys now uses function\n\nsmove now uses the srem and sadd functions\n\nhscan now uses function\n\nhincrby now uses function\n\nhincrbyfloat now uses function\n\ncleaned up hash impls by getting rid of synchronized\nand adding a createRedisHashCommmands method\n\nAdd the set commands now use functions\n\ndisabled some tests that fail because of GEODE-8143"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2Mjk3MjA3", "url": "https://github.com/apache/geode/pull/5125#pullrequestreview-416297207", "createdAt": "2020-05-21T16:21:42Z", "commit": {"oid": "fdc649b556d175add5e2a4b7c64af9bcb46b62d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4543, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}