{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NTEwMTg4", "number": 4818, "title": "GEODE-7667: Add a 'clear' gfsh command for PR and RR clear", "bodyText": "Thank you for submitting a contribution to Apache Geode.\nIn order to streamline the review of the contribution we ask you\nto ensure the following steps have been taken:\nFor all changes:\n\n\n Is there a JIRA ticket associated with this PR? Is it referenced in the commit message?\n\n\n Has your PR been rebased against the latest commit within the target branch (typically develop)?\n\n\n Is your initial contribution a single, squashed commit?\n\n\n Does gradlew build run cleanly?\n\n\n Have you written or updated unit tests to verify your changes?\n\n\n If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under ASF 2.0?\n\n\nNote:\nPlease ensure that once the PR is submitted, check Concourse for build issues and\nsubmit an update to your PR as soon as possible. If you need help, please send an\nemail to dev@geode.apache.org.", "createdAt": "2020-03-16T21:46:13Z", "url": "https://github.com/apache/geode/pull/4818", "merged": true, "mergeCommit": {"oid": "62858e296f874bc237706663b55590bce8f595c5"}, "closed": true, "closedAt": "2020-05-05T18:40:34Z", "author": {"login": "BenjaminPerryRoss"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcO7Wr6AFqTM3NzExNzMwNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABceYd4NAFqTQwNjA1Mjg5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MTE3MzA1", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-377117305", "createdAt": "2020-03-18T18:10:11Z", "commit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxODoxMDoxMlrOF4RJYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxODoxMDoxMlrOF4RJYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU0NTUwNQ==", "bodyText": "can you try to remove this line?", "url": "https://github.com/apache/geode/pull/4818#discussion_r394545505", "createdAt": "2020-03-18T18:10:12Z", "author": {"login": "gesterzhou"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/commands/ClearCommand.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.DataCommandsUtils.callFunctionForRegion;\n+\n+import java.util.Set;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.springframework.shell.core.annotation.CliCommand;\n+import org.springframework.shell.core.annotation.CliOption;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.cli.CliMetaData;\n+import org.apache.geode.management.cli.ConverterHint;\n+import org.apache.geode.management.cli.GfshCommand;\n+import org.apache.geode.management.internal.cli.domain.DataCommandRequest;\n+import org.apache.geode.management.internal.cli.domain.DataCommandResult;\n+import org.apache.geode.management.internal.cli.functions.DataCommandFunction;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.security.ResourcePermission.Operation;\n+import org.apache.geode.security.ResourcePermission.Resource;\n+\n+public class ClearCommand extends GfshCommand {\n+  public static final String REGION_NOT_FOUND = \"Region <%s> not found in any of the members\";\n+\n+  @CliMetaData(relatedTopic = {CliStrings.TOPIC_GEODE_DATA, CliStrings.TOPIC_GEODE_REGION})\n+  @CliCommand(value = {CliStrings.CLEAR_REGION}, help = CliStrings.CLEAR_REGION_HELP)\n+  public ResultModel remove(\n+      @CliOption(key = {CliStrings.CLEAR_REGION_REGION_NAME}, mandatory = true,\n+          help = CliStrings.CLEAR_REGION_REGION_NAME_HELP,\n+          optionContext = ConverterHint.REGION_PATH) String regionPath) {\n+\n+    Cache cache = getCache();\n+\n+    authorize(Resource.DATA, Operation.WRITE, regionPath);\n+\n+\n+    Region region = cache.getRegion(regionPath);\n+    DataCommandFunction removefn = new DataCommandFunction();\n+    DataCommandResult dataResult;\n+    if (region == null) {\n+      Set<DistributedMember> memberList = findAnyMembersForRegion(regionPath);\n+\n+      if (CollectionUtils.isEmpty(memberList)) {\n+        return new ResultModel().createError(String.format(REGION_NOT_FOUND, regionPath));\n+      }\n+\n+      DataCommandRequest request = new DataCommandRequest();\n+      request.setCommand(CliStrings.REMOVE);\n+      request.setRemoveAllKeys(\"ALL\");\n+      request.setRegionName(regionPath);\n+      dataResult = callFunctionForRegion(request, removefn, memberList);\n+    } else {\n+      dataResult = removefn.remove(null, null, regionPath, \"ALL\",\n+          (InternalCache) cache);\n+    }\n+\n+    // BR: is this needed?\n+    dataResult.setKeyClass(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MTE3NjIz", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-377117623", "createdAt": "2020-03-18T18:10:39Z", "commit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxODoxMDozOVrOF4RKgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxODoxMDozOVrOF4RKgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU0NTc5NA==", "bodyText": "should we use clear() instead of remove() for method name? Is that because the upper level has hard-coded to use remove()?", "url": "https://github.com/apache/geode/pull/4818#discussion_r394545794", "createdAt": "2020-03-18T18:10:39Z", "author": {"login": "gesterzhou"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/commands/ClearCommand.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.DataCommandsUtils.callFunctionForRegion;\n+\n+import java.util.Set;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.springframework.shell.core.annotation.CliCommand;\n+import org.springframework.shell.core.annotation.CliOption;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.cli.CliMetaData;\n+import org.apache.geode.management.cli.ConverterHint;\n+import org.apache.geode.management.cli.GfshCommand;\n+import org.apache.geode.management.internal.cli.domain.DataCommandRequest;\n+import org.apache.geode.management.internal.cli.domain.DataCommandResult;\n+import org.apache.geode.management.internal.cli.functions.DataCommandFunction;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.security.ResourcePermission.Operation;\n+import org.apache.geode.security.ResourcePermission.Resource;\n+\n+public class ClearCommand extends GfshCommand {\n+  public static final String REGION_NOT_FOUND = \"Region <%s> not found in any of the members\";\n+\n+  @CliMetaData(relatedTopic = {CliStrings.TOPIC_GEODE_DATA, CliStrings.TOPIC_GEODE_REGION})\n+  @CliCommand(value = {CliStrings.CLEAR_REGION}, help = CliStrings.CLEAR_REGION_HELP)\n+  public ResultModel remove(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MTgxNzE0", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-378181714", "createdAt": "2020-03-20T00:38:51Z", "commit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMDozODo1MVrOF5E3ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwMDo0NTowMlrOF5E8QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM5MjkwNg==", "bodyText": "REMOVE__MSG__CLEARALL_NOT_SUPPORTED_FOR_PARTITIONREGION  is not true anymore, right?", "url": "https://github.com/apache/geode/pull/4818#discussion_r395392906", "createdAt": "2020-03-20T00:38:51Z", "author": {"login": "agingade"}, "path": "geode-core/src/main/java/org/apache/geode/management/internal/i18n/CliStrings.java", "diffHunk": "@@ -1915,6 +1922,9 @@\n   public static final String REMOVE__MSG__REGION_NOT_FOUND = \"Region <{0}> Not Found\";\n   public static final String REMOVE__MSG__KEY_NOT_FOUND_REGION = \"Key is not present in the region\";\n   public static final String REMOVE__MSG__CLEARED_ALL_CLEARS = \"Cleared all keys in the region\";\n+  public static final String REMOVE__MSG__CLEARALL_DEPRECATION_WARNING =\n+      \"Warning: The --all option for the 'remove' command is deprecated. Please\"\n+          + \" use the 'clear region' command instead.\";\n   public static final String REMOVE__MSG__CLEARALL_NOT_SUPPORTED_FOR_PARTITIONREGION =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM5MzE1Mw==", "bodyText": "As Gester suggested; how about using \"clear\" instead of \"remove/all\".", "url": "https://github.com/apache/geode/pull/4818#discussion_r395393153", "createdAt": "2020-03-20T00:40:07Z", "author": {"login": "agingade"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/commands/ClearCommand.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.DataCommandsUtils.callFunctionForRegion;\n+\n+import java.util.Set;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.springframework.shell.core.annotation.CliCommand;\n+import org.springframework.shell.core.annotation.CliOption;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.cli.CliMetaData;\n+import org.apache.geode.management.cli.ConverterHint;\n+import org.apache.geode.management.cli.GfshCommand;\n+import org.apache.geode.management.internal.cli.domain.DataCommandRequest;\n+import org.apache.geode.management.internal.cli.domain.DataCommandResult;\n+import org.apache.geode.management.internal.cli.functions.DataCommandFunction;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.security.ResourcePermission.Operation;\n+import org.apache.geode.security.ResourcePermission.Resource;\n+\n+public class ClearCommand extends GfshCommand {\n+  public static final String REGION_NOT_FOUND = \"Region <%s> not found in any of the members\";\n+\n+  @CliMetaData(relatedTopic = {CliStrings.TOPIC_GEODE_DATA, CliStrings.TOPIC_GEODE_REGION})\n+  @CliCommand(value = {CliStrings.CLEAR_REGION}, help = CliStrings.CLEAR_REGION_HELP)\n+  public ResultModel remove(\n+      @CliOption(key = {CliStrings.CLEAR_REGION_REGION_NAME}, mandatory = true,\n+          help = CliStrings.CLEAR_REGION_REGION_NAME_HELP,\n+          optionContext = ConverterHint.REGION_PATH) String regionPath) {\n+\n+    Cache cache = getCache();\n+\n+    authorize(Resource.DATA, Operation.WRITE, regionPath);\n+\n+\n+    Region region = cache.getRegion(regionPath);\n+    DataCommandFunction removefn = new DataCommandFunction();\n+    DataCommandResult dataResult;\n+    if (region == null) {\n+      Set<DistributedMember> memberList = findAnyMembersForRegion(regionPath);\n+\n+      if (CollectionUtils.isEmpty(memberList)) {\n+        return new ResultModel().createError(String.format(REGION_NOT_FOUND, regionPath));\n+      }\n+\n+      DataCommandRequest request = new DataCommandRequest();\n+      request.setCommand(CliStrings.REMOVE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTM5NDExMg==", "bodyText": "Can we add clear() instead of using remove()? Till the deprecated remove-all is removed, the remove-all can clear().", "url": "https://github.com/apache/geode/pull/4818#discussion_r395394112", "createdAt": "2020-03-20T00:45:02Z", "author": {"login": "agingade"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/functions/DataCommandFunction.java", "diffHunk": "@@ -314,17 +314,13 @@ public DataCommandResult remove(String key, String keyClass, String regionName,\n         }\n       } else {\n         DataPolicy policy = region.getAttributes().getDataPolicy();\n-        if (!policy.withPartitioning()) {\n-          region.clear();\n-          if (logger.isDebugEnabled()) {\n-            logger.debug(\"Cleared all keys in the region - {}\", regionName);\n-          }\n-          return DataCommandResult.createRemoveInfoResult(key, null, null,\n-              CliStrings.format(CliStrings.REMOVE__MSG__CLEARED_ALL_CLEARS, regionName), true);\n-        } else {\n-          return DataCommandResult.createRemoveInfoResult(key, null, null,\n-              CliStrings.REMOVE__MSG__CLEARALL_NOT_SUPPORTED_FOR_PARTITIONREGION, false);\n+        region.clear();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4NTkzMjMx", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-378593231", "createdAt": "2020-03-20T15:40:01Z", "commit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxNTo0MDowMVrOF5Y6zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQyMDo1OToxMlrOF5jCAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTcyMTQyMw==", "bodyText": "In the JIRA ticket, region is an option. e.g. clear --region=regionName.", "url": "https://github.com/apache/geode/pull/4818#discussion_r395721423", "createdAt": "2020-03-20T15:40:01Z", "author": {"login": "jchen21"}, "path": "geode-core/src/main/java/org/apache/geode/management/internal/i18n/CliStrings.java", "diffHunk": "@@ -816,6 +816,13 @@\n   public static final String CLEAR_DEFINED_INDEX__SUCCESS__MSG =\n       \"Index definitions successfully cleared\";\n \n+  /* clear region */\n+  public static final String CLEAR_REGION = \"clear region\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTcyMzg3Mw==", "bodyText": "Why this is 16, not 15?", "url": "https://github.com/apache/geode/pull/4818#discussion_r395723873", "createdAt": "2020-03-20T15:43:41Z", "author": {"login": "jchen21"}, "path": "geode-gfsh/src/integrationTest/java/org/apache/geode/management/internal/cli/GfshParserAutoCompletionIntegrationTest.java", "diffHunk": "@@ -381,7 +381,7 @@ public void testObtainHintForData() {\n     String hintArgument = \"data\";\n     String hintsProvided = gfshParserRule.getCommandManager().obtainHint(hintArgument);\n     String[] hintsProvidedArray = hintsProvided.split(lineSeparator());\n-    assertThat(hintsProvidedArray.length).isEqualTo(15);\n+    assertThat(hintsProvidedArray.length).isEqualTo(16);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTg4NjQxOA==", "bodyText": "My understanding is that the remove command is deprecated, not just the --all option.", "url": "https://github.com/apache/geode/pull/4818#discussion_r395886418", "createdAt": "2020-03-20T20:57:32Z", "author": {"login": "jchen21"}, "path": "geode-core/src/main/java/org/apache/geode/management/internal/i18n/CliStrings.java", "diffHunk": "@@ -1915,6 +1922,9 @@\n   public static final String REMOVE__MSG__REGION_NOT_FOUND = \"Region <{0}> Not Found\";\n   public static final String REMOVE__MSG__KEY_NOT_FOUND_REGION = \"Key is not present in the region\";\n   public static final String REMOVE__MSG__CLEARED_ALL_CLEARS = \"Cleared all keys in the region\";\n+  public static final String REMOVE__MSG__CLEARALL_DEPRECATION_WARNING =\n+      \"Warning: The --all option for the 'remove' command is deprecated. Please\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTg4NzEwNw==", "bodyText": "Again the command is clear --region,  --region is the command option. Not clear region.", "url": "https://github.com/apache/geode/pull/4818#discussion_r395887107", "createdAt": "2020-03-20T20:59:12Z", "author": {"login": "jchen21"}, "path": "geode-core/src/main/java/org/apache/geode/management/internal/i18n/CliStrings.java", "diffHunk": "@@ -1915,6 +1922,9 @@\n   public static final String REMOVE__MSG__REGION_NOT_FOUND = \"Region <{0}> Not Found\";\n   public static final String REMOVE__MSG__KEY_NOT_FOUND_REGION = \"Key is not present in the region\";\n   public static final String REMOVE__MSG__CLEARED_ALL_CLEARS = \"Cleared all keys in the region\";\n+  public static final String REMOVE__MSG__CLEARALL_DEPRECATION_WARNING =\n+      \"Warning: The --all option for the 'remove' command is deprecated. Please\"\n+          + \" use the 'clear region' command instead.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5NTY4MDUz", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-379568053", "createdAt": "2020-03-23T15:55:09Z", "commit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxNTo1NTowOVrOF6MBwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxNzoxNDoxN1rOF6PmNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU1ODc4NA==", "bodyText": "I think we should be putting more values here, to ensure that every bucket has at least one key. Buckets are not fully created until data is put into them, so with only two keys, the system is not in a very realistic state.", "url": "https://github.com/apache/geode/pull/4818#discussion_r396558784", "createdAt": "2020-03-23T15:55:09Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/distributedTest/java/org/apache/geode/management/internal/cli/commands/ClearCommandDUnitTest.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.RemoveCommand.REGION_NOT_FOUND;\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.CacheFactory;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.test.dunit.rules.ClusterStartupRule;\n+import org.apache.geode.test.dunit.rules.MemberVM;\n+import org.apache.geode.test.junit.rules.GfshCommandRule;\n+import org.apache.geode.test.junit.rules.VMProvider;\n+\n+\n+public class ClearCommandDUnitTest {\n+  private static final String commandString = CliStrings.CLEAR_REGION;\n+  private static final String REPLICATE_REGION_NAME = \"replicateRegion\";\n+  private static final String PARTITIONED_REGION_NAME = \"partitionedRegion\";\n+  private static final String EMPTY_STRING = \"\";\n+\n+  @Rule\n+  public ClusterStartupRule clusterStartupRule = new ClusterStartupRule();\n+\n+  @Rule\n+  public GfshCommandRule gfsh = new GfshCommandRule();\n+\n+  private MemberVM locator;\n+  private MemberVM server1;\n+  private MemberVM server2;\n+\n+  @Before\n+  public void setup() throws Exception {\n+    locator = clusterStartupRule.startLocatorVM(0);\n+    server1 = clusterStartupRule.startServerVM(1, locator.getPort());\n+    server2 = clusterStartupRule.startServerVM(2, locator.getPort());\n+\n+    gfsh.connectAndVerify(locator);\n+    gfsh.executeAndAssertThat(\"create region --name=\" + REPLICATE_REGION_NAME + \" --type=REPLICATE\")\n+        .statusIsSuccess();\n+    gfsh.executeAndAssertThat(\n+        \"create region --name=\" + PARTITIONED_REGION_NAME + \" --type=PARTITION\").statusIsSuccess();\n+\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + REPLICATE_REGION_NAME, 2);\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + PARTITIONED_REGION_NAME, 2);\n+\n+    VMProvider.invokeInEveryMember(ClearCommandDUnitTest::populateTestRegions, server1, server2);\n+  }\n+\n+  private static void populateTestRegions() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU1OTgzMg==", "bodyText": "These test names could be a little more descriptive by including what the expected outcome of the test is i.e. clearInvalidRegionReturnsError.", "url": "https://github.com/apache/geode/pull/4818#discussion_r396559832", "createdAt": "2020-03-23T15:56:27Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/distributedTest/java/org/apache/geode/management/internal/cli/commands/ClearCommandDUnitTest.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.RemoveCommand.REGION_NOT_FOUND;\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.CacheFactory;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.test.dunit.rules.ClusterStartupRule;\n+import org.apache.geode.test.dunit.rules.MemberVM;\n+import org.apache.geode.test.junit.rules.GfshCommandRule;\n+import org.apache.geode.test.junit.rules.VMProvider;\n+\n+\n+public class ClearCommandDUnitTest {\n+  private static final String commandString = CliStrings.CLEAR_REGION;\n+  private static final String REPLICATE_REGION_NAME = \"replicateRegion\";\n+  private static final String PARTITIONED_REGION_NAME = \"partitionedRegion\";\n+  private static final String EMPTY_STRING = \"\";\n+\n+  @Rule\n+  public ClusterStartupRule clusterStartupRule = new ClusterStartupRule();\n+\n+  @Rule\n+  public GfshCommandRule gfsh = new GfshCommandRule();\n+\n+  private MemberVM locator;\n+  private MemberVM server1;\n+  private MemberVM server2;\n+\n+  @Before\n+  public void setup() throws Exception {\n+    locator = clusterStartupRule.startLocatorVM(0);\n+    server1 = clusterStartupRule.startServerVM(1, locator.getPort());\n+    server2 = clusterStartupRule.startServerVM(2, locator.getPort());\n+\n+    gfsh.connectAndVerify(locator);\n+    gfsh.executeAndAssertThat(\"create region --name=\" + REPLICATE_REGION_NAME + \" --type=REPLICATE\")\n+        .statusIsSuccess();\n+    gfsh.executeAndAssertThat(\n+        \"create region --name=\" + PARTITIONED_REGION_NAME + \" --type=PARTITION\").statusIsSuccess();\n+\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + REPLICATE_REGION_NAME, 2);\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + PARTITIONED_REGION_NAME, 2);\n+\n+    VMProvider.invokeInEveryMember(ClearCommandDUnitTest::populateTestRegions, server1, server2);\n+  }\n+\n+  private static void populateTestRegions() {\n+    Cache cache = CacheFactory.getAnyInstance();\n+\n+    Region<String, String> replicateRegion = cache.getRegion(REPLICATE_REGION_NAME);\n+    replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");\n+    replicateRegion.put(\"key1\", \"value1\");\n+    replicateRegion.put(\"key2\", \"value2\");\n+\n+    Region<String, String> partitionedRegion = cache.getRegion(PARTITIONED_REGION_NAME);\n+    partitionedRegion.put(\"key1\", \"value1\");\n+    partitionedRegion.put(\"key2\", \"value2\");\n+  }\n+\n+  @Test\n+  public void clearInvalidRegion() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU2MjE2MQ==", "bodyText": "Consider using CommandStringBuilder to create the gfsh commands, and referencing the CliStrings constants for the command options rather than hard-coding them.", "url": "https://github.com/apache/geode/pull/4818#discussion_r396562161", "createdAt": "2020-03-23T15:59:21Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/distributedTest/java/org/apache/geode/management/internal/cli/commands/ClearCommandDUnitTest.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.RemoveCommand.REGION_NOT_FOUND;\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.CacheFactory;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.test.dunit.rules.ClusterStartupRule;\n+import org.apache.geode.test.dunit.rules.MemberVM;\n+import org.apache.geode.test.junit.rules.GfshCommandRule;\n+import org.apache.geode.test.junit.rules.VMProvider;\n+\n+\n+public class ClearCommandDUnitTest {\n+  private static final String commandString = CliStrings.CLEAR_REGION;\n+  private static final String REPLICATE_REGION_NAME = \"replicateRegion\";\n+  private static final String PARTITIONED_REGION_NAME = \"partitionedRegion\";\n+  private static final String EMPTY_STRING = \"\";\n+\n+  @Rule\n+  public ClusterStartupRule clusterStartupRule = new ClusterStartupRule();\n+\n+  @Rule\n+  public GfshCommandRule gfsh = new GfshCommandRule();\n+\n+  private MemberVM locator;\n+  private MemberVM server1;\n+  private MemberVM server2;\n+\n+  @Before\n+  public void setup() throws Exception {\n+    locator = clusterStartupRule.startLocatorVM(0);\n+    server1 = clusterStartupRule.startServerVM(1, locator.getPort());\n+    server2 = clusterStartupRule.startServerVM(2, locator.getPort());\n+\n+    gfsh.connectAndVerify(locator);\n+    gfsh.executeAndAssertThat(\"create region --name=\" + REPLICATE_REGION_NAME + \" --type=REPLICATE\")\n+        .statusIsSuccess();\n+    gfsh.executeAndAssertThat(\n+        \"create region --name=\" + PARTITIONED_REGION_NAME + \" --type=PARTITION\").statusIsSuccess();\n+\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + REPLICATE_REGION_NAME, 2);\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + PARTITIONED_REGION_NAME, 2);\n+\n+    VMProvider.invokeInEveryMember(ClearCommandDUnitTest::populateTestRegions, server1, server2);\n+  }\n+\n+  private static void populateTestRegions() {\n+    Cache cache = CacheFactory.getAnyInstance();\n+\n+    Region<String, String> replicateRegion = cache.getRegion(REPLICATE_REGION_NAME);\n+    replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");\n+    replicateRegion.put(\"key1\", \"value1\");\n+    replicateRegion.put(\"key2\", \"value2\");\n+\n+    Region<String, String> partitionedRegion = cache.getRegion(PARTITIONED_REGION_NAME);\n+    partitionedRegion.put(\"key1\", \"value1\");\n+    partitionedRegion.put(\"key2\", \"value2\");\n+  }\n+\n+  @Test\n+  public void clearInvalidRegion() {\n+    String command = commandString + \" --region=NotAValidRegion\";\n+\n+    gfsh.executeAndAssertThat(command).statusIsError()\n+        .containsOutput(String.format(REGION_NOT_FOUND, \"/NotAValidRegion\"));\n+  }\n+\n+  @Test\n+  public void clearReplicateRegion() {\n+    String command = commandString + \" --region=\" + REPLICATE_REGION_NAME;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU4NTE0MA==", "bodyText": "Is there a reason that we're executing and asserting the success of this command? It doesn't seem related to the clear command.", "url": "https://github.com/apache/geode/pull/4818#discussion_r396585140", "createdAt": "2020-03-23T16:29:31Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/distributedTest/java/org/apache/geode/management/internal/cli/commands/ClearCommandDUnitTest.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.RemoveCommand.REGION_NOT_FOUND;\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.CacheFactory;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.test.dunit.rules.ClusterStartupRule;\n+import org.apache.geode.test.dunit.rules.MemberVM;\n+import org.apache.geode.test.junit.rules.GfshCommandRule;\n+import org.apache.geode.test.junit.rules.VMProvider;\n+\n+\n+public class ClearCommandDUnitTest {\n+  private static final String commandString = CliStrings.CLEAR_REGION;\n+  private static final String REPLICATE_REGION_NAME = \"replicateRegion\";\n+  private static final String PARTITIONED_REGION_NAME = \"partitionedRegion\";\n+  private static final String EMPTY_STRING = \"\";\n+\n+  @Rule\n+  public ClusterStartupRule clusterStartupRule = new ClusterStartupRule();\n+\n+  @Rule\n+  public GfshCommandRule gfsh = new GfshCommandRule();\n+\n+  private MemberVM locator;\n+  private MemberVM server1;\n+  private MemberVM server2;\n+\n+  @Before\n+  public void setup() throws Exception {\n+    locator = clusterStartupRule.startLocatorVM(0);\n+    server1 = clusterStartupRule.startServerVM(1, locator.getPort());\n+    server2 = clusterStartupRule.startServerVM(2, locator.getPort());\n+\n+    gfsh.connectAndVerify(locator);\n+    gfsh.executeAndAssertThat(\"create region --name=\" + REPLICATE_REGION_NAME + \" --type=REPLICATE\")\n+        .statusIsSuccess();\n+    gfsh.executeAndAssertThat(\n+        \"create region --name=\" + PARTITIONED_REGION_NAME + \" --type=PARTITION\").statusIsSuccess();\n+\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + REPLICATE_REGION_NAME, 2);\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + PARTITIONED_REGION_NAME, 2);\n+\n+    VMProvider.invokeInEveryMember(ClearCommandDUnitTest::populateTestRegions, server1, server2);\n+  }\n+\n+  private static void populateTestRegions() {\n+    Cache cache = CacheFactory.getAnyInstance();\n+\n+    Region<String, String> replicateRegion = cache.getRegion(REPLICATE_REGION_NAME);\n+    replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");\n+    replicateRegion.put(\"key1\", \"value1\");\n+    replicateRegion.put(\"key2\", \"value2\");\n+\n+    Region<String, String> partitionedRegion = cache.getRegion(PARTITIONED_REGION_NAME);\n+    partitionedRegion.put(\"key1\", \"value1\");\n+    partitionedRegion.put(\"key2\", \"value2\");\n+  }\n+\n+  @Test\n+  public void clearInvalidRegion() {\n+    String command = commandString + \" --region=NotAValidRegion\";\n+\n+    gfsh.executeAndAssertThat(command).statusIsError()\n+        .containsOutput(String.format(REGION_NOT_FOUND, \"/NotAValidRegion\"));\n+  }\n+\n+  @Test\n+  public void clearReplicateRegion() {\n+    String command = commandString + \" --region=\" + REPLICATE_REGION_NAME;\n+\n+    gfsh.executeAndAssertThat(\"list regions\").statusIsSuccess();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjYxNzI3MA==", "bodyText": "The \"Cleared all keys in the region\" string should ideally be extracted to a constant where it's defined so other places can refer to that rather than hard-coding.", "url": "https://github.com/apache/geode/pull/4818#discussion_r396617270", "createdAt": "2020-03-23T17:14:17Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/distributedTest/java/org/apache/geode/management/internal/cli/commands/ClearCommandDUnitTest.java", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.RemoveCommand.REGION_NOT_FOUND;\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.CacheFactory;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.test.dunit.rules.ClusterStartupRule;\n+import org.apache.geode.test.dunit.rules.MemberVM;\n+import org.apache.geode.test.junit.rules.GfshCommandRule;\n+import org.apache.geode.test.junit.rules.VMProvider;\n+\n+\n+public class ClearCommandDUnitTest {\n+  private static final String commandString = CliStrings.CLEAR_REGION;\n+  private static final String REPLICATE_REGION_NAME = \"replicateRegion\";\n+  private static final String PARTITIONED_REGION_NAME = \"partitionedRegion\";\n+  private static final String EMPTY_STRING = \"\";\n+\n+  @Rule\n+  public ClusterStartupRule clusterStartupRule = new ClusterStartupRule();\n+\n+  @Rule\n+  public GfshCommandRule gfsh = new GfshCommandRule();\n+\n+  private MemberVM locator;\n+  private MemberVM server1;\n+  private MemberVM server2;\n+\n+  @Before\n+  public void setup() throws Exception {\n+    locator = clusterStartupRule.startLocatorVM(0);\n+    server1 = clusterStartupRule.startServerVM(1, locator.getPort());\n+    server2 = clusterStartupRule.startServerVM(2, locator.getPort());\n+\n+    gfsh.connectAndVerify(locator);\n+    gfsh.executeAndAssertThat(\"create region --name=\" + REPLICATE_REGION_NAME + \" --type=REPLICATE\")\n+        .statusIsSuccess();\n+    gfsh.executeAndAssertThat(\n+        \"create region --name=\" + PARTITIONED_REGION_NAME + \" --type=PARTITION\").statusIsSuccess();\n+\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + REPLICATE_REGION_NAME, 2);\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + PARTITIONED_REGION_NAME, 2);\n+\n+    VMProvider.invokeInEveryMember(ClearCommandDUnitTest::populateTestRegions, server1, server2);\n+  }\n+\n+  private static void populateTestRegions() {\n+    Cache cache = CacheFactory.getAnyInstance();\n+\n+    Region<String, String> replicateRegion = cache.getRegion(REPLICATE_REGION_NAME);\n+    replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");\n+    replicateRegion.put(\"key1\", \"value1\");\n+    replicateRegion.put(\"key2\", \"value2\");\n+\n+    Region<String, String> partitionedRegion = cache.getRegion(PARTITIONED_REGION_NAME);\n+    partitionedRegion.put(\"key1\", \"value1\");\n+    partitionedRegion.put(\"key2\", \"value2\");\n+  }\n+\n+  @Test\n+  public void clearInvalidRegion() {\n+    String command = commandString + \" --region=NotAValidRegion\";\n+\n+    gfsh.executeAndAssertThat(command).statusIsError()\n+        .containsOutput(String.format(REGION_NOT_FOUND, \"/NotAValidRegion\"));\n+  }\n+\n+  @Test\n+  public void clearReplicateRegion() {\n+    String command = commandString + \" --region=\" + REPLICATE_REGION_NAME;\n+\n+    gfsh.executeAndAssertThat(\"list regions\").statusIsSuccess();\n+    gfsh.executeAndAssertThat(command).statusIsSuccess();\n+\n+    assertThat(gfsh.getGfshOutput()).contains(\"Cleared all keys in the region\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "466cc1b86b3183a2d738467e9cb9c68bdd41dc1b"}, "originalPosition": 96}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwOTE0MTY3", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-390914167", "createdAt": "2020-04-09T15:46:12Z", "commit": {"oid": "9cf25a867902099e8f64e76d573c9df4c71a49fd"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNTo0NjoxMlrOGDenWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNTo0NjoxN1rOGDenjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMwMDUwNQ==", "bodyText": "I know this wasn't something introduced in this commit, but I feel that this naming was a typo and should be REMOVE__MSG__CLEARED_ALL_KEYS", "url": "https://github.com/apache/geode/pull/4818#discussion_r406300505", "createdAt": "2020-04-09T15:46:12Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/main/java/org/apache/geode/management/internal/i18n/CliStrings.java", "diffHunk": "@@ -1924,9 +1924,7 @@\n   public static final String REMOVE__MSG__CLEARED_ALL_CLEARS = \"Cleared all keys in the region\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cf25a867902099e8f64e76d573c9df4c71a49fd"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMwMDU1Ng==", "bodyText": "If we're executing and asserting, we should assert that the command is successful. If we don't care if the command succeeds or not, we should just use execute(). I think that in this case, we probably do care about the status of the command.", "url": "https://github.com/apache/geode/pull/4818#discussion_r406300556", "createdAt": "2020-04-09T15:46:17Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/distributedTest/java/org/apache/geode/management/internal/cli/commands/ClearCommandDUnitTest.java", "diffHunk": "@@ -70,43 +72,49 @@ private static void populateTestRegions() {\n \n     Region<String, String> replicateRegion = cache.getRegion(REPLICATE_REGION_NAME);\n     replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");\n-    replicateRegion.put(\"key1\", \"value1\");\n-    replicateRegion.put(\"key2\", \"value2\");\n+    for(int i = 0; i < NUM_ENTRIES; i++) {\n+      replicateRegion.put(\"key\" + i, \"value\" + i);\n+    }\n \n     Region<String, String> partitionedRegion = cache.getRegion(PARTITIONED_REGION_NAME);\n-    partitionedRegion.put(\"key1\", \"value1\");\n-    partitionedRegion.put(\"key2\", \"value2\");\n+    replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");\n+    for(int i = 0; i < NUM_ENTRIES; i++) {\n+      partitionedRegion.put(\"key\" + i, \"value\" + i);\n+    }\n   }\n \n   @Test\n-  public void clearInvalidRegion() {\n-    String command = commandString + \" --region=NotAValidRegion\";\n-\n+  public void clearFailsWhenRegionIsNotFound() {\n+    String invalidRegionName = \"NotAValidRegion\";\n+    String command = new CommandStringBuilder(CliStrings.CLEAR)\n+        .addOption(CliStrings.CLEAR_REGION_NAME, invalidRegionName).getCommandString();\n     gfsh.executeAndAssertThat(command).statusIsError()\n-        .containsOutput(String.format(REGION_NOT_FOUND, \"/NotAValidRegion\"));\n+        .containsOutput(String.format(REGION_NOT_FOUND, \"/\" + invalidRegionName));\n   }\n \n   @Test\n-  public void clearReplicateRegion() {\n-    String command = commandString + \" --region=\" + REPLICATE_REGION_NAME;\n+  public void clearSucceedsWithValidReplicateRegion() {\n+    String command = new CommandStringBuilder(CliStrings.CLEAR)\n+        .addOption(CliStrings.CLEAR_REGION_NAME, REPLICATE_REGION_NAME).getCommandString();\n \n-    gfsh.executeAndAssertThat(\"list regions\").statusIsSuccess();\n+    gfsh.executeAndAssertThat(\"list regions\");\n     gfsh.executeAndAssertThat(command).statusIsSuccess();\n \n-    assertThat(gfsh.getGfshOutput()).contains(\"Cleared all keys in the region\");\n+    assertThat(gfsh.getGfshOutput()).contains(REMOVE__MSG__CLEARED_ALL_CLEARS);\n \n     server1.invoke(() -> verifyAllKeysAreRemoved(REPLICATE_REGION_NAME));\n     server2.invoke(() -> verifyAllKeysAreRemoved(REPLICATE_REGION_NAME));\n   }\n \n \n   @Test\n-  public void clearPartitionedRegion() {\n-    String command = commandString + \" --region=\" + PARTITIONED_REGION_NAME;\n+  public void clearSucceedsWithValidPartitionedRegion() {\n+    String command = new CommandStringBuilder(CliStrings.CLEAR)\n+        .addOption(CliStrings.CLEAR_REGION_NAME, PARTITIONED_REGION_NAME).getCommandString();\n \n-    gfsh.executeAndAssertThat(command).statusIsSuccess();\n+    gfsh.executeAndAssertThat(command);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cf25a867902099e8f64e76d573c9df4c71a49fd"}, "originalPosition": 87}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "679895d577209d1df58168015f329cd466c404a8", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/679895d577209d1df58168015f329cd466c404a8", "committedDate": "2020-04-21T04:50:03Z", "message": "Additional PR request changes"}, "afterCommit": {"oid": "8c779a74f7c3260300751d62dc61f0125268a9f3", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/8c779a74f7c3260300751d62dc61f0125268a9f3", "committedDate": "2020-04-21T04:56:57Z", "message": "Additional PR request changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NTM1Nzc1", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-397535775", "createdAt": "2020-04-21T17:47:28Z", "commit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "state": "COMMENTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNzo0NzoyOFrOGJQt8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxODo0NDoyM1rOGJTGoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM2NDI3Mw==", "bodyText": "Remove the \"BR\" here.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412364273", "createdAt": "2020-04-21T17:47:28Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/functions/DataCommandFunction.java", "diffHunk": "@@ -276,7 +276,7 @@ public DataCommandResult remove(String key, String keyClass, String regionName,\n \n     if (StringUtils.isEmpty(removeAllKeys) && (key == null)) {\n       return DataCommandResult.createRemoveResult(null, null, null,\n-          CliStrings.REMOVE__MSG__KEY_EMPTY, false);\n+          \"BR\" + CliStrings.REMOVE__MSG__KEY_EMPTY, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM2NjMyNQ==", "bodyText": "Shouldn't the clear command be using the clear function instead of remove?", "url": "https://github.com/apache/geode/pull/4818#discussion_r412366325", "createdAt": "2020-04-21T17:50:29Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/commands/ClearCommand.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.DataCommandsUtils.callFunctionForRegion;\n+\n+import java.util.Set;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.springframework.shell.core.annotation.CliCommand;\n+import org.springframework.shell.core.annotation.CliOption;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.cli.CliMetaData;\n+import org.apache.geode.management.cli.ConverterHint;\n+import org.apache.geode.management.cli.GfshCommand;\n+import org.apache.geode.management.internal.cli.domain.DataCommandRequest;\n+import org.apache.geode.management.internal.cli.domain.DataCommandResult;\n+import org.apache.geode.management.internal.cli.functions.DataCommandFunction;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.security.ResourcePermission.Operation;\n+import org.apache.geode.security.ResourcePermission.Resource;\n+\n+public class ClearCommand extends GfshCommand {\n+  public static final String REGION_NOT_FOUND = \"Region <%s> not found in any of the members\";\n+\n+  @CliMetaData(relatedTopic = {CliStrings.TOPIC_GEODE_DATA, CliStrings.TOPIC_GEODE_REGION})\n+  @CliCommand(value = {CliStrings.CLEAR}, help = CliStrings.CLEAR_HELP)\n+  public ResultModel clear(\n+      @CliOption(key = {CliStrings.CLEAR_REGION_NAME}, mandatory = true,\n+          help = CliStrings.CLEAR_REGION_NAME_HELP,\n+          optionContext = ConverterHint.REGION_PATH) String regionPath) {\n+\n+    Cache cache = getCache();\n+\n+    authorize(Resource.DATA, Operation.WRITE, regionPath);\n+\n+\n+    Region region = cache.getRegion(regionPath);\n+    DataCommandFunction clearfn = new DataCommandFunction();\n+    DataCommandResult dataResult;\n+    if (region == null) {\n+      Set<DistributedMember> memberList = findAnyMembersForRegion(regionPath);\n+\n+      if (CollectionUtils.isEmpty(memberList)) {\n+        return new ResultModel().createError(String.format(REGION_NOT_FOUND, regionPath));\n+      }\n+\n+      DataCommandRequest request = new DataCommandRequest();\n+      request.setCommand(CliStrings.REMOVE);\n+      request.setRemoveAllKeys(\"ALL\");\n+      request.setRegionName(regionPath);\n+      dataResult = callFunctionForRegion(request, clearfn, memberList);\n+    } else {\n+      dataResult = clearfn.remove(null, null, regionPath, \"ALL\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM3MDI3Ng==", "bodyText": "This variable is never used.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412370276", "createdAt": "2020-04-21T17:55:54Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/functions/DataCommandFunction.java", "diffHunk": "@@ -313,22 +313,21 @@ public DataCommandResult remove(String key, String keyClass, String regionName,\n               CliStrings.REMOVE__MSG__KEY_NOT_FOUND_REGION, false);\n         }\n       } else {\n-        DataPolicy policy = region.getAttributes().getDataPolicy();\n-        if (!policy.withPartitioning()) {\n-          region.clear();\n-          if (logger.isDebugEnabled()) {\n-            logger.debug(\"Cleared all keys in the region - {}\", regionName);\n-          }\n-          return DataCommandResult.createRemoveInfoResult(key, null, null,\n-              CliStrings.format(CliStrings.REMOVE__MSG__CLEARED_ALL_CLEARS, regionName), true);\n-        } else {\n-          return DataCommandResult.createRemoveInfoResult(key, null, null,\n-              CliStrings.REMOVE__MSG__CLEARALL_NOT_SUPPORTED_FOR_PARTITIONREGION, false);\n-        }\n+        return clear(region, regionName);\n       }\n     }\n   }\n \n+  public DataCommandResult clear(Region region, String regionName) {\n+    DataPolicy policy = region.getAttributes().getDataPolicy();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM5MTc0MA==", "bodyText": "It might be best to rename and move this constant to reflect that going forward, only the clear command should be using the message, since remove --all is now deprecated.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412391740", "createdAt": "2020-04-21T18:26:46Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/main/java/org/apache/geode/management/internal/i18n/CliStrings.java", "diffHunk": "@@ -1914,9 +1921,10 @@\n   public static final String REMOVE__MSG__KEY_EMPTY = \"Key is Null\";\n   public static final String REMOVE__MSG__REGION_NOT_FOUND = \"Region <{0}> Not Found\";\n   public static final String REMOVE__MSG__KEY_NOT_FOUND_REGION = \"Key is not present in the region\";\n-  public static final String REMOVE__MSG__CLEARED_ALL_CLEARS = \"Cleared all keys in the region\";\n-  public static final String REMOVE__MSG__CLEARALL_NOT_SUPPORTED_FOR_PARTITIONREGION =\n-      \"Option --\" + REMOVE__ALL + \" is not supported on partitioned region\";\n+  public static final String REMOVE__MSG__CLEARED_ALL_KEYS = \"Cleared all keys in the region\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM5MjYyMg==", "bodyText": "new is not needed here, since createError is a static call.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412392622", "createdAt": "2020-04-21T18:28:07Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/commands/ClearCommand.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.DataCommandsUtils.callFunctionForRegion;\n+\n+import java.util.Set;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.springframework.shell.core.annotation.CliCommand;\n+import org.springframework.shell.core.annotation.CliOption;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.cli.CliMetaData;\n+import org.apache.geode.management.cli.ConverterHint;\n+import org.apache.geode.management.cli.GfshCommand;\n+import org.apache.geode.management.internal.cli.domain.DataCommandRequest;\n+import org.apache.geode.management.internal.cli.domain.DataCommandResult;\n+import org.apache.geode.management.internal.cli.functions.DataCommandFunction;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.security.ResourcePermission.Operation;\n+import org.apache.geode.security.ResourcePermission.Resource;\n+\n+public class ClearCommand extends GfshCommand {\n+  public static final String REGION_NOT_FOUND = \"Region <%s> not found in any of the members\";\n+\n+  @CliMetaData(relatedTopic = {CliStrings.TOPIC_GEODE_DATA, CliStrings.TOPIC_GEODE_REGION})\n+  @CliCommand(value = {CliStrings.CLEAR}, help = CliStrings.CLEAR_HELP)\n+  public ResultModel clear(\n+      @CliOption(key = {CliStrings.CLEAR_REGION_NAME}, mandatory = true,\n+          help = CliStrings.CLEAR_REGION_NAME_HELP,\n+          optionContext = ConverterHint.REGION_PATH) String regionPath) {\n+\n+    Cache cache = getCache();\n+\n+    authorize(Resource.DATA, Operation.WRITE, regionPath);\n+\n+\n+    Region region = cache.getRegion(regionPath);\n+    DataCommandFunction clearfn = new DataCommandFunction();\n+    DataCommandResult dataResult;\n+    if (region == null) {\n+      Set<DistributedMember> memberList = findAnyMembersForRegion(regionPath);\n+\n+      if (CollectionUtils.isEmpty(memberList)) {\n+        return new ResultModel().createError(String.format(REGION_NOT_FOUND, regionPath));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM5NTI5MA==", "bodyText": "These tests could be replaced with a single parameterized version, which would prevent code duplication, and also allow easy addition of other region types, such as those using persistence, should the test need to be expanded to cover them.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412395290", "createdAt": "2020-04-21T18:32:01Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/distributedTest/java/org/apache/geode/management/internal/cli/commands/ClearCommandDUnitTest.java", "diffHunk": "@@ -0,0 +1,130 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.RemoveCommand.REGION_NOT_FOUND;\n+import static org.apache.geode.management.internal.i18n.CliStrings.REMOVE__MSG__CLEARED_ALL_KEYS;\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.CacheFactory;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.management.internal.cli.util.CommandStringBuilder;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.test.dunit.rules.ClusterStartupRule;\n+import org.apache.geode.test.dunit.rules.MemberVM;\n+import org.apache.geode.test.junit.rules.GfshCommandRule;\n+import org.apache.geode.test.junit.rules.VMProvider;\n+\n+\n+public class ClearCommandDUnitTest {\n+  private static final String REPLICATE_REGION_NAME = \"replicateRegion\";\n+  private static final String PARTITIONED_REGION_NAME = \"partitionedRegion\";\n+  private static final String EMPTY_STRING = \"\";\n+  private static final int NUM_ENTRIES = 200;\n+\n+  @Rule\n+  public ClusterStartupRule clusterStartupRule = new ClusterStartupRule();\n+\n+  @Rule\n+  public GfshCommandRule gfsh = new GfshCommandRule();\n+\n+  private MemberVM locator;\n+  private MemberVM server1;\n+  private MemberVM server2;\n+\n+  @Before\n+  public void setup() throws Exception {\n+    locator = clusterStartupRule.startLocatorVM(0);\n+    server1 = clusterStartupRule.startServerVM(1, locator.getPort());\n+    server2 = clusterStartupRule.startServerVM(2, locator.getPort());\n+\n+    gfsh.connectAndVerify(locator);\n+    gfsh.executeAndAssertThat(\"create region --name=\" + REPLICATE_REGION_NAME + \" --type=REPLICATE\")\n+        .statusIsSuccess();\n+    gfsh.executeAndAssertThat(\n+        \"create region --name=\" + PARTITIONED_REGION_NAME + \" --type=PARTITION\").statusIsSuccess();\n+\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + REPLICATE_REGION_NAME, 2);\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + PARTITIONED_REGION_NAME, 2);\n+\n+    VMProvider.invokeInEveryMember(ClearCommandDUnitTest::populateTestRegions, server1, server2);\n+  }\n+\n+  private static void populateTestRegions() {\n+    Cache cache = CacheFactory.getAnyInstance();\n+\n+    Region<String, String> replicateRegion = cache.getRegion(REPLICATE_REGION_NAME);\n+    replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");\n+    for (int i = 0; i < NUM_ENTRIES; i++) {\n+      replicateRegion.put(\"key\" + i, \"value\" + i);\n+    }\n+\n+    Region<String, String> partitionedRegion = cache.getRegion(PARTITIONED_REGION_NAME);\n+    replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");\n+    for (int i = 0; i < NUM_ENTRIES; i++) {\n+      partitionedRegion.put(\"key\" + i, \"value\" + i);\n+    }\n+  }\n+\n+  @Test\n+  public void clearFailsWhenRegionIsNotFound() {\n+    String invalidRegionName = \"NotAValidRegion\";\n+    String command = new CommandStringBuilder(CliStrings.CLEAR)\n+        .addOption(CliStrings.CLEAR_REGION_NAME, invalidRegionName).getCommandString();\n+    gfsh.executeAndAssertThat(command).statusIsError()\n+        .containsOutput(String.format(REGION_NOT_FOUND, \"/\" + invalidRegionName));\n+  }\n+\n+  @Test\n+  public void clearSucceedsWithValidReplicateRegion() {\n+    String command = new CommandStringBuilder(CliStrings.CLEAR)\n+        .addOption(CliStrings.CLEAR_REGION_NAME, REPLICATE_REGION_NAME).getCommandString();\n+\n+    gfsh.executeAndAssertThat(command).statusIsSuccess();\n+\n+    assertThat(gfsh.getGfshOutput()).contains(REMOVE__MSG__CLEARED_ALL_KEYS);\n+\n+    server1.invoke(() -> verifyAllKeysAreRemoved(REPLICATE_REGION_NAME));\n+    server2.invoke(() -> verifyAllKeysAreRemoved(REPLICATE_REGION_NAME));\n+  }\n+\n+\n+  @Test\n+  public void clearSucceedsWithValidPartitionedRegion() {\n+    String command = new CommandStringBuilder(CliStrings.CLEAR)\n+        .addOption(CliStrings.CLEAR_REGION_NAME, PARTITIONED_REGION_NAME).getCommandString();\n+\n+    gfsh.executeAndAssertThat(command).statusIsSuccess();\n+\n+    assertThat(gfsh.getGfshOutput()).contains(REMOVE__MSG__CLEARED_ALL_KEYS);\n+\n+    server1.invoke(() -> verifyAllKeysAreRemoved(PARTITIONED_REGION_NAME));\n+    server2.invoke(() -> verifyAllKeysAreRemoved(PARTITIONED_REGION_NAME));\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM5NjkzMQ==", "bodyText": "Setting the value of result here is redundant, since it will always be assigned in the if/else block below.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412396931", "createdAt": "2020-04-21T18:34:38Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/commands/RemoveCommand.java", "diffHunk": "@@ -90,7 +90,14 @@ public ResultModel remove(\n     }\n \n     dataResult.setKeyClass(keyClass);\n+    ResultModel result = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM5NzU0NQ==", "bodyText": "This method is currently not being used anywhere.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412397545", "createdAt": "2020-04-21T18:35:42Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/domain/DataCommandResult.java", "diffHunk": "@@ -240,6 +242,16 @@ public static DataCommandResult createRemoveResult(Object inputKey, Object value\n     return result;\n   }\n \n+  public static DataCommandResult createClearResult(Throwable error, String errorString,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQwMDA3Mw==", "bodyText": "It might be more consistent to either call setHeader here instead of addInfo, or to rename HEADER_INFO_SECTION to WARNING_INFO_SECTION or something similar.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412400073", "createdAt": "2020-04-21T18:39:32Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/main/java/org/apache/geode/management/internal/cli/domain/DataCommandResult.java", "diffHunk": "@@ -381,6 +397,12 @@ public ResultModel toResultModel() {\n     }\n \n     ResultModel result = new ResultModel();\n+\n+    if (warningMessage != null && !warningMessage.isEmpty()) {\n+      InfoResultModel info = result.addInfo(HEADER_INFO_SECTION);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQwMzM2MQ==", "bodyText": "Is there a particular reason we put a value with an empty string as the key here? Just curious.", "url": "https://github.com/apache/geode/pull/4818#discussion_r412403361", "createdAt": "2020-04-21T18:44:23Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/distributedTest/java/org/apache/geode/management/internal/cli/commands/ClearCommandDUnitTest.java", "diffHunk": "@@ -0,0 +1,130 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.cli.commands.RemoveCommand.REGION_NOT_FOUND;\n+import static org.apache.geode.management.internal.i18n.CliStrings.REMOVE__MSG__CLEARED_ALL_KEYS;\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.CacheFactory;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.management.internal.cli.util.CommandStringBuilder;\n+import org.apache.geode.management.internal.i18n.CliStrings;\n+import org.apache.geode.test.dunit.rules.ClusterStartupRule;\n+import org.apache.geode.test.dunit.rules.MemberVM;\n+import org.apache.geode.test.junit.rules.GfshCommandRule;\n+import org.apache.geode.test.junit.rules.VMProvider;\n+\n+\n+public class ClearCommandDUnitTest {\n+  private static final String REPLICATE_REGION_NAME = \"replicateRegion\";\n+  private static final String PARTITIONED_REGION_NAME = \"partitionedRegion\";\n+  private static final String EMPTY_STRING = \"\";\n+  private static final int NUM_ENTRIES = 200;\n+\n+  @Rule\n+  public ClusterStartupRule clusterStartupRule = new ClusterStartupRule();\n+\n+  @Rule\n+  public GfshCommandRule gfsh = new GfshCommandRule();\n+\n+  private MemberVM locator;\n+  private MemberVM server1;\n+  private MemberVM server2;\n+\n+  @Before\n+  public void setup() throws Exception {\n+    locator = clusterStartupRule.startLocatorVM(0);\n+    server1 = clusterStartupRule.startServerVM(1, locator.getPort());\n+    server2 = clusterStartupRule.startServerVM(2, locator.getPort());\n+\n+    gfsh.connectAndVerify(locator);\n+    gfsh.executeAndAssertThat(\"create region --name=\" + REPLICATE_REGION_NAME + \" --type=REPLICATE\")\n+        .statusIsSuccess();\n+    gfsh.executeAndAssertThat(\n+        \"create region --name=\" + PARTITIONED_REGION_NAME + \" --type=PARTITION\").statusIsSuccess();\n+\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + REPLICATE_REGION_NAME, 2);\n+    locator.waitUntilRegionIsReadyOnExactlyThisManyServers(\"/\" + PARTITIONED_REGION_NAME, 2);\n+\n+    VMProvider.invokeInEveryMember(ClearCommandDUnitTest::populateTestRegions, server1, server2);\n+  }\n+\n+  private static void populateTestRegions() {\n+    Cache cache = CacheFactory.getAnyInstance();\n+\n+    Region<String, String> replicateRegion = cache.getRegion(REPLICATE_REGION_NAME);\n+    replicateRegion.put(EMPTY_STRING, \"valueForEmptyKey\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NjQ2MjY1", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-398646265", "createdAt": "2020-04-22T22:55:01Z", "commit": {"oid": "6fc549d065a63d60802b2148eb5e2013220784b6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMjo1NTowMVrOGKPKjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMjo1NjoxMlrOGKPMsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM4NzQwNw==", "bodyText": "I think that several of these renames were accidentally included when changing the Cli string. They should be put back how they were.", "url": "https://github.com/apache/geode/pull/4818#discussion_r413387407", "createdAt": "2020-04-22T22:55:01Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/distributedTest/java/org/apache/geode/cache30/RegionReliabilityTestCase.java", "diffHunk": "@@ -1341,7 +1341,7 @@ public void run() {\n       // pass\n     }\n \n-    // CLEAR\n+    // CLEAR_REGION", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc549d065a63d60802b2148eb5e2013220784b6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM4NzUzOQ==", "bodyText": "Another accidental rename.", "url": "https://github.com/apache/geode/pull/4818#discussion_r413387539", "createdAt": "2020-04-22T22:55:21Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/distributedTest/java/org/apache/geode/internal/cache/ClearRvvLockingDUnitTest.java", "diffHunk": "@@ -51,7 +51,7 @@\n \n /**\n  * Test class to verify proper RVV locking interaction between entry operations such as PUT/REMOVE\n- * and the CLEAR region operation\n+ * and the CLEAR_REGION region operation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc549d065a63d60802b2148eb5e2013220784b6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM4Nzc3Mw==", "bodyText": "More accidental renames in this file.", "url": "https://github.com/apache/geode/pull/4818#discussion_r413387773", "createdAt": "2020-04-22T22:55:52Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/distributedTest/java/org/apache/geode/internal/cache/ClearTXLockingDUnitTest.java", "diffHunk": "@@ -43,19 +43,20 @@\n import org.apache.geode.test.dunit.rules.DistributedRule;\n \n /**\n- * Test class to verify proper locking interaction between transactions and the CLEAR region\n+ * Test class to verify proper locking interaction between transactions and the CLEAR_REGION region", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc549d065a63d60802b2148eb5e2013220784b6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM4Nzk1Mg==", "bodyText": "Accidental rename.", "url": "https://github.com/apache/geode/pull/4818#discussion_r413387952", "createdAt": "2020-04-22T22:56:12Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/main/java/org/apache/geode/internal/cache/DiskStoreImpl.java", "diffHunk": "@@ -3509,7 +3509,7 @@ public String toString() {\n       if (de != null) {\n         sb.append(\" key=\").append(de.getKey());\n       } else {\n-        sb.append(\" <END CLEAR>\");\n+        sb.append(\" <END CLEAR_REGION>\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc549d065a63d60802b2148eb5e2013220784b6"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMjY4NTg4", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-400268588", "createdAt": "2020-04-24T21:02:28Z", "commit": {"oid": "977782154b33e2686a0dc949442c1cea2188a771"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMTowMjoyOFrOGLpIMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMTowNDozMVrOGLpMLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg2MTM2Mg==", "bodyText": "This feels like more of an integration test as it's currently written, since it's not directly testing the ClearCommand class but rather how that class is used by gfsh. Instead of using gfsh.executeAndAssertThat, it might better to call ClearCommand.clear() directly and assert on the returned ResultModel.\nIt would also be good to verify that callFunctionForRegion() and clearfn.remove() are called with the expected/correct arguments, rater than just asserting the success/failure of the command, since otherwise the last two test cases end up being indistinguishable in terms of what they're asserting and the actual difference in behaviour between the two code paths isn't being verified.", "url": "https://github.com/apache/geode/pull/4818#discussion_r414861362", "createdAt": "2020-04-24T21:02:28Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/test/java/org/apache/geode/management/internal/cli/commands/ClearCommandTest.java", "diffHunk": "@@ -0,0 +1,93 @@\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.i18n.CliStrings.CLEAR_REGION;\n+import static org.apache.geode.management.internal.i18n.CliStrings.CLEAR_REGION_REGION_NAME;\n+import static org.apache.geode.management.internal.cli.commands.ClearCommand.REGION_NOT_FOUND;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.ArgumentMatchers.anyString;\n+import static org.mockito.Mockito.doNothing;\n+import static org.mockito.Mockito.doReturn;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.spy;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.internal.cli.domain.DataCommandRequest;\n+import org.apache.geode.management.internal.cli.domain.DataCommandResult;\n+import org.apache.geode.management.internal.cli.functions.DataCommandFunction;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.test.junit.rules.GfshParserRule;\n+\n+public class ClearCommandTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "977782154b33e2686a0dc949442c1cea2188a771"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg2MTg5Ng==", "bodyText": "It's not necessary to specify the DistributedMember here, since it's implicit in the declaration of the membersList set.", "url": "https://github.com/apache/geode/pull/4818#discussion_r414861896", "createdAt": "2020-04-24T21:03:25Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/test/java/org/apache/geode/management/internal/cli/commands/ClearCommandTest.java", "diffHunk": "@@ -0,0 +1,93 @@\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.i18n.CliStrings.CLEAR_REGION;\n+import static org.apache.geode.management.internal.i18n.CliStrings.CLEAR_REGION_REGION_NAME;\n+import static org.apache.geode.management.internal.cli.commands.ClearCommand.REGION_NOT_FOUND;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.ArgumentMatchers.anyString;\n+import static org.mockito.Mockito.doNothing;\n+import static org.mockito.Mockito.doReturn;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.spy;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.internal.cli.domain.DataCommandRequest;\n+import org.apache.geode.management.internal.cli.domain.DataCommandResult;\n+import org.apache.geode.management.internal.cli.functions.DataCommandFunction;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.test.junit.rules.GfshParserRule;\n+\n+public class ClearCommandTest {\n+\n+  @ClassRule\n+  public static GfshParserRule gfsh = new GfshParserRule();\n+\n+  static final String regionName = \"regionName\";\n+  static final String success = \"SUCCESS\";\n+\n+  InternalCache cache;\n+  ClearCommand command;\n+  Region region;\n+  Set<DistributedMember> membersList;\n+  DistributedMember member;\n+  DataCommandResult dataResult;\n+\n+  @Before\n+  public void setup() {\n+    cache = mock(InternalCache.class);\n+    command = spy(new ClearCommand());\n+    region = mock(Region.class);\n+    dataResult = mock(DataCommandResult.class);\n+\n+    membersList = new HashSet<DistributedMember>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "977782154b33e2686a0dc949442c1cea2188a771"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg2MjM4MA==", "bodyText": "To prevent compiler warnings, this should probably be Region<Object, Object> and a @SuppressWarnings(\"unchecked\") tag should be added to the setup() method.", "url": "https://github.com/apache/geode/pull/4818#discussion_r414862380", "createdAt": "2020-04-24T21:04:31Z", "author": {"login": "DonalEvans"}, "path": "geode-gfsh/src/test/java/org/apache/geode/management/internal/cli/commands/ClearCommandTest.java", "diffHunk": "@@ -0,0 +1,93 @@\n+package org.apache.geode.management.internal.cli.commands;\n+\n+import static org.apache.geode.management.internal.i18n.CliStrings.CLEAR_REGION;\n+import static org.apache.geode.management.internal.i18n.CliStrings.CLEAR_REGION_REGION_NAME;\n+import static org.apache.geode.management.internal.cli.commands.ClearCommand.REGION_NOT_FOUND;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.ArgumentMatchers.anyString;\n+import static org.mockito.Mockito.doNothing;\n+import static org.mockito.Mockito.doReturn;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.spy;\n+import static org.mockito.Mockito.when;\n+\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Cache;\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.distributed.DistributedMember;\n+import org.apache.geode.internal.cache.InternalCache;\n+import org.apache.geode.management.internal.cli.domain.DataCommandRequest;\n+import org.apache.geode.management.internal.cli.domain.DataCommandResult;\n+import org.apache.geode.management.internal.cli.functions.DataCommandFunction;\n+import org.apache.geode.management.internal.cli.result.model.ResultModel;\n+import org.apache.geode.test.junit.rules.GfshParserRule;\n+\n+public class ClearCommandTest {\n+\n+  @ClassRule\n+  public static GfshParserRule gfsh = new GfshParserRule();\n+\n+  static final String regionName = \"regionName\";\n+  static final String success = \"SUCCESS\";\n+\n+  InternalCache cache;\n+  ClearCommand command;\n+  Region region;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "977782154b33e2686a0dc949442c1cea2188a771"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0867b8814e968c1e5a8e73329ad864fe92e626f", "author": {"user": {"login": "DonalEvans", "name": "Donal Evans"}}, "url": "https://github.com/apache/geode/commit/a0867b8814e968c1e5a8e73329ad864fe92e626f", "committedDate": "2020-04-30T16:17:14Z", "message": "Added clear command and modified remove functionality to clear PR\n\nAuthored-by: Benjamin Ross <bross@pivotal.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51e3b47e9d56b3278715402a1c8a21800244ea96", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/51e3b47e9d56b3278715402a1c8a21800244ea96", "committedDate": "2020-04-30T16:17:14Z", "message": "Fixed spA and rat failures\n\nCo-authored-by: Benjamin Ross <bross@pivotal.io>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "290592d72497647839a6bb8a19c0482ef6d2d9d7", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/290592d72497647839a6bb8a19c0482ef6d2d9d7", "committedDate": "2020-04-30T16:17:14Z", "message": "Removed unnessessary code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "402852d8cad2c90cd1fdae90f0771dcef9879d6e", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/402852d8cad2c90cd1fdae90f0771dcef9879d6e", "committedDate": "2020-04-30T16:17:14Z", "message": "Fixed GfshParser test failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "779610b462a131358d6be5491658ae545cf29d41", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/779610b462a131358d6be5491658ae545cf29d41", "committedDate": "2020-04-30T16:17:14Z", "message": "Changes to address PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c352047409d28b1274c5c22b91d04530130bd3b6", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/c352047409d28b1274c5c22b91d04530130bd3b6", "committedDate": "2020-04-30T16:17:14Z", "message": "Additional PR request changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cf3f735c18c4c596e7217d3884fe4ed6b079e0d", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/6cf3f735c18c4c596e7217d3884fe4ed6b079e0d", "committedDate": "2020-04-30T16:17:14Z", "message": "Spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c825574438ced15ae9a9e7899be8038a6ae7f824", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/c825574438ced15ae9a9e7899be8038a6ae7f824", "committedDate": "2020-04-30T16:17:14Z", "message": "Changed 'clear' back to 'clear region'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4545ae01859d8be8cc6e2b8a96315bd31c413d2d", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/4545ae01859d8be8cc6e2b8a96315bd31c413d2d", "committedDate": "2020-04-30T16:17:15Z", "message": "Additional PR changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f59079f96b63e4f6d9cf74c65428e6a4f9956d0f", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/f59079f96b63e4f6d9cf74c65428e6a4f9956d0f", "committedDate": "2020-04-30T16:17:15Z", "message": "Add unit test for ClearCommand class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f84475a9d05870346df76b84a17041b74d0c2a7f", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/f84475a9d05870346df76b84a17041b74d0c2a7f", "committedDate": "2020-04-30T16:17:15Z", "message": "Additional PR request changes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4e0c3df89898777020d61aa08f5914c64a812e94", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/4e0c3df89898777020d61aa08f5914c64a812e94", "committedDate": "2020-04-29T18:03:30Z", "message": "Additional PR request changes"}, "afterCommit": {"oid": "f84475a9d05870346df76b84a17041b74d0c2a7f", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/f84475a9d05870346df76b84a17041b74d0c2a7f", "committedDate": "2020-04-30T16:17:15Z", "message": "Additional PR request changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNjY5OTE1", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-403669915", "createdAt": "2020-04-30T16:10:55Z", "commit": {"oid": "4e0c3df89898777020d61aa08f5914c64a812e94"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoxMDo1NVrOGOwXIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoxNDozMlrOGOwgWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyNTYwMw==", "bodyText": "Here. Also consider fixing the formatting on the comment, since spotless has kind of messed it up following the accidental rename.", "url": "https://github.com/apache/geode/pull/4818#discussion_r418125603", "createdAt": "2020-04-30T16:10:55Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/distributedTest/java/org/apache/geode/internal/cache/ClearTXLockingDUnitTest.java", "diffHunk": "@@ -49,13 +49,14 @@\n  * <p>\n  * GEODE-1740: It was observed that operations performed within a transaction were not holding\n  * region modification locks for the duration of commit processing. This lock is used to ensure\n- * region consistency during CLEAR processing. By not holding the lock for the duration of commit\n+ * region consistency during CLEAR_REGION processing. By not holding the lock for the duration of", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e0c3df89898777020d61aa08f5914c64a812e94"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyNTY3OQ==", "bodyText": "Here.", "url": "https://github.com/apache/geode/pull/4818#discussion_r418125679", "createdAt": "2020-04-30T16:11:02Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/distributedTest/java/org/apache/geode/internal/cache/ClearTXLockingDUnitTest.java", "diffHunk": "@@ -49,13 +49,14 @@\n  * <p>\n  * GEODE-1740: It was observed that operations performed within a transaction were not holding\n  * region modification locks for the duration of commit processing. This lock is used to ensure\n- * region consistency during CLEAR processing. By not holding the lock for the duration of commit\n+ * region consistency during CLEAR_REGION processing. By not holding the lock for the duration of\n+ * commit\n  * processing, a window was opened that allowed region operations such as clear to occur in\n  * mid-commit.\n  *\n  * <p>\n  * The fix for GEODE-1740 was to acquire and hold read locks for any region involved in the commit.\n- * This forces CLEAR to wait until commit processing is complete.\n+ * This forces CLEAR_REGION to wait until commit processing is complete.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e0c3df89898777020d61aa08f5914c64a812e94"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyNTc1NA==", "bodyText": "Here.", "url": "https://github.com/apache/geode/pull/4818#discussion_r418125754", "createdAt": "2020-04-30T16:11:09Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/distributedTest/java/org/apache/geode/internal/cache/ClearTXLockingDUnitTest.java", "diffHunk": "@@ -273,7 +274,7 @@ private void resetArmHook(String rname) {\n   }\n \n   /**\n-   * Wait to be notified it is time to perform region operation (i.e. CLEAR)\n+   * Wait to be notified it is time to perform region operation (i.e. CLEAR_REGION)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e0c3df89898777020d61aa08f5914c64a812e94"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyNzk2Mg==", "bodyText": "I still think that renaming this to something like \"CLEAR_REGION_CLEARED_ALL_KEYS\" and moving it to the \"clear region\" section of constants would be worthwhile. It seems like a good idea to keep all clear-related stuff in one place.", "url": "https://github.com/apache/geode/pull/4818#discussion_r418127962", "createdAt": "2020-04-30T16:14:32Z", "author": {"login": "DonalEvans"}, "path": "geode-core/src/main/java/org/apache/geode/management/internal/i18n/CliStrings.java", "diffHunk": "@@ -1914,9 +1921,10 @@\n   public static final String REMOVE__MSG__KEY_EMPTY = \"Key is Null\";\n   public static final String REMOVE__MSG__REGION_NOT_FOUND = \"Region <{0}> Not Found\";\n   public static final String REMOVE__MSG__KEY_NOT_FOUND_REGION = \"Key is not present in the region\";\n-  public static final String REMOVE__MSG__CLEARED_ALL_CLEARS = \"Cleared all keys in the region\";\n-  public static final String REMOVE__MSG__CLEARALL_NOT_SUPPORTED_FOR_PARTITIONREGION =\n-      \"Option --\" + REMOVE__ALL + \" is not supported on partitioned region\";\n+  public static final String REMOVE__MSG__CLEARED_ALL_KEYS = \"Cleared all keys in the region\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM5MTc0MA=="}, "originalCommit": {"oid": "99838886619f0cefb0ebcd5d0463a03976eaf1eb"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5dd89629fc85c9c7ac80ff9786742720ee1473bb", "author": {"user": {"login": "BenjaminPerryRoss", "name": null}}, "url": "https://github.com/apache/geode/commit/5dd89629fc85c9c7ac80ff9786742720ee1473bb", "committedDate": "2020-05-01T16:16:24Z", "message": "Additional PR changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MjgyMTI0", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-404282124", "createdAt": "2020-05-01T17:15:44Z", "commit": {"oid": "5dd89629fc85c9c7ac80ff9786742720ee1473bb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0Mjg5MjY5", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-404289269", "createdAt": "2020-05-01T17:28:59Z", "commit": {"oid": "5dd89629fc85c9c7ac80ff9786742720ee1473bb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MDUyNDA0", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-406052404", "createdAt": "2020-05-05T18:33:31Z", "commit": {"oid": "5dd89629fc85c9c7ac80ff9786742720ee1473bb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MDUyODk4", "url": "https://github.com/apache/geode/pull/4818#pullrequestreview-406052898", "createdAt": "2020-05-05T18:34:10Z", "commit": {"oid": "5dd89629fc85c9c7ac80ff9786742720ee1473bb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4873, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}