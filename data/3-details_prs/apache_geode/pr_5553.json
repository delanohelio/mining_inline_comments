{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzMTgxNzk4", "number": 5553, "title": "GEODE-8536: Allow limited retries when creating Lucene IndexWriter", "bodyText": "Authored-by: Donal Evans doevans@vmware.com\nThank you for submitting a contribution to Apache Geode.\nIn order to streamline the review of the contribution we ask you\nto ensure the following steps have been taken:\nFor all changes:\n\n\n Is there a JIRA ticket associated with this PR? Is it referenced in the commit message?\n\n\n Has your PR been rebased against the latest commit within the target branch (typically develop)?\n\n\n Is your initial contribution a single, squashed commit?\n\n\n Does gradlew build run cleanly?\n\n\n Have you written or updated unit tests to verify your changes?\n\n\n[N/A] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under ASF 2.0?\n\n\nNote:\nPlease ensure that once the PR is submitted, check Concourse for build issues and\nsubmit an update to your PR as soon as possible. If you need help, please send an\nemail to dev@geode.apache.org.", "createdAt": "2020-09-25T16:12:05Z", "url": "https://github.com/apache/geode/pull/5553", "merged": true, "mergeCommit": {"oid": "eccd4f0d867579990a6a5de3dc070d45ef8bb8fb"}, "closed": true, "closedAt": "2020-10-03T01:43:19Z", "author": {"login": "DonalEvans"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOFgEuAFqTQ5OTg4MjUzNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOs3vggBqjM4MzU3MTA4MzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5ODgyNTM2", "url": "https://github.com/apache/geode/pull/5553#pullrequestreview-499882536", "createdAt": "2020-09-30T23:36:44Z", "commit": {"oid": "c54594d47bf8a1fd19114e18cd73ef3ba5e789bb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNzM3MzI5", "url": "https://github.com/apache/geode/pull/5553#pullrequestreview-500737329", "createdAt": "2020-10-01T21:39:55Z", "commit": {"oid": "c54594d47bf8a1fd19114e18cd73ef3ba5e789bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMTozOTo1NVrOHbbqXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQyMTozOTo1NVrOHbbqXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODUyNjgxNQ==", "bodyText": "Do you think the number of retries is enough?\nBased on the original ticket description, the IOException thrown is caused by \"LuceneEventListener is asynchronously updating the fileAndChunkRegion\". Do we know if the wait is enough for the updating to finish? Is it a problem if IndexWriter creation needs to wait longer for the resources to be freed?\nDo we know \"updating the fileAndChunkRegion\" usually do not require a minute to finish, or we actually hit this issue due to different threads keep updating the fileAndChunkRegion? If so, we can decide the number of attempts and whether the wait needs to be using different intervals.\nIf we do not know answers for these, I think this code change is fine to fix the StackOverflowError.", "url": "https://github.com/apache/geode/pull/5553#discussion_r498526815", "createdAt": "2020-10-01T21:39:55Z", "author": {"login": "pivotal-eshu"}, "path": "geode-lucene/src/main/java/org/apache/geode/cache/lucene/internal/IndexRepositoryFactory.java", "diffHunk": "@@ -44,6 +44,7 @@\n   private static final Logger logger = LogService.getLogger();\n   public static final String FILE_REGION_LOCK_FOR_BUCKET_ID = \"FileRegionLockForBucketId:\";\n   public static final String APACHE_GEODE_INDEX_COMPLETE = \"APACHE_GEODE_INDEX_COMPLETE\";\n+  protected static final int GET_INDEX_WRITER_MAX_ATTEMPTS = 10;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c54594d47bf8a1fd19114e18cd73ef3ba5e789bb"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce55fcf27dfb7ac1ff5eb847741de4100f038220", "author": {"user": {"login": "DonalEvans", "name": "Donal Evans"}}, "url": "https://github.com/apache/geode/commit/ce55fcf27dfb7ac1ff5eb847741de4100f038220", "committedDate": "2020-10-02T20:55:21Z", "message": "GEODE-8536: Allow limited retries when creating Lucene IndexWriter\n\nAuthored-by: Donal Evans <doevans@vmware.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8afd208962f536d0676ccfd9f2a91795ad25ced1", "author": {"user": {"login": "DonalEvans", "name": "Donal Evans"}}, "url": "https://github.com/apache/geode/commit/8afd208962f536d0676ccfd9f2a91795ad25ced1", "committedDate": "2020-10-02T20:55:21Z", "message": "Increase max retry count to 200\n\nAuthored-by: Donal Evans <doevans@vmware.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c54594d47bf8a1fd19114e18cd73ef3ba5e789bb", "author": {"user": {"login": "DonalEvans", "name": "Donal Evans"}}, "url": "https://github.com/apache/geode/commit/c54594d47bf8a1fd19114e18cd73ef3ba5e789bb", "committedDate": "2020-09-25T15:58:33Z", "message": "GEODE-8536: Allow limited retries when creating Lucene IndexWriter\n\nAuthored-by: Donal Evans <doevans@vmware.com>"}, "afterCommit": {"oid": "8afd208962f536d0676ccfd9f2a91795ad25ced1", "author": {"user": {"login": "DonalEvans", "name": "Donal Evans"}}, "url": "https://github.com/apache/geode/commit/8afd208962f536d0676ccfd9f2a91795ad25ced1", "committedDate": "2020-10-02T20:55:21Z", "message": "Increase max retry count to 200\n\nAuthored-by: Donal Evans <doevans@vmware.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4040, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}