{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwODM2MTQx", "number": 4741, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNTo1NTo0MlrODjgkhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjowMDozNVrODjgtPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NTYwMzg4OnYy", "diffSide": "RIGHT", "path": "geode-core/src/main/java/org/apache/geode/distributed/internal/DistributionMessage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNTo1NTo0M1rOFvWuLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjoyMjowN1rOFvX0Gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE5OTY2Mw==", "bodyText": "I think we could get rid of getRecipientsArray() with a little more work.  It's only used until we get down to the messaging layer (GMSMembership.send(), DirectChannel.sendToMany()).  That would get rid of an array-copy for every message we send.", "url": "https://github.com/apache/geode/pull/4741#discussion_r385199663", "createdAt": "2020-02-27T15:55:43Z", "author": {"login": "bschuchardt"}, "path": "geode-core/src/main/java/org/apache/geode/distributed/internal/DistributionMessage.java", "diffHunk": "@@ -301,15 +300,16 @@ public void resetRecipients() {\n     if (this.multicast || this.recipients == null) {\n       return ALL_RECIPIENTS_ARRAY;\n     }\n-    return this.recipients;\n+\n+    return this.recipients.toArray(EMPTY_RECIPIENTS_ARRAY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ca00dd2d56be4ce4e13e545994b2501b05b128"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTIxNzU2Mg==", "bodyText": "Sounds good @bschuchardt, will make the changes, thanks!.", "url": "https://github.com/apache/geode/pull/4741#discussion_r385217562", "createdAt": "2020-02-27T16:22:07Z", "author": {"login": "jujoramos"}, "path": "geode-core/src/main/java/org/apache/geode/distributed/internal/DistributionMessage.java", "diffHunk": "@@ -301,15 +300,16 @@ public void resetRecipients() {\n     if (this.multicast || this.recipients == null) {\n       return ALL_RECIPIENTS_ARRAY;\n     }\n-    return this.recipients;\n+\n+    return this.recipients.toArray(EMPTY_RECIPIENTS_ARRAY);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE5OTY2Mw=="}, "originalCommit": {"oid": "b1ca00dd2d56be4ce4e13e545994b2501b05b128"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NTYwOTkxOnYy", "diffSide": "RIGHT", "path": "geode-core/src/main/java/org/apache/geode/distributed/internal/DistributionMessage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNTo1Njo1NFrOFvWxgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNTo1Njo1NFrOFvWxgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTIwMDUxNQ==", "bodyText": "You could replace The Arrays.toString() here with \"recipients\".  There is at least one other place in the code doing this same thing that you could change.", "url": "https://github.com/apache/geode/pull/4741#discussion_r385200515", "createdAt": "2020-02-27T15:56:54Z", "author": {"login": "bschuchardt"}, "path": "geode-core/src/main/java/org/apache/geode/distributed/internal/DistributionMessage.java", "diffHunk": "@@ -547,8 +548,9 @@ public void setBreadcrumbsInSender() {\n       if (pid != 0) {\n         procId = \"processorId=\" + pid;\n       }\n-      if (this.recipients != null && this.recipients.length <= 10) { // set a limit on recipients\n-        Breadcrumbs.setSendSide(procId + \" recipients=\" + Arrays.toString(this.recipients));\n+\n+      if (this.recipients != null && this.recipients.size() <= 10) { // set a limit on recipients\n+        Breadcrumbs.setSendSide(procId + \" recipients=\" + Arrays.toString(getRecipientsArray()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ca00dd2d56be4ce4e13e545994b2501b05b128"}, "originalPosition": 106}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NTYyNjIzOnYy", "diffSide": "RIGHT", "path": "geode-core/src/main/java/org/apache/geode/internal/cache/tx/RemoteOperationMessage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjowMDozNVrOFvW7rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjowMDozNVrOFvW7rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTIwMzExOQ==", "bodyText": "I think this could just be getRecipients().toString()", "url": "https://github.com/apache/geode/pull/4741#discussion_r385203119", "createdAt": "2020-02-27T16:00:35Z", "author": {"login": "bschuchardt"}, "path": "geode-core/src/main/java/org/apache/geode/internal/cache/tx/RemoteOperationMessage.java", "diffHunk": "@@ -417,18 +418,18 @@ public String toString() {\n    */\n   protected void appendFields(StringBuffer buff) {\n     buff.append(\"; sender=\").append(getSender()).append(\"; recipients=[\");\n-    InternalDistributedMember[] recips = getRecipientsArray();\n-    for (int i = 0; i < recips.length - 1; i++) {\n-      buff.append(recips[i]).append(',');\n+    List<InternalDistributedMember> recipients = getRecipients();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ca00dd2d56be4ce4e13e545994b2501b05b128"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4467, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}