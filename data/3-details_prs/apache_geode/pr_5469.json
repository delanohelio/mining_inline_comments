{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxNzM3NjIy", "number": 5469, "title": "GEODE-8447: QueryResultFormatter should show dates in localized strings", "bodyText": "", "createdAt": "2020-08-21T16:47:26Z", "url": "https://github.com/apache/geode/pull/5469", "merged": true, "mergeCommit": {"oid": "6ca548f8f81a60853d4b49def20d6eb69432bf24"}, "closed": true, "closedAt": "2020-08-26T17:39:17Z", "author": {"login": "jinmeiliao"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdBJBEEABqjM2ODA2NjQ1MzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdsDSsNAFqTU2MDYxNTc3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "32f61bbddc33fddd0197e33975e326172fce78ed", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/32f61bbddc33fddd0197e33975e326172fce78ed", "committedDate": "2020-08-21T16:46:14Z", "message": "GEODE-8447: QueryResultFormatter should show dates in localized strings\n\n* support java.util.Date, java.sql.Date and java.time.* date objects in the formatter"}, "afterCommit": {"oid": "d68c57a6c059ce033969183d9e694bbfcfd89da2", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/d68c57a6c059ce033969183d9e694bbfcfd89da2", "committedDate": "2020-08-21T18:21:12Z", "message": "GEODE-8447: QueryResultFormatter should show dates in localized strings\n\n* support java.util.Date, java.sql.Date and java.time.* date objects in the formatter"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d68c57a6c059ce033969183d9e694bbfcfd89da2", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/d68c57a6c059ce033969183d9e694bbfcfd89da2", "committedDate": "2020-08-21T18:21:12Z", "message": "GEODE-8447: QueryResultFormatter should show dates in localized strings\n\n* support java.util.Date, java.sql.Date and java.time.* date objects in the formatter"}, "afterCommit": {"oid": "4249ff95bb44a1711d67b5ac568de0042340b518", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/4249ff95bb44a1711d67b5ac568de0042340b518", "committedDate": "2020-08-21T20:30:22Z", "message": "GEODE-8447: QueryResultFormatter should show dates in localized strings\n\n* support java.util.Date, java.sql.Date and java.time.* date objects in the formatter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16489de96432982a186a6997a6260a1fb5a0dbca", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/16489de96432982a186a6997a6260a1fb5a0dbca", "committedDate": "2020-08-21T20:42:11Z", "message": "GEODE-8447: QueryResultFormatter should show dates in localized strings\n\n* support java.util.Date, java.sql.Date and java.time.* date objects in the formatter"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4249ff95bb44a1711d67b5ac568de0042340b518", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/4249ff95bb44a1711d67b5ac568de0042340b518", "committedDate": "2020-08-21T20:30:22Z", "message": "GEODE-8447: QueryResultFormatter should show dates in localized strings\n\n* support java.util.Date, java.sql.Date and java.time.* date objects in the formatter"}, "afterCommit": {"oid": "16489de96432982a186a6997a6260a1fb5a0dbca", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/16489de96432982a186a6997a6260a1fb5a0dbca", "committedDate": "2020-08-21T20:42:11Z", "message": "GEODE-8447: QueryResultFormatter should show dates in localized strings\n\n* support java.util.Date, java.sql.Date and java.time.* date objects in the formatter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "287797e95dd7394660aca870744a3f36a6684943", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/287797e95dd7394660aca870744a3f36a6684943", "committedDate": "2020-08-23T15:40:38Z", "message": "empty"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTgwNDk5", "url": "https://github.com/apache/geode/pull/5469#pullrequestreview-473580499", "createdAt": "2020-08-24T14:53:07Z", "commit": {"oid": "287797e95dd7394660aca870744a3f36a6684943"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDo1MzowN1rOHFopeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDo1MzowN1rOHFopeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY3MDkwNQ==", "bodyText": "Does it also handles the date format used by the application/user in the query.\n(From test SelectToDateJUnitTest.java):\n\"select * from /test p where p.createDate = to_date('05202012100559', 'MMddyyyyHHmmss')", "url": "https://github.com/apache/geode/pull/5469#discussion_r475670905", "createdAt": "2020-08-24T14:53:07Z", "author": {"login": "agingade"}, "path": "geode-core/src/integrationTest/java/org/apache/geode/management/internal/beans/DistributedSystemMBeanIntegrationTest.java", "diffHunk": "@@ -0,0 +1,149 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package org.apache.geode.management.internal.beans;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import java.text.SimpleDateFormat;\n+import java.time.LocalDate;\n+import java.util.Date;\n+\n+import org.junit.BeforeClass;\n+import org.junit.ClassRule;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import org.apache.geode.cache.Region;\n+import org.apache.geode.cache.RegionShortcut;\n+import org.apache.geode.management.DistributedSystemMXBean;\n+import org.apache.geode.management.internal.json.QueryResultFormatter;\n+import org.apache.geode.test.junit.assertions.TabularResultModelAssert;\n+import org.apache.geode.test.junit.rules.GfshCommandRule;\n+import org.apache.geode.test.junit.rules.MBeanServerConnectionRule;\n+import org.apache.geode.test.junit.rules.ServerStarterRule;\n+\n+public class DistributedSystemMBeanIntegrationTest {\n+\n+  public static final String SELECT = \"select * from /testRegion r where r.id=1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "287797e95dd7394660aca870744a3f36a6684943"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NzM5MjY4", "url": "https://github.com/apache/geode/pull/5469#pullrequestreview-474739268", "createdAt": "2020-08-25T18:19:55Z", "commit": {"oid": "287797e95dd7394660aca870744a3f36a6684943"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODoxOTo1NlrOHGkUCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODozMjoyNFrOHGkvPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY0ODQ1Nw==", "bodyText": "Is sqlDatee a typo?", "url": "https://github.com/apache/geode/pull/5469#discussion_r476648457", "createdAt": "2020-08-25T18:19:56Z", "author": {"login": "jchen21"}, "path": "geode-gfsh/src/test/java/org/apache/geode/management/internal/cli/json/QueryResultFormatterTest.java", "diffHunk": "@@ -117,15 +119,19 @@ public void testPrimitives() throws Exception {\n     QueryResultFormatter stringResult = new QueryResultFormatter(100).add(RESULT, \"String\");\n     checkResult(stringResult, \"{\\\"result\\\":[[\\\"java.lang.String\\\",\\\"String\\\"]]}\");\n \n+    Date date = new Date(0);\n+    String expectedString =\n+        new SimpleDateFormat(QueryResultFormatter.DATE_FORMAT_PATTERN).format(date);\n     QueryResultFormatter javaDateResult =\n-        new QueryResultFormatter(100).add(RESULT, new java.util.Date(0));\n+        new QueryResultFormatter(100).add(RESULT, date);\n     checkResult(javaDateResult,\n-        \"{\\\"result\\\":[[\\\"java.util.Date\\\",\\\"1970-01-01T00:00:00.000+0000\\\"]]}\");\n+        \"{\\\"result\\\":[[\\\"java.util.Date\\\",\\\"\" + expectedString + \"\\\"]]}\");\n \n+    java.sql.Date sqlDatee = new java.sql.Date(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "287797e95dd7394660aca870744a3f36a6684943"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY1NDc2NQ==", "bodyText": "Can you point me where this new dependency is used in the test? I don't see it is used in the tests of this pull request.", "url": "https://github.com/apache/geode/pull/5469#discussion_r476654765", "createdAt": "2020-08-25T18:31:09Z", "author": {"login": "jchen21"}, "path": "boms/geode-all-bom/src/test/resources/expected-pom.xml", "diffHunk": "@@ -67,6 +67,12 @@\n         <version>2.9.8</version>\n         <scope>compile</scope>\n       </dependency>\n+      <dependency>\n+        <groupId>com.fasterxml.jackson.datatype</groupId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "287797e95dd7394660aca870744a3f36a6684943"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY1NTQyMw==", "bodyText": "Can you elaborate a bit why jackson-datatype-jsr310 is needed? I am not sure why it is necessary to add it.", "url": "https://github.com/apache/geode/pull/5469#discussion_r476655423", "createdAt": "2020-08-25T18:32:24Z", "author": {"login": "jchen21"}, "path": "geode-core/src/main/java/org/apache/geode/management/internal/json/AbstractJSONFormatter.java", "diffHunk": "@@ -94,6 +94,8 @@ public AbstractJSONFormatter(int maxCollectionElements, int serializationDepth,\n \n     // register the custom module\n     mapper.registerModule(mapperModule);\n+    // to support jdk8 java.time if jackson-datatype-jsr310 is included in the classpath", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "287797e95dd7394660aca870744a3f36a6684943"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0OTEwNTIw", "url": "https://github.com/apache/geode/pull/5469#pullrequestreview-474910520", "createdAt": "2020-08-25T21:13:11Z", "commit": {"oid": "287797e95dd7394660aca870744a3f36a6684943"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b1ec074b86435a322c7947301dcf57a9d158c21", "author": {"user": {"login": "jinmeiliao", "name": "Jinmei Liao"}}, "url": "https://github.com/apache/geode/commit/6b1ec074b86435a322c7947301dcf57a9d158c21", "committedDate": "2020-08-25T23:10:28Z", "message": "fix typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjE1Nzcz", "url": "https://github.com/apache/geode/pull/5469#pullrequestreview-560615773", "createdAt": "2021-01-02T02:00:01Z", "commit": {"oid": "16489de96432982a186a6997a6260a1fb5a0dbca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMjowMDowMlrOINUEbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMjowMDowMlrOINUEbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgzMTIxMg==", "bodyText": "this seems like the wrong scope.  don't we need jackson-datatype-jdr310 jar to be included in the shipping product, not just available to this one test?", "url": "https://github.com/apache/geode/pull/5469#discussion_r550831212", "createdAt": "2021-01-02T02:00:02Z", "author": {"login": "onichols-pivotal"}, "path": "geode-core/build.gradle", "diffHunk": "@@ -366,6 +366,7 @@ dependencies {\n \n     integrationTestRuntimeOnly('org.apache.derby:derby')\n     integrationTestRuntimeOnly('xerces:xercesImpl')\n+    integrationTestRuntimeOnly('com.fasterxml.jackson.datatype:jackson-datatype-jsr310')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16489de96432982a186a6997a6260a1fb5a0dbca"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4159, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}