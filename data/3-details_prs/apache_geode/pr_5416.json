{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5NTAxMTg2", "number": 5416, "title": "GEODE-8382: Run Redis tests against Redis API for Geode", "bodyText": "We would like to run Redis's tests against Redis API for Geode.  Tests will run a separate job in the PR and main pipelines.  It has been included in the 'tests' jinja variables.\nCo-authored-by: Murtuza Boxwala mboxwala@pivotal.io", "createdAt": "2020-07-30T18:53:51Z", "url": "https://github.com/apache/geode/pull/5416", "merged": true, "mergeCommit": {"oid": "eb8668ad7caa6e20d9be242ad719e173ebf244d8"}, "closed": true, "closedAt": "2020-08-05T15:44:47Z", "author": {"login": "sabbey37"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6EKx2gH2gAyNDU5NTAxMTg2OjdkODNlODBhNDZkMjZmMjhjOTMyMWQ5ZGQxZTc3ZmJjYzRjYTUxOWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc79IgjgFqTQ2MTc4ODkxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c", "committedDate": "2020-07-30T18:45:05Z", "message": "GEODE-8382: Run Redis tests against Redis API for Geode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMjQ4MTM4", "url": "https://github.com/apache/geode/pull/5416#pullrequestreview-460248138", "createdAt": "2020-08-03T18:25:42Z", "commit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzE0MTMw", "url": "https://github.com/apache/geode/pull/5416#pullrequestreview-460314130", "createdAt": "2020-08-03T20:20:05Z", "commit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDoyMDowNlrOG7Haqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDoyMDo0OVrOG7Hb7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0MDY4Mw==", "bodyText": "I looked at the resource usage for this heavy lifter, and we can safely take this down to 8GB ram, easy.", "url": "https://github.com/apache/geode/pull/5416#discussion_r464640683", "createdAt": "2020-08-03T20:20:06Z", "author": {"login": "rhoughton-pivot"}, "path": "ci/pipelines/shared/jinja.variables.yml", "diffHunk": "@@ -140,6 +140,19 @@ tests:\n   PLATFORM: linux\n   RAM: '210'\n   name: Upgrade\n+- ARTIFACT_SLUG: redistests\n+  CALL_STACK_TIMEOUT: '1200'\n+  CPUS: '4'\n+  DUNIT_PARALLEL_FORKS: '0'\n+  EXECUTE_TEST_TIMEOUT: 30m\n+  GRADLE_TASK: ':geode-redis:redisAPITest'\n+  MAX_IN_FLIGHT: 1\n+  ONLY_JDK: 11\n+  PARALLEL_DUNIT: 'false'\n+  PARALLEL_GRADLE: 'true'\n+  PLATFORM: linux\n+  RAM: '16'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0MTAwNg==", "bodyText": "I saw that this does fail-red when the count != 0. Looks good.", "url": "https://github.com/apache/geode/pull/5416#discussion_r464641006", "createdAt": "2020-08-03T20:20:49Z", "author": {"login": "rhoughton-pivot"}, "path": "ci/scripts/execute_redis_tests.sh", "diffHunk": "@@ -0,0 +1,51 @@\n+#!/usr/bin/env bash\n+\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+cd ..\n+git clone --config transfer.fsckObjects=false https://github.com/prettyClouds/redis.git\n+cd redis\n+git checkout tests-geode-redis\n+\n+JAVA_HOME=\"/usr/lib/jvm/java-11-openjdk-amd64\"  \\\n+../geode-assembly/build/install/apache-geode/bin/gfsh start server \\\n+  --J=-Denable-redis-unsupported-commands=true \\\n+  --name=server1 \\\n+  --redis-port=6380 \\\n+  --redis-bind-address=127.0.0.1 \\\n+  --redis-password=foobar\n+\n+failCount=0\n+\n+./runtest --host 127.0.0.1 --port 6380 --single unit/auth\n+\n+((failCount+=$?))\n+\n+JAVA_HOME=\"/usr/lib/jvm/java-11-openjdk-amd64\" \\\n+../geode-assembly/build/install/apache-geode/bin/gfsh start server \\\n+  --J=-Denable-redis-unsupported-commands=true \\\n+  --name=server2 \\\n+  --server-port=0 \\\n+  --redis-port=6379 \\\n+  --redis-bind-address=127.0.0.1\n+\n+./runtest --host 127.0.0.1 --port 6379 --single unit/type/set --single unit/expire\n+\n+((failCount+=$?))\n+\n+exit $failCount", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzE4NTA2", "url": "https://github.com/apache/geode/pull/5416#pullrequestreview-460318506", "createdAt": "2020-08-03T20:27:42Z", "commit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDoyNzo0MlrOG7HoRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDoyNzo0MlrOG7HoRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0NDE2Nw==", "bodyText": "you should not need to hardcode the JDK path.  The JDK you should be using is passed to you as ${JAVA_TEST_PATH} (see ci/scripts/execute_tests.sh)", "url": "https://github.com/apache/geode/pull/5416#discussion_r464644167", "createdAt": "2020-08-03T20:27:42Z", "author": {"login": "onichols-pivotal"}, "path": "ci/scripts/execute_redis_tests.sh", "diffHunk": "@@ -0,0 +1,51 @@\n+#!/usr/bin/env bash\n+\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+cd ..\n+git clone --config transfer.fsckObjects=false https://github.com/prettyClouds/redis.git\n+cd redis\n+git checkout tests-geode-redis\n+\n+JAVA_HOME=\"/usr/lib/jvm/java-11-openjdk-amd64\"  \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzIxNDMy", "url": "https://github.com/apache/geode/pull/5416#pullrequestreview-460321432", "createdAt": "2020-08-03T20:32:41Z", "commit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDozMjo0MVrOG7Hxbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDozMjo0MVrOG7Hxbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0NjUxMQ==", "bodyText": "redundant as you have already set JAVA_HOME above", "url": "https://github.com/apache/geode/pull/5416#discussion_r464646511", "createdAt": "2020-08-03T20:32:41Z", "author": {"login": "onichols-pivotal"}, "path": "ci/scripts/execute_redis_tests.sh", "diffHunk": "@@ -0,0 +1,51 @@\n+#!/usr/bin/env bash\n+\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+cd ..\n+git clone --config transfer.fsckObjects=false https://github.com/prettyClouds/redis.git\n+cd redis\n+git checkout tests-geode-redis\n+\n+JAVA_HOME=\"/usr/lib/jvm/java-11-openjdk-amd64\"  \\\n+../geode-assembly/build/install/apache-geode/bin/gfsh start server \\\n+  --J=-Denable-redis-unsupported-commands=true \\\n+  --name=server1 \\\n+  --redis-port=6380 \\\n+  --redis-bind-address=127.0.0.1 \\\n+  --redis-password=foobar\n+\n+failCount=0\n+\n+./runtest --host 127.0.0.1 --port 6380 --single unit/auth\n+\n+((failCount+=$?))\n+\n+JAVA_HOME=\"/usr/lib/jvm/java-11-openjdk-amd64\" \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzIyMzI1", "url": "https://github.com/apache/geode/pull/5416#pullrequestreview-460322325", "createdAt": "2020-08-03T20:34:19Z", "commit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDozNDoxOVrOG7H0qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDozNDoxOVrOG7H0qA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0NzMzNg==", "bodyText": "would a comment be appropriate here explaining why a personal fork is being used and the plan/timeline for eliminating dependency on a personal fork?", "url": "https://github.com/apache/geode/pull/5416#discussion_r464647336", "createdAt": "2020-08-03T20:34:19Z", "author": {"login": "onichols-pivotal"}, "path": "ci/scripts/execute_redis_tests.sh", "diffHunk": "@@ -0,0 +1,51 @@\n+#!/usr/bin/env bash\n+\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+cd ..\n+git clone --config transfer.fsckObjects=false https://github.com/prettyClouds/redis.git", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d83e80a46d26f28c9321d9dd1e77fbcc4ca519c"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c4df148e60f43d5cd99ca0cfa97dc7b200c262b", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/0c4df148e60f43d5cd99ca0cfa97dc7b200c262b", "committedDate": "2020-08-03T21:13:09Z", "message": "PR review changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzQ4MTYz", "url": "https://github.com/apache/geode/pull/5416#pullrequestreview-460348163", "createdAt": "2020-08-03T21:19:04Z", "commit": {"oid": "0c4df148e60f43d5cd99ca0cfa97dc7b200c262b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a57d6634733ea2ede104a5331f5e1dd79576978", "author": {"user": {"login": "sabbey37", "name": "Sarah"}}, "url": "https://github.com/apache/geode/commit/6a57d6634733ea2ede104a5331f5e1dd79576978", "committedDate": "2020-08-04T15:43:17Z", "message": "Sets JAVA_TEST_PATH variable as part of ssh call"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNzg4OTEw", "url": "https://github.com/apache/geode/pull/5416#pullrequestreview-461788910", "createdAt": "2020-08-05T15:41:07Z", "commit": {"oid": "6a57d6634733ea2ede104a5331f5e1dd79576978"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4251, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}