{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxNDU1MjQz", "number": 3167, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0Mzo1MVrODd0wnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0OToyN1rODd029w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNTk5NzA4OnYy", "diffSide": "RIGHT", "path": "src/reference/asciidoc/dsl.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0Mzo1MVrOFmplXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0Mzo1MVrOFmplXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA3MTUxNw==", "bodyText": "s/allow to extend an existing.../allow extension of the existing Java DSL with custom or composed.../", "url": "https://github.com/spring-projects/spring-integration/pull/3167#discussion_r376071517", "createdAt": "2020-02-06T20:43:51Z", "author": {"login": "garyrussell"}, "path": "src/reference/asciidoc/dsl.adoc", "diffHunk": "@@ -1202,3 +1202,63 @@ That `errorRecovererFlow` can be used as follows:\n private Function<String, String> errorRecovererFlowGateway;\n ----\n ====\n+\n+[[java-dsl-extensions]]\n+=== DSL Extensions\n+\n+Starting with version 5.3, an `IntegrationFlowExtension` has been introduced to allow to extend an existing Java DSL to any possible custom or composed EIP-operators.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1053e8a287e1d35c3ea2cd31e42e9efe82e605c"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjAwMDc5OnYy", "diffSide": "RIGHT", "path": "src/reference/asciidoc/dsl.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0NTowNlrOFmpnnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0NTowNlrOFmpnnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA3MjA5Mg==", "bodyText": "All that is needed is an extension of this class that provides methods which can be used in...", "url": "https://github.com/spring-projects/spring-integration/pull/3167#discussion_r376072092", "createdAt": "2020-02-06T20:45:06Z", "author": {"login": "garyrussell"}, "path": "src/reference/asciidoc/dsl.adoc", "diffHunk": "@@ -1202,3 +1202,63 @@ That `errorRecovererFlow` can be used as follows:\n private Function<String, String> errorRecovererFlowGateway;\n ----\n ====\n+\n+[[java-dsl-extensions]]\n+=== DSL Extensions\n+\n+Starting with version 5.3, an `IntegrationFlowExtension` has been introduced to allow to extend an existing Java DSL to any possible custom or composed EIP-operators.\n+There is only enough to extend this class and write methods which are going to be used in the `IntegrationFlow` bean definitions.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1053e8a287e1d35c3ea2cd31e42e9efe82e605c"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjAwNTIyOnYy", "diffSide": "RIGHT", "path": "src/reference/asciidoc/dsl.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0NjozOVrOFmpqTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0NjozOVrOFmpqTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA3Mjc4Mw==", "bodyText": "return s/an/the/ extension", "url": "https://github.com/spring-projects/spring-integration/pull/3167#discussion_r376072783", "createdAt": "2020-02-06T20:46:39Z", "author": {"login": "garyrussell"}, "path": "src/reference/asciidoc/dsl.adoc", "diffHunk": "@@ -1202,3 +1202,63 @@ That `errorRecovererFlow` can be used as follows:\n private Function<String, String> errorRecovererFlowGateway;\n ----\n ====\n+\n+[[java-dsl-extensions]]\n+=== DSL Extensions\n+\n+Starting with version 5.3, an `IntegrationFlowExtension` has been introduced to allow to extend an existing Java DSL to any possible custom or composed EIP-operators.\n+There is only enough to extend this class and write methods which are going to be used in the `IntegrationFlow` bean definitions.\n+The extension class can also be used for custom `IntegrationComponentSpec` configuration; for example, missed or default options can be implemented in the existing `IntegrationComponentSpec` extension.\n+The sample below demonstrates a composite custom operator and usage of an `AggregatorSpec` extension for a default custom `outputProcessor`:\n+\n+====\n+[source,java]\n+----\n+public class CustomIntegrationFlowDefinition\n+        extends IntegrationFlowExtension<CustomIntegrationFlowDefinition> {\n+\n+    public CustomIntegrationFlowDefinition upperCaseAfterSplit() {\n+        return split()\n+                .transform(\"payload.toUpperCase()\");\n+    }\n+\n+    public CustomIntegrationFlowDefinition customAggregate(Consumer<CustomAggregatorSpec> aggregator) {\n+        return register(new CustomAggregatorSpec(), aggregator);\n+    }\n+\n+}\n+\n+public class CustomAggregatorSpec extends AggregatorSpec {\n+\n+    CustomAggregatorSpec() {\n+        outputProcessor(group ->\n+                group.getMessages()\n+                        .stream()\n+                        .map(Message::getPayload)\n+                        .map(String.class::cast)\n+                        .collect(Collectors.joining(\", \")));\n+    }\n+\n+}\n+----\n+====\n+\n+For a method chain flow the new DSL operator in these extensions must return an extension class.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1053e8a287e1d35c3ea2cd31e42e9efe82e605c"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjAwNzU1OnYy", "diffSide": "RIGHT", "path": "src/reference/asciidoc/dsl.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0NzoyNlrOFmprsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0NzoyNlrOFmprsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA3MzEzOA==", "bodyText": "s/will look naturally with/will work with/", "url": "https://github.com/spring-projects/spring-integration/pull/3167#discussion_r376073138", "createdAt": "2020-02-06T20:47:26Z", "author": {"login": "garyrussell"}, "path": "src/reference/asciidoc/dsl.adoc", "diffHunk": "@@ -1202,3 +1202,63 @@ That `errorRecovererFlow` can be used as follows:\n private Function<String, String> errorRecovererFlowGateway;\n ----\n ====\n+\n+[[java-dsl-extensions]]\n+=== DSL Extensions\n+\n+Starting with version 5.3, an `IntegrationFlowExtension` has been introduced to allow to extend an existing Java DSL to any possible custom or composed EIP-operators.\n+There is only enough to extend this class and write methods which are going to be used in the `IntegrationFlow` bean definitions.\n+The extension class can also be used for custom `IntegrationComponentSpec` configuration; for example, missed or default options can be implemented in the existing `IntegrationComponentSpec` extension.\n+The sample below demonstrates a composite custom operator and usage of an `AggregatorSpec` extension for a default custom `outputProcessor`:\n+\n+====\n+[source,java]\n+----\n+public class CustomIntegrationFlowDefinition\n+        extends IntegrationFlowExtension<CustomIntegrationFlowDefinition> {\n+\n+    public CustomIntegrationFlowDefinition upperCaseAfterSplit() {\n+        return split()\n+                .transform(\"payload.toUpperCase()\");\n+    }\n+\n+    public CustomIntegrationFlowDefinition customAggregate(Consumer<CustomAggregatorSpec> aggregator) {\n+        return register(new CustomAggregatorSpec(), aggregator);\n+    }\n+\n+}\n+\n+public class CustomAggregatorSpec extends AggregatorSpec {\n+\n+    CustomAggregatorSpec() {\n+        outputProcessor(group ->\n+                group.getMessages()\n+                        .stream()\n+                        .map(Message::getPayload)\n+                        .map(String.class::cast)\n+                        .collect(Collectors.joining(\", \")));\n+    }\n+\n+}\n+----\n+====\n+\n+For a method chain flow the new DSL operator in these extensions must return an extension class.\n+This way a target `IntegrationFlow` definition will look naturally with new and existing DSL operators:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1053e8a287e1d35c3ea2cd31e42e9efe82e605c"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjAxMDYzOnYy", "diffSide": "RIGHT", "path": "src/reference/asciidoc/whats-new.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0ODoyN1rOFmptog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0ODoyN1rOFmptog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA3MzYzNA==", "bodyText": "Same change as first comment in adoc above.", "url": "https://github.com/spring-projects/spring-integration/pull/3167#discussion_r376073634", "createdAt": "2020-02-06T20:48:27Z", "author": {"login": "garyrussell"}, "path": "src/reference/asciidoc/whats-new.adoc", "diffHunk": "@@ -27,18 +27,20 @@ See its JavaDocs and <<./graph.adoc#integration-graph,Integration Graph>> for mo\n The `ReactiveMessageHandler` is now natively supported in the framework.\n See <<./reactive-streams.adoc/reactive-message-handler,ReactiveMessageHandler>> for more information.\n \n+[[x5.3-java-dsl-extensions]]\n+==== Java DSL Extensions\n+\n+A new `IntegrationFlowExtension` API has been introduced to allow to extend an existing Java DSL for custom and composite EIP-operators.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1053e8a287e1d35c3ea2cd31e42e9efe82e605c"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjAxMTQ2OnYy", "diffSide": "RIGHT", "path": "src/reference/asciidoc/whats-new.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0ODo0N1rOFmpuIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0ODo0N1rOFmpuIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA3Mzc2Mg==", "bodyText": "can be used to introduce customizers...", "url": "https://github.com/spring-projects/spring-integration/pull/3167#discussion_r376073762", "createdAt": "2020-02-06T20:48:47Z", "author": {"login": "garyrussell"}, "path": "src/reference/asciidoc/whats-new.adoc", "diffHunk": "@@ -27,18 +27,20 @@ See its JavaDocs and <<./graph.adoc#integration-graph,Integration Graph>> for mo\n The `ReactiveMessageHandler` is now natively supported in the framework.\n See <<./reactive-streams.adoc/reactive-message-handler,ReactiveMessageHandler>> for more information.\n \n+[[x5.3-java-dsl-extensions]]\n+==== Java DSL Extensions\n+\n+A new `IntegrationFlowExtension` API has been introduced to allow to extend an existing Java DSL for custom and composite EIP-operators.\n+This also can be used for introduction customizers for any out-of-the-box `IntegrationComponentSpec` extensions.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1053e8a287e1d35c3ea2cd31e42e9efe82e605c"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjAxMzM1OnYy", "diffSide": "RIGHT", "path": "src/reference/asciidoc/whats-new.adoc", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0OToyN1rOFmpvTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQyMDo0OToyN1rOFmpvTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA3NDA2Mw==", "bodyText": "matches the header in the first message of the group.", "url": "https://github.com/spring-projects/spring-integration/pull/3167#discussion_r376074063", "createdAt": "2020-02-06T20:49:27Z", "author": {"login": "garyrussell"}, "path": "src/reference/asciidoc/whats-new.adoc", "diffHunk": "@@ -48,6 +50,9 @@ See <<./gateway.adoc/gateway-calling-default-methods,Invoking `default` Methods>\n Internal components (such as `_org.springframework.integration.errorLogger`) now have a shortened name when they are represented in the integration graph.\n See <<./graph.adoc#integration-graph,Integration Graph>> for more information.\n \n+In the aggregator, when the `MessageGroupProcessor` returns a `Message`, the `MessageBuilder.popSequenceDetails()` is performed on the output message if the `sequenceDetails` matches with first message of group.\n+See <<./aggregator.adoc#aggregator-api,Aggregator Programming Model>> for more information.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1053e8a287e1d35c3ea2cd31e42e9efe82e605c"}, "originalPosition": 32}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1959, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}