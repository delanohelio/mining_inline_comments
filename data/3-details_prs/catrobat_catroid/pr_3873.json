{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMjg0OTI1", "number": 3873, "title": "CATROID-600 Automatically detect API keys and warn user when uploadin\u2026", "bodyText": "The \"Send web request\" and \"Get image from\" bricks may require API keys for certain web services. These keys belong to the persons that acquired those keys, maybe had to pay money for them, register with their credit card, etc to get them.\nTo remind users that uploading such projects is dangerous, Catroid shall try to detect API keys and warn the user that it detected them, and offer to replace the ones it could identify in the scripts during the upload (but not in the local copy).\nhttps://jira.catrob.at/browse/CATROID-600\nYour checklist for this pull request\nPlease review the contributing guidelines and wiki pages of this repository.\n\n Include the name of the Jira ticket in the PR\u2019s title\n Include a summary of the changes plus the relevant context\n Choose the proper base branch (develop)\n Confirm that the changes follow the project\u2019s coding guidelines\n Verify that the changes generate no compiler or linter warnings\n Perform a self-review of the changes\n Verify to commit no other files than the intentionally changed ones\n Include reasonable and readable tests verifying the added or changed behavior\n Confirm that new and existing unit tests pass locally\n Check that the commits\u2019 message style matches the project\u2019s guideline\n Stick to the project\u2019s gitflow workflow\n Verify that your changes do not have any conflicts with the base branch\n After the PR, verify that all CI checks have passed\n Post a message in the catroid-stage or catroid-ide Slack channel and ask for a code reviewer", "createdAt": "2020-11-17T09:58:58Z", "url": "https://github.com/Catrobat/Catroid/pull/3873", "merged": true, "mergeCommit": {"oid": "3e44e32919d71c7ba5c9f21214e70c6571479612"}, "closed": true, "closedAt": "2021-03-18T22:39:50Z", "author": {"login": "Walcho1125"}, "timelineItems": {"totalCount": 68, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddXiU8gBqjQwMDQ4NzE3NjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABeEdlxDgH2gAyNTIyMjg0OTI1OmE2MDgyZWMxYjViYzUwZDM5NzJlZWM5MWQ0NjAwNDMxMWFhODkzMWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d30e8d6dbf00e994a39bed361f2ce4e6bb8af6ef", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/d30e8d6dbf00e994a39bed361f2ce4e6bb8af6ef", "committedDate": "2020-11-17T09:54:57Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "7dfc7d60595fb1b0630a1bd421a426b4d450ddfa", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/7dfc7d60595fb1b0630a1bd421a426b4d450ddfa", "committedDate": "2020-11-17T11:05:50Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7dfc7d60595fb1b0630a1bd421a426b4d450ddfa", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/7dfc7d60595fb1b0630a1bd421a426b4d450ddfa", "committedDate": "2020-11-17T11:05:50Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "62064d91e6c0bc9c376452d406b801a404770bf4", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/62064d91e6c0bc9c376452d406b801a404770bf4", "committedDate": "2020-11-17T11:23:41Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62064d91e6c0bc9c376452d406b801a404770bf4", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/62064d91e6c0bc9c376452d406b801a404770bf4", "committedDate": "2020-11-17T11:23:41Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "85cd0bcc437141a6dca3c69f9053690c1f166264", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/85cd0bcc437141a6dca3c69f9053690c1f166264", "committedDate": "2020-11-17T15:44:01Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "85cd0bcc437141a6dca3c69f9053690c1f166264", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/85cd0bcc437141a6dca3c69f9053690c1f166264", "committedDate": "2020-11-17T15:44:01Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "b002db054512d98be66dacc14344b2878fac2f9e", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/b002db054512d98be66dacc14344b2878fac2f9e", "committedDate": "2020-11-17T16:24:47Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b002db054512d98be66dacc14344b2878fac2f9e", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/b002db054512d98be66dacc14344b2878fac2f9e", "committedDate": "2020-11-17T16:24:47Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "728ae23b37014dc2c326d82079dfff0a3c13d90d", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/728ae23b37014dc2c326d82079dfff0a3c13d90d", "committedDate": "2020-11-17T18:17:25Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "728ae23b37014dc2c326d82079dfff0a3c13d90d", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/728ae23b37014dc2c326d82079dfff0a3c13d90d", "committedDate": "2020-11-17T18:17:25Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "b717e1f45d057987f6f034f8bd4690f9f30eb9cf", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/b717e1f45d057987f6f034f8bd4690f9f30eb9cf", "committedDate": "2020-11-19T13:52:55Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b717e1f45d057987f6f034f8bd4690f9f30eb9cf", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/b717e1f45d057987f6f034f8bd4690f9f30eb9cf", "committedDate": "2020-11-19T13:52:55Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "5540435670a27d6cc1e06cf814372df1aa2a2eae", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/5540435670a27d6cc1e06cf814372df1aa2a2eae", "committedDate": "2020-11-19T17:24:07Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5540435670a27d6cc1e06cf814372df1aa2a2eae", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/5540435670a27d6cc1e06cf814372df1aa2a2eae", "committedDate": "2020-11-19T17:24:07Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "684ad6cedc6cfa743f17cff8c9cb15c9445ff35d", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/684ad6cedc6cfa743f17cff8c9cb15c9445ff35d", "committedDate": "2020-11-19T17:47:33Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "684ad6cedc6cfa743f17cff8c9cb15c9445ff35d", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/684ad6cedc6cfa743f17cff8c9cb15c9445ff35d", "committedDate": "2020-11-19T17:47:33Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "f3487fd86125602002bd9465a5ab6d6893994641", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/f3487fd86125602002bd9465a5ab6d6893994641", "committedDate": "2020-11-19T18:52:15Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3487fd86125602002bd9465a5ab6d6893994641", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/f3487fd86125602002bd9465a5ab6d6893994641", "committedDate": "2020-11-19T18:52:15Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "cc56d451ae945df8f42215cebb8dbfa25008d0cc", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/cc56d451ae945df8f42215cebb8dbfa25008d0cc", "committedDate": "2020-11-20T14:59:49Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cc56d451ae945df8f42215cebb8dbfa25008d0cc", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/cc56d451ae945df8f42215cebb8dbfa25008d0cc", "committedDate": "2020-11-20T14:59:49Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1", "committedDate": "2020-11-21T17:45:52Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1OTM0NjM0", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-555934634", "createdAt": "2020-12-19T11:11:10Z", "commit": {"oid": "4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOVQxMToxMToxMFrOII6_AA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOVQxMToxMToxMFrOII6_AA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIyNTkyMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t\tLog.e(TestUtils.class.getSimpleName(), Log.getStackTraceString(e));\n          \n          \n            \n            \t\t\t\t\tLog.e(TestUtils.class.getSimpleName(), \"can't delete the project \" + projectName );", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r546225920", "createdAt": "2020-12-19T11:11:10Z", "author": {"login": "ndrnour"}, "path": "catroid/src/androidTest/java/org/catrobat/catroid/test/utils/TestUtils.java", "diffHunk": "@@ -68,6 +69,20 @@ public static void deleteProjects(String... projectNames) throws IOException {\n \t\t}\n \t}\n \n+\tpublic static void deleteAllProjects() {\n+\t\tString[] projects = FlavoredConstants.DEFAULT_ROOT_DIRECTORY.list();\n+\t\tfor (String projectName : projects) {\n+\t\t\tFile projectDir = new File(FlavoredConstants.DEFAULT_ROOT_DIRECTORY, projectName);\n+\t\t\tif (projectDir.exists() && projectDir.isDirectory()) {\n+\t\t\t\ttry {\n+\t\t\t\t\tStorageOperations.deleteDir(projectDir);\n+\t\t\t\t} catch (IOException e) {\n+\t\t\t\t\tLog.e(TestUtils.class.getSimpleName(), Log.getStackTraceString(e));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1OTM3MDgw", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-555937080", "createdAt": "2020-12-19T11:59:29Z", "commit": {"oid": "4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOVQxMTo1OToyOVrOII7QLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOVQxMTo1OToyOVrOII7QLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzMDMxOQ==", "bodyText": "ops! our minSdk is 21, please use an alternative code that supports SDKs from 21 on", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r546230319", "createdAt": "2020-12-19T11:59:29Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -148,6 +159,7 @@ public void loadProjectActivity() {\n \t\tverifyUserIdentity();\n \t}\n \n+\t@RequiresApi(api = Build.VERSION_CODES.O)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1OTM3MTY5", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-555937169", "createdAt": "2020-12-19T12:01:16Z", "commit": {"oid": "4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOVQxMjowMToxNlrOII7Qrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOVQxMjowMToxNlrOII7Qrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzMDQ0Ng==", "bodyText": "this can be removed and used in a new style for replace_api_key TextView", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r546230446", "createdAt": "2020-12-19T12:01:16Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/res/font/courier_new_bold.xml", "diffHunk": "@@ -0,0 +1,29 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<!--\n+  ~ Catroid: An on-device visual programming system for Android devices\n+  ~ Copyright (C) 2010-2020 The Catrobat Team\n+  ~ (<http://developer.catrobat.org/credits>)\n+  ~\n+  ~ This program is free software: you can redistribute it and/or modify\n+  ~ it under the terms of the GNU Affero General Public License as\n+  ~ published by the Free Software Foundation, either version 3 of the\n+  ~ License, or (at your option) any later version.\n+  ~\n+  ~ An additional term exception under section 7 of the GNU Affero\n+  ~ General Public License, version 3, is available at\n+  ~ http://developer.catrobat.org/license_additional_term\n+  ~\n+  ~ This program is distributed in the hope that it will be useful,\n+  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of\n+  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+  ~ GNU Affero General Public License for more details.\n+  ~\n+  ~ You should have received a copy of the GNU Affero General Public License\n+  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+  -->\n+\n+<font-family xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+    xmlns:tools=\"http://schemas.android.com/tools\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1"}, "originalPosition": 26}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/4eb39785ebe9d1a0ce24cbeed276d6ec28786ff1", "committedDate": "2020-11-21T17:45:52Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "82ec547bd51eab8a2aa4f4ad9d478404278b0310", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/82ec547bd51eab8a2aa4f4ad9d478404278b0310", "committedDate": "2020-12-21T11:44:41Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "82ec547bd51eab8a2aa4f4ad9d478404278b0310", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/82ec547bd51eab8a2aa4f4ad9d478404278b0310", "committedDate": "2020-12-21T11:44:41Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "94fb0c08fdabe96078a7c3889f5d9012390c0c69", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/94fb0c08fdabe96078a7c3889f5d9012390c0c69", "committedDate": "2020-12-21T17:37:43Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjU4MTk1", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560658195", "createdAt": "2021-01-02T22:16:20Z", "commit": {"oid": "94fb0c08fdabe96078a7c3889f5d9012390c0c69"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQyMjoxNjoyMFrOINZ6XA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQyMjoxNzoyNFrOINZ6xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDkyNjk0MA==", "bodyText": "is this annotation needed?", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550926940", "createdAt": "2021-01-02T22:16:20Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -458,6 +525,7 @@ public void startSignInWorkflow() {\n \t\tstartActivityForResult(new Intent(this, SignInActivity.class), SIGN_IN_CODE);\n \t}\n \n+\t@RequiresApi(api = Build.VERSION_CODES.O)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94fb0c08fdabe96078a7c3889f5d9012390c0c69"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDkyNzA0Ng==", "bodyText": "test are falling cause of missing string resource R.string.dialog_privacy_policy_text\n22:57:24  /home/catroid/jenkins_slave/workspace/Catroid_PR-3873/catroid/src/androidTest/java/org/catrobat/catroid/uiespresso/ui/dialog/ReplaceApiKeyDialogTest.java:90: error: cannot find symbol 22:57:24  \t\t\t\t\t\tUiTestUtils.getResourcesString(R.string.dialog_privacy_policy_text)\ndid you forget to add it?", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550927046", "createdAt": "2021-01-02T22:17:24Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/res/values/strings.xml", "diffHunk": "@@ -79,6 +79,16 @@\n         You may also report the project on its page on the Catrobat community platform in case\n         you are sure that it is harmful.</string>\n \n+    <!-- Replace Api dialog -->\n+    <string name=\"api_replacement_dialog_neutral\">Upload with Keys anyway</string>\n+    <string name=\"api_replacement_dialog_accept\">Upload with Keys replaced</string>\n+    <string name=\"api_replacement_dialog_warning\">The project contains bricks that access the\n+        web, and also seems to contain API keys. Please see our <a\n+            href=\"https://wiki.catrobat.org/bin/view/Documentation/Web%20requests/\">wiki</a> why uploading these keys can be dangerous\n+        .</string>\n+    <!-- -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94fb0c08fdabe96078a7c3889f5d9012390c0c69"}, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "94fb0c08fdabe96078a7c3889f5d9012390c0c69", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/94fb0c08fdabe96078a7c3889f5d9012390c0c69", "committedDate": "2020-12-21T17:37:43Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "46f0721ebd483a0ae76d1f5f2aa3bb799f9f636c", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/46f0721ebd483a0ae76d1f5f2aa3bb799f9f636c", "committedDate": "2021-01-02T23:21:15Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46f0721ebd483a0ae76d1f5f2aa3bb799f9f636c", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/46f0721ebd483a0ae76d1f5f2aa3bb799f9f636c", "committedDate": "2021-01-02T23:21:15Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "7cfef8ea10c93ed6da7bb96cec2dea74d358ff90", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/7cfef8ea10c93ed6da7bb96cec2dea74d358ff90", "committedDate": "2021-01-03T10:08:11Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7cfef8ea10c93ed6da7bb96cec2dea74d358ff90", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/7cfef8ea10c93ed6da7bb96cec2dea74d358ff90", "committedDate": "2021-01-03T10:08:11Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "72c0194b6214e9b49b3bddc6701e492df7db3240", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/72c0194b6214e9b49b3bddc6701e492df7db3240", "committedDate": "2021-01-03T10:16:40Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "72c0194b6214e9b49b3bddc6701e492df7db3240", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/72c0194b6214e9b49b3bddc6701e492df7db3240", "committedDate": "2021-01-03T10:16:40Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "e0a2436b5976b6cc88538001b9ac458a81bef2fd", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/e0a2436b5976b6cc88538001b9ac458a81bef2fd", "committedDate": "2021-01-03T10:33:56Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjg4MzIz", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560688323", "createdAt": "2021-01-03T11:23:41Z", "commit": {"oid": "e0a2436b5976b6cc88538001b9ac458a81bef2fd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMToyMzo0MVrOINd69g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMToyMzo0MVrOINd69g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5MjYzMA==", "bodyText": "@Walcho1125 ?", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550992630", "createdAt": "2021-01-03T11:23:41Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -435,6 +501,7 @@ protected void verifyUserIdentity() {\n \t\t}\n \t}\n \n+\t@RequiresApi(api = Build.VERSION_CODES.O)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0a2436b5976b6cc88538001b9ac458a81bef2fd"}, "originalPosition": 134}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e0a2436b5976b6cc88538001b9ac458a81bef2fd", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/e0a2436b5976b6cc88538001b9ac458a81bef2fd", "committedDate": "2021-01-03T10:33:56Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "5b50e0223f570850e269f7a3ae5fc29111295774", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/5b50e0223f570850e269f7a3ae5fc29111295774", "committedDate": "2021-01-03T11:25:48Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b50e0223f570850e269f7a3ae5fc29111295774", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/5b50e0223f570850e269f7a3ae5fc29111295774", "committedDate": "2021-01-03T11:25:48Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "a48a4138f23a39374eda9976c00bcbb0aa5790e7", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/a48a4138f23a39374eda9976c00bcbb0aa5790e7", "committedDate": "2021-01-03T11:29:43Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjg4OTE5", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560688919", "createdAt": "2021-01-03T11:33:21Z", "commit": {"oid": "a48a4138f23a39374eda9976c00bcbb0aa5790e7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTozMzoyMVrOINd-xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTozNTo0MlrOINd_sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5MzYwNg==", "bodyText": "please remove this.", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550993606", "createdAt": "2021-01-03T11:33:21Z", "author": {"login": "ndrnour"}, "path": "catroid/src/androidTest/java/org/catrobat/catroid/test/utils/TestUtils.java", "diffHunk": "@@ -68,6 +69,20 @@ public static void deleteProjects(String... projectNames) throws IOException {\n \t\t}\n \t}\n \n+\tpublic static void deleteAllProjects() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a48a4138f23a39374eda9976c00bcbb0aa5790e7"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5MzgwNQ==", "bodyText": "please remove this. BaseActivityTestRule is taking care of that during the initialization. look at its implementation.", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550993805", "createdAt": "2021-01-03T11:35:18Z", "author": {"login": "ndrnour"}, "path": "catroid/src/androidTest/java/org/catrobat/catroid/uiespresso/ui/dialog/ReplaceApiKeyDialogTest.java", "diffHunk": "@@ -0,0 +1,139 @@\n+/*\n+ * Catroid: An on-device visual programming system for Android devices\n+ * Copyright (C) 2010-2020 The Catrobat Team\n+ * (<http://developer.catrobat.org/credits>)\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as\n+ * published by the Free Software Foundation, either version 3 of the\n+ * License, or (at your option) any later version.\n+ *\n+ * An additional term exception under section 7 of the GNU Affero\n+ * General Public License, version 3, is available at\n+ * http://developer.catrobat.org/license_additional_term\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ */\n+\n+package org.catrobat.catroid.uiespresso.ui.dialog;\n+\n+import android.content.Intent;\n+import android.content.SharedPreferences;\n+import android.preference.PreferenceManager;\n+import android.util.Log;\n+\n+import com.google.common.base.Charsets;\n+\n+import org.catrobat.catroid.ProjectManager;\n+import org.catrobat.catroid.R;\n+import org.catrobat.catroid.common.Constants;\n+import org.catrobat.catroid.content.Project;\n+import org.catrobat.catroid.content.Scene;\n+import org.catrobat.catroid.content.Script;\n+import org.catrobat.catroid.content.Sprite;\n+import org.catrobat.catroid.content.StartScript;\n+import org.catrobat.catroid.content.bricks.BackgroundRequestBrick;\n+import org.catrobat.catroid.io.asynctask.ProjectSaveTask;\n+import org.catrobat.catroid.test.utils.TestUtils;\n+import org.catrobat.catroid.uiespresso.ui.activity.ProjectUploadRatingDialogTest;\n+import org.catrobat.catroid.uiespresso.util.rules.BaseActivityTestRule;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import java.io.File;\n+import java.io.IOException;\n+\n+import androidx.test.core.app.ApplicationProvider;\n+\n+import static org.catrobat.catroid.common.Constants.CODE_XML_FILE_NAME;\n+import static org.catrobat.catroid.common.SharedPreferenceKeys.AGREED_TO_PRIVACY_POLICY_VERSION;\n+import static org.catrobat.catroid.ui.ProjectUploadActivity.PROJECT_DIR;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertTrue;\n+\n+import static androidx.test.espresso.Espresso.onView;\n+import static androidx.test.espresso.action.ViewActions.click;\n+import static androidx.test.espresso.matcher.ViewMatchers.withText;\n+\n+public class ReplaceApiKeyDialogTest {\n+\n+\tprivate static final String TAG = ReplaceApiKeyDialogTest.class.getSimpleName();\n+\n+\t@Rule\n+\tpublic BaseActivityTestRule<ProjectUploadRatingDialogTest.ProjectUploadTestActivity> activityTestRule =\n+\t\t\tnew BaseActivityTestRule<>(ProjectUploadRatingDialogTest.ProjectUploadTestActivity.class, false, false);\n+\n+\tprivate int bufferedPrivacyPolicyPreferenceSetting;\n+\n+\tProject dummyProject;\n+\tString apikey = \"AIzaas98d7f9a0sdf07ad0sf8a7sd09fASDf97asd9f\";\n+\t@Before\n+\tpublic void before() {\n+\t\tTestUtils.deleteAllProjects();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a48a4138f23a39374eda9976c00bcbb0aa5790e7"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5Mzg0Mw==", "bodyText": "same.", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550993843", "createdAt": "2021-01-03T11:35:42Z", "author": {"login": "ndrnour"}, "path": "catroid/src/androidTest/java/org/catrobat/catroid/uiespresso/ui/dialog/ReplaceApiKeyDialogTest.java", "diffHunk": "@@ -0,0 +1,139 @@\n+/*\n+ * Catroid: An on-device visual programming system for Android devices\n+ * Copyright (C) 2010-2020 The Catrobat Team\n+ * (<http://developer.catrobat.org/credits>)\n+ *\n+ * This program is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU Affero General Public License as\n+ * published by the Free Software Foundation, either version 3 of the\n+ * License, or (at your option) any later version.\n+ *\n+ * An additional term exception under section 7 of the GNU Affero\n+ * General Public License, version 3, is available at\n+ * http://developer.catrobat.org/license_additional_term\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU Affero General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Affero General Public License\n+ * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ */\n+\n+package org.catrobat.catroid.uiespresso.ui.dialog;\n+\n+import android.content.Intent;\n+import android.content.SharedPreferences;\n+import android.preference.PreferenceManager;\n+import android.util.Log;\n+\n+import com.google.common.base.Charsets;\n+\n+import org.catrobat.catroid.ProjectManager;\n+import org.catrobat.catroid.R;\n+import org.catrobat.catroid.common.Constants;\n+import org.catrobat.catroid.content.Project;\n+import org.catrobat.catroid.content.Scene;\n+import org.catrobat.catroid.content.Script;\n+import org.catrobat.catroid.content.Sprite;\n+import org.catrobat.catroid.content.StartScript;\n+import org.catrobat.catroid.content.bricks.BackgroundRequestBrick;\n+import org.catrobat.catroid.io.asynctask.ProjectSaveTask;\n+import org.catrobat.catroid.test.utils.TestUtils;\n+import org.catrobat.catroid.uiespresso.ui.activity.ProjectUploadRatingDialogTest;\n+import org.catrobat.catroid.uiespresso.util.rules.BaseActivityTestRule;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+\n+import java.io.File;\n+import java.io.IOException;\n+\n+import androidx.test.core.app.ApplicationProvider;\n+\n+import static org.catrobat.catroid.common.Constants.CODE_XML_FILE_NAME;\n+import static org.catrobat.catroid.common.SharedPreferenceKeys.AGREED_TO_PRIVACY_POLICY_VERSION;\n+import static org.catrobat.catroid.ui.ProjectUploadActivity.PROJECT_DIR;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertTrue;\n+\n+import static androidx.test.espresso.Espresso.onView;\n+import static androidx.test.espresso.action.ViewActions.click;\n+import static androidx.test.espresso.matcher.ViewMatchers.withText;\n+\n+public class ReplaceApiKeyDialogTest {\n+\n+\tprivate static final String TAG = ReplaceApiKeyDialogTest.class.getSimpleName();\n+\n+\t@Rule\n+\tpublic BaseActivityTestRule<ProjectUploadRatingDialogTest.ProjectUploadTestActivity> activityTestRule =\n+\t\t\tnew BaseActivityTestRule<>(ProjectUploadRatingDialogTest.ProjectUploadTestActivity.class, false, false);\n+\n+\tprivate int bufferedPrivacyPolicyPreferenceSetting;\n+\n+\tProject dummyProject;\n+\tString apikey = \"AIzaas98d7f9a0sdf07ad0sf8a7sd09fASDf97asd9f\";\n+\t@Before\n+\tpublic void before() {\n+\t\tTestUtils.deleteAllProjects();\n+\t\tSharedPreferences sharedPreferences = PreferenceManager\n+\t\t\t\t.getDefaultSharedPreferences(ApplicationProvider.getApplicationContext());\n+\n+\t\tbufferedPrivacyPolicyPreferenceSetting = sharedPreferences\n+\t\t\t\t.getInt(AGREED_TO_PRIVACY_POLICY_VERSION, 0);\n+\n+\t\tsharedPreferences\n+\t\t\t\t.edit()\n+\t\t\t\t.putInt(AGREED_TO_PRIVACY_POLICY_VERSION, Constants.CATROBAT_TERMS_OF_USE_ACCEPTED)\n+\t\t\t\t.commit();\n+\t\tdummyProject = new Project(ApplicationProvider.getApplicationContext(), \"ApiProject\");\n+\t\tScene dummyScene = new Scene(\"scene\", dummyProject);\n+\t\tProjectManager.getInstance().setCurrentProject(dummyProject);\n+\t\tSprite sprite = new Sprite(\"sprite\");\n+\t\tScript firstScript = new StartScript();\n+\t\tfirstScript.addBrick(new BackgroundRequestBrick(apikey));\n+\t\tdummyScene.addSprite(sprite);\n+\t\tsprite.addScript(firstScript);\n+\t\tdummyProject.addScene(dummyScene);\n+\t\tProjectSaveTask.task(dummyProject, ApplicationProvider.getApplicationContext());\n+\n+\t\tIntent intent = new Intent();\n+\t\tintent.putExtra(PROJECT_DIR, dummyProject.getDirectory());\n+\n+\t\tactivityTestRule.launchActivity(intent);\n+\t}\n+\n+\t@After\n+\tpublic void tearDown() throws Exception {\n+\t\tPreferenceManager.getDefaultSharedPreferences(ApplicationProvider.getApplicationContext())\n+\t\t\t\t.edit()\n+\t\t\t\t.putInt(AGREED_TO_PRIVACY_POLICY_VERSION,\n+\t\t\t\t\t\tbufferedPrivacyPolicyPreferenceSetting)\n+\t\t\t\t.commit();\n+\t\tTestUtils.deleteProjects(\"ApiProject\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a48a4138f23a39374eda9976c00bcbb0aa5790e7"}, "originalPosition": 115}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a48a4138f23a39374eda9976c00bcbb0aa5790e7", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/a48a4138f23a39374eda9976c00bcbb0aa5790e7", "committedDate": "2021-01-03T11:29:43Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/e4f095e43afcac3ab977e64cc6a1bb318b9e77f5", "committedDate": "2021-01-03T11:40:50Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjg5NTgy", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560689582", "createdAt": "2021-01-03T11:44:29Z", "commit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTo0NDoyOVrOINeDTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTo0NDoyOVrOINeDTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5NDc2Nw==", "bodyText": "this function should be void instead of boolean right?", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550994767", "createdAt": "2021-01-03T11:44:29Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +273,60 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"(<value>)[0-9a-zA-Z]{16,45}\";\n+\t\tcodeFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\n+\t\ttry {\n+\t\t\tcode = com.google.common.io.Files.toString(codeFile, Charsets.UTF_8);\n+\t\t} catch (IOException e) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(e));\n+\t\t}\n+\t\tfinal List<String> matches = new ArrayList<>();\n+\t\tif (code.contains(\"WebRequestBrick\") || code.contains(\"BackgroundRequestBrick\") || code.contains(\"LookRequestBrick\")) {\n+\t\t\tPattern pattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);\n+\t\t\tMatcher matcher = pattern.matcher(code);\n+\t\t\twhile (matcher.find()) {\n+\t\t\t\tmatches.add(matcher.group(0));\n+\t\t\t}\n+\t\t}\n+\t\tif (matches.size() > 0) {\n+\t\t\tfor (String match : matches) {\n+\t\t\t\tshowApiReplacementDialog(match);\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate void replaceSecret(String secrete) {\n+\t\tcode = code.replaceAll(secrete, \"<value>INSERT-API-KEY-HERE\");\n+\t\ttry {\n+\t\t\tFileOutputStream stream = new FileOutputStream(codeFile);\n+\t\t\tstream.write(code.getBytes(StandardCharsets.UTF_8));\n+\t\t} catch (IOException e) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(e));\n+\t\t}\n+\t}\n+\n+\tprivate boolean showApiReplacementDialog(String value) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "originalPosition": 91}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjg5OTQw", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560689940", "createdAt": "2021-01-03T11:50:27Z", "commit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTo1MDoyN1rOINeF7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTo1MDoyN1rOINeF7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5NTQzNg==", "bodyText": "remove pls", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550995436", "createdAt": "2021-01-03T11:50:27Z", "author": {"login": "ndrnour"}, "path": "catroid/src/androidTest/java/org/catrobat/catroid/test/utils/TestUtils.java", "diffHunk": "@@ -25,6 +25,7 @@\n import android.content.Context;\n import android.content.SharedPreferences;\n import android.preference.PreferenceManager;\n+import android.util.Log;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjkwMDYw", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560690060", "createdAt": "2021-01-03T11:52:22Z", "commit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTo1MjoyMlrOINeGpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTo1MjoyMlrOINeGpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5NTYyMQ==", "bodyText": "pls rename to xmlFile", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550995621", "createdAt": "2021-01-03T11:52:22Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -92,6 +100,8 @@\n \tpublic static final String NUMBER_OF_UPLOADED_PROJECTS = \"number_of_uploaded_projects\";\n \n \tprivate Project project;\n+\tprivate String code = \"\";\n+\tFile codeFile;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjkwMTMz", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560690133", "createdAt": "2021-01-03T11:53:37Z", "commit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTo1MzozN1rOINeHDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMTo1MzozN1rOINeHDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5NTcyNg==", "bodyText": "instead of hardcoding, declare them as private static final", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550995726", "createdAt": "2021-01-03T11:53:37Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +273,60 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"(<value>)[0-9a-zA-Z]{16,45}\";\n+\t\tcodeFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\n+\t\ttry {\n+\t\t\tcode = com.google.common.io.Files.toString(codeFile, Charsets.UTF_8);\n+\t\t} catch (IOException e) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(e));\n+\t\t}\n+\t\tfinal List<String> matches = new ArrayList<>();\n+\t\tif (code.contains(\"WebRequestBrick\") || code.contains(\"BackgroundRequestBrick\") || code.contains(\"LookRequestBrick\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "originalPosition": 67}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNjkwNTI1", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560690525", "createdAt": "2021-01-03T12:00:03Z", "commit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMjowMDowM1rOINeJyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wM1QxMjowMDowM1rOINeJyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDk5NjQyNQ==", "bodyText": "dialog.dismiss() instead of finish()", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r550996425", "createdAt": "2021-01-03T12:00:03Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +273,60 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"(<value>)[0-9a-zA-Z]{16,45}\";\n+\t\tcodeFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\n+\t\ttry {\n+\t\t\tcode = com.google.common.io.Files.toString(codeFile, Charsets.UTF_8);\n+\t\t} catch (IOException e) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(e));\n+\t\t}\n+\t\tfinal List<String> matches = new ArrayList<>();\n+\t\tif (code.contains(\"WebRequestBrick\") || code.contains(\"BackgroundRequestBrick\") || code.contains(\"LookRequestBrick\")) {\n+\t\t\tPattern pattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);\n+\t\t\tMatcher matcher = pattern.matcher(code);\n+\t\t\twhile (matcher.find()) {\n+\t\t\t\tmatches.add(matcher.group(0));\n+\t\t\t}\n+\t\t}\n+\t\tif (matches.size() > 0) {\n+\t\t\tfor (String match : matches) {\n+\t\t\t\tshowApiReplacementDialog(match);\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate void replaceSecret(String secrete) {\n+\t\tcode = code.replaceAll(secrete, \"<value>INSERT-API-KEY-HERE\");\n+\t\ttry {\n+\t\t\tFileOutputStream stream = new FileOutputStream(codeFile);\n+\t\t\tstream.write(code.getBytes(StandardCharsets.UTF_8));\n+\t\t} catch (IOException e) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(e));\n+\t\t}\n+\t}\n+\n+\tprivate boolean showApiReplacementDialog(String value) {\n+\t\tfinal AlertDialog alertDialog = new AlertDialog.Builder(this)\n+\t\t\t\t.setTitle(R.string.warning)\n+\t\t\t\t.setView(R.layout.dialog_replace_api_key)\n+\t\t\t\t.setPositiveButton(getText(R.string.api_replacement_dialog_accept), (dialog, which) -> {\n+\t\t\t\t\treplaceSecret(value);\n+\t\t\t\t})\n+\t\t\t\t.setNegativeButton(getText(R.string.api_replacement_dialog_neutral), null)\n+\t\t\t\t.setNeutralButton(getText(R.string.cancel), (dialog, which) -> {\n+\t\t\t\t\tfinish();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5"}, "originalPosition": 100}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e4f095e43afcac3ab977e64cc6a1bb318b9e77f5", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/e4f095e43afcac3ab977e64cc6a1bb318b9e77f5", "committedDate": "2021-01-03T11:40:50Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "dcfee1dc4bd0f9de313a88f6ec329b027e905065", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/dcfee1dc4bd0f9de313a88f6ec329b027e905065", "committedDate": "2021-01-03T12:23:25Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dcfee1dc4bd0f9de313a88f6ec329b027e905065", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/dcfee1dc4bd0f9de313a88f6ec329b027e905065", "committedDate": "2021-01-03T12:23:25Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "68ec80451d42fb6f38f9d19901a84dc3a8cddd39", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/68ec80451d42fb6f38f9d19901a84dc3a8cddd39", "committedDate": "2021-01-03T12:35:20Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "68ec80451d42fb6f38f9d19901a84dc3a8cddd39", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/68ec80451d42fb6f38f9d19901a84dc3a8cddd39", "committedDate": "2021-01-03T12:35:20Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "1ce95fbb03bff38675ddc5c507857f5efe47aac3", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/1ce95fbb03bff38675ddc5c507857f5efe47aac3", "committedDate": "2021-01-03T12:42:09Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNzAwMTg3", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560700187", "createdAt": "2021-01-03T14:19:04Z", "commit": {"oid": "1ce95fbb03bff38675ddc5c507857f5efe47aac3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ce95fbb03bff38675ddc5c507857f5efe47aac3", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/1ce95fbb03bff38675ddc5c507857f5efe47aac3", "committedDate": "2021-01-03T12:42:09Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "7048d416a9c8409b77087c61a5577ee31abf49eb", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/7048d416a9c8409b77087c61a5577ee31abf49eb", "committedDate": "2021-01-05T13:41:51Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated\n\nCATROID-742 Add Placeholder names"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7048d416a9c8409b77087c61a5577ee31abf49eb", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/7048d416a9c8409b77087c61a5577ee31abf49eb", "committedDate": "2021-01-05T13:41:51Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated\n\nCATROID-742 Add Placeholder names"}, "afterCommit": {"oid": "85d3e8c580a553331609c8637cd20a75f2a79ba8", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/85d3e8c580a553331609c8637cd20a75f2a79ba8", "committedDate": "2021-01-05T13:56:13Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated\n\nCATROID-742 Add Placeholder names"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "85d3e8c580a553331609c8637cd20a75f2a79ba8", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/85d3e8c580a553331609c8637cd20a75f2a79ba8", "committedDate": "2021-01-05T13:56:13Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated\n\nCATROID-742 Add Placeholder names"}, "afterCommit": {"oid": "a344645bdbf0d03aba607a790319f83817fe9902", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/a344645bdbf0d03aba607a790319f83817fe9902", "committedDate": "2021-01-05T15:37:14Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated\n\nCATROID-742 Add Placeholder names"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a344645bdbf0d03aba607a790319f83817fe9902", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/a344645bdbf0d03aba607a790319f83817fe9902", "committedDate": "2021-01-05T15:37:14Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated\n\nCATROID-742 Add Placeholder names"}, "afterCommit": {"oid": "15de186d54acaec2f001de8300414cb6874b36bd", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/15de186d54acaec2f001de8300414cb6874b36bd", "committedDate": "2021-01-05T17:14:38Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "15de186d54acaec2f001de8300414cb6874b36bd", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/15de186d54acaec2f001de8300414cb6874b36bd", "committedDate": "2021-01-05T17:14:38Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "2386ba4f36ad5e9dcad7f743738aa0ea5b26126c", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/2386ba4f36ad5e9dcad7f743738aa0ea5b26126c", "committedDate": "2021-01-05T19:30:18Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNzExNTA1", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-560711505", "createdAt": "2021-01-03T17:01:05Z", "commit": {"oid": "1ce95fbb03bff38675ddc5c507857f5efe47aac3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxNDozOToxOFrOIPEaJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxOTozMTo0N1rOIPTl0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjY3MTc4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <!-- Replace Api dialog -->\n          \n          \n            \n                <string name=\"api_replacement_dialog_neutral\">Upload with Keys anyway</string>\n          \n          \n            \n                <string name=\"api_replacement_dialog_accept\">Upload with Keys replaced</string>\n          \n          \n            \n                <string name=\"api_replacement_dialog_warning\">The project contains bricks that access the\n          \n          \n            \n                    web, and also seems to contain API keys. Please see our <a\n          \n          \n            \n                        href=\"https://wiki.catrobat.org/bin/view/Documentation/Web%20requests/\">wiki</a> why uploading these keys can be dangerous\n          \n          \n            \n                    .</string>\n          \n          \n            \n                <!-- Replace API dialog -->\n          \n          \n            \n                <string name=\"api_replacement_dialog_neutral\">Upload with this text anyway</string>\n          \n          \n            \n                <string name=\"api_replacement_dialog_accept\">Upload with API keys replaced</string>\n          \n          \n            \n                <string name=\"api_replacement_dialog_warning\">The project contains bricks that access the\n          \n          \n            \n                    web, and also seems to contain API keys. Please see the <a\n          \n          \n            \n                        href=\"https://catrob.at/webbricks\">wiki</a> why uploading these keys \n          \n          \n            \n                    can be dangerous.</string>\n          \n      \n    \n    \n  \n\nHowever, please change the format with the link in api_replacement_dialog_warning so that the html text with the URL is not included here verbatim, but instead is inserted at runtime, as a parameter, i.e., use something like %1 etc. Otherwise this can be destroyed by our translators, even inadvertently. We are not checking in all translations whether such links haven't been changed or somehow been corrupted.", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r552671782", "createdAt": "2021-01-06T14:39:18Z", "author": {"login": "wslany"}, "path": "catroid/src/main/res/values/strings.xml", "diffHunk": "@@ -78,6 +78,16 @@\n         You may also report the project on its page on the Catrobat community platform in case\n         you are sure that it is harmful.</string>\n \n+    <!-- Replace Api dialog -->\n+    <string name=\"api_replacement_dialog_neutral\">Upload with Keys anyway</string>\n+    <string name=\"api_replacement_dialog_accept\">Upload with Keys replaced</string>\n+    <string name=\"api_replacement_dialog_warning\">The project contains bricks that access the\n+        web, and also seems to contain API keys. Please see our <a\n+            href=\"https://wiki.catrobat.org/bin/view/Documentation/Web%20requests/\">wiki</a> why uploading these keys can be dangerous\n+        .</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2386ba4f36ad5e9dcad7f743738aa0ea5b26126c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjgyMzk2OA==", "bodyText": "Please make this string also translatable.\nWhy the \"e\" at the end of secrete, instead of secret?", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r552823968", "createdAt": "2021-01-06T17:15:36Z", "author": {"login": "wslany"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +278,62 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"(<value>).*?((?=.*[A-Za-z].*[0-9].*)[A-Za-z0-9]{24,45}).*?(</value>)\";\n+\t\txmlFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\n+\t\ttry {\n+\t\t\txml = com.google.common.io.Files.toString(xmlFile, Charsets.UTF_8);\n+\t\t} catch (IOException e) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(e));\n+\t\t}\n+\t\tif (xml.contains(WEB_REQUEST_BRICK) || xml.contains(BACKGROUND_REQUEST_BRICK) || xml.contains(LOOK_REQUEST_BRICK) || xml.contains(OPEN_URL_BRICK)) {\n+\t\t\tapiPattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);\n+\t\t\tapiMatcher = apiPattern.matcher(xml);\n+\t\t\tif (apiMatcher.find()) {\n+\t\t\t\tshowApiReplacementDialog(Objects.requireNonNull(apiMatcher.group(2)));\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate void apiKeyFound() {\n+\t\tif (apiMatcher.find(apiMatcher.end())) {\n+\t\t\tshowApiReplacementDialog(Objects.requireNonNull(apiMatcher.group(2)));\n+\t\t}\n+\t}\n+\n+\tprivate void replaceSecret(String secrete) {\n+\t\txml = xml.replaceAll(secrete, \"INSERT-API-KEY-HERE\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2386ba4f36ad5e9dcad7f743738aa0ea5b26126c"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjgyNDk1OQ==", "bodyText": "Please choose a better name than \"value\".", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r552824959", "createdAt": "2021-01-06T17:16:30Z", "author": {"login": "wslany"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +278,62 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"(<value>).*?((?=.*[A-Za-z].*[0-9].*)[A-Za-z0-9]{24,45}).*?(</value>)\";\n+\t\txmlFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\n+\t\ttry {\n+\t\t\txml = com.google.common.io.Files.toString(xmlFile, Charsets.UTF_8);\n+\t\t} catch (IOException e) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(e));\n+\t\t}\n+\t\tif (xml.contains(WEB_REQUEST_BRICK) || xml.contains(BACKGROUND_REQUEST_BRICK) || xml.contains(LOOK_REQUEST_BRICK) || xml.contains(OPEN_URL_BRICK)) {\n+\t\t\tapiPattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);\n+\t\t\tapiMatcher = apiPattern.matcher(xml);\n+\t\t\tif (apiMatcher.find()) {\n+\t\t\t\tshowApiReplacementDialog(Objects.requireNonNull(apiMatcher.group(2)));\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate void apiKeyFound() {\n+\t\tif (apiMatcher.find(apiMatcher.end())) {\n+\t\t\tshowApiReplacementDialog(Objects.requireNonNull(apiMatcher.group(2)));\n+\t\t}\n+\t}\n+\n+\tprivate void replaceSecret(String secrete) {\n+\t\txml = xml.replaceAll(secrete, \"INSERT-API-KEY-HERE\");\n+\t\ttry {\n+\t\t\tFileOutputStream stream = new FileOutputStream(xmlFile);\n+\t\t\tstream.write(xml.getBytes(StandardCharsets.UTF_8));\n+\t\t} catch (IOException e) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(e));\n+\t\t}\n+\t\tapiKeyFound();\n+\t}\n+\n+\tprivate void showApiReplacementDialog(String value) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2386ba4f36ad5e9dcad7f743738aa0ea5b26126c"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjkyMDUzMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tString regex = \"(<value>).*?((?=.*[A-Za-z].*[0-9].*)[A-Za-z0-9]{24,45}).*?(</value>)\";\n          \n          \n            \n            \t\tString regex = \"<value>.*?((?=[A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]{24,45})\";\n          \n      \n    \n    \n  \n\nNote: the capturing group needs to be changed to 1 in line 294 below.", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r552920530", "createdAt": "2021-01-06T19:31:47Z", "author": {"login": "wslany"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +278,62 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"(<value>).*?((?=.*[A-Za-z].*[0-9].*)[A-Za-z0-9]{24,45}).*?(</value>)\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2386ba4f36ad5e9dcad7f743738aa0ea5b26126c"}, "originalPosition": 58}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2386ba4f36ad5e9dcad7f743738aa0ea5b26126c", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/2386ba4f36ad5e9dcad7f743738aa0ea5b26126c", "committedDate": "2021-01-05T19:30:18Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "31b2245f17b407287b87758d5f804b6e554e1b20", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/31b2245f17b407287b87758d5f804b6e554e1b20", "committedDate": "2021-01-12T12:23:11Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31b2245f17b407287b87758d5f804b6e554e1b20", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/31b2245f17b407287b87758d5f804b6e554e1b20", "committedDate": "2021-01-12T12:23:11Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "51182f5c0d37c7ab310788f3c9b2c6d48f1d4c1a", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/51182f5c0d37c7ab310788f3c9b2c6d48f1d4c1a", "committedDate": "2021-01-12T12:38:00Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51182f5c0d37c7ab310788f3c9b2c6d48f1d4c1a", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/51182f5c0d37c7ab310788f3c9b2c6d48f1d4c1a", "committedDate": "2021-01-12T12:38:00Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "d17d0e08be43e2798077013aa0a502bfef8200fd", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/d17d0e08be43e2798077013aa0a502bfef8200fd", "committedDate": "2021-01-18T13:24:22Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d17d0e08be43e2798077013aa0a502bfef8200fd", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/d17d0e08be43e2798077013aa0a502bfef8200fd", "committedDate": "2021-01-18T13:24:22Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "32f94cfb05256df13b1e8b5bea0044ac91aeba6f", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/32f94cfb05256df13b1e8b5bea0044ac91aeba6f", "committedDate": "2021-01-18T13:39:51Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "32f94cfb05256df13b1e8b5bea0044ac91aeba6f", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/32f94cfb05256df13b1e8b5bea0044ac91aeba6f", "committedDate": "2021-01-18T13:39:51Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "36999d31566f117d64878c7341289ff503d492de", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/36999d31566f117d64878c7341289ff503d492de", "committedDate": "2021-01-18T14:05:15Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "36999d31566f117d64878c7341289ff503d492de", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/36999d31566f117d64878c7341289ff503d492de", "committedDate": "2021-01-18T14:05:15Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "529ed9334cd75bb6528bef902093b3b19a157a69", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/529ed9334cd75bb6528bef902093b3b19a157a69", "committedDate": "2021-01-19T09:33:11Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcyMzczMTYy", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-572373162", "createdAt": "2021-01-20T15:58:18Z", "commit": {"oid": "529ed9334cd75bb6528bef902093b3b19a157a69"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTczODY1MTEy", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-573865112", "createdAt": "2021-01-22T01:16:30Z", "commit": {"oid": "529ed9334cd75bb6528bef902093b3b19a157a69"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "529ed9334cd75bb6528bef902093b3b19a157a69", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/529ed9334cd75bb6528bef902093b3b19a157a69", "committedDate": "2021-01-19T09:33:11Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "51f7dce35ff16b55cfb3fd5e655241cc10dc1f97", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/51f7dce35ff16b55cfb3fd5e655241cc10dc1f97", "committedDate": "2021-01-28T11:57:41Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51f7dce35ff16b55cfb3fd5e655241cc10dc1f97", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/51f7dce35ff16b55cfb3fd5e655241cc10dc1f97", "committedDate": "2021-01-28T11:57:41Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "92e18b4487669c87051e010e4f485da2dfca2ee5", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/92e18b4487669c87051e010e4f485da2dfca2ee5", "committedDate": "2021-01-28T14:08:59Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5e44f9a2309783b30af7007804794aca49c18030", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/5e44f9a2309783b30af7007804794aca49c18030", "committedDate": "2021-01-28T14:32:01Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "08e1a1f830db22dbf94c6fd9a8490d10103001d0", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/08e1a1f830db22dbf94c6fd9a8490d10103001d0", "committedDate": "2021-01-28T14:46:20Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "08e1a1f830db22dbf94c6fd9a8490d10103001d0", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/08e1a1f830db22dbf94c6fd9a8490d10103001d0", "committedDate": "2021-01-28T14:46:20Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/5b15b12e4c729a9b44cca30c8c1c1c23a6142a49", "committedDate": "2021-01-28T15:45:54Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk0NzU4MDgy", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-594758082", "createdAt": "2021-02-20T14:45:24Z", "commit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMFQxNDo0NToyNFrOIoz_rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMFQxNDo0NToyNFrOIoz_rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3OTY2NTgzOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    web, and also seems to contain API keys. Please see our &lt;a href=%1s&gt;wiki&lt;/a&gt; why\n          \n          \n            \n                    web, and also seems to contain API keys. Please see %1s why\n          \n      \n    \n    \n  \n\nThis shall be a clickable link, and the link shall be visible. It must be easy for translators.", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r579665838", "createdAt": "2021-02-20T14:45:24Z", "author": {"login": "wslany"}, "path": "catroid/src/main/res/values/strings.xml", "diffHunk": "@@ -81,6 +81,16 @@\n         You may also report the project on its page on the Catrobat community platform in case\n         you are sure that it is harmful.</string>\n \n+    <!-- Replace Api dialog -->\n+    <string name=\"api_replacement_dialog_neutral\">Upload with Keys anyway</string>\n+    <string name=\"api_replacement_dialog_accept\">Upload with Keys replaced</string>\n+    <string name=\"api_replacement_dialog_warning\">The project contains bricks that access the\n+        web, and also seems to contain API keys. Please see our &lt;a href=%1s&gt;wiki&lt;/a&gt; why", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk0NzU4MzE4", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-594758318", "createdAt": "2021-02-20T14:48:20Z", "commit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMFQxNDo0ODoyMFrOIo0BRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMFQxNDo0ODoyMFrOIo0BRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3OTY2NjI0Ng==", "bodyText": "Please eliminate this special font (it increases our APK size by 3% without adding value).", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r579666246", "createdAt": "2021-02-20T14:48:20Z", "author": {"login": "wslany"}, "path": "catroid/src/main/res/layout/dialog_replace_api_key.xml", "diffHunk": "@@ -0,0 +1,49 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<!--\n+  ~ Catroid: An on-device visual programming system for Android devices\n+  ~ Copyright (C) 2010-2020 The Catrobat Team\n+  ~ (<http://developer.catrobat.org/credits>)\n+  ~\n+  ~ This program is free software: you can redistribute it and/or modify\n+  ~ it under the terms of the GNU Affero General Public License as\n+  ~ published by the Free Software Foundation, either version 3 of the\n+  ~ License, or (at your option) any later version.\n+  ~\n+  ~ An additional term exception under section 7 of the GNU Affero\n+  ~ General Public License, version 3, is available at\n+  ~ http://developer.catrobat.org/license_additional_term\n+  ~\n+  ~ This program is distributed in the hope that it will be useful,\n+  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of\n+  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+  ~ GNU Affero General Public License for more details.\n+  ~\n+  ~ You should have received a copy of the GNU Affero General Public License\n+  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+  -->\n+\n+<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"match_parent\"\n+    android:orientation=\"vertical\"\n+    android:paddingEnd=\"@dimen/dialog_content_area_padding\"\n+    android:paddingStart=\"@dimen/dialog_content_area_padding\"\n+    android:paddingTop=\"@dimen/dialog_content_area_padding_top\">\n+\n+         <TextView\n+             android:id=\"@+id/replace_api_key_warning\"\n+             android:layout_width=\"wrap_content\"\n+             android:layout_height=\"wrap_content\"\n+             android:layout_marginBottom=\"@dimen/material_design_spacing_x_large\"/>\n+         <TextView\n+             android:id=\"@+id/replace_api_key\"\n+             android:layout_width=\"match_parent\"\n+             android:layout_height=\"wrap_content\"\n+             android:background=\"#FFFFFF\"\n+             android:paddingLeft=\"24pt\"\n+             android:paddingRight=\"24pt\"\n+             android:paddingTop=\"14pt\"\n+             android:paddingBottom=\"14pt\"\n+             android:textColor=\"#000000\"\n+             android:fontFamily=\"@font/courbd\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk0NzYxNzQ2", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-594761746", "createdAt": "2021-02-20T15:34:51Z", "commit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMFQxNTozNDo1MVrOIo0VOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMFQxNTozNDo1MVrOIo0VOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3OTY3MTM1Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <string name=\"api_replacement_dialog_neutral\">Upload with Keys anyway</string>\n          \n          \n            \n                <string name=\"api_replacement_dialog_accept\">Upload with Keys replaced</string>\n          \n          \n            \n                <string name=\"api_replacement_dialog_neutral\">Upload without change</string>\n          \n          \n            \n                <string name=\"api_replacement_dialog_accept\">Upload with keys replaced</string>", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r579671353", "createdAt": "2021-02-20T15:34:51Z", "author": {"login": "wslany"}, "path": "catroid/src/main/res/values/strings.xml", "diffHunk": "@@ -81,6 +81,16 @@\n         You may also report the project on its page on the Catrobat community platform in case\n         you are sure that it is harmful.</string>\n \n+    <!-- Replace Api dialog -->\n+    <string name=\"api_replacement_dialog_neutral\">Upload with Keys anyway</string>\n+    <string name=\"api_replacement_dialog_accept\">Upload with Keys replaced</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk0NzYyNzQw", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-594762740", "createdAt": "2021-02-20T15:48:18Z", "commit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b15b12e4c729a9b44cca30c8c1c1c23a6142a49", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/5b15b12e4c729a9b44cca30c8c1c1c23a6142a49", "committedDate": "2021-01-28T15:45:54Z", "message": "CATROID-600 Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "dc577dbea7f075d18de6e601daf47faeab4e2788", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/dc577dbea7f075d18de6e601daf47faeab4e2788", "committedDate": "2021-02-26T10:16:46Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc577dbea7f075d18de6e601daf47faeab4e2788", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/dc577dbea7f075d18de6e601daf47faeab4e2788", "committedDate": "2021-02-26T10:16:46Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "3915f9110acaa636724dfabfa8e47e52da351183", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/3915f9110acaa636724dfabfa8e47e52da351183", "committedDate": "2021-02-26T10:42:41Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3915f9110acaa636724dfabfa8e47e52da351183", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/3915f9110acaa636724dfabfa8e47e52da351183", "committedDate": "2021-02-26T10:42:41Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "f8e2d053b4fdea4928f99e3d6d7b953572860efd", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/f8e2d053b4fdea4928f99e3d6d7b953572860efd", "committedDate": "2021-02-28T18:11:34Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA1ODIxNTY0", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-605821564", "createdAt": "2021-03-07T08:34:42Z", "commit": {"oid": "f8e2d053b4fdea4928f99e3d6d7b953572860efd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wN1QwODozNDo0MlrOIxtWQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wN1QwODo0MjoxMFrOIxtZyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODk5NDExMw==", "bodyText": "This seems unnecessary", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r588994113", "createdAt": "2021-03-07T08:34:42Z", "author": {"login": "juliajulie95"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +289,97 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"<value>.*?((?=[A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]{24,45})\";\n+\t\txmlFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\n+\t\ttry {\n+\t\t\txml = Files.asCharSource(xmlFile, Charsets.UTF_8).read();\n+\t\t\tbackUpXml = xml;\n+\t\t} catch (IOException exception) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(exception));\n+\t\t}\n+\t\tif (xml.contains(WEB_REQUEST_BRICK) || xml.contains(BACKGROUND_REQUEST_BRICK) || xml.contains(LOOK_REQUEST_BRICK) || xml.contains(OPEN_URL_BRICK)) {\n+\t\t\tPattern apiPattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);\n+\t\t\tapiMatcher = apiPattern.matcher(xml);\n+\t\t\tif (apiMatcher.find()) {\n+\t\t\t\tshowApiReplacementDialog(Objects.requireNonNull(apiMatcher.group(1)));\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate void apiKeyFound() {\n+\t\tif (apiMatcher.find(apiMatcher.end())) {\n+\t\t\tshowApiReplacementDialog(Objects.requireNonNull(apiMatcher.group(1)));\n+\t\t}\n+\t}\n+\n+\tprivate void replaceSecret(String secret) {\n+\t\txml = xml.replaceAll(secret, getString(R.string.api_replacement));\n+\t\ttry {\n+\t\t\tFileOutputStream stream = new FileOutputStream(xmlFile);\n+\t\t\tstream.write(xml.getBytes(StandardCharsets.UTF_8));\n+\t\t} catch (IOException exception) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(exception));\n+\t\t}\n+\t\treloadProject();\n+\t\tapiKeyFound();\n+\t}\n+\n+\tprivate void reloadProject() {\n+\t\ttry {\n+\t\t\tProjectManager.getInstance().loadProject(project.getDirectory());\n+\t\t\tproject = ProjectManager.getInstance().getCurrentProject();\n+\t\t} catch (ProjectException exception) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(exception));\n+\t\t}\n+\t}\n+\n+\tprivate void loadBackup() {\n+\t\tString currentName = project.getName();\n+\t\tif (!currentName.equals(originalProjectName) && !originalProjectName.equals(project.getName())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8e2d053b4fdea4928f99e3d6d7b953572860efd"}, "originalPosition": 136}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODk5NDcxNQ==", "bodyText": "Files.copy? or FileUtils.copyFile?", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r588994715", "createdAt": "2021-03-07T08:39:15Z", "author": {"login": "juliajulie95"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +289,97 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"<value>.*?((?=[A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]{24,45})\";\n+\t\txmlFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\n+\t\ttry {\n+\t\t\txml = Files.asCharSource(xmlFile, Charsets.UTF_8).read();\n+\t\t\tbackUpXml = xml;\n+\t\t} catch (IOException exception) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(exception));\n+\t\t}\n+\t\tif (xml.contains(WEB_REQUEST_BRICK) || xml.contains(BACKGROUND_REQUEST_BRICK) || xml.contains(LOOK_REQUEST_BRICK) || xml.contains(OPEN_URL_BRICK)) {\n+\t\t\tPattern apiPattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);\n+\t\t\tapiMatcher = apiPattern.matcher(xml);\n+\t\t\tif (apiMatcher.find()) {\n+\t\t\t\tshowApiReplacementDialog(Objects.requireNonNull(apiMatcher.group(1)));\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate void apiKeyFound() {\n+\t\tif (apiMatcher.find(apiMatcher.end())) {\n+\t\t\tshowApiReplacementDialog(Objects.requireNonNull(apiMatcher.group(1)));\n+\t\t}\n+\t}\n+\n+\tprivate void replaceSecret(String secret) {\n+\t\txml = xml.replaceAll(secret, getString(R.string.api_replacement));\n+\t\ttry {\n+\t\t\tFileOutputStream stream = new FileOutputStream(xmlFile);\n+\t\t\tstream.write(xml.getBytes(StandardCharsets.UTF_8));\n+\t\t} catch (IOException exception) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(exception));\n+\t\t}\n+\t\treloadProject();\n+\t\tapiKeyFound();\n+\t}\n+\n+\tprivate void reloadProject() {\n+\t\ttry {\n+\t\t\tProjectManager.getInstance().loadProject(project.getDirectory());\n+\t\t\tproject = ProjectManager.getInstance().getCurrentProject();\n+\t\t} catch (ProjectException exception) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(exception));\n+\t\t}\n+\t}\n+\n+\tprivate void loadBackup() {\n+\t\tString currentName = project.getName();\n+\t\tif (!currentName.equals(originalProjectName) && !originalProjectName.equals(project.getName())) {\n+\t\t\tString toReplace = PROGRAM_NAME_START_TAG + originalProjectName + PROGRAM_NAME_END_TAG;\n+\t\t\tString replaceWith = PROGRAM_NAME_START_TAG + currentName + PROGRAM_NAME_END_TAG;\n+\t\t\txmlFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\t\t\tbackUpXml = backUpXml.replace(toReplace, replaceWith);\n+\t\t}\n+\t\ttry {\n+\t\t\tFileOutputStream stream = new FileOutputStream(xmlFile);\n+\t\t\tstream.write(backUpXml.getBytes(StandardCharsets.UTF_8));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8e2d053b4fdea4928f99e3d6d7b953572860efd"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODk5NTAxOA==", "bodyText": "duplicate to function apiKeyFound?", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r588995018", "createdAt": "2021-03-07T08:42:10Z", "author": {"login": "juliajulie95"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -263,6 +289,97 @@ private void onNextButtonClick() {\n \t\t}\n \t}\n \n+\tprivate void checkCodeforApiKey() {\n+\t\tString regex = \"<value>.*?((?=[A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]{24,45})\";\n+\t\txmlFile = new File(project.getDirectory(), CODE_XML_FILE_NAME);\n+\n+\t\ttry {\n+\t\t\txml = Files.asCharSource(xmlFile, Charsets.UTF_8).read();\n+\t\t\tbackUpXml = xml;\n+\t\t} catch (IOException exception) {\n+\t\t\tLog.e(TAG, Log.getStackTraceString(exception));\n+\t\t}\n+\t\tif (xml.contains(WEB_REQUEST_BRICK) || xml.contains(BACKGROUND_REQUEST_BRICK) || xml.contains(LOOK_REQUEST_BRICK) || xml.contains(OPEN_URL_BRICK)) {\n+\t\t\tPattern apiPattern = Pattern.compile(regex, Pattern.CASE_INSENSITIVE);\n+\t\t\tapiMatcher = apiPattern.matcher(xml);\n+\t\t\tif (apiMatcher.find()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8e2d053b4fdea4928f99e3d6d7b953572860efd"}, "originalPosition": 101}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aef58bf20cdf787079d5991d96715c78492203d1", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/aef58bf20cdf787079d5991d96715c78492203d1", "committedDate": "2021-03-09T13:23:49Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f8e2d053b4fdea4928f99e3d6d7b953572860efd", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/f8e2d053b4fdea4928f99e3d6d7b953572860efd", "committedDate": "2021-02-28T18:11:34Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}, "afterCommit": {"oid": "aef58bf20cdf787079d5991d96715c78492203d1", "author": {"user": {"login": "Walcho1125", "name": "Oskar W"}}, "url": "https://github.com/Catrobat/Catroid/commit/aef58bf20cdf787079d5991d96715c78492203d1", "committedDate": "2021-03-09T13:23:49Z", "message": "CATROID-600 Test Automatically detect API keys and warn user when uploading is initiated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA4OTI1NDU1", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-608925455", "createdAt": "2021-03-10T16:37:44Z", "commit": {"oid": "aef58bf20cdf787079d5991d96715c78492203d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE1ODkxNDA5", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-615891409", "createdAt": "2021-03-18T21:32:48Z", "commit": {"oid": "aef58bf20cdf787079d5991d96715c78492203d1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOFQyMTozMjo0OVrOI5lqBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOFQyMTozMjo0OVrOI5lqBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzI1NjcwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate static final String WIKI_URL = \"<a href='https://wiki.catrobat\"\n          \n          \n            \n            \t\t\t+ \".org/bin/view/Documentation/Web%20requests/'>https://wiki.catrobat.org/bin/view/Documentation/Web%20requests/</a>\";\n          \n          \n            \n            \tprivate static final String WIKI_URL = \"<a href='https://catrob.at/webbricks'>\"\n          \n          \n            \n            \t\t+ \"https://catrob.at/webbricks</a>\";", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r597256708", "createdAt": "2021-03-18T21:32:49Z", "author": {"login": "wslany"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -90,8 +101,21 @@\n \n \tpublic static final int MAX_NUMBER_OF_TAGS_CHECKED = 3;\n \tpublic static final String NUMBER_OF_UPLOADED_PROJECTS = \"number_of_uploaded_projects\";\n+\tprivate static final String WEB_REQUEST_BRICK = \"WebRequestBrick\";\n+\tprivate static final String BACKGROUND_REQUEST_BRICK = \"BackgroundRequestBrick\";\n+\tprivate static final String LOOK_REQUEST_BRICK = \"LookRequestBrick\";\n+\tprivate static final String OPEN_URL_BRICK = \"OpenUrlBrick\";\n+\tprivate static final String WIKI_URL = \"<a href='https://wiki.catrobat\"\n+\t\t\t+ \".org/bin/view/Documentation/Web%20requests/'>https://wiki.catrobat.org/bin/view/Documentation/Web%20requests/</a>\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aef58bf20cdf787079d5991d96715c78492203d1"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a53db423a106dccdcda08ace1234aedb5d6d312a", "author": {"user": {"login": "wslany", "name": "Wolfgang Slany"}}, "url": "https://github.com/Catrobat/Catroid/commit/a53db423a106dccdcda08ace1234aedb5d6d312a", "committedDate": "2021-03-18T21:39:13Z", "message": "Short url to webbricks wiki page"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE1OTE2MDI3", "url": "https://github.com/Catrobat/Catroid/pull/3873#pullrequestreview-615916027", "createdAt": "2021-03-18T22:12:19Z", "commit": {"oid": "a53db423a106dccdcda08ace1234aedb5d6d312a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOFQyMjoxMjoxOVrOI5m6Pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOFQyMjoxMjoxOVrOI5m6Pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzI3NzI0Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t+ \"https://catrob.at/webbricks</a>\";\n          \n          \n            \n            \t\t\t+ \"https://catrob.at/webbricks</a>\";", "url": "https://github.com/Catrobat/Catroid/pull/3873#discussion_r597277246", "createdAt": "2021-03-18T22:12:19Z", "author": {"login": "wslany"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/ProjectUploadActivity.java", "diffHunk": "@@ -90,8 +101,21 @@\n \n \tpublic static final int MAX_NUMBER_OF_TAGS_CHECKED = 3;\n \tpublic static final String NUMBER_OF_UPLOADED_PROJECTS = \"number_of_uploaded_projects\";\n+\tprivate static final String WEB_REQUEST_BRICK = \"WebRequestBrick\";\n+\tprivate static final String BACKGROUND_REQUEST_BRICK = \"BackgroundRequestBrick\";\n+\tprivate static final String LOOK_REQUEST_BRICK = \"LookRequestBrick\";\n+\tprivate static final String OPEN_URL_BRICK = \"OpenUrlBrick\";\n+\tprivate static final String WIKI_URL = \"<a href='https://catrob.at/webbricks'>\"\n+\t\t+ \"https://catrob.at/webbricks</a>\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a53db423a106dccdcda08ace1234aedb5d6d312a"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6082ec1b5bc50d3972eec91d46004311aa8931a", "author": {"user": {"login": "wslany", "name": "Wolfgang Slany"}}, "url": "https://github.com/Catrobat/Catroid/commit/a6082ec1b5bc50d3972eec91d46004311aa8931a", "committedDate": "2021-03-18T22:12:35Z", "message": "correct indentation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2058, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}