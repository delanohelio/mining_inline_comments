{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyMTgwMjUz", "number": 3851, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDowNDowMlrOEzdirg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDowNDo0OVrOEzdkJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMzk2ODQ2OnYy", "diffSide": "RIGHT", "path": "catroid/src/main/java/org/catrobat/catroid/ui/MainMenuActivity.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDowNDowMlrOHqsj5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDowNDowMlrOHqsj5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUzMjMyNg==", "bodyText": "Please outsource this to an extra method (e.g. showTermsOfUseDialog()) in order to keep the onCreate() method compact.", "url": "https://github.com/Catrobat/Catroid/pull/3851#discussion_r514532326", "createdAt": "2020-10-29T20:04:02Z", "author": {"login": "mstoeg"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/MainMenuActivity.java", "diffHunk": "@@ -87,28 +89,54 @@ protected void onCreate(Bundle savedInstanceState) {\n \t\tPreferenceManager.setDefaultValues(this, R.xml.preferences, true);\n \t\tScreenValueHandler.updateScreenWidthAndHeight(this);\n \n-\t\tint oldPrivacyPolicyHash = PreferenceManager.getDefaultSharedPreferences(this)\n+\t\tint oldPrivacyPolicy = PreferenceManager.getDefaultSharedPreferences(this)\n \t\t\t\t\t\t.getInt(AGREED_TO_PRIVACY_POLICY_VERSION, 0);\n-\t\tint currentPrivacyPolicyHash = getResources().getString(R.string.dialog_privacy_policy_text)\n-\t\t\t\t\t\t.hashCode();\n-\t\tif (oldPrivacyPolicyHash == currentPrivacyPolicyHash) {\n+\n+\t\tif (oldPrivacyPolicy == Constants.CATROBAT_TERMS_OF_USE_ACCEPTED) {\n \t\t\tloadContent();\n \t\t} else {\n-\t\t\tsetContentView(R.layout.privacy_policy_view);\n+\t\t\tView view = View.inflate(this, R.layout.privacy_policy_view, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd4fed0e808c1507d640fe15d1b6980c2015b630"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyMzk3MjIzOnYy", "diffSide": "RIGHT", "path": "catroid/src/main/java/org/catrobat/catroid/ui/MainMenuActivity.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDowNDo0OVrOHqsmKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMDowNDo0OVrOHqsmKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUzMjkwNw==", "bodyText": "Please use lambda-expressions here. They should be suggested by Android Studio automatically.", "url": "https://github.com/Catrobat/Catroid/pull/3851#discussion_r514532907", "createdAt": "2020-10-29T20:04:49Z", "author": {"login": "mstoeg"}, "path": "catroid/src/main/java/org/catrobat/catroid/ui/MainMenuActivity.java", "diffHunk": "@@ -87,28 +89,54 @@ protected void onCreate(Bundle savedInstanceState) {\n \t\tPreferenceManager.setDefaultValues(this, R.xml.preferences, true);\n \t\tScreenValueHandler.updateScreenWidthAndHeight(this);\n \n-\t\tint oldPrivacyPolicyHash = PreferenceManager.getDefaultSharedPreferences(this)\n+\t\tint oldPrivacyPolicy = PreferenceManager.getDefaultSharedPreferences(this)\n \t\t\t\t\t\t.getInt(AGREED_TO_PRIVACY_POLICY_VERSION, 0);\n-\t\tint currentPrivacyPolicyHash = getResources().getString(R.string.dialog_privacy_policy_text)\n-\t\t\t\t\t\t.hashCode();\n-\t\tif (oldPrivacyPolicyHash == currentPrivacyPolicyHash) {\n+\n+\t\tif (oldPrivacyPolicy == Constants.CATROBAT_TERMS_OF_USE_ACCEPTED) {\n \t\t\tloadContent();\n \t\t} else {\n-\t\t\tsetContentView(R.layout.privacy_policy_view);\n+\t\t\tView view = View.inflate(this, R.layout.privacy_policy_view, null);\n+\n+\t\t\tTextView termsOfUseUrlTextView = view.findViewById(R.id.dialog_privacy_policy_text_view_url);\n+\n+\t\t\ttermsOfUseUrlTextView.setMovementMethod(LinkMovementMethod.getInstance());\n+\n+\t\t\tString termsOfUseUrlStringText = getString(R.string.main_menu_terms_of_use);\n+\n+\t\t\tString termsOfUseUrl = getString(R.string.terms_of_use_link_template, Constants.CATROBAT_TERMS_OF_USE_URL\n+\t\t\t\t\t\t\t+ Constants.CATROBAT_TERMS_OF_USE_TOKEN_FLAVOR_URL + BuildConfig.FLAVOR\n+\t\t\t\t\t\t\t+ Constants.CATROBAT_TERMS_OF_USE_TOKEN_VERSION_URL + BuildConfig.VERSION_CODE,\n+\t\t\t\t\t\t\ttermsOfUseUrlStringText);\n+\n+\t\t\ttermsOfUseUrlTextView.setText(Html.fromHtml(termsOfUseUrl));\n+\n+\t\t\tnew AlertDialog.Builder(this)\n+\t\t\t\t\t.setNegativeButton(R.string.decline, new DialogInterface.OnClickListener() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd4fed0e808c1507d640fe15d1b6980c2015b630"}, "originalPosition": 47}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3668, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}