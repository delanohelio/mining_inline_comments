{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0Mjk4NzI2", "number": 3693, "title": "CATROID-650 + CATROID-385 Project image empty if the default scene has no screenshot", "bodyText": "https://jira.catrob.at/browse/CATROID-650\nhttps://jira.catrob.at/browse/CATROID-385\n\n\nadded saving a project screenshot in the project folder, when new scene screenshot is taken\n\n\nadded a function that gets scene with the last modified screenshot if no project screenshot available\n\n\nfixed thumbnail for ProjectUpload\n\n\nYour checklist for this pull request\nPlease review the contributing guidelines and wiki pages of this repository.\n\n Include the name of the Jira ticket in the PR\u2019s title\n Include a summary of the changes plus the relevant context\n Choose the proper base branch (develop)\n Confirm that the changes follow the project\u2019s coding guidelines\n Verify that the changes generate no compiler or linter warnings\n Perform a self-review of the changes\n Verify to commit no other files than the intentionally changed ones\n Include reasonable and readable tests verifying the added or changed behavior\n Confirm that new and existing unit tests pass locally\n Check that the commits\u2019 message style matches the project\u2019s guideline\n Stick to the project\u2019s gitflow workflow\n Verify that your changes do not have any conflicts with the base branch\n After the PR, verify that all CI checks have passed\n Post a message in the catroid-stage or catroid-ide Slack channel and ask for a code reviewer", "createdAt": "2020-07-21T09:11:56Z", "url": "https://github.com/Catrobat/Catroid/pull/3693", "merged": true, "mergeCommit": {"oid": "f28b2db78cc1011ab6927963316eb70af57e218d"}, "closed": true, "closedAt": "2020-07-27T16:03:34Z", "author": {"login": "juliajulie95"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3G_rXABqjM1NzE1MTcyOTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5D1ssAFqTQ1NTkwOTY1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MzIzNzA2", "url": "https://github.com/Catrobat/Catroid/pull/3693#pullrequestreview-455323706", "createdAt": "2020-07-26T00:44:08Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwMDo0NDowOVrOG3IXbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwMTozNTozMFrOG3Ik8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2MTkzMw==", "bodyText": "please rename it to getSceneScreenShot", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460461933", "createdAt": "2020-07-26T00:44:09Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/io/ProjectAndSceneScreenshotLoader.java", "diffHunk": "@@ -115,6 +120,41 @@ public File getScreenshotFile(String projectName, String sceneName, boolean isBa\n \t\treturn screenshotLoader.getScreenshotFile();\n \t}\n \n+\tpublic String getScreenshotScene(File projectDir) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2MTk5MQ==", "bodyText": "please avoid hard coded values.", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460461991", "createdAt": "2020-07-26T00:44:56Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/io/ProjectAndSceneScreenshotLoader.java", "diffHunk": "@@ -115,6 +120,41 @@ public File getScreenshotFile(String projectName, String sceneName, boolean isBa\n \t\treturn screenshotLoader.getScreenshotFile();\n \t}\n \n+\tpublic String getScreenshotScene(File projectDir) {\n+\t\tFilenameFilter filter = new FilenameFilter() {\n+\n+\t\t\tpublic boolean accept(File f, String name) {\n+\t\t\t\treturn name.endsWith(\"screenshot.png\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2MjM4NQ==", "bodyText": "why this code is needed since this function handle the structure of the new projects (projects with scenes),\nif you wanna handle the structure of the old projects (projects without Scenes like https://share.catrob.at/app/project/817) please create another function. also, why returning null if projectScreenshots.length != 0 ?", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460462385", "createdAt": "2020-07-26T00:51:19Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/io/ProjectAndSceneScreenshotLoader.java", "diffHunk": "@@ -115,6 +120,41 @@ public File getScreenshotFile(String projectName, String sceneName, boolean isBa\n \t\treturn screenshotLoader.getScreenshotFile();\n \t}\n \n+\tpublic String getScreenshotScene(File projectDir) {\n+\t\tFilenameFilter filter = new FilenameFilter() {\n+\n+\t\t\tpublic boolean accept(File f, String name) {\n+\t\t\t\treturn name.endsWith(\"screenshot.png\");\n+\t\t\t}\n+\t\t};\n+\t\tFile[] projectScreenshots = projectDir.listFiles(filter);\n+\t\tif (projectScreenshots == null || projectScreenshots.length != 0) {\n+\t\t\treturn null;\n+\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2MjUwNQ==", "bodyText": "scene.listFiles(filter) is already defined as sceneScreenshots  in line 136, so please change it to\nscreenshots.addAll(Arrays.asList(sceneScreenshots));", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460462505", "createdAt": "2020-07-26T00:53:14Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/io/ProjectAndSceneScreenshotLoader.java", "diffHunk": "@@ -115,6 +120,41 @@ public File getScreenshotFile(String projectName, String sceneName, boolean isBa\n \t\treturn screenshotLoader.getScreenshotFile();\n \t}\n \n+\tpublic String getScreenshotScene(File projectDir) {\n+\t\tFilenameFilter filter = new FilenameFilter() {\n+\n+\t\t\tpublic boolean accept(File f, String name) {\n+\t\t\t\treturn name.endsWith(\"screenshot.png\");\n+\t\t\t}\n+\t\t};\n+\t\tFile[] projectScreenshots = projectDir.listFiles(filter);\n+\t\tif (projectScreenshots == null || projectScreenshots.length != 0) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tList<File> screenshots = new ArrayList<>();\n+\t\tfor (File scene : projectDir.listFiles()) {\n+\t\t\tFile[] sceneScreenshots = scene.listFiles(filter);\n+\t\t\tif (sceneScreenshots != null && sceneScreenshots.length > 0) {\n+\t\t\t\tscreenshots.addAll(Arrays.asList(scene.listFiles(filter)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2MjgzNA==", "bodyText": "Collection interface has a handy function called isEmpty()  https://developer.android.com/reference/java/util/Collection#isEmpty()\nplease replace it with if (screenshots.isEmpty())", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460462834", "createdAt": "2020-07-26T00:58:07Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/io/ProjectAndSceneScreenshotLoader.java", "diffHunk": "@@ -115,6 +120,41 @@ public File getScreenshotFile(String projectName, String sceneName, boolean isBa\n \t\treturn screenshotLoader.getScreenshotFile();\n \t}\n \n+\tpublic String getScreenshotScene(File projectDir) {\n+\t\tFilenameFilter filter = new FilenameFilter() {\n+\n+\t\t\tpublic boolean accept(File f, String name) {\n+\t\t\t\treturn name.endsWith(\"screenshot.png\");\n+\t\t\t}\n+\t\t};\n+\t\tFile[] projectScreenshots = projectDir.listFiles(filter);\n+\t\tif (projectScreenshots == null || projectScreenshots.length != 0) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tList<File> screenshots = new ArrayList<>();\n+\t\tfor (File scene : projectDir.listFiles()) {\n+\t\t\tFile[] sceneScreenshots = scene.listFiles(filter);\n+\t\t\tif (sceneScreenshots != null && sceneScreenshots.length > 0) {\n+\t\t\t\tscreenshots.addAll(Arrays.asList(scene.listFiles(filter)));\n+\t\t\t}\n+\t\t}\n+\t\tif (screenshots.size() < 1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2MzExMw==", "bodyText": "again, please no hard coded values, manual_screenshot.png is already defined in StageListener.java line 106,\ncould you move it to Constants.java and refactor its usage?", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460463113", "createdAt": "2020-07-26T01:02:08Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/io/ProjectAndSceneScreenshotLoader.java", "diffHunk": "@@ -115,6 +120,41 @@ public File getScreenshotFile(String projectName, String sceneName, boolean isBa\n \t\treturn screenshotLoader.getScreenshotFile();\n \t}\n \n+\tpublic String getScreenshotScene(File projectDir) {\n+\t\tFilenameFilter filter = new FilenameFilter() {\n+\n+\t\t\tpublic boolean accept(File f, String name) {\n+\t\t\t\treturn name.endsWith(\"screenshot.png\");\n+\t\t\t}\n+\t\t};\n+\t\tFile[] projectScreenshots = projectDir.listFiles(filter);\n+\t\tif (projectScreenshots == null || projectScreenshots.length != 0) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tList<File> screenshots = new ArrayList<>();\n+\t\tfor (File scene : projectDir.listFiles()) {\n+\t\t\tFile[] sceneScreenshots = scene.listFiles(filter);\n+\t\t\tif (sceneScreenshots != null && sceneScreenshots.length > 0) {\n+\t\t\t\tscreenshots.addAll(Arrays.asList(scene.listFiles(filter)));\n+\t\t\t}\n+\t\t}\n+\t\tif (screenshots.size() < 1) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tCollections.sort(screenshots, new Comparator<File>() {\n+\t\t\t@Override\n+\t\t\tpublic int compare(File screenshot2, File screenshot1) {\n+\t\t\t\treturn Long.compare(screenshot1.lastModified(), screenshot2.lastModified());\n+\t\t\t}\n+\t\t});\n+\t\tfor (File screenshot : screenshots) {\n+\t\t\tif (screenshot.getName().equals(\"manual_screenshot.png\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2NDc0MQ==", "bodyText": "same as line 152, getParentFile() returns abstract pathname of the parent directory named by this abstract pathname, or null if this pathname does not name a parent as mentioned in https://developer.android.com/reference/java/io/File#getParentFile()\nI think you need the name of the file, right?", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460464741", "createdAt": "2020-07-26T01:26:22Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/java/org/catrobat/catroid/io/ProjectAndSceneScreenshotLoader.java", "diffHunk": "@@ -115,6 +120,41 @@ public File getScreenshotFile(String projectName, String sceneName, boolean isBa\n \t\treturn screenshotLoader.getScreenshotFile();\n \t}\n \n+\tpublic String getScreenshotScene(File projectDir) {\n+\t\tFilenameFilter filter = new FilenameFilter() {\n+\n+\t\t\tpublic boolean accept(File f, String name) {\n+\t\t\t\treturn name.endsWith(\"screenshot.png\");\n+\t\t\t}\n+\t\t};\n+\t\tFile[] projectScreenshots = projectDir.listFiles(filter);\n+\t\tif (projectScreenshots == null || projectScreenshots.length != 0) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tList<File> screenshots = new ArrayList<>();\n+\t\tfor (File scene : projectDir.listFiles()) {\n+\t\t\tFile[] sceneScreenshots = scene.listFiles(filter);\n+\t\t\tif (sceneScreenshots != null && sceneScreenshots.length > 0) {\n+\t\t\t\tscreenshots.addAll(Arrays.asList(scene.listFiles(filter)));\n+\t\t\t}\n+\t\t}\n+\t\tif (screenshots.size() < 1) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tCollections.sort(screenshots, new Comparator<File>() {\n+\t\t\t@Override\n+\t\t\tpublic int compare(File screenshot2, File screenshot1) {\n+\t\t\t\treturn Long.compare(screenshot1.lastModified(), screenshot2.lastModified());\n+\t\t\t}\n+\t\t});\n+\t\tfor (File screenshot : screenshots) {\n+\t\t\tif (screenshot.getName().equals(\"manual_screenshot.png\")) {\n+\t\t\t\treturn screenshot.getParentFile().getName();\n+\t\t\t}\n+\t\t}\n+\t\treturn screenshots.get(0).getParentFile().getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2NDg5OQ==", "bodyText": "what's the reason for changing the width and height? square aspect ratio! as mentioned in the description of https://jira.catrob.at/browse/CATROID-385", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460464899", "createdAt": "2020-07-26T01:28:53Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/res/layout/activity_upload.xml", "diffHunk": "@@ -44,65 +44,69 @@\n \n         <ImageView\n             android:id=\"@+id/project_image_view\"\n-            android:layout_width=\"100dp\"\n-            android:layout_height=\"100dp\"\n+            android:layout_width=\"72dp\"\n+            android:layout_height=\"65dp\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2NTM5NQ==", "bodyText": "this is misleading, no single change from line 56 on, please revert it and try to avoid Reformat Code (alt+ctrl+L) for the whole file, use it only for the new code.", "url": "https://github.com/Catrobat/Catroid/pull/3693#discussion_r460465395", "createdAt": "2020-07-26T01:35:30Z", "author": {"login": "ndrnour"}, "path": "catroid/src/main/res/layout/activity_upload.xml", "diffHunk": "@@ -44,65 +44,69 @@\n \n         <ImageView\n             android:id=\"@+id/project_image_view\"\n-            android:layout_width=\"100dp\"\n-            android:layout_height=\"100dp\"\n+            android:layout_width=\"72dp\"\n+            android:layout_height=\"65dp\"\n+            android:layout_marginStart=\"@dimen/dialog_input_offset\"\n+            android:background=\"@drawable/image_contour\"\n+            android:cropToPadding=\"true\"\n+            android:scaleType=\"centerCrop\"\n             android:layout_marginBottom=\"@dimen/details_spacing\"/>\n \n         <LinearLayout\n             android:layout_width=\"match_parent\"\n             android:layout_height=\"wrap_content\"\n             android:orientation=\"vertical\">\n \n-        <LinearLayout", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "f04a694d8a199abfd4940eec30bd9c23271e725d", "author": {"user": {"login": "juliajulie95", "name": "Julia Herold"}}, "url": "https://github.com/Catrobat/Catroid/commit/f04a694d8a199abfd4940eec30bd9c23271e725d", "committedDate": "2020-07-27T14:56:21Z", "message": "CATROID-650 + CATROID-385 Project image empty if the default scene has no screenshot"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "f04a694d8a199abfd4940eec30bd9c23271e725d", "author": {"user": {"login": "juliajulie95", "name": "Julia Herold"}}, "url": "https://github.com/Catrobat/Catroid/commit/f04a694d8a199abfd4940eec30bd9c23271e725d", "committedDate": "2020-07-27T14:56:21Z", "message": "CATROID-650 + CATROID-385 Project image empty if the default scene has no screenshot"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1OTA5NjUz", "url": "https://github.com/Catrobat/Catroid/pull/3693#pullrequestreview-455909653", "createdAt": "2020-07-27T15:48:08Z", "commit": {"oid": "f04a694d8a199abfd4940eec30bd9c23271e725d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1852, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}