{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNDU0MjIx", "number": 1842, "title": "Adapt to IMDG using UUID instead of Address for Invocations", "bodyText": "Add description here\nChecklist\n\n Tags Set\n Milestone Set\n Any breaking changes are documented\n New public APIs have @Nonnull/@Nullable annotations\n New public APIs have @since tags in Javadoc\n For code samples, code sample main readme is updated\n\nLinks to issues fixed (if any):\nFixes #NNNN\nList of breaking changes:\n\n..", "createdAt": "2020-01-08T13:17:25Z", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842", "merged": true, "mergeCommit": {"oid": "d5736acf7387a1683fec9074839de8a5ae97a223"}, "closed": true, "closedAt": "2020-01-09T06:16:24Z", "author": {"login": "jbartok"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4VMD0AH2gAyMzYwNDU0MjIxOjQwZDNkZTBmODA4N2MzODVmZjc3MTBhNWQ3MmFlYTc3MGRiMmVjNDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4lO_cgFqTM0MDMzOTMwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "40d3de0f8087c385ff7710a5d72aea770db2ec46", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/40d3de0f8087c385ff7710a5d72aea770db2ec46", "committedDate": "2020-01-08T13:15:52Z", "message": "Adapt to IMDG changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5ODU2NzY5", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#pullrequestreview-339856769", "createdAt": "2020-01-08T13:19:57Z", "commit": {"oid": "40d3de0f8087c385ff7710a5d72aea770db2ec46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb1cc70ff37fb5920b207bf30747613775234b42", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/eb1cc70ff37fb5920b207bf30747613775234b42", "committedDate": "2020-01-08T13:27:21Z", "message": "Adapt to IMDG changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5ODcxNDYw", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#pullrequestreview-339871460", "createdAt": "2020-01-08T13:44:51Z", "commit": {"oid": "eb1cc70ff37fb5920b207bf30747613775234b42"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxMzo0NDo1MlrOFbXSIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxMzo0NDo1MlrOFbXSIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDIzNzM0Ng==", "bodyText": "can you make this a Util method? it's repeated several times.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#discussion_r364237346", "createdAt": "2020-01-08T13:44:52Z", "author": {"login": "cangencer"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/impl/JetClientInstanceImpl.java", "diffHunk": "@@ -151,9 +151,9 @@ public ILogger getLogger() {\n         }\n     }\n \n-    private static Address masterAddress(Cluster cluster) {\n+    private static UUID masterUUID(Cluster cluster) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb1cc70ff37fb5920b207bf30747613775234b42"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5ODk2MzEx", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#pullrequestreview-339896311", "createdAt": "2020-01-08T14:24:40Z", "commit": {"oid": "eb1cc70ff37fb5920b207bf30747613775234b42"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxNDoyNDo0MFrOFbYZuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxNDoyNDo0MFrOFbYZuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI1NTY3Mg==", "bodyText": "We have a getMasterMember method on the ClusterService.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#discussion_r364255672", "createdAt": "2020-01-08T14:24:40Z", "author": {"login": "sancar"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/impl/JobProxy.java", "diffHunk": "@@ -142,6 +145,11 @@ protected JobConfig doGetJobConfig() {\n     }\n \n     @Override\n+    protected UUID masterUuid() {\n+        Optional<Member> first = container().getClusterService().getMembers().stream().findFirst();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb1cc70ff37fb5920b207bf30747613775234b42"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3624c51949c576d3b64daacfe0b225512ab9eb87", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/3624c51949c576d3b64daacfe0b225512ab9eb87", "committedDate": "2020-01-08T14:40:22Z", "message": "Extract utility method for obtaining Master from Cluster"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5OTA4NDg1", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#pullrequestreview-339908485", "createdAt": "2020-01-08T14:42:47Z", "commit": {"oid": "3624c51949c576d3b64daacfe0b225512ab9eb87"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxNDo0Mjo0N1rOFbY9TA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxNDo0Mjo0N1rOFbY9TA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI2NDc4MA==", "bodyText": "you can use use clientClusterService.getMaster() here and inline the Util method", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#discussion_r364264780", "createdAt": "2020-01-08T14:42:47Z", "author": {"login": "cangencer"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/impl/ClientJobProxy.java", "diffHunk": "@@ -156,16 +155,15 @@ protected long doGetJobSubmissionTime() {\n     protected JobConfig doGetJobConfig() {\n         return callAndRetryIfTargetNotFound(() -> {\n             ClientMessage request = JetGetJobConfigCodec.encodeRequest(getId());\n-            ClientMessage response = invocation(request, masterAddress()).invoke().get();\n+            ClientMessage response = invocation(request, masterUuid()).invoke().get();\n             Data data = JetGetJobConfigCodec.decodeResponse(response).response;\n             return serializationService().toObject(data);\n         });\n     }\n \n     @Override\n-    protected Address masterAddress() {\n-        Optional<Member> first = container().getCluster().getMembers().stream().findFirst();\n-        return first.orElseThrow(() -> new IllegalStateException(\"No members found in cluster\")).getAddress();\n+    protected UUID masterUuid() {\n+        return Util.getMaster(container().getCluster()).getUuid();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3624c51949c576d3b64daacfe0b225512ab9eb87"}, "originalPosition": 110}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01808ed2f2dd6d973811f6a804eb27c97460dbd8", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/01808ed2f2dd6d973811f6a804eb27c97460dbd8", "committedDate": "2020-01-08T15:04:46Z", "message": "Further change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bad252efff8fc482f0cd18b2ee6c0782fc31dbb", "author": {"user": {"login": "cangencer", "name": "Can Gencer"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/1bad252efff8fc482f0cd18b2ee6c0782fc31dbb", "committedDate": "2020-01-08T17:01:05Z", "message": "refactoring/cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMzM5MzAw", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#pullrequestreview-340339300", "createdAt": "2020-01-09T07:57:32Z", "commit": {"oid": "1bad252efff8fc482f0cd18b2ee6c0782fc31dbb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwNzo1NzozMlrOFbtVnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwNzo1NzozMlrOFbtVnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDU5ODY4Nw==", "bodyText": "To get master member, we get the master member and get its uuid and then get the master member again ?\n@jbartok", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1842#discussion_r364598687", "createdAt": "2020-01-09T07:57:32Z", "author": {"login": "sancar"}, "path": "hazelcast-jet-all/src/main/java/com/hazelcast/jet/server/JetCommandLine.java", "diffHunk": "@@ -406,7 +406,7 @@ public void cluster(\n             JetClientInstanceImpl client = (JetClientInstanceImpl) jet;\n             HazelcastClientInstanceImpl hazelcastClient = client.getHazelcastClient();\n             ClientClusterService clientClusterService = hazelcastClient.getClientClusterService();\n-            Member masterMember = clientClusterService.getMember(clientClusterService.getMasterAddress());\n+            Member masterMember = clientClusterService.getMember(clientClusterService.getMasterMember().getUuid());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1bad252efff8fc482f0cd18b2ee6c0782fc31dbb"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2905, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}