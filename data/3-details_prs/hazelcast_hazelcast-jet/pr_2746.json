{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1MjU2Nzc0", "number": 2746, "title": "Fix Hadoop tests on Windows", "bodyText": "we must check hasHadoopPrefix first before\nPaths.get(path).isAbsolute, because path such as hdfs://something\nfails on windows due to the :\n\n\nthere should be only one assumeThatNoWindowsOS to comment out if we\nwant to test on windows\n\n\nupdate hadoop to 3.3.0 due to\nhttps://issues.apache.org/jira/browse/HDFS-14890 found in 3.2.1", "createdAt": "2020-12-09T15:22:06Z", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2746", "merged": true, "mergeCommit": {"oid": "07672608d320914004629576219a12f10238f0cd"}, "closed": true, "closedAt": "2020-12-15T19:00:42Z", "author": {"login": "viliam-durina"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkgXrYAH2gAyNTM1MjU2Nzc0OmE5NTFjZmQ2YjFkZDhkM2M5YTY1NGE0MWRhZmQ3ZWRjZmFlOThhYWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmbRkXgFqTU1MjUxOTM0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a951cfd6b1dd8d3c9a654a41dafd7edcfae98aad", "author": {"user": {"login": "viliam-durina", "name": "Viliam Durina"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/a951cfd6b1dd8d3c9a654a41dafd7edcfae98aad", "committedDate": "2020-12-09T15:21:20Z", "message": "Fix Hadoop tests on Windows\n\n- we must check `hasHadoopPrefix` first before\nPaths.get(path).isAbsolute, because path such as `hdfs://something`\nfails on windows due to the `:`\n\n- there should be only one `assumeThatNoWindowsOS` to comment out if we\nwant to test on windows\n\n- update hadoop to 3.3.0 due to\nhttps://issues.apache.org/jira/browse/HDFS-14890 found in 3.2.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9444a0eeb87c3a3bc14e4a37440dfa874ec63487", "author": {"user": {"login": "viliam-durina", "name": "Viliam Durina"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/9444a0eeb87c3a3bc14e4a37440dfa874ec63487", "committedDate": "2020-12-09T15:54:08Z", "message": "Fix test failures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f03f3ac9cd75632a5f577b116273ff180e96c1f", "author": {"user": {"login": "viliam-durina", "name": "Viliam Durina"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/4f03f3ac9cd75632a5f577b116273ff180e96c1f", "committedDate": "2020-12-09T16:44:18Z", "message": "Go back to hadoop 3.2.1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMDg1MDgy", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2746#pullrequestreview-550085082", "createdAt": "2020-12-11T13:12:33Z", "commit": {"oid": "4f03f3ac9cd75632a5f577b116273ff180e96c1f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxMjozM1rOID4LUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMzoxNzo0OVrOID4XQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDkzNzA0MQ==", "bodyText": "Why shouldn't this test run on windows? I understand why shouldReadFileWithEscapedGlob doesn't run because of * in filename is not allowed on windows, but here the * is in the path, matching any directory.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2746#discussion_r540937041", "createdAt": "2020-12-11T13:12:33Z", "author": {"login": "frant-hartm"}, "path": "extensions/hadoop/src/test/java/com/hazelcast/jet/hadoop/file/PathAndGlobFileSourceTest.java", "diffHunk": "@@ -51,6 +51,7 @@ public void shouldReadFilesMatchingGlobInTheMiddle() {\n \n     @Test\n     public void shouldReadFilesMatchingGlobInPath() {\n+        assumeThatNoWindowsOS(); // * is not allowed in filename", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f03f3ac9cd75632a5f577b116273ff180e96c1f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDk0MDA5OA==", "bodyText": "This is what I had originally, but didn't pass on Windows due to different line endings. I think it depends on git config core.autocrlf value. Isn't setting this config to true a standard practice on windows? It results in the file having the following content:\nText contents of\\r\\nthe file.\\r\\n", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2746#discussion_r540940098", "createdAt": "2020-12-11T13:17:49Z", "author": {"login": "frant-hartm"}, "path": "extensions/hadoop/src/test/java/com/hazelcast/jet/hadoop/file/TextFileFormatTest.java", "diffHunk": "@@ -35,10 +35,7 @@ public void readTextFileAsSingleItem() {\n                                                       .glob(\"file.txt\")\n                                                       .format(FileFormat.text());\n \n-        assertItemsInSource(source,\n-                \"Text contents of\" + System.lineSeparator() +\n-                        \"the file.\" + System.lineSeparator()\n-        );\n+        assertItemsInSource(source, \"Text contents of\\nthe file.\\n\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f03f3ac9cd75632a5f577b116273ff180e96c1f"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb84e93b7e37aaf0391fc97d5bea3956e4167e38", "author": {"user": {"login": "viliam-durina", "name": "Viliam Durina"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/eb84e93b7e37aaf0391fc97d5bea3956e4167e38", "committedDate": "2020-12-14T20:22:37Z", "message": "Merge remote-tracking branch 'remotes/hazelcast/master' into hadoop-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b19c0a07fa5c99a20c61e7a6f09eb3ccb4c6f2b", "author": {"user": {"login": "viliam-durina", "name": "Viliam Durina"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/7b19c0a07fa5c99a20c61e7a6f09eb3ccb4c6f2b", "committedDate": "2020-12-14T21:35:42Z", "message": "Address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46a32359348727c4b7241009c3cb6ffd4dcb0be4", "author": {"user": {"login": "viliam-durina", "name": "Viliam Durina"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/46a32359348727c4b7241009c3cb6ffd4dcb0be4", "committedDate": "2020-12-14T22:17:33Z", "message": "Fix javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c29c2dea8c6a39edfe56f06a5021f4c7051d2764", "author": {"user": {"login": "viliam-durina", "name": "Viliam Durina"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/c29c2dea8c6a39edfe56f06a5021f4c7051d2764", "committedDate": "2020-12-15T07:18:11Z", "message": "Fix compilation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNTE5MzQ3", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2746#pullrequestreview-552519347", "createdAt": "2020-12-15T14:32:59Z", "commit": {"oid": "c29c2dea8c6a39edfe56f06a5021f4c7051d2764"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3421, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}