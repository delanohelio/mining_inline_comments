{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzOTAwMTg2", "number": 2276, "title": "Add mixins to all commands to configure address and cluster name", "bodyText": "Because the options are already used in other commands, -n/--cluster-name and -a/--addresses will be replaced by -t/--targets. It's possible provide -t/--targets option before and after the command, option after command takes precedence.\nBefore\njet -n jet -a 127.0.0.1:5701 submit job.jar\nAfter\njet submit -t jet@127.0.0.1:5701 job.jar\njet -t jet@127.0.0.1:5701 submit job.jar\nChecklist\n\n Tags Set\n Milestone Set\n Any breaking changes are documented\n\nFixes #2045\nList of breaking changes:\n\n-n/--cluster-name and -a/--addresses are removed from Jet Command Line, and replaced by -t/--targets", "createdAt": "2020-05-27T14:39:55Z", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276", "merged": true, "mergeCommit": {"oid": "85760d7ce2569124e3ad72a40ccf70e972f9d78e"}, "closed": true, "closedAt": "2020-06-29T06:40:43Z", "author": {"login": "caioguedes"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclLzdzgH2gAyNDIzOTAwMTg2OmFiZjdhN2I4ZDhmZTljMWZhODBlNTVkNTU1NzA0NGQxMmQ5NjA1YmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcvCtJrgH2gAyNDIzOTAwMTg2OjA3MDNiMzJmZDgyMjdkMTg1NDQ5NGRjNzUxYzQ2N2QxODY5M2JhYTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "abf7a7b8d8fe9c1fa80e55d5557044d12d9605be", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/abf7a7b8d8fe9c1fa80e55d5557044d12d9605be", "committedDate": "2020-05-26T21:46:27Z", "message": "Initial implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dc722ead5d7a7d073e302eee54fc560791f8042", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/9dc722ead5d7a7d073e302eee54fc560791f8042", "committedDate": "2020-05-26T21:46:27Z", "message": "add targets mixin for cluster name and addresses"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35429bac42a0629c5d991fd8bf4541408cf3e8f0", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/35429bac42a0629c5d991fd8bf4541408cf3e8f0", "committedDate": "2020-05-26T22:10:45Z", "message": "test: target option precedence"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad5872d3e979e19e6f84d9a973e19a66320e271a", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/ad5872d3e979e19e6f84d9a973e19a66320e271a", "committedDate": "2020-05-26T22:46:12Z", "message": "update description add value format validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b597ff130081c2575eef788aa5875041ba01f053", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/b597ff130081c2575eef788aa5875041ba01f053", "committedDate": "2020-05-27T14:39:20Z", "message": "fix style"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0c8af72acfc944718c0d10d84d1198f950bf8c41", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/0c8af72acfc944718c0d10d84d1198f950bf8c41", "committedDate": "2020-05-25T13:37:15Z", "message": "add targets mixin for cluster name and addresses"}, "afterCommit": {"oid": "b597ff130081c2575eef788aa5875041ba01f053", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/b597ff130081c2575eef788aa5875041ba01f053", "committedDate": "2020-05-27T14:39:20Z", "message": "fix style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5ODkyNjM5", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276#pullrequestreview-419892639", "createdAt": "2020-05-28T08:34:59Z", "commit": {"oid": "b597ff130081c2575eef788aa5875041ba01f053"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODozNDo1OVrOGbrJMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODozNDo1OVrOGbrJMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY3MTYwMA==", "bodyText": "I think we still need to keep these, as this is a breaking change. You can mark them as deprecated", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276#discussion_r431671600", "createdAt": "2020-05-28T08:34:59Z", "author": {"login": "cangencer"}, "path": "hazelcast-jet-all/src/main/java/com/hazelcast/jet/server/JetCommandLine.java", "diffHunk": "@@ -96,30 +99,14 @@\n     @Option(names = {\"-f\", \"--config\"},\n             description = \"Optional path to a client config XML/YAML file.\" +\n                     \" The default is to use config/hazelcast-client.yaml.\" +\n-                    \" If you set this option, Jet will ignore the --addresses and --cluster-name options.\",\n+                    \" If you set this option, Jet will ignore the --targets option.\",\n             order = 0\n     )\n     private File config;\n \n-    @Option(names = {\"-a\", \"--addresses\"},\n-            split = \",\",\n-            arity = \"1..*\",\n-            paramLabel = \"<hostname>:<port>\",\n-            description = \"Optional comma-separated list of Jet node addresses in the format\" +\n-                    \" <hostname>:<port>, if you want to connect to a cluster other than the\" +\n-                    \" one configured in the configuration file\",\n-            order = 1\n-    )\n-    private List<String> addresses;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b597ff130081c2575eef788aa5875041ba01f053"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4916f0c21ccaca02f003160cfde73b5beb9320fa", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/4916f0c21ccaca02f003160cfde73b5beb9320fa", "committedDate": "2020-06-02T12:17:25Z", "message": "keep deprecated options compatibility"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d5d03a58277e2a57e3ccbdddf60360e799ca752", "author": {"user": {"login": "caioguedes", "name": "Caio Guedes"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/3d5d03a58277e2a57e3ccbdddf60360e799ca752", "committedDate": "2020-06-15T21:17:37Z", "message": "update references of options on docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNDc3MDI2", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276#pullrequestreview-432477026", "createdAt": "2020-06-17T14:44:44Z", "commit": {"oid": "3d5d03a58277e2a57e3ccbdddf60360e799ca752"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDo0NDo0NFrOGlJMyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDo0NjowMlrOGlJQwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYwMTIyNg==", "bodyText": "Make cluster-name optional", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276#discussion_r441601226", "createdAt": "2020-06-17T14:44:44Z", "author": {"login": "frant-hartm"}, "path": "hazelcast-jet-all/src/main/java/com/hazelcast/jet/server/JetCommandLine.java", "diffHunk": "@@ -555,6 +590,59 @@ void merge(Verbosity other) {\n         }\n     }\n \n+    public static class TargetsMixin {\n+\n+        @Option(names = {\"-t\", \"--targets\"},\n+                description = \"The cluster name and addresses to use if you want to connect to a \"\n+                    + \"cluster other than the one configured in the configuration file.\",\n+                paramLabel = \"<cluster-name>@<hostname>:<port>[,<hostname>:<port>]\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d5d03a58277e2a57e3ccbdddf60360e799ca752"}, "originalPosition": 228}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYwMjI0MQ==", "bodyText": "Use more descriptive name. It is not immediately obvious if the option before or after command takes precedence.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276#discussion_r441602241", "createdAt": "2020-06-17T14:46:02Z", "author": {"login": "frant-hartm"}, "path": "hazelcast-jet-all/src/test/java/com/hazelcast/jet/server/JetCommandLineTest.java", "diffHunk": "@@ -483,6 +484,72 @@ public void test_submit_argsPassing() {\n         assertTrueEventually(() -> assertContains(captureOut(), \" with arguments [--jobOption, fooValue]\"));\n     }\n \n+    @Test\n+    public void testTargetsMixin() {\n+        String target = \"foobar@127.0.0.1:5701,127.0.0.1:5702\";\n+\n+        testTargetsCommand(\"cancel\", \"-t\", target, \"jobName\");\n+        testTargetsCommand(\"-t\", target, \"cancel\", \"jobName\");\n+\n+        testTargetsCommand(\"cluster\", \"-t\", target);\n+        testTargetsCommand(\"-t\", target, \"cluster\");\n+\n+        testTargetsCommand(\"delete-snapshot\", \"snapshotName\", \"-t\", target);\n+        testTargetsCommand(\"-t\", target, \"delete-snapshot\", \"snapshotName\");\n+\n+        testTargetsCommand(\"list-jobs\", \"-t\", target);\n+        testTargetsCommand(\"-t\", target, \"list-jobs\");\n+\n+        testTargetsCommand(\"list-snapshots\", \"-t\", target);\n+        testTargetsCommand(\"-t\", target, \"list-snapshots\");\n+\n+        testTargetsCommand(\"restart\", \"jobName\", \"-t\", target);\n+        testTargetsCommand(\"-t\", target, \"restart\", \"jobName\");\n+\n+        testTargetsCommand(\"resume\", \"jobName\", \"-t\", target);\n+        testTargetsCommand(\"-t\", target, \"resume\", \"jobName\");\n+\n+        testTargetsCommand(\"save-snapshot\", \"jobName\", \"snapshotName\", \"-t\", target);\n+        testTargetsCommand(\"-t\", target, \"save-snapshot\", \"jobName\", \"snapshotName\");\n+\n+        testTargetsCommand(\"submit\", \"-t\", target, testJobJarFile.toString());\n+        testTargetsCommand(\"-t\", target, \"submit\", testJobJarFile.toString());\n+\n+        testTargetsCommand(\"suspend\", \"jobName\", \"-t\", target);\n+        testTargetsCommand(\"-t\", target, \"suspend\", \"jobName\");\n+    }\n+\n+    @Test\n+    public void testTargetsPrecedence() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d5d03a58277e2a57e3ccbdddf60360e799ca752"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "424ddabeb18a8d5ddc52e85a7c1950380d3300e2", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/424ddabeb18a8d5ddc52e85a7c1950380d3300e2", "committedDate": "2020-06-25T07:25:16Z", "message": "Make cluster name optional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c443929cee13c17eb9c4d0838044e5a5074d25d", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/5c443929cee13c17eb9c4d0838044e5a5074d25d", "committedDate": "2020-06-25T07:28:15Z", "message": "Update docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32e1b3f773641038620d1c5dcbfa5d66fdd215d2", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/32e1b3f773641038620d1c5dcbfa5d66fdd215d2", "committedDate": "2020-06-25T07:28:37Z", "message": "Merge branch 'master' into pull/2276"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e033b2cf261f5c7262db7526b2d152431154235", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/3e033b2cf261f5c7262db7526b2d152431154235", "committedDate": "2020-06-25T07:36:07Z", "message": "Update docker docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68c51b8e127dcd8b05395386113d55f4cd3e4a31", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/68c51b8e127dcd8b05395386113d55f4cd3e4a31", "committedDate": "2020-06-25T08:59:53Z", "message": "Merge branch 'master' into pull/2276"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93183069825c66e603cd81eae558612c978efa85", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/93183069825c66e603cd81eae558612c978efa85", "committedDate": "2020-06-25T09:28:27Z", "message": "Fix optional cluster name syntax in help"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6882d53a0e5cff46a3881581c50339e69862a103", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/6882d53a0e5cff46a3881581c50339e69862a103", "committedDate": "2020-06-25T09:31:10Z", "message": "Remove default cluster name from -t parameter in docs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MzQxMzk1", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276#pullrequestreview-437341395", "createdAt": "2020-06-25T09:53:12Z", "commit": {"oid": "6882d53a0e5cff46a3881581c50339e69862a103"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwOTo1MzoxMlrOGozqTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwOTo1MzoxMlrOGozqTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ0MjYzOA==", "bodyText": "should point to the replaced command", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276#discussion_r445442638", "createdAt": "2020-06-25T09:53:12Z", "author": {"login": "cangencer"}, "path": "hazelcast-jet-all/src/main/java/com/hazelcast/jet/server/JetCommandLine.java", "diffHunk": "@@ -105,22 +109,25 @@\n             split = \",\",\n             arity = \"1..*\",\n             paramLabel = \"<hostname>:<port>\",\n-            description = \"Optional comma-separated list of Jet node addresses in the format\" +\n+            description = \"[DEPRECATED] Optional comma-separated list of Jet node addresses in the format\" +\n                     \" <hostname>:<port>, if you want to connect to a cluster other than the\" +\n                     \" one configured in the configuration file\",\n             order = 1\n     )\n     private List<String> addresses;\n \n     @Option(names = {\"-n\", \"--cluster-name\"},\n-            description = \"The cluster name to use when connecting to the cluster \" +\n-                    \"specified by the <addresses> parameter. \",\n-            defaultValue = \"jet\",\n-            showDefaultValue = Visibility.ALWAYS,\n-            order = 2\n+        description = \"[DEPRECATED] The cluster name to use when connecting to the cluster \" +\n+            \"specified by the <addresses> parameter. \",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6882d53a0e5cff46a3881581c50339e69862a103"}, "originalPosition": 53}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc885b055397e552f40d23031f7f39f8deab6e44", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/cc885b055397e552f40d23031f7f39f8deab6e44", "committedDate": "2020-06-25T10:23:11Z", "message": "Point to the new option for deprecated options."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MzYzMjAy", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2276#pullrequestreview-437363202", "createdAt": "2020-06-25T10:25:01Z", "commit": {"oid": "cc885b055397e552f40d23031f7f39f8deab6e44"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0703b32fd8227d1854494dc751c467d18693baa1", "author": {"user": {"login": "frant-hartm", "name": "Franti\u0161ek Hartman"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/0703b32fd8227d1854494dc751c467d18693baa1", "committedDate": "2020-06-26T12:49:39Z", "message": "Remove unused import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3634, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}