{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyNDg4MjY1", "number": 1945, "title": "Add test for durable subscriber", "bodyText": "Fixes #1930\nChecklist\n\n Tags Set\n Milestone Set\n Any breaking changes are documented\n New public APIs have @Nonnull/@Nullable annotations\n New public APIs have @since tags in Javadoc\n For code samples, code sample main readme is updated", "createdAt": "2020-02-07T16:12:00Z", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1945", "merged": true, "mergeCommit": {"oid": "52fb2b05b94ed28bc1abf0e77db85f796c8c160f"}, "closed": true, "closedAt": "2020-02-07T17:07:47Z", "author": {"login": "viliam-durina"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcCBrFrAH2gAyMzcyNDg4MjY1OjlmMTUxNzM2YmJiZTdmMTM3MWYxMzcwYzBlM2VhOGM1OGQ2YzVlZGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcCCchvAFqTM1NTMwMjcwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9f151736bbbe7f1371f1370c0e3ea8c58d6c5edb", "author": {"user": {"login": "viliam-durina", "name": "Viliam Durina"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/9f151736bbbe7f1371f1370c0e3ea8c58d6c5edb", "committedDate": "2020-02-07T16:10:54Z", "message": "Add test for durable subscriber\n\nFixes #1930"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MjkzNjY3", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1945#pullrequestreview-355293667", "createdAt": "2020-02-07T16:50:45Z", "commit": {"oid": "9f151736bbbe7f1371f1370c0e3ea8c58d6c5edb"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxNjo1MDo0NlrOFnDfww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxNjo1MjoyMVrOFnDi3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ5NjA2Nw==", "bodyText": "can this throw?", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1945#discussion_r376496067", "createdAt": "2020-02-07T16:50:46Z", "author": {"login": "cangencer"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/impl/connector/StreamJmsP.java", "diffHunk": "@@ -230,8 +230,12 @@ protected void restoreFromSnapshot(@Nonnull Object key, @Nonnull Object value) {\n \n     @Override\n     public void close() throws Exception {\n-        consumer.close();\n-        session.close();\n+        if (consumer != null) {\n+            consumer.close();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f151736bbbe7f1371f1370c0e3ea8c58d6c5edb"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ5Njg2MQ==", "bodyText": "I frequently see that we always keep adding parameters to test in this way and it makes it harder to read the test with a lot of conditional logic inside. It would be better if they were refactored in a way that would avoid conditional test logic.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1945#discussion_r376496861", "createdAt": "2020-02-07T16:52:21Z", "author": {"login": "cangencer"}, "path": "hazelcast-jet-core/src/test/java/com/hazelcast/jet/impl/connector/JmsIntegrationTestBase.java", "diffHunk": "@@ -383,33 +384,50 @@ public void sinkTopic_whenBuilder_withParameters() throws JMSException {\n \n     @Test\n     public void stressTest_exactlyOnce_forceful() throws Exception {\n-        stressTest(false, EXACTLY_ONCE);\n+        stressTest(false, EXACTLY_ONCE, false);\n     }\n \n     @Test\n     public void stressTest_exactlyOnce_graceful() throws Exception {\n-        stressTest(true, EXACTLY_ONCE);\n+        stressTest(true, EXACTLY_ONCE, false);\n     }\n \n     @Test\n     public void stressTest_atLeastOnce_forceful() throws Exception {\n-        stressTest(false, AT_LEAST_ONCE);\n+        stressTest(false, AT_LEAST_ONCE, false);\n     }\n \n     @Test\n     public void stressTest_noGuarantee_forceful() throws Exception {\n-        stressTest(false, NONE);\n+        stressTest(false, NONE, false);\n     }\n \n-    private void stressTest(boolean graceful, ProcessingGuarantee maxGuarantee)\n+    @Test\n+    public void stressTest_exactlyOnce_forceful_durableTopic() throws Exception {\n+        stressTest(false, EXACTLY_ONCE, true);\n+    }\n+\n+    private void stressTest(boolean graceful, ProcessingGuarantee maxGuarantee, boolean useTopic)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f151736bbbe7f1371f1370c0e3ea8c58d6c5edb"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MzAyNzA4", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1945#pullrequestreview-355302708", "createdAt": "2020-02-07T17:04:55Z", "commit": {"oid": "9f151736bbbe7f1371f1370c0e3ea8c58d6c5edb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2984, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}