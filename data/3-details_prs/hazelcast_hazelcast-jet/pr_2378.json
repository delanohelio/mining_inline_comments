{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNDY4NzI5", "number": 2378, "title": "[005] Make Postgres dataloss on snapshot-stream sync less severe", "bodyText": "Set snapshot mode to exported where data loss is one message only.\nChecklist\n\n Tags Set\n Milestone Set", "createdAt": "2020-06-29T14:52:43Z", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2378", "merged": true, "mergeCommit": {"oid": "afa893bcb1c07d8261ca5b2b462f3007aeb49283"}, "closed": true, "closedAt": "2020-06-30T15:06:01Z", "author": {"login": "jbartok"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcv8LhsgH2gAyNDQxNDY4NzI5OjU5NDc5NWIyOWEwNjQzNmQ0NDhkMmUxN2E0NjY5NDE1NDY4YmQ1Mzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwWRNEgH2gAyNDQxNDY4NzI5OjE0Njg5NWI3OTNhODdlNTYxYzI1ZjBmODMxNjExYWZhMTZjNWEwMjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "594795b29a06436d448d2e17a4669415468bd538", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/594795b29a06436d448d2e17a4669415468bd538", "committedDate": "2020-06-29T07:47:25Z", "message": "Add test for data loss, set snapshot mode to `exported`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d47f4c1b5906048605f5225ce9ce583242cf79ad", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/d47f4c1b5906048605f5225ce9ce583242cf79ad", "committedDate": "2020-06-30T09:11:19Z", "message": "Document data loss problem"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5OTU4MDA1", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2378#pullrequestreview-439958005", "createdAt": "2020-06-30T12:21:42Z", "commit": {"oid": "d47f4c1b5906048605f5225ce9ce583242cf79ad"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMjoyMTo0MlrOGq5wTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMjoyMzoxMFrOGq5zSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYzOTYzMQ==", "bodyText": "The Debezium PostgreSQL Connector this source is based on has data loss issues when ... - this should be rewritten, seem like there are some left words after rewritting", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2378#discussion_r447639631", "createdAt": "2020-06-30T12:21:42Z", "author": {"login": "olukas"}, "path": "extensions/cdc-postgres/src/main/java/com/hazelcast/jet/cdc/postgres/PostgresCdcSources.java", "diffHunk": "@@ -46,12 +46,20 @@ private PostgresCdcSources() {\n      * Creates a CDC source that streams change data from a PostgreSQL database\n      * to Hazelcast Jet.\n      * <p>\n-     * If Jet can't reach the database when it attempts to start the source or\n-     * if it looses the connection to the database from an already running\n-     * source, it throws an exception and terminate the execution of the job.\n-     * This behaviour is not ideal, would be much better to try to reconnect,\n-     * at least for a certain amount of time. Future versions will address the\n-     * problem.\n+     * <b>KNOWN ISSUE 1:</b> If Jet can't reach the database when it attempts to\n+     * start the source or if it looses the connection to the database from an\n+     * already running source, it throws an exception and terminate the\n+     * execution of the job. This behaviour is not ideal, would be much better\n+     * to try to reconnect, at least for a certain amount of time. Future\n+     * versions will address the problem.\n+     * <p>\n+     * <b>KNOWN ISSUE 2:</b> The Debezium PostgreSQL Connector this source is", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d47f4c1b5906048605f5225ce9ce583242cf79ad"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzY0MDM5NA==", "bodyText": "It seems that more items still can be missed after some circumstances. It also not right for events which came a longer time after snapshot (i.e. if there is not update of DB during snapshotting)", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2378#discussion_r447640394", "createdAt": "2020-06-30T12:23:10Z", "author": {"login": "olukas"}, "path": "extensions/cdc-postgres/src/main/java/com/hazelcast/jet/cdc/postgres/PostgresCdcSources.java", "diffHunk": "@@ -46,12 +46,20 @@ private PostgresCdcSources() {\n      * Creates a CDC source that streams change data from a PostgreSQL database\n      * to Hazelcast Jet.\n      * <p>\n-     * If Jet can't reach the database when it attempts to start the source or\n-     * if it looses the connection to the database from an already running\n-     * source, it throws an exception and terminate the execution of the job.\n-     * This behaviour is not ideal, would be much better to try to reconnect,\n-     * at least for a certain amount of time. Future versions will address the\n-     * problem.\n+     * <b>KNOWN ISSUE 1:</b> If Jet can't reach the database when it attempts to\n+     * start the source or if it looses the connection to the database from an\n+     * already running source, it throws an exception and terminate the\n+     * execution of the job. This behaviour is not ideal, would be much better\n+     * to try to reconnect, at least for a certain amount of time. Future\n+     * versions will address the problem.\n+     * <p>\n+     * <b>KNOWN ISSUE 2:</b> The Debezium PostgreSQL Connector this source is\n+     * based on has data loss issues when synchronizing snapshots with event\n+     * streams based on the Postgres WAL (Write-Ahead Log). For details see\n+     * <a href=\"https://issues.redhat.com/browse/DBZ-2288\">DBZ-2288</a>.\n+     * Currently the first streaming event that should come in right after the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d47f4c1b5906048605f5225ce9ce583242cf79ad"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "146895b793a87e561c25f0f831611afa16c5a025", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/146895b793a87e561c25f0f831611afa16c5a025", "committedDate": "2020-06-30T14:11:09Z", "message": "Improve javadoc"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3705, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}