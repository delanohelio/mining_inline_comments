{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2NzUwOTkx", "number": 2581, "title": "Improve safety of working with job suspension cause programmatically", "bodyText": "Attempting to make working programmatically with job suspension cause, for example in MC, less error prone (than relying on specific formatting of Strings).\nBreaking changes:\n\nAPI\n\nChecklist:\n\n Labels and Milestone set\n New public APIs have @Nonnull/@Nullable annotations\n New public APIs have @since tags in Javadoc", "createdAt": "2020-10-02T08:01:43Z", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581", "merged": true, "mergeCommit": {"oid": "18bb638d0acd114bedcfdca467ac7d4e3aa7e2da"}, "closed": true, "closedAt": "2020-10-05T12:35:09Z", "author": {"login": "jbartok"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOhOo_AH2gAyNDk2NzUwOTkxOjI5ZjdiNDk1MmU4MDEwMzM2OTAxZmQxNjNhY2YwNTM2OTc3OGRlMTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPiWNmAH2gAyNDk2NzUwOTkxOmEyZDBjZTc0NzQzYThhMzJjODY5YWI4NmIyMjdhZGZiOTMxMjBiYzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "29f7b4952e8010336901fd163acf05369778de11", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/29f7b4952e8010336901fd163acf05369778de11", "committedDate": "2020-10-02T07:55:02Z", "message": "Improve safety of working with job suspension cause programmatically"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/eabe58573bd9bcc611a1e74d682f4d6daf255bda", "committedDate": "2020-10-02T08:00:45Z", "message": "Add @since annotation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwOTk4MzQz", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#pullrequestreview-500998343", "createdAt": "2020-10-02T09:44:55Z", "commit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwOTo0NDo1NlrOHbnkhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMDowMzoyNlrOHboGZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODcyMTkyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * lead to the suspension of the job. Throws an {@code IllegalStateException}\n          \n          \n            \n                 * led to the suspension of the job. Throws an {@code IllegalStateException}", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498721924", "createdAt": "2020-10-02T09:44:56Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/Job.java", "diffHunk": "@@ -86,21 +87,15 @@ default String getName() {\n     JobStatus getStatus();\n \n     /**\n-     * Return a human-readable description of the cause that led to the\n-     * suspension of this job. For example whether the suspension has been\n-     * explicitly requested by the user or an error has occurred and the job is\n-     * configured to be suspended in such a case (see {@link\n-     * JobConfig#setSuspendOnFailure(boolean)}) - in this case the details of\n-     * the error are also provided.\n-     *\n-     * @return cause that led to the job suspension\n-     * @throws IllegalStateException if the job is not suspended\n+     * Return a {@link JobSuspensionCause description of the cause} that has\n+     * lead to the suspension of the job. Throws an {@code IllegalStateException}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODcyMjEzOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * if the job is not actually suspended.\n          \n          \n            \n                 * if the job is not currently suspended.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498722138", "createdAt": "2020-10-02T09:45:15Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/Job.java", "diffHunk": "@@ -86,21 +87,15 @@ default String getName() {\n     JobStatus getStatus();\n \n     /**\n-     * Return a human-readable description of the cause that led to the\n-     * suspension of this job. For example whether the suspension has been\n-     * explicitly requested by the user or an error has occurred and the job is\n-     * configured to be suspended in such a case (see {@link\n-     * JobConfig#setSuspendOnFailure(boolean)}) - in this case the details of\n-     * the error are also provided.\n-     *\n-     * @return cause that led to the job suspension\n-     * @throws IllegalStateException if the job is not suspended\n+     * Return a {@link JobSuspensionCause description of the cause} that has\n+     * lead to the suspension of the job. Throws an {@code IllegalStateException}\n+     * if the job is not actually suspended.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODcyMjI2Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Description of the cause that has lead to the job being suspended.\n          \n          \n            \n             * Description of the cause that has led to the job being suspended.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498722267", "createdAt": "2020-10-02T09:45:30Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nullable;\n+\n+/**\n+ * Description of the cause that has lead to the job being suspended.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODcyMjY5Ng==", "bodyText": "Shall we remove this?", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498722696", "createdAt": "2020-10-02T09:46:25Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/Job.java", "diffHunk": "@@ -86,21 +87,15 @@ default String getName() {\n     JobStatus getStatus();\n \n     /**\n-     * Return a human-readable description of the cause that led to the\n-     * suspension of this job. For example whether the suspension has been\n-     * explicitly requested by the user or an error has occurred and the job is\n-     * configured to be suspended in such a case (see {@link\n-     * JobConfig#setSuspendOnFailure(boolean)}) - in this case the details of\n-     * the error are also provided.\n-     *\n-     * @return cause that led to the job suspension\n-     * @throws IllegalStateException if the job is not suspended\n+     * Return a {@link JobSuspensionCause description of the cause} that has\n+     * lead to the suspension of the job. Throws an {@code IllegalStateException}\n+     * if the job is not actually suspended.\n      *\n      * @since 4.3\n      */\n     @EvolvingApi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODcyMzk3Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Provides the error that has lead to the suspension of the job, or returns\n          \n          \n            \n                 * Provides the error that has led to the suspension of the job, or returns", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498723977", "createdAt": "2020-10-02T09:49:01Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nullable;\n+\n+/**\n+ * Description of the cause that has lead to the job being suspended.\n+ * <p>\n+ * One reason for the job to be suspended is the user explicitly requesting it.\n+ * Another reason is encountering an error during execution, while being\n+ * configured to get suspended in such cases, instead of just failing. See\n+ * {@link JobConfig#setSuspendOnFailure(boolean)}.\n+ * <p>\n+ * When the job has been suspended due to an error, then the cause of that\n+ * error is provided.\n+ *\n+ * @since 4.4\n+ */\n+public interface JobSuspensionCause {\n+\n+    /**\n+     * True if the job has been suspended due to an explicit request from the\n+     * user.\n+     */\n+    boolean requestedByUser();\n+\n+    /**\n+     * True if the job has been suspended due to encountering an error during\n+     * execution.\n+     */\n+    boolean dueToError();\n+\n+    /**\n+     * Provides the error that has lead to the suspension of the job, or returns", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODcyNDE2NA==", "bodyText": "Does it return null if requested by user? It's not clear to me and seems wrong.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498724164", "createdAt": "2020-10-02T09:49:24Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nullable;\n+\n+/**\n+ * Description of the cause that has lead to the job being suspended.\n+ * <p>\n+ * One reason for the job to be suspended is the user explicitly requesting it.\n+ * Another reason is encountering an error during execution, while being\n+ * configured to get suspended in such cases, instead of just failing. See\n+ * {@link JobConfig#setSuspendOnFailure(boolean)}.\n+ * <p>\n+ * When the job has been suspended due to an error, then the cause of that\n+ * error is provided.\n+ *\n+ * @since 4.4\n+ */\n+public interface JobSuspensionCause {\n+\n+    /**\n+     * True if the job has been suspended due to an explicit request from the\n+     * user.\n+     */\n+    boolean requestedByUser();\n+\n+    /**\n+     * True if the job has been suspended due to encountering an error during\n+     * execution.\n+     */\n+    boolean dueToError();\n+\n+    /**\n+     * Provides the error that has lead to the suspension of the job, or returns\n+     * null if the cause of the suspension is different.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODcyODk1Mg==", "bodyText": "The client might not have the Throwable class. For example, you have a job with a custom ML library. That lib is added either through JobConfig, or to the member class path. A client (e.g. the mancenter) connects and tries to see the cause. It will fail.\nAlso I'm not sure that we never read the JobExecutionRecord in a context where the classes from JobConfig might not be available, it will fail with this change.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498728952", "createdAt": "2020-10-02T09:59:40Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/impl/JobSuspensionCauseImpl.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.impl;\n+\n+import com.hazelcast.jet.core.JobSuspensionCause;\n+import com.hazelcast.jet.impl.execution.init.JetInitDataSerializerHook;\n+import com.hazelcast.nio.ObjectDataInput;\n+import com.hazelcast.nio.ObjectDataOutput;\n+import com.hazelcast.nio.serialization.IdentifiedDataSerializable;\n+\n+import javax.annotation.Nullable;\n+import java.io.IOException;\n+\n+public class JobSuspensionCauseImpl implements JobSuspensionCause, IdentifiedDataSerializable {\n+\n+    private static final JobSuspensionCauseImpl REQUESTED_BY_USER = new JobSuspensionCauseImpl(null);\n+\n+    private Throwable error;\n+\n+    public JobSuspensionCauseImpl() { //needed for deserialization\n+    }\n+\n+    private JobSuspensionCauseImpl(Throwable error) {\n+        this.error = error;\n+    }\n+\n+    @Override\n+    public boolean requestedByUser() {\n+        return error == null;\n+    }\n+\n+    @Override\n+    public boolean dueToError() {\n+        return error != null;\n+    }\n+\n+    @Nullable\n+    @Override\n+    public Throwable errorCause() {\n+        return error;\n+    }\n+\n+    @Override\n+    public int getFactoryId() {\n+        return JetInitDataSerializerHook.FACTORY_ID;\n+    }\n+\n+    @Override\n+    public int getClassId() {\n+        return JetInitDataSerializerHook.JOB_SUSPENSION_CAUSE;\n+    }\n+\n+    @Override\n+    public void writeData(ObjectDataOutput out) throws IOException {\n+        out.writeObject(error);\n+    }\n+\n+    @Override\n+    public void readData(ObjectDataInput in) throws IOException {\n+        error = in.readObject();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODczMDU5Nw==", "bodyText": "What about adding a @Nonnull getDescription() method for simple cases that just want some information? The toString() can also delegate to this method.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498730597", "createdAt": "2020-10-02T10:03:26Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nullable;\n+\n+/**\n+ * Description of the cause that has lead to the job being suspended.\n+ * <p>\n+ * One reason for the job to be suspended is the user explicitly requesting it.\n+ * Another reason is encountering an error during execution, while being\n+ * configured to get suspended in such cases, instead of just failing. See\n+ * {@link JobConfig#setSuspendOnFailure(boolean)}.\n+ * <p>\n+ * When the job has been suspended due to an error, then the cause of that\n+ * error is provided.\n+ *\n+ * @since 4.4\n+ */\n+public interface JobSuspensionCause {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMDEwNjE5", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#pullrequestreview-501010619", "createdAt": "2020-10-02T10:04:53Z", "commit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMDowNDo1M1rOHboIfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxMDowODoxM1rOHboOLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODczMTEzNQ==", "bodyText": "\"True if the user explicitly suspended the job\"", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498731135", "createdAt": "2020-10-02T10:04:53Z", "author": {"login": "mtopolnik"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nullable;\n+\n+/**\n+ * Description of the cause that has lead to the job being suspended.\n+ * <p>\n+ * One reason for the job to be suspended is the user explicitly requesting it.\n+ * Another reason is encountering an error during execution, while being\n+ * configured to get suspended in such cases, instead of just failing. See\n+ * {@link JobConfig#setSuspendOnFailure(boolean)}.\n+ * <p>\n+ * When the job has been suspended due to an error, then the cause of that\n+ * error is provided.\n+ *\n+ * @since 4.4\n+ */\n+public interface JobSuspensionCause {\n+\n+    /**\n+     * True if the job has been suspended due to an explicit request from the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODczMjMzNg==", "bodyText": "\"True if Jet suspended the job because it encountered an error during execution\"", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498732336", "createdAt": "2020-10-02T10:07:34Z", "author": {"login": "mtopolnik"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nullable;\n+\n+/**\n+ * Description of the cause that has lead to the job being suspended.\n+ * <p>\n+ * One reason for the job to be suspended is the user explicitly requesting it.\n+ * Another reason is encountering an error during execution, while being\n+ * configured to get suspended in such cases, instead of just failing. See\n+ * {@link JobConfig#setSuspendOnFailure(boolean)}.\n+ * <p>\n+ * When the job has been suspended due to an error, then the cause of that\n+ * error is provided.\n+ *\n+ * @since 4.4\n+ */\n+public interface JobSuspensionCause {\n+\n+    /**\n+     * True if the job has been suspended due to an explicit request from the\n+     * user.\n+     */\n+    boolean requestedByUser();\n+\n+    /**\n+     * True if the job has been suspended due to encountering an error during", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODczMjU4OQ==", "bodyText": "... is not an exception.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r498732589", "createdAt": "2020-10-02T10:08:13Z", "author": {"login": "mtopolnik"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nullable;\n+\n+/**\n+ * Description of the cause that has lead to the job being suspended.\n+ * <p>\n+ * One reason for the job to be suspended is the user explicitly requesting it.\n+ * Another reason is encountering an error during execution, while being\n+ * configured to get suspended in such cases, instead of just failing. See\n+ * {@link JobConfig#setSuspendOnFailure(boolean)}.\n+ * <p>\n+ * When the job has been suspended due to an error, then the cause of that\n+ * error is provided.\n+ *\n+ * @since 4.4\n+ */\n+public interface JobSuspensionCause {\n+\n+    /**\n+     * True if the job has been suspended due to an explicit request from the\n+     * user.\n+     */\n+    boolean requestedByUser();\n+\n+    /**\n+     * True if the job has been suspended due to encountering an error during\n+     * execution.\n+     */\n+    boolean dueToError();\n+\n+    /**\n+     * Provides the error that has lead to the suspension of the job, or returns\n+     * null if the cause of the suspension is different.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eabe58573bd9bcc611a1e74d682f4d6daf255bda"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75a61168c680090f41b79bdf2faafacc7fb6b1d5", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/75a61168c680090f41b79bdf2faafacc7fb6b1d5", "committedDate": "2020-10-05T10:02:35Z", "message": "Address review concerns"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxOTE4NzQz", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#pullrequestreview-501918743", "createdAt": "2020-10-05T10:25:41Z", "commit": {"oid": "75a61168c680090f41b79bdf2faafacc7fb6b1d5"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMDoyNTo0MVrOHcW14w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMDozMDo0NlrOHcXAxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ5NjQxOQ==", "bodyText": "UnsupportedOperationException is for cases when some behavior is prescribed by the contract, but for some reason isn't implemented.\nBetter would be IllegalStateException.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r499496419", "createdAt": "2020-10-05T10:25:41Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nonnull;\n+\n+/**\n+ * Description of the cause that has led to the job being suspended.\n+ * <p>\n+ * One reason for the job to be suspended is the user explicitly requesting it.\n+ * Another reason is encountering an error during execution, while being\n+ * configured to get suspended in such cases, instead of just failing. See\n+ * {@link JobConfig#setSuspendOnFailure(boolean)}.\n+ * <p>\n+ * When the job has been suspended due to an error, then the cause of that\n+ * error is provided.\n+ *\n+ * @since 4.4\n+ */\n+public interface JobSuspensionCause {\n+\n+    /**\n+     * True if the user explicitly suspended the job.\n+     */\n+    boolean requestedByUser();\n+\n+    /**\n+     * True if Jet suspended the job because it encountered an error during\n+     * execution.\n+     */\n+    boolean dueToError();\n+\n+    /**\n+     * Describes the error that has led to the suspension of the job. Throws\n+     * {@link UnsupportedOperationException} if job was not suspended due to an", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75a61168c680090f41b79bdf2faafacc7fb6b1d5"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ5ODI2Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Describes the job suspension cause in a human readable form.\n          \n          \n            \n                 * Describes the job suspension cause in a human-readable form.\n          \n      \n    \n    \n  \n\nWithout the dash it's a form that's human and also readable :).", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r499498267", "createdAt": "2020-10-05T10:28:59Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/core/JobSuspensionCause.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.jet.core;\n+\n+import com.hazelcast.jet.config.JobConfig;\n+\n+import javax.annotation.Nonnull;\n+\n+/**\n+ * Description of the cause that has led to the job being suspended.\n+ * <p>\n+ * One reason for the job to be suspended is the user explicitly requesting it.\n+ * Another reason is encountering an error during execution, while being\n+ * configured to get suspended in such cases, instead of just failing. See\n+ * {@link JobConfig#setSuspendOnFailure(boolean)}.\n+ * <p>\n+ * When the job has been suspended due to an error, then the cause of that\n+ * error is provided.\n+ *\n+ * @since 4.4\n+ */\n+public interface JobSuspensionCause {\n+\n+    /**\n+     * True if the user explicitly suspended the job.\n+     */\n+    boolean requestedByUser();\n+\n+    /**\n+     * True if Jet suspended the job because it encountered an error during\n+     * execution.\n+     */\n+    boolean dueToError();\n+\n+    /**\n+     * Describes the error that has led to the suspension of the job. Throws\n+     * {@link UnsupportedOperationException} if job was not suspended due to an\n+     * error.\n+     */\n+    @Nonnull\n+    String errorCause();\n+\n+    /**\n+     * Describes the job suspension cause in a human readable form.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75a61168c680090f41b79bdf2faafacc7fb6b1d5"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ5OTIwNg==", "bodyText": "You can keep this assert against the description method.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/2581#discussion_r499499206", "createdAt": "2020-10-05T10:30:46Z", "author": {"login": "viliam-durina"}, "path": "hazelcast-jet-core/src/test/java/com/hazelcast/jet/core/SuspendExecutionOnFailureTest.java", "diffHunk": "@@ -113,7 +113,11 @@ public void when_jobSuspendedByUser_then_suspensionCauseSaysSo() {\n         assertJobStatusEventually(job, RUNNING);\n         job.suspend();\n         assertJobStatusEventually(job, SUSPENDED);\n-        assertEquals(\"Requested by user\", job.getSuspensionCause());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75a61168c680090f41b79bdf2faafacc7fb6b1d5"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2d0ce74743a8a32c869ab86b227adfb93120bc5", "author": {"user": null}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/a2d0ce74743a8a32c869ab86b227adfb93120bc5", "committedDate": "2020-10-05T11:47:08Z", "message": "Address more review concerns"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3461, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}