{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxNzcwNjA3", "number": 1932, "title": "Add nested classes & packages to JobConfig", "bodyText": "JobConfig.addClass() adds nested classes to resources as well.\nChecklist\n\n Tags Set\n Milestone Set\n\n#1689", "createdAt": "2020-02-06T08:33:40Z", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932", "merged": true, "mergeCommit": {"oid": "7127f95ff8f23a04b215bee2aefdd27ba33e80ef"}, "closed": true, "closedAt": "2020-02-25T13:56:50Z", "author": {"login": "gierlachg"}, "timelineItems": {"totalCount": 44, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBmdAggH2gAyMzcxNzcwNjA3OmNhZjM5OGI2NjI1NjgwMjgzOGRlYzJhNmVjZWVmYmJkZWUzYWYyZGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcHyfXgAFqTM2NDE1NTQ5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "caf398b66256802838dec2a6eceefbbdee3af2de", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/caf398b66256802838dec2a6eceefbbdee3af2de", "committedDate": "2020-02-06T08:28:05Z", "message": "Add nested classes to Jet job."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0NDU0NDA4", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#pullrequestreview-354454408", "createdAt": "2020-02-06T13:39:10Z", "commit": {"oid": "caf398b66256802838dec2a6eceefbbdee3af2de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMzozOToxMFrOFmbThQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQxMzozOToxMFrOFmbThQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgzNzU3Mw==", "bodyText": "can we add a test with anonymous class too", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#discussion_r375837573", "createdAt": "2020-02-06T13:39:10Z", "author": {"login": "gurbuzali"}, "path": "hazelcast-jet-core/src/test/java/com/hazelcast/jet/config/ResourceConfigTest.java", "diffHunk": "@@ -1024,4 +1033,9 @@ private File createDirectory(String path) {\n         assertTrue(\"Failed to create directory \" + dirFile, dirFile.mkdirs());\n         return dirFile;\n     }\n+\n+    private static class BaseClass {\n+        private static class NestedClass {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "caf398b66256802838dec2a6eceefbbdee3af2de"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "593776b2b3be9307468b2a21e8c5e27dbc164dbb", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/593776b2b3be9307468b2a21e8c5e27dbc164dbb", "committedDate": "2020-02-06T15:17:35Z", "message": "Add support for anonymous classes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2ad989baa9d9377b48c555fad479b5f3a9354a9", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/e2ad989baa9d9377b48c555fad479b5f3a9354a9", "committedDate": "2020-02-06T15:23:01Z", "message": "Merge branch 'master' into job_classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b48db6d1bb576467565c46fa004b87f475067267", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/b48db6d1bb576467565c46fa004b87f475067267", "committedDate": "2020-02-06T15:29:46Z", "message": "Merge branch 'master' into job_classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e09bd83815280b56724154f8f608ee465030de8", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/2e09bd83815280b56724154f8f608ee465030de8", "committedDate": "2020-02-06T15:30:02Z", "message": "Merge remote-tracking branch 'origin/job_classes' into job_classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6414fc873a99f120adf5011a0d97102c6405bd21", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/6414fc873a99f120adf5011a0d97102c6405bd21", "committedDate": "2020-02-06T15:34:35Z", "message": "Fix spotbugs error."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3ed4d23d5fdf5dd65c0a755ca35d3e8a28d0b87", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/d3ed4d23d5fdf5dd65c0a755ca35d3e8a28d0b87", "committedDate": "2020-02-06T15:37:57Z", "message": "Cleanup JobConfig.addClass() test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e6413cb47616c97bf62f9c32a70001eb1731463", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/3e6413cb47616c97bf62f9c32a70001eb1731463", "committedDate": "2020-02-06T15:38:40Z", "message": "Fix spotbugs error."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "043595624e9afc2f84e6ef45ed58a1de7cd89506", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/043595624e9afc2f84e6ef45ed58a1de7cd89506", "committedDate": "2020-02-06T16:54:21Z", "message": "Filter out non-class nested resources."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5862d59c13d0fb3b2a8d3187524898176c2eccc", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/f5862d59c13d0fb3b2a8d3187524898176c2eccc", "committedDate": "2020-02-06T16:55:36Z", "message": "Format."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d69f3f631dc06d4ab3dda592083a979bd526613", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/8d69f3f631dc06d4ab3dda592083a979bd526613", "committedDate": "2020-02-06T16:59:04Z", "message": "Naming."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "000b222c815f274f1af3a7dfea6e0e4dd37b4951", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/000b222c815f274f1af3a7dfea6e0e4dd37b4951", "committedDate": "2020-02-07T07:21:34Z", "message": "Merge remote-tracking branch 'upstream/master' into job_classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2890b5ad630373c7524982e6c54b03a10fb3052", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/f2890b5ad630373c7524982e6c54b03a10fb3052", "committedDate": "2020-02-07T08:26:32Z", "message": "Handle no package case."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6be14a08cbe110a8c5938212de34dfbe77fa2cdb", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/6be14a08cbe110a8c5938212de34dfbe77fa2cdb", "committedDate": "2020-02-07T08:27:27Z", "message": "Add kotlin resource test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28c6302a5dafc1e42e906e474aa8ef6d17948e58", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/28c6302a5dafc1e42e906e474aa8ef6d17948e58", "committedDate": "2020-02-07T08:35:51Z", "message": "Merge remote-tracking branch 'upstream/master' into job_classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "866584797f6af4d15b3220efbace2ee55d076361", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/866584797f6af4d15b3220efbace2ee55d076361", "committedDate": "2020-02-07T08:44:34Z", "message": "Suppress SpotBugs false positive on JDK11."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca4036daa7f613b209f55220d61357937bd7f775", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/ca4036daa7f613b209f55220d61357937bd7f775", "committedDate": "2020-02-07T09:22:09Z", "message": "Merge remote-tracking branch 'upstream/master' into job_classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e02e7e2eec2cbe74efb7c01014737b7b76955c55", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/e02e7e2eec2cbe74efb7c01014737b7b76955c55", "committedDate": "2020-02-07T10:46:49Z", "message": "Fix build."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MDc1NDI3", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#pullrequestreview-355075427", "createdAt": "2020-02-07T10:49:39Z", "commit": {"oid": "e02e7e2eec2cbe74efb7c01014737b7b76955c55"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxMDo0OTozOVrOFm5URg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxMDo1MDozNlrOFm5Vqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjMyOTI4Ng==", "bodyText": "You can simplify this by first building a literal class string (no escaping) and then calling Pattern.quote() on it.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#discussion_r376329286", "createdAt": "2020-02-07T10:49:39Z", "author": {"login": "mtopolnik"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/config/JobConfig.java", "diffHunk": "@@ -232,10 +241,26 @@ public JobConfig setSnapshotIntervalMillis(long snapshotInterval) {\n     @Nonnull\n     @SuppressWarnings(\"rawtypes\")\n     public JobConfig addClass(@Nonnull Class... classes) {\n-        checkNotNull(classes, \"Classes can not be null\");\n+        checkNotNull(classes, \"Classes cannot be null\");\n         for (Class<?> clazz : classes) {\n             ResourceConfig cfg = new ResourceConfig(clazz);\n             resourceConfigs.put(cfg.getId(), cfg);\n+\n+            ClassLoader classLoader = clazz.getClassLoader();\n+            String packagePrefixPath = Optional.ofNullable(clazz.getPackage())\n+                                               .map(pakage -> pakage.getName().replace('.', '/') + \"/\")\n+                                               .orElse(\"\");\n+            Pattern nestedPattern = Pattern.compile(clazz.getName()\n+                                                         .replace(\".\", \"\\\\/\")\n+                                                         .replace(\"$\", \"\\\\$\") + \"\\\\$.+\" + \"\\\\.class\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e02e7e2eec2cbe74efb7c01014737b7b76955c55"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjMyOTY0Mw==", "bodyText": "Would you mind using static imports here? It would remove quite a lot of noise.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#discussion_r376329643", "createdAt": "2020-02-07T10:50:36Z", "author": {"login": "mtopolnik"}, "path": "hazelcast-jet-core/src/test/kotlin/com/hazelcast/jet/config/KotlinResourceTest.kt", "diffHunk": "@@ -0,0 +1,43 @@\n+package com.hazelcast.jet.config\n+\n+import org.hamcrest.Matchers\n+import org.junit.Assert\n+import org.junit.Before\n+import org.junit.Test\n+\n+class KotlinResourceTest {\n+\n+    private var config: JobConfig? = null\n+\n+    @Before\n+    fun setUp() {\n+        config = JobConfig()\n+    }\n+\n+    @Test\n+    fun shouldAddNestedAndAnonymousClasses() {\n+        // When\n+        config!!.addClass(OuterClass::class.java)\n+\n+        // Then\n+        val resourceConfigs: Collection<ResourceConfig> = config!!.resourceConfigs.values\n+        Assert.assertThat(resourceConfigs, Matchers.hasSize(4))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e02e7e2eec2cbe74efb7c01014737b7b76955c55"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "049e0a5b7565a43041a67a296f1bc0b402b86e79", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/049e0a5b7565a43041a67a296f1bc0b402b86e79", "committedDate": "2020-02-07T10:59:25Z", "message": "Address PR reviews."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "692eab70cb6708f182e26bc2fedd4520a916a458", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/692eab70cb6708f182e26bc2fedd4520a916a458", "committedDate": "2020-02-07T11:10:29Z", "message": "Fix checkstyle."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MDkyMzI3", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#pullrequestreview-355092327", "createdAt": "2020-02-07T11:22:33Z", "commit": {"oid": "692eab70cb6708f182e26bc2fedd4520a916a458"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxMToyMjozM1rOFm6GuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxMToyMjozM1rOFm6GuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjM0MjIwMA==", "bodyText": "minor, but Javadoc should be wrapped at 72 chars (net)", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#discussion_r376342200", "createdAt": "2020-02-07T11:22:33Z", "author": {"login": "cangencer"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/config/JobConfig.java", "diffHunk": "@@ -219,8 +228,8 @@ public JobConfig setSnapshotIntervalMillis(long snapshotInterval) {\n     }\n \n     /**\n-     * Adds the given classes to the Jet job's classpath. They will be\n-     * accessible to all the code attached to the underlying pipeline or DAG,\n+     * Adds the given classes and recursively all their nested classes to the Jet job's classpath.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "692eab70cb6708f182e26bc2fedd4520a916a458"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa8ee78776bac6d808d02ad2e7ebeb41f758fec7", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/fa8ee78776bac6d808d02ad2e7ebeb41f758fec7", "committedDate": "2020-02-07T11:26:49Z", "message": "Fix Javadoc formatting."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MTExMTgx", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#pullrequestreview-355111181", "createdAt": "2020-02-07T12:02:12Z", "commit": {"oid": "fa8ee78776bac6d808d02ad2e7ebeb41f758fec7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxMjowMjoxM1rOFm6-vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxMjowMjoxM1rOFm6-vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjM1NjU0Mw==", "bodyText": "this does not work if the class is coming from a dependency. I've created a jar which contains the OuterClass and added that jar as a dependency to my project. When I called addClass, the returned resource list is empty.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#discussion_r376356543", "createdAt": "2020-02-07T12:02:13Z", "author": {"login": "gurbuzali"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/config/JobConfig.java", "diffHunk": "@@ -232,10 +241,26 @@ public JobConfig setSnapshotIntervalMillis(long snapshotInterval) {\n     @Nonnull\n     @SuppressWarnings(\"rawtypes\")\n     public JobConfig addClass(@Nonnull Class... classes) {\n-        checkNotNull(classes, \"Classes can not be null\");\n+        checkNotNull(classes, \"Classes cannot be null\");\n         for (Class<?> clazz : classes) {\n             ResourceConfig cfg = new ResourceConfig(clazz);\n             resourceConfigs.put(cfg.getId(), cfg);\n+\n+            ClassLoader classLoader = clazz.getClassLoader();\n+            String packagePrefixPath = Optional.ofNullable(clazz.getPackage())\n+                                               .map(pakage -> pakage.getName().replace('.', '/') + \"/\")\n+                                               .orElse(\"\");\n+            Pattern nestedPattern = Pattern.compile(\n+                    Pattern.quote(clazz.getName().replace('.', '/')) + \"\\\\$.+\" + \"\\\\.class\"\n+            );\n+            resources(classLoader, packagePrefixPath)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa8ee78776bac6d808d02ad2e7ebeb41f758fec7"}, "originalPosition": 78}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cb890319be6048ed278006d49b0046415cd784d", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/6cb890319be6048ed278006d49b0046415cd784d", "committedDate": "2020-02-10T10:17:16Z", "message": "Add class discovery using 'classgraph'."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0af77d4615c2203dd6c152a89671c0ed9fac906d", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/0af77d4615c2203dd6c152a89671c0ed9fac906d", "committedDate": "2020-02-10T10:17:59Z", "message": "Merge branch 'master' into job_classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ad9484fdb73fc03b7c8c6ad0746a46913e3a02a", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/4ad9484fdb73fc03b7c8c6ad0746a46913e3a02a", "committedDate": "2020-02-10T11:00:30Z", "message": "Accept String as package name & move ReflectionUtils to config package."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9e0352a8817d2225ea14b9eff5b51250ca75c59", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/e9e0352a8817d2225ea14b9eff5b51250ca75c59", "committedDate": "2020-02-10T12:28:47Z", "message": "Add non-class resources together with addPackage()."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48d36312df2277e8b7323532d59b7a8d855e9e5d", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/48d36312df2277e8b7323532d59b7a8d855e9e5d", "committedDate": "2020-02-10T12:56:06Z", "message": "Remove redundant public modifier."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c9ed5cfcaed6a5016544a96a14784e2cd893498", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/9c9ed5cfcaed6a5016544a96a14784e2cd893498", "committedDate": "2020-02-10T14:00:29Z", "message": "Merge ReflectionUtils classes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75df1f314ceb01878df4aec9c0862bde80a97a3f", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/75df1f314ceb01878df4aec9c0862bde80a97a3f", "committedDate": "2020-02-10T14:02:27Z", "message": "Merge ReflectionUtils classes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e5c4da577d694d8ea477d647e16c02fe834bb14", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/6e5c4da577d694d8ea477d647e16c02fe834bb14", "committedDate": "2020-02-10T14:09:34Z", "message": "Mark class as final."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3671331be999d9e549f08aa39217c9974f5075c6", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/3671331be999d9e549f08aa39217c9974f5075c6", "committedDate": "2020-02-10T19:18:56Z", "message": "Merge branch 'master' into job_classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11e3eea39db06d521e61abcc8ebba07eb22d6715", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/11e3eea39db06d521e61abcc8ebba07eb22d6715", "committedDate": "2020-02-10T19:41:29Z", "message": "Shade classgraph & naming."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50b27c0e115f9a55296b8127e2867b2f424dfe28", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/50b27c0e115f9a55296b8127e2867b2f424dfe28", "committedDate": "2020-02-11T08:01:31Z", "message": "Add notice about usage of classgraph."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2NjAwMDM1", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#pullrequestreview-356600035", "createdAt": "2020-02-11T11:58:29Z", "commit": {"oid": "50b27c0e115f9a55296b8127e2867b2f424dfe28"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89c3e615287329686681d16ebf16eb250e44430d", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/89c3e615287329686681d16ebf16eb250e44430d", "committedDate": "2020-02-24T08:27:08Z", "message": "Merge branch 'master' into job_classes\n\n# Conflicts:\n#\thazelcast-jet-core/pom.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca553b6bf3ec72944a5b80ef3cd7d831cf585145", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/ca553b6bf3ec72944a5b80ef3cd7d831cf585145", "committedDate": "2020-02-24T08:43:56Z", "message": "Merge branch 'master' into job_classes\n\n# Conflicts:\n# hazelcast-jet-core/pom.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f613aaa1cad9c475118cdb39e8f2e888b47384ae", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/f613aaa1cad9c475118cdb39e8f2e888b47384ae", "committedDate": "2020-02-24T09:13:00Z", "message": "Merge branch 'master' into job_classes\n\n# Conflicts:\n# hazelcast-jet-core/pom.xml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MDE0NjI0", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#pullrequestreview-364014624", "createdAt": "2020-02-25T10:06:10Z", "commit": {"oid": "f613aaa1cad9c475118cdb39e8f2e888b47384ae"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDowNjoxMFrOFt_8LA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDoxNzoxOFrOFuAT1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3NzgzNg==", "bodyText": "Do we really have to double-check a @Nonnull parameter?", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#discussion_r383777836", "createdAt": "2020-02-25T10:06:10Z", "author": {"login": "mtopolnik"}, "path": "hazelcast-jet-core/src/main/java/com/hazelcast/jet/config/JobConfig.java", "diffHunk": "@@ -238,11 +240,40 @@ public JobConfig setSnapshotIntervalMillis(long snapshotInterval) {\n     @Nonnull\n     @SuppressWarnings(\"rawtypes\")\n     public JobConfig addClass(@Nonnull Class... classes) {\n-        checkNotNull(classes, \"Classes can not be null\");\n-        for (Class<?> clazz : classes) {\n+        checkNotNull(classes, \"Classes cannot be null\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f613aaa1cad9c475118cdb39e8f2e888b47384ae"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc4MzYzOA==", "bodyText": "The when_<PRECONDITION>_then_<POSTCONDITION> name pattern is more useful. This name could be when_nestedClassesOf_then_returnsAllNestedClasses.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#discussion_r383783638", "createdAt": "2020-02-25T10:16:52Z", "author": {"login": "mtopolnik"}, "path": "hazelcast-jet-core/src/test/java/com/hazelcast/jet/impl/util/ReflectionUtilsTest.java", "diffHunk": "@@ -50,9 +63,49 @@ public void readStaticFieldOrNull_readFromPublicField() {\n         assertEquals(\"staticPublicFieldContent\", field);\n     }\n \n+    @Test\n+    public void shouldDiscoverAllNestedClasses() throws ClassNotFoundException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f613aaa1cad9c475118cdb39e8f2e888b47384ae"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc4Mzg5NQ==", "bodyText": "This should assert that the nested class is also there.", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#discussion_r383783895", "createdAt": "2020-02-25T10:17:18Z", "author": {"login": "mtopolnik"}, "path": "hazelcast-jet-core/src/test/java/com/hazelcast/jet/impl/util/ReflectionUtilsTest.java", "diffHunk": "@@ -50,9 +63,49 @@ public void readStaticFieldOrNull_readFromPublicField() {\n         assertEquals(\"staticPublicFieldContent\", field);\n     }\n \n+    @Test\n+    public void shouldDiscoverAllNestedClasses() throws ClassNotFoundException {\n+        // When\n+        Collection<Class<?>> classes = ReflectionUtils.nestedClassesOf(OuterClass.class);\n+\n+        // Then\n+        assertThat(classes, hasSize(3));\n+        assertThat(classes, containsInAnyOrder(\n+                OuterClass.class,\n+                OuterClass.NestedClass.class,\n+                Class.forName(\"com.hazelcast.jet.impl.util.ReflectionUtilsTest$OuterClass$1\")\n+        ));\n+    }\n+\n+    @Test\n+    public void shouldDiscoverAllClassesAndResourcesInAPackage() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f613aaa1cad9c475118cdb39e8f2e888b47384ae"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "849a0a32fc63828d91ed9a37a54830b5417fb860", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/849a0a32fc63828d91ed9a37a54830b5417fb860", "committedDate": "2020-02-25T10:29:47Z", "message": "Address review comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6d21f5327fdd36b5d8c63eb999defcc7552ba7f", "author": {"user": {"login": "gierlachg", "name": "Grzegorz Gierlach"}}, "url": "https://github.com/hazelcast/hazelcast-jet/commit/a6d21f5327fdd36b5d8c63eb999defcc7552ba7f", "committedDate": "2020-02-25T13:30:20Z", "message": "Address review comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MTU1NDkx", "url": "https://github.com/hazelcast/hazelcast-jet/pull/1932#pullrequestreview-364155491", "createdAt": "2020-02-25T13:53:05Z", "commit": {"oid": "a6d21f5327fdd36b5d8c63eb999defcc7552ba7f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2974, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}