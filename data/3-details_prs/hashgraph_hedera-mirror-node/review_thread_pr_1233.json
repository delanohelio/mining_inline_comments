{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2MDUwMjY3", "number": 1233, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNToxNDoxOVrOE1s87w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0NDo0MlrOE2MsLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NzQ2NDc5OnYy", "diffSide": "RIGHT", "path": "hedera-mirror-importer/src/main/resources/db/scripts/init/init.sql", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNToxNDoxOVrOHuH-MA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNToxNDoxOVrOHuH-MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODEyNzE1Mg==", "bodyText": "Would prefer this file at its original location. I'm guessing it was moved so you don't mount the other sql scripts into the docker volume. See my other comment.", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1233#discussion_r518127152", "createdAt": "2020-11-05T15:14:19Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/main/resources/db/scripts/init/init.sql", "diffHunk": "@@ -0,0 +1,39 @@\n+-- Change the values below if you are not installing via Docker", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2ba92b5f98517083b973edee3ffc902cfcbe1a3"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NzYwMzcwOnYy", "diffSide": "RIGHT", "path": "docker-compose.yml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNTo0MDoyMVrOHuJUHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNTo0MDoyMVrOHuJUHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODE0OTE1MQ==", "bodyText": "Should just be able to mount a single file:\n- ./hedera-mirror-importer/src/main/resources/db/scripts/init.sql:/docker-entrypoint-initdb.d/init.sql\n\nOr if that doesn't work the long syntax might.", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1233#discussion_r518149151", "createdAt": "2020-11-05T15:40:21Z", "author": {"login": "steven-sheehy"}, "path": "docker-compose.yml", "diffHunk": "@@ -12,7 +12,7 @@ services:\n       POSTGRES_USER: mirror_node\n     volumes:\n       - ./db:/var/lib/postgresql/data\n-      - ./hedera-mirror-grpc/scripts/db/:/docker-entrypoint-initdb.d/\n+      - ./hedera-mirror-importer/src/main/resources/db/scripts/init/:/docker-entrypoint-initdb.d/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2ba92b5f98517083b973edee3ffc902cfcbe1a3"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NzY0Mzg1OnYy", "diffSide": "RIGHT", "path": "hedera-mirror-importer/src/main/resources/db/scripts/init/init.sql", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNTo0ODozNFrOHuJtEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNTo0ODozNFrOHuJtEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODE1NTUzNw==", "bodyText": "What's the purpose of creating the mirror_node user idempotently if you're not going to also create the grpc and rosetta users the same way?", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1233#discussion_r518155537", "createdAt": "2020-11-05T15:48:34Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/main/resources/db/scripts/init/init.sql", "diffHunk": "@@ -0,0 +1,39 @@\n+-- Change the values below if you are not installing via Docker\n+\n+\\set db_name 'mirror_node'\n+\\set db_user 'mirror_node'\n+\\set db_password 'mirror_node_pass'\n+\\set db_owner 'mirror_node'\n+\\set grpc_user 'mirror_grpc'\n+\\set grpc_password 'mirror_grpc_pass'\n+\\set rosetta_user 'mirror_rosetta'\n+\\set rosetta_password 'mirror_rosetta_pass'\n+\n+select 'create database mirror_node'\n+where not exists (select from pg_database where datname = :'db_name')\\gexec\n+\n+do $$\n+begin\n+  create user mirror_node with login createrole password 'mirror_node_pass';\n+  exception when duplicate_object then\n+  raise notice 'not creating user mirror_node -- it already exists';\n+end\n+$$;\n+\n+create user :grpc_user with login password :'grpc_password';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f2ba92b5f98517083b973edee3ffc902cfcbe1a3"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MjY2MTM4OnYy", "diffSide": "RIGHT", "path": "hedera-mirror-importer/src/main/resources/db/scripts/init.sql", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0MzozMlrOHu5aQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0MzozMlrOHu5aQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkzNzE1Mg==", "bodyText": "This needs to use the rosetta_user and rosetta_password variables", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1233#discussion_r518937152", "createdAt": "2020-11-06T18:43:32Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/main/resources/db/scripts/init.sql", "diffHunk": "@@ -6,17 +6,46 @@\n \\set db_owner 'mirror_node'\n \\set grpc_user 'mirror_grpc'\n \\set grpc_password 'mirror_grpc_pass'\n+\\set rosetta_user 'mirror_rosetta'\n+\\set rosetta_password 'mirror_rosetta_pass'\n+\n+do $$\n+begin\n+  create user mirror_node with createrole password 'mirror_node_pass';\n+  exception when duplicate_object then\n+  raise notice 'not creating user mirror_node -- it already exists';\n+end\n+$$;\n+\n+select 'create database mirror_node'\n+where not exists (select from pg_database where datname = :'db_name')\\gexec\n+\n+do $$\n+begin\n+  create user mirror_grpc with login password 'mirror_grpc_pass';\n+  exception when duplicate_object then\n+  raise notice 'not creating user mirror_grpc -- it already exists';\n+end\n+$$;\n \n-create user :db_user with login createrole password :'db_password';\n-\n-create database :db_name with owner :db_owner;\n+grant connect on database :db_name to :grpc_user;\n \n-create user :grpc_user with login password :'grpc_password';\n+do $$\n+begin\n+  create user mirror_rosetta with login password 'mirror_rosetta_pass';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10e5f7884ae1deb2c7d48a390e45c75d1ecfdd3d"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MjY2MjcyOnYy", "diffSide": "RIGHT", "path": "hedera-mirror-importer/src/main/resources/db/scripts/init.sql", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0NDowM1rOHu5bFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0NDowM1rOHu5bFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkzNzM2Ng==", "bodyText": "This needs to use the grpc_user and grpc_password variables", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1233#discussion_r518937366", "createdAt": "2020-11-06T18:44:03Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/main/resources/db/scripts/init.sql", "diffHunk": "@@ -6,17 +6,46 @@\n \\set db_owner 'mirror_node'\n \\set grpc_user 'mirror_grpc'\n \\set grpc_password 'mirror_grpc_pass'\n+\\set rosetta_user 'mirror_rosetta'\n+\\set rosetta_password 'mirror_rosetta_pass'\n+\n+do $$\n+begin\n+  create user mirror_node with createrole password 'mirror_node_pass';\n+  exception when duplicate_object then\n+  raise notice 'not creating user mirror_node -- it already exists';\n+end\n+$$;\n+\n+select 'create database mirror_node'\n+where not exists (select from pg_database where datname = :'db_name')\\gexec\n+\n+do $$\n+begin\n+  create user mirror_grpc with login password 'mirror_grpc_pass';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10e5f7884ae1deb2c7d48a390e45c75d1ecfdd3d"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MjY2NDA2OnYy", "diffSide": "RIGHT", "path": "hedera-mirror-importer/src/main/resources/db/scripts/init.sql", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0NDozMlrOHu5b6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0NDozMlrOHu5b6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkzNzU3OA==", "bodyText": "This needs to use the db_name variable", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1233#discussion_r518937578", "createdAt": "2020-11-06T18:44:32Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/main/resources/db/scripts/init.sql", "diffHunk": "@@ -6,17 +6,46 @@\n \\set db_owner 'mirror_node'\n \\set grpc_user 'mirror_grpc'\n \\set grpc_password 'mirror_grpc_pass'\n+\\set rosetta_user 'mirror_rosetta'\n+\\set rosetta_password 'mirror_rosetta_pass'\n+\n+do $$\n+begin\n+  create user mirror_node with createrole password 'mirror_node_pass';\n+  exception when duplicate_object then\n+  raise notice 'not creating user mirror_node -- it already exists';\n+end\n+$$;\n+\n+select 'create database mirror_node'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10e5f7884ae1deb2c7d48a390e45c75d1ecfdd3d"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MjY2NDc4OnYy", "diffSide": "RIGHT", "path": "hedera-mirror-importer/src/main/resources/db/scripts/init.sql", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0NDo0MlrOHu5cUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxODo0NDo0MlrOHu5cUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkzNzY4MQ==", "bodyText": "This needs to use the variables", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1233#discussion_r518937681", "createdAt": "2020-11-06T18:44:42Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/main/resources/db/scripts/init.sql", "diffHunk": "@@ -6,17 +6,46 @@\n \\set db_owner 'mirror_node'\n \\set grpc_user 'mirror_grpc'\n \\set grpc_password 'mirror_grpc_pass'\n+\\set rosetta_user 'mirror_rosetta'\n+\\set rosetta_password 'mirror_rosetta_pass'\n+\n+do $$\n+begin\n+  create user mirror_node with createrole password 'mirror_node_pass';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10e5f7884ae1deb2c7d48a390e45c75d1ecfdd3d"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1401, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}