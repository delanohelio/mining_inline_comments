{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyNzMyNjY0", "number": 682, "title": "Fix NPE when parsing autoRenewAccount", "bodyText": "Detailed description:\n\nBump version to 0.9.0-rc3\nFix NPE after deploying 0.9.0-rc2 to dev:\n\nApr 13 16:42:04 mirrornode-dev-1 java[4160]: 2020-04-13 16:42:04,723 ERROR [scheduling-6] c.h.m.i.p.r.RecordFileParser Error parsing file /var/lib/hedera-mirror-importer/recordstreams/valid/2020-04-10T19_43_31.030021Z.rcd\nApr 13 16:42:04 mirrornode-dev-1 java[4160]: java.lang.NullPointerException: null\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at com.hedera.mirror.importer.parser.record.RecordItemParser.lookupOrCreateId(RecordItemParser.java:670) ~[classes!/:0.9.0-rc2]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at com.hedera.mirror.importer.parser.record.RecordItemParser.consensusUpdateTopicUpdateEntity(RecordItemParser.java:460) ~[classes!/:0.9.0-rc2]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at com.hedera.mirror.importer.parser.record.RecordItemParser.onItem(RecordItemParser.java:283) ~[classes!/:0.9.0-rc2]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at com.hedera.mirror.importer.parser.record.RecordItemParser.onItem(RecordItemParser.java:67) ~[classes!/:0.9.0-rc2]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at com.hedera.mirror.importer.parser.record.RecordFileParser.loadRecordFile(RecordFileParser.java:204) ~[classes!/:0.9.0-rc2]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at com.hedera.mirror.importer.parser.record.RecordFileParser.loadRecordFiles(RecordFileParser.java:270) [classes!/:0.9.0-rc2]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at com.hedera.mirror.importer.parser.record.RecordFileParser.parse(RecordFileParser.java:308) [classes!/:0.9.0-rc2]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at jdk.internal.reflect.GeneratedMethodAccessor112.invoke(Unknown Source) ~[?:?]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84) [spring-context-5.2.3.RELEASE.jar!/:5.2.3.RELEASE]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) [spring-context-5.2.3.RELEASE.jar!/:5.2.3.RELEASE]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) [?:?]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305) [?:?]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305) [?:?]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\nApr 13 16:42:04 mirrornode-dev-1 java[4160]:         at java.lang.Thread.run(Thread.java:834) [?:?]\n\nWhich issue(s) this PR fixes:\nSpecial notes for your reviewer:\nChecklist\n\n Documentation added\n Tests updated", "createdAt": "2020-04-13T16:51:27Z", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/682", "merged": true, "mergeCommit": {"oid": "f355a9d2ea32f9f0df5fc09c8bbebbf3bb603b92"}, "closed": true, "closedAt": "2020-04-13T17:39:22Z", "author": {"login": "steven-sheehy"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXRcRAAH2gAyNDAyNzMyNjY0OjU4MGYwOTcwZmIyYjYxZmY2YzQwYjYwMmViYmYyMTU0OTNiYmVhMjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXSXi8gFqTM5MjI5ODg3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "580f0970fb2b61ff6c40b602ebbf215493bbea29", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/580f0970fb2b61ff6c40b602ebbf215493bbea29", "committedDate": "2020-04-13T16:25:36Z", "message": "Fix NPE when parsing autoRenewAccount\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc4fecc6a732969574e5e0f2e92114ba31083642", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/cc4fecc6a732969574e5e0f2e92114ba31083642", "committedDate": "2020-04-13T16:48:52Z", "message": "Bump versions for v0.9.0-rc3\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMjc0OTI4", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/682#pullrequestreview-392274928", "createdAt": "2020-04-13T16:54:16Z", "commit": {"oid": "cc4fecc6a732969574e5e0f2e92114ba31083642"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNjo1NDoxNlrOGEtBew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNjo1NDoxNlrOGEtBew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU4NTE0Nw==", "bodyText": "You should probably still have this in the if (transactionBody.hasAutoRenewAccount()) {} so that the lookup is only done when it matters", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/682#discussion_r407585147", "createdAt": "2020-04-13T16:54:16Z", "author": {"login": "Nana-EC"}, "path": "hedera-mirror-importer/src/main/java/com/hedera/mirror/importer/parser/record/RecordItemParser.java", "diffHunk": "@@ -455,9 +455,10 @@ private void consensusUpdateTopicUpdateEntity(\n                 entity.setExpiryTimeNs(Utility.timestampInNanosMax(expirationTime));\n             }\n \n-            if (transactionBody.hasAutoRenewAccount()) {\n-                // Looks up (in the big cache) or creates new id.\n-                entity.setAutoRenewAccountId(lookupOrCreateId(EntityId.of(transactionBody.getAutoRenewAccount())));\n+            // Stream can contain transactions with autoRenewAccountId explicitly set to '0.0.0'\n+            Long autoRenewAccountId = lookupOrCreateId(EntityId.of(transactionBody.getAutoRenewAccount()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc4fecc6a732969574e5e0f2e92114ba31083642"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMjk4ODc1", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/682#pullrequestreview-392298875", "createdAt": "2020-04-13T17:30:21Z", "commit": {"oid": "cc4fecc6a732969574e5e0f2e92114ba31083642"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3067, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}