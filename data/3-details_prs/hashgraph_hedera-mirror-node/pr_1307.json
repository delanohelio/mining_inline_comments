{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMTY3MzU2", "number": 1307, "title": "Refactor CryptoTransferTransactionSupplier to only add token only transfers", "bodyText": "Detailed description:\nThe CryptoTransferTransactionSupplier is adding an unnecessary crypto transfer when attempting to submit a token transfer, which could negatively effect the performance.\n\nRefactor CryptoTransferTransactionSupplier to support a token only transfer, while still leaving support for crypto only transfers and both transfers..\n\nSpecial notes for your reviewer:\nChecklist\n\n Documentation added\n Tests updated", "createdAt": "2020-12-02T17:16:53Z", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307", "merged": true, "mergeCommit": {"oid": "9b12200898715cf35c4eb07969ab67416d6f752f"}, "closed": true, "closedAt": "2020-12-02T21:33:05Z", "author": {"login": "ijungmann"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiRyPDgH2gAyNTMxMTY3MzU2OmY3NGRjOWJlYmJkYjU2MzI3ZDg4Mjg4Nzc5MzM5YWQyZDRhM2MxYWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiVeMngFqTU0MzI1MzcwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f74dc9bebbdb56327d88288779339ad2d4a3c1af", "author": {"user": {"login": "ijungmann", "name": "Ian Jungmann"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/f74dc9bebbdb56327d88288779339ad2d4a3c1af", "committedDate": "2020-12-02T17:13:55Z", "message": "Refactor CryptoTransferTransactionSupplier to only add crypto or token transfers\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDczOTQx", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#pullrequestreview-543073941", "createdAt": "2020-12-02T17:29:42Z", "commit": {"oid": "f74dc9bebbdb56327d88288779339ad2d4a3c1af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNzoyOTo0MlrOH9mK2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNzoyOTo0MlrOH9mK2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM1MDU1NA==", "bodyText": "nit: perhaps if it's token transfer, the memo should say so?", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#discussion_r534350554", "createdAt": "2020-12-02T17:29:42Z", "author": {"login": "xin-hedera"}, "path": "hedera-mirror-datagenerator/src/main/java/com/hedera/datagenerator/sdk/supplier/account/CryptoTransferTransactionSupplier.java", "diffHunk": "@@ -55,12 +55,15 @@ public TransferTransaction get() {\n         AccountId senderId = AccountId.fromString(senderAccountId);\n \n         TransferTransaction transferTransaction = new TransferTransaction()\n-                .addHbarTransfer(recipientId, amount)\n-                .addHbarTransfer(senderId, Math.negateExact(amount))\n                 .setMaxTransactionFee(maxTransactionFee)\n                 .setTransactionMemo(Utility.getMemo(\"Mirror node created test crypto transfer\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f74dc9bebbdb56327d88288779339ad2d4a3c1af"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDc0Njc0", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#pullrequestreview-543074674", "createdAt": "2020-12-02T17:30:30Z", "commit": {"oid": "f74dc9bebbdb56327d88288779339ad2d4a3c1af"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f58f69bb0d2dc6f9bc031d9c9c393c0582dd13a8", "author": {"user": {"login": "ijungmann", "name": "Ian Jungmann"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/f58f69bb0d2dc6f9bc031d9c9c393c0582dd13a8", "committedDate": "2020-12-02T17:31:33Z", "message": "Change memo based on token or crypto transfer\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDk1MDM0", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#pullrequestreview-543095034", "createdAt": "2020-12-02T17:54:23Z", "commit": {"oid": "f58f69bb0d2dc6f9bc031d9c9c393c0582dd13a8"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjAxMTM0", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#pullrequestreview-543201134", "createdAt": "2020-12-02T20:14:22Z", "commit": {"oid": "f58f69bb0d2dc6f9bc031d9c9c393c0582dd13a8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMDoxNDoyMlrOH9sY_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMDoxNDoyMlrOH9sY_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ1MjQ3OQ==", "bodyText": "Why else vs the ability to do both if so configured?", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#discussion_r534452479", "createdAt": "2020-12-02T20:14:22Z", "author": {"login": "Nana-EC"}, "path": "hedera-mirror-datagenerator/src/main/java/com/hedera/datagenerator/sdk/supplier/account/CryptoTransferTransactionSupplier.java", "diffHunk": "@@ -55,16 +55,20 @@ public TransferTransaction get() {\n         AccountId senderId = AccountId.fromString(senderAccountId);\n \n         TransferTransaction transferTransaction = new TransferTransaction()\n-                .addHbarTransfer(recipientId, amount)\n-                .addHbarTransfer(senderId, Math.negateExact(amount))\n-                .setMaxTransactionFee(maxTransactionFee)\n-                .setTransactionMemo(Utility.getMemo(\"Mirror node created test crypto transfer\"));\n+                .setMaxTransactionFee(maxTransactionFee);\n \n-        if (StringUtils.isNotBlank(tokenId)) {\n+        //Only add an Hbar transfer or a token transfer, never both\n+        if (StringUtils.isBlank(tokenId)) {\n+            transferTransaction\n+                    .addHbarTransfer(recipientId, amount)\n+                    .addHbarTransfer(senderId, Math.negateExact(amount))\n+                    .setTransactionMemo(Utility.getMemo(\"Mirror node created test crypto transfer\"));\n+        } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f58f69bb0d2dc6f9bc031d9c9c393c0582dd13a8"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjAyMzcz", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#pullrequestreview-543202373", "createdAt": "2020-12-02T20:16:16Z", "commit": {"oid": "f58f69bb0d2dc6f9bc031d9c9c393c0582dd13a8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bffc85e6c7a201b9131b7a67dc372bfe34a22a2", "author": {"user": {"login": "ijungmann", "name": "Ian Jungmann"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/1bffc85e6c7a201b9131b7a67dc372bfe34a22a2", "committedDate": "2020-12-02T21:01:47Z", "message": "Add support for BOTH\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjM2Nzg5", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#pullrequestreview-543236789", "createdAt": "2020-12-02T21:06:31Z", "commit": {"oid": "1bffc85e6c7a201b9131b7a67dc372bfe34a22a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTowNjozMVrOH9uJmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTowNjozMVrOH9uJmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MTMwNw==", "bodyText": "@NotNull", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#discussion_r534481307", "createdAt": "2020-12-02T21:06:31Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-datagenerator/src/main/java/com/hedera/datagenerator/sdk/supplier/account/CryptoTransferTransactionSupplier.java", "diffHunk": "@@ -48,24 +47,52 @@\n \n     private String tokenId;\n \n+    private TransferType transferType = TransferType.CRYPTO;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1bffc85e6c7a201b9131b7a67dc372bfe34a22a2"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a0243465c7986440a68fad8fde7e9036079c232", "author": {"user": {"login": "ijungmann", "name": "Ian Jungmann"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/2a0243465c7986440a68fad8fde7e9036079c232", "committedDate": "2020-12-02T21:07:26Z", "message": "Add @NotNull\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjM3OTE1", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#pullrequestreview-543237915", "createdAt": "2020-12-02T21:08:16Z", "commit": {"oid": "2a0243465c7986440a68fad8fde7e9036079c232"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjUzNzAw", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1307#pullrequestreview-543253700", "createdAt": "2020-12-02T21:31:39Z", "commit": {"oid": "2a0243465c7986440a68fad8fde7e9036079c232"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3386, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}