{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NzUzNDYx", "number": 944, "title": "Continuously deploy to development", "bodyText": "Detailed description:\n\nAdd GitHub Action to build and push Docker images on every push to master and update deploy branch\nAdd GitHub Action to publish Helm charts to a GitHub Pages-based chart repository on every tag\nAdd GitHub Action to start a Kubernetes cluster on every PR, install Helm chart and run tests\nFix hardcoded StorageClass not allowing install in some Kubernetes clusters like k3s\nFix REST Dockerfile to not write files as root, remove pointless multi-stage and don't use npm install as it doesn't use package-lock.json\n\nWhich issue(s) this PR fixes:\nFixes #652\nSpecial notes for your reviewer:\n\nDocker build for tags is still handled by CircleCI for now.\nGitHub Actions can run TestContainers directly. No need for external containers like CircleCI.\n\nChecklist\n\n Documentation added\n Tests updated", "createdAt": "2020-08-10T22:01:36Z", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/944", "merged": true, "mergeCommit": {"oid": "a0f81959c11ac4472c9693db61dbbaad37572d0d"}, "closed": true, "closedAt": "2020-08-11T18:58:05Z", "author": {"login": "steven-sheehy"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9pVLRAH2gAyNDY1NzUzNDYxOjE4ZmU5M2NjMTkwNzA4NzYwNmJmZGQ2ODNlNmY5YmE5YTYyOWFiOGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc937YVAFqTQ2NTE0MDE4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "18fe93cc1907087606bfdd683e6f9ba9a629ab8f", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/18fe93cc1907087606bfdd683e6f9ba9a629ab8f", "committedDate": "2020-08-10T21:44:42Z", "message": "Continuously deploy to development\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5ec5eab174c4e8f06006f2af7c2b8fd130c0fa3", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/c5ec5eab174c4e8f06006f2af7c2b8fd130c0fa3", "committedDate": "2020-08-10T22:06:48Z", "message": "Update documentation with new Helm chart repo\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NjQ5MTA0", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/944#pullrequestreview-464649104", "createdAt": "2020-08-10T23:17:00Z", "commit": {"oid": "c5ec5eab174c4e8f06006f2af7c2b8fd130c0fa3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMzoxNzowMFrOG-i6OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMzoxNzowMFrOG-i6OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODIzNjg1Nw==", "bodyText": "Q: Is this the load balancer IP. Should it be configureable?", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/944#discussion_r468236857", "createdAt": "2020-08-10T23:17:00Z", "author": {"login": "Nana-EC"}, "path": "hedera-mirror-rest/Dockerfile", "diffHunk": "@@ -1,11 +1,16 @@\n-FROM node:13.12.0-alpine3.11 as build\n-WORKDIR /usr/src/app\n-COPY package*.json ./\n-RUN npm install --no-package-lock\n+FROM node:14.7.0-alpine3.12\n+LABEL maintainer=\"mirrornode@hedera.com\"\n \n-FROM node:13.12.0-alpine3.11\n-WORKDIR /usr/src/app\n-COPY --from=build /usr/src/app .\n-COPY . ./\n+# Setup\n+WORKDIR /home/node/app/\n+RUN chown -R node:node .\n+COPY --chown=node:node . ./\n USER node\n-CMD npm start --no-update-notifier\n+\n+# Build\n+ENV NODE_ENV production\n+RUN npm ci --only=production && npm cache clean --force --loglevel=error\n+\n+# Run\n+EXPOSE 5551", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5ec5eab174c4e8f06006f2af7c2b8fd130c0fa3"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "745249350e138967482fc6190319e7179b9eef75", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/745249350e138967482fc6190319e7179b9eef75", "committedDate": "2020-08-10T23:56:25Z", "message": "Remove unused env variable\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NjYzOTIx", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/944#pullrequestreview-464663921", "createdAt": "2020-08-11T00:01:35Z", "commit": {"oid": "745249350e138967482fc6190319e7179b9eef75"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDowMTozNlrOG-jv7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDowMTozNlrOG-jv7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI1MDYwNw==", "bodyText": "nit: missing an s\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      command: ./mvnw ${MAVEN_CLI_OPTS} deploy -DskipTest\n          \n          \n            \n                      command: ./mvnw ${MAVEN_CLI_OPTS} deploy -DskipTests", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/944#discussion_r468250607", "createdAt": "2020-08-11T00:01:36Z", "author": {"login": "Nana-EC"}, "path": ".circleci/config.yml", "diffHunk": "@@ -352,7 +352,7 @@ jobs:\n       - restore_maven_cache\n       - run:\n           name: Running maven deploy\n-          command: ./mvnw ${MAVEN_CLI_OPTS} deploy -DskipTests ${DOCKER_TAG_OVERRIDE}\n+          command: ./mvnw ${MAVEN_CLI_OPTS} deploy -DskipTest", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "745249350e138967482fc6190319e7179b9eef75"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20c86dae1da4f59ef38963bf84d92c76bce5611f", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/20c86dae1da4f59ef38963bf84d92c76bce5611f", "committedDate": "2020-08-11T04:16:07Z", "message": "Fix circle config\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f801fe75e0f67750ac0685bcc16be0ab69bb376", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/4f801fe75e0f67750ac0685bcc16be0ab69bb376", "committedDate": "2020-08-11T14:26:56Z", "message": "Change back to master tag\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MTQwMTgy", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/944#pullrequestreview-465140182", "createdAt": "2020-08-11T14:45:06Z", "commit": {"oid": "4f801fe75e0f67750ac0685bcc16be0ab69bb376"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3040, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}