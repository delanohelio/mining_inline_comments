{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2ODUwNDk2", "number": 1234, "title": "Upgrade Spring Boot to 2.3.5 to fix pgpool connection issue", "bodyText": "Detailed description:\npostgresql jdbc driver 42.2.18 fixes the gssEncMode bug which causes pgpool to shutdown the connections\nWhich issue(s) this PR fixes:\nFixes #\nSpecial notes for your reviewer:\nspring-boot 2.3.4 RELEASE brings in postgresql jdbc driver 42.2.16 which by default set gssEncMode to prefer, so the postgresql driver will send out the gssEncMode after connection is established. The pgpool deployed by postgresql-ha charts doesn't understand gssEncMode command so it just shuts down the connection, this in turn causes importer / grpc to fail to connect to the postgresql database. 42.2.18 fixes the issue by default gssEncMode to allow which will \"connect in plain text then if the server requests it will switch to encrypted mode\".\nupdate: spring-boot 2.3.5.RELEASE has upgraded postgresql jdbc driver to 42.2.18\npgjdbc/pgjdbc#1920\nhttps://jdbc.postgresql.org/documentation/head/connect.html#connection-parameters\nChecklist\n\n Documentation added\n Tests updated", "createdAt": "2020-11-06T16:24:36Z", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1234", "merged": true, "mergeCommit": {"oid": "230eb4bb63a2d5c75a518b2addb416c77a41abaf"}, "closed": true, "closedAt": "2020-11-06T17:21:17Z", "author": {"login": "xin-hedera"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZ5YO8AH2gAyNTE2ODUwNDk2OjQ2Y2NkYjA1YzU5YmNmZGM5YzM0ZDFlMDk2NGE4NTliNGU1MjdiOTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZ6KpgAFqTUyNTM0MTY0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "46ccdb05c59bcfdc9c34d1e0964a859b4e527b94", "author": {"user": {"login": "xin-hedera", "name": "Xin Li"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/46ccdb05c59bcfdc9c34d1e0964a859b4e527b94", "committedDate": "2020-11-06T16:16:24Z", "message": "upgrade postgresql jdbc driver to 42.2.18\n\nSigned-off-by: Xin Li <xin.li@swirlds.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MzIyMjcw", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1234#pullrequestreview-525322270", "createdAt": "2020-11-06T16:46:31Z", "commit": {"oid": "46ccdb05c59bcfdc9c34d1e0964a859b4e527b94"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNjo0NjozMVrOHu1jhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNjo0NjozMVrOHu1jhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3Mzk5MA==", "bodyText": "Please undo all changes and bump spring-boot to 3.2.5.RELEASE which contains the updated postgresql version. It's always better to let Spring manage our dependencies for us if possible.", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1234#discussion_r518873990", "createdAt": "2020-11-06T16:46:31Z", "author": {"login": "steven-sheehy"}, "path": "pom.xml", "diffHunk": "@@ -70,6 +70,7 @@\n         <jmeter.version>5.3</jmeter.version>\n         <micrometer-jvm-extras.version>0.2.0</micrometer-jvm-extras.version>\n         <msgpack.version>0.8.21</msgpack.version>\n+        <postgresql.version>42.2.18</postgresql.version> <!-- This version fixes the gssEncMode bug: https://github.com/pgjdbc/pgjdbc/pull/1920 -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46ccdb05c59bcfdc9c34d1e0964a859b4e527b94"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MzM0ODY0", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1234#pullrequestreview-525334864", "createdAt": "2020-11-06T17:02:22Z", "commit": {"oid": "362773267d6ca55120ddbc3d9d1d32ea9b83e036"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f81cdb573eaaccedd4d1505a7ed83369d05f37e", "author": {"user": {"login": "xin-hedera", "name": "Xin Li"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/5f81cdb573eaaccedd4d1505a7ed83369d05f37e", "committedDate": "2020-11-06T17:07:33Z", "message": "upgrade to spring-boot 2.3.5.RELEASE which brings in postgresql jdbc driver 42.2.18 with the gssEncMode fix\n\nSigned-off-by: Xin Li <xin.li@swirlds.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "362773267d6ca55120ddbc3d9d1d32ea9b83e036", "author": {"user": {"login": "xin-hedera", "name": "Xin Li"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/362773267d6ca55120ddbc3d9d1d32ea9b83e036", "committedDate": "2020-11-06T16:59:26Z", "message": "upgrade to spring-boot 2.3.5.RELEASE which brings in postgresql jdbc driver 42.2.18 with the gssEncMode fix\n\nSigned-off-by: Xin Li <xin.li@swirlds.com>"}, "afterCommit": {"oid": "5f81cdb573eaaccedd4d1505a7ed83369d05f37e", "author": {"user": {"login": "xin-hedera", "name": "Xin Li"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/5f81cdb573eaaccedd4d1505a7ed83369d05f37e", "committedDate": "2020-11-06T17:07:33Z", "message": "upgrade to spring-boot 2.3.5.RELEASE which brings in postgresql jdbc driver 42.2.18 with the gssEncMode fix\n\nSigned-off-by: Xin Li <xin.li@swirlds.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MzQxNjQ2", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1234#pullrequestreview-525341646", "createdAt": "2020-11-06T17:11:28Z", "commit": {"oid": "5f81cdb573eaaccedd4d1505a7ed83369d05f37e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3488, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}