{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4OTM3MzQw", "number": 764, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQxODozMDozOVrOD9G0pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQxOTowMzo0N1rOD9G8ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NDAxNTEwOnYy", "diffSide": "RIGHT", "path": "hedera-mirror-importer/src/test/java/com/hedera/mirror/importer/parser/record/pubsub/PubSubRecordItemListenerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQxODozMDo0MFrOGWb5Ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQyMjo0NzowNFrOGWdDLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE3ODg3NQ==", "bodyText": "nit: You're using Assertj, but you're not really using it:\nassertThat(headers).describedAs(\"Headers contain consensus timestamp\")\n  .hasSize(3)\n  .containsEntry(\"consensusTimestamp\", CONSENSUS_TIMESTAMP);", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/764#discussion_r426178875", "createdAt": "2020-05-16T18:30:40Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/test/java/com/hedera/mirror/importer/parser/record/pubsub/PubSubRecordItemListenerTest.java", "diffHunk": "@@ -213,6 +214,9 @@ private void assertPubSubMessage(EntityId expectedEntity, Transaction expectedTr\n         } else {\n             assertThat(actual.getNonFeeTransfers()).isEqualTo(expectedNonFeeTransfers);\n         }\n+        MessageHeaders headers = argument.getValue().getHeaders();\n+        assertThat(headers.size()).isEqualTo(3); // +2 are default attributes 'id' and 'timestamp' (publish)\n+        assertThat(headers.get(\"consensusTimestamp\")).isEqualTo(CONSENSUS_TIMESTAMP);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a99026fda77e2b9d74d28a76c08657d9f526e78b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE5NzgwNg==", "bodyText": "done.", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/764#discussion_r426197806", "createdAt": "2020-05-16T22:47:04Z", "author": {"login": "apeksharma"}, "path": "hedera-mirror-importer/src/test/java/com/hedera/mirror/importer/parser/record/pubsub/PubSubRecordItemListenerTest.java", "diffHunk": "@@ -213,6 +214,9 @@ private void assertPubSubMessage(EntityId expectedEntity, Transaction expectedTr\n         } else {\n             assertThat(actual.getNonFeeTransfers()).isEqualTo(expectedNonFeeTransfers);\n         }\n+        MessageHeaders headers = argument.getValue().getHeaders();\n+        assertThat(headers.size()).isEqualTo(3); // +2 are default attributes 'id' and 'timestamp' (publish)\n+        assertThat(headers.get(\"consensusTimestamp\")).isEqualTo(CONSENSUS_TIMESTAMP);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE3ODg3NQ=="}, "originalCommit": {"oid": "a99026fda77e2b9d74d28a76c08657d9f526e78b"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NDAzNTMwOnYy", "diffSide": "RIGHT", "path": "hedera-mirror-importer/src/test/java/com/hedera/mirror/importer/parser/record/pubsub/PubSubRecordParserTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQxOTowMzo0N1rOGWcDVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQyMjo0Nzo1NFrOGWdDbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE4MTQ2Mw==", "bodyText": "This is quite convoluted. Would recommend converting them both to domain message:\nList<PubSubMessage> expected = null;\nList<com.google.pubsub.v1.PubsubMessage> actual = null;\n        assertThat(actual).describedAs(\"blah\")\n                .hasSize(expected.size())\n                .zipSatisfy(expected, (a, e) -> {\n                    assertThat(a.getAttributesMap()).containsEntry(\"consensusTimestamp\", e.getConsensusTimestamp().toString());\n                    assertThat(convert(a.getData())).isEqualTo(e);\n                });", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/764#discussion_r426181463", "createdAt": "2020-05-16T19:03:47Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/test/java/com/hedera/mirror/importer/parser/record/pubsub/PubSubRecordParserTest.java", "diffHunk": "@@ -73,6 +78,26 @@ public void testPubSubExporter() throws Exception {\n         // then\n         List<String> expectedMessages =\n                 Files.readAllLines(testResourcesPath.resolve(\"pubsub-messages.txt\"));\n-        assertThat(getAllMessages(NUM_TXNS)).isEqualTo(expectedMessages);\n+        List<PubsubMessage> pubsubMessages = getAllMessages(NUM_TXNS);\n+        List<String> messages = pubsubMessages.stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a99026fda77e2b9d74d28a76c08657d9f526e78b"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE5Nzg3MQ==", "bodyText": "done.\nwant to directly test json, added comment to code too.", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/764#discussion_r426197871", "createdAt": "2020-05-16T22:47:54Z", "author": {"login": "apeksharma"}, "path": "hedera-mirror-importer/src/test/java/com/hedera/mirror/importer/parser/record/pubsub/PubSubRecordParserTest.java", "diffHunk": "@@ -73,6 +78,26 @@ public void testPubSubExporter() throws Exception {\n         // then\n         List<String> expectedMessages =\n                 Files.readAllLines(testResourcesPath.resolve(\"pubsub-messages.txt\"));\n-        assertThat(getAllMessages(NUM_TXNS)).isEqualTo(expectedMessages);\n+        List<PubsubMessage> pubsubMessages = getAllMessages(NUM_TXNS);\n+        List<String> messages = pubsubMessages.stream()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE4MTQ2Mw=="}, "originalCommit": {"oid": "a99026fda77e2b9d74d28a76c08657d9f526e78b"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1042, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}