{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1MDk2Nzcx", "number": 994, "title": "Fixing acceptance tests so that the jar is not always built (#967)", "bodyText": "Signed-off-by: Ian Jungmann ian.jungmann@hedera.com\nDetailed description:\nWhile running the acceptance test suite, the package/jar phase was executing and causing slowdown and occasional failures, when in reality the jar was not necessary at all.\nThis was due to specifying the integration-test phase when running these tests.  Because the tests are being run with the surefire plugin, which by default runs in the \"test\" phase, and because the default_test execution was not being overridden, the tests were being run in the \"test\" phase, and again in the \"integration-test\" phase.  In between these two phases in the \"package\" phase, and because Maven executes every phase up until the last phase specified (in this case \"integration-test\"), it will create the jar.\nBecause these tests do not actually depend on the jar being created or any environment being set up by Maven to run, in the scope of this submodule these should run under the \"test\" phase, and not the \"integration-test\" phase.  See more on the default lifecycle here\nWhich issue(s) this PR fixes:\nFixes #967\nSpecial notes for your reviewer:\nHere is an example showing that the acceptance tests were attempting to run twice with the command provided in the ticket, with the package phase running between the \"test\" phase and the \"integration-test\" phase.  I've omitted test logs.\n[INFO] --- maven-surefire-plugin:3.0.0-M5:test (default-test) @ hedera-mirror-test ---\n[INFO] Results:\n[INFO]\n[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0\n[INFO]\n[INFO]\n[INFO] --- maven-jar-plugin:3.2.0:jar (default-jar) @ hedera-mirror-test ---\n[INFO] Building jar: /Users/ianjungmann/dev/hedera-mirror-node/hedera-mirror-test/target/hedera-mirror-test-0.18.0-rc1.jar\n[INFO]\n[INFO] --- maven-surefire-plugin:3.0.0-M5:test (this-is-my-integration-test-phase) @ hedera-mirror-test ---\n[INFO] Skipping execution of surefire because it has already been run for this configuration\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\nChecklist\n\n Documentation added\n Tests updated", "createdAt": "2020-08-28T05:20:51Z", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/994", "merged": true, "mergeCommit": {"oid": "295f6c3e728b39ca53f10905c4cf4ae3bcf2f4d2"}, "closed": true, "closedAt": "2020-08-31T18:05:09Z", "author": {"login": "ijungmann"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDNox7gH2gAyNDc1MDk2NzcxOjY3MjMyNmI3ZTcyYzE4N2EyYjg0ZjdiOGFjNmUxZTFkMzllNDlkMjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDddL4AFqTQ3ODA2ODc5Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "672326b7e72c187a2b84f7b8ac6e1e1d39e49d27", "author": {"user": {"login": "ijungmann", "name": "Ian Jungmann"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/672326b7e72c187a2b84f7b8ac6e1e1d39e49d27", "committedDate": "2020-08-28T04:52:19Z", "message": "Fixing acceptance tests so that the jar is not always built (#967)\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3ODk1ODgz", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/994#pullrequestreview-477895883", "createdAt": "2020-08-28T17:11:48Z", "commit": {"oid": "672326b7e72c187a2b84f7b8ac6e1e1d39e49d27"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNzoxMTo0OFrOHJOSag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNzoxMTo0OFrOHJOSag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQzMzMyMg==", "bodyText": "Not sure I agree with the approach. Regardless of packaging, these are considered integration tests and they make sense in this phase. Also, this is a breaking change for ops. It would be more appropriate that the pom.xml switched from jar to pom packaging and surefire plugin is set to skipped.", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/994#discussion_r479433322", "createdAt": "2020-08-28T17:11:48Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-test/pom.xml", "diffHunk": "@@ -201,14 +201,6 @@\n                                 </log4j.configurationFile>\n                             </systemPropertyVariables>\n                         </configuration>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "672326b7e72c187a2b84f7b8ac6e1e1d39e49d27"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9ccb549a1f6e8ea0864f5906342eb100b0a088c", "author": {"user": {"login": "ijungmann", "name": "Ian Jungmann"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/d9ccb549a1f6e8ea0864f5906342eb100b0a088c", "committedDate": "2020-08-28T21:06:56Z", "message": "Revert \"Fixing acceptance tests so that the jar is not always built (#967)\"\n\nReverting changes for first attempt as it's easier to restart from the baseline than undo changes\n\nThis reverts commit 672326b7e72c187a2b84f7b8ac6e1e1d39e49d27.\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdae1ecbb9b7c5950cb9ebd10dd12a33007fa599", "author": {"user": {"login": "ijungmann", "name": "Ian Jungmann"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/cdae1ecbb9b7c5950cb9ebd10dd12a33007fa599", "committedDate": "2020-08-28T21:17:05Z", "message": "Forcing jar to not build and surefire to run as part of integratio-test phase during acceptance tests\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MDY4Nzkz", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/994#pullrequestreview-478068793", "createdAt": "2020-08-28T23:18:08Z", "commit": {"oid": "cdae1ecbb9b7c5950cb9ebd10dd12a33007fa599"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3651, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}