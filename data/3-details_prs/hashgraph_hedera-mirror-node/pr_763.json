{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4NzgyMjU2", "number": 763, "title": "Set default topicRunningHashV2AddedTimestamp based on network", "bodyText": "Detailed description:\nSigned-off-by: Apekshit Sharma apekshit.sharma@hedera.com\nWhich issue(s) this PR fixes:\nFixes #745\nSpecial notes for your reviewer:\nDidn't add estimated time for mainnet since it could be very risky for partners.\nNext release (after 0.12.0 around 20th) would be 2 weeks later.  After the release goes out and mainnet is updated, we don't know who may update to 0.12.0 in next 2 weeks. In so, they'd end up with corrupt data in db and know way to know about it.\nChecklist\n\n Documentation added\n Tests updated", "createdAt": "2020-05-15T20:02:31Z", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/763", "merged": true, "mergeCommit": {"oid": "31353e75d7259a3d3cedf2a21c81c81d1db67bb8"}, "closed": true, "closedAt": "2020-05-16T22:17:49Z", "author": {"login": "apeksharma"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchnlZuAH2gAyNDE4NzgyMjU2OjBmMWY3YzMzODgzMjIzMGYzMDVjNjgwOTQ0YzllMDZlYjczZGJmNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABch2YaHgFqTQxMzA3NTQ3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0f1f7c338832230f305c680944c9e06eb73dbf79", "author": {"user": {"login": "apeksharma", "name": "Apekshit Sharma"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/0f1f7c338832230f305c680944c9e06eb73dbf79", "committedDate": "2020-05-15T19:52:44Z", "message": "Set default topicRunningHashV2AddedTimestamp based on network\n\nSigned-off-by: Apekshit Sharma <apekshit.sharma@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyOTUzODQ3", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/763#pullrequestreview-412953847", "createdAt": "2020-05-15T20:41:09Z", "commit": {"oid": "0f1f7c338832230f305c680944c9e06eb73dbf79"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQyMDo0MTowOVrOGWTOTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQyMDo0MTowOVrOGWTOTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAzNjgxNQ==", "bodyText": "I would prefer we hardcode the mainnet time for mainnet deploy that is currently scheduled on status.hedera.com for Thursday, May 21st, at 17:00 UTC. We can always update it later if it changes.\nWe wanted it to fail fast on deploy to mainnet, but the version that we will actually deploy to mainnet that runs this patch will be 0.10.1 anyway and that will fail fast if this is not populated. So we are fine with a possibly inaccurate timestamp for mainnet for 0.12.x.", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/763#discussion_r426036815", "createdAt": "2020-05-15T20:41:09Z", "author": {"login": "steven-sheehy"}, "path": "hedera-mirror-importer/src/main/java/com/hedera/mirror/importer/config/MirrorImporterConfiguration.java", "diffHunk": "@@ -103,6 +110,25 @@ AwsCredentialsProvider awsCredentialsProvider(CommonDownloaderProperties downloa\n         return awsCredentials;\n     }\n \n+    @Bean\n+    FlywayConfigurationCustomizer flywayConfigurationCustomizer() {\n+        return configuration -> {\n+            Long timestamp = mirrorProperties.getTopicRunningHashV2AddedTimestamp();\n+            if (timestamp == null) {\n+                if (mirrorProperties.getNetwork() == HederaNetwork.MAINNET) {\n+                    throw new IllegalArgumentException(\"topicRunningHashV2AddedTimestamp is unknown for MAINNET. To \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f1f7c338832230f305c680944c9e06eb73dbf79"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1449d5bfdf17e7a9ec1d684cdd4d6e188ac0669", "author": {"user": {"login": "apeksharma", "name": "Apekshit Sharma"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/b1449d5bfdf17e7a9ec1d684cdd4d6e188ac0669", "committedDate": "2020-05-15T21:18:24Z", "message": "hard code mainnet time\n\nSigned-off-by: Apekshit Sharma <apekshit.sharma@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyOTc1NzA4", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/763#pullrequestreview-412975708", "createdAt": "2020-05-15T21:21:41Z", "commit": {"oid": "b1449d5bfdf17e7a9ec1d684cdd4d6e188ac0669"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyOTg4ODUz", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/763#pullrequestreview-412988853", "createdAt": "2020-05-15T21:53:28Z", "commit": {"oid": "b1449d5bfdf17e7a9ec1d684cdd4d6e188ac0669"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQyMTo1MzoyOFrOGWU2Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQyMTo1MzoyOFrOGWU2Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA2MzQyNw==", "bodyText": "Now inaccurate after last commit. Now that we're auto-filling it, this can probably be greatly simplified. I like the old description more. You can just add a note that it's automatically populated via code based upon network and to use this setting is to override it.", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/763#discussion_r426063427", "createdAt": "2020-05-15T21:53:28Z", "author": {"login": "steven-sheehy"}, "path": "docs/configuration.md", "diffHunk": "@@ -71,7 +71,7 @@ value, it is recommended to only populate overridden properties in the custom `a\n | `hedera.mirror.importer.parser.record.entity.persist.transactionBytes`      | false                   | Persist raw transaction bytes to the database                                                  |\n | `hedera.mirror.importer.parser.record.entity.sql.batchSize`                 | 100                     | When inserting transactions into db, executeBatches() is called every these many transactions  |\n | `hedera.mirror.importer.parser.record.pubsub.topicName`                     |                         | Pubsub topic to publish transactions to                                                        |\n-| `hedera.mirror.importer.topicRunningHashV2AddedTimestamp`            |                         | The Unix timestamp when topic message running hash v2 was introduced                           |\n+| `hedera.mirror.importer.topicRunningHashV2AddedTimestamp`            | If network is `MAINNET`, then null, otherwise 1588706343553042000  | Used for setting running hash version of topic messages when migrating from v1 to v2. Messages with consensusTimestamp >= this value will be marked version 2, and those less will be marked version 1 |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1449d5bfdf17e7a9ec1d684cdd4d6e188ac0669"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9382e1d5e165b0ee7b75fc5516279786131d494b", "author": {"user": {"login": "apeksharma", "name": "Apekshit Sharma"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/9382e1d5e165b0ee7b75fc5516279786131d494b", "committedDate": "2020-05-16T09:07:17Z", "message": "address review\n\nSigned-off-by: Apekshit Sharma <apekshit.sharma@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMDc1NDc0", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/763#pullrequestreview-413075474", "createdAt": "2020-05-16T13:07:07Z", "commit": {"oid": "9382e1d5e165b0ee7b75fc5516279786131d494b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3143, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}