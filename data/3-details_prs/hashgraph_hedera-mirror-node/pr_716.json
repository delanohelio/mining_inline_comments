{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5NTk1OTkz", "number": 716, "title": "Fixes to run in GKE", "bodyText": "Detailed description:\n\nAdd debug logs to PostgreSQL startup script (not database logs)\nAdd pg_stat_statements to PostgreSQL (See #427)\nAdd REST ServiceMonitor to collect metrics\nAdd ability for Traefik to run as non-root (upstream change)\nAdd Traefik to critical priority class (upstream change)\nRemove custom Traefik ServiceMonitor in favor of inline PodMonitor\nRemove importer Service and ServiceMonitor in favor of PodMonitor\nFix various dashboards not working\nFix sub-chart enabling ServiceMonitor by default\nBump chart dependencies to latest\n\nWhich issue(s) this PR fixes:\nFixes #669\nFixes #691\nSpecial notes for your reviewer:\nChecklist\n\n Documentation added\n Tests updated", "createdAt": "2020-04-27T16:04:27Z", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/716", "merged": true, "mergeCommit": {"oid": "7401b11a68439587f995f8f82d8353564464c3d9"}, "closed": true, "closedAt": "2020-04-28T15:57:42Z", "author": {"login": "steven-sheehy"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbxGYEgH2gAyNDA5NTk1OTkzOjgyNmE5N2JiNDUwY2UwMGZhNDA2MTY0ZGY0YTRhNmQzYmJiOWNjMjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccGAdxAFqTQwMTk4MDU2Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "826a97bb450ce00fa406164df4a4a6d3bbb9cc20", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/826a97bb450ce00fa406164df4a4a6d3bbb9cc20", "committedDate": "2020-04-27T15:34:21Z", "message": "Fixes to run in GKE\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxODgwNzg4", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/716#pullrequestreview-401880788", "createdAt": "2020-04-28T14:16:28Z", "commit": {"oid": "826a97bb450ce00fa406164df4a4a6d3bbb9cc20"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNDoxNjoyOVrOGNWSBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNDoyMzo1N1rOGNWpSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY0OTczMg==", "bodyText": "Perhaps it'd be better to have these auto-generated rather than being insecure by default?", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/716#discussion_r416649732", "createdAt": "2020-04-28T14:16:29Z", "author": {"login": "beeradb"}, "path": "charts/hedera-mirror-rest/values.yaml", "diffHunk": "@@ -10,7 +10,14 @@ affinity:\n \n annotations: {}\n \n-config: {}\n+config:\n+  hedera:\n+    mirror:\n+      rest:\n+        metrics:\n+          config:\n+            password: password\n+            username: metrics", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "826a97bb450ce00fa406164df4a4a6d3bbb9cc20"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjY1NTY5MQ==", "bodyText": "Maybe it makes sense to provide methods for ensuring the importer is operating correctly here?\nJust spitballing, but maybe one or more of the following?\n\nHow to check logs to ensure it's configured properly and is actively importing.\nWhere to look for metrics / dashboards so you can get an idea that it's operating as expected\nInfo on what bucket it is configured to use", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/716#discussion_r416655691", "createdAt": "2020-04-28T14:23:57Z", "author": {"login": "beeradb"}, "path": "charts/hedera-mirror-importer/templates/NOTES.txt", "diffHunk": "@@ -1,20 +1 @@\n-The Hedera Mirror Importer is mainly a background service. You can get the monitoring URL by running these commands:\n-\n-{{- if contains \"NodePort\" .Values.service.type }}\n-\n-  export NODE_PORT=$(kubectl get --namespace {{ include \"hedera-mirror-importer.namespace\" . }} -o jsonpath=\"{.spec.ports[0].nodePort}\" services {{ include \"hedera-mirror-importer.fullname\" . }})\n-  export NODE_IP=$(kubectl get nodes --namespace {{ include \"hedera-mirror-importer.namespace\" . }} -o jsonpath=\"{.items[0].status.addresses[0].address}\")\n-  echo http://$NODE_IP:$NODE_PORT\n-\n-{{- else if contains \"LoadBalancer\" .Values.service.type }}\n-\n-  export SERVICE_IP=$(kubectl get svc --namespace {{ include \"hedera-mirror-importer.namespace\" . }} {{ include \"hedera-mirror-importer.fullname\" . }} --template \"{{\"{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}\"}}\")\n-  echo http://$SERVICE_IP:{{ .Values.service.port }}\n-\n-{{- else if contains \"ClusterIP\" .Values.service.type }}\n-\n-  export POD_NAME=$(kubectl get pods --namespace {{ include \"hedera-mirror-importer.namespace\" . }} -l \"app.kubernetes.io/name={{ include \"hedera-mirror-importer.name\" . }},app.kubernetes.io/instance={{ .Release.Name }}\" -o jsonpath=\"{.items[0].metadata.name}\")\n-  echo \"Visit http://127.0.0.1:8080 to use your application\"\n-  kubectl --namespace {{ include \"hedera-mirror-importer.namespace\" . }} port-forward $POD_NAME 8080:80\n-\n-{{- end }}\n+The Hedera Mirror Importer is installed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "826a97bb450ce00fa406164df4a4a6d3bbb9cc20"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxOTU3MTg2", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/716#pullrequestreview-401957186", "createdAt": "2020-04-28T15:31:52Z", "commit": {"oid": "826a97bb450ce00fa406164df4a4a6d3bbb9cc20"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "554c68b9462f34e2b64e946f2671c73db6224901", "author": {"user": {"login": "steven-sheehy", "name": "Steven Sheehy"}}, "url": "https://github.com/hashgraph/hedera-mirror-node/commit/554c68b9462f34e2b64e946f2671c73db6224901", "committedDate": "2020-04-28T15:40:15Z", "message": "Review feedback\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxOTgwNTY2", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/716#pullrequestreview-401980566", "createdAt": "2020-04-28T15:55:54Z", "commit": {"oid": "554c68b9462f34e2b64e946f2671c73db6224901"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3098, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}