{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzOTUyNjM3", "number": 3995, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMjoxOToyMlrOEt93Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMjoyMzoxNFrOEt983A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NjM0ODgyOnYy", "diffSide": "RIGHT", "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/NacosExecuteTaskExecuteEngine.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMjoxOToyMlrOHiE89Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMjoxOToyMlrOHiE89Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ5NDc3Mw==", "bodyText": "Can it be dynamically changed or defined by the user", "url": "https://github.com/alibaba/nacos/pull/3995#discussion_r505494773", "createdAt": "2020-10-15T12:19:22Z", "author": {"login": "chuntaojun"}, "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/NacosExecuteTaskExecuteEngine.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright 1999-2018 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.alibaba.nacos.common.task.engine;\n+\n+import com.alibaba.nacos.api.exception.NacosException;\n+import com.alibaba.nacos.common.task.AbstractExecuteTask;\n+import com.alibaba.nacos.common.task.NacosTaskProcessor;\n+import org.slf4j.Logger;\n+\n+import java.util.Collection;\n+\n+/**\n+ * Nacos execute task execute engine.\n+ *\n+ * @author xiweng.yy\n+ */\n+public class NacosExecuteTaskExecuteEngine extends AbstractNacosTaskExecuteEngine<AbstractExecuteTask> {\n+    \n+    private final TaskExecuteWorker[] executeWorkers;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2b1f38be54de5d5037409df5530c0ce7047500f"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NjM1MTUyOnYy", "diffSide": "RIGHT", "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/NacosExecuteTaskExecuteEngine.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMjoyMDowNlrOHiE-rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwMzoyMzo0MlrOHilLDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ5NTIxNA==", "bodyText": "If I remember correctly, there's a special way to do this", "url": "https://github.com/alibaba/nacos/pull/3995#discussion_r505495214", "createdAt": "2020-10-15T12:20:06Z", "author": {"login": "chuntaojun"}, "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/NacosExecuteTaskExecuteEngine.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright 1999-2018 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.alibaba.nacos.common.task.engine;\n+\n+import com.alibaba.nacos.api.exception.NacosException;\n+import com.alibaba.nacos.common.task.AbstractExecuteTask;\n+import com.alibaba.nacos.common.task.NacosTaskProcessor;\n+import org.slf4j.Logger;\n+\n+import java.util.Collection;\n+\n+/**\n+ * Nacos execute task execute engine.\n+ *\n+ * @author xiweng.yy\n+ */\n+public class NacosExecuteTaskExecuteEngine extends AbstractNacosTaskExecuteEngine<AbstractExecuteTask> {\n+    \n+    private final TaskExecuteWorker[] executeWorkers;\n+    \n+    public NacosExecuteTaskExecuteEngine(String name, Logger logger) {\n+        super(logger);\n+        int workerCount = findWorkerCount();\n+        executeWorkers = new TaskExecuteWorker[workerCount];\n+        for (int mod = 0; mod < workerCount; ++mod) {\n+            executeWorkers[mod] = new TaskExecuteWorker(name, mod, workerCount);\n+        }\n+    }\n+    \n+    private int findWorkerCount() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2b1f38be54de5d5037409df5530c0ce7047500f"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk3MTAwOQ==", "bodyText": "How to do this?", "url": "https://github.com/alibaba/nacos/pull/3995#discussion_r505971009", "createdAt": "2020-10-16T01:40:18Z", "author": {"login": "KomachiSion"}, "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/NacosExecuteTaskExecuteEngine.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright 1999-2018 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.alibaba.nacos.common.task.engine;\n+\n+import com.alibaba.nacos.api.exception.NacosException;\n+import com.alibaba.nacos.common.task.AbstractExecuteTask;\n+import com.alibaba.nacos.common.task.NacosTaskProcessor;\n+import org.slf4j.Logger;\n+\n+import java.util.Collection;\n+\n+/**\n+ * Nacos execute task execute engine.\n+ *\n+ * @author xiweng.yy\n+ */\n+public class NacosExecuteTaskExecuteEngine extends AbstractNacosTaskExecuteEngine<AbstractExecuteTask> {\n+    \n+    private final TaskExecuteWorker[] executeWorkers;\n+    \n+    public NacosExecuteTaskExecuteEngine(String name, Logger logger) {\n+        super(logger);\n+        int workerCount = findWorkerCount();\n+        executeWorkers = new TaskExecuteWorker[workerCount];\n+        for (int mod = 0; mod < workerCount; ++mod) {\n+            executeWorkers[mod] = new TaskExecuteWorker(name, mod, workerCount);\n+        }\n+    }\n+    \n+    private int findWorkerCount() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ5NTIxNA=="}, "originalCommit": {"oid": "e2b1f38be54de5d5037409df5530c0ce7047500f"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjAyMjY2OA==", "bodyText": "com.alibaba.nacos.common.utils.ThreadUtils#getSuitableThreadCount", "url": "https://github.com/alibaba/nacos/pull/3995#discussion_r506022668", "createdAt": "2020-10-16T03:23:42Z", "author": {"login": "chuntaojun"}, "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/NacosExecuteTaskExecuteEngine.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright 1999-2018 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.alibaba.nacos.common.task.engine;\n+\n+import com.alibaba.nacos.api.exception.NacosException;\n+import com.alibaba.nacos.common.task.AbstractExecuteTask;\n+import com.alibaba.nacos.common.task.NacosTaskProcessor;\n+import org.slf4j.Logger;\n+\n+import java.util.Collection;\n+\n+/**\n+ * Nacos execute task execute engine.\n+ *\n+ * @author xiweng.yy\n+ */\n+public class NacosExecuteTaskExecuteEngine extends AbstractNacosTaskExecuteEngine<AbstractExecuteTask> {\n+    \n+    private final TaskExecuteWorker[] executeWorkers;\n+    \n+    public NacosExecuteTaskExecuteEngine(String name, Logger logger) {\n+        super(logger);\n+        int workerCount = findWorkerCount();\n+        executeWorkers = new TaskExecuteWorker[workerCount];\n+        for (int mod = 0; mod < workerCount; ++mod) {\n+            executeWorkers[mod] = new TaskExecuteWorker(name, mod, workerCount);\n+        }\n+    }\n+    \n+    private int findWorkerCount() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ5NTIxNA=="}, "originalCommit": {"oid": "e2b1f38be54de5d5037409df5530c0ce7047500f"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NjM2MzgwOnYy", "diffSide": "RIGHT", "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/TaskExecuteWorker.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMjoyMzoxNFrOHiFGMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwMTo0MDowNVrOHiiA3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ5NzEzNg==", "bodyText": "must be thread ? why not use runnable that execute by thread-pool-executor", "url": "https://github.com/alibaba/nacos/pull/3995#discussion_r505497136", "createdAt": "2020-10-15T12:23:14Z", "author": {"login": "chuntaojun"}, "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/TaskExecuteWorker.java", "diffHunk": "@@ -101,12 +96,12 @@ public void shutdown() throws NacosException {\n      * Inner execute worker.\n      */\n     private class InnerWorker extends Thread {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2b1f38be54de5d5037409df5530c0ce7047500f"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk3MDkxMA==", "bodyText": "I just move this part, It can be enhance in other atomic PR", "url": "https://github.com/alibaba/nacos/pull/3995#discussion_r505970910", "createdAt": "2020-10-16T01:40:05Z", "author": {"login": "KomachiSion"}, "path": "common/src/main/java/com/alibaba/nacos/common/task/engine/TaskExecuteWorker.java", "diffHunk": "@@ -101,12 +96,12 @@ public void shutdown() throws NacosException {\n      * Inner execute worker.\n      */\n     private class InnerWorker extends Thread {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ5NzEzNg=="}, "originalCommit": {"oid": "e2b1f38be54de5d5037409df5530c0ce7047500f"}, "originalPosition": 92}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4304, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}