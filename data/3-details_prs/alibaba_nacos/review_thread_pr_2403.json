{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyNzk3MDkz", "number": 2403, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwNzo1OTo0NFrODki-mA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMDoxMzo1MVrODklpVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NjQ4NDA4OnYy", "diffSide": "RIGHT", "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Instances.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwNzo1OTo0NFrOFw7b4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwODoyNDoyOFrOFw8CJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg0OTc2MQ==", "bodyText": "Can ThreadLocal be used to avoid lock contention", "url": "https://github.com/alibaba/nacos/pull/2403#discussion_r386849761", "createdAt": "2020-03-03T07:59:44Z", "author": {"login": "chuntaojun"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Instances.java", "diffHunk": "@@ -84,8 +86,10 @@ private String recalculateChecksum() {\n         }\n \n         if (MESSAGE_DIGEST != null) {\n-            checksum =\n-                new BigInteger(1, MESSAGE_DIGEST.digest((sb.toString()).getBytes(Charset.forName(\"UTF-8\")))).toString(16);\n+            synchronized (LOCK) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b76c040826b168cab73a9cebe77ff4c134df4e3f"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg1MDM0OQ==", "bodyText": "okay", "url": "https://github.com/alibaba/nacos/pull/2403#discussion_r386850349", "createdAt": "2020-03-03T08:01:20Z", "author": {"login": "lkxiaolou"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Instances.java", "diffHunk": "@@ -84,8 +86,10 @@ private String recalculateChecksum() {\n         }\n \n         if (MESSAGE_DIGEST != null) {\n-            checksum =\n-                new BigInteger(1, MESSAGE_DIGEST.digest((sb.toString()).getBytes(Charset.forName(\"UTF-8\")))).toString(16);\n+            synchronized (LOCK) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg0OTc2MQ=="}, "originalCommit": {"oid": "b76c040826b168cab73a9cebe77ff4c134df4e3f"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg1OTU1Ng==", "bodyText": "Can ThreadLocal be used to avoid lock contention\n\ndone", "url": "https://github.com/alibaba/nacos/pull/2403#discussion_r386859556", "createdAt": "2020-03-03T08:24:28Z", "author": {"login": "lkxiaolou"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Instances.java", "diffHunk": "@@ -84,8 +86,10 @@ private String recalculateChecksum() {\n         }\n \n         if (MESSAGE_DIGEST != null) {\n-            checksum =\n-                new BigInteger(1, MESSAGE_DIGEST.digest((sb.toString()).getBytes(Charset.forName(\"UTF-8\")))).toString(16);\n+            synchronized (LOCK) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg0OTc2MQ=="}, "originalCommit": {"oid": "b76c040826b168cab73a9cebe77ff4c134df4e3f"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NjkyMTE2OnYy", "diffSide": "RIGHT", "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Instances.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMDoxMzo1MVrOFw_poQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMDo0ODoxNlrOFxA1Zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjkxODgxNw==", "bodyText": "Here, you can consider holding the MessageDigest with a local variable to avoid getting again later", "url": "https://github.com/alibaba/nacos/pull/2403#discussion_r386918817", "createdAt": "2020-03-03T10:13:51Z", "author": {"login": "chuntaojun"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Instances.java", "diffHunk": "@@ -83,9 +84,10 @@ private String recalculateChecksum() {\n             sb.append(\",\");\n         }\n \n-        if (MESSAGE_DIGEST != null) {\n-            checksum =\n-                new BigInteger(1, MESSAGE_DIGEST.digest((sb.toString()).getBytes(Charset.forName(\"UTF-8\")))).toString(16);\n+        if (MESSAGE_DIGEST_LOCAL.get() != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7ca2c1df4de414bfa3d09dd9e15b008662e1de9"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjkzODIxNA==", "bodyText": "Here, you can consider holding the MessageDigest with a local variable to avoid getting again later\n\ndone", "url": "https://github.com/alibaba/nacos/pull/2403#discussion_r386938214", "createdAt": "2020-03-03T10:48:16Z", "author": {"login": "lkxiaolou"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/core/Instances.java", "diffHunk": "@@ -83,9 +84,10 @@ private String recalculateChecksum() {\n             sb.append(\",\");\n         }\n \n-        if (MESSAGE_DIGEST != null) {\n-            checksum =\n-                new BigInteger(1, MESSAGE_DIGEST.digest((sb.toString()).getBytes(Charset.forName(\"UTF-8\")))).toString(16);\n+        if (MESSAGE_DIGEST_LOCAL.get() != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjkxODgxNw=="}, "originalCommit": {"oid": "c7ca2c1df4de414bfa3d09dd9e15b008662e1de9"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4492, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}