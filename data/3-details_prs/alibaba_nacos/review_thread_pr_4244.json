{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMTk1NjYy", "number": 4244, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNzozMzowMVrOE54gDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjo1MzoxMFrOE6jXdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MTI5OTk2OnYy", "diffSide": "RIGHT", "path": "common/src/main/java/com/alibaba/nacos/common/http/AbstractHttpClientFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNzozMzowMVrOH0ngVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNzozMzowMVrOH0ngVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDkzNTI1NA==", "bodyText": "use getIoReactorConfig directly, no need to use attribute.", "url": "https://github.com/alibaba/nacos/pull/4244#discussion_r524935254", "createdAt": "2020-11-17T07:33:01Z", "author": {"login": "KomachiSion"}, "path": "common/src/main/java/com/alibaba/nacos/common/http/AbstractHttpClientFactory.java", "diffHunk": "@@ -70,20 +71,28 @@ public void onChanged(String filePath) {\n     public NacosAsyncRestTemplate createNacosAsyncRestTemplate() {\n         final HttpClientConfig originalRequestConfig = buildHttpClientConfig();\n         final RequestConfig requestConfig = getRequestConfig();\n+        final IOReactorConfig ioReactorConfig = getIoReactorConfig();\n         return new NacosAsyncRestTemplate(assignLogger(), new DefaultAsyncHttpClientRequest(\n                 HttpAsyncClients.custom()\n                         .addInterceptorLast(new RequestContent(true))\n+                        .setDefaultIOReactorConfig(ioReactorConfig)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fdd9a03c80d6f5168ad6b18be3dafae525762bb"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MTg0MzUxOnYy", "diffSide": "RIGHT", "path": "naming/src/main/java/com/alibaba/nacos/naming/healthcheck/HttpHealthCheckProcessor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwOTo0ODo0NFrOH0sqaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwOTo0ODo0NFrOH0sqaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTAxOTc1NQ==", "bodyText": "\u53ef\u4ee5\u5305\u88c5\u5728http\u6a21\u5757\u5185\u90e8\uff0cHttpUtils.isTimeoutException()", "url": "https://github.com/alibaba/nacos/pull/4244#discussion_r525019755", "createdAt": "2020-11-17T09:48:44Z", "author": {"login": "chuntaojun"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/healthcheck/HttpHealthCheckProcessor.java", "diffHunk": "@@ -180,18 +153,17 @@ public Integer onCompleted(Response response) throws Exception {\n                         switchDomain.getHttpHealthParams());\n             }\n             \n-            return httpCode;\n         }\n         \n         @Override\n-        public void onThrowable(Throwable t) {\n+        public void onError(Throwable t) {\n             ip.setCheckRt(System.currentTimeMillis() - startTime);\n             \n             Throwable cause = t;\n             int maxStackDepth = 50;\n             for (int deepth = 0; deepth < maxStackDepth && cause != null; deepth++) {\n                 if (cause instanceof SocketTimeoutException || cause instanceof ConnectTimeoutException", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "622b63430a4461ed3fefc9dcadecde66dd37e0c3"}, "originalPosition": 114}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzY3MzA5OnYy", "diffSide": "RIGHT", "path": "naming/src/main/java/com/alibaba/nacos/naming/misc/HttpClientManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjozNzo1N1rOH0-RkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjozNzo1N1rOH0-RkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTMwODMwNA==", "bodyText": "\u8fd9\u91cc\u7684\u53c2\u6570\u5e94\u5f53\u540e\u9762\u53ef\u4ee5\u5bf9\u5916\u53ef\u914d\u7f6e\u5316\u7684\uff0c\u800c\u4e0d\u662f\u5199\u6b7b\u7684", "url": "https://github.com/alibaba/nacos/pull/4244#discussion_r525308304", "createdAt": "2020-11-17T16:37:57Z", "author": {"login": "chuntaojun"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/misc/HttpClientManager.java", "diffHunk": "@@ -146,4 +163,27 @@ protected Logger assignLogger() {\n             return SRV_LOG;\n         }\n     }\n+    \n+    private static class ProcessorHttpClientFactory extends AbstractHttpClientFactory {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "622b63430a4461ed3fefc9dcadecde66dd37e0c3"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5ODMyMTA0OnYy", "diffSide": "RIGHT", "path": "naming/src/main/java/com/alibaba/nacos/naming/misc/HttpClientManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjo1MjozOFrOH1sUTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjo1MjozOFrOH1sUTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA2MjY3MQ==", "bodyText": "Static final variable get from properties? Static final means that it's a constants. Should not be configed.", "url": "https://github.com/alibaba/nacos/pull/4244#discussion_r526062671", "createdAt": "2020-11-18T12:52:38Z", "author": {"login": "KomachiSion"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/misc/HttpClientManager.java", "diffHunk": "@@ -131,16 +147,58 @@ protected Logger assignLogger() {\n     }\n     \n     private static class ApacheSyncHttpClientFactory extends AbstractApacheHttpClientFactory {\n-    \n+        \n         @Override\n         protected HttpClientConfig buildHttpClientConfig() {\n-            return HttpClientConfig.builder()\n-                    .setConnectionTimeToLive(500, TimeUnit.MILLISECONDS)\n+            return HttpClientConfig.builder().setConnectionTimeToLive(500, TimeUnit.MILLISECONDS)\n                     .setMaxConnTotal(Runtime.getRuntime().availableProcessors() * 2)\n-                    .setMaxConnPerRoute(Runtime.getRuntime().availableProcessors())\n-                    .setMaxRedirects(0).build();\n+                    .setMaxConnPerRoute(Runtime.getRuntime().availableProcessors()).setMaxRedirects(0).build();\n+        }\n+        \n+        @Override\n+        protected Logger assignLogger() {\n+            return SRV_LOG;\n         }\n+    }\n     \n+    private static class ProcessorHttpClientFactory extends AbstractHttpClientFactory {\n+        \n+        private static final int CONNECTION_REQUEST_TIMEOUT = EnvUtil", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9dfc61cfa14aeccf47488efecc860ae2004563a9"}, "originalPosition": 118}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5ODMyMzA5OnYy", "diffSide": "RIGHT", "path": "sys/src/main/java/com/alibaba/nacos/sys/env/Constants.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjo1MzoxMFrOH1sVkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMjo1MzoxMFrOH1sVkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA2Mjk5Mg==", "bodyText": "Naming Constants should not be in parent module.", "url": "https://github.com/alibaba/nacos/pull/4244#discussion_r526062992", "createdAt": "2020-11-18T12:53:10Z", "author": {"login": "KomachiSion"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/env/Constants.java", "diffHunk": "@@ -63,4 +63,33 @@\n     String NACOS_SERVER_HEADER = \"Nacos-Server\";\n     \n     String REQUEST_PATH_SEPARATOR = \"-->\";\n+    \n+    /**\n+     * ============ naming persistent health check http env.\n+     */\n+    String NAMING_PERSISTENT = \"nacos.naming.persistent\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9dfc61cfa14aeccf47488efecc860ae2004563a9"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4255, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}