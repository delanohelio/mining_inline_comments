{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMTA4MDEz", "number": 3523, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwMToyNzo1M1rOEVogiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwMTozNToyM1rOEVomOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMTE5MjQzOnYy", "diffSide": "RIGHT", "path": "config/src/main/java/com/alibaba/nacos/config/server/service/ConfigSubService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwMToyNzo1M1rOG8gBIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwMTo1MDozN1rOG8gZhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjA5MjMyMw==", "bodyText": "Can unified json utils to Jackson util?", "url": "https://github.com/alibaba/nacos/pull/3523#discussion_r466092323", "createdAt": "2020-08-06T01:27:53Z", "author": {"login": "KomachiSion"}, "path": "config/src/main/java/com/alibaba/nacos/config/server/service/ConfigSubService.java", "diffHunk": "@@ -178,19 +178,16 @@ public SampleResult call() throws Exception {\n                 }\n                 \n                 String urlAll = getUrl(ip, url) + \"?\" + paramUrl;\n-                com.alibaba.nacos.config.server.service.notify.NotifyService.HttpResult result = NotifyService\n+                RestResult<String> result = NotifyService\n                         .invokeURL(urlAll, null, Constants.ENCODE);\n                 \n                 // Http code 200\n-                if (result.code == HttpURLConnection.HTTP_OK) {\n-                    String json = result.content;\n-                    SampleResult resultObj = JSONUtils.deserializeObject(json, new TypeReference<SampleResult>() {\n+                if (result.ok()) {\n+                    return JSONUtils.deserializeObject(result.getData(), new TypeReference<SampleResult>() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1b20b5a3b78acfa729e46c04ac1a88251b2a52e"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjA5ODU2Nw==", "bodyText": "Ok, I will modify", "url": "https://github.com/alibaba/nacos/pull/3523#discussion_r466098567", "createdAt": "2020-08-06T01:50:37Z", "author": {"login": "Maijh97"}, "path": "config/src/main/java/com/alibaba/nacos/config/server/service/ConfigSubService.java", "diffHunk": "@@ -178,19 +178,16 @@ public SampleResult call() throws Exception {\n                 }\n                 \n                 String urlAll = getUrl(ip, url) + \"?\" + paramUrl;\n-                com.alibaba.nacos.config.server.service.notify.NotifyService.HttpResult result = NotifyService\n+                RestResult<String> result = NotifyService\n                         .invokeURL(urlAll, null, Constants.ENCODE);\n                 \n                 // Http code 200\n-                if (result.code == HttpURLConnection.HTTP_OK) {\n-                    String json = result.content;\n-                    SampleResult resultObj = JSONUtils.deserializeObject(json, new TypeReference<SampleResult>() {\n+                if (result.ok()) {\n+                    return JSONUtils.deserializeObject(result.getData(), new TypeReference<SampleResult>() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjA5MjMyMw=="}, "originalCommit": {"oid": "c1b20b5a3b78acfa729e46c04ac1a88251b2a52e"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMTIwNjk3OnYy", "diffSide": "RIGHT", "path": "config/src/main/java/com/alibaba/nacos/config/server/service/notify/AsyncNotifyService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwMTozNToyM1rOG8gJiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwMTo1MTozMFrOG8gaWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjA5NDQ3NQ==", "bodyText": "Should we modified this restTemplate.get method, if any error when execute get, call the callback.onError in the restTemplate.get rather than throw exception?", "url": "https://github.com/alibaba/nacos/pull/3523#discussion_r466094475", "createdAt": "2020-08-06T01:35:23Z", "author": {"login": "KomachiSion"}, "path": "config/src/main/java/com/alibaba/nacos/config/server/service/notify/AsyncNotifyService.java", "diffHunk": "@@ -138,52 +132,52 @@ private void executeAsyncInvoke() {\n                         // get delay time and set fail count to the task\n                         asyncTaskExecute(task);\n                     } else {\n-                        HttpGet request = new HttpGet(task.url);\n-                        request.setHeader(NotifyService.NOTIFY_HEADER_LAST_MODIFIED,\n-                                String.valueOf(task.getLastModified()));\n-                        request.setHeader(NotifyService.NOTIFY_HEADER_OP_HANDLE_IP, InetUtils.getSelfIp());\n+                        Header header = Header.newInstance();\n+                        header.addParam(NotifyService.NOTIFY_HEADER_LAST_MODIFIED, String.valueOf(task.getLastModified()));\n+                        header.addParam(NotifyService.NOTIFY_HEADER_OP_HANDLE_IP, InetUtils.getSelfIp());\n                         if (task.isBeta) {\n-                            request.setHeader(\"isBeta\", \"true\");\n+                            header.addParam(\"isBeta\", \"true\");\n+                        }\n+                        AsyncNotifyCallBack asyncNotifyCallBack = new AsyncNotifyCallBack(task);\n+                        try {\n+                            restTemplate.get(task.url, header, Query.EMPTY, String.class, asyncNotifyCallBack);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1b20b5a3b78acfa729e46c04ac1a88251b2a52e"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjA5ODc3OQ==", "bodyText": "Ok, very good advice", "url": "https://github.com/alibaba/nacos/pull/3523#discussion_r466098779", "createdAt": "2020-08-06T01:51:30Z", "author": {"login": "Maijh97"}, "path": "config/src/main/java/com/alibaba/nacos/config/server/service/notify/AsyncNotifyService.java", "diffHunk": "@@ -138,52 +132,52 @@ private void executeAsyncInvoke() {\n                         // get delay time and set fail count to the task\n                         asyncTaskExecute(task);\n                     } else {\n-                        HttpGet request = new HttpGet(task.url);\n-                        request.setHeader(NotifyService.NOTIFY_HEADER_LAST_MODIFIED,\n-                                String.valueOf(task.getLastModified()));\n-                        request.setHeader(NotifyService.NOTIFY_HEADER_OP_HANDLE_IP, InetUtils.getSelfIp());\n+                        Header header = Header.newInstance();\n+                        header.addParam(NotifyService.NOTIFY_HEADER_LAST_MODIFIED, String.valueOf(task.getLastModified()));\n+                        header.addParam(NotifyService.NOTIFY_HEADER_OP_HANDLE_IP, InetUtils.getSelfIp());\n                         if (task.isBeta) {\n-                            request.setHeader(\"isBeta\", \"true\");\n+                            header.addParam(\"isBeta\", \"true\");\n+                        }\n+                        AsyncNotifyCallBack asyncNotifyCallBack = new AsyncNotifyCallBack(task);\n+                        try {\n+                            restTemplate.get(task.url, header, Query.EMPTY, String.class, asyncNotifyCallBack);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjA5NDQ3NQ=="}, "originalCommit": {"oid": "c1b20b5a3b78acfa729e46c04ac1a88251b2a52e"}, "originalPosition": 96}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4392, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}