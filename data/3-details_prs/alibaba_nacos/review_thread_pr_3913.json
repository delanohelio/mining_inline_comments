{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyODQ3NzE1", "number": 3913, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNDo1NDozNlrOEnza-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwODo0MDo0OVrOEo7eyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMTcyNDA4OnYy", "diffSide": "RIGHT", "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNDo1NDozNlrOHYkq8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNTo1ODoyM1rOHYk81Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUyODY4OA==", "bodyText": "There is no port, just set ip or domain.\nSee isIP", "url": "https://github.com/alibaba/nacos/pull/3913#discussion_r495528688", "createdAt": "2020-09-27T04:54:36Z", "author": {"login": "KomachiSion"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "diffHunk": "@@ -219,6 +219,26 @@ public static boolean isIP(String str) {\n         return matcher.matches();\n     }\n     \n+    /**\n+     * juege str is right domain.\n+     *\n+     * @param str nacosIp\n+     * @return nacosIp is domain\n+     */\n+    public static boolean isDomain(String str) {\n+        try {\n+            String[] split = str.split(\":\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00bb7bd9319d7d22c5b8c2268e3c2f73e1cf0646"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUzMzI2OQ==", "bodyText": "yes", "url": "https://github.com/alibaba/nacos/pull/3913#discussion_r495533269", "createdAt": "2020-09-27T05:58:23Z", "author": {"login": "horizonzy"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "diffHunk": "@@ -219,6 +219,26 @@ public static boolean isIP(String str) {\n         return matcher.matches();\n     }\n     \n+    /**\n+     * juege str is right domain.\n+     *\n+     * @param str nacosIp\n+     * @return nacosIp is domain\n+     */\n+    public static boolean isDomain(String str) {\n+        try {\n+            String[] split = str.split(\":\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUyODY4OA=="}, "originalCommit": {"oid": "00bb7bd9319d7d22c5b8c2268e3c2f73e1cf0646"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMTcyNzMyOnYy", "diffSide": "RIGHT", "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNTowMDoxN1rOHYksYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNTo1OTowN1rOHYk86Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUyOTA1Nw==", "bodyText": "Is this too strict to judge?\nthis method need the input must can be parse to IP and can reach.\nBut we just need check the input string is a domain pattern", "url": "https://github.com/alibaba/nacos/pull/3913#discussion_r495529057", "createdAt": "2020-09-27T05:00:17Z", "author": {"login": "KomachiSion"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "diffHunk": "@@ -219,6 +219,26 @@ public static boolean isIP(String str) {\n         return matcher.matches();\n     }\n     \n+    /**\n+     * juege str is right domain.\n+     *\n+     * @param str nacosIp\n+     * @return nacosIp is domain\n+     */\n+    public static boolean isDomain(String str) {\n+        try {\n+            String[] split = str.split(\":\");\n+            if (split.length != 2) {\n+                return false;\n+            }\n+            Integer.parseInt(split[1]);\n+            InetAddress address = InetAddress.getByName(split[0]);\n+            return address.isReachable(100);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00bb7bd9319d7d22c5b8c2268e3c2f73e1cf0646"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUzMzI4OQ==", "bodyText": "yes, just check the domain can resolve", "url": "https://github.com/alibaba/nacos/pull/3913#discussion_r495533289", "createdAt": "2020-09-27T05:59:07Z", "author": {"login": "horizonzy"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "diffHunk": "@@ -219,6 +219,26 @@ public static boolean isIP(String str) {\n         return matcher.matches();\n     }\n     \n+    /**\n+     * juege str is right domain.\n+     *\n+     * @param str nacosIp\n+     * @return nacosIp is domain\n+     */\n+    public static boolean isDomain(String str) {\n+        try {\n+            String[] split = str.split(\":\");\n+            if (split.length != 2) {\n+                return false;\n+            }\n+            Integer.parseInt(split[1]);\n+            InetAddress address = InetAddress.getByName(split[0]);\n+            return address.isReachable(100);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUyOTA1Nw=="}, "originalCommit": {"oid": "00bb7bd9319d7d22c5b8c2268e3c2f73e1cf0646"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMjgyOTgzOnYy", "diffSide": "RIGHT", "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwMzoxMjoyMVrOHYtMhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwMzoxMjoyMVrOHYtMhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY2ODM1Ng==", "bodyText": "illegalIp => illegalIP", "url": "https://github.com/alibaba/nacos/pull/3913#discussion_r495668356", "createdAt": "2020-09-28T03:12:21Z", "author": {"login": "chuntaojun"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "diffHunk": "@@ -87,7 +88,8 @@ public void run() {\n                     nacosIp = ApplicationUtils.getProperty(IP_ADDRESS);\n                 }\n                 \n-                if (!StringUtils.isBlank(nacosIp) && !isIP(nacosIp)) {\n+                boolean illegalIp = !StringUtils.isBlank(nacosIp) && !(isIP(nacosIp) || isDomain(nacosIp));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2a9745f87d994421cb1a758ff3f834e48ecb6bf1"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMjkyNTEyOnYy", "diffSide": "RIGHT", "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwNToxMjowOVrOHaNiXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwODoxNjoxOFrOHaSVEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI0NjgxNA==", "bodyText": "A Warn log can be output here to indicate that the domain name is not reachable", "url": "https://github.com/alibaba/nacos/pull/3913#discussion_r497246814", "createdAt": "2020-09-30T05:12:09Z", "author": {"login": "chuntaojun"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "diffHunk": "@@ -219,35 +221,46 @@ public static boolean isIP(String str) {\n         return matcher.matches();\n     }\n     \n+    /**\n+     * juege str is right domain.\n+     *\n+     * @param str nacosIP\n+     * @return nacosIP is domain\n+     */\n+    public static boolean isDomain(String str) {\n+        InetSocketAddress address = new InetSocketAddress(str, 0);\n+        return !address.isUnresolved();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6545584c5d9538bd7523430f9bb5bc0fc2b46945"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzMyNTMyOQ==", "bodyText": "solve it", "url": "https://github.com/alibaba/nacos/pull/3913#discussion_r497325329", "createdAt": "2020-09-30T08:16:18Z", "author": {"login": "horizonzy"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "diffHunk": "@@ -219,35 +221,46 @@ public static boolean isIP(String str) {\n         return matcher.matches();\n     }\n     \n+    /**\n+     * juege str is right domain.\n+     *\n+     * @param str nacosIP\n+     * @return nacosIP is domain\n+     */\n+    public static boolean isDomain(String str) {\n+        InetSocketAddress address = new InetSocketAddress(str, 0);\n+        return !address.isUnresolved();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI0NjgxNA=="}, "originalCommit": {"oid": "6545584c5d9538bd7523430f9bb5bc0fc2b46945"}, "originalPosition": 111}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMzUzMDM0OnYy", "diffSide": "RIGHT", "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwODo0MDo0OVrOHaTRtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwODo0MDo0OVrOHaTRtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM0MDg1Mw==", "bodyText": "isResolved => unResolved", "url": "https://github.com/alibaba/nacos/pull/3913#discussion_r497340853", "createdAt": "2020-09-30T08:40:49Z", "author": {"login": "chuntaojun"}, "path": "sys/src/main/java/com/alibaba/nacos/sys/utils/InetUtils.java", "diffHunk": "@@ -219,35 +221,50 @@ public static boolean isIP(String str) {\n         return matcher.matches();\n     }\n     \n+    /**\n+     * juege str is right domain.\n+     *\n+     * @param str nacosIP\n+     * @return nacosIP is domain\n+     */\n+    public static boolean isDomain(String str) {\n+        InetSocketAddress address = new InetSocketAddress(str, 0);\n+        boolean isResolved = !address.isUnresolved();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd775d5722913ed65d1a4788f647f101e08323a4"}, "originalPosition": 111}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4297, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}