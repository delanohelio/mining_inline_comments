{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2NzE0OTkz", "number": 3452, "title": "[ISSUE #2858] Unified http client implementation, enhanced async request callback interface", "bodyText": "Please do not create a Pull Request without creating an issue first.\nWhat is the purpose of the change\n#2858\nBrief changelog\nAdd onCancel method to callback\nVerifying this change\nXXXX\nFollow this checklist to help us incorporate your contribution quickly and easily:\n\n Make sure there is a Github issue filed for the change (usually before you start working on it). Trivial changes like typos do not require a Github issue. Your pull request should address just this issue, without pulling in other changes - one PR resolves one issue.\n Format the pull request title like [ISSUE #123] Fix UnknownException when host config not exist. Each commit in the pull request should have a meaningful subject line and body.\n Write a pull request description that is detailed enough to understand what the pull request does, how, and why.\n Write necessary unit-test to verify your logic correction, more mock a little better when cross module dependency exist. If the new feature or significant change is committed, please remember to add integration-test in test module.\n Run mvn -B clean package apache-rat:check findbugs:findbugs -Dmaven.test.skip=true to make sure basic checks pass. Run mvn clean install -DskipITs to make sure unit-test pass. Run mvn clean test-compile failsafe:integration-test  to make sure integration-test pass.", "createdAt": "2020-07-26T07:37:48Z", "url": "https://github.com/alibaba/nacos/pull/3452", "merged": true, "mergeCommit": {"oid": "5b76fd0d568ff0c43a10f270d1262479afbf5b63"}, "closed": true, "closedAt": "2020-07-27T05:15:51Z", "author": {"login": "Maijh97"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4oEN5gH2gAyNDU2NzE0OTkzOjE4NDFjYmVlOGNhMWQyMzY4MWM1ZjVkYWNmOTFiOGMxMGZhNWIzM2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc46ytBgFqTQ1NTQ3NjEwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1841cbee8ca1d23681c5f5dacf91b8c10fa5b33d", "author": {"user": {"login": "Maijh97", "name": "mai.jh"}}, "url": "https://github.com/alibaba/nacos/commit/1841cbee8ca1d23681c5f5dacf91b8c10fa5b33d", "committedDate": "2020-07-26T07:26:39Z", "message": "Enhanced callback interface for asynchronous requests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f1ff13f2e0b7b330c81475c457e02461e3f7995", "author": {"user": {"login": "Maijh97", "name": "mai.jh"}}, "url": "https://github.com/alibaba/nacos/commit/4f1ff13f2e0b7b330c81475c457e02461e3f7995", "committedDate": "2020-07-26T07:31:58Z", "message": "change class name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28dcbd4ef9051eee18eba0afcbe395105e3c2697", "author": {"user": {"login": "Maijh97", "name": "mai.jh"}}, "url": "https://github.com/alibaba/nacos/commit/28dcbd4ef9051eee18eba0afcbe395105e3c2697", "committedDate": "2020-07-26T07:44:07Z", "message": "add license"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be03a06450abccb83af5dbbdbd06c01d8b13e918", "author": {"user": {"login": "Maijh97", "name": "mai.jh"}}, "url": "https://github.com/alibaba/nacos/commit/be03a06450abccb83af5dbbdbd06c01d8b13e918", "committedDate": "2020-07-26T07:56:40Z", "message": "change class name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5733c5114513b01a1a1ac7704f4e923e68db74c", "author": {"user": {"login": "Maijh97", "name": "mai.jh"}}, "url": "https://github.com/alibaba/nacos/commit/c5733c5114513b01a1a1ac7704f4e923e68db74c", "committedDate": "2020-07-26T08:06:48Z", "message": "comment change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDIzODUx", "url": "https://github.com/alibaba/nacos/pull/3452#pullrequestreview-455423851", "createdAt": "2020-07-27T01:46:45Z", "commit": {"oid": "c5733c5114513b01a1a1ac7704f4e923e68db74c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMTo0Njo0NVrOG3ROTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMTo0ODo1NlrOG3RP7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwNzA1Mg==", "bodyText": "Why not use interface rather than Abstract class\uff1f", "url": "https://github.com/alibaba/nacos/pull/3452#discussion_r460607052", "createdAt": "2020-07-27T01:46:45Z", "author": {"login": "KomachiSion"}, "path": "core/src/main/java/com/alibaba/nacos/core/cluster/ServerMemberManager.java", "diffHunk": "@@ -454,7 +454,7 @@ protected void executeBody() {\n             try {\n                 asyncHttpClient\n                         .post(url, Header.newInstance().addParam(Constants.NACOS_SERVER_HEADER, VersionUtils.version),\n-                                Query.EMPTY, getSelf(), reference.getType(), new Callback<String>() {\n+                                Query.EMPTY, getSelf(), reference.getType(), new AbstractCallback<String>() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5733c5114513b01a1a1ac7704f4e923e68db74c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwNzI1Mg==", "bodyText": "Same question as above", "url": "https://github.com/alibaba/nacos/pull/3452#discussion_r460607252", "createdAt": "2020-07-27T01:47:44Z", "author": {"login": "KomachiSion"}, "path": "core/src/main/java/com/alibaba/nacos/core/controller/NacosClusterController.java", "diffHunk": "@@ -162,7 +162,7 @@ public NacosClusterController(ServerMemberManager memberManager) {\n             final String url = HttpUtils\n                     .buildUrl(false, member.getAddress(), ApplicationUtils.getContextPath(), Commons.NACOS_CORE_CONTEXT,\n                             \"/cluster/server/leave\");\n-            asyncHttpClient.post(url, Header.EMPTY, Query.EMPTY, params, genericType.getType(), new Callback<String>() {\n+            asyncHttpClient.post(url, Header.EMPTY, Query.EMPTY, params, genericType.getType(), new AbstractCallback<String>() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5733c5114513b01a1a1ac7704f4e923e68db74c"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYwNzQ2OQ==", "bodyText": "An abstract class but without any default implement and no more abstract method?", "url": "https://github.com/alibaba/nacos/pull/3452#discussion_r460607469", "createdAt": "2020-07-27T01:48:56Z", "author": {"login": "KomachiSion"}, "path": "common/src/main/java/com/alibaba/nacos/common/http/AbstractCallback.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 1999-2018 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.alibaba.nacos.common.http;\n+\n+import com.alibaba.nacos.common.model.RestResult;\n+\n+/**\n+ * Abstract callback.\n+ *\n+ * @author mai.jh\n+ */\n+public abstract class AbstractCallback<T> implements Callback<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5733c5114513b01a1a1ac7704f4e923e68db74c"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96c7103fc86db5d009ea95922807f971b8f2882b", "author": {"user": {"login": "Maijh97", "name": "mai.jh"}}, "url": "https://github.com/alibaba/nacos/commit/96c7103fc86db5d009ea95922807f971b8f2882b", "committedDate": "2020-07-27T02:48:36Z", "message": "delete AbstractCallback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDc2MTA2", "url": "https://github.com/alibaba/nacos/pull/3452#pullrequestreview-455476106", "createdAt": "2020-07-27T05:15:43Z", "commit": {"oid": "96c7103fc86db5d009ea95922807f971b8f2882b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4310, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}