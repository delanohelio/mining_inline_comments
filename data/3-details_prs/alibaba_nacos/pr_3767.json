{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxMDgwMDUz", "number": 3767, "title": "[ISSUE #3687] check serviceName's format(groupName@@serviceName) in server and client", "bodyText": "What is the purpose of the change\nfix-#3687", "createdAt": "2020-09-07T06:12:30Z", "url": "https://github.com/alibaba/nacos/pull/3767", "merged": true, "mergeCommit": {"oid": "3dc0f243f88ddde9a06189d068af20999b473b63"}, "closed": true, "closedAt": "2020-09-09T08:40:08Z", "author": {"login": "horizonzy"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdGctAggH2gAyNDgxMDgwMDUzOjJlMGIxMTQ2MzMwMTM5YmJhOGU3OTFjOTMzNzdjNTRhYjczNWI1NWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHIFOPgFqTQ4NDc4NTY2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e0b1146330139bba8e791c93377c54ab735b55b", "author": {"user": {"login": "horizonzy", "name": "\u8d75\u5ef6"}}, "url": "https://github.com/alibaba/nacos/commit/2e0b1146330139bba8e791c93377c54ab735b55b", "committedDate": "2020-09-07T06:07:17Z", "message": "1.in server, check serviceName's format 'groupName@@serviceName', groupName and serviceName can't be blank\n2.in client, check 'groupName@@serviceName', groupName and serviceName can't be blank"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d37a5bd4cb84425f8b85d8c05053e92ffa07736", "author": {"user": {"login": "horizonzy", "name": "\u8d75\u5ef6"}}, "url": "https://github.com/alibaba/nacos/commit/6d37a5bd4cb84425f8b85d8c05053e92ffa07736", "committedDate": "2020-09-07T08:34:45Z", "message": "ignore the check to groupName"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNDYyNTMy", "url": "https://github.com/alibaba/nacos/pull/3767#pullrequestreview-483462532", "createdAt": "2020-09-07T10:55:30Z", "commit": {"oid": "6d37a5bd4cb84425f8b85d8c05053e92ffa07736"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMDo1NTozMFrOHN6zvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMDo1NTozMFrOHN6zvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM1NzA1Mg==", "bodyText": "I think check length of array is better than catch exception.", "url": "https://github.com/alibaba/nacos/pull/3767#discussion_r484357052", "createdAt": "2020-09-07T10:55:30Z", "author": {"login": "KomachiSion"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/controllers/InstanceController.java", "diffHunk": "@@ -433,6 +440,19 @@ public ObjectNode listWithHealthStatus(@RequestParam String key) throws NacosExc\n         return result;\n     }\n     \n+    private void checkServiceNameFormat(String serviceName) {\n+        try {\n+            String[] split = serviceName.split(Constants.SERVICE_INFO_SPLITER);\n+            String service = split[1];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d37a5bd4cb84425f8b85d8c05053e92ffa07736"}, "originalPosition": 89}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ee0d7de758f8e872f2538c6af720a4fdeb1a9a3", "author": {"user": {"login": "horizonzy", "name": "\u8d75\u5ef6"}}, "url": "https://github.com/alibaba/nacos/commit/2ee0d7de758f8e872f2538c6af720a4fdeb1a9a3", "committedDate": "2020-09-07T14:36:18Z", "message": "check split's length instead of exception to check argument"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb1ac54fa255d48ea160d34ba2a571829376bfbe", "author": {"user": {"login": "horizonzy", "name": "\u8d75\u5ef6"}}, "url": "https://github.com/alibaba/nacos/commit/eb1ac54fa255d48ea160d34ba2a571829376bfbe", "committedDate": "2020-09-08T02:48:40Z", "message": "1.add some notes\n2.remove unnecessary code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MDc1ODA4", "url": "https://github.com/alibaba/nacos/pull/3767#pullrequestreview-484075808", "createdAt": "2020-09-08T12:20:14Z", "commit": {"oid": "eb1ac54fa255d48ea160d34ba2a571829376bfbe"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MDg2NjQy", "url": "https://github.com/alibaba/nacos/pull/3767#pullrequestreview-484086642", "createdAt": "2020-09-08T12:34:49Z", "commit": {"oid": "eb1ac54fa255d48ea160d34ba2a571829376bfbe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxMjozNDo0OVrOHOav9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxMjozNDo0OVrOHOav9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDg4MDM3NA==", "bodyText": "\u6539\u6210\nserviceName = \"@@\"; the length = 0; illegal\nserviceName = \"group@@\"; the length = 1; illegal\nserviceName = \"@@serviceName\"; the length = 2; legal\nserviceName = \"group@@serviceName\"; the length = 2; legal\n\n\u4f1a\u4e0d\u4f1a\u66f4\u597d\u7406\u89e3\uff1f", "url": "https://github.com/alibaba/nacos/pull/3767#discussion_r484880374", "createdAt": "2020-09-08T12:34:49Z", "author": {"login": "KomachiSion"}, "path": "naming/src/main/java/com/alibaba/nacos/naming/controllers/InstanceController.java", "diffHunk": "@@ -433,6 +441,22 @@ public ObjectNode listWithHealthStatus(@RequestParam String key) throws NacosExc\n         return result;\n     }\n     \n+    /**\n+     * check combineServiceName format, the serviceName can't be blank. some relational logic in {@link\n+     * DistroFilter#doFilter}, it will handle combineServiceName in some case, you should know it\n+     *\n+     * @param combineServiceName such as: groupName@@serviceName\n+     */\n+    private void checkServiceNameFormat(String combineServiceName) {\n+        String[] split = combineServiceName.split(Constants.SERVICE_INFO_SPLITER);\n+        //namingService.registerInstance(\"\", \"\", instance); the length = 0\n+        //namingService.registerInstance(\"\", \"DEFAULT_GROUP\", instance); the length = 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb1ac54fa255d48ea160d34ba2a571829376bfbe"}, "originalPosition": 103}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ada9585766a5c74acf14a7636ca270cc137ac9a", "author": {"user": {"login": "horizonzy", "name": "\u8d75\u5ef6"}}, "url": "https://github.com/alibaba/nacos/commit/2ada9585766a5c74acf14a7636ca270cc137ac9a", "committedDate": "2020-09-08T13:58:29Z", "message": "modify the notes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0Nzg1NjYy", "url": "https://github.com/alibaba/nacos/pull/3767#pullrequestreview-484785662", "createdAt": "2020-09-09T08:39:39Z", "commit": {"oid": "2ada9585766a5c74acf14a7636ca270cc137ac9a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4275, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}