{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwMTUzNDkw", "number": 3501, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjo0MDo1OVrOElwEEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNzowMTo0NFrOElwh-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4MDIwMjQxOnYy", "diffSide": "RIGHT", "path": "ui-ngx/src/app/modules/home/components/widget/lib/rpc/knob.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjo0MDo1OVrOHVZiFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjo0MDo1OVrOHVZiFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjIwMDQ2OA==", "bodyText": "These imports don't use", "url": "https://github.com/thingsboard/thingsboard/pull/3501#discussion_r492200468", "createdAt": "2020-09-21T16:40:59Z", "author": {"login": "vvlladd28"}, "path": "ui-ngx/src/app/modules/home/components/widget/lib/rpc/knob.component.ts", "diffHunk": "@@ -25,6 +25,8 @@ import { CanvasDigitalGauge, CanvasDigitalGaugeOptions } from '@home/components/\n import * as tinycolor_ from 'tinycolor2';\n import { ResizeObserver } from '@juggle/resize-observer';\n import GenericOptions = CanvasGauges.GenericOptions;\n+import {number} from \"prop-types\";\n+import {eventTargetLegacyPatch} from \"zone.js/lib/browser/event-target-legacy\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0bc5e4a2bca0ae03dca969e630b84286750f25c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4MDI3MDg4OnYy", "diffSide": "RIGHT", "path": "ui-ngx/src/app/modules/home/components/widget/lib/rpc/knob.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjo1OTo0MVrOHVaNIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNjo1OTo0MVrOHVaNIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjIxMTQ5MA==", "bodyText": "Please formatting this code", "url": "https://github.com/thingsboard/thingsboard/pull/3501#discussion_r492211490", "createdAt": "2020-09-21T16:59:41Z", "author": {"login": "vvlladd28"}, "path": "ui-ngx/src/app/modules/home/components/widget/lib/rpc/knob.component.ts", "diffHunk": "@@ -166,43 +170,52 @@ export class KnobComponent extends PageComponent implements OnInit, OnDestroy {\n \n     this.canvasBar = new CanvasDigitalGauge(canvasBarData).draw();\n \n-    this.knob.on('click', (e) => {\n-      if (this.moving) {\n-        this.moving = false;\n-        return false;\n-      }\n-      e.preventDefault();\n \n-      const offset = this.knob.offset();\n-      const center = {\n-        y : offset.top + this.knob.height()/2,\n-        x: offset.left + this.knob.width()/2\n-      };\n-      const rad2deg = 180/Math.PI;\n-      const t: Touch = ((e.originalEvent as any).touches) ? (e.originalEvent as any).touches[0] : e;\n \n-      const a = center.y - t.pageY;\n-      const b = center.x - t.pageX;\n-      let deg = Math.atan2(a,b)*rad2deg;\n-      if(deg < 0){\n-        deg = 360 + deg;\n-      }\n-      if (deg > this.maxDeg) {\n-        if (deg - 360 > this.minDeg) {\n-          deg = deg - 360;\n-        } else {\n+    this.knob.on('click', (e) => {\n+        if (this.moving) {\n+          this.moving = false;\n           return false;\n         }\n+        e.preventDefault();\n+\n+        const offset = this.knob.offset();\n+        const center = {\n+          y: offset.top + this.knob.height() / 2,\n+          x: offset.left + this.knob.width() / 2\n+        };\n+        const rad2deg = 180 / Math.PI;\n+        const t: Touch = ((e.originalEvent as any).touches) ? (e.originalEvent as any).touches[0] : e;\n+        const a = center.y - t.pageY;\n+        const b = center.x - t.pageX;\n+        let deg = Math.atan2(a, b) * rad2deg;\n+        if (deg < 0) {\n+          deg = 360 + deg;\n+        }\n+        if (deg > this.maxDeg) {\n+          if (deg - 360 > this.minDeg) {\n+            deg = deg - 360;\n+          } else {\n+            return false;\n+          }\n+        }\n+        this.currentDeg = deg;\n+        this.lastDeg = deg;\n+        this.knobTopPointerContainer.css('transform', 'rotate(' + (this.currentDeg) + 'deg)');\n+        this.turn(this.degreeToRatio(this.currentDeg));\n+        this.rotation = this.currentDeg;\n+        this.startDeg = -1;\n+        this.rpcUpdateValue(this.newValue);\n+    });\n+\n+    $(document).on('mouseup touchend', (e) => {\n+      if(this.newValue !== this.rpcValue && this.moving) {\n+        this.rpcUpdateValue(this.newValue);\n       }\n-      this.currentDeg = deg;\n-      this.lastDeg = deg;\n-      this.knobTopPointerContainer.css('transform','rotate('+(this.currentDeg)+'deg)');\n-      this.turn(this.degreeToRatio(this.currentDeg));\n-      this.rotation = this.currentDeg;\n-      this.startDeg = -1;\n     });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0bc5e4a2bca0ae03dca969e630b84286750f25c"}, "originalPosition": 100}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA4MDI3ODk5OnYy", "diffSide": "RIGHT", "path": "ui-ngx/src/app/modules/home/components/widget/lib/rpc/knob.component.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNzowMTo0NFrOHVaSCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxNzowMTo0NFrOHVaSCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjIxMjc0NQ==", "bodyText": "You may need to move this code to this.knob.on('mousedown touchstart'", "url": "https://github.com/thingsboard/thingsboard/pull/3501#discussion_r492212745", "createdAt": "2020-09-21T17:01:44Z", "author": {"login": "vvlladd28"}, "path": "ui-ngx/src/app/modules/home/components/widget/lib/rpc/knob.component.ts", "diffHunk": "@@ -166,43 +170,52 @@ export class KnobComponent extends PageComponent implements OnInit, OnDestroy {\n \n     this.canvasBar = new CanvasDigitalGauge(canvasBarData).draw();\n \n-    this.knob.on('click', (e) => {\n-      if (this.moving) {\n-        this.moving = false;\n-        return false;\n-      }\n-      e.preventDefault();\n \n-      const offset = this.knob.offset();\n-      const center = {\n-        y : offset.top + this.knob.height()/2,\n-        x: offset.left + this.knob.width()/2\n-      };\n-      const rad2deg = 180/Math.PI;\n-      const t: Touch = ((e.originalEvent as any).touches) ? (e.originalEvent as any).touches[0] : e;\n \n-      const a = center.y - t.pageY;\n-      const b = center.x - t.pageX;\n-      let deg = Math.atan2(a,b)*rad2deg;\n-      if(deg < 0){\n-        deg = 360 + deg;\n-      }\n-      if (deg > this.maxDeg) {\n-        if (deg - 360 > this.minDeg) {\n-          deg = deg - 360;\n-        } else {\n+    this.knob.on('click', (e) => {\n+        if (this.moving) {\n+          this.moving = false;\n           return false;\n         }\n+        e.preventDefault();\n+\n+        const offset = this.knob.offset();\n+        const center = {\n+          y: offset.top + this.knob.height() / 2,\n+          x: offset.left + this.knob.width() / 2\n+        };\n+        const rad2deg = 180 / Math.PI;\n+        const t: Touch = ((e.originalEvent as any).touches) ? (e.originalEvent as any).touches[0] : e;\n+        const a = center.y - t.pageY;\n+        const b = center.x - t.pageX;\n+        let deg = Math.atan2(a, b) * rad2deg;\n+        if (deg < 0) {\n+          deg = 360 + deg;\n+        }\n+        if (deg > this.maxDeg) {\n+          if (deg - 360 > this.minDeg) {\n+            deg = deg - 360;\n+          } else {\n+            return false;\n+          }\n+        }\n+        this.currentDeg = deg;\n+        this.lastDeg = deg;\n+        this.knobTopPointerContainer.css('transform', 'rotate(' + (this.currentDeg) + 'deg)');\n+        this.turn(this.degreeToRatio(this.currentDeg));\n+        this.rotation = this.currentDeg;\n+        this.startDeg = -1;\n+        this.rpcUpdateValue(this.newValue);\n+    });\n+\n+    $(document).on('mouseup touchend', (e) => {\n+      if(this.newValue !== this.rpcValue && this.moving) {\n+        this.rpcUpdateValue(this.newValue);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0bc5e4a2bca0ae03dca969e630b84286750f25c"}, "originalPosition": 92}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1354, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}