{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyMDU5OTcw", "number": 3217, "title": "created procedure insert_tb_schema_settings", "bodyText": "", "createdAt": "2020-08-03T09:26:24Z", "url": "https://github.com/thingsboard/thingsboard/pull/3217", "merged": true, "mergeCommit": {"oid": "da091e75c9b1101c74adc62e7be746b5ff2e4731"}, "closed": true, "closedAt": "2020-08-05T08:31:39Z", "author": {"login": "YevhenBondarenko"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7Oj8sgH2gAyNDYyMDU5OTcwOmQzMTUxNTYyMDRiZDIxZDQ2YTZjNmY1YThjYjkzOTM2ZTI5MzkyMTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7S7E9AFqTQ2MDA3NTQ2Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d315156204bd21d46a6c6f5a8cb93936e2939216", "author": {"user": {"login": "YevhenBondarenko", "name": "Yevhen Bondarenko"}}, "url": "https://github.com/thingsboard/thingsboard/commit/d315156204bd21d46a6c6f5a8cb93936e2939216", "committedDate": "2020-08-03T09:25:33Z", "message": "created procedure insert_tb_schema_settings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMDc1NDY2", "url": "https://github.com/thingsboard/thingsboard/pull/3217#pullrequestreview-460075466", "createdAt": "2020-08-03T14:30:26Z", "commit": {"oid": "d315156204bd21d46a6c6f5a8cb93936e2939216"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNDozMDoyNlrOG671sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNDozMDoyNlrOG671sA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQ1MDk5Mg==", "bodyText": "else - update?", "url": "https://github.com/thingsboard/thingsboard/pull/3217#discussion_r464450992", "createdAt": "2020-08-03T14:30:26Z", "author": {"login": "ashvayka"}, "path": "dao/src/main/resources/sql/schema-entities.sql", "diffHunk": "@@ -20,7 +20,17 @@ CREATE TABLE IF NOT EXISTS tb_schema_settings\n     CONSTRAINT tb_schema_settings_pkey PRIMARY KEY (schema_version)\n );\n \n-INSERT INTO tb_schema_settings (schema_version) VALUES (3001000) ON CONFLICT (schema_version) DO UPDATE SET schema_version = 3001000;\n+CREATE OR REPLACE PROCEDURE insert_tb_schema_settings()\n+    LANGUAGE plpgsql AS\n+$$\n+BEGIN\n+    IF (SELECT COUNT(*) FROM tb_schema_settings) = 0 THEN\n+        INSERT INTO tb_schema_settings (schema_version) VALUES (3001000);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d315156204bd21d46a6c6f5a8cb93936e2939216"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3280, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}