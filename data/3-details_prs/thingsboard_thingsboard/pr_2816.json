{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNzk4MzM5", "number": 2816, "title": "[2.5.1] DefaultTransportApiService improvements", "bodyText": "send ENTITY_CREATED event after creating new device from gateway request", "createdAt": "2020-05-22T08:49:57Z", "url": "https://github.com/thingsboard/thingsboard/pull/2816", "merged": true, "mergeCommit": {"oid": "ffe9a40b47a21fe0a3b1a9200f67ca42e6350619"}, "closed": true, "closedAt": "2020-05-25T12:39:13Z", "author": {"login": "YevhenBondarenko"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjuRZaAH2gAyNDIxNzk4MzM5OmQwMzE0MzFjNjQ5NmJjY2RjYTVlOWFiYmVmNWRiN2YyOGY2ZWMxNDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjyGouAH2gAyNDIxNzk4MzM5OjE0MDM5ZDkxNTFjOGMwYjdjMjkyMDk5OGE0Mjc4NzkwMDE2ZDU1OGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d031431c6496bccdca5e9abbef5db7f28f6ec145", "author": {"user": {"login": "YevhenBondarenko", "name": "Yevhen Bondarenko"}}, "url": "https://github.com/thingsboard/thingsboard/commit/d031431c6496bccdca5e9abbef5db7f28f6ec145", "committedDate": "2020-05-22T08:48:04Z", "message": "DefaultTransportApiService improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2ODUyNTY2", "url": "https://github.com/thingsboard/thingsboard/pull/2816#pullrequestreview-416852566", "createdAt": "2020-05-22T11:53:04Z", "commit": {"oid": "d031431c6496bccdca5e9abbef5db7f28f6ec145"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxMTo1MzowNFrOGZUc1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxMTo1MzowNFrOGZUc1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTIwMjY0NA==", "bodyText": "NPE", "url": "https://github.com/thingsboard/thingsboard/pull/2816#discussion_r429202644", "createdAt": "2020-05-22T11:53:04Z", "author": {"login": "ashvayka"}, "path": "application/src/main/java/org/thingsboard/server/service/transport/DefaultTransportApiService.java", "diffHunk": "@@ -119,14 +128,23 @@\n             try {\n                 Device device = deviceService.findDeviceByTenantIdAndName(gateway.getTenantId(), requestMsg.getDeviceName());\n                 if (device == null) {\n+                    TenantId tenantId = gateway.getTenantId();\n                     device = new Device();\n-                    device.setTenantId(gateway.getTenantId());\n+                    device.setTenantId(tenantId);\n                     device.setName(requestMsg.getDeviceName());\n                     device.setType(requestMsg.getDeviceType());\n                     device.setCustomerId(gateway.getCustomerId());\n                     device = deviceService.saveDevice(device);\n                     relationService.saveRelationAsync(TenantId.SYS_TENANT_ID, new EntityRelation(gateway.getId(), device.getId(), \"Created\"));\n                     deviceStateService.onDeviceAdded(device);\n+\n+                    TbMsgMetaData metaData = new TbMsgMetaData();\n+                    metaData.putValue(\"customerId\", device.getCustomerId().toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d031431c6496bccdca5e9abbef5db7f28f6ec145"}, "originalPosition": 60}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14039d9151c8c0b7c2920998a4278790016d558b", "author": {"user": {"login": "YevhenBondarenko", "name": "Yevhen Bondarenko"}}, "url": "https://github.com/thingsboard/thingsboard/commit/14039d9151c8c0b7c2920998a4278790016d558b", "committedDate": "2020-05-22T13:15:56Z", "message": "added gatewayId to metadata in ENTITY_CREATED event msg"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3293, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}