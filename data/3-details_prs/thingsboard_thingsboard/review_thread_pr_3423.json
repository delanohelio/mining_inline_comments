{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxNTIzNDA2", "number": 3423, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTo1NDo0NFrOEpGMyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTo1ODoxMlrOEpGSrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTI4NjQ5OnYy", "diffSide": "RIGHT", "path": "common/data/src/main/java/org/thingsboard/server/common/data/device/profile/MqttDeviceProfileTransportConfiguration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTo1NDo0NFrOHakYmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTo1NDo0NFrOHakYmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzYyMTE0Ng==", "bodyText": "please assign default value.", "url": "https://github.com/thingsboard/thingsboard/pull/3423#discussion_r497621146", "createdAt": "2020-09-30T15:54:44Z", "author": {"login": "ashvayka"}, "path": "common/data/src/main/java/org/thingsboard/server/common/data/device/profile/MqttDeviceProfileTransportConfiguration.java", "diffHunk": "@@ -16,11 +16,14 @@\n package org.thingsboard.server.common.data.device.profile;\n \n import lombok.Data;\n+import org.thingsboard.server.common.data.TransportPayloadType;\n import org.thingsboard.server.common.data.DeviceTransportType;\n \n @Data\n public class MqttDeviceProfileTransportConfiguration implements DeviceProfileTransportConfiguration {\n \n+    private TransportPayloadType transportPayloadType;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "511d136bfa1c7f7a54daa0672748c92d7f6d6c1f"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTI5Mzc1OnYy", "diffSide": "RIGHT", "path": "common/queue/src/main/proto/queue.proto", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTo1NjoxOFrOHakdGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTo1NjoxOFrOHakdGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzYyMjI5Nw==", "bodyText": "This may cause us problems during upgrade (if some data is in the queue). Why not UNKNOWN= something else?", "url": "https://github.com/thingsboard/thingsboard/pull/3423#discussion_r497622297", "createdAt": "2020-09-30T15:56:18Z", "author": {"login": "ashvayka"}, "path": "common/queue/src/main/proto/queue.proto", "diffHunk": "@@ -66,11 +66,12 @@ enum SessionType {\n }\n \n enum KeyValueType {\n-  BOOLEAN_V = 0;\n-  LONG_V = 1;\n-  DOUBLE_V = 2;\n-  STRING_V = 3;\n-  JSON_V = 4;\n+  UNKNOWN = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "511d136bfa1c7f7a54daa0672748c92d7f6d6c1f"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTMwMTU3OnYy", "diffSide": "RIGHT", "path": "common/transport/mqtt/src/main/java/org/thingsboard/server/transport/mqtt/MqttTransportHandler.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTo1ODoxMlrOHakiDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTo1ODoxMlrOHakiDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzYyMzU2Nw==", "bodyText": "var adaptor = deviceSessionCtx.getPayloadAdaptor(). Then you don't need to do a copy-paste all the time.", "url": "https://github.com/thingsboard/thingsboard/pull/3423#discussion_r497623567", "createdAt": "2020-09-30T15:58:12Z", "author": {"login": "ashvayka"}, "path": "common/transport/mqtt/src/main/java/org/thingsboard/server/transport/mqtt/MqttTransportHandler.java", "diffHunk": "@@ -216,22 +243,28 @@ private void handleGatewayPublishMsg(String topicName, int msgId, MqttPublishMes\n     private void processDevicePublish(ChannelHandlerContext ctx, MqttPublishMessage mqttMsg, String topicName, int msgId) {\n         try {\n             if (deviceSessionCtx.isDeviceTelemetryTopic(topicName)) {\n-                TransportProtos.PostTelemetryMsg postTelemetryMsg = adaptor.convertToPostTelemetry(deviceSessionCtx, mqttMsg);\n+                TransportProtos.PostTelemetryMsg postTelemetryMsg = deviceSessionCtx.isJsonPayloadType() ?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "511d136bfa1c7f7a54daa0672748c92d7f6d6c1f"}, "originalPosition": 123}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1350, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}