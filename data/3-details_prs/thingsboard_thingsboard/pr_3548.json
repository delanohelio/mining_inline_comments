{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4NTc3NDQ1", "number": 3548, "title": "[2.5.5] fix enqueue methods impl in DefaultTbContext", "bodyText": "", "createdAt": "2020-10-06T14:11:47Z", "url": "https://github.com/thingsboard/thingsboard/pull/3548", "merged": true, "mergeCommit": {"oid": "0356431856774952d762b1f5c2392411c2c7e74b"}, "closed": true, "closedAt": "2020-10-07T09:06:52Z", "author": {"login": "ShvaykaD"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdP5AmygH2gAyNDk4NTc3NDQ1OmEzYjAwNWU0NWEwMWI1NDA0NGE0NzgwZmEzNmIyNjM3MTIzNjRjMGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdP6okHAH2gAyNDk4NTc3NDQ1OjdjZmE5N2FiNWVkYjJmN2U0MTZiNmE5MGMzYjgyMjFjYjYwMTE4MDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a3b005e45a01b54044a4780fa36b263712364c0e", "author": {"user": {"login": "ShvaykaD", "name": null}}, "url": "https://github.com/thingsboard/thingsboard/commit/a3b005e45a01b54044a4780fa36b263712364c0e", "committedDate": "2020-10-06T14:11:21Z", "message": "added queueName to enqueueForTellNext in TbSendRPCRequestNode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzMTExMTQ2", "url": "https://github.com/thingsboard/thingsboard/pull/3548#pullrequestreview-503111146", "createdAt": "2020-10-06T15:47:09Z", "commit": {"oid": "a3b005e45a01b54044a4780fa36b263712364c0e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNTo0NzoxMFrOHdOZ0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNTo0NzoxMFrOHdOZ0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQwNjczOQ==", "bodyText": "This fixes usage of the API but not the problem with the API itself. Please update your fix with the following idea:\n    @Override\n    public void enqueueForTellNext(TbMsg tbMsg, String relationType) {\n        TopicPartitionInfo tpi = mainCtx.resolve(ServiceType.TB_RULE_ENGINE, tbMsg.getQueueName(), getTenantId(), tbMsg.getOriginator());\n        enqueueForTellNext(tpi, tbMsg, Collections.singleton(relationType), null, null, null);\n    }", "url": "https://github.com/thingsboard/thingsboard/pull/3548#discussion_r500406739", "createdAt": "2020-10-06T15:47:10Z", "author": {"login": "ashvayka"}, "path": "rule-engine/rule-engine-components/src/main/java/org/thingsboard/rule/engine/rpc/TbSendRPCRequestNode.java", "diffHunk": "@@ -113,7 +113,7 @@ public void onMsg(TbContext ctx, TbMsg msg) {\n             ctx.getRpcService().sendRpcRequestToDevice(request, ruleEngineDeviceRpcResponse -> {\n                 if (!ruleEngineDeviceRpcResponse.getError().isPresent()) {\n                     TbMsg next = ctx.newMsg(msg.getQueueName(), msg.getType(), msg.getOriginator(), msg.getMetaData(), ruleEngineDeviceRpcResponse.getResponse().orElse(\"{}\"));\n-                    ctx.enqueueForTellNext(next, TbRelationTypes.SUCCESS);\n+                    ctx.enqueueForTellNext(next, next.getQueueName(), TbRelationTypes.SUCCESS, null, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3b005e45a01b54044a4780fa36b263712364c0e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94bb9f5be3c3ca878b9ed5d6b95a7e3156c29ea0", "author": {"user": {"login": "ShvaykaD", "name": null}}, "url": "https://github.com/thingsboard/thingsboard/commit/94bb9f5be3c3ca878b9ed5d6b95a7e3156c29ea0", "committedDate": "2020-10-06T15:59:18Z", "message": "update the fix in the API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7cfa97ab5edb2f7e416b6a90c3b8221cb6011803", "author": {"user": {"login": "ShvaykaD", "name": null}}, "url": "https://github.com/thingsboard/thingsboard/commit/7cfa97ab5edb2f7e416b6a90c3b8221cb6011803", "committedDate": "2020-10-06T16:04:54Z", "message": "refactoring"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3249, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}