{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzNjY5NzI5", "number": 833, "title": "fix(prov-dev, prov-serv): Fix provisioning clients not sending content length with http requests", "bodyText": "DPS would occasionally return a 411 error because this wasn't being sent on registration requests and enrollment creations\nIt doesn't appear to be a hard requirement since tests usually pass without them, but just to be safe we should send them. The 411 failures seem to disappear once this change is made.", "createdAt": "2020-07-02T18:06:03Z", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/833", "merged": true, "mergeCommit": {"oid": "a9d764f4259615b41e8fdb7d8ab2bc15ab8c5adc"}, "closed": true, "closedAt": "2020-07-07T16:27:51Z", "author": {"login": "timtay-microsoft"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcxCz6YgH2gAyNDQzNjY5NzI5OmRlYjBiNTI5OGY1N2ZhYzIwZDNiNDQ4NzUzYjg3MGMzMTM4YTNlZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcybj_xgFqTQ0MzUwMjY1Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "deb0b5298f57fac20d3b448753b870c3138a3ee3", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/deb0b5298f57fac20d3b448753b870c3138a3ee3", "committedDate": "2020-07-02T18:04:53Z", "message": "fix(prov-dev, prov-serv): Fix provisioning clients not sending content length with http requests\n\nDPS would occasionally return a 411 error because this wasn't being sent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c97bd109e7ac751f49dccfe75821b1f67e3726e", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/3c97bd109e7ac751f49dccfe75821b1f67e3726e", "committedDate": "2020-07-06T17:13:19Z", "message": "Merge branch 'master' into timtay/provisioningTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac167e9bd72ce78c0dcd4241e04ff1d48642956d", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/ac167e9bd72ce78c0dcd4241e04ff1d48642956d", "committedDate": "2020-07-06T20:10:02Z", "message": "Merge branch 'master' into timtay/provisioningTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f0d0916ce33a93d45d68415b1924907aa52d2ba", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/7f0d0916ce33a93d45d68415b1924907aa52d2ba", "committedDate": "2020-07-07T00:56:33Z", "message": "Merge branch 'master' into timtay/provisioningTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNTAyMjM0", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/833#pullrequestreview-443502234", "createdAt": "2020-07-07T01:27:33Z", "commit": {"oid": "7f0d0916ce33a93d45d68415b1924907aa52d2ba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwMToyNzozM1rOGtsFsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwMToyNzozM1rOGtsFsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU2MTQ1OQ==", "bodyText": "If this is not a hard requirement, why was it throwing failure only occasionally?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/833#discussion_r450561459", "createdAt": "2020-07-07T01:27:33Z", "author": {"login": "bikamani"}, "path": "provisioning/provisioning-service-client/src/main/java/com/microsoft/azure/sdk/iot/provisioning/service/contract/ContractApiHttp.java", "diffHunk": "@@ -183,6 +184,7 @@ private HttpRequest createRequest(URL url, HttpMethod method, Map<String, String\n         request.setHeaderField(HEADER_FIELD_NAME_ACCEPT, HEADER_FIELD_VALUE_ACCEPT);\n         request.setHeaderField(HEADER_FIELD_NAME_CONTENT_TYPE, HEADER_FIELD_VALUE_CONTENT_TYPE);\n         request.setHeaderField(HEADER_FIELD_NAME_CHARSET, HEADER_FIELD_VALUE_CHARSET);\n+        request.setHeaderField(HEADER_FIELD_NAME_CONTENT_LENGTH, payload != null ? String.valueOf(payload.length) : \"0\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f0d0916ce33a93d45d68415b1924907aa52d2ba"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNTAyNjI0", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/833#pullrequestreview-443502624", "createdAt": "2020-07-07T01:28:58Z", "commit": {"oid": "7f0d0916ce33a93d45d68415b1924907aa52d2ba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwMToyODo1OFrOGtsG-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QwMToyODo1OFrOGtsG-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU2MTc4Nw==", "bodyText": "Do we not have any e2e tests for this change?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/833#discussion_r450561787", "createdAt": "2020-07-07T01:28:58Z", "author": {"login": "bikamani"}, "path": "provisioning/provisioning-device-client/src/main/java/com/microsoft/azure/sdk/iot/provisioning/device/internal/contract/http/ContractAPIHttp.java", "diffHunk": "@@ -126,6 +127,7 @@ private HttpRequest prepareRequest(\n         request.setHeaderField(USER_AGENT, userAgentValue);\n         request.setHeaderField(ACCEPT, ACCEPT_VALUE);\n         request.setHeaderField(CONTENT_TYPE, ACCEPT_VALUE + \"; \" + ACCEPT_CHARSET);\n+        request.setHeaderField(CONTENT_LENGTH, payload != null ? String.valueOf(payload.length) : \"0\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f0d0916ce33a93d45d68415b1924907aa52d2ba"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNTAyNjU2", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/833#pullrequestreview-443502656", "createdAt": "2020-07-07T01:29:03Z", "commit": {"oid": "7f0d0916ce33a93d45d68415b1924907aa52d2ba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1711, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}