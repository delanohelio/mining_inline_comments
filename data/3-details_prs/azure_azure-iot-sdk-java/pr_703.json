{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyMTUxODUx", "number": 703, "title": "fix(deps, prov-service): Remove SDK-side validation of max twin depth", "bodyText": "Twin depth limits may be arbitrarily changed by services, so there is no reason to validate them on the SDK side. It happened once already when the Iot Hub's max depth went from 5 to 10, and the SDK became inconsistent.\nFixes issue #699", "createdAt": "2020-02-06T22:53:08Z", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/703", "merged": true, "mergeCommit": {"oid": "cd9cabc6092160ceb1db50b920f9d9d2206af1ae"}, "closed": true, "closedAt": "2020-02-08T01:47:13Z", "author": {"login": "timtay-microsoft"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcByy0XAH2gAyMzcyMTUxODUxOjc0OGJjNTcxMDA5ODQyNmYwYWUzMDgwN2E0MGQ3YTYxNDY4ZmYwY2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcCIDrFgH2gAyMzcyMTUxODUxOjQ1MmQwMmZhMGQ3NWI2MTI3MDBiNDY0Y2M3OGNjYjBmZDcwOGU0YjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "748bc5710098426f0ae30807a40d7a61468ff0cf", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/748bc5710098426f0ae30807a40d7a61468ff0cf", "committedDate": "2020-02-06T22:50:46Z", "message": "fix(deps, prov-service): Remove SDK-side validation of max twin depth\n\nDepth limits may be arbitrarily changed by services, so there is no reason to validate them on the SDK side"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "292156328a1b0daace597f2bea861de0153c0a07", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/292156328a1b0daace597f2bea861de0153c0a07", "committedDate": "2020-02-07T00:09:21Z", "message": "Merge branch 'master' into twinDepth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0cfd49a5fc05078126b8b8affee59bcbfca6ac87", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/0cfd49a5fc05078126b8b8affee59bcbfca6ac87", "committedDate": "2020-02-07T18:29:02Z", "message": "to squash"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NDgzNDk1", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/703#pullrequestreview-355483495", "createdAt": "2020-02-07T22:52:10Z", "commit": {"oid": "0cfd49a5fc05078126b8b8affee59bcbfca6ac87"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMjo1MjoxMFrOFnMjjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMjo1Mzo0MFrOFnMlLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY0NDQ5Mw==", "bodyText": "is the allow metadata still being used for any validation?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/703#discussion_r376644493", "createdAt": "2020-02-07T22:52:10Z", "author": {"login": "abhipsaMisra"}, "path": "deps/src/main/java/com/microsoft/azure/sdk/iot/deps/serializer/ParserUtility.java", "diffHunk": "@@ -234,17 +226,7 @@ private static void validateMapInternal(Map<String, Object> map, int level, int\n             if((value != null) && (value instanceof Map))\n             {\n                 /* Codes_SRS_PARSER_UTILITY_21_052: [The validateMap shall throws IllegalArgumentException if the provided map contains more than maxLevel levels and those extra levels contain more than just metadata.] */\n-                if(level <= maxLevel)\n-                {\n-                    validateMapInternal((Map<String, Object>) value, level, maxLevel, allowMetadata);\n-                }\n-                else\n-                {\n-                    if (!mapOnlyContainsMetaData((Map<String, Object>)value))\n-                    {\n-                        throw new IllegalArgumentException(\"Map exceed maximum of \" + maxLevel + \" levels\");\n-                    }\n-                }\n+                validateMapInternal((Map<String, Object>) value, allowMetadata);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0cfd49a5fc05078126b8b8affee59bcbfca6ac87"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY0NDkwOA==", "bodyText": "there are other validations still being done; valid characters, size etc. This might be a good time to scrub through those and remove them.", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/703#discussion_r376644908", "createdAt": "2020-02-07T22:53:40Z", "author": {"login": "abhipsaMisra"}, "path": "deps/src/main/java/com/microsoft/azure/sdk/iot/deps/serializer/ParserUtility.java", "diffHunk": "@@ -234,17 +226,7 @@ private static void validateMapInternal(Map<String, Object> map, int level, int\n             if((value != null) && (value instanceof Map))\n             {\n                 /* Codes_SRS_PARSER_UTILITY_21_052: [The validateMap shall throws IllegalArgumentException if the provided map contains more than maxLevel levels and those extra levels contain more than just metadata.] */\n-                if(level <= maxLevel)\n-                {\n-                    validateMapInternal((Map<String, Object>) value, level, maxLevel, allowMetadata);\n-                }\n-                else\n-                {\n-                    if (!mapOnlyContainsMetaData((Map<String, Object>)value))\n-                    {\n-                        throw new IllegalArgumentException(\"Map exceed maximum of \" + maxLevel + \" levels\");\n-                    }\n-                }\n+                validateMapInternal((Map<String, Object>) value, allowMetadata);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY0NDQ5Mw=="}, "originalCommit": {"oid": "0cfd49a5fc05078126b8b8affee59bcbfca6ac87"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e58a1d2fc1a7ce85b8953a63255a66cc0e18a39a", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/e58a1d2fc1a7ce85b8953a63255a66cc0e18a39a", "committedDate": "2020-02-07T23:12:05Z", "message": "to squash"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "452d02fa0d75b612700b464cc78ccb0fd708e4b3", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/452d02fa0d75b612700b464cc78ccb0fd708e4b3", "committedDate": "2020-02-07T23:37:11Z", "message": "squash"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1813, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}