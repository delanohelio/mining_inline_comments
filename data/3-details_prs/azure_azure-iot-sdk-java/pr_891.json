{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3MDEwMTY1", "number": 891, "title": "fix(iot-dev): Fix issue where errors encountered at http message level were handled twice", "bodyText": "This same logic took place at the IotHubTransport layer based on the result of this method call, so no need to include this logic in the HTTP layer\nYou can see this logic here:\n\n  \n    \n      azure-iot-sdk-java/device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/transport/IotHubTransport.java\n    \n    \n         Line 1026\n      in\n      5867a93\n    \n    \n    \n    \n\n        \n          \n           if (statusCode != IotHubStatusCode.OK_EMPTY && statusCode != IotHubStatusCode.OK)", "createdAt": "2020-08-12T21:11:17Z", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/891", "merged": true, "mergeCommit": {"oid": "8d3327c6b4334947e35a9831382e8ab7ad899b0b"}, "closed": true, "closedAt": "2020-08-13T00:31:05Z", "author": {"login": "timtay-microsoft"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-SCAQAH2gAyNDY3MDEwMTY1OmE0YmFiNTcwYjZiODljNWJlOGU5YzQ0ZmY0YjRhNGY0NDY0YWZjOTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-UiczgFqTQ2NjM1NTM0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a4bab570b6b89c5be8e9c44ff4b4a4f4464afc95", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/a4bab570b6b89c5be8e9c44ff4b4a4f4464afc95", "committedDate": "2020-08-12T21:09:52Z", "message": "fix(iot-dev): Fix issue where errors encountered at http message level were handled twice\n\nThis same logic took place at the IotHubTransport layer based on the result of this method call, so no need to include this logic in the HTTP layer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MjgyNTY2", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/891#pullrequestreview-466282566", "createdAt": "2020-08-12T21:14:49Z", "commit": {"oid": "a4bab570b6b89c5be8e9c44ff4b4a4f4464afc95"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMToxNDo0OVrOG_zHvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMToxNDo0OVrOG_zHvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU1MTAzNw==", "bodyText": "Can you point to where it is handled?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/891#discussion_r469551037", "createdAt": "2020-08-12T21:14:49Z", "author": {"login": "vinagesh"}, "path": "device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/transport/https/HttpsIotHubConnection.java", "diffHunk": "@@ -151,11 +151,6 @@ public IotHubStatusCode sendMessage(Message message) throws TransportException\n                 //Codes_SRS_HTTPSIOTHUBCONNECTION_34_067: [If the response from the service is OK or OK_EMPTY, this function shall notify its listener that a message was sent with no exception.]\n                 this.listener.onMessageSent(transportMessage, null);\n             }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4bab570b6b89c5be8e9c44ff4b4a4f4464afc95"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MjgyNjQ0", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/891#pullrequestreview-466282644", "createdAt": "2020-08-12T21:14:56Z", "commit": {"oid": "a4bab570b6b89c5be8e9c44ff4b4a4f4464afc95"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "036345c67a128241f8495a6dc2207de03b0216f3", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/036345c67a128241f8495a6dc2207de03b0216f3", "committedDate": "2020-08-12T21:18:47Z", "message": "squash"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66c3061b1bae6b88895d8d60228a8390e8598deb", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/66c3061b1bae6b88895d8d60228a8390e8598deb", "committedDate": "2020-08-12T23:22:22Z", "message": "Merge branch 'master' into timtay/httpFix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MzQ3OTU4", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/891#pullrequestreview-466347958", "createdAt": "2020-08-12T23:42:54Z", "commit": {"oid": "66c3061b1bae6b88895d8d60228a8390e8598deb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMzo0Mjo1NFrOG_2iTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMzo0Mjo1NFrOG_2iTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTYwNjk4OQ==", "bodyText": "so is it throwing exception at both layers currently?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/891#discussion_r469606989", "createdAt": "2020-08-12T23:42:54Z", "author": {"login": "bikamani"}, "path": "device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/transport/https/HttpsIotHubConnection.java", "diffHunk": "@@ -173,11 +173,9 @@ public IotHubStatusCode sendMessage(Message message) throws TransportException\n                 //Codes_SRS_HTTPSIOTHUBCONNECTION_34_067: [If the response from the service is OK or OK_EMPTY, this function shall notify its listener that a message was sent with no exception.]\n                 this.listener.onMessageSent(transportMessage, null);\n             }\n-            else\n-            {\n-                //Codes_SRS_HTTPSIOTHUBCONNECTION_34_068: [If the response from the service not OK or OK_EMPTY, this function shall notify its listener that a message was with the mapped IotHubServiceException.]\n-                this.listener.onMessageSent(transportMessage, IotHubStatusCode.getConnectionStatusException(status, \"\"));\n-            }\n+\n+            // Status codes other than 200 and 204 have their errors handled in the IotHubTransport layer once this method returns,\n+            // so there is no need to call \"this.listener.onMessageSent(transportMessage, someException)\" from this layer.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66c3061b1bae6b88895d8d60228a8390e8598deb"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9df9d7e78a494ab1b46b88587e7ebc5376deec0f", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/9df9d7e78a494ab1b46b88587e7ebc5376deec0f", "committedDate": "2020-08-12T23:56:24Z", "message": "squash"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MzU1MzQ5", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/891#pullrequestreview-466355349", "createdAt": "2020-08-13T00:05:08Z", "commit": {"oid": "9df9d7e78a494ab1b46b88587e7ebc5376deec0f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1540, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}