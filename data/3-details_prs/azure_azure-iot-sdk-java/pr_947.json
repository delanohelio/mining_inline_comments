{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1MDU5NTUz", "number": 947, "title": "E2E tests and workaround for retrofit error with null payload", "bodyText": "Checklist\n\n I have read the [contribution guidelines] (https://github.com/Azure/azure-iot-sdk-java/blob/master/.github/CONTRIBUTING.md).\n I added or modified the existing tests to cover the change (we do not allow our test coverage to go down).\nIf this is a modification that impacts the behavior of a public API\n\n I edited the corresponding document in the devdoc folder and added or modified requirements.\n\n\nI submitted this PR against the correct branch:\n\n This pull-request is submitted against the master branch.\n\n\n\nReference/Link to the issue solved with this PR (if any)\nDescription of the problem\n\nDescription of the solution\nAdd E2E tests other than update\nFixed retrofit error for null payloads", "createdAt": "2020-09-29T19:41:18Z", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947", "merged": true, "mergeCommit": {"oid": "1655714e6e9938d72f76a34d5c3d606f2e1f473a"}, "closed": true, "closedAt": "2020-09-29T21:43:09Z", "author": {"login": "vinagesh"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNtgVnAH2gAyNDk1MDU5NTUzOmNiZjVlMjU0NjliMGQ1OGU1YmYzMTQyZDA3YTI1MTdhMzkzYzBkZWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNvRiugFqTQ5ODkxNTA2Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cbf5e25469b0d58e5bf3142d07a2517a393c0deb", "author": {"user": {"login": "vinagesh", "name": "Sindhu Nagesh"}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/cbf5e25469b0d58e5bf3142d07a2517a393c0deb", "committedDate": "2020-09-29T19:39:18Z", "message": "E2E tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODIzODQ0", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498823844", "createdAt": "2020-09-29T19:45:12Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo0NToxMlrOHZ-ifg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo0NToxMlrOHZ-ifg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzAwMTA4Ng==", "bodyText": "You're now sending the payload as a string as opposed to as an Object. Is this intentional?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497001086", "createdAt": "2020-09-29T19:45:12Z", "author": {"login": "barustum"}, "path": "service/iot-service-client/src/main/java/com/microsoft/azure/sdk/iot/service/digitaltwin/DigitalTwinAsyncClient.java", "diffHunk": "@@ -183,13 +188,13 @@ public static DigitalTwinAsyncClient createFromConnectionString(String connectio\n             options = new DigitalTwinInvokeCommandRequestOptions();\n         }\n \n-        Object payloadAsObject = null;\n-        if(payload != null)\n+        // Retrofit does not work well with null in body\n+        if(payload == null)\n         {\n-            payloadAsObject = objectMapper.readValue(payload, Object.class);\n+            payload = \"\";\n         }\n \n-        return digitalTwin.invokeRootLevelCommandWithServiceResponseAsync(digitalTwinId, commandName, payloadAsObject, options.getConnectTimeoutInSeconds(), options.getResponseTimeoutInSeconds())\n+        return digitalTwin.invokeRootLevelCommandWithServiceResponseAsync(digitalTwinId, commandName, payload, options.getConnectTimeoutInSeconds(), options.getResponseTimeoutInSeconds())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODI1NjYx", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498825661", "createdAt": "2020-09-29T19:47:49Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo0Nzo1MFrOHZ-oIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo0Nzo1MFrOHZ-oIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzAwMjUyOQ==", "bodyText": "remove space", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497002529", "createdAt": "2020-09-29T19:47:50Z", "author": {"login": "barustum"}, "path": "iot-e2e-tests/common/src/test/java/tests/integration/com/microsoft/azure/sdk/iot/digitaltwin/DigitalTwinClientComponentTests.java", "diffHunk": "@@ -0,0 +1,211 @@\n+package tests.integration.com.microsoft.azure.sdk.iot.digitaltwin;\n+\n+import com.microsoft.azure.sdk.iot.device.*;\n+import com.microsoft.azure.sdk.iot.device.DeviceTwin.*;\n+import com.microsoft.azure.sdk.iot.service.Device;\n+import com.microsoft.azure.sdk.iot.service.RegistryManager;\n+import com.microsoft.azure.sdk.iot.service.auth.AuthenticationType;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.DigitalTwinAsyncClient;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.DigitalTwinClient;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.generated.models.DigitalTwinGetHeaders;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.helpers.UpdateOperationUtility;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.models.*;\n+import com.microsoft.azure.sdk.iot.service.exceptions.IotHubException;\n+import com.microsoft.rest.ServiceResponseWithHeaders;\n+import lombok.extern.slf4j.Slf4j;\n+import org.junit.*;\n+import org.junit.rules.Timeout;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import tests.integration.com.microsoft.azure.sdk.iot.digitaltwin.helpers.E2ETestConstants;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.IntegrationTest;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.Tools;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.annotations.DigitalTwinTest;\n+import tests.integration.com.microsoft.azure.sdk.iot.iothub.twin.TwinPnPTests;\n+\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.time.ZoneOffset;\n+import java.time.ZonedDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.util.*;\n+\n+import static com.microsoft.azure.sdk.iot.device.IotHubClientProtocol.MQTT;\n+import static com.microsoft.azure.sdk.iot.device.IotHubClientProtocol.MQTT_WS;\n+import static java.util.Arrays.asList;\n+import static org.junit.Assert.assertEquals;\n+\n+@DigitalTwinTest\n+@Slf4j\n+@RunWith(Parameterized.class)\n+public class DigitalTwinClientComponentTests extends IntegrationTest\n+{\n+\n+    private static final String IOTHUB_CONNECTION_STRING = Tools.retrieveEnvironmentVariableValue(E2ETestConstants.IOTHUB_CONNECTION_STRING_ENV_VAR_NAME);\n+    private static RegistryManager registryManager;\n+    private String deviceId;\n+    private DeviceClient deviceClient;\n+    private DigitalTwinClient digitalTwinClient = null;\n+    private static final String DEVICE_ID_PREFIX = \"DigitalTwinServiceClientTests_\";\n+\n+    @Rule\n+    public Timeout globalTimeout = Timeout.seconds(5 * 60); // 5 minutes max per method tested\n+\n+    @Parameterized.Parameter(0)\n+    public IotHubClientProtocol protocol;\n+\n+    @Parameterized.Parameters(name = \"{index}: Digital Twin Test: protocol={0}\")\n+    public static Collection<Object[]> data() {\n+        return asList(new Object[][] {\n+                {MQTT},\n+                {MQTT_WS},\n+        });\n+    }\n+\n+    @BeforeClass\n+    public static void setUpBeforeClass() throws IOException {\n+        registryManager = RegistryManager.createFromConnectionString(IOTHUB_CONNECTION_STRING);\n+    }\n+\n+    @Before\n+    public void setUp() throws URISyntaxException, IOException, IotHubException {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 72}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODI4MTM1", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498828135", "createdAt": "2020-09-29T19:51:29Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo1MToyOVrOHZ-vqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo1MToyOVrOHZ-vqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzAwNDQ1Ng==", "bodyText": "empty test", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497004456", "createdAt": "2020-09-29T19:51:29Z", "author": {"login": "barustum"}, "path": "iot-e2e-tests/common/src/test/java/tests/integration/com/microsoft/azure/sdk/iot/digitaltwin/DigitalTwinClientComponentTests.java", "diffHunk": "@@ -0,0 +1,211 @@\n+package tests.integration.com.microsoft.azure.sdk.iot.digitaltwin;\n+\n+import com.microsoft.azure.sdk.iot.device.*;\n+import com.microsoft.azure.sdk.iot.device.DeviceTwin.*;\n+import com.microsoft.azure.sdk.iot.service.Device;\n+import com.microsoft.azure.sdk.iot.service.RegistryManager;\n+import com.microsoft.azure.sdk.iot.service.auth.AuthenticationType;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.DigitalTwinAsyncClient;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.DigitalTwinClient;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.generated.models.DigitalTwinGetHeaders;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.helpers.UpdateOperationUtility;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.models.*;\n+import com.microsoft.azure.sdk.iot.service.exceptions.IotHubException;\n+import com.microsoft.rest.ServiceResponseWithHeaders;\n+import lombok.extern.slf4j.Slf4j;\n+import org.junit.*;\n+import org.junit.rules.Timeout;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import tests.integration.com.microsoft.azure.sdk.iot.digitaltwin.helpers.E2ETestConstants;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.IntegrationTest;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.Tools;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.annotations.DigitalTwinTest;\n+import tests.integration.com.microsoft.azure.sdk.iot.iothub.twin.TwinPnPTests;\n+\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.time.ZoneOffset;\n+import java.time.ZonedDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.util.*;\n+\n+import static com.microsoft.azure.sdk.iot.device.IotHubClientProtocol.MQTT;\n+import static com.microsoft.azure.sdk.iot.device.IotHubClientProtocol.MQTT_WS;\n+import static java.util.Arrays.asList;\n+import static org.junit.Assert.assertEquals;\n+\n+@DigitalTwinTest\n+@Slf4j\n+@RunWith(Parameterized.class)\n+public class DigitalTwinClientComponentTests extends IntegrationTest\n+{\n+\n+    private static final String IOTHUB_CONNECTION_STRING = Tools.retrieveEnvironmentVariableValue(E2ETestConstants.IOTHUB_CONNECTION_STRING_ENV_VAR_NAME);\n+    private static RegistryManager registryManager;\n+    private String deviceId;\n+    private DeviceClient deviceClient;\n+    private DigitalTwinClient digitalTwinClient = null;\n+    private static final String DEVICE_ID_PREFIX = \"DigitalTwinServiceClientTests_\";\n+\n+    @Rule\n+    public Timeout globalTimeout = Timeout.seconds(5 * 60); // 5 minutes max per method tested\n+\n+    @Parameterized.Parameter(0)\n+    public IotHubClientProtocol protocol;\n+\n+    @Parameterized.Parameters(name = \"{index}: Digital Twin Test: protocol={0}\")\n+    public static Collection<Object[]> data() {\n+        return asList(new Object[][] {\n+                {MQTT},\n+                {MQTT_WS},\n+        });\n+    }\n+\n+    @BeforeClass\n+    public static void setUpBeforeClass() throws IOException {\n+        registryManager = RegistryManager.createFromConnectionString(IOTHUB_CONNECTION_STRING);\n+    }\n+\n+    @Before\n+    public void setUp() throws URISyntaxException, IOException, IotHubException {\n+\n+        this.deviceClient = createDeviceClient(protocol);\n+        deviceClient.open();\n+        digitalTwinClient = DigitalTwinClient.createFromConnectionString(IOTHUB_CONNECTION_STRING);\n+    }\n+\n+    @After\n+    public void cleanUp() {\n+        try {\n+            deviceClient.closeNow();\n+            registryManager.removeDevice(deviceId);\n+        } catch (Exception ex) {\n+            log.error(\"An exception occurred while closing/ deleting the device {}: {}\", deviceId, ex);\n+        }\n+    }\n+\n+    private DeviceClient createDeviceClient(IotHubClientProtocol protocol) throws IOException, IotHubException, URISyntaxException {\n+        ClientOptions options = new ClientOptions();\n+        options.setModelId(E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+\n+        this.deviceId = DEVICE_ID_PREFIX.concat(UUID.randomUUID().toString());\n+        Device device = Device.createDevice(deviceId, AuthenticationType.SAS);\n+        Device registeredDevice = registryManager.addDevice(device);\n+        String deviceConnectionString = registryManager.getDeviceConnectionString(registeredDevice);\n+        return new DeviceClient(deviceConnectionString, protocol, options);\n+    }\n+\n+    @AfterClass\n+    public static void cleanUpAfterClass()\n+    {\n+        registryManager.close();\n+    }\n+\n+    @Test\n+    public void getDigitalTwin() {\n+        // act\n+        BasicDigitalTwin response = this.digitalTwinClient.getDigitalTwin(deviceId, BasicDigitalTwin.class);\n+        ServiceResponseWithHeaders<BasicDigitalTwin, DigitalTwinGetHeaders> responseWithHeaders = this.digitalTwinClient.getDigitalTwinWithResponse(deviceId, BasicDigitalTwin.class);\n+\n+        // assert\n+        assertEquals(response.getMetadata().getModelId(), E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+        assertEquals(responseWithHeaders.body().getMetadata().getModelId(), E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+    }\n+\n+    @Test\n+    public void updateDigitalTwin() throws IOException {\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 118}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODMwMDMx", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498830031", "createdAt": "2020-09-29T19:54:13Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo1NDoxM1rOHZ-1Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo1NDoxM1rOHZ-1Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzAwNTg5MA==", "bodyText": "extract 15 to constant since it's used in multiple tests", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497005890", "createdAt": "2020-09-29T19:54:13Z", "author": {"login": "barustum"}, "path": "iot-e2e-tests/common/src/test/java/tests/integration/com/microsoft/azure/sdk/iot/digitaltwin/DigitalTwinClientComponentTests.java", "diffHunk": "@@ -0,0 +1,211 @@\n+package tests.integration.com.microsoft.azure.sdk.iot.digitaltwin;\n+\n+import com.microsoft.azure.sdk.iot.device.*;\n+import com.microsoft.azure.sdk.iot.device.DeviceTwin.*;\n+import com.microsoft.azure.sdk.iot.service.Device;\n+import com.microsoft.azure.sdk.iot.service.RegistryManager;\n+import com.microsoft.azure.sdk.iot.service.auth.AuthenticationType;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.DigitalTwinAsyncClient;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.DigitalTwinClient;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.generated.models.DigitalTwinGetHeaders;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.helpers.UpdateOperationUtility;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.models.*;\n+import com.microsoft.azure.sdk.iot.service.exceptions.IotHubException;\n+import com.microsoft.rest.ServiceResponseWithHeaders;\n+import lombok.extern.slf4j.Slf4j;\n+import org.junit.*;\n+import org.junit.rules.Timeout;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import tests.integration.com.microsoft.azure.sdk.iot.digitaltwin.helpers.E2ETestConstants;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.IntegrationTest;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.Tools;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.annotations.DigitalTwinTest;\n+import tests.integration.com.microsoft.azure.sdk.iot.iothub.twin.TwinPnPTests;\n+\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.time.ZoneOffset;\n+import java.time.ZonedDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.util.*;\n+\n+import static com.microsoft.azure.sdk.iot.device.IotHubClientProtocol.MQTT;\n+import static com.microsoft.azure.sdk.iot.device.IotHubClientProtocol.MQTT_WS;\n+import static java.util.Arrays.asList;\n+import static org.junit.Assert.assertEquals;\n+\n+@DigitalTwinTest\n+@Slf4j\n+@RunWith(Parameterized.class)\n+public class DigitalTwinClientComponentTests extends IntegrationTest\n+{\n+\n+    private static final String IOTHUB_CONNECTION_STRING = Tools.retrieveEnvironmentVariableValue(E2ETestConstants.IOTHUB_CONNECTION_STRING_ENV_VAR_NAME);\n+    private static RegistryManager registryManager;\n+    private String deviceId;\n+    private DeviceClient deviceClient;\n+    private DigitalTwinClient digitalTwinClient = null;\n+    private static final String DEVICE_ID_PREFIX = \"DigitalTwinServiceClientTests_\";\n+\n+    @Rule\n+    public Timeout globalTimeout = Timeout.seconds(5 * 60); // 5 minutes max per method tested\n+\n+    @Parameterized.Parameter(0)\n+    public IotHubClientProtocol protocol;\n+\n+    @Parameterized.Parameters(name = \"{index}: Digital Twin Test: protocol={0}\")\n+    public static Collection<Object[]> data() {\n+        return asList(new Object[][] {\n+                {MQTT},\n+                {MQTT_WS},\n+        });\n+    }\n+\n+    @BeforeClass\n+    public static void setUpBeforeClass() throws IOException {\n+        registryManager = RegistryManager.createFromConnectionString(IOTHUB_CONNECTION_STRING);\n+    }\n+\n+    @Before\n+    public void setUp() throws URISyntaxException, IOException, IotHubException {\n+\n+        this.deviceClient = createDeviceClient(protocol);\n+        deviceClient.open();\n+        digitalTwinClient = DigitalTwinClient.createFromConnectionString(IOTHUB_CONNECTION_STRING);\n+    }\n+\n+    @After\n+    public void cleanUp() {\n+        try {\n+            deviceClient.closeNow();\n+            registryManager.removeDevice(deviceId);\n+        } catch (Exception ex) {\n+            log.error(\"An exception occurred while closing/ deleting the device {}: {}\", deviceId, ex);\n+        }\n+    }\n+\n+    private DeviceClient createDeviceClient(IotHubClientProtocol protocol) throws IOException, IotHubException, URISyntaxException {\n+        ClientOptions options = new ClientOptions();\n+        options.setModelId(E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+\n+        this.deviceId = DEVICE_ID_PREFIX.concat(UUID.randomUUID().toString());\n+        Device device = Device.createDevice(deviceId, AuthenticationType.SAS);\n+        Device registeredDevice = registryManager.addDevice(device);\n+        String deviceConnectionString = registryManager.getDeviceConnectionString(registeredDevice);\n+        return new DeviceClient(deviceConnectionString, protocol, options);\n+    }\n+\n+    @AfterClass\n+    public static void cleanUpAfterClass()\n+    {\n+        registryManager.close();\n+    }\n+\n+    @Test\n+    public void getDigitalTwin() {\n+        // act\n+        BasicDigitalTwin response = this.digitalTwinClient.getDigitalTwin(deviceId, BasicDigitalTwin.class);\n+        ServiceResponseWithHeaders<BasicDigitalTwin, DigitalTwinGetHeaders> responseWithHeaders = this.digitalTwinClient.getDigitalTwinWithResponse(deviceId, BasicDigitalTwin.class);\n+\n+        // assert\n+        assertEquals(response.getMetadata().getModelId(), E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+        assertEquals(responseWithHeaders.body().getMetadata().getModelId(), E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+    }\n+\n+    @Test\n+    public void updateDigitalTwin() throws IOException {\n+    }\n+\n+    @Test\n+    public void invokeComponentLevelCommand() throws IOException {\n+        // arrange\n+        String componentName = \"thermostat1\";\n+        String commandName = \"getMaxMinReport\";\n+        String commandInput = ZonedDateTime.now(ZoneOffset.UTC).minusMinutes(5).format(DateTimeFormatter.ISO_DATE_TIME);\n+        DigitalTwinInvokeCommandRequestOptions options = new DigitalTwinInvokeCommandRequestOptions();\n+        options.setConnectTimeoutInSeconds(15);\n+        options.setResponseTimeoutInSeconds(15);\n+\n+        // setup device callback\n+        Integer deviceSuccessResponseStatus = 200;\n+        String deviceSuccessResponseMessage = \"Success\";\n+        Integer deviceFailureResponseStatus = 500;\n+        String deviceFailureResponseMessage = \"Failed\";\n+\n+        // Device method callback\n+        String componentCommandName = componentName + \"*\" + commandName;\n+        DeviceMethodCallback deviceMethodCallback = (methodName, methodData, context) -> {\n+            if(methodName.equalsIgnoreCase(componentCommandName)) {\n+                return new DeviceMethodData(deviceSuccessResponseStatus, deviceSuccessResponseMessage);\n+            }\n+            else {\n+                return new DeviceMethodData(deviceFailureResponseStatus, deviceFailureResponseMessage);\n+            }\n+        };\n+\n+        // IotHub event callback\n+        IotHubEventCallback iotHubEventCallback = (responseStatus, callbackContext) -> {};\n+\n+        deviceClient.subscribeToDeviceMethod(deviceMethodCallback, commandName, iotHubEventCallback, commandName);\n+\n+        // act\n+        DigitalTwinCommandResponse responseWithNoPayload = this.digitalTwinClient.invokeComponentCommand(deviceId, componentName, commandName, null);\n+        DigitalTwinCommandResponse response = this.digitalTwinClient.invokeComponentCommand(deviceId, componentName, commandName, commandInput);\n+        ServiceResponseWithHeaders<DigitalTwinCommandResponse, DigitalTwinInvokeCommandHeaders> responseWithHeaders = this.digitalTwinClient.invokeComponentCommandWithResponse(deviceId, componentName, commandName, commandInput, options);\n+\n+        // assert\n+        String receivedDeviceResponseStatus = \"\\\"\" + deviceSuccessResponseMessage + \"\\\"\";\n+        assertEquals(deviceSuccessResponseStatus, responseWithNoPayload.getStatus());\n+        assertEquals(receivedDeviceResponseStatus, responseWithNoPayload.getPayload());\n+        assertEquals(deviceSuccessResponseStatus, responseWithNoPayload.getStatus());\n+        assertEquals(receivedDeviceResponseStatus, response.getPayload());\n+        assertEquals(deviceSuccessResponseStatus, responseWithHeaders.body().getStatus());\n+        assertEquals(receivedDeviceResponseStatus, responseWithHeaders.body().getPayload());\n+    }\n+\n+    @Test\n+    public void invokeRootLevelCommand() throws IOException {\n+        // arrange\n+        String commandName = \"reboot\";\n+        String commandInput = \"5\";\n+        DigitalTwinInvokeCommandRequestOptions options = new DigitalTwinInvokeCommandRequestOptions();\n+        options.setConnectTimeoutInSeconds(15);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 173}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODMwMzg3", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498830387", "createdAt": "2020-09-29T19:54:45Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo1NDo0NVrOHZ-2Xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxOTo1NDo0NVrOHZ-2Xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzAwNjE3NA==", "bodyText": "extract variables in this block to constants", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497006174", "createdAt": "2020-09-29T19:54:45Z", "author": {"login": "barustum"}, "path": "iot-e2e-tests/common/src/test/java/tests/integration/com/microsoft/azure/sdk/iot/digitaltwin/DigitalTwinClientComponentTests.java", "diffHunk": "@@ -0,0 +1,211 @@\n+package tests.integration.com.microsoft.azure.sdk.iot.digitaltwin;\n+\n+import com.microsoft.azure.sdk.iot.device.*;\n+import com.microsoft.azure.sdk.iot.device.DeviceTwin.*;\n+import com.microsoft.azure.sdk.iot.service.Device;\n+import com.microsoft.azure.sdk.iot.service.RegistryManager;\n+import com.microsoft.azure.sdk.iot.service.auth.AuthenticationType;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.DigitalTwinAsyncClient;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.DigitalTwinClient;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.generated.models.DigitalTwinGetHeaders;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.helpers.UpdateOperationUtility;\n+import com.microsoft.azure.sdk.iot.service.digitaltwin.models.*;\n+import com.microsoft.azure.sdk.iot.service.exceptions.IotHubException;\n+import com.microsoft.rest.ServiceResponseWithHeaders;\n+import lombok.extern.slf4j.Slf4j;\n+import org.junit.*;\n+import org.junit.rules.Timeout;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import tests.integration.com.microsoft.azure.sdk.iot.digitaltwin.helpers.E2ETestConstants;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.IntegrationTest;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.Tools;\n+import tests.integration.com.microsoft.azure.sdk.iot.helpers.annotations.DigitalTwinTest;\n+import tests.integration.com.microsoft.azure.sdk.iot.iothub.twin.TwinPnPTests;\n+\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.time.ZoneOffset;\n+import java.time.ZonedDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.util.*;\n+\n+import static com.microsoft.azure.sdk.iot.device.IotHubClientProtocol.MQTT;\n+import static com.microsoft.azure.sdk.iot.device.IotHubClientProtocol.MQTT_WS;\n+import static java.util.Arrays.asList;\n+import static org.junit.Assert.assertEquals;\n+\n+@DigitalTwinTest\n+@Slf4j\n+@RunWith(Parameterized.class)\n+public class DigitalTwinClientComponentTests extends IntegrationTest\n+{\n+\n+    private static final String IOTHUB_CONNECTION_STRING = Tools.retrieveEnvironmentVariableValue(E2ETestConstants.IOTHUB_CONNECTION_STRING_ENV_VAR_NAME);\n+    private static RegistryManager registryManager;\n+    private String deviceId;\n+    private DeviceClient deviceClient;\n+    private DigitalTwinClient digitalTwinClient = null;\n+    private static final String DEVICE_ID_PREFIX = \"DigitalTwinServiceClientTests_\";\n+\n+    @Rule\n+    public Timeout globalTimeout = Timeout.seconds(5 * 60); // 5 minutes max per method tested\n+\n+    @Parameterized.Parameter(0)\n+    public IotHubClientProtocol protocol;\n+\n+    @Parameterized.Parameters(name = \"{index}: Digital Twin Test: protocol={0}\")\n+    public static Collection<Object[]> data() {\n+        return asList(new Object[][] {\n+                {MQTT},\n+                {MQTT_WS},\n+        });\n+    }\n+\n+    @BeforeClass\n+    public static void setUpBeforeClass() throws IOException {\n+        registryManager = RegistryManager.createFromConnectionString(IOTHUB_CONNECTION_STRING);\n+    }\n+\n+    @Before\n+    public void setUp() throws URISyntaxException, IOException, IotHubException {\n+\n+        this.deviceClient = createDeviceClient(protocol);\n+        deviceClient.open();\n+        digitalTwinClient = DigitalTwinClient.createFromConnectionString(IOTHUB_CONNECTION_STRING);\n+    }\n+\n+    @After\n+    public void cleanUp() {\n+        try {\n+            deviceClient.closeNow();\n+            registryManager.removeDevice(deviceId);\n+        } catch (Exception ex) {\n+            log.error(\"An exception occurred while closing/ deleting the device {}: {}\", deviceId, ex);\n+        }\n+    }\n+\n+    private DeviceClient createDeviceClient(IotHubClientProtocol protocol) throws IOException, IotHubException, URISyntaxException {\n+        ClientOptions options = new ClientOptions();\n+        options.setModelId(E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+\n+        this.deviceId = DEVICE_ID_PREFIX.concat(UUID.randomUUID().toString());\n+        Device device = Device.createDevice(deviceId, AuthenticationType.SAS);\n+        Device registeredDevice = registryManager.addDevice(device);\n+        String deviceConnectionString = registryManager.getDeviceConnectionString(registeredDevice);\n+        return new DeviceClient(deviceConnectionString, protocol, options);\n+    }\n+\n+    @AfterClass\n+    public static void cleanUpAfterClass()\n+    {\n+        registryManager.close();\n+    }\n+\n+    @Test\n+    public void getDigitalTwin() {\n+        // act\n+        BasicDigitalTwin response = this.digitalTwinClient.getDigitalTwin(deviceId, BasicDigitalTwin.class);\n+        ServiceResponseWithHeaders<BasicDigitalTwin, DigitalTwinGetHeaders> responseWithHeaders = this.digitalTwinClient.getDigitalTwinWithResponse(deviceId, BasicDigitalTwin.class);\n+\n+        // assert\n+        assertEquals(response.getMetadata().getModelId(), E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+        assertEquals(responseWithHeaders.body().getMetadata().getModelId(), E2ETestConstants.TEMPERATURE_CONTROLLER_MODEL_ID);\n+    }\n+\n+    @Test\n+    public void updateDigitalTwin() throws IOException {\n+    }\n+\n+    @Test\n+    public void invokeComponentLevelCommand() throws IOException {\n+        // arrange\n+        String componentName = \"thermostat1\";\n+        String commandName = \"getMaxMinReport\";\n+        String commandInput = ZonedDateTime.now(ZoneOffset.UTC).minusMinutes(5).format(DateTimeFormatter.ISO_DATE_TIME);\n+        DigitalTwinInvokeCommandRequestOptions options = new DigitalTwinInvokeCommandRequestOptions();\n+        options.setConnectTimeoutInSeconds(15);\n+        options.setResponseTimeoutInSeconds(15);\n+\n+        // setup device callback\n+        Integer deviceSuccessResponseStatus = 200;\n+        String deviceSuccessResponseMessage = \"Success\";\n+        Integer deviceFailureResponseStatus = 500;\n+        String deviceFailureResponseMessage = \"Failed\";\n+\n+        // Device method callback\n+        String componentCommandName = componentName + \"*\" + commandName;\n+        DeviceMethodCallback deviceMethodCallback = (methodName, methodData, context) -> {\n+            if(methodName.equalsIgnoreCase(componentCommandName)) {\n+                return new DeviceMethodData(deviceSuccessResponseStatus, deviceSuccessResponseMessage);\n+            }\n+            else {\n+                return new DeviceMethodData(deviceFailureResponseStatus, deviceFailureResponseMessage);\n+            }\n+        };\n+\n+        // IotHub event callback\n+        IotHubEventCallback iotHubEventCallback = (responseStatus, callbackContext) -> {};\n+\n+        deviceClient.subscribeToDeviceMethod(deviceMethodCallback, commandName, iotHubEventCallback, commandName);\n+\n+        // act\n+        DigitalTwinCommandResponse responseWithNoPayload = this.digitalTwinClient.invokeComponentCommand(deviceId, componentName, commandName, null);\n+        DigitalTwinCommandResponse response = this.digitalTwinClient.invokeComponentCommand(deviceId, componentName, commandName, commandInput);\n+        ServiceResponseWithHeaders<DigitalTwinCommandResponse, DigitalTwinInvokeCommandHeaders> responseWithHeaders = this.digitalTwinClient.invokeComponentCommandWithResponse(deviceId, componentName, commandName, commandInput, options);\n+\n+        // assert\n+        String receivedDeviceResponseStatus = \"\\\"\" + deviceSuccessResponseMessage + \"\\\"\";\n+        assertEquals(deviceSuccessResponseStatus, responseWithNoPayload.getStatus());\n+        assertEquals(receivedDeviceResponseStatus, responseWithNoPayload.getPayload());\n+        assertEquals(deviceSuccessResponseStatus, responseWithNoPayload.getStatus());\n+        assertEquals(receivedDeviceResponseStatus, response.getPayload());\n+        assertEquals(deviceSuccessResponseStatus, responseWithHeaders.body().getStatus());\n+        assertEquals(receivedDeviceResponseStatus, responseWithHeaders.body().getPayload());\n+    }\n+\n+    @Test\n+    public void invokeRootLevelCommand() throws IOException {\n+        // arrange\n+        String commandName = \"reboot\";\n+        String commandInput = \"5\";\n+        DigitalTwinInvokeCommandRequestOptions options = new DigitalTwinInvokeCommandRequestOptions();\n+        options.setConnectTimeoutInSeconds(15);\n+        options.setResponseTimeoutInSeconds(15);\n+\n+        // setup device callback\n+        Integer deviceSuccessResponseStatus = 200;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 177}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODkyODk4", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498892898", "createdAt": "2020-09-29T21:06:32Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMTowNjozMlrOHaCHqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMTowNjozMlrOHaCHqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA1OTc1Mg==", "bodyText": "Temperature controller here?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497059752", "createdAt": "2020-09-29T21:06:32Z", "author": {"login": "bikamani"}, "path": "iot-e2e-tests/common/src/test/java/tests/integration/com/microsoft/azure/sdk/iot/digitaltwin/helpers/E2ETestConstants.java", "diffHunk": "@@ -2,5 +2,6 @@\n \n public class E2ETestConstants {\n     public static final String IOTHUB_CONNECTION_STRING_ENV_VAR_NAME = \"IOTHUB_CONNECTION_STRING\";\n-    public static final String MODEL_ID = \"dtmi:com:example:Thermostat;1\";\n+    public static final String THERMOSTAT_MODEL_ID = \"dtmi:com:example:Thermostat;1\";\n+    public static final String TEMPERATURE_CONTROLLER_MODEL_ID = \"dtmi:com:example:Thermostat;1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODkzOTkx", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498893991", "createdAt": "2020-09-29T21:08:13Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMTowODoxM1rOHaCK9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMTowODoxM1rOHaCK9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA2MDU5Nw==", "bodyText": "You won't need this since it is covered in withResponse overload", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497060597", "createdAt": "2020-09-29T21:08:13Z", "author": {"login": "bikamani"}, "path": "service/iot-service-client/src/main/java/com/microsoft/azure/sdk/iot/service/digitaltwin/DigitalTwinAsyncClient.java", "diffHunk": "@@ -164,6 +164,11 @@ public static DigitalTwinAsyncClient createFromConnectionString(String connectio\n      * @throws IOException can be thrown if the provided payload cannot be deserialized into a valid Json object.\n      */\n     public Observable<DigitalTwinCommandResponse> invokeCommand (String digitalTwinId, String commandName, String payload) throws IOException {\n+        // Retrofit does not work well with null in body\n+        if(payload == null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODk4MzAx", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498898301", "createdAt": "2020-09-29T21:15:10Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMToxNToxMVrOHaCYQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMToxNToxMVrOHaCYQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA2NDAwMA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497064000", "createdAt": "2020-09-29T21:15:11Z", "author": {"login": "bikamani"}, "path": "service/iot-service-client/src/main/java/com/microsoft/azure/sdk/iot/service/digitaltwin/models/DigitalTwinMetadata.java", "diffHunk": "@@ -18,7 +18,7 @@\n \n     /* Model-defined writable properties' request state. */\n     @JsonIgnore\n-    private final Map<String, Object> writeableProperties = new HashMap<>();\n+    private final Map<String, WritableProperty> writeableProperties = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4ODk5NTky", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498899592", "createdAt": "2020-09-29T21:17:17Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMToxNzoxN1rOHaCcTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMToxNzoxN1rOHaCcTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA2NTAzOA==", "bodyText": "We should call it a TEST_MODEL_ID instead", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497065038", "createdAt": "2020-09-29T21:17:17Z", "author": {"login": "bikamani"}, "path": "iot-e2e-tests/common/src/test/java/tests/integration/com/microsoft/azure/sdk/iot/digitaltwin/DigitalTwinClientTests.java", "diffHunk": "@@ -90,7 +92,7 @@ public void cleanUp() {\n \n     private DeviceClient createDeviceClient(IotHubClientProtocol protocol) throws IOException, IotHubException, URISyntaxException {\n         ClientOptions options = new ClientOptions();\n-        options.setModelId(E2ETestConstants.MODEL_ID);\n+        options.setModelId(E2ETestConstants.THERMOSTAT_MODEL_ID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ae3a6664df9d2cc14c36cbb7845abda9bdacb73", "author": {"user": {"login": "vinagesh", "name": "Sindhu Nagesh"}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/1ae3a6664df9d2cc14c36cbb7845abda9bdacb73", "committedDate": "2020-09-29T21:18:08Z", "message": "E2E tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4OTAwMTcy", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498900172", "createdAt": "2020-09-29T21:18:12Z", "commit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMToxODoxMlrOHaCeDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQyMToxODoxMlrOHaCeDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA2NTQ4Nw==", "bodyText": "I see so the idea here is testing both get overloads in same test?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#discussion_r497065487", "createdAt": "2020-09-29T21:18:12Z", "author": {"login": "bikamani"}, "path": "iot-e2e-tests/common/src/test/java/tests/integration/com/microsoft/azure/sdk/iot/digitaltwin/DigitalTwinClientTests.java", "diffHunk": "@@ -107,43 +109,61 @@ public static void cleanUpAfterClass()\n \n     @Test\n     public void getDigitalTwin() {\n-        BasicDigitalTwin getResponse = this.digitalTwinClient.getDigitalTwin(deviceId, BasicDigitalTwin.class);\n-        assertEquals(getResponse.getMetadata().getModelId(), E2ETestConstants.MODEL_ID);\n-    }\n-\n-    @Test\n-    public void getDigitalTwinWithResponse() {\n-        String digitalTwinId = \"\";\n-    }\n+        // act\n+        BasicDigitalTwin response = digitalTwinClient.getDigitalTwin(deviceId, BasicDigitalTwin.class);\n+        ServiceResponseWithHeaders<BasicDigitalTwin, DigitalTwinGetHeaders> responseWithHeaders = digitalTwinClient.getDigitalTwinWithResponse(deviceId, BasicDigitalTwin.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de"}, "originalPosition": 75}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "abe229a79decb254b16a81ca116ad640980502de", "author": {"user": {"login": "vinagesh", "name": "Sindhu Nagesh"}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/abe229a79decb254b16a81ca116ad640980502de", "committedDate": "2020-09-29T19:39:18Z", "message": "E2E tests"}, "afterCommit": {"oid": "1ae3a6664df9d2cc14c36cbb7845abda9bdacb73", "author": {"user": {"login": "vinagesh", "name": "Sindhu Nagesh"}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/1ae3a6664df9d2cc14c36cbb7845abda9bdacb73", "committedDate": "2020-09-29T21:18:08Z", "message": "E2E tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4OTE1MDY2", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/947#pullrequestreview-498915066", "createdAt": "2020-09-29T21:42:58Z", "commit": {"oid": "1ae3a6664df9d2cc14c36cbb7845abda9bdacb73"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1578, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}