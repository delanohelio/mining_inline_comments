{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5MzMwNzE5", "number": 733, "title": "Do not accept HTTP urls in Https connection constructor", "bodyText": "Checklist\n\n I have read the [contribution guidelines] (https://github.com/Azure/azure-iot-sdk-java/blob/master/.github/CONTRIBUTING.md).\n I added or modified the existing tests to cover the change (we do not allow our test coverage to go down).\nIf this is a modification that impacts the behavior of a public API\n\n I edited the corresponding document in the devdoc folder and added or modified requirements.\n\n\nI submitted this PR against the correct branch:\n\n This pull-request is submitted against the master branch.\n\n\n\nReference/Link to the issue solved with this PR (if any)\nHTTP plaintext communication Java SDK\nDescription of the problem\nIoT Hub Java SDK allows unencrypted (HTTP) communication within an https constructor\nDescription of the solution\nWe will not accept an HTTP method in an HTTPS connection constructor", "createdAt": "2020-03-16T15:52:24Z", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/733", "merged": true, "mergeCommit": {"oid": "9e3279a196fa42ef0b2b0eba689bd9b0e34a7737"}, "closed": true, "closedAt": "2020-03-23T16:25:30Z", "author": {"login": "azabbasi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOQITFAH2gAyMzg5MzMwNzE5OmI4YzJlNzI5MWZiYmQ2MzRkZDc4ODBkYWE2YmE0MmY2YjdjY2M1ZjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPrdpngH2gAyMzg5MzMwNzE5OmQ5NTE0NTQ1ZTE5Mjc1YTdlYmQwNDY4YWY1OTJjODI1OTNlZWZmNjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b8c2e7291fbbd634dd7880daa6ba42f6b7ccc5f2", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/b8c2e7291fbbd634dd7880daa6ba42f6b7ccc5f2", "committedDate": "2020-03-16T15:48:34Z", "message": "Do not accept HTTP urls in Https connection constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ef093a060a8d6f6ca70667e02c41ede547d7dbd", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/5ef093a060a8d6f6ca70667e02c41ede547d7dbd", "committedDate": "2020-03-16T17:36:17Z", "message": "Fix the unit test to catch the correct exception"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDQ2NDM3", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/733#pullrequestreview-375446437", "createdAt": "2020-03-16T17:44:45Z", "commit": {"oid": "5ef093a060a8d6f6ca70667e02c41ede547d7dbd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzo0NDo0NVrOF2_OHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzo0NDo0NVrOF2_OHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIwMzIyOA==", "bodyText": "Since this test method now checks that the constructor throws, you can rename this test method", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/733#discussion_r393203228", "createdAt": "2020-03-16T17:44:45Z", "author": {"login": "timtay-microsoft"}, "path": "device/iot-device-client/src/test/java/tests/unit/com/microsoft/azure/sdk/iot/device/transport/https/HttpsConnectionTest.java", "diffHunk": "@@ -394,27 +394,21 @@ public void setSSLContextSetsContextWithProxy(@Mocked final SSLContext mockedCon\n     }\n \n     //Tests_SRS_HTTPSCONNECTION_34_026: [If this object uses HTTP, this function shall throw an UnsupportedOperationException.]\n-    @Test (expected = UnsupportedOperationException.class)\n+    @Test (expected = IllegalArgumentException.class)\n     public void setSSLContextThrowsIfHttp(@Mocked final SSLContext mockedContext) throws IOException, TransportException", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ef093a060a8d6f6ca70667e02c41ede547d7dbd"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDQ3MDU4", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/733#pullrequestreview-375447058", "createdAt": "2020-03-16T17:45:34Z", "commit": {"oid": "5ef093a060a8d6f6ca70667e02c41ede547d7dbd"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3789ee6b622b111c6dde17ff835a29df406e0cb1", "author": {"user": {"login": "azabbasi", "name": "Azad Abbasi"}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/3789ee6b622b111c6dde17ff835a29df406e0cb1", "committedDate": "2020-03-16T17:47:58Z", "message": "Reanaame the test to better represent the actual expectation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDQ5MjE3", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/733#pullrequestreview-375449217", "createdAt": "2020-03-16T17:48:33Z", "commit": {"oid": "3789ee6b622b111c6dde17ff835a29df406e0cb1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDc5MjI4", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/733#pullrequestreview-375479228", "createdAt": "2020-03-16T18:25:35Z", "commit": {"oid": "3789ee6b622b111c6dde17ff835a29df406e0cb1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxODoyNTozNVrOF3Ayjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxODoyNTozNVrOF3Ayjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIyODk0Mw==", "bodyText": "If we make this change we need to let PM know before drop it off. lets chat about this", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/733#discussion_r393228943", "createdAt": "2020-03-16T18:25:35Z", "author": {"login": "prmathur-microsoft"}, "path": "device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/transport/https/HttpsConnection.java", "diffHunk": "@@ -70,10 +70,10 @@ public HttpsConnection(URL url, HttpsMethod method, final ProxySettings proxySet\n     {\n         // Codes_SRS_HTTPSCONNECTION_11_022: [If the URI given does not use the HTTPS or HTTP protocol, the constructor shall throw an IllegalArgumentException.]\n         final String protocol = url.getProtocol();\n-        if (!protocol.equalsIgnoreCase(\"HTTPS\") && !protocol.equalsIgnoreCase(\"HTTP\"))\n+        if (!protocol.equalsIgnoreCase(\"HTTPS\"))\n         {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3789ee6b622b111c6dde17ff835a29df406e0cb1"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9514545e19275a7ebd0468af592c82593eeff62", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/d9514545e19275a7ebd0468af592c82593eeff62", "committedDate": "2020-03-21T02:13:15Z", "message": "Merge branch 'master' into azabbasi/5867818"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1827, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}