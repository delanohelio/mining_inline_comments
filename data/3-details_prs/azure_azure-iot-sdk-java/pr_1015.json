{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzOTIwODM5", "number": 1015, "title": "fix(iot-dev): Fix cleanup logic in AMQP layer when interrupted during open", "bodyText": "exception should be retryable, and the catch block should close the reactor and shut down the executor service, not just shut down the executor service. Close() covers this well so a call to it from this catch block works well", "createdAt": "2020-12-07T20:14:18Z", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/1015", "merged": true, "mergeCommit": {"oid": "a9226a5262a8f4cb92ec7fd1535c0e0d3bc7aa03"}, "closed": true, "closedAt": "2020-12-07T22:21:57Z", "author": {"login": "timtay-microsoft"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdj7W_rAH2gAyNTMzOTIwODM5OjBkZDM3MzY3MTk1ZmMyM2I4NWQxZTk1OWViYjg5YTkwMzg5NjIwYWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdj88tcAFqTU0NjU3NjQ0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0dd37367195fc23b85d1e959ebb89a90389620aa", "author": {"user": {"login": "timtay-microsoft", "name": null}}, "url": "https://github.com/Azure/azure-iot-sdk-java/commit/0dd37367195fc23b85d1e959ebb89a90389620aa", "committedDate": "2020-12-07T20:14:06Z", "message": "fix(iot-dev): Fix cleanup logic in AMQP layer when interrupted during open\n\nexception should be retryable, and the catch block should close the reactor and shut down the executor service, not just shut down the executor service. Close() covers this well so a call to it from this catch block works well"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NTExODI2", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/1015#pullrequestreview-546511826", "createdAt": "2020-12-07T20:31:18Z", "commit": {"oid": "0dd37367195fc23b85d1e959ebb89a90389620aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMDozMToxOFrOIA5aig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMDozMToxOFrOIA5aig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgxMTU5NA==", "bodyText": "I am assuming we only want to clean up on close?", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/1015#discussion_r537811594", "createdAt": "2020-12-07T20:31:18Z", "author": {"login": "barustum"}, "path": "device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/transport/amqps/AmqpsIotHubConnection.java", "diffHunk": "@@ -158,8 +158,10 @@ public void open(Queue<DeviceClientConfig> deviceClientConfigs) throws Transport\n             }\n             catch (InterruptedException e)\n             {\n-                executorServicesCleanup();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dd37367195fc23b85d1e959ebb89a90389620aa"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NTExODk3", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/1015#pullrequestreview-546511897", "createdAt": "2020-12-07T20:31:24Z", "commit": {"oid": "0dd37367195fc23b85d1e959ebb89a90389620aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NTc2Mzc3", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/1015#pullrequestreview-546576377", "createdAt": "2020-12-07T22:05:06Z", "commit": {"oid": "0dd37367195fc23b85d1e959ebb89a90389620aa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMjowNTowNlrOIA817Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMjowNTowNlrOIA817Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg2Nzc1Nw==", "bodyText": "A proton reactor!? Sounds powerful and dangerous.", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/1015#discussion_r537867757", "createdAt": "2020-12-07T22:05:06Z", "author": {"login": "drwill-ms"}, "path": "device/iot-device-client/src/main/java/com/microsoft/azure/sdk/iot/device/transport/amqps/AmqpsIotHubConnection.java", "diffHunk": "@@ -181,6 +183,7 @@ public void close() throws TransportException\n         }\n         catch (InterruptedException e)\n         {\n+            this.executorServicesCleanup();\n             throw new TransportException(\"Interrupted while closing proton reactor\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dd37367195fc23b85d1e959ebb89a90389620aa"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2NTc2NDQ1", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/1015#pullrequestreview-546576445", "createdAt": "2020-12-07T22:05:12Z", "commit": {"oid": "0dd37367195fc23b85d1e959ebb89a90389620aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1519, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}