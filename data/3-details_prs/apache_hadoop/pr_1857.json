{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MDMzNjE2", "number": 1857, "title": "HADOOP-16878. FileUtil.copy() to throw IOException if the source and destination are the same", "bodyText": "Change-Id: Ibaa6e8a23ba575d0092b6d67989dc58c93a3a2d7", "createdAt": "2020-02-24T14:54:50Z", "url": "https://github.com/apache/hadoop/pull/1857", "merged": true, "mergeCommit": {"oid": "59f01a548e457a535aa8b5035142c9fbdc34b5b4"}, "closed": true, "closedAt": "2020-10-13T15:17:45Z", "author": {"login": "bgaborg"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRJNmsABqjMxNjQ0ODE1MjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdR21GKgBqjM4Njc0ODg1ODQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86ff342c81af7da030e8d0437c97e9dcec3b52a0", "author": {"user": {"login": "bgaborg", "name": "Gabor Bota"}}, "url": "https://github.com/apache/hadoop/commit/86ff342c81af7da030e8d0437c97e9dcec3b52a0", "committedDate": "2020-02-24T14:54:00Z", "message": "HADOOP-16878. Copy command in FileUtil to LOG at warn level if the source and destination is the same\n\nChange-Id: Ibaa6e8a23ba575d0092b6d67989dc58c93a3a2d7"}, "afterCommit": {"oid": "dd70770206b29e928a6c53dcaf57b65a031f84fb", "author": {"user": {"login": "bgaborg", "name": "Gabor Bota"}}, "url": "https://github.com/apache/hadoop/commit/dd70770206b29e928a6c53dcaf57b65a031f84fb", "committedDate": "2020-03-25T15:25:59Z", "message": "exception and test\n\nChange-Id: Ia1258709be1f16744db9219bbbeca881493a37e5"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dd70770206b29e928a6c53dcaf57b65a031f84fb", "author": {"user": {"login": "bgaborg", "name": "Gabor Bota"}}, "url": "https://github.com/apache/hadoop/commit/dd70770206b29e928a6c53dcaf57b65a031f84fb", "committedDate": "2020-03-25T15:25:59Z", "message": "exception and test\n\nChange-Id: Ia1258709be1f16744db9219bbbeca881493a37e5"}, "afterCommit": {"oid": "4055b02402942c66af06c33c6d67e416de690674", "author": {"user": {"login": "bgaborg", "name": "Gabor Bota"}}, "url": "https://github.com/apache/hadoop/commit/4055b02402942c66af06c33c6d67e416de690674", "committedDate": "2020-03-30T14:41:17Z", "message": "fix for possible NPE\n\nChange-Id: I0bcac933e8f3ee69ff968b70e2296ec1023c8c2e"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MDUxMDEy", "url": "https://github.com/apache/hadoop/pull/1857#pullrequestreview-385051012", "createdAt": "2020-03-31T19:46:26Z", "commit": {"oid": "4055b02402942c66af06c33c6d67e416de690674"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNzY2OTMz", "url": "https://github.com/apache/hadoop/pull/1857#pullrequestreview-390766933", "createdAt": "2020-04-09T12:57:54Z", "commit": {"oid": "4055b02402942c66af06c33c6d67e416de690674"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxMjo1Nzo1NFrOGDXh-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxMjo1Nzo1NFrOGDXh-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjE4NDQ0Mw==", "bodyText": "Can we use :\nsrcFS.makeQualified(src).equals(dstFS.makeQualified(dst))\ninstead of uri comparison, As I said on Jira, this URI comparison isn't working with HDFS", "url": "https://github.com/apache/hadoop/pull/1857#discussion_r406184443", "createdAt": "2020-04-09T12:57:54Z", "author": {"login": "ayushtkn"}, "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java", "diffHunk": "@@ -398,6 +398,13 @@ public static boolean copy(FileSystem srcFS, FileStatus srcStatus,\n                              Configuration conf) throws IOException {\n     Path src = srcStatus.getPath();\n     dst = checkDest(src.getName(), dstFS, dst, overwrite);\n+\n+    if (dst != null && src != null &&\n+        src.toUri().equals(dst.toUri())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4055b02402942c66af06c33c6d67e416de690674"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1d9cada872700d5d931c065709732b7a86e7482", "author": {"user": {"login": "bgaborg", "name": "Gabor Bota"}}, "url": "https://github.com/apache/hadoop/commit/b1d9cada872700d5d931c065709732b7a86e7482", "committedDate": "2020-10-12T16:27:35Z", "message": "exception and test\n\nChange-Id: Ia1258709be1f16744db9219bbbeca881493a37e5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bb0e03b6a5bcc92e331a69d045c07531c800ff2", "author": {"user": {"login": "bgaborg", "name": "Gabor Bota"}}, "url": "https://github.com/apache/hadoop/commit/7bb0e03b6a5bcc92e331a69d045c07531c800ff2", "committedDate": "2020-10-12T16:27:35Z", "message": "fix for possible NPE\n\nChange-Id: I0bcac933e8f3ee69ff968b70e2296ec1023c8c2e"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8614fd8c228d6daf5f8a5899e6dd09955c787ab", "author": {"user": {"login": "ayushtkn", "name": "Ayush Saxena"}}, "url": "https://github.com/apache/hadoop/commit/d8614fd8c228d6daf5f8a5899e6dd09955c787ab", "committedDate": "2020-10-12T16:28:03Z", "message": "Fix for HDFS & Findbugs."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4055b02402942c66af06c33c6d67e416de690674", "author": {"user": {"login": "bgaborg", "name": "Gabor Bota"}}, "url": "https://github.com/apache/hadoop/commit/4055b02402942c66af06c33c6d67e416de690674", "committedDate": "2020-03-30T14:41:17Z", "message": "fix for possible NPE\n\nChange-Id: I0bcac933e8f3ee69ff968b70e2296ec1023c8c2e"}, "afterCommit": {"oid": "d8614fd8c228d6daf5f8a5899e6dd09955c787ab", "author": {"user": {"login": "ayushtkn", "name": "Ayush Saxena"}}, "url": "https://github.com/apache/hadoop/commit/d8614fd8c228d6daf5f8a5899e6dd09955c787ab", "committedDate": "2020-10-12T16:28:03Z", "message": "Fix for HDFS & Findbugs."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4763, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}