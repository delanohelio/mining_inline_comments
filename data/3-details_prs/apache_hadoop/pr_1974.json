{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NjQ5NjYz", "number": 1974, "title": "HADOOP-17009: Embrace Immutability of Java Collections", "bodyText": "", "createdAt": "2020-04-23T02:54:24Z", "url": "https://github.com/apache/hadoop/pull/1974", "merged": true, "mergeCommit": {"oid": "100ec8e8709e79a6729aab0dac15e080dd747ee5"}, "closed": true, "closedAt": "2020-06-19T17:23:44Z", "author": {"login": "belugabehr"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaTzmMAH2gAyNDA3NjQ5NjYzOmQ3YzgxOGRiNzE5MjAzYjE5NzRlZjQxN2VkMWM0ODE5NWE0NTIxYmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcs2bEBgFqTQzNDIzNTgyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d7c818db719203b1974ef417ed1c48195a4521ba", "author": {"user": {"login": "belugabehr", "name": null}}, "url": "https://github.com/apache/hadoop/commit/d7c818db719203b1974ef417ed1c48195a4521ba", "committedDate": "2020-04-23T02:52:40Z", "message": "HADOOP-17009: Embrace Immutability of Java Collections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbf1e0e2a41e0c3c6d4cf4ef19046b3cfd7b2993", "author": {"user": {"login": "belugabehr", "name": null}}, "url": "https://github.com/apache/hadoop/commit/dbf1e0e2a41e0c3c6d4cf4ef19046b3cfd7b2993", "committedDate": "2020-04-23T14:09:20Z", "message": "Fix checkstyle warnings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MzQ2Njc5", "url": "https://github.com/apache/hadoop/pull/1974#pullrequestreview-399346679", "createdAt": "2020-04-23T18:01:20Z", "commit": {"oid": "dbf1e0e2a41e0c3c6d4cf4ef19046b3cfd7b2993"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMToyMVrOGK1Hcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMToyMVrOGK1Hcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDAwOTIwMw==", "bodyText": "Now, somebody calling getGroups() would start failing if it was adding new things to the list while that was not the case before. I've tried using inmodifiable before but is kind of dangerous.", "url": "https://github.com/apache/hadoop/pull/1974#discussion_r414009203", "createdAt": "2020-04-23T18:01:21Z", "author": {"login": "goiri"}, "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/CompositeGroupsMapping.java", "diffHunk": "@@ -78,15 +79,13 @@\n             user, provider.getClass().getSimpleName(), e.toString());\n         LOG.debug(\"Stacktrace: \", e);\n       }        \n-      if (groups != null && ! groups.isEmpty()) {\n+      if (!groups.isEmpty()) {\n         groupSet.addAll(groups);\n         if (!combined) break;\n       }\n     }\n \n-    List<String> results = new ArrayList<String>(groupSet.size());\n-    results.addAll(groupSet);\n-    return results;\n+    return Collections.unmodifiableList(new ArrayList<>(groupSet));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbf1e0e2a41e0c3c6d4cf4ef19046b3cfd7b2993"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98e9ebea42c9e0aca429f2c012b70bf60ef703b6", "author": {"user": {"login": "belugabehr", "name": null}}, "url": "https://github.com/apache/hadoop/commit/98e9ebea42c9e0aca429f2c012b70bf60ef703b6", "committedDate": "2020-04-23T18:31:40Z", "message": "Revert some of the returning immutable collections on public APIs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDEzMDcw", "url": "https://github.com/apache/hadoop/pull/1974#pullrequestreview-400413070", "createdAt": "2020-04-25T17:14:29Z", "commit": {"oid": "98e9ebea42c9e0aca429f2c012b70bf60ef703b6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNVQxNzoxNDoyOVrOGL37Ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNVQxNzoxNDoyOVrOGL37Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTEwMzgzNQ==", "bodyText": "Why can we use unmodifiable here?", "url": "https://github.com/apache/hadoop/pull/1974#discussion_r415103835", "createdAt": "2020-04-25T17:14:29Z", "author": {"login": "goiri"}, "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/NetworkTopology.java", "diffHunk": "@@ -196,10 +196,8 @@ protected Node getNodeForNetworkLocation(Node node) {\n         loc = loc.substring(1);\n       }\n       InnerNode rack = (InnerNode) clusterMap.getLoc(loc);\n-      if (rack == null) {\n-        return null;\n-      }\n-      return new ArrayList<Node>(rack.getChildren());\n+      return (rack == null) ? Collections.emptyList()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98e9ebea42c9e0aca429f2c012b70bf60ef703b6"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36a221908b5596f82e11660685da39739c2a4b30", "author": {"user": {"login": "belugabehr", "name": null}}, "url": "https://github.com/apache/hadoop/commit/36a221908b5596f82e11660685da39739c2a4b30", "committedDate": "2020-04-27T13:58:57Z", "message": "Revert immutability of getDatanodesInRack"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMTAyMjI5", "url": "https://github.com/apache/hadoop/pull/1974#pullrequestreview-402102229", "createdAt": "2020-04-28T18:27:57Z", "commit": {"oid": "36a221908b5596f82e11660685da39739c2a4b30"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MjM1ODIz", "url": "https://github.com/apache/hadoop/pull/1974#pullrequestreview-434235823", "createdAt": "2020-06-19T17:23:11Z", "commit": {"oid": "36a221908b5596f82e11660685da39739c2a4b30"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4223, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}