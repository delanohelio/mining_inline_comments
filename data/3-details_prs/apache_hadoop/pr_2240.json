{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyMzU5NDU1", "number": 2240, "title": "HADOOP-17165. Implement service-user feature in DecayRPCScheduler.", "bodyText": "JIRA: https://issues.apache.org/jira/browse/HADOOP-17165\nThis PR is following the HADOOP-17165.\nDiff from HADOOP-17165.002.patch\n\nFixed a failed test of TestCommonConfigurationFields.\nUse Set for return type and field type.\nSave the priorities of service users in cache.", "createdAt": "2020-08-24T08:39:51Z", "url": "https://github.com/apache/hadoop/pull/2240", "merged": true, "mergeCommit": {"oid": "e5fe326270259a6bd2a79b5082c65ea9e17ba4da"}, "closed": true, "closedAt": "2020-09-09T16:56:59Z", "author": {"login": "tasanuma"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdB-LCoAH2gAyNDcyMzU5NDU1OjZlMTBjNjg4MWM0Y2FiMjdhNDJhNmY0MDRkMDAyYzFjYTgyZTY4NTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHNJUbgFqTQ4NTA3NDI2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6e10c6881c4cab27a42a6f404d002c1ca82e6852", "author": {"user": {"login": "tasanuma", "name": "Takanobu Asanuma"}}, "url": "https://github.com/apache/hadoop/commit/6e10c6881c4cab27a42a6f404d002c1ca82e6852", "committedDate": "2020-08-24T08:17:20Z", "message": "HADOOP-17165. Implement service-user feature in DecayRPCScheduler."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTE5MTQ5", "url": "https://github.com/apache/hadoop/pull/2240#pullrequestreview-473519149", "createdAt": "2020-08-24T14:02:03Z", "commit": {"oid": "6e10c6881c4cab27a42a6f404d002c1ca82e6852"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDowMjowM1rOHFmeuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDowMjowM1rOHFmeuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTYzNTM4Nw==", "bodyText": "@tasanuma Thanks for your proposal. I am concerned any corner case here if put service users's request to the priority forever rather than flow controls. Such as user hdfs is one service user, and submit one big job which involve massive RPC request to NameNode, other normal users' request may postpone serious.", "url": "https://github.com/apache/hadoop/pull/2240#discussion_r475635387", "createdAt": "2020-08-24T14:02:03Z", "author": {"login": "Hexiaoqiao"}, "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/DecayRpcScheduler.java", "diffHunk": "@@ -483,6 +501,12 @@ private void recomputeScheduleCache() {\n \n     for (Map.Entry<Object, List<AtomicLong>> entry : callCosts.entrySet()) {\n       Object id = entry.getKey();\n+      // The priority for service users is always 0\n+      if (isServiceUser((String)id)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e10c6881c4cab27a42a6f404d002c1ca82e6852"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMTUyNTg1", "url": "https://github.com/apache/hadoop/pull/2240#pullrequestreview-481152585", "createdAt": "2020-09-02T18:22:09Z", "commit": {"oid": "6e10c6881c4cab27a42a6f404d002c1ca82e6852"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b00671fd669a9277fa77c1f1760999fd6c1c040", "author": {"user": {"login": "tasanuma", "name": "Takanobu Asanuma"}}, "url": "https://github.com/apache/hadoop/commit/9b00671fd669a9277fa77c1f1760999fd6c1c040", "committedDate": "2020-09-07T01:32:31Z", "message": "Move the method call to computePriorityLevel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MzMxNjE5", "url": "https://github.com/apache/hadoop/pull/2240#pullrequestreview-484331619", "createdAt": "2020-09-08T17:00:51Z", "commit": {"oid": "9b00671fd669a9277fa77c1f1760999fd6c1c040"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNzowMDo1MVrOHOmNdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNzowMDo1MVrOHOmNdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA2ODE1MA==", "bodyText": "nit nit: usually it is UserName instead of Username, so better follow that pattern.", "url": "https://github.com/apache/hadoop/pull/2240#discussion_r485068150", "createdAt": "2020-09-08T17:00:51Z", "author": {"login": "sunchao"}, "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/ipc/DecayRpcScheduler.java", "diffHunk": "@@ -178,6 +188,7 @@\n   private static final double PRECISION = 0.0001;\n   private MetricsProxy metricsProxy;\n   private final CostProvider costProvider;\n+  private Set<String> serviceUsernames;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b00671fd669a9277fa77c1f1760999fd6c1c040"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4cc5e0fcec768d6a20fbd0ade1711e579c9f4ee", "author": {"user": {"login": "tasanuma", "name": "Takanobu Asanuma"}}, "url": "https://github.com/apache/hadoop/commit/c4cc5e0fcec768d6a20fbd0ade1711e579c9f4ee", "committedDate": "2020-09-09T04:59:29Z", "message": "Use UserName instead of Username"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MDc0MjY3", "url": "https://github.com/apache/hadoop/pull/2240#pullrequestreview-485074267", "createdAt": "2020-09-09T14:33:39Z", "commit": {"oid": "c4cc5e0fcec768d6a20fbd0ade1711e579c9f4ee"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3936, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}