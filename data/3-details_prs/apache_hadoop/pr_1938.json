{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MTQwOTQw", "number": 1938, "title": "HADOOP-16922. ABFS: Change User-Agent header", "bodyText": "HADOOP-16922. Changing User-Agent header.\n\nAdd more inforrmation to the User-Agent header like cluster name, cluster type, java vendor etc.\nAdd APN/1.0 in the begining\n\nAt present the User-Agent header would look like:\nAzure Blob FS/3.4.0-SNAPSHOT (JavaJRE 1.8.0_241; Linux 5.3.0-46-generic; SunJSSE-1.8) MSFT\nWith this PR it would be:\nAPN/1.0 Azure Blob FS/3.4.0-SNAPSHOT (OracleCorporation JavaJRE 1.8.0_241; Linux 5.3.0-46-generic/amd64; SunJSSE-1.8; UNKNOWN/UNKNOWN) MSFT", "createdAt": "2020-04-03T12:19:58Z", "url": "https://github.com/apache/hadoop/pull/1938", "merged": true, "mergeCommit": {"oid": "264e49c8f2cfd15826655bbc1847f378f60ad8c7"}, "closed": true, "closedAt": "2020-04-21T16:37:41Z", "author": {"login": "bilaharith"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTzLAAgH2gAyMzk4MTQwOTQwOmI1MDhjZTIzMDhiZmQ3N2UwNDQwYWE3YWUwZWFlNmQ2YTg3NWQzMTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXmqW-AFqTM5MzEyOTE0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b508ce2308bfd77e0440aa7ae0eae6d6a875d319", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/b508ce2308bfd77e0440aa7ae0eae6d6a875d319", "committedDate": "2020-04-02T21:27:49Z", "message": "User-Agent String changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfa75cb779fa21d0ca17f263dd36dadadc884d99", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/bfa75cb779fa21d0ca17f263dd36dadadc884d99", "committedDate": "2020-04-03T12:16:36Z", "message": "User-Agent header changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a396b3c06de487e0d6b5ff5cc00702a4423558b0", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/a396b3c06de487e0d6b5ff5cc00702a4423558b0", "committedDate": "2020-04-03T15:29:26Z", "message": "Adding test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "acaea3b3ea4846296485e6166f3f8f889e5ed4af", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/acaea3b3ea4846296485e6166f3f8f889e5ed4af", "committedDate": "2020-04-03T15:33:30Z", "message": "Fixing import order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NjEzMzM5", "url": "https://github.com/apache/hadoop/pull/1938#pullrequestreview-387613339", "createdAt": "2020-04-03T22:22:24Z", "commit": {"oid": "acaea3b3ea4846296485e6166f3f8f889e5ed4af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMjoyMjoyNFrOGArZjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMjoyMjoyNFrOGArZjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM2NDIzOQ==", "bodyText": "is this annotation needed?", "url": "https://github.com/apache/hadoop/pull/1938#discussion_r403364239", "createdAt": "2020-04-03T22:22:24Z", "author": {"login": "DadanielZ"}, "path": "hadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/services/TestAbfsClient.java", "diffHunk": "@@ -18,80 +18,220 @@\n \n package org.apache.hadoop.fs.azurebfs.services;\n \n+import java.io.IOException;\n+import java.net.MalformedURLException;\n import java.net.URL;\n import java.util.regex.Pattern;\n \n-import org.apache.hadoop.fs.azurebfs.contracts.exceptions.AzureBlobFileSystemException;\n-import org.junit.Assert;\n+import org.assertj.core.api.Assertions;\n import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n \n import org.apache.hadoop.fs.azurebfs.AbfsConfiguration;\n import org.apache.hadoop.fs.azurebfs.oauth2.AccessTokenProvider;\n import org.apache.hadoop.conf.Configuration;\n import org.apache.hadoop.fs.azurebfs.constants.ConfigurationKeys;\n import org.apache.hadoop.security.ssl.DelegatingSSLSocketFactory;\n-import org.apache.hadoop.util.VersionInfo;\n+\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.APN_VERSION;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.CLIENT_VERSION;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.EMPTY_STRING;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.FORWARD_SLASH;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.JAVA_VERSION;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.OS_ARCH;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.OS_NAME;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.OS_VERSION;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.SEMICOLON;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.SINGLE_WHITE_SPACE;\n+import static org.apache.hadoop.fs.azurebfs.constants.ConfigurationKeys.FS_AZURE_CLUSTER_NAME;\n+import static org.apache.hadoop.fs.azurebfs.constants.ConfigurationKeys.FS_AZURE_CLUSTER_TYPE;\n \n /**\n  * Test useragent of abfs client.\n  *\n  */\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acaea3b3ea4846296485e6166f3f8f889e5ed4af"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba069d884a4961b41d6e0881cafcad8cf1934075", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/ba069d884a4961b41d6e0881cafcad8cf1934075", "committedDate": "2020-04-04T16:50:01Z", "message": "Fixing test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9769e603f6b609238b9135adb15c76b39675603", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/a9769e603f6b609238b9135adb15c76b39675603", "committedDate": "2020-04-04T17:00:09Z", "message": "Removing unused annotation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5a00d329a1423059fff523784104bb78b960337", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/b5a00d329a1423059fff523784104bb78b960337", "committedDate": "2020-04-04T17:03:36Z", "message": "Fixing imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "322f778ac20dd3f1b84b66e1265ae1e32507b955", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/322f778ac20dd3f1b84b66e1265ae1e32507b955", "committedDate": "2020-04-05T13:46:29Z", "message": "Improving test cases"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDA4MDE0", "url": "https://github.com/apache/hadoop/pull/1938#pullrequestreview-388408014", "createdAt": "2020-04-06T16:16:04Z", "commit": {"oid": "322f778ac20dd3f1b84b66e1265ae1e32507b955"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjoxNjowNFrOGBfeDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjoyMDowN1rOGBfozQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIxNzM1Nw==", "bodyText": "if you pulled this out somewhere or made static you could have a unit test which would validate some of this", "url": "https://github.com/apache/hadoop/pull/1938#discussion_r404217357", "createdAt": "2020-04-06T16:16:04Z", "author": {"login": "steveloughran"}, "path": "hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AbfsClient.java", "diffHunk": "@@ -679,32 +679,60 @@ public AuthType getAuthType() {\n \n   @VisibleForTesting\n   String initializeUserAgent(final AbfsConfiguration abfsConfiguration,\n-                             final String sslProviderName) {\n+      final String sslProviderName) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "322f778ac20dd3f1b84b66e1265ae1e32507b955"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIyMDEwOQ==", "bodyText": "can we have org.apache.hadoop.util.VersionInfo,getVersion() in there too? Lets people pin the blame on the logs", "url": "https://github.com/apache/hadoop/pull/1938#discussion_r404220109", "createdAt": "2020-04-06T16:20:07Z", "author": {"login": "steveloughran"}, "path": "hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AbfsClient.java", "diffHunk": "@@ -679,32 +679,60 @@ public AuthType getAuthType() {\n \n   @VisibleForTesting\n   String initializeUserAgent(final AbfsConfiguration abfsConfiguration,\n-                             final String sslProviderName) {\n+      final String sslProviderName) {\n+\n     StringBuilder sb = new StringBuilder();\n-    sb.append(\"(JavaJRE \");\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "322f778ac20dd3f1b84b66e1265ae1e32507b955"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MzcyMDUz", "url": "https://github.com/apache/hadoop/pull/1938#pullrequestreview-389372053", "createdAt": "2020-04-07T18:15:12Z", "commit": {"oid": "322f778ac20dd3f1b84b66e1265ae1e32507b955"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0a372837319fb5c562639c8cbcffe6b4e201878", "author": {"user": {"login": "bilaharith", "name": null}}, "url": "https://github.com/apache/hadoop/commit/a0a372837319fb5c562639c8cbcffe6b4e201878", "committedDate": "2020-04-13T19:32:59Z", "message": "CheckStyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMTI5MTQ4", "url": "https://github.com/apache/hadoop/pull/1938#pullrequestreview-393129148", "createdAt": "2020-04-14T17:09:00Z", "commit": {"oid": "a0a372837319fb5c562639c8cbcffe6b4e201878"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4558, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}