{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2MjQ4ODYy", "number": 2355, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzoyNDo1MVrOEprzJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzozNzozM1rOEpr4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMTQ0Njc5OnYy", "diffSide": "RIGHT", "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/web/JsonUtilClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzoyNDo1MlrOHbgZbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzoyNDo1MlrOHbgZbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODYwNDM5Nw==", "bodyText": "Use \"DELETED\".equal(..) in order to avoid NPE?\n final boolean isDeleted = \"DELETED\".equals(json.get(\"deletionStatus\"));", "url": "https://github.com/apache/hadoop/pull/2355#discussion_r498604397", "createdAt": "2020-10-02T03:24:52Z", "author": {"login": "szetszwo"}, "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/web/JsonUtilClient.java", "diffHunk": "@@ -872,4 +873,39 @@ private static SnapshottableDirectoryStatus toSnapshottableDirectoryStatus(\n             snapshotQuota, parentFullPath);\n     return snapshottableDirectoryStatus;\n   }\n+\n+  public static SnapshotStatus[] toSnapshotList(final Map<?, ?> json) {\n+    if (json == null) {\n+      return null;\n+    }\n+    List<?> list = (List<?>) json.get(\"SnapshotList\");\n+    if (list == null) {\n+      return null;\n+    }\n+    SnapshotStatus[] statuses =\n+        new SnapshotStatus[list.size()];\n+    for (int i = 0; i < list.size(); i++) {\n+      statuses[i] = toSnapshotStatus((Map<?, ?>) list.get(i));\n+    }\n+    return statuses;\n+  }\n+\n+  private static SnapshotStatus toSnapshotStatus(\n+      Map<?, ?> json) {\n+    if (json == null) {\n+      return null;\n+    }\n+    int snapshotID = getInt(json, \"snapshotID\", 0);\n+    boolean isDeleted = ((String)json.get(\"deletionStatus\")).\n+        contentEquals(\"DELETED\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMTQ1MTMwOnYy", "diffSide": "RIGHT", "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/web/WebHdfsFileSystem.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzoyOToyN1rOHbgcQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzoyOToyN1rOHbgcQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODYwNTEyMA==", "bodyText": "In DistributedFileSystem, it is called\n  public SnapshotStatus[] getSnapshotListing(Path snapshotRoot)\nLet's use the same name?", "url": "https://github.com/apache/hadoop/pull/2355#discussion_r498605120", "createdAt": "2020-10-02T03:29:27Z", "author": {"login": "szetszwo"}, "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/web/WebHdfsFileSystem.java", "diffHunk": "@@ -1459,6 +1460,19 @@ SnapshotDiffReport decodeResponse(Map<?, ?> json) {\n     }.run();\n   }\n \n+  public SnapshotStatus[] getSnapshotList(final Path snapshotDir)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMTQ1MTY1OnYy", "diffSide": "RIGHT", "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshotStatus.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzoyOTo0OFrOHbgcgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzoyOTo0OFrOHbgcgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODYwNTE4Ng==", "bodyText": "Unused import.", "url": "https://github.com/apache/hadoop/pull/2355#discussion_r498605186", "createdAt": "2020-10-02T03:29:48Z", "author": {"login": "szetszwo"}, "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshotStatus.java", "diffHunk": "@@ -25,6 +25,7 @@\n import org.apache.hadoop.fs.Path;\n import org.apache.hadoop.fs.permission.FsPermission;\n import org.apache.hadoop.hdfs.DFSUtilClient;\n+import org.apache.hadoop.util.StringUtils;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyMTQ1OTc2OnYy", "diffSide": "RIGHT", "path": "hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/fs/http/client/HttpFSFileSystem.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzozNzozNFrOHbghfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzozNzozNFrOHbghfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODYwNjQ2Mg==", "bodyText": "It should call getSnapshotListing.", "url": "https://github.com/apache/hadoop/pull/2355#discussion_r498606462", "createdAt": "2020-10-02T03:37:34Z", "author": {"login": "szetszwo"}, "path": "hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/fs/http/client/HttpFSFileSystem.java", "diffHunk": "@@ -1582,6 +1584,18 @@ public SnapshotDiffReport getSnapshotDiffReport(Path path,\n     return JsonUtilClient.toSnapshottableDirectoryList(json);\n   }\n \n+  public SnapshotStatus[] getSnapshotList(Path snapshotRoot)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3325, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}