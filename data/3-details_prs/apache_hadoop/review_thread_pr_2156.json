{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUzNjcyMzU4", "number": 2156, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwODo1MzowMFrOEQhzMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwODo1NjozOVrOEQh40A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NzY2NDQ4OnYy", "diffSide": "RIGHT", "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwODo1MzowMFrOG0ugLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwOTo1NjozMlrOG0wyug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MTAzOA==", "bodyText": "This check is not needed as all the other user of xattrs like encryption, erasure encoding calls\nFSDirXAttrOp.unprotectedSetXAttrs(fsd, srcIIP, xattrs, flag) directly without doing a feature check.", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457941038", "createdAt": "2020-07-21T08:53:00Z", "author": {"login": "mukul1987"}, "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java", "diffHunk": "@@ -353,6 +354,20 @@ public int getListLimit() {\n         + \" hard limit \" + DFSConfigKeys.DFS_NAMENODE_MAX_XATTR_SIZE_HARD_LIMIT\n         + \": (%s).\", DFSConfigKeys.DFS_NAMENODE_MAX_XATTR_SIZE_KEY);\n \n+    this.snapshotDeletionOrdered =\n+        conf.getBoolean(DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED,\n+            DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED_DEFAULT);\n+    LOG.info(\"{} = {}\", DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED,\n+        snapshotDeletionOrdered);\n+    if (snapshotDeletionOrdered && !xattrsEnabled) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk3ODU1NA==", "bodyText": "https://issues.apache.org/jira/browse/HDFS-15480", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457978554", "createdAt": "2020-07-21T09:56:32Z", "author": {"login": "bshashikant"}, "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java", "diffHunk": "@@ -353,6 +354,20 @@ public int getListLimit() {\n         + \" hard limit \" + DFSConfigKeys.DFS_NAMENODE_MAX_XATTR_SIZE_HARD_LIMIT\n         + \": (%s).\", DFSConfigKeys.DFS_NAMENODE_MAX_XATTR_SIZE_KEY);\n \n+    this.snapshotDeletionOrdered =\n+        conf.getBoolean(DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED,\n+            DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED_DEFAULT);\n+    LOG.info(\"{} = {}\", DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED,\n+        snapshotDeletionOrdered);\n+    if (snapshotDeletionOrdered && !xattrsEnabled) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MTAzOA=="}, "originalCommit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NzY3ODg4OnYy", "diffSide": "RIGHT", "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwODo1NjozOVrOG0upQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwOTo1NjoyNlrOG0wygA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MzM2Mg==", "bodyText": "Lets also add the value to hdfs-default.xml", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457943362", "createdAt": "2020-07-21T08:56:39Z", "author": {"login": "mukul1987"}, "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java", "diffHunk": "@@ -500,8 +500,13 @@\n \n   public static final String DFS_NAMENODE_SNAPSHOT_MAX_LIMIT =\n       \"dfs.namenode.snapshot.max.limit\";\n-\n   public static final int DFS_NAMENODE_SNAPSHOT_MAX_LIMIT_DEFAULT = 65536;\n+\n+  public static final String DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED =\n+      \"dfs.namenode.snapshot.deletion.ordered\";\n+  public static final boolean DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED_DEFAULT\n+      = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk3ODQ5Ng==", "bodyText": "Addressed in https://issues.apache.org/jira/browse/HDFS-15480.", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457978496", "createdAt": "2020-07-21T09:56:26Z", "author": {"login": "bshashikant"}, "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java", "diffHunk": "@@ -500,8 +500,13 @@\n \n   public static final String DFS_NAMENODE_SNAPSHOT_MAX_LIMIT =\n       \"dfs.namenode.snapshot.max.limit\";\n-\n   public static final int DFS_NAMENODE_SNAPSHOT_MAX_LIMIT_DEFAULT = 65536;\n+\n+  public static final String DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED =\n+      \"dfs.namenode.snapshot.deletion.ordered\";\n+  public static final boolean DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED_DEFAULT\n+      = false;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MzM2Mg=="}, "originalCommit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3519, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}