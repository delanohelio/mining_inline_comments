{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzNDA2ODk5", "number": 2473, "title": "HADOOP-17385. ITestS3ADeleteCost.testDirMarkersFileCreation failure", "bodyText": "The addition of deprecated S3A configuration options in HADOOP-17318\ntriggered a reload of default (xml resource) configurations, which breaks\ntests which fail if there's a per-bucket setting inconsistent with test\nsetup.\nCreating an S3AFS instance before creating the Configuration() instance\nfor test runs gets that reload out the way before test setup takes\nplace.\nAlong with the fix, extra changes in the failing test suite to fail\nfast when marker policy isn't as expected, and to log FS state better.\nTesting: S3 London with marker policy forced to override (which is why this specific test failed)", "createdAt": "2020-11-18T19:03:20Z", "url": "https://github.com/apache/hadoop/pull/2473", "merged": true, "mergeCommit": {"oid": "67dc0928c1accd0093317b64f551cc1b63f01d9e"}, "closed": true, "closedAt": "2020-11-26T12:50:34Z", "author": {"login": "steveloughran"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeQpyKgFqTUzNTEyNTI4NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgSNjBAFqTUzOTI3NzE1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MTI1Mjg0", "url": "https://github.com/apache/hadoop/pull/2473#pullrequestreview-535125284", "createdAt": "2020-11-20T05:28:50Z", "commit": {"oid": "ebd8242f9b2068b4dd81d4e310db6eee67e31737"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNToyODo1MVrOH2-lMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwNTozMTo0MVrOH2-vYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQxMDQ4MA==", "bodyText": "Looks like jira id is wrong.", "url": "https://github.com/apache/hadoop/pull/2473#discussion_r527410480", "createdAt": "2020-11-20T05:28:51Z", "author": {"login": "mukund-thakur"}, "path": "hadoop-tools/hadoop-aws/src/test/java/org/apache/hadoop/fs/s3a/AbstractS3ATestBase.java", "diffHunk": "@@ -60,6 +60,9 @@ public void setup() throws Exception {\n     // filesystems which add default configuration resources to do it before\n     // our tests start adding/removing options. See HADOOP-16626.\n     FileSystem.getLocal(new Configuration());\n+    // instantiate an S3A FS here here to force deprecated key load through the\n+    // static initializers. See: HADOOP-17835", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebd8242f9b2068b4dd81d4e310db6eee67e31737"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzQxMzA5MA==", "bodyText": "typo: two here.", "url": "https://github.com/apache/hadoop/pull/2473#discussion_r527413090", "createdAt": "2020-11-20T05:31:41Z", "author": {"login": "mukund-thakur"}, "path": "hadoop-tools/hadoop-aws/src/test/java/org/apache/hadoop/fs/s3a/AbstractS3ATestBase.java", "diffHunk": "@@ -60,6 +60,9 @@ public void setup() throws Exception {\n     // filesystems which add default configuration resources to do it before\n     // our tests start adding/removing options. See HADOOP-16626.\n     FileSystem.getLocal(new Configuration());\n+    // instantiate an S3A FS here here to force deprecated key load through the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebd8242f9b2068b4dd81d4e310db6eee67e31737"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54c1cd31c2ca02c2073c3de4bad503aab8b209f3", "author": {"user": {"login": "steveloughran", "name": "Steve Loughran"}}, "url": "https://github.com/apache/hadoop/commit/54c1cd31c2ca02c2073c3de4bad503aab8b209f3", "committedDate": "2020-11-23T14:45:53Z", "message": "HADOOP-17385. ITestS3ADeleteCost.testDirMarkersFileCreation failure\n\nThe addition of deprecated S3A configuration options in HADOOP-17318\ntriggered a reload of default (xml resource) configurations, which breaks\ntests which fail if there's a per-bucket setting inconsistent with test\nsetup.\n\nCreating an S3AFS instance before creating the Configuration() instance\nfor test runs gets that reload out the way before test setup takes\nplace.\n\nAlong with the fix, extra changes in the failing test suite to fail\nfast when marker policy isn't as expected, and to log FS state better.\n\nChange-Id: I9f58cf0d42c5ac98962b4a9fed9f3ff93ef182ac"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5da48dd42332e5edf62b6884297d7245779f0ce8", "author": {"user": {"login": "steveloughran", "name": "Steve Loughran"}}, "url": "https://github.com/apache/hadoop/commit/5da48dd42332e5edf62b6884297d7245779f0ce8", "committedDate": "2020-11-23T14:45:53Z", "message": "HADOOP-17385. fix import\n\nChange-Id: Ic48f762aea7552ec1d204298326ad3f2c2b749ea"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57f30e3df348086aa9a0525638f8145206c2431c", "author": {"user": {"login": "steveloughran", "name": "Steve Loughran"}}, "url": "https://github.com/apache/hadoop/commit/57f30e3df348086aa9a0525638f8145206c2431c", "committedDate": "2020-11-23T15:31:18Z", "message": "HADOOP-17385. ITestS3ADeleteCost -fix nits.\n\n+Rebase to trunk to get rid of the license warnings\n\nChange-Id: I679ea2711ce832700ef4aae0ce16008483ff40bc"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ebd8242f9b2068b4dd81d4e310db6eee67e31737", "author": {"user": {"login": "steveloughran", "name": "Steve Loughran"}}, "url": "https://github.com/apache/hadoop/commit/ebd8242f9b2068b4dd81d4e310db6eee67e31737", "committedDate": "2020-11-19T10:40:18Z", "message": "HADOOP-17385. fix import\n\nChange-Id: Ic48f762aea7552ec1d204298326ad3f2c2b749ea"}, "afterCommit": {"oid": "57f30e3df348086aa9a0525638f8145206c2431c", "author": {"user": {"login": "steveloughran", "name": "Steve Loughran"}}, "url": "https://github.com/apache/hadoop/commit/57f30e3df348086aa9a0525638f8145206c2431c", "committedDate": "2020-11-23T15:31:18Z", "message": "HADOOP-17385. ITestS3ADeleteCost -fix nits.\n\n+Rebase to trunk to get rid of the license warnings\n\nChange-Id: I679ea2711ce832700ef4aae0ce16008483ff40bc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MzY4OTQ3", "url": "https://github.com/apache/hadoop/pull/2473#pullrequestreview-538368947", "createdAt": "2020-11-25T10:45:39Z", "commit": {"oid": "57f30e3df348086aa9a0525638f8145206c2431c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxMDo0NTo0MFrOH5tg8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxMDo0NTo0MFrOH5tg8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI3NjU5Mg==", "bodyText": "I think it would be cleaner if we could run the static initializers instead of creating an object without storing the reference. I know that there's a comment there stating that this is required because of a jira, but I don't see the point why would we create an object just to trigger side effects.", "url": "https://github.com/apache/hadoop/pull/2473#discussion_r530276592", "createdAt": "2020-11-25T10:45:40Z", "author": {"login": "bgaborg"}, "path": "hadoop-tools/hadoop-aws/src/test/java/org/apache/hadoop/fs/s3a/AbstractS3ATestBase.java", "diffHunk": "@@ -60,6 +60,9 @@ public void setup() throws Exception {\n     // filesystems which add default configuration resources to do it before\n     // our tests start adding/removing options. See HADOOP-16626.\n     FileSystem.getLocal(new Configuration());\n+    // instantiate an S3A FS here here to force deprecated key load through the\n+    // static initializers. See: HADOOP-17385\n+    new S3AFileSystem();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57f30e3df348086aa9a0525638f8145206c2431c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36524ff183243c976682134aa947e75f0be4e450", "author": {"user": {"login": "steveloughran", "name": "Steve Loughran"}}, "url": "https://github.com/apache/hadoop/commit/36524ff183243c976682134aa947e75f0be4e450", "committedDate": "2020-11-25T13:30:40Z", "message": "HADOOP-17385. Add and use explicit S3AFileSystem.initializeClass()\n\nRather than create and discard an instance, add a new static method\nto S3AFS and invoke it in test setup. This forces the load\n\nChange-Id: Id52b1c46912c6fedd2ae270e2b1eb2222a360329"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5Mjc3MTU0", "url": "https://github.com/apache/hadoop/pull/2473#pullrequestreview-539277154", "createdAt": "2020-11-26T12:35:54Z", "commit": {"oid": "36524ff183243c976682134aa947e75f0be4e450"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3282, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}