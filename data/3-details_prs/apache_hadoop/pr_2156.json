{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUzNjcyMzU4", "number": 2156, "title": "HDFS-15479. Ordered snapshot deletion: make it a configurable feature", "bodyText": "Please see https://issues.apache.org/jira/browse/HDFS-15479", "createdAt": "2020-07-20T17:35:35Z", "url": "https://github.com/apache/hadoop/pull/2156", "merged": true, "mergeCommit": {"oid": "d57462f2daee5f057e32219d4123a3f75506d6d4"}, "closed": true, "closedAt": "2020-07-21T06:06:24Z", "author": {"login": "szetszwo"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc21JTDgH2gAyNDUzNjcyMzU4OjRiN2U4ODhmNDU5YTQ0ZjI3ODhhY2U0OTdhYWUwODYzZjc0ZDllNjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3CZ-fAFqTQ1MjI1NjIzNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4b7e888f459a44f2788ace497aae0863f74d9e68", "author": {"user": {"login": "szetszwo", "name": "Tsz-Wo Nicholas Sze"}}, "url": "https://github.com/apache/hadoop/commit/4b7e888f459a44f2788ace497aae0863f74d9e68", "committedDate": "2020-07-20T17:33:07Z", "message": "HDFS-15479"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "641c3d5a93358a6f5cbf3dee412fbbb25713a048", "author": {"user": {"login": "szetszwo", "name": "Tsz-Wo Nicholas Sze"}}, "url": "https://github.com/apache/hadoop/commit/641c3d5a93358a6f5cbf3dee412fbbb25713a048", "committedDate": "2020-07-20T21:23:08Z", "message": "Fix checkstyle warnings."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8", "author": {"user": {"login": "szetszwo", "name": "Tsz-Wo Nicholas Sze"}}, "url": "https://github.com/apache/hadoop/commit/ebf46aa2961da49ba106f30a659454f7b65061d8", "committedDate": "2020-07-21T01:25:25Z", "message": "Fix checkstyle again"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMTUwMDI1", "url": "https://github.com/apache/hadoop/pull/2156#pullrequestreview-452150025", "createdAt": "2020-07-21T06:06:08Z", "commit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMjU2MjM2", "url": "https://github.com/apache/hadoop/pull/2156#pullrequestreview-452256236", "createdAt": "2020-07-21T08:52:59Z", "commit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwODo1MzowMFrOG0ugLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwODo1NjozOVrOG0upQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MTAzOA==", "bodyText": "This check is not needed as all the other user of xattrs like encryption, erasure encoding calls\nFSDirXAttrOp.unprotectedSetXAttrs(fsd, srcIIP, xattrs, flag) directly without doing a feature check.", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457941038", "createdAt": "2020-07-21T08:53:00Z", "author": {"login": "mukul1987"}, "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java", "diffHunk": "@@ -353,6 +354,20 @@ public int getListLimit() {\n         + \" hard limit \" + DFSConfigKeys.DFS_NAMENODE_MAX_XATTR_SIZE_HARD_LIMIT\n         + \": (%s).\", DFSConfigKeys.DFS_NAMENODE_MAX_XATTR_SIZE_KEY);\n \n+    this.snapshotDeletionOrdered =\n+        conf.getBoolean(DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED,\n+            DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED_DEFAULT);\n+    LOG.info(\"{} = {}\", DFSConfigKeys.DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED,\n+        snapshotDeletionOrdered);\n+    if (snapshotDeletionOrdered && !xattrsEnabled) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk0MzM2Mg==", "bodyText": "Lets also add the value to hdfs-default.xml", "url": "https://github.com/apache/hadoop/pull/2156#discussion_r457943362", "createdAt": "2020-07-21T08:56:39Z", "author": {"login": "mukul1987"}, "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/DFSConfigKeys.java", "diffHunk": "@@ -500,8 +500,13 @@\n \n   public static final String DFS_NAMENODE_SNAPSHOT_MAX_LIMIT =\n       \"dfs.namenode.snapshot.max.limit\";\n-\n   public static final int DFS_NAMENODE_SNAPSHOT_MAX_LIMIT_DEFAULT = 65536;\n+\n+  public static final String DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED =\n+      \"dfs.namenode.snapshot.deletion.ordered\";\n+  public static final boolean DFS_NAMENODE_SNAPSHOT_DELETION_ORDERED_DEFAULT\n+      = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebf46aa2961da49ba106f30a659454f7b65061d8"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4188, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}