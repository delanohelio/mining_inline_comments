{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2MjQ4ODYy", "number": 2355, "title": "HDFS-15611. Add list Snapshot command in WebHDFS.", "bodyText": "please check https://issues.apache.org/jira/browse/HDFS-15611", "createdAt": "2020-10-01T13:12:25Z", "url": "https://github.com/apache/hadoop/pull/2355", "merged": true, "mergeCommit": {"oid": "16aea11c945c84936984e80241dcdd4a0d4b7f58"}, "closed": true, "closedAt": "2020-10-07T05:04:33Z", "author": {"login": "bshashikant"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdORJnkAH2gAyNDk2MjQ4ODYyOmI2YjIwOTBhN2NjMGEwN2IwYWZjZjYxMzc4MTc1MTlmN2I5NWNkNGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdP7LefAFqTUwMzE2MTcxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b6b2090a7cc0a07b0afcf6137817519f7b95cd4b", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/hadoop/commit/b6b2090a7cc0a07b0afcf6137817519f7b95cd4b", "committedDate": "2020-10-01T13:11:04Z", "message": "HDFS-15611. Add list Snapshot command in WebHDFS."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "508e648d9a7f42b5afcf31867b9c9c5b8653139b", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/hadoop/commit/508e648d9a7f42b5afcf31867b9c9c5b8653139b", "committedDate": "2020-10-01T16:16:02Z", "message": "Fixed compilation issue."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/hadoop/commit/e7c07bcb9275a1c23412ccb8eb49491b0652e517", "committedDate": "2020-10-01T16:22:03Z", "message": "Fixed unit test."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwODQxNDYx", "url": "https://github.com/apache/hadoop/pull/2355#pullrequestreview-500841461", "createdAt": "2020-10-02T03:24:51Z", "commit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzoyNDo1MlrOHbgZbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMzozNzozNFrOHbghfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODYwNDM5Nw==", "bodyText": "Use \"DELETED\".equal(..) in order to avoid NPE?\n final boolean isDeleted = \"DELETED\".equals(json.get(\"deletionStatus\"));", "url": "https://github.com/apache/hadoop/pull/2355#discussion_r498604397", "createdAt": "2020-10-02T03:24:52Z", "author": {"login": "szetszwo"}, "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/web/JsonUtilClient.java", "diffHunk": "@@ -872,4 +873,39 @@ private static SnapshottableDirectoryStatus toSnapshottableDirectoryStatus(\n             snapshotQuota, parentFullPath);\n     return snapshottableDirectoryStatus;\n   }\n+\n+  public static SnapshotStatus[] toSnapshotList(final Map<?, ?> json) {\n+    if (json == null) {\n+      return null;\n+    }\n+    List<?> list = (List<?>) json.get(\"SnapshotList\");\n+    if (list == null) {\n+      return null;\n+    }\n+    SnapshotStatus[] statuses =\n+        new SnapshotStatus[list.size()];\n+    for (int i = 0; i < list.size(); i++) {\n+      statuses[i] = toSnapshotStatus((Map<?, ?>) list.get(i));\n+    }\n+    return statuses;\n+  }\n+\n+  private static SnapshotStatus toSnapshotStatus(\n+      Map<?, ?> json) {\n+    if (json == null) {\n+      return null;\n+    }\n+    int snapshotID = getInt(json, \"snapshotID\", 0);\n+    boolean isDeleted = ((String)json.get(\"deletionStatus\")).\n+        contentEquals(\"DELETED\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODYwNTEyMA==", "bodyText": "In DistributedFileSystem, it is called\n  public SnapshotStatus[] getSnapshotListing(Path snapshotRoot)\nLet's use the same name?", "url": "https://github.com/apache/hadoop/pull/2355#discussion_r498605120", "createdAt": "2020-10-02T03:29:27Z", "author": {"login": "szetszwo"}, "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/web/WebHdfsFileSystem.java", "diffHunk": "@@ -1459,6 +1460,19 @@ SnapshotDiffReport decodeResponse(Map<?, ?> json) {\n     }.run();\n   }\n \n+  public SnapshotStatus[] getSnapshotList(final Path snapshotDir)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODYwNTE4Ng==", "bodyText": "Unused import.", "url": "https://github.com/apache/hadoop/pull/2355#discussion_r498605186", "createdAt": "2020-10-02T03:29:48Z", "author": {"login": "szetszwo"}, "path": "hadoop-hdfs-project/hadoop-hdfs-client/src/main/java/org/apache/hadoop/hdfs/protocol/SnapshotStatus.java", "diffHunk": "@@ -25,6 +25,7 @@\n import org.apache.hadoop.fs.Path;\n import org.apache.hadoop.fs.permission.FsPermission;\n import org.apache.hadoop.hdfs.DFSUtilClient;\n+import org.apache.hadoop.util.StringUtils;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODYwNjQ2Mg==", "bodyText": "It should call getSnapshotListing.", "url": "https://github.com/apache/hadoop/pull/2355#discussion_r498606462", "createdAt": "2020-10-02T03:37:34Z", "author": {"login": "szetszwo"}, "path": "hadoop-hdfs-project/hadoop-hdfs-httpfs/src/main/java/org/apache/hadoop/fs/http/client/HttpFSFileSystem.java", "diffHunk": "@@ -1582,6 +1584,18 @@ public SnapshotDiffReport getSnapshotDiffReport(Path path,\n     return JsonUtilClient.toSnapshottableDirectoryList(json);\n   }\n \n+  public SnapshotStatus[] getSnapshotList(Path snapshotRoot)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7c07bcb9275a1c23412ccb8eb49491b0652e517"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "739e04540a3abb32205ed04b2bf0276932f4537c", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/hadoop/commit/739e04540a3abb32205ed04b2bf0276932f4537c", "committedDate": "2020-10-02T05:45:33Z", "message": "Addressed Review comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwODk4NTA4", "url": "https://github.com/apache/hadoop/pull/2355#pullrequestreview-500898508", "createdAt": "2020-10-02T07:02:18Z", "commit": {"oid": "739e04540a3abb32205ed04b2bf0276932f4537c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0e61c1d0cf652182c8d68538f0d41a74909d39a", "author": {"user": {"login": "bshashikant", "name": null}}, "url": "https://github.com/apache/hadoop/commit/c0e61c1d0cf652182c8d68538f0d41a74909d39a", "committedDate": "2020-10-05T06:03:25Z", "message": "Addressed checkstyle issues."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzMTYxNzE3", "url": "https://github.com/apache/hadoop/pull/2355#pullrequestreview-503161717", "createdAt": "2020-10-06T16:43:02Z", "commit": {"oid": "c0e61c1d0cf652182c8d68538f0d41a74909d39a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3765, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}