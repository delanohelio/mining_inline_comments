{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NjQ5NjYz", "number": 1974, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMToyMVrOD1Z4SQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNVQxNzoxNDoyOVrOD2JmZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzI1MTI5OnYy", "diffSide": "RIGHT", "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/CompositeGroupsMapping.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMToyMVrOGK1Hcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxODowMToyMVrOGK1Hcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDAwOTIwMw==", "bodyText": "Now, somebody calling getGroups() would start failing if it was adding new things to the list while that was not the case before. I've tried using inmodifiable before but is kind of dangerous.", "url": "https://github.com/apache/hadoop/pull/1974#discussion_r414009203", "createdAt": "2020-04-23T18:01:21Z", "author": {"login": "goiri"}, "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/CompositeGroupsMapping.java", "diffHunk": "@@ -78,15 +79,13 @@\n             user, provider.getClass().getSimpleName(), e.toString());\n         LOG.debug(\"Stacktrace: \", e);\n       }        \n-      if (groups != null && ! groups.isEmpty()) {\n+      if (!groups.isEmpty()) {\n         groupSet.addAll(groups);\n         if (!combined) break;\n       }\n     }\n \n-    List<String> results = new ArrayList<String>(groupSet.size());\n-    results.addAll(groupSet);\n-    return results;\n+    return Collections.unmodifiableList(new ArrayList<>(groupSet));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbf1e0e2a41e0c3c6d4cf4ef19046b3cfd7b2993"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4MTA2OTgwOnYy", "diffSide": "RIGHT", "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/NetworkTopology.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNVQxNzoxNDoyOVrOGL37Ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMzo1MzoyNFrOGMkXQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTEwMzgzNQ==", "bodyText": "Why can we use unmodifiable here?", "url": "https://github.com/apache/hadoop/pull/1974#discussion_r415103835", "createdAt": "2020-04-25T17:14:29Z", "author": {"login": "goiri"}, "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/NetworkTopology.java", "diffHunk": "@@ -196,10 +196,8 @@ protected Node getNodeForNetworkLocation(Node node) {\n         loc = loc.substring(1);\n       }\n       InnerNode rack = (InnerNode) clusterMap.getLoc(loc);\n-      if (rack == null) {\n-        return null;\n-      }\n-      return new ArrayList<Node>(rack.getChildren());\n+      return (rack == null) ? Collections.emptyList()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98e9ebea42c9e0aca429f2c012b70bf60ef703b6"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgzMTg3NQ==", "bodyText": "Ya, I guess we probably shouldn't.  My thinking wsa \"\n\nReturning null is usually a bad idea, return Collections.emptyList()\nCollections.emptyList() is immutable\nTo make the method consistent, the list of racks should be immutable too.\n\nI will revert this to return an emptyList (new ArrayList<>(0))", "url": "https://github.com/apache/hadoop/pull/1974#discussion_r415831875", "createdAt": "2020-04-27T13:53:24Z", "author": {"login": "belugabehr"}, "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/NetworkTopology.java", "diffHunk": "@@ -196,10 +196,8 @@ protected Node getNodeForNetworkLocation(Node node) {\n         loc = loc.substring(1);\n       }\n       InnerNode rack = (InnerNode) clusterMap.getLoc(loc);\n-      if (rack == null) {\n-        return null;\n-      }\n-      return new ArrayList<Node>(rack.getChildren());\n+      return (rack == null) ? Collections.emptyList()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTEwMzgzNQ=="}, "originalCommit": {"oid": "98e9ebea42c9e0aca429f2c012b70bf60ef703b6"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3528, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}