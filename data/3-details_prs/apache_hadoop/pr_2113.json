{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMjk3ODg2", "number": 2113, "title": "HADOOP-17105: S3AFS - Do not attempt to resolve symlinks in globStatus", "bodyText": "S3AFS does not support symlinks, so attempting to resolve\nsymlinks in globStatus causes wasted S3 calls and worse\nperformance. Removing it will speed up some calls to\nglobStatus.\nJIRA link: https://issues.apache.org/jira/browse/HADOOP-17105", "createdAt": "2020-06-30T21:14:55Z", "url": "https://github.com/apache/hadoop/pull/2113", "merged": true, "mergeCommit": {"oid": "806d84b79c97cd0bbed324f6a324d7c110a6fd87"}, "closed": true, "closedAt": "2020-07-13T18:07:49Z", "author": {"login": "jimmy-zuber-amzn"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwuP_ogH2gAyNDQyMjk3ODg2OmE5ZWM4ODg0N2Y0NDFlNTFhZTA2ZDRkZTliYmJmMGZlYWE3MDZhMWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyLlhTAFqTQ0MjgxMzYxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a9ec88847f441e51ae06d4de9bbbf0feaa706a1b", "author": {"user": {"login": "jimmy-zuber-amzn", "name": null}}, "url": "https://github.com/apache/hadoop/commit/a9ec88847f441e51ae06d4de9bbbf0feaa706a1b", "committedDate": "2020-07-01T18:07:33Z", "message": "S3AFS - Do not attempt to resolve symlinks in globStatus\n\nS3AFS does not support symlinks, so attempting to resolve\nsymlinks in globStatus causes wasted S3 calls and worse\nperformance. Removing it will speed up some calls to\nglobStatus.\n\nJIRA link: https://issues.apache.org/jira/browse/HADOOP-17105"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7940ede82d1d0077f814c4b41eeb99cadea1cc33", "author": {"user": {"login": "jimmy-zuber-amzn", "name": null}}, "url": "https://github.com/apache/hadoop/commit/7940ede82d1d0077f814c4b41eeb99cadea1cc33", "committedDate": "2020-06-30T21:06:41Z", "message": "S3AFS - Do not attempt to resolve symlinks in globStatus\n\nS3AFS does not support symlinks, so attempting to resolve\nsymlinks in globStatus causes wasted S3 calls and worse\nperformance. Removing it will speed up some calls to\nglobStatus.\n\nJIRA link: https://issues.apache.org/jira/browse/HADOOP-17105"}, "afterCommit": {"oid": "a9ec88847f441e51ae06d4de9bbbf0feaa706a1b", "author": {"user": {"login": "jimmy-zuber-amzn", "name": null}}, "url": "https://github.com/apache/hadoop/commit/a9ec88847f441e51ae06d4de9bbbf0feaa706a1b", "committedDate": "2020-07-01T18:07:33Z", "message": "S3AFS - Do not attempt to resolve symlinks in globStatus\n\nS3AFS does not support symlinks, so attempting to resolve\nsymlinks in globStatus causes wasted S3 calls and worse\nperformance. Removing it will speed up some calls to\nglobStatus.\n\nJIRA link: https://issues.apache.org/jira/browse/HADOOP-17105"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyODEzNjE3", "url": "https://github.com/apache/hadoop/pull/2113#pullrequestreview-442813617", "createdAt": "2020-07-06T06:52:13Z", "commit": {"oid": "a9ec88847f441e51ae06d4de9bbbf0feaa706a1b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo1MjoxNFrOGtK2Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQwNjo1MjoxNFrOGtK2Ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAxNjc4Nw==", "bodyText": "Both these tests look almost the same in terms operation counts and also the symlink resolution is always disabled.\nCan you please tell me why do we need two tests here? Thanks.", "url": "https://github.com/apache/hadoop/pull/2113#discussion_r450016787", "createdAt": "2020-07-06T06:52:14Z", "author": {"login": "mukund-thakur"}, "path": "hadoop-tools/hadoop-aws/src/test/java/org/apache/hadoop/fs/s3a/ITestS3AFileOperationCost.java", "diffHunk": "@@ -574,4 +574,48 @@ public void testCreateCost() throws Throwable {\n     }\n \n   }\n+\n+  @Test\n+  public void testCostOfGlobStatus() throws Throwable {\n+    describe(\"Test globStatus has expected cost\");\n+    S3AFileSystem fs = getFileSystem();\n+    assume(\"Unguarded FS only\", !fs.hasMetadataStore());\n+\n+    Path basePath = path(\"testCostOfGlobStatus/nextFolder/\");\n+\n+    // create a bunch of files\n+    int filesToCreate = 10;\n+    for (int i = 0; i < filesToCreate; i++) {\n+      try (FSDataOutputStream out = fs.create(basePath.suffix(\"/\" + i))) {\n+        verifyOperationCount(1, 1);\n+      }\n+    }\n+\n+    fs.globStatus(basePath.suffix(\"/*\"));\n+    // 2 head + 1 list from getFileStatus on path,\n+    // plus 1 list to match the glob pattern\n+    verifyOperationCount(2, 2);\n+  }\n+\n+  @Test\n+  public void testCostOfGlobStatusNoSymlinkResolution() throws Throwable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9ec88847f441e51ae06d4de9bbbf0feaa706a1b"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4115, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}