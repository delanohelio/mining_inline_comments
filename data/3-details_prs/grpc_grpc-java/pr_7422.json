{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NzI2Njcx", "number": 7422, "title": "Add support for IBMJSSE2 into grpc-java", "bodyText": "I made this very simple change to test for IBMJSSE2 security provider in addition to the others.\nIBM JRE does not support the Sun provider, but instead has IBMJSSE2 which supports the same API calls.\nI tested this on Z/OS machine as now it works when before it couldn't find a security provider", "createdAt": "2020-09-14T16:05:52Z", "url": "https://github.com/grpc/grpc-java/pull/7422", "merged": true, "mergeCommit": {"oid": "5879b53c573549028dbcf84fdc206503311870a6"}, "closed": true, "closedAt": "2020-09-16T15:07:53Z", "author": {"login": "kiwi1969"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdIUQLUAH2gAyNDg2NzI2NjcxOjQ0ZWY3YmIxYmRkMTFhY2E0YTAzMjNlY2FmNTViYzkyMjZkODcyZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJQAXXAFqTQ4OTE2NDE4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "44ef7bb1bdd11aca4a0323ecaf55bc9226d872d7", "author": {"user": {"login": "kiwi1969", "name": "Russell Shaw"}}, "url": "https://github.com/grpc/grpc-java/commit/44ef7bb1bdd11aca4a0323ecaf55bc9226d872d7", "committedDate": "2020-09-13T01:24:24Z", "message": "Update GrpcSslContexts.java\n\nAdd support for IBMJSSE2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80c1bef2045e221cd038900664017dadc4944fe0", "author": {"user": {"login": "kiwi1969", "name": "Russell Shaw"}}, "url": "https://github.com/grpc/grpc-java/commit/80c1bef2045e221cd038900664017dadc4944fe0", "committedDate": "2020-09-13T03:00:43Z", "message": "Add files via upload\n\nCompiled on MacBook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9f5bc5ca63564a08f20444d6666ddb0ad2c08c1", "author": {"user": {"login": "kiwi1969", "name": "Russell Shaw"}}, "url": "https://github.com/grpc/grpc-java/commit/e9f5bc5ca63564a08f20444d6666ddb0ad2c08c1", "committedDate": "2020-09-13T03:22:02Z", "message": "Delete grpc-netty-shaded-1.33.0-SNAPSHOT.jar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d47497bb30f2294d4471ee7eeba998fe290686ae", "author": {"user": {"login": "kiwi1969", "name": "Russell Shaw"}}, "url": "https://github.com/grpc/grpc-java/commit/d47497bb30f2294d4471ee7eeba998fe290686ae", "committedDate": "2020-09-13T03:46:22Z", "message": "Update GrpcSslContexts.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a7eca432cedc214d4e855ff439c3ec6e031478e", "author": {"user": {"login": "kiwi1969", "name": "Russell Shaw"}}, "url": "https://github.com/grpc/grpc-java/commit/9a7eca432cedc214d4e855ff439c3ec6e031478e", "committedDate": "2020-09-13T03:47:58Z", "message": "Update GrpcSslContexts.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "143ccbdf1043d843d67fcfffcc2f4a86c22ae6ad", "author": {"user": {"login": "kiwi1969", "name": "Russell Shaw"}}, "url": "https://github.com/grpc/grpc-java/commit/143ccbdf1043d843d67fcfffcc2f4a86c22ae6ad", "committedDate": "2020-09-13T04:05:01Z", "message": "Prebuilt jar for IBMJSEE testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10b908975e37da636516c1ee07a7dcc27025dc8a", "author": {"user": {"login": "kiwi1969", "name": "Russell Shaw"}}, "url": "https://github.com/grpc/grpc-java/commit/10b908975e37da636516c1ee07a7dcc27025dc8a", "committedDate": "2020-09-14T15:58:52Z", "message": "Delete grpc-netty-shaded-1.33.0-SNAPSHOT.jar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3OTQzMzg5", "url": "https://github.com/grpc/grpc-java/pull/7422#pullrequestreview-487943389", "createdAt": "2020-09-14T16:25:06Z", "commit": {"oid": "10b908975e37da636516c1ee07a7dcc27025dc8a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjoyNTowNlrOHRdBdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNjoyNTowNlrOHRdBdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA2MzM1MA==", "bodyText": "I don't think the IBM provider supports Jetty ALPN/NPN, so this should be its own separate condition checking for isJava9AlpnAvailable. Ditto for findJdkProvider", "url": "https://github.com/grpc/grpc-java/pull/7422#discussion_r488063350", "createdAt": "2020-09-14T16:25:06Z", "author": {"login": "ejona86"}, "path": "netty/src/main/java/io/grpc/netty/GrpcSslContexts.java", "diffHunk": "@@ -186,7 +187,8 @@ public static SslContextBuilder configure(SslContextBuilder builder, SslProvider\n   @CanIgnoreReturnValue\n   public static SslContextBuilder configure(SslContextBuilder builder, Provider jdkProvider) {\n     ApplicationProtocolConfig apc;\n-    if (SUN_PROVIDER_NAME.equals(jdkProvider.getName())) {\n+    if (SUN_PROVIDER_NAME.equals(jdkProvider.getName())\n+        || IBM_PROVIDER_NAME.equals(jdkProvider.getName())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10b908975e37da636516c1ee07a7dcc27025dc8a"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc4b9054291991acc060e1799e3f315321aefc9b", "author": {"user": {"login": "kiwi1969", "name": "Russell Shaw"}}, "url": "https://github.com/grpc/grpc-java/commit/dc4b9054291991acc060e1799e3f315321aefc9b", "committedDate": "2020-09-15T20:03:36Z", "message": "Update GrpcSslContexts.java\n\nIBMJSSE2 enhancement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MDM1OTk3", "url": "https://github.com/grpc/grpc-java/pull/7422#pullrequestreview-489035997", "createdAt": "2020-09-15T20:14:26Z", "commit": {"oid": "dc4b9054291991acc060e1799e3f315321aefc9b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MTUwNzE4", "url": "https://github.com/grpc/grpc-java/pull/7422#pullrequestreview-489150718", "createdAt": "2020-09-15T22:27:27Z", "commit": {"oid": "dc4b9054291991acc060e1799e3f315321aefc9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoyNzoyOFrOHSX_Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoyNzoyOFrOHSX_Tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAyOTQ1NA==", "bodyText": "Because of the insertion of this else clause, the behavior is now different when using IBM JRE and both Conscrypt and IBMJSSE2 are present. It will now pick IBMJSSE2 over Conscrypt. If we want to keep the old behavior the else clause will need to be the last one.", "url": "https://github.com/grpc/grpc-java/pull/7422#discussion_r489029454", "createdAt": "2020-09-15T22:27:28Z", "author": {"login": "sanjaypujare"}, "path": "netty/src/main/java/io/grpc/netty/GrpcSslContexts.java", "diffHunk": "@@ -243,6 +251,10 @@ private static Provider findJdkProvider() {\n             || JettyTlsUtil.isJava9AlpnAvailable()) {\n           return provider;\n         }\n+      } else if (IBM_PROVIDER_NAME.equals(provider.getName())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc4b9054291991acc060e1799e3f315321aefc9b"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MTYwNDc1", "url": "https://github.com/grpc/grpc-java/pull/7422#pullrequestreview-489160475", "createdAt": "2020-09-15T22:51:42Z", "commit": {"oid": "dc4b9054291991acc060e1799e3f315321aefc9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjo1MTo0MlrOHSZHOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjo1MTo0MlrOHSZHOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA0Nzg2Ng==", "bodyText": "Similar to my other comment. Because of where this else clause is placed the exception thrown will be different when the jdkProvider is IBMJSSE2 and Java9Alpn is unavailable. Most probably it's not a big deal but I thought it's worth pointing out.", "url": "https://github.com/grpc/grpc-java/pull/7422#discussion_r489047866", "createdAt": "2020-09-15T22:51:42Z", "author": {"login": "sanjaypujare"}, "path": "netty/src/main/java/io/grpc/netty/GrpcSslContexts.java", "diffHunk": "@@ -196,7 +197,14 @@ public static SslContextBuilder configure(SslContextBuilder builder, Provider jd\n         apc = ALPN;\n       } else {\n         throw new IllegalArgumentException(\n-            SUN_PROVIDER_NAME + \" selected, but Java 9+ and Jetty NPN/ALPN unavailable\");\n+            jdkProvider.getName() + \" selected, but Java 9+ and Jetty NPN/ALPN unavailable\");\n+      }\n+    } else if (IBM_PROVIDER_NAME.equals(jdkProvider.getName())) {\n+      if (JettyTlsUtil.isJava9AlpnAvailable()) {\n+        apc = ALPN;\n+      } else {\n+        throw new IllegalArgumentException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc4b9054291991acc060e1799e3f315321aefc9b"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MTY0MTg5", "url": "https://github.com/grpc/grpc-java/pull/7422#pullrequestreview-489164189", "createdAt": "2020-09-15T23:01:26Z", "commit": {"oid": "dc4b9054291991acc060e1799e3f315321aefc9b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4037, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}