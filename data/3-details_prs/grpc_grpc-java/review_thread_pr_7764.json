{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2MjE1NDQy", "number": 7764, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQyMzo0NjoyMVrOFJpPmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQyMzo0NjoyMVrOFJpPmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NjU3MjQwOnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/SharedXdsClientPoolProvider.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQyMzo0NjoyMVrOIMEDjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMTozNDozMVrOIMFGeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUyMDI3MQ==", "bodyText": "It can be shutdown more gracefully with shutdown(). As long as all xdsClients cancel their streams in xdsClient.shutdown(), the channel can be terminated.", "url": "https://github.com/grpc/grpc-java/pull/7764#discussion_r549520271", "createdAt": "2020-12-28T23:46:21Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/SharedXdsClientPoolProvider.java", "diffHunk": "@@ -121,26 +134,27 @@ public XdsClient returnObject(Object object) {\n         if (refCount == 0) {\n           xdsClient.shutdown();\n           xdsClient = null;\n+          channel.shutdownNow();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65cedd5e874135f49cc2a84c14be32692ef6d776"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUzNTAyNA==", "bodyText": "Yeah, I was unsure if we need to use shutdownNow() here to make sure it is quickly shut down. For cases like #7752, the reference to the current xDS channel may be quickly cleared and a new xDS channel is created. shutdownNow() seems to be safer, doesn't it? Is there any reason that shutdown() is better?", "url": "https://github.com/grpc/grpc-java/pull/7764#discussion_r549535024", "createdAt": "2020-12-29T01:18:58Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/SharedXdsClientPoolProvider.java", "diffHunk": "@@ -121,26 +134,27 @@ public XdsClient returnObject(Object object) {\n         if (refCount == 0) {\n           xdsClient.shutdown();\n           xdsClient = null;\n+          channel.shutdownNow();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUyMDI3MQ=="}, "originalCommit": {"oid": "65cedd5e874135f49cc2a84c14be32692ef6d776"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUzNzQwMQ==", "bodyText": "Well, as you said it doesn't actually matter much as long as streams are canceled when XdsClient shuts down. I am changing it to shutdown(), we will see if any problem will be encountered.", "url": "https://github.com/grpc/grpc-java/pull/7764#discussion_r549537401", "createdAt": "2020-12-29T01:34:31Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/SharedXdsClientPoolProvider.java", "diffHunk": "@@ -121,26 +134,27 @@ public XdsClient returnObject(Object object) {\n         if (refCount == 0) {\n           xdsClient.shutdown();\n           xdsClient = null;\n+          channel.shutdownNow();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUyMDI3MQ=="}, "originalCommit": {"oid": "65cedd5e874135f49cc2a84c14be32692ef6d776"}, "originalPosition": 119}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2955, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}