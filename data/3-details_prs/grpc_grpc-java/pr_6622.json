{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0Mzg1MTMy", "number": 6622, "title": "xds: enable keepalive for XDS channel", "bodyText": "XDS clients will use a keepalive time of 5 minutes , and a keepalive timeout of 20 seconds.\nUnfortunately it's not possible to be tested in unit test.", "createdAt": "2020-01-18T03:07:04Z", "url": "https://github.com/grpc/grpc-java/pull/6622", "merged": true, "mergeCommit": {"oid": "1f1ccf2641d35fdc5910b2780885ac694355f504"}, "closed": true, "closedAt": "2020-01-22T01:03:38Z", "author": {"login": "dapengzhang0"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7acnfgH2gAyMzY0Mzg1MTMyOjAzYTFhNGJhMDNkNDg3MmYwZWRiYmQ2ODVmM2Y4OWQzYmVjOWVkMjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8nhS5gH2gAyMzY0Mzg1MTMyOmYzMTgxOTdmMTc3NDFlZjU3MDUxNGM4NDJhN2JiODA3NGY1MTAyOTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "03a1a4ba03d4872f0edbbd685f3f89d3bec9ed21", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/03a1a4ba03d4872f0edbbd685f3f89d3bec9ed21", "committedDate": "2020-01-18T03:05:15Z", "message": "xds: enable keepalive for XDS channel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MDM3MDY3", "url": "https://github.com/grpc/grpc-java/pull/6622#pullrequestreview-345037067", "createdAt": "2020-01-19T23:54:51Z", "commit": {"oid": "03a1a4ba03d4872f0edbbd685f3f89d3bec9ed21"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQyMzo1NDo1MVrOFfRVxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQyMzo1NDo1MVrOFfRVxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODMzNDI3OQ==", "bodyText": "DO we really want to hardcode these values? WHat will be ideal is if we can supply these values from the Bootstrap file as XdsNameResolver.start -> XdsClientImpl ctor -> XdsClient.createChannel() so these are configurable at runtime. The defaults could be these hardcoded values.", "url": "https://github.com/grpc/grpc-java/pull/6622#discussion_r368334279", "createdAt": "2020-01-19T23:54:51Z", "author": {"login": "sanjaypujare"}, "path": "xds/src/main/java/io/grpc/xds/XdsClient.java", "diffHunk": "@@ -491,19 +492,23 @@ ManagedChannel createChannel(List<ServerInfo> servers) {\n         ServerInfo serverInfo = servers.get(0);\n         String serverUri = serverInfo.getServerUri();\n         List<ChannelCreds> channelCredsList = serverInfo.getChannelCredentials();\n-        ManagedChannel ch = null;\n+        ManagedChannelBuilder<?> channelBuilder = null;\n         // Use the first supported channel credentials configuration.\n         // Currently, only \"google_default\" is supported.\n         for (ChannelCreds creds : channelCredsList) {\n           if (creds.getType().equals(\"google_default\")) {\n-            ch = GoogleDefaultChannelBuilder.forTarget(serverUri).build();\n+            channelBuilder = GoogleDefaultChannelBuilder.forTarget(serverUri);\n             break;\n           }\n         }\n-        if (ch == null) {\n-          ch = ManagedChannelBuilder.forTarget(serverUri).build();\n+        if (channelBuilder == null) {\n+          channelBuilder = ManagedChannelBuilder.forTarget(serverUri);\n         }\n-        return ch;\n+\n+        return channelBuilder\n+            .keepAliveTime(5, TimeUnit.MINUTES)\n+            .keepAliveTimeout(20, TimeUnit.SECONDS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03a1a4ba03d4872f0edbbd685f3f89d3bec9ed21"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MDU4Nzc0", "url": "https://github.com/grpc/grpc-java/pull/6622#pullrequestreview-346058774", "createdAt": "2020-01-21T17:28:46Z", "commit": {"oid": "03a1a4ba03d4872f0edbbd685f3f89d3bec9ed21"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNzoyODo0NlrOFgCh6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxNzoyODo0NlrOFgCh6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE0MDIwMg==", "bodyText": "I was thinking we'd just leave Timeout as its default. Yes, the default is 20 seconds, but no need to specify that here.", "url": "https://github.com/grpc/grpc-java/pull/6622#discussion_r369140202", "createdAt": "2020-01-21T17:28:46Z", "author": {"login": "ejona86"}, "path": "xds/src/main/java/io/grpc/xds/XdsClient.java", "diffHunk": "@@ -491,19 +492,23 @@ ManagedChannel createChannel(List<ServerInfo> servers) {\n         ServerInfo serverInfo = servers.get(0);\n         String serverUri = serverInfo.getServerUri();\n         List<ChannelCreds> channelCredsList = serverInfo.getChannelCredentials();\n-        ManagedChannel ch = null;\n+        ManagedChannelBuilder<?> channelBuilder = null;\n         // Use the first supported channel credentials configuration.\n         // Currently, only \"google_default\" is supported.\n         for (ChannelCreds creds : channelCredsList) {\n           if (creds.getType().equals(\"google_default\")) {\n-            ch = GoogleDefaultChannelBuilder.forTarget(serverUri).build();\n+            channelBuilder = GoogleDefaultChannelBuilder.forTarget(serverUri);\n             break;\n           }\n         }\n-        if (ch == null) {\n-          ch = ManagedChannelBuilder.forTarget(serverUri).build();\n+        if (channelBuilder == null) {\n+          channelBuilder = ManagedChannelBuilder.forTarget(serverUri);\n         }\n-        return ch;\n+\n+        return channelBuilder\n+            .keepAliveTime(5, TimeUnit.MINUTES)\n+            .keepAliveTimeout(20, TimeUnit.SECONDS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03a1a4ba03d4872f0edbbd685f3f89d3bec9ed21"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f318197f17741ef570514c842a7bb8074f510292", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/f318197f17741ef570514c842a7bb8074f510292", "committedDate": "2020-01-21T20:53:03Z", "message": "unspecify keepalive timeout"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4822, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}