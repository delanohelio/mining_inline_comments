{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMjgyMjQz", "number": 6800, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMjoxNzowOVrODlORxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwMTozMzoxOVrODlQyfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzU3ODMwOnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMjoxNzowOVrOFx_smw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzoyODowMlrOFyBYVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk2ODE1NQ==", "bodyText": "Why always add a round_robin policy into child policy? Even if its child policy is not empty.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387968155", "createdAt": "2020-03-04T22:17:09Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -78,8 +76,38 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n       Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry registry) {\n     try {\n       String cluster = JsonUtil.getString(rawLoadBalancingPolicyConfig, \"cluster\");\n-      LbConfig childPolicy = selectChildPolicy(rawLoadBalancingPolicyConfig, registry);\n-      LbConfig fallbackPolicy = selectFallbackPolicy(rawLoadBalancingPolicyConfig, registry);\n+\n+      LbConfig roundRobinConfig = new LbConfig(\"round_robin\", ImmutableMap.<String, Object>of());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk3MTczOA==", "bodyText": "round_robin is the default policy, if everything in the list is not supported, it will use round_robin instead of error.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387971738", "createdAt": "2020-03-04T22:25:33Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -78,8 +76,38 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n       Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry registry) {\n     try {\n       String cluster = JsonUtil.getString(rawLoadBalancingPolicyConfig, \"cluster\");\n-      LbConfig childPolicy = selectChildPolicy(rawLoadBalancingPolicyConfig, registry);\n-      LbConfig fallbackPolicy = selectFallbackPolicy(rawLoadBalancingPolicyConfig, registry);\n+\n+      LbConfig roundRobinConfig = new LbConfig(\"round_robin\", ImmutableMap.<String, Object>of());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk2ODE1NQ=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk3MjM1Ng==", "bodyText": "Really? That's not the case for the existing implementation.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387972356", "createdAt": "2020-03-04T22:26:55Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -78,8 +76,38 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n       Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry registry) {\n     try {\n       String cluster = JsonUtil.getString(rawLoadBalancingPolicyConfig, \"cluster\");\n-      LbConfig childPolicy = selectChildPolicy(rawLoadBalancingPolicyConfig, registry);\n-      LbConfig fallbackPolicy = selectFallbackPolicy(rawLoadBalancingPolicyConfig, registry);\n+\n+      LbConfig roundRobinConfig = new LbConfig(\"round_robin\", ImmutableMap.<String, Object>of());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk2ODE1NQ=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5NTczMg==", "bodyText": "The refactor design doc says so. The existing implementation used hard coded round_robin.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387995732", "createdAt": "2020-03-04T23:28:02Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -78,8 +76,38 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n       Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry registry) {\n     try {\n       String cluster = JsonUtil.getString(rawLoadBalancingPolicyConfig, \"cluster\");\n-      LbConfig childPolicy = selectChildPolicy(rawLoadBalancingPolicyConfig, registry);\n-      LbConfig fallbackPolicy = selectFallbackPolicy(rawLoadBalancingPolicyConfig, registry);\n+\n+      LbConfig roundRobinConfig = new LbConfig(\"round_robin\", ImmutableMap.<String, Object>of());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk2ODE1NQ=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzY4NDY4OnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMjo1ODoxN1rOFyAuvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwMDowMDoyMFrOFyCBDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NTA4NQ==", "bodyText": "Since now this is the parsed child policy, I think we would make this field non-null.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387985085", "createdAt": "2020-03-04T22:58:17Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -92,51 +120,17 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n     }\n   }\n \n-  @VisibleForTesting\n-  static LbConfig selectFallbackPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> fallbackConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"fallbackPolicy\"));\n-    LbConfig fallbackPolicy = selectSupportedLbPolicy(fallbackConfigs, lbRegistry);\n-    return fallbackPolicy == null ? DEFAULT_FALLBACK_POLICY : fallbackPolicy;\n-  }\n-\n-  @Nullable\n-  @VisibleForTesting\n-  static LbConfig selectChildPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> childConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"childPolicy\"));\n-    return selectSupportedLbPolicy(childConfigs, lbRegistry);\n-  }\n-\n-  @Nullable\n-  private static LbConfig selectSupportedLbPolicy(\n-      @Nullable List<LbConfig> lbConfigs, LoadBalancerRegistry lbRegistry) {\n-    if (lbConfigs == null) {\n-      return null;\n-    }\n-    for (LbConfig lbConfig : lbConfigs) {\n-      String lbPolicy = lbConfig.getPolicyName();\n-      if (lbRegistry.getProvider(lbPolicy) != null) {\n-        return lbConfig;\n-      }\n-    }\n-    return null;\n-  }\n-\n   /**\n    * Represents a successfully parsed and validated LoadBalancingConfig for XDS.\n    */\n   static final class XdsConfig {\n     // FIXME(chengyuanzhang): make cluster name required.\n     @Nullable\n     final String cluster;\n-    // TODO(carl-mastrangelo): make these Object's containing the fully parsed child configs.\n     @Nullable\n-    final LbConfig childPolicy;\n+    final PolicySelection childPolicy;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAwNjE1Nw==", "bodyText": "Done.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388006157", "createdAt": "2020-03-05T00:00:20Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -92,51 +120,17 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n     }\n   }\n \n-  @VisibleForTesting\n-  static LbConfig selectFallbackPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> fallbackConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"fallbackPolicy\"));\n-    LbConfig fallbackPolicy = selectSupportedLbPolicy(fallbackConfigs, lbRegistry);\n-    return fallbackPolicy == null ? DEFAULT_FALLBACK_POLICY : fallbackPolicy;\n-  }\n-\n-  @Nullable\n-  @VisibleForTesting\n-  static LbConfig selectChildPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> childConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"childPolicy\"));\n-    return selectSupportedLbPolicy(childConfigs, lbRegistry);\n-  }\n-\n-  @Nullable\n-  private static LbConfig selectSupportedLbPolicy(\n-      @Nullable List<LbConfig> lbConfigs, LoadBalancerRegistry lbRegistry) {\n-    if (lbConfigs == null) {\n-      return null;\n-    }\n-    for (LbConfig lbConfig : lbConfigs) {\n-      String lbPolicy = lbConfig.getPolicyName();\n-      if (lbRegistry.getProvider(lbPolicy) != null) {\n-        return lbConfig;\n-      }\n-    }\n-    return null;\n-  }\n-\n   /**\n    * Represents a successfully parsed and validated LoadBalancingConfig for XDS.\n    */\n   static final class XdsConfig {\n     // FIXME(chengyuanzhang): make cluster name required.\n     @Nullable\n     final String cluster;\n-    // TODO(carl-mastrangelo): make these Object's containing the fully parsed child configs.\n     @Nullable\n-    final LbConfig childPolicy;\n+    final PolicySelection childPolicy;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NTA4NQ=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 117}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzY5NzQ4OnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzowMzo1NFrOFyA2ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzo0Njo0N1rOFyBwmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NzEwNw==", "bodyText": "Do we always have a default fallback policy? If it is, this would be non-null.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387987107", "createdAt": "2020-03-04T23:03:54Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -92,51 +120,17 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n     }\n   }\n \n-  @VisibleForTesting\n-  static LbConfig selectFallbackPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> fallbackConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"fallbackPolicy\"));\n-    LbConfig fallbackPolicy = selectSupportedLbPolicy(fallbackConfigs, lbRegistry);\n-    return fallbackPolicy == null ? DEFAULT_FALLBACK_POLICY : fallbackPolicy;\n-  }\n-\n-  @Nullable\n-  @VisibleForTesting\n-  static LbConfig selectChildPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> childConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"childPolicy\"));\n-    return selectSupportedLbPolicy(childConfigs, lbRegistry);\n-  }\n-\n-  @Nullable\n-  private static LbConfig selectSupportedLbPolicy(\n-      @Nullable List<LbConfig> lbConfigs, LoadBalancerRegistry lbRegistry) {\n-    if (lbConfigs == null) {\n-      return null;\n-    }\n-    for (LbConfig lbConfig : lbConfigs) {\n-      String lbPolicy = lbConfig.getPolicyName();\n-      if (lbRegistry.getProvider(lbPolicy) != null) {\n-        return lbConfig;\n-      }\n-    }\n-    return null;\n-  }\n-\n   /**\n    * Represents a successfully parsed and validated LoadBalancingConfig for XDS.\n    */\n   static final class XdsConfig {\n     // FIXME(chengyuanzhang): make cluster name required.\n     @Nullable\n     final String cluster;\n-    // TODO(carl-mastrangelo): make these Object's containing the fully parsed child configs.\n     @Nullable\n-    final LbConfig childPolicy;\n+    final PolicySelection childPolicy;\n     @Nullable\n-    final LbConfig fallbackPolicy;\n+    final PolicySelection fallbackPolicy;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5ODAxNQ==", "bodyText": "Not clear. Currently the CdsLoadBalancer will not create a fallback policy in EDS policy. So it is nullable.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387998015", "createdAt": "2020-03-04T23:35:16Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -92,51 +120,17 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n     }\n   }\n \n-  @VisibleForTesting\n-  static LbConfig selectFallbackPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> fallbackConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"fallbackPolicy\"));\n-    LbConfig fallbackPolicy = selectSupportedLbPolicy(fallbackConfigs, lbRegistry);\n-    return fallbackPolicy == null ? DEFAULT_FALLBACK_POLICY : fallbackPolicy;\n-  }\n-\n-  @Nullable\n-  @VisibleForTesting\n-  static LbConfig selectChildPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> childConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"childPolicy\"));\n-    return selectSupportedLbPolicy(childConfigs, lbRegistry);\n-  }\n-\n-  @Nullable\n-  private static LbConfig selectSupportedLbPolicy(\n-      @Nullable List<LbConfig> lbConfigs, LoadBalancerRegistry lbRegistry) {\n-    if (lbConfigs == null) {\n-      return null;\n-    }\n-    for (LbConfig lbConfig : lbConfigs) {\n-      String lbPolicy = lbConfig.getPolicyName();\n-      if (lbRegistry.getProvider(lbPolicy) != null) {\n-        return lbConfig;\n-      }\n-    }\n-    return null;\n-  }\n-\n   /**\n    * Represents a successfully parsed and validated LoadBalancingConfig for XDS.\n    */\n   static final class XdsConfig {\n     // FIXME(chengyuanzhang): make cluster name required.\n     @Nullable\n     final String cluster;\n-    // TODO(carl-mastrangelo): make these Object's containing the fully parsed child configs.\n     @Nullable\n-    final LbConfig childPolicy;\n+    final PolicySelection childPolicy;\n     @Nullable\n-    final LbConfig fallbackPolicy;\n+    final PolicySelection fallbackPolicy;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NzEwNw=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAwMTE5Mg==", "bodyText": "Hmm, that's bad. We might want to define EdsConfig in EdsLoadBalancerProvider so XdsConfig becomes\nclass XdsConfig {\n  PolicySelection edsPolicy;\n  PolicySelection fallbackPolicy;\n}", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388001192", "createdAt": "2020-03-04T23:44:44Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -92,51 +120,17 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n     }\n   }\n \n-  @VisibleForTesting\n-  static LbConfig selectFallbackPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> fallbackConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"fallbackPolicy\"));\n-    LbConfig fallbackPolicy = selectSupportedLbPolicy(fallbackConfigs, lbRegistry);\n-    return fallbackPolicy == null ? DEFAULT_FALLBACK_POLICY : fallbackPolicy;\n-  }\n-\n-  @Nullable\n-  @VisibleForTesting\n-  static LbConfig selectChildPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> childConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"childPolicy\"));\n-    return selectSupportedLbPolicy(childConfigs, lbRegistry);\n-  }\n-\n-  @Nullable\n-  private static LbConfig selectSupportedLbPolicy(\n-      @Nullable List<LbConfig> lbConfigs, LoadBalancerRegistry lbRegistry) {\n-    if (lbConfigs == null) {\n-      return null;\n-    }\n-    for (LbConfig lbConfig : lbConfigs) {\n-      String lbPolicy = lbConfig.getPolicyName();\n-      if (lbRegistry.getProvider(lbPolicy) != null) {\n-        return lbConfig;\n-      }\n-    }\n-    return null;\n-  }\n-\n   /**\n    * Represents a successfully parsed and validated LoadBalancingConfig for XDS.\n    */\n   static final class XdsConfig {\n     // FIXME(chengyuanzhang): make cluster name required.\n     @Nullable\n     final String cluster;\n-    // TODO(carl-mastrangelo): make these Object's containing the fully parsed child configs.\n     @Nullable\n-    final LbConfig childPolicy;\n+    final PolicySelection childPolicy;\n     @Nullable\n-    final LbConfig fallbackPolicy;\n+    final PolicySelection fallbackPolicy;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NzEwNw=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAwMTk0NQ==", "bodyText": "No, we don't know if we eventually will have FallbackPolicy in EdsConfig.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388001945", "createdAt": "2020-03-04T23:46:47Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/XdsLoadBalancerProvider.java", "diffHunk": "@@ -92,51 +120,17 @@ static ConfigOrError parseLoadBalancingConfigPolicy(\n     }\n   }\n \n-  @VisibleForTesting\n-  static LbConfig selectFallbackPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> fallbackConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"fallbackPolicy\"));\n-    LbConfig fallbackPolicy = selectSupportedLbPolicy(fallbackConfigs, lbRegistry);\n-    return fallbackPolicy == null ? DEFAULT_FALLBACK_POLICY : fallbackPolicy;\n-  }\n-\n-  @Nullable\n-  @VisibleForTesting\n-  static LbConfig selectChildPolicy(\n-      Map<String, ?> rawLoadBalancingPolicyConfig, LoadBalancerRegistry lbRegistry) {\n-    List<LbConfig> childConfigs = ServiceConfigUtil.unwrapLoadBalancingConfigList(\n-        JsonUtil.getListOfObjects(rawLoadBalancingPolicyConfig, \"childPolicy\"));\n-    return selectSupportedLbPolicy(childConfigs, lbRegistry);\n-  }\n-\n-  @Nullable\n-  private static LbConfig selectSupportedLbPolicy(\n-      @Nullable List<LbConfig> lbConfigs, LoadBalancerRegistry lbRegistry) {\n-    if (lbConfigs == null) {\n-      return null;\n-    }\n-    for (LbConfig lbConfig : lbConfigs) {\n-      String lbPolicy = lbConfig.getPolicyName();\n-      if (lbRegistry.getProvider(lbPolicy) != null) {\n-        return lbConfig;\n-      }\n-    }\n-    return null;\n-  }\n-\n   /**\n    * Represents a successfully parsed and validated LoadBalancingConfig for XDS.\n    */\n   static final class XdsConfig {\n     // FIXME(chengyuanzhang): make cluster name required.\n     @Nullable\n     final String cluster;\n-    // TODO(carl-mastrangelo): make these Object's containing the fully parsed child configs.\n     @Nullable\n-    final LbConfig childPolicy;\n+    final PolicySelection childPolicy;\n     @Nullable\n-    final LbConfig fallbackPolicy;\n+    final PolicySelection fallbackPolicy;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NzEwNw=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 120}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzcxMzMxOnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/FallbackLb.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzoxMDo1M1rOFyBAWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzozMzoyMFrOFyBfEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4OTU5NA==", "bodyText": "I am thinking that, instead of receiving the entire XdsConfig, would it be better to just received the parsed fallback policy (i.e., PolicySelection). In this way, FallbackLb does not receive anything extra other than the policy it needs to instantiate.\nAt the mean time, I am feeling like the layer of FallbackLb is kinda unnecessary. Everything of fallback switching can be implemented in XdsLoadBalancer. The existing FallbackLb is basically doing nothing other than delegating handleResolvedAddresses call to the actual policy, which we can directly handle it in XdsLoadBalancer.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387989594", "createdAt": "2020-03-04T23:10:53Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/FallbackLb.java", "diffHunk": "@@ -58,55 +45,18 @@ protected LoadBalancer delegate() {\n     return fallbackPolicyLb;\n   }\n \n-  @SuppressWarnings(\"deprecation\")\n   @Override\n   public void handleResolvedAddresses(ResolvedAddresses resolvedAddresses) {\n-    Attributes attributes = resolvedAddresses.getAttributes();\n-    XdsConfig xdsConfig;\n-    Object lbConfig = resolvedAddresses.getLoadBalancingPolicyConfig();\n-    if (lbConfig != null) {\n-      if (!(lbConfig instanceof XdsConfig)) {\n-        fallbackLbHelper.updateBalancingState(\n-            TRANSIENT_FAILURE,\n-            new ErrorPicker(Status.UNAVAILABLE.withDescription(\n-                \"Load balancing config '\" + lbConfig + \"' is not an XdsConfig\")));\n-        return;\n-      }\n-      xdsConfig = (XdsConfig) lbConfig;\n-    } else {\n-      // In the future, in all cases xdsConfig can be obtained directly by\n-      // resolvedAddresses.getLoadBalancingPolicyConfig().\n-      Map<String, ?> newRawLbConfig = attributes.get(ATTR_LOAD_BALANCING_CONFIG);\n-      if (newRawLbConfig == null) {\n-        // This will not happen when the service config error handling is implemented.\n-        // For now simply go to TRANSIENT_FAILURE.\n-        fallbackLbHelper.updateBalancingState(\n-            TRANSIENT_FAILURE,\n-            new ErrorPicker(\n-                Status.UNAVAILABLE.withDescription(\"ATTR_LOAD_BALANCING_CONFIG not available\")));\n-        return;\n-      }\n-      ConfigOrError cfg =\n-          XdsLoadBalancerProvider.parseLoadBalancingConfigPolicy(newRawLbConfig, lbRegistry);\n-      if (cfg.getError() != null) {\n-        // This will not happen when the service config error handling is implemented.\n-        // For now simply go to TRANSIENT_FAILURE.\n-        fallbackLbHelper.updateBalancingState(TRANSIENT_FAILURE, new ErrorPicker(cfg.getError()));\n-        return;\n-      }\n-      xdsConfig = (XdsConfig) cfg.getConfig();\n-    }\n-\n-    LbConfig fallbackPolicy = xdsConfig.fallbackPolicy;\n+    XdsConfig xdsConfig = (XdsConfig) resolvedAddresses.getLoadBalancingPolicyConfig();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5NzQ1OQ==", "bodyText": "That's true, however FallbackLb is not actually used and eventually will be re-designed, I don't want to touch this class too much in this PR..", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387997459", "createdAt": "2020-03-04T23:33:20Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/FallbackLb.java", "diffHunk": "@@ -58,55 +45,18 @@ protected LoadBalancer delegate() {\n     return fallbackPolicyLb;\n   }\n \n-  @SuppressWarnings(\"deprecation\")\n   @Override\n   public void handleResolvedAddresses(ResolvedAddresses resolvedAddresses) {\n-    Attributes attributes = resolvedAddresses.getAttributes();\n-    XdsConfig xdsConfig;\n-    Object lbConfig = resolvedAddresses.getLoadBalancingPolicyConfig();\n-    if (lbConfig != null) {\n-      if (!(lbConfig instanceof XdsConfig)) {\n-        fallbackLbHelper.updateBalancingState(\n-            TRANSIENT_FAILURE,\n-            new ErrorPicker(Status.UNAVAILABLE.withDescription(\n-                \"Load balancing config '\" + lbConfig + \"' is not an XdsConfig\")));\n-        return;\n-      }\n-      xdsConfig = (XdsConfig) lbConfig;\n-    } else {\n-      // In the future, in all cases xdsConfig can be obtained directly by\n-      // resolvedAddresses.getLoadBalancingPolicyConfig().\n-      Map<String, ?> newRawLbConfig = attributes.get(ATTR_LOAD_BALANCING_CONFIG);\n-      if (newRawLbConfig == null) {\n-        // This will not happen when the service config error handling is implemented.\n-        // For now simply go to TRANSIENT_FAILURE.\n-        fallbackLbHelper.updateBalancingState(\n-            TRANSIENT_FAILURE,\n-            new ErrorPicker(\n-                Status.UNAVAILABLE.withDescription(\"ATTR_LOAD_BALANCING_CONFIG not available\")));\n-        return;\n-      }\n-      ConfigOrError cfg =\n-          XdsLoadBalancerProvider.parseLoadBalancingConfigPolicy(newRawLbConfig, lbRegistry);\n-      if (cfg.getError() != null) {\n-        // This will not happen when the service config error handling is implemented.\n-        // For now simply go to TRANSIENT_FAILURE.\n-        fallbackLbHelper.updateBalancingState(TRANSIENT_FAILURE, new ErrorPicker(cfg.getError()));\n-        return;\n-      }\n-      xdsConfig = (XdsConfig) cfg.getConfig();\n-    }\n-\n-    LbConfig fallbackPolicy = xdsConfig.fallbackPolicy;\n+    XdsConfig xdsConfig = (XdsConfig) resolvedAddresses.getLoadBalancingPolicyConfig();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4OTU5NA=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzczNjQ5OnYy", "diffSide": "RIGHT", "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzoyMTowMlrOFyBOtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzo1OToyNVrOFyCAKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5MzI2OA==", "bodyText": "You can directly use real default registry with round_robin included.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387993268", "createdAt": "2020-03-04T23:21:02Z", "author": {"login": "voidzcy"}, "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "diffHunk": "@@ -73,9 +73,15 @@ public String getPolicyName() {\n     public LoadBalancer newLoadBalancer(Helper helper) {\n       return fakeBalancer1;\n     }\n+\n+    @Override\n+    public ConfigOrError parseLoadBalancingPolicyConfig(\n+        Map<String, ?> rawLoadBalancingPolicyConfig) {\n+      return ConfigOrError.fromConfig(lbConfig1);\n+    }\n   };\n \n-  private final LoadBalancerProvider roundRobin = new LoadBalancerProvider() {\n+  private final LoadBalancerProvider roundRobinProvider = new LoadBalancerProvider() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5OTIwOQ==", "bodyText": "I need register lbProvider1 as well. The default registry is global, it's not a good practice to change its state in test.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r387999209", "createdAt": "2020-03-04T23:38:47Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "diffHunk": "@@ -73,9 +73,15 @@ public String getPolicyName() {\n     public LoadBalancer newLoadBalancer(Helper helper) {\n       return fakeBalancer1;\n     }\n+\n+    @Override\n+    public ConfigOrError parseLoadBalancingPolicyConfig(\n+        Map<String, ?> rawLoadBalancingPolicyConfig) {\n+      return ConfigOrError.fromConfig(lbConfig1);\n+    }\n   };\n \n-  private final LoadBalancerProvider roundRobin = new LoadBalancerProvider() {\n+  private final LoadBalancerProvider roundRobinProvider = new LoadBalancerProvider() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5MzI2OA=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAwMjMwOQ==", "bodyText": "That's ok, AutoConfiguredLoadBalancerFactoryTest is doing that thing.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388002309", "createdAt": "2020-03-04T23:48:00Z", "author": {"login": "voidzcy"}, "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "diffHunk": "@@ -73,9 +73,15 @@ public String getPolicyName() {\n     public LoadBalancer newLoadBalancer(Helper helper) {\n       return fakeBalancer1;\n     }\n+\n+    @Override\n+    public ConfigOrError parseLoadBalancingPolicyConfig(\n+        Map<String, ?> rawLoadBalancingPolicyConfig) {\n+      return ConfigOrError.fromConfig(lbConfig1);\n+    }\n   };\n \n-  private final LoadBalancerProvider roundRobin = new LoadBalancerProvider() {\n+  private final LoadBalancerProvider roundRobinProvider = new LoadBalancerProvider() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5MzI2OA=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAwNTQ3NA==", "bodyText": "That is bad.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388005474", "createdAt": "2020-03-04T23:57:48Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "diffHunk": "@@ -73,9 +73,15 @@ public String getPolicyName() {\n     public LoadBalancer newLoadBalancer(Helper helper) {\n       return fakeBalancer1;\n     }\n+\n+    @Override\n+    public ConfigOrError parseLoadBalancingPolicyConfig(\n+        Map<String, ?> rawLoadBalancingPolicyConfig) {\n+      return ConfigOrError.fromConfig(lbConfig1);\n+    }\n   };\n \n-  private final LoadBalancerProvider roundRobin = new LoadBalancerProvider() {\n+  private final LoadBalancerProvider roundRobinProvider = new LoadBalancerProvider() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5MzI2OA=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAwNTkzMA==", "bodyText": "No, repeating implementation is bad...", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388005930", "createdAt": "2020-03-04T23:59:25Z", "author": {"login": "voidzcy"}, "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "diffHunk": "@@ -73,9 +73,15 @@ public String getPolicyName() {\n     public LoadBalancer newLoadBalancer(Helper helper) {\n       return fakeBalancer1;\n     }\n+\n+    @Override\n+    public ConfigOrError parseLoadBalancingPolicyConfig(\n+        Map<String, ?> rawLoadBalancingPolicyConfig) {\n+      return ConfigOrError.fromConfig(lbConfig1);\n+    }\n   };\n \n-  private final LoadBalancerProvider roundRobin = new LoadBalancerProvider() {\n+  private final LoadBalancerProvider roundRobinProvider = new LoadBalancerProvider() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk5MzI2OA=="}, "originalCommit": {"oid": "dda5a77c3418dbb9a56aaba634a649c795ea809f"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzkyMzU2OnYy", "diffSide": "RIGHT", "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwMDo1NTo1M1rOFyC__w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwMTowNDozMFrOFyDJfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAyMjI3MQ==", "bodyText": "Wait, why do you do this? I mean you could just use the default registry instance for test.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388022271", "createdAt": "2020-03-05T00:55:53Z", "author": {"login": "voidzcy"}, "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "diffHunk": "@@ -73,92 +73,30 @@ public String getPolicyName() {\n     public LoadBalancer newLoadBalancer(Helper helper) {\n       return fakeBalancer1;\n     }\n-  };\n-\n-  private final LoadBalancerProvider roundRobin = new LoadBalancerProvider() {\n-    @Override\n-    public boolean isAvailable() {\n-      return true;\n-    }\n-\n-    @Override\n-    public int getPriority() {\n-      return 5;\n-    }\n-\n-    @Override\n-    public String getPolicyName() {\n-      return \"round_robin\";\n-    }\n \n     @Override\n-    public LoadBalancer newLoadBalancer(Helper helper) {\n-      return null;\n+    public ConfigOrError parseLoadBalancingPolicyConfig(\n+        Map<String, ?> rawLoadBalancingPolicyConfig) {\n+      return ConfigOrError.fromConfig(lbConfig1);\n     }\n   };\n \n+  private final LoadBalancerProvider roundRobinProvider =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d179132e7de0e614840364192006fe832769097"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAyNDcwMw==", "bodyText": "Because I didn't like to modify the global registry.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388024703", "createdAt": "2020-03-05T01:04:30Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/test/java/io/grpc/xds/XdsLoadBalancerProviderTest.java", "diffHunk": "@@ -73,92 +73,30 @@ public String getPolicyName() {\n     public LoadBalancer newLoadBalancer(Helper helper) {\n       return fakeBalancer1;\n     }\n-  };\n-\n-  private final LoadBalancerProvider roundRobin = new LoadBalancerProvider() {\n-    @Override\n-    public boolean isAvailable() {\n-      return true;\n-    }\n-\n-    @Override\n-    public int getPriority() {\n-      return 5;\n-    }\n-\n-    @Override\n-    public String getPolicyName() {\n-      return \"round_robin\";\n-    }\n \n     @Override\n-    public LoadBalancer newLoadBalancer(Helper helper) {\n-      return null;\n+    public ConfigOrError parseLoadBalancingPolicyConfig(\n+        Map<String, ?> rawLoadBalancingPolicyConfig) {\n+      return ConfigOrError.fromConfig(lbConfig1);\n     }\n   };\n \n+  private final LoadBalancerProvider roundRobinProvider =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAyMjI3MQ=="}, "originalCommit": {"oid": "3d179132e7de0e614840364192006fe832769097"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzk4OTc1OnYy", "diffSide": "RIGHT", "path": "xds/src/test/java/io/grpc/xds/CdsLoadBalancerTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQwMTozMzoxOVrOFyDpGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wN1QwMTowOTo0MlrOFzLjZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAzMjc5Mg==", "bodyText": "Same for this one.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r388032792", "createdAt": "2020-03-05T01:33:19Z", "author": {"login": "voidzcy"}, "path": "xds/src/test/java/io/grpc/xds/CdsLoadBalancerTest.java", "diffHunk": "@@ -119,6 +121,34 @@ public LoadBalancer newLoadBalancer(Helper helper) {\n     }\n   };\n \n+  private final LoadBalancerProvider fakeRoundRobinLbProvider = new LoadBalancerProvider() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b478982f0948fdda8f026831fb4c4e30a1c3358b"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIxMDUzMQ==", "bodyText": "This one is not using global registry. The test uses a new registry and registers a fake EDS lb provider, because the global registry registers the built-in EDS lb provider.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r389210531", "createdAt": "2020-03-07T01:06:32Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/test/java/io/grpc/xds/CdsLoadBalancerTest.java", "diffHunk": "@@ -119,6 +121,34 @@ public LoadBalancer newLoadBalancer(Helper helper) {\n     }\n   };\n \n+  private final LoadBalancerProvider fakeRoundRobinLbProvider = new LoadBalancerProvider() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAzMjc5Mg=="}, "originalCommit": {"oid": "b478982f0948fdda8f026831fb4c4e30a1c3358b"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIxMDk4Mg==", "bodyText": "Alright.", "url": "https://github.com/grpc/grpc-java/pull/6800#discussion_r389210982", "createdAt": "2020-03-07T01:09:42Z", "author": {"login": "voidzcy"}, "path": "xds/src/test/java/io/grpc/xds/CdsLoadBalancerTest.java", "diffHunk": "@@ -119,6 +121,34 @@ public LoadBalancer newLoadBalancer(Helper helper) {\n     }\n   };\n \n+  private final LoadBalancerProvider fakeRoundRobinLbProvider = new LoadBalancerProvider() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAzMjc5Mg=="}, "originalCommit": {"oid": "b478982f0948fdda8f026831fb4c4e30a1c3358b"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2893, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}