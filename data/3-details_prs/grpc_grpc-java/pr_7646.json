{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0MTg1MTY0", "number": 7646, "title": "xds: obtain the global SharedCallCounterMap in the xDS resolver only", "bodyText": "This is something I discussed with @ejona86 offline. It's better to obtain global resources in the resolver instead of in LB policies (similar to XdsClient). With that, the resolver has the control for what to be used by LB policies and maintaining this feature is easier for us.", "createdAt": "2020-11-19T19:37:56Z", "url": "https://github.com/grpc/grpc-java/pull/7646", "merged": true, "mergeCommit": {"oid": "40b54079ceff219270dbef8618aeae51455a8824"}, "closed": true, "closedAt": "2020-11-20T20:02:20Z", "author": {"login": "voidzcy"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeHtKtAH2gAyNTI0MTg1MTY0OjMxMTdlZDRiMWM1Y2E1MmRiZDIyZWExOThhNTM4MDk2ZmQ2MzYyYTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdebxvmAFqTUzNTY4NDc0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3117ed4b1c5ca52dbd22ea198a538096fd6362a4", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/3117ed4b1c5ca52dbd22ea198a538096fd6362a4", "committedDate": "2020-11-19T19:13:38Z", "message": "Obtain the global SharedCallCounterMap in the xDS resolver and pass it down as an attribute to LB policies."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0ODkyNDI2", "url": "https://github.com/grpc/grpc-java/pull/7646#pullrequestreview-534892426", "createdAt": "2020-11-19T22:02:26Z", "commit": {"oid": "3117ed4b1c5ca52dbd22ea198a538096fd6362a4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMjowMjoyNlrOH2zrIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQyMjowMjoyNlrOH2zrIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzIzMTc3OA==", "bodyText": "If childLbState does not need need it, might discard the key for downstream balancers.", "url": "https://github.com/grpc/grpc-java/pull/7646#discussion_r527231778", "createdAt": "2020-11-19T22:02:26Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/EdsLoadBalancer2.java", "diffHunk": "@@ -108,6 +110,10 @@ public void handleResolvedAddresses(ResolvedAddresses resolvedAddresses) {\n       xdsClientPool = resolvedAddresses.getAttributes().get(XdsAttributes.XDS_CLIENT_POOL);\n       xdsClient = xdsClientPool.getObject();\n     }\n+    if (callCounterProvider == null) {\n+      callCounterProvider =\n+          resolvedAddresses.getAttributes().get(XdsAttributes.CALL_COUNTER_PROVIDER);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3117ed4b1c5ca52dbd22ea198a538096fd6362a4"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1Njg0NzQ5", "url": "https://github.com/grpc/grpc-java/pull/7646#pullrequestreview-535684749", "createdAt": "2020-11-20T18:36:44Z", "commit": {"oid": "3117ed4b1c5ca52dbd22ea198a538096fd6362a4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4004, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}