{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNzM5ODQ4", "number": 7170, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMjo0OToyOFrOEKTXvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzowMjo1MlrOEKTjlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MjM4NTg5OnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/internal/certprovider/CertificateProvider.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMjo0OToyOFrOGrREcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNzowMDoxNVrOGrZP-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAyMTYxNg==", "bodyText": "This is a regular comment or TODO comment rather than javadoc. Ditto for the other class.", "url": "https://github.com/grpc/grpc-java/pull/7170#discussion_r448021616", "createdAt": "2020-06-30T22:49:28Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/internal/certprovider/CertificateProvider.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 The gRPC Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.grpc.xds.internal.certprovider;\n+\n+import java.security.PrivateKey;\n+import java.security.cert.X509Certificate;\n+import java.util.List;\n+\n+/**\n+ * A plug-in that provides certificates required by the xDS security component and created\n+ * using the certificate-provider config from the xDS server.\n+ *\n+ * <p>We may move this out of the internal package and make this an official API in the future.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e529756e14aca57872b16e0542776878c023a0f"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE1NTY0Mw==", "bodyText": "This is meant to be a regular comment and not a TODO comment because this is not a short-term workaround but rather a long term goal documented in the comment.", "url": "https://github.com/grpc/grpc-java/pull/7170#discussion_r448155643", "createdAt": "2020-07-01T07:00:15Z", "author": {"login": "sanjaypujare"}, "path": "xds/src/main/java/io/grpc/xds/internal/certprovider/CertificateProvider.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 The gRPC Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.grpc.xds.internal.certprovider;\n+\n+import java.security.PrivateKey;\n+import java.security.cert.X509Certificate;\n+import java.util.List;\n+\n+/**\n+ * A plug-in that provides certificates required by the xDS security component and created\n+ * using the certificate-provider config from the xDS server.\n+ *\n+ * <p>We may move this out of the internal package and make this an official API in the future.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAyMTYxNg=="}, "originalCommit": {"oid": "4e529756e14aca57872b16e0542776878c023a0f"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MjQxMDU0OnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/internal/certprovider/CertificateProvider.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzowMDoyNFrOGrRTFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzowMDoyNFrOGrRTFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAyNTM2Nw==", "bodyText": "{@link #close()} is called to \u201cshut down\u201d the provider. looks redundant as the javadoc for the close() method covers it well.\nbtw. Any reason not implementing java.io.Closable interface?", "url": "https://github.com/grpc/grpc-java/pull/7170#discussion_r448025367", "createdAt": "2020-06-30T23:00:24Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/internal/certprovider/CertificateProvider.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 The gRPC Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.grpc.xds.internal.certprovider;\n+\n+import java.security.PrivateKey;\n+import java.security.cert.X509Certificate;\n+import java.util.List;\n+\n+/**\n+ * A plug-in that provides certificates required by the xDS security component and created\n+ * using the certificate-provider config from the xDS server.\n+ *\n+ * <p>We may move this out of the internal package and make this an official API in the future.\n+ *\n+ * <p>The plugin fetches certificates - root and optionally identity cert - required by xDS\n+ * security.  {@link #close()} is called to \u201cshut down\u201d the provider.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e529756e14aca57872b16e0542776878c023a0f"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MjQxNjIwOnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/internal/certprovider/CertificateProvider.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzowMjo1MlrOGrRWVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzowMjo1MlrOGrRWVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAyNjE5OQ==", "bodyText": "These can be final?", "url": "https://github.com/grpc/grpc-java/pull/7170#discussion_r448026199", "createdAt": "2020-06-30T23:02:52Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/internal/certprovider/CertificateProvider.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 The gRPC Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.grpc.xds.internal.certprovider;\n+\n+import java.security.PrivateKey;\n+import java.security.cert.X509Certificate;\n+import java.util.List;\n+\n+/**\n+ * A plug-in that provides certificates required by the xDS security component and created\n+ * using the certificate-provider config from the xDS server.\n+ *\n+ * <p>We may move this out of the internal package and make this an official API in the future.\n+ *\n+ * <p>The plugin fetches certificates - root and optionally identity cert - required by xDS\n+ * security.  {@link #close()} is called to \u201cshut down\u201d the provider.\n+ */\n+public abstract class CertificateProvider {\n+\n+  /** A watcher is registered via the constructor to receive updates for the certificates. */\n+  public interface Watcher {\n+    void updateCertificate(PrivateKey key, List<X509Certificate> certChain);\n+\n+    void updateTrustedRoots(List<X509Certificate> trustedRoots);\n+\n+    void onError(io.grpc.Status errorStatus);\n+  }\n+\n+  /**\n+   * Concrete subclasses will call this to register the {@link Watcher}.\n+   *\n+   * @param watcher to register\n+   * @param notifyCertUpdates if true, the provider is required to call the watcher\u2019s\n+   *     updateCertificate method. Implies the Provider is capable of minting certificates.\n+   *     Used by server-side and mTLS client-side. Note the Provider is always required\n+   *     to call updateTrustedRoots to provide trusted-root updates.\n+   */\n+  protected CertificateProvider(Watcher watcher, boolean notifyCertUpdates) {\n+    this.watcher = watcher;\n+    this.notifyCertUpdates = notifyCertUpdates;\n+  }\n+\n+  /**\n+   * Called by CertificateProviderStore to ask the plugin to release all resources and stop\n+   * cert refreshes and watcher updates. The instance will be released from the store and will be\n+   * garbage collected.\n+   */\n+  public abstract void close();\n+\n+  protected Watcher watcher;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e529756e14aca57872b16e0542776878c023a0f"}, "originalPosition": 64}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2573, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}