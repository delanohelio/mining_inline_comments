{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyNTc0Mzc4", "number": 6792, "title": "all: let interop test use shaded dependency correctly take 2", "bodyText": "This include two commits:\n\nfirst rolls forward #6791\nthen fixes the issue of missing transitive dependency for the shadow configuration.", "createdAt": "2020-03-02T19:49:06Z", "url": "https://github.com/grpc/grpc-java/pull/6792", "merged": true, "mergeCommit": {"oid": "7be75a0bcb3711514c3d8e6e6fefdfb4b5ee2c2d"}, "closed": true, "closedAt": "2020-03-05T00:10:47Z", "author": {"login": "dapengzhang0"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcJyEHcgH2gAyMzgyNTc0Mzc4OjE4NTYxN2Y2NDI2OWQxOTcyM2FmZmE5NjllMWViZjYwMzFhZTBlZTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKfuPEgFqTM2OTIwNDgxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "185617f64269d19723affa969e1ebf6031ae0ee0", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/185617f64269d19723affa969e1ebf6031ae0ee0", "committedDate": "2020-03-02T18:31:09Z", "message": "Revert \"Revert \"all: let interop test use shaded dependency correctly (#6780)\"\"\n\nThis reverts commit 1df7d7ea8ed1f87c7ddd232234dfd19cdc72c4e6."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/51a81acf970b43bb0a0c6e33f3a6d9088b6a7141", "committedDate": "2020-03-02T21:20:37Z", "message": "fix shadow configuration missing transitive dependency"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3683972166e12371073cb8df98147ea910de2dd0", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/3683972166e12371073cb8df98147ea910de2dd0", "committedDate": "2020-03-02T19:45:01Z", "message": "fix shadow configuration missing transitive dependency"}, "afterCommit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/51a81acf970b43bb0a0c6e33f3a6d9088b6a7141", "committedDate": "2020-03-02T21:20:37Z", "message": "fix shadow configuration missing transitive dependency"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NTYyMzY3", "url": "https://github.com/grpc/grpc-java/pull/6792#pullrequestreview-367562367", "createdAt": "2020-03-02T22:03:40Z", "commit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQyMjowMzo0MFrOFww-Wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQyMjowMzo0MFrOFww-Wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY3ODM2Mg==", "bodyText": "This is doubly suspicious. It is strange to need to copy the dependencies, but wouldn't this also include compile-only dependencies?", "url": "https://github.com/grpc/grpc-java/pull/6792#discussion_r386678362", "createdAt": "2020-03-02T22:03:40Z", "author": {"login": "ejona86"}, "path": "alts/build.gradle", "diffHunk": "@@ -29,7 +28,14 @@ dependencies {\n         exclude group: 'io.grpc', module: 'grpc-context'\n     }\n     compileOnly libraries.javax_annotation\n-    testCompile project(':grpc-testing'),\n+\n+    // Use grpc-netty-shaded for transitive dependency.\n+    compileOnly project(':grpc-netty')\n+    shadow project(path: ':grpc-netty-shaded', configuration: 'shadow')\n+    shadow configurations.compile.getDependencies()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NDM0NjI5", "url": "https://github.com/grpc/grpc-java/pull/6792#pullrequestreview-368434629", "createdAt": "2020-03-04T00:58:10Z", "commit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwMDo1ODoxMFrOFxcE4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwMDo1ODoxMFrOFxcE4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzM4NDU0Nw==", "bodyText": "This brings in library.pgv. It needs to be excluded. (maybe with minus() like used in grpc-all?)\nI sort of think excluding may be better than using compileOnly for grpc-netty, since then both 'compile' configuration and 'shadow' configuration are functional outside of this project. It also seems to be a bit less likely to have surprises. But I can accept what's been done here.", "url": "https://github.com/grpc/grpc-java/pull/6792#discussion_r387384547", "createdAt": "2020-03-04T00:58:10Z", "author": {"login": "ejona86"}, "path": "xds/build.gradle", "diffHunk": "@@ -47,7 +47,11 @@ dependencies {\n             libraries.guava_testlib,\n             libraries.netty_epoll\n \n+    // Use grpc-netty-shaded for transitive dependency.\n+    compileOnly project(':grpc-netty')\n     shadow project(path: ':grpc-netty-shaded', configuration: 'shadow')\n+    shadow configurations.compile.getDependencies()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85551411475050a4efd87f2ef1761376aaf5fd09", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/85551411475050a4efd87f2ef1761376aaf5fd09", "committedDate": "2020-03-04T18:26:49Z", "message": "minus pgv dependency from shadow configuration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MjA0ODE4", "url": "https://github.com/grpc/grpc-java/pull/6792#pullrequestreview-369204818", "createdAt": "2020-03-04T23:42:03Z", "commit": {"oid": "85551411475050a4efd87f2ef1761376aaf5fd09"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzo0MjowM1rOFyBqJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzo0MjowM1rOFyBqJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAwMDI5Mw==", "bodyText": "Technically it would probably be best to do the same minus() thing here, but that can be a follow-up.", "url": "https://github.com/grpc/grpc-java/pull/6792#discussion_r388000293", "createdAt": "2020-03-04T23:42:03Z", "author": {"login": "ejona86"}, "path": "xds/build.gradle", "diffHunk": "@@ -39,11 +38,18 @@ dependencies {\n \n     testCompile project(':grpc-core').sourceSets.test.output\n \n-    compileOnly libraries.javax_annotation\n+    compileOnly libraries.javax_annotation,\n+            // At runtime use the epoll included in grpc-netty-shaded", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85551411475050a4efd87f2ef1761376aaf5fd09"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4618, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}