{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NTYzNDg4", "number": 7713, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMToxMzoyMVrOFDr3wQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMToxMzoyMVrOFDr3wQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5NDA4ODMzOnYy", "diffSide": "RIGHT", "path": "core/src/main/java/io/grpc/internal/Http2ClientStreamTransportState.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMToxMzoyMVrOIDdi_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMToxOToyN1rOIDdw0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDUwMDczMw==", "bodyText": "The return value of readableBytes() may depend on the current read index, and inboundDataReceived(frame) may have changed the read index?", "url": "https://github.com/grpc/grpc-java/pull/7713#discussion_r540500733", "createdAt": "2020-12-10T21:13:21Z", "author": {"login": "dapengzhang0"}, "path": "core/src/main/java/io/grpc/internal/Http2ClientStreamTransportState.java", "diffHunk": "@@ -147,8 +147,13 @@ protected void transportDataReceived(ReadableBuffer frame, boolean endOfStream)\n       inboundDataReceived(frame);\n       if (endOfStream) {\n         // This is a protocol violation as we expect to receive trailers.\n-        transportError =\n-            Status.INTERNAL.withDescription(\"Received unexpected EOS on DATA frame from server.\");\n+        if (frame.readableBytes() > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f4bbb12f518d2ac11c4343d592ba4e8ea2af221"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDUwNDI3Mw==", "bodyText": "Good catch. Fixed. This problem would have impacted #7277 as well.", "url": "https://github.com/grpc/grpc-java/pull/7713#discussion_r540504273", "createdAt": "2020-12-10T21:19:27Z", "author": {"login": "ejona86"}, "path": "core/src/main/java/io/grpc/internal/Http2ClientStreamTransportState.java", "diffHunk": "@@ -147,8 +147,13 @@ protected void transportDataReceived(ReadableBuffer frame, boolean endOfStream)\n       inboundDataReceived(frame);\n       if (endOfStream) {\n         // This is a protocol violation as we expect to receive trailers.\n-        transportError =\n-            Status.INTERNAL.withDescription(\"Received unexpected EOS on DATA frame from server.\");\n+        if (frame.readableBytes() > 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDUwMDczMw=="}, "originalCommit": {"oid": "2f4bbb12f518d2ac11c4343d592ba4e8ea2af221"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3006, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}