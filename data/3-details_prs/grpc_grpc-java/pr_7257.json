{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4MDUwOTU5", "number": 7257, "title": "xds: parse timeout from RDS responses", "bodyText": "A small part of implementing per-method timeout configuration.", "createdAt": "2020-07-28T20:58:24Z", "url": "https://github.com/grpc/grpc-java/pull/7257", "merged": true, "mergeCommit": {"oid": "14af76cab1004dede876521f76d5bac49c5471b7"}, "closed": true, "closedAt": "2020-07-31T19:12:02Z", "author": {"login": "voidzcy"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5c2poAH2gAyNDU4MDUwOTU5OjRlMmFjZDg3NjMzZGFmNzU4NDY5NTQ1NjFmYTBiM2IwNDc3MzhhZTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6HNW-gH2gAyNDU4MDUwOTU5OjkxMDc5MGQzODJhNzlhYjI5YzlhNzRkZjljYTA2ZmJhNDIzMjZjYzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4e2acd87633daf75846954561fa0b3b047738ae2", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/4e2acd87633daf75846954561fa0b3b047738ae2", "committedDate": "2020-07-28T20:56:48Z", "message": "Parse timeout from RDS responses."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3ODcxOTU0", "url": "https://github.com/grpc/grpc-java/pull/7257#pullrequestreview-457871954", "createdAt": "2020-07-29T20:28:34Z", "commit": {"oid": "4e2acd87633daf75846954561fa0b3b047738ae2"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMDoyODozNFrOG5I8TA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMDozNzo0MlrOG5JPkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU2ODUyNA==", "bodyText": "If configured as 0, the maximum allowed timeout for gRPC requests is infinity.\nhttps://github.com/envoyproxy/envoy/blob/c694e470dbc9a1dd24b296d117330f0e5becb2c9/api/envoy/api/v2/route/route_components.proto#L964", "url": "https://github.com/grpc/grpc-java/pull/7257#discussion_r462568524", "createdAt": "2020-07-29T20:28:34Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/EnvoyProtoData.java", "diffHunk": "@@ -1146,7 +1162,13 @@ public String toString() {\n           return StructOrError.fromError(\n               \"Unknown cluster specifier: \" + proto.getClusterSpecifierCase());\n       }\n-      return StructOrError.fromStruct(new RouteAction(cluster, weightedClusters));\n+      long timeoutNano = TimeUnit.SECONDS.toNanos(15L);  // default 15s\n+      if (proto.hasMaxGrpcTimeout()) {\n+        timeoutNano = Durations.toNanos(proto.getMaxGrpcTimeout());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e2acd87633daf75846954561fa0b3b047738ae2"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU3MzQ1Ng==", "bodyText": "The \"downstream end-of-stream has been processed\" in envoy API doc is about the stream from client to the envoy proxy, which more or less corresponds to onComplete() of client's request StreamObserver in proxyless case (Because the local xds plugin itself is the \"envoy proxy\".). I think it shouldn't be stated as \"end-of-stream has been processed\" for the proxyless case, in which the stream connects to the backend directly.  cc @dfawley @ejona86", "url": "https://github.com/grpc/grpc-java/pull/7257#discussion_r462573456", "createdAt": "2020-07-29T20:37:42Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/EnvoyProtoData.java", "diffHunk": "@@ -1067,18 +1069,30 @@ public String toString() {\n \n   /** See corresponding Envoy proto message {@link io.envoyproxy.envoy.api.v2.route.RouteAction}. */\n   static final class RouteAction {\n+    // Specifies the upstream timeout for the route, which spans between the point at which\n+    // the entire downstream request (i.e., end-of-stream) has been processed and when the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e2acd87633daf75846954561fa0b3b047738ae2"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "138f6b4dcf4cf2b8696c1151c394e843853bebe2", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/138f6b4dcf4cf2b8696c1151c394e843853bebe2", "committedDate": "2020-07-29T20:58:30Z", "message": "Set timeout to infinite if maxGrpcTimeout is set to 0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0cfc73b6ad38c4d5afc139a82dfcb63185a2906f", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/0cfc73b6ad38c4d5afc139a82dfcb63185a2906f", "committedDate": "2020-07-29T20:59:55Z", "message": "Delete comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3OTA2MTAx", "url": "https://github.com/grpc/grpc-java/pull/7257#pullrequestreview-457906101", "createdAt": "2020-07-29T21:19:40Z", "commit": {"oid": "0cfc73b6ad38c4d5afc139a82dfcb63185a2906f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c416aa79958211a48f8cd47e7294708186e85c2", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/4c416aa79958211a48f8cd47e7294708186e85c2", "committedDate": "2020-07-29T21:24:38Z", "message": "Add case for timeout disabled."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3OTIzNzkz", "url": "https://github.com/grpc/grpc-java/pull/7257#pullrequestreview-457923793", "createdAt": "2020-07-29T21:51:08Z", "commit": {"oid": "4c416aa79958211a48f8cd47e7294708186e85c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "910790d382a79ab29c9a74df9ca06fba42326cc1", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/910790d382a79ab29c9a74df9ca06fba42326cc1", "committedDate": "2020-07-30T22:17:37Z", "message": "Use max value instead of null."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4109, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}