{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MTA4MjM0", "number": 7485, "title": "grpclb: enhance grpclb logging", "bodyText": "Resolving an issue that when there are multiple grpclb balancers in the hierarchical balancer tree (e.g. in the case RLS), logs for grpclb streaming from them are interleaving, it's hard to tell which grpclb is doing what. Prepend the serviceName in each log to distinguish their identities.\n\n\nAdding logs when resolved address is received, oob channel is created, and initial request is sent.\n\n\n(I thought about adding some static util methods like log() to append the serviceName but that seems to be overkill.)\n(A lot of tests are testing logging behaviors which seem not necessary. However, I kept those test cases to minimize the PR.)", "createdAt": "2020-10-05T20:46:44Z", "url": "https://github.com/grpc/grpc-java/pull/7485", "merged": true, "mergeCommit": {"oid": "6cdd537f0e471b34cd4cca3fedcc7e0ef1c01309"}, "closed": true, "closedAt": "2020-10-07T23:22:53Z", "author": {"login": "dapengzhang0"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPpJHlAH2gAyNDk4MTA4MjM0OjY3YzhiNTRlYjI5MTljYWY3OWM4NDllZmYwNjY3M2VkMjk3MGFlYjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQVO3YAFqTUwNDMyNjY1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "67c8b54eb2919caf79c849eff06673ed2970aeb1", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/67c8b54eb2919caf79c849eff06673ed2970aeb1", "committedDate": "2020-10-05T19:42:10Z", "message": "grpclb: enhance grpclb logging"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0f3305c58ad4637a211056821cd829604443722f", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/0f3305c58ad4637a211056821cd829604443722f", "committedDate": "2020-10-05T21:09:13Z", "message": "log resolved addresses"}, "afterCommit": {"oid": "b4d77ab3884ca43f485965aac15af356f4d9d16a", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/b4d77ab3884ca43f485965aac15af356f4d9d16a", "committedDate": "2020-10-05T21:16:27Z", "message": "log resolved addresses"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f69e1e7d03d3b2fab6c3df4bc1c9dff5664ea675", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/f69e1e7d03d3b2fab6c3df4bc1c9dff5664ea675", "committedDate": "2020-10-05T21:26:36Z", "message": "log resolved addresses"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b4d77ab3884ca43f485965aac15af356f4d9d16a", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/b4d77ab3884ca43f485965aac15af356f4d9d16a", "committedDate": "2020-10-05T21:16:27Z", "message": "log resolved addresses"}, "afterCommit": {"oid": "f69e1e7d03d3b2fab6c3df4bc1c9dff5664ea675", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/f69e1e7d03d3b2fab6c3df4bc1c9dff5664ea675", "committedDate": "2020-10-05T21:26:36Z", "message": "log resolved addresses"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MjcxNzQ2", "url": "https://github.com/grpc/grpc-java/pull/7485#pullrequestreview-504271746", "createdAt": "2020-10-07T21:13:22Z", "commit": {"oid": "f69e1e7d03d3b2fab6c3df4bc1c9dff5664ea675"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0Mjg2MTg5", "url": "https://github.com/grpc/grpc-java/pull/7485#pullrequestreview-504286189", "createdAt": "2020-10-07T21:37:48Z", "commit": {"oid": "f69e1e7d03d3b2fab6c3df4bc1c9dff5664ea675"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QyMTozNzo0OFrOHeGcJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QyMTozNzo0OFrOHeGcJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyNDgzNw==", "bodyText": "There is no test for this new log (which is INFO level)? I am assuming there are tests for logging because it is important in terms of debuggability?", "url": "https://github.com/grpc/grpc-java/pull/7485#discussion_r501324837", "createdAt": "2020-10-07T21:37:48Z", "author": {"login": "sanjaypujare"}, "path": "grpclb/src/main/java/io/grpc/grpclb/GrpclbState.java", "diffHunk": "@@ -345,6 +361,7 @@ private void cancelLbRpcRetryTimer() {\n   }\n \n   void shutdown() {\n+    logger.log(ChannelLogLevel.INFO, \"[grpclb-<{0}>] Shutdown\", serviceName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f69e1e7d03d3b2fab6c3df4bc1c9dff5664ea675"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MzI2NjUx", "url": "https://github.com/grpc/grpc-java/pull/7485#pullrequestreview-504326651", "createdAt": "2020-10-07T23:04:16Z", "commit": {"oid": "f69e1e7d03d3b2fab6c3df4bc1c9dff5664ea675"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4073, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}