{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NDQ1Mzc1", "number": 7712, "title": "core: Don't leak CallCredentials into OOB channels", "bodyText": "The addition of CompositeChannelCredentials allowed CallCredentials to\nbe passed to the ManagedChannel itself. But the implementation was buggy\nand used the call creds for out-of-band channels as well, which is\ninappropriate since they have a different authority.\nThis also fixes a bug where resolving OOB channels would have CallCreds\nduplicated; that wasn't noticed or important because we don't use\nCallCreds in OOB channels.\nFixes #7643\n\nNote that the originalTransportFactory usage vs oobTransportFactory usage is\nsubtle. If you use the wrong one then CallCreds are duplicated. That's not great,\nbut also not the worst thing that could happen.", "createdAt": "2020-12-09T20:29:25Z", "url": "https://github.com/grpc/grpc-java/pull/7712", "merged": true, "mergeCommit": {"oid": "4be68f32873655fd4fc243eaa636549f4278fb62"}, "closed": true, "closedAt": "2020-12-10T19:49:30Z", "author": {"login": "ejona86"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkkuPgAH2gAyNTM1NDQ1Mzc1OmQzNDE5ZmY5NmUxOWJhNzVlYWQwMTUwNGIzNzQ3MmQ4OGNmZmUwMjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdk4dtzgFqTU0OTUyOTcwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d3419ff96e19ba75ead01504b37472d88cffe026", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/d3419ff96e19ba75ead01504b37472d88cffe026", "committedDate": "2020-12-09T20:25:36Z", "message": "core: Don't leak CallCredentials into OOB channels\n\nThe addition of CompositeChannelCredentials allowed CallCredentials to\nbe passed to the ManagedChannel itself. But the implementation was buggy\nand used the call creds for out-of-band channels as well, which is\ninappropriate since they have a different authority.\n\nThis also fixes a bug where resolving OOB channels would have CallCreds\nduplicated; that wasn't noticed or important because we don't use\nCallCreds in OOB channels.\n\nFixes #7643"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4ODk2MTIy", "url": "https://github.com/grpc/grpc-java/pull/7712#pullrequestreview-548896122", "createdAt": "2020-12-10T06:49:13Z", "commit": {"oid": "d3419ff96e19ba75ead01504b37472d88cffe026"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNjo0OToxM1rOIC5Qzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNjo0OToxM1rOIC5Qzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTkwNjI1NA==", "bodyText": "s/oobchannels/oobChannels/", "url": "https://github.com/grpc/grpc-java/pull/7712#discussion_r539906254", "createdAt": "2020-12-10T06:49:13Z", "author": {"login": "sanjaypujare"}, "path": "core/src/test/java/io/grpc/internal/ManagedChannelImplTest.java", "diffHunk": "@@ -1741,6 +1744,87 @@ public void oobchannels() {\n         .returnObject(balancerRpcExecutor.getScheduledExecutorService());\n   }\n \n+  @Test\n+  public void oobchannelsHaveNoChannelCallCredentials() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3419ff96e19ba75ead01504b37472d88cffe026"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4OTA5NTE3", "url": "https://github.com/grpc/grpc-java/pull/7712#pullrequestreview-548909517", "createdAt": "2020-12-10T07:17:48Z", "commit": {"oid": "d3419ff96e19ba75ead01504b37472d88cffe026"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNzoxNzo0OFrOIC6uaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNzoxNzo0OFrOIC6uaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTkzMDIxNw==", "bodyText": "Shouldn't this be oobTransportFactory? Otherwise there is no CallCredentialsApplyingTransport and no callCreds can be sent over oobChannel?", "url": "https://github.com/grpc/grpc-java/pull/7712#discussion_r539930217", "createdAt": "2020-12-10T07:17:48Z", "author": {"login": "sanjaypujare"}, "path": "core/src/main/java/io/grpc/internal/ManagedChannelImpl.java", "diffHunk": "@@ -1577,7 +1582,7 @@ public ManagedChannel build() {\n           // TODO(creamsoup) prevent main channel to shutdown if oob channel is not terminated\n           return new ManagedChannelImpl(\n                   managedChannelImplBuilder,\n-                  transportFactory,\n+                  originalTransportFactory,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3419ff96e19ba75ead01504b37472d88cffe026"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5Mzg4MjEy", "url": "https://github.com/grpc/grpc-java/pull/7712#pullrequestreview-549388212", "createdAt": "2020-12-10T16:37:05Z", "commit": {"oid": "d3419ff96e19ba75ead01504b37472d88cffe026"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d8c290e69039ef6d04de0ab6083db62463f2e32", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/9d8c290e69039ef6d04de0ab6083db62463f2e32", "committedDate": "2020-12-10T17:21:01Z", "message": "Tweak test name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NTI5NzA3", "url": "https://github.com/grpc/grpc-java/pull/7712#pullrequestreview-549529707", "createdAt": "2020-12-10T19:25:39Z", "commit": {"oid": "9d8c290e69039ef6d04de0ab6083db62463f2e32"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4751, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}