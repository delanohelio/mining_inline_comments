{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyMDIxNjQy", "number": 7108, "title": "alts: add peer attribute access for the ALTS context", "bodyText": "@ZhenLian For code review\nAdded and tested accessing peer attributes map from the handshaker result", "createdAt": "2020-06-09T19:35:32Z", "url": "https://github.com/grpc/grpc-java/pull/7108", "merged": true, "mergeCommit": {"oid": "e9ea70935b91e69a5ebc21765c06a895dae6f523"}, "closed": true, "closedAt": "2020-06-24T17:24:11Z", "author": {"login": "d-reidenbach"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoanB-gH2gAyNDMyMDIxNjQyOmE5OTdjYWQ0ZWVkZmU3NzNjYWE5ZGYzMDQ0YmQ0ZWQyNGVmMTU2OTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuJvecAFqTQzNjA0NzAxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a997cad4eedfe773caa9df3044bd4ed24ef15698", "author": {"user": {"login": "d-reidenbach", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/a997cad4eedfe773caa9df3044bd4ed24ef15698", "committedDate": "2020-06-05T22:43:13Z", "message": "Added Peer Attribute getter for ALTS plumbing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "497a37354c939c41b94a2cd6dc1bc114c8033fbf", "author": {"user": {"login": "d-reidenbach", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/497a37354c939c41b94a2cd6dc1bc114c8033fbf", "committedDate": "2020-06-08T18:31:19Z", "message": "testing ssh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a238501b115f8eb2b655c363e8ff90979aa57fd", "author": {"user": {"login": "d-reidenbach", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/4a238501b115f8eb2b655c363e8ff90979aa57fd", "committedDate": "2020-06-08T18:34:24Z", "message": "cleaning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4427b0eb24d050fa244d010a27981b31532a5a78", "author": {"user": {"login": "d-reidenbach", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/4427b0eb24d050fa244d010a27981b31532a5a78", "committedDate": "2020-06-09T19:29:21Z", "message": "Added test fgor peer attribute getter and fixed handshaker integration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cbe8e6eebbeed0452919061e69191e655baa096", "author": {"user": {"login": "d-reidenbach", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/5cbe8e6eebbeed0452919061e69191e655baa096", "committedDate": "2020-06-09T23:05:18Z", "message": "Added data to Test Peer Attribute map to better test equality"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3NjAyNjYz", "url": "https://github.com/grpc/grpc-java/pull/7108#pullrequestreview-427602663", "createdAt": "2020-06-09T23:01:41Z", "commit": {"oid": "4427b0eb24d050fa244d010a27981b31532a5a78"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMzowMTo0MVrOGhfRyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQyMzowNzoxOVrOGhfZJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc2ODY0OQ==", "bodyText": "Can we use a local variable instead of a static variable?", "url": "https://github.com/grpc/grpc-java/pull/7108#discussion_r437768649", "createdAt": "2020-06-09T23:01:41Z", "author": {"login": "ZhenLian"}, "path": "alts/src/test/java/io/grpc/alts/internal/AltsAuthContextTest.java", "diffHunk": "@@ -36,6 +40,8 @@\n   private static final String TEST_PEER_SERVICE_ACCOUNT = \"peer@gserviceaccount.com\";\n   private static final String TEST_RECORD_PROTOCOL = \"ALTSRP_GCM_AES128\";\n \n+  private static final Map<String, String> TEST_PEER_ATTRIBUTES = new HashMap<String, String>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4427b0eb24d050fa244d010a27981b31532a5a78"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc3MDUzNQ==", "bodyText": "If we define the map to be a local variable, it doesn't need to be capitalized. We usually do that for some static strings. We can also add some fake values and see if what we got equals what we expect. The key and value of that fake value could be capitalized as a static string.", "url": "https://github.com/grpc/grpc-java/pull/7108#discussion_r437770535", "createdAt": "2020-06-09T23:07:19Z", "author": {"login": "ZhenLian"}, "path": "alts/src/test/java/io/grpc/alts/internal/AltsAuthContextTest.java", "diffHunk": "@@ -54,11 +60,14 @@ public void setUp() {\n                     .setMinor(TEST_MIN_RPC_VERSION_MINOR)\n                     .build())\n             .build();\n+    Identity.Builder peerIdentity = Identity.newBuilder()\n+        .setServiceAccount(TEST_PEER_SERVICE_ACCOUNT);\n+    peerIdentity.putAllAttributes(TEST_PEER_ATTRIBUTES);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4427b0eb24d050fa244d010a27981b31532a5a78"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9394184f74108c6187b3caddca7adc991dd1776e", "author": {"user": {"login": "d-reidenbach", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/9394184f74108c6187b3caddca7adc991dd1776e", "committedDate": "2020-06-09T23:29:40Z", "message": "Fixed static variables and added a deeper map check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxNzI1Mjg5", "url": "https://github.com/grpc/grpc-java/pull/7108#pullrequestreview-431725289", "createdAt": "2020-06-16T17:16:48Z", "commit": {"oid": "9394184f74108c6187b3caddca7adc991dd1776e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNzoxNjo0OVrOGklYcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxNzoyMToxNFrOGkljIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTAxNDM4Nw==", "bodyText": "nit: remove the empty line.", "url": "https://github.com/grpc/grpc-java/pull/7108#discussion_r441014387", "createdAt": "2020-06-16T17:16:49Z", "author": {"login": "ZhenLian"}, "path": "alts/src/test/java/io/grpc/alts/internal/AltsAuthContextTest.java", "diffHunk": "@@ -18,11 +18,15 @@\n \n import static org.junit.Assert.assertEquals;\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9394184f74108c6187b3caddca7adc991dd1776e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTAxNDUxMQ==", "bodyText": "nit: empty line", "url": "https://github.com/grpc/grpc-java/pull/7108#discussion_r441014511", "createdAt": "2020-06-16T17:17:01Z", "author": {"login": "ZhenLian"}, "path": "alts/src/test/java/io/grpc/alts/internal/AltsAuthContextTest.java", "diffHunk": "@@ -18,11 +18,15 @@\n \n import static org.junit.Assert.assertEquals;\n \n+\n+import java.util.HashMap;\n+import java.util.Map;\n import org.junit.Before;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.junit.runners.JUnit4;\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9394184f74108c6187b3caddca7adc991dd1776e"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTAxNDYyOQ==", "bodyText": "nit: empty line", "url": "https://github.com/grpc/grpc-java/pull/7108#discussion_r441014629", "createdAt": "2020-06-16T17:17:13Z", "author": {"login": "ZhenLian"}, "path": "alts/src/test/java/io/grpc/alts/internal/AltsAuthContextTest.java", "diffHunk": "@@ -36,11 +40,15 @@\n   private static final String TEST_PEER_SERVICE_ACCOUNT = \"peer@gserviceaccount.com\";\n   private static final String TEST_RECORD_PROTOCOL = \"ALTSRP_GCM_AES128\";\n \n+  private Map<String, String> testPeerAttributes = new HashMap<String, String>();\n+  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9394184f74108c6187b3caddca7adc991dd1776e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTAxNzEyMQ==", "bodyText": "How about this: we make the map local, but create two static string like TEST_PEER_ATTRIBUTES_KEY and TEST_PEER_ATTRIBUTES_VALUE.", "url": "https://github.com/grpc/grpc-java/pull/7108#discussion_r441017121", "createdAt": "2020-06-16T17:21:14Z", "author": {"login": "ZhenLian"}, "path": "alts/src/test/java/io/grpc/alts/internal/AltsAuthContextTest.java", "diffHunk": "@@ -36,11 +40,15 @@\n   private static final String TEST_PEER_SERVICE_ACCOUNT = \"peer@gserviceaccount.com\";\n   private static final String TEST_RECORD_PROTOCOL = \"ALTSRP_GCM_AES128\";\n \n+  private Map<String, String> testPeerAttributes = new HashMap<String, String>();\n+  \n+\n   private HandshakerResult handshakerResult;\n   private RpcProtocolVersions rpcVersions;\n \n   @Before\n   public void setUp() {\n+    testPeerAttributes.put(\"peer\", \"attributes\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9394184f74108c6187b3caddca7adc991dd1776e"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d92afd898461062ed24c6d7d704cc18eeda6d39", "author": {"user": {"login": "d-reidenbach", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/3d92afd898461062ed24c6d7d704cc18eeda6d39", "committedDate": "2020-06-16T18:58:19Z", "message": "fixed extra line issues and static key value pair for peer attribute map testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72605ea0ed4721d5adf8a4efa6b9c2455f97c919", "author": {"user": {"login": "d-reidenbach", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/72605ea0ed4721d5adf8a4efa6b9c2455f97c919", "committedDate": "2020-06-16T22:15:09Z", "message": "clean up and initialize map in setup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxOTQ3MDg0", "url": "https://github.com/grpc/grpc-java/pull/7108#pullrequestreview-431947084", "createdAt": "2020-06-16T22:55:51Z", "commit": {"oid": "72605ea0ed4721d5adf8a4efa6b9c2455f97c919"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNjA5NjYw", "url": "https://github.com/grpc/grpc-java/pull/7108#pullrequestreview-433609660", "createdAt": "2020-06-18T20:07:03Z", "commit": {"oid": "72605ea0ed4721d5adf8a4efa6b9c2455f97c919"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MDQ3MDE2", "url": "https://github.com/grpc/grpc-java/pull/7108#pullrequestreview-436047016", "createdAt": "2020-06-23T18:27:36Z", "commit": {"oid": "72605ea0ed4721d5adf8a4efa6b9c2455f97c919"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4231, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}