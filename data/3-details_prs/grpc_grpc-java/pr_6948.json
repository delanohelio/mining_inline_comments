{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MTkyMzc0", "number": 6948, "title": "xds: implement requireClientCertificate semantics", "bodyText": "", "createdAt": "2020-04-20T17:15:01Z", "url": "https://github.com/grpc/grpc-java/pull/6948", "merged": true, "mergeCommit": {"oid": "a649737e3a238f0bf84b0f9e73d5b06e5ba016e0"}, "closed": true, "closedAt": "2020-04-21T00:04:39Z", "author": {"login": "sanjaypujare"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZiTjTgH2gAyNDA2MTkyMzc0OjE5NzI3NTc2ODAzNDIzNDVmOGFkNmZjMTM4MjMzMTY2NTFmMDE5OGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZn0r5AH2gAyNDA2MTkyMzc0OjdlZjRmNjlhNjUxYzViMTU1MzcxMTg2YmRmN2RkNWRlZWZhMDk2YzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1972757680342345f8ad6fc13823316651f0198f", "author": {"user": {"login": "sanjaypujare", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/1972757680342345f8ad6fc13823316651f0198f", "committedDate": "2020-04-20T17:12:19Z", "message": "xds: implement requireClientCertificate semantics"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NjgyMzYx", "url": "https://github.com/grpc/grpc-java/pull/6948#pullrequestreview-396682361", "createdAt": "2020-04-20T17:54:26Z", "commit": {"oid": "1972757680342345f8ad6fc13823316651f0198f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzo1NDoyNlrOGIgogw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxODowMTo0MVrOGIg7Gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU3NjQ1MQ==", "bodyText": "it looks like source can be UpstreamTlsContext, what makes this safe?", "url": "https://github.com/grpc/grpc-java/pull/6948#discussion_r411576451", "createdAt": "2020-04-20T17:54:26Z", "author": {"login": "creamsoup"}, "path": "xds/src/main/java/io/grpc/xds/internal/sds/SslContextProvider.java", "diffHunk": "@@ -66,6 +73,21 @@ CommonTlsContext getCommonTlsContext() {\n     return null;\n   }\n \n+  protected void setClientAuthValues(\n+      SslContextBuilder sslContextBuilder, CertificateValidationContext localCertValidationContext)\n+      throws CertificateException, IOException, CertStoreException {\n+    if (localCertValidationContext != null) {\n+      sslContextBuilder.trustManager(new SdsTrustManagerFactory(localCertValidationContext));\n+      DownstreamTlsContext downstreamTlsContext = (DownstreamTlsContext) getSource();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1972757680342345f8ad6fc13823316651f0198f"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU4MTIxMQ==", "bodyText": "consider make a 2 methods sets requirClientCert and make this method private. so existing test doesn't need to be modified. although name is already long, this can be more descriptive.", "url": "https://github.com/grpc/grpc-java/pull/6948#discussion_r411581211", "createdAt": "2020-04-20T18:01:41Z", "author": {"login": "creamsoup"}, "path": "xds/src/test/java/io/grpc/xds/internal/sds/CommonTlsContextTestsUtil.java", "diffHunk": "@@ -170,7 +174,10 @@ static String getTempFileNameForResourcesFile(String resFile) throws IOException\n    * Helper method to build DownstreamTlsContext for above tests. Called from other classes as well.\n    */\n   public static DownstreamTlsContext buildDownstreamTlsContextFromFilenames(\n-      @Nullable String privateKey, @Nullable String certChain, @Nullable String trustCa) {\n+      @Nullable String privateKey,\n+      @Nullable String certChain,\n+      @Nullable String trustCa,\n+      boolean requireClientCert) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1972757680342345f8ad6fc13823316651f0198f"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c33c4b5e6ee66d46fc329bd1ee120d7103efd7cb", "author": {"user": {"login": "sanjaypujare", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/c33c4b5e6ee66d46fc329bd1ee120d7103efd7cb", "committedDate": "2020-04-20T21:41:14Z", "message": "address review comments 1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODM2NjEz", "url": "https://github.com/grpc/grpc-java/pull/6948#pullrequestreview-396836613", "createdAt": "2020-04-20T21:46:45Z", "commit": {"oid": "c33c4b5e6ee66d46fc329bd1ee120d7103efd7cb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMTo0Njo0NVrOGIpC_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMTo0Njo0NVrOGIpC_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcxNDMwMg==", "bodyText": "we don't need those changes anymore.", "url": "https://github.com/grpc/grpc-java/pull/6948#discussion_r411714302", "createdAt": "2020-04-20T21:46:45Z", "author": {"login": "creamsoup"}, "path": "xds/src/test/java/io/grpc/xds/internal/sds/SecretVolumeSslContextProviderTest.java", "diffHunk": "@@ -274,7 +274,8 @@ public void getProviderForServer_defaultTlsCertificate_throwsException() {\n     try {\n       SecretVolumeSslContextProvider.getProviderForServer(\n           CommonTlsContextTestsUtil.buildDownstreamTlsContext(\n-              CommonTlsContextTestsUtil.getCommonTlsContext(tlsCert, /* certContext= */ null)));\n+              CommonTlsContextTestsUtil.getCommonTlsContext(tlsCert, /* certContext= */ null),\n+              /* requireClientCert= */ false));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c33c4b5e6ee66d46fc329bd1ee120d7103efd7cb"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc142a1cb8cc7a11a5b5f444c8a02d0120bb0269", "author": {"user": {"login": "sanjaypujare", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/dc142a1cb8cc7a11a5b5f444c8a02d0120bb0269", "committedDate": "2020-04-20T21:48:11Z", "message": "address review comments 2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODYwMzk0", "url": "https://github.com/grpc/grpc-java/pull/6948#pullrequestreview-396860394", "createdAt": "2020-04-20T22:36:34Z", "commit": {"oid": "dc142a1cb8cc7a11a5b5f444c8a02d0120bb0269"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjozNjozNFrOGIqeXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMjozNjozNFrOGIqeXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTczNzY5Mg==", "bodyText": "nit: should have a meaningful message.\nbtw, this class is rather confusing (and errorprone). it should be split into 2 different classes (server and client). can it be done? how hard to change?", "url": "https://github.com/grpc/grpc-java/pull/6948#discussion_r411737692", "createdAt": "2020-04-20T22:36:34Z", "author": {"login": "creamsoup"}, "path": "xds/src/main/java/io/grpc/xds/internal/sds/SslContextProvider.java", "diffHunk": "@@ -66,6 +79,22 @@ CommonTlsContext getCommonTlsContext() {\n     return null;\n   }\n \n+  protected void setClientAuthValues(\n+      SslContextBuilder sslContextBuilder, CertificateValidationContext localCertValidationContext)\n+      throws CertificateException, IOException, CertStoreException {\n+    checkState(server);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc142a1cb8cc7a11a5b5f444c8a02d0120bb0269"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODYxMTYy", "url": "https://github.com/grpc/grpc-java/pull/6948#pullrequestreview-396861162", "createdAt": "2020-04-20T22:38:17Z", "commit": {"oid": "dc142a1cb8cc7a11a5b5f444c8a02d0120bb0269"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ef4f69a651c5b155371186bdf7dd5deefa096c0", "author": {"user": {"login": "sanjaypujare", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/7ef4f69a651c5b155371186bdf7dd5deefa096c0", "committedDate": "2020-04-20T23:38:02Z", "message": "address review comments 3"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4552, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}