{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2MjYyMjQw", "number": 7766, "title": "netty: Upgrade to Netty 4.1.52 and tcnative 2.0.34", "bodyText": "The tiny cache size was removed from the bytebuf allocator and so was\ndeprecated. TLSv1.3 was enabled by the upgrade, which fails mTLS\nconnections at different times. Conscrypt is incompatible with the\ndefault TrustManager when TLSv1.3 is enabled so we explicitly disable\nTLSv1.3 when Conscrypt is used for the moment.\nCC @sergiitk\nFinal bits of testing are still underway internally, but things look good enough to start the review process.\nFixes #7430", "createdAt": "2020-12-28T22:51:24Z", "url": "https://github.com/grpc/grpc-java/pull/7766", "merged": true, "mergeCommit": {"oid": "8359d0b710a7fff96794115931a5105a1f013415"}, "closed": true, "closedAt": "2020-12-29T23:20:47Z", "author": {"login": "ejona86"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdqul2nAH2gAyNTQ2MjYyMjQwOmU5N2Q0Nzk3NGY1YzMwNzk4ODY3NWU0MjlmZGJlNGZiZjg4YzExMmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdrAoiBgH2gAyNTQ2MjYyMjQwOjk3NGJjYmY1ODI2ODgyNjFkYjBhYzU1Nzg2ZmQzOGYzNjAxNzk2Mzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e97d47974f5c307988675e429fdbe4fbf88c112b", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/e97d47974f5c307988675e429fdbe4fbf88c112b", "committedDate": "2020-12-28T23:19:02Z", "message": "netty: Upgrade to Netty 4.1.52 and tcnative 2.0.34\n\nThe tiny cache size was removed from the bytebuf allocator and so was\ndeprecated. TLSv1.3 was enabled by the upgrade, which fails mTLS\nconnections at different times. Conscrypt is incompatible with the\ndefault TrustManager when TLSv1.3 is enabled so we explicitly disable\nTLSv1.3 when Conscrypt is used for the moment."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f35b98da6328cd2a8ddeaa0e530d30e4149a599b", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/f35b98da6328cd2a8ddeaa0e530d30e4149a599b", "committedDate": "2020-12-28T22:48:31Z", "message": "netty: Upgrade to Netty 4.1.52 and tcnative 2.0.34\n\nThe tiny cache size was removed from the bytebuf allocator and so was\ndeprecated. TLSv1.3 was enabled by the upgrade, which fails mTLS\nconnections at different times. Conscrypt is incompatible with the\ndefault TrustManager when TLSv1.3 is enabled so we explicitly disable\nTLSv1.3 when Conscrypt is used for the moment."}, "afterCommit": {"oid": "e97d47974f5c307988675e429fdbe4fbf88c112b", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/e97d47974f5c307988675e429fdbe4fbf88c112b", "committedDate": "2020-12-28T23:19:02Z", "message": "netty: Upgrade to Netty 4.1.52 and tcnative 2.0.34\n\nThe tiny cache size was removed from the bytebuf allocator and so was\ndeprecated. TLSv1.3 was enabled by the upgrade, which fails mTLS\nconnections at different times. Conscrypt is incompatible with the\ndefault TrustManager when TLSv1.3 is enabled so we explicitly disable\nTLSv1.3 when Conscrypt is used for the moment."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MzMzNDgz", "url": "https://github.com/grpc/grpc-java/pull/7766#pullrequestreview-559333483", "createdAt": "2020-12-28T23:33:22Z", "commit": {"oid": "e97d47974f5c307988675e429fdbe4fbf88c112b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6260d71d072b9d5be6b11e74e0e6f923e6bf0e83", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/6260d71d072b9d5be6b11e74e0e6f923e6bf0e83", "committedDate": "2020-12-28T23:52:01Z", "message": "Fix tests verifying SSLHandshakeException for mTLS"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MzQ1OTQx", "url": "https://github.com/grpc/grpc-java/pull/7766#pullrequestreview-559345941", "createdAt": "2020-12-29T01:03:03Z", "commit": {"oid": "6260d71d072b9d5be6b11e74e0e6f923e6bf0e83"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMTowMzowNFrOIMEzpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMTowMzowNFrOIMEzpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUzMjU4Mg==", "bodyText": "If it enters here because of the if clause what's the point of this assertion?", "url": "https://github.com/grpc/grpc-java/pull/7766#discussion_r549532582", "createdAt": "2020-12-29T01:03:04Z", "author": {"login": "sanjaypujare"}, "path": "xds/src/test/java/io/grpc/xds/XdsSdsClientServerTest.java", "diffHunk": "@@ -175,8 +176,14 @@ public void requireClientAuth_noClientCert_expectException()\n       unaryRpc(/* requestMessage= */ \"buddy\", blockingStub);\n       fail(\"exception expected\");\n     } catch (StatusRuntimeException sre) {\n-      assertThat(sre).hasCauseThat().isInstanceOf(SSLHandshakeException.class);\n-      assertThat(sre).hasCauseThat().hasMessageThat().contains(\"HANDSHAKE_FAILURE\");\n+      if (sre.getCause() instanceof SSLHandshakeException) {\n+        assertThat(sre).hasCauseThat().isInstanceOf(SSLHandshakeException.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6260d71d072b9d5be6b11e74e0e6f923e6bf0e83"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MzQ2MDc0", "url": "https://github.com/grpc/grpc-java/pull/7766#pullrequestreview-559346074", "createdAt": "2020-12-29T01:04:03Z", "commit": {"oid": "6260d71d072b9d5be6b11e74e0e6f923e6bf0e83"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMTowNDowM1rOIME0Wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMTowNDowM1rOIME0Wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUzMjc2Mg==", "bodyText": "Same as above. If sre.getCause() instanceof SSLHandshakeException is true, wouldn't this assertion will always be true?", "url": "https://github.com/grpc/grpc-java/pull/7766#discussion_r549532762", "createdAt": "2020-12-29T01:04:03Z", "author": {"login": "sanjaypujare"}, "path": "xds/src/test/java/io/grpc/xds/XdsSdsClientServerTest.java", "diffHunk": "@@ -206,8 +213,14 @@ public void mtls_badClientCert_expectException() throws IOException, URISyntaxEx\n           false);\n       fail(\"exception expected\");\n     } catch (StatusRuntimeException sre) {\n-      assertThat(sre).hasCauseThat().isInstanceOf(SSLHandshakeException.class);\n-      assertThat(sre).hasCauseThat().hasMessageThat().contains(\"HANDSHAKE_FAILURE\");\n+      if (sre.getCause() instanceof SSLHandshakeException) {\n+        assertThat(sre).hasCauseThat().isInstanceOf(SSLHandshakeException.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6260d71d072b9d5be6b11e74e0e6f923e6bf0e83"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28068e9cf7c9920039d3b3a9335294d55db15290", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/28068e9cf7c9920039d3b3a9335294d55db15290", "committedDate": "2020-12-29T17:21:54Z", "message": "Relax channel state for slow test execution"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6aec232399e1071b0934371d130f994a48a5cfe1", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/6aec232399e1071b0934371d130f994a48a5cfe1", "committedDate": "2020-12-29T17:24:55Z", "message": "Fix grpc version netty upgrade is a part of"}, "afterCommit": {"oid": "5bb2540538a434f48bbf914f6b54f117fcb3a650", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/5bb2540538a434f48bbf914f6b54f117fcb3a650", "committedDate": "2020-12-29T17:25:39Z", "message": "Fix grpc version netty upgrade is a part of"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39dc5ea6c75dcd998b83731ae033387ea66dd892", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/39dc5ea6c75dcd998b83731ae033387ea66dd892", "committedDate": "2020-12-29T17:26:08Z", "message": "Fix grpc version netty upgrade is a part of"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5bb2540538a434f48bbf914f6b54f117fcb3a650", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/5bb2540538a434f48bbf914f6b54f117fcb3a650", "committedDate": "2020-12-29T17:25:39Z", "message": "Fix grpc version netty upgrade is a part of"}, "afterCommit": {"oid": "39dc5ea6c75dcd998b83731ae033387ea66dd892", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/39dc5ea6c75dcd998b83731ae033387ea66dd892", "committedDate": "2020-12-29T17:26:08Z", "message": "Fix grpc version netty upgrade is a part of"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "974bcbf582688261db0ac55786fd38f360179638", "author": {"user": {"login": "ejona86", "name": "Eric Anderson"}}, "url": "https://github.com/grpc/grpc-java/commit/974bcbf582688261db0ac55786fd38f360179638", "committedDate": "2020-12-29T20:20:15Z", "message": "Relax exception string check, as different OpenSSL/Boringssl versions produce slightly different errors"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4708, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}