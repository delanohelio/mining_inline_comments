{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2OTcxMzM2", "number": 6640, "title": "xds: fix bug of xDS resolver parsing service config incorrectly", "bodyText": "The change also fixed small typos in test.", "createdAt": "2020-01-24T18:59:08Z", "url": "https://github.com/grpc/grpc-java/pull/6640", "merged": true, "mergeCommit": {"oid": "e9882ec78db581106f709ab5130bfe30af660e79"}, "closed": true, "closedAt": "2020-01-25T00:12:25Z", "author": {"login": "voidzcy"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9j31DAH2gAyMzY2OTcxMzM2OjJiYzMxZWJhNWM0ZGE5NDIyY2MyYjdmZWY5MzhhYmJjMDE4YjBmNjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9m8aGgFqTM0ODI2NjkwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2bc31eba5c4da9422cc2b7fef938abbc018b0f66", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/2bc31eba5c4da9422cc2b7fef938abbc018b0f66", "committedDate": "2020-01-24T19:11:58Z", "message": "Fix bug of XdsNameResolver parsing service config incorrectly."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c5c46090f337cb9eb7eadf1e642840e8d72c7ed3", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/c5c46090f337cb9eb7eadf1e642840e8d72c7ed3", "committedDate": "2020-01-24T18:57:44Z", "message": "Fix bug of XdsNameResolver parsing service config incorrectly."}, "afterCommit": {"oid": "2bc31eba5c4da9422cc2b7fef938abbc018b0f66", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/2bc31eba5c4da9422cc2b7fef938abbc018b0f66", "committedDate": "2020-01-24T19:11:58Z", "message": "Fix bug of XdsNameResolver parsing service config incorrectly."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTkxNzkx", "url": "https://github.com/grpc/grpc-java/pull/6640#pullrequestreview-348191791", "createdAt": "2020-01-24T19:59:29Z", "commit": {"oid": "2bc31eba5c4da9422cc2b7fef938abbc018b0f66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxOTo1OToyOVrOFho5KA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxOTo1OToyOVrOFho5KA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDgxNzMyMA==", "bodyText": "nit: I think the goal of the test should be verifying result.getServiceConfig() is updated.\nObject fakeParsedConfig = new Object();\nwhen(serviceConfigParser.parseServiceConfig(anyMap)).return(ConfigOrError.fromConfig(fakeParsedConfig));\n...\nverify(serviceConfigParser).parseServiceConfig(eq(serviceConfig));\nassertThat(result.getServiceConfig().getConfig()).isEqualTo(fakeParsedConfig);", "url": "https://github.com/grpc/grpc-java/pull/6640#discussion_r370817320", "createdAt": "2020-01-24T19:59:29Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/test/java/io/grpc/xds/XdsNameResolverTest.java", "diffHunk": "@@ -260,6 +260,7 @@ public void resolve_foundResource() {\n     assertThat(result.getAddresses()).isEmpty();\n     Map<String, ?> serviceConfig =\n         result.getAttributes().get(GrpcAttributes.NAME_RESOLVER_SERVICE_CONFIG);\n+    verify(serviceConfigParser).parseServiceConfig(eq(serviceConfig));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2bc31eba5c4da9422cc2b7fef938abbc018b0f66"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08681b5aba8c45c1aab529dbbe5b50672a667a6a", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/08681b5aba8c45c1aab529dbbe5b50672a667a6a", "committedDate": "2020-01-24T22:23:45Z", "message": "Use a fake identity service config parser for testing, cover invocation of ResolutionResult#setServiceConfig(...)."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MjY2OTA5", "url": "https://github.com/grpc/grpc-java/pull/6640#pullrequestreview-348266909", "createdAt": "2020-01-24T22:46:30Z", "commit": {"oid": "08681b5aba8c45c1aab529dbbe5b50672a667a6a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQyMjo0NjozMVrOFhscDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQyMjo0NjozMVrOFhscDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDg3NTQwNA==", "bodyText": "assertThat(result.getServiceConfig()).isEqualTo(\n    serviceConfigParser.parseServiceConfig(serviceConfig));", "url": "https://github.com/grpc/grpc-java/pull/6640#discussion_r370875404", "createdAt": "2020-01-24T22:46:31Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/test/java/io/grpc/xds/XdsNameResolverTest.java", "diffHunk": "@@ -260,7 +266,7 @@ public void resolve_foundResource() {\n     assertThat(result.getAddresses()).isEmpty();\n     Map<String, ?> serviceConfig =\n         result.getAttributes().get(GrpcAttributes.NAME_RESOLVER_SERVICE_CONFIG);\n-    verify(serviceConfigParser).parseServiceConfig(eq(serviceConfig));\n+    assertThat(result.getServiceConfig().getConfig()).isEqualTo(serviceConfig);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08681b5aba8c45c1aab529dbbe5b50672a667a6a"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4675, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}