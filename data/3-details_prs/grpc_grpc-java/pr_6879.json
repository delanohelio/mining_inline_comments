{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2NjM1ODkz", "number": 6879, "title": "xds: migrating XdsNameResolver to \"xds\" scheme", "bodyText": "Change \"xds-experimenal\" scheme to \"xds\" and add a deprecated provider with \"xds-experimenal\" scheme for keeping interop tests working.", "createdAt": "2020-03-31T22:11:23Z", "url": "https://github.com/grpc/grpc-java/pull/6879", "merged": true, "mergeCommit": {"oid": "5c31dc6d71cac7d5fa8b5897ba5e1260ef03e6c4"}, "closed": true, "closedAt": "2020-04-07T18:52:41Z", "author": {"login": "dapengzhang0"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTKk_jAH2gAyMzk2NjM1ODkzOmYxMDdlZDg5NGU4NWUyZGNhNzMzMDdlMzg5NDc4MmFkNjM0MWY3MDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVIzYJgFqTM4ODcyMjA2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f107ed894e85e2dca73307e3894782ad6341f705", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/f107ed894e85e2dca73307e3894782ad6341f705", "committedDate": "2020-03-31T22:10:06Z", "message": "xds: migrating XdsNameResolver to \"xds\" scheme"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c4020daa705c4025cc33aeb2a1a5192ee955364", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/7c4020daa705c4025cc33aeb2a1a5192ee955364", "committedDate": "2020-03-31T22:50:48Z", "message": "complete copy of XdsNameResolverProvider"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NjIzMzk4", "url": "https://github.com/grpc/grpc-java/pull/6879#pullrequestreview-387623398", "createdAt": "2020-04-03T22:53:48Z", "commit": {"oid": "7c4020daa705c4025cc33aeb2a1a5192ee955364"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMjo1Mzo0OFrOGAr-wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMjo1Mzo0OFrOGAr-wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM3Mzc2MA==", "bodyText": "nit: final.", "url": "https://github.com/grpc/grpc-java/pull/6879#discussion_r403373760", "createdAt": "2020-04-03T22:53:48Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsExperimentalNameResolverProvider.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*\n+ * Copyright 2020 The gRPC Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.grpc.xds;\n+\n+import com.google.common.base.Preconditions;\n+import io.grpc.Internal;\n+import io.grpc.NameResolver;\n+import io.grpc.NameResolver.Args;\n+import io.grpc.NameResolverProvider;\n+import io.grpc.internal.ExponentialBackoffPolicy;\n+import io.grpc.internal.GrpcUtil;\n+import io.grpc.xds.XdsClient.XdsChannelFactory;\n+import java.net.URI;\n+\n+/** A deprecated provider for {@link XdsNameResolver}. */\n+// TODO(zdapeng): remove this class once it's not needed for interop testing.\n+@Deprecated\n+@Internal\n+public class XdsExperimentalNameResolverProvider extends NameResolverProvider {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c4020daa705c4025cc33aeb2a1a5192ee955364"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e28674cedac1de4844cb62d806ea6e1100d101f", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/2e28674cedac1de4844cb62d806ea6e1100d101f", "committedDate": "2020-04-07T00:06:03Z", "message": "final"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NzA1MTcy", "url": "https://github.com/grpc/grpc-java/pull/6879#pullrequestreview-388705172", "createdAt": "2020-04-07T00:19:44Z", "commit": {"oid": "2e28674cedac1de4844cb62d806ea6e1100d101f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwMDoxOTo0NFrOGBukEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwMDoxOTo0NFrOGBukEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ2NDY1OA==", "bodyText": "No tests will verify that xds-experimental still works?", "url": "https://github.com/grpc/grpc-java/pull/6879#discussion_r404464658", "createdAt": "2020-04-07T00:19:44Z", "author": {"login": "ericgribkoff"}, "path": "xds/src/test/java/io/grpc/xds/XdsNameResolverProviderTest.java", "diffHunk": "@@ -91,22 +91,22 @@ public void newNameResolver() {\n   public void validName_withAuthority() {\n     XdsNameResolver resolver =\n         provider.newNameResolver(\n-            URI.create(\"xds-experimental://trafficdirector.google.com/foo.googleapis.com\"), args);\n+            URI.create(\"xds://trafficdirector.google.com/foo.googleapis.com\"), args);\n     assertThat(resolver).isNotNull();\n     assertThat(resolver.getServiceAuthority()).isEqualTo(\"foo.googleapis.com\");\n   }\n \n   @Test\n   public void validName_noAuthority() {\n     XdsNameResolver resolver =\n-        provider.newNameResolver(URI.create(\"xds-experimental:///foo.googleapis.com\"), args);\n+        provider.newNameResolver(URI.create(\"xds:///foo.googleapis.com\"), args);\n     assertThat(resolver).isNotNull();\n     assertThat(resolver.getServiceAuthority()).isEqualTo(\"foo.googleapis.com\");\n   }\n \n   @Test\n   public void invalidName_hostnameContainsUnderscore() {\n-    URI uri = URI.create(\"xds-experimental:///foo_bar.googleapis.com\");\n+    URI uri = URI.create(\"xds:///foo_bar.googleapis.com\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e28674cedac1de4844cb62d806ea6e1100d101f"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1669b508230fe5973ea92de5fb021c3446ef485a", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/1669b508230fe5973ea92de5fb021c3446ef485a", "committedDate": "2020-04-07T00:40:22Z", "message": "copy unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98a182351d0a85b886b2bc9d9122d8ef0ee84e7d", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/98a182351d0a85b886b2bc9d9122d8ef0ee84e7d", "committedDate": "2020-04-07T01:01:55Z", "message": "update xds.sh"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NzIxOTIz", "url": "https://github.com/grpc/grpc-java/pull/6879#pullrequestreview-388721923", "createdAt": "2020-04-07T01:13:23Z", "commit": {"oid": "98a182351d0a85b886b2bc9d9122d8ef0ee84e7d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NzIyMDY0", "url": "https://github.com/grpc/grpc-java/pull/6879#pullrequestreview-388722064", "createdAt": "2020-04-07T01:13:51Z", "commit": {"oid": "98a182351d0a85b886b2bc9d9122d8ef0ee84e7d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4493, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}