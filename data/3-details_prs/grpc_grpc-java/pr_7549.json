{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4NTY4MzUw", "number": 7549, "title": "interop-testing: support dynamic configuration and accumulated stats for xDS test client", "bodyText": "", "createdAt": "2020-10-22T21:27:02Z", "url": "https://github.com/grpc/grpc-java/pull/7549", "merged": true, "mergeCommit": {"oid": "8e04df99f359a69c33ef5c83c7f9e9b418916f66"}, "closed": true, "closedAt": "2020-11-03T18:33:41Z", "author": {"login": "voidzcy"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVIGApgH2gAyNTA4NTY4MzUwOjJkMjMwN2VhOGZhZTA1MzFiMDVkODMwZTFiNmM0OTYwMWFkZDRhOGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY0s6KAFqTUyMjI2MDc2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2d2307ea8fae0531b05d830e1b6c49601add4a8d", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/2d2307ea8fae0531b05d830e1b6c49601add4a8d", "committedDate": "2020-10-22T20:35:27Z", "message": "Support configuring test client rpc type and metadata dynamically."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34a3ed50ff5a5ee97c883d162efd8c4152340b12", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/34a3ed50ff5a5ee97c883d162efd8c4152340b12", "committedDate": "2020-10-22T21:25:54Z", "message": "Support accumulated rpc stats."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1MTYyNTMz", "url": "https://github.com/grpc/grpc-java/pull/7549#pullrequestreview-515162533", "createdAt": "2020-10-22T22:25:41Z", "commit": {"oid": "34a3ed50ff5a5ee97c883d162efd8c4152340b12"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMjoyNTo0MVrOHm2AMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMjoyNTo0MVrOHm2AMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ5MjcyMg==", "bodyText": "I don't understand this. How to use XdsUpdateClientConfigureService to change the value, when runQps() starts immediately?", "url": "https://github.com/grpc/grpc-java/pull/7549#discussion_r510492722", "createdAt": "2020-10-22T22:25:41Z", "author": {"login": "dapengzhang0"}, "path": "interop-testing/src/main/java/io/grpc/testing/integration/XdsTestClient.java", "diffHunk": "@@ -167,8 +169,10 @@ private void parseArgs(String[] args) {\n               + c.qps\n               + \"\\n  --rpc=STR              Types of RPCs to make, ',' separated string. RPCs can \"\n               + \"be EmptyCall or UnaryCall. Default: UnaryCall\"\n+              + \"\\n[deprecated] Use XdsUpdateClientConfigureService\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34a3ed50ff5a5ee97c883d162efd8c4152340b12"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7825e2343079c8726e5ea685903726a6a715db73", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/7825e2343079c8726e5ea685903726a6a715db73", "committedDate": "2020-10-23T01:56:22Z", "message": "Make each PeriodicRpc task run send one RPC  for each type."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2MTYzNDk2", "url": "https://github.com/grpc/grpc-java/pull/7549#pullrequestreview-516163496", "createdAt": "2020-10-24T06:19:29Z", "commit": {"oid": "7825e2343079c8726e5ea685903726a6a715db73"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNFQwNjoxOToyOVrOHno6mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNFQwNjoxOToyOVrOHno6mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTMyNjg3Mw==", "bodyText": "Did I miss some synchronization barrier here? It seems like multiple calls to handleRpcCompleted could be executing simultaneously and count might no longer be correct by the time this #put() is invoked.", "url": "https://github.com/grpc/grpc-java/pull/7549#discussion_r511326873", "createdAt": "2020-10-24T06:19:29Z", "author": {"login": "ericgribkoff"}, "path": "interop-testing/src/main/java/io/grpc/testing/integration/XdsTestClient.java", "diffHunk": "@@ -364,31 +375,43 @@ public void onNext(SimpleResponse response) {\n                   }\n                 }\n               });\n+          rpcsStarted.getAndIncrement();\n         }\n       }\n-    }\n \n-    long nanosPerQuery = TimeUnit.SECONDS.toNanos(1) / qps;\n-\n-    for (RpcType rpcType : rpcTypes) {\n-      ListenableScheduledFuture<?> future =\n-          exec.scheduleAtFixedRate(\n-              new PeriodicRpc(rpcType), 0, nanosPerQuery, TimeUnit.NANOSECONDS);\n+      private void handleRpcCompleted(long requestId, RpcType rpcType, String hostname,\n+          Set<XdsStatsWatcher> watchers) {\n+        int count = 0;\n+        if (rpcsSucceededByPeer.containsKey(hostname)) {\n+          count = rpcsSucceededByPeer.get(hostname);\n+        }\n+        rpcsSucceededByPeer.put(hostname, count + 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7825e2343079c8726e5ea685903726a6a715db73"}, "originalPosition": 199}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4961e436120dc6fe96c2bcdeccb4be0e6660f4bf", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/4961e436120dc6fe96c2bcdeccb4be0e6660f4bf", "committedDate": "2020-10-27T23:10:29Z", "message": "Merge branch 'master' of github.com:grpc/grpc-java into impl/xds_test_client_for_circuit_breaking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa5eb2208d815aeab1b4ffaf55ad79e54f42dfb6", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/aa5eb2208d815aeab1b4ffaf55ad79e54f42dfb6", "committedDate": "2020-10-28T19:22:51Z", "message": "Update counting for total number of RPCs succeeded."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5ac871b7efed84eac73fe20ea91f4a29b89f4a76", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/5ac871b7efed84eac73fe20ea91f4a29b89f4a76", "committedDate": "2020-10-27T23:16:36Z", "message": "Update counting for total number of RPCs succeeded."}, "afterCommit": {"oid": "aa5eb2208d815aeab1b4ffaf55ad79e54f42dfb6", "author": {"user": {"login": "voidzcy", "name": "Chengyuan Zhang"}}, "url": "https://github.com/grpc/grpc-java/commit/aa5eb2208d815aeab1b4ffaf55ad79e54f42dfb6", "committedDate": "2020-10-28T19:22:51Z", "message": "Update counting for total number of RPCs succeeded."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMjYwNzYx", "url": "https://github.com/grpc/grpc-java/pull/7549#pullrequestreview-522260761", "createdAt": "2020-11-03T08:15:33Z", "commit": {"oid": "aa5eb2208d815aeab1b4ffaf55ad79e54f42dfb6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3938, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}