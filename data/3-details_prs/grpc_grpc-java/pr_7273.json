{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5NzkxODU1", "number": 7273, "title": "xds: support v3 for XdsClient", "bodyText": "Duplicated XdsClientImptTest for V3. XdsClientImptTestV2 and all other tests are still using V2. Even for XdsClientImptTest, although the protocol is V3, the test xds server still sends V2 resources in its V3 response.", "createdAt": "2020-07-31T05:17:56Z", "url": "https://github.com/grpc/grpc-java/pull/7273", "merged": true, "mergeCommit": {"oid": "5bf68ff28c4dd67c1f44c5d156c73cb2c102c903"}, "closed": true, "closedAt": "2020-07-31T21:14:11Z", "author": {"login": "dapengzhang0"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6NLdFAH2gAyNDU5NzkxODU1OmE2MzgzYWJlZWRiNjNiNDNkYzdlZmIxMmJjMjMyNzE2ZGY2YzE1YzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6ZBrcgFqTQ1OTM5NjM3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a6383abeedb63b43dc7efb12bc232716df6c15c6", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/a6383abeedb63b43dc7efb12bc232716df6c15c6", "committedDate": "2020-07-31T05:14:58Z", "message": "xds: support v3 for XdsClient"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a641f22a34c5b623343da12f4aad858205e8e50e", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/a641f22a34c5b623343da12f4aad858205e8e50e", "committedDate": "2020-07-31T05:15:04Z", "message": "duplicate XdsClientImplTest for v2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b68fefcc8b1233ac1a3618e370fe2a7e4be15ecc", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/b68fefcc8b1233ac1a3618e370fe2a7e4be15ecc", "committedDate": "2020-07-31T05:15:04Z", "message": "Use v3 protocol for XdsClientImplTestV3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f8699e84a0f552e49bf4df295f926a6ff80e16e", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/2f8699e84a0f552e49bf4df295f926a6ff80e16e", "committedDate": "2020-07-31T16:54:17Z", "message": "useProtocolV3 can be final"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "52e67313d8106e8bc1f1f5c60d99ca6a5d749b8c", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/52e67313d8106e8bc1f1f5c60d99ca6a5d749b8c", "committedDate": "2020-07-31T16:51:40Z", "message": "useProtocolV3 can be final"}, "afterCommit": {"oid": "2f8699e84a0f552e49bf4df295f926a6ff80e16e", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/2f8699e84a0f552e49bf4df295f926a6ff80e16e", "committedDate": "2020-07-31T16:54:17Z", "message": "useProtocolV3 can be final"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MzU0MDgw", "url": "https://github.com/grpc/grpc-java/pull/7273#pullrequestreview-459354080", "createdAt": "2020-07-31T17:50:17Z", "commit": {"oid": "2f8699e84a0f552e49bf4df295f926a6ff80e16e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNzo1MDoxOFrOG6Q7Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNzo1MDoxOFrOG6Q7Rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0NzkxMA==", "bodyText": "nit: you could just pass a channel for each AdsStream's constructor and create its own stub inside.", "url": "https://github.com/grpc/grpc-java/pull/7273#discussion_r463747910", "createdAt": "2020-07-31T17:50:18Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsClientImpl.java", "diffHunk": "@@ -516,12 +522,18 @@ public String toString() {\n    */\n   private void startRpcStream() {\n     checkState(adsStream == null, \"Previous adsStream has not been cleared yet\");\n-    io.envoyproxy.envoy.service.discovery.v2.AggregatedDiscoveryServiceGrpc\n-            .AggregatedDiscoveryServiceStub\n-        stub =\n-            io.envoyproxy.envoy.service.discovery.v2.AggregatedDiscoveryServiceGrpc.newStub(\n-                channel);\n-    adsStream = new AdsStreamV2(stub);\n+    if (useProtocolV3) {\n+      AggregatedDiscoveryServiceGrpc.AggregatedDiscoveryServiceStub stub =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f8699e84a0f552e49bf4df295f926a6ff80e16e"}, "originalPosition": 68}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6065ef76cd2030b039e00efcd9084a91c8d47758", "author": {"user": {"login": "dapengzhang0", "name": "ZHANG Dapeng"}}, "url": "https://github.com/grpc/grpc-java/commit/6065ef76cd2030b039e00efcd9084a91c8d47758", "committedDate": "2020-07-31T18:39:17Z", "message": "cleanup AdsStream constructor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5Mzk2Mzc5", "url": "https://github.com/grpc/grpc-java/pull/7273#pullrequestreview-459396379", "createdAt": "2020-07-31T19:03:09Z", "commit": {"oid": "2f8699e84a0f552e49bf4df295f926a6ff80e16e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4132, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}