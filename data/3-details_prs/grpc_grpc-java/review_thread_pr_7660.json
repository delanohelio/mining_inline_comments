{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2MzE0MDc0", "number": 7660, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwMTowNDo0MVrOE_Z4mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTozMDoyMFrOE_0UbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0OTE5ODM1OnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwMTowNDo0MVrOH9GKdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMToyNjozOVrOH9uzbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgyNjE2NQ==", "bodyText": "I don't think using the last priority's error message is better than just saying cannot establish connection to any priority.", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r533826165", "createdAt": "2020-12-02T01:04:41Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "diffHunk": "@@ -153,7 +153,9 @@ private void tryNextPriority(boolean reportConnecting) {\n     }\n     // TODO(zdapeng): Include error details of each priority.\n     logger.log(XdsLogLevel.DEBUG, \"All priority failed\");\n-    updateOverallState(TRANSIENT_FAILURE, new ErrorPicker(Status.UNAVAILABLE));\n+    String lastPriority = priorityNames.get(priorityNames.size() - 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6ac91cd336033f22272e118829eda91401a8281"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ5MjAxMg==", "bodyText": "I am fine with using the last priority's error state as the overall error state for the LB. I am encountering the similar situation in cluster_resolver LB.", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r534492012", "createdAt": "2020-12-02T21:26:39Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "diffHunk": "@@ -153,7 +153,9 @@ private void tryNextPriority(boolean reportConnecting) {\n     }\n     // TODO(zdapeng): Include error details of each priority.\n     logger.log(XdsLogLevel.DEBUG, \"All priority failed\");\n-    updateOverallState(TRANSIENT_FAILURE, new ErrorPicker(Status.UNAVAILABLE));\n+    String lastPriority = priorityNames.get(priorityNames.size() - 1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgyNjE2NQ=="}, "originalCommit": {"oid": "b6ac91cd336033f22272e118829eda91401a8281"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MzUyOTQwOnYy", "diffSide": "RIGHT", "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTozMDoyMFrOH9u7NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QyMDozMDo0N1rOH-w2bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ5NDAwNQ==", "bodyText": "We could delete this TODO. It's a bit undefined for how to aggregate multiple error statuses.", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r534494005", "createdAt": "2020-12-02T21:30:20Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "diffHunk": "@@ -153,7 +153,9 @@ private void tryNextPriority(boolean reportConnecting) {\n     }\n     // TODO(zdapeng): Include error details of each priority.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6ac91cd336033f22272e118829eda91401a8281"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUzNDA0MA==", "bodyText": "I was considering a status with a cause that suppresses a list of status exceptions for all priorities, or something similar, as further improvement in the future.", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r535534040", "createdAt": "2020-12-03T19:42:43Z", "author": {"login": "dapengzhang0"}, "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "diffHunk": "@@ -153,7 +153,9 @@ private void tryNextPriority(boolean reportConnecting) {\n     }\n     // TODO(zdapeng): Include error details of each priority.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ5NDAwNQ=="}, "originalCommit": {"oid": "b6ac91cd336033f22272e118829eda91401a8281"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTU3NDEyNg==", "bodyText": "That sounds a horrible idea though. Using the last priority's connection status is good enough as per current design.", "url": "https://github.com/grpc/grpc-java/pull/7660#discussion_r535574126", "createdAt": "2020-12-03T20:30:47Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/PriorityLoadBalancer.java", "diffHunk": "@@ -153,7 +153,9 @@ private void tryNextPriority(boolean reportConnecting) {\n     }\n     // TODO(zdapeng): Include error details of each priority.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ5NDAwNQ=="}, "originalCommit": {"oid": "b6ac91cd336033f22272e118829eda91401a8281"}, "originalPosition": 2}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2317, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}