{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5NzU2NjM0", "number": 7047, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQyMTo0MzoxOFrOD9j_ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQyMTo0Mzo1MFrOD9kACA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1ODc5NDU0OnYy", "diffSide": "LEFT", "path": "xds/src/main/java/io/grpc/xds/XdsClientImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQyMTo0MzoxOFrOGXIepg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQyMTo0MzoxOFrOGXIepg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwOTM1MA==", "bodyText": "Justification: The converted object EnvoyProtoData.Route is guaranteed to have one of cluster or weighted_cluster set. So this logic is redundant here.", "url": "https://github.com/grpc/grpc-java/pull/7047#discussion_r426909350", "createdAt": "2020-05-18T21:43:18Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsClientImpl.java", "diffHunk": "@@ -864,30 +864,10 @@ private void handleRdsResponse(DiscoveryResponse rdsResponse) {\n           \"Virtual host [\" + virtualHost.getName()\n               + \"] contains non-default route as the last route\");\n     }\n-    // We only validate the default route unless path matching is enabled.\n     if (!enableExperimentalRouting) {\n       EnvoyProtoData.Route defaultRoute = Iterables.getLast(routes);\n-      if (defaultRoute.getRouteAction().getCluster() == null) {\n-        throw new InvalidProtoDataException(\n-            \"Virtual host [\" + virtualHost.getName()\n-                + \"] default route contains no cluster name\");\n-      }\n       return Collections.singletonList(defaultRoute);\n     }\n-\n-    // We do more validation if path matching is enabled, but whether every single route is\n-    // required to be valid for grpc is TBD.\n-    // For now we consider the whole list invalid if anything invalid for grpc is found.\n-    // TODO(zdapeng): Fix it if the decision is different from current implementation.\n-    // TODO(zdapeng): Add test for validation.\n-    for (EnvoyProtoData.Route route : routes) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4239350f374286d117743c7103f87a17c170a4c"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1ODc5NTYwOnYy", "diffSide": "LEFT", "path": "xds/src/main/java/io/grpc/xds/XdsClientImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQyMTo0Mzo1MFrOGXIfWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQyMTo0Mzo1MFrOGXIfWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwOTUyOQ==", "bodyText": "No longer require the default route to have cluster as the cluster_specifier.", "url": "https://github.com/grpc/grpc-java/pull/7047#discussion_r426909529", "createdAt": "2020-05-18T21:43:50Z", "author": {"login": "voidzcy"}, "path": "xds/src/main/java/io/grpc/xds/XdsClientImpl.java", "diffHunk": "@@ -864,30 +864,10 @@ private void handleRdsResponse(DiscoveryResponse rdsResponse) {\n           \"Virtual host [\" + virtualHost.getName()\n               + \"] contains non-default route as the last route\");\n     }\n-    // We only validate the default route unless path matching is enabled.\n     if (!enableExperimentalRouting) {\n       EnvoyProtoData.Route defaultRoute = Iterables.getLast(routes);\n-      if (defaultRoute.getRouteAction().getCluster() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4239350f374286d117743c7103f87a17c170a4c"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2697, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}