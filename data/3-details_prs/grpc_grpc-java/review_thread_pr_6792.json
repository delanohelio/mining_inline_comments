{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyNTc0Mzc4", "number": 6792, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQyMjowMzo0MFrODkcLiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzo0MjowM1rODlPg-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NTM3MDMyOnYy", "diffSide": "RIGHT", "path": "alts/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQyMjowMzo0MFrOFww-Wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQyMzozNDowNFrOFwzPUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY3ODM2Mg==", "bodyText": "This is doubly suspicious. It is strange to need to copy the dependencies, but wouldn't this also include compile-only dependencies?", "url": "https://github.com/grpc/grpc-java/pull/6792#discussion_r386678362", "createdAt": "2020-03-02T22:03:40Z", "author": {"login": "ejona86"}, "path": "alts/build.gradle", "diffHunk": "@@ -29,7 +28,14 @@ dependencies {\n         exclude group: 'io.grpc', module: 'grpc-context'\n     }\n     compileOnly libraries.javax_annotation\n-    testCompile project(':grpc-testing'),\n+\n+    // Use grpc-netty-shaded for transitive dependency.\n+    compileOnly project(':grpc-netty')\n+    shadow project(path: ':grpc-netty-shaded', configuration: 'shadow')\n+    shadow configurations.compile.getDependencies()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjcxNTQ3Mw==", "bodyText": "My understanding is:\n\nDependencyHandler.project(path : 'grpc-alts', configuration: 'shadow') returns a Dependency that includes the output of :grpc-alts:shadowJar plus all dependencies added (manually) into shadow configuration.\n\nHowever,\n\n\nThe output of :grpc-alts:shadowJar does not depend on anything in the shadow configuration.\n\n\nThe output pom.xml of maven publication does not include anything in the shadow configuration unless you modify pom.withXml {} manually.", "url": "https://github.com/grpc/grpc-java/pull/6792#discussion_r386715473", "createdAt": "2020-03-02T23:34:04Z", "author": {"login": "dapengzhang0"}, "path": "alts/build.gradle", "diffHunk": "@@ -29,7 +28,14 @@ dependencies {\n         exclude group: 'io.grpc', module: 'grpc-context'\n     }\n     compileOnly libraries.javax_annotation\n-    testCompile project(':grpc-testing'),\n+\n+    // Use grpc-netty-shaded for transitive dependency.\n+    compileOnly project(':grpc-netty')\n+    shadow project(path: ':grpc-netty-shaded', configuration: 'shadow')\n+    shadow configurations.compile.getDependencies()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY3ODM2Mg=="}, "originalCommit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5OTg5MDkzOnYy", "diffSide": "RIGHT", "path": "xds/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwMDo1ODoxMFrOFxcE4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxODoyOTozMlrOFx4qZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzM4NDU0Nw==", "bodyText": "This brings in library.pgv. It needs to be excluded. (maybe with minus() like used in grpc-all?)\nI sort of think excluding may be better than using compileOnly for grpc-netty, since then both 'compile' configuration and 'shadow' configuration are functional outside of this project. It also seems to be a bit less likely to have surprises. But I can accept what's been done here.", "url": "https://github.com/grpc/grpc-java/pull/6792#discussion_r387384547", "createdAt": "2020-03-04T00:58:10Z", "author": {"login": "ejona86"}, "path": "xds/build.gradle", "diffHunk": "@@ -47,7 +47,11 @@ dependencies {\n             libraries.guava_testlib,\n             libraries.netty_epoll\n \n+    // Use grpc-netty-shaded for transitive dependency.\n+    compileOnly project(':grpc-netty')\n     shadow project(path: ':grpc-netty-shaded', configuration: 'shadow')\n+    shadow configurations.compile.getDependencies()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg1MjkwMA==", "bodyText": "Done.", "url": "https://github.com/grpc/grpc-java/pull/6792#discussion_r387852900", "createdAt": "2020-03-04T18:29:32Z", "author": {"login": "dapengzhang0"}, "path": "xds/build.gradle", "diffHunk": "@@ -47,7 +47,11 @@ dependencies {\n             libraries.guava_testlib,\n             libraries.netty_epoll\n \n+    // Use grpc-netty-shaded for transitive dependency.\n+    compileOnly project(':grpc-netty')\n     shadow project(path: ':grpc-netty-shaded', configuration: 'shadow')\n+    shadow configurations.compile.getDependencies()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzM4NDU0Nw=="}, "originalCommit": {"oid": "51a81acf970b43bb0a0c6e33f3a6d9088b6a7141"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwMzc4MTA2OnYy", "diffSide": "RIGHT", "path": "xds/build.gradle", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzo0MjowM1rOFyBqJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMzo0MjowM1rOFyBqJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODAwMDI5Mw==", "bodyText": "Technically it would probably be best to do the same minus() thing here, but that can be a follow-up.", "url": "https://github.com/grpc/grpc-java/pull/6792#discussion_r388000293", "createdAt": "2020-03-04T23:42:03Z", "author": {"login": "ejona86"}, "path": "xds/build.gradle", "diffHunk": "@@ -39,11 +38,18 @@ dependencies {\n \n     testCompile project(':grpc-core').sourceSets.test.output\n \n-    compileOnly libraries.javax_annotation\n+    compileOnly libraries.javax_annotation,\n+            // At runtime use the epoll included in grpc-netty-shaded", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85551411475050a4efd87f2ef1761376aaf5fd09"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2880, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}