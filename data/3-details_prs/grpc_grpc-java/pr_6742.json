{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4NTI0MTU0", "number": 6742, "title": "okhttp: fix incorrect connection-level flow control handling at beginning of connection", "bodyText": "Addressing #6685\nSpecifically, this addresses bugs that occur when the OkHttpChannelBuilder.flowControlWindow(int) setting is increased from its default value.\nTwo changes:\n\nOn starting a connection, ensure the value of OkHttpChannelBuilder.flowControlWindow(int) is sent via Settings.INITIAL_WINDOW_SIZE. Also send a WINDOW_UPDATE after Settings to update the connection-level window.\nAlways initialize the OutboundFlowController with an initialWindowSize of 65335 bytes per the http2 spec instead of using the inbound window size.", "createdAt": "2020-02-22T00:17:47Z", "url": "https://github.com/grpc/grpc-java/pull/6742", "merged": true, "mergeCommit": {"oid": "bf2a66c8a2d52be41afd7090c151984a3ce64e0d"}, "closed": true, "closedAt": "2020-02-27T20:34:24Z", "author": {"login": "chrisschek"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHoWdOgH2gAyMzc4NTI0MTU0OmVhNmE2ZDAyZWUwMmY1MmVmYWQ1MDI2Nzk4Njg2N2ExYmE2N2MzYzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIgznagFqTM2NTk1MTk2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ea6a6d02ee02f52efad50267986867a1ba67c3c5", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/ea6a6d02ee02f52efad50267986867a1ba67c3c5", "committedDate": "2020-02-25T02:04:17Z", "message": "okhttp: fix incorrect initial size of outbound flow control window"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22eb66e47ec54a0dc134b64ffc66fff66ebc171d", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/22eb66e47ec54a0dc134b64ffc66fff66ebc171d", "committedDate": "2020-02-25T02:04:22Z", "message": "okhttp: fix incorrect initial size of outbound flow control window"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aac0867923badf9bdd92d68e339f13d11441baa9", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/aac0867923badf9bdd92d68e339f13d11441baa9", "committedDate": "2020-02-25T02:04:30Z", "message": "okhttp: simplify OutboundFlowController constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14ada64ab0cfb69dca0117a5a9122e2035766c88", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/14ada64ab0cfb69dca0117a5a9122e2035766c88", "committedDate": "2020-02-25T02:04:42Z", "message": "okhttp: unit tests for outbound flow control window changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8da35397b0ece339398edc2dec5043c3b09216eb", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/8da35397b0ece339398edc2dec5043c3b09216eb", "committedDate": "2020-02-25T02:04:50Z", "message": "okhttp: unit testing sending initialWindowSize in settings"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2fd5b206ff9d981ff63265678a60735781b0c0d8", "author": {"user": null}, "url": "https://github.com/grpc/grpc-java/commit/2fd5b206ff9d981ff63265678a60735781b0c0d8", "committedDate": "2020-02-25T01:11:11Z", "message": "okhttp: unit testing sending initialWindowSize in settings"}, "afterCommit": {"oid": "8da35397b0ece339398edc2dec5043c3b09216eb", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/8da35397b0ece339398edc2dec5043c3b09216eb", "committedDate": "2020-02-25T02:04:50Z", "message": "okhttp: unit testing sending initialWindowSize in settings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzODE0NjM3", "url": "https://github.com/grpc/grpc-java/pull/6742#pullrequestreview-363814637", "createdAt": "2020-02-25T01:22:17Z", "commit": {"oid": "2fd5b206ff9d981ff63265678a60735781b0c0d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwMToyMjoxOFrOFt1rlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQwMToyMjoxOFrOFt1rlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzYwOTc0OA==", "bodyText": "I think these three tests should still be around. They are trying to test that the outbound flow controller observes the flow control given to it. Since passing windowSize to startTransport() no longer works, these need to get something like frameHandler().settings(false, new Settings()); (but with the INITIAL_WINDOW_SIZE set to windowSize) to change the window size available.", "url": "https://github.com/grpc/grpc-java/pull/6742#discussion_r383609748", "createdAt": "2020-02-25T01:22:18Z", "author": {"login": "ejona86"}, "path": "okhttp/src/test/java/io/grpc/okhttp/OkHttpClientTransportTest.java", "diffHunk": "@@ -838,37 +868,34 @@ public void windowUpdateWithInboundFlowControl() throws Exception {\n \n   @Test\n   public void outboundFlowControl() throws Exception {\n-    outboundFlowControl(INITIAL_WINDOW_SIZE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fd5b206ff9d981ff63265678a60735781b0c0d8"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "671dd3319335668adc439a99a590a21c29aa7ba3", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/671dd3319335668adc439a99a590a21c29aa7ba3", "committedDate": "2020-02-26T23:53:14Z", "message": "okhttp: restore test cases for outboundFlowControl big/small window size"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "66b5856c55e5265472e7cc2b051b52ce7a322507", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/66b5856c55e5265472e7cc2b051b52ce7a322507", "committedDate": "2020-02-26T23:09:33Z", "message": "okhttp: restore test cases for outboundFlowControl big/small window size"}, "afterCommit": {"oid": "671dd3319335668adc439a99a590a21c29aa7ba3", "author": {"user": {"login": "chrisschek", "name": null}}, "url": "https://github.com/grpc/grpc-java/commit/671dd3319335668adc439a99a590a21c29aa7ba3", "committedDate": "2020-02-26T23:53:14Z", "message": "okhttp: restore test cases for outboundFlowControl big/small window size"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MzM2MDI4", "url": "https://github.com/grpc/grpc-java/pull/6742#pullrequestreview-365336028", "createdAt": "2020-02-27T00:14:30Z", "commit": {"oid": "671dd3319335668adc439a99a590a21c29aa7ba3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTUxOTY0", "url": "https://github.com/grpc/grpc-java/pull/6742#pullrequestreview-365951964", "createdAt": "2020-02-27T19:50:49Z", "commit": {"oid": "671dd3319335668adc439a99a590a21c29aa7ba3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4597, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}