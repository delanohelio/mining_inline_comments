{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMjU0MzQ0", "number": 628, "title": "DEVX-2217: Convert nested JSON recipe to KT", "bodyText": "Description\nThis PR converts the nested-json-data recipe from the stream processing cookbook\n\nStaging Docs\n\nhttp://kafka-tutorials-staging.s3-website-us-west-2.amazonaws.com/DEVX-2217_covert_nested_json_recipe/ksqldb-working-with-nested-json/ksql.html", "createdAt": "2020-11-13T01:07:42Z", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628", "merged": true, "mergeCommit": {"oid": "2fbbd54eb0d07a01ba3317a493716826518298cc"}, "closed": true, "closedAt": "2020-11-17T23:44:46Z", "author": {"login": "bbejeck"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdb88H_AFqTUyOTYzODgxMQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABddgu29gFqTUzMjg0MTA3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5NjM4ODEx", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#pullrequestreview-529638811", "createdAt": "2020-11-13T01:33:02Z", "commit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwMTozMzowM1rOHyWFrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwMTozMzowM1rOHyWFrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU1Mjc0OQ==", "bodyText": "Not sure if this is overkill or not, but I thought it might be good to be explicit about the JSON structure issue.", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#discussion_r522552749", "createdAt": "2020-11-13T01:33:03Z", "author": {"login": "bbejeck"}, "path": "_includes/tutorials/ksql-nested-json/ksql/markup/dev/problem-description.adoc", "diffHunk": "@@ -0,0 +1,34 @@\n+Let's say you have a topic `financial_txns`, containing stock purchase at your firm. You want to do some basic reporting that includes the the number of shares, customer-id, and the ticker symbol involved in the transaction. All the information is in the record, but it's in JSON format and the information you need is nested.  Here's an example record:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNDM1NDE4", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#pullrequestreview-531435418", "createdAt": "2020-11-16T15:34:12Z", "commit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNTozNDoxM1rOH0ENjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNTo1NDo0OVrOH0FPbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM1NzAwNQ==", "bodyText": "I don't think this is overkill, I like that you are visually calling out what data you need out of the event.", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#discussion_r524357005", "createdAt": "2020-11-16T15:34:13Z", "author": {"login": "awalther28"}, "path": "_includes/tutorials/ksql-nested-json/ksql/markup/dev/problem-description.adoc", "diffHunk": "@@ -0,0 +1,34 @@\n+Let's say you have a topic `financial_txns`, containing stock purchase at your firm. You want to do some basic reporting that includes the the number of shares, customer-id, and the ticker symbol involved in the transaction. All the information is in the record, but it's in JSON format and the information you need is nested.  Here's an example record:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU1Mjc0OQ=="}, "originalCommit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM2MDk2OQ==", "bodyText": "One thing you should note is the number of nested fields is consistent across multiple events. Robin recently wrote a blog about how you need to use MAP to model nested fields with a variable number of fields.\nI'm not sure if you would want to go into detail in this KT of how to use MAP and when.", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#discussion_r524360969", "createdAt": "2020-11-16T15:39:12Z", "author": {"login": "awalther28"}, "path": "_includes/tutorials/ksql-nested-json/ksql/markup/dev/problem-description.adoc", "diffHunk": "@@ -0,0 +1,34 @@\n+Let's say you have a topic `financial_txns`, containing stock purchase at your firm. You want to do some basic reporting that includes the the number of shares, customer-id, and the ticker symbol involved in the transaction. All the information is in the record, but it's in JSON format and the information you need is nested.  Here's an example record:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU1Mjc0OQ=="}, "originalCommit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM2MjEzMA==", "bodyText": "Should this be\n\nWithin the CREATE STREAM statement...\n?", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#discussion_r524362130", "createdAt": "2020-11-16T15:40:39Z", "author": {"login": "awalther28"}, "path": "_includes/tutorials/ksql-nested-json/ksql/markup/dev/create-financial-transaction-stream.adoc", "diffHunk": "@@ -0,0 +1,30 @@\n+The first thing we do is to create a stream `TRANSACTION_STREAM` based off stock purchase transactions topic `financial_txns`. Within the create `STREAM` statement, you'll use a `STRUCT` keyword to define each nested object.  The `STRUCT` keyword provides a mechanism to navigate to the desired fields in your query.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM2NDkzMw==", "bodyText": "Feel free to shoot this down but I think it would be helpful to give a definition to what a struct is.\n\nA struct is a ksqlDB data type that represents strongly typed structured, or nested, data. A struct is an ordered collection of named fields that have a specific type. [pulled directly from ksqlDB docs]\nAs mentioned earlier, structs won't work in all scenarios but this reads like \"structs work for any nested object\".", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#discussion_r524364933", "createdAt": "2020-11-16T15:44:09Z", "author": {"login": "awalther28"}, "path": "_includes/tutorials/ksql-nested-json/ksql/markup/dev/create-financial-transaction-stream.adoc", "diffHunk": "@@ -0,0 +1,30 @@\n+The first thing we do is to create a stream `TRANSACTION_STREAM` based off stock purchase transactions topic `financial_txns`. Within the create `STREAM` statement, you'll use a `STRUCT` keyword to define each nested object.  The `STRUCT` keyword provides a mechanism to navigate to the desired fields in your query.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM2MjEzMA=="}, "originalCommit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM3Mzg2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tdiff --strip-trailing-cr $(STEPS_DIR)/dev/expected-transient-reporting.log $(DEV_OUTPUTS_DIR)/transient-reporting/output-0.log\n          \n          \n            \n            \tdiff --strip-trailing-cr $(STEPS_DIR)/dev/expected-transient-reporting.log $(DEV_OUTPUTS_DIR)/transient-reporting/output-0.log\n          \n          \n            \n            \tdiff --strip-trailing-cr $(STEPS_DIR)/test/expected-results.log $(TEST_OUTPUTS_DIR)/test-results.log\n          \n      \n    \n    \n  \n\nCan we add in the suggestion above? That way we verify that the test statement section is working as expected in our pipeline.", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#discussion_r524373869", "createdAt": "2020-11-16T15:54:49Z", "author": {"login": "awalther28"}, "path": "_includes/tutorials/ksql-nested-json/ksql/code/Makefile", "diffHunk": "@@ -0,0 +1,15 @@\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEST_OUTPUTS_DIR := $(STEPS_DIR)/test/outputs\n+PROD_OUTPUTS_DIR := $(STEPS_DIR)/prod/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+SEQUENCE := \"dev, test, prod, ccloud\"\n+\n+tutorial:\n+\trm -r $(DEV_OUTPUTS_DIR) || true\n+\trm -r $(TEST_OUTPUTS_DIR) || true\n+\tmkdir $(DEV_OUTPUTS_DIR)\n+\tmkdir -p $(TEST_OUTPUTS_DIR)\n+\tharness-runner ../../../../../_data/harnesses/ksql-nested-json/ksql.yml $(TEMP_DIR) $(SEQUENCE)\n+\tdiff --strip-trailing-cr $(STEPS_DIR)/dev/expected-transient-reporting.log $(DEV_OUTPUTS_DIR)/transient-reporting/output-0.log", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "527115182ffdd7f44d9bef5c449d2bcb5bd862a6", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/527115182ffdd7f44d9bef5c449d2bcb5bd862a6", "committedDate": "2020-11-17T18:24:43Z", "message": "initial commit for nested json work"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "075df18c81ac1e79cac2f7731d43384afb0f5358", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/075df18c81ac1e79cac2f7731d43384afb0f5358", "committedDate": "2020-11-17T18:24:43Z", "message": "more changes for nested data conversion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48c1b01099b9e79322b26bf9c5f88004cad33cc6", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/48c1b01099b9e79322b26bf9c5f88004cad33cc6", "committedDate": "2020-11-17T18:24:43Z", "message": "Final changes for nested JSON recipe conversion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "385fb166bce53f1b5355d3e127a0e6e6c906399c", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/385fb166bce53f1b5355d3e127a0e6e6c906399c", "committedDate": "2020-11-17T21:09:40Z", "message": "updates per comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fad1adc1c657705ceede8e5eea63c7a63a9b7a3f", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/fad1adc1c657705ceede8e5eea63c7a63a9b7a3f", "committedDate": "2020-11-13T01:04:21Z", "message": "Final changes for nested JSON recipe conversion"}, "afterCommit": {"oid": "385fb166bce53f1b5355d3e127a0e6e6c906399c", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/385fb166bce53f1b5355d3e127a0e6e6c906399c", "committedDate": "2020-11-17T21:09:40Z", "message": "updates per comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyODQxMDcx", "url": "https://github.com/confluentinc/kafka-tutorials/pull/628#pullrequestreview-532841071", "createdAt": "2020-11-17T21:49:11Z", "commit": {"oid": "385fb166bce53f1b5355d3e127a0e6e6c906399c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 99, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}