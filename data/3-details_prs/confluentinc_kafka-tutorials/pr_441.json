{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2Nzk3MzY5", "number": 441, "title": "MINOR: Add documentation about harness runner", "bodyText": "Covers #403", "createdAt": "2020-06-18T22:41:53Z", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441", "merged": true, "mergeCommit": {"oid": "22956a7316cfe91ae57b5252586c29ca4c08cef3"}, "closed": true, "closedAt": "2020-06-24T22:58:21Z", "author": {"login": "bbejeck"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcr6eJhgH2gAyNDM2Nzk3MzY5OjdkYjYzYjIyZTY3MWY4ZWQ2Nzg3YmM3Njk2Yzc4ZDc0NmQxZDg5MWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuiIV8gH2gAyNDM2Nzk3MzY5OmFlZmVmZjliZjc2M2E2MjJhMjA1Njc3YWZlODZlMDg3ZmExZDk3ZDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7db63b22e671f8ed6787bc7696c78d746d1d891c", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/7db63b22e671f8ed6787bc7696c78d746d1d891c", "committedDate": "2020-06-16T19:32:15Z", "message": "intial commit for documenting harness runner"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/329e16de87d5697391dee8827d1da1fcaf5aeeeb", "committedDate": "2020-06-18T22:40:07Z", "message": "add description of harness file to README"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MjEzMDA2", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#pullrequestreview-434213006", "createdAt": "2020-06-19T16:42:10Z", "commit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNjo0MjoxMFrOGmbHYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxNjo0MjoxMFrOGmbHYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0MzMyOA==", "bodyText": "I noticed this section does not discuss action: docker_ksql_cli_session. This type probably deserves its own description below.", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r442943328", "createdAt": "2020-06-19T16:42:10Z", "author": {"login": "colinhicks"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;\n+\n+To run a tutorial programatically do the following stepes. Note these instructions assume you've already checked out the kafka-tutorials repo).\n+\n+1. cd into `_includes/tutorials/<tutorial name>/<type>/code` directory where type is one of `ksql | kstreams | kafka`.\n+2. run the `make` command.\n+\n+The `Makefile` will delete and re-create the `outputs` directory used contain files with output from various steps used to verify the tutorial steps.\n+\n+Here's an example of the contents of a `Makefile`:\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/fk-joins/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output-events.json $(DEV_OUTPUTS_DIR)/music-interest.json\n+```\n+\n+The last line uses the `diff` command to validate expected output against the actual output of tutorial steps.  The `Makefile` may have more than one valdiation step so it will have separate `diff` commmands for each verification.  For example:\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/dynamic-output-topic/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output.json $(DEV_OUTPUTS_DIR)/actual-output.json\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-special-output.json $(DEV_OUTPUTS_DIR)/actual-special-order-output.json\n+```\n+\n+\n+\n+\n+#### 1. Structure\n+\n+Three top-level sections make up the harness file:\n+\n+* dev - the setup and teaching portion of the tutorial (required)\n+* test - test setup and execution of tests, if any (optional)\n+* prod - steps to build and deploy a docker image of the tutorial code (optional)\n+\n+In some cases, having a test and or prod section doesn't make sense, so those sections can be left out of the harness file.  The Apache Kafka console producer and consumer tutorials are a good example of tutorials that don't need a test or prod section.\n+\n+The `dev`, `test`, and `prod` sections contain a top-level element `steps`.  The `steps` contains any number of well, steps for the user to walk through.  Addtionally the `harness_runner` script follows the same steps for executing the tutorial automatically during builds.  The steps in any section are structured in the same way, so we'll only discuss the make-up of a single section.\n+\n+For reference here is an example section\n+\n+```yml\n+ - title: Get Confluent Platform\n+      content:\n+        - action: make_file\n+          file: docker-compose.yml\n+          render:\n+            file: tutorials/console-consumer-primitive-keys-values/kafka/markup/dev/make-docker-compose.adoc\n+\n+        - action: execute_async\n+          file: tutorial-steps/dev/docker-compose-up.sh\n+          render:\n+            file: tutorials/console-consumer-primitive-keys-values/kafka/markup/dev/start-compose.adoc\n+\n+        - action: execute\n+          file: tutorial-steps/dev/wait-for-containers.sh\n+          render:\n+            skip: true\n+\n+        - name: wait for ksqldb-server and connectors\n+          action: sleep\n+          ms: 30000\n+          render:\n+            skip: true\n+```\n+\n+\n+* Title - each section starts with a `title` element and as the label suggests, the text provided here is the text used the label the step for the tutorial user and the output to the console by the harness runner.  The `title` section contains one element - `content`\n+\n+* content - the `content` section (a YAML `dictionary`) contains an arbitrary sized list of YAML dictionaries named `action`. An `action` key creates an anonymous step i.e. not specified in the output of the test runner.  For output in the test runner, you can provide a `-name` key followed by some text for console output.\n+* action - `action` keys drive the behavior of the harness. An action key can be one of these values", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 94}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MzY1ODg5", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#pullrequestreview-434365889", "createdAt": "2020-06-19T22:23:38Z", "commit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQyMjoyMzozOFrOGmig7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQyMjozMjozOFrOGmioaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NDU1OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ## Working with the harness file\n          \n          \n            \n            ## Testing Locally", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443064559", "createdAt": "2020-06-19T22:23:38Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NDc4Mw==", "bodyText": "@bbejeck can we had a Table of Contents at the top of the README?", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443064783", "createdAt": "2020-06-19T22:24:40Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NDk5Mw==", "bodyText": "Why assume?  Can we add a step:\ngit clone https://github.com/confluentinc/kafka-tutorials.git\ncd kafka-tutorials", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443064993", "createdAt": "2020-06-19T22:25:30Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;\n+\n+To run a tutorial programatically do the following stepes. Note these instructions assume you've already checked out the kafka-tutorials repo).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NTE2Ng==", "bodyText": "FYC: hyperlink to an existing Makefile", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443065166", "createdAt": "2020-06-19T22:26:18Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;\n+\n+To run a tutorial programatically do the following stepes. Note these instructions assume you've already checked out the kafka-tutorials repo).\n+\n+1. cd into `_includes/tutorials/<tutorial name>/<type>/code` directory where type is one of `ksql | kstreams | kafka`.\n+2. run the `make` command.\n+\n+The `Makefile` will delete and re-create the `outputs` directory used contain files with output from various steps used to verify the tutorial steps.\n+\n+Here's an example of the contents of a `Makefile`:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NTcxOA==", "bodyText": "Add example.\n\ncd _includes/tutorials/aggregating-count/kstreams/code", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443065718", "createdAt": "2020-06-19T22:28:58Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;\n+\n+To run a tutorial programatically do the following stepes. Note these instructions assume you've already checked out the kafka-tutorials repo).\n+\n+1. cd into `_includes/tutorials/<tutorial name>/<type>/code` directory where type is one of `ksql | kstreams | kafka`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NjE2Mg==", "bodyText": "I tried to run this myself and got:\n\u201cThe \u2018harness-runner==0.0.1\u2019 distribution was not found and is required by the application\u201d\n\n\nHow can I resolve this?\nConsider whether this PR should add the explanation to resolve this error message", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443066162", "createdAt": "2020-06-19T22:31:05Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;\n+\n+To run a tutorial programatically do the following stepes. Note these instructions assume you've already checked out the kafka-tutorials repo).\n+\n+1. cd into `_includes/tutorials/<tutorial name>/<type>/code` directory where type is one of `ksql | kstreams | kafka`.\n+2. run the `make` command.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NjI4Mw==", "bodyText": "Hyperlink to example file?", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443066283", "createdAt": "2020-06-19T22:31:45Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;\n+\n+To run a tutorial programatically do the following stepes. Note these instructions assume you've already checked out the kafka-tutorials repo).\n+\n+1. cd into `_includes/tutorials/<tutorial name>/<type>/code` directory where type is one of `ksql | kstreams | kafka`.\n+2. run the `make` command.\n+\n+The `Makefile` will delete and re-create the `outputs` directory used contain files with output from various steps used to verify the tutorial steps.\n+\n+Here's an example of the contents of a `Makefile`:\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/fk-joins/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output-events.json $(DEV_OUTPUTS_DIR)/music-interest.json\n+```\n+\n+The last line uses the `diff` command to validate expected output against the actual output of tutorial steps.  The `Makefile` may have more than one valdiation step so it will have separate `diff` commmands for each verification.  For example:\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/dynamic-output-topic/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output.json $(DEV_OUTPUTS_DIR)/actual-output.json\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-special-output.json $(DEV_OUTPUTS_DIR)/actual-special-order-output.json\n+```\n+\n+\n+\n+\n+#### 1. Structure\n+\n+Three top-level sections make up the harness file:\n+\n+* dev - the setup and teaching portion of the tutorial (required)\n+* test - test setup and execution of tests, if any (optional)\n+* prod - steps to build and deploy a docker image of the tutorial code (optional)\n+\n+In some cases, having a test and or prod section doesn't make sense, so those sections can be left out of the harness file.  The Apache Kafka console producer and consumer tutorials are a good example of tutorials that don't need a test or prod section.\n+\n+The `dev`, `test`, and `prod` sections contain a top-level element `steps`.  The `steps` contains any number of well, steps for the user to walk through.  Addtionally the `harness_runner` script follows the same steps for executing the tutorial automatically during builds.  The steps in any section are structured in the same way, so we'll only discuss the make-up of a single section.\n+\n+For reference here is an example section", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NjQ3Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            #### TLDR;\n          \n          \n            \n            #### TL;DR", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443066472", "createdAt": "2020-06-19T22:32:38Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MzY4NDMy", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#pullrequestreview-434368432", "createdAt": "2020-06-19T22:34:08Z", "commit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQyMjozNDowOFrOGmipmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQyMjozNDowOFrOGmipmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2Njc3OQ==", "bodyText": "Can you add a hyperlink to those tutorials?", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443066779", "createdAt": "2020-06-19T22:34:08Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;\n+\n+To run a tutorial programatically do the following stepes. Note these instructions assume you've already checked out the kafka-tutorials repo).\n+\n+1. cd into `_includes/tutorials/<tutorial name>/<type>/code` directory where type is one of `ksql | kstreams | kafka`.\n+2. run the `make` command.\n+\n+The `Makefile` will delete and re-create the `outputs` directory used contain files with output from various steps used to verify the tutorial steps.\n+\n+Here's an example of the contents of a `Makefile`:\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/fk-joins/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output-events.json $(DEV_OUTPUTS_DIR)/music-interest.json\n+```\n+\n+The last line uses the `diff` command to validate expected output against the actual output of tutorial steps.  The `Makefile` may have more than one valdiation step so it will have separate `diff` commmands for each verification.  For example:\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/dynamic-output-topic/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output.json $(DEV_OUTPUTS_DIR)/actual-output.json\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-special-output.json $(DEV_OUTPUTS_DIR)/actual-special-order-output.json\n+```\n+\n+\n+\n+\n+#### 1. Structure\n+\n+Three top-level sections make up the harness file:\n+\n+* dev - the setup and teaching portion of the tutorial (required)\n+* test - test setup and execution of tests, if any (optional)\n+* prod - steps to build and deploy a docker image of the tutorial code (optional)\n+\n+In some cases, having a test and or prod section doesn't make sense, so those sections can be left out of the harness file.  The Apache Kafka console producer and consumer tutorials are a good example of tutorials that don't need a test or prod section.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0MzY4NDk3", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#pullrequestreview-434368497", "createdAt": "2020-06-19T22:34:24Z", "commit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQyMjozNDoyNFrOGmipxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQyMjozNDoyNFrOGmipxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NjgyMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                Somtimes the `execute` step is an _internal_ step only for the harness runner. Internal steps ignore the `render:` using a `skip: true` entry\n          \n          \n            \n                Sometimes the `execute` step is an _internal_ step only for the harness runner. Internal steps ignore the `render:` using a `skip: true` entry", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443066823", "createdAt": "2020-06-19T22:34:24Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +237,180 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Working with the harness file\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TLDR;\n+\n+To run a tutorial programatically do the following stepes. Note these instructions assume you've already checked out the kafka-tutorials repo).\n+\n+1. cd into `_includes/tutorials/<tutorial name>/<type>/code` directory where type is one of `ksql | kstreams | kafka`.\n+2. run the `make` command.\n+\n+The `Makefile` will delete and re-create the `outputs` directory used contain files with output from various steps used to verify the tutorial steps.\n+\n+Here's an example of the contents of a `Makefile`:\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/fk-joins/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output-events.json $(DEV_OUTPUTS_DIR)/music-interest.json\n+```\n+\n+The last line uses the `diff` command to validate expected output against the actual output of tutorial steps.  The `Makefile` may have more than one valdiation step so it will have separate `diff` commmands for each verification.  For example:\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/dynamic-output-topic/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output.json $(DEV_OUTPUTS_DIR)/actual-output.json\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-special-output.json $(DEV_OUTPUTS_DIR)/actual-special-order-output.json\n+```\n+\n+\n+\n+\n+#### 1. Structure\n+\n+Three top-level sections make up the harness file:\n+\n+* dev - the setup and teaching portion of the tutorial (required)\n+* test - test setup and execution of tests, if any (optional)\n+* prod - steps to build and deploy a docker image of the tutorial code (optional)\n+\n+In some cases, having a test and or prod section doesn't make sense, so those sections can be left out of the harness file.  The Apache Kafka console producer and consumer tutorials are a good example of tutorials that don't need a test or prod section.\n+\n+The `dev`, `test`, and `prod` sections contain a top-level element `steps`.  The `steps` contains any number of well, steps for the user to walk through.  Addtionally the `harness_runner` script follows the same steps for executing the tutorial automatically during builds.  The steps in any section are structured in the same way, so we'll only discuss the make-up of a single section.\n+\n+For reference here is an example section\n+\n+```yml\n+ - title: Get Confluent Platform\n+      content:\n+        - action: make_file\n+          file: docker-compose.yml\n+          render:\n+            file: tutorials/console-consumer-primitive-keys-values/kafka/markup/dev/make-docker-compose.adoc\n+\n+        - action: execute_async\n+          file: tutorial-steps/dev/docker-compose-up.sh\n+          render:\n+            file: tutorials/console-consumer-primitive-keys-values/kafka/markup/dev/start-compose.adoc\n+\n+        - action: execute\n+          file: tutorial-steps/dev/wait-for-containers.sh\n+          render:\n+            skip: true\n+\n+        - name: wait for ksqldb-server and connectors\n+          action: sleep\n+          ms: 30000\n+          render:\n+            skip: true\n+```\n+\n+\n+* Title - each section starts with a `title` element and as the label suggests, the text provided here is the text used the label the step for the tutorial user and the output to the console by the harness runner.  The `title` section contains one element - `content`\n+\n+* content - the `content` section (a YAML `dictionary`) contains an arbitrary sized list of YAML dictionaries named `action`. An `action` key creates an anonymous step i.e. not specified in the output of the test runner.  For output in the test runner, you can provide a `-name` key followed by some text for console output.\n+* action - `action` keys drive the behavior of the harness. An action key can be one of these values\n+    * `action: make_file` - an action prompting the user to create a file for the tutorial.\n+    * `action: execute` - a synchronous action step\n+    * `action: execute_async` - an asynchronous step, this indicates a step the user will keep running for some portion of the tutorial.\n+    * `action: sleep` - pause the test runner for an amount of time specified by the `ms` key. You use `sleep` key to allow some asnyc action to complete\n+        * `ms: NNN` - the time in milliseconds you want the test harness to pause execution.  You only use `ms` after an `action: sleep` entry.\n+\n+In the next sections you'll see how to use `action` keys to organize your harness files\n+\n+\n+\n+#### 2. Action type descriptions and examples\n+\n+* `make_file`\n+    The `make_file` instructs the user to create a file an existing file required to run the tutorial.  Some examples are the `docker-compose.yml` file , a `statements.sql` (ksqlDB) , and Java files.\n+\n+    A `make_file` with a file to render look like this:\n+    ```yml\n+    - action: make_file\n+          file: docker-compose.yml\n+          render:\n+            file: tutorials/console-consumer-primitive-keys-values/kafka/markup/dev/make-docker-compose.adoc\n+    ```\n+\n+    * `file:` the path and name to the file.  The path is relative to `<tutorial-name>/<type>/code>` .The harness runner will use the file during the automated tutorial execution.\n+    * `render:` the file to render.  The `render` key is followed by one of two possible keys:\n+        * `file:` the path and name of the file to render to the user. \n+\n+* `execute` The `execute` step is a synchronous execution step during the tutorial for the user as well as the harness runner\n+\n+    ```yml\n+     - action: execute\n+          file: tutorial-steps/dev/init.sh\n+          render:\n+            file: tutorials/console-consumer-primitive-keys-values/kafka/markup/dev/init.adoc\n+    ```\n+\n+    Somtimes the `execute` step is an _internal_ step only for the harness runner. Internal steps ignore the `render:` using a `skip: true` entry", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "329e16de87d5697391dee8827d1da1fcaf5aeeeb"}, "originalPosition": 131}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce91dc13038c91cad2fd68a8fe63fd8398fcd92c", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/ce91dc13038c91cad2fd68a8fe63fd8398fcd92c", "committedDate": "2020-06-22T14:53:32Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Yeva Byzek <ybyzek@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db157806eeb0284be19a5ed370ad1a1f513c3c0a", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/db157806eeb0284be19a5ed370ad1a1f513c3c0a", "committedDate": "2020-06-22T15:26:26Z", "message": "First attempt at a TOC"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e4271d97207f39c52ac093f34b6cc0c9723194f", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/8e4271d97207f39c52ac093f34b6cc0c9723194f", "committedDate": "2020-06-22T17:12:55Z", "message": "Updates per comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a3552a4850c31fcc0acfaf25862f3aeda1ef28f", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/6a3552a4850c31fcc0acfaf25862f3aeda1ef28f", "committedDate": "2020-06-22T19:52:00Z", "message": "Add description of ocker_ksql_cli_session action"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MjI4MDcz", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#pullrequestreview-435228073", "createdAt": "2020-06-22T19:54:58Z", "commit": {"oid": "6a3552a4850c31fcc0acfaf25862f3aeda1ef28f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxOTo1NDo1OFrOGnO0NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxOTo1NDo1OFrOGnO0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5MDM4OQ==", "bodyText": "@colinhicks I've added a section for docker_ksql_cli_session", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r443790389", "createdAt": "2020-06-22T19:54:58Z", "author": {"login": "bbejeck"}, "path": "README.md", "diffHunk": "@@ -237,6 +268,210 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Testing Locally\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TL;DR\n+\n+To run a tutorial programatically do the following stepes. Note to follow these instructions you'll need to checkout the kafka-tutorials repo:\n+\n+1. git clone https://github.com/confluentinc/kafka-tutorials.git\n+2. cd kafka-tutorials\n+\n+Once you have the kafka-tutorials repo checked out do the following:\n+\n+1. cd into `_includes/tutorials/<tutorial name>/<type>/code` directory where type is one of `ksql | kstreams | kafka`.\n+    * For exmaple `cd _includes/tutorials/fk-joins/kstreams/code`\n+2. run the `make` command.\n+\n+The `Makefile` will delete and re-create the `outputs` directory used contain files with output from various steps used to verify the tutorial steps.\n+\n+Here's of [the contents of an actual `Makefile`](https://github.com/confluentinc/kafka-tutorials/blob/master/_includes/tutorials/fk-joins/kstreams/code/Makefile) :\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/fk-joins/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output-events.json $(DEV_OUTPUTS_DIR)/music-interest.json\n+```\n+\n+The last line uses the `diff` command to validate expected output against the actual output of tutorial steps.  The `Makefile` may have more than one valdiation step so it will have separate `diff` commmands for each verification.  \n+\n+For example here's the `Makefile` from the [dynamic output topics tutorial](https://github.com/confluentinc/kafka-tutorials/blob/master/_includes/tutorials/dynamic-output-topic/kstreams/code/Makefile)\n+\n+```yml\n+STEPS_DIR := tutorial-steps\n+DEV_OUTPUTS_DIR := $(STEPS_DIR)/dev/outputs\n+TEMP_DIR := $(shell mktemp -d)\n+\n+tutorial:\n+  rm -r $(DEV_OUTPUTS_DIR) || true\n+  mkdir $(DEV_OUTPUTS_DIR)\n+  harness-runner ../../../../../_data/harnesses/dynamic-output-topic/kstreams.yml $(TEMP_DIR)\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-output.json $(DEV_OUTPUTS_DIR)/actual-output.json\n+  diff --strip-trailing-cr $(STEPS_DIR)/dev/expected-special-output.json $(DEV_OUTPUTS_DIR)/actual-special-order-output.json\n+```\n+\n+#### 1. Structure\n+\n+Three top-level sections make up the harness file:\n+\n+* dev - the setup and teaching portion of the tutorial (required)\n+* test - test setup and execution of tests, if any (optional)\n+* prod - steps to build and deploy a docker image of the tutorial code (optional)\n+\n+In some cases, having a test and or prod section doesn't make sense, so those sections can be left out of the harness file.  The Apache Kafka [console producer and consumer basic operations](https://github.com/confluentinc/kafka-tutorials/blob/master/_data/harnesses/console-consumer-produer-basic/kafka.yml) and the Apache Kafka [console consumer with primitive keys and values](https://github.com/confluentinc/kafka-tutorials/blob/master/_data/harnesses/console-consumer-primitive-keys-values/kafka.yml) tutorials are a good example of tutorials that don't need a test or prod section.\n+\n+The `dev`, `test`, and `prod` sections contain a top-level element `steps`.  The `steps` contains any number of well, steps for the user to walk through.  Addtionally the `harness_runner` script follows the same steps for executing the tutorial automatically during builds.  The steps in any section are structured in the same way, so we'll only discuss the make-up of a single section.\n+\n+For reference here is an example section of the harness file from the [console consumer primitive keys and values tutorial](https://github.com/confluentinc/kafka-tutorials/blob/master/_data/harnesses/console-consumer-primitive-keys-values/kafka.yml)\n+\n+```yml\n+ - title: Get Confluent Platform\n+      content:\n+        - action: make_file\n+          file: docker-compose.yml\n+          render:\n+            file: tutorials/console-consumer-primitive-keys-values/kafka/markup/dev/make-docker-compose.adoc\n+\n+        - action: execute_async\n+          file: tutorial-steps/dev/docker-compose-up.sh\n+          render:\n+            file: tutorials/console-consumer-primitive-keys-values/kafka/markup/dev/start-compose.adoc\n+\n+        - action: execute\n+          file: tutorial-steps/dev/wait-for-containers.sh\n+          render:\n+            skip: true\n+\n+        - name: wait for ksqldb-server and connectors\n+          action: sleep\n+          ms: 30000\n+          render:\n+            skip: true\n+```\n+\n+\n+* Title - each section starts with a `title` element and as the label suggests, the text provided here is the text used the label the step for the tutorial user and the output to the console by the harness runner.  The `title` section contains one element - `content`\n+\n+* content - the `content` section (a YAML `dictionary`) contains an arbitrary sized list of YAML dictionaries named `action`. An `action` key creates an anonymous step i.e. not specified in the output of the test runner.  For output in the test runner, you can provide a `-name` key followed by some text for console output.\n+* action - `action` keys drive the behavior of the harness. An action key can be one of these values\n+    * `action: make_file` - an action prompting the user to create a file for the tutorial.\n+    * `action: execute` - a synchronous action step\n+    * `action: execute_async` - an asynchronous step, this indicates a step the user will keep running for some portion of the tutorial.\n+    * `action: sleep` - pause the test runner for an amount of time specified by the `ms` key. You use `sleep` key to allow some asnyc action to complete\n+        * `ms: NNN` - the time in milliseconds you want the test harness to pause execution.  You only use `ms` after an `action: sleep` entry.\n+    * `docker_ksql_cli_session` - an action starting a ksqlDB CLI session for working through a tutorial", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a3552a4850c31fcc0acfaf25862f3aeda1ef28f"}, "originalPosition": 140}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MTA0ODQ0", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#pullrequestreview-436104844", "createdAt": "2020-06-23T19:51:05Z", "commit": {"oid": "6a3552a4850c31fcc0acfaf25862f3aeda1ef28f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxOTo1MTowNlrOGn4M6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxOTo1MTowNlrOGn4M6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ2ODQ1Nw==", "bodyText": "Should we add a 3rd step to setup environment per the instructions at https://github.com/confluentinc/kafka-tutorials#setup ?  If so, that might be where we provide the optional Dockerfile addition?", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r444468457", "createdAt": "2020-06-23T19:51:06Z", "author": {"login": "ybyzek"}, "path": "README.md", "diffHunk": "@@ -237,6 +268,210 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Testing Locally\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.\n+\n+This section is not meant to be an exhaustive decription of the harness file.  New tutorial authors should not need to create a harness file from scratch, using either the `tools/gen_project.sh` or  `tools/clone.sh` script will provide a usable harness file.  This section should provide enough guidance to add, update, or remove sections as needed.\n+\n+#### TL;DR\n+\n+To run a tutorial programatically do the following stepes. Note to follow these instructions you'll need to checkout the kafka-tutorials repo:\n+\n+1. git clone https://github.com/confluentinc/kafka-tutorials.git\n+2. cd kafka-tutorials", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a3552a4850c31fcc0acfaf25862f3aeda1ef28f"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NjkxMDc0", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#pullrequestreview-436691074", "createdAt": "2020-06-24T14:17:01Z", "commit": {"oid": "6a3552a4850c31fcc0acfaf25862f3aeda1ef28f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNDoxNzowMlrOGoUL4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNDoxNzowMlrOGoUL4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDkyNjk0Ng==", "bodyText": "Typo: YAML file formt", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#discussion_r444926946", "createdAt": "2020-06-24T14:17:02Z", "author": {"login": "vdesabou"}, "path": "README.md", "diffHunk": "@@ -237,6 +268,210 @@ You can do the same for Kafka Streams and Kafka, by using the `kstreams` and `ka\n \n Lastly, create a Makefile in the `code` directory to invoke the harness runner and check any outputs that it produces. Then modify the `.semaphore/semaphore.yml` file to invoke that Makefile. This will make sure your tutorial gets checked by the CI system.\n \n+## Testing Locally\n+\n+Given the test harness is the `heart` of a tutorial, it will be helpful to describe in detail how to work with a `kafka|ksql|kstreams.yml` file.  It should be noted the harness file is in the [YAML file formt](https://en.wikipedia.org/wiki/YAML), so formatting properly is essential.  The harness files generates the structure of the rendered tutorial and also validates any output of tutorial steps against expected values.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a3552a4850c31fcc0acfaf25862f3aeda1ef28f"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d86c33e3d687bea521f85e7a333c16af9e07b9c1", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/d86c33e3d687bea521f85e7a333c16af9e07b9c1", "committedDate": "2020-06-24T22:07:50Z", "message": "Update TOC to only go to 2nd level"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c6fd3b7b0d4892e61f1c0cffcefd46a89db161f", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/5c6fd3b7b0d4892e61f1c0cffcefd46a89db161f", "committedDate": "2020-06-24T22:33:03Z", "message": "add instructions for using docker to install python3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MDU0MDgx", "url": "https://github.com/confluentinc/kafka-tutorials/pull/441#pullrequestreview-437054081", "createdAt": "2020-06-24T22:38:54Z", "commit": {"oid": "5c6fd3b7b0d4892e61f1c0cffcefd46a89db161f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aefeff9bf763a622a205677afe86e087fa1d97d2", "author": {"user": {"login": "bbejeck", "name": "Bill Bejeck"}}, "url": "https://github.com/confluentinc/kafka-tutorials/commit/aefeff9bf763a622a205677afe86e087fa1d97d2", "committedDate": "2020-06-24T22:52:29Z", "message": "Cleaned up grammar"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 170, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}