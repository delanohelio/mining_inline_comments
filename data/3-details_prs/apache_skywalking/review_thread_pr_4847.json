{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NzE3NTI3", "number": 4847, "reviewThreads": {"totalCount": 50, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowMjowM1rOEBO8Rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMzo0NDoyOFrOETd2Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NzI4ODM4OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/config/agent.config", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowMjowM1rOGc9obw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNzowM1rOGc9rpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzA4Nw==", "bodyText": "I think we should share the backend service, and the kafka sender could be activated automatically through the same agent plugin activation way(copy).", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r433023087", "createdAt": "2020-06-01T03:02:03Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -78,3 +78,6 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n \n # mysql plugin configuration\n # plugin.mysql.trace_sql_parameters=${SW_MYSQL_TRACE_SQL_PARAMETERS:false}\n+\n+# Kafka producer configuration\n+# collector.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be6dada18cd520e4bc9f963a6be3053d9c11d679"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzkxMA==", "bodyText": "From the Config, you have implemented the JVM, trace and profile, so, I think when this plugin activated, there is no need to have grpc endpoint, right?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r433023910", "createdAt": "2020-06-01T03:07:03Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -78,3 +78,6 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n \n # mysql plugin configuration\n # plugin.mysql.trace_sql_parameters=${SW_MYSQL_TRACE_SQL_PARAMETERS:false}\n+\n+# Kafka producer configuration\n+# collector.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzA4Nw=="}, "originalCommit": {"oid": "be6dada18cd520e4bc9f963a6be3053d9c11d679"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NzI5MDUzOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowMzo0N1rOGc9pnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowMzo0N1rOGc9pnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzM4OQ==", "bodyText": "Why this is provided? If this is provided, you wouldn't have the Kafka-clients at the runtime, as the agent core doesn't include those.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r433023389", "createdAt": "2020-06-01T03:03:47Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/pom.xml", "diffHunk": "@@ -0,0 +1,58 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>optional-producer-plugins</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>8.0.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>kafka-producer-plugin</artifactId>\n+    <packaging>jar</packaging>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-agent-core</artifactId>\n+            <version>${project.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-util</artifactId>\n+            <version>${project.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-test-tools</artifactId>\n+            <version>${project.version}</version>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.kafka</groupId>\n+            <artifactId>kafka-clients</artifactId>\n+            <version>2.3.1</version>\n+            <scope>provided</scope>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be6dada18cd520e4bc9f963a6be3053d9c11d679"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NzI5MTA4OnYy", "diffSide": "LEFT", "path": "apm-sniffer/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNDoxOVrOGc9p6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNDoxOVrOGc9p6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzQ2Nw==", "bodyText": "Why remove toolkit?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r433023467", "createdAt": "2020-06-01T03:04:19Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/pom.xml", "diffHunk": "@@ -32,10 +32,8 @@\n         <module>apm-agent</module>\n         <module>apm-agent-core</module>\n         <module>apm-sdk-plugin</module>\n-        <module>apm-toolkit-activation</module>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be6dada18cd520e4bc9f963a6be3053d9c11d679"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NzI5MTg4OnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNDo1OFrOGc9qVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNDo1OFrOGc9qVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzU3Mw==", "bodyText": "Kafka version should be managed in the oap level pom.xml", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r433023573", "createdAt": "2020-06-01T03:04:58Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/pom.xml", "diffHunk": "@@ -0,0 +1,48 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>skywalking-mq-receiver-plugins</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>8.0.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>kafka-receiver-plugin</artifactId>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.kafka</groupId>\n+            <artifactId>kafka-clients</artifactId>\n+            <version>2.4.1</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be6dada18cd520e4bc9f963a6be3053d9c11d679"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NzI5MjY4OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-producer-plugins/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNTozNlrOGc9qyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwMzowNTozNlrOGc9qyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzAyMzY4OA==", "bodyText": "Why shade the bytebuddy?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r433023688", "createdAt": "2020-06-01T03:05:36Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/optional-producer-plugins/pom.xml", "diffHunk": "@@ -0,0 +1,144 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>apm-sniffer</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>8.0.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>optional-producer-plugins</artifactId>\n+    <packaging>pom</packaging>\n+\n+    <modules>\n+        <module>kafka-producer-plugin</module>\n+    </modules>\n+\n+    <properties>\n+        <shade.net.bytebuddy.source>net.bytebuddy</shade.net.bytebuddy.source>\n+        <shade.net.bytebuddy.target>${shade.package}.${shade.net.bytebuddy.source}</shade.net.bytebuddy.target>\n+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+\n+        <sdk.plugin.related.dir/>\n+        <agent.package.dest.dir>${project.build.directory}${sdk.plugin.related.dir}/../../../../skywalking-agent\n+        </agent.package.dest.dir>\n+        <bootstrap.plugin.dest.dir>${agent.package.dest.dir}/mq-reporter-plugins</bootstrap.plugin.dest.dir>\n+\n+        <ant-contrib.version>1.0b3</ant-contrib.version>\n+        <ant-nodeps.version>1.8.1</ant-nodeps.version>\n+    </properties>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-agent-core</artifactId>\n+            <version>${project.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-util</artifactId>\n+            <version>${project.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-test-tools</artifactId>\n+            <version>${project.version}</version>\n+            <scope>test</scope>\n+        </dependency>\n+    </dependencies>\n+\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <artifactId>maven-shade-plugin</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be6dada18cd520e4bc9f963a6be3053d9c11d679"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNDU2MjM2OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaTraceSegmentService.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwOToxNzoyOFrOGfm38A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNzoxMTowN1rOGmndfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5NTk1Mg==", "bodyText": "need try catch exception and send trace data by async way? put to buffer, and consume to send by kafka, just advice.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r435795952", "createdAt": "2020-06-05T09:17:28Z", "author": {"login": "zifeihan"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaTraceSegmentService.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import org.apache.kafka.clients.producer.KafkaProducer;\n+import org.apache.kafka.clients.producer.ProducerRecord;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.context.TracingContext;\n+import org.apache.skywalking.apm.agent.core.context.TracingContextListener;\n+import org.apache.skywalking.apm.agent.core.context.trace.TraceSegment;\n+import org.apache.skywalking.apm.agent.core.logging.api.ILog;\n+import org.apache.skywalking.apm.agent.core.logging.api.LogManager;\n+import org.apache.skywalking.apm.agent.core.remote.TraceSegmentServiceClient;\n+import org.apache.skywalking.apm.network.language.agent.v3.SegmentObject;\n+\n+@OverrideImplementor(TraceSegmentServiceClient.class)\n+public class KafkaTraceSegmentService implements BootService, TracingContextListener {\n+    private static final ILog logger = LogManager.getLogger(KafkaTraceSegmentService.class);\n+\n+    private String topic;\n+    private KafkaProducer<String, Bytes> producer;\n+\n+    @Override\n+    public void prepare() throws Throwable {\n+        topic = Config.Collector.Kafka.TOPIC_SEGMENT;\n+    }\n+\n+    @Override\n+    public void boot() throws Throwable {\n+        producer = ServiceManager.INSTANCE.findService(MessageQueueServiceManagement.class).getProducer(topic);\n+    }\n+\n+    @Override\n+    public void onComplete() throws Throwable {\n+        TracingContext.ListenerManager.add(this);\n+    }\n+\n+    @Override\n+    public void shutdown() throws Throwable {\n+        TracingContext.ListenerManager.remove(this);\n+    }\n+\n+    @Override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16b8f7be0c067a6acb8d25d3f34465fc4daa65b9"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTgwNTE4Mw==", "bodyText": "Thanks for your suggestions.\nYes, we have to catch the exception.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r435805183", "createdAt": "2020-06-05T09:34:06Z", "author": {"login": "dmsolr"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaTraceSegmentService.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import org.apache.kafka.clients.producer.KafkaProducer;\n+import org.apache.kafka.clients.producer.ProducerRecord;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.context.TracingContext;\n+import org.apache.skywalking.apm.agent.core.context.TracingContextListener;\n+import org.apache.skywalking.apm.agent.core.context.trace.TraceSegment;\n+import org.apache.skywalking.apm.agent.core.logging.api.ILog;\n+import org.apache.skywalking.apm.agent.core.logging.api.LogManager;\n+import org.apache.skywalking.apm.agent.core.remote.TraceSegmentServiceClient;\n+import org.apache.skywalking.apm.network.language.agent.v3.SegmentObject;\n+\n+@OverrideImplementor(TraceSegmentServiceClient.class)\n+public class KafkaTraceSegmentService implements BootService, TracingContextListener {\n+    private static final ILog logger = LogManager.getLogger(KafkaTraceSegmentService.class);\n+\n+    private String topic;\n+    private KafkaProducer<String, Bytes> producer;\n+\n+    @Override\n+    public void prepare() throws Throwable {\n+        topic = Config.Collector.Kafka.TOPIC_SEGMENT;\n+    }\n+\n+    @Override\n+    public void boot() throws Throwable {\n+        producer = ServiceManager.INSTANCE.findService(MessageQueueServiceManagement.class).getProducer(topic);\n+    }\n+\n+    @Override\n+    public void onComplete() throws Throwable {\n+        TracingContext.ListenerManager.add(this);\n+    }\n+\n+    @Override\n+    public void shutdown() throws Throwable {\n+        TracingContext.ListenerManager.remove(this);\n+    }\n+\n+    @Override", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5NTk1Mg=="}, "originalCommit": {"oid": "16b8f7be0c067a6acb8d25d3f34465fc4daa65b9"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzExODQ2Mg==", "bodyText": "@dmsolr  any update?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443118462", "createdAt": "2020-06-20T09:58:30Z", "author": {"login": "zifeihan"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaTraceSegmentService.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import org.apache.kafka.clients.producer.KafkaProducer;\n+import org.apache.kafka.clients.producer.ProducerRecord;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.context.TracingContext;\n+import org.apache.skywalking.apm.agent.core.context.TracingContextListener;\n+import org.apache.skywalking.apm.agent.core.context.trace.TraceSegment;\n+import org.apache.skywalking.apm.agent.core.logging.api.ILog;\n+import org.apache.skywalking.apm.agent.core.logging.api.LogManager;\n+import org.apache.skywalking.apm.agent.core.remote.TraceSegmentServiceClient;\n+import org.apache.skywalking.apm.network.language.agent.v3.SegmentObject;\n+\n+@OverrideImplementor(TraceSegmentServiceClient.class)\n+public class KafkaTraceSegmentService implements BootService, TracingContextListener {\n+    private static final ILog logger = LogManager.getLogger(KafkaTraceSegmentService.class);\n+\n+    private String topic;\n+    private KafkaProducer<String, Bytes> producer;\n+\n+    @Override\n+    public void prepare() throws Throwable {\n+        topic = Config.Collector.Kafka.TOPIC_SEGMENT;\n+    }\n+\n+    @Override\n+    public void boot() throws Throwable {\n+        producer = ServiceManager.INSTANCE.findService(MessageQueueServiceManagement.class).getProducer(topic);\n+    }\n+\n+    @Override\n+    public void onComplete() throws Throwable {\n+        TracingContext.ListenerManager.add(this);\n+    }\n+\n+    @Override\n+    public void shutdown() throws Throwable {\n+        TracingContext.ListenerManager.remove(this);\n+    }\n+\n+    @Override", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5NTk1Mg=="}, "originalCommit": {"oid": "16b8f7be0c067a6acb8d25d3f34465fc4daa65b9"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE0NTU5Ng==", "bodyText": "Yes, it will be released in 8.1.0 :)", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443145596", "createdAt": "2020-06-20T17:11:07Z", "author": {"login": "dmsolr"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaTraceSegmentService.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import org.apache.kafka.clients.producer.KafkaProducer;\n+import org.apache.kafka.clients.producer.ProducerRecord;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.context.TracingContext;\n+import org.apache.skywalking.apm.agent.core.context.TracingContextListener;\n+import org.apache.skywalking.apm.agent.core.context.trace.TraceSegment;\n+import org.apache.skywalking.apm.agent.core.logging.api.ILog;\n+import org.apache.skywalking.apm.agent.core.logging.api.LogManager;\n+import org.apache.skywalking.apm.agent.core.remote.TraceSegmentServiceClient;\n+import org.apache.skywalking.apm.network.language.agent.v3.SegmentObject;\n+\n+@OverrideImplementor(TraceSegmentServiceClient.class)\n+public class KafkaTraceSegmentService implements BootService, TracingContextListener {\n+    private static final ILog logger = LogManager.getLogger(KafkaTraceSegmentService.class);\n+\n+    private String topic;\n+    private KafkaProducer<String, Bytes> producer;\n+\n+    @Override\n+    public void prepare() throws Throwable {\n+        topic = Config.Collector.Kafka.TOPIC_SEGMENT;\n+    }\n+\n+    @Override\n+    public void boot() throws Throwable {\n+        producer = ServiceManager.INSTANCE.findService(MessageQueueServiceManagement.class).getProducer(topic);\n+    }\n+\n+    @Override\n+    public void onComplete() throws Throwable {\n+        TracingContext.ListenerManager.add(this);\n+    }\n+\n+    @Override\n+    public void shutdown() throws Throwable {\n+        TracingContext.ListenerManager.remove(this);\n+    }\n+\n+    @Override", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc5NTk1Mg=="}, "originalCommit": {"oid": "16b8f7be0c067a6acb8d25d3f34465fc4daa65b9"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NTk2NTcyOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo0MjoxM1rOGnWW5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxODoyNTo0N1rOGrw1iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxMzk1Nw==", "bodyText": "How are these topic(s) created?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443913957", "createdAt": "2020-06-23T01:42:13Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -140,6 +140,25 @@\n          * Get profile task list interval\n          */\n         public static int GET_PROFILE_TASK_INTERVAL = 20;\n+\n+        public static class Kafka {\n+\n+            public static String BOOTSTRAP_SERVERS;\n+\n+            public static int BATCH_SIZE = 1000;\n+\n+            public static String ACKS = \"1\";\n+\n+            public static String TOPIC_METRICS = \"skywalking-metrics\";\n+\n+            public static String TOPIC_PROFILING = \"skywalking-profiling\";\n+\n+            public static String TOPIC_SEGMENT = \"skywalking-segment\";\n+\n+            public static String TOPIC_MANAGEMENT = \"skywalking-management\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODU0MjA4OQ==", "bodyText": "If the topic not exists, Kafka will create it by itself.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r448542089", "createdAt": "2020-07-01T18:25:47Z", "author": {"login": "dmsolr"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -140,6 +140,25 @@\n          * Get profile task list interval\n          */\n         public static int GET_PROFILE_TASK_INTERVAL = 20;\n+\n+        public static class Kafka {\n+\n+            public static String BOOTSTRAP_SERVERS;\n+\n+            public static int BATCH_SIZE = 1000;\n+\n+            public static String ACKS = \"1\";\n+\n+            public static String TOPIC_METRICS = \"skywalking-metrics\";\n+\n+            public static String TOPIC_PROFILING = \"skywalking-profiling\";\n+\n+            public static String TOPIC_SEGMENT = \"skywalking-segment\";\n+\n+            public static String TOPIC_MANAGEMENT = \"skywalking-management\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxMzk1Nw=="}, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NTk2Njg1OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo0Mjo0N1rOGnWXjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo0Mjo0N1rOGnWXjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxNDEyNQ==", "bodyText": "Why change this? Who will create new Tracing Context?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443914125", "createdAt": "2020-06-23T01:42:47Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java", "diffHunk": "@@ -116,7 +116,7 @@\n     /**\n      * Initialize all fields with default value.\n      */\n-    TracingContext(String firstOPName) {\n+    public TracingContext(String firstOPName) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NTk2OTMxOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/jvm/JVMServiceSender.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo0NDoxNVrOGnWZEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo0NDoxNVrOGnWZEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxNDUxNQ==", "bodyText": "Comments are required.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443914515", "createdAt": "2020-06-23T01:44:15Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/jvm/JVMServiceSender.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.jvm;\n+\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetric;\n+\n+public interface JVMServiceSender extends BootService, Runnable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NTk3MjgxOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/jvm/JVMServiceSenderImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo0NjoyMlrOGnWbNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo0NjoyMlrOGnWbNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxNTA2Mw==", "bodyText": "I think this should be JVMServiceGrpcSender", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443915063", "createdAt": "2020-06-23T01:46:22Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/jvm/JVMServiceSenderImpl.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.jvm;\n+\n+import io.grpc.Channel;\n+import java.util.LinkedList;\n+import java.util.concurrent.LinkedBlockingQueue;\n+import java.util.concurrent.TimeUnit;\n+import org.apache.skywalking.apm.agent.core.boot.DefaultImplementor;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+import org.apache.skywalking.apm.agent.core.commands.CommandService;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.logging.api.ILog;\n+import org.apache.skywalking.apm.agent.core.logging.api.LogManager;\n+import org.apache.skywalking.apm.agent.core.remote.GRPCChannelListener;\n+import org.apache.skywalking.apm.agent.core.remote.GRPCChannelManager;\n+import org.apache.skywalking.apm.agent.core.remote.GRPCChannelStatus;\n+import org.apache.skywalking.apm.network.common.v3.Commands;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetric;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetricCollection;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetricReportServiceGrpc;\n+\n+import static org.apache.skywalking.apm.agent.core.conf.Config.Collector.GRPC_UPSTREAM_TIMEOUT;\n+\n+@DefaultImplementor\n+public class JVMServiceSenderImpl implements JVMServiceSender, GRPCChannelListener {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NTk4MDMwOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo1MDo1MlrOGnWfnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo1MDo1MlrOGnWfnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxNjE5MQ==", "bodyText": "Where do we shade this dependency? And dist LICENSE/NOTICE/dep license files has to update, due to you include more things.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443916191", "createdAt": "2020-06-23T01:50:52Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/pom.xml", "diffHunk": "@@ -0,0 +1,63 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>optional-producer-plugins</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>8.0.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>kafka-producer-plugin</artifactId>\n+    <packaging>jar</packaging>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-agent-core</artifactId>\n+            <version>${project.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-util</artifactId>\n+            <version>${project.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-test-tools</artifactId>\n+            <version>${project.version}</version>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.kafka</groupId>\n+            <artifactId>kafka-clients</artifactId>\n+            <version>${kafk-clients.version}</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NTk5NTI1OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaProfileTaskService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMTo1OTozOFrOGnWpGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo0MDowNVrOGnXSCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxODYxOA==", "bodyText": "What does this comment mean? What Rest API? All codes below are using Kafka related tech stack. Confusing.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443918618", "createdAt": "2020-06-23T01:59:38Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaProfileTaskService.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import java.util.ArrayList;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.TimeUnit;\n+import org.apache.kafka.clients.producer.KafkaProducer;\n+import org.apache.kafka.clients.producer.ProducerRecord;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.agent.core.boot.DefaultNamedThreadFactory;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.logging.api.ILog;\n+import org.apache.skywalking.apm.agent.core.logging.api.LogManager;\n+import org.apache.skywalking.apm.agent.core.profile.ProfileTaskChannelService;\n+import org.apache.skywalking.apm.agent.core.profile.TracingThreadSnapshot;\n+import org.apache.skywalking.apm.agent.core.remote.GRPCChannelManager;\n+import org.apache.skywalking.apm.network.language.profile.v3.ThreadSnapshot;\n+import org.apache.skywalking.apm.util.RunnableWithExceptionProtection;\n+\n+/**\n+ * Considering that MessageQueue belongs to a decoupled architecture, therefore we do not support this. The MQ is not\n+ * good for real-time interactive. It will be implemented through Rest API.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyOTA5Nw==", "bodyText": "Ignore it, note for myself. I forgot to remove it.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443929097", "createdAt": "2020-06-23T02:40:05Z", "author": {"login": "dmsolr"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaProfileTaskService.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import java.util.ArrayList;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.TimeUnit;\n+import org.apache.kafka.clients.producer.KafkaProducer;\n+import org.apache.kafka.clients.producer.ProducerRecord;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.agent.core.boot.DefaultNamedThreadFactory;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.logging.api.ILog;\n+import org.apache.skywalking.apm.agent.core.logging.api.LogManager;\n+import org.apache.skywalking.apm.agent.core.profile.ProfileTaskChannelService;\n+import org.apache.skywalking.apm.agent.core.profile.TracingThreadSnapshot;\n+import org.apache.skywalking.apm.agent.core.remote.GRPCChannelManager;\n+import org.apache.skywalking.apm.network.language.profile.v3.ThreadSnapshot;\n+import org.apache.skywalking.apm.util.RunnableWithExceptionProtection;\n+\n+/**\n+ * Considering that MessageQueue belongs to a decoupled architecture, therefore we do not support this. The MQ is not\n+ * good for real-time interactive. It will be implemented through Rest API.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxODYxOA=="}, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjAwMjE0OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjowMzoyOVrOGnWtSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjowMzoyOVrOGnWtSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkxOTY5MQ==", "bodyText": "Comments", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443919691", "createdAt": "2020-06-23T02:03:29Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java", "diffHunk": "@@ -140,6 +140,25 @@\n          * Get profile task list interval\n          */\n         public static int GET_PROFILE_TASK_INTERVAL = 20;\n+\n+        public static class Kafka {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjAxNDk0OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/MessageQueueServiceManagement.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoxMTozOVrOGnW1og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoxMTozOVrOGnW1og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMTgyNg==", "bodyText": "What is this? Why is there a config not from the official way?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443921826", "createdAt": "2020-06-23T02:11:39Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/optional-producer-plugins/kafka-producer-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/MessageQueueServiceManagement.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import java.util.Properties;\n+import org.apache.kafka.clients.producer.KafkaProducer;\n+import org.apache.kafka.clients.producer.ProducerConfig;\n+import org.apache.kafka.common.serialization.BytesSerializer;\n+import org.apache.kafka.common.serialization.StringSerializer;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.boot.DefaultImplementor;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.logging.api.ILog;\n+import org.apache.skywalking.apm.agent.core.logging.api.LogManager;\n+\n+@DefaultImplementor\n+public class MessageQueueServiceManagement implements BootService, Runnable {\n+    private static final ILog logger = LogManager.getLogger(MessageQueueServiceManagement.class);\n+    private KafkaProducer<String, Bytes> producer;\n+\n+    @Override\n+    public void prepare() {\n+        Properties properties = new Properties();\n+        properties.setProperty(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, Config.Collector.Kafka.BOOTSTRAP_SERVERS);\n+        properties.setProperty(ProducerConfig.BATCH_SIZE_CONFIG, String.valueOf(Config.Collector.Kafka.BATCH_SIZE));\n+        properties.setProperty(ProducerConfig.ACKS_CONFIG, Config.Collector.Kafka.ACKS);\n+\n+        Config.Collector.Kafka.CONSUMER_CONFIG.forEach((k, v) -> properties.setProperty(k, v));\n+\n+        if (!properties.contains(\"max.block.ms\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjAxODg5OnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/KafkaReceiverProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoxNDoyMFrOGnW4Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo0NDoxN1rOGnXWVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMjUxMA==", "bodyText": "I think once you are opening receiver, this should take the responsibility of creating topic(s), right?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443922510", "createdAt": "2020-06-23T02:14:20Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/KafkaReceiverProvider.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka.provider;\n+\n+import lombok.extern.slf4j.Slf4j;\n+import org.apache.skywalking.oap.server.configuration.api.ConfigurationModule;\n+import org.apache.skywalking.oap.server.core.CoreModule;\n+import org.apache.skywalking.oap.server.core.cluster.ClusterModule;\n+import org.apache.skywalking.oap.server.library.module.ModuleConfig;\n+import org.apache.skywalking.oap.server.library.module.ModuleDefine;\n+import org.apache.skywalking.oap.server.library.module.ModuleProvider;\n+import org.apache.skywalking.oap.server.library.module.ModuleStartException;\n+import org.apache.skywalking.oap.server.library.module.ServiceNotProvidedException;\n+import org.apache.skywalking.oap.server.receiver.kafka.KafkaReceiveHandlerRegister;\n+import org.apache.skywalking.oap.server.receiver.kafka.module.KafkaReceiverConfig;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.handler.JVMMetricsReceiveHandler;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.handler.KafkaManagementReceiveHandler;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.handler.TraceSegmentReceiveHandler;\n+import org.apache.skywalking.oap.server.receiver.mq.ReceiveHandlerRegister;\n+import org.apache.skywalking.oap.server.receiver.mq.module.MessageQueueReceiverModule;\n+import org.apache.skywalking.oap.server.receiver.sharing.server.SharingServerModule;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.TraceServiceModuleConfig;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.parser.SegmentParserListenerManager;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.parser.listener.MultiScopesAnalysisListener;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.parser.listener.NetworkAddressAliasMappingListener;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.parser.listener.SegmentAnalysisListener;\n+import org.apache.skywalking.oap.server.telemetry.TelemetryModule;\n+\n+@Slf4j\n+public class KafkaReceiverProvider extends ModuleProvider {\n+    private KafkaReceiverConfig config;\n+    private KafkaReceiveHandlerRegister handlerRegister;\n+    private TraceServiceModuleConfig traceServiceModuleConfig;\n+\n+    public KafkaReceiverProvider() {\n+        config = new KafkaReceiverConfig();\n+    }\n+\n+    @Override\n+    public String name() {\n+        return \"kafka\";\n+    }\n+\n+    @Override\n+    public Class<? extends ModuleDefine> module() {\n+        return MessageQueueReceiverModule.class;\n+    }\n+\n+    @Override\n+    public ModuleConfig createConfigBeanIfAbsent() {\n+        return config;\n+    }\n+\n+    @Override\n+    public void prepare() throws ServiceNotProvidedException, ModuleStartException {\n+        handlerRegister = new KafkaReceiveHandlerRegister(config);\n+        this.registerServiceImplementation(ReceiveHandlerRegister.class, handlerRegister);\n+    }\n+\n+    @Override\n+    public void start() throws ServiceNotProvidedException, ModuleStartException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzMDE5Nw==", "bodyText": "Kafka consumer/product will create it if not exists in default. I will recheck.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443930197", "createdAt": "2020-06-23T02:44:17Z", "author": {"login": "dmsolr"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/KafkaReceiverProvider.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka.provider;\n+\n+import lombok.extern.slf4j.Slf4j;\n+import org.apache.skywalking.oap.server.configuration.api.ConfigurationModule;\n+import org.apache.skywalking.oap.server.core.CoreModule;\n+import org.apache.skywalking.oap.server.core.cluster.ClusterModule;\n+import org.apache.skywalking.oap.server.library.module.ModuleConfig;\n+import org.apache.skywalking.oap.server.library.module.ModuleDefine;\n+import org.apache.skywalking.oap.server.library.module.ModuleProvider;\n+import org.apache.skywalking.oap.server.library.module.ModuleStartException;\n+import org.apache.skywalking.oap.server.library.module.ServiceNotProvidedException;\n+import org.apache.skywalking.oap.server.receiver.kafka.KafkaReceiveHandlerRegister;\n+import org.apache.skywalking.oap.server.receiver.kafka.module.KafkaReceiverConfig;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.handler.JVMMetricsReceiveHandler;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.handler.KafkaManagementReceiveHandler;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.handler.TraceSegmentReceiveHandler;\n+import org.apache.skywalking.oap.server.receiver.mq.ReceiveHandlerRegister;\n+import org.apache.skywalking.oap.server.receiver.mq.module.MessageQueueReceiverModule;\n+import org.apache.skywalking.oap.server.receiver.sharing.server.SharingServerModule;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.TraceServiceModuleConfig;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.parser.SegmentParserListenerManager;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.parser.listener.MultiScopesAnalysisListener;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.parser.listener.NetworkAddressAliasMappingListener;\n+import org.apache.skywalking.oap.server.receiver.trace.provider.parser.listener.SegmentAnalysisListener;\n+import org.apache.skywalking.oap.server.telemetry.TelemetryModule;\n+\n+@Slf4j\n+public class KafkaReceiverProvider extends ModuleProvider {\n+    private KafkaReceiverConfig config;\n+    private KafkaReceiveHandlerRegister handlerRegister;\n+    private TraceServiceModuleConfig traceServiceModuleConfig;\n+\n+    public KafkaReceiverProvider() {\n+        config = new KafkaReceiverConfig();\n+    }\n+\n+    @Override\n+    public String name() {\n+        return \"kafka\";\n+    }\n+\n+    @Override\n+    public Class<? extends ModuleDefine> module() {\n+        return MessageQueueReceiverModule.class;\n+    }\n+\n+    @Override\n+    public ModuleConfig createConfigBeanIfAbsent() {\n+        return config;\n+    }\n+\n+    @Override\n+    public void prepare() throws ServiceNotProvidedException, ModuleStartException {\n+        handlerRegister = new KafkaReceiveHandlerRegister(config);\n+        this.registerServiceImplementation(ReceiveHandlerRegister.class, handlerRegister);\n+    }\n+\n+    @Override\n+    public void start() throws ServiceNotProvidedException, ModuleStartException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMjUxMA=="}, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjAxOTUwOnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/dispatcher/JVMSourceDispatcher.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoxNDo0N1rOGnW4rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoxNDo0N1rOGnW4rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMjYwNg==", "bodyText": "Unexpected logger,", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443922606", "createdAt": "2020-06-23T02:14:47Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/dispatcher/JVMSourceDispatcher.java", "diffHunk": "@@ -0,0 +1,179 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka.provider.dispatcher;\n+\n+import java.util.List;\n+import org.apache.skywalking.apm.network.common.v3.CPU;\n+import org.apache.skywalking.apm.network.language.agent.v3.GC;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetric;\n+import org.apache.skywalking.apm.network.language.agent.v3.Memory;\n+import org.apache.skywalking.apm.network.language.agent.v3.MemoryPool;\n+import org.apache.skywalking.oap.server.core.CoreModule;\n+import org.apache.skywalking.oap.server.core.analysis.IDManager;\n+import org.apache.skywalking.oap.server.core.analysis.NodeType;\n+import org.apache.skywalking.oap.server.core.analysis.TimeBucket;\n+import org.apache.skywalking.oap.server.core.source.GCPhrase;\n+import org.apache.skywalking.oap.server.core.source.MemoryPoolType;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMCPU;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMGC;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMMemory;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMMemoryPool;\n+import org.apache.skywalking.oap.server.core.source.SourceReceiver;\n+import org.apache.skywalking.oap.server.library.module.ModuleManager;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * Copy from other receiver\n+ */\n+public class JVMSourceDispatcher {\n+    private static final Logger logger = LoggerFactory.getLogger(JVMSourceDispatcher.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjAyNTE5OnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/dispatcher/JVMSourceDispatcher.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoxODoyN1rOGnW8Iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo0NDoyOFrOGnXWgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMzQ5MQ==", "bodyText": "This comment doesn't make sense. If you want to say copy, that is mostly from another project, not ourselves.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443923491", "createdAt": "2020-06-23T02:18:27Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/dispatcher/JVMSourceDispatcher.java", "diffHunk": "@@ -0,0 +1,179 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka.provider.dispatcher;\n+\n+import java.util.List;\n+import org.apache.skywalking.apm.network.common.v3.CPU;\n+import org.apache.skywalking.apm.network.language.agent.v3.GC;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetric;\n+import org.apache.skywalking.apm.network.language.agent.v3.Memory;\n+import org.apache.skywalking.apm.network.language.agent.v3.MemoryPool;\n+import org.apache.skywalking.oap.server.core.CoreModule;\n+import org.apache.skywalking.oap.server.core.analysis.IDManager;\n+import org.apache.skywalking.oap.server.core.analysis.NodeType;\n+import org.apache.skywalking.oap.server.core.analysis.TimeBucket;\n+import org.apache.skywalking.oap.server.core.source.GCPhrase;\n+import org.apache.skywalking.oap.server.core.source.MemoryPoolType;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMCPU;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMGC;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMMemory;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMMemoryPool;\n+import org.apache.skywalking.oap.server.core.source.SourceReceiver;\n+import org.apache.skywalking.oap.server.library.module.ModuleManager;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * Copy from other receiver", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzMDI0MQ==", "bodyText": "Got it", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443930241", "createdAt": "2020-06-23T02:44:28Z", "author": {"login": "dmsolr"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/dispatcher/JVMSourceDispatcher.java", "diffHunk": "@@ -0,0 +1,179 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka.provider.dispatcher;\n+\n+import java.util.List;\n+import org.apache.skywalking.apm.network.common.v3.CPU;\n+import org.apache.skywalking.apm.network.language.agent.v3.GC;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetric;\n+import org.apache.skywalking.apm.network.language.agent.v3.Memory;\n+import org.apache.skywalking.apm.network.language.agent.v3.MemoryPool;\n+import org.apache.skywalking.oap.server.core.CoreModule;\n+import org.apache.skywalking.oap.server.core.analysis.IDManager;\n+import org.apache.skywalking.oap.server.core.analysis.NodeType;\n+import org.apache.skywalking.oap.server.core.analysis.TimeBucket;\n+import org.apache.skywalking.oap.server.core.source.GCPhrase;\n+import org.apache.skywalking.oap.server.core.source.MemoryPoolType;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMCPU;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMGC;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMMemory;\n+import org.apache.skywalking.oap.server.core.source.ServiceInstanceJVMMemoryPool;\n+import org.apache.skywalking.oap.server.core.source.SourceReceiver;\n+import org.apache.skywalking.oap.server.library.module.ModuleManager;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * Copy from other receiver", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMzQ5MQ=="}, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjAyNzEwOnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/handler/JVMMetricsReceiveHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoxOTo0MlrOGnW9UQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjo0NDozOVrOGnXWug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMzc5Mw==", "bodyText": "All handler names should be renamed to KafkaConsumer, as this is what you are doing.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443923793", "createdAt": "2020-06-23T02:19:42Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/handler/JVMMetricsReceiveHandler.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka.provider.handler;\n+\n+import com.google.protobuf.InvalidProtocolBufferException;\n+import lombok.extern.slf4j.Slf4j;\n+import org.apache.kafka.clients.consumer.ConsumerRecord;\n+import org.apache.kafka.common.TopicPartition;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetricCollection;\n+import org.apache.skywalking.oap.server.core.CoreModule;\n+import org.apache.skywalking.oap.server.core.config.NamingLengthControl;\n+import org.apache.skywalking.oap.server.library.module.ModuleManager;\n+import org.apache.skywalking.oap.server.receiver.kafka.module.KafkaReceiverConfig;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.dispatcher.JVMSourceDispatcher;\n+\n+@Slf4j\n+public class JVMMetricsReceiveHandler implements KafkaReceiveHandler {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkzMDI5OA==", "bodyText": "OK", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443930298", "createdAt": "2020-06-23T02:44:39Z", "author": {"login": "dmsolr"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/provider/handler/JVMMetricsReceiveHandler.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka.provider.handler;\n+\n+import com.google.protobuf.InvalidProtocolBufferException;\n+import lombok.extern.slf4j.Slf4j;\n+import org.apache.kafka.clients.consumer.ConsumerRecord;\n+import org.apache.kafka.common.TopicPartition;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.network.language.agent.v3.JVMMetricCollection;\n+import org.apache.skywalking.oap.server.core.CoreModule;\n+import org.apache.skywalking.oap.server.core.config.NamingLengthControl;\n+import org.apache.skywalking.oap.server.library.module.ModuleManager;\n+import org.apache.skywalking.oap.server.receiver.kafka.module.KafkaReceiverConfig;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.dispatcher.JVMSourceDispatcher;\n+\n+@Slf4j\n+public class JVMMetricsReceiveHandler implements KafkaReceiveHandler {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMzc5Mw=="}, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2NjA0MDkwOnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/mq-receiver-common/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoyNzo0NlrOGnXFXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QwMjoyNzo0NlrOGnXFXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyNTg1Mg==", "bodyText": "What is this for? Are all MQs same? I have doubts about this. What could be reused across these?\nFrom my understanding, the MQ consumers at the OAP side are about to use MQ native client API and transport them into the source, that is alll.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r443925852", "createdAt": "2020-06-23T02:27:46Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-receiver-plugin/skywalking-mq-receiver-plugins/mq-receiver-common/pom.xml", "diffHunk": "@@ -0,0 +1,29 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>skywalking-mq-receiver-plugins</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>8.0.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>mq-receiver-common</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb758d229092c00475ecfd8754712731ece9a575"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxODU4MTAzOnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/KafkaReceiveHandlerRegister.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwODo0NjowNlrOGvHpLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwODo0NjowNlrOGvHpLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA2MTQ4Nw==", "bodyText": "This should not be a service, as no one will use this out of this module", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r452061487", "createdAt": "2020-07-09T08:46:06Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-receiver-plugin/skywalking-kafka-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/kafka/KafkaReceiveHandlerRegister.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka;\n+\n+import com.google.common.collect.ImmutableMap;\n+import com.google.common.collect.Lists;\n+import io.netty.util.concurrent.DefaultThreadFactory;\n+import java.time.Duration;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Properties;\n+import java.util.concurrent.Executors;\n+import lombok.extern.slf4j.Slf4j;\n+import org.apache.kafka.clients.consumer.ConsumerConfig;\n+import org.apache.kafka.clients.consumer.ConsumerRecord;\n+import org.apache.kafka.clients.consumer.ConsumerRecords;\n+import org.apache.kafka.clients.consumer.KafkaConsumer;\n+import org.apache.kafka.common.TopicPartition;\n+import org.apache.kafka.common.serialization.BytesDeserializer;\n+import org.apache.kafka.common.serialization.StringDeserializer;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.oap.server.library.module.Service;\n+import org.apache.skywalking.oap.server.receiver.kafka.module.KafkaReceiverConfig;\n+import org.apache.skywalking.oap.server.receiver.kafka.provider.handler.KafkaConsumerHandler;\n+\n+/**\n+ *\n+ */\n+@Slf4j\n+public class KafkaReceiveHandlerRegister implements Service, Runnable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22fd4430f31e79cc6cb993217226d157e175b022"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgyNzYzNzgzOnYy", "diffSide": "RIGHT", "path": ".github/workflows/e2e.kafka.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwMjo0NDowMFrOGwZv2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QwMjo0NDowMFrOGwZv2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQwNjY4Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              GOAgent:\n          \n          \n            \n              Kafka:", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r453406682", "createdAt": "2020-07-13T02:44:00Z", "author": {"login": "kezhenxu94"}, "path": ".github/workflows/e2e.kafka.yaml", "diffHunk": "@@ -0,0 +1,50 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+name: E2E\n+\n+on:\n+  pull_request:\n+  push:\n+    branches:\n+      - master\n+    tags:\n+      - 'v*'\n+\n+env:\n+  SKIP_TEST: true\n+  SW_AGENT_JDK_VERSION: 8\n+\n+jobs:\n+  GOAgent:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e2193c1599f8627ee0648d0046aaee038d73371"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMzM1NDMyOnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-kafka-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/kafka/provider/SourceReceiverPoint.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMTowMzozMlrOGxO1lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMTowMzozMlrOGxO1lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3NjUwMg==", "bodyText": "unused", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454276502", "createdAt": "2020-07-14T11:03:32Z", "author": {"login": "kezhenxu94"}, "path": "oap-server/server-receiver-plugin/skywalking-kafka-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/kafka/provider/SourceReceiverPoint.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.receiver.kafka.provider;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+@Retention(RetentionPolicy.RUNTIME)\n+@Target(ElementType.FIELD)\n+public @interface SourceReceiverPoint {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c50b511c029498967aea97fcf130c45948154f27"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMzQyODUyOnYy", "diffSide": "RIGHT", "path": "oap-server/server-cluster-plugin/cluster-zookeeper-plugin/src/main/java/org/apache/skywalking/oap/server/cluster/plugin/zookeeper/ZookeeperCoordinator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMToyNzoyM1rOGxPivg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMToyNzoyM1rOGxPivg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI4ODA2Mg==", "bodyText": "Do you mean conflict (instead of confirmed)?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454288062", "createdAt": "2020-07-14T11:27:23Z", "author": {"login": "kezhenxu94"}, "path": "oap-server/server-cluster-plugin/cluster-zookeeper-plugin/src/main/java/org/apache/skywalking/oap/server/cluster/plugin/zookeeper/ZookeeperCoordinator.java", "diffHunk": "@@ -78,6 +84,33 @@ public synchronized void registerRemote(RemoteInstance remoteInstance) throws Se\n         }\n     }\n \n+    @Override\n+    public synchronized RemoteInstance updateRemoteNodes(String serverId) throws Exception {\n+        ServiceInstance self = null;\n+        for (ServiceInstance<RemoteInstance> service : serviceCache.getInstances()) {\n+\n+            if (service.getPayload().getAddress().equals(selfAddress)) {\n+                self = service;\n+            } else if (StringUtil.isNotEmpty(serverId) && serverId.equals(service.getPayload().getServerId())) {\n+                throw new ServiceRegisterException(\"ServerId[\" + serverId + \"] confirmed\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c50b511c029498967aea97fcf130c45948154f27"}, "originalPosition": 71}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMzQ2NjAxOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-reporter-plugins/kafka-reporter-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaServiceManagementProducer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMTozOTowOVrOGxP5nA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMTozOTowOVrOGxP5nA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI5MzkxNg==", "bodyText": "Is this class name general enough? Seems KafkaServiceManagementService has nothing to do with ServiceManagement, a little misleading (because there is another class KafkaServiceManagementService)", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454293916", "createdAt": "2020-07-14T11:39:09Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/optional-reporter-plugins/kafka-reporter-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaServiceManagementProducer.java", "diffHunk": "@@ -0,0 +1,100 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import java.util.Arrays;\n+import java.util.Objects;\n+import java.util.Properties;\n+import java.util.Set;\n+import java.util.concurrent.ExecutionException;\n+import java.util.stream.Collectors;\n+import org.apache.kafka.clients.admin.AdminClient;\n+import org.apache.kafka.clients.admin.DescribeTopicsResult;\n+import org.apache.kafka.clients.producer.KafkaProducer;\n+import org.apache.kafka.clients.producer.ProducerConfig;\n+import org.apache.kafka.common.serialization.BytesSerializer;\n+import org.apache.kafka.common.serialization.StringSerializer;\n+import org.apache.kafka.common.utils.Bytes;\n+import org.apache.skywalking.apm.agent.core.boot.BootService;\n+import org.apache.skywalking.apm.agent.core.boot.DefaultImplementor;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+\n+/**\n+ *  Configuring, initializing and holding a KafkaProducer instance for reporters.\n+ */\n+@DefaultImplementor\n+public class KafkaServiceManagementProducer implements BootService, Runnable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c50b511c029498967aea97fcf130c45948154f27"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjY1Nzg3OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-receivers.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDo1MDozNlrOGxuLPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxODoxNVrOGxv0AQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4OTk1MQ==", "bodyText": "I suggest not to use too many different terms when you're saying the same thing\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            And we have to configure **Zookeeper** as the OAP cluster management tool.\n          \n          \n            \n            And we have to configure **Zookeeper** as the OAP cluster coordinator.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454789951", "createdAt": "2020-07-15T04:50:36Z", "author": {"login": "kezhenxu94"}, "path": "docs/en/setup/backend/backend-receivers.md", "diffHunk": "@@ -128,3 +129,20 @@ receiver-oc:\n     gRPCHost: ${SW_OC_RECEIVER_GRPC_HOST:0.0.0.0}\n     gRPCPort: ${SW_OC_RECEIVER_GRPC_PORT:55678}\n ```\n+\n+## Kafka receiver\n+\n+Kafka Receiver supports to receive `TraceSegment`, `JVMMetrics` and others of Agent reported as gRPC Receiver.\n+Currently, it has to connect to the whole topic or single partition of topic when OAP is in cluster mode.\n+And we have to configure **Zookeeper** as the OAP cluster management tool.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNjc2OQ==", "bodyText": "Why we need a Zookeeping to be OAP cluster management? Which parts of codes using the this?\nThis fetcher is only taking responsibility for itself, the coordinator is for distributed aggregation. If the user wants Zookeeper for Kafka, and another coordinator, such as k8s, for OAP, I can't see the blocks. Is this?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454816769", "createdAt": "2020-07-15T06:18:15Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-receivers.md", "diffHunk": "@@ -128,3 +129,20 @@ receiver-oc:\n     gRPCHost: ${SW_OC_RECEIVER_GRPC_HOST:0.0.0.0}\n     gRPCPort: ${SW_OC_RECEIVER_GRPC_PORT:55678}\n ```\n+\n+## Kafka receiver\n+\n+Kafka Receiver supports to receive `TraceSegment`, `JVMMetrics` and others of Agent reported as gRPC Receiver.\n+Currently, it has to connect to the whole topic or single partition of topic when OAP is in cluster mode.\n+And we have to configure **Zookeeper** as the OAP cluster management tool.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4OTk1MQ=="}, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjY1OTczOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-receivers.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDo1MTozOVrOGxuMTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDo1MTozOVrOGxuMTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc5MDIyMw==", "bodyText": "- won't active the implementation, instead, it disables the implementation", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454790223", "createdAt": "2020-07-15T04:51:39Z", "author": {"login": "kezhenxu94"}, "path": "docs/en/setup/backend/backend-receivers.md", "diffHunk": "@@ -128,3 +129,20 @@ receiver-oc:\n     gRPCHost: ${SW_OC_RECEIVER_GRPC_HOST:0.0.0.0}\n     gRPCPort: ${SW_OC_RECEIVER_GRPC_PORT:55678}\n ```\n+\n+## Kafka receiver\n+\n+Kafka Receiver supports to receive `TraceSegment`, `JVMMetrics` and others of Agent reported as gRPC Receiver.\n+Currently, it has to connect to the whole topic or single partition of topic when OAP is in cluster mode.\n+And we have to configure **Zookeeper** as the OAP cluster management tool.\n+\n+**Suggestion and recommend**, creating the Kafka topics by self before OAP Server starting. Although OAP server\n+will create these if not exist.\n+\n+To active the `default` implementation:\n+```yaml\n+receiver-kafka:\n+  selector: ${SW_RECEIVER_KAFKA:-}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjY2OTQxOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-receivers.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDo1NzowNFrOGxuSBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxMzowMFrOGxvsRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc5MTY4Nw==", "bodyText": "The doc on agent side is missing?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454791687", "createdAt": "2020-07-15T04:57:04Z", "author": {"login": "kezhenxu94"}, "path": "docs/en/setup/backend/backend-receivers.md", "diffHunk": "@@ -128,3 +129,20 @@ receiver-oc:\n     gRPCHost: ${SW_OC_RECEIVER_GRPC_HOST:0.0.0.0}\n     gRPCPort: ${SW_OC_RECEIVER_GRPC_PORT:55678}\n ```\n+\n+## Kafka receiver", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNDc4OA==", "bodyText": "Read my comment, this is not a receiver.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454814788", "createdAt": "2020-07-15T06:13:00Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-receivers.md", "diffHunk": "@@ -128,3 +129,20 @@ receiver-oc:\n     gRPCHost: ${SW_OC_RECEIVER_GRPC_HOST:0.0.0.0}\n     gRPCPort: ${SW_OC_RECEIVER_GRPC_PORT:55678}\n ```\n+\n+## Kafka receiver", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc5MTY4Nw=="}, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjgyMDA5OnYy", "diffSide": "RIGHT", "path": "dist-material/release-docs/LICENSE", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxMjoxMFrOGxvrEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxMjoxMFrOGxvrEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNDQ4Mw==", "bodyText": "Why has an empty line?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454814483", "createdAt": "2020-07-15T06:12:10Z", "author": {"login": "wu-sheng"}, "path": "dist-material/release-docs/LICENSE", "diffHunk": "@@ -380,6 +384,8 @@ The text of each license is also included at licenses/LICENSE-[project].txt.\n     proto files from gogo: https://github.com/gogo/protobuf  BSD-2\n     proto files from grpc-gateway, https://github.com/grpc-ecosystem/grpc-gateway/tree/master/protoc-gen-swagger/options BSD-3\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjgyNTYyOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-receivers.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxNDoyMVrOGxvuTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxNDoyMVrOGxvuTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNTMwOQ==", "bodyText": "Trace and JVM Metrics, please use common nouns. Don't use the class name in the codes.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454815309", "createdAt": "2020-07-15T06:14:21Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-receivers.md", "diffHunk": "@@ -128,3 +129,20 @@ receiver-oc:\n     gRPCHost: ${SW_OC_RECEIVER_GRPC_HOST:0.0.0.0}\n     gRPCPort: ${SW_OC_RECEIVER_GRPC_PORT:55678}\n ```\n+\n+## Kafka receiver\n+\n+Kafka Receiver supports to receive `TraceSegment`, `JVMMetrics` and others of Agent reported as gRPC Receiver.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjgyODY3OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-receivers.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxNToxNVrOGxvv5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxNjowOFrOGxvxPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNTcxOA==", "bodyText": "What are the topics, and what are they for? And which are the recommend commands with parameters? We need a very clear doc about this.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454815718", "createdAt": "2020-07-15T06:15:15Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-receivers.md", "diffHunk": "@@ -128,3 +129,20 @@ receiver-oc:\n     gRPCHost: ${SW_OC_RECEIVER_GRPC_HOST:0.0.0.0}\n     gRPCPort: ${SW_OC_RECEIVER_GRPC_PORT:55678}\n ```\n+\n+## Kafka receiver\n+\n+Kafka Receiver supports to receive `TraceSegment`, `JVMMetrics` and others of Agent reported as gRPC Receiver.\n+Currently, it has to connect to the whole topic or single partition of topic when OAP is in cluster mode.\n+And we have to configure **Zookeeper** as the OAP cluster management tool.\n+\n+**Suggestion and recommend**, creating the Kafka topics by self before OAP Server starting. Although OAP server", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNjA2MQ==", "bodyText": "Suggestion and recommend are not the same. Please make this part clear. Also, you have codes to create topic automatically, what they are going to do, also should be declared clearly here.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454816061", "createdAt": "2020-07-15T06:16:08Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-receivers.md", "diffHunk": "@@ -128,3 +129,20 @@ receiver-oc:\n     gRPCHost: ${SW_OC_RECEIVER_GRPC_HOST:0.0.0.0}\n     gRPCPort: ${SW_OC_RECEIVER_GRPC_PORT:55678}\n ```\n+\n+## Kafka receiver\n+\n+Kafka Receiver supports to receive `TraceSegment`, `JVMMetrics` and others of Agent reported as gRPC Receiver.\n+Currently, it has to connect to the whole topic or single partition of topic when OAP is in cluster mode.\n+And we have to configure **Zookeeper** as the OAP cluster management tool.\n+\n+**Suggestion and recommend**, creating the Kafka topics by self before OAP Server starting. Although OAP server", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNTcxOA=="}, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjgzMTkzOnYy", "diffSide": "RIGHT", "path": "oap-server/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxNjoyOVrOGxvxsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxNjoyOVrOGxvxsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNjE3OQ==", "bodyText": "Why an empty line?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454816179", "createdAt": "2020-07-15T06:16:29Z", "author": {"login": "wu-sheng"}, "path": "oap-server/pom.xml", "diffHunk": "@@ -94,6 +94,8 @@\n         <zookeeper.image.version>3.5</zookeeper.image.version>\n         <protobuf-java-util.version>3.11.4</protobuf-java-util.version>\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjgzNzk2OnYy", "diffSide": "RIGHT", "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/cluster/ClusterNodeUpdate.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxOToxN1rOGxv1WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoxOToxN1rOGxv1WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNzExMg==", "bodyText": "I don't this is the right design, as commented above.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454817112", "createdAt": "2020-07-15T06:19:17Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/cluster/ClusterNodeUpdate.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.core.cluster;\n+\n+import org.apache.skywalking.oap.server.library.module.Service;\n+\n+public interface ClusterNodeUpdate extends Service {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjg1MTUxOnYy", "diffSide": "RIGHT", "path": "oap-server/server-receiver-plugin/skywalking-kafka-receiver-plugin/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoyNDozOFrOGxv9NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjoyNDozOFrOGxv9NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxOTEyNQ==", "bodyText": "Why do you depend on this? I think you should refactor the structure of the code, to separate the trace/JVM analysis codes in a separate module. Then the receiver and Kafka fetcher depend on it both.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r454819125", "createdAt": "2020-07-15T06:24:38Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-receiver-plugin/skywalking-kafka-receiver-plugin/pom.xml", "diffHunk": "@@ -0,0 +1,56 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>server-receiver-plugin</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>8.1.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>skywalking-kafka-receiver-plugin</artifactId>\n+    <packaging>jar</packaging>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>skywalking-trace-receiver-plugin</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eed50986db7c82ea5055055fe8c4e709f87906a5"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2OTQ1NjEzOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-reporter-plugins/kafka-reporter-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaContextManagerExtendService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QyMzo0MjowMFrOG2fKBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QyMzo0MjowMFrOG2fKBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc4Njc1Ng==", "bodyText": "Why do this? Your context manager should be controlled by kafka connectivity. Is that possible?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r459786756", "createdAt": "2020-07-23T23:42:00Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/optional-reporter-plugins/kafka-reporter-plugin/src/main/java/org/apache/skywalking/apm/agent/core/kafka/KafkaContextManagerExtendService.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.kafka;\n+\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.context.ContextManagerExtendService;\n+import org.apache.skywalking.apm.agent.core.remote.GRPCChannelStatus;\n+\n+/**\n+ * For compatible with {@link ContextManagerExtendService}, don't need to manage connection status by self.\n+ */\n+@OverrideImplementor(ContextManagerExtendService.class)\n+public class KafkaContextManagerExtendService extends ContextManagerExtendService {\n+\n+    @Override\n+    public void prepare() {\n+        statusChanged(GRPCChannelStatus.CONNECTED);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59d20a57c10c7b234e960aa8dfe1bf2f55bdb8e7"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDQzMzc2OnYy", "diffSide": "RIGHT", "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/cluster/RemoteInstance.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwODo0ODo0MVrOG2nyfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwODo0ODo0MVrOG2nyfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkyODE5MA==", "bodyText": "What is this for?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r459928190", "createdAt": "2020-07-24T08:48:41Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/cluster/RemoteInstance.java", "diffHunk": "@@ -26,8 +26,15 @@\n \n     private final Address address;\n \n+    private final String serverId;\n+\n     public RemoteInstance(Address address) {\n+        this(address, null);\n+    }\n+\n+    public RemoteInstance(Address address, String serverId) {\n         this.address = address;\n+        this.serverId = serverId;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c579a080b2c34394e84e2b0083fca14d944fc2c9"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDY3NjI3OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/config/agent.config", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMzo0NzowM1rOG3Mg-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMzo0NzowM1rOG3Mg-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUyOTkxMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}\n          \n          \n            \n            # plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460529912", "createdAt": "2020-07-26T13:47:03Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/config/agent.config", "diffHunk": "@@ -87,3 +87,6 @@ logging.level=${SW_LOGGING_LEVEL:INFO}\n \n # mysql plugin configuration\n # plugin.mysql.trace_sql_parameters=${SW_MYSQL_TRACE_SQL_PARAMETERS:false}\n+\n+# Kafka producer configuration\n+plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02353972f4d5879c4be8e227bbf43df898ecbe3c"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDY4MTgyOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMzo1NDowMVrOG3MjsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMzo1NDowMVrOG3MjsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMDYwOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Kafka Fetcher will pull message from Kafka Broker(s) what is the Agent delivered(Currently, we only support Java Agent.) They include JVM Metrics data, Tracing Segment, and Service/Instance properties. Of course, we can also consume and process these data in other applications. Kafka Fetcher can work with GRPC Receiver at same time. It contains JVM-Receiver, Trace-Receiver etc.\n          \n          \n            \n            Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically JTracing Segment, Service/Instance properties, and VM Metrics data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460530608", "createdAt": "2020-07-26T13:54:01Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,44 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher will pull message from Kafka Broker(s) what is the Agent delivered(Currently, we only support Java Agent.) They include JVM Metrics data, Tracing Segment, and Service/Instance properties. Of course, we can also consume and process these data in other applications. Kafka Fetcher can work with GRPC Receiver at same time. It contains JVM-Receiver, Trace-Receiver etc.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02353972f4d5879c4be8e227bbf43df898ecbe3c"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDY4MjU4OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMzo1NDo0NlrOG3MkEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMzo1NDo0NlrOG3MkEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMDcwNQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            We have to create following topics of Kafka which are named `skywalking-segments`, `skywalking-metrics`, `skywalking-profile` and `skywalking-managements`, for `kafka-fetcher`.\n          \n          \n            \n            `skywalking-segments`, `skywalking-metrics`, `skywalking-profile`, and `skywalking-managements` are required by `kafka-fetcher`.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460530705", "createdAt": "2020-07-26T13:54:46Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,44 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher will pull message from Kafka Broker(s) what is the Agent delivered(Currently, we only support Java Agent.) They include JVM Metrics data, Tracing Segment, and Service/Instance properties. Of course, we can also consume and process these data in other applications. Kafka Fetcher can work with GRPC Receiver at same time. It contains JVM-Receiver, Trace-Receiver etc.\n+\n+Kafka Fetcher is disabled in default, and we configure as following to enable.\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+```\n+\n+We have to create following topics of Kafka which are named `skywalking-segments`, `skywalking-metrics`, `skywalking-profile` and `skywalking-managements`, for `kafka-fetcher`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02353972f4d5879c4be8e227bbf43df898ecbe3c"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDY4MzkzOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMzo1NjowMFrOG3Mksg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMzo1NjowMFrOG3Mksg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMDg2Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If the OAP server automatically creates topics, you can also modify the number of partitions and replications of the topic created by default through the following configuration:\n          \n          \n            \n            Why using the OAP server automatical creation mechanism, you could modify the number of partitions and replications of the topics through the following configurations:", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460530866", "createdAt": "2020-07-26T13:56:00Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,44 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher will pull message from Kafka Broker(s) what is the Agent delivered(Currently, we only support Java Agent.) They include JVM Metrics data, Tracing Segment, and Service/Instance properties. Of course, we can also consume and process these data in other applications. Kafka Fetcher can work with GRPC Receiver at same time. It contains JVM-Receiver, Trace-Receiver etc.\n+\n+Kafka Fetcher is disabled in default, and we configure as following to enable.\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+```\n+\n+We have to create following topics of Kafka which are named `skywalking-segments`, `skywalking-metrics`, `skywalking-profile` and `skywalking-managements`, for `kafka-fetcher`.\n+If they are not exist, Kafka Fetcher will create them in default. Also, you can create them by self before OAP server started.\n+\n+If the OAP server automatically creates topics, you can also modify the number of partitions and replications of the topic created by default through the following configuration:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02353972f4d5879c4be8e227bbf43df898ecbe3c"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDY5NTE3OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/service-agent/java-agent/How-to-enable-kafka-reporter.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNDowOTowNlrOG3MqPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNDowOTowNlrOG3MqPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUzMjI4Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The Kafka reporter plugin support to report Tracing, JVM Metric data, Instance Properties, and Profiling to Kafka Broker, which is disabled in default. We move the jar of the plugin from `optional-reporter-plugins` to `reporter-plugins` for activating.\n          \n          \n            \n            The Kafka reporter plugin support report traces, JVM metrics, Instance Properties, and profiled snapshots to Kafka cluster, which is disabled in default. Move the jar of the plugin from `optional-reporter-plugins` to `reporter-plugins` for activating.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460532287", "createdAt": "2020-07-26T14:09:06Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/How-to-enable-kafka-reporter.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# How to enable Kafka Reporter\n+\n+The Kafka reporter plugin support to report Tracing, JVM Metric data, Instance Properties, and Profiling to Kafka Broker, which is disabled in default. We move the jar of the plugin from `optional-reporter-plugins` to `reporter-plugins` for activating.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02353972f4d5879c4be8e227bbf43df898ecbe3c"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NTE3MTA3OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMDowMTo0NFrOG3QNkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMDowMTo0NFrOG3QNkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU5MDQ4MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically JTracing Segment, Service/Instance properties, and VM Metrics data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.\n          \n          \n            \n            Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically Trace Segments, Service/Instance properties, JVM Metrics, and Meter system data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460590480", "createdAt": "2020-07-27T00:01:44Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,43 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically JTracing Segment, Service/Instance properties, and VM Metrics data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "500059130ed01a671f57241f2402c472aa15cb8d"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NTE3MjI1OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMDowMzoxM1rOG3QOMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMDowMzoxM1rOG3QOMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU5MDY0MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            `skywalking-segments`, `skywalking-metrics`, `skywalking-profile`, and `skywalking-managements` are required by `kafka-fetcher`.\n          \n          \n            \n            `skywalking-segments`, `skywalking-metrics`, `skywalking-profile`, `skywalking-managements`, and `skywalking-meters` topics are required by `kafka-fetcher`.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460590641", "createdAt": "2020-07-27T00:03:13Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,43 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically JTracing Segment, Service/Instance properties, and VM Metrics data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.\n+\n+Kafka Fetcher is disabled in default, and we configure as following to enable.\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+```\n+\n+`skywalking-segments`, `skywalking-metrics`, `skywalking-profile`, and `skywalking-managements` are required by `kafka-fetcher`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "500059130ed01a671f57241f2402c472aa15cb8d"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NTE3MjcxOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMDowMzo0MVrOG3QObw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMDowMzo0MVrOG3QObw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU5MDcwMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If they are not exist, Kafka Fetcher will create them in default. Also, you can create them by self before OAP server started.\n          \n          \n            \n            If they do not exist, Kafka Fetcher will create them in default. Also, you can create them by yourself before the OAP server started.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460590703", "createdAt": "2020-07-27T00:03:41Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,43 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically JTracing Segment, Service/Instance properties, and VM Metrics data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.\n+\n+Kafka Fetcher is disabled in default, and we configure as following to enable.\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+```\n+\n+`skywalking-segments`, `skywalking-metrics`, `skywalking-profile`, and `skywalking-managements` are required by `kafka-fetcher`.\n+If they are not exist, Kafka Fetcher will create them in default. Also, you can create them by self before OAP server started.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "500059130ed01a671f57241f2402c472aa15cb8d"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NTE3MjkyOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMDowMzo1OFrOG3QOiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMDowMzo1OFrOG3QOiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU5MDcyOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Why using the OAP server automatical creation mechanism, you could modify the number of partitions and replications of the topics through the following configurations:\n          \n          \n            \n            When using the OAP server automatical creation mechanism, you could modify the number of partitions and replications of the topics through the following configurations:", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460590728", "createdAt": "2020-07-27T00:03:58Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,43 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically JTracing Segment, Service/Instance properties, and VM Metrics data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.\n+\n+Kafka Fetcher is disabled in default, and we configure as following to enable.\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+```\n+\n+`skywalking-segments`, `skywalking-metrics`, `skywalking-profile`, and `skywalking-managements` are required by `kafka-fetcher`.\n+If they are not exist, Kafka Fetcher will create them in default. Also, you can create them by self before OAP server started.\n+\n+Why using the OAP server automatical creation mechanism, you could modify the number of partitions and replications of the topics through the following configurations:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "500059130ed01a671f57241f2402c472aa15cb8d"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjA1NDU3OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/configuration-vocabulary.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODoxNDoyNVrOG3YGmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODoxNDoyNVrOG3YGmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxOTc3MA==", "bodyText": "This should be removed, right?", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460719770", "createdAt": "2020-07-27T08:14:25Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/configuration-vocabulary.md", "diffHunk": "@@ -170,6 +170,18 @@ core|default|role|Option values, `Mixed/Receiver/Aggregator`. **Receiver** mode\n | - | - | maxMessageSize | Sets the maximum message size allowed to be received on the server. Empty means 4 MiB | - | 4M(based on Netty) |\n | prometheus-fetcher | default | Read [fetcher doc](backend-fetcher.md) for more details | - | - |\n | - | - | active | Activate the Prometheus fetcher. | SW_PROMETHEUS_FETCHER_ACTIVE | false |\n+| kafka-fetcher | default | Read [fetcher doc](backend-fetcher.md) for more details | - | - |\n+| - | - | bootstrapServers | A list of host/port pairs to use for establishing the initial connection to the Kafka cluster. | SW_KAFKA_FETCHER_SERVERS | localhost:9092 |\n+| - | - | groupId | A unique string that identifies the consumer group this consumer belongs to.| - | skywalking-consumer |\n+| - | - | serverId | It equals to PartitionId if isSharding is true. | - | -1 |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95fc220b17d4dd79ff879c5a2665e3e27a0d5d1"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjA1ODI4OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODoxNToyNlrOG3YIxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODoxNToyNlrOG3YIxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcyMDMyNw==", "bodyText": "I think we should highlight partitions value here, but with -1 as default value.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460720327", "createdAt": "2020-07-27T08:15:26Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,43 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically Tracing Segments, Service/Instance properties, JVM Metrics, and Meter system data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.\n+\n+Kafka Fetcher is disabled in default, and we configure as following to enable.\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+```\n+\n+`skywalking-segments`, `skywalking-metrics`, `skywalking-profile`, `skywalking-managements` and `skywalking-meters` topics are required by `kafka-fetcher`.\n+If they do not exist, Kafka Fetcher will create them in default. Also, you can create them by yourself before the OAP server started.\n+\n+When using the OAP server automatical creation mechanism, you could modify the number of partitions and replications of the topics through the following configurations:\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+    partitions: 1\n+    replicationFactor: 1\n+```\n+\n+In the cluster mode, it should be noted that the number of topic partitions is the same as that of OAP servers. In other words, each OAP can only subscribe the specified partition. Therefore, the 'serverId' must be configured to specify which partition to consume.\n+\n+Kafka Fetcher allows to configure all the Kafka producers listed [here](http://kafka.apache.org/24/documentation.html#consumerconfigs) in property `kafkaConsumerConfig`. Such as:\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+    kafkaConsumerConfig:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95fc220b17d4dd79ff879c5a2665e3e27a0d5d1"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjA2MDI1OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-fetcher.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODoxNjowMFrOG3YJ-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODoxNjowMFrOG3YJ-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcyMDYzMw==", "bodyText": "I think we should highlight partitions value here, but with -1 as default value.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r460720633", "createdAt": "2020-07-27T08:16:00Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -85,3 +85,43 @@ that adds the procedure from raw data to minute rate.\n \n When you specify `avgHistogram` and `avgHistogramPercentile`, the source should be the type of `histogram`. A counterFunction\n is also needed due to the `bucket`, `sum` and `count` of histogram are counters.\n+\n+## Kafka Fetcher\n+\n+Kafka Fetcher pulls messages from Kafka Broker(s) what is the Agent delivered. Check the agent documentation about the details. Typically Tracing Segments, Service/Instance properties, JVM Metrics, and Meter system data are supported.  Kafka Fetcher can work with gRPC/HTTP Receivers at the same time for adopting different transport protocols.\n+\n+Kafka Fetcher is disabled in default, and we configure as following to enable.\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+```\n+\n+`skywalking-segments`, `skywalking-metrics`, `skywalking-profile`, `skywalking-managements` and `skywalking-meters` topics are required by `kafka-fetcher`.\n+If they do not exist, Kafka Fetcher will create them in default. Also, you can create them by yourself before the OAP server started.\n+\n+When using the OAP server automatical creation mechanism, you could modify the number of partitions and replications of the topics through the following configurations:\n+\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}\n+    partitions: 1\n+    replicationFactor: 1\n+```\n+\n+In the cluster mode, it should be noted that the number of topic partitions is the same as that of OAP servers. In other words, each OAP can only subscribe the specified partition. Therefore, the 'serverId' must be configured to specify which partition to consume.\n+\n+Kafka Fetcher allows to configure all the Kafka producers listed [here](http://kafka.apache.org/24/documentation.html#consumerconfigs) in property `kafkaConsumerConfig`. Such as:\n+```yaml\n+kafka-fetcher:\n+  selector: ${SW_KAFKA_FETCHER:default}\n+  default:\n+    bootstrapServers: ${SW_KAFKA_FETCHER_SERVERS:localhost:9092}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b95fc220b17d4dd79ff879c5a2665e3e27a0d5d1"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MDkwOTg5OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/service-agent/java-agent/How-to-enable-kafka-reporter.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMDoxMDoxNVrOG4F7-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMDoxMDoxNVrOG4F7-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ3MDcxNQ==", "bodyText": "This doc has not been linked from java-agent/README.md. It should be a separate section after ## Advanced Features\n## Advanced Reporters\n* Use Kafka to transport the traces, JVM metrics, instance properties, and profiled snapshots to the backend. Read the [doc](How-to-enable-kafka-reporter.md) for more details.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r461470715", "createdAt": "2020-07-28T10:10:15Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/How-to-enable-kafka-reporter.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# How to enable Kafka Reporter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "021d6b342278019f38aea3df1b0141f6eb6ca24b"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MDkxODQwOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/service-agent/java-agent/How-to-enable-kafka-reporter.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMDoxMjoyN1rOG4GBEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxMDoxMjoyN1rOG4GBEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ3MjAxOA==", "bodyText": "After this, you should add.\nAfter you activated the Kafka reporter, you need to open [Kafka fetcher] (link to the fetcher doc) at the OAP side.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r461472018", "createdAt": "2020-07-28T10:12:27Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/How-to-enable-kafka-reporter.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# How to enable Kafka Reporter\n+\n+The Kafka reporter plugin support report traces, JVM metrics, Instance Properties, and profiled snapshots to Kafka cluster, which is disabled in default. Move the jar of the plugin from `optional-reporter-plugins` to `reporter-plugins` for activating.\n+\n+Notice, currently, the agent still needs to configure GRPC receiver for delivering the task of profiling. In other words, the following configure cannot be omitted.\n+\n+```properties\n+# Backend service addresses.\n+collector.backend_service=${SW_AGENT_COLLECTOR_BACKEND_SERVICES:127.0.0.1:11800}\n+\n+# Kafka producer configuration\n+plugin.kafka.bootstrap_servers=${SW_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}\n+plugin.kafka.consumer_config[delivery.timeout.ms]=12000\n+```\n+\n+Kafka reporter plugin support to customize all configurations of listed in [here](http://kafka.apache.org/24/documentation.html#producerconfigs).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "021d6b342278019f38aea3df1b0141f6eb6ca24b"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4ODQ3Mzc1OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/service-agent/java-agent/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMzo0NDoyOFrOG5OBcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQyMzo0NDoyOFrOG5OBcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjY1MTc2MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * Use Kafka to transport the traces, JVM metrics, instance properties, and profiled snapshots to the backend. Read the [How to enable Kafka Reporter](How-to-enable-kafka-reporter.md) for more details.\n          \n          \n            \n            \n          \n          \n            \n            ## Advanced Reporters\n          \n          \n            \n            The advanced report provides an alternative way to submit the agent collected data to the backend. All of them are in the `optional-reporter-plugins` folder, move the one you needed into the `reporter-plugins` folder for the activation. **Notice, don't try to activate multiple reporters, that could cause unexpected fatal errors.**\n          \n          \n            \n            \n          \n          \n            \n            * Use Kafka to transport the traces, JVM metrics, instance properties, and profiled snapshots to the backend. Read the [How to enable Kafka Reporter](How-to-enable-kafka-reporter.md) for more details.", "url": "https://github.com/apache/skywalking/pull/4847#discussion_r462651760", "createdAt": "2020-07-29T23:44:28Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/README.md", "diffHunk": "@@ -172,6 +174,7 @@ Now, we have the following known bootstrap plugins.\n     * If you want to forward MicroMeter/Spring Sleuth metrics to Meter System, use [SkyWalking MicroMeter Register](Application-toolkit-micrometer.md).\n     * If you want to use OpenTracing Java APIs, try [SkyWalking OpenTracing compatible tracer](Opentracing.md). More details you could find at http://opentracing.io\n * If you want to specify the path of your agent.config file. Read [set config file through system properties](Specified-agent-config.md)\n+* Use Kafka to transport the traces, JVM metrics, instance properties, and profiled snapshots to the backend. Read the [How to enable Kafka Reporter](How-to-enable-kafka-reporter.md) for more details.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f8bfff27b7b3e7378d2b12ee6f038e1fabace18"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 186, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}