{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMTE3NjEw", "number": 5851, "title": "Support group in the service traffic and service list query.", "bodyText": "If this pull request closes/resolves/fixes an existing issue, replace the issue number. Closes #5841. Related to #5835\n Update the CHANGES log.\n\nThis feature doc is as below. @hanahmily need to\n\nAdjust #5835 to adopt this as the lastest naming rule.\nUpdate UI's template page. Service Filter should be renamed to Service Group(including the Chinese version)\nUpdate the self-observability dashboard configuration(maybe codes too).\n\nService Auto Grouping\nSkyWalking supports various default and customized dashboard templates.\nEach template provides the reasonable layout for the services in the particular field.\nSuch as, services with a language agent installed\ncould have different metrics with service detected by the service mesh observability solution,\nand different with SkyWalking's self-observability metrics dashboard.\nTherefore, since 8.3.0, SkyWalking OAP would generate the group based on this simple naming format.\n${service name} = [${group name}:]${logic name}\nOnce the service name includes :(colon), the literal string before the colon would be considered as the group name.\nIn the latest GraphQL query, the group name has been provided as an option parameter.\n\ngetAllServices(duration: Duration!, group: String): [Service!]!\n\nRocketBot UI dashboards(Standard type) support the group name for default and custom configurations.\n\nFYI @hailin0 I think you need to consider this in your DolphinScheduler integration. I am not sure whether you would use a new dashboard for the DolphinScheduler Dashboard.", "createdAt": "2020-11-17T03:43:18Z", "url": "https://github.com/apache/skywalking/pull/5851", "merged": true, "mergeCommit": {"oid": "c9202af1ee4f48acaa20814788da8b224bfcfe0d"}, "closed": true, "closedAt": "2020-11-17T14:45:33Z", "author": {"login": "wu-sheng"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddRFAzAH2gAyNTIyMTE3NjEwOjkxMzJmNzUxMTc1MWM2ZjgxMTZjMTBjYzc2MjBlZDQ3NjNkNDlkYjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddaaqzAFqTUzMjQxNjAzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9132f7511751c6f8116c10cc7620ed4763d49db7", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/9132f7511751c6f8116c10cc7620ed4763d49db7", "committedDate": "2020-11-17T03:34:54Z", "message": "Support group in the service traffic and service list query."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f94cfc1d0af58f3f932b0a17cc716302fa750812", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/f94cfc1d0af58f3f932b0a17cc716302fa750812", "committedDate": "2020-11-17T03:37:42Z", "message": "Update changelog."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMDAxNjc2", "url": "https://github.com/apache/skywalking/pull/5851#pullrequestreview-532001676", "createdAt": "2020-11-17T03:46:39Z", "commit": {"oid": "f94cfc1d0af58f3f932b0a17cc716302fa750812"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwMzo0NjozOVrOH0jTWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwMzo0NjozOVrOH0jTWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg2NjM5Mg==", "bodyText": "Why not double \":\", typo?", "url": "https://github.com/apache/skywalking/pull/5851#discussion_r524866392", "createdAt": "2020-11-17T03:46:39Z", "author": {"login": "hanahmily"}, "path": "docs/en/setup/backend/service-auto-grouping.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# Service Auto Grouping\n+SkyWalking supports various default and customized dashboard templates. \n+Each template provides the reasonable layout for the services in the particular field. \n+Such as, services with a language agent installed \n+could have different metrics with service detected by the service mesh observability solution, \n+and different with SkyWalking's self-observability metrics dashboard.\n+\n+Therefore, since 8.3.0, SkyWalking OAP would generate the group based on this simple naming format.\n+\n+### ${service name} = [${group name}:]${logic name}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f94cfc1d0af58f3f932b0a17cc716302fa750812"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bca78311c48e6515cf95f0c0e62514c82b3680f1", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/bca78311c48e6515cf95f0c0e62514c82b3680f1", "committedDate": "2020-11-17T03:52:31Z", "message": "Fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMDAyODYy", "url": "https://github.com/apache/skywalking/pull/5851#pullrequestreview-532002862", "createdAt": "2020-11-17T03:50:57Z", "commit": {"oid": "f94cfc1d0af58f3f932b0a17cc716302fa750812"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwMzo1MDo1OFrOH0jXkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwMzo1MDo1OFrOH0jXkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg2NzQ3Mw==", "bodyText": "\"..\" on the end", "url": "https://github.com/apache/skywalking/pull/5851#discussion_r524867473", "createdAt": "2020-11-17T03:50:58Z", "author": {"login": "dmsolr"}, "path": "docs/en/setup/backend/backend-setup.md", "diffHunk": "@@ -108,6 +108,7 @@ or 3rd party configuration management system.\n 1. [Uninstrumented Gateways](uninstrumented-gateways.md). Configure gateways/proxies that are not supported by SkyWalking agent plugins,\n to reflect the delegation in topology graph.\n 1. [Apdex threshold](apdex-threshold.md). Configure the thresholds for different services if Apdex calculation is activated in the OAL.\n+1. [Service Grouping](service-auto-grouping.md). An automatic grouping mechanism for all services based on name..", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f94cfc1d0af58f3f932b0a17cc716302fa750812"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbf13426468eec36464133632a1a3d2768630bba", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/bbf13426468eec36464133632a1a3d2768630bba", "committedDate": "2020-11-17T03:56:19Z", "message": "Fix a format issue."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMDI3MTE4", "url": "https://github.com/apache/skywalking/pull/5851#pullrequestreview-532027118", "createdAt": "2020-11-17T05:14:39Z", "commit": {"oid": "bbf13426468eec36464133632a1a3d2768630bba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNToxNDozOVrOH0krgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNToxNDozOVrOH0krgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg4ODk2Mg==", "bodyText": "need to keep group as a service name prefix?", "url": "https://github.com/apache/skywalking/pull/5851#discussion_r524888962", "createdAt": "2020-11-17T05:14:39Z", "author": {"login": "hailin0"}, "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/analysis/manual/service/ServiceTraffic.java", "diffHunk": "@@ -93,14 +101,23 @@ public ServiceTraffic map2Data(final Map<String, Object> dbMap) {\n             ServiceTraffic serviceTraffic = new ServiceTraffic();\n             serviceTraffic.setName((String) dbMap.get(NAME));\n             serviceTraffic.setNodeType(NodeType.valueOf(((Number) dbMap.get(NODE_TYPE)).intValue()));\n+            serviceTraffic.setGroup((String) dbMap.get(GROUP));\n             return serviceTraffic;\n         }\n \n         @Override\n         public Map<String, Object> data2Map(final ServiceTraffic storageData) {\n+            final String serviceName = storageData.getName();\n+            if (NodeType.Normal.equals(storageData.getNodeType())) {\n+                int groupIdx = serviceName.indexOf(DOUBLE_COLONS_SPLIT);\n+                if (groupIdx > 0) {\n+                    storageData.setGroup(serviceName.substring(0, groupIdx));\n+                }\n+            }\n             Map<String, Object> map = new HashMap<>();\n-            map.put(NAME, storageData.getName());\n+            map.put(NAME, serviceName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbf13426468eec36464133632a1a3d2768630bba"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ed34de5b6c2aa9906c9507d1f1aa09504995c56", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/6ed34de5b6c2aa9906c9507d1f1aa09504995c56", "committedDate": "2020-11-17T06:35:55Z", "message": "Add group in the service query. Fix the keyword issue in the storage."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c0ad45f8f9c110d8e75deca8f8204c3d0a03c4f", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/2c0ad45f8f9c110d8e75deca8f8204c3d0a03c4f", "committedDate": "2020-11-17T06:36:12Z", "message": "no message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMDg0MTc5", "url": "https://github.com/apache/skywalking/pull/5851#pullrequestreview-532084179", "createdAt": "2020-11-17T07:36:06Z", "commit": {"oid": "2c0ad45f8f9c110d8e75deca8f8204c3d0a03c4f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNzozNjowNlrOH0nldQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwNzozNjowNlrOH0nldQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDkzNjU2NQ==", "bodyText": "TagName.GROUP", "url": "https://github.com/apache/skywalking/pull/5851#discussion_r524936565", "createdAt": "2020-11-17T07:36:06Z", "author": {"login": "dmsolr"}, "path": "oap-server/server-storage-plugin/storage-influxdb-plugin/src/main/java/org/apache/skywalking/oap/server/storage/plugin/influxdb/TableMetaInfo.java", "diffHunk": "@@ -62,8 +62,9 @@ public static void addModel(Model model) {\n                 || EndpointTraffic.INDEX_NAME.equals(model.getName())) {\n                 storageAndTagMap.put(EndpointTraffic.SERVICE_ID, InfluxConstants.TagName.SERVICE_ID);\n             } else {\n-                // service_traffic  name, node_type\n+                // service_traffic  name, node_type, group\n                 storageAndTagMap.put(ServiceTraffic.NODE_TYPE, InfluxConstants.TagName.NODE_TYPE);\n+                storageAndTagMap.put(ServiceTraffic.GROUP, InfluxConstants.TagName.NODE_TYPE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c0ad45f8f9c110d8e75deca8f8204c3d0a03c4f"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07c15ee4a0b652bcc7ec2605cc81b939d849ef19", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/07c15ee4a0b652bcc7ec2605cc81b939d849ef19", "committedDate": "2020-11-17T07:38:32Z", "message": "Fix."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "261e7078c5f384961d572d8435cb60de0a28a64d", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/261e7078c5f384961d572d8435cb60de0a28a64d", "committedDate": "2020-11-17T07:40:19Z", "message": "FIX."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMTE2NzU4", "url": "https://github.com/apache/skywalking/pull/5851#pullrequestreview-532116758", "createdAt": "2020-11-17T08:20:49Z", "commit": {"oid": "261e7078c5f384961d572d8435cb60de0a28a64d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMTE3ODk5", "url": "https://github.com/apache/skywalking/pull/5851#pullrequestreview-532117899", "createdAt": "2020-11-17T08:22:24Z", "commit": {"oid": "261e7078c5f384961d572d8435cb60de0a28a64d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d00bcd6a5701bfdf0e9b8ee79b426df643ef6617", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/d00bcd6a5701bfdf0e9b8ee79b426df643ef6617", "committedDate": "2020-11-17T12:50:09Z", "message": "Fix MetadataQuery issue."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f71df9bd5e7123dd0b84596ced6acfd15f3cdb7d", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/f71df9bd5e7123dd0b84596ced6acfd15f3cdb7d", "committedDate": "2020-11-17T12:54:16Z", "message": "Fix searchEndpoint."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6d267ed66baa280c1cb3352391c6d70e3a14b1a", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/b6d267ed66baa280c1cb3352391c6d70e3a14b1a", "committedDate": "2020-11-17T13:23:22Z", "message": "Fix.missing parameter."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNDE2MDMw", "url": "https://github.com/apache/skywalking/pull/5851#pullrequestreview-532416030", "createdAt": "2020-11-17T14:27:42Z", "commit": {"oid": "b6d267ed66baa280c1cb3352391c6d70e3a14b1a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1655, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}