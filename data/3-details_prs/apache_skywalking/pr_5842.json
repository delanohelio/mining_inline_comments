{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwOTY1MjIz", "number": 5842, "title": "Add the plugin for mssql-jtds 1.x plugin.", "bodyText": "Add an agent plugin to support mssql-jtds 1.x\n\n Add a test case for the new plugin, refer to the doc\n Add a component id in the component-libraries.yml\n Add a logo in the UI repo\n\nFix #2340, add an agent plugin to support mssql-jtds 1.x, like", "createdAt": "2020-11-14T05:49:31Z", "url": "https://github.com/apache/skywalking/pull/5842", "merged": true, "mergeCommit": {"oid": "7220643cbfef5045e2ba2cbe1719fe7f23f0c6b4"}, "closed": true, "closedAt": "2020-11-16T00:30:26Z", "author": {"login": "zifeihan"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcVLeHgH2gAyNTIwOTY1MjIzOjM5ODA2MjQ5NTFiNmEzYjAxMThhZGU2ZTgwNWU2NmIwYWI3MzcxOTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcv5R2gFqTUzMDc5NjA5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3980624951b6a3b0118ade6e805e66b0ab737191", "author": {"user": {"login": "zifeihan", "name": "zifeihan"}}, "url": "https://github.com/apache/skywalking/commit/3980624951b6a3b0118ade6e805e66b0ab737191", "committedDate": "2020-11-14T05:47:39Z", "message": "Add the plugin for mssql-jtds 1.x plugin."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f1b07f972de29d9a3de7095dee1d0774a84cf3a", "author": {"user": {"login": "zifeihan", "name": "zifeihan"}}, "url": "https://github.com/apache/skywalking/commit/7f1b07f972de29d9a3de7095dee1d0774a84cf3a", "committedDate": "2020-11-14T06:17:52Z", "message": "Polishing."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152", "author": {"user": {"login": "zifeihan", "name": "zifeihan"}}, "url": "https://github.com/apache/skywalking/commit/fe1c1eeef19acc3cb4d2977ae99823d93a08e152", "committedDate": "2020-11-14T07:48:51Z", "message": "Polishing."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNzYzMDM3", "url": "https://github.com/apache/skywalking/pull/5842#pullrequestreview-530763037", "createdAt": "2020-11-15T03:07:30Z", "commit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwMzowNzozMFrOHza6oA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwMzowNzozMFrOHza6oA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzY4MDQxNg==", "bodyText": "Duplicated?", "url": "https://github.com/apache/skywalking/pull/5842#discussion_r523680416", "createdAt": "2020-11-15T03:07:30Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/Plugin-list.md", "diffHunk": "@@ -109,3 +109,5 @@\n - vertx-core-3.x\n - xxl-job-2.x\n - zookeeper-3.4.x\n+- zookeeper-3.4.x", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNzYyNTQ3", "url": "https://github.com/apache/skywalking/pull/5842#pullrequestreview-530762547", "createdAt": "2020-11-15T02:53:05Z", "commit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwMjo1NDozMVrOHzaZIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwMjo1NDozMVrOHzaZIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzY3MTg0MA==", "bodyText": "Should be provided scope", "url": "https://github.com/apache/skywalking/pull/5842#discussion_r523671840", "createdAt": "2020-11-15T02:54:31Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-sdk-plugin/mssql-jtds-1.x-plugin/pom.xml", "diffHunk": "@@ -0,0 +1,51 @@\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>apm-sdk-plugin</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>8.3.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>apm-mssql-jtds-1.x-plugin</artifactId>\n+    <packaging>jar</packaging>\n+\n+    <name>mssql-jtds-1.x-plugin</name>\n+    <url>http://maven.apache.org</url>\n+\n+    <properties>\n+        <mssql-jtds.version>1.2.6</mssql-jtds.version>\n+    </properties>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.skywalking</groupId>\n+            <artifactId>apm-jdbc-commons</artifactId>\n+            <version>${project.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+\n+        <dependency>\n+            <groupId>net.sourceforge.jtds</groupId>\n+            <artifactId>jtds</artifactId>\n+            <version>${mssql-jtds.version}</version>\n+        </dependency>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNzYzMTIz", "url": "https://github.com/apache/skywalking/pull/5842#pullrequestreview-530763123", "createdAt": "2020-11-15T03:10:37Z", "commit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwMzoxMDozN1rOHzbC1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwMzoxMDozN1rOHzbC1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzY4MjUxOQ==", "bodyText": "SqlServer:\n  id: 3006\n  languages: C#\n\nSqlServer language should be updated.", "url": "https://github.com/apache/skywalking/pull/5842#discussion_r523682519", "createdAt": "2020-11-15T03:10:37Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-bootstrap/src/main/resources/component-libraries.yml", "diffHunk": "@@ -537,4 +540,5 @@ Component-Server-Mappings:\n   influxdb-java: InfluxDB\n   Predis: Redis\n   PyMysql: Mysql\n-  spring-kafka-consumer: kafka-consumer\n\\ No newline at end of file\n+  spring-kafka-consumer: kafka-consumer\n+  mssql-jdbc-driver: SqlServer", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNzYzNjM0", "url": "https://github.com/apache/skywalking/pull/5842#pullrequestreview-530763634", "createdAt": "2020-11-15T03:22:46Z", "commit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwMzoyMjo0N1rOHzbjEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwNDozMzozM1rOHzcfdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzY5MDc3MA==", "bodyText": "Put this in file plugins-test.1.yaml", "url": "https://github.com/apache/skywalking/pull/5842#discussion_r523690770", "createdAt": "2020-11-15T03:22:47Z", "author": {"login": "kezhenxu94"}, "path": ".github/workflows/plugins-test.0.yaml", "diffHunk": "@@ -70,6 +70,7 @@ jobs:\n           - gson-scenario\n           - elasticjob-3.x-scenario\n           - springmvc-reactive-scenario\n+          - mssql-jtds-scenario", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzcwNjIyOA==", "bodyText": "Why not use org.apache.skywalking.apm.agent.core.plugin.match.MultiClassNameMatch so that you don't need several subclasses?", "url": "https://github.com/apache/skywalking/pull/5842#discussion_r523706228", "createdAt": "2020-11-15T04:33:33Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-sdk-plugin/mssql-jtds-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/mssql/jtds/v1/define/ConnectionJDBC2Instrumentation.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.mssql.jtds.v1.define;\n+\n+import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n+\n+import static org.apache.skywalking.apm.agent.core.plugin.match.NameMatch.byName;\n+\n+/**\n+ * {@link ConnectionJDBC2Instrumentation} presents that skywalking intercepts {@link net.sourceforge.jtds.jdbc.ConnectionJDBC2}.\n+ */\n+public class ConnectionJDBC2Instrumentation extends AbstractConnectionInstrumentation {\n+    public static final String ENHANCE_CLASS = \"net.sourceforge.jtds.jdbc.ConnectionJDBC2\";\n+\n+    @Override\n+    protected ClassMatch enhanceClass() {\n+        return byName(ENHANCE_CLASS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe1c1eeef19acc3cb4d2977ae99823d93a08e152"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c75f2709ccd9b0c8f17fd52f63a7692400b112a5", "author": {"user": {"login": "zifeihan", "name": "zifeihan"}}, "url": "https://github.com/apache/skywalking/commit/c75f2709ccd9b0c8f17fd52f63a7692400b112a5", "committedDate": "2020-11-15T05:05:49Z", "message": "Polishing."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNzY3NzUx", "url": "https://github.com/apache/skywalking/pull/5842#pullrequestreview-530767751", "createdAt": "2020-11-15T05:12:51Z", "commit": {"oid": "c75f2709ccd9b0c8f17fd52f63a7692400b112a5"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwNToxMjo1MlrOHzcq8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNVQwNToxMjo1MlrOHzcq8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzcwOTE2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * 1. Enhance <code>prepareStatement</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCPrepareStatementInterceptor</code>\n          \n          \n            \n             * 3. Enhance <code>prepareCall</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCPrepareCallInterceptor</code>\n          \n          \n            \n             * 4. Enhance <code>createStatement</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCStatementInterceptor</code>\n          \n          \n            \n             * 5. Enhance <code>commit, rollback, close, releaseSavepoint</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.ConnectionServiceMethodInterceptor</code>\n          \n          \n            \n             * 1. Enhance <code>prepareStatement</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCPrepareStatementInterceptor</code>\n          \n          \n            \n             * 2. Enhance <code>prepareCall</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCPrepareCallInterceptor</code>\n          \n          \n            \n             * 3. Enhance <code>createStatement</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCStatementInterceptor</code>\n          \n          \n            \n             * 4. Enhance <code>commit, rollback, close, releaseSavepoint</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.ConnectionServiceMethodInterceptor</code>", "url": "https://github.com/apache/skywalking/pull/5842#discussion_r523709168", "createdAt": "2020-11-15T05:12:52Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-sdk-plugin/mssql-jtds-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/mssql/jtds/v1/define/AbstractConnectionInstrumentation.java", "diffHunk": "@@ -0,0 +1,150 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.mssql.jtds.v1.define;\n+\n+import net.bytebuddy.description.method.MethodDescription;\n+import net.bytebuddy.matcher.ElementMatcher;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.ClassInstanceMethodsEnhancePluginDefine;\n+import org.apache.skywalking.apm.plugin.jdbc.define.Constants;\n+\n+import static net.bytebuddy.matcher.ElementMatchers.named;\n+import static net.bytebuddy.matcher.ElementMatchers.takesArguments;\n+\n+/**\n+ * {@link AbstractConnectionInstrumentation} define how to enhance the following methods that the class which extend\n+ * {@link java.sql.Connection}.\n+ * <p>\n+ * 1. Enhance <code>prepareStatement</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCPrepareStatementInterceptor</code>\n+ * 3. Enhance <code>prepareCall</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCPrepareCallInterceptor</code>\n+ * 4. Enhance <code>createStatement</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.JDBCStatementInterceptor</code>\n+ * 5. Enhance <code>commit, rollback, close, releaseSavepoint</code> by <code>org.apache.skywalking.apm.plugin.jdbc.define.ConnectionServiceMethodInterceptor</code>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c75f2709ccd9b0c8f17fd52f63a7692400b112a5"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9883ac84fbe4b0793ce6263044b7748c2c0d003f", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/9883ac84fbe4b0793ce6263044b7748c2c0d003f", "committedDate": "2020-11-15T05:19:29Z", "message": "Update apm-sniffer/apm-sdk-plugin/mssql-jtds-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/mssql/jtds/v1/define/AbstractConnectionInstrumentation.java\n\nCo-authored-by: Zhenxu Ke <kezhenxu94@163.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bbd2162fc87c53b7950e6cfb79e8416487f9f0e", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/1bbd2162fc87c53b7950e6cfb79e8416487f9f0e", "committedDate": "2020-11-15T11:30:07Z", "message": "Merge branch 'master' into mssql"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNzk1MjYx", "url": "https://github.com/apache/skywalking/pull/5842#pullrequestreview-530795261", "createdAt": "2020-11-15T12:44:36Z", "commit": {"oid": "1bbd2162fc87c53b7950e6cfb79e8416487f9f0e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNzk2MDkw", "url": "https://github.com/apache/skywalking/pull/5842#pullrequestreview-530796090", "createdAt": "2020-11-15T12:55:13Z", "commit": {"oid": "1bbd2162fc87c53b7950e6cfb79e8416487f9f0e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1641, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}