{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3MjY5NzAy", "number": 5493, "title": "add webflux webclient plugin", "bodyText": "Please answer these questions before submitting a pull request\n\n\nWhy submit this pull request?\n\n\n Bug fix\n\n\n New feature provided\n\n\n Improve performance\n\n\nRelated issues\n\n\n\nBug fix\n\n\nBug description.\n\n\nHow to fix?\n\n\n\nNew feature or improvement\nThis plugin can collect the information of webflux\nInterceptor Method\norg.springframework.web.reactive.function.client.ExchangeFunctions$DefaultExchangeFunction$exchange()\nWhy  I chose the mehod?\nNo matter what the webclient calls exchange() or retrieve(), the asynchronous request is finally executed through org.springframework.web.reactive.function.client.ExchangeFunctions$DefaultExchangeFunction$exchange() and return  Mono<ClientResponse> .So I chose exchange() as the Interceptor Method.\nResult", "createdAt": "2020-09-15T12:43:28Z", "url": "https://github.com/apache/skywalking/pull/5493", "merged": true, "mergeCommit": {"oid": "806666b4cc7df864d3f20796ec9a171151e72c0e"}, "closed": true, "closedAt": "2020-09-27T14:38:08Z", "author": {"login": "vcjmhg"}, "timelineItems": {"totalCount": 63, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclQRkWgH2gAyNDg3MjY5NzAyOmQxMTFlNWRhZGI3ZGU4ZGNkODIwOWY4N2E4ODEzYTUwZGNmZTk5ZTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdM_S7MgFqTQ5NzA4Mjg1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d111e5dadb7de8dcd8209f87a8813a50dcfe99e2", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/d111e5dadb7de8dcd8209f87a8813a50dcfe99e2", "committedDate": "2020-05-27T02:58:57Z", "message": "Merge pull request #1 from apache/master\n\nramain the last"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad67170d39f576e20f9bd4cb43bb8be4f18b4857", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/ad67170d39f576e20f9bd4cb43bb8be4f18b4857", "committedDate": "2020-07-01T09:39:53Z", "message": "Merge pull request #2 from apache/master\n\nupdate localbase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd07f9b2980b4a3bab8f85cc9233c4e3f01a70b7", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/cd07f9b2980b4a3bab8f85cc9233c4e3f01a70b7", "committedDate": "2020-08-28T02:05:29Z", "message": "Merge pull request #4 from apache/master\n\nupdate to date of time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e9e1264405eb5b08be73201f15305f1d122f5f4", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/0e9e1264405eb5b08be73201f15305f1d122f5f4", "committedDate": "2020-09-14T12:50:18Z", "message": "Merge pull request #6 from apache/master\n\nupdate project"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6a6dadb320ba39b0f64157438df96f778209b8f", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/d6a6dadb320ba39b0f64157438df96f778209b8f", "committedDate": "2020-09-15T08:48:41Z", "message": "Merge branch 'master' of https://github.com/apache/skywalking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cec57d6a3444efcbe9918094611a8b34db30cc59", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/cec57d6a3444efcbe9918094611a8b34db30cc59", "committedDate": "2020-09-15T12:41:30Z", "message": "finish webflux webclient plugin test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "cec57d6a3444efcbe9918094611a8b34db30cc59", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/cec57d6a3444efcbe9918094611a8b34db30cc59", "committedDate": "2020-09-15T12:41:30Z", "message": "finish webflux webclient plugin test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51483a77f1ff89db93a9ce2eab00e6de9da14c3c", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/51483a77f1ff89db93a9ce2eab00e6de9da14c3c", "committedDate": "2020-09-16T11:17:34Z", "message": "Merge branch 'master' of https://github.com/apache/skywalking into dev"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab0009cd9809fbced1884bd8e9de95e6c1b74816", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/ab0009cd9809fbced1884bd8e9de95e6c1b74816", "committedDate": "2020-09-16T12:45:20Z", "message": "add plugin information in Plugin-list.md and modefiy some content in expectedData.yaml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMzk3NzY0", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-490397764", "createdAt": "2020-09-17T09:13:18Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwOToxMzoxOVrOHTY8dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwOToxMzoxOVrOHTY8dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA5MzY4Nw==", "bodyText": "@vcjmhg swap this line and line 31 solves the problem,", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r490093687", "createdAt": "2020-09-17T09:13:19Z", "author": {"login": "kezhenxu94"}, "path": "test/plugin/scenarios/webflux-scenario/pom.xml", "diffHunk": "@@ -29,6 +29,7 @@\n         <module>webflux-projectA-scenario</module>\n         <module>webflux-projectB-scenario</module>\n         <module>webflux-dist</module>\n+        <module>webflux-webclient-scenario</module>", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNDAxNDc2", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-490401476", "createdAt": "2020-09-17T09:17:56Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwOToxNzo1NlrOHTZH_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwOToxNzo1NlrOHTZH_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA5NjYzOQ==", "bodyText": "This name doesn't accord to the one in apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r490096639", "createdAt": "2020-09-17T09:17:56Z", "author": {"login": "kezhenxu94"}, "path": "oap-server/server-bootstrap/src/main/resources/component-libraries.yml", "diffHunk": "@@ -323,6 +323,9 @@ SpringScheduled:\n quartz-scheduler:\n   id: 97\n   languages: Java\n+spring-webclient:", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94fddff8e20168bc6612ac696f267b70ac9707d3", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/94fddff8e20168bc6612ac696f267b70ac9707d3", "committedDate": "2020-09-17T10:57:55Z", "message": "make plugin name in component-libraries.yml same with in ComponentDefine.java"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "94fddff8e20168bc6612ac696f267b70ac9707d3", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/94fddff8e20168bc6612ac696f267b70ac9707d3", "committedDate": "2020-09-17T10:57:55Z", "message": "make plugin name in component-libraries.yml same with in ComponentDefine.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNDk0NTc1", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-490494575", "createdAt": "2020-09-17T11:27:01Z", "commit": {"oid": "94fddff8e20168bc6612ac696f267b70ac9707d3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMToyNzowMVrOHTdhmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMToyNzowMVrOHTdhmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE2ODcyOQ==", "bodyText": "Should the format be k=v in properties?", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r490168729", "createdAt": "2020-09-17T11:27:01Z", "author": {"login": "dmsolr"}, "path": "test/plugin/scenarios/webflux-scenario/webflux-webclient-scenario/src/main/resources/application.properties", "diffHunk": "@@ -0,0 +1,19 @@\n+\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+#  limitations under the License.\n+#\n+\n+server.port: 18081", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94fddff8e20168bc6612ac696f267b70ac9707d3"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "431a3b7987f6a7ad3e1b844305a7e3ce724b78b5", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/431a3b7987f6a7ad3e1b844305a7e3ce724b78b5", "committedDate": "2020-09-18T00:17:40Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b9095b867b21d0c4f0287effdf660413df9ba3b", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/8b9095b867b21d0c4f0287effdf660413df9ba3b", "committedDate": "2020-09-18T00:23:49Z", "message": "change the filetype of application.yml from .properties to yml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMTA5ODc1", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-491109875", "createdAt": "2020-09-18T02:33:23Z", "commit": {"oid": "8b9095b867b21d0c4f0287effdf660413df9ba3b"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMjozMzoyM1rOHT721Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwMjo1Nzo1OFrOHT8O6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY2NTY4NQ==", "bodyText": "span may be null if (allArguments[0] == null)", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r490665685", "createdAt": "2020-09-18T02:33:23Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-sdk-plugin/spring-plugins/spring-webflux-5.x-webclient-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/webflux/v5/webclient/WebFluxWebClientInterceptor.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.spring.webflux.v5.webclient;\n+\n+import org.apache.skywalking.apm.agent.core.context.CarrierItem;\n+import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.web.reactive.function.client.ClientRequest;\n+import org.springframework.web.reactive.function.client.ClientResponse;\n+import reactor.core.publisher.Mono;\n+\n+import java.lang.reflect.Method;\n+import java.net.URI;\n+import java.util.function.BiConsumer;\n+\n+public class WebFluxWebClientInterceptor implements InstanceMethodsAroundInterceptor {\n+\n+    @Override\n+    public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes, MethodInterceptResult result) throws Throwable {\n+        if (allArguments[0] == null) {\n+            //illegal args,can't trace ignore\n+            return;\n+        }\n+\n+        ClientRequest request = (ClientRequest) allArguments[0];\n+        final ContextCarrier contextCarrier = new ContextCarrier();\n+\n+        URI uri = request.url();\n+        final String requestURIString = getRequestURIString(uri);\n+        final String operationName = requestURIString;\n+        final String remotePeer = getIPAndPort(uri);\n+        AbstractSpan span = ContextManager.createExitSpan(operationName, contextCarrier, remotePeer);\n+\n+        //set componet name\n+        span.setComponent(ComponentsDefine.SPRING_WEBCLIENT);\n+        Tags.URL.set(span, uri.toString());\n+        Tags.HTTP.METHOD.set(span, request.method().toString());\n+        SpanLayer.asHttp(span);\n+\n+        //user async interface\n+        span.prepareForAsync();\n+        ContextManager.stopSpan();\n+\n+        objInst.setSkyWalkingDynamicField(span);\n+\n+        CarrierItem next = contextCarrier.items();\n+        while (next.hasNext()) {\n+            next = next.next();\n+            request.headers().add(next.getHeadKey(), next.getHeadValue());\n+        }\n+    }\n+\n+    @Override\n+    public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes, Object ret) throws Throwable {\n+        Mono<ClientResponse> ret1 = (Mono<ClientResponse>) ret;\n+        AbstractSpan span = (AbstractSpan) objInst.getSkyWalkingDynamicField();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b9095b867b21d0c4f0287effdf660413df9ba3b"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY3MDM3Ng==", "bodyText": "You don't need span.errorOccurred(); now\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        span.errorOccurred();\n          \n          \n            \n                        span.log(error);\n          \n          \n            \n                        span.log(error);", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r490670376", "createdAt": "2020-09-18T02:51:47Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-sdk-plugin/spring-plugins/spring-webflux-5.x-webclient-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/webflux/v5/webclient/WebFluxWebClientInterceptor.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.spring.webflux.v5.webclient;\n+\n+import org.apache.skywalking.apm.agent.core.context.CarrierItem;\n+import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.web.reactive.function.client.ClientRequest;\n+import org.springframework.web.reactive.function.client.ClientResponse;\n+import reactor.core.publisher.Mono;\n+\n+import java.lang.reflect.Method;\n+import java.net.URI;\n+import java.util.function.BiConsumer;\n+\n+public class WebFluxWebClientInterceptor implements InstanceMethodsAroundInterceptor {\n+\n+    @Override\n+    public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes, MethodInterceptResult result) throws Throwable {\n+        if (allArguments[0] == null) {\n+            //illegal args,can't trace ignore\n+            return;\n+        }\n+\n+        ClientRequest request = (ClientRequest) allArguments[0];\n+        final ContextCarrier contextCarrier = new ContextCarrier();\n+\n+        URI uri = request.url();\n+        final String requestURIString = getRequestURIString(uri);\n+        final String operationName = requestURIString;\n+        final String remotePeer = getIPAndPort(uri);\n+        AbstractSpan span = ContextManager.createExitSpan(operationName, contextCarrier, remotePeer);\n+\n+        //set componet name\n+        span.setComponent(ComponentsDefine.SPRING_WEBCLIENT);\n+        Tags.URL.set(span, uri.toString());\n+        Tags.HTTP.METHOD.set(span, request.method().toString());\n+        SpanLayer.asHttp(span);\n+\n+        //user async interface\n+        span.prepareForAsync();\n+        ContextManager.stopSpan();\n+\n+        objInst.setSkyWalkingDynamicField(span);\n+\n+        CarrierItem next = contextCarrier.items();\n+        while (next.hasNext()) {\n+            next = next.next();\n+            request.headers().add(next.getHeadKey(), next.getHeadValue());\n+        }\n+    }\n+\n+    @Override\n+    public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes, Object ret) throws Throwable {\n+        Mono<ClientResponse> ret1 = (Mono<ClientResponse>) ret;\n+        AbstractSpan span = (AbstractSpan) objInst.getSkyWalkingDynamicField();\n+        return ret1.doAfterSuccessOrError(new BiConsumer<ClientResponse, Throwable>() {\n+            @Override\n+            public void accept(ClientResponse clientResponse, Throwable throwable) {\n+                HttpStatus httpStatus = clientResponse.statusCode();\n+                if (httpStatus != null) {\n+                    Tags.STATUS_CODE.set(span, Integer.toString(httpStatus.value()));\n+                    if (httpStatus.isError()) {\n+                        span.errorOccurred();\n+                    }\n+                }\n+            }\n+        }).doOnError(error -> {\n+            span.errorOccurred();\n+            span.log(error);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b9095b867b21d0c4f0287effdf660413df9ba3b"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDY3MTg1MQ==", "bodyText": "Only pick up some of them to test, testing all versions requires many resources and makes the test slow", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r490671851", "createdAt": "2020-09-18T02:57:58Z", "author": {"login": "kezhenxu94"}, "path": "test/plugin/scenarios/webflux-scenario/support-version.list", "diffHunk": "@@ -23,3 +23,11 @@\n 2.1.5.RELEASE\n 2.1.6.RELEASE\n 2.1.7.RELEASE\n+2.1.8.RELEASE\n+2.1.9.RELEASE\n+2.1.10.RELEASE\n+2.1.11.RELEASE\n+2.1.12.RELEASE\n+2.1.13.RELEASE\n+2.1.14.RELEASE\n+2.1.15.RELEASE", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b9095b867b21d0c4f0287effdf660413df9ba3b"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25312006edf56d28ca59c9fec6f6d4b5029096cb", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/25312006edf56d28ca59c9fec6f6d4b5029096cb", "committedDate": "2020-09-18T02:58:42Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6299ee1313a11941a7fba1513f5320e883a43967", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/6299ee1313a11941a7fba1513f5320e883a43967", "committedDate": "2020-09-19T13:53:31Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c0282e7c61855408beab498fa7c1508e38eebd2", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/4c0282e7c61855408beab498fa7c1508e38eebd2", "committedDate": "2020-09-20T01:53:05Z", "message": "fix the problem that allArgument[0] may be null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fc18652fb9908fba9bcb5631b314221b56640fc", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/5fc18652fb9908fba9bcb5631b314221b56640fc", "committedDate": "2020-09-20T02:12:45Z", "message": "Merge branch 'master' of https://github.com/apache/skywalking into dev\n\n\u0001 Conflicts:\n\u0001\tapm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java\n\u0001\toap-server/server-bootstrap/src/main/resources/component-libraries.yml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMTY3MTEx", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-492167111", "createdAt": "2020-09-20T02:21:40Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMFQwMjoyMTo0MFrOHU3f2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMFQwMjoyMTo0MFrOHU3f2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0Mjg0Mg==", "bodyText": "You didn't format the codes, and why/when this could NULL? Is there a real case for this?", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r491642842", "createdAt": "2020-09-20T02:21:40Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-sdk-plugin/spring-plugins/spring-webflux-5.x-webclient-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/webflux/v5/webclient/WebFluxWebClientInterceptor.java", "diffHunk": "@@ -0,0 +1,119 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.spring.webflux.v5.webclient;\n+\n+import org.apache.skywalking.apm.agent.core.context.CarrierItem;\n+import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.web.reactive.function.client.ClientRequest;\n+import org.springframework.web.reactive.function.client.ClientResponse;\n+import reactor.core.publisher.Mono;\n+\n+import java.lang.reflect.Method;\n+import java.net.URI;\n+import java.util.function.BiConsumer;\n+\n+public class WebFluxWebClientInterceptor implements InstanceMethodsAroundInterceptor {\n+\n+    @Override\n+    public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes, MethodInterceptResult result) throws Throwable {\n+        if (allArguments[0] == null) {\n+            //illegal args,can't trace ignore\n+            return;\n+        }\n+\n+        ClientRequest request = (ClientRequest) allArguments[0];\n+        final ContextCarrier contextCarrier = new ContextCarrier();\n+\n+        URI uri = request.url();\n+        final String requestURIString = getRequestURIString(uri);\n+        final String operationName = requestURIString;\n+        final String remotePeer = getIPAndPort(uri);\n+        AbstractSpan span = ContextManager.createExitSpan(operationName, contextCarrier, remotePeer);\n+\n+        //set componet name\n+        span.setComponent(ComponentsDefine.SPRING_WEBCLIENT);\n+        Tags.URL.set(span, uri.toString());\n+        Tags.HTTP.METHOD.set(span, request.method().toString());\n+        SpanLayer.asHttp(span);\n+\n+        //user async interface\n+        span.prepareForAsync();\n+        ContextManager.stopSpan();\n+\n+        objInst.setSkyWalkingDynamicField(span);\n+\n+        CarrierItem next = contextCarrier.items();\n+        while (next.hasNext()) {\n+            next = next.next();\n+            request.headers().add(next.getHeadKey(), next.getHeadValue());\n+        }\n+    }\n+\n+    @Override\n+    public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes, Object ret) throws Throwable {\n+        // fix the problem that allArgument[0] may be null\n+        if(allArguments[0] == null){", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 80}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMTY3MzU5", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-492167359", "createdAt": "2020-09-20T02:27:28Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMFQwMjoyNzoyOFrOHU3hZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMFQwMjoyNzoyOFrOHU3hZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MzIzNg==", "bodyText": "What is the difference between this new link and above L45-L47? You seem only to change the target address. Why you do WebClient in another new service rather than doing directly here? I am feeling the new service in the test is not necessary.\nPlease correct me if I am wrong.", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r491643236", "createdAt": "2020-09-20T02:27:28Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/scenarios/webflux-scenario/webflux-projectA-scenario/src/main/java/org/apache/skywalking/apm/testcase/sc/webflux/projectA/controller/TestController.java", "diffHunk": "@@ -43,6 +45,7 @@ public String testcase() throws IOException {\n         visit(\"http://\" + hostBAddress + \"/testcase/route/error\");\n         visit(\"http://\" + hostBAddress + \"/notFound\");\n         visit(\"http://\" + hostBAddress + \"/testcase/annotation/mono/hello\");\n+        visit(\"http://\" + clientHostAddress + \"/testcase/webclient/testGet\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a6c3d45c992c286903076d494939390e29b8005", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/5a6c3d45c992c286903076d494939390e29b8005", "committedDate": "2020-09-20T04:18:48Z", "message": "resolve conflicts"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "5a6c3d45c992c286903076d494939390e29b8005", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/5a6c3d45c992c286903076d494939390e29b8005", "committedDate": "2020-09-20T04:18:48Z", "message": "resolve conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed4a3026d92d808de0b2f8dee9dbefc7d999b7b9", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/ed4a3026d92d808de0b2f8dee9dbefc7d999b7b9", "committedDate": "2020-09-20T06:37:57Z", "message": "move the test cases of webclient into projectA"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5a6c3d45c992c286903076d494939390e29b8005", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/5a6c3d45c992c286903076d494939390e29b8005", "committedDate": "2020-09-20T04:18:48Z", "message": "resolve conflicts"}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "170f497abc2b1194052599bc366b90470531621a", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/170f497abc2b1194052599bc366b90470531621a", "committedDate": "2020-09-21T14:34:48Z", "message": "move the test cases of webclient into projectA"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba8f38de7266268b2c675ed073788d32c414aad9", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/ba8f38de7266268b2c675ed073788d32c414aad9", "committedDate": "2020-09-21T16:02:37Z", "message": "move the test cases of webclient into projectA"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "170f497abc2b1194052599bc366b90470531621a", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/170f497abc2b1194052599bc366b90470531621a", "committedDate": "2020-09-21T14:34:48Z", "message": "move the test cases of webclient into projectA"}, "afterCommit": {"oid": "ba8f38de7266268b2c675ed073788d32c414aad9", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/ba8f38de7266268b2c675ed073788d32c414aad9", "committedDate": "2020-09-21T16:02:37Z", "message": "move the test cases of webclient into projectA"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f544b02e6e6c23328c103d2f8d835a429b34d04", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/4f544b02e6e6c23328c103d2f8d835a429b34d04", "committedDate": "2020-09-22T02:43:30Z", "message": "modify expectedData.yaml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "873bb622bd9c552c0638e382cd01817d162042ac", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/873bb622bd9c552c0638e382cd01817d162042ac", "committedDate": "2020-09-22T02:48:50Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31ecad3576de439c7b12fa2fe5fd075713972d06", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/31ecad3576de439c7b12fa2fe5fd075713972d06", "committedDate": "2020-09-22T02:49:29Z", "message": "Merge branch 'master' of github.com:vcjmhg/skywalking into fix-webclient"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1f0af6a07e983f147b1f6fce24a14024950edfe", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/e1f0af6a07e983f147b1f6fce24a14024950edfe", "committedDate": "2020-09-22T03:58:13Z", "message": "modefy component-libraries.yml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4096cdc7aeb93dda1a5424c74ef44aa94e24e1cc", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/4096cdc7aeb93dda1a5424c74ef44aa94e24e1cc", "committedDate": "2020-09-22T03:59:24Z", "message": "Merge branch 'dev' of github.com:vcjmhg/skywalking into fix-webclient"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b29e7b5559b54181dbec03f2b12e5fd9e421a72", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/9b29e7b5559b54181dbec03f2b12e5fd9e421a72", "committedDate": "2020-09-22T09:00:07Z", "message": "modefy component-libraries.yml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMjk2OTI2", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-493296926", "createdAt": "2020-09-22T09:52:15Z", "commit": {"oid": "9b29e7b5559b54181dbec03f2b12e5fd9e421a72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwOTo1MjoxNVrOHVyjBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQwOTo1MjoxNVrOHVyjBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjYxMDMxMQ==", "bodyText": "A component should not include the version.", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r492610311", "createdAt": "2020-09-22T09:52:15Z", "author": {"login": "wu-sheng"}, "path": "apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java", "diffHunk": "@@ -178,4 +178,6 @@\n     public static final OfficialComponent QUARTZ_SCHEDULER = new OfficialComponent(97, \"quartz-scheduler\");\n \n     public static final OfficialComponent XXL_JOB = new OfficialComponent(98, \"xxl-job\");\n-}\n+\n+    public static final OfficialComponent SPRING_WEBCLIENT = new OfficialComponent(99, \"spring-webflux-5.x-webclient\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b29e7b5559b54181dbec03f2b12e5fd9e421a72"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21568387ef383b7b0cd0830f3eee11f503e47d2a", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/21568387ef383b7b0cd0830f3eee11f503e47d2a", "committedDate": "2020-09-22T12:29:20Z", "message": "modify webclient defined name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13174a28def4066b4b43eb059f5a963882e51996", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/13174a28def4066b4b43eb059f5a963882e51996", "committedDate": "2020-09-22T12:30:05Z", "message": "Merge branch 'master' of https://github.com/apache/skywalking into fix-webclient"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14d65c661d31531b4854f704f760a62509b2128b", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/14d65c661d31531b4854f704f760a62509b2128b", "committedDate": "2020-09-22T14:09:16Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNTcxMjQ1", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-493571245", "createdAt": "2020-09-22T15:12:42Z", "commit": {"oid": "14d65c661d31531b4854f704f760a62509b2128b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNToxMjo0MlrOHV_KwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNToxMjo0MlrOHV_KwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjgxNzA4OQ==", "bodyText": "Where is the server-side segment with ref to match this?", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r492817089", "createdAt": "2020-09-22T15:12:42Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/scenarios/webflux-scenario/config/expectedData.yaml", "diffHunk": "@@ -321,6 +321,22 @@ segmentItems:\n       - {key: url, value: not null}\n       - {key: http.method, value: GET}\n       skipAnalysis: 'false'\n+    - operationName: /testcase/webclient/server", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14d65c661d31531b4854f704f760a62509b2128b"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNTcxODA0", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-493571804", "createdAt": "2020-09-22T15:13:16Z", "commit": {"oid": "14d65c661d31531b4854f704f760a62509b2128b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNToxMzoxNlrOHV_NaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQxNToxMzoxNlrOHV_NaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjgxNzc2OQ==", "bodyText": "This should be traced in the expected data. Please recheck.", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r492817769", "createdAt": "2020-09-22T15:13:16Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/scenarios/webflux-scenario/webflux-projectB-scenario/src/main/java/test/apache/skywalking/apm/testcase/sc/webflux/projectB/controller/TestAnnotationController.java", "diffHunk": "@@ -44,6 +44,11 @@ public String error() {\n         }\n         return \"1\";\n     }\n+    \n+    @RequestMapping(\"/testcase/webclient/server\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14d65c661d31531b4854f704f760a62509b2128b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14cee1677b59271971f65683eede646a93e3ef74", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/14cee1677b59271971f65683eede646a93e3ef74", "committedDate": "2020-09-23T02:00:02Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12a0ba0a11c8ecf2f930c1e5cd79f1e21af4e81d", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/12a0ba0a11c8ecf2f930c1e5cd79f1e21af4e81d", "committedDate": "2020-09-23T14:53:50Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2efb2632ae6b3ee1e1c664577b1f5717630498a8", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/2efb2632ae6b3ee1e1c664577b1f5717630498a8", "committedDate": "2020-09-24T01:26:21Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af1637d74b9852fa4cc9b13c5c5dbfe37b7b8f52", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/af1637d74b9852fa4cc9b13c5c5dbfe37b7b8f52", "committedDate": "2020-09-24T01:32:04Z", "message": "Merge branch 'dev' of github.com:vcjmhg/skywalking into dev\n\n\u0001 Conflicts:\n\u0001\ttest/plugin/scenarios/webflux-scenario/support-version.list\n\u0001\ttest/plugin/scenarios/webflux-scenario/webflux-projectA-scenario/src/main/java/org/apache/skywalking/apm/testcase/sc/webflux/projectA/controller/TestController.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e303fb70007b8e20e4547ca064f8d2424400fa1", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/7e303fb70007b8e20e4547ca064f8d2424400fa1", "committedDate": "2020-09-25T12:27:31Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ff7731a581d494c650da29e7c0c8addde97c7c4", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/0ff7731a581d494c650da29e7c0c8addde97c7c4", "committedDate": "2020-09-26T04:49:35Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e206610ef3b12b919fdffe215bc5735bd77153ca", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/e206610ef3b12b919fdffe215bc5735bd77153ca", "committedDate": "2020-09-26T04:52:05Z", "message": "fix the problem that can't send ref data correctly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b18be6b90513c62952ea8b8114452483efe2cb3", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/3b18be6b90513c62952ea8b8114452483efe2cb3", "committedDate": "2020-09-26T04:52:24Z", "message": "Merge branch 'dev' of github.com:vcjmhg/skywalking into dev"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "3b18be6b90513c62952ea8b8114452483efe2cb3", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/3b18be6b90513c62952ea8b8114452483efe2cb3", "committedDate": "2020-09-26T04:52:24Z", "message": "Merge branch 'dev' of github.com:vcjmhg/skywalking into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e536b588090279e022a79ae49a8d9c68303ddbe", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/4e536b588090279e022a79ae49a8d9c68303ddbe", "committedDate": "2020-09-26T12:57:04Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDAzMTcz", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-497003173", "createdAt": "2020-09-26T12:59:50Z", "commit": {"oid": "4e536b588090279e022a79ae49a8d9c68303ddbe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxMjo1OTo1MFrOHYgJYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxMjo1OTo1MFrOHYgJYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ1NDU2MA==", "bodyText": "Recently, we are reducing the unnecessary tests, you could run all these locally, but in the upstream CI, we recommend the latest mini version num, 2.1.6 for all 2.1.x.", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r495454560", "createdAt": "2020-09-26T12:59:50Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/scenarios/webflux-scenario/support-version.list", "diffHunk": "@@ -16,5 +16,10 @@\n \n # 2.0.0-2.1.0 are supported, but due to the status code bug(https://github.com/spring-projects/spring-framework/issues/21901)\n # we don\u2019t test them\n-\n+2.1.1.RELEASE\n+2.1.2.RELEASE\n+2.1.3.RELEASE\n+2.1.4.RELEASE\n+2.1.5.RELEASE\n+2.1.6.RELEASE", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e536b588090279e022a79ae49a8d9c68303ddbe"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDA0MTQz", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-497004143", "createdAt": "2020-09-26T13:17:39Z", "commit": {"oid": "4e536b588090279e022a79ae49a8d9c68303ddbe"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2941c689a65cc33d270aea81e5767fa92a6bbb88", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/2941c689a65cc33d270aea81e5767fa92a6bbb88", "committedDate": "2020-09-27T04:23:06Z", "message": "modify the version of test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c6aeca07f79b631a156e513fb83710c3d3c717f", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/4c6aeca07f79b631a156e513fb83710c3d3c717f", "committedDate": "2020-09-27T04:23:25Z", "message": "Merge branch 'master' into dev"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b19c55d5017db57406c2c3434914585342b0f45", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/3b19c55d5017db57406c2c3434914585342b0f45", "committedDate": "2020-09-27T04:24:21Z", "message": "Merge branch 'dev' of github.com:vcjmhg/skywalking into dev"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDU1ODcy", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-497055872", "createdAt": "2020-09-27T06:36:46Z", "commit": {"oid": "3b19c55d5017db57406c2c3434914585342b0f45"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDU5OTg4", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-497059988", "createdAt": "2020-09-27T07:46:33Z", "commit": {"oid": "3b19c55d5017db57406c2c3434914585342b0f45"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cd47d45112200a46c54d7a61ceedc28e8242565", "author": {"user": {"login": "vcjmhg", "name": null}}, "url": "https://github.com/apache/skywalking/commit/2cd47d45112200a46c54d7a61ceedc28e8242565", "committedDate": "2020-09-27T08:37:48Z", "message": "increase the version of netty"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDYwODEz", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-497060813", "createdAt": "2020-09-27T07:59:07Z", "commit": {"oid": "3b19c55d5017db57406c2c3434914585342b0f45"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNzo1OTowN1rOHYljbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwNzo1OTowN1rOHYljbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTU0MzE0OQ==", "bodyText": "The version of 2.1x.RELEASE seems has passed ,but 2.2.x failed.It seem context-path has not activated,I will check it.", "url": "https://github.com/apache/skywalking/pull/5493#discussion_r495543149", "createdAt": "2020-09-27T07:59:07Z", "author": {"login": "vcjmhg"}, "path": "test/plugin/scenarios/webflux-scenario/support-version.list", "diffHunk": "@@ -16,5 +16,6 @@\n \n # 2.0.0-2.1.0 are supported, but due to the status code bug(https://github.com/spring-projects/spring-framework/issues/21901)\n # we don\u2019t test them\n-\n-2.1.7.RELEASE\n+2.1.17.RELEASE\n+2.2.10.RELEASE\n+2.3.4.RELEASE", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b19c55d5017db57406c2c3434914585342b0f45"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDgyODUx", "url": "https://github.com/apache/skywalking/pull/5493#pullrequestreview-497082851", "createdAt": "2020-09-27T13:49:01Z", "commit": {"oid": "2cd47d45112200a46c54d7a61ceedc28e8242565"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1680, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}