{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNjgxMDYz", "number": 4311, "title": "Provide the new version upgrade documentation/FAQ.", "bodyText": "As many people asked, I finally have time to write this.", "createdAt": "2020-02-04T07:14:14Z", "url": "https://github.com/apache/skywalking/pull/4311", "merged": true, "mergeCommit": {"oid": "421ba88dbfba48cdc5845547381aa4763775b4b1"}, "closed": true, "closedAt": "2020-02-04T09:40:13Z", "author": {"login": "wu-sheng"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcA8LyuAH2gAyMzcwNjgxMDYzOmUxMDAxOTQwYzUxMzYyZThjNjQ0OGU0MTAzMjA1NzY1MzRmMjhkMGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcA9Mz2gH2gAyMzcwNjgxMDYzOjcwZmRjMGQwNjlmYzgzODk1Njc3NmZjNjI4ZTBmYjcyMmZhZTFkOTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e1001940c51362e8c6448e410320576534f28d0d", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/e1001940c51362e8c6448e410320576534f28d0d", "committedDate": "2020-02-04T07:13:16Z", "message": "Provide the new version upgrade documentation/FAQ."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNzcyNjc3", "url": "https://github.com/apache/skywalking/pull/4311#pullrequestreview-352772677", "createdAt": "2020-02-04T07:43:11Z", "commit": {"oid": "e1001940c51362e8c6448e410320576534f28d0d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNzgxOTAw", "url": "https://github.com/apache/skywalking/pull/4311#pullrequestreview-352781900", "createdAt": "2020-02-04T08:05:08Z", "commit": {"oid": "e1001940c51362e8c6448e410320576534f28d0d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwODowNTowOVrOFlK_Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwODowNTowOVrOFlK_Tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDUyMTY3OA==", "bodyText": "\"compatible\", \"so users could not upgrade the agents.\" ? typo?", "url": "https://github.com/apache/skywalking/pull/4311#discussion_r374521678", "createdAt": "2020-02-04T08:05:09Z", "author": {"login": "kezhenxu94"}, "path": "docs/en/FAQ/v6-version-upgrade.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# V6 upgrade\n+SkyWalking v6 is widely used in many production environments. Users may wants to upgrade to an old release to new.\n+This is a guidance to tell users how to do that.\n+\n+**NOTICE**, the following ways are not the only ways to do upgrade.\n+\n+## Use Canary Release\n+Like all applications, SkyWalking could use `canary release` method to upgrade by following these steps\n+1. Deploy a new cluster by using the latest(or new) version of SkyWalking OAP cluster with new database cluster.\n+1. Once the target(being monitored) service has chance to upgrade the agent.jar(or just simply reboot), change the `collector.backend_service`\n+pointing to the new OAP backend, and use/add a new namespace(`agent.namespace` in [Table of Agent Configuration Properties](../setup/service-agent/java-agent/README.md#table-of-agent-configuration-properties)).\n+The namespace will avoid the conflict between different versions.\n+1. When all target services have been rebooted, the old OAP clusters could be discarded.\n+\n+`Canary Release` methods works for any version upgrade.\n+\n+## Online Hot Reboot Upgrade\n+The reason we required `Canary Release` is, SkyWalking agent has cache mechanisms, switching to a new cluster makes the \n+cache unavailable for new OAP cluster.\n+In the 6.5.0+(especially for agent version), we have [**Agent hot reboot trigger mechanism**](../setup/backend/backend-setup.md#agent-hot-reboot-trigger-mechanism-in-oap-server-upgrade).\n+By using that, we could do upgrade an easier way, **deploy a new cluster by using the latest(or new) version of SkyWalking OAP cluster with new database cluster**,\n+and shift the traffic to the new cluster once for all. Based on the mechanism, all agents will go into `cool_down` mode, then\n+back online. More detail, read the backend setup document.\n+\n+**NOTICE**, as a known bug in 6.4.0, its agent could have re-connection issue, so, even this bot reboot mechanism included in 6.4.0,\n+it may not work in some network scenarios, especially in k8s.\n+\n+## Agent Compatibility\n+All versions of SkyWalking 6.x(even 7.x) are compatible with each others, so users could not upgrade the agents. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1001940c51362e8c6448e410320576534f28d0d"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68eb14a93459b52484a4182301e40922d278dc33", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/68eb14a93459b52484a4182301e40922d278dc33", "committedDate": "2020-02-04T08:07:25Z", "message": "Make the sentence more clear."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNzgzODQ1", "url": "https://github.com/apache/skywalking/pull/4311#pullrequestreview-352783845", "createdAt": "2020-02-04T08:09:37Z", "commit": {"oid": "68eb14a93459b52484a4182301e40922d278dc33"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70fdc0d069fc838956776fc628e0fb722fae1d95", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/70fdc0d069fc838956776fc628e0fb722fae1d95", "committedDate": "2020-02-04T08:24:17Z", "message": "Merge branch 'master' into upgrade-faq"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2639, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}