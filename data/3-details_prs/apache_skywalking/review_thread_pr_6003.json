{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5MjAwODg0", "number": 6003, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOVQxMzowMToyMFrOFHc3YQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwOToxNTo1NVrOFJuQsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMzU3MjgxOnYy", "diffSide": "RIGHT", "path": "test/plugin/pom.xml", "isResolved": true, "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOVQxMzowMToyMFrOII7maQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMFQxNDoxNzoyMFrOIJElGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ==", "bodyText": "Due to \n  \n    \n      skywalking/test/plugin/generator.sh\n    \n    \n        Lines 79 to 84\n      in\n      753c73a\n    \n    \n    \n    \n\n        \n          \n           # add scenario_name into plugin/pom.xml \n        \n\n        \n          \n           isWrite=$(cat ./pom.xml | grep $scenario_name) \n        \n\n        \n          \n           if [[ -z  $isWrite ]] \n        \n\n        \n          \n           then \n        \n\n        \n          \n             sed -i '/<\\/sourceDirectories>/i <sourceDirectory>'\"$scenario_name\"'<\\/sourceDirectory>' ./pom.xml \n        \n\n        \n          \n           fi \n        \n    \n  \n\n, could we give rid of this?", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546236009", "createdAt": "2020-12-19T13:01:20Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjI0MTQwMA==", "bodyText": "Because scenarios is not a maven project, if only configure <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>, the maven project in scenarios can't  be checked.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546241400", "createdAt": "2020-12-19T13:58:36Z", "author": {"login": "vcjmhg"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjI0Mjg4Mg==", "bodyText": "I know, I mean you are using this script to generate these configurations, right? But the hard-code configurations are still there, https://github.com/apache/skywalking/blob/753c73ab8b/test/plugin/pom.xml#L116-L222\nDo I misunderstand something?", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546242882", "createdAt": "2020-12-19T14:14:05Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjI0NDI0Ng==", "bodyText": "The generator.sh is to generate NEW scenario project, and it will add a new line of that project to https://github.com/apache/skywalking/blob/753c73ab8b/test/plugin/pom.xml#L116-L222", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546244246", "createdAt": "2020-12-19T14:27:46Z", "author": {"login": "kezhenxu94"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjI0NDgzMA==", "bodyText": "Why limit it to new only? Why don't we do that before running the tests and check the code style first?", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546244830", "createdAt": "2020-12-19T14:34:15Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMxNjAzNQ==", "bodyText": "It will be ok to write this script into run.sh. If we do so, it will ensure that the code style is checked before running.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546316035", "createdAt": "2020-12-20T03:40:11Z", "author": {"login": "vcjmhg"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMxNjQwMQ==", "bodyText": "Yes, then this part could be removed and don't require the new contributor to add.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546316401", "createdAt": "2020-12-20T03:45:12Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMyNzY1MQ==", "bodyText": "There are some problems that should be considered, if we write the scripts into run.sh:\n\nWe execute scenarios in a different order and the content of pom.xml may be different, which breaks idempotence and may cause conflicts when merging.\nSome scenarios may need to be handled separately to check the code style. For example jdk14-with-gson-scenario cannot be checked by adding its name in plugin/pom.xml because of different jdk version.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546327651", "createdAt": "2020-12-20T06:07:11Z", "author": {"login": "vcjmhg"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMzMjE1NA==", "bodyText": "The changed pom.xml wouldn't be submitted or merged. It is updated in the CI process only.\n\nAdd the scenario name into pom.xml before run, and delete the added content after execution. Is it like this?\n\nCould you be more clear about what does this mean? Why does code style relate to JDK version?\n\nWhen I add  <sourceDirectory>scenarios/jdk14-with-gson-scenario</sourceDirectory> into plugin/pom.xml, We can see the following verification results\uff1a\nFailed to execute goal org.apache.maven.plugins:maven-checkstyle-plugin:3.1.0:check (validate) on project apache-skywalking-test-plugin: Failed during checkstyle configuration \nSo, I guess the reason may be caused by different jdk versions and I handle it separately. If my understanding is wrong or you have a better solution please let me know", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546332154", "createdAt": "2020-12-20T06:58:02Z", "author": {"login": "vcjmhg"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMzMzQ2Nw==", "bodyText": "With your description, how about adding the check style plugin into every scenario's pom.xml, rather than governing the parent pom.xml?", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546333467", "createdAt": "2020-12-20T07:12:11Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjMzMzk4MQ==", "bodyText": "The generator.sh you changed clearly has the chance to add codestyle check when setting a new plugin test scenario, right?", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546333981", "createdAt": "2020-12-20T07:17:11Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM2NDc2Mg==", "bodyText": "Yes,  it will add <sourceDirectory>scenario_name<\\/sourceDirectory> into pom.xml . It works well when I test on my pc.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546364762", "createdAt": "2020-12-20T11:40:11Z", "author": {"login": "vcjmhg"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM2NzI3NA==", "bodyText": "I don't mean this, Yes, it will add <sourceDirectory>scenario_name<\\/sourceDirectory> into pom.xml.\nI prefer you consider to add the plugin configuration into file like this one, https://github.com/apache/skywalking/blob/9c48d0686a/test/plugin/scenarios/activemq-scenario/pom.xml", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546367274", "createdAt": "2020-12-20T12:02:52Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM4MzEyOQ==", "bodyText": "ok\uff0cI got it. I will have a try!", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r546383129", "createdAt": "2020-12-20T14:17:20Z", "author": {"login": "vcjmhg"}, "path": "test/plugin/pom.xml", "diffHunk": "@@ -99,6 +103,151 @@\n                     <encoding>${project.build.sourceEncoding}</encoding>\n                 </configuration>\n             </plugin>\n+            <plugin>\n+                <artifactId>maven-checkstyle-plugin</artifactId>\n+                <version>${maven-checkstyle-plugin.version}</version>\n+                <configuration>\n+                    <configLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/checkStyle.xml</configLocation>\n+                    <headerLocation>${maven.multiModuleProjectDirectory}/apm-checkstyle/CHECKSTYLE_HEAD</headerLocation>\n+                    <encoding>UTF-8</encoding>\n+                    <consoleOutput>true</consoleOutput>\n+                    <includeTestSourceDirectory>true</includeTestSourceDirectory>\n+                    <failOnViolation>${checkstyle.fails.on.error}</failOnViolation>\n+                    <sourceDirectories>\n+                        <sourceDirectory>${project.build.sourceDirectory}</sourceDirectory>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIzNjAwOQ=="}, "originalCommit": {"oid": "753c73ab8ba68717d67dfa5306a7d224a6f26805"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NTQxNzUzOnYy", "diffSide": "RIGHT", "path": "test/plugin/generator.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxNDowMTo1NFrOIL6KyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQxNDowMTo1NFrOIL6KyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTM1ODI4MQ==", "bodyText": "I think you forget to remove this.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r549358281", "createdAt": "2020-12-28T14:01:54Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/generator.sh", "diffHunk": "@@ -74,4 +74,11 @@ ${MVNW} archetype:generate \\\n     -DarchetypeCatalog=local \\\n     -DinteractiveMode=false \\\n     -DarchetypeVersion=1.0.0 \\\n-    -Dpackage=${package}\n\\ No newline at end of file\n+    -Dpackage=${package}\n+\n+# add scenario_name into plugin/pom.xml\n+isWrite=$(cat ./pom.xml | grep $scenario_name)\n+if [[ -z  $isWrite ]]\n+then\n+  sed -i '/<\\/sourceDirectories>/i <sourceDirectory>'\"$scenario_name\"'<\\/sourceDirectory>' ./pom.xml\n+fi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fcdd25b7f97eaa37d0596ec8383f37d95f36eda"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NzE2MDg0OnYy", "diffSide": "RIGHT", "path": ".github/workflows/plugins-jdk14-test.0.yaml", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNzoxOToyOFrOIMItkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwODoyNTowMFrOIMJxlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5NjU2MA==", "bodyText": "@kezhenxu94 @dmsolr Are you ok about this?", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r549596560", "createdAt": "2020-12-29T07:19:28Z", "author": {"login": "wu-sheng"}, "path": ".github/workflows/plugins-jdk14-test.0.yaml", "diffHunk": "@@ -53,6 +53,8 @@ jobs:\n       - uses: actions/setup-java@v1\n         with:\n           java-version: 8\n+      - name: Add checkstyle-plugin\n+        run: sed -i '/<\\/sourceDirectories>/i <sourceDirectory>scenarios\\/jdk14-with-gson-scenario<\\/sourceDirectory>' test/plugin/pom.xml", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1af27987b04eec76836e09f93ed9aed9ff963e31"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYwMjE4Ng==", "bodyText": "@kezhenxu94 @dmsolr Are you ok about this?\n\nWorks for me", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r549602186", "createdAt": "2020-12-29T07:42:01Z", "author": {"login": "kezhenxu94"}, "path": ".github/workflows/plugins-jdk14-test.0.yaml", "diffHunk": "@@ -53,6 +53,8 @@ jobs:\n       - uses: actions/setup-java@v1\n         with:\n           java-version: 8\n+      - name: Add checkstyle-plugin\n+        run: sed -i '/<\\/sourceDirectories>/i <sourceDirectory>scenarios\\/jdk14-with-gson-scenario<\\/sourceDirectory>' test/plugin/pom.xml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5NjU2MA=="}, "originalCommit": {"oid": "1af27987b04eec76836e09f93ed9aed9ff963e31"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYxMjA5Mg==", "bodyText": "@vcjmhg Could you change this yaml as a matrix based? In case we forget we hard coded jdk14-with-gson-scenario here.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r549612092", "createdAt": "2020-12-29T08:18:20Z", "author": {"login": "wu-sheng"}, "path": ".github/workflows/plugins-jdk14-test.0.yaml", "diffHunk": "@@ -53,6 +53,8 @@ jobs:\n       - uses: actions/setup-java@v1\n         with:\n           java-version: 8\n+      - name: Add checkstyle-plugin\n+        run: sed -i '/<\\/sourceDirectories>/i <sourceDirectory>scenarios\\/jdk14-with-gson-scenario<\\/sourceDirectory>' test/plugin/pom.xml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5NjU2MA=="}, "originalCommit": {"oid": "1af27987b04eec76836e09f93ed9aed9ff963e31"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYxMzk3NQ==", "bodyText": "ok", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r549613975", "createdAt": "2020-12-29T08:25:00Z", "author": {"login": "vcjmhg"}, "path": ".github/workflows/plugins-jdk14-test.0.yaml", "diffHunk": "@@ -53,6 +53,8 @@ jobs:\n       - uses: actions/setup-java@v1\n         with:\n           java-version: 8\n+      - name: Add checkstyle-plugin\n+        run: sed -i '/<\\/sourceDirectories>/i <sourceDirectory>scenarios\\/jdk14-with-gson-scenario<\\/sourceDirectory>' test/plugin/pom.xml", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5NjU2MA=="}, "originalCommit": {"oid": "1af27987b04eec76836e09f93ed9aed9ff963e31"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NzM5NDQxOnYy", "diffSide": "RIGHT", "path": "test/plugin/run.sh", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwOToxNTo1NVrOIMKuKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0yNFQwODo0Njo0NVrOI8eAbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYyOTQ4MA==", "bodyText": "You inject the style check in the CI control file, what is the purpose of this?", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r549629480", "createdAt": "2020-12-29T09:15:55Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/run.sh", "diffHunk": "@@ -140,11 +140,19 @@ if [[ ! -d ${agent_home} ]]; then\n     echo \"[WARN] SkyWalking Agent not exists\"\n     ${mvnw} --batch-mode -f ${home}/../../pom.xml -Pagent -DskipTests clean package\n fi\n+# if it fails last time, relevant information will be deleted\n+sed -i '/<sourceDirectory>scenarios\\/'\"$scenario_name\"'<\\/sourceDirectory>/d' ./pom.xml\n+# add scenario_name into plugin/pom.xml\n+echo check code with the checkstyle-plugin\n+sed -i '/<\\/sourceDirectories>/i <sourceDirectory>scenarios\\/'\"$scenario_name\"'<\\/sourceDirectory>' ./pom.xml\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8fda5241ac8f902e4569ec493f3e264a638d3aa9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTY0MDM4Mg==", "bodyText": "It ensures that the code will be checked when we run the scenario locally. And after checking, the injected code will be deleted.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r549640382", "createdAt": "2020-12-29T09:50:18Z", "author": {"login": "vcjmhg"}, "path": "test/plugin/run.sh", "diffHunk": "@@ -140,11 +140,19 @@ if [[ ! -d ${agent_home} ]]; then\n     echo \"[WARN] SkyWalking Agent not exists\"\n     ${mvnw} --batch-mode -f ${home}/../../pom.xml -Pagent -DskipTests clean package\n fi\n+# if it fails last time, relevant information will be deleted\n+sed -i '/<sourceDirectory>scenarios\\/'\"$scenario_name\"'<\\/sourceDirectory>/d' ./pom.xml\n+# add scenario_name into plugin/pom.xml\n+echo check code with the checkstyle-plugin\n+sed -i '/<\\/sourceDirectories>/i <sourceDirectory>scenarios\\/'\"$scenario_name\"'<\\/sourceDirectory>' ./pom.xml\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYyOTQ4MA=="}, "originalCommit": {"oid": "8fda5241ac8f902e4569ec493f3e264a638d3aa9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTY0MTI5MA==", "bodyText": "I see. But I feel a little concern about the dirty config(added but not removed somehow) will be pushed.", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r549641290", "createdAt": "2020-12-29T09:53:24Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/run.sh", "diffHunk": "@@ -140,11 +140,19 @@ if [[ ! -d ${agent_home} ]]; then\n     echo \"[WARN] SkyWalking Agent not exists\"\n     ${mvnw} --batch-mode -f ${home}/../../pom.xml -Pagent -DskipTests clean package\n fi\n+# if it fails last time, relevant information will be deleted\n+sed -i '/<sourceDirectory>scenarios\\/'\"$scenario_name\"'<\\/sourceDirectory>/d' ./pom.xml\n+# add scenario_name into plugin/pom.xml\n+echo check code with the checkstyle-plugin\n+sed -i '/<\\/sourceDirectories>/i <sourceDirectory>scenarios\\/'\"$scenario_name\"'<\\/sourceDirectory>' ./pom.xml\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYyOTQ4MA=="}, "originalCommit": {"oid": "8fda5241ac8f902e4569ec493f3e264a638d3aa9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDI3NzEwMQ==", "bodyText": "I check out the newest code, 8.5.0-SNAPSHOT.\nRun this script failed in my MacBook. How to fix it?\nref: local-test-and-pull-request-to-the-upstream\n\u279c  skywalking git:(master) bash ./test/plugin/run.sh hbase-scenario\n+++ dirname ./test/plugin/run.sh\n++ cd ./test/plugin\n++ pwd\n+ home=/Users/nisiyong/CodeProjects/skywalking/test/plugin\n+ scenario_name=\n+ force_build=off\n+ cleanup=off\n+ debug_mode=\n+ mvnw=/Users/nisiyong/CodeProjects/skywalking/test/plugin/../../mvnw\n+ agent_home=/Users/nisiyong/CodeProjects/skywalking/test/plugin/../../skywalking-agent\n+ jacoco_home=/Users/nisiyong/CodeProjects/skywalking/test/plugin/../jacoco\n+ scenarios_home=/Users/nisiyong/CodeProjects/skywalking/test/plugin/scenarios\n+ num_of_testcases=\n+ image_version=jdk8-1.0.0\n++ date +%s\n+ start_stamp=1616572417\n+ parse_commandline hbase-scenario\n+ test 1 -gt 0\n+ _key=hbase-scenario\n+ case \"$_key\" in\n+ scenario_name=hbase-scenario\n+ shift\n+ test 0 -gt 0\n+ [[ off == \\o\\n ]]\n+ test -z hbase-scenario\n+ [[ ! -d /Users/nisiyong/CodeProjects/skywalking/test/plugin/../../skywalking-agent ]]\n+ sed -i '/<sourceDirectory>scenarios\\/hbase-scenario<\\/sourceDirectory>/d' ./pom.xml\nsed: 1: \"./pom.xml\": invalid command code .", "url": "https://github.com/apache/skywalking/pull/6003#discussion_r600277101", "createdAt": "2021-03-24T08:46:45Z", "author": {"login": "nisiyong"}, "path": "test/plugin/run.sh", "diffHunk": "@@ -140,11 +140,19 @@ if [[ ! -d ${agent_home} ]]; then\n     echo \"[WARN] SkyWalking Agent not exists\"\n     ${mvnw} --batch-mode -f ${home}/../../pom.xml -Pagent -DskipTests clean package\n fi\n+# if it fails last time, relevant information will be deleted\n+sed -i '/<sourceDirectory>scenarios\\/'\"$scenario_name\"'<\\/sourceDirectory>/d' ./pom.xml\n+# add scenario_name into plugin/pom.xml\n+echo check code with the checkstyle-plugin\n+sed -i '/<\\/sourceDirectories>/i <sourceDirectory>scenarios\\/'\"$scenario_name\"'<\\/sourceDirectory>' ./pom.xml\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYyOTQ4MA=="}, "originalCommit": {"oid": "8fda5241ac8f902e4569ec493f3e264a638d3aa9"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4674, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}