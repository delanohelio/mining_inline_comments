{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4NjI4Nzc5", "number": 4162, "title": "Support collecting http parameters", "bodyText": "Plugins of Tomcat, Spring MVC, Armeria are supported for now\nPlease answer these questions before submitting pull request\n\nWhy submit this pull request?\n Bug fix\n New feature provided\n Improve performance\n\nThis pull request provides another config item to enable/disable collecting http parameters of a request.\nIt uses a general name plugin.http.collect_http_params but doesn't guarantee that all http plugins should be under its control, unless the plugin itself takes this config item into consideration, such as Tomcat, Spring MVC, and Armeria plugin.\nThis pull request also partially close #324 but I would suggest open another issue to track the downstreaming config feature, and I believe we need more discussion on that, @wu-sheng", "createdAt": "2020-01-02T11:27:52Z", "url": "https://github.com/apache/skywalking/pull/4162", "merged": true, "mergeCommit": {"oid": "f52f7f466a1bbca8e67a1e61a2c7c1f56a229709"}, "closed": true, "closedAt": "2020-01-02T23:51:27Z", "author": {"login": "kezhenxu94"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2X_XUAH2gAyMzU4NjI4Nzc5OjMyNDM5ZTI2YmI5YTU0OTc2NTEzODMzMzIxNzJhNTE4OGM2Yzg5ZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb2cCfTAFqTMzNzcyODgyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "32439e26bb9a5497651383332172a5188c6c89fc", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/32439e26bb9a5497651383332172a5188c6c89fc", "committedDate": "2020-01-02T11:23:52Z", "message": "Support collecting http parameters\n\nPlugins of Tomcat, Spring MVC, Armeria are supported for now"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "866e74b050af357b53797e451a2b9ab0a35b74e8", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/866e74b050af357b53797e451a2b9ab0a35b74e8", "committedDate": "2020-01-02T11:28:36Z", "message": "Merge branch 'master' into feature/http-params"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NjIzNDcz", "url": "https://github.com/apache/skywalking/pull/4162#pullrequestreview-337623473", "createdAt": "2020-01-02T11:37:43Z", "commit": {"oid": "866e74b050af357b53797e451a2b9ab0a35b74e8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxMTozNzo0M1rOFZp57A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxMTozNzo0M1rOFZp57A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ0NTI5Mg==", "bodyText": "As far as I know, parallelStream() could cause high latency on high requests.", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362445292", "createdAt": "2020-01-02T11:37:43Z", "author": {"login": "dmsolr"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/util/CollectionUtil.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.util;\n+\n+import java.util.Arrays;\n+import java.util.Map;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * Some utility methods for collections.\n+ * Reinvent the wheels because importing third-party libs just for some methods is not worthwhile in agent side\n+ *\n+ * @author kezhenxu94\n+ * @since 7.0.0\n+ */\n+public final class CollectionUtil {\n+    public static String toString(final Map<String, String[]> map) {\n+        return map\n+            .entrySet()\n+            .parallelStream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "866e74b050af357b53797e451a2b9ab0a35b74e8"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edb5f66d8560bcd677763d739f4db22f9aaad608", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/edb5f66d8560bcd677763d739f4db22f9aaad608", "committedDate": "2020-01-02T11:51:38Z", "message": "Fix failed unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf1ee5025f50e7a1c4996052f5609997e97fb824", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/bf1ee5025f50e7a1c4996052f5609997e97fb824", "committedDate": "2020-01-02T12:32:57Z", "message": "Fix failed plugin test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bae29cd59ab1d7dee6d53b8b9d7cd49a6001cc04", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/bae29cd59ab1d7dee6d53b8b9d7cd49a6001cc04", "committedDate": "2020-01-02T12:33:47Z", "message": "Merge branch 'master' into feature/http-params"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NjQzODk0", "url": "https://github.com/apache/skywalking/pull/4162#pullrequestreview-337643894", "createdAt": "2020-01-02T12:47:14Z", "commit": {"oid": "bae29cd59ab1d7dee6d53b8b9d7cd49a6001cc04"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NjQ4Mjk5", "url": "https://github.com/apache/skywalking/pull/4162#pullrequestreview-337648299", "createdAt": "2020-01-02T13:02:16Z", "commit": {"oid": "bae29cd59ab1d7dee6d53b8b9d7cd49a6001cc04"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxMzowMjoxNlrOFZrIBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxMzowMjoxNlrOFZrIBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ2NTI4NQ==", "bodyText": "Do we need to indicate this should work for UTF-8 encoding project? I think some vendors are using GBK in telecom, bank, etic", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362465285", "createdAt": "2020-01-02T13:02:16Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/README.md", "diffHunk": "@@ -118,6 +118,8 @@ property key | Description | Default |\n `plugin.opgroup.*`|Support operation name customize group rules in different plugins. Read [Group rule supported plugins](op_name_group_rule.md)|Not set|\n `plugin.springtransaction.simplify_transaction_definition_name`|If true, the transaction definition name will be simplified.|false|\n `plugin.jdkthreading.threading_class_prefixes` | Threading classes (`java.lang.Runnable` and `java.util.concurrent.Callable`) and their subclasses, including anonymous inner classes whose name match any one of the `THREADING_CLASS_PREFIXES` (splitted by `,`) will be instrumented, make sure to only specify as narrow prefixes as what you're expecting to instrument, (`java.` and `javax.` will be ignored due to safety issues) | Not set |\n+`plugin.http.collect_http_params`| This config item controls that whether the plugins related to HTTP should collect the parameters of the request. The name `plugin.http.collect_http_params` is rather general, but it doesn't guarantee that all http plugins should be under its control, unless the plugin itself takes this config item into consideration, such as Tomcat, Spring MVC, and Armeria plugin. | `false` |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bae29cd59ab1d7dee6d53b8b9d7cd49a6001cc04"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad47d6006bf2b8989263f6a32e451781024b2f37", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/ad47d6006bf2b8989263f6a32e451781024b2f37", "committedDate": "2020-01-02T13:37:17Z", "message": "Add case when encoding is not UTF8 (say GBK)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "728d69fe4cdfaa73a45124cca3b404f8e1ca47bd", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/728d69fe4cdfaa73a45124cca3b404f8e1ca47bd", "committedDate": "2020-01-02T13:37:39Z", "message": "Merge branch 'master' into feature/http-params"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NjYxMzg0", "url": "https://github.com/apache/skywalking/pull/4162#pullrequestreview-337661384", "createdAt": "2020-01-02T13:40:22Z", "commit": {"oid": "728d69fe4cdfaa73a45124cca3b404f8e1ca47bd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxMzo0MDoyMlrOFZrwlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxMzo0MDoyMlrOFZrwlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ3NTY2OA==", "bodyText": "@wu-sheng Here I meant", "url": "https://github.com/apache/skywalking/pull/4162#discussion_r362475668", "createdAt": "2020-01-02T13:40:22Z", "author": {"login": "kezhenxu94"}, "path": "test/plugin/scenarios/spring-3.1.x-scenario/src/main/webapp/WEB-INF/web.xml", "diffHunk": "@@ -23,6 +23,20 @@\n          version=\"3.1\">\n     <display-name>skywalking-spring-3.1.x-scenario</display-name>\n \n+    <filter>\n+        <filter-name>setCharacterEncodingFilter</filter-name>\n+        <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n+        <init-param>\n+            <param-name>encoding</param-name>\n+            <param-value>GBK</param-value>\n+        </init-param>\n+    </filter>\n+\n+    <filter-mapping>\n+        <filter-name>setCharacterEncodingFilter</filter-name>\n+        <url-pattern>/*</url-pattern>\n+    </filter-mapping>\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "728d69fe4cdfaa73a45124cca3b404f8e1ca47bd"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e4cf4b38eeea68a3a4871aa5fcfa9a1ec9517d1", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/6e4cf4b38eeea68a3a4871aa5fcfa9a1ec9517d1", "committedDate": "2020-01-02T15:31:47Z", "message": "Update web.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce318b98d54069b01a87b39a12e69c933bc7163d", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/ce318b98d54069b01a87b39a12e69c933bc7163d", "committedDate": "2020-01-02T15:32:27Z", "message": "Merge branch 'master' into feature/http-params"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6884f86a815e5c013d390441c4326a04cca97029", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/6884f86a815e5c013d390441c4326a04cca97029", "committedDate": "2020-01-02T15:33:39Z", "message": "Update web.xml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NzE3MTIx", "url": "https://github.com/apache/skywalking/pull/4162#pullrequestreview-337717121", "createdAt": "2020-01-02T15:43:11Z", "commit": {"oid": "6884f86a815e5c013d390441c4326a04cca97029"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NzI4ODI1", "url": "https://github.com/apache/skywalking/pull/4162#pullrequestreview-337728825", "createdAt": "2020-01-02T16:06:54Z", "commit": {"oid": "6884f86a815e5c013d390441c4326a04cca97029"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2713, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}