{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0MjU2OTY5", "number": 5028, "title": "Fix no data bug of oap self observability instance_metrics_second_aggregation metrics.", "bodyText": "Please answer these questions before submitting pull request\n\n\nWhy submit this pull request?\n\n\n Bug fix\n\n\n New feature provided\n\n\n Improve performance\n\n\nRelated issues\n\n\n\nBug fix\n\n\nBug description.\nOap self-observability aggregation(Per Minute) chart's meter_instance_metrics_second_aggregation metrics no data.\n\n\nHow to fix?\nAdd minute dimensionality second aggregation counter.\n\n\n\nNew feature or improvement\n\nDescribe the details and related test reports.", "createdAt": "2020-07-04T08:29:03Z", "url": "https://github.com/apache/skywalking/pull/5028", "merged": true, "mergeCommit": {"oid": "a3ae7b4dc60db8f665847fbbd10bf230431df12c"}, "closed": true, "closedAt": "2020-07-06T05:03:37Z", "author": {"login": "Ax1an"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcxjgZVAH2gAyNDQ0MjU2OTY5OjFlNmZlNzNjMTc4ZDc1ZDE2ODgzZDZiMzNmM2MzOWNkMDdkM2I0OGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyJF0mAFqTQ0Mjc2MDUyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1e6fe73c178d75d16883d6b33f3c39cd07d3b48a", "author": {"user": {"login": "Ax1an", "name": "Ax1an"}}, "url": "https://github.com/apache/skywalking/commit/1e6fe73c178d75d16883d6b33f3c39cd07d3b48a", "committedDate": "2020-07-04T08:10:26Z", "message": "Fix no data bug of oap self observability instance_metrics_second_aggregation metrics."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNTk3MTE2", "url": "https://github.com/apache/skywalking/pull/5028#pullrequestreview-442597116", "createdAt": "2020-07-04T08:50:44Z", "commit": {"oid": "1e6fe73c178d75d16883d6b33f3c39cd07d3b48a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQwODo1MDo0NFrOGs6z2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQwODo1MDo0NFrOGs6z2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc1NDA3NQ==", "bodyText": "Why Change this?", "url": "https://github.com/apache/skywalking/pull/5028#discussion_r449754075", "createdAt": "2020-07-04T08:50:44Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/analysis/worker/MetricsAggregateWorker.java", "diffHunk": "@@ -69,7 +69,7 @@\n                                                           .getService(MetricsCreator.class);\n         aggregationCounter = metricsCreator.createCounter(\n             \"metrics_aggregation\", \"The number of rows in aggregation\",\n-            new MetricsTag.Keys(\"metricName\", \"level\", \"dimensionality\"), new MetricsTag.Values(modelName, \"1\", \"min\")\n+            new MetricsTag.Keys(\"metricName\", \"level\", \"dimensionality\"), new MetricsTag.Values(modelName, \"1\", \"minute\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e6fe73c178d75d16883d6b33f3c39cd07d3b48a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNTk3MTkx", "url": "https://github.com/apache/skywalking/pull/5028#pullrequestreview-442597191", "createdAt": "2020-07-04T08:52:06Z", "commit": {"oid": "1e6fe73c178d75d16883d6b33f3c39cd07d3b48a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQwODo1MjowNlrOGs60OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQwODo1MjowNlrOGs60OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc1NDE2OQ==", "bodyText": "Why remove all these? The downsampling is important.", "url": "https://github.com/apache/skywalking/pull/5028#discussion_r449754169", "createdAt": "2020-07-04T08:52:06Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/analysis/worker/MetricsTransWorker.java", "diffHunk": "@@ -36,28 +32,12 @@\n     private final MetricsPersistentWorker hourPersistenceWorker;\n     private final MetricsPersistentWorker dayPersistenceWorker;\n \n-    private final CounterMetrics aggregationHourCounter;\n-    private final CounterMetrics aggregationDayCounter;\n-\n     public MetricsTransWorker(ModuleDefineHolder moduleDefineHolder,\n-                              String modelName,\n                               MetricsPersistentWorker hourPersistenceWorker,\n                               MetricsPersistentWorker dayPersistenceWorker) {\n         super(moduleDefineHolder);\n         this.hourPersistenceWorker = hourPersistenceWorker;\n         this.dayPersistenceWorker = dayPersistenceWorker;\n-\n-        MetricsCreator metricsCreator = moduleDefineHolder.find(TelemetryModule.NAME)\n-                                                          .provider()\n-                                                          .getService(MetricsCreator.class);\n-        aggregationHourCounter = metricsCreator.createCounter(\n-            \"metrics_aggregation\", \"The number of rows in aggregation\", new MetricsTag.Keys(\"metricName\", \"level\",\n-                                                                                            \"dimensionality\"\n-            ), new MetricsTag.Values(modelName, \"2\", \"hour\"));\n-        aggregationDayCounter = metricsCreator.createCounter(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e6fe73c178d75d16883d6b33f3c39cd07d3b48a"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNTk4MDk0", "url": "https://github.com/apache/skywalking/pull/5028#pullrequestreview-442598094", "createdAt": "2020-07-04T09:12:06Z", "commit": {"oid": "1e6fe73c178d75d16883d6b33f3c39cd07d3b48a"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb5a65be0873d84e42f7f488aa35ed09caafd58f", "author": {"user": {"login": "Ax1an", "name": "Ax1an"}}, "url": "https://github.com/apache/skywalking/commit/fb5a65be0873d84e42f7f488aa35ed09caafd58f", "committedDate": "2020-07-04T10:58:10Z", "message": "update grafana.json"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6c8ddb584ab823370cef00446c1d8f95b01311f", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/a6c8ddb584ab823370cef00446c1d8f95b01311f", "committedDate": "2020-07-06T00:39:43Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "895340beeefcb1a8cb9a36e6bcd5dc93fa8dccae", "author": {"user": {"login": "Ax1an", "name": "Ax1an"}}, "url": "https://github.com/apache/skywalking/commit/895340beeefcb1a8cb9a36e6bcd5dc93fa8dccae", "committedDate": "2020-07-06T03:53:44Z", "message": "update oap.yaml"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNzYwNTIx", "url": "https://github.com/apache/skywalking/pull/5028#pullrequestreview-442760521", "createdAt": "2020-07-06T03:57:48Z", "commit": {"oid": "895340beeefcb1a8cb9a36e6bcd5dc93fa8dccae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2035, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}