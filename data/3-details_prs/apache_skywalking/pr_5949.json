{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyMzIwNTY0", "number": 5949, "title": "Support Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters.", "bodyText": "Update the documentation to include this new feature.\n\n\n Update the CHANGES log.\n\n\nKafka provides \"MirrorMaker 2.0(MM2)\" which leverages the Connect framework to replicate topics between Kafka clusters. This is realy helpful when handling large-scaled services/Multiple Data Centers/Edge Computing.\nWhen skywalking cluster deployed in a Data Center(\"DC1\" for example) and the topics mirrored from other Data Centers will be renamed based on the aliases(\"DC2.skywalking-metrics etc.\"):\nhttps://github.com/apache/kafka/tree/trunk/connect/mirror#remote-topics\nAdding support to oap kafka module for the renamed topics, set the aliases via application.yml or environment variables. This feature need to set up an oap server for each mirrored Kafka cluster.", "createdAt": "2020-12-04T06:29:04Z", "url": "https://github.com/apache/skywalking/pull/5949", "merged": true, "mergeCommit": {"oid": "6eb5648ba8928a73d5ca22ef7d36b40d08d86c8e"}, "closed": true, "closedAt": "2020-12-06T09:10:31Z", "author": {"login": "osiriswd"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdixEQ8AH2gAyNTMyMzIwNTY0OmEzODAzZGI1ZGY1ODJmYzE4ODJlNDE2NzNkYjU1MmQxNjU2MGQ4NWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdjcsOfAFqTU0NTY4MjM1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a3803db5df582fc1882e41673db552d16560d85f", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/a3803db5df582fc1882e41673db552d16560d85f", "committedDate": "2020-12-04T05:40:40Z", "message": "Update KafkaFetcherConfig.java\n\nAdd support for Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a535854eb0b30e0d113dc6a4674a74c970984d3d", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/a535854eb0b30e0d113dc6a4674a74c970984d3d", "committedDate": "2020-12-04T06:05:04Z", "message": "Update backend-fetcher.md\n\nAdd support for Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0Njk2ODU5", "url": "https://github.com/apache/skywalking/pull/5949#pullrequestreview-544696859", "createdAt": "2020-12-04T06:54:59Z", "commit": {"oid": "a535854eb0b30e0d113dc6a4674a74c970984d3d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwNjo1NDo1OVrOH_DSVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwNjo1NToyOFrOH_DTEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTg3NjE4Mw==", "bodyText": "I can't find the place using these, have you submitted all codes?", "url": "https://github.com/apache/skywalking/pull/5949#discussion_r535876183", "createdAt": "2020-12-04T06:54:59Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-fetcher-plugin/kafka-fetcher-plugin/src/main/java/org/apache/skywalking/oap/server/analyzer/agent/kafka/module/KafkaFetcherConfig.java", "diffHunk": "@@ -84,5 +84,29 @@\n     private int kafkaHandlerThreadPoolSize;\n \n     private int kafkaHandlerThreadPoolQueueSize;\n-\n+    \n+    private String MM2SourceAlias = \"\";\n+\n+    private String MM2SourceSeparator = \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a535854eb0b30e0d113dc6a4674a74c970984d3d"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTg3NjM3MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            When useing Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters, you can set the source Kafka Cluster alias(MM2SourceAlias) and separator(MM2SourceSeparator) according to your Kafka MirrorMaker config:\n          \n          \n            \n            When use Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters, you can set the source Kafka Cluster alias(MM2SourceAlias) and separator(MM2SourceSeparator) according to your Kafka MirrorMaker config.", "url": "https://github.com/apache/skywalking/pull/5949#discussion_r535876371", "createdAt": "2020-12-04T06:55:28Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -122,3 +122,22 @@ kafka-fetcher:\n       enable.auto.commit: true\n       ...\n ```\n+\n+When useing Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters, you can set the source Kafka Cluster alias(MM2SourceAlias) and separator(MM2SourceSeparator) according to your Kafka MirrorMaker config:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a535854eb0b30e0d113dc6a4674a74c970984d3d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0Njk3NjMy", "url": "https://github.com/apache/skywalking/pull/5949#pullrequestreview-544697632", "createdAt": "2020-12-04T06:56:53Z", "commit": {"oid": "a535854eb0b30e0d113dc6a4674a74c970984d3d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwNjo1Njo1M1rOH_DVeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwNjo1Njo1M1rOH_DVeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTg3Njk4Ng==", "bodyText": "Are you trying to hijack the get method? I recommend you don't do this. Put the logic in the provider, please.", "url": "https://github.com/apache/skywalking/pull/5949#discussion_r535876986", "createdAt": "2020-12-04T06:56:53Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-fetcher-plugin/kafka-fetcher-plugin/src/main/java/org/apache/skywalking/oap/server/analyzer/agent/kafka/module/KafkaFetcherConfig.java", "diffHunk": "@@ -84,5 +84,29 @@\n     private int kafkaHandlerThreadPoolSize;\n \n     private int kafkaHandlerThreadPoolQueueSize;\n-\n+    \n+    private String MM2SourceAlias = \"\";\n+\n+    private String MM2SourceSeparator = \"\";\n+    \n+    public String getTopicNameOfMetrics() {\n+        return this.getMM2SourceAlias() + this.getMM2SourceSeparator() + this.topicNameOfMetrics;\n+    }\n+\n+    public String getTopicNameOfProfiling() {\n+        return this.getMM2SourceAlias() + this.getMM2SourceSeparator() + this.topicNameOfProfiling;\n+    }\n+\n+    public String getTopicNameOfTracingSegments() {\n+        return this.getMM2SourceAlias() + this.getMM2SourceSeparator() + this.topicNameOfTracingSegments;\n+    }\n+\n+    public String getTopicNameOfManagements() {\n+        return this.getMM2SourceAlias() + this.getMM2SourceSeparator() + this.topicNameOfManagements;\n+    }\n+\n+    public String getTopicNameOfMeters() {\n+        return this.getMM2SourceAlias() + this.getMM2SourceSeparator() + this.topicNameOfMeters;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a535854eb0b30e0d113dc6a4674a74c970984d3d"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e2a2764d4782a528b293897ec00cacb6c316307", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/8e2a2764d4782a528b293897ec00cacb6c316307", "committedDate": "2020-12-04T07:17:33Z", "message": "Update KafkaFetcherConfig.java\n\nSupport Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters. Move logic to the provider."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06c6211d8494756cb919a367b13ed9bc7800094a", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/06c6211d8494756cb919a367b13ed9bc7800094a", "committedDate": "2020-12-04T07:19:35Z", "message": "Update JVMMetricsHandler.java\n\nSupport Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50c6244edfdb91c484eb9c0ab6913df3da2abff4", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/50c6244edfdb91c484eb9c0ab6913df3da2abff4", "committedDate": "2020-12-04T07:20:12Z", "message": "Update MeterServiceHandler.java\n\nSupport Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dec9260797525440a1e2243ac616a9bdf1f85a14", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/dec9260797525440a1e2243ac616a9bdf1f85a14", "committedDate": "2020-12-04T07:20:41Z", "message": "Update ProfileTaskHandler.java\n\nSupport Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30bd26926dce18693c864e4b1b32fb46abec9fab", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/30bd26926dce18693c864e4b1b32fb46abec9fab", "committedDate": "2020-12-04T07:21:07Z", "message": "Update ServiceManagementHandler.java\n\nSupport Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b213ea80fd7a0b9e5f9e7d9cae7ceac8ffeb8ba", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/5b213ea80fd7a0b9e5f9e7d9cae7ceac8ffeb8ba", "committedDate": "2020-12-04T07:21:31Z", "message": "Update TraceSegmentHandler.java\n\nSupport Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b235337019d0f54cd2a5a1107225bbbce47ce88", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/2b235337019d0f54cd2a5a1107225bbbce47ce88", "committedDate": "2020-12-04T07:22:34Z", "message": "Update docs/en/setup/backend/backend-fetcher.md\n\nCo-authored-by: \u5434\u665f Wu Sheng <wu.sheng@foxmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2735bd2ef9f64ca9f4fbe337cdac2ed5fb2dafd4", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/2735bd2ef9f64ca9f4fbe337cdac2ed5fb2dafd4", "committedDate": "2020-12-04T07:24:57Z", "message": "Update CHANGES.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "571637daf68e9b334548b7db73bb068906ad8a36", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/571637daf68e9b334548b7db73bb068906ad8a36", "committedDate": "2020-12-04T15:07:08Z", "message": "Update backend-fetcher.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "692281d3acae1ac923cd5ee808adb45454b95f4a", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/692281d3acae1ac923cd5ee808adb45454b95f4a", "committedDate": "2020-12-04T15:08:18Z", "message": "Update KafkaFetcherConfig.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa4ed93dd90c010480b3cebbd3b55785154cd4bf", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/aa4ed93dd90c010480b3cebbd3b55785154cd4bf", "committedDate": "2020-12-04T15:09:09Z", "message": "Update JVMMetricsHandler.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0488077b27112ba01e9165b053049d4a9017045", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/b0488077b27112ba01e9165b053049d4a9017045", "committedDate": "2020-12-04T15:09:46Z", "message": "Update MeterServiceHandler.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac671c705f3be1e685f1e28dd04ae8d448fafee9", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/ac671c705f3be1e685f1e28dd04ae8d448fafee9", "committedDate": "2020-12-04T15:10:23Z", "message": "Update ProfileTaskHandler.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa252384d320b807a43ae3a87057691ddb75c64c", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/fa252384d320b807a43ae3a87057691ddb75c64c", "committedDate": "2020-12-04T15:10:52Z", "message": "Update ServiceManagementHandler.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67c22ac1699e62ad431a3b2bc28f053b2ba906bb", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/67c22ac1699e62ad431a3b2bc28f053b2ba906bb", "committedDate": "2020-12-04T15:12:15Z", "message": "Update TraceSegmentHandler.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfb47258a85d2d940e5a52028c91424336de2a98", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/cfb47258a85d2d940e5a52028c91424336de2a98", "committedDate": "2020-12-05T08:44:15Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NTUzMjc3", "url": "https://github.com/apache/skywalking/pull/5949#pullrequestreview-545553277", "createdAt": "2020-12-05T09:08:32Z", "commit": {"oid": "cfb47258a85d2d940e5a52028c91424336de2a98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwOTowODozM1rOH_ug6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwOTowODozM1rOH_ug6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjU4NDQyNA==", "bodyText": "I recommend adding a link refer to Kafka mirroring docs.", "url": "https://github.com/apache/skywalking/pull/5949#discussion_r536584424", "createdAt": "2020-12-05T09:08:33Z", "author": {"login": "dmsolr"}, "path": "docs/en/setup/backend/backend-fetcher.md", "diffHunk": "@@ -122,3 +122,21 @@ kafka-fetcher:\n       enable.auto.commit: true\n       ...\n ```\n+\n+When use Kafka MirrorMaker 2.0 to replicate topics between Kafka clusters, you can set the source Kafka Cluster alias(mm2SourceAlias) and separator(mm2SourceSeparator) according to your Kafka MirrorMaker config.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cfb47258a85d2d940e5a52028c91424336de2a98"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea6bad2da27d0223b87f02982a49ab0bc0f56b4f", "author": {"user": {"login": "osiriswd", "name": "Wu Di"}}, "url": "https://github.com/apache/skywalking/commit/ea6bad2da27d0223b87f02982a49ab0bc0f56b4f", "committedDate": "2020-12-06T08:00:25Z", "message": "Update backend-fetcher.md\n\nAdding a link refer to Kafka mirroring docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb87cc165855230467856aca35e2404bc9df2704", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/cb87cc165855230467856aca35e2404bc9df2704", "committedDate": "2020-12-06T08:21:49Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NjgxNzgy", "url": "https://github.com/apache/skywalking/pull/5949#pullrequestreview-545681782", "createdAt": "2020-12-06T08:22:11Z", "commit": {"oid": "cb87cc165855230467856aca35e2404bc9df2704"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NjgyMzUw", "url": "https://github.com/apache/skywalking/pull/5949#pullrequestreview-545682350", "createdAt": "2020-12-06T08:30:14Z", "commit": {"oid": "cb87cc165855230467856aca35e2404bc9df2704"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1427, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}