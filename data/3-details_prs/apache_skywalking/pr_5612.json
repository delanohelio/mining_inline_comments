{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1OTAzMzMy", "number": 5612, "title": "fix INEFFICIENT_KEYSET_ITERATOR", "bodyText": "Please answer these questions before submitting a pull request\n\n\nWhy submit this pull request?\n\n\n Bug fix\n\n\n New feature provided\n\n\n Improve performance\n\n\nRelated issues\n\n\n\nBug fix\n\nBug description.\n\nAccessing a value using a key that was retrieved from a keySet iterator. It is more efficient to use an iterator on the entrySet of the map, avoiding the extra HashMap.get(key) lookup.\n\nHow to fix?\n\nreplace with entrySet\n\nNew feature or improvement\n\nDescribe the details and related test reports.", "createdAt": "2020-10-01T02:20:43Z", "url": "https://github.com/apache/skywalking/pull/5612", "merged": true, "mergeCommit": {"oid": "a5f405296597a5b8b18adbcb244319b00b493599"}, "closed": true, "closedAt": "2020-10-06T13:44:24Z", "author": {"login": "x22x22"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOHzI1AH2gAyNDk1OTAzMzMyOmUzZGIzZTJmM2UzYjYwZjViZGFiOTI3NjY0NDdiMjBiMjgwMzY4ZDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdP4pmIgFqTUwMjk4MDAzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e3db3e2f3e3b60f5bdab92766447b20b280368d2", "author": {"user": {"login": "x22x22", "name": "Kdump"}}, "url": "https://github.com/apache/skywalking/commit/e3db3e2f3e3b60f5bdab92766447b20b280368d2", "committedDate": "2020-10-01T02:17:22Z", "message": "fix INEFFICIENT_KEYSET_ITERATOR"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNDk2NzAw", "url": "https://github.com/apache/skywalking/pull/5612#pullrequestreview-500496700", "createdAt": "2020-10-01T15:58:40Z", "commit": {"oid": "e3db3e2f3e3b60f5bdab92766447b20b280368d2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00e76028913ff6d6b082fe8e7f045bf4796767f9", "author": {"user": {"login": "x22x22", "name": "Kdump"}}, "url": "https://github.com/apache/skywalking/commit/00e76028913ff6d6b082fe8e7f045bf4796767f9", "committedDate": "2020-10-04T03:05:59Z", "message": "fix code style issue."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a10062536bba60ceabb677e1cacf251d73eb4b62", "author": {"user": {"login": "x22x22", "name": "Kdump"}}, "url": "https://github.com/apache/skywalking/commit/a10062536bba60ceabb677e1cacf251d73eb4b62", "committedDate": "2020-10-04T03:22:09Z", "message": "Merge branch 'master' into fix-INEFFICIENT_KEYSET_ITERATOR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf2cf8db9a5b358c74e285bde8da4d4789fca1f2", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/cf2cf8db9a5b358c74e285bde8da4d4789fca1f2", "committedDate": "2020-10-06T10:03:24Z", "message": "Merge branch 'master' into fix-INEFFICIENT_KEYSET_ITERATOR"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNzc5MDUx", "url": "https://github.com/apache/skywalking/pull/5612#pullrequestreview-502779051", "createdAt": "2020-10-06T10:03:34Z", "commit": {"oid": "a10062536bba60ceabb677e1cacf251d73eb4b62"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyOTgwMDMy", "url": "https://github.com/apache/skywalking/pull/5612#pullrequestreview-502980032", "createdAt": "2020-10-06T13:46:12Z", "commit": {"oid": "cf2cf8db9a5b358c74e285bde8da4d4789fca1f2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxMzo0NjoxM1rOHdHZkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxMzo0NjoxM1rOHdHZkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDI5MTk4Nw==", "bodyText": "Well, I'm late for just a second \ud83e\udd23 but this doesn't fix what you said in the comment\n\nAccessing a value using a key that was retrieved from a keySet iterator. It is more efficient to use an iterator on the entrySet of the map, avoiding the extra HashMap.get(key) lookup.\n\n\"avoiding the extra HashMap.get(key) lookup.\", you are still looking up with the key, should replace logs.get(entries.getKey()) entries.getValue()", "url": "https://github.com/apache/skywalking/pull/5612#discussion_r500291987", "createdAt": "2020-10-06T13:46:13Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/optional-plugins/customize-enhance-plugin/src/main/java/org/apache/skywalking/apm/plugin/customize/interceptor/BaseInterceptorMethods.java", "diffHunk": "@@ -56,15 +56,14 @@ void beforeMethod(Method method, Object[] allArguments) {\n                     }\n                 }\n                 if (tags != null && !tags.isEmpty()) {\n-                    for (String key : tags.keySet()) {\n-                        String expression = tags.get(key);\n-                        spanTags.put(key, CustomizeExpression.parseExpression(expression, context));\n+                    for (Map.Entry<String, String> expression: tags.entrySet()) {\n+                        spanTags.put(expression.getKey(), CustomizeExpression.parseExpression(expression.getValue(), context));\n                     }\n                 }\n                 if (logs != null && !logs.isEmpty()) {\n-                    for (String key : logs.keySet()) {\n-                        String expression = logs.get(key);\n-                        spanLogs.put(key, CustomizeExpression.parseExpression(expression, context));\n+                    for (Map.Entry<String, String> entries : logs.entrySet()) {\n+                        String expression = logs.get(entries.getKey());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf2cf8db9a5b358c74e285bde8da4d4789fca1f2"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1775, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}