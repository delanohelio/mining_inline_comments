{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2MjYyMzM1", "number": 5416, "reviewThreads": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyMDoxOVrOEeWhGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwODo1ODo0NFrOEgld2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjYxNjU2OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/ExceptionAnalyzerStrategy.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyMDoxOVrOHJ9MZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyMDoxOVrOHJ9MZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMTgzMA==", "bodyText": "Use annotation.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r480201830", "createdAt": "2020-08-31T15:20:19Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/ExceptionAnalyzerStrategy.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser;\n+\n+import lombok.Getter;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.AnyExceptionAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.EntryFirstExceptionAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.ExceptionAnalyzer;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * define the strategy to analysis segment status\n+ */\n+public enum ExceptionAnalyzerStrategy {\n+    ANY(AnyExceptionAnalyzer.class),\n+\n+    ENTRY_FIRST(EntryFirstExceptionAnalyzer.class);\n+\n+    private final Logger log = LoggerFactory.getLogger(ExceptionAnalyzerStrategy.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjYyNTQ0OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/ExceptionAnalyzerStrategy.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyMjoyOVrOHJ9RqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyMjoyOVrOHJ9RqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMzE3Ng==", "bodyText": "Even reflect cost is limited, but it is not necessary. ExceptionAnalyzer implementors are stateless, you could have the instance in the constructor directly.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r480203176", "createdAt": "2020-08-31T15:22:29Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/ExceptionAnalyzerStrategy.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser;\n+\n+import lombok.Getter;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.AnyExceptionAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.EntryFirstExceptionAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.ExceptionAnalyzer;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * define the strategy to analysis segment status\n+ */\n+public enum ExceptionAnalyzerStrategy {\n+    ANY(AnyExceptionAnalyzer.class),\n+\n+    ENTRY_FIRST(EntryFirstExceptionAnalyzer.class);\n+\n+    private final Logger log = LoggerFactory.getLogger(ExceptionAnalyzerStrategy.class);\n+    @Getter\n+    private ExceptionAnalyzer exceptionAnalyzer;\n+\n+    ExceptionAnalyzerStrategy(final Class<? extends ExceptionAnalyzer> clazz) {\n+        try {\n+            this.exceptionAnalyzer = clazz.newInstance();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjYyNjU0OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/ExceptionAnalyzerStrategy.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyMjo0OFrOHJ9SSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyMjo0OFrOHJ9SSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMzMzNg==", "bodyText": "Use final and annotation for the constructor directly.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r480203336", "createdAt": "2020-08-31T15:22:48Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/ExceptionAnalyzerStrategy.java", "diffHunk": "@@ -0,0 +1,58 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser;\n+\n+import lombok.Getter;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.AnyExceptionAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.EntryFirstExceptionAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.ExceptionAnalyzer;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+/**\n+ * define the strategy to analysis segment status\n+ */\n+public enum ExceptionAnalyzerStrategy {\n+    ANY(AnyExceptionAnalyzer.class),\n+\n+    ENTRY_FIRST(EntryFirstExceptionAnalyzer.class);\n+\n+    private final Logger log = LoggerFactory.getLogger(ExceptionAnalyzerStrategy.class);\n+    @Getter\n+    private ExceptionAnalyzer exceptionAnalyzer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjYzMjYxOnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/AnalyzerModuleConfig.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyNDoyMVrOHJ9V_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyNDoyMVrOHJ9V_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwNDI4NA==", "bodyText": "I think the initializer has supported the enum. You don't need to do this.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r480204284", "createdAt": "2020-08-31T15:24:21Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/AnalyzerModuleConfig.java", "diffHunk": "@@ -80,9 +83,19 @@\n     private final String configPath = \"meter-receive-config\";\n \n     /**\n-     * Sample the trace segment if the segment has span(s) tagged as error status, and ignore the sampleRate configuration.\n+     * Sample the trace segment if the segment has span(s) tagged as error status, and ignore the sampleRate\n+     * configuration.\n      */\n     @Setter\n     @Getter\n     private boolean forceSampleErrorSegment = true;\n+\n+    /**\n+     * the strategy is to extract the status of segment from span collection\n+     *\n+     * @see ExceptionAnalyzerStrategy\n+     */\n+    @Setter\n+    @Getter\n+    private String exceptionAnalyzerStrategy = ENTRY_FIRST.name();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjcxODgyOnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/ExceptionAnalyzer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNTo0MjoyMlrOHJ-H7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNTo0MjoyMlrOHJ-H7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIxNzA2OQ==", "bodyText": "This is a low-performance method design. In the SegmentAnalysisListener#parseSegment, we have the span list iteration already, this interface forces the implementation to do it again.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                boolean isError(SegmentObject segmentObject);\n          \n          \n            \n                boolean isError(SpanObject span);", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r480217069", "createdAt": "2020-08-31T15:42:22Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/ExceptionAnalyzer.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SegmentObject;\n+\n+/**\n+ * judge the status of spanObject\n+ */\n+public interface ExceptionAnalyzer {\n+    /**\n+     * extract error status from the span collection in segmentObject\n+     */\n+    boolean isError(SegmentObject segmentObject);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjcxOTQzOnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/ExceptionAnalyzer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNTo0MjoyNlrOHJ-IQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNTo0MjoyNlrOHJ-IQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIxNzE1NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public interface ExceptionAnalyzer {\n          \n          \n            \n            public interface SegmentStatusAnalyzer {", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r480217154", "createdAt": "2020-08-31T15:42:26Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/ExceptionAnalyzer.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SegmentObject;\n+\n+/**\n+ * judge the status of spanObject\n+ */\n+public interface ExceptionAnalyzer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjc1NTE4OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/configuration-vocabulary.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNTo0OTo0OFrOHJ-ctg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNTo0OTo0OFrOHJ-ctg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIyMjM5MA==", "bodyText": "Also, notice, ENTRY_FIRST is not the right term. The entry span could be not the first, and vice versa.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r480222390", "createdAt": "2020-08-31T15:49:48Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/configuration-vocabulary.md", "diffHunk": "@@ -134,6 +134,7 @@ core|default|role|Option values, `Mixed/Receiver/Aggregator`. **Receiver** mode\n | - | -| sampleRate|Sampling rate for receiving trace. The precision is 1/10000. 10000 means 100% sample in default.|SW_TRACE_SAMPLE_RATE|10000|\n | - | - |slowDBAccessThreshold|The slow database access thresholds. Unit ms.|SW_SLOW_DB_THRESHOLD|default:200,mongodb:100|\n | - | - |forceSampleErrorSegment|When sampling mechanism activated, this config would make the error status segment sampled, ignoring the sampling rate.|SW_FORCE_SAMPLE_ERROR_SEGMENT|true|\n+| - | - |exceptionAnalyzerStrategy|Define how to extract segment status.If the exceptionAnalyzerStrategy equals to ENTRY_FIRST, the final status would be follow entry span status.Otherwise,the status would be error if the status of any spans is error. |SW_EXCEPTION_ANALYZER_STRATEGY|ENTRY_FIRST|", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwODk3NzQ5OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-plugins/exception-ignore-plugin/src/main/java/org/apache/skywalking/apm/plugin/exception/ignore/ExceptionIgnorerService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNToyNDozOFrOHK73AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNTo1OToxN1rOHK9WSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTIyODU0NQ==", "bodyText": "I don't think we discussed this implementation before. Don't make 2 features in one PR.\nThis implementation should be discussed on the mail list, because, you should notice, the span#occurError could be called separately, such as based on HTTP response code. This logic could override it incorrectly, if HTTP response code == 500 and exception occurs.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r481228545", "createdAt": "2020-09-01T15:24:38Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/optional-plugins/exception-ignore-plugin/src/main/java/org/apache/skywalking/apm/plugin/exception/ignore/ExceptionIgnorerService.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.exception.ignore;\n+\n+import com.google.common.collect.ImmutableSet;\n+import com.google.common.reflect.ClassPath;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.context.DefaultExceptionIgnorerService;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractTracingSpan;\n+import org.apache.skywalking.apm.agent.core.plugin.PluginBootstrap;\n+import org.apache.skywalking.apm.toolkit.trace.IgnoredException;\n+import org.apache.skywalking.apm.util.StringUtil;\n+\n+import static org.apache.skywalking.apm.plugin.exception.ignore.ExceptionAnalyzerConfig.Plugin.IgnoredException.IGNORED_EXCEPTION_CLASS_NAMES;\n+import static org.apache.skywalking.apm.plugin.exception.ignore.ExceptionAnalyzerConfig.Plugin.IgnoredException.IGNORED_EXCEPTION_SCAN_SCOPE;\n+\n+@OverrideImplementor(DefaultExceptionIgnorerService.class)\n+public class ExceptionIgnorerService extends DefaultExceptionIgnorerService {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTI1MjkzNg==", "bodyText": "now logic is only adjust status when throw ignore exception,\nfirst we define 2 kinds of exception. IgnoreException and OtherException\n\nif response code is 500 and don't  throw exception ,the final status is error.\nif response code is 500  and throw OtherException,the final status is errror.\nif response code is 500  and throw IgnoreException,the final status is not error.\nfor example in spring mvc, maybe throw exception would be cause response code is 500, if the exception could be ignored,the span final staus would be not error\n\ni would push a new pr about the feature", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r481252936", "createdAt": "2020-09-01T15:59:17Z", "author": {"login": "EvanLjp"}, "path": "apm-sniffer/optional-plugins/exception-ignore-plugin/src/main/java/org/apache/skywalking/apm/plugin/exception/ignore/ExceptionIgnorerService.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.exception.ignore;\n+\n+import com.google.common.collect.ImmutableSet;\n+import com.google.common.reflect.ClassPath;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import org.apache.skywalking.apm.agent.core.boot.OverrideImplementor;\n+import org.apache.skywalking.apm.agent.core.context.DefaultExceptionIgnorerService;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractTracingSpan;\n+import org.apache.skywalking.apm.agent.core.plugin.PluginBootstrap;\n+import org.apache.skywalking.apm.toolkit.trace.IgnoredException;\n+import org.apache.skywalking.apm.util.StringUtil;\n+\n+import static org.apache.skywalking.apm.plugin.exception.ignore.ExceptionAnalyzerConfig.Plugin.IgnoredException.IGNORED_EXCEPTION_CLASS_NAMES;\n+import static org.apache.skywalking.apm.plugin.exception.ignore.ExceptionAnalyzerConfig.Plugin.IgnoredException.IGNORED_EXCEPTION_SCAN_SCOPE;\n+\n+@OverrideImplementor(DefaultExceptionIgnorerService.class)\n+public class ExceptionIgnorerService extends DefaultExceptionIgnorerService {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTIyODU0NQ=="}, "originalCommit": null, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODQ1ODc3OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/AnySpanSegmentStatusAnalyzer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzozNjo0M1rOHMZ6oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzozNjo0M1rOHMZ6oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc2OTU2OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public class AnySpanSegmentStatusAnalyzer implements SegmentStatusAnalyzer {\n          \n          \n            \n            public class FromSpanStatus implements SegmentStatusAnalyzer {", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r482769569", "createdAt": "2020-09-03T07:36:43Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/AnySpanSegmentStatusAnalyzer.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+\n+public class AnySpanSegmentStatusAnalyzer implements SegmentStatusAnalyzer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eaf402b0bc2f41354dd45be5cdbf40cb182c311"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODQ2NzcyOnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/SegmentStatusAnalyzer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzozODo1OFrOHMZ__g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzozODo1OFrOHMZ__g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc3MDk0Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * judge the status of spanObject\n          \n          \n            \n             * The SegmentStatusAnalyzer implementations provide different strategies for determining the segment status from the status of spans.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r482770942", "createdAt": "2020-09-03T07:38:58Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/SegmentStatusAnalyzer.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+\n+/**\n+ * judge the status of spanObject", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eaf402b0bc2f41354dd45be5cdbf40cb182c311"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODQ3MzM1OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/SegmentStatusStrategy.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzo0MDoxN1rOHMaDPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzo0MDoxN1rOHMaDPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc3MTc3Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * define the strategy to analysis segment status\n          \n          \n            \n             * Define the available strategies for analysis segment status analysis.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r482771773", "createdAt": "2020-09-03T07:40:17Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/SegmentStatusStrategy.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser;\n+\n+import lombok.Getter;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.AnySpanSegmentStatusAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.FirstSpanSegmentStatusAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.SegmentStatusAnalyzer;\n+\n+/**\n+ * define the strategy to analysis segment status", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eaf402b0bc2f41354dd45be5cdbf40cb182c311"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODQ3NTUzOnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/SegmentStatusStrategy.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzo0MDo1MFrOHMaElQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzo0MDo1MFrOHMaElQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc3MjExNw==", "bodyText": "Use Lombok to replace this.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r482772117", "createdAt": "2020-09-03T07:40:50Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/SegmentStatusStrategy.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser;\n+\n+import lombok.Getter;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.AnySpanSegmentStatusAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.FirstSpanSegmentStatusAnalyzer;\n+import org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy.SegmentStatusAnalyzer;\n+\n+/**\n+ * define the strategy to analysis segment status\n+ */\n+public enum SegmentStatusStrategy {\n+    FROM_SPAN_STATUS(new AnySpanSegmentStatusAnalyzer()),\n+\n+    FROM_FIRST_SPAN_STATUS(new FirstSpanSegmentStatusAnalyzer());\n+\n+    @Getter\n+    private final SegmentStatusAnalyzer exceptionAnalyzer;\n+\n+    SegmentStatusStrategy(final SegmentStatusAnalyzer exceptionAnalyzer) {\n+        this.exceptionAnalyzer = exceptionAnalyzer;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eaf402b0bc2f41354dd45be5cdbf40cb182c311"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODQ4MzQwOnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FirstSpanSegmentStatusAnalyzer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzo0Mjo1NFrOHMaJbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzo0Mjo1NFrOHMaJbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc3MzM1Ng==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public class FirstSpanSegmentStatusAnalyzer extends AnySpanSegmentStatusAnalyzer {\n          \n          \n            \n            public class FromEntrySpan extends AnySpanSegmentStatusAnalyzer {\n          \n      \n    \n    \n  \n\nI think don't the first span makes sense. Usually, the entry span represents the RPC incoming call status.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r482773356", "createdAt": "2020-09-03T07:42:54Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FirstSpanSegmentStatusAnalyzer.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+\n+public class FirstSpanSegmentStatusAnalyzer extends AnySpanSegmentStatusAnalyzer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eaf402b0bc2f41354dd45be5cdbf40cb182c311"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODUwMjU2OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/configuration-vocabulary.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzo0Nzo0NFrOHMaU2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzo0Nzo0NFrOHMaU2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc3NjI4MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            | - | - |segmentStatusAnalysisStrategy|Extract the final segment status from span collection in segment. Logic or operation is as default within all span status.|SW_SEGMENT_STATUS_ANALYSIS_STRATEGY|FROM_SPAN_STATUS|\n          \n          \n            \n            | - | - |segmentStatusAnalysisStrategy|Determine the final segment status from the status of spans. Available values are `FROM_SPAN_STATUS` and `FROM_ENTRY_SPAN`. `FROM_SPAN_STATUS` represents the segment status would be error if any span is in error status. `FROM_ENTRY_SPAN` means the segment status would be determined by the status of entry spans only.|SW_SEGMENT_STATUS_ANALYSIS_STRATEGY|FROM_SPAN_STATUS|\n          \n      \n    \n    \n  \n\nNOTICE, the document is for end-users, you need to adjust the way of expression for them, rather than writing document from a developer.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r482776280", "createdAt": "2020-09-03T07:47:44Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/configuration-vocabulary.md", "diffHunk": "@@ -137,6 +137,7 @@ core|default|role|Option values, `Mixed/Receiver/Aggregator`. **Receiver** mode\n | - | -| sampleRate|Sampling rate for receiving trace. The precision is 1/10000. 10000 means 100% sample in default.|SW_TRACE_SAMPLE_RATE|10000|\n | - | - |slowDBAccessThreshold|The slow database access thresholds. Unit ms.|SW_SLOW_DB_THRESHOLD|default:200,mongodb:100|\n | - | - |forceSampleErrorSegment|When sampling mechanism activated, this config would make the error status segment sampled, ignoring the sampling rate.|SW_FORCE_SAMPLE_ERROR_SEGMENT|true|\n+| - | - |segmentStatusAnalysisStrategy|Extract the final segment status from span collection in segment. Logic or operation is as default within all span status.|SW_SEGMENT_STATUS_ANALYSIS_STRATEGY|FROM_SPAN_STATUS|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eaf402b0bc2f41354dd45be5cdbf40cb182c311"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTk2NjMyOnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromEntrySpan.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDowNDozNFrOHMoMvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDowNDozNFrOHMoMvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwMzU4Mg==", "bodyText": "Comments", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r483003582", "createdAt": "2020-09-03T14:04:34Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromEntrySpan.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanType;\n+\n+public class FromEntrySpan implements SegmentStatusAnalyzer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d17765ec3d3640cb5cfa0b7604a27412b85b384"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTk2NjY1OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromSpanStatus.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDowNDozOFrOHMoM8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDowNDozOFrOHMoM8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwMzYzMw==", "bodyText": "Comments", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r483003633", "createdAt": "2020-09-03T14:04:38Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromSpanStatus.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+\n+public class FromSpanStatus implements SegmentStatusAnalyzer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d17765ec3d3640cb5cfa0b7604a27412b85b384"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMzk4ODU4OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromFirstSpan.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMzo0OToxOVrOHNORlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMzo1MDo1M1rOHNOVUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyNzQxNA==", "bodyText": "This is entry not first span.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r483627414", "createdAt": "2020-09-04T13:49:19Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromFirstSpan.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanType;\n+\n+/**\n+ * FromFirstSpan means the status of the segment is the same as the status of the first span. Mostly, the first span is\n+ * an entry span. However, a tracing caused by a scheduled task, the first one should be a local span.\n+ */\n+public class FromFirstSpan implements SegmentStatusAnalyzer {\n+\n+    @Override\n+    public boolean isError(final SpanObject spanObject) {\n+        return spanObject.getSpanType().equals(SpanType.Entry) && spanObject.getIsError();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24c57a9ebe41f493129732825429d7531a8fe89c"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyODM3MA==", "bodyText": "This also indicates your UT has some issues. Please fix with this.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r483628370", "createdAt": "2020-09-04T13:50:53Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromFirstSpan.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanType;\n+\n+/**\n+ * FromFirstSpan means the status of the segment is the same as the status of the first span. Mostly, the first span is\n+ * an entry span. However, a tracing caused by a scheduled task, the first one should be a local span.\n+ */\n+public class FromFirstSpan implements SegmentStatusAnalyzer {\n+\n+    @Override\n+    public boolean isError(final SpanObject spanObject) {\n+        return spanObject.getSpanType().equals(SpanType.Entry) && spanObject.getIsError();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyNzQxNA=="}, "originalCommit": {"oid": "24c57a9ebe41f493129732825429d7531a8fe89c"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNDM2NjI5OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/SegmentStatusStrategy.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNToyMzoyNlrOHNR6EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNToyMzoyNlrOHNR6EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY4NjkyOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * FROM_FIRST_SPAN` means the segment status would be determined by the status of the first span only.\n          \n          \n            \n                 * `FROM_FIRST_SPAN` means the segment status would be determined by the status of the first span only.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r483686928", "createdAt": "2020-09-04T15:23:26Z", "author": {"login": "kezhenxu94"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/SegmentStatusStrategy.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+\n+/**\n+ * Define the available strategies for analysis segment status analysis.\n+ */\n+@AllArgsConstructor\n+public enum SegmentStatusStrategy {\n+    /**\n+     * `FROM_SPAN_STATUS` represents the segment status would be error if any span is in error status.\n+     */\n+    FROM_SPAN_STATUS(new FromSpanStatus()),\n+    /**\n+     * `FROM_ENTRY_SPAN` means the segment status would be determined by the status of entry spans only.\n+     *\n+     * @see FromEntrySpan\n+     */\n+    FROM_ENTRY_SPAN(new FromEntrySpan()),\n+    /**\n+     * FROM_FIRST_SPAN` means the segment status would be determined by the status of the first span only.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb60f42e798f37697f58169890bb191828e2b2bf"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNjAzMzg4OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromEntrySpan.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwODo1NDowNVrOHNgs0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwODo1NDowNVrOHNgs0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkyOTI5OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * FromEntrySpan means the status of the segment is the same as the status of the entry span. If the entry span does not\n          \n          \n            \n             * exist, the final state of the segment will be a success.\n          \n          \n            \n             * FromEntrySpan means the status of the segment is the same as the status of the entry span. If the entry span does not\n          \n          \n            \n             * exist, the final state of the segment is successful.", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r483929298", "createdAt": "2020-09-05T08:54:05Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/FromEntrySpan.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanType;\n+\n+/**\n+ * FromEntrySpan means the status of the segment is the same as the status of the entry span. If the entry span does not\n+ * exist, the final state of the segment will be a success.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00f7e1c1b7cd78b7053f74bd73b02403056d5504"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNjAzNzM3OnYy", "diffSide": "RIGHT", "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/SegmentStatusAnalyzer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwODo1ODo0NFrOHNgubw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNVQwODo1ODo0NFrOHNgubw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkyOTcxMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Determines whether the status of a span is passed to segment or not.\n          \n          \n            \n                 * @return false, if the status of the given status represents the fatal status of the whole segment based on the strategy", "url": "https://github.com/apache/skywalking/pull/5416#discussion_r483929711", "createdAt": "2020-09-05T08:58:44Z", "author": {"login": "wu-sheng"}, "path": "oap-server/analyzer/agent-analyzer/src/main/java/org/apache/skywalking/oap/server/analyzer/provider/trace/parser/listener/strategy/SegmentStatusAnalyzer.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.analyzer.provider.trace.parser.listener.strategy;\n+\n+import org.apache.skywalking.apm.network.language.agent.v3.SpanObject;\n+\n+/**\n+ * The SegmentStatusAnalyzer implementations provide different strategies for determining the segment status from the\n+ * status of spans.\n+ */\n+public interface SegmentStatusAnalyzer {\n+    /**\n+     * Determines whether the status of a span is passed to segment or not.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "61e1d57cc55f16d35beb2a0bf9c7fb05513d2cd6"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}