{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxNDg0NjAw", "number": 4546, "title": "Provide HTTP parameter in the profiling contet", "bodyText": "Please answer these questions before submitting pull request\n\n\nWhy submit this pull request?\n\n\n Bug fix\n\n\n New feature provided\n\n\n Improve performance\n\n\nRelated issues\n#4542", "createdAt": "2020-03-20T11:35:11Z", "url": "https://github.com/apache/skywalking/pull/4546", "merged": true, "mergeCommit": {"oid": "ace781ff490310de09313f19194281826f9064b0"}, "closed": true, "closedAt": "2020-03-22T09:19:58Z", "author": {"login": "mrproliu"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPe3b9gH2gAyMzkxNDg0NjAwOmEwNmM5ZTE5ZjM5ZjE4MzU2YTBmODJjMWI2OTY4ZTZjNDliOWRhNDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQGKAlAFqTM3ODk4NTQ2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a06c9e19f39f18356a0f82c1b6968e6c49b9da44", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/a06c9e19f39f18356a0f82c1b6968e6c49b9da44", "committedDate": "2020-03-20T11:32:39Z", "message": "Provide active HTTP parameter collection automatically in the profiling context"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f020112c13575572ebaebc88d2693b751b15d671", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/f020112c13575572ebaebc88d2693b751b15d671", "committedDate": "2020-03-20T11:36:11Z", "message": "Fix style check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c7d972421dd6ea93d5202f2343d19f770f8b867", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/6c7d972421dd6ea93d5202f2343d19f770f8b867", "committedDate": "2020-03-20T13:03:09Z", "message": "fix style error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ef76fa6f9bfbd83be3f319d2a63ec08d329d725", "author": {"user": {"login": "mrproliu", "name": null}}, "url": "https://github.com/apache/skywalking/commit/3ef76fa6f9bfbd83be3f319d2a63ec08d329d725", "committedDate": "2020-03-20T13:16:48Z", "message": "Merge branch 'master' into profile_active_http_param"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4NDgwODE2", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378480816", "createdAt": "2020-03-20T13:28:28Z", "commit": {"oid": "3ef76fa6f9bfbd83be3f319d2a63ec08d329d725"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzoyODoyOFrOF5Tpcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzoyODoyOFrOF5Tpcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzNTA1OA==", "bodyText": "We should not open this heavy object for this. Right now, only true/false should be opened.", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r395635058", "createdAt": "2020-03-20T13:28:28Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/AbstractTracerContext.java", "diffHunk": "@@ -115,4 +116,10 @@\n      */\n     void asyncStop(AsyncSpan span);\n \n+    /**\n+     * Get current context profiler\n+     * @return null if not profiling\n+     */\n+    ThreadProfiler profiler();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ef76fa6f9bfbd83be3f319d2a63ec08d329d725"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4NDgxOTA1", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378481905", "createdAt": "2020-03-20T13:29:48Z", "commit": {"oid": "3ef76fa6f9bfbd83be3f319d2a63ec08d329d725"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzoyOTo0OVrOF5TsiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzoyOTo0OVrOF5TsiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzNTg0OQ==", "bodyText": "This will cost unexpected resource. We should use span to delegate. Such as span#isProfiling.", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r395635849", "createdAt": "2020-03-20T13:29:49Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/ContextManager.java", "diffHunk": "@@ -224,4 +226,17 @@ public static RuntimeContext getRuntimeContext() {\n \n         return runtimeContext;\n     }\n+\n+    /**\n+     * Get current context profiling status\n+     * @return\n+     */\n+    public static ProfilingStatus getProfilingStatus() {\n+        final AbstractTracerContext context = get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ef76fa6f9bfbd83be3f319d2a63ec08d329d725"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4NDgyMzU0", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378482354", "createdAt": "2020-03-20T13:30:22Z", "commit": {"oid": "3ef76fa6f9bfbd83be3f319d2a63ec08d329d725"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzozMDoyMlrOF5Tt1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMzozMDoyMlrOF5Tt1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTYzNjE4Mg==", "bodyText": "I don't think we should open this.", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r395636182", "createdAt": "2020-03-20T13:30:22Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java", "diffHunk": "@@ -106,9 +107,9 @@\n     private final long createTime;\n \n     /**\n-     * profiling status\n+     * profiling data\n      */\n-    private volatile boolean profiling;\n+    private volatile ThreadProfiler profiler;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ef76fa6f9bfbd83be3f319d2a63ec08d329d725"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b99274c55c574bd6700253f9eec44040e8e2cea", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/3b99274c55c574bd6700253f9eec44040e8e2cea", "committedDate": "2020-03-21T04:09:48Z", "message": "Add profile status, storage it into TracingContext. simplify to get profiling method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa82ad6d3e78089e2213dc30ec919273f7bfeaac", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/aa82ad6d3e78089e2213dc30ec919273f7bfeaac", "committedDate": "2020-03-21T04:13:33Z", "message": "Change the profile status field name in TracingContext"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7428114c4ee326c536cfc2d6c0841e3b852f241", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/d7428114c4ee326c536cfc2d6c0841e3b852f241", "committedDate": "2020-03-21T12:59:12Z", "message": "Replace gone images"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTE3OTA4", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378917908", "createdAt": "2020-03-21T13:14:51Z", "commit": {"oid": "d7428114c4ee326c536cfc2d6c0841e3b852f241"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxMzoxNDo1MVrOF5paxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxMzozMToxOFrOF5pfbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk5MTc0OQ==", "bodyText": "either remove this or add descriptive comments", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r395991749", "createdAt": "2020-03-21T13:14:51Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/AbstractSpan.java", "diffHunk": "@@ -126,4 +126,11 @@\n     AbstractSpan start(long startTime);\n \n     AbstractSpan setPeer(String remotePeer);\n+\n+    /**\n+     * Check current context has profiling\n+     *\n+     * @return\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7428114c4ee326c536cfc2d6c0841e3b852f241"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk5MTg0Ng==", "bodyText": "PADDING? do you mean PENDING?", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r395991846", "createdAt": "2020-03-21T13:16:12Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatus.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Profile status, include entire profile cycle\n+ */\n+public enum ProfileStatus {\n+    /**\n+     * Profile not required\n+     */\n+    NONE,\n+\n+    /**\n+     * Prepare to profile, when {@link ProfileTask#getMinDurationThreshold()} is reached,\n+     * the status will be changed to profiling, and the thread snapshot will be started\n+     */\n+    PADDING,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7428114c4ee326c536cfc2d6c0841e3b852f241"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk5MTkyNg==", "bodyText": "either remove this or add descriptive comments", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r395991926", "createdAt": "2020-03-21T13:17:14Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatusReference.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Wrapper {@link ProfileStatus}, make sure {@link org.apache.skywalking.apm.agent.core.context.TracingContext} with {@link ThreadProfiler} have same reference with {@link ProfileStatus},\n+ * And only the profile module could change the status\n+ */\n+public class ProfileStatusReference {\n+\n+    private volatile ProfileStatus status;\n+\n+    private ProfileStatusReference(ProfileStatus status) {\n+        this.status = status;\n+    }\n+\n+    /**\n+     * Create with not watching\n+     * @return", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7428114c4ee326c536cfc2d6c0841e3b852f241"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk5MTk2OQ==", "bodyText": "ditto", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r395991969", "createdAt": "2020-03-21T13:17:41Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatusReference.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Wrapper {@link ProfileStatus}, make sure {@link org.apache.skywalking.apm.agent.core.context.TracingContext} with {@link ThreadProfiler} have same reference with {@link ProfileStatus},\n+ * And only the profile module could change the status\n+ */\n+public class ProfileStatusReference {\n+\n+    private volatile ProfileStatus status;\n+\n+    private ProfileStatusReference(ProfileStatus status) {\n+        this.status = status;\n+    }\n+\n+    /**\n+     * Create with not watching\n+     * @return\n+     */\n+    public static ProfileStatusReference createWithNone() {\n+        return new ProfileStatusReference(ProfileStatus.NONE);\n+    }\n+\n+    /**\n+     * Create with padding to profile\n+     * @return", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7428114c4ee326c536cfc2d6c0841e3b852f241"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk5Mjk0Mw==", "bodyText": "Config.Plugin.SpringMVC.COLLECT_HTTP_PARAMS", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r395992943", "createdAt": "2020-03-21T13:31:18Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/AbstractMethodInterceptor.java", "diffHunk": "@@ -185,6 +180,12 @@ public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allA\n                 ContextManager.getRuntimeContext().remove(CONTROLLER_METHOD_STACK_DEPTH);\n             }\n \n+            // Active HTTP parameter collection automatically in the profiling context.\n+            // https://github.com/apache/skywalking/issues/4542\n+            if (!Config.Plugin.Tomcat.COLLECT_HTTP_PARAMS && span.isProfiling()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d7428114c4ee326c536cfc2d6c0841e3b852f241"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/97460fb8630f8eb997f0e0958f6f499e7ddd1b76", "committedDate": "2020-03-21T14:14:56Z", "message": "resolve issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY4ODU0", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378968854", "createdAt": "2020-03-22T03:15:49Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoxNTo0OVrOF5s-Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoxNTo0OVrOF5s-Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA0OTk3MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Prepare to profile, when {@link ProfileTask#getMinDurationThreshold()} is reached,\n          \n          \n            \n                 * Prepare to profile, until {@link ProfileTask#getMinDurationThreshold()} reached,", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396049971", "createdAt": "2020-03-22T03:15:49Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatus.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Profile status, include entire profile cycle\n+ */\n+public enum ProfileStatus {\n+    /**\n+     * Profile not required\n+     */\n+    NONE,\n+\n+    /**\n+     * Prepare to profile, when {@link ProfileTask#getMinDurationThreshold()} is reached,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY4ODk3", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378968897", "createdAt": "2020-03-22T03:17:22Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoxNzoyMlrOF5s-ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoxNzoyMlrOF5s-ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDAyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * the status will be changed to profiling, and the thread snapshot will be started\n          \n          \n            \n                 * Once the status changed to profiling, the thread snapshot is officially started", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050026", "createdAt": "2020-03-22T03:17:22Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatus.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Profile status, include entire profile cycle\n+ */\n+public enum ProfileStatus {\n+    /**\n+     * Profile not required\n+     */\n+    NONE,\n+\n+    /**\n+     * Prepare to profile, when {@link ProfileTask#getMinDurationThreshold()} is reached,\n+     * the status will be changed to profiling, and the thread snapshot will be started", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY4OTQ0", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378968944", "createdAt": "2020-03-22T03:19:01Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoxOTowMlrOF5s-uA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoxOTowMlrOF5s-uA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDEwNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * or the current thread cannot take a thread snapshot operation again\n          \n          \n            \n                 * or the current thread isn't available.", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050104", "createdAt": "2020-03-22T03:19:02Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatus.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Profile status, include entire profile cycle\n+ */\n+public enum ProfileStatus {\n+    /**\n+     * Profile not required\n+     */\n+    NONE,\n+\n+    /**\n+     * Prepare to profile, when {@link ProfileTask#getMinDurationThreshold()} is reached,\n+     * the status will be changed to profiling, and the thread snapshot will be started\n+     */\n+    PENDING,\n+\n+    /**\n+     * Profile operation has been started, and dump thread snapshot will continue\n+     */\n+    PROFILING,\n+\n+    /**\n+     * The current {@link org.apache.skywalking.apm.agent.core.context.TracingContext} has finished executing,\n+     * or the current thread cannot take a thread snapshot operation again", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY4OTU0", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378968954", "createdAt": "2020-03-22T03:19:18Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoxOToxOFrOF5s-vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoxOToxOFrOF5s-vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDExMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * The current {@link org.apache.skywalking.apm.agent.core.context.TracingContext} has finished executing,\n          \n          \n            \n                 * The current {@link org.apache.skywalking.apm.agent.core.context.TracingContext} has finished,", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050111", "createdAt": "2020-03-22T03:19:18Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatus.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Profile status, include entire profile cycle\n+ */\n+public enum ProfileStatus {\n+    /**\n+     * Profile not required\n+     */\n+    NONE,\n+\n+    /**\n+     * Prepare to profile, when {@link ProfileTask#getMinDurationThreshold()} is reached,\n+     * the status will be changed to profiling, and the thread snapshot will be started\n+     */\n+    PENDING,\n+\n+    /**\n+     * Profile operation has been started, and dump thread snapshot will continue\n+     */\n+    PROFILING,\n+\n+    /**\n+     * The current {@link org.apache.skywalking.apm.agent.core.context.TracingContext} has finished executing,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY4OTk2", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378968996", "createdAt": "2020-03-22T03:20:46Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoyMDo0N1rOF5s--Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoyMDo0N1rOF5s--Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDE2OQ==", "bodyText": "I think there is another typo, pending", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050169", "createdAt": "2020-03-22T03:20:47Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatusReference.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Wrapper {@link ProfileStatus}, make sure {@link org.apache.skywalking.apm.agent.core.context.TracingContext} with {@link ThreadProfiler} have same reference with {@link ProfileStatus},\n+ * And only the profile module could change the status\n+ */\n+public class ProfileStatusReference {\n+\n+    private volatile ProfileStatus status;\n+\n+    private ProfileStatusReference(ProfileStatus status) {\n+        this.status = status;\n+    }\n+\n+    /**\n+     * Create with not watching\n+     */\n+    public static ProfileStatusReference createWithNone() {\n+        return new ProfileStatusReference(ProfileStatus.NONE);\n+    }\n+\n+    /**\n+     * Create with padding to profile\n+     */\n+    public static ProfileStatusReference createWithPadding() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY5MDY1", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378969065", "createdAt": "2020-03-22T03:22:57Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoyMjo1N1rOF5s_UA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzoyMjo1N1rOF5s_UA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDI1Ng==", "bodyText": "Why refer an issue here? Anything special?", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050256", "createdAt": "2020-03-22T03:22:57Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/AbstractMethodInterceptor.java", "diffHunk": "@@ -185,6 +180,12 @@ public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allA\n                 ContextManager.getRuntimeContext().remove(CONTROLLER_METHOD_STACK_DEPTH);\n             }\n \n+            // Active HTTP parameter collection automatically in the profiling context.\n+            // https://github.com/apache/skywalking/issues/4542", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY5MzE0", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378969314", "createdAt": "2020-03-22T03:30:25Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozMDoyNVrOF5tAjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozMDoyNVrOF5tAjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDU3Mg==", "bodyText": "Don't refer to issue, unless there is something special, because if don't follow this, we will have thousands of issue links in the codes.", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050572", "createdAt": "2020-03-22T03:30:25Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/TomcatInvokeInterceptor.java", "diffHunk": "@@ -83,32 +83,26 @@ public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allAr\n         SpanLayer.asHttp(span);\n \n         if (Config.Plugin.Tomcat.COLLECT_HTTP_PARAMS) {\n-            final Map<String, String[]> parameterMap = new HashMap<>();\n-            final org.apache.coyote.Request coyoteRequest = request.getCoyoteRequest();\n-            final Parameters parameters = coyoteRequest.getParameters();\n-            for (final Enumeration<String> names = parameters.getParameterNames(); names.hasMoreElements(); ) {\n-                final String name = names.nextElement();\n-                parameterMap.put(name, parameters.getParameterValues(name));\n-            }\n-\n-            if (!parameterMap.isEmpty()) {\n-                String tagValue = CollectionUtil.toString(parameterMap);\n-                tagValue = Config.Plugin.Http.HTTP_PARAMS_LENGTH_THRESHOLD > 0 ? StringUtil.cut(tagValue, Config.Plugin.Http.HTTP_PARAMS_LENGTH_THRESHOLD) : tagValue;\n-                Tags.HTTP.PARAMS.set(span, tagValue);\n-            }\n+            collectHttpParam(request, span);\n         }\n     }\n \n     @Override\n     public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n         Object ret) throws Throwable {\n+        Request request = (Request) allArguments[0];\n         HttpServletResponse response = (HttpServletResponse) allArguments[1];\n \n         AbstractSpan span = ContextManager.activeSpan();\n         if (IS_SERVLET_GET_STATUS_METHOD_EXIST && response.getStatus() >= 400) {\n             span.errorOccurred();\n             Tags.STATUS_CODE.set(span, Integer.toString(response.getStatus()));\n         }\n+        // Active HTTP parameter collection automatically in the profiling context.\n+        // https://github.com/apache/skywalking/issues/4542", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY5Mzky", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378969392", "createdAt": "2020-03-22T03:33:06Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozMzowN1rOF5tBHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozMzowN1rOF5tBHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDcxNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Profile not required\n          \n          \n            \n                 * No profile", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050716", "createdAt": "2020-03-22T03:33:07Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatus.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Profile status, include entire profile cycle\n+ */\n+public enum ProfileStatus {\n+    /**\n+     * Profile not required", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY5NDA3", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378969407", "createdAt": "2020-03-22T03:33:28Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozMzoyOFrOF5tBMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozMzoyOFrOF5tBMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDczNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Profile operation has been started, and dump thread snapshot will continue\n          \n          \n            \n                 * Profile operation has been started.", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050736", "createdAt": "2020-03-22T03:33:28Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatus.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Profile status, include entire profile cycle\n+ */\n+public enum ProfileStatus {\n+    /**\n+     * Profile not required\n+     */\n+    NONE,\n+\n+    /**\n+     * Prepare to profile, when {@link ProfileTask#getMinDurationThreshold()} is reached,\n+     * the status will be changed to profiling, and the thread snapshot will be started\n+     */\n+    PENDING,\n+\n+    /**\n+     * Profile operation has been started, and dump thread snapshot will continue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY5NDMy", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378969432", "createdAt": "2020-03-22T03:34:28Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozNDoyOVrOF5tBUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozNDoyOVrOF5tBUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDc2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public boolean isBeingWatched() {\n          \n          \n            \n                /**\n          \n          \n            \n                 * The profile monitoring is watching, wait for some profile conditions.\n          \n          \n            \n                 */\n          \n          \n            \n                public boolean isBeingWatched() {", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050769", "createdAt": "2020-03-22T03:34:29Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/profile/ProfileStatusReference.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.profile;\n+\n+/**\n+ * Wrapper {@link ProfileStatus}, make sure {@link org.apache.skywalking.apm.agent.core.context.TracingContext} with {@link ThreadProfiler} have same reference with {@link ProfileStatus},\n+ * And only the profile module could change the status\n+ */\n+public class ProfileStatusReference {\n+\n+    private volatile ProfileStatus status;\n+\n+    private ProfileStatusReference(ProfileStatus status) {\n+        this.status = status;\n+    }\n+\n+    /**\n+     * Create with not watching\n+     */\n+    public static ProfileStatusReference createWithNone() {\n+        return new ProfileStatusReference(ProfileStatus.NONE);\n+    }\n+\n+    /**\n+     * Create with padding to profile\n+     */\n+    public static ProfileStatusReference createWithPadding() {\n+        return new ProfileStatusReference(ProfileStatus.PENDING);\n+    }\n+\n+    public ProfileStatus get() {\n+        return this.status;\n+    }\n+\n+    public boolean isBeingWatched() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTY5NDk3", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378969497", "createdAt": "2020-03-22T03:36:32Z", "commit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozNjozM1rOF5tBow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQwMzozNjozM1rOF5tBow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA1MDg1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Check current context has profiling\n          \n          \n            \n                 * @return true if the span's owner(tracing context main thread) is been profiled.", "url": "https://github.com/apache/skywalking/pull/4546#discussion_r396050851", "createdAt": "2020-03-22T03:36:33Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/AbstractSpan.java", "diffHunk": "@@ -126,4 +126,9 @@\n     AbstractSpan start(long startTime);\n \n     AbstractSpan setPeer(String remotePeer);\n+\n+    /**\n+     * Check current context has profiling", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97460fb8630f8eb997f0e0958f6f499e7ddd1b76"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b68d43d5f71ae065263698de3a64662896698aa7", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/b68d43d5f71ae065263698de3a64662896698aa7", "committedDate": "2020-03-22T03:48:33Z", "message": "resole description issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9ebc3131009b193ca824ab06e3116640cb52b74", "author": {"user": {"login": "mrproliu", "name": null}}, "url": "https://github.com/apache/skywalking/commit/d9ebc3131009b193ca824ab06e3116640cb52b74", "committedDate": "2020-03-22T05:19:53Z", "message": "Merge branch 'master' into profile_active_http_param"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTg1MjUw", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378985250", "createdAt": "2020-03-22T09:16:54Z", "commit": {"oid": "d9ebc3131009b193ca824ab06e3116640cb52b74"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTg1NDYx", "url": "https://github.com/apache/skywalking/pull/4546#pullrequestreview-378985461", "createdAt": "2020-03-22T09:19:14Z", "commit": {"oid": "d9ebc3131009b193ca824ab06e3116640cb52b74"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2476, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}