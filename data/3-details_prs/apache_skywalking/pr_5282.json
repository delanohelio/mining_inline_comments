{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MjMyMTA2", "number": 5282, "title": "Super Size Dataset record index  es rolling step", "bodyText": "Please answer these questions before submitting a pull request\n\n\nWhy submit this pull request?\n\n\n Improve performance\n\n\nRelated issues\n#5251\n\n\n\nNew feature or improvement\n\nDescribe the details and related test reports.\nbalance es shards store", "createdAt": "2020-08-10T01:14:33Z", "url": "https://github.com/apache/skywalking/pull/5282", "merged": true, "mergeCommit": {"oid": "2df3c683baede7a0b7f24885ce1bbe48b13c7dac"}, "closed": true, "closedAt": "2020-08-10T06:49:12Z", "author": {"login": "EvanLjp"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchzg5-gH2gAyNDY1MjMyMTA2OjAwMmY0YzI1NzMzOTlhOTY2NDlhNjRmYjM5OWRjOGI3ZTgwY2QxNzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9bw91gH2gAyNDY1MjMyMTA2OjkwNTA1OTA4NmZkNWVmMTVmODllZGJkZTAwOGFmYTdiOGQ0YjNlNTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "002f4c2573399a96649a64fb399dc8b7e80cd175", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/002f4c2573399a96649a64fb399dc8b7e80cd175", "committedDate": "2020-05-16T09:46:41Z", "message": "add SuperDataset tag for add super size dataset shards config in es"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fead29fe6379c1784feb1e21b28888266242d69", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/3fead29fe6379c1784feb1e21b28888266242d69", "committedDate": "2020-05-16T13:40:59Z", "message": "explain the meaning of indexShardsNumber and superDatasetIndexShardsFactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f84bf3ea704ac9c0b7d751d6533d8ad25ba94625", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/f84bf3ea704ac9c0b7d751d6533d8ad25ba94625", "committedDate": "2020-05-17T08:19:36Z", "message": "code style format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9c0d17a67d7213e7426b1449410700079b0ac2a", "author": {"user": {"login": "EvanLjp", "name": "Evan"}}, "url": "https://github.com/apache/skywalking/commit/b9c0d17a67d7213e7426b1449410700079b0ac2a", "committedDate": "2020-05-17T08:35:47Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f176bdbb28a466f0683d341d7b5eb1782068438f", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/f176bdbb28a466f0683d341d7b5eb1782068438f", "committedDate": "2020-05-17T08:55:05Z", "message": "code style format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34df4295c55fb7343a4e3e3dc86ff417d44f0010", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/34df4295c55fb7343a4e3e3dc86ff417d44f0010", "committedDate": "2020-05-17T08:59:25Z", "message": "code style format and change notes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e698ddf0b0d522894d94b4f1143210afabffd8d5", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/e698ddf0b0d522894d94b4f1143210afabffd8d5", "committedDate": "2020-05-20T08:01:53Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52e21a287727aeffa241533f3c208a7b9c4fb215", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/52e21a287727aeffa241533f3c208a7b9c4fb215", "committedDate": "2020-05-27T13:54:44Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87cc6a2c405f3b31deaf8d5a47f718edd6c0eee5", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/87cc6a2c405f3b31deaf8d5a47f718edd6c0eee5", "committedDate": "2020-06-10T04:41:26Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39669e67a8b738f7cf5030b3277ddc1668a88835", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/39669e67a8b738f7cf5030b3277ddc1668a88835", "committedDate": "2020-06-22T09:47:59Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "172145bdc3ca85d0876cbd8f0b113c571fdb8c79", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/172145bdc3ca85d0876cbd8f0b113c571fdb8c79", "committedDate": "2020-07-12T14:33:34Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c32e00ae24a9f7ec30510ce292006172356a7cf", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/2c32e00ae24a9f7ec30510ce292006172356a7cf", "committedDate": "2020-07-14T07:36:38Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7be9f078d9264919eb1158e31c39fb2c5c3fdd0d", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/7be9f078d9264919eb1158e31c39fb2c5c3fdd0d", "committedDate": "2020-07-20T02:13:49Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bf0783eb1f479ba7c17bc0d5c44c9a1fc3bfd40", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/9bf0783eb1f479ba7c17bc0d5c44c9a1fc3bfd40", "committedDate": "2020-07-29T15:07:45Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2dd54c30375f24bc5f46f3a84a284893b0adb105", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/2dd54c30375f24bc5f46f3a84a284893b0adb105", "committedDate": "2020-08-01T09:14:36Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d67538404afe862216472843f94ec376bbd7a14", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/3d67538404afe862216472843f94ec376bbd7a14", "committedDate": "2020-08-09T14:50:36Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbb8b52a18226c11472c81ab332126ff700d581c", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/dbb8b52a18226c11472c81ab332126ff700d581c", "committedDate": "2020-08-10T01:12:52Z", "message": "add super dataset index day step"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTIzMzc2", "url": "https://github.com/apache/skywalking/pull/5282#pullrequestreview-463923376", "createdAt": "2020-08-10T01:17:07Z", "commit": {"oid": "dbb8b52a18226c11472c81ab332126ff700d581c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMToxNzowN1rOG9_VVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMToxNzowN1rOG9_VVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY1Mzk3Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                superDatasetDayStep: ${SW_SUPERDATASET_STORAGE_DAY_STEP:-1} # Represent the number of days in the super size dataset record index, the default value is the same as dayStep when the value lt 0\n          \n          \n            \n                superDatasetDayStep: ${SW_SUPERDATASET_STORAGE_DAY_STEP:-1} # Represent the number of days in the super size dataset record index, the default value is the same as dayStep when the value is less than 0\n          \n      \n    \n    \n  \n\nUse the full words in the comment :)", "url": "https://github.com/apache/skywalking/pull/5282#discussion_r467653973", "createdAt": "2020-08-10T01:17:07Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-bootstrap/src/main/resources/application.yml", "diffHunk": "@@ -101,6 +101,7 @@ storage:\n     password: ${SW_ES_PASSWORD:\"\"}\n     secretsManagementFile: ${SW_ES_SECRETS_MANAGEMENT_FILE:\"\"} # Secrets management file in the properties format includes the username, password, which are managed by 3rd party tool.\n     dayStep: ${SW_STORAGE_DAY_STEP:1} # Represent the number of days in the one minute/hour/day index.\n+    superDatasetDayStep: ${SW_SUPERDATASET_STORAGE_DAY_STEP:-1} # Represent the number of days in the super size dataset record index, the default value is the same as dayStep when the value lt 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbb8b52a18226c11472c81ab332126ff700d581c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTIzNDA1", "url": "https://github.com/apache/skywalking/pull/5282#pullrequestreview-463923405", "createdAt": "2020-08-10T01:17:18Z", "commit": {"oid": "dbb8b52a18226c11472c81ab332126ff700d581c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMToxNzoxOFrOG9_VbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMToxNzoxOFrOG9_VbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY1Mzk5Nw==", "bodyText": "Same here.", "url": "https://github.com/apache/skywalking/pull/5282#discussion_r467653997", "createdAt": "2020-08-10T01:17:18Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-bootstrap/src/main/resources/application.yml", "diffHunk": "@@ -119,6 +120,7 @@ storage:\n     trustStorePath: ${SW_STORAGE_ES_SSL_JKS_PATH:\"\"}\n     trustStorePass: ${SW_STORAGE_ES_SSL_JKS_PASS:\"\"}\n     dayStep: ${SW_STORAGE_DAY_STEP:1} # Represent the number of days in the one minute/hour/day index.\n+    superDatasetDayStep: ${SW_SUPERDATASET_STORAGE_DAY_STEP:-1} # Represent the number of days in the super size dataset record index, the default value is the same as dayStep when the value lt 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbb8b52a18226c11472c81ab332126ff700d581c"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTIzNDQz", "url": "https://github.com/apache/skywalking/pull/5282#pullrequestreview-463923443", "createdAt": "2020-08-10T01:17:44Z", "commit": {"oid": "dbb8b52a18226c11472c81ab332126ff700d581c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMToxNzo0NFrOG9_VjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMToxNzo0NFrOG9_VjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY1NDAyOQ==", "bodyText": "Java has a @since annotation, please use it.", "url": "https://github.com/apache/skywalking/pull/5282#discussion_r467654029", "createdAt": "2020-08-10T01:17:44Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-storage-plugin/storage-elasticsearch-plugin/src/main/java/org/apache/skywalking/oap/server/storage/plugin/elasticsearch/StorageModuleElasticsearchConfig.java", "diffHunk": "@@ -80,6 +80,11 @@\n      */\n     @Getter\n     private int dayStep = 1;\n+    /**\n+     * Since 8.2.0, the record day step is for record index rolling when the value of it is gt 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbb8b52a18226c11472c81ab332126ff700d581c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24c8ef51c45ed7223a5dda040c7ad983730fe22e", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/24c8ef51c45ed7223a5dda040c7ad983730fe22e", "committedDate": "2020-08-10T01:19:46Z", "message": "add super dataset index day step"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a265ef118f654dbb831d2c2368742031b99160fb", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/a265ef118f654dbb831d2c2368742031b99160fb", "committedDate": "2020-08-10T01:22:17Z", "message": "Merge branch 'recore-es-store-step' of https://github.com/EvanLjp/skywalking into recore-es-store-step"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99f82ec1c79e55def3ba3fb80885f7a35f923cd9", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/99f82ec1c79e55def3ba3fb80885f7a35f923cd9", "committedDate": "2020-08-10T01:44:33Z", "message": "add step config on es 7 storage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8e31ed77296b81d562232dab92a36d10e8408e8", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/a8e31ed77296b81d562232dab92a36d10e8408e8", "committedDate": "2020-08-10T01:53:38Z", "message": "fix doc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTQ1NzI5", "url": "https://github.com/apache/skywalking/pull/5282#pullrequestreview-463945729", "createdAt": "2020-08-10T03:53:27Z", "commit": {"oid": "a8e31ed77296b81d562232dab92a36d10e8408e8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMzo1MzoyN1rOG-Auwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMzo1MzoyN1rOG-Auwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY3Njg2Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            superDatasetDayStep is a advanced parameter for es storage load balance.\n          \n          \n            \n            superDatasetDayStep is an advanced parameter for es storage load balance.", "url": "https://github.com/apache/skywalking/pull/5282#discussion_r467676866", "createdAt": "2020-08-10T03:53:27Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-storage.md", "diffHunk": "@@ -105,6 +106,10 @@ Such as, if dayStep == 11,\n 1. data in [2000-01-01, 2000-01-11] will be merged into the index-20000101.\n 1. data in [2000-01-12, 2000-01-22] will be merged into the index-20000112.\n \n+superDatasetDayStep is a advanced parameter for es storage load balance.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8e31ed77296b81d562232dab92a36d10e8408e8"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "777895adcaee59ad00b9e3ba071f46f6f2037417", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/777895adcaee59ad00b9e3ba071f46f6f2037417", "committedDate": "2020-08-10T03:56:05Z", "message": "fix doc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTQ2ODUy", "url": "https://github.com/apache/skywalking/pull/5282#pullrequestreview-463946852", "createdAt": "2020-08-10T03:59:47Z", "commit": {"oid": "a8e31ed77296b81d562232dab92a36d10e8408e8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMzo1OTo0OFrOG-Ay5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwMzo1OTo0OFrOG-Ay5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY3NzkyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            For the trace data storage system, open it would be improve es performance.If the value of superDatasetDayStep is above 0,\n          \n          \n            \n            the rolling strategy of the superdateset index(trace segment,zipkin or jaeger ...) would be affected. Otherwise, all indices would be rolling with the strategy of dayStep.   \n          \n          \n            \n            `storage/elasticsearch/superDatasetDayStep` override the `storage/elasticsearch/dayStep` if the value is positive.\n          \n          \n            \n            This would affect the record related entities, such as the trace segment. In some cases, the size of metrics is much less than the record(trace), this would help the shards balance in the ElasticSearch cluster.", "url": "https://github.com/apache/skywalking/pull/5282#discussion_r467677924", "createdAt": "2020-08-10T03:59:48Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-storage.md", "diffHunk": "@@ -105,6 +106,10 @@ Such as, if dayStep == 11,\n 1. data in [2000-01-01, 2000-01-11] will be merged into the index-20000101.\n 1. data in [2000-01-12, 2000-01-22] will be merged into the index-20000112.\n \n+superDatasetDayStep is a advanced parameter for es storage load balance.\n+For the trace data storage system, open it would be improve es performance.If the value of superDatasetDayStep is above 0,\n+the rolling strategy of the superdateset index(trace segment,zipkin or jaeger ...) would be affected. Otherwise, all indices would be rolling with the strategy of dayStep.   ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8e31ed77296b81d562232dab92a36d10e8408e8"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb9b4e9e387af54f7ddd70b228dd02241e5e063b", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/bb9b4e9e387af54f7ddd70b228dd02241e5e063b", "committedDate": "2020-08-10T04:22:33Z", "message": "fix doc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTY5MTc0", "url": "https://github.com/apache/skywalking/pull/5282#pullrequestreview-463969174", "createdAt": "2020-08-10T05:50:19Z", "commit": {"oid": "bb9b4e9e387af54f7ddd70b228dd02241e5e063b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "905059086fd5ef15f89edbde008afa7b8d4b3e51", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/905059086fd5ef15f89edbde008afa7b8d4b3e51", "committedDate": "2020-08-10T05:56:23Z", "message": "Merge branch 'master' into recore-es-store-step"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1885, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}