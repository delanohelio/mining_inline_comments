{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzOTc0MDA5", "number": 6057, "title": "fix influx query error #6056", "bodyText": "Add a unit test to verify that the fix works.\n Explain briefly why the bug exists and how to fix it.\n\n\nSearchService method use influxdb identifier in sql when we use storage-influxdb-plugin.Put influxdb identifier in the middle of double quotation marks can solve this question.", "createdAt": "2020-12-22T08:57:13Z", "url": "https://github.com/apache/skywalking/pull/6057", "merged": true, "mergeCommit": {"oid": "88999300829567202933ba991c9ae69d9f3310b8"}, "closed": true, "closedAt": "2020-12-22T12:25:37Z", "author": {"login": "zhe1926"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdl9bjKAH2gAyNTQzOTc0MDA5OjA3ZDk5ZGEwMjc5OGI1Y2JiZWU5MWEzODJmNWU1NWQwNWRkZmMwZWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdoph6GgFqTU1NzAzNzY3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "07d99da02798b5cbbee91a382f5e55d05ddfc0ec", "author": {"user": {"login": "zhe1926", "name": "songzhe"}}, "url": "https://github.com/apache/skywalking/commit/07d99da02798b5cbbee91a382f5e55d05ddfc0ec", "committedDate": "2020-12-14T03:46:44Z", "message": "Merge pull request #1 from apache/master\n\n2020.12.4 update from apache to me"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38bbecf939aed6585289ffa2d6a07e03cd6cb600", "author": {"user": {"login": "zhe1926", "name": "songzhe"}}, "url": "https://github.com/apache/skywalking/commit/38bbecf939aed6585289ffa2d6a07e03cd6cb600", "committedDate": "2020-12-22T03:46:46Z", "message": "Merge pull request #2 from apache/master\n\n2020.12.22 update from apache to me"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4e90499f8e779d4aa0bfdacde08e14dfa75bb6b", "author": {"user": {"login": "zhe1926", "name": "songzhe"}}, "url": "https://github.com/apache/skywalking/commit/e4e90499f8e779d4aa0bfdacde08e14dfa75bb6b", "committedDate": "2020-12-22T08:38:16Z", "message": "fix influx query error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d0ce81d31c39f65858979f27ad6c1f9487a4a0b", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/3d0ce81d31c39f65858979f27ad6c1f9487a4a0b", "committedDate": "2020-12-22T09:04:52Z", "message": "Merge branch 'master' into fix-influxdb-error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a00e13008b7ae2302a6ae97241ee158e229547c2", "author": {"user": {"login": "zhe1926", "name": "songzhe"}}, "url": "https://github.com/apache/skywalking/commit/a00e13008b7ae2302a6ae97241ee158e229547c2", "committedDate": "2020-12-22T09:24:43Z", "message": "fix searchService error in 8.4.0"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2OTUwNzc3", "url": "https://github.com/apache/skywalking/pull/6057#pullrequestreview-556950777", "createdAt": "2020-12-22T09:48:24Z", "commit": {"oid": "a00e13008b7ae2302a6ae97241ee158e229547c2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQwOTo0ODoyNFrOIJ0_3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQwOTo0ODoyNFrOIJ0_3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE3NjQxNQ==", "bodyText": "We have a constant with quotes, InfluxConstants.NAME.", "url": "https://github.com/apache/skywalking/pull/6057#discussion_r547176415", "createdAt": "2020-12-22T09:48:24Z", "author": {"login": "dmsolr"}, "path": "oap-server/server-storage-plugin/storage-influxdb-plugin/src/main/java/org/apache/skywalking/oap/server/storage/plugin/influxdb/query/MetadataQuery.java", "diffHunk": "@@ -125,7 +125,7 @@ public Service searchService(String serviceCode) throws IOException {\n         final WhereQueryImpl<SelectQueryImpl> whereQuery = select(ID_COLUMN, NAME, ServiceTraffic.GROUP)\n             .from(client.getDatabase(), ServiceTraffic.INDEX_NAME)\n             .where(eq(TagName.NODE_TYPE, String.valueOf(NodeType.Normal.value())));\n-        whereQuery.and(eq(ServiceTraffic.NAME, serviceCode));\n+        whereQuery.and(eq(\"\\\"\" + ServiceTraffic.NAME + \"\\\"\", serviceCode));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a00e13008b7ae2302a6ae97241ee158e229547c2"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f709c011afa8b5be4d2f10b74c6fb018f70e9d3b", "author": {"user": {"login": "zhe1926", "name": "songzhe"}}, "url": "https://github.com/apache/skywalking/commit/f709c011afa8b5be4d2f10b74c6fb018f70e9d3b", "committedDate": "2020-12-22T11:00:36Z", "message": "use InfluxConstants.NAME"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MDAzOTM0", "url": "https://github.com/apache/skywalking/pull/6057#pullrequestreview-557003934", "createdAt": "2020-12-22T11:15:49Z", "commit": {"oid": "f709c011afa8b5be4d2f10b74c6fb018f70e9d3b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MDM3Njc1", "url": "https://github.com/apache/skywalking/pull/6057#pullrequestreview-557037675", "createdAt": "2020-12-22T12:17:21Z", "commit": {"oid": "f709c011afa8b5be4d2f10b74c6fb018f70e9d3b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1501, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}