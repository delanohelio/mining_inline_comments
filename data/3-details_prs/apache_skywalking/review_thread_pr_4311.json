{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNjgxMDYz", "number": 4311, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwODowNTowOVrODc4wxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwODowNTowOVrODc4wxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNjE2NzEwOnYy", "diffSide": "RIGHT", "path": "docs/en/FAQ/v6-version-upgrade.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwODowNTowOVrOFlK_Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwODowNjozN1rOFlLBWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDUyMTY3OA==", "bodyText": "\"compatible\", \"so users could not upgrade the agents.\" ? typo?", "url": "https://github.com/apache/skywalking/pull/4311#discussion_r374521678", "createdAt": "2020-02-04T08:05:09Z", "author": {"login": "kezhenxu94"}, "path": "docs/en/FAQ/v6-version-upgrade.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# V6 upgrade\n+SkyWalking v6 is widely used in many production environments. Users may wants to upgrade to an old release to new.\n+This is a guidance to tell users how to do that.\n+\n+**NOTICE**, the following ways are not the only ways to do upgrade.\n+\n+## Use Canary Release\n+Like all applications, SkyWalking could use `canary release` method to upgrade by following these steps\n+1. Deploy a new cluster by using the latest(or new) version of SkyWalking OAP cluster with new database cluster.\n+1. Once the target(being monitored) service has chance to upgrade the agent.jar(or just simply reboot), change the `collector.backend_service`\n+pointing to the new OAP backend, and use/add a new namespace(`agent.namespace` in [Table of Agent Configuration Properties](../setup/service-agent/java-agent/README.md#table-of-agent-configuration-properties)).\n+The namespace will avoid the conflict between different versions.\n+1. When all target services have been rebooted, the old OAP clusters could be discarded.\n+\n+`Canary Release` methods works for any version upgrade.\n+\n+## Online Hot Reboot Upgrade\n+The reason we required `Canary Release` is, SkyWalking agent has cache mechanisms, switching to a new cluster makes the \n+cache unavailable for new OAP cluster.\n+In the 6.5.0+(especially for agent version), we have [**Agent hot reboot trigger mechanism**](../setup/backend/backend-setup.md#agent-hot-reboot-trigger-mechanism-in-oap-server-upgrade).\n+By using that, we could do upgrade an easier way, **deploy a new cluster by using the latest(or new) version of SkyWalking OAP cluster with new database cluster**,\n+and shift the traffic to the new cluster once for all. Based on the mechanism, all agents will go into `cool_down` mode, then\n+back online. More detail, read the backend setup document.\n+\n+**NOTICE**, as a known bug in 6.4.0, its agent could have re-connection issue, so, even this bot reboot mechanism included in 6.4.0,\n+it may not work in some network scenarios, especially in k8s.\n+\n+## Agent Compatibility\n+All versions of SkyWalking 6.x(even 7.x) are compatible with each others, so users could not upgrade the agents. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1001940c51362e8c6448e410320576534f28d0d"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDUyMjIwMw==", "bodyText": "Users could not upgrade the agents even they upgraded the OAP server. I will make the sentence more clear.", "url": "https://github.com/apache/skywalking/pull/4311#discussion_r374522203", "createdAt": "2020-02-04T08:06:37Z", "author": {"login": "wu-sheng"}, "path": "docs/en/FAQ/v6-version-upgrade.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# V6 upgrade\n+SkyWalking v6 is widely used in many production environments. Users may wants to upgrade to an old release to new.\n+This is a guidance to tell users how to do that.\n+\n+**NOTICE**, the following ways are not the only ways to do upgrade.\n+\n+## Use Canary Release\n+Like all applications, SkyWalking could use `canary release` method to upgrade by following these steps\n+1. Deploy a new cluster by using the latest(or new) version of SkyWalking OAP cluster with new database cluster.\n+1. Once the target(being monitored) service has chance to upgrade the agent.jar(or just simply reboot), change the `collector.backend_service`\n+pointing to the new OAP backend, and use/add a new namespace(`agent.namespace` in [Table of Agent Configuration Properties](../setup/service-agent/java-agent/README.md#table-of-agent-configuration-properties)).\n+The namespace will avoid the conflict between different versions.\n+1. When all target services have been rebooted, the old OAP clusters could be discarded.\n+\n+`Canary Release` methods works for any version upgrade.\n+\n+## Online Hot Reboot Upgrade\n+The reason we required `Canary Release` is, SkyWalking agent has cache mechanisms, switching to a new cluster makes the \n+cache unavailable for new OAP cluster.\n+In the 6.5.0+(especially for agent version), we have [**Agent hot reboot trigger mechanism**](../setup/backend/backend-setup.md#agent-hot-reboot-trigger-mechanism-in-oap-server-upgrade).\n+By using that, we could do upgrade an easier way, **deploy a new cluster by using the latest(or new) version of SkyWalking OAP cluster with new database cluster**,\n+and shift the traffic to the new cluster once for all. Based on the mechanism, all agents will go into `cool_down` mode, then\n+back online. More detail, read the backend setup document.\n+\n+**NOTICE**, as a known bug in 6.4.0, its agent could have re-connection issue, so, even this bot reboot mechanism included in 6.4.0,\n+it may not work in some network scenarios, especially in k8s.\n+\n+## Agent Compatibility\n+All versions of SkyWalking 6.x(even 7.x) are compatible with each others, so users could not upgrade the agents. ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDUyMTY3OA=="}, "originalCommit": {"oid": "e1001940c51362e8c6448e410320576534f28d0d"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4554, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}