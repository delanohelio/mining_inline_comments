{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1Mzg0NDE5", "number": 5408, "title": "Fix sampling and Kafka reporter conflicting.", "bodyText": "@peng-yongsheng reported this conflict. As they used to extend the same core service, when both of them are active, which could happen, they can't work together.\nBut, from the design perspective, I notice, ignore plugin actually is just a sampling service. It used ContextManagerExtendService extension, just because only sampling service API doesn't provide the operation name.\nIn this PR, I changed the sampling service API, and move TraceIgnoreExtendService to extend it. So conflict goes away.", "createdAt": "2020-08-28T12:43:24Z", "url": "https://github.com/apache/skywalking/pull/5408", "merged": true, "mergeCommit": {"oid": "ca5e576c046690248bf906e73aa74fa66eef1ca6"}, "closed": true, "closedAt": "2020-08-28T15:47:04Z", "author": {"login": "wu-sheng"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDSE_YgH2gAyNDc1Mzg0NDE5OjUzYmFjZmMxM2U0NDFmZTJlNjUwODc2MzBjMTQ3N2E4NzA4ZjY3YTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDWp5egFqTQ3NzgxOTUzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "53bacfc13e441fe2e65087630c1477a8708f67a9", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/53bacfc13e441fe2e65087630c1477a8708f67a9", "committedDate": "2020-08-28T10:02:45Z", "message": "Fix sampling and Kafka reporter conflicting."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NzUxODg3", "url": "https://github.com/apache/skywalking/pull/5408#pullrequestreview-477751887", "createdAt": "2020-08-28T13:59:20Z", "commit": {"oid": "53bacfc13e441fe2e65087630c1477a8708f67a9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMzo1OToyMVrOHJHQ4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMzo1OToyMVrOHJHQ4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTMxODI0Mw==", "bodyText": "Seems the variable SAMPLING_SERVICE is not used anywhere now and can be removed (line 69)", "url": "https://github.com/apache/skywalking/pull/5408#discussion_r479318243", "createdAt": "2020-08-28T13:59:21Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java", "diffHunk": "@@ -438,20 +434,7 @@ private void finish() {\n \n             if (isFinishedInMainThread && (!isRunningInAsyncMode || asyncSpanCounter == 0)) {\n                 TraceSegment finishedSegment = segment.finish(isLimitMechanismWorking());\n-                /*\n-                 * Recheck the segment if the segment contains only one span.\n-                 * Because in the runtime, can't sure this segment is part of distributed trace.\n-                 *\n-                 * @see {@link #createSpan(String, long, boolean)}\n-                 */\n-                if (!segment.hasRef() && segment.isSingleSpanSegment()) {\n-                    if (!SAMPLING_SERVICE.trySampling()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53bacfc13e441fe2e65087630c1477a8708f67a9"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b078b32aa4027c9d5340a0fcf1b4cd829b17e81", "author": {"user": {"login": "kezhenxu94", "name": "kezhenxu94"}}, "url": "https://github.com/apache/skywalking/commit/5b078b32aa4027c9d5340a0fcf1b4cd829b17e81", "committedDate": "2020-08-28T14:03:24Z", "message": "Merge branch 'master' into conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96e30ead34001f38dcf66f331e5dca367c4b58c1", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/96e30ead34001f38dcf66f331e5dca367c4b58c1", "committedDate": "2020-08-28T14:27:51Z", "message": "Remove legacy codes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3ODE5NTM3", "url": "https://github.com/apache/skywalking/pull/5408#pullrequestreview-477819537", "createdAt": "2020-08-28T15:22:41Z", "commit": {"oid": "96e30ead34001f38dcf66f331e5dca367c4b58c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1960, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}