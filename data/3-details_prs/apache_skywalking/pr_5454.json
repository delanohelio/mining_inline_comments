{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxNzIyOTkz", "number": 5454, "title": "Parse TLS mode from ALS", "bodyText": "Set up TLS mode property to Service and instance relationship source, which intends to parse TLS mode from envoy AccessLog.\nThe type of TLS mode is \"String\"  instead of \"Enum\" due to the issues of variable receivers. In this PR only ALS relevant TLS mode is supported. Tracing or other analyzers might adopt to different terms to identify TLS mode.", "createdAt": "2020-09-08T01:56:52Z", "url": "https://github.com/apache/skywalking/pull/5454", "merged": true, "mergeCommit": {"oid": "50d2ff75bcf42d6d7e12567590701cc44e6b9dc7"}, "closed": true, "closedAt": "2020-09-13T06:52:40Z", "author": {"login": "hanahmily"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdGtkQxgH2gAyNDgxNzIyOTkzOjFhMTAyODQyNzE5NTg0MjQyMTBiYzVmMzVmOTY0ZTQ3N2EwOTJmMDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdIY8cHAFqTQ4NzI4MDMyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1a10284271958424210bc5f35f964e477a092f03", "author": {"user": {"login": "hanahmily", "name": "Gao Hongtao"}}, "url": "https://github.com/apache/skywalking/commit/1a10284271958424210bc5f35f964e477a092f03", "committedDate": "2020-09-08T01:46:07Z", "message": "Parse tls mode from als\n\nSigned-off-by: Gao Hongtao <hanahmily@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNzg3MjEw", "url": "https://github.com/apache/skywalking/pull/5454#pullrequestreview-483787210", "createdAt": "2020-09-08T04:28:59Z", "commit": {"oid": "1a10284271958424210bc5f35f964e477a092f03"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNDoyOTowMFrOHOMSBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwNDoyOTowMFrOHOMSBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDY0MzMzMw==", "bodyText": "We don't visualize tls in the current UI. Please remove them.", "url": "https://github.com/apache/skywalking/pull/5454#discussion_r484643333", "createdAt": "2020-09-08T04:29:00Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-bootstrap/src/main/resources/oal/core.oal", "diffHunk": "@@ -69,6 +69,12 @@ database_access_sla = from(DatabaseAccess.*).percent(status == true);\n database_access_cpm = from(DatabaseAccess.*).cpm();\n database_access_percentile = from(DatabaseAccess.latency).percentile(10);\n \n+// Example of TLS related metric. Detected point was not distinguished, that means mTLS requests from both sides will be\n+// counted in.\n+//////////\n+// service_relation_mtls_cpm = from(ServiceRelation.*).filter(tlsMode == \"mTLS\").cpm();\n+// service_instance_relation_mtls_cpm = from(ServiceInstanceRelation.*).filter(tlsMode == \"mTLS\").cpm();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a10284271958424210bc5f35f964e477a092f03"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzNzg3NDA2", "url": "https://github.com/apache/skywalking/pull/5454#pullrequestreview-483787406", "createdAt": "2020-09-08T04:29:50Z", "commit": {"oid": "1a10284271958424210bc5f35f964e477a092f03"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MDU5OTM4", "url": "https://github.com/apache/skywalking/pull/5454#pullrequestreview-484059938", "createdAt": "2020-09-08T11:57:36Z", "commit": {"oid": "1a10284271958424210bc5f35f964e477a092f03"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxMTo1NzozNlrOHOZf1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxMTo1NzozNlrOHOZf1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDg1OTg2Mw==", "bodyText": "This and service relation source have been changed, scope-definitions.md doc should be updated.\n\nservice_relation_mtls_cpm = from(ServiceRelation.*).filter(tlsMode == \"mTLS\").cpm();\n\nThis example should belong to the doc I pointed to you.", "url": "https://github.com/apache/skywalking/pull/5454#discussion_r484859863", "createdAt": "2020-09-08T11:57:36Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/source/ServiceInstanceRelation.java", "diffHunk": "@@ -103,6 +103,9 @@ public String getEntityId() {\n     @Getter\n     @Setter\n     private DetectPoint detectPoint;\n+    @Getter\n+    @Setter\n+    private String tlsMode;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a10284271958424210bc5f35f964e477a092f03"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a94799248c0e42176b4fbcd53b4695739868647a", "author": {"user": {"login": "hanahmily", "name": "Gao Hongtao"}}, "url": "https://github.com/apache/skywalking/commit/a94799248c0e42176b4fbcd53b4695739868647a", "committedDate": "2020-09-09T00:05:40Z", "message": "Polish code\n\nSigned-off-by: Gao Hongtao <hanahmily@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14b0956a03f0e4004a1b41588d83af422b9806b0", "author": {"user": {"login": "hanahmily", "name": "Gao Hongtao"}}, "url": "https://github.com/apache/skywalking/commit/14b0956a03f0e4004a1b41588d83af422b9806b0", "committedDate": "2020-09-13T05:31:07Z", "message": "Merge branch 'master' into source-tls"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MjgwMzIz", "url": "https://github.com/apache/skywalking/pull/5454#pullrequestreview-487280323", "createdAt": "2020-09-13T06:52:22Z", "commit": {"oid": "14b0956a03f0e4004a1b41588d83af422b9806b0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2010, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}