{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzMjE1Njc4", "number": 5961, "title": "Add alarm tests in the e2e", "bodyText": "Fix multiple same scope alarms, create at the same time.\n\nAdd ruleName field to the AlarmRecord bean, and let the ruleName field be part of the ID.\n\nAdd alarm tests in the e2e\n\n\nSupport alarm query.\n\n\nCheck the Alarm webhook.\n\n\nCheck silence config.\n\n\n resolves #4530 .\n\n\n Update the CHANGES log.", "createdAt": "2020-12-06T15:31:12Z", "url": "https://github.com/apache/skywalking/pull/5961", "merged": true, "mergeCommit": {"oid": "4aa9f301d0d97198f023e2d91779222e1a5787dc"}, "closed": true, "closedAt": "2020-12-08T08:47:29Z", "author": {"login": "mrproliu"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjiWrwAH2gAyNTMzMjE1Njc4OmFlMTRjOGJjMmU2NTI0ZWZiMDZiZmQ1MWM5YWI1YTY1YzMyZTk0ZTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkFbDZgFqTU0NjgzMDgwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ae14c8bc2e6524efb06bfd51c9ab5a65c32e94e1", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/ae14c8bc2e6524efb06bfd51c9ab5a65c32e94e1", "committedDate": "2020-12-06T15:06:08Z", "message": "1. Add Alarm E2E\n2. Add rule name to AlarmRecord, fix multiple same scope alarm at same time"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cea68ecc44925f1584ad4b12d50d0101bca4847", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/1cea68ecc44925f1584ad4b12d50d0101bca4847", "committedDate": "2020-12-06T15:12:54Z", "message": "Fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1daa0356426bad67c86cf04db3928a7eeaa43ddd", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/1daa0356426bad67c86cf04db3928a7eeaa43ddd", "committedDate": "2020-12-06T15:24:58Z", "message": "Add changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a549b444bfc05ecd9bfb938139152303a0e6620", "author": {"user": {"login": "mrproliu", "name": null}}, "url": "https://github.com/apache/skywalking/commit/2a549b444bfc05ecd9bfb938139152303a0e6620", "committedDate": "2020-12-06T15:32:34Z", "message": "Merge branch 'master' into alarm-e2e"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95572f7cd6c793d32329055f40b8054b11c5fd09", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/95572f7cd6c793d32329055f40b8054b11c5fd09", "committedDate": "2020-12-06T15:55:19Z", "message": "Add more description to the change log"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "377e8d87d5e0a1ba9b0a8c9c2909963196376311", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/377e8d87d5e0a1ba9b0a8c9c2909963196376311", "committedDate": "2020-12-06T23:32:20Z", "message": "Update CHANGES.md\n\nPolish changelog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ae073e7ecdf0ac953a0ee3bda2f9b058bb276cf", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/3ae073e7ecdf0ac953a0ee3bda2f9b058bb276cf", "committedDate": "2020-12-07T02:13:00Z", "message": "Commit graphQL file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6261d15f44c07e7e6aa31ef754594eaabb69b578", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/6261d15f44c07e7e6aa31ef754594eaabb69b578", "committedDate": "2020-12-07T05:17:20Z", "message": "Adding meter receive log, trying to locate meter e2e error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1OTU4ODAx", "url": "https://github.com/apache/skywalking/pull/5961#pullrequestreview-545958801", "createdAt": "2020-12-07T09:19:33Z", "commit": {"oid": "6261d15f44c07e7e6aa31ef754594eaabb69b578"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwOToxOTozM1rOIAdEbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QwOToxOTozM1rOIAdEbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzM0NzE4MQ==", "bodyText": "I think once you have the ruleName, scope is not necessary? RuleName matches the metrics name already, right?", "url": "https://github.com/apache/skywalking/pull/5961#discussion_r537347181", "createdAt": "2020-12-07T09:19:33Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/alarm/AlarmRecord.java", "diffHunk": "@@ -46,10 +47,11 @@\n     public static final String ID1 = \"id1\";\n     public static final String START_TIME = \"start_time\";\n     public static final String ALARM_MESSAGE = \"alarm_message\";\n+    public static final String RULE_NAME = \"rule_name\";\n \n     @Override\n     public String id() {\n-        return getTimeBucket() + Const.ID_CONNECTOR + scope + Const.ID_CONNECTOR + id0 + Const.ID_CONNECTOR + id1;\n+        return getTimeBucket() + Const.ID_CONNECTOR + scope + Const.ID_CONNECTOR + ruleName + Const.ID_CONNECTOR + id0 + Const.ID_CONNECTOR + id1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6261d15f44c07e7e6aa31ef754594eaabb69b578"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebd4e7ee1949fc4d84c3e752a053180809147e94", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/ebd4e7ee1949fc4d84c3e752a053180809147e94", "committedDate": "2020-12-07T12:09:34Z", "message": "1. remove logs\n2. remove scope part at alarm record"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff5058751ea2852f14d80e6e0170f0f20e76ccff", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/ff5058751ea2852f14d80e6e0170f0f20e76ccff", "committedDate": "2020-12-08T02:06:31Z", "message": "Merge branch 'master' into alarm-e2e"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2Njg5OTA3", "url": "https://github.com/apache/skywalking/pull/5961#pullrequestreview-546689907", "createdAt": "2020-12-08T02:07:10Z", "commit": {"oid": "ff5058751ea2852f14d80e6e0170f0f20e76ccff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ2ODMwODAz", "url": "https://github.com/apache/skywalking/pull/5961#pullrequestreview-546830803", "createdAt": "2020-12-08T07:57:35Z", "commit": {"oid": "ff5058751ea2852f14d80e6e0170f0f20e76ccff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1438, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}