{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4NjkxNTUz", "number": 4165, "title": "Add kotlin coroutine plugin", "bodyText": "Skywalking with Kotlin coroutine\nThis PR provided an auto instrument support plugin for Kotlin coroutine based on context snapshot.\nChecklist\nYou can merge this PR after all check is done.\n\n Implementation\n Test\n Documents\n CI build pass\n Review\n\nDescription\nWe have known there are some limits with skywalking and coroutine, because of the trace context based on ThreadLocal.\nBut skywalking provided context snapshot for cross-thread tracing, I create this plugin for resolving context losing in Kotlin coroutine.\nImplementation principle\nAs we know, Kotlin coroutine switches the execution thread by CoroutineDispatcher.\n\nCreate a snapshot of the current context before dispatch the continuation.\nThen create a coroutine span after thread switched, mark the span continued with the snapshot.\nEvery new span which created in the new thread will be a child of this coroutine span. So we can link those span together in a tracing.\nAfter the original runnable executed, we need to stop the coroutine span for cleaning thread state.\n\nSome screenshots\nRun without the plugin\nWe run a Kotlin coroutine based gRPC server without this coroutine plugin.\nYou can find, the one call (client -> server1 -> server2) has been split two tracing paths.\n\nServer1 without exit span and server2 tracing path.\n\nServer2 tracing path.\n\n\nRun with the plugin\nWith no business code changed, just install the plugin. We can find the tracing paths be connected together. We can get all info of one client call.", "createdAt": "2020-01-02T15:14:13Z", "url": "https://github.com/apache/skywalking/pull/4165", "merged": true, "mergeCommit": {"oid": "4e03d5e6d73ac32093960a5cdf3de5863ad6aede"}, "closed": true, "closedAt": "2020-01-04T14:52:00Z", "author": {"login": "devkanro"}, "timelineItems": {"totalCount": 32, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2bb_bgFqTMzNzcwODA3MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb3DRceAFqTMzODM1NDE4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NzA4MDcx", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-337708071", "createdAt": "2020-01-02T15:24:51Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NzA5NTQ5", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-337709549", "createdAt": "2020-01-02T15:27:47Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxNToyNzo0OFrOFZuB8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxNToyNzo0OFrOFZuB8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjUxMjg4MA==", "bodyText": "This should not be added. COROUTINE is a local span. Should not be Layer.", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r362512880", "createdAt": "2020-01-02T15:27:48Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/SpanLayer.java", "diffHunk": "@@ -26,7 +26,8 @@\n     RPC_FRAMEWORK(2),\n     HTTP(3),\n     MQ(4),\n-    CACHE(5);\n+    CACHE(5),\n+    COROUTINE(6);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NzE0Nzg0", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-337714784", "createdAt": "2020-01-02T15:38:22Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxNTozODoyMlrOFZuRRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxNTozODoyMlrOFZuRRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjUxNjgwNA==", "bodyText": "Why is kotlin coroutine plugin as bootstrap plugin? From my understanding, Kotlin still run inside JVM, and compiled as .class files. Bootstrap plugins should be rt.jar level injection. Does koltin plugin require this?", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r362516804", "createdAt": "2020-01-02T15:38:22Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/bootstrap-plugins/pom.xml", "diffHunk": "@@ -43,6 +43,7 @@\n     <modules>\n         <module>jdk-http-plugin</module>\n         <module>jdk-threading-plugin</module>\n+        <module>kotlin-coroutine-plugin</module>", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NzE5MTY1", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-337719165", "createdAt": "2020-01-02T15:47:25Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxNTo0NzoyNlrOFZue1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQxNTo0ODoxMVrOFZugBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjUyMDI3OQ==", "bodyText": "I meant this, although the name is \u201cstdlib\u201d, but for Java it is not really standard, all the classes/functions in it will cause ClassNotFoundException when users are using vanilla Java", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r362520279", "createdAt": "2020-01-02T15:47:26Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/bootstrap-plugins/kotlin-coroutine-plugin/pom.xml", "diffHunk": "@@ -0,0 +1,78 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+    <parent>\n+        <groupId>org.apache.skywalking</groupId>\n+        <artifactId>bootstrap-plugins</artifactId>\n+        <version>7.0.0-SNAPSHOT</version>\n+    </parent>\n+\n+    <artifactId>apm-kotlin-coroutine-plugin</artifactId>\n+    <name>kotlin-coroutine-plugin</name>\n+    <packaging>jar</packaging>\n+\n+    <properties>\n+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+        <kotlin.version>1.3.61</kotlin.version>\n+        <kotlinx.coroutine.version>1.3.3</kotlinx.coroutine.version>\n+        <kotlin.compiler.incremental>true</kotlin.compiler.incremental>\n+    </properties>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.jetbrains.kotlin</groupId>\n+            <artifactId>kotlin-stdlib</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjUyMDU4MQ==", "bodyText": "Obviously it\u2019s not bootstrap plugin", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r362520581", "createdAt": "2020-01-02T15:48:11Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/bootstrap-plugins/kotlin-coroutine-plugin/pom.xml", "diffHunk": "@@ -0,0 +1,78 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+    <parent>\n+        <groupId>org.apache.skywalking</groupId>\n+        <artifactId>bootstrap-plugins</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ad1ad64fbb00a03851932c0ea899c4a6f8b311b", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/8ad1ad64fbb00a03851932c0ea899c4a6f8b311b", "committedDate": "2020-01-02T17:13:33Z", "message": "Kotlin coroutine plugin write in Java"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "8ad1ad64fbb00a03851932c0ea899c4a6f8b311b", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/8ad1ad64fbb00a03851932c0ea899c4a6f8b311b", "committedDate": "2020-01-02T17:13:33Z", "message": "Kotlin coroutine plugin write in Java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47cbf78f5cb8139f79724ecb700b730f0f0a46e4", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/47cbf78f5cb8139f79724ecb700b730f0f0a46e4", "committedDate": "2020-01-03T07:03:34Z", "message": "Add license"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3OTY3NTg5", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-337967589", "createdAt": "2020-01-03T07:15:21Z", "commit": {"oid": "47cbf78f5cb8139f79724ecb700b730f0f0a46e4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wM1QwNzoxNToyMVrOFZ6vbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wM1QwNzoxNToyMVrOFZ6vbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjcyMTEzNA==", "bodyText": "Do we need it?", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r362721134", "createdAt": "2020-01-03T07:15:21Z", "author": {"login": "dmsolr"}, "path": "apm-sniffer/optional-plugins/kotlin-coroutine-plugin/src/main/java/org/apache/skywalking/apm/plugin/kotlin/coroutine/TracingRunnable.java", "diffHunk": "@@ -0,0 +1,89 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.kotlin.coroutine;\n+\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.ContextSnapshot;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+\n+/**\n+ * {@link Runnable} wrapper with trace context snapshot, it will create span\n+ * with context snapshot around {@link Runnable} runs.\n+ * <p>\n+ * A class implementation will be cheaper cost than lambda with captured\n+ * variables implementation.\n+ */\n+class TracingRunnable implements Runnable {\n+    private static final String COROUTINE = \"/Kotlin/Coroutine\";\n+\n+    private ContextSnapshot snapshot;\n+    private Runnable delegate;\n+    private String tracingId;\n+\n+    private TracingRunnable(ContextSnapshot snapshot, Runnable delegate, String tracingId) {\n+        this.snapshot = snapshot;\n+        this.delegate = delegate;\n+        this.tracingId = tracingId;\n+    }\n+\n+    private TracingRunnable(ContextSnapshot snapshot, Runnable delegate) {\n+        this(snapshot, delegate, ContextManager.getGlobalTraceId());\n+    }\n+\n+    /**\n+     * Wrap {@link Runnable} by {@link TracingRunnable} if active trace context\n+     * existed.\n+     *\n+     * @param delegate {@link Runnable} to wrap.\n+     *\n+     * @return Wrapped {@link TracingRunnable} or original {@link Runnable} if\n+     * trace context not existed.\n+     */\n+    public static Runnable wrapOrNot(Runnable delegate) {\n+        // Just wrap continuation with active trace context\n+        if (ContextManager.isActive()) {\n+            return new TracingRunnable(ContextManager.capture(), delegate);\n+        } else {\n+            return delegate;\n+        }\n+    }\n+\n+    @Override\n+    public void run() {\n+        if (ContextManager.getGlobalTraceId().equals(tracingId)) {\n+            // Trace id same with before dispatching, skip restore snapshot.\n+            delegate.run();\n+            return;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47cbf78f5cb8139f79724ecb700b730f0f0a46e4"}, "originalPosition": 74}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c237385d33d116864fd9770cabc5cd3052e5e778", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/c237385d33d116864fd9770cabc5cd3052e5e778", "committedDate": "2020-01-03T09:34:40Z", "message": "Add licens for plugin def file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6927733408eae5efc85e13552affa6726b25a658", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/6927733408eae5efc85e13552affa6726b25a658", "committedDate": "2020-01-03T13:58:39Z", "message": "Merge branch 'master' into kt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bb159554fe0452d7eee4279bde1946095d14e79", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/2bb159554fe0452d7eee4279bde1946095d14e79", "committedDate": "2020-01-03T20:51:17Z", "message": "Add test case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzI3NjU5", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338327659", "createdAt": "2020-01-04T01:00:58Z", "commit": {"oid": "2bb159554fe0452d7eee4279bde1946095d14e79"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55c46557a01abad9f48b724259b91d4d6bb7bfce", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/55c46557a01abad9f48b724259b91d4d6bb7bfce", "committedDate": "2020-01-04T05:39:31Z", "message": "Fix review and update plugin test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzM5NDQ1", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338339445", "createdAt": "2020-01-04T05:59:18Z", "commit": {"oid": "55c46557a01abad9f48b724259b91d4d6bb7bfce"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQwNTo1OToxOFrOFaM4fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQwNTo1OToxOFrOFaM4fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAxODM2Nw==", "bodyText": "missed startScript: ./bin/startup.sh", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363018367", "createdAt": "2020-01-04T05:59:18Z", "author": {"login": "kezhenxu94"}, "path": "test/plugin/scenarios/kotlin-coroutine-scenario/configuration.yml", "diffHunk": "@@ -0,0 +1,22 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+type: jvm\n+entryService: http://localhost:8080/kotlin-coroutine-scenario/case/h2\n+healthCheck: http://localhost:8080/kotlin-coroutine-scenario/case/healthCheck\n+framework: kt-coroutine\n+runningMode: with_optional\n+withPlugins: apm-kotlin-coroutine-plugin-*.jar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "55c46557a01abad9f48b724259b91d4d6bb7bfce"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d8d467381f1d45f1ba3c3669551d77d35527264", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/3d8d467381f1d45f1ba3c3669551d77d35527264", "committedDate": "2020-01-04T06:02:32Z", "message": "Fix missed configuration 'startScript'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "415436de6069f0b4a04f07a9000057b3793fd037", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/415436de6069f0b4a04f07a9000057b3793fd037", "committedDate": "2020-01-04T06:04:51Z", "message": "Add docs for kotlin coroutine plugin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzM5ODUw", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338339850", "createdAt": "2020-01-04T06:13:37Z", "commit": {"oid": "415436de6069f0b4a04f07a9000057b3793fd037"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQwNjoxMzozN1rOFaM6ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQwNjoxNDoxNlrOFaM6eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAxODg1OA==", "bodyText": "You don't need this plugin, instead, you need this, otherwise the packaged jar is not executable:\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <version>${spring-boot-version}</version>\n                <executions>\n                    <execution>\n                        <goals>\n                            <goal>repackage</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363018858", "createdAt": "2020-01-04T06:13:37Z", "author": {"login": "kezhenxu94"}, "path": "test/plugin/scenarios/kotlin-coroutine-scenario/pom.xml", "diffHunk": "@@ -0,0 +1,157 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <groupId>org.apache.skywalking.apm.testcase</groupId>\n+    <artifactId>kotlin-coroutine-scenario</artifactId>\n+    <version>1.0.0</version>\n+    <packaging>jar</packaging>\n+\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <properties>\n+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+        <compiler.version>1.8</compiler.version>\n+        <os-maven-plugin.version>1.6.2</os-maven-plugin.version>\n+\n+        <spring-boot-version>2.1.6.RELEASE</spring-boot-version>\n+        <kotlin.version>1.3.61</kotlin.version>\n+        <kotlinx.coroutine.version>1.3.3</kotlinx.coroutine.version>\n+    </properties>\n+\n+    <name>skywalking-kotlin-coroutine-scenario</name>\n+\n+    <dependencyManagement>\n+        <dependencies>\n+            <dependency>\n+                <groupId>org.springframework.boot</groupId>\n+                <artifactId>spring-boot-dependencies</artifactId>\n+                <version>${spring-boot-version}</version>\n+                <type>pom</type>\n+                <scope>import</scope>\n+            </dependency>\n+        </dependencies>\n+    </dependencyManagement>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.springframework.boot</groupId>\n+            <artifactId>spring-boot-starter-web</artifactId>\n+            <exclusions>\n+                <exclusion>\n+                    <groupId>org.springframework.boot</groupId>\n+                    <artifactId>spring-boot-starter-logging</artifactId>\n+                </exclusion>\n+            </exclusions>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.springframework.boot</groupId>\n+            <artifactId>spring-boot-starter-log4j2</artifactId>\n+            <exclusions>\n+                <exclusion>\n+                    <artifactId>jul-to-slf4j</artifactId>\n+                    <groupId>org.slf4j</groupId>\n+                </exclusion>\n+            </exclusions>\n+        </dependency>\n+        <dependency>\n+            <groupId>com.h2database</groupId>\n+            <artifactId>h2</artifactId>\n+            <version>1.4.196</version>\n+        </dependency>\n+        <dependency>\n+            <groupId>commons-dbcp</groupId>\n+            <artifactId>commons-dbcp</artifactId>\n+            <version>1.4</version>\n+        </dependency>\n+\n+        <dependency>\n+            <groupId>org.jetbrains.kotlin</groupId>\n+            <artifactId>kotlin-stdlib</artifactId>\n+            <version>${kotlin.version}</version>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.jetbrains.kotlinx</groupId>\n+            <artifactId>kotlinx-coroutines-core</artifactId>\n+            <version>${kotlinx.coroutine.version}</version>\n+        </dependency>\n+    </dependencies>\n+\n+    <build>\n+        <finalName>kotlin-coroutine-scenario</finalName>\n+        <sourceDirectory>${project.basedir}/src/main/kotlin</sourceDirectory>\n+        <plugins>\n+            <plugin>\n+                <groupId>kr.motd.maven</groupId>\n+                <artifactId>os-maven-plugin</artifactId>\n+                <version>${os-maven-plugin.version}</version>\n+                <executions>\n+                    <execution>\n+                        <phase>initialize</phase>\n+                        <goals>\n+                            <goal>detect</goal>\n+                        </goals>\n+                    </execution>\n+                </executions>\n+            </plugin>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "415436de6069f0b4a04f07a9000057b3793fd037"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAxODg3MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                - {kotlin-coroutine: nq 0}\n          \n          \n            \n                - {kotlin-coroutine-scenario: nq 0}", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363018871", "createdAt": "2020-01-04T06:14:06Z", "author": {"login": "kezhenxu94"}, "path": "test/plugin/scenarios/kotlin-coroutine-scenario/config/expectedData.yaml", "diffHunk": "@@ -0,0 +1,121 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+registryItems:\n+  applications:\n+    - {kotlin-coroutine: nq 0}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "415436de6069f0b4a04f07a9000057b3793fd037"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAxODg3NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                - {kotlin-coroutine: 1}\n          \n          \n            \n                - {kotlin-coroutine-scenario: 1}", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363018874", "createdAt": "2020-01-04T06:14:16Z", "author": {"login": "kezhenxu94"}, "path": "test/plugin/scenarios/kotlin-coroutine-scenario/config/expectedData.yaml", "diffHunk": "@@ -0,0 +1,121 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+registryItems:\n+  applications:\n+    - {kotlin-coroutine: nq 0}\n+  instances:\n+    - {kotlin-coroutine: 1}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "415436de6069f0b4a04f07a9000057b3793fd037"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b318bd747362275ba89adb20eecb6440650217f0", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/b318bd747362275ba89adb20eecb6440650217f0", "committedDate": "2020-01-04T06:21:00Z", "message": "Fix wrong configs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzQwMTUw", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338340150", "createdAt": "2020-01-04T06:25:04Z", "commit": {"oid": "b318bd747362275ba89adb20eecb6440650217f0"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67560402694fa4877f1b8cc18d1689c30dedc99b", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/67560402694fa4877f1b8cc18d1689c30dedc99b", "committedDate": "2020-01-04T06:34:07Z", "message": "Update expectedData.yaml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b891f1fa99844f8900b5468e9ea6c2fd2c43a153", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/b891f1fa99844f8900b5468e9ea6c2fd2c43a153", "committedDate": "2020-01-04T06:37:08Z", "message": "Fix typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d0e4efffdee024c939fd6277f22364c8b299323", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/8d0e4efffdee024c939fd6277f22364c8b299323", "committedDate": "2020-01-04T07:28:56Z", "message": "Fix operation names"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzQ0MzU1", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338344355", "createdAt": "2020-01-04T08:52:04Z", "commit": {"oid": "8d0e4efffdee024c939fd6277f22364c8b299323"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQwODo1MjowNFrOFaNP8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQwODo1ODoxOVrOFaNQ0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyNDM2OA==", "bodyText": "If you want to provide screenshots, you need to host the images in Apache repo. Should create a folder named 7.0.0/kotlin/coroutine at here https://github.com/apache/skywalking-website/tree/master/docs/.vuepress/public/screenshots", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363024368", "createdAt": "2020-01-04T08:52:04Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/agent-optional-plugins/Kotlin-Coroutine-plugin.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# Skywalking with Kotlin coroutine\n+This PR provided an auto instrument support plugin for Kotlin coroutine based on context snapshot.\n+\n+## Description\n+We have known there are some limits with skywalking and coroutine, because of the trace context based on `ThreadLocal`.\n+\n+But skywalking provided context snapshot for cross-thread tracing, I create this plugin for resolving context losing in Kotlin coroutine.\n+\n+## Implementation principle\n+As we know, Kotlin coroutine switches the execution thread by `CoroutineDispatcher`.\n+\n+01. Create a snapshot of the current context before dispatch the continuation.\n+02. Then create a coroutine span after thread switched, mark the span continued with the snapshot.\n+03. Every new span which created in the new thread will be a child of this coroutine span. So we can link those span together in a tracing.\n+04. After the original runnable executed, we need to stop the coroutine span for cleaning thread state.\n+\n+## Some screenshots\n+### Run without the plugin\n+We run a Kotlin coroutine based gRPC server without this coroutine plugin.  \n+You can find, the one call (client -> server1 -> server2) has been split two tracing paths.\n+\n+01. Server1 without exit span and server2 tracing path.\n+![Without kotlin plugin1](https://user-images.githubusercontent.com/9367842/71715581-dd18be80-2e4c-11ea-9316-60937ee2c03d.jpg)\n+02. Server2 tracing path.\n+![Without kotlin plugin2](https://user-images.githubusercontent.com/9367842/71715588-e0ac4580-2e4c-11ea-95fd-de9d276caefd.jpg)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d0e4efffdee024c939fd6277f22364c8b299323"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyNDM5OA==", "bodyText": "As an optional plugin, this doc should be linked from https://github.com/apache/skywalking/blob/master/docs/en/setup/service-agent/java-agent/README.md#optional-plugins", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363024398", "createdAt": "2020-01-04T08:53:02Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/agent-optional-plugins/Kotlin-Coroutine-plugin.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# Skywalking with Kotlin coroutine", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d0e4efffdee024c939fd6277f22364c8b299323"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyNDU5Mw==", "bodyText": "Is only 1.3.0 supported? Or 1.3.x, or 1.0+?\nAccording to the central repo, there are many coroutine releases, https://mvnrepository.com/artifact/org.jetbrains.kotlinx/kotlinx-coroutines-core. We should set the boundary clear.", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363024593", "createdAt": "2020-01-04T08:58:19Z", "author": {"login": "wu-sheng"}, "path": "test/plugin/scenarios/kotlin-coroutine-scenario/support-version.list", "diffHunk": "@@ -0,0 +1,16 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+1.3.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d0e4efffdee024c939fd6277f22364c8b299323"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "760c4fef751a194f803d9ea4ab7f825127a68bea", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/760c4fef751a194f803d9ea4ab7f825127a68bea", "committedDate": "2020-01-04T09:49:29Z", "message": "Add more kotlin coroutine to test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9ad4d825201095da6597c261d2687b9512ff0fe", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/c9ad4d825201095da6597c261d2687b9512ff0fe", "committedDate": "2020-01-04T09:49:47Z", "message": "Update docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/dcbfaf3ac48e46b5000b5287f4fc41e054725e69", "committedDate": "2020-01-04T09:53:51Z", "message": "Update image url"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzQ4NTcx", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338348571", "createdAt": "2020-01-04T11:07:09Z", "commit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQxMTowNzowOVrOFaNjoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQxMToxNjozOFrOFaNlAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTQwOQ==", "bodyText": "You miss this update.", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363029409", "createdAt": "2020-01-04T11:07:09Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/Supported-list.md", "diffHunk": "@@ -86,6 +86,8 @@\n   * [Spring @Async](https://github.com/spring-projects/spring-framework) 4.x and 5.x\n * Cache\n   * [Ehcache](https://www.ehcache.org/) 2.x\n+* Kotlin\n+  * [Coroutine](https://kotlinlang.org/docs/reference/coroutines-overview.html) 1.3.x (Optional\u00b2)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTQxOA==", "bodyText": "This plugin, not PR", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363029418", "createdAt": "2020-01-04T11:07:39Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/agent-optional-plugins/Kotlin-Coroutine-plugin.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# Skywalking with Kotlin coroutine\n+This PR provided an auto instrument support plugin for Kotlin coroutine based on context snapshot.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTUxNA==", "bodyText": "With no -> Without\nBusiness code changed -> changing codes manually.\nTracing path -> spans", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363029514", "createdAt": "2020-01-04T11:10:26Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/agent-optional-plugins/Kotlin-Coroutine-plugin.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# Skywalking with Kotlin coroutine\n+This PR provided an auto instrument support plugin for Kotlin coroutine based on context snapshot.\n+\n+## Description\n+We have known there are some limits with skywalking and coroutine, because of the trace context based on `ThreadLocal`.\n+\n+But skywalking provided context snapshot for cross-thread tracing, I create this plugin for resolving context losing in Kotlin coroutine.\n+\n+## Implementation principle\n+As we know, Kotlin coroutine switches the execution thread by `CoroutineDispatcher`.\n+\n+01. Create a snapshot of the current context before dispatch the continuation.\n+02. Then create a coroutine span after thread switched, mark the span continued with the snapshot.\n+03. Every new span which created in the new thread will be a child of this coroutine span. So we can link those span together in a tracing.\n+04. After the original runnable executed, we need to stop the coroutine span for cleaning thread state.\n+\n+## Some screenshots\n+### Run without the plugin\n+We run a Kotlin coroutine based gRPC server without this coroutine plugin.  \n+You can find, the one call (client -> server1 -> server2) has been split two tracing paths.\n+\n+01. Server1 without exit span and server2 tracing path.\n+![Without kotlin plugin1](http://skywalking.apache.org/screenshots/7.0.0/kotlin/coroutine/without-coroutine-plugin-server1.jpg)\n+02. Server2 tracing path.\n+![Without kotlin plugin2](http://skywalking.apache.org/screenshots/7.0.0/kotlin/coroutine/without-coroutine-plugin-server2.jpg)\n+\n+### Run with the plugin\n+With no business code changed, just install the plugin. We can find the tracing paths be connected together. We can get all info of one client call.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTY1OA==", "bodyText": "We need to add the reason of optional plugin.\nPlugin of Kotlin coroutine provides the tracing across coroutines automatically. As it will add local spans to all across routines scenarios, Please assess the performance impact.", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363029658", "createdAt": "2020-01-04T11:13:59Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/README.md", "diffHunk": "@@ -135,6 +135,7 @@ Now, we have the following known optional plugins.\n * [Customize enhance](Customize-enhance-trace.md) Trace methods based on description files, rather than write plugin or change source codes.\n * Plugin of Spring Cloud Gateway 2.1.x in optional plugin folder. Please only active this plugin when you install agent in Spring Gateway. spring-cloud-gateway-2.x-plugin and spring-webflux-5.x-plugin are both required.\n * Plugin of Spring Transaction in optional plugin folder. The reason of being optional plugin is, many local span are generated, which also spend more CPU, memory and network.\n+* [Plugin of Kotlin coroutine](agent-optional-plugins/Kotlin-Coroutine-plugin.md)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTY2Mw==", "bodyText": "Provided to provides", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363029663", "createdAt": "2020-01-04T11:14:15Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/agent-optional-plugins/Kotlin-Coroutine-plugin.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# Skywalking with Kotlin coroutine\n+This PR provided an auto instrument support plugin for Kotlin coroutine based on context snapshot.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTQxOA=="}, "originalCommit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTczNQ==", "bodyText": "Description official document should like\nSkyWalking provide tracing context propagation inside thread. In order to support Kotlin Coroutine, we provide this additional plugin.", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363029735", "createdAt": "2020-01-04T11:16:00Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/agent-optional-plugins/Kotlin-Coroutine-plugin.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# Skywalking with Kotlin coroutine\n+This PR provided an auto instrument support plugin for Kotlin coroutine based on context snapshot.\n+\n+## Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTc2MQ==", "bodyText": "Your description is PR context.", "url": "https://github.com/apache/skywalking/pull/4165#discussion_r363029761", "createdAt": "2020-01-04T11:16:38Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/service-agent/java-agent/agent-optional-plugins/Kotlin-Coroutine-plugin.md", "diffHunk": "@@ -0,0 +1,30 @@\n+# Skywalking with Kotlin coroutine\n+This PR provided an auto instrument support plugin for Kotlin coroutine based on context snapshot.\n+\n+## Description", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyOTczNQ=="}, "originalCommit": {"oid": "dcbfaf3ac48e46b5000b5287f4fc41e054725e69"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81bd37c974c1193dcac7abbb0184ec413866e329", "author": {"user": {"login": "devkanro", "name": "Kanro"}}, "url": "https://github.com/apache/skywalking/commit/81bd37c974c1193dcac7abbb0184ec413866e329", "committedDate": "2020-01-04T12:15:26Z", "message": "Fix docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5abf643f59a93be6d50fa9bbe8095fffe7815927", "author": {"user": {"login": "wu-sheng", "name": "\u5434\u665f Wu Sheng"}}, "url": "https://github.com/apache/skywalking/commit/5abf643f59a93be6d50fa9bbe8095fffe7815927", "committedDate": "2020-01-04T12:31:57Z", "message": "Merge branch 'master' into kt"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzUzMTEw", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338353110", "createdAt": "2020-01-04T13:15:41Z", "commit": {"oid": "5abf643f59a93be6d50fa9bbe8095fffe7815927"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzUzNTc3", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338353577", "createdAt": "2020-01-04T13:31:08Z", "commit": {"oid": "5abf643f59a93be6d50fa9bbe8095fffe7815927"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzU0MTg2", "url": "https://github.com/apache/skywalking/pull/4165#pullrequestreview-338354186", "createdAt": "2020-01-04T13:49:32Z", "commit": {"oid": "5abf643f59a93be6d50fa9bbe8095fffe7815927"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2719, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}