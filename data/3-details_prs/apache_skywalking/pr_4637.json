{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMTg1NTA5", "number": 4637, "title": "support `java` -> `nginx` -> `java` e2e test, and v3 protocol", "bodyText": "Please answer these questions before submitting pull request\n\n\nWhy submit this pull request?\n\n\n Bug fix\n\n\n New feature provided\n\n\n Improve performance\n\n\nRelated issues\n#4455\n\n\n\nNew feature or improvement\n\nadd java -> nginx -> java e2e test.\nadapt the new v3 protocol backend.", "createdAt": "2020-04-11T12:45:40Z", "url": "https://github.com/apache/skywalking/pull/4637", "merged": true, "mergeCommit": {"oid": "1601cc107c800e1011b37f131d1b520c1a8a57b0"}, "closed": true, "closedAt": "2020-04-11T14:31:29Z", "author": {"login": "mrproliu"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWlB19gH2gAyNDAyMTg1NTA5OjcwNzc1MjU2MDZkMWE4YWQzNTAyNTdkYmJkMWZiMzhmM2M2NTViZjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWmmkQAFqTM5MTc3MTAyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7077525606d1a8ad350257dbbd1fb38f3c655bf8", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/7077525606d1a8ad350257dbbd1fb38f3c655bf8", "committedDate": "2020-04-11T12:40:55Z", "message": "support `java` -> `nginx` -> `java` e2e test, and v3 protocol"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzY1OTk3", "url": "https://github.com/apache/skywalking/pull/4637#pullrequestreview-391765997", "createdAt": "2020-04-11T13:24:06Z", "commit": {"oid": "7077525606d1a8ad350257dbbd1fb38f3c655bf8"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMzoyNDowNlrOGENMSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMzoyNDozNlrOGENMhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA2MzYyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  - 9091\n          \n          \n            \n                  - 9090", "url": "https://github.com/apache/skywalking/pull/4637#discussion_r407063626", "createdAt": "2020-04-11T13:24:06Z", "author": {"login": "kezhenxu94"}, "path": "test/e2e/e2e-test/docker/lua/docker-compose.yml", "diffHunk": "@@ -42,7 +42,27 @@ services:\n       oap:\n         condition: service_healthy\n \n-  provider:\n+  provider-entry:\n+    build:\n+      context: ../../../\n+      dockerfile: e2e-test/docker/Dockerfile.provider\n+    networks:\n+      - e2e\n+    expose:\n+      - 9091", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7077525606d1a8ad350257dbbd1fb38f3c655bf8"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA2MzY1Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  test: [\"CMD\", \"sh\", \"-c\", \"nc -z 127.0.0.1 9091\"]\n          \n          \n            \n                  test: [\"CMD\", \"sh\", \"-c\", \"nc -z 127.0.0.1 9090\"]", "url": "https://github.com/apache/skywalking/pull/4637#discussion_r407063653", "createdAt": "2020-04-11T13:24:13Z", "author": {"login": "kezhenxu94"}, "path": "test/e2e/e2e-test/docker/lua/docker-compose.yml", "diffHunk": "@@ -42,7 +42,27 @@ services:\n       oap:\n         condition: service_healthy\n \n-  provider:\n+  provider-entry:\n+    build:\n+      context: ../../../\n+      dockerfile: e2e-test/docker/Dockerfile.provider\n+    networks:\n+      - e2e\n+    expose:\n+      - 9091\n+    environment:\n+      - SW_AGENT_COLLECTOR_BACKEND_SERVICES=oap:11800\n+      - SW_AGENT_NAME=e2e-service-entry-provider\n+    depends_on:\n+      oap:\n+        condition: service_healthy\n+    healthcheck:\n+      test: [\"CMD\", \"sh\", \"-c\", \"nc -z 127.0.0.1 9091\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7077525606d1a8ad350257dbbd1fb38f3c655bf8"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA2MzY4Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @ContainerHostAndPort(name = \"provider-entry\", port = 8080)\n          \n          \n            \n                @ContainerHostAndPort(name = \"provider-entry\", port = 9090)", "url": "https://github.com/apache/skywalking/pull/4637#discussion_r407063686", "createdAt": "2020-04-11T13:24:36Z", "author": {"login": "kezhenxu94"}, "path": "test/e2e/e2e-test/src/test/java/org/apache/skywalking/e2e/LuaE2E.java", "diffHunk": "@@ -77,17 +77,22 @@\n     @ContainerHostAndPort(name = \"ui\", port = 8080)\n     private HostAndPort swWebappHostPort;\n \n+    @SuppressWarnings(\"unused\")\n+    @ContainerHostAndPort(name = \"provider-entry\", port = 8080)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7077525606d1a8ad350257dbbd1fb38f3c655bf8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9438323cc343fe5603dd97a9c0fa04da470154b", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/e9438323cc343fe5603dd97a9c0fa04da470154b", "committedDate": "2020-04-11T13:27:41Z", "message": "fix wrong lua e2e container port define"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "730bd53b0f30fac0ad6e04906fc4bba3608cceb9", "author": {"user": null}, "url": "https://github.com/apache/skywalking/commit/730bd53b0f30fac0ad6e04906fc4bba3608cceb9", "committedDate": "2020-04-11T13:43:56Z", "message": "fix e2e error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzcxMDI4", "url": "https://github.com/apache/skywalking/pull/4637#pullrequestreview-391771028", "createdAt": "2020-04-11T14:30:56Z", "commit": {"oid": "730bd53b0f30fac0ad6e04906fc4bba3608cceb9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2286, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}