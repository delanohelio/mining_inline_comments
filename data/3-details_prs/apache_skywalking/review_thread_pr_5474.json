{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1MjI4NTM3", "number": 5474, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMzowOTozNVrOEivP9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwODoyNjozMFrOEiwjqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODYxMTc1OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-alarm.md", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMzowOTozNVrOHQyEoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNTo1OTowNVrOHQy6Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1OTY0OA==", "bodyText": "According to this doc, it seems to belong to Enterprise WeChat, could you confirm? Where is the doc about how to get a group robot?", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487359648", "createdAt": "2020-09-12T03:09:35Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/api/doc/90000/90136/91770).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM2MjE4MQ==", "bodyText": "Yes, this is the Enterprise wechat, I will change the link later", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487362181", "createdAt": "2020-09-12T03:40:26Z", "author": {"login": "xbkaishui"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/api/doc/90000/90136/91770).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1OTY0OA=="}, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM2Mjg1Nw==", "bodyText": "Does this mean, this can't be done in a normal WeChat group?", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487362857", "createdAt": "2020-09-12T03:48:25Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/api/doc/90000/90136/91770).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1OTY0OA=="}, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3MjI0NQ==", "bodyText": "Yes, there is not open api for normal WeChat group, it's not illegal", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487372245", "createdAt": "2020-09-12T05:44:53Z", "author": {"login": "xbkaishui"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/api/doc/90000/90136/91770).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1OTY0OA=="}, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3MjUxMQ==", "bodyText": "Then let's indicate it clearly in the document. Because people may be misguided by the current doc. The first look to me is, this works on any WeChat until I open the API doc you linked.", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487372511", "createdAt": "2020-09-12T05:47:45Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/api/doc/90000/90136/91770).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1OTY0OA=="}, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3MzQwNw==", "bodyText": "got it", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487373407", "createdAt": "2020-09-12T05:59:05Z", "author": {"login": "xbkaishui"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/api/doc/90000/90136/91770).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1OTY0OA=="}, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODYxMjA2OnYy", "diffSide": "RIGHT", "path": "oap-server/server-alarm-plugin/src/main/java/org/apache/skywalking/oap/server/core/alarm/provider/Rules.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMzoxMDowN1rOHQyExw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMzoxMDowN1rOHQyExw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1OTY4Nw==", "bodyText": "Different naming style. Please fix.", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487359687", "createdAt": "2020-09-12T03:10:07Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-alarm-plugin/src/main/java/org/apache/skywalking/oap/server/core/alarm/provider/Rules.java", "diffHunk": "@@ -34,6 +35,7 @@\n     private List<String> webhooks;\n     private GRPCAlarmSetting grpchookSetting;\n     private SlackSettings slacks;\n+    private WechatSettings wechatSetting;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODYxMjg0OnYy", "diffSide": "RIGHT", "path": "oap-server/server-alarm-plugin/src/main/java/org/apache/skywalking/oap/server/core/alarm/provider/wechat/WechatHookCallback.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMzoxMDo1OVrOHQyFIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMzoxMDo1OVrOHQyFIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1OTc3Ng==", "bodyText": "Remove the link from the comments.", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487359776", "createdAt": "2020-09-12T03:10:59Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-alarm-plugin/src/main/java/org/apache/skywalking/oap/server/core/alarm/provider/wechat/WechatHookCallback.java", "diffHunk": "@@ -0,0 +1,102 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.core.alarm.provider.wechat;\n+\n+import io.netty.handler.codec.http.HttpHeaderValues;\n+import lombok.extern.slf4j.Slf4j;\n+import org.apache.http.HttpHeaders;\n+import org.apache.http.HttpStatus;\n+import org.apache.http.StatusLine;\n+import org.apache.http.client.config.RequestConfig;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.entity.ContentType;\n+import org.apache.http.entity.StringEntity;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.skywalking.oap.server.core.alarm.AlarmCallback;\n+import org.apache.skywalking.oap.server.core.alarm.AlarmMessage;\n+import org.apache.skywalking.oap.server.core.alarm.provider.AlarmRulesWatcher;\n+\n+import java.io.IOException;\n+import java.util.List;\n+\n+/**\n+ * Use SkyWalking alarm wechat webhook API.\n+ * See https://work.weixin.qq.com/api/doc/90000/90136/91770", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODYxNjk3OnYy", "diffSide": "RIGHT", "path": "oap-server/server-alarm-plugin/src/main/java/org/apache/skywalking/oap/server/core/alarm/provider/wechat/WechatHookCallback.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMzoxNjo1NFrOHQyHMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMzoxNjo1NFrOHQyHMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM2MDMwNA==", "bodyText": "Don't connect the literal strings with +. There is no performance issue in the JDK8+, but this is not good for reading. Please use {} for the place holder.", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487360304", "createdAt": "2020-09-12T03:16:54Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-alarm-plugin/src/main/java/org/apache/skywalking/oap/server/core/alarm/provider/wechat/WechatHookCallback.java", "diffHunk": "@@ -0,0 +1,102 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.oap.server.core.alarm.provider.wechat;\n+\n+import io.netty.handler.codec.http.HttpHeaderValues;\n+import lombok.extern.slf4j.Slf4j;\n+import org.apache.http.HttpHeaders;\n+import org.apache.http.HttpStatus;\n+import org.apache.http.StatusLine;\n+import org.apache.http.client.config.RequestConfig;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.entity.ContentType;\n+import org.apache.http.entity.StringEntity;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.skywalking.oap.server.core.alarm.AlarmCallback;\n+import org.apache.skywalking.oap.server.core.alarm.AlarmMessage;\n+import org.apache.skywalking.oap.server.core.alarm.provider.AlarmRulesWatcher;\n+\n+import java.io.IOException;\n+import java.util.List;\n+\n+/**\n+ * Use SkyWalking alarm wechat webhook API.\n+ * See https://work.weixin.qq.com/api/doc/90000/90136/91770\n+ */\n+@Slf4j\n+public class WechatHookCallback implements AlarmCallback {\n+    private static final int HTTP_CONNECT_TIMEOUT = 1000;\n+    private static final int HTTP_CONNECTION_REQUEST_TIMEOUT = 1000;\n+    private static final int HTTP_SOCKET_TIMEOUT = 10000;\n+    private AlarmRulesWatcher alarmRulesWatcher;\n+    private RequestConfig requestConfig;\n+\n+    public WechatHookCallback(final AlarmRulesWatcher alarmRulesWatcher) {\n+        this.alarmRulesWatcher = alarmRulesWatcher;\n+        this.requestConfig = RequestConfig.custom()\n+                .setConnectTimeout(HTTP_CONNECT_TIMEOUT)\n+                .setConnectionRequestTimeout(HTTP_CONNECTION_REQUEST_TIMEOUT)\n+                .setSocketTimeout(HTTP_SOCKET_TIMEOUT)\n+                .build();\n+    }\n+\n+    @Override\n+    public void doAlarm(List<AlarmMessage> alarmMessages) {\n+        if (this.alarmRulesWatcher.getWechatSettings() == null || this.alarmRulesWatcher.getWechatSettings().getWebhooks().isEmpty()) {\n+            return;\n+        }\n+        CloseableHttpClient httpClient = HttpClients.custom().build();\n+        try {\n+            this.alarmRulesWatcher.getWechatSettings().getWebhooks().forEach(url -> {\n+                alarmMessages.forEach(alarmMessage -> {\n+                    String requestBody = String.format(\n+                            this.alarmRulesWatcher.getWechatSettings().getTextTemplate(), alarmMessage.getAlarmMessage()\n+                    );\n+                    sendAlarmMessage(httpClient, url, requestBody);\n+                });\n+            });\n+        } finally {\n+            try {\n+                httpClient.close();\n+            } catch (IOException e) {\n+                log.error(e.getMessage(), e);\n+            }\n+        }\n+    }\n+\n+    private void sendAlarmMessage(CloseableHttpClient httpClient, String url, String requestBody) {\n+        try {\n+            HttpPost post = new HttpPost(url);\n+            post.setConfig(requestConfig);\n+            post.setHeader(HttpHeaders.ACCEPT, HttpHeaderValues.APPLICATION_JSON.toString());\n+            post.setHeader(HttpHeaders.CONTENT_TYPE, HttpHeaderValues.APPLICATION_JSON.toString());\n+            StringEntity entity = new StringEntity(requestBody, ContentType.APPLICATION_JSON);\n+            post.setEntity(entity);\n+            CloseableHttpResponse httpResponse = httpClient.execute(post);\n+            StatusLine statusLine = httpResponse.getStatusLine();\n+            if (statusLine != null && statusLine.getStatusCode() != HttpStatus.SC_OK) {\n+                log.error(\"send wechat alarm to \" + url + \" failure. Response code: \" + statusLine.getStatusCode());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f09f8ba32b1d9f82a68817cea46d733430e6ad1b"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODcyOTQxOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-alarm.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNjowMTozOFrOHQy7QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNjowMTozOFrOHQy7QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3MzYzMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The alarm message will send through HTTP post by `application/json` content type if you configured Wechat Webhooks as following:\n          \n          \n            \n            The alarm message would send through HTTP post by `application/json` content type after you set up Wechat Webhooks as following:", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487373632", "createdAt": "2020-09-12T06:01:38Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).\n+The alarm message will send through HTTP post by `application/json` content type if you configured Wechat Webhooks as following:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7403d8159f3726b16f11240035ca3faebda2a40"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODczMDMxOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-alarm.md", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNjowMzowMFrOHQy7ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNjoxMzowMlrOHQy-1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3MzczMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).\n          \n          \n            \n            Note, only WeCom(WeChat Company Edition) supports webhook. To use the WeChat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487373731", "createdAt": "2020-09-12T06:03:00Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7403d8159f3726b16f11240035ca3faebda2a40"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3Mzc0NQ==", "bodyText": "WeCom is from the official website.", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487373745", "createdAt": "2020-09-12T06:03:22Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3MzczMQ=="}, "originalCommit": {"oid": "a7403d8159f3726b16f11240035ca3faebda2a40"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3NDU0OQ==", "bodyText": "changed", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487374549", "createdAt": "2020-09-12T06:13:02Z", "author": {"login": "xbkaishui"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+To use Wechat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3MzczMQ=="}, "originalCommit": {"oid": "a7403d8159f3726b16f11240035ca3faebda2a40"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODczMDc1OnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-alarm.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNjowNDoyM1rOHQy73A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwNjowNjoyNFrOHQy8mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3Mzc4OA==", "bodyText": "Take a look at my previous comment. This seems not called enterprise wechat.", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487373788", "createdAt": "2020-09-12T06:04:23Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+Notice: This is only apply to Enterprise Webchat. To use Wechat webhook you need to follow the [Enterprise Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "345c120938b74ca83b9ef7f7e2d01ac18923a2f3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3Mzk3OA==", "bodyText": "Ok, thanks", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487373978", "createdAt": "2020-09-12T06:06:24Z", "author": {"login": "xbkaishui"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+Notice: This is only apply to Enterprise Webchat. To use Wechat webhook you need to follow the [Enterprise Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM3Mzc4OA=="}, "originalCommit": {"oid": "345c120938b74ca83b9ef7f7e2d01ac18923a2f3"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODgyNTg2OnYy", "diffSide": "RIGHT", "path": "oap-server/server-bootstrap/src/main/resources/alarm-settings.yml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwODoyNjoxMlrOHQzoWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwODoyNjoxMlrOHQzoWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM4NTE3Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"content\": \"Apache Skywalking Alarm: \\n %s.\"\n          \n          \n            \n                    \"content\": \"Apache SkyWalking Alarm: \\n %s.\"", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487385177", "createdAt": "2020-09-12T08:26:12Z", "author": {"login": "wu-sheng"}, "path": "oap-server/server-bootstrap/src/main/resources/alarm-settings.yml", "diffHunk": "@@ -59,3 +59,13 @@ slackHooks:\n   webhooks:\n #    - https://hooks.slack.com/services/x/y/zssss\n \n+wechatHooks:\n+  textTemplate: |-\n+    {\n+      \"msgtype\": \"text\",\n+      \"text\": {\n+        \"content\": \"Apache Skywalking Alarm: \\n %s.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40ed2779ea4c77c00542975b2f37266f5867e807"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0ODgyNjAzOnYy", "diffSide": "RIGHT", "path": "docs/en/setup/backend/backend-alarm.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwODoyNjozMFrOHQzobQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwODoyNjozMFrOHQzobQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM4NTE5Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"content\": \"Apache Skywalking Alarm: \\n %s.\"\n          \n          \n            \n                    \"content\": \"Apache SkyWalking Alarm: \\n %s.\"", "url": "https://github.com/apache/skywalking/pull/5474#discussion_r487385197", "createdAt": "2020-09-12T08:26:30Z", "author": {"login": "wu-sheng"}, "path": "docs/en/setup/backend/backend-alarm.md", "diffHunk": "@@ -180,6 +180,23 @@ slackHooks:\n     - https://hooks.slack.com/services/x/y/z\n ```\n \n+## WeChat Hook\n+Note, only WeCom(WeChat Company Edition) supports webhook. To use the WeChat webhook you need to follow the [Wechat Webhooks guide](https://work.weixin.qq.com/help?doc_id=13376).\n+The alarm message would send through HTTP post by `application/json` content type after you set up Wechat Webhooks as following:\n+```yml\n+wechatHooks:\n+  textTemplate: |-\n+    {\n+      \"msgtype\": \"text\",\n+      \"text\": {\n+        \"content\": \"Apache Skywalking Alarm: \\n %s.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "313504ce3679cc803436d4a2091536d4caca315b"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4796, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}