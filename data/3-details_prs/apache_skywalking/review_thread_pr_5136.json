{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUzNDEzMDM2", "number": 5136, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMzowNDo1MFrOEQKrBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNDozODoyNFrOEQOImg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1Mzg3NTI1OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/boot/ConfigInitializationService.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMzowNDo1MFrOG0LQyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNDoxMDoyM1rOG0OySQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM2MzY1Nw==", "bodyText": "I didn't see any particular usage of this method, all implementations of this interface return the class itself, just to get the implemented class, I think this method is no needed actually", "url": "https://github.com/apache/skywalking/pull/5136#discussion_r457363657", "createdAt": "2020-07-20T13:04:50Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/boot/ConfigInitializationService.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.boot;\n+\n+/**\n+ * ConfigInitializationService provides the config class which should host all parameters originally from agent setup.\n+ * {@link org.apache.skywalking.apm.agent.core.conf.Config} provides the core level config, all plugins could implement\n+ * this interface to have the same capability about initializing config from agent.config, system properties and system\n+ * environment variables.\n+ */\n+public interface ConfigInitializationService {\n+    /**\n+     * @return Config to host parameters, all static fields set based on the config variable name.\n+     */\n+    Class config();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7d57adedb3c5f8dc0cbf0a5fcbc0bc67b6c3ee"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM2NjM2OA==", "bodyText": "I just want to follow the SPI mode, because the developer actually could not return this class type.", "url": "https://github.com/apache/skywalking/pull/5136#discussion_r457366368", "createdAt": "2020-07-20T13:08:33Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/boot/ConfigInitializationService.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.boot;\n+\n+/**\n+ * ConfigInitializationService provides the config class which should host all parameters originally from agent setup.\n+ * {@link org.apache.skywalking.apm.agent.core.conf.Config} provides the core level config, all plugins could implement\n+ * this interface to have the same capability about initializing config from agent.config, system properties and system\n+ * environment variables.\n+ */\n+public interface ConfigInitializationService {\n+    /**\n+     * @return Config to host parameters, all static fields set based on the config variable name.\n+     */\n+    Class config();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM2MzY1Nw=="}, "originalCommit": {"oid": "ca7d57adedb3c5f8dc0cbf0a5fcbc0bc67b6c3ee"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM2ODgzMw==", "bodyText": "I just want to follow the SPI mode, because the developer actually could not return this class type.\n\nThis is nothing todo with SPI IMO, and the developer doesn't need to return the type, we just get the actual class in the service loader, see my another comment inline", "url": "https://github.com/apache/skywalking/pull/5136#discussion_r457368833", "createdAt": "2020-07-20T13:11:51Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/boot/ConfigInitializationService.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.boot;\n+\n+/**\n+ * ConfigInitializationService provides the config class which should host all parameters originally from agent setup.\n+ * {@link org.apache.skywalking.apm.agent.core.conf.Config} provides the core level config, all plugins could implement\n+ * this interface to have the same capability about initializing config from agent.config, system properties and system\n+ * environment variables.\n+ */\n+public interface ConfigInitializationService {\n+    /**\n+     * @return Config to host parameters, all static fields set based on the config variable name.\n+     */\n+    Class config();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM2MzY1Nw=="}, "originalCommit": {"oid": "ca7d57adedb3c5f8dc0cbf0a5fcbc0bc67b6c3ee"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM3MzgwMw==", "bodyText": "I have read that. I mean, this Config class is loaded through SPI.", "url": "https://github.com/apache/skywalking/pull/5136#discussion_r457373803", "createdAt": "2020-07-20T13:18:26Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/boot/ConfigInitializationService.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.boot;\n+\n+/**\n+ * ConfigInitializationService provides the config class which should host all parameters originally from agent setup.\n+ * {@link org.apache.skywalking.apm.agent.core.conf.Config} provides the core level config, all plugins could implement\n+ * this interface to have the same capability about initializing config from agent.config, system properties and system\n+ * environment variables.\n+ */\n+public interface ConfigInitializationService {\n+    /**\n+     * @return Config to host parameters, all static fields set based on the config variable name.\n+     */\n+    Class config();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM2MzY1Nw=="}, "originalCommit": {"oid": "ca7d57adedb3c5f8dc0cbf0a5fcbc0bc67b6c3ee"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzQyMTM4NQ==", "bodyText": "I think the new initialization mode fits your preference more. Anyway, the old way is wrong in the tech perspective.", "url": "https://github.com/apache/skywalking/pull/5136#discussion_r457421385", "createdAt": "2020-07-20T14:10:23Z", "author": {"login": "wu-sheng"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/boot/ConfigInitializationService.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.boot;\n+\n+/**\n+ * ConfigInitializationService provides the config class which should host all parameters originally from agent setup.\n+ * {@link org.apache.skywalking.apm.agent.core.conf.Config} provides the core level config, all plugins could implement\n+ * this interface to have the same capability about initializing config from agent.config, system properties and system\n+ * environment variables.\n+ */\n+public interface ConfigInitializationService {\n+    /**\n+     * @return Config to host parameters, all static fields set based on the config variable name.\n+     */\n+    Class config();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM2MzY1Nw=="}, "originalCommit": {"oid": "ca7d57adedb3c5f8dc0cbf0a5fcbc0bc67b6c3ee"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1Mzg3NzE4OnYy", "diffSide": "RIGHT", "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/boot/PluginConfigInitializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMzowNToxMVrOG0LRxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMzowNToxMVrOG0LRxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM2MzkxMQ==", "bodyText": "Here is what I mean\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        SnifferConfigInitializer.initializeConfig(configInitializationService.config());\n          \n          \n            \n                        SnifferConfigInitializer.initializeConfig(configInitializationService.getClass());", "url": "https://github.com/apache/skywalking/pull/5136#discussion_r457363911", "createdAt": "2020-07-20T13:05:11Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/boot/PluginConfigInitializer.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.agent.core.boot;\n+\n+import java.util.ServiceLoader;\n+import org.apache.skywalking.apm.agent.core.conf.SnifferConfigInitializer;\n+import org.apache.skywalking.apm.agent.core.plugin.loader.AgentClassLoader;\n+\n+/**\n+ * PluginConfigInitializer loads Config(s) in all existing plugins, and initialize them through current agent settings.\n+ */\n+public class PluginConfigInitializer {\n+    public void initConfigurationsOfAllPlugins() {\n+        final ServiceLoader<ConfigInitializationService> configServiceLoader = ServiceLoader.load(\n+            ConfigInitializationService.class, AgentClassLoader.getDefault());\n+        configServiceLoader.forEach(configInitializationService -> {\n+            SnifferConfigInitializer.initializeConfig(configInitializationService.config());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7d57adedb3c5f8dc0cbf0a5fcbc0bc67b6c3ee"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NDQ0MDMyOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/optional-plugins/customize-enhance-plugin/src/main/java/org/apache/skywalking/apm/plugin/customize/conf/PluginConfigService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNDozODowMFrOG0QW8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNDozODowMFrOG0QW8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzQ0NzE1NQ==", "bodyText": "Is it intentionally named with a Service suffix? Seems very different from others", "url": "https://github.com/apache/skywalking/pull/5136#discussion_r457447155", "createdAt": "2020-07-20T14:38:00Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/optional-plugins/customize-enhance-plugin/src/main/java/org/apache/skywalking/apm/plugin/customize/conf/PluginConfigService.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.customize.conf;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import org.apache.skywalking.apm.agent.core.boot.PluginConfig;\n+\n+public class PluginConfigService implements PluginConfig {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5d13666401c0ec7273d434df0bdc93024cb2886"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NDQ0MjUwOnYy", "diffSide": "RIGHT", "path": "apm-sniffer/apm-toolkit-activation/apm-toolkit-trace-activation/src/main/java/org/apache/skywalking/apm/toolkit/activation/ToolkitPluginConfigService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNDozODoyNFrOG0QYNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNDozODoyNFrOG0QYNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzQ0NzQ3OQ==", "bodyText": "And this one", "url": "https://github.com/apache/skywalking/pull/5136#discussion_r457447479", "createdAt": "2020-07-20T14:38:24Z", "author": {"login": "kezhenxu94"}, "path": "apm-sniffer/apm-toolkit-activation/apm-toolkit-trace-activation/src/main/java/org/apache/skywalking/apm/toolkit/activation/ToolkitPluginConfigService.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.toolkit.activation;\n+\n+import org.apache.skywalking.apm.agent.core.boot.PluginConfig;\n+\n+public class ToolkitPluginConfigService implements PluginConfig {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5d13666401c0ec7273d434df0bdc93024cb2886"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 100, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}