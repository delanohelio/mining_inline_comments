{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5OTgxOTk3", "number": 2944, "title": "Config for breaking token building flow on error when obtaining claims", "bodyText": "Description:\nThis config is used to check whether to break the normal authentication flow upon facing claim handling errors. Currently an empty claim map is returned and the flow continues. This config is used to decide which action to take in such a scenario.\nRelated issues:\nwso2/product-is#8168\nRelated PRs:\nwso2-extensions/identity-inbound-auth-oauth#1381", "createdAt": "2020-05-19T09:06:36Z", "url": "https://github.com/wso2/carbon-identity-framework/pull/2944", "merged": true, "mergeCommit": {"oid": "851189abce84393f5c104f6e5de40dbb44364dee"}, "closed": true, "closedAt": "2020-05-19T17:10:33Z", "author": {"login": "ashendes"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciwrn-AH2gAyNDE5OTgxOTk3Ojc5YTNjMzg2NzJmNzdhMzUyZTgwZjk1NTZlZjZiNTEwNWQzZDAxYTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABci3qOAAFqTQxNDY1NDczOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "79a3c38672f77a352e80f9556ef6b5105d3d01a3", "author": {"user": {"login": "ashendes", "name": "Ashen Kavinda De Silva"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/79a3c38672f77a352e80f9556ef6b5105d3d01a3", "committedDate": "2020-05-19T09:02:36Z", "message": "Config and config getter methods for breaking token building flow when an error is encountered while obtaining OIDC claims"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57e48ec18514adb91ca920144dc83f3eb6b23b98", "author": {"user": {"login": "ashendes", "name": "Ashen Kavinda De Silva"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/57e48ec18514adb91ca920144dc83f3eb6b23b98", "committedDate": "2020-05-19T09:37:01Z", "message": "Config getter method check fixed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDg0Nzk3", "url": "https://github.com/wso2/carbon-identity-framework/pull/2944#pullrequestreview-414484797", "createdAt": "2020-05-19T14:10:58Z", "commit": {"oid": "57e48ec18514adb91ca920144dc83f3eb6b23b98"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDoxMDo1OFrOGXiSow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDoxMDo1OFrOGXiSow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMzMjI1OQ==", "bodyText": "return !Boolean.FALSE.toString().equalsIgnoreCase(continueOnClaimHandlingErrorValue)", "url": "https://github.com/wso2/carbon-identity-framework/pull/2944#discussion_r427332259", "createdAt": "2020-05-19T14:10:58Z", "author": {"login": "tharindu-bandara"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/util/FrameworkUtils.java", "diffHunk": "@@ -2546,4 +2551,22 @@ private static UserStoreManager getUserStoreManager(int tenantId, String userSto\n         }\n         return userStoreManager;\n     }\n+\n+    /**\n+     * Check whether the authentication flow should continue upon facing a claim handling error.\n+     *\n+     * @return true/false Continue or break flow when facing claim handling errors.\n+     */\n+    public static boolean isContinueOnClaimHandlingErrorAllowed() {\n+\n+        String continueOnClaimHandlingErrorValue = IdentityUtil.getProperty(CONTINUE_ON_CLAIM_HANDLING_ERROR);\n+\n+        // If config is empty or not a boolean value, the property must be set to the default value which is true.\n+        if (StringUtils.isBlank(continueOnClaimHandlingErrorValue) ||\n+                !(TRUE.equalsIgnoreCase(continueOnClaimHandlingErrorValue) ||\n+                        FALSE.equalsIgnoreCase(continueOnClaimHandlingErrorValue))) {\n+            continueOnClaimHandlingErrorValue = CONTINUE_ON_CLAIM_HANDLING_ERROR_DEFAULT;\n+        }\n+        return Boolean.parseBoolean(continueOnClaimHandlingErrorValue);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e48ec18514adb91ca920144dc83f3eb6b23b98"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef99f932c704f0fcada28096fe1b57e9e9ca2628", "author": {"user": {"login": "ashendes", "name": "Ashen Kavinda De Silva"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/ef99f932c704f0fcada28096fe1b57e9e9ca2628", "committedDate": "2020-05-19T15:42:21Z", "message": "Config getter method updated."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NjU0NzM4", "url": "https://github.com/wso2/carbon-identity-framework/pull/2944#pullrequestreview-414654738", "createdAt": "2020-05-19T17:10:24Z", "commit": {"oid": "ef99f932c704f0fcada28096fe1b57e9e9ca2628"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2273, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}