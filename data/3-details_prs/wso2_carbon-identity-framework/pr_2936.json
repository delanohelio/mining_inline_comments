{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4NTA2Mzkx", "number": 2936, "title": "Implement SP App deletion on Tenant Deletion", "bodyText": "Proposed changes in this pull request\nImplemented the deletion of Service Provider Apps when a Tenant gets deleted\nFixes: #2932", "createdAt": "2020-05-15T10:23:57Z", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936", "merged": true, "mergeCommit": {"oid": "33bf65d2b6102c50cff558a7a694e4d5d0de80e7"}, "closed": true, "closedAt": "2020-07-13T05:07:04Z", "author": {"login": "sumedhe"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchfU7dAH2gAyNDE4NTA2MzkxOjQ4NDM4MjFmNjgwZDM0OTY4NjExMWM3NjBjYzk2NjUwZDA5OGE4MTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdtDjtmgFqTU2MTUxMzAwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4843821f680d349686111c760cc96650d098a818", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/4843821f680d349686111c760cc96650d098a818", "committedDate": "2020-05-15T10:15:30Z", "message": "Implement SP App deletion on Tenant Deletion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMDQ4NTgw", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-413048580", "createdAt": "2020-05-16T05:11:20Z", "commit": {"oid": "4843821f680d349686111c760cc96650d098a818"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwNToxMToyMVrOGWYRuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwNToxMToyMVrOGWYRuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExOTYwOQ==", "bodyText": "rename to deleteApplications(int tenantId)", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r426119609", "createdAt": "2020-05-16T05:11:21Z", "author": {"login": "IsuraD"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/ApplicationManagementService.java", "diffHunk": "@@ -131,6 +131,14 @@ public abstract void updateApplication(ServiceProvider serviceProvider, String t\n     public abstract void deleteApplication(String applicationName, String tenantDomain, String username)\n             throws IdentityApplicationManagementException;\n \n+    /**\n+     * Delete Applications by tenant id.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws IdentityApplicationManagementException\n+     */\n+    public abstract void deleteApplicationsByTenantId(int tenantId) throws IdentityApplicationManagementException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4843821f680d349686111c760cc96650d098a818"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMDQ4Njg5", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-413048689", "createdAt": "2020-05-16T05:13:08Z", "commit": {"oid": "4843821f680d349686111c760cc96650d098a818"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwNToxMzowOFrOGWYSOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwNToxMzowOFrOGWYSOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExOTczNw==", "bodyText": "remove line", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r426119737", "createdAt": "2020-05-16T05:13:08Z", "author": {"login": "IsuraD"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/ApplicationManagementServiceImpl.java", "diffHunk": "@@ -714,6 +714,20 @@ public void deleteApplication(String applicationName, String tenantDomain, Strin\n         }\n     }\n \n+    /**\n+     * Delete Applications by tenant id.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws IdentityApplicationManagementException\n+     */\n+    @Override\n+    public void deleteApplicationsByTenantId(int tenantId) throws IdentityApplicationManagementException {\n+\n+        ApplicationDAO appDAO = ApplicationMgtSystemConfig.getInstance().getApplicationDAO();\n+        appDAO.deleteApplicationsByTenantId(tenantId);\n+    }\n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4843821f680d349686111c760cc96650d098a818"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMDQ4NzIz", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-413048723", "createdAt": "2020-05-16T05:13:51Z", "commit": {"oid": "4843821f680d349686111c760cc96650d098a818"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwNToxMzo1MlrOGWYSUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwNToxMzo1MlrOGWYSUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjExOTc2Mw==", "bodyText": "Lets put an audit log here...", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r426119763", "createdAt": "2020-05-16T05:13:52Z", "author": {"login": "IsuraD"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/dao/impl/ApplicationDAOImpl.java", "diffHunk": "@@ -3538,6 +3540,41 @@ public void deleteApplication(int applicationID, Connection connection)\n \n     }\n \n+    /**\n+     * Delete all applications of a given tenant id.\n+     *\n+     * @param\n+     * @throws IdentityApplicationManagementException\n+     */\n+    @Override\n+    public void deleteApplicationsByTenantId(int tenantId) throws IdentityApplicationManagementException {\n+\n+        if (log.isDebugEnabled()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4843821f680d349686111c760cc96650d098a818"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4630f53f1e5b8e7a49e607681b2ed12a39c5bc16", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/4630f53f1e5b8e7a49e607681b2ed12a39c5bc16", "committedDate": "2020-05-19T08:41:15Z", "message": "Add audit logging and fix minor issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88800c6dd0f30fbfc3c606117f394bf390e7b527", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/88800c6dd0f30fbfc3c606117f394bf390e7b527", "committedDate": "2020-06-14T16:56:16Z", "message": "Merge remote-tracking branch 'wso2/master' into delete-sp-apps-on-tenant-deletion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxMzg4NjI5", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-431388629", "createdAt": "2020-06-16T10:57:16Z", "commit": {"oid": "c159bf2a8d905d2c763bd4368c46dcb51081c71b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxMDo1NzoxNlrOGkWGdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQxMDo1NzoxNlrOGkWGdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc2NDAyMQ==", "bodyText": "Add the params of the method.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r440764021", "createdAt": "2020-06-16T10:57:16Z", "author": {"login": "ShanChathusanda93"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/dao/impl/ApplicationDAOImpl.java", "diffHunk": "@@ -3538,6 +3545,45 @@ public void deleteApplication(int applicationID, Connection connection)\n \n     }\n \n+    /**\n+     * Delete all applications of a given tenant id.\n+     *\n+     * @param", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c159bf2a8d905d2c763bd4368c46dcb51081c71b"}, "originalPosition": 40}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c159bf2a8d905d2c763bd4368c46dcb51081c71b", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/c159bf2a8d905d2c763bd4368c46dcb51081c71b", "committedDate": "2020-06-14T19:30:52Z", "message": "Add cache cleaning after deletion"}, "afterCommit": {"oid": "c4f9c57f8b47155708dbd961bb95ad2300e52e84", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/c4f9c57f8b47155708dbd961bb95ad2300e52e84", "committedDate": "2020-06-16T20:06:45Z", "message": "Add cache cleaning after deletion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a9ebd30e2972ba85399e560f38f4455d384c8cc", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/5a9ebd30e2972ba85399e560f38f4455d384c8cc", "committedDate": "2020-06-16T20:08:45Z", "message": "Add cache cleaning after deletion"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c4f9c57f8b47155708dbd961bb95ad2300e52e84", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/c4f9c57f8b47155708dbd961bb95ad2300e52e84", "committedDate": "2020-06-16T20:06:45Z", "message": "Add cache cleaning after deletion"}, "afterCommit": {"oid": "5a9ebd30e2972ba85399e560f38f4455d384c8cc", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/5a9ebd30e2972ba85399e560f38f4455d384c8cc", "committedDate": "2020-06-16T20:08:45Z", "message": "Add cache cleaning after deletion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzOTY5NzI1", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-433969725", "createdAt": "2020-06-19T10:27:28Z", "commit": {"oid": "5a9ebd30e2972ba85399e560f38f4455d384c8cc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMDoyNzoyOVrOGmQAwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMDoyNzoyOVrOGmQAwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjc2MTQxMA==", "bodyText": "rename to  public void deleteApplications(int tenantId)", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r442761410", "createdAt": "2020-06-19T10:27:29Z", "author": {"login": "IsuraD"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/dao/impl/ApplicationDAOImpl.java", "diffHunk": "@@ -3538,6 +3545,45 @@ public void deleteApplication(int applicationID, Connection connection)\n \n     }\n \n+    /**\n+     * Delete all applications of a given tenant id.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws IdentityApplicationManagementException\n+     */\n+    @Override\n+    public void deleteApplicationsByTenantId(int tenantId) throws IdentityApplicationManagementException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a9ebd30e2972ba85399e560f38f4455d384c8cc"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzOTY5ODgz", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-433969883", "createdAt": "2020-06-19T10:27:46Z", "commit": {"oid": "5a9ebd30e2972ba85399e560f38f4455d384c8cc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMDoyNzo0NlrOGmQBOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMDoyNzo0NlrOGmQBOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjc2MTUyOQ==", "bodyText": "Use org.wso2.carbon.identity.oauth2.listener.TenantCreationEventListener", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r442761529", "createdAt": "2020-06-19T10:27:46Z", "author": {"login": "IsuraD"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/listener/ApplicationTenantMgtListener.java", "diffHunk": "@@ -0,0 +1,72 @@\n+package org.wso2.carbon.identity.application.mgt.listener;\n+\n+import org.wso2.carbon.identity.application.common.IdentityApplicationManagementException;\n+import org.wso2.carbon.identity.application.mgt.ApplicationManagementService;\n+import org.wso2.carbon.stratos.common.beans.TenantInfoBean;\n+import org.wso2.carbon.stratos.common.exception.StratosException;\n+import org.wso2.carbon.stratos.common.listeners.TenantMgtListener;\n+\n+/**\n+ * Application Tenant Management Listener\n+ */\n+public class ApplicationTenantMgtListener implements TenantMgtListener {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a9ebd30e2972ba85399e560f38f4455d384c8cc"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzOTcwMTY2", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-433970166", "createdAt": "2020-06-19T10:28:16Z", "commit": {"oid": "5a9ebd30e2972ba85399e560f38f4455d384c8cc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMDoyODoxNlrOGmQCGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQxMDoyODoxNlrOGmQCGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjc2MTc1Mg==", "bodyText": "better use try with resource", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r442761752", "createdAt": "2020-06-19T10:28:16Z", "author": {"login": "IsuraD"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/dao/impl/ApplicationDAOImpl.java", "diffHunk": "@@ -3538,6 +3545,45 @@ public void deleteApplication(int applicationID, Connection connection)\n \n     }\n \n+    /**\n+     * Delete all applications of a given tenant id.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws IdentityApplicationManagementException\n+     */\n+    @Override\n+    public void deleteApplicationsByTenantId(int tenantId) throws IdentityApplicationManagementException {\n+\n+        if (log.isDebugEnabled()) {\n+            log.debug(\"Deleting all applications of the tenant: \" + tenantId);\n+        }\n+\n+        String auditData = \"\\\"\" + \"Tenant Id\" + \"\\\" : \\\"\" + tenantId + \"\\\"\";\n+\n+        Connection connection = IdentityDatabaseUtil.getDBConnection(false);\n+        PreparedStatement deleteClientPrepStmt = null;\n+\n+        try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a9ebd30e2972ba85399e560f38f4455d384c8cc"}, "originalPosition": 55}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e1063a11ba6dd975a748c48925ddd54ffdf71f5e", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/e1063a11ba6dd975a748c48925ddd54ffdf71f5e", "committedDate": "2020-06-20T16:55:09Z", "message": "Fix minor issues"}, "afterCommit": {"oid": "29bee8e9207af422f4ab3e61aaf38f0566359877", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/29bee8e9207af422f4ab3e61aaf38f0566359877", "committedDate": "2020-06-20T20:11:44Z", "message": "Remove ApplicationTenantMgtListener and fix minor issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/63d253dd3f414c122fad68907a164d830bf19406", "committedDate": "2020-06-23T07:11:31Z", "message": "Remove ApplicationTenantMgtListener and fix minor issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "29bee8e9207af422f4ab3e61aaf38f0566359877", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/29bee8e9207af422f4ab3e61aaf38f0566359877", "committedDate": "2020-06-20T20:11:44Z", "message": "Remove ApplicationTenantMgtListener and fix minor issues"}, "afterCommit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406", "author": {"user": {"login": "sumedhe", "name": "Sumedhe Dissanayake"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/63d253dd3f414c122fad68907a164d830bf19406", "committedDate": "2020-06-23T07:11:31Z", "message": "Remove ApplicationTenantMgtListener and fix minor issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2OTgzNTc0", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-446983574", "createdAt": "2020-07-13T05:06:56Z", "commit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNTA0Nzk5", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-561504799", "createdAt": "2021-01-05T04:19:33Z", "commit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDoxOTozM1rOIOJm6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDoxOTozM1rOIOJm6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcwODM5Mw==", "bodyText": "Complete the Javadoc comment by adding the specific Exception type. The param descriptions should start with a capital letter and end with a full stop.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r551708393", "createdAt": "2021-01-05T04:19:33Z", "author": {"login": "sachiniWettasinghe"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/ApplicationManagementService.java", "diffHunk": "@@ -131,6 +131,14 @@ public abstract void updateApplication(ServiceProvider serviceProvider, String t\n     public abstract void deleteApplication(String applicationName, String tenantDomain, String username)\n             throws IdentityApplicationManagementException;\n \n+    /**\n+     * Delete Applications by tenant id.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws IdentityApplicationManagementException", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNTA1MDkx", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-561505091", "createdAt": "2021-01-05T04:20:54Z", "commit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDoyMDo1NFrOIOJnvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDoyMDo1NFrOIOJnvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcwODYwNg==", "bodyText": "Comment should end with a full stop.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r551708606", "createdAt": "2021-01-05T04:20:54Z", "author": {"login": "sachiniWettasinghe"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/ApplicationManagementServiceImpl.java", "diffHunk": "@@ -714,6 +718,38 @@ public void deleteApplication(String applicationName, String tenantDomain, Strin\n         }\n     }\n \n+    /**\n+     * Delete Applications by tenant id.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws IdentityApplicationManagementException\n+     */\n+    @Override\n+    public void deleteApplications(int tenantId) throws IdentityApplicationManagementException {\n+\n+        String tenantDomain = IdentityTenantUtil.getTenantDomain(tenantId);\n+        ApplicationBasicInfo[] applicationBasicInfos = getAllApplicationBasicInfo(\n+                tenantDomain, CarbonContext.getThreadLocalCarbonContext().getUsername());\n+\n+        ApplicationDAO appDAO = ApplicationMgtSystemConfig.getInstance().getApplicationDAO();\n+        appDAO.deleteApplications(tenantId);\n+\n+        // Clear cache entries of each deleted SP", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNTEyMjY1", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-561512265", "createdAt": "2021-01-05T04:49:45Z", "commit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDo0OTo0NVrOIOKBIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDo0OTo0NVrOIOKBIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNTEwNg==", "bodyText": "end the comment with a full stop", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r551715106", "createdAt": "2021-01-05T04:49:45Z", "author": {"login": "sachiniWettasinghe"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/dao/impl/ApplicationDAOImpl.java", "diffHunk": "@@ -3538,6 +3545,41 @@ public void deleteApplication(int applicationID, Connection connection)\n \n     }\n \n+    /**\n+     * Delete all applications of a given tenant id.\n+     *\n+     * @param tenantId Id of the tenant\n+     * @throws IdentityApplicationManagementException\n+     */\n+    @Override\n+    public void deleteApplications(int tenantId) throws IdentityApplicationManagementException {\n+\n+        if (log.isDebugEnabled()) {\n+            log.debug(\"Deleting all applications of the tenant: \" + tenantId);\n+        }\n+\n+        String auditData = \"\\\"\" + \"Tenant Id\" + \"\\\" : \\\"\" + tenantId + \"\\\"\";\n+\n+        try (Connection connection = IdentityDatabaseUtil.getDBConnection(true)) {\n+\n+            // Delete the application certificates of the tenant", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNTEyNjU2", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-561512656", "createdAt": "2021-01-05T04:51:11Z", "commit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDo1MToxMVrOIOKCTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDo1MToxMVrOIOKCTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNTQwNw==", "bodyText": "Format the Javadoc descriptions. Also, the descriptions should end with a full stop.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r551715407", "createdAt": "2021-01-05T04:51:11Z", "author": {"login": "sachiniWettasinghe"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/dao/impl/ApplicationDAOImpl.java", "diffHunk": "@@ -5060,4 +5125,24 @@ private int createServiceProvider(String tenantDomain, ServiceProvider servicePr\n         }\n         return applicationId;\n     }\n+\n+    /**\n+     * Add audit log entry.\n+     *\n+     * @param action Action\n+     * @param data Audit data\n+     * @param result Result", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "originalPosition": 115}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNTEzMDA3", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#pullrequestreview-561513007", "createdAt": "2021-01-05T04:52:33Z", "commit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDo1MjozM1rOIOKDeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwNDo1MjozM1rOIOKDeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTcxNTcwNA==", "bodyText": "Remove redundant line", "url": "https://github.com/wso2/carbon-identity-framework/pull/2936#discussion_r551715704", "createdAt": "2021-01-05T04:52:33Z", "author": {"login": "sachiniWettasinghe"}, "path": "components/application-mgt/org.wso2.carbon.identity.application.mgt/src/main/java/org/wso2/carbon/identity/application/mgt/dao/impl/ApplicationDAOImpl.java", "diffHunk": "@@ -5060,4 +5125,24 @@ private int createServiceProvider(String tenantDomain, ServiceProvider servicePr\n         }\n         return applicationId;\n     }\n+\n+    /**\n+     * Add audit log entry.\n+     *\n+     * @param action Action\n+     * @param data Audit data\n+     * @param result Result\n+     */\n+    private void audit(String action, String data, String result) {\n+\n+        String loggedInUser = PrivilegedCarbonContext.getThreadLocalCarbonContext().getUsername();\n+        if (StringUtils.isBlank(loggedInUser)) {\n+            loggedInUser = CarbonConstants.REGISTRY_SYSTEM_USERNAME;\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63d253dd3f414c122fad68907a164d830bf19406"}, "originalPosition": 123}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2262, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}