{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxMDUyNDAx", "number": 2832, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMzo0NzoxNlrODqOi8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMzo0OTo1NFrODqOkDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NjA1MTA0OnYy", "diffSide": "RIGHT", "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/DefaultURLResolverService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMzo0NzoxNlrOF52KTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMzo0NzoxNlrOF52KTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMDUyNw==", "bodyText": "Better if the conditions are switched so it's more meaningful.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2832#discussion_r396200527", "createdAt": "2020-03-23T03:47:16Z", "author": {"login": "malithie"}, "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/DefaultURLResolverService.java", "diffHunk": "@@ -140,7 +141,23 @@ private void appendTenantAsPathParam(StringBuilder serverUrl) {\n         if (StringUtils.isBlank(tenantDomain)) {\n             tenantDomain = PrivilegedCarbonContext.getThreadLocalCarbonContext().getTenantDomain();\n         }\n-        if (tenantDomain != null) {\n+        if (StringUtils.isNotBlank(tenantDomain)) {\n+            if (serverUrl.toString().endsWith(\"/\")) {\n+                serverUrl.append(\"t/\").append(tenantDomain);\n+            } else {\n+                serverUrl.append(\"/t/\").append(tenantDomain);\n+            }\n+        }\n+    }\n+\n+    private void appendTenantPathParamInLegacyMode(StringBuilder serverUrl) {\n+\n+        String tenantDomain = IdentityTenantUtil.getTenantDomainFromContext();\n+        if (StringUtils.isBlank(tenantDomain)) {\n+            tenantDomain = PrivilegedCarbonContext.getThreadLocalCarbonContext().getTenantDomain();\n+        }\n+        if (!MultitenantConstants.SUPER_TENANT_DOMAIN_NAME.equalsIgnoreCase(tenantDomain) &&\n+                StringUtils.isNotBlank(tenantDomain)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d0dea2b88bdd1fe5b98567b5a45ef1224129dcb"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NjA1Mzg4OnYy", "diffSide": "RIGHT", "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/DefaultURLResolverService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMzo0OTo1NFrOF52MFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwMzo0OTo1NFrOF52MFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMDk4Mw==", "bodyText": "Maybe we can rename this to indicate legacy mode operation as well so that it is consistent", "url": "https://github.com/wso2/carbon-identity-framework/pull/2832#discussion_r396200983", "createdAt": "2020-03-23T03:49:54Z", "author": {"login": "malithie"}, "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/DefaultURLResolverService.java", "diffHunk": "@@ -152,7 +169,7 @@ private void appendTenantAsPathParam(StringBuilder serverUrl) {\n     private void appendTenantAsQueryParam(StringBuilder serverUrl) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d0dea2b88bdd1fe5b98567b5a45ef1224129dcb"}, "originalPosition": 63}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2248, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}