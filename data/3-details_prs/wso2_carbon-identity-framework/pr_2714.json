{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4NTc3MzUw", "number": 2714, "title": "Continue IdentityUserIdResolverListener operation when the user list is empty", "bodyText": "", "createdAt": "2020-01-29T14:10:21Z", "url": "https://github.com/wso2/carbon-identity-framework/pull/2714", "merged": true, "mergeCommit": {"oid": "87e0c75e68d9547f7a5cec11db9d8abad9ceaf90"}, "closed": true, "closedAt": "2020-01-29T17:35:05Z", "author": {"login": "madurangasiriwardena"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_HRvKAFqTM1MDE3MjgwMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_IAK1gBqjI5OTAwNTEwNTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwMTcyODAz", "url": "https://github.com/wso2/carbon-identity-framework/pull/2714#pullrequestreview-350172803", "createdAt": "2020-01-29T15:00:52Z", "commit": {"oid": "ef6be8f4eebb5cd94408152c93d247c89af29513"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNTowMDo1MlrOFjLi5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNTowMDo1MlrOFjLi5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjQzMzYzOQ==", "bodyText": "Shall we wrap this code logic to a private method similar to getUserIds() and re-use, as the logic is re-used several places? the method will return the userID list for a non-empty user list and a non-empty userID list. Otherwise, it will return an empty string array.\nAnd also, IMO empty user list equals empty userIDs. If we plan to trigger all the listeners for an empty user list, the same can be applied with an empty userID list returned for a non-empty user list. WDYT?", "url": "https://github.com/wso2/carbon-identity-framework/pull/2714#discussion_r372433639", "createdAt": "2020-01-29T15:00:52Z", "author": {"login": "tharindu-bandara"}, "path": "components/identity-mgt/org.wso2.carbon.identity.mgt/src/main/java/org/wso2/carbon/identity/mgt/listener/IdentityUserIdResolverListener.java", "diffHunk": "@@ -531,7 +531,16 @@ public boolean doPreAddRole(String roleName, String[] userList, Permission[] per\n             return true;\n         }\n \n-        String[] userIDs = getUserIdsFromUserNames(userList, (AbstractUserStoreManager) userStoreManager);\n+        String[] userIDs;\n+        if (ArrayUtils.isNotEmpty(userList)) {\n+            userIDs = getUserIdsFromUserNames(userList, (AbstractUserStoreManager) userStoreManager);\n+\n+            if (ArrayUtils.isEmpty(userIDs)) {\n+                return true;\n+            }\n+        } else {\n+            userIDs = new String[0];\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef6be8f4eebb5cd94408152c93d247c89af29513"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwMTkyNTI1", "url": "https://github.com/wso2/carbon-identity-framework/pull/2714#pullrequestreview-350192525", "createdAt": "2020-01-29T15:24:48Z", "commit": {"oid": "ef6be8f4eebb5cd94408152c93d247c89af29513"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNToyNDo0OVrOFjMgVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxNToyNDo0OVrOFjMgVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjQ0OTM2Nw==", "bodyText": "We need to remove this check as this will override the fix.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2714#discussion_r372449367", "createdAt": "2020-01-29T15:24:49Z", "author": {"login": "tharindu-bandara"}, "path": "components/identity-mgt/org.wso2.carbon.identity.mgt/src/main/java/org/wso2/carbon/identity/mgt/listener/IdentityUserIdResolverListener.java", "diffHunk": "@@ -531,7 +531,16 @@ public boolean doPreAddRole(String roleName, String[] userList, Permission[] per\n             return true;\n         }\n \n-        String[] userIDs = getUserIdsFromUserNames(userList, (AbstractUserStoreManager) userStoreManager);\n+        String[] userIDs;\n+        if (ArrayUtils.isNotEmpty(userList)) {\n+            userIDs = getUserIdsFromUserNames(userList, (AbstractUserStoreManager) userStoreManager);\n+\n+            if (ArrayUtils.isEmpty(userIDs)) {\n+                return true;\n+            }\n+        } else {\n+            userIDs = new String[0];\n+        }\n \n         if (ArrayUtils.isEmpty(userIDs)) {\n             return true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef6be8f4eebb5cd94408152c93d247c89af29513"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2ae3f4a627cc522cf57c5aa3a6fcc063c007377", "author": {"user": {"login": "madurangasiriwardena", "name": "Maduranga Siriwardena"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/f2ae3f4a627cc522cf57c5aa3a6fcc063c007377", "committedDate": "2020-01-29T15:29:53Z", "message": "Continue IdentityUserIdResolverListener operation when the user list is empty"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef6be8f4eebb5cd94408152c93d247c89af29513", "author": {"user": {"login": "madurangasiriwardena", "name": "Maduranga Siriwardena"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/ef6be8f4eebb5cd94408152c93d247c89af29513", "committedDate": "2020-01-29T14:09:02Z", "message": "Continue IdentityUserIdResolverListener operation when the user list is empty"}, "afterCommit": {"oid": "f2ae3f4a627cc522cf57c5aa3a6fcc063c007377", "author": {"user": {"login": "madurangasiriwardena", "name": "Maduranga Siriwardena"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/f2ae3f4a627cc522cf57c5aa3a6fcc063c007377", "committedDate": "2020-01-29T15:29:53Z", "message": "Continue IdentityUserIdResolverListener operation when the user list is empty"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwMjEwMjcx", "url": "https://github.com/wso2/carbon-identity-framework/pull/2714#pullrequestreview-350210271", "createdAt": "2020-01-29T15:45:52Z", "commit": {"oid": "f2ae3f4a627cc522cf57c5aa3a6fcc063c007377"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a621b82c514d81e4cdb8964af90b948a3c2fac6", "author": {"user": {"login": "madurangasiriwardena", "name": "Maduranga Siriwardena"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/1a621b82c514d81e4cdb8964af90b948a3c2fac6", "committedDate": "2020-01-29T15:51:18Z", "message": "Refactor the logic"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f82d85eb59cd22a79d87060fc8cd79b4bd77b3f6", "author": {"user": {"login": "madurangasiriwardena", "name": "Maduranga Siriwardena"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/f82d85eb59cd22a79d87060fc8cd79b4bd77b3f6", "committedDate": "2020-01-29T15:49:15Z", "message": "Refactor the logic"}, "afterCommit": {"oid": "1a621b82c514d81e4cdb8964af90b948a3c2fac6", "author": {"user": {"login": "madurangasiriwardena", "name": "Maduranga Siriwardena"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/1a621b82c514d81e4cdb8964af90b948a3c2fac6", "committedDate": "2020-01-29T15:51:18Z", "message": "Refactor the logic"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2440, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}