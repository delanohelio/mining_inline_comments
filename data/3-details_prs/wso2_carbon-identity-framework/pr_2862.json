{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNDYyNTMw", "number": 2862, "title": "Fix saml endpoints for tenant-qualified mode", "bodyText": "Proposed changes in this pull request\nfix saml endpoints for tenant-qualified mode\nrevert samlAuthnRequestsSigningEnabled url\nadd default endpoint constants\nImprovement for the #2828 that fixed  #wso2/product-is#7900", "createdAt": "2020-04-09T14:37:33Z", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862", "merged": true, "mergeCommit": {"oid": "13d8d5460ef61a82ae06c7d995e4bf9c0591a0b6"}, "closed": true, "closedAt": "2020-04-10T10:04:19Z", "author": {"login": "chamathns"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcV9aNsAH2gAyNDAxNDYyNTMwOjVlODgyZjlmOThiNGY5MzI2ZmQ5M2FkMWI3MmU2Njg5YWZlMTZjNzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWOL5ggFqTM5MTM2ODYwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72", "author": {"user": {"login": "chamathns", "name": "Chamath Samarawickrama"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/5e882f9f98b4f9326fd93ad1b72e6689afe16c72", "committedDate": "2020-04-09T14:31:20Z", "message": "fix saml endpoints for tenant-qualified mode\nrevert samlAuthnRequestsSigningEnabled url\nadd default endpoint constants"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMjI4MzYz", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391228363", "createdAt": "2020-04-10T01:47:18Z", "commit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0NzoxOFrOGDutxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0NzoxOFrOGDutxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NDI5NQ==", "bodyText": "Should this be throwing a runtime exception ? Can use IdentityProviderManagementException right", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406564295", "createdAt": "2020-04-10T01:47:18Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -140,10 +143,26 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n         String samlAuthnRequestsSigningEnabled;\n \n         openIdUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.OPENID_SERVER_URL);\n-        samlECPUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig.SAML_ECP_URL),\n-                true, true);\n-        samlArtifactUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig\n-                .SSO_ARTIFACT_URL), true, true);\n+\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlECPUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SAML_ECP_URL).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdPManagementConstants.SAML_ECP_URL, e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMjI4Nzg0", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391228784", "createdAt": "2020-04-10T01:49:25Z", "commit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0OToyNVrOGDuvrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0OToyNVrOGDuvrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NDc4Mw==", "bodyText": "I don't this we would need to handle this exception one by one.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406564783", "createdAt": "2020-04-10T01:49:25Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -140,10 +143,26 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n         String samlAuthnRequestsSigningEnabled;\n \n         openIdUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.OPENID_SERVER_URL);\n-        samlECPUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig.SAML_ECP_URL),\n-                true, true);\n-        samlArtifactUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig\n-                .SSO_ARTIFACT_URL), true, true);\n+\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlECPUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SAML_ECP_URL).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdPManagementConstants.SAML_ECP_URL, e);\n+            }\n+            try {\n+                samlArtifactUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SSO_ARTIFACT_URL).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMjI5MjYx", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391229261", "createdAt": "2020-04-10T01:51:36Z", "commit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo1MTozNlrOGDuxdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo1MTozNlrOGDuxdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NTIzNw==", "bodyText": "were these not read from the file before", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406565237", "createdAt": "2020-04-10T01:51:36Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +188,24 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+                samlLogoutUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                    + IdPManagementUtil.getTenantParameter();\n \n-        samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+            samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                    + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMjMwMzg4", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391230388", "createdAt": "2020-04-10T01:56:04Z", "commit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo1NjowNFrOGDu19w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo1NjowNFrOGDu19w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NjM5MQ==", "bodyText": "A wrong config ? Is there a use of this really", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406566391", "createdAt": "2020-04-10T01:56:04Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -181,8 +215,9 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             samlECPUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n         }\n \n-        samlAuthnRequestsSigningEnabled = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.\n-                SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED, true, true, true, false);\n+        samlAuthnRequestsSigningEnabled = IdentityUtil\n+                .getServerURL(IdentityConstants.ServerConfig.SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED, true, true) +\n+                IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 76}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMjMyMjc3", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391232277", "createdAt": "2020-04-10T02:04:16Z", "commit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNDoxNlrOGDu9ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNDoxNlrOGDu9ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODM4Nw==", "bodyText": "Same is done above right ?", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406568387", "createdAt": "2020-04-10T02:04:16Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2566,34 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n-\n-        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlSSOUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 98}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMjMyMzUx", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391232351", "createdAt": "2020-04-10T02:04:36Z", "commit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNDozNlrOGDu-AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNDozNlrOGDu-AQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODQ0OQ==", "bodyText": "Isn't same done above", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406568449", "createdAt": "2020-04-10T02:04:36Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2566,34 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n-\n-        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlSSOUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }\n         updateFederationAuthenticationConfigProperty(residentIDP,\n                 IdentityApplicationConstants.Authenticator\n                         .SAML2SSO.NAME, IdentityApplicationConstants.Authenticator.SAML2SSO.SSO_URL, samlSSOUrl);\n \n-        String samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlLogoutUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlLogoutUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 116}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMjMyNjI1", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391232625", "createdAt": "2020-04-10T02:05:50Z", "commit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNTo1MFrOGDu_Dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNTo1MFrOGDu_Dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODcxOA==", "bodyText": "When giving a path should we really give '/', doesn't the builder handles it.\nEven if we give it should handle IMO", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406568718", "createdAt": "2020-04-10T02:05:50Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/util/IdPManagementConstants.java", "diffHunk": "@@ -74,6 +74,11 @@\n     public static final String PROVISIONING =\n             \"INBOUND_PROV_ENABLED, INBOUND_PROV_USER_STORE_ID, DEFAULT_PRO_CONNECTOR_NAME\";\n \n+    //Default SAML endpoints.\n+    public static final String SSO_ARTIFACT_URL = \"/samlartresolve\";\n+    public static final String SAML_ECP_URL = \"/samlecp\";\n+    public static final String SAMLSSO = \"/samlsso\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cd821cae58dd480769d3b8e94cf1913fa6b6ed2", "author": {"user": {"login": "chamathns", "name": "Chamath Samarawickrama"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/5cd821cae58dd480769d3b8e94cf1913fa6b6ed2", "committedDate": "2020-04-10T05:23:08Z", "message": "resolve issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMjc4Mjc5", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391278279", "createdAt": "2020-04-10T05:53:50Z", "commit": {"oid": "5cd821cae58dd480769d3b8e94cf1913fa6b6ed2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNTo1Mzo1MFrOGDxv8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNTo1Mzo1MFrOGDxv8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYxNDAwMw==", "bodyText": "haven't we read sso url from file", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406614003", "createdAt": "2020-04-10T05:53:50Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +186,21 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+                samlLogoutUrl = samlSSOUrl;\n+            } catch (URLBuilderException e) {\n+                throw IdentityProviderManagementException.error(IdentityProviderManagementServerException.class,\n+                        \"Error while building URL: \" + IdPManagementConstants.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5cd821cae58dd480769d3b8e94cf1913fa6b6ed2"}, "originalPosition": 58}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30", "author": {"user": {"login": "chamathns", "name": "Chamath Samarawickrama"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/ec77da36cd77ed3b01a39ac5177cd37fac6dab30", "committedDate": "2020-04-10T06:30:04Z", "message": "introduce method to resolve absolute Url"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzA3NDA1", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391307405", "createdAt": "2020-04-10T07:31:22Z", "commit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNzozMToyMlrOGDzXog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNzozMToyMlrOGDzXog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MDU0Ng==", "bodyText": "why we send a tenant parameter here. What's the URL that gets constructed", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406640546", "createdAt": "2020-04-10T07:31:22Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +170,11 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzIwNDMz", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391320433", "createdAt": "2020-04-10T08:04:03Z", "commit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODowNDowM1rOGD0C_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODowNDowM1rOGD0C_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY1MTY0Nw==", "bodyText": "So which invokes this method and why that tenant param does not need to be applied here", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406651647", "createdAt": "2020-04-10T08:04:03Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2531,14 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n+        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        samlSSOUrl = resolveAbsoluteURL(IdPManagementConstants.SAMLSSO, samlSSOUrl);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 56}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzI0NDQz", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391324443", "createdAt": "2020-04-10T08:14:07Z", "commit": {"oid": "a994510b8bab448fcaa61d89dac59465527df77f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODoxNDowN1rOGD0QoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODoxNDowN1rOGD0QoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY1NTEzNg==", "bodyText": "Should we add the tenant domain as a query param when the url is read from file?\n@malithie @mefarazath @inthirakumaaran", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406655136", "createdAt": "2020-04-10T08:14:07Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -137,13 +139,16 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n         String scimGroupsEndpoint;\n         String scim2UsersEndpoint;\n         String scim2GroupsEndpoint;\n-        String samlAuthnRequestsSigningEnabled;\n \n         openIdUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.OPENID_SERVER_URL);\n-        samlECPUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig.SAML_ECP_URL),\n-                true, true);\n-        samlArtifactUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig\n-                .SSO_ARTIFACT_URL), true, true);\n+        samlSSOUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.SSO_IDP_URL) +\n+                IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a994510b8bab448fcaa61d89dac59465527df77f"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a994510b8bab448fcaa61d89dac59465527df77f", "author": {"user": {"login": "chamathns", "name": "Chamath Samarawickrama"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/a994510b8bab448fcaa61d89dac59465527df77f", "committedDate": "2020-04-10T08:10:15Z", "message": "change samlSSOUrl to read the url from file in legacy mode"}, "afterCommit": {"oid": "77644953fb3f635d669e8e0edd372c7679751613", "author": {"user": {"login": "chamathns", "name": "Chamath Samarawickrama"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/77644953fb3f635d669e8e0edd372c7679751613", "committedDate": "2020-04-10T08:59:23Z", "message": "change samlSSOUrl to read the url from file in legacy mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d345710127abc9ad0de12c3ed4a84bc437a628c4", "author": {"user": {"login": "chamathns", "name": "Chamath Samarawickrama"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/d345710127abc9ad0de12c3ed4a84bc437a628c4", "committedDate": "2020-04-10T09:41:57Z", "message": "change samlSSOUrl to read the url from file in legacy mode"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "77644953fb3f635d669e8e0edd372c7679751613", "author": {"user": {"login": "chamathns", "name": "Chamath Samarawickrama"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/77644953fb3f635d669e8e0edd372c7679751613", "committedDate": "2020-04-10T08:59:23Z", "message": "change samlSSOUrl to read the url from file in legacy mode"}, "afterCommit": {"oid": "d345710127abc9ad0de12c3ed4a84bc437a628c4", "author": {"user": {"login": "chamathns", "name": "Chamath Samarawickrama"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/d345710127abc9ad0de12c3ed4a84bc437a628c4", "committedDate": "2020-04-10T09:41:57Z", "message": "change samlSSOUrl to read the url from file in legacy mode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzY4NjAy", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#pullrequestreview-391368602", "createdAt": "2020-04-10T10:04:05Z", "commit": {"oid": "d345710127abc9ad0de12c3ed4a84bc437a628c4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2339, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}