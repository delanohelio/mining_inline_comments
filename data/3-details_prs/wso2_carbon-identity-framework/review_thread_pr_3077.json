{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwNzI4NTk4", "number": 3077, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwNDoxNjowMlrOEiYArw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwNDoxNzoxNlrOEiYBbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDgwNDMxOnYy", "diffSide": "RIGHT", "path": "components/entitlement/org.wso2.carbon.identity.entitlement/src/main/java/org/wso2/carbon/identity/entitlement/internal/EntitlementServiceComponent.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwNDoxNjowMlrOHQNr5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNTowMzozNFrOHRD-ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njc2MzQ5NA==", "bodyText": "Complete the javadoc with descriptions", "url": "https://github.com/wso2/carbon-identity-framework/pull/3077#discussion_r486763494", "createdAt": "2020-09-11T04:16:02Z", "author": {"login": "sachiniWettasinghe"}, "path": "components/entitlement/org.wso2.carbon.identity.entitlement/src/main/java/org/wso2/carbon/identity/entitlement/internal/EntitlementServiceComponent.java", "diffHunk": "@@ -307,6 +317,36 @@ protected void activate(ComponentContext ctxt) {\n         }\n     }\n \n+    /**\n+     * Adds policy files with unique policyIDs to the registry.\n+     *\n+     * @param policyIdList\n+     * @param fileList\n+     * @return\n+     * @throws IOException\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "164486c4752f82477543a5caa13a9c527688d03e"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1MzAyNw==", "bodyText": "Fixed in #3110", "url": "https://github.com/wso2/carbon-identity-framework/pull/3077#discussion_r487653027", "createdAt": "2020-09-14T05:03:34Z", "author": {"login": "ashendes"}, "path": "components/entitlement/org.wso2.carbon.identity.entitlement/src/main/java/org/wso2/carbon/identity/entitlement/internal/EntitlementServiceComponent.java", "diffHunk": "@@ -307,6 +317,36 @@ protected void activate(ComponentContext ctxt) {\n         }\n     }\n \n+    /**\n+     * Adds policy files with unique policyIDs to the registry.\n+     *\n+     * @param policyIdList\n+     * @param fileList\n+     * @return\n+     * @throws IOException\n+     */", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njc2MzQ5NA=="}, "originalCommit": {"oid": "164486c4752f82477543a5caa13a9c527688d03e"}, "originalPosition": 90}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NDgwNjIxOnYy", "diffSide": "RIGHT", "path": "components/entitlement/org.wso2.carbon.identity.entitlement/src/main/java/org/wso2/carbon/identity/entitlement/internal/EntitlementServiceComponent.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQwNDoxNzoxNlrOHQNs7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQwNTowMzozOVrOHRD-sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njc2Mzc1Ng==", "bodyText": "Format the comment by starting with a capital letter and ending with a '.'. And add a meaningful sentence here.", "url": "https://github.com/wso2/carbon-identity-framework/pull/3077#discussion_r486763756", "createdAt": "2020-09-11T04:17:16Z", "author": {"login": "sachiniWettasinghe"}, "path": "components/entitlement/org.wso2.carbon.identity.entitlement/src/main/java/org/wso2/carbon/identity/entitlement/internal/EntitlementServiceComponent.java", "diffHunk": "@@ -307,6 +317,36 @@ protected void activate(ComponentContext ctxt) {\n         }\n     }\n \n+    /**\n+     * Adds policy files with unique policyIDs to the registry.\n+     *\n+     * @param policyIdList\n+     * @param fileList\n+     * @return\n+     * @throws IOException\n+     */\n+    private boolean addPolicyFiles(List<String> policyIdList, File[] fileList) throws IOException {\n+\n+        boolean customPolicies = false;\n+        for (File policyFile : fileList) {\n+            if (policyFile.isFile()) {\n+                PolicyDTO policyDTO = new PolicyDTO();\n+                policyDTO.setPolicy(FileUtils.readFileToString(policyFile));\n+                if (!policyIdList.contains(policyDTO.getPolicyId())) {\n+                    try {\n+                        EntitlementUtil.addFilesystemPolicy(policyDTO, registryService\n+                                .getGovernanceSystemRegistry(), true);\n+                    } catch (Exception e) {\n+                        // log and ignore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "164486c4752f82477543a5caa13a9c527688d03e"}, "originalPosition": 103}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY1MzA0Mw==", "bodyText": "Fixed in #3110", "url": "https://github.com/wso2/carbon-identity-framework/pull/3077#discussion_r487653043", "createdAt": "2020-09-14T05:03:39Z", "author": {"login": "ashendes"}, "path": "components/entitlement/org.wso2.carbon.identity.entitlement/src/main/java/org/wso2/carbon/identity/entitlement/internal/EntitlementServiceComponent.java", "diffHunk": "@@ -307,6 +317,36 @@ protected void activate(ComponentContext ctxt) {\n         }\n     }\n \n+    /**\n+     * Adds policy files with unique policyIDs to the registry.\n+     *\n+     * @param policyIdList\n+     * @param fileList\n+     * @return\n+     * @throws IOException\n+     */\n+    private boolean addPolicyFiles(List<String> policyIdList, File[] fileList) throws IOException {\n+\n+        boolean customPolicies = false;\n+        for (File policyFile : fileList) {\n+            if (policyFile.isFile()) {\n+                PolicyDTO policyDTO = new PolicyDTO();\n+                policyDTO.setPolicy(FileUtils.readFileToString(policyFile));\n+                if (!policyIdList.contains(policyDTO.getPolicyId())) {\n+                    try {\n+                        EntitlementUtil.addFilesystemPolicy(policyDTO, registryService\n+                                .getGovernanceSystemRegistry(), true);\n+                    } catch (Exception e) {\n+                        // log and ignore", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Njc2Mzc1Ng=="}, "originalCommit": {"oid": "164486c4752f82477543a5caa13a9c527688d03e"}, "originalPosition": 103}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2525, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}