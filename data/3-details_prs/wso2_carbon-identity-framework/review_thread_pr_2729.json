{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyMjMwMTg5", "number": 2729, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwNDo0NTowMFrODd6Umg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwNDo0OToxNVrODd6Wgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjkwODQyOnYy", "diffSide": "RIGHT", "path": "components/user-mgt/org.wso2.carbon.user.mgt/src/main/java/org/wso2/carbon/user/mgt/listeners/UserClaimsAuditLogger.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwNDo0NTowMFrOFmyMRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwNDo0NTowMFrOFmyMRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIxMjU0OA==", "bodyText": "Shall we change the method name as \"logUpdatedClaims\"?", "url": "https://github.com/wso2/carbon-identity-framework/pull/2729#discussion_r376212548", "createdAt": "2020-02-07T04:45:00Z", "author": {"login": "nilasini"}, "path": "components/user-mgt/org.wso2.carbon.user.mgt/src/main/java/org/wso2/carbon/user/mgt/listeners/UserClaimsAuditLogger.java", "diffHunk": "@@ -114,11 +123,65 @@ public boolean doPreSetUserClaimValues(String userName, Map<String, String> clai\n     public boolean doPostSetUserClaimValues(String userName, Map<String, String> claims, String profileName, UserStoreManager userStoreManager) throws UserStoreException {\n \n         if (isEnable()) {\n-            logClaims(userName, \"doPostSetUserClaimValues\", userStoreManager);\n+            if (isLogUpdatedClaimsOnlyPropertyEnabled()) {\n+                return true;\n+            } else {\n+                logClaims(userName, \"doPostSetUserClaimValues\", userStoreManager);\n+            }\n         }\n         return true;\n     }\n \n+    private boolean isLogUpdatedClaimsOnlyPropertyEnabled() {\n+\n+        Object propertyValue = IdentityUtil.readEventListenerProperty(EVENT_LISTENER_TYPE, this.getClass().getName())\n+                .getProperties().get(LOG_UPDATED_CLAIMS_ONLY_PROPERTY);\n+        if (propertyValue != null) {\n+            return Boolean.parseBoolean(propertyValue.toString());\n+        }\n+\n+        return false;\n+    }\n+\n+    /**\n+     * This will log only the updated user claims rather than logging every claim that is added under the loggable\n+     * claims configuration.\n+     *\n+     * @param userName         Username.\n+     * @param claims           User claims.\n+     * @param action           Action to be logged in the audit log.\n+     * @param userStoreManager Userstore manager.\n+     */\n+    private void logOnlyUpdatedClaims(String userName, Map<String, String> claims, String action,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "739d2af1184ec9b0581da9694e381ee6d7e98ae5"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMyNjkxMzMwOnYy", "diffSide": "RIGHT", "path": "components/user-mgt/org.wso2.carbon.user.mgt/src/main/java/org/wso2/carbon/user/mgt/listeners/UserClaimsAuditLogger.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwNDo0OToxNVrOFmyO8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwNTozNzoxMlrOFmyv_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIxMzIzMg==", "bodyText": "Shall we add a method comment here", "url": "https://github.com/wso2/carbon-identity-framework/pull/2729#discussion_r376213232", "createdAt": "2020-02-07T04:49:15Z", "author": {"login": "sarubi"}, "path": "components/user-mgt/org.wso2.carbon.user.mgt/src/main/java/org/wso2/carbon/user/mgt/listeners/UserClaimsAuditLogger.java", "diffHunk": "@@ -114,11 +123,65 @@ public boolean doPreSetUserClaimValues(String userName, Map<String, String> clai\n     public boolean doPostSetUserClaimValues(String userName, Map<String, String> claims, String profileName, UserStoreManager userStoreManager) throws UserStoreException {\n \n         if (isEnable()) {\n-            logClaims(userName, \"doPostSetUserClaimValues\", userStoreManager);\n+            if (isLogUpdatedClaimsOnlyPropertyEnabled()) {\n+                return true;\n+            } else {\n+                logClaims(userName, \"doPostSetUserClaimValues\", userStoreManager);\n+            }\n         }\n         return true;\n     }\n \n+    private boolean isLogUpdatedClaimsOnlyPropertyEnabled() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "739d2af1184ec9b0581da9694e381ee6d7e98ae5"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIyMTY5NA==", "bodyText": "Added", "url": "https://github.com/wso2/carbon-identity-framework/pull/2729#discussion_r376221694", "createdAt": "2020-02-07T05:37:12Z", "author": {"login": "sachiniWettasinghe"}, "path": "components/user-mgt/org.wso2.carbon.user.mgt/src/main/java/org/wso2/carbon/user/mgt/listeners/UserClaimsAuditLogger.java", "diffHunk": "@@ -114,11 +123,65 @@ public boolean doPreSetUserClaimValues(String userName, Map<String, String> clai\n     public boolean doPostSetUserClaimValues(String userName, Map<String, String> claims, String profileName, UserStoreManager userStoreManager) throws UserStoreException {\n \n         if (isEnable()) {\n-            logClaims(userName, \"doPostSetUserClaimValues\", userStoreManager);\n+            if (isLogUpdatedClaimsOnlyPropertyEnabled()) {\n+                return true;\n+            } else {\n+                logClaims(userName, \"doPostSetUserClaimValues\", userStoreManager);\n+            }\n         }\n         return true;\n     }\n \n+    private boolean isLogUpdatedClaimsOnlyPropertyEnabled() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIxMzIzMg=="}, "originalCommit": {"oid": "739d2af1184ec9b0581da9694e381ee6d7e98ae5"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2366, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}