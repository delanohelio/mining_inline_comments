{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3NjU3Mjg3", "number": 2773, "title": "Use Federation association manager service", "bodyText": "Fix : wso2/product-is#7658\nApproach\nThe federated user association was done in the authentication-framework by calling the UserProfileAdmin service. But there is a separate service class, FederatedAssociationManager  implemented for executing the user association functionalities.\nThis PR has changed the implementation of JIT provisioning to use the FederatedAssociationManager service.", "createdAt": "2020-02-20T09:57:17Z", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773", "merged": true, "mergeCommit": {"oid": "dcd7a33ee58a743d44f3659a569abbb54dbd8632"}, "closed": true, "closedAt": "2020-02-20T18:20:33Z", "author": {"login": "pamodaaw"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGINIugFqTM2MTc3MjE0NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGJdNugFqTM2MTgyODczMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzcyMTQ0", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#pullrequestreview-361772144", "createdAt": "2020-02-20T10:03:13Z", "commit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMDowMzoxM1rOFsNMjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMDowMzoxM1rOFsNMjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg5Nzg2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            User user = getAssociatedUser(username, userStoreDomain, tenantDomain);\n          \n          \n            \n                            User user = getAssociatedUser(username, tenantDomain, userStoreDomain);\n          \n      \n    \n    \n  \n\nAnd also, if possible, can we interchange method parameters to the order -> tenantDomain, userStoreDomain, username", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#discussion_r381897868", "createdAt": "2020-02-20T10:03:13Z", "author": {"login": "tharindu-bandara"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/handler/provisioning/impl/DefaultProvisioningHandler.java", "diffHunk": "@@ -196,8 +202,10 @@ protected void associateUser(String username, String userStoreDomain, String ten\n             PrivilegedCarbonContext.getThreadLocalCarbonContext().setUsername(usernameWithUserstoreDomain);\n \n             if (!StringUtils.isEmpty(idp) && !StringUtils.isEmpty(subject)) {\n-                UserProfileAdmin userProfileAdmin = UserProfileAdmin.getInstance();\n-                userProfileAdmin.associateID(idp, subject);\n+                FederatedAssociationManager federatedAssociationManager = FrameworkUtils\n+                        .getFederatedAssociationManager();\n+                User user = getAssociatedUser(username, userStoreDomain, tenantDomain);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzc0MTA3", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#pullrequestreview-361774107", "createdAt": "2020-02-20T10:06:04Z", "commit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMDowNjowNFrOFsNSgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMDowNjowNFrOFsNSgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg5OTM5Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    }", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#discussion_r381899393", "createdAt": "2020-02-20T10:06:04Z", "author": {"login": "tharindu-bandara"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/handler/provisioning/impl/DefaultProvisioningHandler.java", "diffHunk": "@@ -249,10 +268,11 @@ private void handleFederatedUserNameEqualsToSuperAdminUserName(UserRealm realm,\n                                                                    Collection<String> deletingRoles)\n             throws UserStoreException, FrameworkException {\n         if (userStoreManager.getRealmConfiguration().isPrimary()\n-            && username.equals(realm.getRealmConfiguration().getAdminUserName())) {\n-            if (log.isDebugEnabled()) {\n+                && username.equals(realm.getRealmConfiguration().getAdminUserName())) {\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed"}, "originalPosition": 100}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzc2NjE0", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#pullrequestreview-361776614", "createdAt": "2020-02-20T10:09:35Z", "commit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMDowOTozNVrOFsNaJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMDowOTozNVrOFsNaJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTkwMTM0OQ==", "bodyText": "New line", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#discussion_r381901349", "createdAt": "2020-02-20T10:09:35Z", "author": {"login": "tharindu-bandara"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/internal/FrameworkServiceComponent.java", "diffHunk": "@@ -736,4 +737,28 @@ private void loadCodeForRequire() {\n                     \"adaptive authentication scripts.\", e);\n         }\n     }\n+    @Reference(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzc3MTgx", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#pullrequestreview-361777181", "createdAt": "2020-02-20T10:10:25Z", "commit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMDoxMDoyNVrOFsNb7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxMDoxMDoyNVrOFsNb7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTkwMTgwNA==", "bodyText": "Shall we change the name indicating the federated association manager?", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#discussion_r381901804", "createdAt": "2020-02-20T10:10:25Z", "author": {"login": "tharindu-bandara"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/internal/FrameworkServiceComponent.java", "diffHunk": "@@ -736,4 +737,28 @@ private void loadCodeForRequire() {\n                     \"adaptive authentication scripts.\", e);\n         }\n     }\n+    @Reference(\n+            name = \"identity.user.profile.mgt.component\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47441fb4844e6870cab3622d1e94615dfe774148", "author": {"user": {"login": "pamodaaw", "name": "Pamoda Wimalasiri"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/47441fb4844e6870cab3622d1e94615dfe774148", "committedDate": "2020-02-20T10:26:58Z", "message": "Use Federation association manager service"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed", "author": {"user": {"login": "pamodaaw", "name": "Pamoda Wimalasiri"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/cc09d1bffd78a8ec9a4f20a6213b79be9744d2ed", "committedDate": "2020-02-20T09:42:35Z", "message": "Use Federation association manager service"}, "afterCommit": {"oid": "47441fb4844e6870cab3622d1e94615dfe774148", "author": {"user": {"login": "pamodaaw", "name": "Pamoda Wimalasiri"}}, "url": "https://github.com/wso2/carbon-identity-framework/commit/47441fb4844e6870cab3622d1e94615dfe774148", "committedDate": "2020-02-20T10:26:58Z", "message": "Use Federation association manager service"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxODI4NzMy", "url": "https://github.com/wso2/carbon-identity-framework/pull/2773#pullrequestreview-361828732", "createdAt": "2020-02-20T11:30:41Z", "commit": {"oid": "47441fb4844e6870cab3622d1e94615dfe774148"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2397, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}