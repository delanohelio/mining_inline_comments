{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3OTM5NDE4", "number": 3017, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDowOTo1MFrOEOhHkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxNDoyOToxMVrOEsEpVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjU4MTMxOnYy", "diffSide": "RIGHT", "path": "features/identity-event/org.wso2.carbon.identity.event.server.feature/resources/identity-event.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDowOTo1MFrOGxtgYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNDowOTo1MFrOGxtgYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc3ODk3OQ==", "bodyText": "You should add these configurations to the j2 file and default.json file as well", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r454778979", "createdAt": "2020-07-15T04:09:50Z", "author": {"login": "nilasini"}, "path": "features/identity-event/org.wso2.carbon.identity.event.server.feature/resources/identity-event.properties", "diffHunk": "@@ -119,3 +119,9 @@ OIDCLogoutEventHandler.subscription.1=SESSION_TERMINATE\n OIDCLogoutEventHandler.enable=true\n module.name.21=tenantRegistrationVerificationHandler\n tenantRegistrationVerificationHandler.subscription.1=PRE_SET_USER_CLAIMS\n+module.name.22=analyticsLoginDataPublisherV110\n+analyticsLoginDataPublisherV110.subscription.1=AUTHENTICATION_STEP_SUCCESS", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5ec3d6e17910c9bd5547cd88823efd8c0de01389"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNjgwMDEwOnYy", "diffSide": "RIGHT", "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwNjowMzoxMVrOGxvfUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwOTo1MTo0NVrOGx20JQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxMTQ3Mg==", "bodyText": "Changing the method signature will effect several places. Did you able to check those places?", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r454811472", "createdAt": "2020-07-15T06:03:11Z", "author": {"login": "ShanChathusanda93"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -153,43 +155,77 @@ protected boolean isStepHasMultiOption(AuthenticationContext context) {\n         return stepHasMultiOption;\n     }\n \n-    protected void publishAuthenticationStepAttempt(HttpServletRequest request, AuthenticationContext context,\n-                                                  User user, boolean success) {\n+    protected void publishAuthenticationStepAttemptSuccess(HttpServletRequest request, AuthenticationContext context,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "454aad61e1e1eba5e0446d63bd49db7b42abf7c7"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxMzAyNA==", "bodyText": "you shouldn't change the method signature of protected/public methods.", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r454813024", "createdAt": "2020-07-15T06:07:58Z", "author": {"login": "nilasini"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -153,43 +155,77 @@ protected boolean isStepHasMultiOption(AuthenticationContext context) {\n         return stepHasMultiOption;\n     }\n \n-    protected void publishAuthenticationStepAttempt(HttpServletRequest request, AuthenticationContext context,\n-                                                  User user, boolean success) {\n+    protected void publishAuthenticationStepAttemptSuccess(HttpServletRequest request, AuthenticationContext context,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxMTQ3Mg=="}, "originalCommit": {"oid": "454aad61e1e1eba5e0446d63bd49db7b42abf7c7"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxMzE3NQ==", "bodyText": "yes, I checked in all the places and the tests. Also discussed in the code review.", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r454813175", "createdAt": "2020-07-15T06:08:19Z", "author": {"login": "Sathiyakugan"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -153,43 +155,77 @@ protected boolean isStepHasMultiOption(AuthenticationContext context) {\n         return stepHasMultiOption;\n     }\n \n-    protected void publishAuthenticationStepAttempt(HttpServletRequest request, AuthenticationContext context,\n-                                                  User user, boolean success) {\n+    protected void publishAuthenticationStepAttemptSuccess(HttpServletRequest request, AuthenticationContext context,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxMTQ3Mg=="}, "originalCommit": {"oid": "454aad61e1e1eba5e0446d63bd49db7b42abf7c7"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxNjcxOQ==", "bodyText": "But customers are using this AbstractApplicationAuthenticator to write their own custom authenticators, so changing the method signature is not acceptable. Is it decided to change the protected method signature in the code review?", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r454816719", "createdAt": "2020-07-15T06:18:06Z", "author": {"login": "nilasini"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -153,43 +155,77 @@ protected boolean isStepHasMultiOption(AuthenticationContext context) {\n         return stepHasMultiOption;\n     }\n \n-    protected void publishAuthenticationStepAttempt(HttpServletRequest request, AuthenticationContext context,\n-                                                  User user, boolean success) {\n+    protected void publishAuthenticationStepAttemptSuccess(HttpServletRequest request, AuthenticationContext context,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxMTQ3Mg=="}, "originalCommit": {"oid": "454aad61e1e1eba5e0446d63bd49db7b42abf7c7"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkzMTQ5Mw==", "bodyText": "ACK and Changed", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r454931493", "createdAt": "2020-07-15T09:51:45Z", "author": {"login": "Sathiyakugan"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -153,43 +155,77 @@ protected boolean isStepHasMultiOption(AuthenticationContext context) {\n         return stepHasMultiOption;\n     }\n \n-    protected void publishAuthenticationStepAttempt(HttpServletRequest request, AuthenticationContext context,\n-                                                  User user, boolean success) {\n+    protected void publishAuthenticationStepAttemptSuccess(HttpServletRequest request, AuthenticationContext context,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgxMTQ3Mg=="}, "originalCommit": {"oid": "454aad61e1e1eba5e0446d63bd49db7b42abf7c7"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzI4MzA3OnYy", "diffSide": "RIGHT", "path": "features/identity-event/org.wso2.carbon.identity.event.server.feature/resources/org.wso2.carbon.identity.event.server.feature.default.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODozNTo1N1rOGx0CNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODozNTo1N1rOGx0CNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg4NTk0MA==", "bodyText": "enabling analyticsLoginDataPublisherV110 property is missing?", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r454885940", "createdAt": "2020-07-15T08:35:57Z", "author": {"login": "nilasini"}, "path": "features/identity-event/org.wso2.carbon.identity.event.server.feature/resources/org.wso2.carbon.identity.event.server.feature.default.json", "diffHunk": "@@ -134,6 +134,8 @@\n     \"PRE_SET_CHALLENGE_QUESTION_ANSWERS\",\n     \"POST_SET_CHALLENGE_QUESTION_ANSWERS\"\n   ],\n+  \"identity_mgt.events.schemes.analyticsLoginDataPublisherV110.module_index\": \"22\",\n+  \"identity_mgt.events.schemes.analyticsLoginDataPublisherV110.subscriptions\": \"$ref{authentication.analytics.publish_authentication_event_types}\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed25e71b0cba74eade83573b46d7750f8b440747"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0NjQ4NTAwOnYy", "diffSide": "RIGHT", "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxNDoyODoxN1rOHfMHwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNDoyMzoxN1rOHsxB5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjQ5OA==", "bodyText": "We can use a multiline comment here.", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r502466498", "createdAt": "2020-10-09T14:28:17Z", "author": {"login": "ivantha"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -179,17 +187,32 @@ protected void publishAuthenticationStepAttempt(HttpServletRequest request, Auth\n             if (success) {\n                 authnDataPublisherProxy.publishAuthenticationStepSuccess(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to null since the step event is Success and for the next\n+                // step event start time will be added in DefaultStepHandler handle method.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7199b6ef5d88df549011bdaa279ecd6be46c8c8c"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcwMjY5Mw==", "bodyText": "Fixed with #3159", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r516702693", "createdAt": "2020-11-03T14:23:17Z", "author": {"login": "Sathiyakugan"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -179,17 +187,32 @@ protected void publishAuthenticationStepAttempt(HttpServletRequest request, Auth\n             if (success) {\n                 authnDataPublisherProxy.publishAuthenticationStepSuccess(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to null since the step event is Success and for the next\n+                // step event start time will be added in DefaultStepHandler handle method.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjQ5OA=="}, "originalCommit": {"oid": "7199b6ef5d88df549011bdaa279ecd6be46c8c8c"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0NjQ4NjM2OnYy", "diffSide": "RIGHT", "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxNDoyODozMlrOHfMIdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNDoyMzoyNlrOHsxCTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjY3OA==", "bodyText": "Same as https://github.com/wso2/carbon-identity-framework/pull/3017/files#r502466498", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r502466678", "createdAt": "2020-10-09T14:28:32Z", "author": {"login": "ivantha"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -179,17 +187,32 @@ protected void publishAuthenticationStepAttempt(HttpServletRequest request, Auth\n             if (success) {\n                 authnDataPublisherProxy.publishAuthenticationStepSuccess(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to null since the step event is Success and for the next\n+                // step event start time will be added in DefaultStepHandler handle method.\n+                context.setAnalyticsData(FrameworkConstants.AnalyticsData.CURRENT_AUTHENTICATOR_START_TIME, null);\n \n             } else {\n                 authnDataPublisherProxy.publishAuthenticationStepFailure(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to current time since the step event is failure and retrying\n+                // the event duration will be counted as a new step.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7199b6ef5d88df549011bdaa279ecd6be46c8c8c"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcwMjc5OQ==", "bodyText": "Fixed with #3159", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r516702799", "createdAt": "2020-11-03T14:23:26Z", "author": {"login": "Sathiyakugan"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -179,17 +187,32 @@ protected void publishAuthenticationStepAttempt(HttpServletRequest request, Auth\n             if (success) {\n                 authnDataPublisherProxy.publishAuthenticationStepSuccess(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to null since the step event is Success and for the next\n+                // step event start time will be added in DefaultStepHandler handle method.\n+                context.setAnalyticsData(FrameworkConstants.AnalyticsData.CURRENT_AUTHENTICATOR_START_TIME, null);\n \n             } else {\n                 authnDataPublisherProxy.publishAuthenticationStepFailure(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to current time since the step event is failure and retrying\n+                // the event duration will be counted as a new step.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NjY3OA=="}, "originalCommit": {"oid": "7199b6ef5d88df549011bdaa279ecd6be46c8c8c"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0NjQ4OTE3OnYy", "diffSide": "RIGHT", "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxNDoyOToxMVrOHfMKIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNDoyMzozMFrOHsxCeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NzEwNA==", "bodyText": "It is better to add a doc comment for this method even if it is private.", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r502467104", "createdAt": "2020-10-09T14:29:11Z", "author": {"login": "ivantha"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -179,17 +187,32 @@ protected void publishAuthenticationStepAttempt(HttpServletRequest request, Auth\n             if (success) {\n                 authnDataPublisherProxy.publishAuthenticationStepSuccess(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to null since the step event is Success and for the next\n+                // step event start time will be added in DefaultStepHandler handle method.\n+                context.setAnalyticsData(FrameworkConstants.AnalyticsData.CURRENT_AUTHENTICATOR_START_TIME, null);\n \n             } else {\n                 authnDataPublisherProxy.publishAuthenticationStepFailure(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to current time since the step event is failure and retrying\n+                // the event duration will be counted as a new step.\n+                context.setAnalyticsData(\n+                        FrameworkConstants.AnalyticsData.CURRENT_AUTHENTICATOR_START_TIME, System.currentTimeMillis());\n             }\n         }\n     }\n \n+    private void publishAuthenticationStepAttemptFailure(HttpServletRequest request, AuthenticationContext context,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7199b6ef5d88df549011bdaa279ecd6be46c8c8c"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcwMjg0Mg==", "bodyText": "Fixed with #3159", "url": "https://github.com/wso2/carbon-identity-framework/pull/3017#discussion_r516702842", "createdAt": "2020-11-03T14:23:30Z", "author": {"login": "Sathiyakugan"}, "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/AbstractApplicationAuthenticator.java", "diffHunk": "@@ -179,17 +187,32 @@ protected void publishAuthenticationStepAttempt(HttpServletRequest request, Auth\n             if (success) {\n                 authnDataPublisherProxy.publishAuthenticationStepSuccess(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to null since the step event is Success and for the next\n+                // step event start time will be added in DefaultStepHandler handle method.\n+                context.setAnalyticsData(FrameworkConstants.AnalyticsData.CURRENT_AUTHENTICATOR_START_TIME, null);\n \n             } else {\n                 authnDataPublisherProxy.publishAuthenticationStepFailure(request, context,\n                         unmodifiableParamMap);\n+                // Resetting the authenticator start time to current time since the step event is failure and retrying\n+                // the event duration will be counted as a new step.\n+                context.setAnalyticsData(\n+                        FrameworkConstants.AnalyticsData.CURRENT_AUTHENTICATOR_START_TIME, System.currentTimeMillis());\n             }\n         }\n     }\n \n+    private void publishAuthenticationStepAttemptFailure(HttpServletRequest request, AuthenticationContext context,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ2NzEwNA=="}, "originalCommit": {"oid": "7199b6ef5d88df549011bdaa279ecd6be46c8c8c"}, "originalPosition": 61}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2617, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}