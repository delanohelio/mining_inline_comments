{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2ODA3ODg1", "number": 3011, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxMTo1OTo1OFrOEM3Qjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxMjozODo0MVrOEM4EXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxOTIzNzI3OnYy", "diffSide": "RIGHT", "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilder.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxMTo1OTo1OFrOGvN9ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxMjoyMTowNlrOGvOotQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDk2NA==", "bodyText": "Do we encode the parameters when building resolvedParamsString?", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452164964", "createdAt": "2020-07-09T11:59:58Z", "author": {"login": "mefarazath"}, "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilder.java", "diffHunk": "@@ -501,13 +501,7 @@ private void appendParamsToUri(StringBuilder serverUrl, String resolvedParamsStr\n                 serverUrl.setLength(serverUrl.length() - 1);\n             }\n             if (StringUtils.isNotBlank(resolvedParamsString)) {\n-                try {\n-                    serverUrl.append(delimiter).append(URLEncoder.encode(resolvedParamsString,\n-                            StandardCharsets.UTF_8.name()));\n-                } catch (UnsupportedEncodingException e) {\n-                    throw new URLBuilderException(String.format(\"Error while trying to build url. %s is not supported\" +\n-                            \".\", StandardCharsets.UTF_8.name()), e);\n-                }\n+                serverUrl.append(delimiter).append(resolvedParamsString);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a4fa8362e80a66ddb6c8277384bc525bd3b9162"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2ODM4OA==", "bodyText": "do you mean individual parameters?", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452168388", "createdAt": "2020-07-09T12:06:43Z", "author": {"login": "emswbandara"}, "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilder.java", "diffHunk": "@@ -501,13 +501,7 @@ private void appendParamsToUri(StringBuilder serverUrl, String resolvedParamsStr\n                 serverUrl.setLength(serverUrl.length() - 1);\n             }\n             if (StringUtils.isNotBlank(resolvedParamsString)) {\n-                try {\n-                    serverUrl.append(delimiter).append(URLEncoder.encode(resolvedParamsString,\n-                            StandardCharsets.UTF_8.name()));\n-                } catch (UnsupportedEncodingException e) {\n-                    throw new URLBuilderException(String.format(\"Error while trying to build url. %s is not supported\" +\n-                            \".\", StandardCharsets.UTF_8.name()), e);\n-                }\n+                serverUrl.append(delimiter).append(resolvedParamsString);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDk2NA=="}, "originalCommit": {"oid": "5a4fa8362e80a66ddb6c8277384bc525bd3b9162"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE3MDcxNg==", "bodyText": "Yes", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452170716", "createdAt": "2020-07-09T12:11:11Z", "author": {"login": "mefarazath"}, "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilder.java", "diffHunk": "@@ -501,13 +501,7 @@ private void appendParamsToUri(StringBuilder serverUrl, String resolvedParamsStr\n                 serverUrl.setLength(serverUrl.length() - 1);\n             }\n             if (StringUtils.isNotBlank(resolvedParamsString)) {\n-                try {\n-                    serverUrl.append(delimiter).append(URLEncoder.encode(resolvedParamsString,\n-                            StandardCharsets.UTF_8.name()));\n-                } catch (UnsupportedEncodingException e) {\n-                    throw new URLBuilderException(String.format(\"Error while trying to build url. %s is not supported\" +\n-                            \".\", StandardCharsets.UTF_8.name()), e);\n-                }\n+                serverUrl.append(delimiter).append(resolvedParamsString);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDk2NA=="}, "originalCommit": {"oid": "5a4fa8362e80a66ddb6c8277384bc525bd3b9162"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE3NjA1Mw==", "bodyText": "It was not encoded previously. Added fix at f4f1ea2", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452176053", "createdAt": "2020-07-09T12:21:06Z", "author": {"login": "emswbandara"}, "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilder.java", "diffHunk": "@@ -501,13 +501,7 @@ private void appendParamsToUri(StringBuilder serverUrl, String resolvedParamsStr\n                 serverUrl.setLength(serverUrl.length() - 1);\n             }\n             if (StringUtils.isNotBlank(resolvedParamsString)) {\n-                try {\n-                    serverUrl.append(delimiter).append(URLEncoder.encode(resolvedParamsString,\n-                            StandardCharsets.UTF_8.name()));\n-                } catch (UnsupportedEncodingException e) {\n-                    throw new URLBuilderException(String.format(\"Error while trying to build url. %s is not supported\" +\n-                            \".\", StandardCharsets.UTF_8.name()), e);\n-                }\n+                serverUrl.append(delimiter).append(resolvedParamsString);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDk2NA=="}, "originalCommit": {"oid": "5a4fa8362e80a66ddb6c8277384bc525bd3b9162"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgxOTM2OTkxOnYy", "diffSide": "RIGHT", "path": "components/identity-core/org.wso2.carbon.identity.core/src/test/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilderTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxMjozODo0MVrOGvPPbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQxMjozODo0MVrOGvPPbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE4NTk2Ng==", "bodyText": "Can we add a test case where a parameter has a special character like \"space\" or some character that needs encoding?", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452185966", "createdAt": "2020-07-09T12:38:41Z", "author": {"login": "mefarazath"}, "path": "components/identity-core/org.wso2.carbon.identity.core/src/test/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilderTest.java", "diffHunk": "@@ -260,33 +260,32 @@ public void testBuild() {\n \n         return new Object[][]{\n                 {\"https\", \"www.wso2.com\", 9443, \"/proxyContext\", \"abc\", false, null, \"\", fragmentParams,\n-                        \"https://www.wso2.com:9443/proxyContext#key1%3Dfragment%26key2%3Dfragment%26key3%3Dfragment\" +\n-                                \"%26key4%3Dfragment\", \"\"},\n+                        \"https://www.wso2.com:9443/proxyContext#key1=fragment&key2=fragment&key3=fragment&key4\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4f1ea2d22cbde21781861b96a7a230a312daada"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2609, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}