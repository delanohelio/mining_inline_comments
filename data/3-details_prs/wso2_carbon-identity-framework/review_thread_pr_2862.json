{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNDYyNTMw", "number": 2862, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0NzoxOFrODwnzQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODoxNDowN1rODwrndQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzEwMzM3OnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0NzoxOFrOGDutxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0NzoxOFrOGDutxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NDI5NQ==", "bodyText": "Should this be throwing a runtime exception ? Can use IdentityProviderManagementException right", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406564295", "createdAt": "2020-04-10T01:47:18Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -140,10 +143,26 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n         String samlAuthnRequestsSigningEnabled;\n \n         openIdUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.OPENID_SERVER_URL);\n-        samlECPUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig.SAML_ECP_URL),\n-                true, true);\n-        samlArtifactUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig\n-                .SSO_ARTIFACT_URL), true, true);\n+\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlECPUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SAML_ECP_URL).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdPManagementConstants.SAML_ECP_URL, e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzEwNjk4OnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0OToyNVrOGDuvrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo0OToyNVrOGDuvrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NDc4Mw==", "bodyText": "I don't this we would need to handle this exception one by one.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406564783", "createdAt": "2020-04-10T01:49:25Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -140,10 +143,26 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n         String samlAuthnRequestsSigningEnabled;\n \n         openIdUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.OPENID_SERVER_URL);\n-        samlECPUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig.SAML_ECP_URL),\n-                true, true);\n-        samlArtifactUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig\n-                .SSO_ARTIFACT_URL), true, true);\n+\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlECPUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SAML_ECP_URL).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdPManagementConstants.SAML_ECP_URL, e);\n+            }\n+            try {\n+                samlArtifactUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SSO_ARTIFACT_URL).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzEwOTg0OnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo1MTozNlrOGDuxdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNDo1NTo1N1rOGDxA2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NTIzNw==", "bodyText": "were these not read from the file before", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406565237", "createdAt": "2020-04-10T01:51:36Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +188,24 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+                samlLogoutUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                    + IdPManagementUtil.getTenantParameter();\n \n-        samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+            samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                    + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYwMTk0NQ==", "bodyText": "I reverted the previous changes [1]. There, samlLogoutUrl and samlSSOUrl had been using the IdentityConstants.\n[1] - https://github.com/wso2/carbon-identity-framework/pull/2828/files#diff-98664c0777759c45d183f9180c27614e", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406601945", "createdAt": "2020-04-10T04:55:57Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +188,24 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+                samlLogoutUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                    + IdPManagementUtil.getTenantParameter();\n \n-        samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+            samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                    + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NTIzNw=="}, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzExODEwOnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMTo1NjowNFrOGDu19w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMzoyMzozOVrOGDwAUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NjM5MQ==", "bodyText": "A wrong config ? Is there a use of this really", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406566391", "createdAt": "2020-04-10T01:56:04Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -181,8 +215,9 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             samlECPUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n         }\n \n-        samlAuthnRequestsSigningEnabled = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.\n-                SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED, true, true, true, false);\n+        samlAuthnRequestsSigningEnabled = IdentityUtil\n+                .getServerURL(IdentityConstants.ServerConfig.SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED, true, true) +\n+                IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU4NTQyNg==", "bodyText": "I changed this to its original implementation since I had changed it to use the modified getServerURL method. Shall we remove this since it is not used?\nThe property is used here [1]. But it is not set to the FederatedAuthnConfig from the IdentityProviderManager impl.\n[1] - https://github.com/wso2-extensions/identity-metadata-saml2/blob/41cc848d17f32d5fc377557de91f6efe7473ecb2/components/org.wso2.carbon.identity.idp.metadata.saml2/src/main/java/org/wso2/carbon/identity/idp/metadata/saml2/builder/IDPMetadataBuilder.java#L57", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406585426", "createdAt": "2020-04-10T03:23:39Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -181,8 +215,9 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             samlECPUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n         }\n \n-        samlAuthnRequestsSigningEnabled = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.\n-                SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED, true, true, true, false);\n+        samlAuthnRequestsSigningEnabled = IdentityUtil\n+                .getServerURL(IdentityConstants.ServerConfig.SAML_METADATA_AUTHN_REQUESTS_SIGNING_ENABLED, true, true) +\n+                IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2NjM5MQ=="}, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzEzMTg5OnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNDoxNlrOGDu9ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMDowMzo1MVrOGD2lwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODM4Nw==", "bodyText": "Same is done above right ?", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406568387", "createdAt": "2020-04-10T02:04:16Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2566,34 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n-\n-        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlSSOUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYwNzE4OA==", "bodyText": "this is a done for a different method.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406607188", "createdAt": "2020-04-10T05:22:07Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2566,34 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n-\n-        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlSSOUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODM4Nw=="}, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYxNTA0Ng==", "bodyText": "ok\nSo all these paths just send the path and construct from old way looks to me we can have a method that will just take the context and URL for the legacy mode and return\nSo handling the exception does not needs to be duplicated, checking tenant qualified does not needs to be duplicated and readability can be improved", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406615046", "createdAt": "2020-04-10T05:58:19Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2566,34 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n-\n-        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlSSOUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODM4Nw=="}, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYyMjg5MQ==", "bodyText": "Introduced a method to handle this.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406622891", "createdAt": "2020-04-10T06:30:51Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2566,34 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n-\n-        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlSSOUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODM4Nw=="}, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY5MzMxMg==", "bodyText": "This logic should not ideally be here. Rather if this is something that should not be persisted it should be fixed at that place rather than overriding again after reading properties from DB.\nYet, in the context of present scope fixing this path is fine.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406693312", "createdAt": "2020-04-10T10:03:51Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2566,34 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n-\n-        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlSSOUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODM4Nw=="}, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 98}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzEzMjIyOnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNDozNlrOGDu-AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNDozNlrOGDu-AQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODQ0OQ==", "bodyText": "Isn't same done above", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406568449", "createdAt": "2020-04-10T02:04:36Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2566,34 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n-\n-        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlSSOUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }\n         updateFederationAuthenticationConfigProperty(residentIDP,\n                 IdentityApplicationConstants.Authenticator\n                         .SAML2SSO.NAME, IdentityApplicationConstants.Authenticator.SAML2SSO.SSO_URL, samlSSOUrl);\n \n-        String samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true,\n-                true, true, false);\n+        String samlLogoutUrl;\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlLogoutUrl = ServiceURLBuilder.create().addPath(IdentityConstants.ServerConfig.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+            } catch (URLBuilderException e) {\n+                throw IdentityRuntimeException\n+                        .error(\"Error while building URL: \" + IdentityConstants.ServerConfig.SAMLSSO, e);\n+            }\n+        } else {\n+            samlLogoutUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 116}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzEzNDIwOnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/util/IdPManagementConstants.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjowNTo1MFrOGDu_Dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwMjo0MToyNlrOGDveXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODcxOA==", "bodyText": "When giving a path should we really give '/', doesn't the builder handles it.\nEven if we give it should handle IMO", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406568718", "createdAt": "2020-04-10T02:05:50Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/util/IdPManagementConstants.java", "diffHunk": "@@ -74,6 +74,11 @@\n     public static final String PROVISIONING =\n             \"INBOUND_PROV_ENABLED, INBOUND_PROV_USER_STORE_ID, DEFAULT_PRO_CONNECTOR_NAME\";\n \n+    //Default SAML endpoints.\n+    public static final String SSO_ARTIFACT_URL = \"/samlartresolve\";\n+    public static final String SAML_ECP_URL = \"/samlecp\";\n+    public static final String SAMLSSO = \"/samlsso\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU3NjczNA==", "bodyText": "No we don't need to give \"/\". Builder can handle it.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406576734", "createdAt": "2020-04-10T02:41:26Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/util/IdPManagementConstants.java", "diffHunk": "@@ -74,6 +74,11 @@\n     public static final String PROVISIONING =\n             \"INBOUND_PROV_ENABLED, INBOUND_PROV_USER_STORE_ID, DEFAULT_PRO_CONNECTOR_NAME\";\n \n+    //Default SAML endpoints.\n+    public static final String SSO_ARTIFACT_URL = \"/samlartresolve\";\n+    public static final String SAML_ECP_URL = \"/samlecp\";\n+    public static final String SAMLSSO = \"/samlsso\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2ODcxOA=="}, "originalCommit": {"oid": "5e882f9f98b4f9326fd93ad1b72e6689afe16c72"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzQ1MTg2OnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNTo1Mzo1MFrOGDxv8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNjowNDoxN1rOGDx5eQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYxNDAwMw==", "bodyText": "haven't we read sso url from file", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406614003", "createdAt": "2020-04-10T05:53:50Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +186,21 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+                samlLogoutUrl = samlSSOUrl;\n+            } catch (URLBuilderException e) {\n+                throw IdentityProviderManagementException.error(IdentityProviderManagementServerException.class,\n+                        \"Error while building URL: \" + IdPManagementConstants.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5cd821cae58dd480769d3b8e94cf1913fa6b6ed2"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYxNjQ0MQ==", "bodyText": "no", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406616441", "createdAt": "2020-04-10T06:04:17Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +186,21 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        if (IdentityTenantUtil.isTenantQualifiedUrlsEnabled()) {\n+            try {\n+                samlSSOUrl = ServiceURLBuilder.create().addPath(IdPManagementConstants.SAMLSSO).build()\n+                        .getAbsoluteURL();\n+                samlLogoutUrl = samlSSOUrl;\n+            } catch (URLBuilderException e) {\n+                throw IdentityProviderManagementException.error(IdentityProviderManagementServerException.class,\n+                        \"Error while building URL: \" + IdPManagementConstants.SAMLSSO, e);\n+            }\n+        } else {\n+            samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjYxNDAwMw=="}, "originalCommit": {"oid": "5cd821cae58dd480769d3b8e94cf1913fa6b6ed2"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzYzMTMyOnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNzozMToyMlrOGDzXog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODowNDoxNFrOGD0DQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MDU0Ng==", "bodyText": "why we send a tenant parameter here. What's the URL that gets constructed", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406640546", "createdAt": "2020-04-10T07:31:22Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +170,11 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MDg1OQ==", "bodyText": "This was the earlier implementation. Before we used the modified getServerURL method", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406640859", "createdAt": "2020-04-10T07:32:21Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +170,11 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MDU0Ng=="}, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MTE0MA==", "bodyText": "This constructs https://localhost:9443/samlsso?tenantDomain=wso2.com", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406641140", "createdAt": "2020-04-10T07:33:17Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +170,11 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MDU0Ng=="}, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0NzAxOQ==", "bodyText": "with the new method, we take the constructed url mentioned above, checks if tenantQualifiedURLs is enabled, and if yes, resets it to https://localhost:9443/t/wso2.com/samlsso", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406647019", "createdAt": "2020-04-10T07:50:33Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +170,11 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MDU0Ng=="}, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY1MTcxMg==", "bodyText": "I see, so this has been something existed. +1", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406651712", "createdAt": "2020-04-10T08:04:14Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -169,9 +170,11 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n             openIdUrl = IdentityUtil.getServerURL(IdentityConstants.OpenId.OPENID, true, true);\n         }\n \n-        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true, true, false);\n+        samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true)\n+                + IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MDU0Ng=="}, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzcwNDkwOnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODowNDowM1rOGD0C_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwOTowOToyNlrOGD1cxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY1MTY0Nw==", "bodyText": "So which invokes this method and why that tenant param does not need to be applied here", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406651647", "createdAt": "2020-04-10T08:04:03Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2531,14 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n+        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        samlSSOUrl = resolveAbsoluteURL(IdPManagementConstants.SAMLSSO, samlSSOUrl);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY3NDYyOQ==", "bodyText": "getResidentIdP invokes this overrideResidentIdpEPUrls(IdentityProvider residentIDP).\nSo, eventually, FederationAuthenticationConfig properties for samlsso are overwritten through this.\nIf the query parameter is needed to be appended to the residentIdP configs for samlsso, we need to append that here.", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406674629", "createdAt": "2020-04-10T09:09:26Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -2531,15 +2531,14 @@ private void overrideResidentIdpEPUrls(IdentityProvider residentIDP)\n             throws IdentityProviderManagementException {\n \n         // Not all endpoints are persisted. So we need to update only a few properties.\n+        String samlSSOUrl = IdentityUtil.getServerURL(IdentityConstants.ServerConfig.SAMLSSO, true, true);\n+        samlSSOUrl = resolveAbsoluteURL(IdPManagementConstants.SAMLSSO, samlSSOUrl);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY1MTY0Nw=="}, "originalCommit": {"oid": "ec77da36cd77ed3b01a39ac5177cd37fac6dab30"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzcyODUzOnYy", "diffSide": "RIGHT", "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODoxNDowN1rOGD0QoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODoyMjoxMFrOGD0axA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY1NTEzNg==", "bodyText": "Should we add the tenant domain as a query param when the url is read from file?\n@malithie @mefarazath @inthirakumaaran", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406655136", "createdAt": "2020-04-10T08:14:07Z", "author": {"login": "chamathns"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -137,13 +139,16 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n         String scimGroupsEndpoint;\n         String scim2UsersEndpoint;\n         String scim2GroupsEndpoint;\n-        String samlAuthnRequestsSigningEnabled;\n \n         openIdUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.OPENID_SERVER_URL);\n-        samlECPUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig.SAML_ECP_URL),\n-                true, true);\n-        samlArtifactUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig\n-                .SSO_ARTIFACT_URL), true, true);\n+        samlSSOUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.SSO_IDP_URL) +\n+                IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a994510b8bab448fcaa61d89dac59465527df77f"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY1NzczMg==", "bodyText": "we should first read from the file. Then if it's empty we construct then only tenant query param should be appended", "url": "https://github.com/wso2/carbon-identity-framework/pull/2862#discussion_r406657732", "createdAt": "2020-04-10T08:22:10Z", "author": {"login": "malithie"}, "path": "components/idp-mgt/org.wso2.carbon.idp.mgt/src/main/java/org/wso2/carbon/idp/mgt/IdentityProviderManager.java", "diffHunk": "@@ -137,13 +139,16 @@ public IdentityProvider getResidentIdP(String tenantDomain)\n         String scimGroupsEndpoint;\n         String scim2UsersEndpoint;\n         String scim2GroupsEndpoint;\n-        String samlAuthnRequestsSigningEnabled;\n \n         openIdUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.OPENID_SERVER_URL);\n-        samlECPUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig.SAML_ECP_URL),\n-                true, true);\n-        samlArtifactUrl = IdentityUtil.resolveURL(IdentityUtil.getProperty(IdentityConstants.ServerConfig\n-                .SSO_ARTIFACT_URL), true, true);\n+        samlSSOUrl = IdentityUtil.getProperty(IdentityConstants.ServerConfig.SSO_IDP_URL) +\n+                IdPManagementUtil.getTenantParameter();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY1NTEzNg=="}, "originalCommit": {"oid": "a994510b8bab448fcaa61d89dac59465527df77f"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2294, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}