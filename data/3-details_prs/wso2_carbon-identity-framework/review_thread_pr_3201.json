{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExNjk0Nzc4", "number": 3201, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNzo0NzoxMFrOEy7nqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNzo0NzoxMFrOEy7nqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODQxMDY1OnYy", "diffSide": "RIGHT", "path": "components/claim-mgt/org.wso2.carbon.identity.claim.metadata.mgt/src/main/java/org/wso2/carbon/identity/claim/metadata/mgt/ClaimMetadataManagementServiceImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNzo0NzoxMFrOHp2Ybg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxODo0Mjo0MlrOHp4idA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY0NDY1NA==", "bodyText": "since we are using contains() below, better to use a set here which will be efficient", "url": "https://github.com/wso2/carbon-identity-framework/pull/3201#discussion_r513644654", "createdAt": "2020-10-28T17:47:10Z", "author": {"login": "pulasthi7"}, "path": "components/claim-mgt/org.wso2.carbon.identity.claim.metadata.mgt/src/main/java/org/wso2/carbon/identity/claim/metadata/mgt/ClaimMetadataManagementServiceImpl.java", "diffHunk": "@@ -82,11 +87,23 @@ public void addClaimDialect(ClaimDialect claimDialect, String tenantDomain) thro\n         if (claimDialect == null || StringUtils.isBlank(claimDialect.getClaimDialectURI())) {\n             throw new ClaimMetadataClientException(ERROR_CODE_EMPTY_CLAIM_DIALECT);\n         }\n+        if (StringUtils.isBlank(tenantDomain)) {\n+            throw new ClaimMetadataClientException(ERROR_CODE_EMPTY_TENANT_DOMAIN);\n+        }\n+        int tenantId = IdentityTenantUtil.getTenantId(tenantDomain);\n+        if (tenantId == MultitenantConstants.INVALID_TENANT_ID) {\n+            throw new ClaimMetadataClientException(ERROR_CODE_INVALID_TENANT_DOMAIN.getCode(),\n+                    String.format(ERROR_CODE_INVALID_TENANT_DOMAIN.getMessage(), tenantDomain));\n+        }\n \n-        // TODO : validate claim dialect already exists?\n+        List<ClaimDialect> claimDialects = this.claimDialectDAO.getClaimDialects(tenantId);\n+        List<String> claimDialectUris = claimDialects.stream().map(ClaimDialect::getClaimDialectURI).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a6854f90b76b965c6a84ca7d21c6bf2090a6249"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY3OTk4OA==", "bodyText": "Fixed: e892da0", "url": "https://github.com/wso2/carbon-identity-framework/pull/3201#discussion_r513679988", "createdAt": "2020-10-28T18:42:42Z", "author": {"login": "somindatommy"}, "path": "components/claim-mgt/org.wso2.carbon.identity.claim.metadata.mgt/src/main/java/org/wso2/carbon/identity/claim/metadata/mgt/ClaimMetadataManagementServiceImpl.java", "diffHunk": "@@ -82,11 +87,23 @@ public void addClaimDialect(ClaimDialect claimDialect, String tenantDomain) thro\n         if (claimDialect == null || StringUtils.isBlank(claimDialect.getClaimDialectURI())) {\n             throw new ClaimMetadataClientException(ERROR_CODE_EMPTY_CLAIM_DIALECT);\n         }\n+        if (StringUtils.isBlank(tenantDomain)) {\n+            throw new ClaimMetadataClientException(ERROR_CODE_EMPTY_TENANT_DOMAIN);\n+        }\n+        int tenantId = IdentityTenantUtil.getTenantId(tenantDomain);\n+        if (tenantId == MultitenantConstants.INVALID_TENANT_ID) {\n+            throw new ClaimMetadataClientException(ERROR_CODE_INVALID_TENANT_DOMAIN.getCode(),\n+                    String.format(ERROR_CODE_INVALID_TENANT_DOMAIN.getMessage(), tenantDomain));\n+        }\n \n-        // TODO : validate claim dialect already exists?\n+        List<ClaimDialect> claimDialects = this.claimDialectDAO.getClaimDialects(tenantId);\n+        List<String> claimDialectUris = claimDialects.stream().map(ClaimDialect::getClaimDialectURI).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY0NDY1NA=="}, "originalCommit": {"oid": "4a6854f90b76b965c6a84ca7d21c6bf2090a6249"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2497, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}