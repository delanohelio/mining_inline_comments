{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNTYyNjkx", "number": 1723, "title": "DDB Enhanced Client adds bean annotations for attribute converter pro\u2026", "bodyText": "\u2026viders and attribute converters\nDescription\n\nAdds an optional attribute to supply an AttributeConverterProvider to the @DynamoDbBean annotation.\nAdds another annotation DynamoDbConvertedBy to be used on a DDB bean attribute when that attribute needs a specific converter. This converter overrides any attribute converter provider supplied converters.\n\nTracking DDB enhanced client features: Issue #35.\nMotivation and Context\nThese annotation enhancements enrich the DBB Enhanced Client bean features and allow users to customize how their beans are converted to and from DDB format.\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-03-18T17:13:54Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1723", "merged": true, "mergeCommit": {"oid": "16641d687cbc566050ea38cfb24bc89294aa73af"}, "closed": true, "closedAt": "2020-03-19T23:35:45Z", "author": {"login": "cenedhryn"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcO7VCcAFqTM3NzA5Mzg5Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPTtHKgBqjMxNDc1MDIzNzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MDkzODkz", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1723#pullrequestreview-377093893", "createdAt": "2020-03-18T17:39:56Z", "commit": {"oid": "57c6e284ecec013ee1b0bc7d54e9280c2c52a4ed"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNzozOTo1NlrOF4QBQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxODowNzoxNFrOF4RC2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDUyNzA0Mg==", "bodyText": "This example doesn't really make any sense because we're using the plural form with the 'temporary' singular implementation, maybe add a TODO? I also don't see the need to use an inner class here in this isolated example?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1723#discussion_r394527042", "createdAt": "2020-03-18T17:39:56Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/enhanced/dynamodb/mapper/annotations/DynamoDbBean.java", "diffHunk": "@@ -20,15 +20,27 @@\n import java.lang.annotation.RetentionPolicy;\n import java.lang.annotation.Target;\n import software.amazon.awssdk.annotations.SdkPublicApi;\n+import software.amazon.awssdk.enhanced.dynamodb.AttributeConverter;\n+import software.amazon.awssdk.enhanced.dynamodb.AttributeConverterProvider;\n import software.amazon.awssdk.enhanced.dynamodb.mapper.BeanTableSchema;\n \n /**\n  * Class level annotation that identifies this class as being a DynamoDb mappable entity. Any class used to initialize\n- * a {@link BeanTableSchema} must have this\n- * annotation. If a class is used as a document within another DynamoDbBean it will also require this annotation.\n+ * a {@link BeanTableSchema} must have this annotation. If a class is used as a document within another DynamoDbBean,\n+ * it will also require this annotation.\n+ * <p>\n+ * Using {@link AttributeConverterProvider}s is optional and, if used, the supplied provider supersedes the default\n+ * converter provided by the table schema. The converter must provide {@link AttributeConverter}s for all types used\n+ * in the schema. The table schema default AttributeConverterProvider provides standard converters for most primitive\n+ * and common Java types. Use custom AttributeConverterProviders when you have specific needs for type conversion\n+ * that the defaults do not cover. Define the AttributeConverterProvider like this:\n+ * {@code\n+ * @literal @DynamoDbBean(converterProviders = ConverterBean.CustomAttributeConverterProvider.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57c6e284ecec013ee1b0bc7d54e9280c2c52a4ed"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDUyNzU4Mw==", "bodyText": "I think saying 'The converter is optional' is misleading, I'd rather say 'This annotation is optional'", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1723#discussion_r394527583", "createdAt": "2020-03-18T17:40:46Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/enhanced/dynamodb/mapper/annotations/DynamoDbConvertedBy.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.enhanced.dynamodb.mapper.annotations;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+import software.amazon.awssdk.annotations.SdkPublicApi;\n+import software.amazon.awssdk.enhanced.dynamodb.AttributeConverter;\n+import software.amazon.awssdk.enhanced.dynamodb.AttributeConverterProvider;\n+\n+/**\n+ * Associates a custom {@link AttributeConverter} with this attribute. The converter is optional and takes\n+ * precedence over any converter for this type provided by the table schema {@link AttributeConverterProvider}\n+ * if it exists. Use custom AttributeConverterProvider when you have specific needs for type conversion\n+ * that the defaults do not cover.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57c6e284ecec013ee1b0bc7d54e9280c2c52a4ed"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDUyODAwMA==", "bodyText": "Maybe add an example showing both the annotation and the attribute declaration?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1723#discussion_r394528000", "createdAt": "2020-03-18T17:41:27Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/enhanced/dynamodb/mapper/annotations/DynamoDbConvertedBy.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.enhanced.dynamodb.mapper.annotations;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+import software.amazon.awssdk.annotations.SdkPublicApi;\n+import software.amazon.awssdk.enhanced.dynamodb.AttributeConverter;\n+import software.amazon.awssdk.enhanced.dynamodb.AttributeConverterProvider;\n+\n+/**\n+ * Associates a custom {@link AttributeConverter} with this attribute. The converter is optional and takes\n+ * precedence over any converter for this type provided by the table schema {@link AttributeConverterProvider}\n+ * if it exists. Use custom AttributeConverterProvider when you have specific needs for type conversion\n+ * that the defaults do not cover.\n+ */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57c6e284ecec013ee1b0bc7d54e9280c2c52a4ed"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU0MzgzMw==", "bodyText": "I can't find a test associated with this, also I think the CustomAttributeConverter should have a private constructor (so it can't be instantiated by the test), and we should check for exception. You have a good test for this with the provider.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1723#discussion_r394543833", "createdAt": "2020-03-18T18:07:14Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/enhanced/dynamodb/mapper/testbeans/AttributeConverterNoConstructorBean.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.enhanced.dynamodb.mapper.testbeans;\n+\n+import software.amazon.awssdk.enhanced.dynamodb.AttributeConverter;\n+import software.amazon.awssdk.enhanced.dynamodb.AttributeValueType;\n+import software.amazon.awssdk.enhanced.dynamodb.EnhancedType;\n+import software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.DynamoDbBean;\n+import software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.DynamoDbConvertedBy;\n+import software.amazon.awssdk.services.dynamodb.model.AttributeValue;\n+\n+@DynamoDbBean\n+public class AttributeConverterNoConstructorBean extends AbstractBean {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57c6e284ecec013ee1b0bc7d54e9280c2c52a4ed"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MDk3MzYy", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1723#pullrequestreview-378097362", "createdAt": "2020-03-19T21:12:40Z", "commit": {"oid": "6cc43a7c6ce2fe9133b15e85949d866bce8166c5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18fab281c16d6015bf3b490578267c7f330381f6", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/18fab281c16d6015bf3b490578267c7f330381f6", "committedDate": "2020-03-19T22:32:03Z", "message": "DDB Enhanced Client adds bean annotations for attribute converter providers and attribute converters"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca6f02c6b036166727b1ebb71d011fa5b9a18e46", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/ca6f02c6b036166727b1ebb71d011fa5b9a18e46", "committedDate": "2020-03-19T21:09:49Z", "message": "Merge branch 'master' into salande/enhanced-ddb-bean-attributeconverterprovider"}, "afterCommit": {"oid": "18fab281c16d6015bf3b490578267c7f330381f6", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/18fab281c16d6015bf3b490578267c7f330381f6", "committedDate": "2020-03-19T22:32:03Z", "message": "DDB Enhanced Client adds bean annotations for attribute converter providers and attribute converters"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2753, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}