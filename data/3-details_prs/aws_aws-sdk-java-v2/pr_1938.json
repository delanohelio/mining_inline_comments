{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzNzM5MjY5", "number": 1938, "title": "Sdk metrics preview", "bodyText": "Description\nMerge in V2 metrics into master.\n\nmerged in 8a088f5 in sdk-metrics-development-2\nUpdated the metrics modules to match the versions in 8a088f5\n\nMotivation and Context\n\n\nTesting\n\n\n\nScreenshots (if appropriate)\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n\n\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-07-02T20:59:20Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938", "merged": true, "mergeCommit": {"oid": "0c9d384b2900180c6424c91739c78a06261f9a9b"}, "closed": true, "closedAt": "2020-07-07T00:04:30Z", "author": {"login": "dagnir"}, "timelineItems": {"totalCount": 35, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclfbwJgH2gAyNDQzNzM5MjY5OmZhYWJhNDA5Njc3ZjAyOTMyYjY4Yzk1ZTViNjI4NzRjMzlkMWM0NGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyZnFogFqTQ0MzQ2MjQyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "faaba409677f02932b68c95e5b62874c39d1c44e", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/faaba409677f02932b68c95e5b62874c39d1c44e", "committedDate": "2020-05-27T20:38:39Z", "message": "Add default impls of SPI classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5af6d878e64572e02424d6e896b87fc4d00b2d13", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/5af6d878e64572e02424d6e896b87fc4d00b2d13", "committedDate": "2020-05-27T21:05:11Z", "message": "Merge pull request #1859 from dagnir/spi-impl\n\nAdd default impls of SPI classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69e0b3c38cc87fa68d2dac3764146167f9d1b3be", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/69e0b3c38cc87fa68d2dac3764146167f9d1b3be", "committedDate": "2020-05-28T23:41:30Z", "message": "Add apache HTTP request stats"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "299ed84b1ba559932f2c7f701b9b80c68dd1f9cc", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/299ed84b1ba559932f2c7f701b9b80c68dd1f9cc", "committedDate": "2020-05-28T23:59:26Z", "message": "Merge pull request #1863 from dagnir/apache-metrics\n\nAdd apache HTTP request stats"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7e834c5166eb63aa4d960fd916b93efd9980291", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/f7e834c5166eb63aa4d960fd916b93efd9980291", "committedDate": "2020-06-04T18:54:06Z", "message": "Add setup code for API call metrics for sync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c8dd25f1581dea78e51ef6728df099757992a0a", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/4c8dd25f1581dea78e51ef6728df099757992a0a", "committedDate": "2020-06-05T22:52:15Z", "message": "Merge pull request #1872 from dagnir/core-metrics\n\nAdd setup code for API call metrics for sync"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f72a114d03a84b3380fa4e9ee90afadb9f942b8", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/7f72a114d03a84b3380fa4e9ee90afadb9f942b8", "committedDate": "2020-06-06T00:16:00Z", "message": "Collect HTTP/1 metrics in NettyNioHttpClient."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e14f0af8582e2c65d9b227ecd634e765f1b18a8a", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/e14f0af8582e2c65d9b227ecd634e765f1b18a8a", "committedDate": "2020-06-08T15:53:44Z", "message": "Support core metrics for sync clients"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ee0be38d830caa074339a7fcc476812ee8c714c", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/0ee0be38d830caa074339a7fcc476812ee8c714c", "committedDate": "2020-06-08T21:59:30Z", "message": "Merge pull request #1882 from dagnir/core-metrics-pt2\n\nSupport core metrics for sync clients"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c882aaa0be323bd5cff55a5689347f4a1b9e13ff", "author": {"user": {"login": "zoewangg", "name": "Zoe Wang"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/c882aaa0be323bd5cff55a5689347f4a1b9e13ff", "committedDate": "2020-06-10T17:08:23Z", "message": "Add metrics codegen changes for async clients"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9032023c516b877958cd54d39a8f7bd4122bc9ac", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9032023c516b877958cd54d39a8f7bd4122bc9ac", "committedDate": "2020-06-11T18:40:35Z", "message": "Added support for HTTP/2 metrics to Netty.\n\nUpdated existing HTTP metrics to specify that they are \"concurrency\", not \"connections\". For HTTP/2, we can't calculate the maximum number of connections, and concurrency is more useful to customers anyway.\n\nFixed the AVAILABLE_CONCURRENCY in Netty to actually be the number of established but idle concurrency, not the difference between max concurrency and leased concurrency."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f53f9c0b09ef4849dff42a2fe255e02340dbd09", "author": {"user": {"login": "zoewangg", "name": "Zoe Wang"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/1f53f9c0b09ef4849dff42a2fe255e02340dbd09", "committedDate": "2020-06-12T03:34:36Z", "message": "Support core metrics for async clients"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49d745e8966ee2f153ea69ad767aa21eaf13d1a6", "author": {"user": {"login": "zoewangg", "name": "Zoe Wang"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/49d745e8966ee2f153ea69ad767aa21eaf13d1a6", "committedDate": "2020-06-12T18:48:46Z", "message": "Add functional and unit tests to verify async core metrics for event streaming operation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9b7faabb0ecd823a5ce0f7cc99a6530d5f7a82c", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/b9b7faabb0ecd823a5ce0f7cc99a6530d5f7a82c", "committedDate": "2020-06-18T15:19:38Z", "message": "Add tests for MetricUtils\n\nFollow-up on review comment on #1882"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27fbcfd88a4f5170a9a982563ca6263a8b890ffc", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/27fbcfd88a4f5170a9a982563ca6263a8b890ffc", "committedDate": "2020-06-18T16:39:44Z", "message": "Merge pull request #1906 from dagnir/metric-utils-test\n\nMetric utils test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c888404d3d80e327cad33f7193473ea8018757a", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/6c888404d3d80e327cad33f7193473ea8018757a", "committedDate": "2020-06-18T17:38:10Z", "message": "Minor metrics fixes\n\n - move ServiceId and OperationName reporting into try block\n - ServiceName -> ServiceId\n - Fix typo in test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c192e3b04892987bf0872f76ba4f65167f3a872", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/8c192e3b04892987bf0872f76ba4f65167f3a872", "committedDate": "2020-06-18T18:21:54Z", "message": "Additional tests for IOException for core metrics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "312d49a0e05c0b431cb0ded45e5245c442259052", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/312d49a0e05c0b431cb0ded45e5245c442259052", "committedDate": "2020-06-22T20:09:15Z", "message": "Add CloudWatchMetricPublisher, a MetricPublisher implementation that uploads metric data to CloudWatch."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83d46ca59c168684d9b53fbec22821053f667d4f", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/83d46ca59c168684d9b53fbec22821053f667d4f", "committedDate": "2020-06-22T21:24:10Z", "message": "Fixed a cloudwatch-metric-publisher issue where very small values would result in a failure calling cloudwatch."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9908e2253ebc6c2a211be16382c1e1a348db0523", "author": {"user": {"login": "Quanzzzz", "name": "Quan Zhou"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9908e2253ebc6c2a211be16382c1e1a348db0523", "committedDate": "2020-06-23T04:54:04Z", "message": "Merged mainline to metrics development branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d57c583a56c11def229349b01f6c3b2d9fe919a", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/3d57c583a56c11def229349b01f6c3b2d9fe919a", "committedDate": "2020-06-23T17:46:03Z", "message": "Add HttpClient collector to HTTP request"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "203af1cb2d4d8fd24c95f77a4316a735fe6155d2", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/203af1cb2d4d8fd24c95f77a4316a735fe6155d2", "committedDate": "2020-06-23T20:25:48Z", "message": "Merge pull request #1923 from Quanzzzz/sdk-metrics-development-2\n\nMerge mainline to metrics development branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4346d2cc8d0f02ca60c36088b17e213ec859e1b", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/c4346d2cc8d0f02ca60c36088b17e213ec859e1b", "committedDate": "2020-06-30T20:40:43Z", "message": "Mutiple metrics fixes\n\n - Allow lists of publishers to be set.\n\n   Allow setting of metric pubishers to be set on the client of request override\n   rather than a single publisher, making using multiple MetricPublishers per\n   client or request easier.\n\n - Remove any non-core usage of MetricUtils.\n\n - Fix metrics test in TranscribeStreamIntegrationTest.\n\n - Fix Async API call metric stage to add the duration in a separate\n   CompletionStage."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33b3138d20d8cda02fe947235a773dccbe29ad69", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/33b3138d20d8cda02fe947235a773dccbe29ad69", "committedDate": "2020-06-30T23:45:57Z", "message": "Updated metric publishing to address internal review comments.\n\nAlso fixed an issue where multiple parts of the SDK were ignoring the \"alternate\" request ID."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43513308e653458b4a8d423a74e6839bd51339f0", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/43513308e653458b4a8d423a74e6839bd51339f0", "committedDate": "2020-07-01T22:03:01Z", "message": "Add Preview annotations for metrics related classes/methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3e149e1bcf44f7de999e525d8a49fb3fb8dac9d", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/d3e149e1bcf44f7de999e525d8a49fb3fb8dac9d", "committedDate": "2020-07-02T20:40:05Z", "message": "Update CW Publisher to PREVIEW"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9307eefb9d319feaca989da54a4a560cd4a9a9f1", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9307eefb9d319feaca989da54a4a560cd4a9a9f1", "committedDate": "2020-07-02T21:33:30Z", "message": "Merge remote-tracking branch 'origin/master' into sdk-metrics-preview"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/bac7d6f06bac3f985ded5a0c507143d8a84f4bd0", "committedDate": "2020-07-02T21:33:52Z", "message": "Update metrics module versions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "14536e3fb8bec5462514f2107592b77c99a777d5", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/14536e3fb8bec5462514f2107592b77c99a777d5", "committedDate": "2020-07-02T20:52:32Z", "message": "Update metrics module versions"}, "afterCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/bac7d6f06bac3f985ded5a0c507143d8a84f4bd0", "committedDate": "2020-07-02T21:33:52Z", "message": "Update metrics module versions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyMDQ2MjA3", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#pullrequestreview-442046207", "createdAt": "2020-07-02T22:11:14Z", "commit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMjoxNDozNFrOGsea0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMjozMTo1MlrOGseuUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI4ODkxNQ==", "bodyText": "Should we return whenComplete's result, so that it's easier to say that \"when the execute future completes, metrics have been published\"?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#discussion_r449288915", "createdAt": "2020-07-02T22:14:34Z", "author": {"login": "millems"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/client/test-endpoint-discovery-async.java", "diffHunk": "@@ -255,9 +302,19 @@ public final String serviceName() {\n                             .withOperationName(\"TestDiscoveryRequired\")\n                             .withMarshaller(new TestDiscoveryRequiredRequestMarshaller(protocolFactory))\n                             .withResponseHandler(responseHandler).withErrorResponseHandler(errorResponseHandler)\n-                            .discoveredEndpoint(cachedEndpoint).withInput(testDiscoveryRequiredRequest));\n+                            .withMetricCollector(apiCallMetricCollector).discoveredEndpoint(cachedEndpoint)\n+                            .withInput(testDiscoveryRequiredRequest));\n+            AwsRequestOverrideConfiguration requestOverrideConfig = testDiscoveryRequiredRequest.overrideConfiguration().orElse(\n+                    null);\n+            executeFuture.whenComplete((r, e) -> {\n+                List<MetricPublisher> metricPublishers = resolveMetricPublishers(clientConfiguration, requestOverrideConfig);\n+                metricPublishers.forEach(p -> p.publish(apiCallMetricCollector.collect()));\n+            });\n             return executeFuture;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "originalPosition": 147}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI4OTk3MQ==", "bodyText": "We might want to consider supporting these, so that enabling the \"NoOpMetricCollector\" won't cause all of the SDK calls to fail with UnsupportedOperationException.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#discussion_r449289971", "createdAt": "2020-07-02T22:17:42Z", "author": {"login": "millems"}, "path": "core/metrics-spi/src/main/java/software/amazon/awssdk/metrics/NoOpMetricCollector.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.metrics;\n+\n+import software.amazon.awssdk.annotations.SdkPreviewApi;\n+import software.amazon.awssdk.annotations.SdkPublicApi;\n+\n+/**\n+ * A metric collector that doesn't do anything.\n+ *\n+ * <b>NOTE:</b> This is a Preview API and is subject to change so it should not be used in production.\n+ */\n+@SdkPreviewApi\n+@SdkPublicApi\n+public final class NoOpMetricCollector implements MetricCollector {\n+    private static final NoOpMetricCollector INSTANCE = new NoOpMetricCollector();\n+\n+    private NoOpMetricCollector() {\n+    }\n+\n+    @Override\n+    public String name() {\n+        return \"NoOp\";\n+    }\n+\n+    @Override\n+    public <T> void reportMetric(SdkMetric<T> metric, T data) {\n+    }\n+\n+    @Override\n+    public MetricCollector createChild(String name) {\n+        throw new UnsupportedOperationException(\"No op collector does not support createChild\");\n+    }\n+\n+    @Override\n+    public MetricCollection collect() {\n+        throw new UnsupportedOperationException(\"No op collector does not support collect\");\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5MDQ1MQ==", "bodyText": "Do we use this? Why not just let the caller use valueClass().cast(o)?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#discussion_r449290451", "createdAt": "2020-07-02T22:19:31Z", "author": {"login": "millems"}, "path": "core/metrics-spi/src/main/java/software/amazon/awssdk/metrics/SdkMetric.java", "diffHunk": "@@ -0,0 +1,94 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.metrics;\n+\n+import java.util.Set;\n+import software.amazon.awssdk.annotations.SdkPreviewApi;\n+import software.amazon.awssdk.annotations.SdkPublicApi;\n+import software.amazon.awssdk.metrics.internal.DefaultSdkMetric;\n+\n+/**\n+ * A specific SDK metric.\n+ *\n+ * @param <T> The type for values of this metric.\n+ *\n+ * <b>NOTE:</b> This is a Preview API and is subject to change so it should not be used in production.\n+ */\n+@SdkPreviewApi\n+@SdkPublicApi\n+public interface SdkMetric<T> {\n+\n+    /**\n+     * @return The name of this metric.\n+     */\n+    String name();\n+\n+    /**\n+     * @return The categories of this metric.\n+     */\n+    Set<MetricCategory> categories();\n+\n+    /**\n+     * @return The level of this metric.\n+     */\n+    MetricLevel level();\n+\n+    /**\n+     * @return The class of the value associated with this metric.\n+     */\n+    Class<T> valueClass();\n+\n+    /**\n+     * Cast the given object to the value class associated with this event.\n+     *\n+     * @param o The object.\n+     * @return The cast object.\n+     * @throws ClassCastException If {@code o} is not an instance of type {@code\n+     * T}.\n+     */\n+    T convertValue(Object o);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5MDU3NA==", "bodyText": "weird formatting", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#discussion_r449290574", "createdAt": "2020-07-02T22:20:03Z", "author": {"login": "millems"}, "path": "core/metrics-spi/src/main/java/software/amazon/awssdk/metrics/internal/DefaultMetricCollection.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.metrics.internal;\n+\n+import static java.util.stream.Collectors.toList;\n+\n+import java.time.Instant;\n+import java.util.Collections;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import software.amazon.awssdk.annotations.SdkInternalApi;\n+import software.amazon.awssdk.metrics.MetricCollection;\n+import software.amazon.awssdk.metrics.MetricRecord;\n+import software.amazon.awssdk.metrics.SdkMetric;\n+import software.amazon.awssdk.utils.ToString;\n+\n+@SdkInternalApi\n+public final class DefaultMetricCollection implements MetricCollection {\n+    private final String name;\n+    private final Map<SdkMetric<?>, List<MetricRecord<?>>> metrics;\n+    private final List<MetricCollection> children;\n+    private final Instant creationTime;\n+\n+    public DefaultMetricCollection(String name, Map<SdkMetric<?>,\n+        List<MetricRecord<?>>> metrics,\n+                                   List<MetricCollection> children) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5MTA1Ng==", "bodyText": "Nit: Capital C?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#discussion_r449291056", "createdAt": "2020-07-02T22:21:47Z", "author": {"login": "millems"}, "path": "core/metrics-spi/src/main/java/software/amazon/awssdk/metrics/internal/DefaultMetricCollector.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.metrics.internal;\n+\n+import java.util.ArrayList;\n+import java.util.LinkedHashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.stream.Collectors;\n+import software.amazon.awssdk.annotations.SdkInternalApi;\n+import software.amazon.awssdk.metrics.MetricCollection;\n+import software.amazon.awssdk.metrics.MetricCollector;\n+import software.amazon.awssdk.metrics.MetricRecord;\n+import software.amazon.awssdk.metrics.SdkMetric;\n+import software.amazon.awssdk.utils.Logger;\n+import software.amazon.awssdk.utils.ToString;\n+import software.amazon.awssdk.utils.Validate;\n+\n+/**\n+ * TODO: Before launch, we should iterate on the performance of this collector, because it's currently very naive.\n+ */\n+@SdkInternalApi\n+public final class DefaultMetricCollector implements MetricCollector {\n+    private static final Logger log = Logger.loggerFor(DefaultMetricCollector.class);\n+    private final String name;\n+    private final Map<SdkMetric<?>, List<MetricRecord<?>>> metrics = new LinkedHashMap<>();\n+    private final List<MetricCollector> children = new ArrayList<>();\n+\n+    public DefaultMetricCollector(String name) {\n+        this.name = name;\n+    }\n+\n+    @Override\n+    public String name() {\n+        return name;\n+    }\n+\n+    @Override\n+    public synchronized <T> void reportMetric(SdkMetric<T> metric, T data) {\n+        metrics.computeIfAbsent(metric, (m) -> new ArrayList<>())\n+               .add(new DefaultMetricRecord<>(metric, data));\n+    }\n+\n+    @Override\n+    public synchronized MetricCollector createChild(String name) {\n+        MetricCollector child = new DefaultMetricCollector(name);\n+        children.add(child);\n+        return child;\n+    }\n+\n+    @Override\n+    public synchronized MetricCollection collect() {\n+        List<MetricCollection> collectedChildren = children.stream()\n+                .map(MetricCollector::collect)\n+                .collect(Collectors.toList());\n+\n+        DefaultMetricCollection metricRecords = new DefaultMetricCollection(name, metrics, collectedChildren);\n+\n+        log.debug(() -> \"collected metrics records: \" + metricRecords);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5Mjg0Nw==", "bodyText": "Worried about this being used when collect() and newChild() throw exceptions.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#discussion_r449292847", "createdAt": "2020-07-02T22:28:07Z", "author": {"login": "millems"}, "path": "core/sdk-core/src/main/java/software/amazon/awssdk/core/internal/util/MetricUtils.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.core.internal.util;\n+\n+import static software.amazon.awssdk.core.http.HttpResponseHandler.X_AMZN_REQUEST_ID_HEADERS;\n+import static software.amazon.awssdk.core.http.HttpResponseHandler.X_AMZ_ID_2_HEADER;\n+\n+import java.time.Duration;\n+import java.util.concurrent.Callable;\n+import java.util.function.Supplier;\n+import software.amazon.awssdk.annotations.SdkInternalApi;\n+import software.amazon.awssdk.core.internal.http.RequestExecutionContext;\n+import software.amazon.awssdk.core.metrics.CoreMetric;\n+import software.amazon.awssdk.http.HttpMetric;\n+import software.amazon.awssdk.http.SdkHttpFullResponse;\n+import software.amazon.awssdk.metrics.MetricCollector;\n+import software.amazon.awssdk.metrics.NoOpMetricCollector;\n+import software.amazon.awssdk.utils.Pair;\n+import software.amazon.awssdk.utils.http.SdkHttpUtils;\n+\n+/**\n+ * Utility methods for working with metrics.\n+ */\n+@SdkInternalApi\n+public final class MetricUtils {\n+\n+    private MetricUtils() {\n+    }\n+\n+    /**\n+     * Measure the duration of the given callable.\n+     *\n+     * @param c The callable to measure.\n+     * @return A {@code Pair} containing the result of {@code c} and the duration.\n+     */\n+    public static <T> Pair<T, Duration> measureDuration(Supplier<T> c) {\n+        long start = System.nanoTime();\n+        T result = c.get();\n+        Duration d = Duration.ofNanos(System.nanoTime() - start);\n+        return Pair.of(result, d);\n+    }\n+\n+    /**\n+     * Measure the duration of the given callable.\n+     *\n+     * @param c The callable to measure.\n+     * @return A {@code Pair} containing the result of {@code c} and the duration.\n+     */\n+    public static <T> Pair<T, Duration> measureDurationUnsafe(Callable<T> c) throws Exception {\n+        long start = System.nanoTime();\n+        T result = c.call();\n+        Duration d = Duration.ofNanos(System.nanoTime() - start);\n+        return Pair.of(result, d);\n+    }\n+\n+    public static void collectHttpMetrics(MetricCollector metricCollector, SdkHttpFullResponse httpResponse) {\n+        metricCollector.reportMetric(HttpMetric.HTTP_STATUS_CODE, httpResponse.statusCode());\n+        SdkHttpUtils.allMatchingHeadersFromCollection(httpResponse.headers(), X_AMZN_REQUEST_ID_HEADERS)\n+                    .forEach(v -> metricCollector.reportMetric(CoreMetric.AWS_REQUEST_ID, v));\n+        httpResponse.firstMatchingHeader(X_AMZ_ID_2_HEADER)\n+                    .ifPresent(v -> metricCollector.reportMetric(CoreMetric.AWS_EXTENDED_REQUEST_ID, v));\n+    }\n+\n+    public static MetricCollector createAttemptMetricsCollector(RequestExecutionContext context) {\n+        MetricCollector parentCollector = context.executionContext().metricCollector();\n+        if (parentCollector != null) {\n+            return parentCollector.createChild(\"ApiCallAttempt\");\n+        }\n+        return NoOpMetricCollector.create();\n+    }\n+\n+    public static MetricCollector createHttpMetricsCollector(RequestExecutionContext context) {\n+        MetricCollector parentCollector = context.attemptMetricCollector();\n+        if (parentCollector != null) {\n+            return parentCollector.createChild(\"HttpClient\");\n+        }\n+        return NoOpMetricCollector.create();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5MzE5OQ==", "bodyText": "Maybe we should do ~= since this function disregards small, constant time factors.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#discussion_r449293199", "createdAt": "2020-07-02T22:29:24Z", "author": {"login": "millems"}, "path": "core/sdk-core/src/main/java/software/amazon/awssdk/core/metrics/CoreMetric.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.core.metrics;\n+\n+import java.time.Duration;\n+import software.amazon.awssdk.annotations.SdkPreviewApi;\n+import software.amazon.awssdk.annotations.SdkPublicApi;\n+import software.amazon.awssdk.core.retry.RetryPolicy;\n+import software.amazon.awssdk.metrics.MetricCategory;\n+import software.amazon.awssdk.metrics.MetricLevel;\n+import software.amazon.awssdk.metrics.SdkMetric;\n+\n+/**\n+ * <b>NOTE:</b> This is a Preview API and is subject to change so it should not be used in production.\n+ */\n+@SdkPreviewApi\n+@SdkPublicApi\n+public final class CoreMetric {\n+    /**\n+     * The unique ID for the service. This is present for all API call metrics.\n+     */\n+    public static final SdkMetric<String> SERVICE_ID =\n+        metric(\"ServiceId\", String.class, MetricLevel.ERROR);\n+\n+    /**\n+     * The name of the service operation being invoked. This is present for all\n+     * API call metrics.\n+     */\n+    public static final SdkMetric<String> OPERATION_NAME =\n+        metric(\"OperationName\", String.class, MetricLevel.ERROR);\n+\n+    /**\n+     * True if the API call succeeded, false otherwise.\n+     */\n+    public static final SdkMetric<Boolean> API_CALL_SUCCESSFUL =\n+        metric(\"ApiCallSuccessful\", Boolean.class, MetricLevel.ERROR);\n+\n+    /**\n+     * The number of retries that the SDK performed in the execution of the request. 0 implies that the request worked the first\n+     * time, and no retries were attempted.\n+     */\n+    public static final SdkMetric<Integer> RETRY_COUNT =\n+        metric(\"RetryCount\", Integer.class, MetricLevel.ERROR);\n+\n+    /**\n+     * The duration of the API call. This includes all call attempts made.\n+     *\n+     * <p>{@code API_CALL_DURATION = CREDENTIALS_FETCH_DURATION + MARSHALLING_DURATION + SUM_ALL(BACKOFF_DELAY_DURATION) +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI5MzkwNg==", "bodyText": "I noticed we updated V1 from milliseconds to nanoseconds. Should we just do nanos instead from the beginning for V2?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#discussion_r449293906", "createdAt": "2020-07-02T22:31:52Z", "author": {"login": "millems"}, "path": "metric-publishers/cloudwatch-metric-publisher/src/main/java/software/amazon/awssdk/metrics/publishers/cloudwatch/internal/transform/TimeBucketedMetrics.java", "diffHunk": "@@ -0,0 +1,226 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.metrics.publishers.cloudwatch.internal.transform;\n+\n+import static java.time.temporal.ChronoUnit.MINUTES;\n+\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Comparator;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import software.amazon.awssdk.annotations.SdkInternalApi;\n+import software.amazon.awssdk.metrics.MetricCategory;\n+import software.amazon.awssdk.metrics.MetricCollection;\n+import software.amazon.awssdk.metrics.MetricLevel;\n+import software.amazon.awssdk.metrics.MetricRecord;\n+import software.amazon.awssdk.metrics.SdkMetric;\n+import software.amazon.awssdk.services.cloudwatch.model.Dimension;\n+import software.amazon.awssdk.services.cloudwatch.model.StandardUnit;\n+\n+/**\n+ * \"Buckets\" metrics by the minute in which they were collected. This allows all metric data for a given 1-minute period to be\n+ * aggregated under a specific {@link MetricAggregator}.\n+ */\n+@SdkInternalApi\n+class TimeBucketedMetrics {\n+    /**\n+     * A map from \"the minute during which a metric value happened\" to \"the dimension and metric associated with the metric\n+     * values\" to \"the aggregator for the metric values that occurred within that minute and for that dimension/metric\".\n+     */\n+    private final Map<Instant, Map<MetricAggregatorKey, MetricAggregator>> timeBucketedMetrics = new HashMap<>();\n+\n+    /**\n+     * The dimensions that should be used for aggregating metrics that occur within a given minute. These are optional values.\n+     * The dimensions will be used if a {@link MetricCollection} includes them, but if it does not, it will be aggregated with\n+     * whatever dimensions (if any) are available.\n+     */\n+    private final Set<SdkMetric<String>> dimensions;\n+\n+    /**\n+     * The set of metrics for which {@link DetailedMetricAggregator}s should be used for aggregation. All other metrics will use\n+     * a {@link SummaryMetricAggregator}.\n+     */\n+    private final Set<SdkMetric<?>> detailedMetrics;\n+\n+    /**\n+     * The metric categories for which we should aggregate values. Any categories outside of this set will have their values\n+     * ignored/dropped.\n+     */\n+    private final Set<MetricCategory> metricCategories;\n+\n+    /**\n+     * The metric levels for which we should aggregate values. Any categories at a more \"verbose\" level than this one will have\n+     * their values ignored/dropped.\n+     */\n+    private final MetricLevel metricLevel;\n+\n+    /**\n+     * True, when the {@link #metricCategories} contains {@link MetricCategory#ALL}.\n+     */\n+    private final boolean metricCategoriesContainsAll;\n+\n+\n+\n+    TimeBucketedMetrics(Set<SdkMetric<String>> dimensions,\n+                        Set<MetricCategory> metricCategories,\n+                        MetricLevel metricLevel,\n+                        Set<SdkMetric<?>> detailedMetrics) {\n+        this.dimensions = dimensions;\n+        this.detailedMetrics = detailedMetrics;\n+        this.metricCategories = metricCategories;\n+        this.metricLevel = metricLevel;\n+        this.metricCategoriesContainsAll = metricCategories.contains(MetricCategory.ALL);\n+    }\n+\n+    /**\n+     * Add the provided collection to the proper bucket, based on the metric collection's time.\n+     */\n+    public void addMetrics(MetricCollection metrics) {\n+        Instant bucket = getBucket(metrics);\n+        addMetricsToBucket(metrics, bucket);\n+    }\n+\n+    /**\n+     * Reset this bucket, clearing all stored values.\n+     */\n+    public void reset() {\n+        timeBucketedMetrics.clear();\n+    }\n+\n+    /**\n+     * Retrieve all values in this collection. The map key is the minute in which the metric values were collected, and the\n+     * map value are all of the metrics that were aggregated during that minute.\n+     */\n+    public Map<Instant, Collection<MetricAggregator>> timeBucketedMetrics() {\n+        return timeBucketedMetrics.entrySet()\n+                                  .stream()\n+                                  .collect(Collectors.toMap(e -> e.getKey(), e -> e.getValue().values()));\n+    }\n+\n+    private Instant getBucket(MetricCollection metrics) {\n+        return metrics.creationTime().truncatedTo(MINUTES);\n+    }\n+\n+    private void addMetricsToBucket(MetricCollection metrics, Instant bucketId) {\n+        aggregateMetrics(metrics, timeBucketedMetrics.computeIfAbsent(bucketId, i -> new HashMap<>()));\n+    }\n+\n+    private void aggregateMetrics(MetricCollection metrics, Map<MetricAggregatorKey, MetricAggregator> bucket) {\n+        List<Dimension> dimensions = dimensions(metrics);\n+        extractAllMetrics(metrics).forEach(metricRecord -> {\n+            MetricAggregatorKey aggregatorKey = new MetricAggregatorKey(metricRecord.metric(), dimensions);\n+            valueFor(metricRecord).ifPresent(metricValue -> {\n+                bucket.computeIfAbsent(aggregatorKey, m -> newAggregator(aggregatorKey))\n+                      .addMetricValue(MetricValueNormalizer.normalize(metricValue));\n+            });\n+        });\n+    }\n+\n+    private List<Dimension> dimensions(MetricCollection metricCollection) {\n+        List<Dimension> result = new ArrayList<>();\n+        for (MetricRecord<?> metricRecord : metricCollection) {\n+            if (dimensions.contains(metricRecord.metric())) {\n+                result.add(Dimension.builder()\n+                                    .name(metricRecord.metric().name())\n+                                    .value((String) metricRecord.value())\n+                                    .build());\n+            }\n+        }\n+\n+        // Sort the dimensions to make sure that the order in the input metric collection doesn't affect the result.\n+        // We use descending order just so that \"ServiceName\" is before \"OperationName\" when we use the default dimensions.\n+        result.sort(Comparator.comparing(Dimension::name).reversed());\n+        return result;\n+    }\n+\n+    private List<MetricRecord<?>> extractAllMetrics(MetricCollection metrics) {\n+        List<MetricRecord<?>> result = new ArrayList<>();\n+        extractAllMetrics(metrics, result);\n+        return result;\n+    }\n+\n+    private void extractAllMetrics(MetricCollection metrics, List<MetricRecord<?>> extractedMetrics) {\n+        for (MetricRecord<?> metric : metrics) {\n+            extractedMetrics.add(metric);\n+        }\n+        metrics.children().forEach(child -> extractAllMetrics(child, extractedMetrics));\n+    }\n+\n+    private MetricAggregator newAggregator(MetricAggregatorKey aggregatorKey) {\n+        SdkMetric<?> metric = aggregatorKey.metric();\n+        StandardUnit metricUnit = unitFor(metric);\n+        if (detailedMetrics.contains(metric)) {\n+            return new DetailedMetricAggregator(aggregatorKey, metricUnit);\n+        } else {\n+            return new SummaryMetricAggregator(aggregatorKey, metricUnit);\n+        }\n+    }\n+\n+    private StandardUnit unitFor(SdkMetric<?> metric) {\n+        Class<?> metricType = metric.valueClass();\n+\n+        if (Duration.class.isAssignableFrom(metricType)) {\n+            return StandardUnit.MILLISECONDS;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bac7d6f06bac3f985ded5a0c507143d8a84f4bd0"}, "originalPosition": 184}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyMDYwNTM2", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#pullrequestreview-442060536", "createdAt": "2020-07-02T22:55:46Z", "commit": {"oid": "14536e3fb8bec5462514f2107592b77c99a777d5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47da2eec26151650b968335e200f5896328035ce", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/47da2eec26151650b968335e200f5896328035ce", "committedDate": "2020-07-06T21:13:13Z", "message": "Merge remote-tracking branch 'origin/master' into sdk-metrics-preview"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9faee7d440bf49c1dff8a3f0872a70e0eb47b672", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9faee7d440bf49c1dff8a3f0872a70e0eb47b672", "committedDate": "2020-07-06T22:19:57Z", "message": "Update versions to match latest SNAPSHOT in master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "843adfc95201f0baa3a4524cb0793acb9fdcff1d", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/843adfc95201f0baa3a4524cb0793acb9fdcff1d", "committedDate": "2020-07-06T22:54:25Z", "message": "Add announcement blog post"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNDYyNDIz", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1938#pullrequestreview-443462423", "createdAt": "2020-07-06T23:12:37Z", "commit": {"oid": "843adfc95201f0baa3a4524cb0793acb9fdcff1d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2414, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}