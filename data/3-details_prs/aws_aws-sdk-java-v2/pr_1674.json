{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxMTE2NDE3", "number": 1674, "title": "DynamoDb Enhanced Client : changed the way extensions are loaded, loa\u2026", "bodyText": "\u2026ds VersionedRecordExtension by default\nMotivation and Context\nMany customers are going to want to use versioned records, and for those that don't if they don't tag any attributes on their table as 'version attributes' the extension will not get in the way so it made sense to load it by default.\nWe are leaving the door open in the future to provide meta-extensions that can do intelligent ordering of multiple extensions if such a thing is possible, but for now the order must be specified manually.\nRelates to #35\nTesting\nUnit tests\nLicense\n\n\n\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-02-27T23:01:36Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1674", "merged": true, "mergeCommit": {"oid": "38f54b23dd9c4c4409ea57ca481b5ef3f126dc73"}, "closed": true, "closedAt": "2020-02-28T01:08:29Z", "author": {"login": "bmaizels"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIj4IkABqjMwNzk4ODQwMzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIlJFOgBqjMwODAwNTM1NTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f4e5b3217811311bf04f48be2f7214f64e11a8a", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/3f4e5b3217811311bf04f48be2f7214f64e11a8a", "committedDate": "2020-02-27T22:56:33Z", "message": "DynamoDb Enhanced Client : changed the way extensions are loaded, loads VersionedRecordExtension by default"}, "afterCommit": {"oid": "dc597034630628c1d1fc55d52bdc3e1a98d3a32f", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/dc597034630628c1d1fc55d52bdc3e1a98d3a32f", "committedDate": "2020-02-27T23:24:54Z", "message": "DynamoDb Enhanced Client : changed the way extensions are loaded, loads VersionedRecordExtension by default"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MDgyMDY5", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1674#pullrequestreview-366082069", "createdAt": "2020-02-27T23:57:38Z", "commit": {"oid": "dc597034630628c1d1fc55d52bdc3e1a98d3a32f"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMzo1NzozOFrOFvlUCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwMDowNzowNVrOFvlfHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQzODcyOA==", "bodyText": "Should we move the common apis to an interface that both async client builder and sync client builder extend? It's easier to maintain that way, to me, eg: If we ever need to update javadocs, we can just update one place in stead of two.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1674#discussion_r385438728", "createdAt": "2020-02-27T23:57:38Z", "author": {"login": "zoewangg"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/enhanced/dynamodb/DynamoDbEnhancedAsyncClient.java", "diffHunk": "@@ -91,10 +91,38 @@\n      * The builder definition for a {@link DynamoDbEnhancedAsyncClient}.\n      */\n     interface Builder {\n-        Builder dynamoDbClient(DynamoDbAsyncClient dynamoDbAsyncClient);\n-\n-        Builder extendWith(DynamoDbEnhancedClientExtension dynamoDbEnhancedClientExtension);\n-\n+        /**\n+         * The regular low-level SDK client to use with the enhanced client.\n+         * @param dynamoDbClient an initialized {@link DynamoDbAsyncClient}\n+         */\n+        Builder dynamoDbClient(DynamoDbAsyncClient dynamoDbClient);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc597034630628c1d1fc55d52bdc3e1a98d3a32f"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQzOTc4OQ==", "bodyText": "unmodifiable list?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1674#discussion_r385439789", "createdAt": "2020-02-28T00:01:04Z", "author": {"login": "zoewangg"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/enhanced/dynamodb/internal/client/ExtensionResolver.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.enhanced.dynamodb.internal.client;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import software.amazon.awssdk.annotations.SdkInternalApi;\n+import software.amazon.awssdk.enhanced.dynamodb.DynamoDbEnhancedClientExtension;\n+import software.amazon.awssdk.enhanced.dynamodb.extensions.VersionedRecordExtension;\n+import software.amazon.awssdk.enhanced.dynamodb.internal.extensions.ChainExtension;\n+\n+/**\n+ * Static module to assist with the initialization of an extension for a DynamoDB Enhanced Client based on supplied\n+ * configuration.\n+ */\n+@SdkInternalApi\n+public final class ExtensionResolver {\n+    private static final DynamoDbEnhancedClientExtension DEFAULT_VERSIONED_RECORD_EXTENSION =\n+        VersionedRecordExtension.builder().build();\n+    private static final List<DynamoDbEnhancedClientExtension> DEFAULT_EXTENSIONS =\n+        Collections.singletonList(DEFAULT_VERSIONED_RECORD_EXTENSION);\n+\n+    private ExtensionResolver() {\n+    }\n+\n+    /**\n+     * Static provider for the default extensions that are bundled with the DynamoDB Enhanced Client. Currently this is\n+     * just the {@link software.amazon.awssdk.enhanced.dynamodb.extensions.VersionedRecordExtension}.\n+     *\n+     * These extensions will be used by default unless overridden in the enhanced client builder.\n+     */\n+    public static List<DynamoDbEnhancedClientExtension> defaultExtensions() {\n+        return DEFAULT_EXTENSIONS;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc597034630628c1d1fc55d52bdc3e1a98d3a32f"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ0MTU2Nw==", "bodyText": "Where do we do null check for DynamoDbEnhancedClientExtension?\nShould we use Optional?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1674#discussion_r385441567", "createdAt": "2020-02-28T00:07:05Z", "author": {"login": "zoewangg"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/enhanced/dynamodb/internal/client/ExtensionResolver.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.enhanced.dynamodb.internal.client;\n+\n+import java.util.Collections;\n+import java.util.List;\n+\n+import software.amazon.awssdk.annotations.SdkInternalApi;\n+import software.amazon.awssdk.enhanced.dynamodb.DynamoDbEnhancedClientExtension;\n+import software.amazon.awssdk.enhanced.dynamodb.extensions.VersionedRecordExtension;\n+import software.amazon.awssdk.enhanced.dynamodb.internal.extensions.ChainExtension;\n+\n+/**\n+ * Static module to assist with the initialization of an extension for a DynamoDB Enhanced Client based on supplied\n+ * configuration.\n+ */\n+@SdkInternalApi\n+public final class ExtensionResolver {\n+    private static final DynamoDbEnhancedClientExtension DEFAULT_VERSIONED_RECORD_EXTENSION =\n+        VersionedRecordExtension.builder().build();\n+    private static final List<DynamoDbEnhancedClientExtension> DEFAULT_EXTENSIONS =\n+        Collections.singletonList(DEFAULT_VERSIONED_RECORD_EXTENSION);\n+\n+    private ExtensionResolver() {\n+    }\n+\n+    /**\n+     * Static provider for the default extensions that are bundled with the DynamoDB Enhanced Client. Currently this is\n+     * just the {@link software.amazon.awssdk.enhanced.dynamodb.extensions.VersionedRecordExtension}.\n+     *\n+     * These extensions will be used by default unless overridden in the enhanced client builder.\n+     */\n+    public static List<DynamoDbEnhancedClientExtension> defaultExtensions() {\n+        return DEFAULT_EXTENSIONS;\n+    }\n+\n+    /**\n+     * Resolves a list of extensions into a single extension. If the list is a singleton, will just return that extension\n+     * otherwise it will combine them with the {@link software.amazon.awssdk.enhanced.dynamodb.internal.extensions.ChainExtension}\n+     * meta-extension using the order provided in the list.\n+     *\n+     * @param extensions A list of extensions to be combined in strict order\n+     * @return A single extension that combines all the supplied extensions or null if no extensions were provided\n+     */\n+    public static DynamoDbEnhancedClientExtension resolveExtensions(List<DynamoDbEnhancedClientExtension> extensions) {\n+        if (extensions == null || extensions.isEmpty()) {\n+            return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc597034630628c1d1fc55d52bdc3e1a98d3a32f"}, "originalPosition": 60}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc597034630628c1d1fc55d52bdc3e1a98d3a32f", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/dc597034630628c1d1fc55d52bdc3e1a98d3a32f", "committedDate": "2020-02-27T23:24:54Z", "message": "DynamoDb Enhanced Client : changed the way extensions are loaded, loads VersionedRecordExtension by default"}, "afterCommit": {"oid": "b180825acf704e5b4580f87c41694584ede2ff25", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/b180825acf704e5b4580f87c41694584ede2ff25", "committedDate": "2020-02-28T00:47:38Z", "message": "DynamoDb Enhanced Client : changed the way extensions are loaded, loads VersionedRecordExtension by default"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MDk5NTk5", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1674#pullrequestreview-366099599", "createdAt": "2020-02-28T00:51:06Z", "commit": {"oid": "b180825acf704e5b4580f87c41694584ede2ff25"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwMDo1MTowNlrOFvmPfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwMDo1MTowNlrOFvmPfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ1Mzk1MA==", "bodyText": "nit: {@inheritDoc} is not necessay. @Override automatically renders the inherited doc.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1674#discussion_r385453950", "createdAt": "2020-02-28T00:51:06Z", "author": {"login": "zoewangg"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/enhanced/dynamodb/DynamoDbEnhancedClient.java", "diffHunk": "@@ -88,11 +88,29 @@ static Builder builder() {\n     /**\n      * The builder definition for a {@link DynamoDbEnhancedClient}.\n      */\n-    interface Builder {\n+    interface Builder extends DynamoDbEnhancedResource.Builder {\n+        /**\n+         * The regular low-level SDK client to use with the enhanced client.\n+         * @param dynamoDbClient an initialized {@link DynamoDbClient}\n+         */\n         Builder dynamoDbClient(DynamoDbClient dynamoDbClient);\n \n-        Builder extendWith(DynamoDbEnhancedClientExtension dynamoDbEnhancedClientExtension);\n-\n+        /**\n+         * {@inheritDoc}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b180825acf704e5b4580f87c41694584ede2ff25"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb12003687b7550107903b69b88a50566f7b8d5e", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/fb12003687b7550107903b69b88a50566f7b8d5e", "committedDate": "2020-02-28T00:53:40Z", "message": "DynamoDb Enhanced Client : changed the way extensions are loaded, loads VersionedRecordExtension by default"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b180825acf704e5b4580f87c41694584ede2ff25", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/b180825acf704e5b4580f87c41694584ede2ff25", "committedDate": "2020-02-28T00:47:38Z", "message": "DynamoDb Enhanced Client : changed the way extensions are loaded, loads VersionedRecordExtension by default"}, "afterCommit": {"oid": "fb12003687b7550107903b69b88a50566f7b8d5e", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/fb12003687b7550107903b69b88a50566f7b8d5e", "committedDate": "2020-02-28T00:53:40Z", "message": "DynamoDb Enhanced Client : changed the way extensions are loaded, loads VersionedRecordExtension by default"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2702, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}