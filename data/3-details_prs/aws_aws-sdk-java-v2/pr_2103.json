{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2OTcyMDMx", "number": 2103, "title": "Subclass events to do visitor dispatch", "bodyText": "Description\nGenerate events as discrete subclasses of the base shape class that take care\ndispatching to the correct visitor method.\nMotivation and Context\nFix event stream generation to support multiple events of the same shape.\nTesting\nNew unit tests.\nScreenshots (if appropriate)\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n\n\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-10-20T17:20:06Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103", "merged": true, "mergeCommit": {"oid": "d50b76b8fc2a1ff0ba1239611a7e4deb7085dca0"}, "closed": true, "closedAt": "2020-10-24T00:44:16Z", "author": {"login": "dagnir"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUcUvZgFqTUxMjk3NjQ0MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVfpVZgBqjM5MTYwOTg2MzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyOTc2NDQx", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#pullrequestreview-512976441", "createdAt": "2020-10-20T17:35:43Z", "commit": {"oid": "7e254a8fe1d4ca0820721ea04f80615ca87d6027"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzozNTo0M1rOHlJefg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzozNTo0M1rOHlJefg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODcxNDYyMg==", "bodyText": "Uhhh I need to fix this!", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#discussion_r508714622", "createdAt": "2020-10-20T17:35:43Z", "author": {"login": "dagnir"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/eventone.java", "diffHunk": "@@ -164,7 +164,7 @@ public final void setFoo(String foo) {\n \n         @Override\n         public EventOne build() {\n-            return new EventOne(this);\n+            throw new UnsupportedOperationException();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e254a8fe1d4ca0820721ea04f80615ca87d6027"}, "originalPosition": 85}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e254a8fe1d4ca0820721ea04f80615ca87d6027", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/7e254a8fe1d4ca0820721ea04f80615ca87d6027", "committedDate": "2020-10-20T17:18:33Z", "message": "Subclass events to do visitor dispatch\n\nGenerate events as discrete subclasses of the base shape class that take care\ndispatching to the correct visitor method."}, "afterCommit": {"oid": "aac901003e65a7fff437cb0bf172394729c2c26b", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/aac901003e65a7fff437cb0bf172394729c2c26b", "committedDate": "2020-10-20T21:17:10Z", "message": "Subclass events to do visitor dispatch\n\nGenerate events as discrete subclasses of the base shape class that take care\ndispatching to the correct visitor method."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "71decb4d674631f7a9fc8147118d3a8638df5bdd", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/71decb4d674631f7a9fc8147118d3a8638df5bdd", "committedDate": "2020-10-21T21:43:43Z", "message": "fixup! Subclass events to do visitor dispatch"}, "afterCommit": {"oid": "35ddb8c51ed55a344872d9d6fb420f4fb5554130", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/35ddb8c51ed55a344872d9d6fb420f4fb5554130", "committedDate": "2020-10-21T22:34:31Z", "message": "Add customization for Transcribe AudioStream"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b903b8e036c69fe2541faf040ae0f773eb4c6b8b", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/b903b8e036c69fe2541faf040ae0f773eb4c6b8b", "committedDate": "2020-10-22T20:58:12Z", "message": "Add builder methods to eventstream interface"}, "afterCommit": {"oid": "ebd81f79382e44a9449c170494378546b49797e6", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/ebd81f79382e44a9449c170494378546b49797e6", "committedDate": "2020-10-22T23:29:28Z", "message": "Add builder methods to eventstream interface"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1ODYyMDQ4", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#pullrequestreview-515862048", "createdAt": "2020-10-23T17:19:50Z", "commit": {"oid": "ebd81f79382e44a9449c170494378546b49797e6"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNzoxOTo1MFrOHnWsug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxNzoyNToxN1rOHnW3yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAyODQxMA==", "bodyText": "Can we add sdk internal api annotation and javadocs?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#discussion_r511028410", "createdAt": "2020-10-23T17:19:50Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/eventone.java", "diffHunk": "@@ -21,24 +21,24 @@\n /**\n  */\n @Generated(\"software.amazon.awssdk:codegen\")\n-public final class EventOne implements SdkPojo, Serializable, ToCopyableBuilder<EventOne.Builder, EventOne>, EventStream {\n+public class EventOne implements SdkPojo, Serializable, ToCopyableBuilder<EventOne.Builder, EventOne>, EventStream {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebd81f79382e44a9449c170494378546b49797e6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTAzMTI0Mg==", "bodyText": "Hmm, not a big fan of the underscore in the end. Can we use something else? Or rename the base class to BaseEventOne?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#discussion_r511031242", "createdAt": "2020-10-23T17:25:17Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/eventone_.java", "diffHunk": "@@ -0,0 +1,55 @@\n+package software.amazon.awssdk.services.jsonprotocoltests.model.eventstream;\n+\n+import software.amazon.awssdk.annotations.Generated;\n+import software.amazon.awssdk.annotations.SdkInternalApi;\n+import software.amazon.awssdk.services.jsonprotocoltests.model.EventOne;\n+import software.amazon.awssdk.services.jsonprotocoltests.model.EventStreamOperationResponseHandler;\n+\n+/**\n+ * A specialization of {@code software.amazon.awssdk.services.jsonprotocoltests.model.EventOne} that represents the\n+ * {@code EventStream#EventOne} event. Do not use this class directly. Instead, use the static builder methods on\n+ * {@link software.amazon.awssdk.services.jsonprotocoltests.model.EventStream}.\n+ */\n+@SdkInternalApi\n+@Generated(\"software.amazon.awssdk:codegen\")\n+public final class EventOne_ extends EventOne {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebd81f79382e44a9449c170494378546b49797e6"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1OTIwMDM1", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#pullrequestreview-515920035", "createdAt": "2020-10-23T18:40:06Z", "commit": {"oid": "ebd81f79382e44a9449c170494378546b49797e6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxODo0MDowNlrOHnZg9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxODo0MDowNlrOHnZg9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTA3NDU0OQ==", "bodyText": "Can we mark all methods that are not intended to be overridden final?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#discussion_r511074549", "createdAt": "2020-10-23T18:40:06Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/eventone.java", "diffHunk": "@@ -21,24 +21,24 @@\n /**\n  */\n @Generated(\"software.amazon.awssdk:codegen\")\n-public final class EventOne implements SdkPojo, Serializable, ToCopyableBuilder<EventOne.Builder, EventOne>, EventStream {\n+public class EventOne implements SdkPojo, Serializable, ToCopyableBuilder<EventOne.Builder, EventOne>, EventStream {\n     private static final SdkField<String> FOO_FIELD = SdkField.<String> builder(MarshallingType.STRING).memberName(\"Foo\")\n-                                                                                                       .getter(getter(EventOne::foo)).setter(setter(Builder::foo))\n-                                                                                                       .traits(LocationTrait.builder().location(MarshallLocation.PAYLOAD).locationName(\"Foo\").build()).build();\n+            .getter(getter(EventOne::foo)).setter(setter(Builder::foo))\n+            .traits(LocationTrait.builder().location(MarshallLocation.PAYLOAD).locationName(\"Foo\").build()).build();\n \n     private static final List<SdkField<?>> SDK_FIELDS = Collections.unmodifiableList(Arrays.asList(FOO_FIELD));\n \n     private static final long serialVersionUID = 1L;\n \n     private final String foo;\n \n-    private EventOne(BuilderImpl builder) {\n+    protected EventOne(BuilderImpl builder) {\n         this.foo = builder.foo;\n     }\n \n     /**\n      * Returns the value of the Foo property for this object.\n-     *\n+     * \n      * @return The value of the Foo property for this object.\n      */\n     public String foo() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebd81f79382e44a9449c170494378546b49797e6"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9cc7479abfb6a8c8c688ddcd88eef7ebe8ff92e2", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9cc7479abfb6a8c8c688ddcd88eef7ebe8ff92e2", "committedDate": "2020-10-23T21:25:16Z", "message": "Use \"Default\" prefix for event classes"}, "afterCommit": {"oid": "0fe44d556e0a7b97795cc144683078666948f680", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/0fe44d556e0a7b97795cc144683078666948f680", "committedDate": "2020-10-23T21:36:05Z", "message": "Use \"Default\" prefix for event classes"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0fe44d556e0a7b97795cc144683078666948f680", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/0fe44d556e0a7b97795cc144683078666948f680", "committedDate": "2020-10-23T21:36:05Z", "message": "Use \"Default\" prefix for event classes"}, "afterCommit": {"oid": "8906af94f1227762d8fad05c03b99fc9113d9b64", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/8906af94f1227762d8fad05c03b99fc9113d9b64", "committedDate": "2020-10-23T22:09:35Z", "message": "Use \"Default\" prefix for event classes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2MDM4MTkw", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#pullrequestreview-516038190", "createdAt": "2020-10-23T22:13:44Z", "commit": {"oid": "0fe44d556e0a7b97795cc144683078666948f680"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMjoxNDoxOVrOHnf1Hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QyMjoxNDoxOVrOHnf1Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE3ODAxNA==", "bodyText": "It'd nice if we can only add final to non-final model classes, but I guess it's not trivial to do so with the current implementation of the model codegen class spec.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2103#discussion_r511178014", "createdAt": "2020-10-23T22:14:19Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/alltypesrequest.java", "diffHunk": "@@ -495,63 +495,63 @@ private AllTypesRequest(BuilderImpl builder) {\n \n     /**\n      * Returns the value of the StringMember property for this object.\n-     *\n+     * \n      * @return The value of the StringMember property for this object.\n      */\n-    public String stringMember() {\n+    public final String stringMember() {\n         return stringMember;\n     }\n \n     /**\n      * Returns the value of the IntegerMember property for this object.\n-     *\n+     * \n      * @return The value of the IntegerMember property for this object.\n      */\n-    public Integer integerMember() {\n+    public final Integer integerMember() {\n         return integerMember;\n     }\n \n     /**\n      * Returns the value of the BooleanMember property for this object.\n-     *\n+     * \n      * @return The value of the BooleanMember property for this object.\n      */\n-    public Boolean booleanMember() {\n+    public final Boolean booleanMember() {\n         return booleanMember;\n     }\n \n     /**\n      * Returns the value of the FloatMember property for this object.\n-     *\n+     * \n      * @return The value of the FloatMember property for this object.\n      */\n-    public Float floatMember() {\n+    public final Float floatMember() {\n         return floatMember;\n     }\n \n     /**\n      * Returns the value of the DoubleMember property for this object.\n-     *\n+     * \n      * @return The value of the DoubleMember property for this object.\n      */\n-    public Double doubleMember() {\n+    public final Double doubleMember() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8906af94f1227762d8fad05c03b99fc9113d9b64"}, "originalPosition": 719}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7023f9e0a6d563b9fe6752d46d897dc0c1c86d94", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/7023f9e0a6d563b9fe6752d46d897dc0c1c86d94", "committedDate": "2020-10-23T23:59:27Z", "message": "Subclass events to do visitor dispatch\n\nGenerate events as discrete subclasses of the base shape class that take care\ndispatching to the correct visitor method. The base shape is what we would\ngenerate as a normal model class for a non request/response shape today.\nHowever, because they need to be extended, they are no longer final; insteach\nany method that can be made final (such as property getters) is made final.\n\nThis commit also generates static builder methods on the event stream interface\nto make discovery and creation of events easier."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8906af94f1227762d8fad05c03b99fc9113d9b64", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/8906af94f1227762d8fad05c03b99fc9113d9b64", "committedDate": "2020-10-23T22:09:35Z", "message": "Use \"Default\" prefix for event classes"}, "afterCommit": {"oid": "7023f9e0a6d563b9fe6752d46d897dc0c1c86d94", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/7023f9e0a6d563b9fe6752d46d897dc0c1c86d94", "committedDate": "2020-10-23T23:59:27Z", "message": "Subclass events to do visitor dispatch\n\nGenerate events as discrete subclasses of the base shape class that take care\ndispatching to the correct visitor method. The base shape is what we would\ngenerate as a normal model class for a non request/response shape today.\nHowever, because they need to be extended, they are no longer final; insteach\nany method that can be made final (such as property getters) is made final.\n\nThis commit also generates static builder methods on the event stream interface\nto make discovery and creation of events easier."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2371, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}