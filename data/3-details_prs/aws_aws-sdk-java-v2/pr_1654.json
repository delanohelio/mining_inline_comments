{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2MzExNjk3", "number": 1654, "title": "Dynamodb-enhanced [preview]: Updates all operations with consumer sty\u2026", "bodyText": "\u2026le invocations\nDescription\nAdds a second method to the client/table/index interfaces for all operations, that take builder consumers as input. This allows invocations in the following style:\ncustomerTable.getItem(r -> r.key(key));\nMotivation and Context\nImproves discoverability for the enhanced client by adding consumer-style methods for all client, table and index operations.\nTesting\nTested with mvn clean install\nScreenshots (if appropriate)\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n\n\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-02-17T20:57:45Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654", "merged": true, "mergeCommit": {"oid": "61a3e74d64d52d8d6d2def14b9ac94e39063b391"}, "closed": true, "closedAt": "2020-02-21T16:01:22Z", "author": {"login": "cenedhryn"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFn9z_gFqTM2MDYyNDg4MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGhXXagH2gAyMzc2MzExNjk3OjliMDdmNjAzMDVjNTNkNTA4ZWY3ZTUwMzRhNjU0NTFkNzNjOTQ5OGE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNjI0ODgw", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#pullrequestreview-360624880", "createdAt": "2020-02-18T19:48:46Z", "commit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "state": "COMMENTED", "comments": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOTo0ODo0NlrOFrQGxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQyMDoyNzozMVrOFrRSjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg5Njk2NA==", "bodyText": "This looks like a good candidate for a utils class, and can be re-used in other classes that do a similar thing.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380896964", "createdAt": "2020-02-18T19:48:46Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/BatchGetItemEnhancedRequest.java", "diffHunk": "@@ -66,14 +62,18 @@ public int hashCode() {\n         return readBatches != null ? readBatches.hashCode() : 0;\n     }\n \n+    private static List<ReadBatch> getListIfExist(List<ReadBatch> readBatches) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg5Nzc4OA==", "bodyText": "Should this be generic and in utils?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380897788", "createdAt": "2020-02-18T19:50:04Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/BatchWriteItemEnhancedRequest.java", "diffHunk": "@@ -66,14 +62,18 @@ public int hashCode() {\n         return writeBatches != null ? writeBatches.hashCode() : 0;\n     }\n \n+    private static List<WriteBatch> getListIfExist(List<WriteBatch> writeBatches) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMDgwNA==", "bodyText": "Could we make this generic and put it in utils?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380900804", "createdAt": "2020-02-18T19:55:49Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/TransactGetItemsEnhancedRequest.java", "diffHunk": "@@ -65,17 +64,34 @@ public int hashCode() {\n         return transactGetItems != null ? transactGetItems.hashCode() : 0;\n     }\n \n+    private List<TransactGetItem> getListIfExist(List<Supplier<TransactGetItem>> itemSupplierList) {\n+        if (itemSupplierList == null || itemSupplierList.isEmpty()) {\n+            return null;\n+        }\n+        return Collections.unmodifiableList(itemSupplierList.stream()\n+                                                            .map(Supplier::get)\n+                                                            .collect(Collectors.toList()));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMTAwNQ==", "bodyText": "I think our pattern is to have this call the other overloaded implementation of addGetItem rather than duplicate the code here.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380901005", "createdAt": "2020-02-18T19:56:14Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/TransactGetItemsEnhancedRequest.java", "diffHunk": "@@ -65,17 +64,34 @@ public int hashCode() {\n         return transactGetItems != null ? transactGetItems.hashCode() : 0;\n     }\n \n+    private List<TransactGetItem> getListIfExist(List<Supplier<TransactGetItem>> itemSupplierList) {\n+        if (itemSupplierList == null || itemSupplierList.isEmpty()) {\n+            return null;\n+        }\n+        return Collections.unmodifiableList(itemSupplierList.stream()\n+                                                            .map(Supplier::get)\n+                                                            .collect(Collectors.toList()));\n+    }\n+\n     public static final class Builder {\n         private List<Supplier<TransactGetItem>> itemSupplierList = new ArrayList<>();\n \n         private Builder() {\n         }\n \n-        public <T> Builder addGetItem(MappedTableResource<T> mappedTableResource, GetItemEnhancedRequest<T> request) {\n+        public <T> Builder addGetItem(MappedTableResource<T> mappedTableResource, GetItemEnhancedRequest request) {\n             itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, GetItemOperation.create(request)));\n             return this;\n         }\n \n+        public <T> Builder addGetItem(MappedTableResource<T> mappedTableResource,\n+                                      Consumer<GetItemEnhancedRequest.Builder> requestConsumer) {\n+            GetItemEnhancedRequest.Builder builder = GetItemEnhancedRequest.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, GetItemOperation.create(builder.build())));\n+            return this;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMTQxOQ==", "bodyText": "Could we generify and put in utils?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380901419", "createdAt": "2020-02-18T19:57:02Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/TransactWriteItemsEnhancedRequest.java", "diffHunk": "@@ -67,6 +66,15 @@ public int hashCode() {\n         return transactWriteItems != null ? transactWriteItems.hashCode() : 0;\n     }\n \n+    private List<TransactWriteItem> getListIfExist(List<Supplier<TransactWriteItem>> itemSupplierList) {\n+        if (itemSupplierList == null || itemSupplierList.isEmpty()) {\n+            return null;\n+        }\n+        return Collections.unmodifiableList(itemSupplierList.stream()\n+                                                            .map(Supplier::get)\n+                                                            .collect(Collectors.toList()));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMTY5Mg==", "bodyText": "Could we call the other overloaded method and not duplicate code here", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380901692", "createdAt": "2020-02-18T19:57:34Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/TransactWriteItemsEnhancedRequest.java", "diffHunk": "@@ -78,21 +86,55 @@ private Builder() {\n             return this;\n         }\n \n-        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource, DeleteItemEnhancedRequest<T> request) {\n+        public <T> Builder addConditionCheck(MappedTableResource<T> mappedTableResource,\n+                                             Consumer<ConditionCheck.Builder> requestConsumer) {\n+            ConditionCheck.Builder builder = ConditionCheck.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, builder.build()));\n+            return this;\n+        }\n+\n+        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource, DeleteItemEnhancedRequest request) {\n             itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, DeleteItemOperation.create(request)));\n             return this;\n         }\n \n+        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource,\n+                                      Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer) {\n+            DeleteItemEnhancedRequest.Builder builder = DeleteItemEnhancedRequest.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource,\n+                                                                 DeleteItemOperation.create(builder.build())));\n+            return this;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMTg1NQ==", "bodyText": "Could we call the other overloaded method and not duplicate code here", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380901855", "createdAt": "2020-02-18T19:57:51Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/TransactWriteItemsEnhancedRequest.java", "diffHunk": "@@ -78,21 +86,55 @@ private Builder() {\n             return this;\n         }\n \n-        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource, DeleteItemEnhancedRequest<T> request) {\n+        public <T> Builder addConditionCheck(MappedTableResource<T> mappedTableResource,\n+                                             Consumer<ConditionCheck.Builder> requestConsumer) {\n+            ConditionCheck.Builder builder = ConditionCheck.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, builder.build()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMjAwMA==", "bodyText": "Could we call the other overloaded method and not duplicate code here", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380902000", "createdAt": "2020-02-18T19:58:04Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/TransactWriteItemsEnhancedRequest.java", "diffHunk": "@@ -78,21 +86,55 @@ private Builder() {\n             return this;\n         }\n \n-        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource, DeleteItemEnhancedRequest<T> request) {\n+        public <T> Builder addConditionCheck(MappedTableResource<T> mappedTableResource,\n+                                             Consumer<ConditionCheck.Builder> requestConsumer) {\n+            ConditionCheck.Builder builder = ConditionCheck.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, builder.build()));\n+            return this;\n+        }\n+\n+        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource, DeleteItemEnhancedRequest request) {\n             itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, DeleteItemOperation.create(request)));\n             return this;\n         }\n \n+        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource,\n+                                      Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer) {\n+            DeleteItemEnhancedRequest.Builder builder = DeleteItemEnhancedRequest.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource,\n+                                                                 DeleteItemOperation.create(builder.build())));\n+            return this;\n+        }\n+\n         public <T> Builder addPutItem(MappedTableResource<T> mappedTableResource, PutItemEnhancedRequest<T> request) {\n             itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, PutItemOperation.create(request)));\n             return this;\n         }\n \n+        public <T> Builder addPutItem(MappedTableResource<T> mappedTableResource, Class<? extends T> itemClass,\n+                                      Consumer<PutItemEnhancedRequest.Builder<T>> requestConsumer) {\n+            PutItemEnhancedRequest.Builder<T> builder = PutItemEnhancedRequest.builder(itemClass);\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, PutItemOperation.create(builder.build())));\n+            return this;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMjEwMw==", "bodyText": "Could we call the other overloaded method and not duplicate code here", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380902103", "createdAt": "2020-02-18T19:58:15Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/TransactWriteItemsEnhancedRequest.java", "diffHunk": "@@ -78,21 +86,55 @@ private Builder() {\n             return this;\n         }\n \n-        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource, DeleteItemEnhancedRequest<T> request) {\n+        public <T> Builder addConditionCheck(MappedTableResource<T> mappedTableResource,\n+                                             Consumer<ConditionCheck.Builder> requestConsumer) {\n+            ConditionCheck.Builder builder = ConditionCheck.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, builder.build()));\n+            return this;\n+        }\n+\n+        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource, DeleteItemEnhancedRequest request) {\n             itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, DeleteItemOperation.create(request)));\n             return this;\n         }\n \n+        public <T> Builder addDeleteItem(MappedTableResource<T> mappedTableResource,\n+                                      Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer) {\n+            DeleteItemEnhancedRequest.Builder builder = DeleteItemEnhancedRequest.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource,\n+                                                                 DeleteItemOperation.create(builder.build())));\n+            return this;\n+        }\n+\n         public <T> Builder addPutItem(MappedTableResource<T> mappedTableResource, PutItemEnhancedRequest<T> request) {\n             itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, PutItemOperation.create(request)));\n             return this;\n         }\n \n+        public <T> Builder addPutItem(MappedTableResource<T> mappedTableResource, Class<? extends T> itemClass,\n+                                      Consumer<PutItemEnhancedRequest.Builder<T>> requestConsumer) {\n+            PutItemEnhancedRequest.Builder<T> builder = PutItemEnhancedRequest.builder(itemClass);\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, PutItemOperation.create(builder.build())));\n+            return this;\n+        }\n+\n         public <T> Builder addUpdateItem(MappedTableResource<T> mappedTableResource, UpdateItemEnhancedRequest<T> request) {\n             itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource, UpdateItemOperation.create(request)));\n             return this;\n         }\n \n+        public <T> Builder addUpdateItem(MappedTableResource<T> mappedTableResource, Class<? extends T> itemClass,\n+                                         Consumer<UpdateItemEnhancedRequest.Builder<T>> requestConsumer) {\n+            UpdateItemEnhancedRequest.Builder<T> builder = UpdateItemEnhancedRequest.builder(itemClass);\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateTransactWriteItem(mappedTableResource,\n+                                                                 UpdateItemOperation.create(builder.build())));\n+            return this;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 86}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMjc3Ng==", "bodyText": "Can we generify and put in utils?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380902776", "createdAt": "2020-02-18T19:59:28Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/WriteBatch.java", "diffHunk": "@@ -82,36 +81,57 @@ public int hashCode() {\n     public interface Builder<T> {\n         Builder<T> mappedTableResource(MappedTableResource<T> mappedTableResource);\n \n-        Builder<T> addDeleteItem(DeleteItemEnhancedRequest<T> request);\n+        Builder<T> addDeleteItem(DeleteItemEnhancedRequest request);\n+\n+        Builder<T> addDeleteItem(Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer);\n \n         Builder<T> addPutItem(PutItemEnhancedRequest<T> request);\n \n+        Builder<T> addPutItem(Consumer<PutItemEnhancedRequest.Builder<T>> requestConsumer);\n+\n         WriteBatch build();\n     }\n \n     private static final class BuilderImpl<T> implements Builder<T> {\n \n+        private Class<? extends T> itemClass;\n         private List<Supplier<WriteRequest>> itemSupplierList = new ArrayList<>();\n         private MappedTableResource<T> mappedTableResource;\n \n-        private BuilderImpl() {\n+        private BuilderImpl(Class<? extends T> itemClass) {\n+            this.itemClass = itemClass;\n         }\n \n         public Builder<T> mappedTableResource(MappedTableResource<T> mappedTableResource) {\n             this.mappedTableResource = mappedTableResource;\n             return this;\n         }\n \n-        public Builder<T> addDeleteItem(DeleteItemEnhancedRequest<T> request) {\n+        public Builder<T> addDeleteItem(DeleteItemEnhancedRequest request) {\n             itemSupplierList.add(() -> generateWriteRequest(() -> mappedTableResource, DeleteItemOperation.create(request)));\n             return this;\n         }\n \n+        public Builder<T> addDeleteItem(Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer) {\n+            DeleteItemEnhancedRequest.Builder builder = DeleteItemEnhancedRequest.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateWriteRequest(() -> mappedTableResource,\n+                                                            DeleteItemOperation.create(builder.build())));\n+            return this;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMzAxMQ==", "bodyText": "Could we call the other overloaded method and not duplicate code here", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380903011", "createdAt": "2020-02-18T19:59:54Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/WriteBatch.java", "diffHunk": "@@ -82,36 +81,57 @@ public int hashCode() {\n     public interface Builder<T> {\n         Builder<T> mappedTableResource(MappedTableResource<T> mappedTableResource);\n \n-        Builder<T> addDeleteItem(DeleteItemEnhancedRequest<T> request);\n+        Builder<T> addDeleteItem(DeleteItemEnhancedRequest request);\n+\n+        Builder<T> addDeleteItem(Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer);\n \n         Builder<T> addPutItem(PutItemEnhancedRequest<T> request);\n \n+        Builder<T> addPutItem(Consumer<PutItemEnhancedRequest.Builder<T>> requestConsumer);\n+\n         WriteBatch build();\n     }\n \n     private static final class BuilderImpl<T> implements Builder<T> {\n \n+        private Class<? extends T> itemClass;\n         private List<Supplier<WriteRequest>> itemSupplierList = new ArrayList<>();\n         private MappedTableResource<T> mappedTableResource;\n \n-        private BuilderImpl() {\n+        private BuilderImpl(Class<? extends T> itemClass) {\n+            this.itemClass = itemClass;\n         }\n \n         public Builder<T> mappedTableResource(MappedTableResource<T> mappedTableResource) {\n             this.mappedTableResource = mappedTableResource;\n             return this;\n         }\n \n-        public Builder<T> addDeleteItem(DeleteItemEnhancedRequest<T> request) {\n+        public Builder<T> addDeleteItem(DeleteItemEnhancedRequest request) {\n             itemSupplierList.add(() -> generateWriteRequest(() -> mappedTableResource, DeleteItemOperation.create(request)));\n             return this;\n         }\n \n+        public Builder<T> addDeleteItem(Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer) {\n+            DeleteItemEnhancedRequest.Builder builder = DeleteItemEnhancedRequest.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateWriteRequest(() -> mappedTableResource,\n+                                                            DeleteItemOperation.create(builder.build())));\n+            return this;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMzEwOQ==", "bodyText": "Could we call the other overloaded method and not duplicate code here", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380903109", "createdAt": "2020-02-18T20:00:04Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/WriteBatch.java", "diffHunk": "@@ -82,36 +81,57 @@ public int hashCode() {\n     public interface Builder<T> {\n         Builder<T> mappedTableResource(MappedTableResource<T> mappedTableResource);\n \n-        Builder<T> addDeleteItem(DeleteItemEnhancedRequest<T> request);\n+        Builder<T> addDeleteItem(DeleteItemEnhancedRequest request);\n+\n+        Builder<T> addDeleteItem(Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer);\n \n         Builder<T> addPutItem(PutItemEnhancedRequest<T> request);\n \n+        Builder<T> addPutItem(Consumer<PutItemEnhancedRequest.Builder<T>> requestConsumer);\n+\n         WriteBatch build();\n     }\n \n     private static final class BuilderImpl<T> implements Builder<T> {\n \n+        private Class<? extends T> itemClass;\n         private List<Supplier<WriteRequest>> itemSupplierList = new ArrayList<>();\n         private MappedTableResource<T> mappedTableResource;\n \n-        private BuilderImpl() {\n+        private BuilderImpl(Class<? extends T> itemClass) {\n+            this.itemClass = itemClass;\n         }\n \n         public Builder<T> mappedTableResource(MappedTableResource<T> mappedTableResource) {\n             this.mappedTableResource = mappedTableResource;\n             return this;\n         }\n \n-        public Builder<T> addDeleteItem(DeleteItemEnhancedRequest<T> request) {\n+        public Builder<T> addDeleteItem(DeleteItemEnhancedRequest request) {\n             itemSupplierList.add(() -> generateWriteRequest(() -> mappedTableResource, DeleteItemOperation.create(request)));\n             return this;\n         }\n \n+        public Builder<T> addDeleteItem(Consumer<DeleteItemEnhancedRequest.Builder> requestConsumer) {\n+            DeleteItemEnhancedRequest.Builder builder = DeleteItemEnhancedRequest.builder();\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateWriteRequest(() -> mappedTableResource,\n+                                                            DeleteItemOperation.create(builder.build())));\n+            return this;\n+        }\n+\n         public Builder<T> addPutItem(PutItemEnhancedRequest<T> request) {\n             itemSupplierList.add(() -> generateWriteRequest(() -> mappedTableResource, PutItemOperation.create(request)));\n             return this;\n         }\n \n+        public Builder<T> addPutItem(Consumer<PutItemEnhancedRequest.Builder<T>> requestConsumer) {\n+            PutItemEnhancedRequest.Builder<T> builder = PutItemEnhancedRequest.builder(this.itemClass);\n+            requestConsumer.accept(builder);\n+            itemSupplierList.add(() -> generateWriteRequest(() -> mappedTableResource, PutItemOperation.create(builder.build())));\n+            return this;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwMzIyMQ==", "bodyText": "Can we generify and put in utils", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380903221", "createdAt": "2020-02-18T20:00:19Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/model/WriteBatch.java", "diffHunk": "@@ -123,4 +143,13 @@ private WriteRequest generateWriteRequest(Supplier<MappedTableResource<T>> mappe\n                                                   mappedTableResourceSupplier.get().mapperExtension());\n         }\n     }\n+\n+    private List<WriteRequest> getListIfExist(List<Supplier<WriteRequest>> itemSupplierList) {\n+        if (itemSupplierList == null || itemSupplierList.isEmpty()) {\n+            return null;\n+        }\n+        return Collections.unmodifiableList(itemSupplierList.stream()\n+                                                            .map(Supplier::get)\n+                                                            .collect(Collectors.toList()));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 99}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwNDU0MA==", "bodyText": "My IDE is showing this method as not having coverage.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380904540", "createdAt": "2020-02-18T20:02:29Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/DynamoDbEnhancedAsyncClient.java", "diffHunk": "@@ -49,18 +50,35 @@\n         throw new UnsupportedOperationException();\n     }\n \n+    default SdkPublisher<BatchGetResultPage> batchGetItem(Consumer<BatchGetItemEnhancedRequest.Builder> requestConsumer) {\n+        throw new UnsupportedOperationException();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwNDYwOA==", "bodyText": "My IDE is showing this method as not having coverage.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380904608", "createdAt": "2020-02-18T20:02:37Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/DynamoDbEnhancedAsyncClient.java", "diffHunk": "@@ -49,18 +50,35 @@\n         throw new UnsupportedOperationException();\n     }\n \n+    default SdkPublisher<BatchGetResultPage> batchGetItem(Consumer<BatchGetItemEnhancedRequest.Builder> requestConsumer) {\n+        throw new UnsupportedOperationException();\n+    }\n+\n     default CompletableFuture<BatchWriteResult> batchWriteItem(BatchWriteItemEnhancedRequest request) {\n         throw new UnsupportedOperationException();\n     }\n \n+    default CompletableFuture<BatchWriteResult> batchWriteItem(Consumer<BatchWriteItemEnhancedRequest.Builder> requestConsumer) {\n+        throw new UnsupportedOperationException();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwNDkzNA==", "bodyText": "My IDE is showing this method as not having coverage.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380904934", "createdAt": "2020-02-18T20:03:19Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/DynamoDbEnhancedClient.java", "diffHunk": "@@ -48,18 +49,34 @@\n         throw new UnsupportedOperationException();\n     }\n \n+    default SdkIterable<BatchGetResultPage> batchGetItem(Consumer<BatchGetItemEnhancedRequest.Builder> requestConsumer) {\n+        throw new UnsupportedOperationException();\n+    }\n+\n     default BatchWriteResult batchWriteItem(BatchWriteItemEnhancedRequest request) {\n         throw new UnsupportedOperationException();\n     }\n \n+    default BatchWriteResult batchWriteItem(Consumer<BatchWriteItemEnhancedRequest.Builder> requestConsumer) {\n+        throw new UnsupportedOperationException();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwNTcyMQ==", "bodyText": "This does not appear to be used. Can we remove it?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380905721", "createdAt": "2020-02-18T20:04:55Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/core/DefaultDynamoDbIndexTest.java", "diffHunk": "@@ -37,6 +38,9 @@\n     @Mock\n     private MapperExtension mockMapperExtension;\n \n+    @Mock\n+    private PaginatedIndexOperation<?,?,?,?> mockPaginatedOperation;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwNzE0Mg==", "bodyText": "I think we should be able to make basic assertions here beyond 'it didn't blow up'.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380907142", "createdAt": "2020-02-18T20:07:59Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/AsyncBasicCrudTest.java", "diffHunk": "@@ -228,6 +226,25 @@ public void deleteTable() {\n                                 .join();\n     }\n \n+    @Test\n+    public void getItemInterfaceToOperationSucceeds() {\n+        mappedTable.getItem(r -> r.key(Key.create(stringValue(\"id-value\"), stringValue(\"sort-value\")))).join();\n+        mappedTable.getItem(GetItemEnhancedRequest.builder()\n+                                                  .key(Key.create(stringValue(\"id-value\"), stringValue(\"sort-value\")))\n+                                                  .build()).join();\n+    }\n+\n+    @Test\n+    public void putItemInterfaceToOperationSucceeds() {\n+        Record record = new Record()\n+            .setId(\"id-value\")\n+            .setSort(\"sort-value\")\n+            .setAttribute(\"one\");\n+\n+        mappedTable.putItem(Record.class, r -> r.item(record)).join();\n+        mappedTable.putItem(PutItemEnhancedRequest.builder(Record.class).item(record).build()).join();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwNzY1MQ==", "bodyText": "I think we should be able to make basic assertions here beyond 'it didn't blow up'.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380907651", "createdAt": "2020-02-18T20:09:02Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/AsyncBasicCrudTest.java", "diffHunk": "@@ -376,11 +381,17 @@ public void putWithConditionThatFails() {\n                    .join();\n     }\n \n+    @Test\n+    public void deleteItemInterfaceToOperationSucceeds() {\n+        mappedTable.deleteItem(r -> r.key(Key.create(stringValue(\"id-value\"), stringValue(\"sort-value\")))).join();\n+        mappedTable.deleteItem(DeleteItemEnhancedRequest.builder()\n+                                                        .key(Key.create(stringValue(\"id-value\"), stringValue(\"sort-value\")))\n+                                                        .build()).join();\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwNzc1NQ==", "bodyText": "I think we should be able to make basic assertions here beyond 'it didn't blow up'.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380907755", "createdAt": "2020-02-18T20:09:12Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/AsyncBasicCrudTest.java", "diffHunk": "@@ -436,6 +451,17 @@ public void deleteWithConditionThatFails() {\n                                                .build()).join();\n     }\n \n+    @Test\n+    public void updateItemInterfaceToOperationSucceeds() {\n+        Record record = new Record()\n+            .setId(\"id-value\")\n+            .setSort(\"sort-value\")\n+            .setAttribute(\"one\");\n+\n+        mappedTable.updateItem(Record.class, r -> r.item(record)).join();\n+        mappedTable.updateItem(UpdateItemEnhancedRequest.builder(Record.class).item(record).build()).join();\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 229}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwOTA5NQ==", "bodyText": "Unused imports", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380909095", "createdAt": "2020-02-18T20:11:41Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/AsyncIndexScanTest.java", "diffHunk": "@@ -0,0 +1,290 @@\n+/*\n+ * Copyright 2010-2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.extensions.dynamodb.mappingclient.functionaltests;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.empty;\n+import static org.hamcrest.Matchers.is;\n+import static org.hamcrest.Matchers.nullValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.AttributeValues.numberValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.AttributeValues.stringValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.primaryPartitionKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.primarySortKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.secondaryPartitionKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.secondarySortKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.Attributes.integerNumberAttribute;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.Attributes.stringAttribute;\n+\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+import java.util.stream.IntStream;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Test;\n+import software.amazon.awssdk.core.async.SdkPublisher;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbAsyncIndex;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbAsyncTable;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbEnhancedAsyncClient;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbEnhancedClient;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbIndex;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbTable;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwOTU2NQ==", "bodyText": "I think we're using this code in a bunch of places, can we refactor it into a base test class or util?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380909565", "createdAt": "2020-02-18T20:12:42Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/AsyncIndexScanTest.java", "diffHunk": "@@ -0,0 +1,290 @@\n+/*\n+ * Copyright 2010-2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.extensions.dynamodb.mappingclient.functionaltests;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.empty;\n+import static org.hamcrest.Matchers.is;\n+import static org.hamcrest.Matchers.nullValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.AttributeValues.numberValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.AttributeValues.stringValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.primaryPartitionKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.primarySortKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.secondaryPartitionKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.secondarySortKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.Attributes.integerNumberAttribute;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.Attributes.stringAttribute;\n+\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+import java.util.stream.IntStream;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Test;\n+import software.amazon.awssdk.core.async.SdkPublisher;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbAsyncIndex;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbAsyncTable;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbEnhancedAsyncClient;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbEnhancedClient;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbIndex;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbTable;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.Expression;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.Page;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.TableSchema;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.core.DefaultDynamoDbEnhancedAsyncClient;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.model.GlobalSecondaryIndex;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.model.ScanEnhancedRequest;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.StaticTableSchema;\n+import software.amazon.awssdk.services.dynamodb.model.AttributeValue;\n+import software.amazon.awssdk.services.dynamodb.model.DeleteTableRequest;\n+import software.amazon.awssdk.services.dynamodb.model.Projection;\n+import software.amazon.awssdk.services.dynamodb.model.ProjectionType;\n+\n+public class AsyncIndexScanTest extends LocalDynamoDbAsyncTestBase {\n+    private static class Record {\n+        private String id;\n+        private Integer sort;\n+        private Integer value;\n+        private String gsiId;\n+        private Integer gsiSort;\n+\n+        private String getId() {\n+            return id;\n+        }\n+\n+        private Record setId(String id) {\n+            this.id = id;\n+            return this;\n+        }\n+\n+        private Integer getSort() {\n+            return sort;\n+        }\n+\n+        private Record setSort(Integer sort) {\n+            this.sort = sort;\n+            return this;\n+        }\n+\n+        private Integer getValue() {\n+            return value;\n+        }\n+\n+        private Record setValue(Integer value) {\n+            this.value = value;\n+            return this;\n+        }\n+\n+        private String getGsiId() {\n+            return gsiId;\n+        }\n+\n+        private Record setGsiId(String gsiId) {\n+            this.gsiId = gsiId;\n+            return this;\n+        }\n+\n+        private Integer getGsiSort() {\n+            return gsiSort;\n+        }\n+\n+        private Record setGsiSort(Integer gsiSort) {\n+            this.gsiSort = gsiSort;\n+            return this;\n+        }\n+\n+        @Override\n+        public boolean equals(Object o) {\n+            if (this == o) return true;\n+            if (o == null || getClass() != o.getClass()) return false;\n+            Record record = (Record) o;\n+            return Objects.equals(id, record.id) &&\n+                   Objects.equals(sort, record.sort) &&\n+                   Objects.equals(value, record.value) &&\n+                   Objects.equals(gsiId, record.gsiId) &&\n+                   Objects.equals(gsiSort, record.gsiSort);\n+        }\n+\n+        @Override\n+        public int hashCode() {\n+            return Objects.hash(id, sort, value, gsiId, gsiSort);\n+        }\n+    }\n+\n+    private static final TableSchema<Record> TABLE_SCHEMA =\n+        StaticTableSchema.builder(Record.class)\n+                         .newItemSupplier(Record::new)\n+                         .attributes(\n+                             stringAttribute(\"id\", Record::getId, Record::setId).as(primaryPartitionKey()),\n+                             integerNumberAttribute(\"sort\", Record::getSort, Record::setSort).as(primarySortKey()),\n+                             integerNumberAttribute(\"value\", Record::getValue, Record::setValue),\n+                             stringAttribute(\"gsi_id\", Record::getGsiId, Record::setGsiId)\n+                                 .as(secondaryPartitionKey(\"gsi_keys_only\")),\n+                             integerNumberAttribute(\"gsi_sort\", Record::getGsiSort, Record::setGsiSort)\n+                                 .as(secondarySortKey(\"gsi_keys_only\")))\n+                         .build();\n+\n+    private static final List<Record> RECORDS =\n+        IntStream.range(0, 10)\n+                 .mapToObj(i -> new Record()\n+                     .setId(\"id-value\")\n+                     .setSort(i)\n+                     .setValue(i)\n+                     .setGsiId(\"gsi-id-value\")\n+                     .setGsiSort(i))\n+                 .collect(Collectors.toList());\n+\n+    private static final List<Record> KEYS_ONLY_RECORDS =\n+        RECORDS.stream()\n+               .map(record -> new Record()\n+                   .setId(record.id)\n+                   .setSort(record.sort)\n+                   .setGsiId(record.gsiId)\n+                   .setGsiSort(record.gsiSort))\n+               .collect(Collectors.toList());\n+\n+    private DynamoDbEnhancedAsyncClient enhancedAsyncClient =\n+        DefaultDynamoDbEnhancedAsyncClient.builder()\n+                                          .dynamoDbClient(getDynamoDbAsyncClient())\n+                                          .build();\n+\n+    private DynamoDbAsyncTable<Record> mappedTable = enhancedAsyncClient.table(getConcreteTableName(\"table-name\"), TABLE_SCHEMA);\n+    private DynamoDbAsyncIndex<Record> keysOnlyMappedIndex = mappedTable.index(\"gsi_keys_only\");\n+\n+    private void insertRecords() {\n+        RECORDS.forEach(record -> mappedTable.putItem(Record.class, r -> r.item(record)).join());\n+    }\n+\n+    private static <T> List<T> drainPublisher(SdkPublisher<T> publisher, int expectedNumberOfResults) {\n+        BufferingSubscriber<T> subscriber = new BufferingSubscriber<>();\n+        publisher.subscribe(subscriber);\n+        subscriber.waitForCompletion(1000L);\n+\n+        assertThat(subscriber.isCompleted(), is(true));\n+        assertThat(subscriber.bufferedError(), is(nullValue()));\n+        assertThat(subscriber.bufferedItems().size(), is(expectedNumberOfResults));\n+\n+        return subscriber.bufferedItems();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 186}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkwOTc4Nw==", "bodyText": "Why is this commented out?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380909787", "createdAt": "2020-02-18T20:13:09Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/AsyncIndexScanTest.java", "diffHunk": "@@ -0,0 +1,290 @@\n+/*\n+ * Copyright 2010-2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.extensions.dynamodb.mappingclient.functionaltests;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.empty;\n+import static org.hamcrest.Matchers.is;\n+import static org.hamcrest.Matchers.nullValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.AttributeValues.numberValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.AttributeValues.stringValue;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.primaryPartitionKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.primarySortKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.secondaryPartitionKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.secondarySortKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.Attributes.integerNumberAttribute;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.Attributes.stringAttribute;\n+\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+import java.util.stream.IntStream;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Test;\n+import software.amazon.awssdk.core.async.SdkPublisher;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbAsyncIndex;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbAsyncTable;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbEnhancedAsyncClient;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbEnhancedClient;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbIndex;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.DynamoDbTable;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.Expression;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.Page;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.TableSchema;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.core.DefaultDynamoDbEnhancedAsyncClient;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.model.GlobalSecondaryIndex;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.model.ScanEnhancedRequest;\n+import software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.StaticTableSchema;\n+import software.amazon.awssdk.services.dynamodb.model.AttributeValue;\n+import software.amazon.awssdk.services.dynamodb.model.DeleteTableRequest;\n+import software.amazon.awssdk.services.dynamodb.model.Projection;\n+import software.amazon.awssdk.services.dynamodb.model.ProjectionType;\n+\n+public class AsyncIndexScanTest extends LocalDynamoDbAsyncTestBase {\n+    private static class Record {\n+        private String id;\n+        private Integer sort;\n+        private Integer value;\n+        private String gsiId;\n+        private Integer gsiSort;\n+\n+        private String getId() {\n+            return id;\n+        }\n+\n+        private Record setId(String id) {\n+            this.id = id;\n+            return this;\n+        }\n+\n+        private Integer getSort() {\n+            return sort;\n+        }\n+\n+        private Record setSort(Integer sort) {\n+            this.sort = sort;\n+            return this;\n+        }\n+\n+        private Integer getValue() {\n+            return value;\n+        }\n+\n+        private Record setValue(Integer value) {\n+            this.value = value;\n+            return this;\n+        }\n+\n+        private String getGsiId() {\n+            return gsiId;\n+        }\n+\n+        private Record setGsiId(String gsiId) {\n+            this.gsiId = gsiId;\n+            return this;\n+        }\n+\n+        private Integer getGsiSort() {\n+            return gsiSort;\n+        }\n+\n+        private Record setGsiSort(Integer gsiSort) {\n+            this.gsiSort = gsiSort;\n+            return this;\n+        }\n+\n+        @Override\n+        public boolean equals(Object o) {\n+            if (this == o) return true;\n+            if (o == null || getClass() != o.getClass()) return false;\n+            Record record = (Record) o;\n+            return Objects.equals(id, record.id) &&\n+                   Objects.equals(sort, record.sort) &&\n+                   Objects.equals(value, record.value) &&\n+                   Objects.equals(gsiId, record.gsiId) &&\n+                   Objects.equals(gsiSort, record.gsiSort);\n+        }\n+\n+        @Override\n+        public int hashCode() {\n+            return Objects.hash(id, sort, value, gsiId, gsiSort);\n+        }\n+    }\n+\n+    private static final TableSchema<Record> TABLE_SCHEMA =\n+        StaticTableSchema.builder(Record.class)\n+                         .newItemSupplier(Record::new)\n+                         .attributes(\n+                             stringAttribute(\"id\", Record::getId, Record::setId).as(primaryPartitionKey()),\n+                             integerNumberAttribute(\"sort\", Record::getSort, Record::setSort).as(primarySortKey()),\n+                             integerNumberAttribute(\"value\", Record::getValue, Record::setValue),\n+                             stringAttribute(\"gsi_id\", Record::getGsiId, Record::setGsiId)\n+                                 .as(secondaryPartitionKey(\"gsi_keys_only\")),\n+                             integerNumberAttribute(\"gsi_sort\", Record::getGsiSort, Record::setGsiSort)\n+                                 .as(secondarySortKey(\"gsi_keys_only\")))\n+                         .build();\n+\n+    private static final List<Record> RECORDS =\n+        IntStream.range(0, 10)\n+                 .mapToObj(i -> new Record()\n+                     .setId(\"id-value\")\n+                     .setSort(i)\n+                     .setValue(i)\n+                     .setGsiId(\"gsi-id-value\")\n+                     .setGsiSort(i))\n+                 .collect(Collectors.toList());\n+\n+    private static final List<Record> KEYS_ONLY_RECORDS =\n+        RECORDS.stream()\n+               .map(record -> new Record()\n+                   .setId(record.id)\n+                   .setSort(record.sort)\n+                   .setGsiId(record.gsiId)\n+                   .setGsiSort(record.gsiSort))\n+               .collect(Collectors.toList());\n+\n+    private DynamoDbEnhancedAsyncClient enhancedAsyncClient =\n+        DefaultDynamoDbEnhancedAsyncClient.builder()\n+                                          .dynamoDbClient(getDynamoDbAsyncClient())\n+                                          .build();\n+\n+    private DynamoDbAsyncTable<Record> mappedTable = enhancedAsyncClient.table(getConcreteTableName(\"table-name\"), TABLE_SCHEMA);\n+    private DynamoDbAsyncIndex<Record> keysOnlyMappedIndex = mappedTable.index(\"gsi_keys_only\");\n+\n+    private void insertRecords() {\n+        RECORDS.forEach(record -> mappedTable.putItem(Record.class, r -> r.item(record)).join());\n+    }\n+\n+    private static <T> List<T> drainPublisher(SdkPublisher<T> publisher, int expectedNumberOfResults) {\n+        BufferingSubscriber<T> subscriber = new BufferingSubscriber<>();\n+        publisher.subscribe(subscriber);\n+        subscriber.waitForCompletion(1000L);\n+\n+        assertThat(subscriber.isCompleted(), is(true));\n+        assertThat(subscriber.bufferedError(), is(nullValue()));\n+        assertThat(subscriber.bufferedItems().size(), is(expectedNumberOfResults));\n+\n+        return subscriber.bufferedItems();\n+    }\n+\n+    @Before\n+    public void createTable() {\n+        mappedTable.createTable(r -> r.provisionedThroughput(getDefaultProvisionedThroughput())\n+                                      .globalSecondaryIndices(GlobalSecondaryIndex.create(\n+                                          \"gsi_keys_only\",\n+                                          Projection.builder().projectionType(ProjectionType.KEYS_ONLY).build(),\n+                                          getDefaultProvisionedThroughput()))).join();\n+    }\n+\n+    @After\n+    public void deleteTable() {\n+        getDynamoDbAsyncClient().deleteTable(DeleteTableRequest.builder()\n+                                                               .tableName(getConcreteTableName(\"table-name\"))\n+                                                               .build()).join();\n+    }\n+\n+    @Test\n+    public void scanAllRecordsDefaultSettings() {\n+        insertRecords();\n+\n+        SdkPublisher<Page<Record>> publisher = keysOnlyMappedIndex.scan(ScanEnhancedRequest.builder().build());\n+        List<Page<Record>> results = drainPublisher(publisher, 1);\n+        Page<Record> page = results.get(0);\n+\n+        assertThat(page.items(), is(KEYS_ONLY_RECORDS));\n+    //    assertThat(page.lastEvaluatedKey(), is(nullValue()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 213}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkxMDQyOQ==", "bodyText": "I think we should be able to make basic assertions here beyond 'it didn't blow up'.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380910429", "createdAt": "2020-02-18T20:14:34Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/BasicCrudTest.java", "diffHunk": "@@ -222,6 +220,25 @@ public void deleteTable() {\n                                                           .build());\n     }\n \n+    @Test\n+    public void getItemInterfaceToOperationSucceeds() {\n+        mappedTable.getItem(r -> r.key(Key.create(stringValue(\"id-value\"), stringValue(\"sort-value\"))));\n+        mappedTable.getItem(GetItemEnhancedRequest.builder()\n+                                                  .key(Key.create(stringValue(\"id-value\"), stringValue(\"sort-value\")))\n+                                                  .build());\n+    }\n+\n+    @Test\n+    public void putItemInterfaceToOperationSucceeds() {\n+        Record record = new Record()\n+            .setId(\"id-value\")\n+            .setSort(\"sort-value\")\n+            .setAttribute(\"one\");\n+\n+        mappedTable.putItem(Record.class, r -> r.item(record));\n+        mappedTable.putItem(PutItemEnhancedRequest.builder(Record.class).item(record).build());\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkxMDYwOA==", "bodyText": "I think we should be able to make basic assertions here beyond 'it didn't blow up'.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380910608", "createdAt": "2020-02-18T20:14:59Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/BasicCrudTest.java", "diffHunk": "@@ -360,10 +371,17 @@ public void putWithConditionThatFails() {\n                                                   .conditionExpression(conditionExpression).build());\n     }\n \n+    @Test\n+    public void deleteItemInterfaceToOperationSucceeds() {\n+        mappedTable.deleteItem(r -> r.key(Key.create(stringValue(\"id-value\"), stringValue(\"sort-value\"))));\n+        mappedTable.deleteItem(DeleteItemEnhancedRequest.builder()\n+                                                        .key(Key.create(stringValue(\"id-value\"), stringValue(\"sort-value\")))\n+                                                        .build());\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 165}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkxMDcyNA==", "bodyText": "I think we should be able to make basic assertions here beyond 'it didn't blow up'.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380910724", "createdAt": "2020-02-18T20:15:13Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/BasicCrudTest.java", "diffHunk": "@@ -418,6 +436,17 @@ public void deleteWithConditionThatFails() {\n                                                .build());\n     }\n \n+    @Test\n+    public void updateItemInterfaceToOperationSucceeds() {\n+        Record record = new Record()\n+            .setId(\"id-value\")\n+            .setSort(\"sort-value\")\n+            .setAttribute(\"one\");\n+\n+        mappedTable.updateItem(Record.class, r -> r.item(record));\n+        mappedTable.updateItem(UpdateItemEnhancedRequest.builder(Record.class).item(record).build());\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 215}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkxMDk0MQ==", "bodyText": "Unused imports.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380910941", "createdAt": "2020-02-18T20:15:46Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/functionaltests/BasicQueryTest.java", "diffHunk": "@@ -25,6 +25,8 @@\n import static software.amazon.awssdk.extensions.dynamodb.mappingclient.model.QueryConditional.equalTo;\n import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.primaryPartitionKey;\n import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.primarySortKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.secondaryPartitionKey;\n+import static software.amazon.awssdk.extensions.dynamodb.mappingclient.staticmapper.AttributeTags.secondarySortKey;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkxNTc3MQ==", "bodyText": "I'm not sure I like this, speaking to Matt he said there is prior art for having an overloaded version of this that takes no arguments at all. So-called 'simple' method form.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380915771", "createdAt": "2020-02-18T20:26:20Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/README.md", "diffHunk": "@@ -80,66 +80,109 @@ values used are also completely arbitrary.\n  \n ### Common primitive operations\n These all strongly map to the primitive DynamoDB operations they are\n-named after. These examples are the most simple variants of each\n-operation possible. These commands can be customized by using the\n-builders provided for each command and offer most of the features\n-available in the low-level DynamoDB SDK client.\n+named after. The examples below are the most simple variants of each\n+operation possible, using the the two styles available for constructing\n+requests with either builder or consumers. These commands can be \n+customized by using the builders provided for each command and offer \n+most of the features available in the low-level DynamoDB SDK client.\n \n    ```java\n    // CreateTable\n-   customerTable.createTable(CreateTableEnhancedRequest.create());\n+   customerTable.createTable(() -> {});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkxNjM2Nw==", "bodyText": "Can we do the 'simple method' implementation here with no arguments.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r380916367", "createdAt": "2020-02-18T20:27:31Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/README.md", "diffHunk": "@@ -80,66 +80,109 @@ values used are also completely arbitrary.\n  \n ### Common primitive operations\n These all strongly map to the primitive DynamoDB operations they are\n-named after. These examples are the most simple variants of each\n-operation possible. These commands can be customized by using the\n-builders provided for each command and offer most of the features\n-available in the low-level DynamoDB SDK client.\n+named after. The examples below are the most simple variants of each\n+operation possible, using the the two styles available for constructing\n+requests with either builder or consumers. These commands can be \n+customized by using the builders provided for each command and offer \n+most of the features available in the low-level DynamoDB SDK client.\n \n    ```java\n    // CreateTable\n-   customerTable.createTable(CreateTableEnhancedRequest.create());\n+   customerTable.createTable(() -> {});\n+   customerTable.createTable(CreateTableEnhancedRequest.builder().build());\n    \n    // GetItem\n-   Customer customer = customerTable.getItem(GetItemEnhancedRequest.create(Key.create(stringValue(\"a123\"))));\n-   \n+   Customer customer = customerTable.getItem(r -> r.key(Key.create(stringValue(\"a123\"))));\n+   Customer customer = customerTable.getItem(GetItemEnhancedRequest.builder()\n+                                                                   .key(Key.create(stringValue(\"a123\")))\n+                                                                   .build()); \n    // UpdateItem\n-   Customer updatedCustomer = customerTable.updateItem(UpdateItemEnhancedRequest.create(customer));\n+   Customer updatedCustomer = customerTable.updateItem(Customer.class, r -> r.item(customer));\n+   Customer updatedCustomer = customerTable.updateItem(UpdateItemEnhancedRequest.builder(Customer.class)\n+                                                                                .item(customer)\n+                                                                                .build());\n    \n    // PutItem\n-   customerTable.putItem(PutItemEnhancedRequest.create(customer));\n+   customerTable.putItem(Customer.class, r -> r.item(customer));\n+   customerTable.putItem(PutItemEnhancedRequest.builder(Customer.class)\n+                                               .item(customer)\n+                                               .build());\n    \n    // DeleteItem\n-   Customer deletedCustomer = customerTable.deleteItem(DeleteItemEnhancedRequest.create(Key.create(stringValue(\"a123\"), numberValue(456))));\n+   Customer deletedCustomer = customerTable.deleteItem(r -> r.key(Key.create(stringValue(\"a123\"), numberValue(456))));\n+   Customer deletedCustomer = customerTable.deleteItem(DeleteItemEnhancedRequest.builder()\n+                                                                                     .key(Key.create(stringValue(\"a123\"), numberValue(456)))\n+                                                                                     .build());\n    \n    // Query\n-   Iterable<Page<Customer>> customers = customerTable.query(QueryEnhancedRequest.create(equalTo(Key.create(stringValue(\"a123\")))));\n-   \n+   Iterable<Page<Customer>> customers = customerTable.query(r -> r.queryConditional(equalTo(Key.create(stringValue(\"a123\")))));\n+   Iterable<Page<Customer>> customers = customerTable.query(QueryEnhancedRequest.builder()\n+                                                                                .queryConditional(equalTo(Key.create(stringValue(\"a123\"))))\n+                                                                                .build());\n    // Scan\n-   Iterable<Page<Customer>> customers = customerTable.scan(ScanEnhancedRequest.create());\n+   Iterable<Page<Customer>> customers = customerTable.scan(() -> {});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58a29cba77abd0112690e51bc38de127c6eb9c0a"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMjg3NTYz", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#pullrequestreview-361287563", "createdAt": "2020-02-19T17:26:08Z", "commit": {"oid": "6c02a65b42b841a447e48110009b32d980e468ff"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNzoyNjowOFrOFrweCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNzoyNjowOFrOFrweCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQyNzIwOA==", "bodyText": "Now it's generic and global we should rename this to be a little more specific to what it does, which is call each supplier and make a list of the results.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#discussion_r381427208", "createdAt": "2020-02-19T17:26:08Z", "author": {"login": "bmaizels"}, "path": "services-custom/dynamodb-enhanced/src/main/java/software/amazon/awssdk/extensions/dynamodb/mappingclient/core/Utils.java", "diffHunk": "@@ -117,4 +119,13 @@ public static String cleanAttributeName(String key) {\n         return sortKeyValue.map(attributeValue -> Key.create(partitionKeyValue, attributeValue))\n                            .orElseGet(() -> Key.create(partitionKeyValue));\n     }\n+\n+    public static <T> List<T> getListIfExist(List<Supplier<T>> itemSupplierList) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c02a65b42b841a447e48110009b32d980e468ff"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMTI3NzA1", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1654#pullrequestreview-362127705", "createdAt": "2020-02-20T18:20:36Z", "commit": {"oid": "a9c22a97ebac12f15dfe1f73d8557ce694ec74c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a8103448fe609ff122ca31a7aa188a9082849da", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/7a8103448fe609ff122ca31a7aa188a9082849da", "committedDate": "2020-02-21T15:18:27Z", "message": "Dynamodb-enhanced [preview]: Updates all operations with consumer style invocations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2aa6aa476880fa83efd67231e1d888f8bd50e832", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/2aa6aa476880fa83efd67231e1d888f8bd50e832", "committedDate": "2020-02-20T18:21:00Z", "message": "Merge branch 'master' into salande/ddbmapper-consumer-operations"}, "afterCommit": {"oid": "7a8103448fe609ff122ca31a7aa188a9082849da", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/7a8103448fe609ff122ca31a7aa188a9082849da", "committedDate": "2020-02-21T15:18:27Z", "message": "Dynamodb-enhanced [preview]: Updates all operations with consumer style invocations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b07f60305c53d508ef7e5034a65451d73c9498a", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9b07f60305c53d508ef7e5034a65451d73c9498a", "committedDate": "2020-02-21T15:22:01Z", "message": "Merge branch 'master' into salande/ddbmapper-consumer-operations"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2677, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}