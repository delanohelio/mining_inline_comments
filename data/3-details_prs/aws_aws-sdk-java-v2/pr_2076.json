{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1OTA5NDAz", "number": 2076, "title": "DynamoDB Enhanced Client: Added support for attribute level custom up\u2026", "bodyText": "\u2026date behaviors\nImplements suggestion in #1822\nDescription\nCopied from README.md update:\nChanging update behavior of attributes\nIt is possible to customize the update behavior as applicable to individual attributes when an 'update' operation is\nperformed (e.g. UpdateItem or an update within TransactWriteItems).\nFor example, say like you wanted to store a 'created on' timestamp on your record, but only wanted its value to be\nwritten if there is no existing value for the attribute stored in the database then you would use the\nWRITE_IF_NOT_EXISTS update behavior. Here is an example using a bean:\n@DynamoDbBean\npublic class Customer extends GenericRecord {\n    private String id;\n    private Instant createdOn;\n\n    @DynamoDbPartitionKey\n    public String getId() { return this.id; }\n    public void setId(String id) { this.name = id; }\n\n    @DynamoDbUpdateBehavior(UpdateBehavior.WRITE_IF_NOT_EXISTS)\n    public Instant getCreatedOn() { return this.createdOn; }    \n    public void setCreatedOn(Instant createdOn) { this.createdOn = createdOn; }\n}\nSame example using a static table schema:\nstatic final TableSchema<Customer> CUSTOMER_TABLE_SCHEMA =\n     TableSchema.builder(Customer.class)\n       .newItemSupplier(Customer::new)\n       .addAttribute(String.class, a -> a.name(\"id\")\n                                         .getter(Customer::getId)\n                                         .setter(Customer::setId)\n                                         .tags(primaryPartitionKey()))\n       .addAttribute(Instant.class, a -> a.name(\"createdOn\")\n                                          .getter(Customer::getCreatedOn)\n                                          .setter(Customer::setCreatedOn)\n                                          .tags(updateBehavior(UpdateBehavior.WRITE_IF_NOT_EXISTS)))\n       .build();", "createdAt": "2020-10-01T02:41:55Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2076", "merged": true, "mergeCommit": {"oid": "84679eda4ba57c22a77b373cc0171b64b4821e91"}, "closed": true, "closedAt": "2020-10-03T01:31:15Z", "author": {"login": "bmaizels"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOIO_DgBqjM4MjcyMTcwOTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOtka4gH2gAyNDk1OTA5NDAzOjYwZGU5ODZkNmU3NDA1YzFiNmM3YWUyMDFjOTkyY2JiODMwZjBjMTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18631f292db9e0420623a9167cea05e0834a5737", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/18631f292db9e0420623a9167cea05e0834a5737", "committedDate": "2020-10-01T02:36:27Z", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors"}, "afterCommit": {"oid": "b7be963907c97323da9be0cbb60079b41c18d0c3", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/b7be963907c97323da9be0cbb60079b41c18d0c3", "committedDate": "2020-10-01T02:47:16Z", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b7be963907c97323da9be0cbb60079b41c18d0c3", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/b7be963907c97323da9be0cbb60079b41c18d0c3", "committedDate": "2020-10-01T02:47:16Z", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors"}, "afterCommit": {"oid": "ae432b1c9531947bde0b32528c9f534ff8376eab", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/ae432b1c9531947bde0b32528c9f534ff8376eab", "committedDate": "2020-10-01T02:48:37Z", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78576238ea3469ddae74c57cf58fd6ce99701bed", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/78576238ea3469ddae74c57cf58fd6ce99701bed", "committedDate": "2020-10-01T21:50:49Z", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "90714e46b52383bd10f9cb724ea7361fc270f2c0", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/90714e46b52383bd10f9cb724ea7361fc270f2c0", "committedDate": "2020-10-01T21:46:57Z", "message": "Merge branch 'master' into bmaizels/ddbenhanced-update-behaviors"}, "afterCommit": {"oid": "78576238ea3469ddae74c57cf58fd6ce99701bed", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/78576238ea3469ddae74c57cf58fd6ce99701bed", "committedDate": "2020-10-01T21:50:49Z", "message": "DynamoDB Enhanced Client: Added support for attribute level custom update behaviors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNDUwNzAy", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2076#pullrequestreview-501450702", "createdAt": "2020-10-02T21:12:03Z", "commit": {"oid": "78576238ea3469ddae74c57cf58fd6ce99701bed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMToxMjowNFrOHb7vxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMToxMjowNFrOHb7vxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1MjQ4Ng==", "bodyText": "I'm confused about the use of this. Would you actually use it for \"created date\" if it doesn't work for putItem (only for updateItem)? Wouldn't this be firstUpdatedDate, which seems kind of useless?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2076#discussion_r499052486", "createdAt": "2020-10-02T21:12:04Z", "author": {"login": "millems"}, "path": "services-custom/dynamodb-enhanced/src/test/java/software/amazon/awssdk/enhanced/dynamodb/functionaltests/models/RecordWithUpdateBehaviors.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.enhanced.dynamodb.functionaltests.models;\n+\n+import java.time.Instant;\n+import software.amazon.awssdk.enhanced.dynamodb.extensions.annotations.DynamoDbVersionAttribute;\n+import software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.DynamoDbBean;\n+import software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.DynamoDbPartitionKey;\n+import software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.DynamoDbUpdateBehavior;\n+\n+import static software.amazon.awssdk.enhanced.dynamodb.mapper.UpdateBehavior.WRITE_ALWAYS;\n+import static software.amazon.awssdk.enhanced.dynamodb.mapper.UpdateBehavior.WRITE_IF_NOT_EXISTS;\n+\n+@DynamoDbBean\n+public class RecordWithUpdateBehaviors {\n+    private String id;\n+    private Instant createdOn;\n+    private Instant lastUpdatedOn;\n+    private Long version;\n+\n+    @DynamoDbPartitionKey\n+    public String getId() {\n+        return id;\n+    }\n+\n+    public void setId(String id) {\n+        this.id = id;\n+    }\n+\n+    @DynamoDbUpdateBehavior(WRITE_IF_NOT_EXISTS)\n+    public Instant getCreatedOn() {\n+        return createdOn;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78576238ea3469ddae74c57cf58fd6ce99701bed"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNDczMDY1", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2076#pullrequestreview-501473065", "createdAt": "2020-10-02T22:09:04Z", "commit": {"oid": "78576238ea3469ddae74c57cf58fd6ce99701bed"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60de986d6e7405c1b6c7ae201c992cbb830f0c10", "author": {"user": {"login": "bmaizels", "name": "Benjamin Maizels"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/60de986d6e7405c1b6c7ae201c992cbb830f0c10", "committedDate": "2020-10-02T22:17:41Z", "message": "Merge branch 'master' into bmaizels/ddbenhanced-update-behaviors"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2493, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}