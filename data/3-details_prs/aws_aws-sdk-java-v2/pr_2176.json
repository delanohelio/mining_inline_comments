{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwNjc3NDQx", "number": 2176, "title": "Expose event-type in stream interface", "bodyText": "Description\n\nMotivation and Context\n\n\nTesting\n\n\n\nScreenshots (if appropriate)\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n\n\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-12-02T01:26:14Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176", "merged": true, "mergeCommit": {"oid": "308e493546ded28c5784a91b29704a4f2a7943e3"}, "closed": true, "closedAt": "2020-12-04T21:39:34Z", "author": {"login": "dagnir"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiUw0UgBqjQwNjQyOTk1NzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdi-tneAFqTU0NTMxMTIyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "482176c7de9058be30d494b1298e1b91306c7e1e", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/482176c7de9058be30d494b1298e1b91306c7e1e", "committedDate": "2020-12-01T23:47:39Z", "message": "Expose event-type in stream interface"}, "afterCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/c39678a67a5b856ec0c0712432a1d0148eea5976", "committedDate": "2020-12-02T20:40:56Z", "message": "Expose event-type in stream interface"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjM1MTc1", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#pullrequestreview-543235175", "createdAt": "2020-12-02T21:04:04Z", "commit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTowNDowNVrOH9uEew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTowNDo0M1rOH9uF6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ3OTk5NQ==", "bodyText": "nit: can we extract it to a separate method?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r534479995", "createdAt": "2020-12-02T21:04:05Z", "author": {"login": "zoewangg"}, "path": "codegen/src/main/java/software/amazon/awssdk/codegen/poet/model/AwsServiceModel.java", "diffHunk": "@@ -203,6 +210,30 @@ private void addEventSupport(TypeSpec.Builder specBuilder, ShapeModel eventStrea\n \n         specBuilder.addSuperinterface(eventStreamClassName);\n \n+        // This is hacky, but there's no better solution without\n+        // extensive refactoring. We basically need to know if any of\n+        // the *event types* within this even stream have this\n+        // customization enabled, which requires knowing the\n+        // MemberModel that has this given shape.\n+        boolean usesLegacyScheme = false;\n+        String eventName = null;\n+        for (MemberModel member : eventStream.getMembers()) {\n+            if (member.getShape().equals(shapeModel) && helper.useLegacyGenerationScheme(member)) {\n+                usesLegacyScheme = true;\n+                eventName = member.getName();\n+                break;\n+            }\n+        }\n+\n+        if (usesLegacyScheme) {\n+            specBuilder.addMethod(MethodSpec.methodBuilder(\"sdkEventType\")\n+                       .addAnnotation(Override.class)\n+                       .addModifiers(PUBLIC)\n+                       .returns(String.class)\n+                       .addStatement(\"return $S\", eventName)\n+                       .build());\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MDM2Mg==", "bodyText": "Should we use enum for the type?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r534480362", "createdAt": "2020-12-02T21:04:43Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/sharedstream/eventstream.java", "diffHunk": "@@ -41,6 +41,13 @@ public void accept(StreamDeathsResponseHandler.Visitor visitor) {\n         return DefaultPerson.builder();\n     }\n \n+    /**\n+     * The type of this event. Corresponds to the {@code :event-type} header on the Message.\n+     */\n+    default String sdkEventType() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/c39678a67a5b856ec0c0712432a1d0148eea5976", "committedDate": "2020-12-02T20:40:56Z", "message": "Expose event-type in stream interface"}, "afterCommit": {"oid": "03b7c2e644ea0b05fed3dd6f5a32f0a98577f5bd", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/03b7c2e644ea0b05fed3dd6f5a32f0a98577f5bd", "committedDate": "2020-12-03T01:03:02Z", "message": "Expose event-type in stream interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03b7c2e644ea0b05fed3dd6f5a32f0a98577f5bd", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/03b7c2e644ea0b05fed3dd6f5a32f0a98577f5bd", "committedDate": "2020-12-03T01:03:02Z", "message": "Expose event-type in stream interface"}, "afterCommit": {"oid": "de5700aa46ce3d2800c192d6b78f1b5861f615e6", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/de5700aa46ce3d2800c192d6b78f1b5861f615e6", "committedDate": "2020-12-03T01:18:58Z", "message": "Expose event-type in stream interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de5700aa46ce3d2800c192d6b78f1b5861f615e6", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/de5700aa46ce3d2800c192d6b78f1b5861f615e6", "committedDate": "2020-12-03T01:18:58Z", "message": "Expose event-type in stream interface"}, "afterCommit": {"oid": "425ac63e9482217f51bf9b00fb450c45a6768b8b", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/425ac63e9482217f51bf9b00fb450c45a6768b8b", "committedDate": "2020-12-03T01:33:30Z", "message": "Expose event-type in stream interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "425ac63e9482217f51bf9b00fb450c45a6768b8b", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/425ac63e9482217f51bf9b00fb450c45a6768b8b", "committedDate": "2020-12-03T01:33:30Z", "message": "Expose event-type in stream interface"}, "afterCommit": {"oid": "a839ef820a67def6f82d390420d860c8950d9b82", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/a839ef820a67def6f82d390420d860c8950d9b82", "committedDate": "2020-12-03T02:37:20Z", "message": "Expose event-type in stream interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a839ef820a67def6f82d390420d860c8950d9b82", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/a839ef820a67def6f82d390420d860c8950d9b82", "committedDate": "2020-12-03T02:37:20Z", "message": "Expose event-type in stream interface"}, "afterCommit": {"oid": "79caff91b8635b38412fde819f4e2d7e3732236d", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/79caff91b8635b38412fde819f4e2d7e3732236d", "committedDate": "2020-12-04T01:41:22Z", "message": "Multiple fixes\n\n - Use C2j name as string value of EventType enum\n - Use NamingStrategy to generate event class name and builder method\n - Fix Javadoc notation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/32cd8d61bc470ef325477fa29af90d5b8c12b2b4", "committedDate": "2020-12-04T01:48:13Z", "message": "Expose event-type in stream interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "79caff91b8635b38412fde819f4e2d7e3732236d", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/79caff91b8635b38412fde819f4e2d7e3732236d", "committedDate": "2020-12-04T01:41:22Z", "message": "Multiple fixes\n\n - Use C2j name as string value of EventType enum\n - Use NamingStrategy to generate event class name and builder method\n - Fix Javadoc notation"}, "afterCommit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/32cd8d61bc470ef325477fa29af90d5b8c12b2b4", "committedDate": "2020-12-04T01:48:13Z", "message": "Expose event-type in stream interface"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MjY5NDAw", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#pullrequestreview-545269400", "createdAt": "2020-12-04T20:19:42Z", "commit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMDoxOTo0MlrOH_gohw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMDo0Nzo1NFrOH_hd-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM1Njk5OQ==", "bodyText": "Typo? EventStream$EventTwo -> EventStream#EventTwo", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r536356999", "createdAt": "2020-12-04T20:19:42Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/defaulteventtwo.java", "diffHunk": "@@ -1,14 +1,16 @@\n-package software.amazon.awssdk.services.jsonprotocoltests.model.eventstream;\n+package software.amazon.awssdk.services.json.model.eventstream;\n \n import software.amazon.awssdk.annotations.Generated;\n import software.amazon.awssdk.annotations.SdkInternalApi;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventStreamOperationResponseHandler;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo;\n+import software.amazon.awssdk.services.json.model.EventStream;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationWithOnlyOutputResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventTwo;\n \n /**\n- * A specialization of {@code software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo} that represents the\n- * {@code EventStream#EventTwo} event. Do not use this class directly. Instead, use the static builder methods on\n- * {@link software.amazon.awssdk.services.jsonprotocoltests.model.EventStream}.\n+ * A specialization of {@code software.amazon.awssdk.services.json.model.EventTwo} that represents the\n+ * {@code EventStream$EventTwo} event. Do not use this class directly. Instead, use the static builder methods on", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM3MDY4Mw==", "bodyText": "Is this change intentional? Shouldn't it be DefaultSecondEventTwo?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r536370683", "createdAt": "2020-12-04T20:47:54Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/defaultsecondeventtwo.java", "diffHunk": "@@ -1,21 +1,23 @@\n-package software.amazon.awssdk.services.jsonprotocoltests.model.eventstream;\n+package software.amazon.awssdk.services.json.model.eventstream;\n \n import software.amazon.awssdk.annotations.Generated;\n import software.amazon.awssdk.annotations.SdkInternalApi;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventStreamOperationResponseHandler;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo;\n+import software.amazon.awssdk.services.json.model.EventStream;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationWithOnlyOutputResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventTwo;\n \n /**\n- * A specialization of {@code software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo} that represents the\n- * {@code EventStream#SecondEventTwo} event. Do not use this class directly. Instead, use the static builder methods on\n- * {@link software.amazon.awssdk.services.jsonprotocoltests.model.EventStream}.\n+ * A specialization of {@code software.amazon.awssdk.services.json.model.EventTwo} that represents the\n+ * {@code EventStream$secondeventtwo} event. Do not use this class directly. Instead, use the static builder methods on\n+ * {@link software.amazon.awssdk.services.json.model.EventStream}.\n  */\n @SdkInternalApi\n @Generated(\"software.amazon.awssdk:codegen\")\n-public final class DefaultSecondEventTwo extends EventTwo {\n+public final class DefaultSecondeventtwo extends EventTwo {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MzExMjI3", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#pullrequestreview-545311227", "createdAt": "2020-12-04T21:34:36Z", "commit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2384, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}