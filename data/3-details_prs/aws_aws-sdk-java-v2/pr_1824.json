{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0OTUwMjM2", "number": 1824, "title": "Raise a helpful error message when an obviously-invalid region name is given to the SDK.", "bodyText": "Fixes #1642.\nOld Error Message: software.amazon.awssdk.core.exception.SdkClientException: Unable to marshall request to JSON: host must not be null.\nNew Error Message: software.amazon.awssdk.core.exception.SdkClientException: Configured region (US_EAST_1) resulted in an invalid URI: https://s3.US_EAST_1.amazonaws.com Valid region examples: [af-south-1, ap-east-1, ap-northeast-1, ap-northeast-2, ap-south-1, ap-southeast-1, ap-southeast-2, aws-global, ca-central-1, eu-central-1, eu-north-1, eu-west-1, eu-west-2, eu-west-3, me-south-1, sa-east-1, us-east-1, us-east-2, us-west-1, us-west-2, cn-north-1, cn-northwest-1, fips-us-gov-west-1, us-gov-east-1, us-gov-west-1, us-iso-east-1, us-isob-east-1]\nOne risk worth calling out is that this change now throws an exception at client creation time, instead of when the service is called (although the exception type is the same). I personally think this new behavior is better, and it's unlikely that there are a large number of customers relying on when we actually throw this exception.", "createdAt": "2020-05-07T22:24:24Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1824", "merged": true, "mergeCommit": {"oid": "42d34918a93aa35f619349a55b9904ddfe94f744"}, "closed": true, "closedAt": "2020-05-07T22:56:04Z", "author": {"login": "millems"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfE7cagH2gAyNDE0OTUwMjM2OjQwN2YxZjU5OWMzN2QyODNjMGEyMTJiNDM1OTdhNTZiYjBlYWZhMDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfFFBsgFqTQwNzg4MjU0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "407f1f599c37d283c0a212b43597a56bb0eafa01", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/407f1f599c37d283c0a212b43597a56bb0eafa01", "committedDate": "2020-05-07T22:22:17Z", "message": "Raise a helpful error message when an obviously-invalid region name is given to the SDK.\n\nPreviously, a NullPointerException would be raised. Fixes #1642."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3ODc5MTc3", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1824#pullrequestreview-407879177", "createdAt": "2020-05-07T22:24:59Z", "commit": {"oid": "407f1f599c37d283c0a212b43597a56bb0eafa01"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMjoyNDo1OVrOGSSbzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMjoyNDo1OVrOGSSbzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgyOTU4Mw==", "bodyText": "This change is unrelated, but it prevents an error message being logged when the profile file is null.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1824#discussion_r421829583", "createdAt": "2020-05-07T22:24:59Z", "author": {"login": "millems"}, "path": "core/regions/src/main/java/software/amazon/awssdk/regions/servicemetadata/EnhancedS3ServiceMetadata.java", "diffHunk": "@@ -100,12 +100,16 @@ private static String envVarSetting() {\n         return SdkSystemSetting.AWS_S3_US_EAST_1_REGIONAL_ENDPOINT.getStringValue().orElse(null);\n     }\n \n-    private String profileFileSetting(Supplier<ProfileFile> profileFileSupplier, Supplier<String> profileName) {\n+    private String profileFileSetting(Supplier<ProfileFile> profileFileSupplier, Supplier<String> profileNameSupplier) {\n         try {\n-            return profileFileSupplier.get()\n-                                      .profile(profileName.get())\n-                                      .flatMap(p -> p.property(ProfileProperty.S3_US_EAST_1_REGIONAL_ENDPOINT))\n-                                      .orElse(null);\n+            ProfileFile profileFile = profileFileSupplier.get();\n+            String profileName = profileNameSupplier.get();\n+            if (profileFile == null || profileName == null) {\n+                return null;\n+            }\n+            return profileFile.profile(profileName)\n+                              .flatMap(p -> p.property(ProfileProperty.S3_US_EAST_1_REGIONAL_ENDPOINT))\n+                              .orElse(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "407f1f599c37d283c0a212b43597a56bb0eafa01"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e427b9859328ef46da89dc7c039d60dd608cb5c0", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/e427b9859328ef46da89dc7c039d60dd608cb5c0", "committedDate": "2020-05-07T22:26:41Z", "message": "Merge branch 'master' into millem/bad-region-error-improvement"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3ODgyNTQy", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1824#pullrequestreview-407882542", "createdAt": "2020-05-07T22:32:46Z", "commit": {"oid": "e427b9859328ef46da89dc7c039d60dd608cb5c0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2549, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}