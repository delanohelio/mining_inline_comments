{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NDg1NzE5", "number": 2220, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMjozNzoxMVrOFKL4Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMjozNzoxMVrOFKL4Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2MjI0Njk1OnYy", "diffSide": "RIGHT", "path": "core/sdk-core/src/main/java/software/amazon/awssdk/core/internal/http/pipeline/stages/TimeoutExceptionHandlingStage.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMjozNzoxMVrOIM2fFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMVQxODo1Njo0MVrOINI35g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDM0NjUxOA==", "bodyText": "We check isCausedByApiCallAttemptTimeout but can this be caused by the API call timer as well?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2220#discussion_r550346518", "createdAt": "2020-12-30T22:37:11Z", "author": {"login": "dagnir"}, "path": "core/sdk-core/src/main/java/software/amazon/awssdk/core/internal/http/pipeline/stages/TimeoutExceptionHandlingStage.java", "diffHunk": "@@ -90,7 +91,8 @@ public TimeoutExceptionHandlingStage(HttpClientDependencies dependencies, Reques\n      */\n     private Exception translatePipelineException(RequestExecutionContext context, Exception e) {\n         if (e instanceof InterruptedException || e instanceof IOException ||\n-            e instanceof AbortedException || Thread.currentThread().isInterrupted()) {\n+                e instanceof AbortedException || Thread.currentThread().isInterrupted()\n+                || (e instanceof SdkClientException && isCausedByApiCallAttemptTimeout(context))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "209764f246a19185a65e51dc6dd60c1b9d110ba0"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDM4MjY3Ng==", "bodyText": "The timeout exception is caused while  ApiCallAttemptTimeoutExecute-Link and this is the same check which resets the interrupts\nApiCallAttemptTimeoutTrackingStageInterruptReset-Link.\nAPI call timer  causes context.apiCallTimeoutTracker() while the one used above is\ncontext.apiCallAttemptTimeoutTracker()", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2220#discussion_r550382676", "createdAt": "2020-12-31T02:56:02Z", "author": {"login": "joviegas"}, "path": "core/sdk-core/src/main/java/software/amazon/awssdk/core/internal/http/pipeline/stages/TimeoutExceptionHandlingStage.java", "diffHunk": "@@ -90,7 +91,8 @@ public TimeoutExceptionHandlingStage(HttpClientDependencies dependencies, Reques\n      */\n     private Exception translatePipelineException(RequestExecutionContext context, Exception e) {\n         if (e instanceof InterruptedException || e instanceof IOException ||\n-            e instanceof AbortedException || Thread.currentThread().isInterrupted()) {\n+                e instanceof AbortedException || Thread.currentThread().isInterrupted()\n+                || (e instanceof SdkClientException && isCausedByApiCallAttemptTimeout(context))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDM0NjUxOA=="}, "originalCommit": {"oid": "209764f246a19185a65e51dc6dd60c1b9d110ba0"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDY0Nzc4Mg==", "bodyText": "Okay gotcha, so if the API call timer fired (and not the attempt timer), then the exception would be AbortedException which we already handle.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2220#discussion_r550647782", "createdAt": "2020-12-31T18:56:41Z", "author": {"login": "dagnir"}, "path": "core/sdk-core/src/main/java/software/amazon/awssdk/core/internal/http/pipeline/stages/TimeoutExceptionHandlingStage.java", "diffHunk": "@@ -90,7 +91,8 @@ public TimeoutExceptionHandlingStage(HttpClientDependencies dependencies, Reques\n      */\n     private Exception translatePipelineException(RequestExecutionContext context, Exception e) {\n         if (e instanceof InterruptedException || e instanceof IOException ||\n-            e instanceof AbortedException || Thread.currentThread().isInterrupted()) {\n+                e instanceof AbortedException || Thread.currentThread().isInterrupted()\n+                || (e instanceof SdkClientException && isCausedByApiCallAttemptTimeout(context))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDM0NjUxOA=="}, "originalCommit": {"oid": "209764f246a19185a65e51dc6dd60c1b9d110ba0"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3962, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}