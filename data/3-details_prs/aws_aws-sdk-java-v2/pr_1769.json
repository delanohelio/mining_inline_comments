{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5OTQ4MjAz", "number": 1769, "title": "Integrating AWS CRT 0.5.1 into aws-crt-dev-preview", "bodyText": "Description\n\nThis points the SDK to the latest build of the Java CRT available in Maven, ie, 0.5.1, and includes any changes necessary to make that work.\nBranch includes changes from crt-api-update (#1498)\nBranch includes change from crt_v0.5.1 (alexw91@025c43c)\nI'm currently relying on the existing unit tests invoked by mvn clean install, and would be open to any other means of validating these changes if someone knows better.\n\nTesting\nmvn clean install\nTypes of changes\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-04-06T23:00:54Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1769", "merged": true, "mergeCommit": {"oid": "6e66a7cd47eef0b0b3f7ae1a2fc718c8c7219caf"}, "closed": true, "closedAt": "2020-04-07T20:54:52Z", "author": {"login": "rccarper"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVGsTngH2gAyMzk5OTQ4MjAzOjE4YzE3Yjk0ZTI5OGI3ZjQ4NjQ0ZTdmNWEyNGE1Njg0NzdkZTJhYmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVZJE9AH2gAyMzk5OTQ4MjAzOmVhNjdhNjE5NjViNWQxZDEyOWYyODNjZGU4ZmE4YmFjNDg4MDRjZjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "18c17b94e298b7f48644e7f5a24a568477de2abb", "author": {"user": {"login": "JonathanHenson", "name": "Jonathan M. Henson"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/18c17b94e298b7f48644e7f5a24a568477de2abb", "committedDate": "2020-04-06T22:46:19Z", "message": "Updated crt http client to use latest crt api, which uses byte[] for response body."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f39e59ee84e38a66e232b4b716648c6a00daf076", "author": {"user": {"login": "JonathanHenson", "name": "Jonathan M. Henson"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/f39e59ee84e38a66e232b4b716648c6a00daf076", "committedDate": "2020-04-06T22:46:19Z", "message": "Removed old comment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "037f03d3f40646c85f5430334635188a4b67eb77", "author": {"user": {"login": "JonathanHenson", "name": "Jonathan M. Henson"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/037f03d3f40646c85f5430334635188a4b67eb77", "committedDate": "2020-04-06T22:46:49Z", "message": "Fixed build failures."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37ceb5599041ab53d0d3b2c62eb8ec0f275d97c7", "author": {"user": {"login": "JonathanHenson", "name": "Jonathan M. Henson"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/37ceb5599041ab53d0d3b2c62eb8ec0f275d97c7", "committedDate": "2020-04-06T22:46:49Z", "message": "Fixed benchmark builds."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c53e1210beb8477aeed56ad2fdf1c2f0ae86d652", "author": {"user": {"login": "JonathanHenson", "name": "Jonathan M. Henson"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/c53e1210beb8477aeed56ad2fdf1c2f0ae86d652", "committedDate": "2020-04-06T22:46:49Z", "message": "Removed unused import."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20a907e3c22755a51f33e1a102902754351a74de", "author": {"user": {"login": "JonathanHenson", "name": "Jonathan M. Henson"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/20a907e3c22755a51f33e1a102902754351a74de", "committedDate": "2020-04-06T22:46:49Z", "message": "Fixed SPI test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2466d564c61f174f9cdfc1e60b8469bca6322fe", "author": {"user": {"login": "JonathanHenson", "name": "Jonathan M. Henson"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/d2466d564c61f174f9cdfc1e60b8469bca6322fe", "committedDate": "2020-04-06T22:46:49Z", "message": "Hopefully fix the build this time."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a03e35a227d318275bf8160f419b6c31202c038a", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/a03e35a227d318275bf8160f419b6c31202c038a", "committedDate": "2020-04-06T22:47:11Z", "message": "Updating SDK to work with most recent CRT\n\nFactoring out EventLoopGroup/HostResolver from client constructor, fixing bug reported by Sonar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37fe7c57d7738547944eadafd6566253ba2d332e", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/37fe7c57d7738547944eadafd6566253ba2d332e", "committedDate": "2020-04-06T22:47:11Z", "message": "Taking out incorrect try-with-resources block"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9125cb8d22978deff2a4735d4e6ca3222e7d2982", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9125cb8d22978deff2a4735d4e6ca3222e7d2982", "committedDate": "2020-04-06T22:47:11Z", "message": "Updating to latest SDK snapshot and CRT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20728ffacec7d2312832a7c8e2f92b368a71aafa", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/20728ffacec7d2312832a7c8e2f92b368a71aafa", "committedDate": "2020-04-06T22:47:11Z", "message": "Adjusting usage of builder, removing whitespace change."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6295b73edfba26ad63ff166380965b5aa0cf9038", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/6295b73edfba26ad63ff166380965b5aa0cf9038", "committedDate": "2020-04-06T22:47:11Z", "message": "Updating snapshot version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9ecbbef98f6b931e17a9692382df076274bb05f", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/e9ecbbef98f6b931e17a9692382df076274bb05f", "committedDate": "2020-04-06T22:47:11Z", "message": "Updating copyright headers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9df0bb681bc8a085c189246c811fe3c4a9a12adb", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9df0bb681bc8a085c189246c811fe3c4a9a12adb", "committedDate": "2020-04-06T22:47:11Z", "message": "Fixing checkstyle warning for 'TLS' being more than 2 consecutive capital letters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f830694d44e6e06ea068b276e081294e5af9a925", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/f830694d44e6e06ea068b276e081294e5af9a925", "committedDate": "2020-04-06T22:47:11Z", "message": "Updating snapshot and CRT version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "907a82ac86e357458e195a13d4b0ee2e1a086d14", "author": {"user": {"login": "alexw91", "name": "Alex Weibel"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/907a82ac86e357458e195a13d4b0ee2e1a086d14", "committedDate": "2020-04-06T22:47:11Z", "message": "Grabbing commit 025c43c52d4bf92ae36959e8b8a473589ba3345a: Update AWS CRT Client to work with v0.5.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a59adac604871e029ef1eb9ae99243e8babfb12", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9a59adac604871e029ef1eb9ae99243e8babfb12", "committedDate": "2020-04-06T22:47:11Z", "message": "Updating snapshot version and adding aws-crt-client to tests coverage reporting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5be5b161ef83e7201bc727a6ed336452ec3037c4", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/5be5b161ef83e7201bc727a6ed336452ec3037c4", "committedDate": "2020-04-06T22:47:11Z", "message": "Fixing copyright headers.  Fixing CRT version in sdk-benchmarks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92c24d155add0082801fe4fd4b034ea384335a50", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/92c24d155add0082801fe4fd4b034ea384335a50", "committedDate": "2020-04-06T22:47:11Z", "message": "Adding manual window management flag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b3ddc490d75fb565218c09d3d4a97fefe1542d5", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/9b3ddc490d75fb565218c09d3d4a97fefe1542d5", "committedDate": "2020-04-06T22:47:11Z", "message": "Fixing version in pom file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45ceea3cbe11210295353cdefc9984fca378bfac", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/45ceea3cbe11210295353cdefc9984fca378bfac", "committedDate": "2020-04-06T22:50:37Z", "message": "Updating pom version"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NDMwNTE3", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1769#pullrequestreview-389430517", "createdAt": "2020-04-07T19:37:02Z", "commit": {"oid": "45ceea3cbe11210295353cdefc9984fca378bfac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NDI3NjQx", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1769#pullrequestreview-389427641", "createdAt": "2020-04-07T19:32:38Z", "commit": {"oid": "45ceea3cbe11210295353cdefc9984fca378bfac"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTozMjozOVrOGCS9Vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTozNzoyOVrOGCTHIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2MDk1MQ==", "bodyText": "I\"m not sure what the purposes of these changes is. Care to enlighten me?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1769#discussion_r405060951", "createdAt": "2020-04-07T19:32:39Z", "author": {"login": "JonathanHenson"}, "path": "http-clients/aws-crt-client/src/it/java/software/amazon/awssdk/http/crt/AwsCrtClientKmsIntegrationTest.java", "diffHunk": "@@ -43,9 +47,13 @@ public void setup() {\n                 continue;\n             }\n \n+            int numThreads = 1;\n+            eventLoopGroup = new EventLoopGroup(numThreads);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45ceea3cbe11210295353cdefc9984fca378bfac"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2MTUxNg==", "bodyText": "create is a wierd verb for a builder pattern", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1769#discussion_r405061516", "createdAt": "2020-04-07T19:33:42Z", "author": {"login": "JonathanHenson"}, "path": "http-clients/aws-crt-client/src/main/java/software/amazon/awssdk/http/crt/AwsCrtAsyncHttpClient.java", "diffHunk": "@@ -135,9 +146,16 @@ private HttpClientConnectionManager createConnectionPool(URI uri) {\n         Validate.notNull(uri, \"URI must not be null\");\n         log.debug(() -> \"Creating ConnectionPool for: URI:\" + uri + \", MaxConns: \" + maxConnectionsPerEndpoint);\n \n-        return new HttpClientConnectionManager(bootstrap, socketOptions, tlsContext, uri,\n-                                                HttpClientConnectionManager.DEFAULT_MAX_BUFFER_SIZE, windowSize,\n-                                                maxConnectionsPerEndpoint);\n+        HttpClientConnectionManagerOptions options = new HttpClientConnectionManagerOptions()\n+                .withClientBootstrap(bootstrap)\n+                .withSocketOptions(socketOptions)\n+                .withTlsContext(tlsContext)\n+                .withUri(uri)\n+                .withWindowSize(windowSize)\n+                .withMaxConnections(maxConnectionsPerEndpoint)\n+                .withManualWindowManagement(manualWindowManagement);\n+\n+        return HttpClientConnectionManager.create(options);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45ceea3cbe11210295353cdefc9984fca378bfac"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA2MzQ1Ng==", "bodyText": "make sure to call out if this is ever set to true the user is responsible for calling updateWindow on the stream object.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1769#discussion_r405063456", "createdAt": "2020-04-07T19:37:29Z", "author": {"login": "JonathanHenson"}, "path": "http-clients/aws-crt-client/src/main/java/software/amazon/awssdk/http/crt/AwsCrtAsyncHttpClient.java", "diffHunk": "@@ -264,36 +281,50 @@ public void close() {\n      */\n     public interface Builder extends SdkAsyncHttpClient.Builder<AwsCrtAsyncHttpClient.Builder> {\n \n-        /**\n-         * The number of Threads to use in the EventLoop.\n-         * @param eventLoopSize The number of Threads to use in the EventLoop.\n-         * @return the builder of the method chaining.\n-         */\n-        Builder eventLoopSize(int eventLoopSize);\n-\n         /**\n          * The AWS CRT TlsCipherPreference to use for this Client\n          * @param tlsCipherPreference The AWS Common Runtime TlsCipherPreference\n-         * @return the builder of the method chaining.\n+         * @return The builder of the method chaining.\n          */\n         Builder tlsCipherPreference(TlsCipherPreference tlsCipherPreference);\n \n         /**\n          * Whether or not to Verify the Peer's TLS Certificate Chain.\n          * @param verifyPeer true if the Certificate Chain should be validated, false if validation should be skipped.\n-         * @return the builder of the method chaining.\n+         * @return The builder of the method chaining.\n          */\n         Builder verifyPeer(boolean verifyPeer);\n \n+        /**\n+         * If set to true, then the TCP read back pressure mechanism will be enabled.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45ceea3cbe11210295353cdefc9984fca378bfac"}, "originalPosition": 146}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea67a61965b5d1d129f283cde8fa8bac48804cf9", "author": {"user": {"login": "rccarper", "name": "Ryan Carper"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/ea67a61965b5d1d129f283cde8fa8bac48804cf9", "committedDate": "2020-04-07T20:16:02Z", "message": "Updating comment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2504, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}