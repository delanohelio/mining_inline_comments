{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2MjY0NzA3", "number": 2199, "title": "Merge evenstream generation fixes", "bodyText": "Description\nMerge in the event stream code generation fixes from dongie/eventstream-visitors-fix branch.\nMotivation and Context\nBug fix.\nTesting\n\n\n\nScreenshots (if appropriate)\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n\n\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-12-10T21:20:13Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2199", "merged": true, "mergeCommit": {"oid": "d0b3942d16cc9dd36876edc19f6a16930b49a7f4"}, "closed": true, "closedAt": "2020-12-16T23:50:11Z", "author": {"login": "dagnir"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdS5yxXgH2gAyNTM2MjY0NzA3OmFkNjU0NGMwNTBmNzZmM2RiOTE0YWU5OTgxMGMyZWYwZjU3Njc5NGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdm3QJDAFqTU1NDE1ODc2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ad6544c050f76f3db914ae99810c2ef0f576794a", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/ad6544c050f76f3db914ae99810c2ef0f576794a", "committedDate": "2020-10-15T22:47:55Z", "message": "Include event type in visitor name\n\nThis commit fixes event visitor method generation by including the *event type*\nin the visitor name. Note that event type here is actually the member name in\nthe encompassing eventstream structure, *not* the Java class of the event.\n\nFor example, in the example below, \"Foo\" is the event type.\n\n\"MyEventStream\": {\n   \"type\": \"structure\",\n   \"eventstream\": true,\n   \"members\": {\n       \"Foo\": {\n           \"shape\": \"Bar\"\n       }\n   }\n}\n\nTo ensure that this change is backwards compatible with existing services that\nhave event streams (Transcribe Streaming and Kinesis), we also include a\ncustomization to supress this behavior keep the method name as \"visit\".\n\nNote that by sheer luck, the existing consumer method setters, e.g.\n\nBuilder onSubscribeToShardEvent(Consumer<SubscribeToShardEvent>);\n\nare unaffected by this change. The previous generation scheme for these methods\nis \"on{Generation Java class name for event shape}\"; now it's \"on{event type}\".\nHowever, both Transcribe and Kinesis use the shape name as the member name (or\nvise versa?) in their current iteration of their event streams.\n\nFor example, in Kinesis, SubscribeToShard's output stream is defined as\n\n\"SubscribeToShardEventStream\":{\n  \"type\":\"structure\",\n  \"required\":[\"SubscribeToShardEvent\"],\n  \"members\":{\n    \"SubscribeToShardEvent\":{\"shape\":\"SubscribeToShardEvent\"},\n\n    ...\n    },\n  \"eventstream\":true\n}"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d50b76b8fc2a1ff0ba1239611a7e4deb7085dca0", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/d50b76b8fc2a1ff0ba1239611a7e4deb7085dca0", "committedDate": "2020-10-24T00:44:15Z", "message": "Subclass events to do visitor dispatch\n\nGenerate events as discrete subclasses of the base shape class that take care\ndispatching to the correct visitor method. The base shape is what we would\ngenerate as a normal model class for a non request/response shape today.\nHowever, because they need to be extended, they are no longer final; insteach\nany method that can be made final (such as property getters) is made final.\n\nThis commit also generates static builder methods on the event stream interface\nto make discovery and creation of events easier."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "294927b791b09a654a1cd95972722b1aba1c6d50", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/294927b791b09a654a1cd95972722b1aba1c6d50", "committedDate": "2020-12-03T22:55:50Z", "message": "Merge remote-tracking branch 'origin/master' into dongie/eventstream-visitors-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7d882db40170d1684ad84b5ebdcb14cc582721d", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/e7d882db40170d1684ad84b5ebdcb14cc582721d", "committedDate": "2020-12-03T23:31:44Z", "message": "Merge pull request #2181 from dagnir/eventstream-visitors-fix-merge\n\nEventstream visitors fix merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/32cd8d61bc470ef325477fa29af90d5b8c12b2b4", "committedDate": "2020-12-04T01:48:13Z", "message": "Expose event-type in stream interface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "308e493546ded28c5784a91b29704a4f2a7943e3", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/308e493546ded28c5784a91b29704a4f2a7943e3", "committedDate": "2020-12-04T21:39:34Z", "message": "Merge pull request #2176 from aws/sdk-event-type-getter\n\nExpose event-type in stream interface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65534411b9103a835d1f585a89275e9d210c4a98", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/65534411b9103a835d1f585a89275e9d210c4a98", "committedDate": "2020-12-07T19:24:19Z", "message": "Event transformation based on type\n\nFixes event marshalling and unmarshalling:\n\n - Fix unmarshalling by mapping event type to the correct builder static\n   constructor on the eventstream interface.\n\n - Fix marshalling by retrieving the value for the :event-type header from the\n   event using getSdkEventType()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMDU4OTQ5", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2199#pullrequestreview-552058949", "createdAt": "2020-12-15T02:31:03Z", "commit": {"oid": "a92d99717f294253bb7819c4fe4bc9b2aed9226f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMjozMTowNFrOIF1_LQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMjozMTowNFrOIF1_LQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjk5ODMxNw==", "bodyText": "Do we need the copy right statement here?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2199#discussion_r542998317", "createdAt": "2020-12-15T02:31:04Z", "author": {"login": "Quanzzzz"}, "path": "codegen/src/test/java/software/amazon/awssdk/codegen/poet/eventstream/EventModelSpecTest.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package software.amazon.awssdk.codegen.poet.eventstream;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a92d99717f294253bb7819c4fe4bc9b2aed9226f"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e55e8f40de2ad8ef4172675223215af08e2bbd9", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/2e55e8f40de2ad8ef4172675223215af08e2bbd9", "committedDate": "2020-12-15T22:02:47Z", "message": "Merge remote-tracking branch 'origin/master' into dongie/eventstream-visitors-fix"}, "afterCommit": {"oid": "2349c2eb63044cb617a6e28dff4e9a08c41d71f3", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/2349c2eb63044cb617a6e28dff4e9a08c41d71f3", "committedDate": "2020-12-15T23:42:41Z", "message": "Add legacy gen for MedicalTranscriptResultStream\n\nMedicalTranscriptResultStream$TrancriptEvent was released with the existing code\ngeneration scheme so it needs to be customized."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2349c2eb63044cb617a6e28dff4e9a08c41d71f3", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/2349c2eb63044cb617a6e28dff4e9a08c41d71f3", "committedDate": "2020-12-15T23:42:41Z", "message": "Add legacy gen for MedicalTranscriptResultStream\n\nMedicalTranscriptResultStream$TrancriptEvent was released with the existing code\ngeneration scheme so it needs to be customized."}, "afterCommit": {"oid": "2e55e8f40de2ad8ef4172675223215af08e2bbd9", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/2e55e8f40de2ad8ef4172675223215af08e2bbd9", "committedDate": "2020-12-15T22:02:47Z", "message": "Merge remote-tracking branch 'origin/master' into dongie/eventstream-visitors-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1ad3aa118437458d36b906f41ed9e97ef0f6cea", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/a1ad3aa118437458d36b906f41ed9e97ef0f6cea", "committedDate": "2020-12-16T00:15:53Z", "message": "Add legacy gen for MedicalTranscriptResultStream\n\nMedicalTranscriptResultStream$TrancriptEvent was released with the existing code\ngeneration scheme so it needs to be customized."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8dd326d373bd2fd8277707b8290f2424397bcd6", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/b8dd326d373bd2fd8277707b8290f2424397bcd6", "committedDate": "2020-12-16T19:51:51Z", "message": "Add validation for new streams\n\nValidation is only for Kinesis, Transcribe Streaming, since they have existing\nstreams generated with the old style."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c77cecda8e1aac79f748c7f30b802e7242e591b4", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/c77cecda8e1aac79f748c7f30b802e7242e591b4", "committedDate": "2020-12-16T19:56:42Z", "message": "Merge remote-tracking branch 'origin/master' into dongie/eventstream-visitors-fix"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e55e8f40de2ad8ef4172675223215af08e2bbd9", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/2e55e8f40de2ad8ef4172675223215af08e2bbd9", "committedDate": "2020-12-15T22:02:47Z", "message": "Merge remote-tracking branch 'origin/master' into dongie/eventstream-visitors-fix"}, "afterCommit": {"oid": "c77cecda8e1aac79f748c7f30b802e7242e591b4", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/c77cecda8e1aac79f748c7f30b802e7242e591b4", "committedDate": "2020-12-16T19:56:42Z", "message": "Merge remote-tracking branch 'origin/master' into dongie/eventstream-visitors-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b67c0cc9f71725a649086ba78dfff86e94de4c76", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/b67c0cc9f71725a649086ba78dfff86e94de4c76", "committedDate": "2020-12-16T22:52:02Z", "message": "Don't strip SafeVarargs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd35d3a6e701924716771aecf7076ff61ef2a236", "author": {"user": {"login": "dagnir", "name": "Dongie Agnir"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/bd35d3a6e701924716771aecf7076ff61ef2a236", "committedDate": "2020-12-16T22:53:02Z", "message": "Add changelog entry"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0MTU3OTky", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2199#pullrequestreview-554157992", "createdAt": "2020-12-16T23:07:09Z", "commit": {"oid": "bd35d3a6e701924716771aecf7076ff61ef2a236"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0MTU4NzY5", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2199#pullrequestreview-554158769", "createdAt": "2020-12-16T23:08:46Z", "commit": {"oid": "bd35d3a6e701924716771aecf7076ff61ef2a236"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2396, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}