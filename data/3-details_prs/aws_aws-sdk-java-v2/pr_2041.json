{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4ODA0MzMx", "number": 2041, "title": "Parse XML errors like in S3", "bodyText": "Changes the definition of the document error root to what is used in AWS S3, so that errors are fully parsed.\nMotivation and Context\nTo this point, errors returned from S3Control have lost their XML content and only the error type has been returned, showing null:\nsoftware.amazon.awssdk.services.s3control.model.S3ControlException: null\n\nWith this change, errors are parsed correctly as:\nsoftware.amazon.awssdk.services.s3control.model.S3ControlException: Missing role arn \n(Service: S3Control, Status Code: 400, Request ID: 4T5H9GEV7H3K9MCJ, Extended Request ID: USkN9APZoEVT0...)\n\nTesting\n\nUnit tests and functional tests\n\nTypes of changes\n\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n\n\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-09-17T16:53:08Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2041", "merged": true, "mergeCommit": {"oid": "e4cbcb90dea31f631a80254f5aec6ea53d91de12"}, "closed": true, "closedAt": "2020-09-18T16:59:56Z", "author": {"login": "cenedhryn"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJ1lhDAFqTQ5MDg3NDQ2Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJ6IXTgFqTQ5MTA2NjU2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwODc0NDY3", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2041#pullrequestreview-490874467", "createdAt": "2020-09-17T18:27:10Z", "commit": {"oid": "4c969c0e4b9ec01e891f129cb4e6c589c4442224"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxODoyNzoxMFrOHTv1Ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxODo0NjoyOVrOHTwe8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2ODY2Mg==", "bodyText": "We shouldn't add log4j.properties in the main resources", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2041#discussion_r490468662", "createdAt": "2020-09-17T18:27:10Z", "author": {"login": "dagnir"}, "path": "services/s3control/src/main/resources/log4j.properties", "diffHunk": "@@ -0,0 +1,33 @@\n+#", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c969c0e4b9ec01e891f129cb4e6c589c4442224"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ3OTM0Ng==", "bodyText": "Thinking about this some more, I'm not sure that this is the right behavior; it's possible that the user could still want this behavior even with an endpoint override.\nCan we leave this change out of the client for now? For testing, we can we can just add a new client interceptor that changes the request URL to the WireMock host before it's sent.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2041#discussion_r490479346", "createdAt": "2020-09-17T18:46:29Z", "author": {"login": "dagnir"}, "path": "services/s3control/src/main/java/software/amazon/awssdk/services/s3control/internal/interceptors/EndpointAddressInterceptor.java", "diffHunk": "@@ -81,7 +86,7 @@ private String resolveHost(SdkHttpRequest request, String accountId, S3ControlCo\n \n         }\n         validateComponentIsHostnameCompliant(accountId, \"account id\");\n-        return String.format(\"%s.%s\", accountId, host);\n+        return hasEndpointOverride ? host : String.format(\"%s.%s\", accountId, host);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c969c0e4b9ec01e891f129cb4e6c589c4442224"}, "originalPosition": 34}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c969c0e4b9ec01e891f129cb4e6c589c4442224", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/4c969c0e4b9ec01e891f129cb4e6c589c4442224", "committedDate": "2020-09-17T16:39:16Z", "message": "Changes document error root definition for XML based errors to same as AWS S3, so that errors are fully parsed. This change also adds honoring endpoint overrides for the S3 Control client."}, "afterCommit": {"oid": "4ef8508945adef1bbb0f59809432835e56e85cb5", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/4ef8508945adef1bbb0f59809432835e56e85cb5", "committedDate": "2020-09-17T22:39:15Z", "message": "Changes document error root definition for XML based errors to same as AWS S1, so that errors are fully parsed. This change also adds honoring endpoint overrides for the S3 Control client."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMDM4OTY4", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2041#pullrequestreview-491038968", "createdAt": "2020-09-17T22:45:18Z", "commit": {"oid": "4ef8508945adef1bbb0f59809432835e56e85cb5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjo0NToxOFrOHT4CCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMjo0NToxOFrOHT4CCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDYwMzAxOA==", "bodyText": "New changes look good, but looks like this still needs to be reverted along with the accompanying test.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2041#discussion_r490603018", "createdAt": "2020-09-17T22:45:18Z", "author": {"login": "dagnir"}, "path": "services/s3control/src/main/java/software/amazon/awssdk/services/s3control/internal/interceptors/EndpointAddressInterceptor.java", "diffHunk": "@@ -81,7 +86,7 @@ private String resolveHost(SdkHttpRequest request, String accountId, S3ControlCo\n \n         }\n         validateComponentIsHostnameCompliant(accountId, \"account id\");\n-        return String.format(\"%s.%s\", accountId, host);\n+        return hasEndpointOverride ? host : String.format(\"%s.%s\", accountId, host);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ef8508945adef1bbb0f59809432835e56e85cb5"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ccfa146e55d0261408557fa525ee3ec9b0ca7d9", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/2ccfa146e55d0261408557fa525ee3ec9b0ca7d9", "committedDate": "2020-09-18T00:00:13Z", "message": "Changes document error root definition for XML based errors to same as AWS S1, so that errors are fully parsed. This change also adds honoring endpoint overrides for the S3 Control client."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ef8508945adef1bbb0f59809432835e56e85cb5", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/4ef8508945adef1bbb0f59809432835e56e85cb5", "committedDate": "2020-09-17T22:39:15Z", "message": "Changes document error root definition for XML based errors to same as AWS S1, so that errors are fully parsed. This change also adds honoring endpoint overrides for the S3 Control client."}, "afterCommit": {"oid": "2ccfa146e55d0261408557fa525ee3ec9b0ca7d9", "author": {"user": {"login": "cenedhryn", "name": "Anna-Karin Salander"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/2ccfa146e55d0261408557fa525ee3ec9b0ca7d9", "committedDate": "2020-09-18T00:00:13Z", "message": "Changes document error root definition for XML based errors to same as AWS S1, so that errors are fully parsed. This change also adds honoring endpoint overrides for the S3 Control client."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxMDY2NTY0", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2041#pullrequestreview-491066564", "createdAt": "2020-09-18T00:06:11Z", "commit": {"oid": "2ccfa146e55d0261408557fa525ee3ec9b0ca7d9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2464, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}