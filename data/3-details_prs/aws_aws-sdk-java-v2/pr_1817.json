{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0MjgxOTg3", "number": 1817, "title": "Fix generation for services that contain operations with the same name as the service", "bodyText": "Description\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.\u00a0 This adds 'Default' to the concrete class names only in cases where there is an operation with a clashing name.\nMotivation and Context\nSome simpler microservices do not adhere to the standard naming guidelines.  This allows clients to be generated for them.\nTesting\nThis should only impact models for which non-compiling code would be generated today.  This was tested with a simple unit test, and out-of-band against a similar service model end-to-end.\nScreenshots (if appropriate)\nTypes of changes\n\n Bug fix (non-breaking change which fixes an issue)\n New feature (non-breaking change which adds functionality)\n\nChecklist\n\n\n\n I have read the CONTRIBUTING document\n Local run of mvn install succeeds\n My code follows the code style of this project\n My change requires a change to the Javadoc documentation\n I have updated the Javadoc documentation accordingly\n I have read the README document\n I have added tests to cover my changes\n All new and existing tests passed\n A short description of the change has been added to the CHANGELOG\n My change is to implement 1.11 parity feature and I have updated LaunchChangelog\n\nLicense\n\n\n\n\n I confirm that this pull request can be released under the Apache 2 license", "createdAt": "2020-05-06T19:12:45Z", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1817", "merged": true, "mergeCommit": {"oid": "ad3af5a6382c92522e7d50ce121546aa574b050b"}, "closed": true, "closedAt": "2020-05-14T19:08:15Z", "author": {"login": "adamthom-amzn"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcevIm4gBqjMzMTAyNzE4ODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchSGIJAH2gAyNDE0MjgxOTg3OjFiZTBlNTZjZGMzYzE3YzhiOTA1ZTMyOGZlYzRhYjNmYWIwNTk4MjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ecc10958178e7a2d0d6b78c73e7dbeafb51fd09b", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/ecc10958178e7a2d0d6b78c73e7dbeafb51fd09b", "committedDate": "2020-05-06T19:13:02Z", "message": "Merge branch 'master' into service-operation-collision"}, "afterCommit": {"oid": "d4aa4fde8ecaf0f1efec7976bb354b2447c39e0f", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/d4aa4fde8ecaf0f1efec7976bb354b2447c39e0f", "committedDate": "2020-05-06T20:44:58Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Base' to the abstract base class name only in cases where there is an operation with a clashing name."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4aa4fde8ecaf0f1efec7976bb354b2447c39e0f", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/d4aa4fde8ecaf0f1efec7976bb354b2447c39e0f", "committedDate": "2020-05-06T20:44:58Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Base' to the abstract base class name only in cases where there is an operation with a clashing name."}, "afterCommit": {"oid": "4f24f456f3282eca1a6cd78f6deff551ba61b1e1", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/4f24f456f3282eca1a6cd78f6deff551ba61b1e1", "committedDate": "2020-05-06T21:04:17Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Default' to the concrete class names only in cases where there is an operation with a clashing name."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f24f456f3282eca1a6cd78f6deff551ba61b1e1", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/4f24f456f3282eca1a6cd78f6deff551ba61b1e1", "committedDate": "2020-05-06T21:04:17Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Default' to the concrete class names only in cases where there is an operation with a clashing name."}, "afterCommit": {"oid": "12c1b8f767e807fac62f05e5725eda4482b12100", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/12c1b8f767e807fac62f05e5725eda4482b12100", "committedDate": "2020-05-06T22:16:46Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Default' to the concrete class names only in cases where there is an operation with a clashing name."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzEzNDg1", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1817#pullrequestreview-410313485", "createdAt": "2020-05-12T18:29:46Z", "commit": {"oid": "12c1b8f767e807fac62f05e5725eda4482b12100"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxODoyOTo0NlrOGUToYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxODoyOTo0NlrOGUToYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk0NjMzOA==", "bodyText": "assertThat(testModel.getShapes().values())\n    .extracting(ShapeModel::getShapeName)\n    .containsExactlyInAnyOrder(\"DefaultCollisionException\", \"DefaultCollisionRequest\", \"DefaultCollisionResponse\");\n?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1817#discussion_r423946338", "createdAt": "2020-05-12T18:29:46Z", "author": {"login": "millems"}, "path": "codegen/src/test/java/software/amazon/awssdk/codegen/IntermediateModelBuilderTest.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package software.amazon.awssdk.codegen;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import java.io.File;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.stream.Collectors;\n+import org.junit.Test;\n+import software.amazon.awssdk.codegen.model.config.customization.CustomizationConfig;\n+import software.amazon.awssdk.codegen.model.intermediate.IntermediateModel;\n+import software.amazon.awssdk.codegen.model.service.ServiceModel;\n+import software.amazon.awssdk.codegen.utils.ModelLoaderUtils;\n+\n+public class IntermediateModelBuilderTest {\n+\n+    @Test\n+    public void testServiceAndShapeNameCollisions() throws Exception {\n+        final File modelFile = new File(IntermediateModelBuilderTest.class\n+                                            .getResource(\"poet/client/c2j/collision/service-2.json\").getFile());\n+        IntermediateModel testModel = new IntermediateModelBuilder(\n+            C2jModels.builder()\n+                     .serviceModel(ModelLoaderUtils.loadModel(ServiceModel.class, modelFile))\n+                     .customizationConfig(CustomizationConfig.create())\n+                     .build())\n+            .build();\n+\n+        assertEquals(new HashSet<>(Arrays.asList(\"DefaultCollisionException\", \"DefaultCollisionRequest\", \"DefaultCollisionResponse\")),\n+                     testModel.getShapes().values().stream().map(s -> s.getShapeName()).collect(Collectors.toSet()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "12c1b8f767e807fac62f05e5725eda4482b12100"}, "originalPosition": 44}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "448bd1d26a36747f9a06b2b703816e03a2f24903", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/448bd1d26a36747f9a06b2b703816e03a2f24903", "committedDate": "2020-05-12T18:31:17Z", "message": "Merge branch 'master' into service-operation-collision"}, "afterCommit": {"oid": "24fca8727455b2a15693dd79a976d5ca7fd24f7e", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/24fca8727455b2a15693dd79a976d5ca7fd24f7e", "committedDate": "2020-05-12T21:54:32Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Default' to the concrete class names only in cases where there is an operation with a clashing name."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMjQ0ODEw", "url": "https://github.com/aws/aws-sdk-java-v2/pull/1817#pullrequestreview-411244810", "createdAt": "2020-05-13T19:44:50Z", "commit": {"oid": "24fca8727455b2a15693dd79a976d5ca7fd24f7e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c720a3d92e7d6d80edd09ef6f9014c99ec2815f", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/1c720a3d92e7d6d80edd09ef6f9014c99ec2815f", "committedDate": "2020-05-13T21:37:41Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Default' to the concrete class names only in cases where there is an operation with a clashing name."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "24fca8727455b2a15693dd79a976d5ca7fd24f7e", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/24fca8727455b2a15693dd79a976d5ca7fd24f7e", "committedDate": "2020-05-12T21:54:32Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Default' to the concrete class names only in cases where there is an operation with a clashing name."}, "afterCommit": {"oid": "1c720a3d92e7d6d80edd09ef6f9014c99ec2815f", "author": {"user": {"login": "adamthom-amzn", "name": "Adam Thomas"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/1c720a3d92e7d6d80edd09ef6f9014c99ec2815f", "committedDate": "2020-05-13T21:37:41Z", "message": "Fix generation for services that contain operations with the same name as the service.\n\nIf a 'FooService' contains an operation named 'Foo', the generator will attempt to generate a 'FooRequest' that extends an abstract 'FooRequest'.  This adds 'Default' to the concrete class names only in cases where there is an operation with a clashing name."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1be0e56cdc3c17c8b905e328fec4ab3fab059825", "author": {"user": {"login": "millems", "name": "Matthew Miller"}}, "url": "https://github.com/aws/aws-sdk-java-v2/commit/1be0e56cdc3c17c8b905e328fec4ab3fab059825", "committedDate": "2020-05-14T18:50:34Z", "message": "Merge branch 'master' into service-operation-collision"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2541, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}