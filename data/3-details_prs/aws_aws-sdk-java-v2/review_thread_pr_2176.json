{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwNjc3NDQx", "number": 2176, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTowNDowNVrOE_zwUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMDo0Nzo1NFrOFA-RzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MzQzNjk3OnYy", "diffSide": "RIGHT", "path": "codegen/src/main/java/software/amazon/awssdk/codegen/poet/model/AwsServiceModel.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTowNDowNVrOH9uEew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTowNDowNVrOH9uEew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ3OTk5NQ==", "bodyText": "nit: can we extract it to a separate method?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r534479995", "createdAt": "2020-12-02T21:04:05Z", "author": {"login": "zoewangg"}, "path": "codegen/src/main/java/software/amazon/awssdk/codegen/poet/model/AwsServiceModel.java", "diffHunk": "@@ -203,6 +210,30 @@ private void addEventSupport(TypeSpec.Builder specBuilder, ShapeModel eventStrea\n \n         specBuilder.addSuperinterface(eventStreamClassName);\n \n+        // This is hacky, but there's no better solution without\n+        // extensive refactoring. We basically need to know if any of\n+        // the *event types* within this even stream have this\n+        // customization enabled, which requires knowing the\n+        // MemberModel that has this given shape.\n+        boolean usesLegacyScheme = false;\n+        String eventName = null;\n+        for (MemberModel member : eventStream.getMembers()) {\n+            if (member.getShape().equals(shapeModel) && helper.useLegacyGenerationScheme(member)) {\n+                usesLegacyScheme = true;\n+                eventName = member.getName();\n+                break;\n+            }\n+        }\n+\n+        if (usesLegacyScheme) {\n+            specBuilder.addMethod(MethodSpec.methodBuilder(\"sdkEventType\")\n+                       .addAnnotation(Override.class)\n+                       .addModifiers(PUBLIC)\n+                       .returns(String.class)\n+                       .addStatement(\"return $S\", eventName)\n+                       .build());\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1MzQzOTU1OnYy", "diffSide": "RIGHT", "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/sharedstream/eventstream.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMTowNDo0M1rOH9uF6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMToxOToyN1rOH9ukPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MDM2Mg==", "bodyText": "Should we use enum for the type?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r534480362", "createdAt": "2020-12-02T21:04:43Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/sharedstream/eventstream.java", "diffHunk": "@@ -41,6 +41,13 @@ public void accept(StreamDeathsResponseHandler.Visitor visitor) {\n         return DefaultPerson.builder();\n     }\n \n+    /**\n+     * The type of this event. Corresponds to the {@code :event-type} header on the Message.\n+     */\n+    default String sdkEventType() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4NDk4OA==", "bodyText": "What's the benefit?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r534484988", "createdAt": "2020-12-02T21:13:28Z", "author": {"login": "dagnir"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/sharedstream/eventstream.java", "diffHunk": "@@ -41,6 +41,13 @@ public void accept(StreamDeathsResponseHandler.Visitor visitor) {\n         return DefaultPerson.builder();\n     }\n \n+    /**\n+     * The type of this event. Corresponds to the {@code :event-type} header on the Message.\n+     */\n+    default String sdkEventType() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MDM2Mg=="}, "originalCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4Njc3NQ==", "bodyText": "It'll be easier to enumerate all types when they do switch, whereas with string, they will need to manually check the code to see all available types.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r534486775", "createdAt": "2020-12-02T21:16:49Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/sharedstream/eventstream.java", "diffHunk": "@@ -41,6 +41,13 @@ public void accept(StreamDeathsResponseHandler.Visitor visitor) {\n         return DefaultPerson.builder();\n     }\n \n+    /**\n+     * The type of this event. Corresponds to the {@code :event-type} header on the Message.\n+     */\n+    default String sdkEventType() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MDM2Mg=="}, "originalCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4ODEyNg==", "bodyText": "Sounds good.", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r534488126", "createdAt": "2020-12-02T21:19:27Z", "author": {"login": "dagnir"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/model/sharedstream/eventstream.java", "diffHunk": "@@ -41,6 +41,13 @@ public void accept(StreamDeathsResponseHandler.Visitor visitor) {\n         return DefaultPerson.builder();\n     }\n \n+    /**\n+     * The type of this event. Corresponds to the {@code :event-type} header on the Message.\n+     */\n+    default String sdkEventType() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MDM2Mg=="}, "originalCommit": {"oid": "c39678a67a5b856ec0c0712432a1d0148eea5976"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2NTU1MjYzOnYy", "diffSide": "RIGHT", "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/defaulteventtwo.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMDoxOTo0MlrOH_gohw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMToyMTo0M1rOH_ictA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM1Njk5OQ==", "bodyText": "Typo? EventStream$EventTwo -> EventStream#EventTwo", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r536356999", "createdAt": "2020-12-04T20:19:42Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/defaulteventtwo.java", "diffHunk": "@@ -1,14 +1,16 @@\n-package software.amazon.awssdk.services.jsonprotocoltests.model.eventstream;\n+package software.amazon.awssdk.services.json.model.eventstream;\n \n import software.amazon.awssdk.annotations.Generated;\n import software.amazon.awssdk.annotations.SdkInternalApi;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventStreamOperationResponseHandler;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo;\n+import software.amazon.awssdk.services.json.model.EventStream;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationWithOnlyOutputResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventTwo;\n \n /**\n- * A specialization of {@code software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo} that represents the\n- * {@code EventStream#EventTwo} event. Do not use this class directly. Instead, use the static builder methods on\n- * {@link software.amazon.awssdk.services.jsonprotocoltests.model.EventStream}.\n+ * A specialization of {@code software.amazon.awssdk.services.json.model.EventTwo} that represents the\n+ * {@code EventStream$EventTwo} event. Do not use this class directly. Instead, use the static builder methods on", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM4Njc0MA==", "bodyText": "No, decided to use the C2j notation", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r536386740", "createdAt": "2020-12-04T21:21:43Z", "author": {"login": "dagnir"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/defaulteventtwo.java", "diffHunk": "@@ -1,14 +1,16 @@\n-package software.amazon.awssdk.services.jsonprotocoltests.model.eventstream;\n+package software.amazon.awssdk.services.json.model.eventstream;\n \n import software.amazon.awssdk.annotations.Generated;\n import software.amazon.awssdk.annotations.SdkInternalApi;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventStreamOperationResponseHandler;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo;\n+import software.amazon.awssdk.services.json.model.EventStream;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationWithOnlyOutputResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventTwo;\n \n /**\n- * A specialization of {@code software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo} that represents the\n- * {@code EventStream#EventTwo} event. Do not use this class directly. Instead, use the static builder methods on\n- * {@link software.amazon.awssdk.services.jsonprotocoltests.model.EventStream}.\n+ * A specialization of {@code software.amazon.awssdk.services.json.model.EventTwo} that represents the\n+ * {@code EventStream$EventTwo} event. Do not use this class directly. Instead, use the static builder methods on", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM1Njk5OQ=="}, "originalCommit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2NTY0Njg1OnYy", "diffSide": "RIGHT", "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/defaultsecondeventtwo.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMDo0Nzo1NFrOH_hd-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQyMToyMjo0MlrOH_ieqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM3MDY4Mw==", "bodyText": "Is this change intentional? Shouldn't it be DefaultSecondEventTwo?", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r536370683", "createdAt": "2020-12-04T20:47:54Z", "author": {"login": "zoewangg"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/defaultsecondeventtwo.java", "diffHunk": "@@ -1,21 +1,23 @@\n-package software.amazon.awssdk.services.jsonprotocoltests.model.eventstream;\n+package software.amazon.awssdk.services.json.model.eventstream;\n \n import software.amazon.awssdk.annotations.Generated;\n import software.amazon.awssdk.annotations.SdkInternalApi;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventStreamOperationResponseHandler;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo;\n+import software.amazon.awssdk.services.json.model.EventStream;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationWithOnlyOutputResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventTwo;\n \n /**\n- * A specialization of {@code software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo} that represents the\n- * {@code EventStream#SecondEventTwo} event. Do not use this class directly. Instead, use the static builder methods on\n- * {@link software.amazon.awssdk.services.jsonprotocoltests.model.EventStream}.\n+ * A specialization of {@code software.amazon.awssdk.services.json.model.EventTwo} that represents the\n+ * {@code EventStream$secondeventtwo} event. Do not use this class directly. Instead, use the static builder methods on\n+ * {@link software.amazon.awssdk.services.json.model.EventStream}.\n  */\n @SdkInternalApi\n @Generated(\"software.amazon.awssdk:codegen\")\n-public final class DefaultSecondEventTwo extends EventTwo {\n+public final class DefaultSecondeventtwo extends EventTwo {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM4NzI0MA==", "bodyText": "It's a little confusing, but this one corresponds to this event \n  \n    \n      aws-sdk-java-v2/codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/service-2.json\n    \n    \n         Line 106\n      in\n      32cd8d6\n    \n    \n    \n    \n\n        \n          \n           \"secondeventtwo\": {", "url": "https://github.com/aws/aws-sdk-java-v2/pull/2176#discussion_r536387240", "createdAt": "2020-12-04T21:22:42Z", "author": {"login": "dagnir"}, "path": "codegen/src/test/resources/software/amazon/awssdk/codegen/poet/eventstream/defaultsecondeventtwo.java", "diffHunk": "@@ -1,21 +1,23 @@\n-package software.amazon.awssdk.services.jsonprotocoltests.model.eventstream;\n+package software.amazon.awssdk.services.json.model.eventstream;\n \n import software.amazon.awssdk.annotations.Generated;\n import software.amazon.awssdk.annotations.SdkInternalApi;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventStreamOperationResponseHandler;\n-import software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo;\n+import software.amazon.awssdk.services.json.model.EventStream;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventStreamOperationWithOnlyOutputResponseHandler;\n+import software.amazon.awssdk.services.json.model.EventTwo;\n \n /**\n- * A specialization of {@code software.amazon.awssdk.services.jsonprotocoltests.model.EventTwo} that represents the\n- * {@code EventStream#SecondEventTwo} event. Do not use this class directly. Instead, use the static builder methods on\n- * {@link software.amazon.awssdk.services.jsonprotocoltests.model.EventStream}.\n+ * A specialization of {@code software.amazon.awssdk.services.json.model.EventTwo} that represents the\n+ * {@code EventStream$secondeventtwo} event. Do not use this class directly. Instead, use the static builder methods on\n+ * {@link software.amazon.awssdk.services.json.model.EventStream}.\n  */\n @SdkInternalApi\n @Generated(\"software.amazon.awssdk:codegen\")\n-public final class DefaultSecondEventTwo extends EventTwo {\n+public final class DefaultSecondeventtwo extends EventTwo {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM3MDY4Mw=="}, "originalCommit": {"oid": "32cd8d61bc470ef325477fa29af90d5b8c12b2b4"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3939, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}