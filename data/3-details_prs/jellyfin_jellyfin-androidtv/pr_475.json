{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3OTgwMTky", "number": 475, "title": "Add support for vertical grids", "bodyText": "This adds some more poetry and spaghetti to the grid code to allow vertical grids! A user preference is added and will default to the new vertical view.\nChanges\n\nAdd new preference \"grid direction\"\nCan be vertical or horizontal\nAdd new vertical grid direction\n\n\nIssues\n\nCloses #317", "createdAt": "2020-05-14T12:59:16Z", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475", "merged": true, "mergeCommit": {"oid": "3bca99d058331a5dbdf08f9e25850a6a93296b3e"}, "closed": true, "closedAt": "2020-05-22T17:07:19Z", "author": {"login": "nielsvanvelzen"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciMNlEABqjMzNDQ2MDg2MDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcj1GTUgBqjMzNjU0NjE4MDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f04afa500e02aa675b319ac8c5b66adf80e47d35", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/f04afa500e02aa675b319ac8c5b66adf80e47d35", "committedDate": "2020-05-15T19:47:55Z", "message": "Fix TODO"}, "afterCommit": {"oid": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba", "committedDate": "2020-05-17T14:31:33Z", "message": "Fix TODO"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NDI3NTMy", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#pullrequestreview-415427532", "createdAt": "2020-05-20T14:59:23Z", "commit": {"oid": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNDo1OToyM1rOGYQGNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNTowMjoxNVrOGYQQAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4Mjc0Mw==", "bodyText": "todo?", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428082743", "createdAt": "2020-05-20T14:59:23Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/StdGridFragment.java", "diffHunk": "@@ -594,7 +602,12 @@ public void run() {\n     private void refreshCurrentItem() {\n         if (MediaManager.getCurrentMediaPosition() >= 0) {\n             mCurrentItem = MediaManager.getCurrentMediaItem();\n-            getGridPresenter().setPosition(MediaManager.getCurrentMediaPosition());\n+\n+            Presenter presenter = getGridPresenter();\n+            if (presenter instanceof HorizontalGridPresenter)\n+                ((HorizontalGridPresenter) presenter).setPosition(MediaManager.getCurrentMediaPosition());\n+            //tood vertical?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba"}, "originalPosition": 124}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NDM3MQ==", "bodyText": "I think this does need to change based on the image size selected. For example small images look rather strange currently...", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428084371", "createdAt": "2020-05-20T15:01:01Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/StdGridFragment.java", "diffHunk": "@@ -131,15 +134,27 @@ public void onCreate(Bundle savedInstanceState) {\n \n         mCardHeight = getCardHeight(mPosterSizeSetting);\n \n-        setupUIElements();\n+        if (mApplication.getUserPreferences().getGridDirection() == GridDirection.HORIZONTAL) {\n+            HorizontalGridPresenter gridPresenter = new HorizontalGridPresenter();\n+            gridPresenter.setNumberOfRows(getGridHeight() / getCardHeight());\n+            setGridPresenter(gridPresenter);\n+        }else {\n+            VerticalGridPresenter gridPresenter = new VerticalGridPresenter();\n+            // Why is this hardcoded you ask? Well did you ever look at getGridHeight()? Yup that one is hardcoded too\n+            // This whole fragment is only optimized for 16:9 screens anyway\n+            // is this bad? Yup it definitely is, we'll fix it when this screen is rewritten\n+            // - Niels, 2020\n+            gridPresenter.setNumberOfColumns(5);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NTI1MQ==", "bodyText": "Should we default to horizontal since that is the current layout? I honestly don't know lol", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428085251", "createdAt": "2020-05-20T15:02:15Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/preferences/UserPreferences.kt", "diffHunk": "@@ -43,6 +40,11 @@ class UserPreferences(context: Context) : SharedPreferenceStore(PreferenceManage\n \t */\n \tvar backdropEnabled by booleanPreference(\"pref_show_backdrop\", true)\n \n+\t/**\n+\t * Enable background images while browsing\n+\t */\n+\tvar gridDirection by enumPreference(\"grid_direction\", GridDirection.VERTICAL)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NDcxODUy", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#pullrequestreview-415471852", "createdAt": "2020-05-20T15:44:35Z", "commit": {"oid": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNTo0NDozNVrOGYSLjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxNTo0NDozNVrOGYSLjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODExNjg3Nw==", "bodyText": "Description is wrong", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428116877", "createdAt": "2020-05-20T15:44:35Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/preferences/UserPreferences.kt", "diffHunk": "@@ -43,6 +40,11 @@ class UserPreferences(context: Context) : SharedPreferenceStore(PreferenceManage\n \t */\n \tvar backdropEnabled by booleanPreference(\"pref_show_backdrop\", true)\n \n+\t/**\n+\t * Enable background images while browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MzE5NzUw", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#pullrequestreview-416319750", "createdAt": "2020-05-21T16:51:53Z", "commit": {"oid": "ae06654a1d3179fcdb8e9d1e94274525972377af"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNjo1MTo1M1rOGY6uLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNjo1MTo1M1rOGY6uLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODc4MTEwMw==", "bodyText": "You missed changing the default here \ud83d\ude09", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428781103", "createdAt": "2020-05-21T16:51:53Z", "author": {"login": "thornbill"}, "path": "app/src/main/res/xml/preferences.xml", "diffHunk": "@@ -37,6 +37,13 @@\n             android:defaultValue=\"true\"\n             android:key=\"pref_show_backdrop\"\n             android:title=\"@string/lbl_show_backdrop\" />\n+        <ListPreference\n+            android:defaultValue=\"VERTICAL\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae06654a1d3179fcdb8e9d1e94274525972377af"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2OTc4NzUz", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#pullrequestreview-416978753", "createdAt": "2020-05-22T14:59:31Z", "commit": {"oid": "733e281dd898513f02eb60e81e1ff1fc75ebaade"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2c5ba8190300def9a31991563c95cb4c952f3b0", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/d2c5ba8190300def9a31991563c95cb4c952f3b0", "committedDate": "2020-05-22T16:45:06Z", "message": "Add support for vertical grids"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc5e5494ea646415c331bf87587e34504b0c62ba", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/cc5e5494ea646415c331bf87587e34504b0c62ba", "committedDate": "2020-05-22T16:45:06Z", "message": "Fix TODO"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "850ae900a9c21339decba4d168be5cbf7dd9a394", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/850ae900a9c21339decba4d168be5cbf7dd9a394", "committedDate": "2020-05-22T16:45:06Z", "message": "Fix some bugs, marked the vertical grid as experimental, determine column count based on image size"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b552d3a455ee3cff1d9dc84cb7a6f3767e74e629", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/b552d3a455ee3cff1d9dc84cb7a6f3767e74e629", "committedDate": "2020-05-22T16:45:07Z", "message": "Change default to horizontal in XML"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "733e281dd898513f02eb60e81e1ff1fc75ebaade", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/733e281dd898513f02eb60e81e1ff1fc75ebaade", "committedDate": "2020-05-21T19:54:07Z", "message": "Change default to horizontal in XML"}, "afterCommit": {"oid": "b552d3a455ee3cff1d9dc84cb7a6f3767e74e629", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/b552d3a455ee3cff1d9dc84cb7a6f3767e74e629", "committedDate": "2020-05-22T16:45:07Z", "message": "Change default to horizontal in XML"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4332, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}