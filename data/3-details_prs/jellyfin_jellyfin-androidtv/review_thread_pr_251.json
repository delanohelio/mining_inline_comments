{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MDc5NzUy", "number": 251, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOTowNjo0OVrODXPrNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToyNzoxNVrODXP_Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NzAwNjYxOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/util/Utils.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOTowNjo0OVrOFcdYbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOTowNjo0OVrOFcdYbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM4NTgzOQ==", "bodyText": "I think the createPopMenu function which accepts an Activity instance can be removed now", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365385839", "createdAt": "2020-01-10T19:06:49Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/util/Utils.java", "diffHunk": "@@ -206,6 +206,10 @@ public static PopupMenu createPopupMenu(Activity activity, View view, int gravit\n         return new PopupMenu(activity, view, gravity);\n     }\n \n+    public static PopupMenu createPopupMenu(Context context, View view, int gravity) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NzAxNTkwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/actions/AdjustAudioDelayAction.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToxMDo0MVrOFcdecg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToxMDo0MVrOFcdecg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM4NzM3OA==", "bodyText": "A lot of actions have the exact same code with only the name and icon changed. Wouldn't it be better to create an IconAction which accepts the icon as parameter in the constructor? This way you can re-use that class for all simple actions.\nMaybe even add it to the CustomAction class so you don't even need to extend it.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365387378", "createdAt": "2020-01-10T19:10:41Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/actions/AdjustAudioDelayAction.java", "diffHunk": "@@ -0,0 +1,14 @@\n+package org.jellyfin.androidtv.playback.overlay.actions;\n+\n+import android.content.Context;\n+\n+import org.jellyfin.androidtv.R;\n+import org.jellyfin.androidtv.playback.overlay.CustomPlaybackTransportControlGlue;\n+\n+public class AdjustAudioDelayAction extends CustomAction {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NzAxOTE1OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/actions/RecordAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToxMjoxMFrOFcdglg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQyMjoxODowMVrOFchd1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM4NzkyNg==", "bodyText": "(addition to the previous suggestion for the action classes) adding a second icon parameter to the (to-be-made) constructor could trigger the active/inactive behavior. When the second icon is null it will always use the first one.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365387926", "createdAt": "2020-01-10T19:12:10Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/actions/RecordAction.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package org.jellyfin.androidtv.playback.overlay.actions;\n+\n+import android.content.Context;\n+import android.graphics.drawable.Drawable;\n+\n+import org.jellyfin.androidtv.R;\n+import org.jellyfin.androidtv.playback.overlay.CustomPlaybackTransportControlGlue;\n+\n+public class RecordAction extends CustomAction {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ1Mjc1Ng==", "bodyText": "Good point, but as you can see, I check which type of action is clicked in the onCustomActionClicked method in the CustomPlaybackTransportControlGlue class. But maybe I can instead use some sort of enum (eg. ACTION_SUBTITLES) which I pass in the IconAction object on initialization which I can later check against.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365452756", "createdAt": "2020-01-10T22:18:01Z", "author": {"login": "Florianisme"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/actions/RecordAction.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package org.jellyfin.androidtv.playback.overlay.actions;\n+\n+import android.content.Context;\n+import android.graphics.drawable.Drawable;\n+\n+import org.jellyfin.androidtv.R;\n+import org.jellyfin.androidtv.playback.overlay.CustomPlaybackTransportControlGlue;\n+\n+public class RecordAction extends CustomAction {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM4NzkyNg=="}, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NzAyMTk5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/actions/CustomAction.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToxMzoyMVrOFcdiYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToxMzoyMVrOFcdiYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM4ODM4NA==", "bodyText": "I don't think I saw this constructor use in any other place. I'd suggest moving the super call to the other constructor.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365388384", "createdAt": "2020-01-10T19:13:21Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/actions/CustomAction.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.jellyfin.androidtv.playback.overlay.actions;\n+\n+\n+import android.content.Context;\n+import android.graphics.drawable.Drawable;\n+import android.view.View;\n+\n+import androidx.leanback.widget.PlaybackControlsRow;\n+\n+import org.jellyfin.androidtv.playback.overlay.CustomPlaybackTransportControlGlue;\n+\n+public abstract class CustomAction extends PlaybackControlsRow.MultiAction {\n+\n+    private Context context;\n+    private CustomPlaybackTransportControlGlue customPlaybackTransportControlGlue;\n+\n+    public CustomAction(Context context, CustomPlaybackTransportControlGlue customPlaybackTransportControlGlue) {\n+        this(0);\n+        this.context = context;\n+        this.customPlaybackTransportControlGlue = customPlaybackTransportControlGlue;\n+    }\n+\n+    private CustomAction(int id) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NzAzOTk0OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomActionClickedHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToyMDoxNFrOFcdtmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToyMDoxNFrOFcdtmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5MTI1OA==", "bodyText": "I don't really like how this one class is responsible for all click handlers, I'd rather see them added to their respective action class.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365391258", "createdAt": "2020-01-10T19:20:14Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomActionClickedHandler.java", "diffHunk": "@@ -0,0 +1,147 @@\n+package org.jellyfin.androidtv.playback.overlay;\n+\n+import android.content.Context;\n+import android.view.Gravity;\n+import android.view.MenuItem;\n+import android.view.View;\n+import android.widget.PopupMenu;\n+\n+import org.jellyfin.androidtv.R;\n+import org.jellyfin.androidtv.TvApp;\n+import org.jellyfin.androidtv.livetv.TvManager;\n+import org.jellyfin.androidtv.model.compat.SubtitleStreamInfo;\n+import org.jellyfin.androidtv.playback.CustomPlaybackOverlayFragment;\n+import org.jellyfin.androidtv.playback.PlaybackController;\n+import org.jellyfin.androidtv.playback.VideoManager;\n+import org.jellyfin.androidtv.ui.AudioDelayPopup;\n+import org.jellyfin.androidtv.ui.ValueChangedListener;\n+import org.jellyfin.androidtv.util.Utils;\n+import org.jellyfin.apiclient.model.entities.MediaStream;\n+\n+import java.util.List;\n+\n+public class CustomActionClickedHandler {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NzA1MDU5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomPlaybackTransportControlGlue.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToyNDowOVrOFcd0Fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQyMjoyMDoxNlrOFchgcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5MjkxOA==", "bodyText": "See my previous comment on the way these handlers are implemented. Would be better if you could just do action.onClicked(); or something like that", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365392918", "createdAt": "2020-01-10T19:24:09Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomPlaybackTransportControlGlue.java", "diffHunk": "@@ -0,0 +1,239 @@\n+package org.jellyfin.androidtv.playback.overlay;\n+\n+import android.content.Context;\n+import android.view.View;\n+\n+import androidx.leanback.media.PlaybackTransportControlGlue;\n+import androidx.leanback.widget.Action;\n+import androidx.leanback.widget.ArrayObjectAdapter;\n+import androidx.leanback.widget.PlaybackControlsRow;\n+\n+import org.jellyfin.androidtv.playback.PlaybackController;\n+import org.jellyfin.androidtv.playback.overlay.actions.AdjustAudioDelayAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.ChannelBarChannelAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.ChapterAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.ClosedCaptionsAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.GuideAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.PreviousLiveTvChannelAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.RecordAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.SelectAudioAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.ZoomAction;\n+\n+public class CustomPlaybackTransportControlGlue extends PlaybackTransportControlGlue {\n+\n+    // Normal playback actions\n+    private PlaybackControlsRow.PlayPauseAction playPauseAction;\n+    private PlaybackControlsRow.RewindAction rewindAction;\n+    private PlaybackControlsRow.FastForwardAction fastForwardAction;\n+    private PlaybackControlsRow.SkipNextAction skipNextAction;\n+    private SelectAudioAction selectAudioAction;\n+    private ClosedCaptionsAction closedCaptionsAction;\n+    private AdjustAudioDelayAction adjustAudioDelayAction;\n+    private ZoomAction zoomAction;\n+    private ChapterAction chapterAction;\n+\n+    // TV actions\n+    private PreviousLiveTvChannelAction previousLiveTvChannelAction;\n+    private ChannelBarChannelAction channelBarChannelAction;\n+    private GuideAction guideAction;\n+    private RecordAction recordAction;\n+\n+    private final VideoPlayerAdapter playerAdapter;\n+    private final LeanbackOverlayFragment leanbackOverlayFragment;\n+    private final CustomActionClickedHandler customActionClickedHandler;\n+    private ArrayObjectAdapter primaryActionsAdapter;\n+    private ArrayObjectAdapter secondaryActionsAdapter;\n+\n+    CustomPlaybackTransportControlGlue(Context context, VideoPlayerAdapter playerAdapter, PlaybackController playbackController, LeanbackOverlayFragment leanbackOverlayFragment) {\n+        super(context, playerAdapter);\n+        this.playerAdapter = playerAdapter;\n+        this.leanbackOverlayFragment = leanbackOverlayFragment;\n+        customActionClickedHandler = new CustomActionClickedHandler(playbackController, leanbackOverlayFragment, context);\n+        initActions(context);\n+    }\n+\n+    private void initActions(Context context) {\n+        playPauseAction = new PlaybackControlsRow.PlayPauseAction(context);\n+        rewindAction = new PlaybackControlsRow.RewindAction(context);\n+        fastForwardAction = new PlaybackControlsRow.FastForwardAction(context);\n+        skipNextAction = new PlaybackControlsRow.SkipNextAction(context);\n+        selectAudioAction = new SelectAudioAction(context, this);\n+        closedCaptionsAction = new ClosedCaptionsAction(context, this);\n+        adjustAudioDelayAction = new AdjustAudioDelayAction(context, this);\n+        zoomAction = new ZoomAction(context, this);\n+        chapterAction = new ChapterAction(context, this);\n+\n+        previousLiveTvChannelAction = new PreviousLiveTvChannelAction(context, this);\n+        channelBarChannelAction = new ChannelBarChannelAction(context, this);\n+        guideAction = new GuideAction(context, this);\n+        recordAction = new RecordAction(context, this);\n+    }\n+\n+    @Override\n+    protected void onCreatePrimaryActions(ArrayObjectAdapter primaryActionsAdapter) {\n+        this.primaryActionsAdapter = primaryActionsAdapter;\n+\n+        primaryActionsAdapter.add(playPauseAction);\n+\n+        if (canSeek()) {\n+            primaryActionsAdapter.add(rewindAction);\n+            primaryActionsAdapter.add(fastForwardAction);\n+        }\n+\n+        if (hasSubs()) {\n+            primaryActionsAdapter.add(closedCaptionsAction);\n+        }\n+\n+        if (hasMultiAudio()) {\n+            primaryActionsAdapter.add(selectAudioAction);\n+        }\n+\n+        if (isLiveTv()) {\n+            primaryActionsAdapter.add(channelBarChannelAction);\n+            primaryActionsAdapter.add(guideAction);\n+        }\n+    }\n+\n+    @Override\n+    protected void onCreateSecondaryActions(ArrayObjectAdapter secondaryActionsAdapter) {\n+        this.secondaryActionsAdapter = secondaryActionsAdapter;\n+\n+        if (isLiveTv()) {\n+            secondaryActionsAdapter.add(previousLiveTvChannelAction);\n+            if (canRecordLiveTv()) {\n+                secondaryActionsAdapter.add(recordAction);\n+                recordingStateChanged();\n+            }\n+        }\n+\n+        if (hasNextItem()) {\n+            secondaryActionsAdapter.add(skipNextAction);\n+        }\n+\n+\n+        if (hasChapters()) {\n+            secondaryActionsAdapter.add(chapterAction);\n+        }\n+\n+        if (!isNativeMode()) {\n+            secondaryActionsAdapter.add(adjustAudioDelayAction);\n+        } else {\n+            secondaryActionsAdapter.add(zoomAction);\n+        }\n+    }\n+\n+    @Override\n+    public void onActionClicked(Action action) {\n+        if (action == playPauseAction) {\n+            if (playPauseAction.getIndex() == PlaybackControlsRow.PlayPauseAction.INDEX_PAUSE) {\n+                getPlayerAdapter().pause();\n+            } else if (playPauseAction.getIndex() == PlaybackControlsRow.PlayPauseAction.INDEX_PLAY) {\n+                getPlayerAdapter().play();\n+            }\n+            playPauseAction.nextIndex();\n+        } else if (action == rewindAction) {\n+            getPlayerAdapter().rewind();\n+        } else if (action == fastForwardAction) {\n+            getPlayerAdapter().fastForward();\n+        } else if (action == skipNextAction) {\n+            getPlayerAdapter().next();\n+        }\n+        notifyActionChanged(action);\n+    }\n+\n+    public void onCustomActionClicked(Action action, View view) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 144}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ1MzQyNw==", "bodyText": "Good point!\nBut then I will have to keep an action class for every action I add.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365453427", "createdAt": "2020-01-10T22:20:16Z", "author": {"login": "Florianisme"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomPlaybackTransportControlGlue.java", "diffHunk": "@@ -0,0 +1,239 @@\n+package org.jellyfin.androidtv.playback.overlay;\n+\n+import android.content.Context;\n+import android.view.View;\n+\n+import androidx.leanback.media.PlaybackTransportControlGlue;\n+import androidx.leanback.widget.Action;\n+import androidx.leanback.widget.ArrayObjectAdapter;\n+import androidx.leanback.widget.PlaybackControlsRow;\n+\n+import org.jellyfin.androidtv.playback.PlaybackController;\n+import org.jellyfin.androidtv.playback.overlay.actions.AdjustAudioDelayAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.ChannelBarChannelAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.ChapterAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.ClosedCaptionsAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.GuideAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.PreviousLiveTvChannelAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.RecordAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.SelectAudioAction;\n+import org.jellyfin.androidtv.playback.overlay.actions.ZoomAction;\n+\n+public class CustomPlaybackTransportControlGlue extends PlaybackTransportControlGlue {\n+\n+    // Normal playback actions\n+    private PlaybackControlsRow.PlayPauseAction playPauseAction;\n+    private PlaybackControlsRow.RewindAction rewindAction;\n+    private PlaybackControlsRow.FastForwardAction fastForwardAction;\n+    private PlaybackControlsRow.SkipNextAction skipNextAction;\n+    private SelectAudioAction selectAudioAction;\n+    private ClosedCaptionsAction closedCaptionsAction;\n+    private AdjustAudioDelayAction adjustAudioDelayAction;\n+    private ZoomAction zoomAction;\n+    private ChapterAction chapterAction;\n+\n+    // TV actions\n+    private PreviousLiveTvChannelAction previousLiveTvChannelAction;\n+    private ChannelBarChannelAction channelBarChannelAction;\n+    private GuideAction guideAction;\n+    private RecordAction recordAction;\n+\n+    private final VideoPlayerAdapter playerAdapter;\n+    private final LeanbackOverlayFragment leanbackOverlayFragment;\n+    private final CustomActionClickedHandler customActionClickedHandler;\n+    private ArrayObjectAdapter primaryActionsAdapter;\n+    private ArrayObjectAdapter secondaryActionsAdapter;\n+\n+    CustomPlaybackTransportControlGlue(Context context, VideoPlayerAdapter playerAdapter, PlaybackController playbackController, LeanbackOverlayFragment leanbackOverlayFragment) {\n+        super(context, playerAdapter);\n+        this.playerAdapter = playerAdapter;\n+        this.leanbackOverlayFragment = leanbackOverlayFragment;\n+        customActionClickedHandler = new CustomActionClickedHandler(playbackController, leanbackOverlayFragment, context);\n+        initActions(context);\n+    }\n+\n+    private void initActions(Context context) {\n+        playPauseAction = new PlaybackControlsRow.PlayPauseAction(context);\n+        rewindAction = new PlaybackControlsRow.RewindAction(context);\n+        fastForwardAction = new PlaybackControlsRow.FastForwardAction(context);\n+        skipNextAction = new PlaybackControlsRow.SkipNextAction(context);\n+        selectAudioAction = new SelectAudioAction(context, this);\n+        closedCaptionsAction = new ClosedCaptionsAction(context, this);\n+        adjustAudioDelayAction = new AdjustAudioDelayAction(context, this);\n+        zoomAction = new ZoomAction(context, this);\n+        chapterAction = new ChapterAction(context, this);\n+\n+        previousLiveTvChannelAction = new PreviousLiveTvChannelAction(context, this);\n+        channelBarChannelAction = new ChannelBarChannelAction(context, this);\n+        guideAction = new GuideAction(context, this);\n+        recordAction = new RecordAction(context, this);\n+    }\n+\n+    @Override\n+    protected void onCreatePrimaryActions(ArrayObjectAdapter primaryActionsAdapter) {\n+        this.primaryActionsAdapter = primaryActionsAdapter;\n+\n+        primaryActionsAdapter.add(playPauseAction);\n+\n+        if (canSeek()) {\n+            primaryActionsAdapter.add(rewindAction);\n+            primaryActionsAdapter.add(fastForwardAction);\n+        }\n+\n+        if (hasSubs()) {\n+            primaryActionsAdapter.add(closedCaptionsAction);\n+        }\n+\n+        if (hasMultiAudio()) {\n+            primaryActionsAdapter.add(selectAudioAction);\n+        }\n+\n+        if (isLiveTv()) {\n+            primaryActionsAdapter.add(channelBarChannelAction);\n+            primaryActionsAdapter.add(guideAction);\n+        }\n+    }\n+\n+    @Override\n+    protected void onCreateSecondaryActions(ArrayObjectAdapter secondaryActionsAdapter) {\n+        this.secondaryActionsAdapter = secondaryActionsAdapter;\n+\n+        if (isLiveTv()) {\n+            secondaryActionsAdapter.add(previousLiveTvChannelAction);\n+            if (canRecordLiveTv()) {\n+                secondaryActionsAdapter.add(recordAction);\n+                recordingStateChanged();\n+            }\n+        }\n+\n+        if (hasNextItem()) {\n+            secondaryActionsAdapter.add(skipNextAction);\n+        }\n+\n+\n+        if (hasChapters()) {\n+            secondaryActionsAdapter.add(chapterAction);\n+        }\n+\n+        if (!isNativeMode()) {\n+            secondaryActionsAdapter.add(adjustAudioDelayAction);\n+        } else {\n+            secondaryActionsAdapter.add(zoomAction);\n+        }\n+    }\n+\n+    @Override\n+    public void onActionClicked(Action action) {\n+        if (action == playPauseAction) {\n+            if (playPauseAction.getIndex() == PlaybackControlsRow.PlayPauseAction.INDEX_PAUSE) {\n+                getPlayerAdapter().pause();\n+            } else if (playPauseAction.getIndex() == PlaybackControlsRow.PlayPauseAction.INDEX_PLAY) {\n+                getPlayerAdapter().play();\n+            }\n+            playPauseAction.nextIndex();\n+        } else if (action == rewindAction) {\n+            getPlayerAdapter().rewind();\n+        } else if (action == fastForwardAction) {\n+            getPlayerAdapter().fastForward();\n+        } else if (action == skipNextAction) {\n+            getPlayerAdapter().next();\n+        }\n+        notifyActionChanged(action);\n+    }\n+\n+    public void onCustomActionClicked(Action action, View view) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5MjkxOA=="}, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 144}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NzA1NjAwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomSeekProvider.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToyNjoxM1rOFcd3Ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxODowNzo0M1rOFeis5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5Mzc1NQ==", "bodyText": "I'm not really sure what this class does. Is it providing the possible \"seek positions\" to the player? And if so, does this mean that whatever I watch it can only seek to 30 positions? Which would mean that if I watched a movie of 30 hours I would skip one hour every time?", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365393755", "createdAt": "2020-01-10T19:26:13Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomSeekProvider.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package org.jellyfin.androidtv.playback.overlay;\n+\n+import androidx.leanback.widget.PlaybackSeekDataProvider;\n+\n+public class CustomSeekProvider extends PlaybackSeekDataProvider {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQzMTg2OQ==", "bodyText": "I just confirmed this myself while testing. I think adding stepts for every x seconds would be better.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365431869", "createdAt": "2020-01-10T21:11:47Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomSeekProvider.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package org.jellyfin.androidtv.playback.overlay;\n+\n+import androidx.leanback.widget.PlaybackSeekDataProvider;\n+\n+public class CustomSeekProvider extends PlaybackSeekDataProvider {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5Mzc1NQ=="}, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQ1Mzg1Ng==", "bodyText": "Yes, I also think I saw a code example of a quick seeker, which means the faster you click (or the longer you hold to the right), the faster you seek", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365453856", "createdAt": "2020-01-10T22:21:56Z", "author": {"login": "Florianisme"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomSeekProvider.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package org.jellyfin.androidtv.playback.overlay;\n+\n+import androidx.leanback.widget.PlaybackSeekDataProvider;\n+\n+public class CustomSeekProvider extends PlaybackSeekDataProvider {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5Mzc1NQ=="}, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzU3MDE0OA==", "bodyText": "Can you update this one so it works better for movies / long episodes? 30 steps is enough for a 30 minute show but it isn't for a 3 hour movie. The behavior you mentioned you saw in an example would be awesome to have", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r367570148", "createdAt": "2020-01-16T18:07:43Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/CustomSeekProvider.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package org.jellyfin.androidtv.playback.overlay;\n+\n+import androidx.leanback.widget.PlaybackSeekDataProvider;\n+\n+public class CustomSeekProvider extends PlaybackSeekDataProvider {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5Mzc1NQ=="}, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NzA1ODIzOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/VideoPlayerAdapter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToyNzoxNVrOFcd49Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxOToyNzoxNVrOFcd49Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5NDE2NQ==", "bodyText": "Typo in live", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/251#discussion_r365394165", "createdAt": "2020-01-10T19:27:15Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/playback/overlay/VideoPlayerAdapter.java", "diffHunk": "@@ -0,0 +1,148 @@\n+package org.jellyfin.androidtv.playback.overlay;\n+\n+import androidx.leanback.media.PlayerAdapter;\n+\n+import org.jellyfin.androidtv.TvApp;\n+import org.jellyfin.androidtv.playback.CustomPlaybackOverlayFragment;\n+import org.jellyfin.androidtv.playback.PlaybackController;\n+import org.jellyfin.androidtv.util.DeviceUtils;\n+import org.jellyfin.androidtv.util.apiclient.StreamHelper;\n+import org.jellyfin.apiclient.model.dto.BaseItemDto;\n+import org.jellyfin.apiclient.model.dto.ChapterInfoDto;\n+\n+import java.util.List;\n+\n+public class VideoPlayerAdapter extends PlayerAdapter {\n+\n+    private final PlaybackController playbackController;\n+    private CustomPlaybackOverlayFragment customPlaybackOverlayFragment;\n+\n+    VideoPlayerAdapter(PlaybackController playbackController) {\n+        this.playbackController = playbackController;\n+    }\n+\n+    @Override\n+    public void play() {\n+        playbackController.play(playbackController.getCurrentPosition());\n+    }\n+\n+    @Override\n+    public void pause() {\n+        playbackController.pause();\n+    }\n+\n+    @Override\n+    public void rewind() {\n+        playbackController.skip(-30000);\n+        updateCurrentPosition();\n+    }\n+\n+    @Override\n+    public void fastForward() {\n+        playbackController.skip(30000);\n+        updateCurrentPosition();\n+    }\n+\n+    @Override\n+    public void seekTo(long positionInMs) {\n+        playbackController.seek(positionInMs);\n+        updateCurrentPosition();\n+    }\n+\n+    @Override\n+    public void next() {\n+        playbackController.next();\n+    }\n+\n+    @Override\n+    public long getDuration() {\n+        return getCurrentlyPlayingItem().getRunTimeTicks() != null ?\n+                getCurrentlyPlayingItem().getRunTimeTicks() / 10000 : -1;\n+    }\n+\n+    @Override\n+    public long getCurrentPosition() {\n+        return playbackController.getCurrentPosition();\n+    }\n+\n+    @Override\n+    public boolean isPlaying() {\n+        return playbackController.isPlaying();\n+    }\n+\n+    @Override\n+    public long getBufferedPosition() {\n+        return getDuration();\n+    }\n+\n+    void updateCurrentPosition() {\n+        getCallback().onCurrentPositionChanged(this);\n+    }\n+\n+    void updatePlayState() {\n+        getCallback().onPlayStateChanged(this);\n+    }\n+\n+    boolean hasSubs() {\n+        return StreamHelper.getSubtitleStreams(playbackController.getCurrentMediaSource()).size() > 0;\n+    }\n+\n+    boolean hasMultiAudio() {\n+        return StreamHelper.getAudioStreams(playbackController.getCurrentMediaSource()).size() > 1;\n+    }\n+\n+    boolean hasNextItem() {\n+        return playbackController.hasNextItem();\n+    }\n+\n+    boolean isNativeMode() {\n+        return playbackController.isNativeMode();\n+    }\n+\n+    boolean canSeek() {\n+        return !DeviceUtils.isFireTv() && playbackController.canSeek();\n+    }\n+\n+    boolean isLiveTv() {\n+        return playbackController.isLiveTv();\n+    }\n+\n+    void setMasterOverlayFragment(CustomPlaybackOverlayFragment customPlaybackOverlayFragment) {\n+        this.customPlaybackOverlayFragment = customPlaybackOverlayFragment;\n+    }\n+\n+    CustomPlaybackOverlayFragment getMasterOverlayFragment() {\n+        return customPlaybackOverlayFragment;\n+    }\n+\n+    boolean canRecordLieTv() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ada7b65a8f752781f0ad421caec99155128d9d2"}, "originalPosition": 118}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1104, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}