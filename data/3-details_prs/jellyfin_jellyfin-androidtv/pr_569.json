{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkxNDE4NDIy", "number": 569, "title": "Live TV improvements", "bodyText": "Changes\n\nAdded channel name to info bar for programs with no data.\nIgnore programs that fill time slots that have already been filled by a previous program.\nChange live tv guide from 6 hours to 9 hours of programming to be consistent with non live guide.\nChannel surf using channel headers in live guide\nLong/short press in non-live guide and live guide\nAdded full back button handling properly\nSplit no program data into 30 minute slots for easier side scrolling\nFixed favorite programs not sorting to the top when the preference is checked\n\nKnown Issues\n\nWhen watching live TV the live guide is set to force refresh every 30 minutes, it appears when it is supposed to refresh the loading spinner will not disappear.\n\nPossible Issues(I can't reproduce)\n\nNone\n\nTo do (hopefully):\n\n Address issue #284\n1. Look into channel sorting My guide data is so bad I can't get good results no matter what here\n2. Lazy load channels Will work on in different commit\n3. If program is in a time slot that conflicted with another program then highlight the background to signify we don't know if this is what is actually playing Scrapped for now\n\nFinished:\n\n Replace <No Prorgam Data> with resource string\n Skip program data if another program has filled the time slot\n Channel headers can be used to surf in guide\n Short press to play channel, long press for detail screen\n Split no program data in 30 minute slots\n\nMaybe implement in the far off future\n\nDo not refresh entire player when switching channels by channel header, this appears to only happen if channel doesn't work with the player(libVlc or exoplayer) currently being used\nSplit <No Program Data> shows into 30 minute segments for the filler slot", "createdAt": "2020-09-23T02:46:07Z", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569", "merged": true, "mergeCommit": {"oid": "13e0177e8712967b2feeaba100c4d18c155fba93"}, "closed": true, "closedAt": "2020-09-30T03:23:16Z", "author": {"login": "MrChip53"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLjNeiAH2gAyNDkxNDE4NDIyOjg5ODNkNWM4ZjIzZTNhMGQ2M2EyMjRhMTlkMWE2Mzc0MzcwOGUzOTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN0I_WAFqTQ5OTA1ODgyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8983d5c8f23e3a0d63a224a19d1a63743708e394", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/8983d5c8f23e3a0d63a224a19d1a63743708e394", "committedDate": "2020-09-23T02:31:48Z", "message": "Add channel name to info bar for <No Program Data> programs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb37af39b1c0133588f20017e4229f46ccded09a", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/eb37af39b1c0133588f20017e4229f46ccded09a", "committedDate": "2020-09-23T02:41:16Z", "message": "Add channel name to info bar in CustomPlaybackOverlayFragment.java for <No Program Data> programs."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a913f133c6731cc71e75250ad3050ace0841cf46", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/a913f133c6731cc71e75250ad3050ace0841cf46", "committedDate": "2020-09-23T04:24:02Z", "message": "Remove hard coded strings; start implementing 30 minutes No Program segments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e8d33d38728e3ee3f30ce8e4d3fdef355c2b2de", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/4e8d33d38728e3ee3f30ce8e4d3fdef355c2b2de", "committedDate": "2020-09-23T04:31:17Z", "message": "Last hard coded string"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3524401a9b66b7432b99e22248852e3a71ea7127", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/3524401a9b66b7432b99e22248852e3a71ea7127", "committedDate": "2020-09-24T05:46:35Z", "message": "Add channel surfing in live guide using channel headers; long press and short press actions in non-live guide; skip adding programs that are for a time slot that has been filled by a previous program; fix issue with live guide over scrolling to the left"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b452f7fe5f00a12a8dfd0c7f28e4a6c1d8068f4f", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/b452f7fe5f00a12a8dfd0c7f28e4a6c1d8068f4f", "committedDate": "2020-09-24T06:20:49Z", "message": "Attach channel header scrolling to program scrolling; fixed half of lost focus bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85ecab725035c802e060ebe087d8ae23f7c08250", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/85ecab725035c802e060ebe087d8ae23f7c08250", "committedDate": "2020-09-24T17:35:42Z", "message": "Fix back button for Live TV while viewing show"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57cfc9acc0c8e7b61cf7256b66026853499fb34c", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/57cfc9acc0c8e7b61cf7256b66026853499fb34c", "committedDate": "2020-09-24T18:13:54Z", "message": "Finished with channel surfing feature"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "809262a4a7075b6a33e831751b08dc059f26afa4", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/809262a4a7075b6a33e831751b08dc059f26afa4", "committedDate": "2020-09-24T19:56:20Z", "message": "Long press and short press in live tv guide"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MTQ4MzAz", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#pullrequestreview-496148303", "createdAt": "2020-09-25T06:43:03Z", "commit": {"oid": "809262a4a7075b6a33e831751b08dc059f26afa4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNjo0MzowM1rOHX28xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwNjo0MzowM1rOHX28xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc3OTU5MQ==", "bodyText": "Either remove, uncomment or add a comment explaining why this line is commented to avoid confusion for other devs", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#discussion_r494779591", "createdAt": "2020-09-25T06:43:03Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/GuideChannelHeader.java", "diffHunk": "@@ -45,14 +48,39 @@ private void initComponent(Context context, ChannelInfoDto channel) {\n         ((TextView) findViewById(R.id.channelName)).setText(channel.getName());\n         ((TextView) findViewById(R.id.channelNumber)).setText(channel.getNumber());\n         mChannelImage = (ImageView) findViewById(R.id.channelImage);\n+\n+        if (fragment != null) {\n+            mActivity = fragment;\n+            this.setFocusable(focusable);\n+            setOnClickListener(new OnClickListener() {\n+                @Override\n+                public void onClick(View v) {\n+                    fragment.switchChannel(channel.getId(), false);\n+                }\n+            });\n+        }\n     }\n \n     public void loadImage() {\n-        Glide.with(mActivity)\n+        Glide.with(mContext)\n                 .load(ImageUtils.getPrimaryImageUrl(mChannel, get(ApiClient.class)))\n                 .override(IMAGE_WIDTH, IMAGE_HEIGHT)\n                 .centerInside()\n                 .into(mChannelImage);\n     }\n \n+    @Override\n+    protected void onFocusChanged(boolean gainFocus, int direction, Rect previouslyFocusedRect) {\n+        super.onFocusChanged(gainFocus, direction, previouslyFocusedRect);\n+\n+        if (gainFocus) {\n+            setBackgroundColor(Utils.getThemeColor(getContext(), android.R.attr.colorAccent));\n+\n+            mActivity.setSelectedProgram(this);\n+        } else {\n+            setBackground(getResources().getDrawable(R.drawable.light_border));\n+        }\n+//        TvApp.getApplication().getLogger().Debug(\"Focus on \" + mProgram.getName() + \" was \" + (gainFocus ? \"gained\" : \"lost\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "809262a4a7075b6a33e831751b08dc059f26afa4"}, "originalPosition": 75}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d468551207f40b21fd77cfb62c8468f06107d1e1", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/d468551207f40b21fd77cfb62c8468f06107d1e1", "committedDate": "2020-09-26T01:56:29Z", "message": "change short press to play channel ONLY if its on the show currently airing; Remove comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f782cf1dcd3a24411c2f7eade87353d8ec85a785", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/f782cf1dcd3a24411c2f7eade87353d8ec85a785", "committedDate": "2020-09-26T04:11:44Z", "message": "Change condition to start channel vs open options"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MDQwNjUy", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#pullrequestreview-497040652", "createdAt": "2020-09-27T01:03:06Z", "commit": {"oid": "f782cf1dcd3a24411c2f7eade87353d8ec85a785"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwMTowMzowNlrOHYjqAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QwMToxMDowMFrOHYjr2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUxMjA2Ng==", "bodyText": "Shouldn\u2019t this be 30*(slot+1)?", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#discussion_r495512066", "createdAt": "2020-09-27T01:03:06Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/livetv/LiveTvGuideActivity.java", "diffHunk": "@@ -767,26 +797,36 @@ protected void onPostExecute(Void aVoid) {\n \n     private int currentCellId = 0;\n \n+    private GuideChannelHeader getChannelHeader(Context context, ChannelInfoDto channel, boolean focusable){\n+        return new GuideChannelHeader(context, null, channel, focusable);\n+    }\n+\n     private LinearLayout getProgramRow(List<BaseItemDto> programs, String channelId) {\n \n         LinearLayout programRow = new LinearLayout(this);\n \n         if (programs.size() == 0) {\n             if (mFilters.any()) return null; // don't show rows with no program data\n \n-            BaseItemDto empty = new BaseItemDto();\n-            int duration = ((Long)((mCurrentLocalGuideEnd - mCurrentLocalGuideStart) / 60000)).intValue();\n-            empty.setName(\"  <No Program Data Available>\");\n-            empty.setChannelId(channelId);\n-            empty.setStartDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart)));\n-            empty.setEndDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart+(duration*60000))));\n-            ProgramGridCell cell = new ProgramGridCell(this, this, empty);\n-            cell.setId(currentCellId++);\n-            cell.setLayoutParams(new ViewGroup.LayoutParams(duration * PIXELS_PER_MINUTE, ROW_HEIGHT));\n-            cell.setFocusable(true);\n-            programRow.addView(cell);\n-            cell.setLast();\n-            cell.setFirst();\n+            int minutes = ((Long)((mCurrentLocalGuideEnd - mCurrentLocalGuideStart) / 60000)).intValue();\n+            int slot = 0;\n+            do {\n+                BaseItemDto empty = new BaseItemDto();\n+                empty.setName(\"  \" + getString(R.string.no_program_data));\n+                empty.setChannelId(channelId);\n+                empty.setStartDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + ((30*slot) * 60000))));\n+                empty.setEndDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + ((30+(slot+1)) * 60000))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f782cf1dcd3a24411c2f7eade87353d8ec85a785"}, "originalPosition": 95}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUxMjI0Nw==", "bodyText": "It shouldn\u2019t be necessary to multiply both sides by 60000 here.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#discussion_r495512247", "createdAt": "2020-09-27T01:05:22Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/livetv/LiveTvGuideActivity.java", "diffHunk": "@@ -767,26 +797,36 @@ protected void onPostExecute(Void aVoid) {\n \n     private int currentCellId = 0;\n \n+    private GuideChannelHeader getChannelHeader(Context context, ChannelInfoDto channel, boolean focusable){\n+        return new GuideChannelHeader(context, null, channel, focusable);\n+    }\n+\n     private LinearLayout getProgramRow(List<BaseItemDto> programs, String channelId) {\n \n         LinearLayout programRow = new LinearLayout(this);\n \n         if (programs.size() == 0) {\n             if (mFilters.any()) return null; // don't show rows with no program data\n \n-            BaseItemDto empty = new BaseItemDto();\n-            int duration = ((Long)((mCurrentLocalGuideEnd - mCurrentLocalGuideStart) / 60000)).intValue();\n-            empty.setName(\"  <No Program Data Available>\");\n-            empty.setChannelId(channelId);\n-            empty.setStartDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart)));\n-            empty.setEndDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart+(duration*60000))));\n-            ProgramGridCell cell = new ProgramGridCell(this, this, empty);\n-            cell.setId(currentCellId++);\n-            cell.setLayoutParams(new ViewGroup.LayoutParams(duration * PIXELS_PER_MINUTE, ROW_HEIGHT));\n-            cell.setFocusable(true);\n-            programRow.addView(cell);\n-            cell.setLast();\n-            cell.setFirst();\n+            int minutes = ((Long)((mCurrentLocalGuideEnd - mCurrentLocalGuideStart) / 60000)).intValue();\n+            int slot = 0;\n+            do {\n+                BaseItemDto empty = new BaseItemDto();\n+                empty.setName(\"  \" + getString(R.string.no_program_data));\n+                empty.setChannelId(channelId);\n+                empty.setStartDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + ((30*slot) * 60000))));\n+                empty.setEndDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + ((30+(slot+1)) * 60000))));\n+                ProgramGridCell cell = new ProgramGridCell(this, this, empty, false);\n+                cell.setId(currentCellId++);\n+                cell.setLayoutParams(new ViewGroup.LayoutParams(30 * PIXELS_PER_MINUTE, ROW_HEIGHT));\n+                cell.setFocusable(true);\n+                programRow.addView(cell);\n+                if (slot == 0)\n+                    cell.setFirst();\n+                if (slot == (minutes / 30) - 1)\n+                    cell.setLast();\n+                slot++;\n+            } while((30*slot)*60000 < minutes*60000);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f782cf1dcd3a24411c2f7eade87353d8ec85a785"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUxMjUwNw==", "bodyText": "Same here", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#discussion_r495512507", "createdAt": "2020-09-27T01:09:41Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/playback/CustomPlaybackOverlayFragment.java", "diffHunk": "@@ -842,19 +910,35 @@ protected void onPostExecute(Void aVoid) {\n \n     private int currentCellId = 0;\n \n+    private GuideChannelHeader getChannelHeader(Context context, ChannelInfoDto channel, boolean focusable){\n+        return new GuideChannelHeader(context, this, channel, focusable);\n+    }\n+\n     private LinearLayout getProgramRow(List<BaseItemDto> programs, String channelId) {\n         LinearLayout programRow = new LinearLayout(mActivity);\n         if (programs.size() == 0) {\n-            BaseItemDto empty = new BaseItemDto();\n-            empty.setName(mApplication.getString(R.string.no_program_data));\n-            empty.setChannelId(channelId);\n-            empty.setStartDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart)));\n-            empty.setEndDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + (150 * 60000))));\n-            ProgramGridCell cell = new ProgramGridCell(mActivity, mFragment, empty);\n-            cell.setId(currentCellId++);\n-            cell.setLayoutParams(new ViewGroup.LayoutParams(150 * PIXELS_PER_MINUTE, LiveTvGuideActivity.ROW_HEIGHT));\n-            cell.setFocusable(true);\n-            programRow.addView(cell);\n+\n+            int minutes = ((Long)((mCurrentLocalGuideEnd - mCurrentLocalGuideStart) / 60000)).intValue();\n+            int slot = 0;\n+\n+            do {\n+                BaseItemDto empty = new BaseItemDto();\n+                empty.setName(\"  \" + getString(R.string.no_program_data));\n+                empty.setChannelId(channelId);\n+                empty.setStartDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + ((30*slot) * 60000))));\n+                empty.setEndDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + ((30+(slot+1)) * 60000))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f782cf1dcd3a24411c2f7eade87353d8ec85a785"}, "originalPosition": 244}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTUxMjUzNg==", "bodyText": "Same here", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#discussion_r495512536", "createdAt": "2020-09-27T01:10:00Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/playback/CustomPlaybackOverlayFragment.java", "diffHunk": "@@ -842,19 +910,35 @@ protected void onPostExecute(Void aVoid) {\n \n     private int currentCellId = 0;\n \n+    private GuideChannelHeader getChannelHeader(Context context, ChannelInfoDto channel, boolean focusable){\n+        return new GuideChannelHeader(context, this, channel, focusable);\n+    }\n+\n     private LinearLayout getProgramRow(List<BaseItemDto> programs, String channelId) {\n         LinearLayout programRow = new LinearLayout(mActivity);\n         if (programs.size() == 0) {\n-            BaseItemDto empty = new BaseItemDto();\n-            empty.setName(mApplication.getString(R.string.no_program_data));\n-            empty.setChannelId(channelId);\n-            empty.setStartDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart)));\n-            empty.setEndDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + (150 * 60000))));\n-            ProgramGridCell cell = new ProgramGridCell(mActivity, mFragment, empty);\n-            cell.setId(currentCellId++);\n-            cell.setLayoutParams(new ViewGroup.LayoutParams(150 * PIXELS_PER_MINUTE, LiveTvGuideActivity.ROW_HEIGHT));\n-            cell.setFocusable(true);\n-            programRow.addView(cell);\n+\n+            int minutes = ((Long)((mCurrentLocalGuideEnd - mCurrentLocalGuideStart) / 60000)).intValue();\n+            int slot = 0;\n+\n+            do {\n+                BaseItemDto empty = new BaseItemDto();\n+                empty.setName(\"  \" + getString(R.string.no_program_data));\n+                empty.setChannelId(channelId);\n+                empty.setStartDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + ((30*slot) * 60000))));\n+                empty.setEndDate(TimeUtils.convertToUtcDate(new Date(mCurrentLocalGuideStart + ((30+(slot+1)) * 60000))));\n+                ProgramGridCell cell = new ProgramGridCell(mActivity, this, empty, false);\n+                cell.setId(currentCellId++);\n+                cell.setLayoutParams(new ViewGroup.LayoutParams(30 * PIXELS_PER_MINUTE, LiveTvGuideActivity.ROW_HEIGHT));\n+                cell.setFocusable(true);\n+                programRow.addView(cell);\n+                if (slot == 0)\n+                    cell.setFirst();\n+                if (slot == (minutes / 30) - 1)\n+                    cell.setLast();\n+                slot++;\n+            } while((30*slot)*60000 < minutes*60000);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f782cf1dcd3a24411c2f7eade87353d8ec85a785"}, "originalPosition": 255}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "461fe1ceb70a5ac625d428dc3d9926c6902d6077", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/461fe1ceb70a5ac625d428dc3d9926c6902d6077", "committedDate": "2020-09-27T02:49:32Z", "message": "Requested changes #1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07e489f6f0a630d4d18e460720668e393ac1edaa", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/07e489f6f0a630d4d18e460720668e393ac1edaa", "committedDate": "2020-09-27T16:38:49Z", "message": "Fix favorites at top bug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0da70177f0324a3d9ec7e73fa9e0a5324cc3bfe", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/c0da70177f0324a3d9ec7e73fa9e0a5324cc3bfe", "committedDate": "2020-09-28T03:08:07Z", "message": "Fix issue #284 and the issue I discovered with the infinite spinner when live guide refreshes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b0bacbc146cc3dd61b7e617dfe909319f7bfef7", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/8b0bacbc146cc3dd61b7e617dfe909319f7bfef7", "committedDate": "2020-09-29T04:15:31Z", "message": "Fix for bug that locked up non-live guide when re-entering from main menu"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NDYyNTg2", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#pullrequestreview-498462586", "createdAt": "2020-09-29T13:23:25Z", "commit": {"oid": "8b0bacbc146cc3dd61b7e617dfe909319f7bfef7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxMzoyMzoyNVrOHZs6Xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNDoyNDoyM1rOHZv4HQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcxMjI4Nw==", "bodyText": "It looks like getUserData() can return null, so we should add some checks here to handle that.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#discussion_r496712287", "createdAt": "2020-09-29T13:23:25Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/livetv/TvManager.java", "diffHunk": "@@ -248,6 +248,15 @@ public int compare(ChannelInfoDto lhs, ChannelInfoDto rhs) {\n                 }));\n             }\n \n+            if (prefs.favsAtTop) {\n+                Collections.sort(allChannels, new Comparator<ChannelInfoDto>() {\n+                    @Override\n+                    public int compare(ChannelInfoDto channelInfoDto, ChannelInfoDto t1) {\n+                        return -Boolean.compare(channelInfoDto.getUserData().getIsFavorite(), t1.getUserData().getIsFavorite());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b0bacbc146cc3dd61b7e617dfe909319f7bfef7"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcxMjgzMA==", "bodyText": "Maybe just use channel1 and channel2 as the variable names here?", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#discussion_r496712830", "createdAt": "2020-09-29T13:24:09Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/livetv/TvManager.java", "diffHunk": "@@ -248,6 +248,15 @@ public int compare(ChannelInfoDto lhs, ChannelInfoDto rhs) {\n                 }));\n             }\n \n+            if (prefs.favsAtTop) {\n+                Collections.sort(allChannels, new Comparator<ChannelInfoDto>() {\n+                    @Override\n+                    public int compare(ChannelInfoDto channelInfoDto, ChannelInfoDto t1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b0bacbc146cc3dd61b7e617dfe909319f7bfef7"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njc2MDg2MQ==", "bodyText": "Why did you change this from using System.currentTimeMillis()?", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#discussion_r496760861", "createdAt": "2020-09-29T14:24:23Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/livetv/LiveTvGuideActivity.java", "diffHunk": "@@ -260,7 +260,10 @@ protected void onResume() {\n     }\n \n     protected void doLoad() {\n-        if (TvManager.shouldForceReload() || System.currentTimeMillis() > mLastLoad + 3600000) {\n+        Calendar curTime = Calendar.getInstance();\n+        curTime.setTime(new Date());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b0bacbc146cc3dd61b7e617dfe909319f7bfef7"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d274b1d06646443bb63e3c939ab02541f8aea895", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/d274b1d06646443bb63e3c939ab02541f8aea895", "committedDate": "2020-09-30T00:37:15Z", "message": "Requested changes and a couple more hardcoded strings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b14be1f4af6dc8f6b513fa4b63c42ae1e10837e", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/0b14be1f4af6dc8f6b513fa4b63c42ae1e10837e", "committedDate": "2020-09-30T00:43:17Z", "message": "Remove accidental commit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MDU4ODI4", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/569#pullrequestreview-499058828", "createdAt": "2020-09-30T03:23:08Z", "commit": {"oid": "0b14be1f4af6dc8f6b513fa4b63c42ae1e10837e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4181, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}