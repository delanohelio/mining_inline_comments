{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMjI5Nzgy", "number": 630, "title": "Add the ability to change the rating type shown on cards", "bodyText": "Changes\n\nAdds an option under settings to toggle between Rotten Tomatoes or IMDb for what is shown on the ImageCards.\n\nIssues\n#584", "createdAt": "2020-11-15T17:31:00Z", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630", "merged": true, "mergeCommit": {"oid": "909e0281baa1d4e59dbfef19a4e733d445bf1657"}, "closed": true, "closedAt": "2020-12-17T15:34:35Z", "author": {"login": "MrChip53"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdc0O1hgBqjM5OTc2NDc1NzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnFVDQAFqTU1NDcxODE5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0bad73cf423f20efec90e86e92d247ff894d8e40", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/0bad73cf423f20efec90e86e92d247ff894d8e40", "committedDate": "2020-11-15T17:46:10Z", "message": "Better comments in RatingProvider.kt"}, "afterCommit": {"oid": "139a6ef59be59380b66ffc64807cd3ea1373d2f1", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/139a6ef59be59380b66ffc64807cd3ea1373d2f1", "committedDate": "2020-11-15T17:57:31Z", "message": "Add the ability to choose IMDb as the default rating provider"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxOTgwODUy", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#pullrequestreview-531980852", "createdAt": "2020-11-17T02:41:07Z", "commit": {"oid": "139a6ef59be59380b66ffc64807cd3ea1373d2f1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwMjo0MTowN1rOH0iMVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QwMjo0MTowN1rOH0iMVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg0ODIxNA==", "bodyText": "Looks like you could use holder here instead of casting repeatedly \ud83d\ude09 .", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r524848214", "createdAt": "2020-11-17T02:41:07Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/presentation/CardPresenter.java", "diffHunk": "@@ -394,9 +398,17 @@ public void onBindViewHolder(Presenter.ViewHolder viewHolder, Object item) {\n             holder.mCardView.setPlayingIndicator(true);\n         } else {\n             holder.mCardView.setPlayingIndicator(false);\n-            Drawable badge = rowItem.getBadgeImage();\n-            if (badge != null) {\n-                ((ViewHolder) viewHolder).mCardView.setBadgeImage(badge);\n+\n+            if (get(UserPreferences.class).get(UserPreferences.Companion.getDefaultRatingProvider()) == RatingProvider.RATING_RT) {\n+                Drawable badge = rowItem.getBadgeImage();\n+                ((ViewHolder) viewHolder).mCardView.setRating(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "139a6ef59be59380b66ffc64807cd3ea1373d2f1"}, "originalPosition": 28}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9dab5bdcedbde261f69e0df91cc0029f2bcaabb8", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/9dab5bdcedbde261f69e0df91cc0029f2bcaabb8", "committedDate": "2020-11-17T06:04:00Z", "message": "Remove excessive casting in CardPresenter.java"}, "afterCommit": {"oid": "7550a0cb690fe8aa09b39a952fdcbd9f3d02108b", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/7550a0cb690fe8aa09b39a952fdcbd9f3d02108b", "committedDate": "2020-11-17T06:33:06Z", "message": "Add the ability to choose IMDb as the default rating provider"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef18dd0c2925cd496367a525748eb1b30b5d0990", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/ef18dd0c2925cd496367a525748eb1b30b5d0990", "committedDate": "2020-11-28T15:23:24Z", "message": "Change strings to be more provider agnostic"}, "afterCommit": {"oid": "373acc8958f6f267f6d4d2e59422936f1cf20dcb", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/373acc8958f6f267f6d4d2e59422936f1cf20dcb", "committedDate": "2020-11-28T15:24:36Z", "message": "Change strings to be more provider agnostic"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNzYzMTYz", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#pullrequestreview-552763163", "createdAt": "2020-12-15T18:46:06Z", "commit": {"oid": "373acc8958f6f267f6d4d2e59422936f1cf20dcb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxODo0NjowNlrOIGafjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxODo1MjowMlrOIGavXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU5NjQyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Sets default rating provider to Rotten tomatoes.\n          \n          \n            \n            \t * Sets default rating provider to tomatoes.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r543596429", "createdAt": "2020-12-15T18:46:06Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/preference/constant/RatingProvider.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package org.jellyfin.androidtv.preference.constant\n+\n+import org.jellyfin.androidtv.R\n+import org.jellyfin.androidtv.ui.preference.dsl.EnumDisplayOptions\n+\n+enum class RatingProvider {\n+\t/**\n+\t * Sets default rating provider to Rotten tomatoes.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "373acc8958f6f267f6d4d2e59422936f1cf20dcb"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU5NjUwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Sets the default rating provider to IMDb.\n          \n          \n            \n            \t * Sets the default rating provider to stars.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r543596508", "createdAt": "2020-12-15T18:46:14Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/preference/constant/RatingProvider.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package org.jellyfin.androidtv.preference.constant\n+\n+import org.jellyfin.androidtv.R\n+import org.jellyfin.androidtv.ui.preference.dsl.EnumDisplayOptions\n+\n+enum class RatingProvider {\n+\t/**\n+\t * Sets default rating provider to Rotten tomatoes.\n+\t */\n+\t@EnumDisplayOptions(R.string.lbl_tomatoes)\n+\tRATING_TOMATOES,\n+\n+\t/**\n+\t * Sets the default rating provider to IMDb.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "373acc8958f6f267f6d4d2e59422936f1cf20dcb"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU5NzM3OA==", "bodyText": "I think the code will be more readable if the result of the get(UserPreferences.class).get(UserPreferences.Companion.getDefaultRatingProvider()) part is moved to a variable before the if statement.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r543597378", "createdAt": "2020-12-15T18:47:24Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/ui/presentation/CardPresenter.java", "diffHunk": "@@ -394,13 +398,21 @@ public void onBindViewHolder(Presenter.ViewHolder viewHolder, Object item) {\n             holder.mCardView.setPlayingIndicator(true);\n         } else {\n             holder.mCardView.setPlayingIndicator(false);\n-            Drawable badge = rowItem.getBadgeImage();\n-            if (badge != null) {\n-                ((ViewHolder) viewHolder).mCardView.setBadgeImage(badge);\n+\n+            if (get(UserPreferences.class).get(UserPreferences.Companion.getDefaultRatingProvider()) == RatingProvider.RATING_TOMATOES) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "373acc8958f6f267f6d4d2e59422936f1cf20dcb"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzYwMDQ3OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <string name=\"pref_default_rating\">Default Ratings Scale</string>\n          \n          \n            \n                <string name=\"pref_default_rating\">Default rating type</string>\n          \n      \n    \n    \n  \n\nCould apply this consistently in the code too", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r543600479", "createdAt": "2020-12-15T18:52:02Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/res/values/strings.xml", "diffHunk": "@@ -418,4 +418,7 @@\n     <string name=\"lbl_manual_login\">Manual Login</string>\n     <string name=\"lbl_playback_control_ends\">Ends at %1$s</string>\n     <string name=\"watch_count_overflow\">99+</string>\n+    <string name=\"lbl_stars\">Stars</string>\n+    <string name=\"lbl_tomatoes\">Tomatoes</string>\n+    <string name=\"pref_default_rating\">Default Ratings Scale</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "373acc8958f6f267f6d4d2e59422936f1cf20dcb"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12fc12f124226350569a539aa76041dbbb79d0de", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/12fc12f124226350569a539aa76041dbbb79d0de", "committedDate": "2020-12-17T04:24:22Z", "message": "Add the ability to change the default rating type displayed on cards"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62e5bd8c89bc47e8b990d0b7a3dc31913a7bec7a", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/62e5bd8c89bc47e8b990d0b7a3dc31913a7bec7a", "committedDate": "2020-12-17T04:19:20Z", "message": "Change strings to be more provider agnostic"}, "afterCommit": {"oid": "12fc12f124226350569a539aa76041dbbb79d0de", "author": {"user": {"login": "MrChip53", "name": "Chris Simoni"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/12fc12f124226350569a539aa76041dbbb79d0de", "committedDate": "2020-12-17T04:24:22Z", "message": "Add the ability to change the default rating type displayed on cards"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0NzE4MTky", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#pullrequestreview-554718192", "createdAt": "2020-12-17T15:32:48Z", "commit": {"oid": "12fc12f124226350569a539aa76041dbbb79d0de"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4233, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}