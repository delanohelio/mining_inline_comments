{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NDY4Njk2", "number": 490, "title": "Removed Picasso to be replaced by Glide.", "bodyText": "Changes\n\nMigration from Glide version 3 to 4.\nRemoved completly Picasso and OkHttp from the project to be replaced by Glide.\nCreated new BackgroundManager util to set the background drawable.\nRemoved unused imports.\nIssues\n\nCloses #403", "createdAt": "2020-05-30T13:51:11Z", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490", "merged": true, "mergeCommit": {"oid": "f276047df4d20996c790d8cf7647f0a4423b64ad"}, "closed": true, "closedAt": "2020-05-31T16:49:51Z", "author": {"login": "tukilo"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmXNPagH2gAyNDI1NDY4Njk2Ojc2Mzg3Y2FlOGVkM2NmNWVmOTRjNjE1ODYzNjczMzNlOWQ5MGRkZTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcmugpnAFqTQyMTUxMDMzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "76387cae8ed3cf5ef94c61586367333e9d90dde6", "author": {"user": null}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/76387cae8ed3cf5ef94c61586367333e9d90dde6", "committedDate": "2020-05-30T13:37:29Z", "message": "Glide migrated from 3 to 4. Removed Picasso to be replaced by Glide."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDA4MDY3", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#pullrequestreview-421408067", "createdAt": "2020-05-30T14:12:29Z", "commit": {"oid": "76387cae8ed3cf5ef94c61586367333e9d90dde6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxNDoxMjoyOVrOGcyvfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxNDoxNTozNVrOGcywbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg0NDY2OQ==", "bodyText": "We don't add \"created by\" comments to files. We only have them in some other files that were inherited from the old Emby code.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432844669", "createdAt": "2020-05-30T14:12:29Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,42 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.app.Activity\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.load.resource.bitmap.BitmapTransformation\n+import com.bumptech.glide.load.resource.bitmap.CenterInside\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+\n+/** Created by Oriol on 30/05/20. **/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76387cae8ed3cf5ef94c61586367333e9d90dde6"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg0NDc1NA==", "bodyText": "This could be a context", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432844754", "createdAt": "2020-05-30T14:13:23Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,42 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.app.Activity\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.load.resource.bitmap.BitmapTransformation\n+import com.bumptech.glide.load.resource.bitmap.CenterInside\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+\n+/** Created by Oriol on 30/05/20. **/\n+\n+fun BackgroundManager.drawable(\n+\tactivity: Activity,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76387cae8ed3cf5ef94c61586367333e9d90dde6"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg0NDkxMQ==", "bodyText": "We should return true here", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432844911", "createdAt": "2020-05-30T14:15:35Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,42 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.app.Activity\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.load.resource.bitmap.BitmapTransformation\n+import com.bumptech.glide.load.resource.bitmap.CenterInside\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+\n+/** Created by Oriol on 30/05/20. **/\n+\n+fun BackgroundManager.drawable(\n+\tactivity: Activity,\n+\turl: String,\n+\tskipMemoryCache: Boolean = true,\n+\ttransformation: BitmapTransformation = CenterInside(),\n+\twidthPixels: Int,\n+\theightPixels: Int\n+) {\n+\n+\tGlide.with(activity)\n+\t\t.load(url)\n+\t\t.skipMemoryCache(skipMemoryCache)\n+\t\t.override(widthPixels, heightPixels)\n+\t\t.transform(transformation)\n+\t\t.listener(object : RequestListener<Drawable?> {\n+\t\t\toverride fun onLoadFailed(e: GlideException?, model: Any, target: Target<Drawable?>, isFirstResource: Boolean): Boolean {\n+\t\t\t\treturn false\n+\t\t\t}\n+\n+\t\t\toverride fun onResourceReady(resource: Drawable?, model: Any, target: Target<Drawable?>, dataSource: DataSource, isFirstResource: Boolean): Boolean {\n+\t\t\t\tdrawable = resource\n+\t\t\t\treturn false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76387cae8ed3cf5ef94c61586367333e9d90dde6"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f01b88996d7ddcfacaef28711af6a5b55ee4b77", "author": {"user": {"login": "tukilo", "name": "omm"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/9f01b88996d7ddcfacaef28711af6a5b55ee4b77", "committedDate": "2020-05-30T16:32:02Z", "message": "Removed template by default \"Created by\". Removed all skipMemoryCache() calls. Removed unused imports. Removed SkipMemoryCache and Transformation params from BackgroundUtils. Added Timber.e in onLoadFailed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDMzMTM1", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#pullrequestreview-421433135", "createdAt": "2020-05-30T18:19:15Z", "commit": {"oid": "9f01b88996d7ddcfacaef28711af6a5b55ee4b77"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxODoxOToxNVrOGc0pUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMFQxODoxOToxNVrOGc0pUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg3NTg1Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t.override(widthPixels, heightPixels)\n          \n          \n            \n            \t\t.override(widthPixels, heightPixels)\n          \n          \n            \n            \t\t.centerCrop()\n          \n      \n    \n    \n  \n\nWhen testing I noticed some backdrops getting stretched which did not happen before this PR. Adding the centerCrop function here fixed it.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432875856", "createdAt": "2020-05-30T18:19:15Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.content.Context\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+import timber.log.Timber\n+\n+fun BackgroundManager.drawable(\n+\tcontext: Context,\n+\turl: String,\n+\twidthPixels: Int,\n+\theightPixels: Int\n+) {\n+\n+\tGlide.with(context)\n+\t\t.load(url)\n+\t\t.override(widthPixels, heightPixels)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f01b88996d7ddcfacaef28711af6a5b55ee4b77"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d21b97be9c204d2ef54d9b6a238be25217886499", "author": {"user": {"login": "tukilo", "name": "omm"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/d21b97be9c204d2ef54d9b6a238be25217886499", "committedDate": "2020-05-30T18:36:11Z", "message": "Update app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt\n\nCo-authored-by: Niels van Velzen <nielsvanvelzen@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDM0NTM0", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#pullrequestreview-421434534", "createdAt": "2020-05-30T18:40:28Z", "commit": {"oid": "d21b97be9c204d2ef54d9b6a238be25217886499"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNTAyOTUz", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#pullrequestreview-421502953", "createdAt": "2020-05-31T15:05:29Z", "commit": {"oid": "d21b97be9c204d2ef54d9b6a238be25217886499"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNTowNToyOVrOGc5iLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNTowNTo1MlrOGc5iUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1NTk0OQ==", "bodyText": "As this file only contains a single extension function I'd recommend renaming it to \"BackgroundManagerExtensions\" to stay consistent with the other file(s)", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432955949", "createdAt": "2020-05-31T15:05:29Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.content.Context\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+import timber.log.Timber\n+\n+fun BackgroundManager.drawable(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d21b97be9c204d2ef54d9b6a238be25217886499"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1NTk3Nw==", "bodyText": "Unnecessary whitespace", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432955977", "createdAt": "2020-05-31T15:05:42Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.content.Context\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+import timber.log.Timber\n+\n+fun BackgroundManager.drawable(\n+\tcontext: Context,\n+\turl: String,\n+\twidthPixels: Int,\n+\theightPixels: Int\n+) {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d21b97be9c204d2ef54d9b6a238be25217886499"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1NTk4Ng==", "bodyText": "Unnecessary whitespace", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432955986", "createdAt": "2020-05-31T15:05:52Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.content.Context\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+import timber.log.Timber\n+\n+fun BackgroundManager.drawable(\n+\tcontext: Context,\n+\turl: String,\n+\twidthPixels: Int,\n+\theightPixels: Int\n+) {\n+\n+\tGlide.with(context)\n+\t\t.load(url)\n+\t\t.override(widthPixels, heightPixels)\n+\t\t.centerCrop()\n+\t\t.listener(object : RequestListener<Drawable?> {\n+\t\t\toverride fun onLoadFailed(e: GlideException?, model: Any, target: Target<Drawable?>, isFirstResource: Boolean): Boolean {\n+\t\t\t\tTimber.e(e)\n+\t\t\t\treturn false\n+\t\t\t}\n+\n+\t\t\toverride fun onResourceReady(resource: Drawable?, model: Any, target: Target<Drawable?>, dataSource: DataSource, isFirstResource: Boolean): Boolean {\n+\t\t\t\tdrawable = resource\n+\t\t\t\treturn true\n+\t\t\t}\n+\t\t}).submit()\n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d21b97be9c204d2ef54d9b6a238be25217886499"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbfceb501fd0e622b09069ef1ed01404f70f467d", "author": {"user": {"login": "tukilo", "name": "omm"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/bbfceb501fd0e622b09069ef1ed01404f70f467d", "committedDate": "2020-05-31T16:40:53Z", "message": "Small details"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNTEwMzMx", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#pullrequestreview-421510331", "createdAt": "2020-05-31T16:46:30Z", "commit": {"oid": "bbfceb501fd0e622b09069ef1ed01404f70f467d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4141, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}