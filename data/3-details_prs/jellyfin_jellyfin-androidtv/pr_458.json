{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4OTI0NDEw", "number": 458, "title": "Remove unnecessary layout xml files", "bodyText": "Changes\n\nDon't use the \"key listener\" from BaseActivity in activities extending it\n\nIt is still used in fragments for now\n\n\nRemoved the activity_[X].xml files that only contained a fragment\n\nThe Activity class now uses the fragmentManager to set it's content\n\n\nRewrite all the simple FragmentActivity classes in Kotlin\n\nOnly the ones changed in the previous item\n\n\nRedo the \"ExpandableTextView\"\n\nNow in Kotlin!\nLess code smells!\nNo magic strings!\nBackground using XML instead of code\nAlways clickable\nNo \"currentActivity\"! :)\n\n\n\n\nIssues\n\nNotes\n\nAt some point we can reduce the amount of activities to just a few that use fragments for their content. For example; instead of using all those activities in the browsing package we could have just one.\nDepends on #457", "createdAt": "2020-04-25T15:23:06Z", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458", "merged": true, "mergeCommit": {"oid": "1cd336e6d5c7ec667de3454174bcfe1edfbf1f9e"}, "closed": true, "closedAt": "2020-04-29T16:58:37Z", "author": {"login": "nielsvanvelzen"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbHwSdgFqTQwMDQwMzQ3MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABccbgFzgFqTQwMjg2MTI2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDAzNDcx", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#pullrequestreview-400403471", "createdAt": "2020-04-25T15:24:05Z", "commit": {"oid": "0d23a89917965ceeb6347bfaf5aefaa693d480ed"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNVQxNToyNDowNVrOGL2tuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNVQxNToyNDowNlrOGL2tvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTA4Mzk2MQ==", "bodyText": "Refactor this method to reduce its Cognitive Complexity from 27 to the 15 allowed.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415083961", "createdAt": "2020-04-25T15:24:05Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/details/PhotoPlayerActivity.java", "diffHunk": "@@ -113,72 +112,70 @@ public void onCreate(Bundle savedInstanceState) {\n         mPopupRowsFragment.setOnItemViewClickedListener(itemViewClickedListener);\n         mPopupRowsFragment.setOnItemViewSelectedListener(itemViewSelectedListener);\n         setupPopupAnimations();\n+    }\n \n-        registerKeyListener(new IKeyListener() {\n-            @Override\n-            public boolean onKeyUp(int key, KeyEvent event) {\n-                switch (key) {\n-\n-                    case KeyEvent.KEYCODE_BACK:\n-                    case KeyEvent.KEYCODE_B:\n-                        if (mPopupPanelVisible) {\n-                            hideThumbPanel();\n-                            return true;\n-                        }\n-                        break;\n-\n-                    case KeyEvent.KEYCODE_DPAD_RIGHT:\n-                        if (!mPopupPanelVisible && MediaManager.hasNextMediaItem()) {\n-                            if (isLoadingNext || isTransitioning)\n-                                return true; //swallow too fast requests\n-                            if (isPlaying) {\n-                                stop();\n-                                play();\n-                            } else {\n-                                next(750);\n-                            }\n-                            return true;\n-                        }\n-                        break;\n-\n-                    case KeyEvent.KEYCODE_DPAD_LEFT:\n-                        if (!mPopupPanelVisible && MediaManager.hasPrevMediaItem()) {\n-                            if (isLoadingPrev || isTransitioning)\n-                                return true; //swallow too fast requests\n-                            if (isPlaying) stop();\n-                            currentPhoto = MediaManager.prevMedia().getBaseItem();\n-                            nextImage.setImageDrawable(currentImageView().getDrawable());\n-                            nextImageView().setImageDrawable(prevImage.getDrawable());\n-                            transition(750);\n-                            loadPrev();\n-                            return true;\n-                        }\n-                        break;\n+    @Override\n+    public boolean onKeyUp(int keyCode, KeyEvent event) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d23a89917965ceeb6347bfaf5aefaa693d480ed"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTA4Mzk2Mw==", "bodyText": "Add a default case to this switch.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415083963", "createdAt": "2020-04-25T15:24:06Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/details/ItemListActivity.java", "diffHunk": "@@ -197,6 +161,41 @@ public boolean onKeyUp(int key, KeyEvent event) {\n \n     }\n \n+\n+\n+    @Override\n+    public boolean onKeyUp(int keyCode, KeyEvent event) {\n+        if (MediaManager.isPlayingAudio()) {\n+            switch (keyCode) {\n+                case KeyEvent.KEYCODE_MEDIA_PAUSE:\n+                case KeyEvent.KEYCODE_MEDIA_PLAY_PAUSE:\n+                    if (MediaManager.isPlayingAudio()) MediaManager.pauseAudio();\n+                    else MediaManager.resumeAudio();\n+                    return true;\n+                case KeyEvent.KEYCODE_MEDIA_NEXT:\n+                case KeyEvent.KEYCODE_MEDIA_FAST_FORWARD:\n+                    MediaManager.nextAudioItem();\n+                    return true;\n+                case KeyEvent.KEYCODE_MEDIA_PREVIOUS:\n+                case KeyEvent.KEYCODE_MEDIA_REWIND:\n+                    MediaManager.prevAudioItem();\n+                    return true;\n+                case KeyEvent.KEYCODE_MENU:\n+                    showMenu(mCurrentRow, false);\n+                    return true;\n+            }\n+        } else if (mCurrentRow != null) {\n+            switch (keyCode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d23a89917965ceeb6347bfaf5aefaa693d480ed"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTA4Mzk2NA==", "bodyText": "Add a default case to this switch.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415083964", "createdAt": "2020-04-25T15:24:06Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/details/ItemListActivity.java", "diffHunk": "@@ -197,6 +161,41 @@ public boolean onKeyUp(int key, KeyEvent event) {\n \n     }\n \n+\n+\n+    @Override\n+    public boolean onKeyUp(int keyCode, KeyEvent event) {\n+        if (MediaManager.isPlayingAudio()) {\n+            switch (keyCode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d23a89917965ceeb6347bfaf5aefaa693d480ed"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTA4Mzk2NQ==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415083965", "createdAt": "2020-04-25T15:24:06Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/CollectionActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d23a89917965ceeb6347bfaf5aefaa693d480ed"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTA4Mzk2Nw==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415083967", "createdAt": "2020-04-25T15:24:06Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/startup/SelectUserActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.startup", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d23a89917965ceeb6347bfaf5aefaa693d480ed"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNDc1OTI1", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#pullrequestreview-400475925", "createdAt": "2020-04-26T08:33:42Z", "commit": {"oid": "57e73765ae78ed4c19f6e3ec7d36012310030cf0"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQwODozMzo0MlrOGMBF6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQwODozMzo0M1rOGMBF9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI1Mzk5NQ==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415253995", "createdAt": "2020-04-26T08:33:42Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/startup/SelectServerActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.startup", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e73765ae78ed4c19f6e3ec7d36012310030cf0"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI1Mzk5Nw==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415253997", "createdAt": "2020-04-26T08:33:42Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/ByGenreActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e73765ae78ed4c19f6e3ec7d36012310030cf0"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI1Mzk5OQ==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415253999", "createdAt": "2020-04-26T08:33:43Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/ByLetterActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e73765ae78ed4c19f6e3ec7d36012310030cf0"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI1NDAwMw==", "bodyText": "Method onKeyUp has 51 lines of code (exceeds 25 allowed). Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415254003", "createdAt": "2020-04-26T08:33:43Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/details/PhotoPlayerActivity.java", "diffHunk": "@@ -113,72 +112,70 @@ public void onCreate(Bundle savedInstanceState) {\n         mPopupRowsFragment.setOnItemViewClickedListener(itemViewClickedListener);\n         mPopupRowsFragment.setOnItemViewSelectedListener(itemViewSelectedListener);\n         setupPopupAnimations();\n+    }\n \n-        registerKeyListener(new IKeyListener() {\n-            @Override\n-            public boolean onKeyUp(int key, KeyEvent event) {\n-                switch (key) {\n-\n-                    case KeyEvent.KEYCODE_BACK:\n-                    case KeyEvent.KEYCODE_B:\n-                        if (mPopupPanelVisible) {\n-                            hideThumbPanel();\n-                            return true;\n-                        }\n-                        break;\n-\n-                    case KeyEvent.KEYCODE_DPAD_RIGHT:\n-                        if (!mPopupPanelVisible && MediaManager.hasNextMediaItem()) {\n-                            if (isLoadingNext || isTransitioning)\n-                                return true; //swallow too fast requests\n-                            if (isPlaying) {\n-                                stop();\n-                                play();\n-                            } else {\n-                                next(750);\n-                            }\n-                            return true;\n-                        }\n-                        break;\n-\n-                    case KeyEvent.KEYCODE_DPAD_LEFT:\n-                        if (!mPopupPanelVisible && MediaManager.hasPrevMediaItem()) {\n-                            if (isLoadingPrev || isTransitioning)\n-                                return true; //swallow too fast requests\n-                            if (isPlaying) stop();\n-                            currentPhoto = MediaManager.prevMedia().getBaseItem();\n-                            nextImage.setImageDrawable(currentImageView().getDrawable());\n-                            nextImageView().setImageDrawable(prevImage.getDrawable());\n-                            transition(750);\n-                            loadPrev();\n-                            return true;\n-                        }\n-                        break;\n+    @Override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e73765ae78ed4c19f6e3ec7d36012310030cf0"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI1NDAwNQ==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415254005", "createdAt": "2020-04-26T08:33:43Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/GenericFolderActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e73765ae78ed4c19f6e3ec7d36012310030cf0"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33a94393c2e8769ccbd099ddf45629699e0f10d0", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/33a94393c2e8769ccbd099ddf45629699e0f10d0", "committedDate": "2020-04-28T15:52:43Z", "message": "Add own key handling in ItemList and PhotoPlayer activities"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41098f93a4df2b6d396ff7b93bb02d7e0d6c848e", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/41098f93a4df2b6d396ff7b93bb02d7e0d6c848e", "committedDate": "2020-04-28T15:52:43Z", "message": "Replace all layouts with a single fragment to use the fragmentmanager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5dbd02e584766140daba04081d66ef0285171a9", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/f5dbd02e584766140daba04081d66ef0285171a9", "committedDate": "2020-04-28T15:52:44Z", "message": "Convert the modified activities to Kotlin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/ba461b0165936fed8fd1179bfb49b405f6490c10", "committedDate": "2020-04-28T15:52:45Z", "message": "Redo ExpandableTextView"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "57e73765ae78ed4c19f6e3ec7d36012310030cf0", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/57e73765ae78ed4c19f6e3ec7d36012310030cf0", "committedDate": "2020-04-26T08:30:40Z", "message": "Redo ExpandableTextView"}, "afterCommit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10", "author": {"user": {"login": "nielsvanvelzen", "name": "Niels van Velzen"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/ba461b0165936fed8fd1179bfb49b405f6490c10", "committedDate": "2020-04-28T15:52:45Z", "message": "Redo ExpandableTextView"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxOTc5MjEw", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#pullrequestreview-401979210", "createdAt": "2020-04-28T15:54:28Z", "commit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNTo1NDoyOVrOGNbHow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNTo1NDozMFrOGNbHtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcyODk5NQ==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r416728995", "createdAt": "2020-04-28T15:54:29Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/UserViewActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcyOTAwNA==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r416729004", "createdAt": "2020-04-28T15:54:29Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/GenericGridActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcyOTAwOQ==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r416729009", "createdAt": "2020-04-28T15:54:29Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/BrowseRecordingsActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcyOTAxMw==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r416729013", "createdAt": "2020-04-28T15:54:29Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/BrowseScheduleActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcyOTAxNQ==", "bodyText": "Similar blocks of code found in 14 locations. Consider refactoring.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r416729015", "createdAt": "2020-04-28T15:54:30Z", "author": {"login": "codeclimate"}, "path": "app/src/main/java/org/jellyfin/androidtv/browsing/BrowsePersonsActivity.kt", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.jellyfin.androidtv.browsing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyODYxMjYy", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#pullrequestreview-402861262", "createdAt": "2020-04-29T16:58:27Z", "commit": {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4322, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}