{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxNTU2Mzg5", "number": 295, "title": "Implement Cast display for Movies", "bodyText": "Basically this is very much not yet done, but more to verify whether this is an acceptable path to handling item selection, or whether we want to go with a more complex scheme like a custom row that handles its own clicks or each item on its own.\nAlso, I experimented with square cards and it already did not look good as some actor pictures are off-center, so circle crop would definitely ruin them. Will need to stay in portrait mode.\nAnother question is whether we would want to use our own layout or not, because to me the default ImageCardView seems fine for now.\nThis is what it looks like currently", "createdAt": "2020-02-05T19:54:42Z", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295", "merged": true, "mergeCommit": {"oid": "76b22dcf69acd02d47474b2444e93381657a4fe7"}, "closed": true, "closedAt": "2020-02-08T12:20:24Z", "author": {"login": "AndreasGB"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBbmSmAH2gAyMzcxNTU2Mzg5OjZhOTM4M2JjYzIxZTU4YjBhYjNjOTBhYjMxNzdjODY5MWY1YWQ3NmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcCSvDagH2gAyMzcxNTU2Mzg5OjY0OGQ3ZDBlZTk1ODExZDhmMGIyNjBiNDU5ZTIwMzdmMmNlYTIxZTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6a9383bcc21e58b0ab3c90ab3177c8691f5ad76f", "author": {"user": {"login": "AndreasGB", "name": "Andreas"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/6a9383bcc21e58b0ab3c90ab3177c8691f5ad76f", "committedDate": "2020-02-05T19:49:16Z", "message": "Initial PersonPresenter as well as cast display for movies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MDI0ODA0", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#pullrequestreview-354024804", "createdAt": "2020-02-05T20:39:58Z", "commit": {"oid": "6a9383bcc21e58b0ab3c90ab3177c8691f5ad76f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQyMDozOTo1OFrOFmGblg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQyMDo0MDoyNFrOFmGcTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ5NTU3NA==", "bodyText": "Can be moved to a seperate file as it doesn't use our base class (yet?)", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#discussion_r375495574", "createdAt": "2020-02-05T20:39:58Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/model/itemtypes/LiftedItems.kt", "diffHunk": "@@ -36,4 +39,14 @@ class Episode(original: BaseItemDto) : PlayableItem(original) {\n \t}\n }\n \n-class Movie(original: BaseItemDto) : PlayableItem(original)\n+class Person(original: BaseItemPerson) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a9383bcc21e58b0ab3c90ab3177c8691f5ad76f"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ5NTc1Nw==", "bodyText": "Don't persons support multiple images? In that case we could use the imagecollection", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#discussion_r375495757", "createdAt": "2020-02-05T20:40:24Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/model/itemtypes/LiftedItems.kt", "diffHunk": "@@ -36,4 +39,14 @@ class Episode(original: BaseItemDto) : PlayableItem(original) {\n \t}\n }\n \n-class Movie(original: BaseItemDto) : PlayableItem(original)\n+class Person(original: BaseItemPerson) {\n+\tval id: String = original.id\n+\tval name: String = original.name\n+\tval role: String = original.role\n+\tval type: PersonType = original.personType\n+\tval primaryImage: ImageCollection.Image? = original.primaryImageTag?.let { ImageCollection.Image(original.id, ImageType.Primary, it) }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a9383bcc21e58b0ab3c90ab3177c8691f5ad76f"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b0ee283b5e7eaff1f1f3d0c3aad32c4c8ebc9ea", "author": {"user": {"login": "AndreasGB", "name": "Andreas"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/4b0ee283b5e7eaff1f1f3d0c3aad32c4c8ebc9ea", "committedDate": "2020-02-07T13:48:43Z", "message": "Item Click handling moved to Presenters, new Marquee ImageCardView Style, Refactoring"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NDMwNzkw", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#pullrequestreview-355430790", "createdAt": "2020-02-07T20:54:45Z", "commit": {"oid": "4b0ee283b5e7eaff1f1f3d0c3aad32c4c8ebc9ea"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMDo1NDo0NVrOFnKAng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMDo1ODowNFrOFnKGFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwMjc4Mg==", "bodyText": "override fun onBindViewHolder(viewHolder: ViewHolder, item: Any) {\nshould work, so you won't need the requireNotNull calls", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#discussion_r376602782", "createdAt": "2020-02-07T20:54:45Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/details/PersonPresenter.kt", "diffHunk": "@@ -1,28 +1,42 @@\n package org.jellyfin.androidtv.details\n \n+import android.content.Context\n+import android.content.Intent\n import android.graphics.drawable.BitmapDrawable\n import android.view.ViewGroup\n+import androidx.appcompat.view.ContextThemeWrapper\n import androidx.leanback.widget.ImageCardView\n-import androidx.leanback.widget.Presenter\n import kotlinx.coroutines.Dispatchers\n import kotlinx.coroutines.GlobalScope\n import kotlinx.coroutines.launch\n import org.jellyfin.androidtv.R\n import org.jellyfin.androidtv.TvApp\n-import org.jellyfin.androidtv.model.itemtypes.Person\n-import org.jellyfin.androidtv.presentation.MyImageCardView\n+import org.jellyfin.androidtv.base.ClickablePresenter\n+import org.jellyfin.androidtv.model.itemtypes.BriefPersonData\n \n private const val LOG_TAG = \"PersonPresenter\"\n \n-class PersonPresenter : Presenter() {\n+class PersonPresenter(private val context: Context) : ClickablePresenter() {\n+\n+\toverride fun onItemClicked(item: Any?) {\n+\t\trequireNotNull(item)\n+\t\tval person = item as BriefPersonData\n+\t\tval intent = Intent(context, FullDetailsActivity::class.java)\n+\t\tintent.putExtra(\"ItemId\", person.id)\n+\n+\t\tcontext.startActivity(intent)\n+\t}\n+\n \toverride fun onCreateViewHolder(parent: ViewGroup?): ViewHolder {\n-\t\treturn ViewHolder(ImageCardView(parent!!.context))\n+\t\treturn ViewHolder(ImageCardView(ContextThemeWrapper(parent!!.context, R.style.MarqueeImageCardViewTheme)))\n \t}\n \n \toverride fun onBindViewHolder(viewHolder: ViewHolder?, item: Any?) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b0ee283b5e7eaff1f1f3d0c3aad32c4c8ebc9ea"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwMzA5Nw==", "bodyText": "Interface might be better if it only defines the \"clickability\"", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#discussion_r376603097", "createdAt": "2020-02-07T20:55:39Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/base/ClickablePresenter.kt", "diffHunk": "@@ -0,0 +1,7 @@\n+package org.jellyfin.androidtv.base\n+\n+import androidx.leanback.widget.Presenter\n+\n+abstract class ClickablePresenter : Presenter() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b0ee283b5e7eaff1f1f3d0c3aad32c4c8ebc9ea"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwMzI5OQ==", "bodyText": "Might be worth using a generic on the class/interface so we don't need to use the any type", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#discussion_r376603299", "createdAt": "2020-02-07T20:56:06Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/base/ClickablePresenter.kt", "diffHunk": "@@ -0,0 +1,7 @@\n+package org.jellyfin.androidtv.base\n+\n+import androidx.leanback.widget.Presenter\n+\n+abstract class ClickablePresenter : Presenter() {\n+\tabstract fun onItemClicked(item: Any?)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b0ee283b5e7eaff1f1f3d0c3aad32c4c8ebc9ea"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYwNDE4MQ==", "bodyText": "Use this.context instead of this.activity", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#discussion_r376604181", "createdAt": "2020-02-07T20:58:04Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/details/MovieDetailsFragment.kt", "diffHunk": "@@ -1,22 +1,19 @@\n package org.jellyfin.androidtv.details\n \n-import android.content.Intent\n-import android.util.Log\n import androidx.leanback.widget.*\n import org.jellyfin.androidtv.R\n import org.jellyfin.androidtv.details.actions.*\n import org.jellyfin.androidtv.model.itemtypes.Movie\n-import org.jellyfin.androidtv.model.itemtypes.Person\n import org.jellyfin.androidtv.presentation.InfoCardPresenter\n \n private const val LOG_TAG = \"MovieDetailsFragment\"\n \n-class MovieDetailsFragment(item: Movie) : BaseDetailsFragment<Movie>(item), OnItemViewClickedListener {\n+class MovieDetailsFragment(item: Movie) : BaseDetailsFragment<Movie>(item) {\n \n \tprivate val detailsRow by lazy { DetailsOverviewRow(Unit).apply { actionsAdapter = ActionAdapter() } }\n //\tprivate val chaptersRow by lazy { Row() }\n //\tprivate val staffRow by lazy { Row() }\n-\tprivate val charactersRow by lazy { ListRow(HeaderItem(\"Cast/Crew\"), ArrayObjectAdapter(PersonPresenter())) }\n+\tprivate val charactersRow by lazy { ListRow(HeaderItem(\"Cast/Crew\"), ArrayObjectAdapter(PersonPresenter(this.activity!!))) }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b0ee283b5e7eaff1f1f3d0c3aad32c4c8ebc9ea"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5fe796ba251ca90abfabf9a03dc80cfdb9457b6", "author": {"user": {"login": "AndreasGB", "name": "Andreas"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/e5fe796ba251ca90abfabf9a03dc80cfdb9457b6", "committedDate": "2020-02-07T23:21:03Z", "message": "Refactoring ClickablePresenter to ItemClickListener Interface + minor other refactors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NTM4MjY3", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#pullrequestreview-355538267", "createdAt": "2020-02-08T08:55:04Z", "commit": {"oid": "e5fe796ba251ca90abfabf9a03dc80cfdb9457b6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOFQwODo1NTowNFrOFnPz8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOFQwODo1NTowNFrOFnPz8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY5Nzg0MA==", "bodyText": "We don't need this import. When using Android Studio you can have it fix your imports when creating commits. (option for this is in the commit dialog)", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/295#discussion_r376697840", "createdAt": "2020-02-08T08:55:04Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/base/IItemClickListener.kt", "diffHunk": "@@ -0,0 +1,7 @@\n+package org.jellyfin.androidtv.base\n+\n+import androidx.leanback.widget.Presenter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5fe796ba251ca90abfabf9a03dc80cfdb9457b6"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "648d7d0ee95811d8f0b260b459e2037f2cea21e7", "author": {"user": {"login": "AndreasGB", "name": "Andreas"}}, "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/648d7d0ee95811d8f0b260b459e2037f2cea21e7", "committedDate": "2020-02-08T12:03:37Z", "message": "Remove unnecessary import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4375, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}