{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMTIzNzYx", "number": 260, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQyMzo1MDoxOVrODYrU-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxODowNToyOFrODejYlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3MjAyMjk4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/preferences/ui/UserPreferencesFragment.kt", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQyMzo1MDoxOVrOFerHZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQxMToxMjoxMlrOFfOX3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzcwODAwNQ==", "bodyText": "Should we be using LeanbackPreferenceFragmentCompat?", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/260#discussion_r367708005", "createdAt": "2020-01-16T23:50:19Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/preferences/ui/UserPreferencesFragment.kt", "diffHunk": "@@ -0,0 +1,145 @@\n+package org.jellyfin.androidtv.preferences.ui\n+\n+import android.app.AlertDialog\n+import android.content.SharedPreferences\n+import android.content.SharedPreferences.OnSharedPreferenceChangeListener\n+import android.os.Bundle\n+import androidx.preference.*\n+import org.jellyfin.androidtv.R\n+import org.jellyfin.androidtv.TvApp\n+import org.jellyfin.androidtv.model.LogonCredentials\n+import org.jellyfin.androidtv.util.DeviceUtils\n+import org.jellyfin.androidtv.util.apiclient.AuthenticationHelper\n+import java.io.IOException\n+\n+class UserPreferencesFragment : PreferenceFragmentCompat(), OnSharedPreferenceChangeListener {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc6d8c9f6d6ae917d544c510bc7434af3d580713"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA1ODQ3NA==", "bodyText": "LeanbackPreferenceFragmentCompat unfortunately doesn't work, when I tried it previously it crashed the application. So for now I didn't change the ui much. I might do that in the future though.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/260#discussion_r368058474", "createdAt": "2020-01-17T17:47:03Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/preferences/ui/UserPreferencesFragment.kt", "diffHunk": "@@ -0,0 +1,145 @@\n+package org.jellyfin.androidtv.preferences.ui\n+\n+import android.app.AlertDialog\n+import android.content.SharedPreferences\n+import android.content.SharedPreferences.OnSharedPreferenceChangeListener\n+import android.os.Bundle\n+import androidx.preference.*\n+import org.jellyfin.androidtv.R\n+import org.jellyfin.androidtv.TvApp\n+import org.jellyfin.androidtv.model.LogonCredentials\n+import org.jellyfin.androidtv.util.DeviceUtils\n+import org.jellyfin.androidtv.util.apiclient.AuthenticationHelper\n+import java.io.IOException\n+\n+class UserPreferencesFragment : PreferenceFragmentCompat(), OnSharedPreferenceChangeListener {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzcwODAwNQ=="}, "originalCommit": {"oid": "bc6d8c9f6d6ae917d544c510bc7434af3d580713"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI2MDgxMg==", "bodyText": "I don\u2019t like that this doesn\u2019t match the app theme. Maybe we should extend the default theme you used to apply the Jellyfin colors as a temporary solution?", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/260#discussion_r368260812", "createdAt": "2020-01-19T02:32:30Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/preferences/ui/UserPreferencesFragment.kt", "diffHunk": "@@ -0,0 +1,145 @@\n+package org.jellyfin.androidtv.preferences.ui\n+\n+import android.app.AlertDialog\n+import android.content.SharedPreferences\n+import android.content.SharedPreferences.OnSharedPreferenceChangeListener\n+import android.os.Bundle\n+import androidx.preference.*\n+import org.jellyfin.androidtv.R\n+import org.jellyfin.androidtv.TvApp\n+import org.jellyfin.androidtv.model.LogonCredentials\n+import org.jellyfin.androidtv.util.DeviceUtils\n+import org.jellyfin.androidtv.util.apiclient.AuthenticationHelper\n+import java.io.IOException\n+\n+class UserPreferencesFragment : PreferenceFragmentCompat(), OnSharedPreferenceChangeListener {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzcwODAwNQ=="}, "originalCommit": {"oid": "bc6d8c9f6d6ae917d544c510bc7434af3d580713"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI4NTY2Mg==", "bodyText": "I managed to get the leanback style preferences working. It now looks like this:", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/260#discussion_r368285662", "createdAt": "2020-01-19T11:12:12Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/preferences/ui/UserPreferencesFragment.kt", "diffHunk": "@@ -0,0 +1,145 @@\n+package org.jellyfin.androidtv.preferences.ui\n+\n+import android.app.AlertDialog\n+import android.content.SharedPreferences\n+import android.content.SharedPreferences.OnSharedPreferenceChangeListener\n+import android.os.Bundle\n+import androidx.preference.*\n+import org.jellyfin.androidtv.R\n+import org.jellyfin.androidtv.TvApp\n+import org.jellyfin.androidtv.model.LogonCredentials\n+import org.jellyfin.androidtv.util.DeviceUtils\n+import org.jellyfin.androidtv.util.apiclient.AuthenticationHelper\n+import java.io.IOException\n+\n+class UserPreferencesFragment : PreferenceFragmentCompat(), OnSharedPreferenceChangeListener {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzcwODAwNQ=="}, "originalCommit": {"oid": "bc6d8c9f6d6ae917d544c510bc7434af3d580713"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMDYwODk5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/startup/StartupActivity.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQwOTo1NToxNVrOFnUNlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wOVQwOTo1NToxNVrOFnUNlw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc2OTk0Mw==", "bodyText": "Might want to move this to the newly created stores", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/260#discussion_r376769943", "createdAt": "2020-02-09T09:55:15Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/startup/StartupActivity.java", "diffHunk": "@@ -57,26 +57,6 @@ protected void onCreate(Bundle savedInstanceState) {\n         application = (TvApp) getApplicationContext();\n         logger = application.getLogger();\n \n-        //Migrate prefs\n-        if (Integer.parseInt(application.getConfigVersion()) < 2) {\n-            application.getSystemPrefs().edit().putString(\"sys_pref_config_version\", \"2\").apply();\n-        }\n-        if (Integer.parseInt(application.getConfigVersion()) < 3) {\n-            application.getPrefs().edit().putString(\"pref_max_bitrate\", \"0\").apply();\n-            application.getSystemPrefs().edit().putString(\"sys_pref_config_version\", \"3\").apply();\n-        }\n-        if (Integer.parseInt(application.getConfigVersion()) < 4) {\n-            application.getPrefs().edit().putBoolean(\"pref_enable_premieres\", false).apply();\n-            application.getPrefs().edit().putBoolean(\"pref_enable_info_panel\", false).apply();\n-            application.getSystemPrefs().edit().putString(\"sys_pref_config_version\", \"4\").apply();\n-        }\n-        if (Integer.parseInt(application.getConfigVersion()) < 5) {\n-            boolean useExternal = application.getPrefs().getBoolean(\"pref_video_use_external\", false);\n-\n-            application.getPrefs().edit().putString(\"pref_video_player\", useExternal ? \"external\" : \"auto\").apply();\n-            application.getSystemPrefs().edit().putString(\"sys_pref_config_version\", \"5\").apply();\n-        }\n-\n         //Ensure we have prefs\n         PreferenceManager.setDefaultValues(this, R.xml.preferences, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c67afcd4380eb4c84687a4750b3b805083d0f8c9"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzMzYzNjA3OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/org/jellyfin/androidtv/preferences/UserPreferences.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxODowNToyOFrOFnwGVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxOToyMTo0MFrOFnyd4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNjgzNw==", "bodyText": "It seems all boolean preferences are being defaulted to false now. Is this correct?", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/260#discussion_r377226837", "createdAt": "2020-02-10T18:05:28Z", "author": {"login": "thornbill"}, "path": "app/src/main/java/org/jellyfin/androidtv/preferences/UserPreferences.kt", "diffHunk": "@@ -0,0 +1,169 @@\n+package org.jellyfin.androidtv.preferences\n+\n+import android.content.Context\n+import android.preference.PreferenceManager\n+import org.jellyfin.androidtv.preferences.enums.AudioBehavior\n+import org.jellyfin.androidtv.preferences.enums.LoginBehavior\n+import org.jellyfin.androidtv.preferences.enums.PreferredVideoPlayer\n+\n+/**\n+ * User preferences are configurable by the user and change behavior of the application.\n+ * When changing preferences migration should be added to the init function.\n+ *\n+ * @param context Context to get the SharedPreferences from\n+ */\n+class UserPreferences(context: Context) : SharedPreferenceStore(PreferenceManager.getDefaultSharedPreferences(context)) {\n+\t/* Authentication */\n+\t/**\n+\t * Behavior for login when starting the app.\n+\t * **note**: Currently settable via user-preferences only due too custom logic\n+\t */\n+\tvar loginBehavior by enumPreference(\"login_behavior\", LoginBehavior.SHOW_LOGIN)\n+\t\tprivate set\n+\n+\t/**\n+\t * Ask for password when starting the app\n+\t */\n+\tvar passwordPromptEnabled by booleanPreference(\"pref_auto_pw_prompt\", false)\n+\n+\t/**\n+\t * Use login using pin (when set)\n+\t */\n+\tvar passwordDPadEnabled by booleanPreference(\"pref_alt_pw_entry\", false)\n+\n+\t/**\n+\t * Sign out automatically after x milliseconds\n+\t */\n+\tvar autoSignOutTimeout by stringPreference(\"pref_auto_logoff_timeout\", \"3600000\")\n+\n+\t/* Display */\n+\t/**\n+\t * Enable background images while browsing\n+\t */\n+\tvar backdropEnabled by booleanPreference(\"pref_show_backdrop\", false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3686914935358980fb35916e0d5bc82bdfb6392f"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI2NTYzMw==", "bodyText": "I might have forgotten to set the default values for the booleans. I'll check them tomorrow.", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/260#discussion_r377265633", "createdAt": "2020-02-10T19:21:40Z", "author": {"login": "nielsvanvelzen"}, "path": "app/src/main/java/org/jellyfin/androidtv/preferences/UserPreferences.kt", "diffHunk": "@@ -0,0 +1,169 @@\n+package org.jellyfin.androidtv.preferences\n+\n+import android.content.Context\n+import android.preference.PreferenceManager\n+import org.jellyfin.androidtv.preferences.enums.AudioBehavior\n+import org.jellyfin.androidtv.preferences.enums.LoginBehavior\n+import org.jellyfin.androidtv.preferences.enums.PreferredVideoPlayer\n+\n+/**\n+ * User preferences are configurable by the user and change behavior of the application.\n+ * When changing preferences migration should be added to the init function.\n+ *\n+ * @param context Context to get the SharedPreferences from\n+ */\n+class UserPreferences(context: Context) : SharedPreferenceStore(PreferenceManager.getDefaultSharedPreferences(context)) {\n+\t/* Authentication */\n+\t/**\n+\t * Behavior for login when starting the app.\n+\t * **note**: Currently settable via user-preferences only due too custom logic\n+\t */\n+\tvar loginBehavior by enumPreference(\"login_behavior\", LoginBehavior.SHOW_LOGIN)\n+\t\tprivate set\n+\n+\t/**\n+\t * Ask for password when starting the app\n+\t */\n+\tvar passwordPromptEnabled by booleanPreference(\"pref_auto_pw_prompt\", false)\n+\n+\t/**\n+\t * Use login using pin (when set)\n+\t */\n+\tvar passwordDPadEnabled by booleanPreference(\"pref_alt_pw_entry\", false)\n+\n+\t/**\n+\t * Sign out automatically after x milliseconds\n+\t */\n+\tvar autoSignOutTimeout by stringPreference(\"pref_auto_logoff_timeout\", \"3600000\")\n+\n+\t/* Display */\n+\t/**\n+\t * Enable background images while browsing\n+\t */\n+\tvar backdropEnabled by booleanPreference(\"pref_show_backdrop\", false)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNjgzNw=="}, "originalCommit": {"oid": "3686914935358980fb35916e0d5bc82bdfb6392f"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1106, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}