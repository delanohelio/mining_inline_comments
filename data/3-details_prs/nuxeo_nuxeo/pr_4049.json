{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5NTU0NDU3", "number": 4049, "title": "NXP-29020 implement table of contents on explorer pages", "bodyText": "T&P running at https://qa.nuxeo.org/jenkins/job/TestAndPush/job/ondemand-testandpush-atchertchian-master-2/87/", "createdAt": "2020-05-18T14:53:08Z", "url": "https://github.com/nuxeo/nuxeo/pull/4049", "merged": true, "mergeCommit": {"oid": "89c318a4acae7366fbba93f640da6b35af1965fe"}, "closed": true, "closedAt": "2020-05-20T09:33:06Z", "author": {"login": "atchertchian"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciwmWFAFqTQxNDIzODM2NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjFDgNgFqTQxNTEyMDE3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MjM4MzY0", "url": "https://github.com/nuxeo/nuxeo/pull/4049#pullrequestreview-414238364", "createdAt": "2020-05-19T08:54:31Z", "commit": {"oid": "b07f9377b07e9ba8de45fcbea33bb446dcdb74c2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1NDozMVrOGXWhGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1NjoyNlrOGXWmTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzOTM1NQ==", "bodyText": "you can now use proper variable scoping with let or const", "url": "https://github.com/nuxeo/nuxeo/pull/4049#discussion_r427139355", "createdAt": "2020-05-19T08:54:31Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/resources/script/jquery.toc.js", "diffHunk": "@@ -0,0 +1,25 @@\n+(function ($) {\n+\n+  $.fn.toc = function (tocListContainer, tocList) {\n+    $(tocList).empty();\n+\n+    var index = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b07f9377b07e9ba8de45fcbea33bb446dcdb74c2"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzOTY0MA==", "bodyText": "Use String templating for that: https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/template_strings", "url": "https://github.com/nuxeo/nuxeo/pull/4049#discussion_r427139640", "createdAt": "2020-05-19T08:54:56Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/resources/script/jquery.toc.js", "diffHunk": "@@ -0,0 +1,25 @@\n+(function ($) {\n+\n+  $.fn.toc = function (tocListContainer, tocList) {\n+    $(tocList).empty();\n+\n+    var index = 0;\n+    $(\"h2\").each(function () {\n+      var name = \"toc\" + index;\n+      var anchor = \"<a name='\" + name + \"' class='anchor'></a>\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b07f9377b07e9ba8de45fcbea33bb446dcdb74c2"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE0MDMyOA==", "bodyText": "Apparently jquery#each callback already contains index and obj ref: https://api.jquery.com/jQuery.each/#jQuery-each-object-callback", "url": "https://github.com/nuxeo/nuxeo/pull/4049#discussion_r427140328", "createdAt": "2020-05-19T08:55:55Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/resources/script/jquery.toc.js", "diffHunk": "@@ -0,0 +1,25 @@\n+(function ($) {\n+\n+  $.fn.toc = function (tocListContainer, tocList) {\n+    $(tocList).empty();\n+\n+    var index = 0;\n+    $(\"h2\").each(function () {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b07f9377b07e9ba8de45fcbea33bb446dcdb74c2"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE0MDY4NA==", "bodyText": "It looks like you miss parenthesis here.", "url": "https://github.com/nuxeo/nuxeo/pull/4049#discussion_r427140684", "createdAt": "2020-05-19T08:56:26Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/resources/script/jquery.toc.js", "diffHunk": "@@ -0,0 +1,25 @@\n+(function ($) {\n+\n+  $.fn.toc = function (tocListContainer, tocList) {\n+    $(tocList).empty();\n+\n+    var index = 0;\n+    $(\"h2\").each(function () {\n+      var name = \"toc\" + index;\n+      var anchor = \"<a name='\" + name + \"' class='anchor'></a>\";\n+      $(this).before(anchor);\n+\n+      var li = \"<li><a href='#\" + name + \"'>\" + $(this).text() + \"</a></li>\";\n+      $(tocList).append(li);\n+      index++;\n+    });\n+\n+    if (index < 2) {\n+      // only one item ==> remove TOC\n+      console.log(\"removing\");\n+      $(tocListContainer).remove;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b07f9377b07e9ba8de45fcbea33bb446dcdb74c2"}, "originalPosition": 20}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b07f9377b07e9ba8de45fcbea33bb446dcdb74c2", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b07f9377b07e9ba8de45fcbea33bb446dcdb74c2", "committedDate": "2020-05-18T14:51:00Z", "message": "NXP-29020: add ftests for table of contents"}, "afterCommit": {"oid": "6dd21f69c4b6af32683cb4e5b4b802be9e704ae9", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6dd21f69c4b6af32683cb4e5b4b802be9e704ae9", "committedDate": "2020-05-19T09:47:36Z", "message": "NXP-29020: add ftests for table of contents"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6dd21f69c4b6af32683cb4e5b4b802be9e704ae9", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6dd21f69c4b6af32683cb4e5b4b802be9e704ae9", "committedDate": "2020-05-19T09:47:36Z", "message": "NXP-29020: add ftests for table of contents"}, "afterCommit": {"oid": "7e8eb3497526ed88d0edb3ed56c1f84918689286", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/7e8eb3497526ed88d0edb3ed56c1f84918689286", "committedDate": "2020-05-19T14:58:39Z", "message": "NXP-29020: add ftests for table of contents"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f39e06d07b75ac14e82d13152c1639a490e7b3a5", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f39e06d07b75ac14e82d13152c1639a490e7b3a5", "committedDate": "2020-05-19T15:00:01Z", "message": "NXP-29020: implement javascript table of contents on all artifact pages (except services)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b2d9e505d53f715bd711ad07331535967fb04c3", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/0b2d9e505d53f715bd711ad07331535967fb04c3", "committedDate": "2020-05-19T15:00:01Z", "message": "NXP-29020: capitalize table of contents items"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bf9276f970f2ada41beb54e4fa91ceb1fb4b2ca", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9bf9276f970f2ada41beb54e4fa91ceb1fb4b2ca", "committedDate": "2020-05-19T15:00:01Z", "message": "NXP-29020: add ftests for table of contents"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "357e8bbd518c891d0cc56dc17665ab78da9014db", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/357e8bbd518c891d0cc56dc17665ab78da9014db", "committedDate": "2020-05-19T14:59:40Z", "message": "ci"}, "afterCommit": {"oid": "9bf9276f970f2ada41beb54e4fa91ceb1fb4b2ca", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9bf9276f970f2ada41beb54e4fa91ceb1fb4b2ca", "committedDate": "2020-05-19T15:00:01Z", "message": "NXP-29020: add ftests for table of contents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NTUyMDc2", "url": "https://github.com/nuxeo/nuxeo/pull/4049#pullrequestreview-414552076", "createdAt": "2020-05-19T15:14:11Z", "commit": {"oid": "9bf9276f970f2ada41beb54e4fa91ceb1fb4b2ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTIwMTc5", "url": "https://github.com/nuxeo/nuxeo/pull/4049#pullrequestreview-415120179", "createdAt": "2020-05-20T08:46:47Z", "commit": {"oid": "9bf9276f970f2ada41beb54e4fa91ceb1fb4b2ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4737, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}