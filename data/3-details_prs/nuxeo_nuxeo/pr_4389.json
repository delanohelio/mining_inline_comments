{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0MjQ2NjE0", "number": 4389, "title": "NXP-29488: Fix NPE in MimeTypeTranslationHelper", "bodyText": "Fix for Jira issue NXP-29488", "createdAt": "2020-10-15T16:57:52Z", "url": "https://github.com/nuxeo/nuxeo/pull/4389", "merged": true, "mergeCommit": {"oid": "018e81b4555402fab30f3a5eb1329f616cc5bd27"}, "closed": true, "closedAt": "2020-10-29T09:56:28Z", "author": {"login": "charlesboidot"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdS1NooAFqTUwOTYwNzI3NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdW908-gFqTUxODY3NTQ4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NjA3Mjc0", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-509607274", "createdAt": "2020-10-15T17:24:26Z", "commit": {"oid": "a3bc23e529fd32fb145f8e9bcd641d24edc4ad71"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoyNDoyNlrOHiSVYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoyNzozNFrOHiScOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcxNDAxOQ==", "bodyText": "Shouldn't it be:\n.filter(co -> destinationMimeType == null || destinationMimeType.equals(co.mimeType))", "url": "https://github.com/nuxeo/nuxeo/pull/4389#discussion_r505714019", "createdAt": "2020-10-15T17:24:26Z", "author": {"login": "ataillefer"}, "path": "modules/core/nuxeo-core-convert/src/main/java/org/nuxeo/ecm/core/convert/service/MimeTypeTranslationHelper.java", "diffHunk": "@@ -159,7 +159,8 @@ public boolean hasCompatibleMimeType(List<String> mimeTypes, String mimeType) {\n         }\n \n         return cos.stream()\n-                  .filter(co -> destinationMimeType == null || co.mimeType.equals(destinationMimeType))\n+                  .filter(co -> (co.mimeType != null)\n+                          && (destinationMimeType == null || co.mimeType.equals(destinationMimeType)))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3bc23e529fd32fb145f8e9bcd641d24edc4ad71"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcxNTc3MQ==", "bodyText": "I'm wondering if this is necessary since testGetConverterNames() is already testing this exact code.\nSimply adding the contribution below without the fix should make this test fail.", "url": "https://github.com/nuxeo/nuxeo/pull/4389#discussion_r505715771", "createdAt": "2020-10-15T17:27:34Z", "author": {"login": "ataillefer"}, "path": "modules/core/nuxeo-core-convert/src/test/java/org/nuxeo/ecm/core/convert/service/TestMimeTypeTranslationHelper.java", "diffHunk": "@@ -97,4 +97,13 @@ public void testHasCompatibleMimeType() {\n         assertTrue(mimeTypeTranslationHelper.hasCompatibleMimeType(mimeTypes, \"text/html\"));\n         assertTrue(mimeTypeTranslationHelper.hasCompatibleMimeType(mimeTypes, \"application/pdf\"));\n     }\n+\n+    @Test\n+    public void testGetConverterNamesWhenCOMimeTypeIsNull() {\n+        //No NPE thrown\n+        List<String> converterNames = mimeTypeTranslationHelper.getConverterNames(\"application/pdf\", \"text/plain\");\n+        assertEquals(2, converterNames.size());\n+        assertTrue(converterNames.contains(\"toText1\"));\n+        assertTrue(converterNames.contains(\"toText2\"));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3bc23e529fd32fb145f8e9bcd641d24edc4ad71"}, "originalPosition": 12}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a3bc23e529fd32fb145f8e9bcd641d24edc4ad71", "author": {"user": {"login": "charlesboidot", "name": "Charles Boidot"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a3bc23e529fd32fb145f8e9bcd641d24edc4ad71", "committedDate": "2020-10-15T16:45:14Z", "message": "NXP-29488: Fix NPE in MimeTypeTranslationHelper"}, "afterCommit": {"oid": "cdba800b6d76336e1a8116b307267245f97b82e8", "author": {"user": {"login": "charlesboidot", "name": "Charles Boidot"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cdba800b6d76336e1a8116b307267245f97b82e8", "committedDate": "2020-10-15T20:32:55Z", "message": "NXP-29488: Fix NPE in MimeTypeTranslationHelper"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjg5OTEz", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-510289913", "createdAt": "2020-10-16T09:09:44Z", "commit": {"oid": "cdba800b6d76336e1a8116b307267245f97b82e8"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMzg2MDc4", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-510386078", "createdAt": "2020-10-16T11:32:13Z", "commit": {"oid": "cdba800b6d76336e1a8116b307267245f97b82e8"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNDM2NzA2", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-510436706", "createdAt": "2020-10-16T12:50:00Z", "commit": {"oid": "cdba800b6d76336e1a8116b307267245f97b82e8"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cdba800b6d76336e1a8116b307267245f97b82e8", "author": {"user": {"login": "charlesboidot", "name": "Charles Boidot"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cdba800b6d76336e1a8116b307267245f97b82e8", "committedDate": "2020-10-15T20:32:55Z", "message": "NXP-29488: Fix NPE in MimeTypeTranslationHelper"}, "afterCommit": {"oid": "23437d8be1e6b3f73f83323f10b99d9b71501bf3", "author": {"user": {"login": "charlesboidot", "name": "Charles Boidot"}}, "url": "https://github.com/nuxeo/nuxeo/commit/23437d8be1e6b3f73f83323f10b99d9b71501bf3", "committedDate": "2020-10-26T13:51:35Z", "message": "NXP-29488: Fix NPE in MimeTypeTranslationHelper"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2Nzk5Njk4", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-516799698", "createdAt": "2020-10-26T13:55:02Z", "commit": {"oid": "23437d8be1e6b3f73f83323f10b99d9b71501bf3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2ODAwODUz", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-516800853", "createdAt": "2020-10-26T13:56:15Z", "commit": {"oid": "23437d8be1e6b3f73f83323f10b99d9b71501bf3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2OTU4NTk0", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-516958594", "createdAt": "2020-10-26T16:29:32Z", "commit": {"oid": "23437d8be1e6b3f73f83323f10b99d9b71501bf3"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5804fd88d04c4b3113a2ada751db2f885975191", "author": {"user": {"login": "charlesboidot", "name": "Charles Boidot"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d5804fd88d04c4b3113a2ada751db2f885975191", "committedDate": "2020-10-28T09:27:07Z", "message": "NXP-29488: Fix NPE in MimeTypeTranslationHelper"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "23437d8be1e6b3f73f83323f10b99d9b71501bf3", "author": {"user": {"login": "charlesboidot", "name": "Charles Boidot"}}, "url": "https://github.com/nuxeo/nuxeo/commit/23437d8be1e6b3f73f83323f10b99d9b71501bf3", "committedDate": "2020-10-26T13:51:35Z", "message": "NXP-29488: Fix NPE in MimeTypeTranslationHelper"}, "afterCommit": {"oid": "d5804fd88d04c4b3113a2ada751db2f885975191", "author": {"user": {"login": "charlesboidot", "name": "Charles Boidot"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d5804fd88d04c4b3113a2ada751db2f885975191", "committedDate": "2020-10-28T09:27:07Z", "message": "NXP-29488: Fix NPE in MimeTypeTranslationHelper"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NDcxMjIw", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-518471220", "createdAt": "2020-10-28T09:33:24Z", "commit": {"oid": "d5804fd88d04c4b3113a2ada751db2f885975191"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4NDk5ODE0", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-518499814", "createdAt": "2020-10-28T10:06:03Z", "commit": {"oid": "d5804fd88d04c4b3113a2ada751db2f885975191"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4Njc1NDg2", "url": "https://github.com/nuxeo/nuxeo/pull/4389#pullrequestreview-518675486", "createdAt": "2020-10-28T13:45:37Z", "commit": {"oid": "d5804fd88d04c4b3113a2ada751db2f885975191"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4939, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}