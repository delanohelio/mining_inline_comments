{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxMTYyODIy", "number": 3902, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNDoyODo1MVrODwbf5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNDoyODo1MVrODwbf5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMTA4Nzc1OnYy", "diffSide": "RIGHT", "path": "nuxeo-features/nuxeo-elasticsearch/nuxeo-elasticsearch-audit/src/test/java/org/nuxeo/elasticsearch/TestESHistoryProvider.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQxNDoyODo1MVrOGDbRKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQyMzo1MDoxNFrOGDtAUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI0NTY3Mw==", "bodyText": "This comment and the one above has the correct space after // on master.", "url": "https://github.com/nuxeo/nuxeo/pull/3902#discussion_r406245673", "createdAt": "2020-04-09T14:28:51Z", "author": {"login": "efge"}, "path": "nuxeo-features/nuxeo-elasticsearch/nuxeo-elasticsearch-audit/src/test/java/org/nuxeo/elasticsearch/TestESHistoryProvider.java", "diffHunk": "@@ -429,6 +435,29 @@ public void testCustomDocumentHistoryPageProvider() {\n         assertEquals(5, entries.size());\n     }\n \n+    @Test\n+    public void testCustomFixedPartDocumentHistoryPageProvider() {\n+        assertNotNull(pageProviderService.getPageProviderDefinition(\"FIXED_PART_DOCUMENT_HISTORY_PROVIDER\"));\n+        DocumentModel searchDoc = session.createDocumentModel(\"BasicAuditSearch\");\n+        searchDoc.setPathInfo(\"/\", \"auditsearch\");\n+        searchDoc = session.createDocument(searchDoc);\n+\n+        searchDoc.setPropertyValue(\"basicauditsearch:eventIds\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:eventCategories\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:startDate\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:endDate\", null);\n+\n+        //test with doc\n+        PageProvider<LogEntry> pageProvider = getPageProvider(\"FIXED_PART_DOCUMENT_HISTORY_PROVIDER\", 30, 0, doc);\n+        pageProvider.setSearchDocumentModel(searchDoc);\n+        assertEquals(1, pageProvider.getCurrentPage().size());\n+\n+        //test with proxy to check that the doc uuid is correctly set in the fixed part", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d1b26366593989acd892099661e2fb0f559c9ef"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUzNjI3NA==", "bodyText": "Thanks for catching it.", "url": "https://github.com/nuxeo/nuxeo/pull/3902#discussion_r406536274", "createdAt": "2020-04-09T23:50:14Z", "author": {"login": "michaelva"}, "path": "nuxeo-features/nuxeo-elasticsearch/nuxeo-elasticsearch-audit/src/test/java/org/nuxeo/elasticsearch/TestESHistoryProvider.java", "diffHunk": "@@ -429,6 +435,29 @@ public void testCustomDocumentHistoryPageProvider() {\n         assertEquals(5, entries.size());\n     }\n \n+    @Test\n+    public void testCustomFixedPartDocumentHistoryPageProvider() {\n+        assertNotNull(pageProviderService.getPageProviderDefinition(\"FIXED_PART_DOCUMENT_HISTORY_PROVIDER\"));\n+        DocumentModel searchDoc = session.createDocumentModel(\"BasicAuditSearch\");\n+        searchDoc.setPathInfo(\"/\", \"auditsearch\");\n+        searchDoc = session.createDocument(searchDoc);\n+\n+        searchDoc.setPropertyValue(\"basicauditsearch:eventIds\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:eventCategories\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:startDate\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:endDate\", null);\n+\n+        //test with doc\n+        PageProvider<LogEntry> pageProvider = getPageProvider(\"FIXED_PART_DOCUMENT_HISTORY_PROVIDER\", 30, 0, doc);\n+        pageProvider.setSearchDocumentModel(searchDoc);\n+        assertEquals(1, pageProvider.getCurrentPage().size());\n+\n+        //test with proxy to check that the doc uuid is correctly set in the fixed part", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI0NTY3Mw=="}, "originalCommit": {"oid": "2d1b26366593989acd892099661e2fb0f559c9ef"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4201, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}