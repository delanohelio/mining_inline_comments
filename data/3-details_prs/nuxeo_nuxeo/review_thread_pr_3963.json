{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3ODE5MjA5", "number": 3963, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjozNToyN1rOD1XhWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoxNToyN1rOD1y9ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3Mjg2NDg4OnYy", "diffSide": "RIGHT", "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/RetentionTestCase.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNjozNToyN1rOGKxeRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwODoxMjowN1rOGLL6ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk0OTUwOQ==", "bodyText": "small typo: matadataXPath", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r413949509", "createdAt": "2020-04-23T16:35:27Z", "author": {"login": "nmpcunha"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/RetentionTestCase.java", "diffHunk": "@@ -108,7 +110,7 @@ protected void awaitRetentionExpiration(long millis) throws InterruptedException\n \n     protected RetentionRule createRuleWithActions(RetentionRule.ApplicationPolicy policy,\n             StartingPointPolicy startingPointPolicy, List<String> docTypes, String startingPointEventId,\n-            String startingPointExpression, String matadataXPath, long years, long months, long days,\n+            String startingPointExpressionLanguage, String startingPointEventInput, String matadataXPath, long years, long months, long days,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8df0865d9f626a1cfab18464910933d323202ed7"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM4MjczMA==", "bodyText": "thanks, I will do it on master with a separate commit cleanup/format", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414382730", "createdAt": "2020-04-24T08:12:07Z", "author": {"login": "RSalem07"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/RetentionTestCase.java", "diffHunk": "@@ -108,7 +110,7 @@ protected void awaitRetentionExpiration(long millis) throws InterruptedException\n \n     protected RetentionRule createRuleWithActions(RetentionRule.ApplicationPolicy policy,\n             StartingPointPolicy startingPointPolicy, List<String> docTypes, String startingPointEventId,\n-            String startingPointExpression, String matadataXPath, long years, long months, long days,\n+            String startingPointExpressionLanguage, String startingPointEventInput, String matadataXPath, long years, long months, long days,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk0OTUwOQ=="}, "originalCommit": {"oid": "8df0865d9f626a1cfab18464910933d323202ed7"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NDczMDcyOnYy", "diffSide": "RIGHT", "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/schemas/retention_definition.xsd", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwMToxOTozOFrOGLCaZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwODowMjowOVrOGLLjyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDIyNzA0NQ==", "bodyText": "This seems unnecessarily verbose to me. I would suggest just startingPointExpression and startingPointValue instead (same with related various constants, parameters and variables).", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414227045", "createdAt": "2020-04-24T01:19:38Z", "author": {"login": "efge"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/schemas/retention_definition.xsd", "diffHunk": "@@ -31,7 +31,8 @@\n       <xs:restriction base=\"xs:string\" ref:resolver=\"directoryResolver\" ref:directory=\"RetentionEvent\" />\n     </xs:simpleType>\n   </xs:element>\n-  <xs:element name=\"startingPointExpression\" type=\"xs:string\" />\n+  <xs:element name=\"startingPointExpressionLanguage\" type=\"xs:string\" />\n+  <xs:element name=\"startingPointEventInput\" type=\"xs:string\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8df0865d9f626a1cfab18464910933d323202ed7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM3NjkwNQ==", "bodyText": "Yep, it was my first idea and after that I changed it. but let rename them :)", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414376905", "createdAt": "2020-04-24T08:02:09Z", "author": {"login": "RSalem07"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/schemas/retention_definition.xsd", "diffHunk": "@@ -31,7 +31,8 @@\n       <xs:restriction base=\"xs:string\" ref:resolver=\"directoryResolver\" ref:directory=\"RetentionEvent\" />\n     </xs:simpleType>\n   </xs:element>\n-  <xs:element name=\"startingPointExpression\" type=\"xs:string\" />\n+  <xs:element name=\"startingPointExpressionLanguage\" type=\"xs:string\" />\n+  <xs:element name=\"startingPointEventInput\" type=\"xs:string\" />", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDIyNzA0NQ=="}, "originalCommit": {"oid": "8df0865d9f626a1cfab18464910933d323202ed7"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjQ2NzA2OnYy", "diffSide": "RIGHT", "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/RetentionTestCase.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMDo0MToyOVrOGLRq0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMDo0MToyOVrOGLRq0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ3NzAxMA==", "bodyText": "CoreBulkFeature is declared by CoreFeature, you should already have it in the test (no needs to depend on it).", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414477010", "createdAt": "2020-04-24T10:41:29Z", "author": {"login": "kevinleturc"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/RetentionTestCase.java", "diffHunk": "@@ -50,7 +51,7 @@\n  * @since 11.1\n  */\n @RunWith(FeaturesRunner.class)\n-@Features({ TransactionalFeature.class, AutomationFeature.class })\n+@Features({ TransactionalFeature.class, AutomationFeature.class, CoreBulkFeature.class })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89e111efa1fa273c7ae2284c02c5abbfcbb663eb"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NjUyOTQ5OnYy", "diffSide": "LEFT", "path": "addons/nuxeo-retention/nuxeo-retention-web-ui/src/main/resources/web/nuxeo.war/ui/document/retentionrule/nuxeo-retentionrule-view-layout.html", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMDo1ODoyOFrOGLSPJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxMTowMzoxMlrOGLSY5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ4NjMwOA==", "bodyText": "Does this pass linting? If yes, it is ok for me!", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414486308", "createdAt": "2020-04-24T10:58:28Z", "author": {"login": "nmpcunha"}, "path": "addons/nuxeo-retention/nuxeo-retention-web-ui/src/main/resources/web/nuxeo.war/ui/document/retentionrule/nuxeo-retentionrule-view-layout.html", "diffHunk": "@@ -69,7 +69,7 @@\n         <div role=\"widget\">\n           <label>[[i18n(\"retention.rule.label.startPolicy.eventBased.expression.placeholder\")]]</label>\n           <nuxeo-tag name=\"eventInput\">\n-            [[document.properties.retention_def:startingPointExpression]]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3852c471f061cb82447b4496aa144b754bf44890"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ4ODgwNQ==", "bodyText": "I think yes, I compared it to the others ones, it looks the same formatting :)", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414488805", "createdAt": "2020-04-24T11:03:12Z", "author": {"login": "RSalem07"}, "path": "addons/nuxeo-retention/nuxeo-retention-web-ui/src/main/resources/web/nuxeo.war/ui/document/retentionrule/nuxeo-retentionrule-view-layout.html", "diffHunk": "@@ -69,7 +69,7 @@\n         <div role=\"widget\">\n           <label>[[i18n(\"retention.rule.label.startPolicy.eventBased.expression.placeholder\")]]</label>\n           <nuxeo-tag name=\"eventInput\">\n-            [[document.properties.retention_def:startingPointExpression]]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ4NjMwOA=="}, "originalCommit": {"oid": "3852c471f061cb82447b4496aa144b754bf44890"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NzM1MjcwOnYy", "diffSide": "RIGHT", "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/RetentionTestCase.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoxMzo0M1rOGLZs8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoxMzo0M1rOGLZs8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYwODYyNg==", "bodyText": "missing space after ,", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414608626", "createdAt": "2020-04-24T14:13:43Z", "author": {"login": "efge"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/RetentionTestCase.java", "diffHunk": "@@ -131,23 +134,30 @@ protected RetentionRule createRuleWithActions(RetentionRule.ApplicationPolicy po\n     protected RetentionRule createImmediateRuleMillis(RetentionRule.ApplicationPolicy policy, long durationMillis,\n             List<String> beginActions, List<String> endActions) {\n         return createRuleWithActions(policy, RetentionRule.StartingPointPolicy.IMMEDIATE, Arrays.asList(\"File\"), null,\n-                null, null, 0L, 0L, 0L, durationMillis, beginActions, endActions);\n+                null, null,null, 0L, 0L, 0L, durationMillis, beginActions, endActions);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3852c471f061cb82447b4496aa144b754bf44890"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NzM1NDIzOnYy", "diffSide": "RIGHT", "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/TestRetentionManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoxMzo1N1rOGLZt1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoxMzo1N1rOGLZt1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYwODg1Mw==", "bodyText": "missing space after , (and 2 others below)", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414608853", "createdAt": "2020-04-24T14:13:57Z", "author": {"login": "efge"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/test/java/org/nuxeo/retention/test/TestRetentionManager.java", "diffHunk": "@@ -61,19 +68,19 @@ public void testRuleOnlyFile() {\n     @Test\n     public void test1DayManualImmediateRuleRunningRetention() throws InterruptedException {\n         assertStillUnderRetentionAfter(file, createRuleWithActions(RetentionRule.ApplicationPolicy.MANUAL,\n-                RetentionRule.StartingPointPolicy.IMMEDIATE, null, null, null, null, 0, 0, 1, 0, null, null), 1000);\n+                RetentionRule.StartingPointPolicy.IMMEDIATE, null, null, null, null,null, 0, 0, 1, 0, null, null), 1000);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3852c471f061cb82447b4496aa144b754bf44890"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3NzM2MDc0OnYy", "diffSide": "RIGHT", "path": "addons/nuxeo-retention/nuxeo-retention-web-ui/src/main/resources/web/nuxeo.war/ui/document/retentionrule/nuxeo-retentionrule-create-layout.html", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoxNToyN1rOGLZxtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNDoxNToyN1rOGLZxtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDYwOTg0Ng==", "bodyText": "Maybe change the i18n label too? Not sure.", "url": "https://github.com/nuxeo/nuxeo/pull/3963#discussion_r414609846", "createdAt": "2020-04-24T14:15:27Z", "author": {"login": "efge"}, "path": "addons/nuxeo-retention/nuxeo-retention-web-ui/src/main/resources/web/nuxeo.war/ui/document/retentionrule/nuxeo-retentionrule-create-layout.html", "diffHunk": "@@ -116,11 +116,11 @@\n              min-chars=\"0\">\n            </nuxeo-directory-suggestion>\n            <nuxeo-input role=\"widget\" name=\"eventInput\"\n-                        label=\"[[i18n('retention.rule.label.startPolicy.eventBased.expression.description')]]\"\n-                        placeholder=\"[[i18n('retention.rule.label.startPolicy.eventBased.expression.placeholder')]]\"\n-                        name=\"startingPointExpression\"\n+                        label=\"[[i18n('retention.rule.label.startPolicy.eventBased.input.description')]]\"\n+                        placeholder=\"[[i18n('retention.rule.label.startPolicy.eventBased.input.placeholder')]]\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3852c471f061cb82447b4496aa144b754bf44890"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4173, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}