{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5NTI2NDA4", "number": 4184, "title": "fix-NXP-29291-transient-store-ttl", "bodyText": "PR created from https://qa.nuxeo.org/jenkins/job/TestAndPush/job/ondemand-testandpush-nsilva/150/", "createdAt": "2020-06-24T21:22:29Z", "url": "https://github.com/nuxeo/nuxeo/pull/4184", "merged": true, "mergeCommit": {"oid": "1fca36703762f0438f51e10c5372806b2fabc652"}, "closed": true, "closedAt": "2020-06-25T10:13:07Z", "author": {"login": "nuxeojenkins"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuhVusAFqTQzNzAzNTM1Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcur0UqAFqTQzNzM1MzE4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MDM1MzUy", "url": "https://github.com/nuxeo/nuxeo/pull/4184#pullrequestreview-437035352", "createdAt": "2020-06-24T21:57:12Z", "commit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MDQyODUy", "url": "https://github.com/nuxeo/nuxeo/pull/4184#pullrequestreview-437042852", "createdAt": "2020-06-24T22:13:20Z", "commit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMjoxMzoyMVrOGok6Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMjoxMzoyMVrOGok6Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTIwMDk2Mw==", "bodyText": "I would prefer nuxeo.transientstore.ttl as a property name (we already have another one related to transient stores, nuxeo.transientstore.provider).\nAnd therefore it would make sense for S3 to have nuxeo.s3storage.transientstore.ttl for example", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445200963", "createdAt": "2020-06-24T22:13:21Z", "author": {"login": "efge"}, "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/nuxeo.defaults", "diffHunk": "@@ -56,3 +56,5 @@ nuxeo.cache.concurrencylevel=500\n \n # boolean to switch back to former hot reload mechanism\n nuxeo.hotreload.compat.mechanism=false\n+\n+nuxeo.storage.transient.ttl=4320", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MzAwMDQz", "url": "https://github.com/nuxeo/nuxeo/pull/4184#pullrequestreview-437300043", "createdAt": "2020-06-25T08:58:01Z", "commit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwODo1ODowMVrOGoxssg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwODo1ODowMVrOGoxssg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQxMDQ4Mg==", "bodyText": "Wondering why not have a default value for the 2 properties in nuxeo.defaults?\nAlso, \"second\" is confusing, makes think of the time unit whereas it's minutes.\nIf we follow Florent's recommendations, something like:\nnuxeo.transientstore.ttl\nnuxeo.transientstore.second.level.ttl", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445410482", "createdAt": "2020-06-25T08:58:01Z", "author": {"login": "ataillefer"}, "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/config/transient-store-config.xml", "diffHunk": "@@ -7,8 +7,8 @@\n     <store name=\"default\" class=\"org.nuxeo.ecm.core.transientstore.keyvalueblob.KeyValueBlobTransientStore\">\n       <targetMaxSizeMB>-1</targetMaxSizeMB>\n       <absoluteMaxSizeMB>-1</absoluteMaxSizeMB>\n-      <firstLevelTTL>240</firstLevelTTL>\n-      <secondLevelTTL>10</secondLevelTTL>\n+      <firstLevelTTL>${nuxeo.storage.transient.ttl}</firstLevelTTL>\n+      <secondLevelTTL>${nuxeo.storage.transient.second.ttl:=10}</secondLevelTTL>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/aa755dd904e9b3a7d8fe760ad46683d9fd394aef", "committedDate": "2020-06-24T15:51:39Z", "message": "NXP-29291: allow configuring transient store ttl"}, "afterCommit": {"oid": "813506cc7cf79e4fe277d3867936e88487fd8c61", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/813506cc7cf79e4fe277d3867936e88487fd8c61", "committedDate": "2020-06-25T09:08:42Z", "message": "NXP-29291: allow configuring transient store ttl"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MzE0NjUw", "url": "https://github.com/nuxeo/nuxeo/pull/4184#pullrequestreview-437314650", "createdAt": "2020-06-25T09:17:12Z", "commit": {"oid": "813506cc7cf79e4fe277d3867936e88487fd8c61"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwOToxNzoxM1rOGoyYDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwOToxNzoxM1rOGoyYDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQyMTU4Mw==", "bodyText": "What does the ${r\"\"} for?\nAlso, defaults should be there or in nuxeo.defaults, not both imho.", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445421583", "createdAt": "2020-06-25T09:17:13Z", "author": {"login": "kevinleturc"}, "path": "packages/nuxeo-amazon-s3-package/src/main/resources/install/templates/s3binaries/nxserver/config/s3directupload-config.xml.nxftl", "diffHunk": "@@ -10,8 +10,8 @@\n       <property name=\"keyValueStore\">s3DirectUploadKeyValueStore</property> <!-- not defined there, fallback on default -->\n       <targetMaxSizeMB>${nuxeo.s3storage.transient.targetMaxSizeMB}</targetMaxSizeMB>\n       <absoluteMaxSizeMB>-1</absoluteMaxSizeMB>\n-      <firstLevelTTL>120</firstLevelTTL>\n-      <secondLevelTTL>10</secondLevelTTL>\n+      <firstLevelTTL>${nuxeo.s3storage.transientstore.ttl}</firstLevelTTL>\n+      <secondLevelTTL>${r\"${nuxeo.s3storage.transientstore.ttl2:=10}\"}</secondLevelTTL>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "813506cc7cf79e4fe277d3867936e88487fd8c61"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "813506cc7cf79e4fe277d3867936e88487fd8c61", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/813506cc7cf79e4fe277d3867936e88487fd8c61", "committedDate": "2020-06-25T09:08:42Z", "message": "NXP-29291: allow configuring transient store ttl"}, "afterCommit": {"oid": "5666034a5adc3e06621763ee41e9099ba6d53c35", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5666034a5adc3e06621763ee41e9099ba6d53c35", "committedDate": "2020-06-25T09:22:45Z", "message": "NXP-29291: allow configuring transient store ttl"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MzIwMTQz", "url": "https://github.com/nuxeo/nuxeo/pull/4184#pullrequestreview-437320143", "createdAt": "2020-06-25T09:24:33Z", "commit": {"oid": "5666034a5adc3e06621763ee41e9099ba6d53c35"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MzIwNjI1", "url": "https://github.com/nuxeo/nuxeo/pull/4184#pullrequestreview-437320625", "createdAt": "2020-06-25T09:25:08Z", "commit": {"oid": "5666034a5adc3e06621763ee41e9099ba6d53c35"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "124cd19735e591f4bc65adc0e54e36537c507fe2", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/124cd19735e591f4bc65adc0e54e36537c507fe2", "committedDate": "2020-06-25T10:04:23Z", "message": "NXP-29291: allow configuring transient store ttl"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5666034a5adc3e06621763ee41e9099ba6d53c35", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5666034a5adc3e06621763ee41e9099ba6d53c35", "committedDate": "2020-06-25T09:22:45Z", "message": "NXP-29291: allow configuring transient store ttl"}, "afterCommit": {"oid": "124cd19735e591f4bc65adc0e54e36537c507fe2", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/124cd19735e591f4bc65adc0e54e36537c507fe2", "committedDate": "2020-06-25T10:04:23Z", "message": "NXP-29291: allow configuring transient store ttl"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MzUzMTgx", "url": "https://github.com/nuxeo/nuxeo/pull/4184#pullrequestreview-437353181", "createdAt": "2020-06-25T10:09:40Z", "commit": {"oid": "124cd19735e591f4bc65adc0e54e36537c507fe2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4719, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}