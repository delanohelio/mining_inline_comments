{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3NzE3NTg0", "number": 4110, "title": "NXP-29192: Better SIG handling for docker run", "bodyText": "", "createdAt": "2020-06-04T09:46:52Z", "url": "https://github.com/nuxeo/nuxeo/pull/4110", "merged": true, "mergeCommit": {"oid": "ed5dbc6753c9de3fc4b6eae07ecf6fc67005221b"}, "closed": true, "closedAt": "2020-06-09T09:13:35Z", "author": {"login": "kevinleturc"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcn96MXABqjM0MDY3OTk2MTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpPfRxgFqTQyNjE2OTczNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bfa5e763c14dbdc4d820f980f0004dd288516970", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/bfa5e763c14dbdc4d820f980f0004dd288516970", "committedDate": "2020-06-04T09:43:54Z", "message": "NXP-29192: Better SIG handling for docker run"}, "afterCommit": {"oid": "65a8f5823e1441288df8f8493a59e4487ec37b42", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/65a8f5823e1441288df8f8493a59e4487ec37b42", "committedDate": "2020-06-04T13:16:45Z", "message": "NXP-29192: Better SIG handling for docker run"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NDY1MTk0", "url": "https://github.com/nuxeo/nuxeo/pull/4110#pullrequestreview-424465194", "createdAt": "2020-06-04T13:46:09Z", "commit": {"oid": "65a8f5823e1441288df8f8493a59e4487ec37b42"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NTEyNzQ2", "url": "https://github.com/nuxeo/nuxeo/pull/4110#pullrequestreview-424512746", "createdAt": "2020-06-04T14:32:42Z", "commit": {"oid": "65a8f5823e1441288df8f8493a59e4487ec37b42"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NjAwNzY4", "url": "https://github.com/nuxeo/nuxeo/pull/4110#pullrequestreview-424600768", "createdAt": "2020-06-04T15:59:50Z", "commit": {"oid": "65a8f5823e1441288df8f8493a59e4487ec37b42"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTo1OTo1MFrOGfM_RA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjowMTowNVrOGfNCeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM3MTg0NA==", "bodyText": "I would say\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              # any signal send to a bash script is not propagated to child process by design\n          \n          \n            \n              # any signal sent to a bash script is not propagated to child processes by design", "url": "https://github.com/nuxeo/nuxeo/pull/4110#discussion_r435371844", "createdAt": "2020-06-04T15:59:50Z", "author": {"login": "NourNuxeo"}, "path": "server/nuxeo-server-tomcat/src/main/resources/tomcat/bin/nuxeoctl", "diffHunk": "@@ -233,7 +233,15 @@ while true; do\n   done\n   cp \"$NUXEO_LAUNCHER\" \"$TMPLAUNCHER\"\n   echo [`date`] \"Launcher command: $JAVA  \\\"-Xbootclasspath/a:$JAVA_TOOLS\\\" $MODULE_OPTS $LAUNCHER_DEBUG \\\"-Dlauncher.java.opts=$JAVA_OPTS\\\" \\\"-Dnuxeo.home=$NUXEO_HOME\\\" \\\"-Dnuxeo.conf=$NUXEO_CONF\\\" \\\"-Dnuxeo.log.dir=$LOG_DIR\\\" -jar \\\"$TMPLAUNCHER\\\" $@\" >> \"$LOG_DIR\"/nuxeoctl.log\n-  \"$JAVA\" \"-Xbootclasspath/a:$JAVA_TOOLS\" $MODULE_OPTS $LAUNCHER_DEBUG \"-Dlauncher.java.opts=$JAVA_OPTS\" \"-Dnuxeo.home=$NUXEO_HOME\" \"-Dnuxeo.conf=$NUXEO_CONF\" \"-Dnuxeo.log.dir=$LOG_DIR\" -jar \"$TMPLAUNCHER\" \"$@\"\n+  # any signal send to a bash script is not propagated to child process by design", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65a8f5823e1441288df8f8493a59e4487ec37b42"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM3MjY2NA==", "bodyText": "then I would\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              # thus we need to use trap/wait to forward signal to java process\n          \n          \n            \n              # thus we need to use trap/wait to forward signal to (other?) java (sub?)processes", "url": "https://github.com/nuxeo/nuxeo/pull/4110#discussion_r435372664", "createdAt": "2020-06-04T16:01:05Z", "author": {"login": "NourNuxeo"}, "path": "server/nuxeo-server-tomcat/src/main/resources/tomcat/bin/nuxeoctl", "diffHunk": "@@ -233,7 +233,15 @@ while true; do\n   done\n   cp \"$NUXEO_LAUNCHER\" \"$TMPLAUNCHER\"\n   echo [`date`] \"Launcher command: $JAVA  \\\"-Xbootclasspath/a:$JAVA_TOOLS\\\" $MODULE_OPTS $LAUNCHER_DEBUG \\\"-Dlauncher.java.opts=$JAVA_OPTS\\\" \\\"-Dnuxeo.home=$NUXEO_HOME\\\" \\\"-Dnuxeo.conf=$NUXEO_CONF\\\" \\\"-Dnuxeo.log.dir=$LOG_DIR\\\" -jar \\\"$TMPLAUNCHER\\\" $@\" >> \"$LOG_DIR\"/nuxeoctl.log\n-  \"$JAVA\" \"-Xbootclasspath/a:$JAVA_TOOLS\" $MODULE_OPTS $LAUNCHER_DEBUG \"-Dlauncher.java.opts=$JAVA_OPTS\" \"-Dnuxeo.home=$NUXEO_HOME\" \"-Dnuxeo.conf=$NUXEO_CONF\" \"-Dnuxeo.log.dir=$LOG_DIR\" -jar \"$TMPLAUNCHER\" \"$@\"\n+  # any signal send to a bash script is not propagated to child process by design\n+  # this is an issue in Docker because nuxeoctl is PID 1 and responsible to kill its child processes\n+  # thus we need to use trap/wait to forward signal to java process", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65a8f5823e1441288df8f8493a59e4487ec37b42"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "65a8f5823e1441288df8f8493a59e4487ec37b42", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/65a8f5823e1441288df8f8493a59e4487ec37b42", "committedDate": "2020-06-04T13:16:45Z", "message": "NXP-29192: Better SIG handling for docker run"}, "afterCommit": {"oid": "8a978cd635d7cad9b77cfea6621b972150f551c7", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8a978cd635d7cad9b77cfea6621b972150f551c7", "committedDate": "2020-06-08T08:32:43Z", "message": "NXP-29192: Better SIG handling for docker run"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MDE3ODEz", "url": "https://github.com/nuxeo/nuxeo/pull/4110#pullrequestreview-426017813", "createdAt": "2020-06-08T08:34:32Z", "commit": {"oid": "8a978cd635d7cad9b77cfea6621b972150f551c7"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "254ae1704f39c9b02493806e7459a1170f0236c4", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/254ae1704f39c9b02493806e7459a1170f0236c4", "committedDate": "2020-06-08T08:35:13Z", "message": "NXP-29192: Better SIG handling for docker run"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8a978cd635d7cad9b77cfea6621b972150f551c7", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8a978cd635d7cad9b77cfea6621b972150f551c7", "committedDate": "2020-06-08T08:32:43Z", "message": "NXP-29192: Better SIG handling for docker run"}, "afterCommit": {"oid": "254ae1704f39c9b02493806e7459a1170f0236c4", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/254ae1704f39c9b02493806e7459a1170f0236c4", "committedDate": "2020-06-08T08:35:13Z", "message": "NXP-29192: Better SIG handling for docker run"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MDIxODA5", "url": "https://github.com/nuxeo/nuxeo/pull/4110#pullrequestreview-426021809", "createdAt": "2020-06-08T08:40:10Z", "commit": {"oid": "254ae1704f39c9b02493806e7459a1170f0236c4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MTY5NzM2", "url": "https://github.com/nuxeo/nuxeo/pull/4110#pullrequestreview-426169736", "createdAt": "2020-06-08T12:19:43Z", "commit": {"oid": "254ae1704f39c9b02493806e7459a1170f0236c4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4698, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}