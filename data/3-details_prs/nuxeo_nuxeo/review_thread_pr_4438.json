{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1NDQ1MTU3", "number": 4438, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxNzozMVrOE1kMvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDozNTo1MVrOE2y2FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NjAzMDY5OnYy", "diffSide": "RIGHT", "path": "docker/install-packages.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxNzozMVrOHt6Gkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMzoyNDozM1rOHuDE1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5OTkyMg==", "bodyText": "Would it make sense to separate this change (\">\" into \">>\"), which is not directly related to the merge of both scripts, and fixes the bug that empties the nuxeo.conf file when using the connect URL parameter?", "url": "https://github.com/nuxeo/nuxeo/pull/4438#discussion_r517899922", "createdAt": "2020-11-05T09:17:31Z", "author": {"login": "atchertchian"}, "path": "docker/install-packages.sh", "diffHunk": "@@ -39,11 +43,19 @@ fi\n \n if [ -n \"$connect_url\" ]; then\n   echo \"Setting Connect URL: $connect_url\"\n-  printf \"org.nuxeo.connect.url=%b\\n\" \"$connect_url\" > $NUXEO_HOME/bin/nuxeo.conf\n+  printf \"org.nuxeo.connect.url=%b\\n\" \"$connect_url\" >> $NUXEO_HOME/bin/nuxeo.conf", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e978909d0776e93934a3d9dae2ab1e8905b85851"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA0NjkzMw==", "bodyText": "Could be a separate commit yes.", "url": "https://github.com/nuxeo/nuxeo/pull/4438#discussion_r518046933", "createdAt": "2020-11-05T13:24:33Z", "author": {"login": "troger"}, "path": "docker/install-packages.sh", "diffHunk": "@@ -39,11 +43,19 @@ fi\n \n if [ -n \"$connect_url\" ]; then\n   echo \"Setting Connect URL: $connect_url\"\n-  printf \"org.nuxeo.connect.url=%b\\n\" \"$connect_url\" > $NUXEO_HOME/bin/nuxeo.conf\n+  printf \"org.nuxeo.connect.url=%b\\n\" \"$connect_url\" >> $NUXEO_HOME/bin/nuxeo.conf", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5OTkyMg=="}, "originalCommit": {"oid": "e978909d0776e93934a3d9dae2ab1e8905b85851"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1ODgzMTEyOnYy", "diffSide": "RIGHT", "path": "docker/install-packages.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDoxNzoyMlrOHvw4KA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDoxNzoyMlrOHvw4KA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0NTkyOA==", "bodyText": "mpInstallArgs?", "url": "https://github.com/nuxeo/nuxeo/pull/4438#discussion_r519845928", "createdAt": "2020-11-09T14:17:22Z", "author": {"login": "ataillefer"}, "path": "docker/install-packages.sh", "diffHunk": "@@ -18,10 +18,14 @@ if [[ -f $NUXEO_HOME/configured ]]; then\n   exit 2\n fi\n \n+# default arguments for mp-install command\n+mp_install_args=\"--accept yes --relax no\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f44008039f789e05c4c9d2945f49083259c93869"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1ODkxNjA0OnYy", "diffSide": "RIGHT", "path": "docker/README.md", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDozNTo1MVrOHvxsWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDozNTo1MVrOHvxsWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg1OTI4OA==", "bodyText": "RUN /install-packages.sh", "url": "https://github.com/nuxeo/nuxeo/pull/4438#discussion_r519859288", "createdAt": "2020-11-09T14:35:51Z", "author": {"login": "ataillefer"}, "path": "docker/README.md", "diffHunk": "@@ -130,23 +130,23 @@ dive nuxeo/nuxeo:latest\n \n ## Build a Custom Image From Nuxeo\n \n-We provide some utility scripts to install Nuxeo packages when building an image from the Nuxeo image:\n+We provide a utility script to install remote Nuxeo packages from [Nuxeo Connect](https://connect.nuxeo.com/) and local Nuxeo packages when building an image from the Nuxeo image:\n \n-- [install-local-packages.sh](./install-local-packages.sh): install a local Nuxeo package embedded in the image as a ZIP file.\n-- [install-packages.sh](./install-packages.sh): install a remote Nuxeo package from [Nuxeo Connect](https://connect.nuxeo.com/).\n-\n-For instance, you can use these scripts in the following `Dockerfile`:\n+For instance, you can use this script in the following `Dockerfile`:\n \n ```Dockerfile\n FROM <DOCKER_REGISTRY>/nuxeo:<TAG>\n \n ARG CLID\n ARG CONNECT_URL\n \n+COPY --chown=900:0 path/to/local-package-nodeps-*.zip $NUXEO_HOME/local-packages/local-package-nodeps.zip\n COPY --chown=900:0 path/to/local-package-*.zip $NUXEO_HOME/local-packages/local-package.zip\n \n-RUN /install-local-packages.sh $NUXEO_HOME/local-packages\n-RUN /install-packages.sh --clid ${CLID} --connect-url ${CONNECT_URL} nuxeo-web-ui nuxeo-drive\n+# Install a local package without its dependencies (`mp-install --nodeps`)\n+RUN /install-packages --offline $NUXEO_HOME/local-packages/local-package-nodeps.zip", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f44008039f789e05c4c9d2945f49083259c93869"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4394, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}