{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3OTA2MzU4", "number": 4115, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNToyNjoyOVrOECnTdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTozMDowN1rOECnZ3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMTc2NTY2OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/java/org/nuxeo/apidoc/browse/Distribution.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNToyNjoyOVrOGfLbVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjowOToxMFrOGfNXWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM0NjI2Mg==", "bodyText": "You can use log4j2 format feature to save some resources.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    log.debug(\"Path => \" + redirectUrl);\n          \n          \n            \n                    log.debug(\"Path => {}\",  redirectUrl);\n          \n      \n    \n    \n  \n\nOtherwise, we tend to use a colon follow by a space and directly is value, for example The document: {docId} has been removed. I don't know if we want to follow such pattern here?", "url": "https://github.com/nuxeo/nuxeo/pull/4115#discussion_r435346262", "createdAt": "2020-06-04T15:26:29Z", "author": {"login": "kevinleturc"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/java/org/nuxeo/apidoc/browse/Distribution.java", "diffHunk": "@@ -358,21 +335,27 @@ public Object doSaveExtended() throws NamingException, NotSupportedException, Sy\n             tx.begin();\n             startedTx = true;\n         }\n+\n+        FormData formData = getContext().getForm();\n+        String source = formData.getString(\"source\");\n         try {\n-            getSnapshotManager().persistRuntimeSnapshot(getContext().getCoreSession(), distribLabel, otherProperties,\n-                    filter);\n+            getSnapshotManager().persistRuntimeSnapshot(getContext().getCoreSession(), formData.getString(\"name\"),\n+                    readFormData(formData), filter);\n         } catch (NuxeoException e) {\n             log.error(\"Error during storage\", e);\n             if (tx != null) {\n                 tx.rollback();\n             }\n-            return getView(\"savedKO\").arg(\"message\", e.getMessage());\n+            return getView(\"savedKO\").arg(\"message\", e.getMessage()).arg(\"source\", source);\n         }\n         log.info(\"Snapshot saved.\");\n+\n         if (tx != null && startedTx) {\n             tx.commit();\n         }\n-        return getView(\"saved\");\n+        String redirectUrl = getContext().getBaseURL() + getPath();\n+        log.debug(\"Path => \" + redirectUrl);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac472c7c00b953c6fbaa79ab0208e5fe84b9e571"}, "originalPosition": 150}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM3ODAwOA==", "bodyText": "Indeed this is old logging, I only moved that line when factoring out duplicated code, and did not pay much attention to it, but i do not see the point of computing the redirectUrl just for logging since we're not redirecting to it anyway.\nSo i will just remove it \ud83d\udc4d", "url": "https://github.com/nuxeo/nuxeo/pull/4115#discussion_r435378008", "createdAt": "2020-06-04T16:09:10Z", "author": {"login": "atchertchian"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/java/org/nuxeo/apidoc/browse/Distribution.java", "diffHunk": "@@ -358,21 +335,27 @@ public Object doSaveExtended() throws NamingException, NotSupportedException, Sy\n             tx.begin();\n             startedTx = true;\n         }\n+\n+        FormData formData = getContext().getForm();\n+        String source = formData.getString(\"source\");\n         try {\n-            getSnapshotManager().persistRuntimeSnapshot(getContext().getCoreSession(), distribLabel, otherProperties,\n-                    filter);\n+            getSnapshotManager().persistRuntimeSnapshot(getContext().getCoreSession(), formData.getString(\"name\"),\n+                    readFormData(formData), filter);\n         } catch (NuxeoException e) {\n             log.error(\"Error during storage\", e);\n             if (tx != null) {\n                 tx.rollback();\n             }\n-            return getView(\"savedKO\").arg(\"message\", e.getMessage());\n+            return getView(\"savedKO\").arg(\"message\", e.getMessage()).arg(\"source\", source);\n         }\n         log.info(\"Snapshot saved.\");\n+\n         if (tx != null && startedTx) {\n             tx.commit();\n         }\n-        return getView(\"saved\");\n+        String redirectUrl = getContext().getBaseURL() + getPath();\n+        log.debug(\"Path => \" + redirectUrl);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM0NjI2Mg=="}, "originalCommit": {"oid": "ac472c7c00b953c6fbaa79ab0208e5fe84b9e571"}, "originalPosition": 150}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMTc4MjA0OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/resources/script/jquery.utils.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTozMDowN1rOGfLlmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTozMDowN1rOGfLlmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM0ODg4OQ==", "bodyText": "It misses a new line at the end of this file.", "url": "https://github.com/nuxeo/nuxeo/pull/4115#discussion_r435348889", "createdAt": "2020-06-04T15:30:07Z", "author": {"login": "kevinleturc"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/resources/script/jquery.utils.js", "diffHunk": "@@ -0,0 +1,7 @@\n+(function ($) {\n+\n+  $.fn.clickButton = function (element) {\n+    element.classList.add('clicked');\n+  }\n+\n+})(jQuery);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac472c7c00b953c6fbaa79ab0208e5fe84b9e571"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4098, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}