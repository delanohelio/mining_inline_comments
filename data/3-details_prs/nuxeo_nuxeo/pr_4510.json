{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxODMzMTM4", "number": 4510, "title": "NXP-29924: avoid storing intermediate chain results", "bodyText": "This should make async chain execution a bit more efficient as we just need the final chain output, no need to keep putting op outputs in the transient store.\nOriginal bug was due to us detaching the document just so we could put it in the transient store but we never attached it again until the end of the chain.", "createdAt": "2020-12-03T14:46:34Z", "url": "https://github.com/nuxeo/nuxeo/pull/4510", "merged": true, "mergeCommit": {"oid": "e7ff6ac1badf8c66e02af21f0a91d67b1cfae267"}, "closed": true, "closedAt": "2020-12-04T09:26:23Z", "author": {"login": "nelsonsilva"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdilZSTABqjQwNjgzNDgwNTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdioXQgAFqTU0NDMxMTUxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cdc863947e7efe8d5d91907fc6f7839a41c81937", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cdc863947e7efe8d5d91907fc6f7839a41c81937", "committedDate": "2020-12-03T14:44:13Z", "message": "NXP-29924: avoid storing intermediate chain results"}, "afterCommit": {"oid": "83d17e1ce2ecd99087c570b562c12acd247e880d", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/83d17e1ce2ecd99087c570b562c12acd247e880d", "committedDate": "2020-12-03T16:04:15Z", "message": "NXP-29924: avoid storing intermediate chain results"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c387333809679df688e4420d788f5b9350f645a9", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c387333809679df688e4420d788f5b9350f645a9", "committedDate": "2020-12-03T16:14:20Z", "message": "NXP-29924: avoid storing intermediate chain results"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83d17e1ce2ecd99087c570b562c12acd247e880d", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/83d17e1ce2ecd99087c570b562c12acd247e880d", "committedDate": "2020-12-03T16:04:15Z", "message": "NXP-29924: avoid storing intermediate chain results"}, "afterCommit": {"oid": "c387333809679df688e4420d788f5b9350f645a9", "author": {"user": {"login": "nelsonsilva", "name": "Nelson Silva"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c387333809679df688e4420d788f5b9350f645a9", "committedDate": "2020-12-03T16:14:20Z", "message": "NXP-29924: avoid storing intermediate chain results"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MTM0Njgw", "url": "https://github.com/nuxeo/nuxeo/pull/4510#pullrequestreview-544134680", "createdAt": "2020-12-03T16:20:15Z", "commit": {"oid": "c387333809679df688e4420d788f5b9350f645a9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MzExNTE5", "url": "https://github.com/nuxeo/nuxeo/pull/4510#pullrequestreview-544311519", "createdAt": "2020-12-03T19:31:52Z", "commit": {"oid": "c387333809679df688e4420d788f5b9350f645a9"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozMTo1MlrOH-t0QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozMTo1MlrOH-t0QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyNDQxNw==", "bodyText": "Is it worth doing output = null after this to avoid keeping a reference to the output in a field?", "url": "https://github.com/nuxeo/nuxeo/pull/4510#discussion_r535524417", "createdAt": "2020-12-03T19:31:52Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-automation/nuxeo-automation-server/src/main/java/org/nuxeo/ecm/automation/server/jaxrs/adapters/AsyncOperationAdapter.java", "diffHunk": "@@ -148,13 +148,16 @@ public Object doPost(ExecutionRequest xreq) {\n \n         opCtx.setCallback(new OperationCallback() {\n \n+            private Object output;\n+\n             @Override\n             public void onChainEnter(OperationType chain) {\n                 //\n             }\n \n             @Override\n             public void onChainExit() {\n+                setOutput(executionId, (Serializable) output);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c387333809679df688e4420d788f5b9350f645a9"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4909, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}