{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0MjQ2NjE0", "number": 4389, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoyNDoyNlrOEuGROQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoyNzozNFrOEuGVZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NzcyNjY1OnYy", "diffSide": "RIGHT", "path": "modules/core/nuxeo-core-convert/src/main/java/org/nuxeo/ecm/core/convert/service/MimeTypeTranslationHelper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoyNDoyNlrOHiSVYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoyNDoyNlrOHiSVYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcxNDAxOQ==", "bodyText": "Shouldn't it be:\n.filter(co -> destinationMimeType == null || destinationMimeType.equals(co.mimeType))", "url": "https://github.com/nuxeo/nuxeo/pull/4389#discussion_r505714019", "createdAt": "2020-10-15T17:24:26Z", "author": {"login": "ataillefer"}, "path": "modules/core/nuxeo-core-convert/src/main/java/org/nuxeo/ecm/core/convert/service/MimeTypeTranslationHelper.java", "diffHunk": "@@ -159,7 +159,8 @@ public boolean hasCompatibleMimeType(List<String> mimeTypes, String mimeType) {\n         }\n \n         return cos.stream()\n-                  .filter(co -> destinationMimeType == null || co.mimeType.equals(destinationMimeType))\n+                  .filter(co -> (co.mimeType != null)\n+                          && (destinationMimeType == null || co.mimeType.equals(destinationMimeType)))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3bc23e529fd32fb145f8e9bcd641d24edc4ad71"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2NzczNzM0OnYy", "diffSide": "RIGHT", "path": "modules/core/nuxeo-core-convert/src/test/java/org/nuxeo/ecm/core/convert/service/TestMimeTypeTranslationHelper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoyNzozNFrOHiScOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNzoyNzozNFrOHiScOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcxNTc3MQ==", "bodyText": "I'm wondering if this is necessary since testGetConverterNames() is already testing this exact code.\nSimply adding the contribution below without the fix should make this test fail.", "url": "https://github.com/nuxeo/nuxeo/pull/4389#discussion_r505715771", "createdAt": "2020-10-15T17:27:34Z", "author": {"login": "ataillefer"}, "path": "modules/core/nuxeo-core-convert/src/test/java/org/nuxeo/ecm/core/convert/service/TestMimeTypeTranslationHelper.java", "diffHunk": "@@ -97,4 +97,13 @@ public void testHasCompatibleMimeType() {\n         assertTrue(mimeTypeTranslationHelper.hasCompatibleMimeType(mimeTypes, \"text/html\"));\n         assertTrue(mimeTypeTranslationHelper.hasCompatibleMimeType(mimeTypes, \"application/pdf\"));\n     }\n+\n+    @Test\n+    public void testGetConverterNamesWhenCOMimeTypeIsNull() {\n+        //No NPE thrown\n+        List<String> converterNames = mimeTypeTranslationHelper.getConverterNames(\"application/pdf\", \"text/plain\");\n+        assertEquals(2, converterNames.size());\n+        assertTrue(converterNames.contains(\"toText1\"));\n+        assertTrue(converterNames.contains(\"toText2\"));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3bc23e529fd32fb145f8e9bcd641d24edc4ad71"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4365, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}