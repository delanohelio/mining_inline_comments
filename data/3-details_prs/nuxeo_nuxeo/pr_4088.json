{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0Mzk4NzY5", "number": 4088, "title": "NXP-28950: compute bundle and component deployment order in explorer", "bodyText": "T&P running at https://qa.nuxeo.org/jenkins/job/TestAndPush/job/ondemand-testandpush-atchertchian-master/233/", "createdAt": "2020-05-28T10:35:58Z", "url": "https://github.com/nuxeo/nuxeo/pull/4088", "merged": true, "mergeCommit": {"oid": "b7b4530904ca004ba6bd9c28b6f47cce71aac5d4"}, "closed": true, "closedAt": "2020-05-29T06:48:09Z", "author": {"login": "atchertchian"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclrlYtAFqTQxOTk4MzQ2OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABclvND2gFqTQyMDIwMzIxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5OTgzNDY4", "url": "https://github.com/nuxeo/nuxeo/pull/4088#pullrequestreview-419983468", "createdAt": "2020-05-28T10:38:26Z", "commit": {"oid": "8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDozODoyNlrOGbvaAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDo0NToxMVrOGbvnMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTc0MTQ0Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    checkDeploymentOrder(legacy ? false : true);\n          \n          \n            \n                    checkDeploymentOrder(!legacy);\n          \n      \n    \n    \n  \n\n(same elsewhere)", "url": "https://github.com/nuxeo/nuxeo/pull/4088#discussion_r431741443", "createdAt": "2020-05-28T10:38:26Z", "author": {"login": "efge"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/pages/artifacts/BundleArtifactPage.java", "diffHunk": "@@ -60,16 +67,18 @@ public void checkReference(boolean partial, boolean legacy) {\n         checkGroupId(\"org.nuxeo.ecm.platform\");\n         checkArtifactId(\"nuxeo-apidoc-core\");\n         checkRequirements(null);\n+        checkDeploymentOrder(legacy ? false : true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTc0MjQ3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (set) {\n          \n          \n            \n                        assertFalse(orderIsBlank);\n          \n          \n            \n                    } else {\n          \n          \n            \n                        assertTrue(orderIsBlank);\n          \n          \n            \n                    }\n          \n          \n            \n                    assertEquals(!set, orderIsBlank);\n          \n      \n    \n    \n  \n\n(same elsewhere)", "url": "https://github.com/nuxeo/nuxeo/pull/4088#discussion_r431742475", "createdAt": "2020-05-28T10:40:32Z", "author": {"login": "efge"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/pages/artifacts/BundleArtifactPage.java", "diffHunk": "@@ -90,4 +99,13 @@ public void checkArtifactId(String id) {\n         assertEquals(id, artifactId.getText());\n     }\n \n+    public void checkDeploymentOrder(boolean set) {\n+        boolean orderIsBlank = StringUtils.isBlank(deploymentOrder.getText());\n+        if (set) {\n+            assertFalse(orderIsBlank);\n+        } else {\n+            assertTrue(orderIsBlank);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTc0MzMwNg==", "bodyText": "Keep newline at end of file", "url": "https://github.com/nuxeo/nuxeo/pull/4088#discussion_r431743306", "createdAt": "2020-05-28T10:42:15Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-core/src/main/java/org/nuxeo/apidoc/api/ComponentInfo.java", "diffHunk": "@@ -89,4 +96,16 @@\n      */\n     List<String> getRequirements();\n \n-}\n+    /**\n+     * Returns the registration order as indicated by {@link ComponentManager}.\n+     *\n+     * @since 11.1\n+     */\n+    Long getRegistrationOrder();\n+\n+    /**\n+     * @since 11.1\n+     */\n+    void setRegistrationOrder(Long order);\n+\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTc0MzY2OQ==", "bodyText": "Setter could use a @since 11.1 too for consistency.", "url": "https://github.com/nuxeo/nuxeo/pull/4088#discussion_r431743669", "createdAt": "2020-05-28T10:42:57Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-core/src/main/java/org/nuxeo/apidoc/api/BundleInfo.java", "diffHunk": "@@ -91,4 +96,13 @@\n      */\n     Blob getParentReadme();\n \n+    /**\n+     * Returns the deployment order as indicated by the runtime context.\n+     *\n+     * @since 11.1\n+     */\n+    Long getDeploymentOrder();\n+\n+    void setDeploymentOrder(Long order);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTc0NDE2Mw==", "bodyText": "Could be written this way to minimize space taken, especially on a protected member\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                /**\n          \n          \n            \n                 * @since 11.1\n          \n          \n            \n                 */\n          \n          \n            \n                /** @since 11.1 */", "url": "https://github.com/nuxeo/nuxeo/pull/4088#discussion_r431744163", "createdAt": "2020-05-28T10:43:59Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-core/src/main/java/org/nuxeo/apidoc/introspection/BundleInfoImpl.java", "diffHunk": "@@ -42,6 +42,9 @@\n \n     protected String manifest;\n \n+    /**\n+     * @since 11.1\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTc0NDgxNw==", "bodyText": "If you make registrationOrder a long then autoboxing will allow you to get rid of the Long.valueOf (another instance below for bindex/setDeploymentOrder)", "url": "https://github.com/nuxeo/nuxeo/pull/4088#discussion_r431744817", "createdAt": "2020-05-28T10:45:11Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-core/src/main/java/org/nuxeo/apidoc/introspection/ServerInfo.java", "diffHunk": "@@ -352,6 +355,8 @@ public static ServerInfo build(String name, String version) {\n             }\n \n             ComponentInfoImpl component = new ComponentInfoImpl(binfo, cname);\n+            component.setRegistrationOrder(Long.valueOf(registrationOrder++));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8c1d61134fa2748c1a5f3c46ac604dfdf48cf7c9", "committedDate": "2020-05-28T10:31:25Z", "message": "NXP-28950: compute bundle and component deployment order in explorer"}, "afterCommit": {"oid": "30aa992e933eb514b20799e1412354d7997ae859", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/30aa992e933eb514b20799e1412354d7997ae859", "committedDate": "2020-05-28T12:43:48Z", "message": "NXP-28950: compute bundle and component deployment order in explorer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56d811fd811ec51ba7df53f5d090d1217fcadcab", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/56d811fd811ec51ba7df53f5d090d1217fcadcab", "committedDate": "2020-05-28T13:37:21Z", "message": "NXP-28950: compute bundle and component deployment order in explorer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "30aa992e933eb514b20799e1412354d7997ae859", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/30aa992e933eb514b20799e1412354d7997ae859", "committedDate": "2020-05-28T12:43:48Z", "message": "NXP-28950: compute bundle and component deployment order in explorer"}, "afterCommit": {"oid": "56d811fd811ec51ba7df53f5d090d1217fcadcab", "author": {"user": {"login": "atchertchian", "name": "Anahide Tchertchian"}}, "url": "https://github.com/nuxeo/nuxeo/commit/56d811fd811ec51ba7df53f5d090d1217fcadcab", "committedDate": "2020-05-28T13:37:21Z", "message": "NXP-28950: compute bundle and component deployment order in explorer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMTI0NTAz", "url": "https://github.com/nuxeo/nuxeo/pull/4088#pullrequestreview-420124503", "createdAt": "2020-05-28T13:47:56Z", "commit": {"oid": "56d811fd811ec51ba7df53f5d090d1217fcadcab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjAzMjEw", "url": "https://github.com/nuxeo/nuxeo/pull/4088#pullrequestreview-420203210", "createdAt": "2020-05-28T15:01:05Z", "commit": {"oid": "56d811fd811ec51ba7df53f5d090d1217fcadcab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4749, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}