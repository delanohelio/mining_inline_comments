{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxODMzMTM4", "number": 4510, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozMTo1MlrOFAbVtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozMTo1MlrOFAbVtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTkyMjQ1OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-automation/nuxeo-automation-server/src/main/java/org/nuxeo/ecm/automation/server/jaxrs/adapters/AsyncOperationAdapter.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTozMTo1MlrOH-t0QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOTo0NDozMVrOH-ueIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyNDQxNw==", "bodyText": "Is it worth doing output = null after this to avoid keeping a reference to the output in a field?", "url": "https://github.com/nuxeo/nuxeo/pull/4510#discussion_r535524417", "createdAt": "2020-12-03T19:31:52Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-automation/nuxeo-automation-server/src/main/java/org/nuxeo/ecm/automation/server/jaxrs/adapters/AsyncOperationAdapter.java", "diffHunk": "@@ -148,13 +148,16 @@ public Object doPost(ExecutionRequest xreq) {\n \n         opCtx.setCallback(new OperationCallback() {\n \n+            private Object output;\n+\n             @Override\n             public void onChainEnter(OperationType chain) {\n                 //\n             }\n \n             @Override\n             public void onChainExit() {\n+                setOutput(executionId, (Serializable) output);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c387333809679df688e4420d788f5b9350f645a9"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUzNDMzMA==", "bodyText": "The operation callback is referenced by the context which is referenced by the thread that handles the chain execution so I'd expect it to be ready for GC once execution is done, no?", "url": "https://github.com/nuxeo/nuxeo/pull/4510#discussion_r535534330", "createdAt": "2020-12-03T19:43:16Z", "author": {"login": "nelsonsilva"}, "path": "modules/platform/nuxeo-automation/nuxeo-automation-server/src/main/java/org/nuxeo/ecm/automation/server/jaxrs/adapters/AsyncOperationAdapter.java", "diffHunk": "@@ -148,13 +148,16 @@ public Object doPost(ExecutionRequest xreq) {\n \n         opCtx.setCallback(new OperationCallback() {\n \n+            private Object output;\n+\n             @Override\n             public void onChainEnter(OperationType chain) {\n                 //\n             }\n \n             @Override\n             public void onChainExit() {\n+                setOutput(executionId, (Serializable) output);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyNDQxNw=="}, "originalCommit": {"oid": "c387333809679df688e4420d788f5b9350f645a9"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUzNTEzOQ==", "bodyText": "Yes if it doesn't last longer than that then no need for manual \"cleanup\".", "url": "https://github.com/nuxeo/nuxeo/pull/4510#discussion_r535535139", "createdAt": "2020-12-03T19:44:31Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-automation/nuxeo-automation-server/src/main/java/org/nuxeo/ecm/automation/server/jaxrs/adapters/AsyncOperationAdapter.java", "diffHunk": "@@ -148,13 +148,16 @@ public Object doPost(ExecutionRequest xreq) {\n \n         opCtx.setCallback(new OperationCallback() {\n \n+            private Object output;\n+\n             @Override\n             public void onChainEnter(OperationType chain) {\n                 //\n             }\n \n             @Override\n             public void onChainExit() {\n+                setOutput(executionId, (Serializable) output);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyNDQxNw=="}, "originalCommit": {"oid": "c387333809679df688e4420d788f5b9350f645a9"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4271, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}