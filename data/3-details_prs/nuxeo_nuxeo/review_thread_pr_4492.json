{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2NDQyMjI5", "number": 4492, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxMjoyODoxNVrOE8svZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxMjozNDoyOVrOE8s4fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyMDgzMDQ1OnYy", "diffSide": "RIGHT", "path": "modules/core/nuxeo-core-binarymanager-cloud/nuxeo-core-binarymanager-gcp/src/main/java/org/nuxeo/ecm/core/storage/gcp/GoogleStorageBinaryManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxMjoyODoxNVrOH4-mGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxMjoyODoxNVrOH4-mGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTUwNzg2Nw==", "bodyText": "Mo -> MB", "url": "https://github.com/nuxeo/nuxeo/pull/4492#discussion_r529507867", "createdAt": "2020-11-24T12:28:15Z", "author": {"login": "efge"}, "path": "modules/core/nuxeo-core-binarymanager-cloud/nuxeo-core-binarymanager-gcp/src/main/java/org/nuxeo/ecm/core/storage/gcp/GoogleStorageBinaryManager.java", "diffHunk": "@@ -76,6 +79,16 @@\n \n     public static final String BUCKET_PREFIX_PROPERTY = \"storage.bucket_prefix\";\n \n+    /** @since 11.4 */\n+    public static final String UPLOAD_CHUNK_SIZE_PROPERTY = \"storage.upload.chunk.size\";\n+\n+    /**\n+     * Default is taken from {@link com.google.cloud.BaseWriteChannel}.\n+     *\n+     * @since 11.4\n+     */\n+    public static final int DEFAULT_UPLOAD_CHUNK_SIZE = 2048 * 1024; // 2 Mo", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9aa9d8476c28e3627c5f431f546eec5349dfdd49"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyMDg1Mzc1OnYy", "diffSide": "RIGHT", "path": "modules/core/nuxeo-core-binarymanager-cloud/nuxeo-core-binarymanager-gcp/src/main/java/org/nuxeo/ecm/core/storage/gcp/GoogleStorageBinaryManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxMjozNDoyOVrOH4-z5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxMjozNDoyOVrOH4-z5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTUxMTM5OA==", "bodyText": "bufferLength definition can be moved inside the try.\nProbably buffer too.", "url": "https://github.com/nuxeo/nuxeo/pull/4492#discussion_r529511398", "createdAt": "2020-11-24T12:34:29Z", "author": {"login": "efge"}, "path": "modules/core/nuxeo-core-binarymanager-cloud/nuxeo-core-binarymanager-gcp/src/main/java/org/nuxeo/ecm/core/storage/gcp/GoogleStorageBinaryManager.java", "diffHunk": "@@ -186,8 +203,14 @@ public void storeFile(String digest, File file) {\n             String key = bucketPrefix + digest;\n             // try to get the blob's metadata to check if it exists\n             if (bucket.get(key) == null) {\n-                try (var fis = new FileInputStream(file)) {\n-                    bucket.create(key, fis);\n+                int bufferLength;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9aa9d8476c28e3627c5f431f546eec5349dfdd49"}, "originalPosition": 62}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4252, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}