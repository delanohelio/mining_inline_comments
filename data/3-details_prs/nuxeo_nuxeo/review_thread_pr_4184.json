{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5NTI2NDA4", "number": 4184, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMjoxMzoyMVrOEIi_Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwOToxNzoxMlrOEIrgmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3Mzk3Mjc0OnYy", "diffSide": "RIGHT", "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/nuxeo.defaults", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMjoxMzoyMVrOGok6Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwODo1Mjo0NFrOGoxgmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTIwMDk2Mw==", "bodyText": "I would prefer nuxeo.transientstore.ttl as a property name (we already have another one related to transient stores, nuxeo.transientstore.provider).\nAnd therefore it would make sense for S3 to have nuxeo.s3storage.transientstore.ttl for example", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445200963", "createdAt": "2020-06-24T22:13:21Z", "author": {"login": "efge"}, "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/nuxeo.defaults", "diffHunk": "@@ -56,3 +56,5 @@ nuxeo.cache.concurrencylevel=500\n \n # boolean to switch back to former hot reload mechanism\n nuxeo.hotreload.compat.mechanism=false\n+\n+nuxeo.storage.transient.ttl=4320", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQwNzM4NQ==", "bodyText": "works for me, i drew inspiration from nuxeo.storage.azure.* as it seemed nicer to read (would rather have nuxeo.storage.(transient|s3|azure|...).* than the current naming..).\nBut I agree that given we already have nuxeo.transientstore.provider we should be consistent. I'll update the PR.", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445407385", "createdAt": "2020-06-25T08:52:44Z", "author": {"login": "nelsonsilva"}, "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/nuxeo.defaults", "diffHunk": "@@ -56,3 +56,5 @@ nuxeo.cache.concurrencylevel=500\n \n # boolean to switch back to former hot reload mechanism\n nuxeo.hotreload.compat.mechanism=false\n+\n+nuxeo.storage.transient.ttl=4320", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTIwMDk2Mw=="}, "originalCommit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NTMwMTQ5OnYy", "diffSide": "RIGHT", "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/config/transient-store-config.xml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwODo1ODowMVrOGoxssg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwOToyMzo0OFrOGoynLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQxMDQ4Mg==", "bodyText": "Wondering why not have a default value for the 2 properties in nuxeo.defaults?\nAlso, \"second\" is confusing, makes think of the time unit whereas it's minutes.\nIf we follow Florent's recommendations, something like:\nnuxeo.transientstore.ttl\nnuxeo.transientstore.second.level.ttl", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445410482", "createdAt": "2020-06-25T08:58:01Z", "author": {"login": "ataillefer"}, "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/config/transient-store-config.xml", "diffHunk": "@@ -7,8 +7,8 @@\n     <store name=\"default\" class=\"org.nuxeo.ecm.core.transientstore.keyvalueblob.KeyValueBlobTransientStore\">\n       <targetMaxSizeMB>-1</targetMaxSizeMB>\n       <absoluteMaxSizeMB>-1</absoluteMaxSizeMB>\n-      <firstLevelTTL>240</firstLevelTTL>\n-      <secondLevelTTL>10</secondLevelTTL>\n+      <firstLevelTTL>${nuxeo.storage.transient.ttl}</firstLevelTTL>\n+      <secondLevelTTL>${nuxeo.storage.transient.second.ttl:=10}</secondLevelTTL>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQyMTQwMg==", "bodyText": "just pushed a change to use nuxeo.transientstore.ttl2.\nI did think about that but I couldn't think of a good use case to change second level ttl so did not expose it by default in nuxeo.defaults.", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445421402", "createdAt": "2020-06-25T09:16:54Z", "author": {"login": "nelsonsilva"}, "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/config/transient-store-config.xml", "diffHunk": "@@ -7,8 +7,8 @@\n     <store name=\"default\" class=\"org.nuxeo.ecm.core.transientstore.keyvalueblob.KeyValueBlobTransientStore\">\n       <targetMaxSizeMB>-1</targetMaxSizeMB>\n       <absoluteMaxSizeMB>-1</absoluteMaxSizeMB>\n-      <firstLevelTTL>240</firstLevelTTL>\n-      <secondLevelTTL>10</secondLevelTTL>\n+      <firstLevelTTL>${nuxeo.storage.transient.ttl}</firstLevelTTL>\n+      <secondLevelTTL>${nuxeo.storage.transient.second.ttl:=10}</secondLevelTTL>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQxMDQ4Mg=="}, "originalCommit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQyNTQ1NQ==", "bodyText": "Moved to nuxeo.defaults", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445425455", "createdAt": "2020-06-25T09:23:48Z", "author": {"login": "nelsonsilva"}, "path": "server/nuxeo-nxr-server/src/main/resources/templates/common/config/transient-store-config.xml", "diffHunk": "@@ -7,8 +7,8 @@\n     <store name=\"default\" class=\"org.nuxeo.ecm.core.transientstore.keyvalueblob.KeyValueBlobTransientStore\">\n       <targetMaxSizeMB>-1</targetMaxSizeMB>\n       <absoluteMaxSizeMB>-1</absoluteMaxSizeMB>\n-      <firstLevelTTL>240</firstLevelTTL>\n-      <secondLevelTTL>10</secondLevelTTL>\n+      <firstLevelTTL>${nuxeo.storage.transient.ttl}</firstLevelTTL>\n+      <secondLevelTTL>${nuxeo.storage.transient.second.ttl:=10}</secondLevelTTL>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQxMDQ4Mg=="}, "originalCommit": {"oid": "aa755dd904e9b3a7d8fe760ad46683d9fd394aef"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NTM2OTIyOnYy", "diffSide": "RIGHT", "path": "packages/nuxeo-amazon-s3-package/src/main/resources/install/templates/s3binaries/nxserver/config/s3directupload-config.xml.nxftl", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwOToxNzoxM1rOGoyYDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwOToyNDowOVrOGoyoBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQyMTU4Mw==", "bodyText": "What does the ${r\"\"} for?\nAlso, defaults should be there or in nuxeo.defaults, not both imho.", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445421583", "createdAt": "2020-06-25T09:17:13Z", "author": {"login": "kevinleturc"}, "path": "packages/nuxeo-amazon-s3-package/src/main/resources/install/templates/s3binaries/nxserver/config/s3directupload-config.xml.nxftl", "diffHunk": "@@ -10,8 +10,8 @@\n       <property name=\"keyValueStore\">s3DirectUploadKeyValueStore</property> <!-- not defined there, fallback on default -->\n       <targetMaxSizeMB>${nuxeo.s3storage.transient.targetMaxSizeMB}</targetMaxSizeMB>\n       <absoluteMaxSizeMB>-1</absoluteMaxSizeMB>\n-      <firstLevelTTL>120</firstLevelTTL>\n-      <secondLevelTTL>10</secondLevelTTL>\n+      <firstLevelTTL>${nuxeo.s3storage.transientstore.ttl}</firstLevelTTL>\n+      <secondLevelTTL>${r\"${nuxeo.s3storage.transientstore.ttl2:=10}\"}</secondLevelTTL>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "813506cc7cf79e4fe277d3867936e88487fd8c61"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQyMzI4Mw==", "bodyText": "${r\"..\"} is to not process the expression so it ends up in the XML contribution (we handle them ourselves in XML).\nI will move ttl2 to nuxeo.defaults then.", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445423283", "createdAt": "2020-06-25T09:20:09Z", "author": {"login": "nelsonsilva"}, "path": "packages/nuxeo-amazon-s3-package/src/main/resources/install/templates/s3binaries/nxserver/config/s3directupload-config.xml.nxftl", "diffHunk": "@@ -10,8 +10,8 @@\n       <property name=\"keyValueStore\">s3DirectUploadKeyValueStore</property> <!-- not defined there, fallback on default -->\n       <targetMaxSizeMB>${nuxeo.s3storage.transient.targetMaxSizeMB}</targetMaxSizeMB>\n       <absoluteMaxSizeMB>-1</absoluteMaxSizeMB>\n-      <firstLevelTTL>120</firstLevelTTL>\n-      <secondLevelTTL>10</secondLevelTTL>\n+      <firstLevelTTL>${nuxeo.s3storage.transientstore.ttl}</firstLevelTTL>\n+      <secondLevelTTL>${r\"${nuxeo.s3storage.transientstore.ttl2:=10}\"}</secondLevelTTL>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQyMTU4Mw=="}, "originalCommit": {"oid": "813506cc7cf79e4fe277d3867936e88487fd8c61"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQyNTY2OQ==", "bodyText": "Moved to nuxeo.defaults", "url": "https://github.com/nuxeo/nuxeo/pull/4184#discussion_r445425669", "createdAt": "2020-06-25T09:24:09Z", "author": {"login": "nelsonsilva"}, "path": "packages/nuxeo-amazon-s3-package/src/main/resources/install/templates/s3binaries/nxserver/config/s3directupload-config.xml.nxftl", "diffHunk": "@@ -10,8 +10,8 @@\n       <property name=\"keyValueStore\">s3DirectUploadKeyValueStore</property> <!-- not defined there, fallback on default -->\n       <targetMaxSizeMB>${nuxeo.s3storage.transient.targetMaxSizeMB}</targetMaxSizeMB>\n       <absoluteMaxSizeMB>-1</absoluteMaxSizeMB>\n-      <firstLevelTTL>120</firstLevelTTL>\n-      <secondLevelTTL>10</secondLevelTTL>\n+      <firstLevelTTL>${nuxeo.s3storage.transientstore.ttl}</firstLevelTTL>\n+      <secondLevelTTL>${r\"${nuxeo.s3storage.transientstore.ttl2:=10}\"}</secondLevelTTL>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQyMTU4Mw=="}, "originalCommit": {"oid": "813506cc7cf79e4fe277d3867936e88487fd8c61"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4146, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}