{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5MzM5NDc5", "number": 4214, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDozMDoyNlrOEOn_lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMzo1NDoyMFrOEPJAXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzcwNzc1OnYy", "diffSide": "RIGHT", "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "isResolved": false, "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxMDozMDoyNlrOGx4HEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDowMzowOVrOGyseBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA==", "bodyText": "Isn't it breaking the backward compatibility? It changes the quick filters returned by the REST API", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r454952720", "createdAt": "2020-07-15T10:30:26Z", "author": {"login": "troger"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAwNDk5MQ==", "bodyText": "For the moment, we have only one client using the addon, and they use the default UI. I can let the original quickfilter and hardcode the expected filters (and removing the exceptTrashed one) in the nuxeo-result element (https://github.com/nuxeo/nuxeo-web-ui/blob/master/elements/nuxeo-results/nuxeo-results.js#L275). What would be the best option?", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455004991", "createdAt": "2020-07-15T12:14:22Z", "author": {"login": "gcarlin"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTczOTExOQ==", "bodyText": "Guess it could be an option, indeed, a safer one!\nBut, if we are sure about the impact (only one client and being a \"private\" addon), would it be that bad to perform the change? (cc @troger )\nOf course,  stating that on the \"Upgrade Notes\" and double checking our impact assessment.", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455739119", "createdAt": "2020-07-16T12:11:39Z", "author": {"login": "nmpcunha"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc0NjU0NA==", "bodyText": "If you know what you are doing and the impacts, I'm OK, just wanted to mention it :)", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455746544", "createdAt": "2020-07-16T12:25:17Z", "author": {"login": "troger"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc3NjY1Mg==", "bodyText": "TBH, I don't know too  \ud83d\ude05\nBut @gcarlin's input may be a \"game changer\". Anyway, the other option (safer one, keeping the existing quickFilter) is also viable, but it would mean that we'll keep/maintain something that is already obsolete, i.e. seems that it is not useful \ud83e\udd37\u200d\u2642\ufe0f", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455776652", "createdAt": "2020-07-16T13:15:47Z", "author": {"login": "nmpcunha"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc4MjczOQ==", "bodyText": "Using \"hardcoded\" quickfilters on the nuxeo-results element also implies that a new quickfilter won't be displayed automatically. That said, I would opt for the safe option (never know if anyone else is using it).", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455782739", "createdAt": "2020-07-16T13:24:32Z", "author": {"login": "gcarlin"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc4NTMwNg==", "bodyText": "But in that case we would not be \"hardcoding\" since it is a parameter and the users can change it if they want! Or am I seeing it a wrong way?", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455785306", "createdAt": "2020-07-16T13:28:05Z", "author": {"login": "nmpcunha"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc4ODM5OA==", "bodyText": "Yes yes, but I guess that's the only part in Web UI we explicitly indicate which quickfilters to display (so you might not guess you need also to update the result element)", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455788398", "createdAt": "2020-07-16T13:32:44Z", "author": {"login": "gcarlin"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgxMDU2Ng==", "bodyText": "So, according to nelson note (#4214 (comment)), we will only add an additional quickfilter", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455810566", "createdAt": "2020-07-16T14:03:09Z", "author": {"login": "gcarlin"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk1MjcyMA=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0MzExNjQ1OnYy", "diffSide": "RIGHT", "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMzo1NDoyMFrOGysC6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQyMDo1NzoxMlrOGy8gng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgwMzYyNg==", "bodyText": "With ecm:isTrashed = 0 in the fixed part we'll end up with ecm:isTrashed = 0 AND ecm:isTrashed = 1 => no results, no?", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455803626", "createdAt": "2020-07-16T13:54:20Z", "author": {"login": "nelsonsilva"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">\n+          <clause>ecm:isTrashed = 1</clause>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgwNTk3Nw==", "bodyText": "Indeed! So maybe adding a quickfilter is enough, and we do not modify the fixed part of the query.", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455805977", "createdAt": "2020-07-16T13:57:22Z", "author": {"login": "gcarlin"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">\n+          <clause>ecm:isTrashed = 1</clause>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgwMzYyNg=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgyNzAyMQ==", "bodyText": "Initial requirement as described in the ticket was \"Default retention search shouldn't list trashed documents\" which this doesn't do and we already had a quickfilter to exclude trashed documents so effectively you're adding a new quick filter to list trashed documents under retention (which I thought you shouldn't be able to have in the first place, no?)", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455827021", "createdAt": "2020-07-16T14:25:20Z", "author": {"login": "nelsonsilva"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">\n+          <clause>ecm:isTrashed = 1</clause>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgwMzYyNg=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgzMjM3Nw==", "bodyText": "You can have documents under retention located in the trash (if compliance mode is not explicitly activated). So the original requirement is to get non trashed documents in the listing. But, as you noted correctly, if we have a fixed part excluding trashed document, we wouldn't be able to make any operation on these documents (extending retention period / apply a legal hold / attach a retention rule). So we would be loosing a default feature (even if we agree it is strange to perform retention actions on trashed documents)", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455832377", "createdAt": "2020-07-16T14:31:48Z", "author": {"login": "gcarlin"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">\n+          <clause>ecm:isTrashed = 1</clause>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgwMzYyNg=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg2NDY4OA==", "bodyText": "But my point is we already have a quick filter to show only non trashed documents.... is there a new requirement to show only trashed now ?", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r455864688", "createdAt": "2020-07-16T15:14:57Z", "author": {"login": "nelsonsilva"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">\n+          <clause>ecm:isTrashed = 1</clause>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgwMzYyNg=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3MzM3NA==", "bodyText": "Not really, so well considered, we can keep the original  code. The idea would be to get the quickfilter exceptTrashed selected by default.", "url": "https://github.com/nuxeo/nuxeo/pull/4214#discussion_r456073374", "createdAt": "2020-07-16T20:57:12Z", "author": {"login": "gcarlin"}, "path": "addons/nuxeo-retention/nuxeo-retention-core/src/main/resources/OSGI-INF/retention-pageproviders.xml", "diffHunk": "@@ -100,8 +101,8 @@\n         <quickFilter name=\"hasNotLegalHold\">\n           <clause>ecm:hasLegalHold = 0</clause>\n         </quickFilter>\n-        <quickFilter name=\"exceptTrashed\">\n-          <clause>ecm:isTrashed = 0</clause>\n+        <quickFilter name=\"includeTrashed\">\n+          <clause>ecm:isTrashed = 1</clause>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgwMzYyNg=="}, "originalCommit": {"oid": "5c6cc68b07e6e8296a4fe865c4033580e7bb0272"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4344, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}