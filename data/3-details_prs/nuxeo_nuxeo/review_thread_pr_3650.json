{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5OTk4NTg0", "number": 3650, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMDoyMjo1NFrOEg4RJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMzo1Nzo0N1rOEhr7Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyOTExNzgxOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-platform-importer/nuxeo-importer-stream/src/test/java/org/nuxeo/importer/stream/tests/importer/TestAutomation.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMDoyMjo1NFrOHN5zmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxNTowMDoxMlrOHOCYiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM0MDYzNA==", "bodyText": "I suggest you use FeaturesRunner.getBuildDirectory() istead of the hardcoded target to make sure that the multi-environment tests are completely isolated.\nSee https://jira.nuxeo.com/browse/NXP-28579 and 7d7a2f9.", "url": "https://github.com/nuxeo/nuxeo/pull/3650#discussion_r484340634", "createdAt": "2020-09-07T10:22:54Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-platform-importer/nuxeo-importer-stream/src/test/java/org/nuxeo/importer/stream/tests/importer/TestAutomation.java", "diffHunk": "@@ -62,7 +63,7 @@\n     AutomationService automationService;\n \n     @Rule\n-    public TemporaryFolder folder = new TemporaryFolder();\n+    public TemporaryFolder folder = new TemporaryFolder(new File(\"target\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "036e42cfaaa417592ca4181c5ccc978ac0d88a23"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDQ4MTE2Mw==", "bodyText": "Thanks, I will do that for modules that uses FeaturesRunner (i.e. not for the nuxeo-stream lib)", "url": "https://github.com/nuxeo/nuxeo/pull/3650#discussion_r484481163", "createdAt": "2020-09-07T15:00:12Z", "author": {"login": "bdelbosc"}, "path": "modules/platform/nuxeo-platform-importer/nuxeo-importer-stream/src/test/java/org/nuxeo/importer/stream/tests/importer/TestAutomation.java", "diffHunk": "@@ -62,7 +63,7 @@\n     AutomationService automationService;\n \n     @Rule\n-    public TemporaryFolder folder = new TemporaryFolder();\n+    public TemporaryFolder folder = new TemporaryFolder(new File(\"target\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM0MDYzNA=="}, "originalCommit": {"oid": "036e42cfaaa417592ca4181c5ccc978ac0d88a23"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyOTEyODYzOnYy", "diffSide": "RIGHT", "path": "modules/runtime/nuxeo-stream/src/main/java/org/nuxeo/lib/stream/log/chronicle/ChronicleLogOffsetTracker.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMDoyNjoxNVrOHN56QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wN1QxMDoyNjoxNVrOHN56QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM0MjMzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // border line cases that happens on unit test and where the queue is not yet ready\n          \n          \n            \n                        // border line cases that happens on unit tests and where the queue is not yet ready", "url": "https://github.com/nuxeo/nuxeo/pull/3650#discussion_r484342336", "createdAt": "2020-09-07T10:26:15Z", "author": {"login": "ataillefer"}, "path": "modules/runtime/nuxeo-stream/src/main/java/org/nuxeo/lib/stream/log/chronicle/ChronicleLogOffsetTracker.java", "diffHunk": "@@ -123,9 +122,18 @@ public long readLastCommittedOffset() {\n                     offsetQueue.file().getAbsolutePath(), e.getMessage()));\n             offsetTailer = offsetQueue.createTailer().direction(TailerDirection.BACKWARD).toEnd();\n         }\n-        if (offsetTailer.state() == TailerState.UNINITIALISED) {\n+        switch (offsetTailer.state()) {\n+        case FOUND_CYCLE:\n+            // expected case continue\n+            break;\n+        case UNINITIALISED:\n             // This is a new queue, we are not going to find anything\n             return 0;\n+        default:\n+            // border line cases that happens on unit test and where the queue is not yet ready", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00135d92b2206ad47e7fb90ea4c6f3cffef4a4cc"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzNzU4MTM4OnYy", "diffSide": "RIGHT", "path": "pom.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMzo1Nzo0N1rOHPIseg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNTowMToyMlrOHPLvVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTYzMzE0Ng==", "bodyText": "@bdelbosc Is there a specific reason why this would be uppercase please?\nIt's been making my eclipse java build fail for not obvious reason...", "url": "https://github.com/nuxeo/nuxeo/pull/3650#discussion_r485633146", "createdAt": "2020-09-09T13:57:47Z", "author": {"login": "atchertchian"}, "path": "pom.xml", "diffHunk": "@@ -4987,7 +4987,7 @@\n       <dependency>\n         <!-- unused dependency, declared to exclude affinity -->\n         <groupId>net.openhft</groupId>\n-        <artifactId>chronicle-threads</artifactId>\n+        <artifactId>chronicle-Threads</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89b98898fce100ba960cf73dc65f195a52d65e28"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTY4MzAzMA==", "bodyText": "see #4306", "url": "https://github.com/nuxeo/nuxeo/pull/3650#discussion_r485683030", "createdAt": "2020-09-09T15:01:22Z", "author": {"login": "atchertchian"}, "path": "pom.xml", "diffHunk": "@@ -4987,7 +4987,7 @@\n       <dependency>\n         <!-- unused dependency, declared to exclude affinity -->\n         <groupId>net.openhft</groupId>\n-        <artifactId>chronicle-threads</artifactId>\n+        <artifactId>chronicle-Threads</artifactId>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTYzMzE0Ng=="}, "originalCommit": {"oid": "89b98898fce100ba960cf73dc65f195a52d65e28"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4312, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}