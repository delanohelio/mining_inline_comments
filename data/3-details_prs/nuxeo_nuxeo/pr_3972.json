{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NTY4OTg3", "number": 3972, "title": "NXBT-3289: remove buggy empty-docker-secret", "bodyText": "", "createdAt": "2020-04-24T14:00:47Z", "url": "https://github.com/nuxeo/nuxeo/pull/3972", "merged": true, "mergeCommit": {"oid": "9c46562f25fe7009d44fdbdc9eb4ac931415012d"}, "closed": true, "closedAt": "2020-04-28T12:24:04Z", "author": {"login": "NourNuxeo"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbKRAmABqjMyNzIxNjQ1Mjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccC-T_AFqTQwMTc4MDA2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5a37fa4202eec68e374c36efa02a691fb195c4eb", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5a37fa4202eec68e374c36efa02a691fb195c4eb", "committedDate": "2020-04-24T14:00:11Z", "message": "NXBT-3289: remove buggy empty-docker-secret"}, "afterCommit": {"oid": "104b9fd577d16727923e65131471f000d933d60d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/104b9fd577d16727923e65131471f000d933d60d", "committedDate": "2020-04-25T18:19:30Z", "message": "NXBT-3289: remove buggy empty-docker-secret"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNjg2NzA0", "url": "https://github.com/nuxeo/nuxeo/pull/3972#pullrequestreview-400686704", "createdAt": "2020-04-27T07:22:09Z", "commit": {"oid": "104b9fd577d16727923e65131471f000d933d60d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNzoyMjoxMFrOGMUeCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNzoyMjoxMFrOGMUeCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTU3MTQ2NQ==", "bodyText": "why not simply\nkubectl create secret generic kubernetes-docker-cfg \\\n                  --namespace=${PREVIEW_NAMESPACE} \\\n                  --from-literal=.dockerconfigjson=\"\\$(kubectl --namespace platform get secret kubernetes-docker-cfg -ojsonpath='{.data.\\\\.dockerconfigjson}' | base64 --decode)\" \\\n                  --type=kubernetes.io/dockerconfigjson", "url": "https://github.com/nuxeo/nuxeo/pull/3972#discussion_r415571465", "createdAt": "2020-04-27T07:22:10Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -660,6 +660,10 @@ pipeline {\n                 // Previous preview deployment needs to be scaled to 0 to be replaced correctly\n                 sh \"kubectl -n ${PREVIEW_NAMESPACE} scale deployment nuxeo-preview --replicas=0\"\n               }\n+              sh \"\"\"kubectl create secret generic kubernetes-docker-cfg \\\n+                  --namespace=${PREVIEW_NAMESPACE} \\\n+                  --from-literal=.dockerconfigjson=\"\\$(kubectl --namespace platform get secret kubernetes-docker-cfg -ojsonpath='{.data.\\\\.dockerconfigjson}' | base64 --decode)\" \\\n+                  --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\"\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "104b9fd577d16727923e65131471f000d933d60d"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNjg4MDY1", "url": "https://github.com/nuxeo/nuxeo/pull/3972#pullrequestreview-400688065", "createdAt": "2020-04-27T07:24:21Z", "commit": {"oid": "104b9fd577d16727923e65131471f000d933d60d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNzoyNDoyMVrOGMUjfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwNzoyNDoyMVrOGMUjfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTU3Mjg2MQ==", "bodyText": "Could you pleas use a constant for 'platform' as we try to do for kubectl commands.\nI'd say, after this line:\nkubernetesNamespace = 'platform'", "url": "https://github.com/nuxeo/nuxeo/pull/3972#discussion_r415572861", "createdAt": "2020-04-27T07:24:21Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -660,6 +660,10 @@ pipeline {\n                 // Previous preview deployment needs to be scaled to 0 to be replaced correctly\n                 sh \"kubectl -n ${PREVIEW_NAMESPACE} scale deployment nuxeo-preview --replicas=0\"\n               }\n+              sh \"\"\"kubectl create secret generic kubernetes-docker-cfg \\\n+                  --namespace=${PREVIEW_NAMESPACE} \\\n+                  --from-literal=.dockerconfigjson=\"\\$(kubectl --namespace platform get secret kubernetes-docker-cfg -ojsonpath='{.data.\\\\.dockerconfigjson}' | base64 --decode)\" \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "104b9fd577d16727923e65131471f000d933d60d"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwODA4NTQy", "url": "https://github.com/nuxeo/nuxeo/pull/3972#pullrequestreview-400808542", "createdAt": "2020-04-27T10:07:46Z", "commit": {"oid": "cc7699aa915ee0a07f25208963efc28adef2c15b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMDowNzo0N1rOGMbRYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QxMDowNzo0N1rOGMbRYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4MjkxMg==", "bodyText": "I would say this one is not linked to the Kubernetes namespace, it's just a GitHub status name.", "url": "https://github.com/nuxeo/nuxeo/pull/3972#discussion_r415682912", "createdAt": "2020-04-27T10:07:47Z", "author": {"login": "troger"}, "path": "Jenkinsfile", "diffHunk": "@@ -158,7 +159,7 @@ def buildUnitTestStage(env) {\n     stage(\"Run ${env} unit tests\") {\n       container(\"maven-${env}\") {\n         script {\n-          setGitHubBuildStatus(\"platform/utests/${env}\", \"Unit tests - ${env} environment\", 'PENDING')\n+          setGitHubBuildStatus(\"${kubernetesNamespace}/utests/${env}\", \"Unit tests - ${env} environment\", 'PENDING')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc7699aa915ee0a07f25208963efc28adef2c15b"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccdf1a1450c45e0dbabf1994a286c90072a5c152", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ccdf1a1450c45e0dbabf1994a286c90072a5c152", "committedDate": "2020-04-27T10:17:12Z", "message": "NXBT-3289: remove buggy empty-docker-secret"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cc7699aa915ee0a07f25208963efc28adef2c15b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cc7699aa915ee0a07f25208963efc28adef2c15b", "committedDate": "2020-04-27T09:18:06Z", "message": "NXBT-3289: introduce the kubernetesNamespace variable"}, "afterCommit": {"oid": "ccdf1a1450c45e0dbabf1994a286c90072a5c152", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ccdf1a1450c45e0dbabf1994a286c90072a5c152", "committedDate": "2020-04-27T10:17:12Z", "message": "NXBT-3289: remove buggy empty-docker-secret"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwOTExNjIy", "url": "https://github.com/nuxeo/nuxeo/pull/3972#pullrequestreview-400911622", "createdAt": "2020-04-27T12:41:15Z", "commit": {"oid": "ccdf1a1450c45e0dbabf1994a286c90072a5c152"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzgwMDY0", "url": "https://github.com/nuxeo/nuxeo/pull/3972#pullrequestreview-401780064", "createdAt": "2020-04-28T12:23:50Z", "commit": {"oid": "ccdf1a1450c45e0dbabf1994a286c90072a5c152"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4784, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}