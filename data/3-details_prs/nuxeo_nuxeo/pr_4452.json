{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NDYzNjgz", "number": 4452, "title": "Fix NXP-29529 es passthrough", "bodyText": "", "createdAt": "2020-11-10T12:45:08Z", "url": "https://github.com/nuxeo/nuxeo/pull/4452", "merged": true, "mergeCommit": {"oid": "8a7daae7bb232bf492753b41c3b525a6da61c158"}, "closed": true, "closedAt": "2020-11-13T10:45:55Z", "author": {"login": "kevinleturc"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbIkNhgH2gAyNTE4NDYzNjgzOjU4MjFlM2JjMzVlMjBhNmUyYWViNzdlOTQzMGYwMjA4YjcwNGEwMmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcEzPNAFqTUyOTk1NjQ0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5821e3bc35e20a6e2aeb77e9430f0208b704a02c", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5821e3bc35e20a6e2aeb77e9430f0208b704a02c", "committedDate": "2020-11-10T12:31:59Z", "message": "NXP-29529: Cleanup / Format"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4ODk2OTM5", "url": "https://github.com/nuxeo/nuxeo/pull/4452#pullrequestreview-528896939", "createdAt": "2020-11-12T09:26:42Z", "commit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOToyNjo0MlrOHxx2yQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOTozMTo1MFrOHxyEXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk1OTExMw==", "bodyText": "extra { I guess", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521959113", "createdAt": "2020-11-12T09:26:42Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/DocRequestFilter.java", "diffHunk": "@@ -32,23 +32,33 @@\n \n     private final String indices;\n \n-    private final String types;\n+    /** @deprecated since 11.4, types have been removed since Elasticsearch 7.x */\n+    @Deprecated\n+    private final String types = null;\n \n     private final String documentId;\n \n     private final String rawQuery;\n \n-    public DocRequestFilter(NuxeoPrincipal principal, String indices, String types, String documentId,\n-            String rawQuery) {\n+    public DocRequestFilter(NuxeoPrincipal principal, String indices, String documentId, String rawQuery) {\n         this.principal = principal;\n         this.indices = indices;\n-        this.types = types;\n         this.documentId = documentId;\n         this.rawQuery = rawQuery;\n     }\n \n+    /**\n+     * @deprecated since 11.4, types have been removed since Elasticsearch 7.x, use\n+     *             {{@link #DocRequestFilter(NuxeoPrincipal, String, String, String)} instead", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk1OTgxMA==", "bodyText": "extra {, and the following ones", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521959810", "createdAt": "2020-11-12T09:27:42Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/Main.java", "diffHunk": "@@ -101,37 +100,58 @@ public String searchWithPayload(@PathParam(\"indices\") String indices, @Context U\n     @Produces(MediaType.APPLICATION_JSON)\n     public String searchWithPost(@PathParam(\"indices\") String indices, @Context UriInfo uriInf, String payload)\n             throws IOException, JSONException {\n-        return doSearchWithPayload(indices, \"_all\", uriInf.getRequestUri().getRawQuery(), payload);\n+        return doSearchWithPayload(indices, uriInf.getRequestUri().getRawQuery(), payload);\n     }\n \n+    /**\n+     * @deprecated since 11.4, types have been removed since Elasticsearch 7.x, use\n+     *             {{@link #searchWithPayload(String, UriInfo, MultivaluedMap)} instead", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2MDUxMg==", "bodyText": "don't we want the since in the annotation?", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521960512", "createdAt": "2020-11-12T09:28:45Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/Main.java", "diffHunk": "@@ -101,37 +100,58 @@ public String searchWithPayload(@PathParam(\"indices\") String indices, @Context U\n     @Produces(MediaType.APPLICATION_JSON)\n     public String searchWithPost(@PathParam(\"indices\") String indices, @Context UriInfo uriInf, String payload)\n             throws IOException, JSONException {\n-        return doSearchWithPayload(indices, \"_all\", uriInf.getRequestUri().getRawQuery(), payload);\n+        return doSearchWithPayload(indices, uriInf.getRequestUri().getRawQuery(), payload);\n     }\n \n+    /**\n+     * @deprecated since 11.4, types have been removed since Elasticsearch 7.x, use\n+     *             {{@link #searchWithPayload(String, UriInfo, MultivaluedMap)} instead\n+     */\n     @GET\n     @Path(\"{indices}/{types}/_search\")\n     @Consumes(MediaType.APPLICATION_FORM_URLENCODED)\n     @Produces(MediaType.APPLICATION_JSON)\n+    @Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2MjU4OQ==", "bodyText": "why?", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521962589", "createdAt": "2020-11-12T09:31:50Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/test/java/org/nuxeo/elasticsearch/http/readonly/TestRequestValidator.java", "diffHunk": "@@ -47,14 +47,18 @@ public void initValidator() {\n     }\n \n     @Test\n-    public void testCheckValidDocumentId() throws Exception {\n+    public void testCheckValidDocumentId() {\n         validator.checkValidDocumentId(\"123\");\n         exception.expect(IllegalArgumentException.class);\n         validator.checkValidDocumentId(null);\n     }\n \n+    /**\n+     * @since 11.4", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f743dd435eb6f0e206cc9ac0979e361968d573f0", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f743dd435eb6f0e206cc9ac0979e361968d573f0", "committedDate": "2020-11-12T09:40:05Z", "message": "NXP-29529: Remove Elasticsearch types from passpathrough"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/341948787efc89622a1b66228ac74ffdda9a0add", "committedDate": "2020-11-10T12:43:42Z", "message": "NXP-29529: Remove Elasticsearch types from passpathrough"}, "afterCommit": {"oid": "f743dd435eb6f0e206cc9ac0979e361968d573f0", "author": {"user": {"login": "kevinleturc", "name": "Kevin Leturc"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f743dd435eb6f0e206cc9ac0979e361968d573f0", "committedDate": "2020-11-12T09:40:05Z", "message": "NXP-29529: Remove Elasticsearch types from passpathrough"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4OTEwOTgz", "url": "https://github.com/nuxeo/nuxeo/pull/4452#pullrequestreview-528910983", "createdAt": "2020-11-12T09:43:16Z", "commit": {"oid": "f743dd435eb6f0e206cc9ac0979e361968d573f0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5OTU2NDQz", "url": "https://github.com/nuxeo/nuxeo/pull/4452#pullrequestreview-529956443", "createdAt": "2020-11-13T10:42:42Z", "commit": {"oid": "f743dd435eb6f0e206cc9ac0979e361968d573f0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4954, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}