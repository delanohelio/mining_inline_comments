{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyODY0MjI2", "number": 3856, "title": "Feature nxp 27713 nuxeo staging preview", "bodyText": "", "createdAt": "2020-03-24T09:04:13Z", "url": "https://github.com/nuxeo/nuxeo/pull/3856", "merged": true, "mergeCommit": {"oid": "c56ecebcfc4940bb653c184d18adf34cd31b2c99"}, "closed": true, "closedAt": "2020-04-08T08:18:10Z", "author": {"login": "NourNuxeo"}, "timelineItems": {"totalCount": 194, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcS-yQ0ABqjMxODIxMjk1NDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVi7wYAFqTM4OTcyNDE5Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86667e5f50ca98ce5746690fc622c6a1ce106dad", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/86667e5f50ca98ce5746690fc622c6a1ce106dad", "committedDate": "2020-03-30T16:39:35Z", "message": "TEMP"}, "afterCommit": {"oid": "19feef6b3c2a6e4d1d2a54be0395bf8e56fa9f93", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/19feef6b3c2a6e4d1d2a54be0395bf8e56fa9f93", "committedDate": "2020-03-31T08:25:05Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "19feef6b3c2a6e4d1d2a54be0395bf8e56fa9f93", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/19feef6b3c2a6e4d1d2a54be0395bf8e56fa9f93", "committedDate": "2020-03-31T08:25:05Z", "message": "TEMP"}, "afterCommit": {"oid": "c67c15425175dd632716213334ceae20a414cd6f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c67c15425175dd632716213334ceae20a414cd6f", "committedDate": "2020-03-31T09:15:03Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "07fa8424bad885708914077a8bd03b84be1e8e5e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/07fa8424bad885708914077a8bd03b84be1e8e5e", "committedDate": "2020-03-31T09:49:08Z", "message": "TEST"}, "afterCommit": {"oid": "c67c15425175dd632716213334ceae20a414cd6f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c67c15425175dd632716213334ceae20a414cd6f", "committedDate": "2020-03-31T09:15:03Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c67c15425175dd632716213334ceae20a414cd6f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c67c15425175dd632716213334ceae20a414cd6f", "committedDate": "2020-03-31T09:15:03Z", "message": "TEMP"}, "afterCommit": {"oid": "4ca8a6ff29f291be097cc762f1f86c60a570e883", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4ca8a6ff29f291be097cc762f1f86c60a570e883", "committedDate": "2020-03-31T11:32:11Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1f8b633165758fd37f5f9f8f7b10d30a5e4e9eb4", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1f8b633165758fd37f5f9f8f7b10d30a5e4e9eb4", "committedDate": "2020-03-31T14:39:07Z", "message": "WIP"}, "afterCommit": {"oid": "99a6ffe3091faa3308d9fe5c0a4ae6b324b5acb3", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/99a6ffe3091faa3308d9fe5c0a4ae6b324b5acb3", "committedDate": "2020-03-31T14:41:30Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "99a6ffe3091faa3308d9fe5c0a4ae6b324b5acb3", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/99a6ffe3091faa3308d9fe5c0a4ae6b324b5acb3", "committedDate": "2020-03-31T14:41:30Z", "message": "WIP"}, "afterCommit": {"oid": "2df68d2f90f732e1df17f075e33d67e05326e392", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2df68d2f90f732e1df17f075e33d67e05326e392", "committedDate": "2020-03-31T14:45:52Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2df68d2f90f732e1df17f075e33d67e05326e392", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2df68d2f90f732e1df17f075e33d67e05326e392", "committedDate": "2020-03-31T14:45:52Z", "message": "WIP"}, "afterCommit": {"oid": "ee207c7b0e50787a37271309f158e268a216589f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ee207c7b0e50787a37271309f158e268a216589f", "committedDate": "2020-03-31T14:54:52Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ee207c7b0e50787a37271309f158e268a216589f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ee207c7b0e50787a37271309f158e268a216589f", "committedDate": "2020-03-31T14:54:52Z", "message": "WIP"}, "afterCommit": {"oid": "01e3771a3d9f46292a7e246f70a7d7555a05d8f3", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/01e3771a3d9f46292a7e246f70a7d7555a05d8f3", "committedDate": "2020-03-31T14:58:33Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "01e3771a3d9f46292a7e246f70a7d7555a05d8f3", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/01e3771a3d9f46292a7e246f70a7d7555a05d8f3", "committedDate": "2020-03-31T14:58:33Z", "message": "WIP"}, "afterCommit": {"oid": "72f1c7e4f2df34c3cc6bf111fa76238b3eb28c10", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/72f1c7e4f2df34c3cc6bf111fa76238b3eb28c10", "committedDate": "2020-03-31T15:09:27Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "72f1c7e4f2df34c3cc6bf111fa76238b3eb28c10", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/72f1c7e4f2df34c3cc6bf111fa76238b3eb28c10", "committedDate": "2020-03-31T15:09:27Z", "message": "WIP"}, "afterCommit": {"oid": "2dd275781e529b9ffa7b15aa65a0b126b4ecaf7c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2dd275781e529b9ffa7b15aa65a0b126b4ecaf7c", "committedDate": "2020-03-31T15:16:00Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2dd275781e529b9ffa7b15aa65a0b126b4ecaf7c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2dd275781e529b9ffa7b15aa65a0b126b4ecaf7c", "committedDate": "2020-03-31T15:16:00Z", "message": "WIP"}, "afterCommit": {"oid": "59b5d7c90562539198ef98023340aa330ec17f7f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/59b5d7c90562539198ef98023340aa330ec17f7f", "committedDate": "2020-03-31T15:19:46Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "59b5d7c90562539198ef98023340aa330ec17f7f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/59b5d7c90562539198ef98023340aa330ec17f7f", "committedDate": "2020-03-31T15:19:46Z", "message": "WIP"}, "afterCommit": {"oid": "a01147ec94824cdf6011ff9dbbdf452a8df5ac68", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a01147ec94824cdf6011ff9dbbdf452a8df5ac68", "committedDate": "2020-03-31T15:26:37Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a01147ec94824cdf6011ff9dbbdf452a8df5ac68", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a01147ec94824cdf6011ff9dbbdf452a8df5ac68", "committedDate": "2020-03-31T15:26:37Z", "message": "WIP"}, "afterCommit": {"oid": "e9d3df8281d23979df84d8ca2719578d4bac4d1a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e9d3df8281d23979df84d8ca2719578d4bac4d1a", "committedDate": "2020-03-31T15:29:53Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e9d3df8281d23979df84d8ca2719578d4bac4d1a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e9d3df8281d23979df84d8ca2719578d4bac4d1a", "committedDate": "2020-03-31T15:29:53Z", "message": "WIP"}, "afterCommit": {"oid": "e845518a6e0ba8aeac5d96f57d7202e73d255e5d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e845518a6e0ba8aeac5d96f57d7202e73d255e5d", "committedDate": "2020-03-31T15:46:05Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e845518a6e0ba8aeac5d96f57d7202e73d255e5d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e845518a6e0ba8aeac5d96f57d7202e73d255e5d", "committedDate": "2020-03-31T15:46:05Z", "message": "WIP"}, "afterCommit": {"oid": "3b1d733ff09605f2b11d1e27586e898b4e4008fd", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/3b1d733ff09605f2b11d1e27586e898b4e4008fd", "committedDate": "2020-03-31T15:49:47Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3b1d733ff09605f2b11d1e27586e898b4e4008fd", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/3b1d733ff09605f2b11d1e27586e898b4e4008fd", "committedDate": "2020-03-31T15:49:47Z", "message": "WIP"}, "afterCommit": {"oid": "460e6a0049dfbb90dd09d80101e76d7b57d71bab", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/460e6a0049dfbb90dd09d80101e76d7b57d71bab", "committedDate": "2020-03-31T15:50:50Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "460e6a0049dfbb90dd09d80101e76d7b57d71bab", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/460e6a0049dfbb90dd09d80101e76d7b57d71bab", "committedDate": "2020-03-31T15:50:50Z", "message": "WIP"}, "afterCommit": {"oid": "ecde52bf895a0ebc0ef76f5bb39527da0a2e3031", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ecde52bf895a0ebc0ef76f5bb39527da0a2e3031", "committedDate": "2020-03-31T16:01:19Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ecde52bf895a0ebc0ef76f5bb39527da0a2e3031", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ecde52bf895a0ebc0ef76f5bb39527da0a2e3031", "committedDate": "2020-03-31T16:01:19Z", "message": "WIP"}, "afterCommit": {"oid": "8a853abd254d54358ca28406adba4ba38ecf1a44", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8a853abd254d54358ca28406adba4ba38ecf1a44", "committedDate": "2020-03-31T16:03:40Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8a853abd254d54358ca28406adba4ba38ecf1a44", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8a853abd254d54358ca28406adba4ba38ecf1a44", "committedDate": "2020-03-31T16:03:40Z", "message": "WIP"}, "afterCommit": {"oid": "b9fa250fa55bfd7ca93a4f5e81114184e2698f09", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b9fa250fa55bfd7ca93a4f5e81114184e2698f09", "committedDate": "2020-03-31T16:04:18Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b9fa250fa55bfd7ca93a4f5e81114184e2698f09", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b9fa250fa55bfd7ca93a4f5e81114184e2698f09", "committedDate": "2020-03-31T16:04:18Z", "message": "WIP"}, "afterCommit": {"oid": "34981e604168b187117c6bdcc2307b40c3821c3c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/34981e604168b187117c6bdcc2307b40c3821c3c", "committedDate": "2020-03-31T16:07:38Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "34981e604168b187117c6bdcc2307b40c3821c3c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/34981e604168b187117c6bdcc2307b40c3821c3c", "committedDate": "2020-03-31T16:07:38Z", "message": "WIP"}, "afterCommit": {"oid": "77c365d06e689b05d64ebbe0046167303e41fbfe", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/77c365d06e689b05d64ebbe0046167303e41fbfe", "committedDate": "2020-03-31T16:12:07Z", "message": "WIPTEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "77c365d06e689b05d64ebbe0046167303e41fbfe", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/77c365d06e689b05d64ebbe0046167303e41fbfe", "committedDate": "2020-03-31T16:12:07Z", "message": "WIPTEMP"}, "afterCommit": {"oid": "5d7e1a9eab855dd21dba58289a52203737953980", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5d7e1a9eab855dd21dba58289a52203737953980", "committedDate": "2020-03-31T16:23:12Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d7e1a9eab855dd21dba58289a52203737953980", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5d7e1a9eab855dd21dba58289a52203737953980", "committedDate": "2020-03-31T16:23:12Z", "message": "TEMP"}, "afterCommit": {"oid": "ed31823b6f311cfb1ffb69411f358a4ff94dec00", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ed31823b6f311cfb1ffb69411f358a4ff94dec00", "committedDate": "2020-03-31T16:31:42Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ed31823b6f311cfb1ffb69411f358a4ff94dec00", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ed31823b6f311cfb1ffb69411f358a4ff94dec00", "committedDate": "2020-03-31T16:31:42Z", "message": "TEMP"}, "afterCommit": {"oid": "08eedb8db7e5b13678b9640ded52b0aca1993da4", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/08eedb8db7e5b13678b9640ded52b0aca1993da4", "committedDate": "2020-03-31T17:05:04Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "08eedb8db7e5b13678b9640ded52b0aca1993da4", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/08eedb8db7e5b13678b9640ded52b0aca1993da4", "committedDate": "2020-03-31T17:05:04Z", "message": "TEMP"}, "afterCommit": {"oid": "643907d2a84a0d4fb000228c79b0988bd16ec66f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/643907d2a84a0d4fb000228c79b0988bd16ec66f", "committedDate": "2020-03-31T17:12:00Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "643907d2a84a0d4fb000228c79b0988bd16ec66f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/643907d2a84a0d4fb000228c79b0988bd16ec66f", "committedDate": "2020-03-31T17:12:00Z", "message": "TEMP"}, "afterCommit": {"oid": "20d169b7cc06156e5161530bb6fa6609eed6860d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/20d169b7cc06156e5161530bb6fa6609eed6860d", "committedDate": "2020-03-31T17:17:25Z", "message": "TEMP"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzMwNDEz", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-385330413", "createdAt": "2020-04-01T07:34:12Z", "commit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzozNDoxMlrOF-0Lww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzozNDoxMlrOF-0Lww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxMTAxMQ==", "bodyText": "This should go in the TEMP commit as it won't be needed once https://github.com/nuxeo/nuxeo-helm-chart/pull/8/files is merged and the nuxeo Helm chart is updated.\nIn fact, it would even not be needed in the TEMP commit by following 20d169b#r401406736.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r401411011", "createdAt": "2020-04-01T07:34:12Z", "author": {"login": "ataillefer"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,77 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview\n+  nuxeo:\n+    customParams: |-\n+      elasticsearch.restClient.socketTimeoutMs=300000\n+      elasticsearch.restClient.connectionTimeoutMs=300000\n+    podAnnotations:\n+      preview/scm.ref: $SCM_REF\n+    podLabels:\n+      branch: \"$BRANCH_NAME\"\n+      team: platform\n+      resource: pod\n+      usage: preview\n+    service:\n+      annotations:\n+        fabric8.io/ingress.annotations: |-\n+          nginx.ingress.kubernetes.io/proxy-body-size: 0\n+          nginx.ingress.kubernetes.io/server-snippet: ignore_invalid_headers off;\n+      labels:\n+        branch: \"$BRANCH_NAME\"\n+        team: platform\n+        resource: service\n+        usage: preview\n+    image:\n+      repository: $DOCKER_REGISTRY/nuxeo/nuxeo\n+      tag: $VERSION\n+      pullPolicy: IfNotPresent", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzM1MDQ3", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-385335047", "createdAt": "2020-04-01T07:41:24Z", "commit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo0MToyNFrOF-0bPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo0MToyNFrOF-0bPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxNDk3Mw==", "bodyText": "could be \"preview\" (lowercase, not a title) \ud83d\ude00", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r401414973", "createdAt": "2020-04-01T07:41:24Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +638,72 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo Preview', 'PENDING')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzM1Mzcz", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-385335373", "createdAt": "2020-04-01T07:41:54Z", "commit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo0MTo1NFrOF-0cPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo0MTo1NFrOF-0cPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQxNTIyOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n          \n          \n            \n                          boolean nsExists = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r401415228", "createdAt": "2020-04-01T07:41:54Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +638,72 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzQyODcy", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-385342872", "createdAt": "2020-04-01T07:53:17Z", "commit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo1MzoxN1rOF-00iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo1MzoxN1rOF-00iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQyMTQ0OQ==", "bodyText": "Could you be more explicit?\nExplain that for the reference branches we cannot use jx preview otherwise the preview deployment would be garbage collected.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r401421449", "createdAt": "2020-04-01T07:53:17Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +638,72 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${PREVIEW_NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${PREVIEW_NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // reference branch have a different preview command. The -n name provided must be lowercase.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzQ0MDcz", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-385344073", "createdAt": "2020-04-01T07:55:10Z", "commit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo1NToxMFrOF-04fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo1NToxMFrOF-04fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQyMjQ2Mg==", "bodyText": "Out of curiosity, did you try to use helm install directly instead of jx step helm install?\nIt's worth giving it a try to rely as less as possible on the jx command, since we are already using a mix of pure helm and jx commands.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r401422462", "createdAt": "2020-04-01T07:55:10Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +638,72 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${PREVIEW_NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${PREVIEW_NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // reference branch have a different preview command. The -n name provided must be lowercase.\n+              previewCommand = \"jx step helm install --namespace ${PREVIEW_NAMESPACE} -n ${APP_NAME}-${PREVIEW_NAMESPACE.toLowerCase()} .\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzQ1MTM5", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-385345139", "createdAt": "2020-04-01T07:56:40Z", "commit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo1Njo0MFrOF-072g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwNzo1Njo0MFrOF-072g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQyMzMyMg==", "bodyText": "Same remark as a56c1da#r401422462: would helm build work?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r401423322", "createdAt": "2020-04-01T07:56:40Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +638,72 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${PREVIEW_NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${PREVIEW_NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // reference branch have a different preview command. The -n name provided must be lowercase.\n+              previewCommand = \"jx step helm install --namespace ${PREVIEW_NAMESPACE} -n ${APP_NAME}-${PREVIEW_NAMESPACE.toLowerCase()} .\"\n+              if (isPullRequest()) {\n+                // waiting for https://github.com/jenkins-x/jx/issues/5797 to be fixed in order to remove --source-url\n+                previewCommand = \"jx preview --namespace ${PREVIEW_NAMESPACE} --source-url=https://github.com/nuxeo/nuxeo ${noCommentOpt}\"\n+              }\n+              sh \"\"\"\n+                jx step helm build", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzQ4NTY3", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-385348567", "createdAt": "2020-04-01T08:01:33Z", "commit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODowMTozNFrOF-1GlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODowMTozNFrOF-1GlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQyNjA2OQ==", "bodyText": "Usually, we tend to use either a ternary:\ndef previewCommand = isPullRequest() ?\n  \"jx preview ...\"\n  : \"jx step helm install...\"\n\nor the traditional form:\nif (isPullRequest()) {\n  ...\n} else {\n  ...\n}\n\nIt avoids assigning the variable twice and is easier to read.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r401426069", "createdAt": "2020-04-01T08:01:34Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +638,72 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${PREVIEW_NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${PREVIEW_NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // reference branch have a different preview command. The -n name provided must be lowercase.\n+              previewCommand = \"jx step helm install --namespace ${PREVIEW_NAMESPACE} -n ${APP_NAME}-${PREVIEW_NAMESPACE.toLowerCase()} .\"\n+              if (isPullRequest()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzQ5MjYw", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-385349260", "createdAt": "2020-04-01T08:02:35Z", "commit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODowMjozNVrOF-1ItA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODowMjozNVrOF-1ItA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQyNjYxMg==", "bodyText": "I guess nuxeo-pr-3856 should be ${PREVIEW_NAMESPACE}?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r401426612", "createdAt": "2020-04-01T08:02:35Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +638,72 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${PREVIEW_NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${PREVIEW_NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // reference branch have a different preview command. The -n name provided must be lowercase.\n+              previewCommand = \"jx step helm install --namespace ${PREVIEW_NAMESPACE} -n ${APP_NAME}-${PREVIEW_NAMESPACE.toLowerCase()} .\"\n+              if (isPullRequest()) {\n+                // waiting for https://github.com/jenkins-x/jx/issues/5797 to be fixed in order to remove --source-url\n+                previewCommand = \"jx preview --namespace ${PREVIEW_NAMESPACE} --source-url=https://github.com/nuxeo/nuxeo ${noCommentOpt}\"\n+              }\n+              sh \"\"\"\n+                jx step helm build\n+                mkdir target && helm template . --output-dir target\n+                ${previewCommand}\n+              \"\"\"\n+              if (!isPullRequest()) {\n+                // When not using jx preview, we need to expose the nuxeo url by hand\n+                url = sh(returnStdout: true, script: \"jx get urls -n nuxeo-pr-3856 | grep -oP https://.* | tr -d '\\\\n'\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a56c1daccaf38394bed76fb5471085cf33646b1d"}, "originalPosition": 60}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "20d169b7cc06156e5161530bb6fa6609eed6860d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/20d169b7cc06156e5161530bb6fa6609eed6860d", "committedDate": "2020-03-31T17:17:25Z", "message": "TEMP"}, "afterCommit": {"oid": "a531bb8df4bc641781dce278642649fd30ec36cd", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a531bb8df4bc641781dce278642649fd30ec36cd", "committedDate": "2020-04-01T08:35:11Z", "message": "fixup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a531bb8df4bc641781dce278642649fd30ec36cd", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a531bb8df4bc641781dce278642649fd30ec36cd", "committedDate": "2020-04-01T08:35:11Z", "message": "fixup"}, "afterCommit": {"oid": "4393cfe92cab5668f1c212831b986d9cd73b7ee8", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4393cfe92cab5668f1c212831b986d9cd73b7ee8", "committedDate": "2020-04-01T09:53:55Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4393cfe92cab5668f1c212831b986d9cd73b7ee8", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4393cfe92cab5668f1c212831b986d9cd73b7ee8", "committedDate": "2020-04-01T09:53:55Z", "message": "TEMP"}, "afterCommit": {"oid": "669c7d3875d0c4f8b5ea56e46845aa624b2e8735", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/669c7d3875d0c4f8b5ea56e46845aa624b2e8735", "committedDate": "2020-04-01T10:05:51Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "669c7d3875d0c4f8b5ea56e46845aa624b2e8735", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/669c7d3875d0c4f8b5ea56e46845aa624b2e8735", "committedDate": "2020-04-01T10:05:51Z", "message": "TEMP"}, "afterCommit": {"oid": "ffb547b81c7eb26e82de52d6e1c9b2ee283afcfe", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ffb547b81c7eb26e82de52d6e1c9b2ee283afcfe", "committedDate": "2020-04-01T10:19:29Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ffb547b81c7eb26e82de52d6e1c9b2ee283afcfe", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ffb547b81c7eb26e82de52d6e1c9b2ee283afcfe", "committedDate": "2020-04-01T10:19:29Z", "message": "TEMP"}, "afterCommit": {"oid": "329b5f679b5271ba9b1f69e61a8e91b7a010648b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/329b5f679b5271ba9b1f69e61a8e91b7a010648b", "committedDate": "2020-04-01T10:26:48Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "329b5f679b5271ba9b1f69e61a8e91b7a010648b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/329b5f679b5271ba9b1f69e61a8e91b7a010648b", "committedDate": "2020-04-01T10:26:48Z", "message": "TEMP"}, "afterCommit": {"oid": "4fa78fb6d1fa3646f20ed40327332896627174bb", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4fa78fb6d1fa3646f20ed40327332896627174bb", "committedDate": "2020-04-01T12:24:08Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4fa78fb6d1fa3646f20ed40327332896627174bb", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4fa78fb6d1fa3646f20ed40327332896627174bb", "committedDate": "2020-04-01T12:24:08Z", "message": "TEMP"}, "afterCommit": {"oid": "8ec6472ec6700a04fc3dbc6d94b048aa7f6b6843", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8ec6472ec6700a04fc3dbc6d94b048aa7f6b6843", "committedDate": "2020-04-01T12:28:51Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8ec6472ec6700a04fc3dbc6d94b048aa7f6b6843", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8ec6472ec6700a04fc3dbc6d94b048aa7f6b6843", "committedDate": "2020-04-01T12:28:51Z", "message": "TEMP"}, "afterCommit": {"oid": "291284bfa836200857b2fa1efa9d4647c6585256", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/291284bfa836200857b2fa1efa9d4647c6585256", "committedDate": "2020-04-01T12:44:48Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "291284bfa836200857b2fa1efa9d4647c6585256", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/291284bfa836200857b2fa1efa9d4647c6585256", "committedDate": "2020-04-01T12:44:48Z", "message": "TEMP"}, "afterCommit": {"oid": "d6d8311c1d7da8e32734a87c1f48b9a2fdfea23d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d6d8311c1d7da8e32734a87c1f48b9a2fdfea23d", "committedDate": "2020-04-01T12:59:26Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6d8311c1d7da8e32734a87c1f48b9a2fdfea23d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d6d8311c1d7da8e32734a87c1f48b9a2fdfea23d", "committedDate": "2020-04-01T12:59:26Z", "message": "TEMP"}, "afterCommit": {"oid": "af0a0e42f44f860f35f59d051ec54926543d6d92", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/af0a0e42f44f860f35f59d051ec54926543d6d92", "committedDate": "2020-04-01T15:11:40Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "af0a0e42f44f860f35f59d051ec54926543d6d92", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/af0a0e42f44f860f35f59d051ec54926543d6d92", "committedDate": "2020-04-01T15:11:40Z", "message": "TEMP"}, "afterCommit": {"oid": "4d503e266de485978417dbaba69e8e9809a5f7e9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4d503e266de485978417dbaba69e8e9809a5f7e9", "committedDate": "2020-04-01T15:13:24Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d503e266de485978417dbaba69e8e9809a5f7e9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4d503e266de485978417dbaba69e8e9809a5f7e9", "committedDate": "2020-04-01T15:13:24Z", "message": "TEMP"}, "afterCommit": {"oid": "54624609f93964821c58483185fa2f75d6a3ddbc", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/54624609f93964821c58483185fa2f75d6a3ddbc", "committedDate": "2020-04-01T15:15:32Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "54624609f93964821c58483185fa2f75d6a3ddbc", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/54624609f93964821c58483185fa2f75d6a3ddbc", "committedDate": "2020-04-01T15:15:32Z", "message": "TEMP"}, "afterCommit": {"oid": "6b0f35e10c977cf76ba70d04b718e30045f30469", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6b0f35e10c977cf76ba70d04b718e30045f30469", "committedDate": "2020-04-01T15:50:52Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b0f35e10c977cf76ba70d04b718e30045f30469", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6b0f35e10c977cf76ba70d04b718e30045f30469", "committedDate": "2020-04-01T15:50:52Z", "message": "TEMP"}, "afterCommit": {"oid": "7fb5089c590cdcd92b9e353f6cd3a16a0efe693c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/7fb5089c590cdcd92b9e353f6cd3a16a0efe693c", "committedDate": "2020-04-01T16:06:27Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7fb5089c590cdcd92b9e353f6cd3a16a0efe693c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/7fb5089c590cdcd92b9e353f6cd3a16a0efe693c", "committedDate": "2020-04-01T16:06:27Z", "message": "TEMP"}, "afterCommit": {"oid": "164c8e73d0c711db8434fab1f55f9f135cbb48db", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/164c8e73d0c711db8434fab1f55f9f135cbb48db", "committedDate": "2020-04-01T16:39:03Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "164c8e73d0c711db8434fab1f55f9f135cbb48db", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/164c8e73d0c711db8434fab1f55f9f135cbb48db", "committedDate": "2020-04-01T16:39:03Z", "message": "TEMP"}, "afterCommit": {"oid": "d10c542de8d5ccfbc6ad5e71a59f7529250b3c02", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d10c542de8d5ccfbc6ad5e71a59f7529250b3c02", "committedDate": "2020-04-01T17:07:45Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b022c4ae40ef9378a892217381af877a6f74236", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9b022c4ae40ef9378a892217381af877a6f74236", "committedDate": "2020-04-01T17:18:03Z", "message": "WIP"}, "afterCommit": {"oid": "d37c4616d7d8403725303a9c855f6ca04157e868", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d37c4616d7d8403725303a9c855f6ca04157e868", "committedDate": "2020-04-01T17:32:58Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d37c4616d7d8403725303a9c855f6ca04157e868", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d37c4616d7d8403725303a9c855f6ca04157e868", "committedDate": "2020-04-01T17:32:58Z", "message": "WIP"}, "afterCommit": {"oid": "a4bf51d63b209e9ec9dc4fcb58c9d64b11194f3a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a4bf51d63b209e9ec9dc4fcb58c9d64b11194f3a", "committedDate": "2020-04-01T18:49:34Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a4bf51d63b209e9ec9dc4fcb58c9d64b11194f3a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a4bf51d63b209e9ec9dc4fcb58c9d64b11194f3a", "committedDate": "2020-04-01T18:49:34Z", "message": "WIP"}, "afterCommit": {"oid": "f5b2b0b88a5499c49139a17f2a9830b189b06a8b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f5b2b0b88a5499c49139a17f2a9830b189b06a8b", "committedDate": "2020-04-01T19:04:02Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f5b2b0b88a5499c49139a17f2a9830b189b06a8b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f5b2b0b88a5499c49139a17f2a9830b189b06a8b", "committedDate": "2020-04-01T19:04:02Z", "message": "WIP"}, "afterCommit": {"oid": "47df1cd401bef49444b5f27871950653e866f122", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/47df1cd401bef49444b5f27871950653e866f122", "committedDate": "2020-04-02T09:16:24Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47df1cd401bef49444b5f27871950653e866f122", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/47df1cd401bef49444b5f27871950653e866f122", "committedDate": "2020-04-02T09:16:24Z", "message": "WIP"}, "afterCommit": {"oid": "73e6fba1b33ce424cc3e2e852f0973fb3ea6d783", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/73e6fba1b33ce424cc3e2e852f0973fb3ea6d783", "committedDate": "2020-04-02T09:49:07Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "73e6fba1b33ce424cc3e2e852f0973fb3ea6d783", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/73e6fba1b33ce424cc3e2e852f0973fb3ea6d783", "committedDate": "2020-04-02T09:49:07Z", "message": "WIP"}, "afterCommit": {"oid": "0c3210a1954cefaa2c91f2de07d74cb309ffdfb0", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/0c3210a1954cefaa2c91f2de07d74cb309ffdfb0", "committedDate": "2020-04-02T10:25:22Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0c3210a1954cefaa2c91f2de07d74cb309ffdfb0", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/0c3210a1954cefaa2c91f2de07d74cb309ffdfb0", "committedDate": "2020-04-02T10:25:22Z", "message": "WIP"}, "afterCommit": {"oid": "577d8dc45216e0e8e774c6762ee0ee7c8f02abed", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/577d8dc45216e0e8e774c6762ee0ee7c8f02abed", "committedDate": "2020-04-02T12:13:18Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "577d8dc45216e0e8e774c6762ee0ee7c8f02abed", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/577d8dc45216e0e8e774c6762ee0ee7c8f02abed", "committedDate": "2020-04-02T12:13:18Z", "message": "WIP"}, "afterCommit": {"oid": "faa2b5dc67bd5e9f3817e43117a5ff2e3539cb44", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/faa2b5dc67bd5e9f3817e43117a5ff2e3539cb44", "committedDate": "2020-04-02T12:32:46Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "faa2b5dc67bd5e9f3817e43117a5ff2e3539cb44", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/faa2b5dc67bd5e9f3817e43117a5ff2e3539cb44", "committedDate": "2020-04-02T12:32:46Z", "message": "WIP"}, "afterCommit": {"oid": "03334de1d0057f680d6070fa634b71d0b3150256", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/03334de1d0057f680d6070fa634b71d0b3150256", "committedDate": "2020-04-02T12:45:06Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03334de1d0057f680d6070fa634b71d0b3150256", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/03334de1d0057f680d6070fa634b71d0b3150256", "committedDate": "2020-04-02T12:45:06Z", "message": "WIP"}, "afterCommit": {"oid": "8ced0645ba5f2ed584020f69d1688a49c715836f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8ced0645ba5f2ed584020f69d1688a49c715836f", "committedDate": "2020-04-02T13:18:03Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8ced0645ba5f2ed584020f69d1688a49c715836f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8ced0645ba5f2ed584020f69d1688a49c715836f", "committedDate": "2020-04-02T13:18:03Z", "message": "TEMP"}, "afterCommit": {"oid": "05eb1931bf37609bf9f2fc8f9aebd0a780a74f18", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/05eb1931bf37609bf9f2fc8f9aebd0a780a74f18", "committedDate": "2020-04-02T13:33:16Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05eb1931bf37609bf9f2fc8f9aebd0a780a74f18", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/05eb1931bf37609bf9f2fc8f9aebd0a780a74f18", "committedDate": "2020-04-02T13:33:16Z", "message": "TEMP"}, "afterCommit": {"oid": "9f141d1c47a14fa521fbddf96318e9165472fa96", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9f141d1c47a14fa521fbddf96318e9165472fa96", "committedDate": "2020-04-02T14:19:52Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e3b2d4a0bf04ccd1c458ffbbf5f11a8c0e9da1cf", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e3b2d4a0bf04ccd1c458ffbbf5f11a8c0e9da1cf", "committedDate": "2020-04-02T17:32:53Z", "message": "FIXUP"}, "afterCommit": {"oid": "06f879eb31563fb2a7355cfca9f8c410b00a041e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/06f879eb31563fb2a7355cfca9f8c410b00a041e", "committedDate": "2020-04-02T17:58:54Z", "message": "FIXUP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "06f879eb31563fb2a7355cfca9f8c410b00a041e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/06f879eb31563fb2a7355cfca9f8c410b00a041e", "committedDate": "2020-04-02T17:58:54Z", "message": "FIXUP"}, "afterCommit": {"oid": "ecc736df775259e75a34af60a103d4848cd3fbf5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ecc736df775259e75a34af60a103d4848cd3fbf5", "committedDate": "2020-04-02T18:27:44Z", "message": "FIXUP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ecc736df775259e75a34af60a103d4848cd3fbf5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ecc736df775259e75a34af60a103d4848cd3fbf5", "committedDate": "2020-04-02T18:27:44Z", "message": "FIXUP"}, "afterCommit": {"oid": "dc9019e23bfa7968c879549876e2f06b41fb0acf", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/dc9019e23bfa7968c879549876e2f06b41fb0acf", "committedDate": "2020-04-02T18:42:03Z", "message": "FIXUP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc9019e23bfa7968c879549876e2f06b41fb0acf", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/dc9019e23bfa7968c879549876e2f06b41fb0acf", "committedDate": "2020-04-02T18:42:03Z", "message": "FIXUP"}, "afterCommit": {"oid": "192fbdcd369a76c582f5789538da6947fa9699cc", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/192fbdcd369a76c582f5789538da6947fa9699cc", "committedDate": "2020-04-02T18:52:00Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "192fbdcd369a76c582f5789538da6947fa9699cc", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/192fbdcd369a76c582f5789538da6947fa9699cc", "committedDate": "2020-04-02T18:52:00Z", "message": "WIP"}, "afterCommit": {"oid": "1383e553dcfd5cf81a231f94085ff07265b3a7e5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1383e553dcfd5cf81a231f94085ff07265b3a7e5", "committedDate": "2020-04-02T19:03:30Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1383e553dcfd5cf81a231f94085ff07265b3a7e5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1383e553dcfd5cf81a231f94085ff07265b3a7e5", "committedDate": "2020-04-02T19:03:30Z", "message": "WIP"}, "afterCommit": {"oid": "ce6c33dadac24849c5f8d90844937d4e36a5cd99", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ce6c33dadac24849c5f8d90844937d4e36a5cd99", "committedDate": "2020-04-02T19:34:01Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce6c33dadac24849c5f8d90844937d4e36a5cd99", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ce6c33dadac24849c5f8d90844937d4e36a5cd99", "committedDate": "2020-04-02T19:34:01Z", "message": "TEMP"}, "afterCommit": {"oid": "6de38c3116089a63777635892b0594a4881c3fc2", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6de38c3116089a63777635892b0594a4881c3fc2", "committedDate": "2020-04-02T19:40:22Z", "message": "TEMP"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MDM0OTQ1", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-387034945", "createdAt": "2020-04-03T07:56:05Z", "commit": {"oid": "f070a1efc87cfae8c4de2aae14aa8292d3a96ed2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNzo1NjowNVrOGAJGdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNzo1NjowNVrOGAJGdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjgwMjI5NQ==", "bodyText": "Since we're not using jx preview anymore, can we remove ORG and APP_NAME?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r402802295", "createdAt": "2020-04-03T07:56:05Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -284,6 +284,12 @@ pipeline {\n     CHANGE_BRANCH = \"${env.CHANGE_BRANCH != null ? env.CHANGE_BRANCH : BRANCH_NAME}\"\n     CHANGE_TARGET = \"${env.CHANGE_TARGET != null ? env.CHANGE_TARGET : BRANCH_NAME}\"\n     CONNECT_PREPROD_URL = 'https://nos-preprod-connect.nuxeocloud.com/nuxeo'\n+    // Required by the jx preview command: https://github.com/jenkins-x/jx/blob/8fdc3a1182bc3ed6ae09728721b53ea4fa1d6234/pkg/cmd/preview/preview.go#L1007\n+    ORG = \"nuxeo\"\n+    // Required by the jx preview command: https://github.com/jenkins-x/jx/blob/8fdc3a1182bc3ed6ae09728721b53ea4fa1d6234/pkg/cmd/preview/preview.go#L1015\n+    APP_NAME = \"nuxeo\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f070a1efc87cfae8c4de2aae14aa8292d3a96ed2"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MDM2ODMz", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-387036833", "createdAt": "2020-04-03T07:59:02Z", "commit": {"oid": "f070a1efc87cfae8c4de2aae14aa8292d3a96ed2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNzo1OTowMlrOGAJQlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNzo1OTowMlrOGAJQlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjgwNDg4NA==", "bodyText": "What do think of having \"nuxeo-preview-${BRANCH_NAME.toLowerCase()}\"?\nSo, once it's merged, we have nuxeo-preview-master as a namespace, clearer to identify than just nuxeo-master when looking at the long list of available namespaces in Kubernetes.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r402804884", "createdAt": "2020-04-03T07:59:02Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -284,6 +284,12 @@ pipeline {\n     CHANGE_BRANCH = \"${env.CHANGE_BRANCH != null ? env.CHANGE_BRANCH : BRANCH_NAME}\"\n     CHANGE_TARGET = \"${env.CHANGE_TARGET != null ? env.CHANGE_TARGET : BRANCH_NAME}\"\n     CONNECT_PREPROD_URL = 'https://nos-preprod-connect.nuxeocloud.com/nuxeo'\n+    // Required by the jx preview command: https://github.com/jenkins-x/jx/blob/8fdc3a1182bc3ed6ae09728721b53ea4fa1d6234/pkg/cmd/preview/preview.go#L1007\n+    ORG = \"nuxeo\"\n+    // Required by the jx preview command: https://github.com/jenkins-x/jx/blob/8fdc3a1182bc3ed6ae09728721b53ea4fa1d6234/pkg/cmd/preview/preview.go#L1015\n+    APP_NAME = \"nuxeo\"\n+    PREVIEW_NAMESPACE = \"$APP_NAME-${BRANCH_NAME.toLowerCase()}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f070a1efc87cfae8c4de2aae14aa8292d3a96ed2"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MDM4MjA4", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-387038208", "createdAt": "2020-04-03T08:01:10Z", "commit": {"oid": "f070a1efc87cfae8c4de2aae14aa8292d3a96ed2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwODowMToxMVrOGAJXog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwODowMToxMVrOGAJXog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjgwNjY5MA==", "bodyText": "I think this comment would be more suitable just before the definition of PREVIEW_NAMESPACE where the lowercase is applied, or eventually before  kubectl create namespace, because it is really this instruction that requires lowercase.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r402806690", "createdAt": "2020-04-03T08:01:11Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +638,67 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExists = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExists) {\n+                noCommentOpt = '--no-comment'\n+                // Previous preview deployment needs to be scaled to 0 to be replaced correctly\n+                sh \"kubectl -n ${PREVIEW_NAMESPACE} scale deployment preview --replicas=0\"\n+              } else {\n+                sh \"kubectl create namespace ${PREVIEW_NAMESPACE}\"\n+              }\n+              // third build and deploy the chart\n+              // To avoid jx gc cron job, reference branch previews are deployed by calling jx step helm install\n+              // The -n name provided must be lowercase", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f070a1efc87cfae8c4de2aae14aa8292d3a96ed2"}, "originalPosition": 49}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6de38c3116089a63777635892b0594a4881c3fc2", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6de38c3116089a63777635892b0594a4881c3fc2", "committedDate": "2020-04-02T19:40:22Z", "message": "TEMP"}, "afterCommit": {"oid": "32c152233be61b4c91f63b651f3da9491113c925", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/32c152233be61b4c91f63b651f3da9491113c925", "committedDate": "2020-04-04T06:51:18Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd430ba77d73fa915797769fd20583d90bca6a62", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/fd430ba77d73fa915797769fd20583d90bca6a62", "committedDate": "2020-04-04T07:07:00Z", "message": "WIP"}, "afterCommit": {"oid": "2986b3235109ae9f9369966ec4622387909e6827", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2986b3235109ae9f9369966ec4622387909e6827", "committedDate": "2020-04-04T07:23:22Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2986b3235109ae9f9369966ec4622387909e6827", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2986b3235109ae9f9369966ec4622387909e6827", "committedDate": "2020-04-04T07:23:22Z", "message": "TEMP"}, "afterCommit": {"oid": "6f62dd4d388b2321bf644806f209e4a51ab77a44", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6f62dd4d388b2321bf644806f209e4a51ab77a44", "committedDate": "2020-04-04T07:28:15Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f62dd4d388b2321bf644806f209e4a51ab77a44", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6f62dd4d388b2321bf644806f209e4a51ab77a44", "committedDate": "2020-04-04T07:28:15Z", "message": "TEMP"}, "afterCommit": {"oid": "b03a91c37555e2538dee26c20c3ed6f6fe49880c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b03a91c37555e2538dee26c20c3ed6f6fe49880c", "committedDate": "2020-04-04T07:30:45Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b03a91c37555e2538dee26c20c3ed6f6fe49880c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b03a91c37555e2538dee26c20c3ed6f6fe49880c", "committedDate": "2020-04-04T07:30:45Z", "message": "TEMP"}, "afterCommit": {"oid": "5443cce814413d0f54f29766521de59abffcc44d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5443cce814413d0f54f29766521de59abffcc44d", "committedDate": "2020-04-04T08:57:32Z", "message": "TEMP"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Njk3NjQ4", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-387697648", "createdAt": "2020-04-04T13:02:26Z", "commit": {"oid": "5443cce814413d0f54f29766521de59abffcc44d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxMzowMjoyNlrOGAxuLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxMzowMjoyNlrOGAxuLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ2NzgyMQ==", "bodyText": "I believe that jx step helm install creates the namespace if it doesn't exist, so this might be useles..", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r403467821", "createdAt": "2020-04-04T13:02:26Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,8 +648,71 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      /*\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      */\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExists = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExists) {\n+                noCommentOpt = '--no-comment'\n+                // Previous preview deployment needs to be scaled to 0 to be replaced correctly\n+                sh \"kubectl -n ${PREVIEW_NAMESPACE} scale deployment nuxeo-preview --replicas=0\"\n+              } else {\n+                sh \"kubectl create namespace ${PREVIEW_NAMESPACE}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5443cce814413d0f54f29766521de59abffcc44d"}, "originalPosition": 154}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Njk3Nzk3", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-387697797", "createdAt": "2020-04-04T13:04:47Z", "commit": {"oid": "5443cce814413d0f54f29766521de59abffcc44d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxMzowNDo0N1rOGAxvHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxMzowNDo0N1rOGAxvHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ2ODA2Mg==", "bodyText": "I would suggest to always use the - or the -- syntax for options, at least in the same command.\nSo: jx step helm install --namespace xxx --name yyy.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r403468062", "createdAt": "2020-04-04T13:04:47Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,8 +648,71 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      /*\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      */\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              boolean nsExists = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExists) {\n+                noCommentOpt = '--no-comment'\n+                // Previous preview deployment needs to be scaled to 0 to be replaced correctly\n+                sh \"kubectl -n ${PREVIEW_NAMESPACE} scale deployment nuxeo-preview --replicas=0\"\n+              } else {\n+                sh \"kubectl create namespace ${PREVIEW_NAMESPACE}\"\n+              }\n+              // third build and deploy the chart\n+              // To avoid jx gc cron job, reference branch previews are deployed by calling jx step helm install\n+              sh \"\"\"\n+                jx step helm build\n+                mkdir target && helm template . --output-dir target\n+                jx step helm install --namespace ${PREVIEW_NAMESPACE} -n ${PREVIEW_NAMESPACE} .", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5443cce814413d0f54f29766521de59abffcc44d"}, "originalPosition": 161}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Njk4MDAw", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-387698000", "createdAt": "2020-04-04T13:07:40Z", "commit": {"oid": "5443cce814413d0f54f29766521de59abffcc44d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxMzowNzo0MFrOGAxwGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQxMzowNzo0MFrOGAxwGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ2ODMxMw==", "bodyText": "more precisely the --name and --namespace options", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r403468313", "createdAt": "2020-04-04T13:07:40Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -279,11 +279,14 @@ pipeline {\n     PUBLIC_DOCKER_REGISTRY = 'docker.packages.nuxeo.com'\n     MAVEN_OPTS = \"$MAVEN_OPTS -Xms512m -Xmx3072m\"\n     MAVEN_ARGS = getMavenArgs()\n-    VERSION = getVersion()\n+    VERSION = \"11.x\"\n     DOCKER_TAG = getDockerTagFrom(\"${VERSION}\")\n     CHANGE_BRANCH = \"${env.CHANGE_BRANCH != null ? env.CHANGE_BRANCH : BRANCH_NAME}\"\n     CHANGE_TARGET = \"${env.CHANGE_TARGET != null ? env.CHANGE_TARGET : BRANCH_NAME}\"\n     CONNECT_PREPROD_URL = 'https://nos-preprod-connect.nuxeocloud.com/nuxeo'\n+    // jx step helm install's -n option requires the name provided to be lowercase", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5443cce814413d0f54f29766521de59abffcc44d"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5443cce814413d0f54f29766521de59abffcc44d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5443cce814413d0f54f29766521de59abffcc44d", "committedDate": "2020-04-04T08:57:32Z", "message": "TEMP"}, "afterCommit": {"oid": "2ca863d292185c4b2a4347da99c78eb1142905ef", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2ca863d292185c4b2a4347da99c78eb1142905ef", "committedDate": "2020-04-04T20:03:16Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ca863d292185c4b2a4347da99c78eb1142905ef", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2ca863d292185c4b2a4347da99c78eb1142905ef", "committedDate": "2020-04-04T20:03:16Z", "message": "TEMP"}, "afterCommit": {"oid": "52cbc7d1f29b10265cff91adcb154d4eb54e4d65", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/52cbc7d1f29b10265cff91adcb154d4eb54e4d65", "committedDate": "2020-04-06T13:39:24Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "52cbc7d1f29b10265cff91adcb154d4eb54e4d65", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/52cbc7d1f29b10265cff91adcb154d4eb54e4d65", "committedDate": "2020-04-06T13:39:24Z", "message": "TEMP"}, "afterCommit": {"oid": "83ef45fb19ad3b6cffc136ee22c38d4912d0466f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/83ef45fb19ad3b6cffc136ee22c38d4912d0466f", "committedDate": "2020-04-06T14:21:13Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83ef45fb19ad3b6cffc136ee22c38d4912d0466f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/83ef45fb19ad3b6cffc136ee22c38d4912d0466f", "committedDate": "2020-04-06T14:21:13Z", "message": "TEMP"}, "afterCommit": {"oid": "e1fd8d9c2ee4dffa14ebfdd23526d11ed511292f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e1fd8d9c2ee4dffa14ebfdd23526d11ed511292f", "committedDate": "2020-04-06T18:11:56Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e1fd8d9c2ee4dffa14ebfdd23526d11ed511292f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e1fd8d9c2ee4dffa14ebfdd23526d11ed511292f", "committedDate": "2020-04-06T18:11:56Z", "message": "TEMP"}, "afterCommit": {"oid": "f8432d29ef6c86c89e7596c9fcd71f403df39600", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f8432d29ef6c86c89e7596c9fcd71f403df39600", "committedDate": "2020-04-06T13:38:27Z", "message": "NXP-27713: deploy a preview env for reference branches"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NTI2NzYz", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-388526763", "createdAt": "2020-04-06T18:51:14Z", "commit": {"oid": "f8432d29ef6c86c89e7596c9fcd71f403df39600"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxODo1MToxNVrOGBlYFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxODo1MToxNVrOGBlYFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMxNDEzMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                replicator.v1.mittwald.de/replicate-from: platform-staging/nexus-docker-cfg\n          \n          \n            \n                replicator.v1.mittwald.de/replicate-from: platform/nexus-docker-cfg", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r404314133", "createdAt": "2020-04-06T18:51:15Z", "author": {"login": "ataillefer"}, "path": "ci/helm/preview/templates/empty-docker-secret-for-kubernetes-replicator.yaml", "diffHunk": "@@ -0,0 +1,9 @@\n+apiVersion: v1\n+kind: Secret\n+metadata:\n+  name: nexus-docker-cfg\n+  annotations:\n+    replicator.v1.mittwald.de/replicate-from: platform-staging/nexus-docker-cfg", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8432d29ef6c86c89e7596c9fcd71f403df39600"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f8432d29ef6c86c89e7596c9fcd71f403df39600", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f8432d29ef6c86c89e7596c9fcd71f403df39600", "committedDate": "2020-04-06T13:38:27Z", "message": "NXP-27713: deploy a preview env for reference branches"}, "afterCommit": {"oid": "5fa06cf79725c984b365e0fd9ebd09d8bbcce431", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5fa06cf79725c984b365e0fd9ebd09d8bbcce431", "committedDate": "2020-04-06T19:34:07Z", "message": "NXP-27713: deploy a preview env for reference branches"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5fa06cf79725c984b365e0fd9ebd09d8bbcce431", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5fa06cf79725c984b365e0fd9ebd09d8bbcce431", "committedDate": "2020-04-06T19:34:07Z", "message": "NXP-27713: deploy a preview env for reference branches"}, "afterCommit": {"oid": "83964ce276df7e7bf6cbdda3c483e15dedff7384", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/83964ce276df7e7bf6cbdda3c483e15dedff7384", "committedDate": "2020-04-06T20:23:20Z", "message": "NXP-27713: deploy a preview env for reference branches"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NTkwMjk1", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-388590295", "createdAt": "2020-04-06T20:25:50Z", "commit": {"oid": "83964ce276df7e7bf6cbdda3c483e15dedff7384"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MDk4Mjgx", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-389098281", "createdAt": "2020-04-07T13:10:07Z", "commit": {"oid": "83964ce276df7e7bf6cbdda3c483e15dedff7384"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMzoxMDowN1rOGCCvzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMzoxMTozNVrOGCCzlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc5NTM0Mg==", "bodyText": "noCommentOpt is unused?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r404795342", "createdAt": "2020-04-07T13:10:07Z", "author": {"login": "kevinleturc"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +635,63 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview', 'Deploy nuxeo preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute environment variables in chart values\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            script {\n+              boolean nsExists = sh(returnStatus: true, script: \"kubectl get namespace ${PREVIEW_NAMESPACE}\") == 0\n+              String noCommentOpt = '';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83964ce276df7e7bf6cbdda3c483e15dedff7384"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc5NjMxMA==", "bodyText": "unused?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r404796310", "createdAt": "2020-04-07T13:11:35Z", "author": {"login": "kevinleturc"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,71 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: nuxeo-preview\n+  nuxeo:\n+    customParams: |-\n+      elasticsearch.restClient.socketTimeoutMs=300000\n+      elasticsearch.restClient.connectionTimeoutMs=300000\n+    podAnnotations:\n+      preview/scm.ref: $SCM_REF", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83964ce276df7e7bf6cbdda3c483e15dedff7384"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c95b57f21f4fdace355838e46cd8dc75230db3a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5c95b57f21f4fdace355838e46cd8dc75230db3a", "committedDate": "2020-04-07T13:25:53Z", "message": "NXP-27713: deploy a preview env for reference branches"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83964ce276df7e7bf6cbdda3c483e15dedff7384", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/83964ce276df7e7bf6cbdda3c483e15dedff7384", "committedDate": "2020-04-06T20:23:20Z", "message": "NXP-27713: deploy a preview env for reference branches"}, "afterCommit": {"oid": "5c95b57f21f4fdace355838e46cd8dc75230db3a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5c95b57f21f4fdace355838e46cd8dc75230db3a", "committedDate": "2020-04-07T13:25:53Z", "message": "NXP-27713: deploy a preview env for reference branches"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MTYwNDg3", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-389160487", "createdAt": "2020-04-07T14:16:07Z", "commit": {"oid": "5c95b57f21f4fdace355838e46cd8dc75230db3a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NzI0MTkz", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-389724193", "createdAt": "2020-04-08T07:40:32Z", "commit": {"oid": "5c95b57f21f4fdace355838e46cd8dc75230db3a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cab0316207dded9447c863e44c3bc65dcd500223", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cab0316207dded9447c863e44c3bc65dcd500223", "committedDate": "2020-03-24T08:59:31Z", "message": "TEMP"}, "afterCommit": {"oid": "f690baabf871156ef918f2463bc61fa833ed3f3c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f690baabf871156ef918f2463bc61fa833ed3f3c", "committedDate": "2020-03-24T13:52:36Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f690baabf871156ef918f2463bc61fa833ed3f3c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f690baabf871156ef918f2463bc61fa833ed3f3c", "committedDate": "2020-03-24T13:52:36Z", "message": "TEMP"}, "afterCommit": {"oid": "bee3c8ac4d3914bbc96a95d5cde9eff25599bb37", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/bee3c8ac4d3914bbc96a95d5cde9eff25599bb37", "committedDate": "2020-03-24T13:54:24Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bee3c8ac4d3914bbc96a95d5cde9eff25599bb37", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/bee3c8ac4d3914bbc96a95d5cde9eff25599bb37", "committedDate": "2020-03-24T13:54:24Z", "message": "TEMP"}, "afterCommit": {"oid": "12e628c5e99ccfe8ad877766dcaedabf3a67e3e1", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/12e628c5e99ccfe8ad877766dcaedabf3a67e3e1", "committedDate": "2020-03-24T14:06:43Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8f5450853da8d3fcacd224a9cc5d206c5c608d7", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b8f5450853da8d3fcacd224a9cc5d206c5c608d7", "committedDate": "2020-03-24T14:19:55Z", "message": "TEMP 2"}, "afterCommit": {"oid": "b8b657ed8b25dd6402ce6bbdc972858e72298a0e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b8b657ed8b25dd6402ce6bbdc972858e72298a0e", "committedDate": "2020-03-24T14:26:36Z", "message": "TEMP 2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8b657ed8b25dd6402ce6bbdc972858e72298a0e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b8b657ed8b25dd6402ce6bbdc972858e72298a0e", "committedDate": "2020-03-24T14:26:36Z", "message": "TEMP 2"}, "afterCommit": {"oid": "418916dd46d9e5edeb48cc30860a5a50ec9bb81c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/418916dd46d9e5edeb48cc30860a5a50ec9bb81c", "committedDate": "2020-03-24T14:30:38Z", "message": "TEMP 2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "418916dd46d9e5edeb48cc30860a5a50ec9bb81c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/418916dd46d9e5edeb48cc30860a5a50ec9bb81c", "committedDate": "2020-03-24T14:30:38Z", "message": "TEMP 2"}, "afterCommit": {"oid": "aef314da91235ae64604c7046a086bcd4c673de6", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/aef314da91235ae64604c7046a086bcd4c673de6", "committedDate": "2020-03-24T14:33:14Z", "message": "TEMP 2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aef314da91235ae64604c7046a086bcd4c673de6", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/aef314da91235ae64604c7046a086bcd4c673de6", "committedDate": "2020-03-24T14:33:14Z", "message": "TEMP 2"}, "afterCommit": {"oid": "4c1b2b0893fe899a1d2bfabaf1c20e996cc872ce", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4c1b2b0893fe899a1d2bfabaf1c20e996cc872ce", "committedDate": "2020-03-24T14:36:20Z", "message": "TEMP 2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c1b2b0893fe899a1d2bfabaf1c20e996cc872ce", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4c1b2b0893fe899a1d2bfabaf1c20e996cc872ce", "committedDate": "2020-03-24T14:36:20Z", "message": "TEMP 2"}, "afterCommit": {"oid": "c7a7f21f777d04f013cee4848f8dbe0954ea9185", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c7a7f21f777d04f013cee4848f8dbe0954ea9185", "committedDate": "2020-03-24T14:41:38Z", "message": "TEMP 2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c7a7f21f777d04f013cee4848f8dbe0954ea9185", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c7a7f21f777d04f013cee4848f8dbe0954ea9185", "committedDate": "2020-03-24T14:41:38Z", "message": "TEMP 2"}, "afterCommit": {"oid": "d877626ac43a36c9f15ea903fb5709ffcd7d399c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d877626ac43a36c9f15ea903fb5709ffcd7d399c", "committedDate": "2020-03-24T14:48:47Z", "message": "TEMP 2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f264f61b27712ad3b6939a1d475f7e79cc458c5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4f264f61b27712ad3b6939a1d475f7e79cc458c5", "committedDate": "2020-03-24T14:52:48Z", "message": "fixup"}, "afterCommit": {"oid": "3a08dfc33e303074b39cd9e5a124a1dc0ec33650", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/3a08dfc33e303074b39cd9e5a124a1dc0ec33650", "committedDate": "2020-03-24T15:48:30Z", "message": "fixup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3a08dfc33e303074b39cd9e5a124a1dc0ec33650", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/3a08dfc33e303074b39cd9e5a124a1dc0ec33650", "committedDate": "2020-03-24T15:48:30Z", "message": "fixup"}, "afterCommit": {"oid": "e6590e7f90947d91864f5deef0e7dc851f8c3ce3", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e6590e7f90947d91864f5deef0e7dc851f8c3ce3", "committedDate": "2020-03-24T16:43:11Z", "message": "fixup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e6590e7f90947d91864f5deef0e7dc851f8c3ce3", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e6590e7f90947d91864f5deef0e7dc851f8c3ce3", "committedDate": "2020-03-24T16:43:11Z", "message": "fixup"}, "afterCommit": {"oid": "c0dbcca20f848670028d5997ef5cb800a5525f63", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c0dbcca20f848670028d5997ef5cb800a5525f63", "committedDate": "2020-03-24T16:50:06Z", "message": "fixup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c0dbcca20f848670028d5997ef5cb800a5525f63", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c0dbcca20f848670028d5997ef5cb800a5525f63", "committedDate": "2020-03-24T16:50:06Z", "message": "fixup"}, "afterCommit": {"oid": "34d9bfbadca39eacdfa116d7e658f8bde5d9ec4f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/34d9bfbadca39eacdfa116d7e658f8bde5d9ec4f", "committedDate": "2020-03-24T16:59:08Z", "message": "fixup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "34d9bfbadca39eacdfa116d7e658f8bde5d9ec4f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/34d9bfbadca39eacdfa116d7e658f8bde5d9ec4f", "committedDate": "2020-03-24T16:59:08Z", "message": "fixup"}, "afterCommit": {"oid": "fc09624d63d61ff06893ab3ef107bcbafff527e9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/fc09624d63d61ff06893ab3ef107bcbafff527e9", "committedDate": "2020-03-24T17:17:07Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f18a673464252824e29fdd0ca8ce8f7ca761eb01", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f18a673464252824e29fdd0ca8ce8f7ca761eb01", "committedDate": "2020-03-24T17:33:57Z", "message": "TEMP2"}, "afterCommit": {"oid": "6296607bdb57c190951b85d001cdd986f88a35f2", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6296607bdb57c190951b85d001cdd986f88a35f2", "committedDate": "2020-03-24T17:38:34Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6296607bdb57c190951b85d001cdd986f88a35f2", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6296607bdb57c190951b85d001cdd986f88a35f2", "committedDate": "2020-03-24T17:38:34Z", "message": "TEMP2"}, "afterCommit": {"oid": "234b12f2b7fd74360bb79222f158edd88faa8afb", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/234b12f2b7fd74360bb79222f158edd88faa8afb", "committedDate": "2020-03-24T17:52:34Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "234b12f2b7fd74360bb79222f158edd88faa8afb", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/234b12f2b7fd74360bb79222f158edd88faa8afb", "committedDate": "2020-03-24T17:52:34Z", "message": "TEMP2"}, "afterCommit": {"oid": "c93b42833a3b71885844588148c7719286f30e9e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c93b42833a3b71885844588148c7719286f30e9e", "committedDate": "2020-03-24T18:47:11Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c93b42833a3b71885844588148c7719286f30e9e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c93b42833a3b71885844588148c7719286f30e9e", "committedDate": "2020-03-24T18:47:11Z", "message": "TEMP2"}, "afterCommit": {"oid": "b9251449c4b8da02be0e0ff416c2a379b0cf229f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b9251449c4b8da02be0e0ff416c2a379b0cf229f", "committedDate": "2020-03-24T20:40:24Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce6f95a33c6f70ce328e05cdd966de49403c580d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ce6f95a33c6f70ce328e05cdd966de49403c580d", "committedDate": "2020-03-24T21:10:59Z", "message": "TEMP3"}, "afterCommit": {"oid": "4a8d8598dee8e3784225ff89c5ced0670427e6b5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4a8d8598dee8e3784225ff89c5ced0670427e6b5", "committedDate": "2020-03-24T21:48:02Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a8d8598dee8e3784225ff89c5ced0670427e6b5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4a8d8598dee8e3784225ff89c5ced0670427e6b5", "committedDate": "2020-03-24T21:48:02Z", "message": "TEMP"}, "afterCommit": {"oid": "c9842e949ba1209796e9c2582e46989ce3786a5e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c9842e949ba1209796e9c2582e46989ce3786a5e", "committedDate": "2020-03-24T21:56:37Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9842e949ba1209796e9c2582e46989ce3786a5e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c9842e949ba1209796e9c2582e46989ce3786a5e", "committedDate": "2020-03-24T21:56:37Z", "message": "TEMP"}, "afterCommit": {"oid": "4f24571e31d2ab3ab517cf870105d192ed369a1c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4f24571e31d2ab3ab517cf870105d192ed369a1c", "committedDate": "2020-03-24T22:06:23Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4f24571e31d2ab3ab517cf870105d192ed369a1c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4f24571e31d2ab3ab517cf870105d192ed369a1c", "committedDate": "2020-03-24T22:06:23Z", "message": "TEMP"}, "afterCommit": {"oid": "2dcc3c544f3e299cf106199868684f081ddc197a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2dcc3c544f3e299cf106199868684f081ddc197a", "committedDate": "2020-03-24T22:21:08Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2dcc3c544f3e299cf106199868684f081ddc197a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2dcc3c544f3e299cf106199868684f081ddc197a", "committedDate": "2020-03-24T22:21:08Z", "message": "TEMP"}, "afterCommit": {"oid": "588c5a27826aefc9a906cc5d90697897b66b113e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/588c5a27826aefc9a906cc5d90697897b66b113e", "committedDate": "2020-03-25T08:13:10Z", "message": "TEMP"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwOTcwNjI2", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-380970626", "createdAt": "2020-03-25T09:17:41Z", "commit": {"oid": "ae9ec87d9038d4e3714d558dff94fa4b98367caf"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwOToxNzo0MVrOF7SCmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQwOToyMjozMlrOF7SOPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcwNTg4Mw==", "bodyText": "Use the same when as other stages:\nwhen {\n        not {\n          branch 'PR-*'\n        }\n      }", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r397705883", "createdAt": "2020-03-25T09:17:41Z", "author": {"login": "troger"}, "path": "Jenkinsfile", "diffHunk": "@@ -631,6 +636,77 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        branch \"${REFERENCE_BRANCH}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae9ec87d9038d4e3714d558dff94fa4b98367caf"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcwNjIyNQ==", "bodyText": "No need for this var, either it's a PR, either it's a reference branch.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r397706225", "createdAt": "2020-03-25T09:18:12Z", "author": {"login": "troger"}, "path": "Jenkinsfile", "diffHunk": "@@ -282,6 +282,11 @@ pipeline {\n     DOCKER_TAG = getDockerTagFrom(\"${VERSION}\")\n     CHANGE_BRANCH = \"${env.CHANGE_BRANCH != null ? env.CHANGE_BRANCH : BRANCH_NAME}\"\n     CHANGE_TARGET = \"${env.CHANGE_TARGET != null ? env.CHANGE_TARGET : BRANCH_NAME}\"\n+    ORG = \"nuxeo\"\n+    APP_NAME = \"nuxeo\"\n+    NAMESPACE = \"$APP_NAME-${BRANCH_NAME.toLowerCase()}\"\n+    REFERENCE_BRANCH = \"master\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae9ec87d9038d4e3714d558dff94fa4b98367caf"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcwNjg2Nw==", "bodyText": "Images are already built by another stage \"Build Docker images\", no need to build them again...", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r397706867", "createdAt": "2020-03-25T09:19:12Z", "author": {"login": "troger"}, "path": "Jenkinsfile", "diffHunk": "@@ -631,6 +636,77 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        branch \"${REFERENCE_BRANCH}\"\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('docker/nuxeo') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Build Nuxeo preview image", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae9ec87d9038d4e3714d558dff94fa4b98367caf"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcwODg2Mw==", "bodyText": "All the preview folder should go in the already existing ci/helm/ folder, no need to create a new helm folder at the root.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r397708863", "createdAt": "2020-03-25T09:22:32Z", "author": {"login": "troger"}, "path": "helm/preview/Chart.yaml", "diffHunk": "@@ -0,0 +1,5 @@\n+apiVersion: v1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae9ec87d9038d4e3714d558dff94fa4b98367caf"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "588c5a27826aefc9a906cc5d90697897b66b113e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/588c5a27826aefc9a906cc5d90697897b66b113e", "committedDate": "2020-03-25T08:13:10Z", "message": "TEMP"}, "afterCommit": {"oid": "333d9aabbe5062f8a641e917bde158560c5cc655", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/333d9aabbe5062f8a641e917bde158560c5cc655", "committedDate": "2020-03-25T14:20:06Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "333d9aabbe5062f8a641e917bde158560c5cc655", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/333d9aabbe5062f8a641e917bde158560c5cc655", "committedDate": "2020-03-25T14:20:06Z", "message": "TEMP2"}, "afterCommit": {"oid": "1645929f906fba4a461f4a24e5be4255a55b773d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1645929f906fba4a461f4a24e5be4255a55b773d", "committedDate": "2020-03-25T16:36:31Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1645929f906fba4a461f4a24e5be4255a55b773d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1645929f906fba4a461f4a24e5be4255a55b773d", "committedDate": "2020-03-25T16:36:31Z", "message": "TEMP2"}, "afterCommit": {"oid": "78431937f3530ac02fe7fd169cdf36de2d6c0aa4", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/78431937f3530ac02fe7fd169cdf36de2d6c0aa4", "committedDate": "2020-03-25T17:13:28Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "78431937f3530ac02fe7fd169cdf36de2d6c0aa4", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/78431937f3530ac02fe7fd169cdf36de2d6c0aa4", "committedDate": "2020-03-25T17:13:28Z", "message": "TEMP2"}, "afterCommit": {"oid": "22007f729b6dff23175bf76b0fae5eda855d519c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/22007f729b6dff23175bf76b0fae5eda855d519c", "committedDate": "2020-03-25T18:59:54Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8b4022d0344ee794e864227ca21b75646f23cd9d", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8b4022d0344ee794e864227ca21b75646f23cd9d", "committedDate": "2020-03-26T09:12:33Z", "message": "TEMP3"}, "afterCommit": {"oid": "e791d186a44dc3c0ee5f6d378a2ad53a59ca8ea8", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e791d186a44dc3c0ee5f6d378a2ad53a59ca8ea8", "committedDate": "2020-03-26T09:36:37Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1cbcb33399c50b66ddd674fd368fbd8ed3c231bf", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1cbcb33399c50b66ddd674fd368fbd8ed3c231bf", "committedDate": "2020-03-26T10:41:58Z", "message": "TEMP4"}, "afterCommit": {"oid": "c2ffc41fc2abd57eb4334132cb734468649ece15", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c2ffc41fc2abd57eb4334132cb734468649ece15", "committedDate": "2020-03-25T13:16:56Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2fd89f09242f23ae453ee332d1b11bcf3bbdd3b9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2fd89f09242f23ae453ee332d1b11bcf3bbdd3b9", "committedDate": "2020-03-26T14:29:10Z", "message": "TEMP2"}, "afterCommit": {"oid": "dd26e58a8b98477759a840dabcfa777777aa81ea", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/dd26e58a8b98477759a840dabcfa777777aa81ea", "committedDate": "2020-03-26T14:31:28Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dd26e58a8b98477759a840dabcfa777777aa81ea", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/dd26e58a8b98477759a840dabcfa777777aa81ea", "committedDate": "2020-03-26T14:31:28Z", "message": "TEMP2"}, "afterCommit": {"oid": "8aeca93345cc7f858b11a2020ddff85f9f93d671", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8aeca93345cc7f858b11a2020ddff85f9f93d671", "committedDate": "2020-03-26T14:39:56Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6de365407715e45eb930841f9695f20688d239fe", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/6de365407715e45eb930841f9695f20688d239fe", "committedDate": "2020-03-26T16:27:22Z", "message": "TEMP2"}, "afterCommit": {"oid": "4523fe5c4eaeba224108ecba2c589129aed34073", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4523fe5c4eaeba224108ecba2c589129aed34073", "committedDate": "2020-03-26T16:29:22Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4523fe5c4eaeba224108ecba2c589129aed34073", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4523fe5c4eaeba224108ecba2c589129aed34073", "committedDate": "2020-03-26T16:29:22Z", "message": "TEMP2"}, "afterCommit": {"oid": "8833f171416b1b797dda500d70a7178ea62fe90f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8833f171416b1b797dda500d70a7178ea62fe90f", "committedDate": "2020-03-26T18:05:22Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8833f171416b1b797dda500d70a7178ea62fe90f", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8833f171416b1b797dda500d70a7178ea62fe90f", "committedDate": "2020-03-26T18:05:22Z", "message": "TEMP2"}, "afterCommit": {"oid": "b53d7c61157e363fdcef8b95eb62c1dbb26ace77", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b53d7c61157e363fdcef8b95eb62c1dbb26ace77", "committedDate": "2020-03-26T18:07:07Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b53d7c61157e363fdcef8b95eb62c1dbb26ace77", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b53d7c61157e363fdcef8b95eb62c1dbb26ace77", "committedDate": "2020-03-26T18:07:07Z", "message": "TEMP2"}, "afterCommit": {"oid": "7fb98e2b82dbf90eb6ab69b577e98a04a5277bfb", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/7fb98e2b82dbf90eb6ab69b577e98a04a5277bfb", "committedDate": "2020-03-26T18:11:46Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7fb98e2b82dbf90eb6ab69b577e98a04a5277bfb", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/7fb98e2b82dbf90eb6ab69b577e98a04a5277bfb", "committedDate": "2020-03-26T18:11:46Z", "message": "TEMP2"}, "afterCommit": {"oid": "67d17114e7d6ccbbc0f2cd64da5898a728fa220a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/67d17114e7d6ccbbc0f2cd64da5898a728fa220a", "committedDate": "2020-03-26T18:17:25Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "67d17114e7d6ccbbc0f2cd64da5898a728fa220a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/67d17114e7d6ccbbc0f2cd64da5898a728fa220a", "committedDate": "2020-03-26T18:17:25Z", "message": "TEMP2"}, "afterCommit": {"oid": "1cf522575ee21be955a452f5ebdb3f1d7826df91", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1cf522575ee21be955a452f5ebdb3f1d7826df91", "committedDate": "2020-03-26T18:48:14Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1cf522575ee21be955a452f5ebdb3f1d7826df91", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1cf522575ee21be955a452f5ebdb3f1d7826df91", "committedDate": "2020-03-26T18:48:14Z", "message": "TEMP2"}, "afterCommit": {"oid": "743faa5ffb22c3ce0c7a69e33916a58c84d9528b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/743faa5ffb22c3ce0c7a69e33916a58c84d9528b", "committedDate": "2020-03-26T20:30:44Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "743faa5ffb22c3ce0c7a69e33916a58c84d9528b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/743faa5ffb22c3ce0c7a69e33916a58c84d9528b", "committedDate": "2020-03-26T20:30:44Z", "message": "TEMP2"}, "afterCommit": {"oid": "ca0fd09a8cbeb7581f55a3b8ce3b3aff30c74a52", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ca0fd09a8cbeb7581f55a3b8ce3b3aff30c74a52", "committedDate": "2020-03-26T20:38:04Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca0fd09a8cbeb7581f55a3b8ce3b3aff30c74a52", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ca0fd09a8cbeb7581f55a3b8ce3b3aff30c74a52", "committedDate": "2020-03-26T20:38:04Z", "message": "TEMP2"}, "afterCommit": {"oid": "310c4550916b0b86aaf3dc92426ff266894262c2", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/310c4550916b0b86aaf3dc92426ff266894262c2", "committedDate": "2020-03-26T20:42:50Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "310c4550916b0b86aaf3dc92426ff266894262c2", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/310c4550916b0b86aaf3dc92426ff266894262c2", "committedDate": "2020-03-26T20:42:50Z", "message": "TEMP2"}, "afterCommit": {"oid": "bb230edbed628403194a68b800b3009e78c1db56", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/bb230edbed628403194a68b800b3009e78c1db56", "committedDate": "2020-03-26T20:50:07Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb230edbed628403194a68b800b3009e78c1db56", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/bb230edbed628403194a68b800b3009e78c1db56", "committedDate": "2020-03-26T20:50:07Z", "message": "TEMP2"}, "afterCommit": {"oid": "9b89a47016e0df06d86e32cf1950def62fb879ea", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9b89a47016e0df06d86e32cf1950def62fb879ea", "committedDate": "2020-03-26T21:35:39Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b89a47016e0df06d86e32cf1950def62fb879ea", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9b89a47016e0df06d86e32cf1950def62fb879ea", "committedDate": "2020-03-26T21:35:39Z", "message": "TEMP2"}, "afterCommit": {"oid": "2bdc8f9a49ac331492c31d886be250dd68e8df04", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2bdc8f9a49ac331492c31d886be250dd68e8df04", "committedDate": "2020-03-26T22:16:12Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2bdc8f9a49ac331492c31d886be250dd68e8df04", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2bdc8f9a49ac331492c31d886be250dd68e8df04", "committedDate": "2020-03-26T22:16:12Z", "message": "TEMP2"}, "afterCommit": {"oid": "2a85da700025e0f200b6a503b6292472ad49de54", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2a85da700025e0f200b6a503b6292472ad49de54", "committedDate": "2020-03-27T09:52:00Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a85da700025e0f200b6a503b6292472ad49de54", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2a85da700025e0f200b6a503b6292472ad49de54", "committedDate": "2020-03-27T09:52:00Z", "message": "TEMP2"}, "afterCommit": {"oid": "0cbad6047732e4098dd65f5839c29ebc8fa83015", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/0cbad6047732e4098dd65f5839c29ebc8fa83015", "committedDate": "2020-03-27T09:58:45Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0cbad6047732e4098dd65f5839c29ebc8fa83015", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/0cbad6047732e4098dd65f5839c29ebc8fa83015", "committedDate": "2020-03-27T09:58:45Z", "message": "TEMP2"}, "afterCommit": {"oid": "cdabae2bee3e2327a50b3f8efef2f01d732ea9a0", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cdabae2bee3e2327a50b3f8efef2f01d732ea9a0", "committedDate": "2020-03-27T10:09:44Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cdabae2bee3e2327a50b3f8efef2f01d732ea9a0", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cdabae2bee3e2327a50b3f8efef2f01d732ea9a0", "committedDate": "2020-03-27T10:09:44Z", "message": "TEMP2"}, "afterCommit": {"oid": "cbb9e337418a52de6d1caec99fa133847e4ba430", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cbb9e337418a52de6d1caec99fa133847e4ba430", "committedDate": "2020-03-27T10:25:12Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cbb9e337418a52de6d1caec99fa133847e4ba430", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cbb9e337418a52de6d1caec99fa133847e4ba430", "committedDate": "2020-03-27T10:25:12Z", "message": "TEMP2"}, "afterCommit": {"oid": "955979c5c8e156d5afee3c8ffb27385435e02900", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/955979c5c8e156d5afee3c8ffb27385435e02900", "committedDate": "2020-03-27T10:40:45Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "955979c5c8e156d5afee3c8ffb27385435e02900", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/955979c5c8e156d5afee3c8ffb27385435e02900", "committedDate": "2020-03-27T10:40:45Z", "message": "TEMP2"}, "afterCommit": {"oid": "7942af06b236a1b8c0a15b79ca3a22f06f5b9bd9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/7942af06b236a1b8c0a15b79ca3a22f06f5b9bd9", "committedDate": "2020-03-27T10:45:56Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7942af06b236a1b8c0a15b79ca3a22f06f5b9bd9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/7942af06b236a1b8c0a15b79ca3a22f06f5b9bd9", "committedDate": "2020-03-27T10:45:56Z", "message": "TEMP2"}, "afterCommit": {"oid": "e86e648ff9f1b009a26e77a545ab70d3b9b3a928", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e86e648ff9f1b009a26e77a545ab70d3b9b3a928", "committedDate": "2020-03-27T11:08:45Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e86e648ff9f1b009a26e77a545ab70d3b9b3a928", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e86e648ff9f1b009a26e77a545ab70d3b9b3a928", "committedDate": "2020-03-27T11:08:45Z", "message": "TEMP2"}, "afterCommit": {"oid": "4afd5b4f2efba82a6c3b8cda199e4a960bd578c7", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4afd5b4f2efba82a6c3b8cda199e4a960bd578c7", "committedDate": "2020-03-27T14:19:51Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4afd5b4f2efba82a6c3b8cda199e4a960bd578c7", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4afd5b4f2efba82a6c3b8cda199e4a960bd578c7", "committedDate": "2020-03-27T14:19:51Z", "message": "TEMP2"}, "afterCommit": {"oid": "da2c7bcb572161d121f373894ed3f24573bb13d6", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/da2c7bcb572161d121f373894ed3f24573bb13d6", "committedDate": "2020-03-27T17:45:02Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "da2c7bcb572161d121f373894ed3f24573bb13d6", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/da2c7bcb572161d121f373894ed3f24573bb13d6", "committedDate": "2020-03-27T17:45:02Z", "message": "TEMP2"}, "afterCommit": {"oid": "f93950a44ba9469af30531a4caf63e7d4a65c8d9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f93950a44ba9469af30531a4caf63e7d4a65c8d9", "committedDate": "2020-03-27T18:10:01Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f93950a44ba9469af30531a4caf63e7d4a65c8d9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f93950a44ba9469af30531a4caf63e7d4a65c8d9", "committedDate": "2020-03-27T18:10:01Z", "message": "TEMP2"}, "afterCommit": {"oid": "f61b4dbb40826b7a976ee0e5be050ec44d839176", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f61b4dbb40826b7a976ee0e5be050ec44d839176", "committedDate": "2020-03-27T18:22:43Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f61b4dbb40826b7a976ee0e5be050ec44d839176", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f61b4dbb40826b7a976ee0e5be050ec44d839176", "committedDate": "2020-03-27T18:22:43Z", "message": "TEMP2"}, "afterCommit": {"oid": "d2c543d52a65040c0a4324cee5942e9b01a9db70", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d2c543d52a65040c0a4324cee5942e9b01a9db70", "committedDate": "2020-03-27T19:12:43Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d2c543d52a65040c0a4324cee5942e9b01a9db70", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/d2c543d52a65040c0a4324cee5942e9b01a9db70", "committedDate": "2020-03-27T19:12:43Z", "message": "TEMP2"}, "afterCommit": {"oid": "4bd36f08f88c702f39e445e8cd8cbda79a6296b4", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4bd36f08f88c702f39e445e8cd8cbda79a6296b4", "committedDate": "2020-03-27T19:27:43Z", "message": "TEMP2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMTYxMjE0", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383161214", "createdAt": "2020-03-27T19:57:10Z", "commit": {"oid": "eebd04cfd86e8456e986383fad8898991fc5f63d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxOTo1NzoxMFrOF8__mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxOTo1NzoxMFrOF8__mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTUwNzM1NA==", "bodyText": "unused", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399507354", "createdAt": "2020-03-27T19:57:10Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -284,6 +284,11 @@ pipeline {\n     CHANGE_BRANCH = \"${env.CHANGE_BRANCH != null ? env.CHANGE_BRANCH : BRANCH_NAME}\"\n     CHANGE_TARGET = \"${env.CHANGE_TARGET != null ? env.CHANGE_TARGET : BRANCH_NAME}\"\n     CONNECT_PREPROD_URL = 'https://nos-preprod-connect.nuxeocloud.com/nuxeo'\n+    ORG = \"nuxeo\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eebd04cfd86e8456e986383fad8898991fc5f63d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMTYxNjUy", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383161652", "createdAt": "2020-03-27T19:57:54Z", "commit": {"oid": "eebd04cfd86e8456e986383fad8898991fc5f63d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxOTo1Nzo1NFrOF9AA8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxOTo1Nzo1NFrOF9AA8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTUwNzY5OQ==", "bodyText": "we don't need any package", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399507699", "createdAt": "2020-03-27T19:57:54Z", "author": {"login": "ataillefer"}, "path": "helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,86 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview\n+  nuxeo:\n+    podAnnotations:\n+      preview/scm.ref: ${SCM_REF}\n+    podLabels:\n+      branch: \"$BRANCH_NAME\"\n+      team: platform\n+      resource: pod\n+      usage: preview\n+    service:\n+      annotations:\n+        fabric8.io/ingress.annotations: |-\n+          nginx.ingress.kubernetes.io/proxy-body-size: 0\n+          nginx.ingress.kubernetes.io/server-snippet: ignore_invalid_headers off;\n+      labels:\n+        team: platform\n+        resource: service\n+        usage: preview\n+    image:\n+      repository: ${DOCKER_REGISTRY}/nuxeo/nuxeo\n+      tag: ${VERSION}\n+      pullPolicy: Always\n+    packages: nuxeo-web-ui nuxeo-dam", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eebd04cfd86e8456e986383fad8898991fc5f63d"}, "originalPosition": 44}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4bd36f08f88c702f39e445e8cd8cbda79a6296b4", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/4bd36f08f88c702f39e445e8cd8cbda79a6296b4", "committedDate": "2020-03-27T19:27:43Z", "message": "TEMP2"}, "afterCommit": {"oid": "b8c18247f9889362f4c9059e1f7199dce55b8d7b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b8c18247f9889362f4c9059e1f7199dce55b8d7b", "committedDate": "2020-03-27T20:47:17Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8c18247f9889362f4c9059e1f7199dce55b8d7b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b8c18247f9889362f4c9059e1f7199dce55b8d7b", "committedDate": "2020-03-27T20:47:17Z", "message": "TEMP"}, "afterCommit": {"oid": "13b8581764b7d9b69bff9c7a48567813068ce687", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/13b8581764b7d9b69bff9c7a48567813068ce687", "committedDate": "2020-03-27T20:56:50Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "13b8581764b7d9b69bff9c7a48567813068ce687", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/13b8581764b7d9b69bff9c7a48567813068ce687", "committedDate": "2020-03-27T20:56:50Z", "message": "TEMP"}, "afterCommit": {"oid": "67ffae0e10509cec5e6116d2c087047184415ed2", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/67ffae0e10509cec5e6116d2c087047184415ed2", "committedDate": "2020-03-27T21:39:49Z", "message": "NXP-27713: deploy a preview env for reference branches"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "67ffae0e10509cec5e6116d2c087047184415ed2", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/67ffae0e10509cec5e6116d2c087047184415ed2", "committedDate": "2020-03-27T21:39:49Z", "message": "NXP-27713: deploy a preview env for reference branches"}, "afterCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/2d627a61f1386cad149b6b013fcbc83d34551056", "committedDate": "2020-03-27T21:45:27Z", "message": "NXP-27713: deploy a preview env for reference branches"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "12237d66f3a1341245676900d89698deb462eb51", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/12237d66f3a1341245676900d89698deb462eb51", "committedDate": "2020-03-27T21:51:40Z", "message": "TEMP"}, "afterCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5", "committedDate": "2020-03-27T21:54:28Z", "message": "TEMP"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMzA1Njg2", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383305686", "createdAt": "2020-03-28T11:39:15Z", "commit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxMTozOToxNlrOF9I2eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxMTo0MTozN1rOF9I3Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY1MjQ3NA==", "bodyText": "This should be in nuxeo-helm-chart repository.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399652474", "createdAt": "2020-03-28T11:39:16Z", "author": {"login": "kevinleturc"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,93 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview\n+  nuxeo:\n+    customParams: |-\n+      elasticsearch.restClient.socketTimeoutMs=300000\n+      elasticsearch.restClient.connectionTimeoutMs=300000\n+    podAnnotations:\n+      preview/scm.ref: ${SCM_REF}\n+    podLabels:\n+      branch: \"$BRANCH_NAME\"\n+      team: platform\n+      resource: pod\n+      usage: preview\n+    service:\n+      annotations:\n+        fabric8.io/ingress.annotations: |-\n+          nginx.ingress.kubernetes.io/proxy-body-size: 0\n+          nginx.ingress.kubernetes.io/server-snippet: ignore_invalid_headers off;\n+      labels:\n+        team: platform\n+        resource: service\n+        usage: preview\n+    image:\n+      repository: ${DOCKER_REGISTRY}/nuxeo/nuxeo\n+      tag: ${VERSION}\n+      pullPolicy: Always\n+    packages: nuxeo-web-ui nuxeo-dam\n+    livenessProbe:\n+      initialDelaySeconds: 900\n+      periodSeconds: 20\n+      successThreshold: 1\n+      failureThreshold: 5\n+      timeoutSeconds: 10\n+    readinessProbe:\n+      periodSeconds: 20\n+      initialDelaySeconds: 600\n+      successThreshold: 1\n+      timeoutSeconds: 10\n+      failureThreshold: 5\n+    custom_envs:\n+    - name: NUXEO_CLID\n+      valueFrom:\n+        secretKeyRef:\n+          name: instance-clid\n+          key: instance.clid\n+    persistence:\n+      enabled: ${PERSISTENCE}\n+  mongodb:\n+    deploy: ${PERSISTENCE}\n+    persistence:\n+      enabled: ${PERSISTENCE}\n+    labels:\n+      branch: \"$BRANCH_NAME\"\n+      resource: deployment\n+      team: platform\n+      usage: preview\n+    podLabels:\n+      branch: \"$BRANCH_NAME\"\n+      resource: pod\n+      team: platform\n+      usage: preview\n+  elasticsearch:\n+    deploy: ${PERSISTENCE}\n+    master:\n+      persistence:\n+        enabled: ${PERSISTENCE}\n+    data:\n+      persistence:\n+        enabled: ${PERSISTENCE}\n+    cluster:\n+      env:\n+        EXPECTED_MASTER_NODES: 1\n+        RECOVER_AFTER_MASTER_NODES: 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY1MjUwNw==", "bodyText": "Whitespace.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399652507", "createdAt": "2020-03-28T11:39:40Z", "author": {"login": "kevinleturc"}, "path": "Jenkinsfile", "diffHunk": "@@ -303,393 +307,61 @@ pipeline {\n       }\n     }\n \n-    stage('Update version') {\n+    stage('Deploy Preview') {\n       steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n         container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Update version\n-          ----------------------------------------\n-          New version: ${VERSION}\n-          \"\"\"\n-          sh \"\"\"\n-            mvn ${MAVEN_ARGS} -Pdistrib,docker versions:set -DnewVersion=${VERSION} -DgenerateBackupPoms=false\n-            perl -i -pe 's|<nuxeo.platform.version>.*?</nuxeo.platform.version>|<nuxeo.platform.version>${VERSION}</nuxeo.platform.version>|' pom.xml\n-            perl -i -pe 's|org.nuxeo.ecm.product.version=.*|org.nuxeo.ecm.product.version=${VERSION}|' nuxeo-distribution/nuxeo-nxr-server/src/main/resources/templates/nuxeo.defaults\n-          \"\"\"\n-        }\n-      }\n-    }\n-\n-    stage('Git commit') {\n-      when {\n-        not {\n-          branch 'PR-*'\n-        }\n-      }\n-      steps {\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Git commit\n-          ----------------------------------------\n-          \"\"\"\n-          sh \"\"\"\n-            git add .\n-            git commit -m \"Release ${VERSION}\"\n-          \"\"\"\n-        }\n-      }\n-    }\n-\n-    stage('Compile') {\n-      steps {\n-        setGitHubBuildStatus('platform/compile', 'Compile', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Compile\n-          ----------------------------------------\"\"\"\n-          echo \"MAVEN_OPTS=$MAVEN_OPTS\"\n-          sh \"mvn ${MAVEN_ARGS} -V -T0.8C -DskipTests install\"\n-        }\n-      }\n-      post {\n-        success {\n-          setGitHubBuildStatus('platform/compile', 'Compile', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/compile', 'Compile', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Run common unit tests') {\n-      steps {\n-        setGitHubBuildStatus('platform/utests/common/dev', 'Unit tests - common', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Run common unit tests\n-          ----------------------------------------\"\"\"\n-          dir('nuxeo-common') {\n-            sh \"mvn ${MAVEN_ARGS} test\"\n-          }\n-        }\n-      }\n-      post {\n-        always {\n-          junit testResults: '**/target/surefire-reports/*.xml'\n-        }\n-        success {\n-          setGitHubBuildStatus('platform/utests/common/dev', 'Unit tests - common', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/utests/common/dev', 'Unit tests - common', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Run runtime unit tests') {\n-      steps {\n-        setGitHubBuildStatus('platform/utests/runtime/dev', 'Unit tests - runtime', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Run runtime unit tests\n-          ----------------------------------------\"\"\"\n-          dir('nuxeo-runtime') {\n-            sh \"mvn ${MAVEN_ARGS} test\"\n-          }\n-        }\n-      }\n-      post {\n-        always {\n-          junit testResults: '**/target/surefire-reports/*.xml'\n-        }\n-        success {\n-          setGitHubBuildStatus('platform/utests/runtime/dev', 'Unit tests - runtime', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/utests/runtime/dev', 'Unit tests - runtime', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Run unit tests') {\n-      steps {\n-        script {\n-          def stages = [:]\n-          for (env in testEnvironments) {\n-            stages[\"Run ${env} unit tests\"] = buildUnitTestStage(env);\n-          }\n-          parallel stages\n-        }\n-      }\n-    }\n-\n-    stage('Package') {\n-      steps {\n-        setGitHubBuildStatus('platform/package', 'Package', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Package\n-          ----------------------------------------\"\"\"\n-          sh \"mvn ${MAVEN_ARGS} -f nuxeo-distribution/pom.xml -DskipTests install\"\n-          sh \"mvn ${MAVEN_ARGS} -f packages/pom.xml -DskipTests install\"\n-        }\n-      }\n-      post {\n-        success {\n-          setGitHubBuildStatus('platform/package', 'Package', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/package', 'Package', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Run \"dev\" functional tests') {\n-      steps {\n-        setGitHubBuildStatus('platform/ftests/dev', 'Functional tests - dev environment', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Run \"dev\" functional tests\n-          ----------------------------------------\"\"\"\n-          script {\n-            try {\n-              runFunctionalTests('nuxeo-distribution/nuxeo-server-tests')\n-              runFunctionalTests('nuxeo-distribution/nuxeo-server-hotreload-tests')\n-              runFunctionalTests('nuxeo-distribution/nuxeo-server-gatling-tests')\n-              runFunctionalTests('ftests')\n-              setGitHubBuildStatus('platform/ftests/dev', 'Functional tests - dev environment', 'SUCCESS')\n-            } catch (err) {\n-              setGitHubBuildStatus('platform/ftests/dev', 'Functional tests - dev environment', 'FAILURE')\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute docker image names and versions\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              sh(returnStdout: true, script: 'jx -b ns | sed -r \"s/^Using namespace \\'([^\\']+)\\'.+\\\\$/\\\\1/\"')\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // waiting for https://github.com/jenkins-x/jx/issues/5797 to be fixed in order to remove --source-url\n+              sh \"\"\"\n+                jx step helm build --verbose\n+                mkdir target && helm template . --output-dir target\n+                jx preview \\\n+                  --namespace ${NAMESPACE} \\\n+                  --verbose \\\n+                  --source-url=https://github.com/nuxeo/nuxeo \\\n+                  --preview-health-timeout 15m \\\n+                  ${noCommentOpt}\n+              \"\"\"\n             }\n           }\n         }\n       }\n       post {\n         always {\n-          junit testResults: '**/target/failsafe-reports/*.xml'\n-        }\n-      }\n-    }\n-\n-    stage('Build Docker images') {\n-      steps {\n-        setGitHubBuildStatus('platform/docker/build', 'Build Docker images', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Build Docker images\n-          ----------------------------------------\n-          Image tag: ${VERSION}\n-          \"\"\"\n-          echo \"Build and push Docker images to internal Docker registry ${DOCKER_REGISTRY}\"\n-          // Fetch Nuxeo distribution and Nuxeo Content Platform packages with Maven\n-          sh \"mvn ${MAVEN_ARGS} -f docker/pom.xml process-resources\"\n-          skaffoldBuildAll()\n-        }\n-      }\n-      post {\n-        success {\n-          setGitHubBuildStatus('platform/docker/build', 'Build Docker images', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/docker/build', 'Build Docker images', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Test Docker images') {\n-      steps {\n-        setGitHubBuildStatus('platform/docker/test', 'Test Docker images', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Test Docker images\n-          ----------------------------------------\n-          \"\"\"\n-          script {\n-            // builder image\n-            def image = \"${DOCKER_REGISTRY}/${dockerNamespace}/${BUILDER_IMAGE_NAME}:${VERSION}\"\n-            echo \"Test ${image}\"\n-            dockerPull(image)\n-            dockerRun(image, 'ls -l /distrib')\n-\n-            // base image\n-            image = \"${DOCKER_REGISTRY}/${dockerNamespace}/${BASE_IMAGE_NAME}:${VERSION}\"\n-            echo \"Test ${image}\"\n-            dockerPull(image)\n-            dockerRun(image, 'cat /etc/centos-release; java -version')\n-\n-            // nuxeo slim image\n-            image = \"${DOCKER_REGISTRY}/${dockerNamespace}/${SLIM_IMAGE_NAME}:${VERSION}\"\n-            echo \"Test ${image}\"\n-            dockerPull(image)\n-            echo 'Run image as root (0)'\n-            dockerRun(image, 'nuxeoctl start')\n-            echo 'Run image as an arbitrary user (800)'\n-            dockerRun(image, 'nuxeoctl start', '800')\n-\n-            // nuxeo image\n-            image = \"${DOCKER_REGISTRY}/${dockerNamespace}/${NUXEO_IMAGE_NAME}:${VERSION}\"\n-            echo \"Test ${image}\"\n-            dockerPull(image)\n-            echo 'Run image as root (0)'\n-            dockerRun(image, 'nuxeoctl start')\n-            echo 'Run image as an arbitrary user (800)'\n-            dockerRun(image, 'nuxeoctl start', '800')\n-          }\n+          archiveArtifacts allowEmptyArchive: true, artifacts: '**/requirements.lock, **/charts/*.tgz, **/target/**/*.yaml'\n         }\n-      }\n-      post {\n         success {\n-          setGitHubBuildStatus('platform/docker/test', 'Test Docker images', 'SUCCESS')\n+          setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'SUCCESS')\n         }\n         failure {\n-          setGitHubBuildStatus('platform/docker/test', 'Test Docker images', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Deploy Docker images') {\n-      when {\n-        not {\n-          branch 'PR-*'\n-        }\n-      }\n-      steps {\n-        setGitHubBuildStatus('platform/docker/deploy', 'Deploy Docker images', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Deploy Docker images\n-          ----------------------------------------\n-          Image tag: ${VERSION}\n-          \"\"\"\n-          echo \"Push Docker images to public Docker registry ${PUBLIC_DOCKER_REGISTRY}\"\n-          dockerDeploy(\"${SLIM_IMAGE_NAME}\")\n-          dockerDeploy(\"${NUXEO_IMAGE_NAME}\")\n-        }\n-      }\n-      post {\n-        success {\n-          setGitHubBuildStatus('platform/docker/deploy', 'Deploy Docker images', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/docker/deploy', 'Deploy Docker images', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Deploy Maven artifacts') {\n-      steps {\n-        setGitHubBuildStatus('platform/deploy', 'Deploy Maven artifacts', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Deploy Maven artifacts\n-          ----------------------------------------\"\"\"\n-          sh \"mvn ${MAVEN_ARGS} -Pdistrib -DskipTests deploy\"\n-        }\n-      }\n-      post {\n-        success {\n-          setGitHubBuildStatus('platform/deploy', 'Deploy Maven artifacts', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/deploy', 'Deploy Maven artifacts', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Upload Nuxeo Packages') {\n-      steps {\n-        setGitHubBuildStatus('platform/upload/packages', 'Upload Nuxeo Packages', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Upload Nuxeo Packages to ${CONNECT_PREPROD_URL}\n-          ----------------------------------------\"\"\"\n-          withCredentials([usernameColonPassword(credentialsId: 'connect-preprod', variable: 'CONNECT_PASS')]) {\n-            sh \"\"\"\n-              PACKAGES_TO_UPLOAD=\"packages/nuxeo-*-package/target/nuxeo-*-package-*.zip\"\n-              for file in \\$PACKAGES_TO_UPLOAD ; do\n-                curl -i -u \"$CONNECT_PASS\" -F package=@\\$(ls \\$file) \"$CONNECT_PREPROD_URL\"/site/marketplace/upload?batch=true ;\n-              done\n-            \"\"\"\n-          }\n-        }\n-      }\n-      post {\n-        success {\n-          setGitHubBuildStatus('platform/upload/packages', 'Upload Nuxeo Packages', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/upload/packages', 'Upload Nuxeo Packages', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Git tag and push') {\n-      when {\n-        not {\n-          branch 'PR-*'\n-        }\n-      }\n-      steps {\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Git tag and push\n-          ----------------------------------------\n-          \"\"\"\n-          sh \"\"\"\n-            #!/usr/bin/env bash -xe\n-            # create the Git credentials\n-            jx step git credentials\n-            git config credential.helper store\n-\n-            # Git tag\n-            jx step tag -v ${VERSION}\n-          \"\"\"\n-        }\n-      }\n-    }\n-\n-    stage('JSF pipeline') {\n-      when {\n-        expression {\n-          // only trigger JSF pipeline if the target branch is master or a maintenance branch\n-          return CHANGE_TARGET ==~ 'master|\\\\d+\\\\.\\\\d+'\n-        }\n-      }\n-      steps {\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Build JSF pipeline\n-          ----------------------------------------\n-          Parameters:\n-            NUXEO_BRANCH: ${CHANGE_BRANCH}\n-            NUXEO_COMMIT_SHA: ${GIT_COMMIT}\n-            NUXEO_VERSION: ${VERSION}\n-          \"\"\"\n-          build job: \"/nuxeo/nuxeo-jsf-ui-status/${CHANGE_TARGET}\",\n-            parameters: [\n-              string(name: 'NUXEO_BRANCH', value: \"${CHANGE_BRANCH}\"),\n-              string(name: 'NUXEO_COMMIT_SHA', value: \"${GIT_COMMIT}\"),\n-              string(name: 'NUXEO_VERSION', value: \"${VERSION}\"),\n-            ], propagate: false, wait: false\n+          setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'FAILURE')\n         }\n       }\n     }\n   }\n-\n+  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY1MjY0Nw==", "bodyText": "This was added in arender because nuxeo 10.10 hotfixes itself during boot. This is not the case with master, so:\n\nprobably not needed\ncan be lowered", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399652647", "createdAt": "2020-03-28T11:41:37Z", "author": {"login": "kevinleturc"}, "path": "Jenkinsfile", "diffHunk": "@@ -303,393 +307,61 @@ pipeline {\n       }\n     }\n \n-    stage('Update version') {\n+    stage('Deploy Preview') {\n       steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n         container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Update version\n-          ----------------------------------------\n-          New version: ${VERSION}\n-          \"\"\"\n-          sh \"\"\"\n-            mvn ${MAVEN_ARGS} -Pdistrib,docker versions:set -DnewVersion=${VERSION} -DgenerateBackupPoms=false\n-            perl -i -pe 's|<nuxeo.platform.version>.*?</nuxeo.platform.version>|<nuxeo.platform.version>${VERSION}</nuxeo.platform.version>|' pom.xml\n-            perl -i -pe 's|org.nuxeo.ecm.product.version=.*|org.nuxeo.ecm.product.version=${VERSION}|' nuxeo-distribution/nuxeo-nxr-server/src/main/resources/templates/nuxeo.defaults\n-          \"\"\"\n-        }\n-      }\n-    }\n-\n-    stage('Git commit') {\n-      when {\n-        not {\n-          branch 'PR-*'\n-        }\n-      }\n-      steps {\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Git commit\n-          ----------------------------------------\n-          \"\"\"\n-          sh \"\"\"\n-            git add .\n-            git commit -m \"Release ${VERSION}\"\n-          \"\"\"\n-        }\n-      }\n-    }\n-\n-    stage('Compile') {\n-      steps {\n-        setGitHubBuildStatus('platform/compile', 'Compile', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Compile\n-          ----------------------------------------\"\"\"\n-          echo \"MAVEN_OPTS=$MAVEN_OPTS\"\n-          sh \"mvn ${MAVEN_ARGS} -V -T0.8C -DskipTests install\"\n-        }\n-      }\n-      post {\n-        success {\n-          setGitHubBuildStatus('platform/compile', 'Compile', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/compile', 'Compile', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Run common unit tests') {\n-      steps {\n-        setGitHubBuildStatus('platform/utests/common/dev', 'Unit tests - common', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Run common unit tests\n-          ----------------------------------------\"\"\"\n-          dir('nuxeo-common') {\n-            sh \"mvn ${MAVEN_ARGS} test\"\n-          }\n-        }\n-      }\n-      post {\n-        always {\n-          junit testResults: '**/target/surefire-reports/*.xml'\n-        }\n-        success {\n-          setGitHubBuildStatus('platform/utests/common/dev', 'Unit tests - common', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/utests/common/dev', 'Unit tests - common', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Run runtime unit tests') {\n-      steps {\n-        setGitHubBuildStatus('platform/utests/runtime/dev', 'Unit tests - runtime', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Run runtime unit tests\n-          ----------------------------------------\"\"\"\n-          dir('nuxeo-runtime') {\n-            sh \"mvn ${MAVEN_ARGS} test\"\n-          }\n-        }\n-      }\n-      post {\n-        always {\n-          junit testResults: '**/target/surefire-reports/*.xml'\n-        }\n-        success {\n-          setGitHubBuildStatus('platform/utests/runtime/dev', 'Unit tests - runtime', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/utests/runtime/dev', 'Unit tests - runtime', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Run unit tests') {\n-      steps {\n-        script {\n-          def stages = [:]\n-          for (env in testEnvironments) {\n-            stages[\"Run ${env} unit tests\"] = buildUnitTestStage(env);\n-          }\n-          parallel stages\n-        }\n-      }\n-    }\n-\n-    stage('Package') {\n-      steps {\n-        setGitHubBuildStatus('platform/package', 'Package', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Package\n-          ----------------------------------------\"\"\"\n-          sh \"mvn ${MAVEN_ARGS} -f nuxeo-distribution/pom.xml -DskipTests install\"\n-          sh \"mvn ${MAVEN_ARGS} -f packages/pom.xml -DskipTests install\"\n-        }\n-      }\n-      post {\n-        success {\n-          setGitHubBuildStatus('platform/package', 'Package', 'SUCCESS')\n-        }\n-        failure {\n-          setGitHubBuildStatus('platform/package', 'Package', 'FAILURE')\n-        }\n-      }\n-    }\n-\n-    stage('Run \"dev\" functional tests') {\n-      steps {\n-        setGitHubBuildStatus('platform/ftests/dev', 'Functional tests - dev environment', 'PENDING')\n-        container('maven') {\n-          echo \"\"\"\n-          ----------------------------------------\n-          Run \"dev\" functional tests\n-          ----------------------------------------\"\"\"\n-          script {\n-            try {\n-              runFunctionalTests('nuxeo-distribution/nuxeo-server-tests')\n-              runFunctionalTests('nuxeo-distribution/nuxeo-server-hotreload-tests')\n-              runFunctionalTests('nuxeo-distribution/nuxeo-server-gatling-tests')\n-              runFunctionalTests('ftests')\n-              setGitHubBuildStatus('platform/ftests/dev', 'Functional tests - dev environment', 'SUCCESS')\n-            } catch (err) {\n-              setGitHubBuildStatus('platform/ftests/dev', 'Functional tests - dev environment', 'FAILURE')\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute docker image names and versions\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              sh(returnStdout: true, script: 'jx -b ns | sed -r \"s/^Using namespace \\'([^\\']+)\\'.+\\\\$/\\\\1/\"')\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // waiting for https://github.com/jenkins-x/jx/issues/5797 to be fixed in order to remove --source-url\n+              sh \"\"\"\n+                jx step helm build --verbose\n+                mkdir target && helm template . --output-dir target\n+                jx preview \\\n+                  --namespace ${NAMESPACE} \\\n+                  --verbose \\\n+                  --source-url=https://github.com/nuxeo/nuxeo \\\n+                  --preview-health-timeout 15m \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 217}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMzIzNDQ5", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383323449", "createdAt": "2020-03-28T15:41:46Z", "commit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxNTo0MTo0NlrOF9KSQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxNTo0MjozMVrOF9KSgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3NTk2OA==", "bodyText": "This may be linked to my other comment about preview-health-timeout, these values are for an environment deploying nuxeo 10.10. On master we probably don't need to wait 10min before checking readiness.\nI think we could try the default values coming from nuxeo helm chart.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399675968", "createdAt": "2020-03-28T15:41:46Z", "author": {"login": "kevinleturc"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,93 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview\n+  nuxeo:\n+    customParams: |-\n+      elasticsearch.restClient.socketTimeoutMs=300000\n+      elasticsearch.restClient.connectionTimeoutMs=300000\n+    podAnnotations:\n+      preview/scm.ref: ${SCM_REF}\n+    podLabels:\n+      branch: \"$BRANCH_NAME\"\n+      team: platform\n+      resource: pod\n+      usage: preview\n+    service:\n+      annotations:\n+        fabric8.io/ingress.annotations: |-\n+          nginx.ingress.kubernetes.io/proxy-body-size: 0\n+          nginx.ingress.kubernetes.io/server-snippet: ignore_invalid_headers off;\n+      labels:\n+        team: platform\n+        resource: service\n+        usage: preview\n+    image:\n+      repository: ${DOCKER_REGISTRY}/nuxeo/nuxeo\n+      tag: ${VERSION}\n+      pullPolicy: Always\n+    packages: nuxeo-web-ui nuxeo-dam\n+    livenessProbe:\n+      initialDelaySeconds: 900\n+      periodSeconds: 20\n+      successThreshold: 1\n+      failureThreshold: 5\n+      timeoutSeconds: 10\n+    readinessProbe:\n+      periodSeconds: 20\n+      initialDelaySeconds: 600\n+      successThreshold: 1\n+      timeoutSeconds: 10\n+      failureThreshold: 5", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3NTk4MQ==", "bodyText": "To remove.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399675981", "createdAt": "2020-03-28T15:41:59Z", "author": {"login": "kevinleturc"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,93 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview\n+  nuxeo:\n+    customParams: |-\n+      elasticsearch.restClient.socketTimeoutMs=300000\n+      elasticsearch.restClient.connectionTimeoutMs=300000\n+    podAnnotations:\n+      preview/scm.ref: ${SCM_REF}\n+    podLabels:\n+      branch: \"$BRANCH_NAME\"\n+      team: platform\n+      resource: pod\n+      usage: preview\n+    service:\n+      annotations:\n+        fabric8.io/ingress.annotations: |-\n+          nginx.ingress.kubernetes.io/proxy-body-size: 0\n+          nginx.ingress.kubernetes.io/server-snippet: ignore_invalid_headers off;\n+      labels:\n+        team: platform\n+        resource: service\n+        usage: preview\n+    image:\n+      repository: ${DOCKER_REGISTRY}/nuxeo/nuxeo\n+      tag: ${VERSION}\n+      pullPolicy: Always\n+    packages: nuxeo-web-ui nuxeo-dam", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3NjAzNA==", "bodyText": "To add maybe?\nbranch: \"$BRANCH_NAME\"", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399676034", "createdAt": "2020-03-28T15:42:31Z", "author": {"login": "kevinleturc"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,93 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview\n+  nuxeo:\n+    customParams: |-\n+      elasticsearch.restClient.socketTimeoutMs=300000\n+      elasticsearch.restClient.connectionTimeoutMs=300000\n+    podAnnotations:\n+      preview/scm.ref: ${SCM_REF}\n+    podLabels:\n+      branch: \"$BRANCH_NAME\"\n+      team: platform\n+      resource: pod\n+      usage: preview\n+    service:\n+      annotations:\n+        fabric8.io/ingress.annotations: |-\n+          nginx.ingress.kubernetes.io/proxy-body-size: 0\n+          nginx.ingress.kubernetes.io/server-snippet: ignore_invalid_headers off;\n+      labels:\n+        team: platform", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTc4Mzkx", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383578391", "createdAt": "2020-03-30T07:06:05Z", "commit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzowNjowNlrOF9cHLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzowNjowNlrOF9cHLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk2ODA0NQ==", "bodyText": "Maybe just nuxeo/preview? Shorter in the status list.\nI know it's like this in ARender, but WDYT @troger @kevinleturc ?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399968045", "createdAt": "2020-03-30T07:06:06Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -303,393 +307,61 @@ pipeline {\n       }\n     }\n \n-    stage('Update version') {\n+    stage('Deploy Preview') {\n       steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTgwMjQ0", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383580244", "createdAt": "2020-03-30T07:09:30Z", "commit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzowOTozMFrOF9cNqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzowOTozMFrOF9cNqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk2OTcwNA==", "bodyText": "I'd go with PREVIEW_NAMESPACE so it is explicit.\nWe're also using some namespaces for unit tests, for which the related env vars are prefixed by TEST_, see for instance https://github.com/nuxeo/nuxeo/blob/master/Jenkinsfile#L267.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399969704", "createdAt": "2020-03-30T07:09:30Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -279,11 +279,15 @@ pipeline {\n     PUBLIC_DOCKER_REGISTRY = 'docker.packages.nuxeo.com'\n     MAVEN_OPTS = \"$MAVEN_OPTS -Xms512m -Xmx3072m\"\n     MAVEN_ARGS = getMavenArgs()\n-    VERSION = getVersion()\n+    VERSION = \"11.1-SNAPSHOT\"\n     DOCKER_TAG = getDockerTagFrom(\"${VERSION}\")\n     CHANGE_BRANCH = \"${env.CHANGE_BRANCH != null ? env.CHANGE_BRANCH : BRANCH_NAME}\"\n     CHANGE_TARGET = \"${env.CHANGE_TARGET != null ? env.CHANGE_TARGET : BRANCH_NAME}\"\n     CONNECT_PREPROD_URL = 'https://nos-preprod-connect.nuxeocloud.com/nuxeo'\n+    ORG = \"nuxeo\"\n+    APP_NAME = \"nuxeo\"\n+    NAMESPACE = \"$APP_NAME-${BRANCH_NAME.toLowerCase()}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTgzNDA1", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383583405", "createdAt": "2020-03-30T07:14:49Z", "commit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoxNDo0OVrOF9cXnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoxNDo0OVrOF9cXnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk3MjI1Mw==", "bodyText": "For a smaller diff, you can simply use\n      when {\n        expression {\n          return false\n        }\n      }\n\nSee 2bd2ee9.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399972253", "createdAt": "2020-03-30T07:14:49Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -307,370 +307,7 @@ pipeline {\n       }\n     }\n \n-    stage('Update version') {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTg4NTEz", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383588513", "createdAt": "2020-03-30T07:23:33Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoyMzozM1rOF9cnvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoyMzozM1rOF9cnvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk3NjM4MA==", "bodyText": "I'm wondering if we need/want the chart tgz archives, since we have all the YAML files?\n@kevinleturc", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399976380", "createdAt": "2020-03-30T07:23:33Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -661,6 +665,65 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute docker image names and versions\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              sh(returnStdout: true, script: 'jx -b ns | sed -r \"s/^Using namespace \\'([^\\']+)\\'.+\\\\$/\\\\1/\"')\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // waiting for https://github.com/jenkins-x/jx/issues/5797 to be fixed in order to remove --source-url\n+              sh \"\"\"\n+                jx step helm build --verbose\n+                mkdir target && helm template . --output-dir target\n+                jx preview \\\n+                  --namespace ${NAMESPACE} \\\n+                  --verbose \\\n+                  --source-url=https://github.com/nuxeo/nuxeo \\\n+                  --preview-health-timeout 15m \\\n+                  ${noCommentOpt}\n+              \"\"\"\n+            }\n+          }\n+        }\n+      }\n+      post {\n+        always {\n+          archiveArtifacts allowEmptyArchive: true, artifacts: '**/requirements.lock, **/charts/*.tgz, **/target/**/*.yaml'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTkxNzAy", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383591702", "createdAt": "2020-03-30T07:28:39Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoyODo0MFrOF9cyJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzoyODo0MFrOF9cyJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk3OTA0Ng==", "bodyText": "Can't we always use $VAR_NAME (without {...}) for environment variable substitution?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399979046", "createdAt": "2020-03-30T07:28:40Z", "author": {"login": "ataillefer"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,93 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview\n+  nuxeo:\n+    customParams: |-\n+      elasticsearch.restClient.socketTimeoutMs=300000\n+      elasticsearch.restClient.connectionTimeoutMs=300000\n+    podAnnotations:\n+      preview/scm.ref: ${SCM_REF}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTkzNDA2", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383593406", "createdAt": "2020-03-30T07:31:18Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzozMToxOFrOF9c3kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzozMToxOFrOF9c3kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk4MDQzNA==", "bodyText": "The comment about Docker images is not relevant.\nIt should be limited to something generic like \"first substitute environment variables in chart values\".", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399980434", "createdAt": "2020-03-30T07:31:18Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -661,6 +665,65 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute docker image names and versions", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTk3MDI2", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383597026", "createdAt": "2020-03-30T07:37:14Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzozNzoxNFrOF9dDHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzozNzoxNFrOF9dDHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk4MzM5MA==", "bodyText": "Is this line really useful?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399983390", "createdAt": "2020-03-30T07:37:14Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -661,6 +665,65 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute docker image names and versions\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              sh(returnStdout: true, script: 'jx -b ns | sed -r \"s/^Using namespace \\'([^\\']+)\\'.+\\\\$/\\\\1/\"')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTk5MDMz", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383599033", "createdAt": "2020-03-30T07:40:21Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0MDoyMVrOF9dJgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0MDoyMVrOF9dJgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk4NTAyNA==", "bodyText": "Do we want to refresh the issue or add a comment?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399985024", "createdAt": "2020-03-30T07:40:21Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -661,6 +665,65 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute docker image names and versions\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              sh(returnStdout: true, script: 'jx -b ns | sed -r \"s/^Using namespace \\'([^\\']+)\\'.+\\\\$/\\\\1/\"')\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // waiting for https://github.com/jenkins-x/jx/issues/5797 to be fixed in order to remove --source-url", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNTk5NTY3", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383599567", "createdAt": "2020-03-30T07:41:12Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0MToxMlrOF9dLFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0MToxMlrOF9dLFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk4NTQzMQ==", "bodyText": "Do we want to keep the verbose output?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399985431", "createdAt": "2020-03-30T07:41:12Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -661,6 +665,65 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute docker image names and versions\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              sh(returnStdout: true, script: 'jx -b ns | sed -r \"s/^Using namespace \\'([^\\']+)\\'.+\\\\$/\\\\1/\"')\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // waiting for https://github.com/jenkins-x/jx/issues/5797 to be fixed in order to remove --source-url\n+              sh \"\"\"\n+                jx step helm build --verbose", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNjAwMjE3", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383600217", "createdAt": "2020-03-30T07:42:10Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0MjoxMFrOF9dNGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0MjoxMFrOF9dNGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk4NTk0Nw==", "bodyText": "Do we want to keep the verbose output?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399985947", "createdAt": "2020-03-30T07:42:10Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -661,6 +665,65 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')\n+        container('maven') {\n+          dir('ci/helm/preview') {\n+            echo \"\"\"\n+            ----------------------------------------\n+            Deploy Preview environment\n+            ----------------------------------------\"\"\"\n+            // first substitute docker image names and versions\n+            sh \"\"\"\n+              mv values.yaml values.yaml.tosubst\n+              envsubst < values.yaml.tosubst > values.yaml\n+            \"\"\"\n+            // second create target namespace (if doesn't exist) and copy secrets to target namespace\n+            script {\n+              sh(returnStdout: true, script: 'jx -b ns | sed -r \"s/^Using namespace \\'([^\\']+)\\'.+\\\\$/\\\\1/\"')\n+              boolean nsExist = sh(returnStatus: true, script: \"kubectl get namespace ${NAMESPACE}\") == 0\n+              String noCommentOpt = '';\n+              if (nsExist) {\n+                noCommentOpt = '--no-comment'\n+              } else {\n+                sh \"kubectl create namespace ${NAMESPACE}\"\n+              }\n+              sh \"kubectl create secret generic preview-docker-cfg --namespace=${NAMESPACE} --from-file=.dockerconfigjson=/home/jenkins/.docker/config.json --type=kubernetes.io/dockerconfigjson --dry-run -o yaml | kubectl apply -f -\"\n+              // third build and deploy the chart\n+              // waiting for https://github.com/jenkins-x/jx/issues/5797 to be fixed in order to remove --source-url\n+              sh \"\"\"\n+                jx step helm build --verbose\n+                mkdir target && helm template . --output-dir target\n+                jx preview \\\n+                  --namespace ${NAMESPACE} \\\n+                  --verbose \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNjAyODQ4", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383602848", "createdAt": "2020-03-30T07:46:02Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0NjowMlrOF9dV1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0NjowMlrOF9dV1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk4ODE4MQ==", "bodyText": "What about nuxeo-preview to have it very clear in the pod list that it's a nuxeo preview (even if the pod are in a dedicated namespace)?", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399988181", "createdAt": "2020-03-30T07:46:02Z", "author": {"login": "ataillefer"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,93 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzNjA1MjMy", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-383605232", "createdAt": "2020-03-30T07:49:43Z", "commit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0OTo0NFrOF9ddlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwNzo0OTo0NFrOF9ddlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk5MDE2Ng==", "bodyText": "VERSION should refer to a release version, so always unique, thus pullPolicy: Always should be useles.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r399990166", "createdAt": "2020-03-30T07:49:44Z", "author": {"login": "ataillefer"}, "path": "ci/helm/preview/values.yaml", "diffHunk": "@@ -0,0 +1,93 @@\n+expose:\n+  Annotations:\n+    helm.sh/hook: post-install,post-upgrade\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  config:\n+    # add tls configuration\n+    domain: platform.dev.nuxeo.com\n+    exposer: Ingress\n+    http: true\n+    tlsacme: true\n+    tlsSecretName: platform-cluster-tls\n+    urltemplate: '\"{{.Service}}-{{.Namespace}}.{{.Domain}}\"'\n+\n+cleanup:\n+  Args:\n+    - --cleanup\n+  Annotations:\n+    helm.sh/hook: pre-delete\n+    helm.sh/hook-delete-policy: hook-succeeded\n+\n+nuxeo:\n+  fullnameOverride: preview\n+  nuxeo:\n+    customParams: |-\n+      elasticsearch.restClient.socketTimeoutMs=300000\n+      elasticsearch.restClient.connectionTimeoutMs=300000\n+    podAnnotations:\n+      preview/scm.ref: ${SCM_REF}\n+    podLabels:\n+      branch: \"$BRANCH_NAME\"\n+      team: platform\n+      resource: pod\n+      usage: preview\n+    service:\n+      annotations:\n+        fabric8.io/ingress.annotations: |-\n+          nginx.ingress.kubernetes.io/proxy-body-size: 0\n+          nginx.ingress.kubernetes.io/server-snippet: ignore_invalid_headers off;\n+      labels:\n+        team: platform\n+        resource: service\n+        usage: preview\n+    image:\n+      repository: ${DOCKER_REGISTRY}/nuxeo/nuxeo\n+      tag: ${VERSION}\n+      pullPolicy: Always", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d627a61f1386cad149b6b013fcbc83d34551056"}, "originalPosition": 46}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5c945a845c95bc7f99fdaf94a42ee379d3d3c8e5", "committedDate": "2020-03-27T21:54:28Z", "message": "TEMP"}, "afterCommit": {"oid": "ce639eae61835a8d758613d9335c0555f18c5b8c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ce639eae61835a8d758613d9335c0555f18c5b8c", "committedDate": "2020-03-30T08:48:42Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce639eae61835a8d758613d9335c0555f18c5b8c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ce639eae61835a8d758613d9335c0555f18c5b8c", "committedDate": "2020-03-30T08:48:42Z", "message": "TEMP"}, "afterCommit": {"oid": "3ec176bc31d3c7e8d4f2dde30b510cf80491214a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/3ec176bc31d3c7e8d4f2dde30b510cf80491214a", "committedDate": "2020-03-30T08:50:26Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ec176bc31d3c7e8d4f2dde30b510cf80491214a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/3ec176bc31d3c7e8d4f2dde30b510cf80491214a", "committedDate": "2020-03-30T08:50:26Z", "message": "TEMP"}, "afterCommit": {"oid": "a9a356082bb97d20d4e06629de4c2109730bae4a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a9a356082bb97d20d4e06629de4c2109730bae4a", "committedDate": "2020-03-30T09:06:24Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9a356082bb97d20d4e06629de4c2109730bae4a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a9a356082bb97d20d4e06629de4c2109730bae4a", "committedDate": "2020-03-30T09:06:24Z", "message": "TEMP"}, "afterCommit": {"oid": "ae0da673af97ad124e28826da6800ad0dd3bdfe9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ae0da673af97ad124e28826da6800ad0dd3bdfe9", "committedDate": "2020-03-30T09:07:27Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae0da673af97ad124e28826da6800ad0dd3bdfe9", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ae0da673af97ad124e28826da6800ad0dd3bdfe9", "committedDate": "2020-03-30T09:07:27Z", "message": "TEMP"}, "afterCommit": {"oid": "b7b41dd040c1bf0c8985df233b37645380b9f474", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b7b41dd040c1bf0c8985df233b37645380b9f474", "committedDate": "2020-03-30T10:53:47Z", "message": "TEMP2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b7b41dd040c1bf0c8985df233b37645380b9f474", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b7b41dd040c1bf0c8985df233b37645380b9f474", "committedDate": "2020-03-30T10:53:47Z", "message": "TEMP2"}, "afterCommit": {"oid": "1c9d92a7de02be69f45bb4187c8d618ba25bb811", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1c9d92a7de02be69f45bb4187c8d618ba25bb811", "committedDate": "2020-03-30T13:05:24Z", "message": "fixup2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c9d92a7de02be69f45bb4187c8d618ba25bb811", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1c9d92a7de02be69f45bb4187c8d618ba25bb811", "committedDate": "2020-03-30T13:05:24Z", "message": "fixup2"}, "afterCommit": {"oid": "9ece69d2467e94536243b62fc0de5900c2d3b4c5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9ece69d2467e94536243b62fc0de5900c2d3b4c5", "committedDate": "2020-03-30T13:18:02Z", "message": "fixup2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9ece69d2467e94536243b62fc0de5900c2d3b4c5", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9ece69d2467e94536243b62fc0de5900c2d3b4c5", "committedDate": "2020-03-30T13:18:02Z", "message": "fixup2"}, "afterCommit": {"oid": "c9e04aa86c7872518476533353fbf9d03a151a2a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c9e04aa86c7872518476533353fbf9d03a151a2a", "committedDate": "2020-03-30T13:35:40Z", "message": "fixup2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9e04aa86c7872518476533353fbf9d03a151a2a", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c9e04aa86c7872518476533353fbf9d03a151a2a", "committedDate": "2020-03-30T13:35:40Z", "message": "fixup2"}, "afterCommit": {"oid": "e285fff58100ac0b78388b5065d267de82b6c635", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e285fff58100ac0b78388b5065d267de82b6c635", "committedDate": "2020-03-30T13:37:17Z", "message": "fixup2"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e285fff58100ac0b78388b5065d267de82b6c635", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e285fff58100ac0b78388b5065d267de82b6c635", "committedDate": "2020-03-30T13:37:17Z", "message": "fixup2"}, "afterCommit": {"oid": "cc2f342a0d9bf9150fb39b1055c1f81a41316503", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cc2f342a0d9bf9150fb39b1055c1f81a41316503", "committedDate": "2020-03-30T14:00:19Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cc2f342a0d9bf9150fb39b1055c1f81a41316503", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cc2f342a0d9bf9150fb39b1055c1f81a41316503", "committedDate": "2020-03-30T14:00:19Z", "message": "TEMP"}, "afterCommit": {"oid": "9cf95e3a5da3342b82f33945772f4c1cc33fac5e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9cf95e3a5da3342b82f33945772f4c1cc33fac5e", "committedDate": "2020-03-30T14:08:31Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9cf95e3a5da3342b82f33945772f4c1cc33fac5e", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9cf95e3a5da3342b82f33945772f4c1cc33fac5e", "committedDate": "2020-03-30T14:08:31Z", "message": "TEMP"}, "afterCommit": {"oid": "a3440709a7a25c133a0e77152bb72725236f6d7b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a3440709a7a25c133a0e77152bb72725236f6d7b", "committedDate": "2020-03-30T15:06:30Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a3440709a7a25c133a0e77152bb72725236f6d7b", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a3440709a7a25c133a0e77152bb72725236f6d7b", "committedDate": "2020-03-30T15:06:30Z", "message": "TEMP"}, "afterCommit": {"oid": "14f71fd04bd15c93a7cfae0f1f5f1732380cab0c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/14f71fd04bd15c93a7cfae0f1f5f1732380cab0c", "committedDate": "2020-03-30T15:15:02Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "14f71fd04bd15c93a7cfae0f1f5f1732380cab0c", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/14f71fd04bd15c93a7cfae0f1f5f1732380cab0c", "committedDate": "2020-03-30T15:15:02Z", "message": "TEMP"}, "afterCommit": {"oid": "49ffe87a5c2bacc9a3cdf4fb4b29f052160d5439", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/49ffe87a5c2bacc9a3cdf4fb4b29f052160d5439", "committedDate": "2020-03-30T15:19:30Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "49ffe87a5c2bacc9a3cdf4fb4b29f052160d5439", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/49ffe87a5c2bacc9a3cdf4fb4b29f052160d5439", "committedDate": "2020-03-30T15:19:30Z", "message": "TEMP"}, "afterCommit": {"oid": "82e05e292517fc51f8e15a58afac75ae418eb314", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/82e05e292517fc51f8e15a58afac75ae418eb314", "committedDate": "2020-03-30T15:22:19Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "82e05e292517fc51f8e15a58afac75ae418eb314", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/82e05e292517fc51f8e15a58afac75ae418eb314", "committedDate": "2020-03-30T15:22:19Z", "message": "TEMP"}, "afterCommit": {"oid": "1ca12f3b09d2d8a075393c056fc99cbb1db93a67", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1ca12f3b09d2d8a075393c056fc99cbb1db93a67", "committedDate": "2020-03-30T15:26:44Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ca12f3b09d2d8a075393c056fc99cbb1db93a67", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/1ca12f3b09d2d8a075393c056fc99cbb1db93a67", "committedDate": "2020-03-30T15:26:44Z", "message": "TEMP"}, "afterCommit": {"oid": "8d26231f70cd1ae5a85023f3d3a7e5ae08434fa3", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8d26231f70cd1ae5a85023f3d3a7e5ae08434fa3", "committedDate": "2020-03-30T15:45:37Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d26231f70cd1ae5a85023f3d3a7e5ae08434fa3", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/8d26231f70cd1ae5a85023f3d3a7e5ae08434fa3", "committedDate": "2020-03-30T15:45:37Z", "message": "TEMP"}, "afterCommit": {"oid": "123ad8dad3dc523dfcef177b79eea2816bf06a42", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/123ad8dad3dc523dfcef177b79eea2816bf06a42", "committedDate": "2020-03-30T16:01:44Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "123ad8dad3dc523dfcef177b79eea2816bf06a42", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/123ad8dad3dc523dfcef177b79eea2816bf06a42", "committedDate": "2020-03-30T16:01:44Z", "message": "TEMP"}, "afterCommit": {"oid": "a519071478e08d0fafb0010ce4113269c444ff45", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a519071478e08d0fafb0010ce4113269c444ff45", "committedDate": "2020-03-30T16:25:38Z", "message": "TEMP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a519071478e08d0fafb0010ce4113269c444ff45", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/a519071478e08d0fafb0010ce4113269c444ff45", "committedDate": "2020-03-30T16:25:38Z", "message": "TEMP"}, "afterCommit": {"oid": "86667e5f50ca98ce5746690fc622c6a1ce106dad", "author": {"user": {"login": "NourNuxeo", "name": "Nour AL KOTOB"}}, "url": "https://github.com/nuxeo/nuxeo/commit/86667e5f50ca98ce5746690fc622c6a1ce106dad", "committedDate": "2020-03-30T16:39:35Z", "message": "TEMP"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDgxOTg4", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-384481988", "createdAt": "2020-03-31T07:51:24Z", "commit": {"oid": "155ec563e2df40faa1251b96a8334f801d1d1bab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNzo1MToyNFrOF-JZZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNzo1MToyNFrOF-JZZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDcwOTk4OQ==", "bodyText": "extra spaces", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r400709989", "createdAt": "2020-03-31T07:51:24Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -284,8 +288,15 @@ pipeline {\n     CHANGE_BRANCH = \"${env.CHANGE_BRANCH != null ? env.CHANGE_BRANCH : BRANCH_NAME}\"\n     CHANGE_TARGET = \"${env.CHANGE_TARGET != null ? env.CHANGE_TARGET : BRANCH_NAME}\"\n     CONNECT_PREPROD_URL = 'https://nos-preprod-connect.nuxeocloud.com/nuxeo'\n+    // Required by the jx preview command: https://github.com/jenkins-x/jx/blob/8fdc3a1182bc3ed6ae09728721b53ea4fa1d6234/pkg/cmd/preview/preview.go#L1007\n+    ORG = \"nuxeo\"\n+    // Required by the jx preview command: https://github.com/jenkins-x/jx/blob/8fdc3a1182bc3ed6ae09728721b53ea4fa1d6234/pkg/cmd/preview/preview.go#L1015\n+    APP_NAME = \"nuxeo\"\n+    TEST_NAMESPACE = \"$APP_NAME-${BRANCH_NAME.toLowerCase()}\"\n+    PERSISTENCE = !isPullRequest()\n+    DEBUG_OPTION = getDebugOption()\n   }\n-\n+  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155ec563e2df40faa1251b96a8334f801d1d1bab"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDgyNjM1", "url": "https://github.com/nuxeo/nuxeo/pull/3856#pullrequestreview-384482635", "createdAt": "2020-03-31T07:52:18Z", "commit": {"oid": "155ec563e2df40faa1251b96a8334f801d1d1bab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNzo1MjoxOFrOF-Jbag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNzo1MjoxOFrOF-Jbag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDcxMDUwNg==", "bodyText": "You marked as resolved but kept nuxeo/preview/deploy, we're suggesting simply nuxeo/preview.", "url": "https://github.com/nuxeo/nuxeo/pull/3856#discussion_r400710506", "createdAt": "2020-03-31T07:52:18Z", "author": {"login": "ataillefer"}, "path": "Jenkinsfile", "diffHunk": "@@ -632,6 +643,63 @@ pipeline {\n       }\n     }\n \n+    stage('Deploy Preview') {\n+      when {\n+        not {\n+          branch 'PR-*'\n+        }\n+      }\n+      steps {\n+        setGitHubBuildStatus('nuxeo/preview/deploy', 'Deploy nuxeo Preview', 'PENDING')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "155ec563e2df40faa1251b96a8334f801d1d1bab"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4810, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}