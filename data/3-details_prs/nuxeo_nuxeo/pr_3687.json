{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1OTk3OTky", "number": 3687, "title": "feature-NXP-28537-upgrade-dependencies", "bodyText": "PR created from https://qa.nuxeo.org/jenkins/job/TestAndPush/job/ondemand-testandpush-fguillaume-2/208/", "createdAt": "2020-01-22T18:23:00Z", "url": "https://github.com/nuxeo/nuxeo/pull/3687", "merged": true, "mergeCommit": {"oid": "ccec375a393eaa2fe718305b512769b9ddf76402"}, "closed": true, "closedAt": "2020-01-23T09:44:00Z", "author": {"login": "nuxeojenkins"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb82ooFAH2gAyMzY1OTk3OTkyOmVhN2VmM2I0MmUyODg0NzcyOGQ3M2FiNGFhYTEzZjY2MTVmZjhmZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9HINsgFqTM0NzE2NTEwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ea7ef3b42e28847728d73ab4aaa13f6615ff8fd4", "author": {"user": {"login": "efge", "name": "Florent Guillaume"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ea7ef3b42e28847728d73ab4aaa13f6615ff8fd4", "committedDate": "2020-01-22T14:29:38Z", "message": "NXP-28537: upgrade various dependencies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2ODQ3NDk5", "url": "https://github.com/nuxeo/nuxeo/pull/3687#pullrequestreview-346847499", "createdAt": "2020-01-22T19:33:28Z", "commit": {"oid": "df975063024e49cadbd45202264031a192b33e10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTozMzoyOVrOFgoaLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTozMzoyOVrOFgoaLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTc2MDgxMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // bad badding\n          \n          \n            \n                    // bad padding", "url": "https://github.com/nuxeo/nuxeo/pull/3687#discussion_r369760813", "createdAt": "2020-01-22T19:33:29Z", "author": {"login": "ataillefer"}, "path": "nuxeo-common/src/test/java/org/nuxeo/common/codec/CryptoTest.java", "diffHunk": "@@ -98,18 +98,22 @@ public void testDecryptionFailSilently() throws Exception {\n         assertFalse(Crypto.isEncrypted(\"\"));\n         assertFalse(Crypto.isEncrypted(\"{$$}\"));\n \n+        // bad padding\n         String encryptedString = \"{$$xoWODkBtRXnsdzIBdosUFA==}\";\n         String decryptedString = new String(crypto.decrypt(encryptedString));\n         assertEquals(\"Decryption must fail silently\", decryptedString, encryptedString);\n \n+        // last block FB== is not valid (B is not a possible value)\n         encryptedString = \"{$$xoWODkCtRXnSuqIBdosUFB==}\";\n         decryptedString = new String(crypto.decrypt(encryptedString));\n         assertEquals(\"Decryption must fail silently\", decryptedString, encryptedString);\n \n+        // illegal block size\n         encryptedString = \"{$REVTL0VDQi9QS0NTNVBhZGRpbmc=$w/wCDLXoGsasskNaEpMt0wg==}\";\n         decryptedString = new String(crypto.decrypt(encryptedString));\n         assertEquals(\"Decryption must fail silently\", decryptedString, encryptedString);\n \n+        // bad badding", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df975063024e49cadbd45202264031a192b33e10"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2ODQ5Mjc0", "url": "https://github.com/nuxeo/nuxeo/pull/3687#pullrequestreview-346849274", "createdAt": "2020-01-22T19:36:25Z", "commit": {"oid": "df975063024e49cadbd45202264031a192b33e10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTozNjoyNVrOFgofQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTozNjoyNVrOFgofQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTc2MjExNA==", "bodyText": "What's the point of logging the beginning of the content?", "url": "https://github.com/nuxeo/nuxeo/pull/3687#discussion_r369762114", "createdAt": "2020-01-22T19:36:25Z", "author": {"login": "ataillefer"}, "path": "nuxeo-core/nuxeo-core-io/src/main/java/org/nuxeo/ecm/core/io/impl/AbstractDocumentModelWriter.java", "diffHunk": "@@ -382,7 +383,18 @@ private static Object getElementData(ExportedDocument xdoc, Element element, Typ\n                 }\n                 if (blob == null) { // maybe the blob is embedded in Base64\n                     // encoded data\n-                    byte[] bytes = Base64.decodeBase64(content);\n+                    byte[] bytes;\n+                    try {\n+                        bytes = Base64.decodeBase64(content);\n+                    } catch (IllegalArgumentException e) {\n+                        // example invalid base64: fd7b9e4.blob\n+                        if (log.isDebugEnabled()) {\n+                            log.warn(\"Invalid blob base64 in document: \" + xdoc.getId() + \": \" + StringUtils.abbreviate(content, 50));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df975063024e49cadbd45202264031a192b33e10"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2ODUwMjgx", "url": "https://github.com/nuxeo/nuxeo/pull/3687#pullrequestreview-346850281", "createdAt": "2020-01-22T19:38:02Z", "commit": {"oid": "df975063024e49cadbd45202264031a192b33e10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTozODowMlrOFgoiMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxOTozODowMlrOFgoiMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTc2Mjg2Nw==", "bodyText": "Isn't false the default value?\nAnd why this change? Maybe add a comment to explain the semantics.", "url": "https://github.com/nuxeo/nuxeo/pull/3687#discussion_r369762867", "createdAt": "2020-01-22T19:38:02Z", "author": {"login": "ataillefer"}, "path": "nuxeo-core/nuxeo-core-test/src/test/java/org/nuxeo/ecm/core/io/transform/BaseExport.java", "diffHunk": "@@ -36,7 +36,7 @@\n \n     String uuid;\n \n-    protected boolean skipBlobs = true;\n+    protected boolean skipBlobs = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df975063024e49cadbd45202264031a192b33e10"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f57f666a95722fb259906d635190bd1841af476", "author": {"user": {"login": "efge", "name": "Florent Guillaume"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5f57f666a95722fb259906d635190bd1841af476", "committedDate": "2020-01-22T20:05:04Z", "message": "NXP-28537: upgrade commons-codec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c951666abb28c32cbd38ca8ffa48b054e421f00f", "author": {"user": {"login": "efge", "name": "Florent Guillaume"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c951666abb28c32cbd38ca8ffa48b054e421f00f", "committedDate": "2020-01-22T20:05:04Z", "message": "NXP-28537: upgrade javax.mail"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f48dbc1767e2c721b2a519fb7ab39a6bd4f8c34b", "author": {"user": {"login": "efge", "name": "Florent Guillaume"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f48dbc1767e2c721b2a519fb7ab39a6bd4f8c34b", "committedDate": "2020-01-22T14:29:38Z", "message": "NXP-28537: upgrade javax.mail"}, "afterCommit": {"oid": "c951666abb28c32cbd38ca8ffa48b054e421f00f", "author": {"user": {"login": "efge", "name": "Florent Guillaume"}}, "url": "https://github.com/nuxeo/nuxeo/commit/c951666abb28c32cbd38ca8ffa48b054e421f00f", "committedDate": "2020-01-22T20:05:04Z", "message": "NXP-28537: upgrade javax.mail"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2ODc1ODEy", "url": "https://github.com/nuxeo/nuxeo/pull/3687#pullrequestreview-346875812", "createdAt": "2020-01-22T20:20:25Z", "commit": {"oid": "c951666abb28c32cbd38ca8ffa48b054e421f00f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2OTM0MjY0", "url": "https://github.com/nuxeo/nuxeo/pull/3687#pullrequestreview-346934264", "createdAt": "2020-01-22T22:01:19Z", "commit": {"oid": "5f57f666a95722fb259906d635190bd1841af476"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQyMjowMToxOVrOFgsgfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQyMjowMToxOVrOFgsgfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTgyNzk2Ng==", "bodyText": "Why doing several bad padding cases ? Maybe the answer should be in the comments ?\nHow about extracting the error message in a local variable ?", "url": "https://github.com/nuxeo/nuxeo/pull/3687#discussion_r369827966", "createdAt": "2020-01-22T22:01:19Z", "author": {"login": "NourNuxeo"}, "path": "nuxeo-common/src/test/java/org/nuxeo/common/codec/CryptoTest.java", "diffHunk": "@@ -98,18 +98,22 @@ public void testDecryptionFailSilently() throws Exception {\n         assertFalse(Crypto.isEncrypted(\"\"));\n         assertFalse(Crypto.isEncrypted(\"{$$}\"));\n \n+        // bad padding\n         String encryptedString = \"{$$xoWODkBtRXnsdzIBdosUFA==}\";\n         String decryptedString = new String(crypto.decrypt(encryptedString));\n         assertEquals(\"Decryption must fail silently\", decryptedString, encryptedString);\n \n+        // last block FB== is not valid (B is not a possible value)\n         encryptedString = \"{$$xoWODkCtRXnSuqIBdosUFB==}\";\n         decryptedString = new String(crypto.decrypt(encryptedString));\n         assertEquals(\"Decryption must fail silently\", decryptedString, encryptedString);\n \n+        // illegal block size\n         encryptedString = \"{$REVTL0VDQi9QS0NTNVBhZGRpbmc=$w/wCDLXoGsasskNaEpMt0wg==}\";\n         decryptedString = new String(crypto.decrypt(encryptedString));\n         assertEquals(\"Decryption must fail silently\", decryptedString, encryptedString);\n \n+        // bad padding\n         encryptedString = \"{$REVTL0VDQi9QS0NTNVBhZGRpbmc=$w/wCDLXoG5VFkNbEpMt0wg==}\";\n         decryptedString = new String(crypto.decrypt(encryptedString));\n         assertEquals(\"Decryption must fail silently\", decryptedString, encryptedString);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f57f666a95722fb259906d635190bd1841af476"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MTY1MTA3", "url": "https://github.com/nuxeo/nuxeo/pull/3687#pullrequestreview-347165107", "createdAt": "2020-01-23T09:42:37Z", "commit": {"oid": "c951666abb28c32cbd38ca8ffa48b054e421f00f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4885, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}