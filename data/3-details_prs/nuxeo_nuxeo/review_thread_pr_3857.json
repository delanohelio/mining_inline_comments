{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzMDE1ODAx", "number": 3857, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMzoxNDoyMVrODrNMtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoxMjo1OVrODrUHgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NjMxNjA1OnYy", "diffSide": "RIGHT", "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMzoxNDoyMlrOF7aYew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMzo1Nzo0OVrOF7cS0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0MjU1NQ==", "bodyText": "Why not in the if? If the mode is not compliance, there is no need for this component to require something as it will be empty.", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397842555", "createdAt": "2020-03-25T13:14:22Z", "author": {"login": "troger"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,23 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">\n+\n+    <require>org.nuxeo.retention.types</require>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0ODczMQ==", "bodyText": "My rational here was to avoid this contribution to be loaded before retention.types since I wasn't able to be sure how template and contribs engine works and if there is any chance of that to happen.", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397848731", "createdAt": "2020-03-25T13:23:42Z", "author": {"login": "nmpcunha"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,23 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">\n+\n+    <require>org.nuxeo.retention.types</require>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0MjU1NQ=="}, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg2Nzc5NQ==", "bodyText": "It is not possible to have that scenario? If not I'll move that line \ud83d\ude42", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397867795", "createdAt": "2020-03-25T13:49:55Z", "author": {"login": "nmpcunha"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,23 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">\n+\n+    <require>org.nuxeo.retention.types</require>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0MjU1NQ=="}, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg3Mzg3Mg==", "bodyText": "You're right, it's better to have the require, but it's only needed when the component is not empty, so you can move that require with the other one, inside the if. If the component is empty, we don't care if it's loaded before or after org.nuxeo.retention.types.", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397873872", "createdAt": "2020-03-25T13:57:49Z", "author": {"login": "troger"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,23 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">\n+\n+    <require>org.nuxeo.retention.types</require>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0MjU1NQ=="}, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NjMxODQ4OnYy", "diffSide": "RIGHT", "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMzoxNTowMFrOF7aaFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMzoxNTowMFrOF7aaFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0Mjk2Nw==", "bodyText": "Empty line to be removed.", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397842967", "createdAt": "2020-03-25T13:15:00Z", "author": {"login": "troger"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,23 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">\n+\n+    <require>org.nuxeo.retention.types</require>\n+\n+<#if \"${nuxeo.retention.mode}\" == \"compliance\">\n+    <require>org.nuxeo.ecm.core.schema.TypeService</require>\n+\n+    <extension target=\"org.nuxeo.ecm.core.schema.TypeService\" point=\"schema\">\n+        <schema name=\"files\" enabled=\"false\" />\n+    </extension>\n+\n+    <extension target=\"org.nuxeo.ecm.core.schema.TypeService\" point=\"doctype\">\n+        <facet name=\"Commentable\" enabled=\"false\" />\n+        <facet name=\"Publishable\" enabled=\"false\" />\n+        <facet name=\"Versionable\" enabled=\"false\" />\n+    </extension>\n+\n+</#if>\n+\n+</component>\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NjM1NzA0OnYy", "diffSide": "RIGHT", "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nuxeo.defaults", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMzoyNDowNlrOF7ax0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNTo1NjoxNFrOF7iEvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0OTA0Mw==", "bodyText": "Will we have more than 2 modes? If no, I would probably go for a \"boolean\".", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397849043", "createdAt": "2020-03-25T13:24:06Z", "author": {"login": "troger"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nuxeo.defaults", "diffHunk": "@@ -0,0 +1,5 @@\n+## DO NOT EDIT THIS FILE, USE nuxeo.conf  ##\n+nuxeo.template.includes=\n+retention.target=.\n+\n+nuxeo.retention.mode=standard", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg1MDgzMw==", "bodyText": "Not for now.\nAs far as I was able to understand, we can have \"booleans\" but at the end of the day they are strings, in fact.\nThis way it was to try to map directly what is on our requirements, but I would also be ok with nuxeo.retention.compliant with \"true\" or \"false\"", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397850833", "createdAt": "2020-03-25T13:26:34Z", "author": {"login": "nmpcunha"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nuxeo.defaults", "diffHunk": "@@ -0,0 +1,5 @@\n+## DO NOT EDIT THIS FILE, USE nuxeo.conf  ##\n+nuxeo.template.includes=\n+retention.target=.\n+\n+nuxeo.retention.mode=standard", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0OTA0Mw=="}, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg3NTA0OQ==", "bodyText": "I find it easier to understand/read if it's just \"enable or not the compliance mode\" :)\nLet's add people to the conversation! WDYT @efge @RSalem07 ?", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397875049", "createdAt": "2020-03-25T13:59:15Z", "author": {"login": "troger"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nuxeo.defaults", "diffHunk": "@@ -0,0 +1,5 @@\n+## DO NOT EDIT THIS FILE, USE nuxeo.conf  ##\n+nuxeo.template.includes=\n+retention.target=.\n+\n+nuxeo.retention.mode=standard", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0OTA0Mw=="}, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg3NzUxMA==", "bodyText": "from my point of view, as we have only the compliance mode enable or disabled (standard) we can use boolean, which also avoid string comparaison any any typo error", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397877510", "createdAt": "2020-03-25T14:02:25Z", "author": {"login": "RSalem07"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nuxeo.defaults", "diffHunk": "@@ -0,0 +1,5 @@\n+## DO NOT EDIT THIS FILE, USE nuxeo.conf  ##\n+nuxeo.template.includes=\n+retention.target=.\n+\n+nuxeo.retention.mode=standard", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0OTA0Mw=="}, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk2ODU3NA==", "bodyText": "I'd have chosen nuxeo.retention.compliance.enabled=true/false", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397968574", "createdAt": "2020-03-25T15:56:14Z", "author": {"login": "efge"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nuxeo.defaults", "diffHunk": "@@ -0,0 +1,5 @@\n+## DO NOT EDIT THIS FILE, USE nuxeo.conf  ##\n+nuxeo.template.includes=\n+retention.target=.\n+\n+nuxeo.retention.mode=standard", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg0OTA0Mw=="}, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NjQ2ODQyOnYy", "diffSide": "RIGHT", "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nuxeo.defaults", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMzo0ODo1MlrOF7b3rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMzo0ODo1MlrOF7b3rw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg2NjkyNw==", "bodyText": "needs a break line at the end of the file.", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r397866927", "createdAt": "2020-03-25T13:48:52Z", "author": {"login": "RSalem07"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nuxeo.defaults", "diffHunk": "@@ -0,0 +1,5 @@\n+## DO NOT EDIT THIS FILE, USE nuxeo.conf  ##\n+nuxeo.template.includes=\n+retention.target=.\n+\n+nuxeo.retention.mode=standard", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a213dfcebc7e32c15f1da0c3aa821b6e55565309"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NzQ0NTAyOnYy", "diffSide": "RIGHT", "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoxMTo1NVrOF7llgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoxNjozMFrOF7lzQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyNjExNA==", "bodyText": "Please remove the blank line before <component as well.", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r398026114", "createdAt": "2020-03-25T17:11:55Z", "author": {"login": "efge"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,19 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88485d18b4e460c62d17064807aa5b7efb1e1a30"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyOTYzNQ==", "bodyText": "Can remove \ud83d\udc4d\nBut, just to clarify, it is consistent with the examples provided \ud83d\ude09", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r398029635", "createdAt": "2020-03-25T17:16:30Z", "author": {"login": "nmpcunha"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,19 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyNjExNA=="}, "originalCommit": {"oid": "88485d18b4e460c62d17064807aa5b7efb1e1a30"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2NzQ0OTYwOnYy", "diffSide": "RIGHT", "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoxMjo1OVrOF7lokA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzoyMjoyMFrOF7mDiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyNjg5Ng==", "bodyText": "This <require> is useless, it's implicit in the fact that we use extension points from this component.", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r398026896", "createdAt": "2020-03-25T17:12:59Z", "author": {"login": "efge"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,19 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">\n+<#if \"${nuxeo.retention.compliance.enabled}\" == \"true\">\n+    <require>org.nuxeo.retention.types</require>\n+    <require>org.nuxeo.ecm.core.schema.TypeService</require>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88485d18b4e460c62d17064807aa5b7efb1e1a30"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyODQ5Mg==", "bodyText": "What about loading order as we discussed above? Is there any chance that this specific contribution is loaded before org.nuxeo.retention.types?", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r398028492", "createdAt": "2020-03-25T17:15:06Z", "author": {"login": "nmpcunha"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,19 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">\n+<#if \"${nuxeo.retention.compliance.enabled}\" == \"true\">\n+    <require>org.nuxeo.retention.types</require>\n+    <require>org.nuxeo.ecm.core.schema.TypeService</require>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyNjg5Ng=="}, "originalCommit": {"oid": "88485d18b4e460c62d17064807aa5b7efb1e1a30"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAzMzgwMQ==", "bodyText": "point is to keep <require>org.nuxeo.retention.types</require> but drop the <require>org.nuxeo.ecm.core.schema.TypeService</require>  since you're already making contributions to it", "url": "https://github.com/nuxeo/nuxeo/pull/3857#discussion_r398033801", "createdAt": "2020-03-25T17:22:20Z", "author": {"login": "nelsonsilva"}, "path": "packages/nuxeo-retention-package/src/main/resources/install/templates/retention/nxserver/config/retention-compliance-config.xml.nxftl", "diffHunk": "@@ -0,0 +1,19 @@\n+<?xml version=\"1.0\"?>\n+\n+<component name=\"org.nuxeo.retention.compliance.types\">\n+<#if \"${nuxeo.retention.compliance.enabled}\" == \"true\">\n+    <require>org.nuxeo.retention.types</require>\n+    <require>org.nuxeo.ecm.core.schema.TypeService</require>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyNjg5Ng=="}, "originalCommit": {"oid": "88485d18b4e460c62d17064807aa5b7efb1e1a30"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4209, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}