{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NDYzNjgz", "number": 4452, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOToyNjo0MlrOE4En6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOTozMTo1MFrOE4EwXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3MjMxNDY0OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/DocRequestFilter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOToyNjo0MlrOHxx2yQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOToyNjo0MlrOHxx2yQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk1OTExMw==", "bodyText": "extra { I guess", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521959113", "createdAt": "2020-11-12T09:26:42Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/DocRequestFilter.java", "diffHunk": "@@ -32,23 +32,33 @@\n \n     private final String indices;\n \n-    private final String types;\n+    /** @deprecated since 11.4, types have been removed since Elasticsearch 7.x */\n+    @Deprecated\n+    private final String types = null;\n \n     private final String documentId;\n \n     private final String rawQuery;\n \n-    public DocRequestFilter(NuxeoPrincipal principal, String indices, String types, String documentId,\n-            String rawQuery) {\n+    public DocRequestFilter(NuxeoPrincipal principal, String indices, String documentId, String rawQuery) {\n         this.principal = principal;\n         this.indices = indices;\n-        this.types = types;\n         this.documentId = documentId;\n         this.rawQuery = rawQuery;\n     }\n \n+    /**\n+     * @deprecated since 11.4, types have been removed since Elasticsearch 7.x, use\n+     *             {{@link #DocRequestFilter(NuxeoPrincipal, String, String, String)} instead", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3MjMxODk2OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/Main.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOToyNzo0MlrOHxx5gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOToyNzo0MlrOHxx5gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk1OTgxMA==", "bodyText": "extra {, and the following ones", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521959810", "createdAt": "2020-11-12T09:27:42Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/Main.java", "diffHunk": "@@ -101,37 +100,58 @@ public String searchWithPayload(@PathParam(\"indices\") String indices, @Context U\n     @Produces(MediaType.APPLICATION_JSON)\n     public String searchWithPost(@PathParam(\"indices\") String indices, @Context UriInfo uriInf, String payload)\n             throws IOException, JSONException {\n-        return doSearchWithPayload(indices, \"_all\", uriInf.getRequestUri().getRawQuery(), payload);\n+        return doSearchWithPayload(indices, uriInf.getRequestUri().getRawQuery(), payload);\n     }\n \n+    /**\n+     * @deprecated since 11.4, types have been removed since Elasticsearch 7.x, use\n+     *             {{@link #searchWithPayload(String, UriInfo, MultivaluedMap)} instead", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3MjMyMzEzOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/Main.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOToyODo0NVrOHxx8QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOTo0MDoyOFrOHxyZmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2MDUxMg==", "bodyText": "don't we want the since in the annotation?", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521960512", "createdAt": "2020-11-12T09:28:45Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/Main.java", "diffHunk": "@@ -101,37 +100,58 @@ public String searchWithPayload(@PathParam(\"indices\") String indices, @Context U\n     @Produces(MediaType.APPLICATION_JSON)\n     public String searchWithPost(@PathParam(\"indices\") String indices, @Context UriInfo uriInf, String payload)\n             throws IOException, JSONException {\n-        return doSearchWithPayload(indices, \"_all\", uriInf.getRequestUri().getRawQuery(), payload);\n+        return doSearchWithPayload(indices, uriInf.getRequestUri().getRawQuery(), payload);\n     }\n \n+    /**\n+     * @deprecated since 11.4, types have been removed since Elasticsearch 7.x, use\n+     *             {{@link #searchWithPayload(String, UriInfo, MultivaluedMap)} instead\n+     */\n     @GET\n     @Path(\"{indices}/{types}/_search\")\n     @Consumes(MediaType.APPLICATION_FORM_URLENCODED)\n     @Produces(MediaType.APPLICATION_JSON)\n+    @Deprecated", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2ODAyNw==", "bodyText": "Indeed, forRemoval added too.", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521968027", "createdAt": "2020-11-12T09:40:28Z", "author": {"login": "kevinleturc"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/main/java/org/nuxeo/elasticsearch/http/readonly/Main.java", "diffHunk": "@@ -101,37 +100,58 @@ public String searchWithPayload(@PathParam(\"indices\") String indices, @Context U\n     @Produces(MediaType.APPLICATION_JSON)\n     public String searchWithPost(@PathParam(\"indices\") String indices, @Context UriInfo uriInf, String payload)\n             throws IOException, JSONException {\n-        return doSearchWithPayload(indices, \"_all\", uriInf.getRequestUri().getRawQuery(), payload);\n+        return doSearchWithPayload(indices, uriInf.getRequestUri().getRawQuery(), payload);\n     }\n \n+    /**\n+     * @deprecated since 11.4, types have been removed since Elasticsearch 7.x, use\n+     *             {{@link #searchWithPayload(String, UriInfo, MultivaluedMap)} instead\n+     */\n     @GET\n     @Path(\"{indices}/{types}/_search\")\n     @Consumes(MediaType.APPLICATION_FORM_URLENCODED)\n     @Produces(MediaType.APPLICATION_JSON)\n+    @Deprecated", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2MDUxMg=="}, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3MjMzNjMxOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/test/java/org/nuxeo/elasticsearch/http/readonly/TestRequestValidator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOTozMTo1MFrOHxyEXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQwOTozNjo0OFrOHxyQkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2MjU4OQ==", "bodyText": "why?", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521962589", "createdAt": "2020-11-12T09:31:50Z", "author": {"login": "ataillefer"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/test/java/org/nuxeo/elasticsearch/http/readonly/TestRequestValidator.java", "diffHunk": "@@ -47,14 +47,18 @@ public void initValidator() {\n     }\n \n     @Test\n-    public void testCheckValidDocumentId() throws Exception {\n+    public void testCheckValidDocumentId() {\n         validator.checkValidDocumentId(\"123\");\n         exception.expect(IllegalArgumentException.class);\n         validator.checkValidDocumentId(null);\n     }\n \n+    /**\n+     * @since 11.4", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2NTcxMg==", "bodyText": "My bad, it should be a @deprecated since 11.4.", "url": "https://github.com/nuxeo/nuxeo/pull/4452#discussion_r521965712", "createdAt": "2020-11-12T09:36:48Z", "author": {"login": "kevinleturc"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-http-read-only/src/test/java/org/nuxeo/elasticsearch/http/readonly/TestRequestValidator.java", "diffHunk": "@@ -47,14 +47,18 @@ public void initValidator() {\n     }\n \n     @Test\n-    public void testCheckValidDocumentId() throws Exception {\n+    public void testCheckValidDocumentId() {\n         validator.checkValidDocumentId(\"123\");\n         exception.expect(IllegalArgumentException.class);\n         validator.checkValidDocumentId(null);\n     }\n \n+    /**\n+     * @since 11.4", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTk2MjU4OQ=="}, "originalCommit": {"oid": "341948787efc89622a1b66228ac74ffdda9a0add"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4336, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}