{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2ODYwOTM0", "number": 4318, "title": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests", "bodyText": "", "createdAt": "2020-09-14T20:21:19Z", "url": "https://github.com/nuxeo/nuxeo/pull/4318", "merged": true, "mergeCommit": {"oid": "02bcc6328c0d3b5530b173ddc223926d3de0a0db"}, "closed": true, "closedAt": "2020-09-17T13:53:22Z", "author": {"login": "ataillefer"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJGxrpgFqTQ4ODYxOTUzNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJxTi3gFqTQ5MDYxNDU3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NjE5NTM3", "url": "https://github.com/nuxeo/nuxeo/pull/4318#pullrequestreview-488619537", "createdAt": "2020-09-15T12:16:15Z", "commit": {"oid": "9b777712407f7d560a7166374f7080756b969fa9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NjYxNTIw", "url": "https://github.com/nuxeo/nuxeo/pull/4318#pullrequestreview-488661520", "createdAt": "2020-09-15T13:07:11Z", "commit": {"oid": "9b777712407f7d560a7166374f7080756b969fa9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b777712407f7d560a7166374f7080756b969fa9", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9b777712407f7d560a7166374f7080756b969fa9", "committedDate": "2020-09-14T20:12:14Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}, "afterCommit": {"oid": "5666e8a74070ec7f4038f3898e3a5fdd60431fc3", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5666e8a74070ec7f4038f3898e3a5fdd60431fc3", "committedDate": "2020-09-15T15:15:04Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5666e8a74070ec7f4038f3898e3a5fdd60431fc3", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5666e8a74070ec7f4038f3898e3a5fdd60431fc3", "committedDate": "2020-09-15T15:15:04Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}, "afterCommit": {"oid": "cc63dc892b64adab1f16392068de379e6ed42e95", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cc63dc892b64adab1f16392068de379e6ed42e95", "committedDate": "2020-09-15T22:13:37Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90c65117cba02b5810c1ae938b7a3ffa9b44b28c", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/90c65117cba02b5810c1ae938b7a3ffa9b44b28c", "committedDate": "2020-09-16T08:59:06Z", "message": "NXP-29652: Fix some SonarQube issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cc63dc892b64adab1f16392068de379e6ed42e95", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/cc63dc892b64adab1f16392068de379e6ed42e95", "committedDate": "2020-09-15T22:13:37Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}, "afterCommit": {"oid": "5a55f88d83b1b45b79646acfd1d475635c701d6b", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5a55f88d83b1b45b79646acfd1d475635c701d6b", "committedDate": "2020-09-16T08:59:34Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NzA4Njc4", "url": "https://github.com/nuxeo/nuxeo/pull/4318#pullrequestreview-489708678", "createdAt": "2020-09-16T14:51:18Z", "commit": {"oid": "5a55f88d83b1b45b79646acfd1d475635c701d6b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNDo1MToxOFrOHS0tEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxNDo1MToxOFrOHS0tEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQ5OTkyMw==", "bodyText": "What's the point of keeping commented code/test here? It will be never executed/run.", "url": "https://github.com/nuxeo/nuxeo/pull/4318#discussion_r489499923", "createdAt": "2020-09-16T14:51:18Z", "author": {"login": "troger"}, "path": "modules/platform/nuxeo-elasticsearch/nuxeo-elasticsearch-core/src/test/java/org/nuxeo/elasticsearch/test/TestMapping.java", "diffHunk": "@@ -128,8 +128,13 @@ public void testIlikeSearch() throws Exception {\n         Assert.assertEquals(0, ret.totalSize());\n         ret = ess.query(new NxQueryBuilder(session).nxql(\"SELECT * FROM Document WHERE dc:description LIKE 'Upper%'\"));\n         Assert.assertEquals(0, ret.totalSize());\n-        ret = ess.query(new NxQueryBuilder(session).nxql(\"SELECT * FROM Document WHERE dc:description LIKE 'UPPER%'\"));\n-        Assert.assertEquals(0, ret.totalSize());\n+        // match_phrase_prefix query against a keyword field behaves differently depending on the Elasticsearch version\n+        // prior to 6.7.0, it doesn't match\n+        // since 6.7.0, it matches, yet we're not sure if it is really expected\n+        // since 7, it raises an exception\n+        // ret = ess.query(new NxQueryBuilder(session).nxql(\"SELECT * FROM Document WHERE dc:description LIKE\n+        // 'UPPER%'\"));\n+        // Assert.assertEquals(0, ret.totalSize());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a55f88d83b1b45b79646acfd1d475635c701d6b"}, "originalPosition": 59}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5a55f88d83b1b45b79646acfd1d475635c701d6b", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/5a55f88d83b1b45b79646acfd1d475635c701d6b", "committedDate": "2020-09-16T08:59:34Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}, "afterCommit": {"oid": "3686c018af5077e1384f5efacd8094000dc2e062", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/3686c018af5077e1384f5efacd8094000dc2e062", "committedDate": "2020-09-17T08:55:27Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff23bdbb37e8df5b8ed2781959cae25552e1a27a", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ff23bdbb37e8df5b8ed2781959cae25552e1a27a", "committedDate": "2020-09-17T09:17:08Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments.\nNote that we've removed an assertion from TestMapping#testIlikeSearch since a match_phrase_prefix query against a keyword field behaves differently depending on the Elasticsearch version:\n- prior to 6.7.0, it doesn't match\n- since 6.7.0, it matches, yet we're not sure if it is really expected\n- since 7, it raises an exception"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3686c018af5077e1384f5efacd8094000dc2e062", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/3686c018af5077e1384f5efacd8094000dc2e062", "committedDate": "2020-09-17T08:55:27Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments."}, "afterCommit": {"oid": "ff23bdbb37e8df5b8ed2781959cae25552e1a27a", "author": {"user": {"login": "ataillefer", "name": "Antoine Taillefer"}}, "url": "https://github.com/nuxeo/nuxeo/commit/ff23bdbb37e8df5b8ed2781959cae25552e1a27a", "committedDate": "2020-09-17T09:17:08Z", "message": "NXP-29652: Use an Elasticsearch cluster for Elasticsearch unit tests\n\nWhen run in the PostgreSQL/MongoDB environments.\nNote that we've removed an assertion from TestMapping#testIlikeSearch since a match_phrase_prefix query against a keyword field behaves differently depending on the Elasticsearch version:\n- prior to 6.7.0, it doesn't match\n- since 6.7.0, it matches, yet we're not sure if it is really expected\n- since 7, it raises an exception"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNDA5Njgw", "url": "https://github.com/nuxeo/nuxeo/pull/4318#pullrequestreview-490409680", "createdAt": "2020-09-17T09:28:08Z", "commit": {"oid": "ff23bdbb37e8df5b8ed2781959cae25552e1a27a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNjE0NTc4", "url": "https://github.com/nuxeo/nuxeo/pull/4318#pullrequestreview-490614578", "createdAt": "2020-09-17T13:49:15Z", "commit": {"oid": "ff23bdbb37e8df5b8ed2781959cae25552e1a27a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4972, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}