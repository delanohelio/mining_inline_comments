{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2NTEyOTU2", "number": 3694, "title": "fix-NXP-28462-html-preview", "bodyText": "PR created from https://qa.nuxeo.org/jenkins/job/TestAndPush/job/ondemand-testandpush-fguillaume/750/", "createdAt": "2020-01-23T18:54:32Z", "url": "https://github.com/nuxeo/nuxeo/pull/3694", "merged": true, "mergeCommit": {"oid": "60676bb7122aa690eda715c8caef09eb67285d8f"}, "closed": true, "closedAt": "2020-01-24T10:49:48Z", "author": {"login": "nuxeojenkins"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9PJOtAFqTM0NzUzNTc5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9ckPRAFqTM0Nzg3MTg2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NTM1Nzk5", "url": "https://github.com/nuxeo/nuxeo/pull/3694#pullrequestreview-347535799", "createdAt": "2020-01-23T19:02:57Z", "commit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxOTowMjo1N1rOFhJRiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxOTowMjo1N1rOFhJRiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI5OTI3Mw==", "bodyText": "Why is a document needed?", "url": "https://github.com/nuxeo/nuxeo/pull/3694#discussion_r370299273", "createdAt": "2020-01-23T19:02:57Z", "author": {"login": "ataillefer"}, "path": "nuxeo-features/preview/nuxeo-preview-core/src/test/java/org/nuxeo/ecm/platform/preview/tests/adapter/TestPreviewAdapter.java", "diffHunk": "@@ -152,4 +156,18 @@ public void testFolderishDocument() throws Exception {\n         assertNotNull(adapter);\n     }\n \n+    @Test\n+    public void testConvertTextToHtml() throws IOException {\n+        Blob blob = new StringBlob(\"thisismytest\", \"text/plain\");\n+        DocumentModel doc = session.createDocumentModel(\"File\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NTM3ODA0", "url": "https://github.com/nuxeo/nuxeo/pull/3694#pullrequestreview-347537804", "createdAt": "2020-01-23T19:06:21Z", "commit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxOTowNjoyMVrOFhJXrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxOTowNjoyMVrOFhJXrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMwMDg0NA==", "bodyText": "Why not init(List.of(blob) since this is master?\nOr do we need a mutable list?", "url": "https://github.com/nuxeo/nuxeo/pull/3694#discussion_r370300844", "createdAt": "2020-01-23T19:06:21Z", "author": {"login": "ataillefer"}, "path": "nuxeo-core/nuxeo-core-api/src/main/java/org/nuxeo/ecm/core/api/blobholder/SimpleBlobHolder.java", "diffHunk": "@@ -58,6 +59,11 @@ protected void init(List<Blob> blobs) {\n         creationDate = Calendar.getInstance();\n     }\n \n+    @Override\n+    public void setBlob(Blob blob) {\n+        init(new ArrayList<>(Arrays.asList(blob)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3Nzk3Njg1", "url": "https://github.com/nuxeo/nuxeo/pull/3694#pullrequestreview-347797685", "createdAt": "2020-01-24T08:13:14Z", "commit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwODoxMzoxNFrOFhWS2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwODoxMzoxNFrOFhWS2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDUxMjYwMw==", "bodyText": "can we pass an empty map (Map.of, Collections.emptyMap()) instead of null on the map parameter", "url": "https://github.com/nuxeo/nuxeo/pull/3694#discussion_r370512603", "createdAt": "2020-01-24T08:13:14Z", "author": {"login": "RSalem07"}, "path": "nuxeo-features/preview/nuxeo-preview-core/src/test/java/org/nuxeo/ecm/platform/preview/tests/adapter/TestPreviewAdapter.java", "diffHunk": "@@ -152,4 +156,18 @@ public void testFolderishDocument() throws Exception {\n         assertNotNull(adapter);\n     }\n \n+    @Test\n+    public void testConvertTextToHtml() throws IOException {\n+        Blob blob = new StringBlob(\"thisismytest\", \"text/plain\");\n+        DocumentModel doc = session.createDocumentModel(\"File\");\n+        doc.setPropertyValue(\"file:content\", (Serializable) blob);\n+        // convert using SimpleBlobHolder (like ConvertAdapter)\n+        BlobHolder blobHolder = new SimpleBlobHolder(blob);\n+        BlobHolder res = conversionService.convertToMimeType(\"text/html\", blobHolder , null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3Nzk4Njk5", "url": "https://github.com/nuxeo/nuxeo/pull/3694#pullrequestreview-347798699", "createdAt": "2020-01-24T08:16:01Z", "commit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwODoxNjowMVrOFhWWMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwODoxNjowMVrOFhWWMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDUxMzQ1Nw==", "bodyText": "we can use the constructor with single parameter (which use text/plain mime type internally):\nBlob blob = new StringBlob(\"thisismytest\", \"text/plain\"); ->  Blob blob = new StringBlob(\"thisismytest\");", "url": "https://github.com/nuxeo/nuxeo/pull/3694#discussion_r370513457", "createdAt": "2020-01-24T08:16:01Z", "author": {"login": "RSalem07"}, "path": "nuxeo-features/preview/nuxeo-preview-core/src/test/java/org/nuxeo/ecm/platform/preview/tests/adapter/TestPreviewAdapter.java", "diffHunk": "@@ -152,4 +156,18 @@ public void testFolderishDocument() throws Exception {\n         assertNotNull(adapter);\n     }\n \n+    @Test\n+    public void testConvertTextToHtml() throws IOException {\n+        Blob blob = new StringBlob(\"thisismytest\", \"text/plain\");\n+        DocumentModel doc = session.createDocumentModel(\"File\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3Nzk4OTk1", "url": "https://github.com/nuxeo/nuxeo/pull/3694#pullrequestreview-347798995", "createdAt": "2020-01-24T08:16:49Z", "commit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93470d77a9d4e836ed3dc157cac4434bc6cf821b", "author": {"user": {"login": "efge", "name": "Florent Guillaume"}}, "url": "https://github.com/nuxeo/nuxeo/commit/93470d77a9d4e836ed3dc157cac4434bc6cf821b", "committedDate": "2020-01-24T10:30:46Z", "message": "NXP-28462: fix error on HTML preview"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9d307846cdee0deece09e2bdb723fd303857aebb", "author": {"user": {"login": "efge", "name": "Florent Guillaume"}}, "url": "https://github.com/nuxeo/nuxeo/commit/9d307846cdee0deece09e2bdb723fd303857aebb", "committedDate": "2020-01-23T14:00:22Z", "message": "NXP-28462: fix error on HTML preview"}, "afterCommit": {"oid": "93470d77a9d4e836ed3dc157cac4434bc6cf821b", "author": {"user": {"login": "efge", "name": "Florent Guillaume"}}, "url": "https://github.com/nuxeo/nuxeo/commit/93470d77a9d4e836ed3dc157cac4434bc6cf821b", "committedDate": "2020-01-24T10:30:46Z", "message": "NXP-28462: fix error on HTML preview"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3ODY4ODE2", "url": "https://github.com/nuxeo/nuxeo/pull/3694#pullrequestreview-347868816", "createdAt": "2020-01-24T10:35:33Z", "commit": {"oid": "93470d77a9d4e836ed3dc157cac4434bc6cf821b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3ODcxODYx", "url": "https://github.com/nuxeo/nuxeo/pull/3694#pullrequestreview-347871861", "createdAt": "2020-01-24T10:41:14Z", "commit": {"oid": "93470d77a9d4e836ed3dc157cac4434bc6cf821b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4888, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}