{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MzQ3MTYy", "number": 4048, "reviewThreads": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMzo1NToxMFrOD9Z64w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODoxNDowOVrOD96ozA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NzE0NDAzOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-core/src/main/java/org/nuxeo/apidoc/adapters/BundleGroupDocAdapter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMzo1NToxMFrOGW4R3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMzo1NToxMFrOGW4R3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY0MzkzMg==", "bodyText": "You should use doc.putContextData() directly.", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r426643932", "createdAt": "2020-05-18T13:55:10Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-core/src/main/java/org/nuxeo/apidoc/adapters/BundleGroupDocAdapter.java", "diffHunk": "@@ -64,6 +65,8 @@ public static BundleGroupDocAdapter create(BundleGroup bundleGroup, CoreSession\n             files.add(item);\n         }\n         doc.setPropertyValue(PROP_READMES, files);\n+\n+        doc.getContextData().put(ThumbnailConstants.DISABLE_THUMBNAIL_COMPUTATION, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ef10d32f988fb2934e2f225b260268b8ef633ef1"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NzE1MzgyOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/uploadEdit.ftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMzo1NzoyNFrOGW4YVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMzo1NzoyNFrOGW4YVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY0NTU4OQ==", "bodyText": "No need for ; I think", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r426645589", "createdAt": "2020-05-18T13:57:24Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/uploadEdit.ftl", "diffHunk": "@@ -1,43 +1,49 @@\n <@extends src=\"base.ftl\">\n \n-<@block name=\"stylesheets\">\n-</@block>\n-\n-\n-<@block name=\"header_scripts\">\n-</@block>\n-\n-<@block name=\"left\">\n-</@block>\n+<@block name=\"left\" />\n \n <@block name=\"right\">\n \n-  The distribution zip you have uploaded contains : ${snapObject.bundleIds?size} bundles. <br/><br/>\n-\n-  You can edit some of the properties of the Distribution before you validate the upload :<br/>\n+  <div>\n+    The distribution zip you have uploaded contains <b>${snapObject.bundleIds?size} bundles</b>.\n+  </div>\n+  <br />\n+  <div>\n+    You can edit some of the properties of the distribution before you validate the upload:<br/>\n+  </div>\n \n   <form method=\"POST\" action=\"${Root.path}/uploadDistribTmpValid\">\n-  <table>\n-   <tr>\n-     <td> Name : </td>\n-     <td> <input type=\"text\" name=\"name\" value=\"${tmpSnap.nxdistribution.name}\"/> </td>\n-   </tr>\n-   <tr>\n-     <td> Version : </td>\n-     <td> <input type=\"text\" name=\"version\" value=\"${tmpSnap.nxdistribution.version}\"/> </td>\n-   </tr>\n-   <tr>\n-     <td> Path Segment : </td>\n-     <td> <input type=\"text\" name=\"pathSegment\" value=\"${tmpSnap.name}\"/></td>\n-   </tr>\n-   <tr>\n-     <td> Title : </td>\n-     <td> <input type=\"text\" name=\"title\" value=\"${tmpSnap.title}\"/> </td>\n-   </tr>\n-   <tr><td colspan=\"2\">\n-    <input type=\"submit\" value=\"Import bundles\"/>\n-   </td></tr>\n-   </table>\n+    <table>\n+      <tr>\n+        <td>Name</td>\n+        <td>\n+          <input type=\"text\" name=\"name\" value=\"${tmpSnap.nxdistribution.name}\" width=\"100%\" />\n+        </td>\n+      </tr>\n+      <tr>\n+        <td>Version</td>\n+        <td>\n+          <input type=\"text\" name=\"version\" value=\"${tmpSnap.nxdistribution.version}\" width=\"100%\" />\n+        </td>\n+      </tr>\n+      <tr>\n+        <td>Path Segment</td>\n+        <td>\n+          <input type=\"text\" name=\"pathSegment\" value=\"${tmpSnap.name}\" width=\"100%\" />\n+        </td>\n+      </tr>\n+      <tr>\n+        <td>Title</td>\n+        <td>\n+          <input type=\"text\" name=\"title\" value=\"${tmpSnap.title}\" width=\"100%\" />\n+        </td>\n+      </tr>\n+      <tr>\n+        <td colspan=\"2\">\n+          <input type=\"submit\" value=\"Import bundles\" id=\"doImport\" onclick=\"this.classList.add('primary');\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d4d4956bba634cb21e993859a6733544fba7775"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDIzMjY0OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo0ODo0N1rOGXWQ7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOToyMDoyM1rOGXXikw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNTIxNQ==", "bodyText": "Indent issue", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427135215", "createdAt": "2020-05-19T08:48:47Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -12,6 +12,7 @@\n     <#assign rtSnap=Root.runtimeDistribution/>\n     <#assign snapList=Root.listPersistedDistributions()/>\n \n+  <div>\n   <table class=\"tablesorter distributions\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE0Njg0OA==", "bodyText": "I'm not always reindenting on HTML otherwise it makes the diff unreadable.\nThe status i inherited in this module is very bad, so if we have guideline and a way to reformat automatically, coud you please point me to it?", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427146848", "createdAt": "2020-05-19T09:05:40Z", "author": {"login": "atchertchian"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -12,6 +12,7 @@\n     <#assign rtSnap=Root.runtimeDistribution/>\n     <#assign snapList=Root.listPersistedDistributions()/>\n \n+  <div>\n   <table class=\"tablesorter distributions\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNTIxNQ=="}, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE1MzA2MA==", "bodyText": "(anyway i'll remove the div)", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427153060", "createdAt": "2020-05-19T09:15:26Z", "author": {"login": "atchertchian"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -12,6 +12,7 @@\n     <#assign rtSnap=Root.runtimeDistribution/>\n     <#assign snapList=Root.listPersistedDistributions()/>\n \n+  <div>\n   <table class=\"tablesorter distributions\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNTIxNQ=="}, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE1NjExNQ==", "bodyText": "https://github.blog/2018-05-01-ignore-white-space-in-code-review/\nI don't expect a full format; as you said it will change the whole file. But when adding a container tag; it makes sense to adjust the content indent. (using tab key, or most of recent IDE has this feature by default. For instance: https://mspoweruser.com/visual-studio-code-can-now-indent-code-automagically/)", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427156115", "createdAt": "2020-05-19T09:20:23Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -12,6 +12,7 @@\n     <#assign rtSnap=Root.runtimeDistribution/>\n     <#assign snapList=Root.listPersistedDistributions()/>\n \n+  <div>\n   <table class=\"tablesorter distributions\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNTIxNQ=="}, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDIzNDU4OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo0OToxNlrOGXWSVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo0OToxNlrOGXWSVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNTU3NA==", "bodyText": "Please avoid using <br> for spacing and rely on style.", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427135574", "createdAt": "2020-05-19T08:49:16Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -103,26 +108,24 @@\n           </#if>\n         </td>\n         <td>\n-          <p><a class=\"button\" href=\"${Root.path}/download/${distrib.key}\">Export as zip</a></p>\n+          <p><a class=\"button\" href=\"${Root.path}/download/${distrib.key}\" onclick=\"this.classList.add('primary');\">Export as zip</a></p>\n         </td>\n       </tr>\n     </#list>\n \n   </table>\n+  </div>\n \n-  <h2>Upload Distribution</h2>\n+  <br />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDIzNjA4OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo0OTozNlrOGXWTWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo0OTozNlrOGXWTWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNTgzNQ==", "bodyText": "Indent", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427135835", "createdAt": "2020-05-19T08:49:36Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -103,26 +108,24 @@\n           </#if>\n         </td>\n         <td>\n-          <p><a class=\"button\" href=\"${Root.path}/download/${distrib.key}\">Export as zip</a></p>\n+          <p><a class=\"button\" href=\"${Root.path}/download/${distrib.key}\" onclick=\"this.classList.add('primary');\">Export as zip</a></p>\n         </td>\n       </tr>\n     </#list>\n \n   </table>\n+  </div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDIzOTgyOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1MDoyN1rOGXWVxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1MDoyN1rOGXWVxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNjQ1NQ==", "bodyText": "Use a toggle function for adding a class dynamicaly", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427136455", "createdAt": "2020-05-19T08:50:27Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -53,11 +54,11 @@\n               </tr>\n               <tr>\n                 <td class=\"nowrap\">Version</td>\n-                <td>${rtSnap.version}</td>\n+                <td><span name=\"version\">${rtSnap.version}</span></td>\n               </tr>\n             </table>\n             <i>Existing snapshot with the same name and version will be updated.</i><br/>\n-            <input type=\"submit\" value=\"Save\"/>\n+            <input type=\"submit\" value=\"Save\" id=\"doSave\" class=\"button\" onclick=\"this.classList.add('primary');\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDI0MTgxOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1MDo1MlrOGXWXEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1MDo1MlrOGXWXEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNjc4NA==", "bodyText": "Same function here", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427136784", "createdAt": "2020-05-19T08:50:52Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -103,26 +108,24 @@\n           </#if>\n         </td>\n         <td>\n-          <p><a class=\"button\" href=\"${Root.path}/download/${distrib.key}\">Export as zip</a></p>\n+          <p><a class=\"button\" href=\"${Root.path}/download/${distrib.key}\" onclick=\"this.classList.add('primary');\">Export as zip</a></p>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDI0MjIzOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1MDo1OFrOGXWXUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1MDo1OFrOGXWXUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNjg0OA==", "bodyText": "Same function", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427136848", "createdAt": "2020-05-19T08:50:58Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/forms.ftl", "diffHunk": "@@ -79,8 +80,12 @@\n                 <td class=\"nowrap\">Packages prefixes</td>\n                 <td><textarea rows=\"4\" cols=\"30\" name=\"packages\"></textarea></td>\n               </tr>\n+              <tr>\n+                <td class=\"nowrap\">Version</td>\n+                <td><span name=\"version\">${rtSnap.version}</span></td>\n+              </tr>\n             </table>\n-            <input type=\"submit\" value=\"Save\"/>\n+            <input type=\"submit\" value=\"Save\" id=\"doSaveExtended\" class=\"button\" onclick=\"this.classList.add('primary');\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MDI0NzQ5OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/uploadEdit.ftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1MjowOVrOGXWaqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwODo1MjowOVrOGXWaqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEzNzcwNw==", "bodyText": "Same here, avoir using br for spacing.", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427137707", "createdAt": "2020-05-19T08:52:09Z", "author": {"login": "akervern"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/uploadEdit.ftl", "diffHunk": "@@ -1,43 +1,49 @@\n <@extends src=\"base.ftl\">\n \n-<@block name=\"stylesheets\">\n-</@block>\n-\n-\n-<@block name=\"header_scripts\">\n-</@block>\n-\n-<@block name=\"left\">\n-</@block>\n+<@block name=\"left\" />\n \n <@block name=\"right\">\n \n-  The distribution zip you have uploaded contains : ${snapObject.bundleIds?size} bundles. <br/><br/>\n-\n-  You can edit some of the properties of the Distribution before you validate the upload :<br/>\n+  <div>\n+    The distribution zip you have uploaded contains <b>${snapObject.bundleIds?size} bundles</b>.\n+  </div>\n+  <br />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "305d9d139f52f0ef3e360e5c3506d397bf8b4e8d"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjQxMDk1OnYy", "diffSide": "RIGHT", "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/ITExplorerAdminTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNzo0OTo1NVrOGXr2Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNzo0OTo1NVrOGXr2Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ4ODg1MQ==", "bodyText": "Remove redundant = null", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427488851", "createdAt": "2020-05-19T17:49:55Z", "author": {"login": "efge"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/ITExplorerAdminTest.java", "diffHunk": "@@ -32,6 +64,46 @@\n  */\n public class ITExplorerAdminTest extends AbstractExplorerTest {\n \n+    public static File downloadDir = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjQ0MTI0OnYy", "diffSide": "RIGHT", "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/ITExplorerAdminTest.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNzo1NzozNFrOGXsJlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwNjoxMjo1MFrOGZLxLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ5Mzc4Mw==", "bodyText": "If you don't need the value of i itself but just to get the next element sometimes, you can work with an iterator:\nfor (Iterator<String> lineIter = lines.iterator(); lineIter.hasNext(); ) {\n    String path = lineIter.next();\n    ...\n    ... Integer.valueOf(lineIter.next()) ...\n}", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427493783", "createdAt": "2020-05-19T17:57:34Z", "author": {"login": "efge"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/ITExplorerAdminTest.java", "diffHunk": "@@ -62,4 +136,171 @@ public void testDistribAdminPage() {\n         page.check();\n     }\n \n+    @Test\n+    public void testHomePageLiveDistrib() {\n+        ExplorerHomePage home = goHome();\n+        home.check();\n+        // check upload form is here for admin\n+        asPage(UploadFragment.class);\n+    }\n+\n+    protected String getDistribId(String name, String version) {\n+        return String.format(\"%s-%s\", name, version);\n+    }\n+\n+    protected String getDistribExportName(String distribId) {\n+        return String.format(\"nuxeo-distribution-%s.zip\", distribId);\n+    }\n+\n+    protected void checkLiveDistrib(String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkBundleGroups();\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(false);\n+    }\n+\n+    @Test\n+    public void testLiveDistribExportAndImport() {\n+        String distribName = \"my-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, false);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkLiveDistrib(distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkLiveDistrib(newDistribId);\n+    }\n+\n+    protected void checkPartialDistrib(String virtualBundleGroup, String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkPartialBundleGroup(virtualBundleGroup);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(true);\n+    }\n+\n+    // will be easier to maintain as a reference when a specific bundle group is used for explorer...\n+    protected void checkPartialBundleGroup(String distribName) {\n+        Locator.findElementWaitUntilEnabledAndClick(By.linkText(distribName));\n+        BundleGroupArtifactPage apage = asPage(BundleGroupArtifactPage.class);\n+        apage.checkDocumentationText(null);\n+        apage.checkSubGroup(null);\n+        apage.checkBundle(\"org.nuxeo.apidoc.core\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.repo\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.webengine\");\n+    }\n+\n+    @Test\n+    public void testLivePartialDistribExportAndImport() {\n+        String distribName = \"my-partial-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, true);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkPartialDistrib(distribName, distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"partial-imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkPartialDistrib(distribName, newDistribId);\n+    }\n+\n+    protected void createSampleZip(String sourceDirPath, String zipFilePath, boolean addMarker) throws IOException {\n+        Path p = Files.createFile(Paths.get(zipFilePath));\n+        try (ZipOutputStream zs = new ZipOutputStream(Files.newOutputStream(p))) {\n+            if (addMarker) {\n+                ZipEntry zipEntry = new ZipEntry(\".nuxeo-archive\");\n+                zs.putNextEntry(zipEntry);\n+                zs.closeEntry();\n+            }\n+            // read paths from reference file as NuxeoArchiveReader requires a given order and extra info\n+            List<String> lines = Files.readAllLines(Paths.get(sourceDirPath, \"entries.txt\"));\n+            for (int i = 0; i < lines.size(); i++) {\n+                String path = lines.get(i);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 225}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg2NTYwMg==", "bodyText": "I'd rather not change these logics now because i'm getting the next next line sometimes (to fill extra info on the zip entry), and because i fought with NuxeoArchiveReader expected format.\nBut i'll keep that in mind \ud83d\udc4d", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427865602", "createdAt": "2020-05-20T09:21:32Z", "author": {"login": "atchertchian"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/ITExplorerAdminTest.java", "diffHunk": "@@ -62,4 +136,171 @@ public void testDistribAdminPage() {\n         page.check();\n     }\n \n+    @Test\n+    public void testHomePageLiveDistrib() {\n+        ExplorerHomePage home = goHome();\n+        home.check();\n+        // check upload form is here for admin\n+        asPage(UploadFragment.class);\n+    }\n+\n+    protected String getDistribId(String name, String version) {\n+        return String.format(\"%s-%s\", name, version);\n+    }\n+\n+    protected String getDistribExportName(String distribId) {\n+        return String.format(\"nuxeo-distribution-%s.zip\", distribId);\n+    }\n+\n+    protected void checkLiveDistrib(String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkBundleGroups();\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(false);\n+    }\n+\n+    @Test\n+    public void testLiveDistribExportAndImport() {\n+        String distribName = \"my-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, false);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkLiveDistrib(distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkLiveDistrib(newDistribId);\n+    }\n+\n+    protected void checkPartialDistrib(String virtualBundleGroup, String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkPartialBundleGroup(virtualBundleGroup);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(true);\n+    }\n+\n+    // will be easier to maintain as a reference when a specific bundle group is used for explorer...\n+    protected void checkPartialBundleGroup(String distribName) {\n+        Locator.findElementWaitUntilEnabledAndClick(By.linkText(distribName));\n+        BundleGroupArtifactPage apage = asPage(BundleGroupArtifactPage.class);\n+        apage.checkDocumentationText(null);\n+        apage.checkSubGroup(null);\n+        apage.checkBundle(\"org.nuxeo.apidoc.core\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.repo\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.webengine\");\n+    }\n+\n+    @Test\n+    public void testLivePartialDistribExportAndImport() {\n+        String distribName = \"my-partial-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, true);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkPartialDistrib(distribName, distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"partial-imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkPartialDistrib(distribName, newDistribId);\n+    }\n+\n+    protected void createSampleZip(String sourceDirPath, String zipFilePath, boolean addMarker) throws IOException {\n+        Path p = Files.createFile(Paths.get(zipFilePath));\n+        try (ZipOutputStream zs = new ZipOutputStream(Files.newOutputStream(p))) {\n+            if (addMarker) {\n+                ZipEntry zipEntry = new ZipEntry(\".nuxeo-archive\");\n+                zs.putNextEntry(zipEntry);\n+                zs.closeEntry();\n+            }\n+            // read paths from reference file as NuxeoArchiveReader requires a given order and extra info\n+            List<String> lines = Files.readAllLines(Paths.get(sourceDirPath, \"entries.txt\"));\n+            for (int i = 0; i < lines.size(); i++) {\n+                String path = lines.get(i);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ5Mzc4Mw=="}, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 225}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAxMTc3Mw==", "bodyText": "Well my suggestion doesn't change the logic, just how we write the code. It does the same thing.", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r428011773", "createdAt": "2020-05-20T13:30:54Z", "author": {"login": "efge"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/ITExplorerAdminTest.java", "diffHunk": "@@ -62,4 +136,171 @@ public void testDistribAdminPage() {\n         page.check();\n     }\n \n+    @Test\n+    public void testHomePageLiveDistrib() {\n+        ExplorerHomePage home = goHome();\n+        home.check();\n+        // check upload form is here for admin\n+        asPage(UploadFragment.class);\n+    }\n+\n+    protected String getDistribId(String name, String version) {\n+        return String.format(\"%s-%s\", name, version);\n+    }\n+\n+    protected String getDistribExportName(String distribId) {\n+        return String.format(\"nuxeo-distribution-%s.zip\", distribId);\n+    }\n+\n+    protected void checkLiveDistrib(String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkBundleGroups();\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(false);\n+    }\n+\n+    @Test\n+    public void testLiveDistribExportAndImport() {\n+        String distribName = \"my-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, false);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkLiveDistrib(distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkLiveDistrib(newDistribId);\n+    }\n+\n+    protected void checkPartialDistrib(String virtualBundleGroup, String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkPartialBundleGroup(virtualBundleGroup);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(true);\n+    }\n+\n+    // will be easier to maintain as a reference when a specific bundle group is used for explorer...\n+    protected void checkPartialBundleGroup(String distribName) {\n+        Locator.findElementWaitUntilEnabledAndClick(By.linkText(distribName));\n+        BundleGroupArtifactPage apage = asPage(BundleGroupArtifactPage.class);\n+        apage.checkDocumentationText(null);\n+        apage.checkSubGroup(null);\n+        apage.checkBundle(\"org.nuxeo.apidoc.core\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.repo\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.webengine\");\n+    }\n+\n+    @Test\n+    public void testLivePartialDistribExportAndImport() {\n+        String distribName = \"my-partial-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, true);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkPartialDistrib(distribName, distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"partial-imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkPartialDistrib(distribName, newDistribId);\n+    }\n+\n+    protected void createSampleZip(String sourceDirPath, String zipFilePath, boolean addMarker) throws IOException {\n+        Path p = Files.createFile(Paths.get(zipFilePath));\n+        try (ZipOutputStream zs = new ZipOutputStream(Files.newOutputStream(p))) {\n+            if (addMarker) {\n+                ZipEntry zipEntry = new ZipEntry(\".nuxeo-archive\");\n+                zs.putNextEntry(zipEntry);\n+                zs.closeEntry();\n+            }\n+            // read paths from reference file as NuxeoArchiveReader requires a given order and extra info\n+            List<String> lines = Files.readAllLines(Paths.get(sourceDirPath, \"entries.txt\"));\n+            for (int i = 0; i < lines.size(); i++) {\n+                String path = lines.get(i);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ5Mzc4Mw=="}, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 225}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAxNTAxNw==", "bodyText": "Yes i got that, still in some cases i have an extra ++ so i kind of need the index here not to complicate things (at least for me)", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r428015017", "createdAt": "2020-05-20T13:35:09Z", "author": {"login": "atchertchian"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/ITExplorerAdminTest.java", "diffHunk": "@@ -62,4 +136,171 @@ public void testDistribAdminPage() {\n         page.check();\n     }\n \n+    @Test\n+    public void testHomePageLiveDistrib() {\n+        ExplorerHomePage home = goHome();\n+        home.check();\n+        // check upload form is here for admin\n+        asPage(UploadFragment.class);\n+    }\n+\n+    protected String getDistribId(String name, String version) {\n+        return String.format(\"%s-%s\", name, version);\n+    }\n+\n+    protected String getDistribExportName(String distribId) {\n+        return String.format(\"nuxeo-distribution-%s.zip\", distribId);\n+    }\n+\n+    protected void checkLiveDistrib(String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkBundleGroups();\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(false);\n+    }\n+\n+    @Test\n+    public void testLiveDistribExportAndImport() {\n+        String distribName = \"my-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, false);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkLiveDistrib(distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkLiveDistrib(newDistribId);\n+    }\n+\n+    protected void checkPartialDistrib(String virtualBundleGroup, String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkPartialBundleGroup(virtualBundleGroup);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(true);\n+    }\n+\n+    // will be easier to maintain as a reference when a specific bundle group is used for explorer...\n+    protected void checkPartialBundleGroup(String distribName) {\n+        Locator.findElementWaitUntilEnabledAndClick(By.linkText(distribName));\n+        BundleGroupArtifactPage apage = asPage(BundleGroupArtifactPage.class);\n+        apage.checkDocumentationText(null);\n+        apage.checkSubGroup(null);\n+        apage.checkBundle(\"org.nuxeo.apidoc.core\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.repo\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.webengine\");\n+    }\n+\n+    @Test\n+    public void testLivePartialDistribExportAndImport() {\n+        String distribName = \"my-partial-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, true);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkPartialDistrib(distribName, distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"partial-imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkPartialDistrib(distribName, newDistribId);\n+    }\n+\n+    protected void createSampleZip(String sourceDirPath, String zipFilePath, boolean addMarker) throws IOException {\n+        Path p = Files.createFile(Paths.get(zipFilePath));\n+        try (ZipOutputStream zs = new ZipOutputStream(Files.newOutputStream(p))) {\n+            if (addMarker) {\n+                ZipEntry zipEntry = new ZipEntry(\".nuxeo-archive\");\n+                zs.putNextEntry(zipEntry);\n+                zs.closeEntry();\n+            }\n+            // read paths from reference file as NuxeoArchiveReader requires a given order and extra info\n+            List<String> lines = Files.readAllLines(Paths.get(sourceDirPath, \"entries.txt\"));\n+            for (int i = 0; i < lines.size(); i++) {\n+                String path = lines.get(i);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ5Mzc4Mw=="}, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 225}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA2MDM5OQ==", "bodyText": "After all see related commit with #4059", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r429060399", "createdAt": "2020-05-22T06:12:50Z", "author": {"login": "atchertchian"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/ITExplorerAdminTest.java", "diffHunk": "@@ -62,4 +136,171 @@ public void testDistribAdminPage() {\n         page.check();\n     }\n \n+    @Test\n+    public void testHomePageLiveDistrib() {\n+        ExplorerHomePage home = goHome();\n+        home.check();\n+        // check upload form is here for admin\n+        asPage(UploadFragment.class);\n+    }\n+\n+    protected String getDistribId(String name, String version) {\n+        return String.format(\"%s-%s\", name, version);\n+    }\n+\n+    protected String getDistribExportName(String distribId) {\n+        return String.format(\"nuxeo-distribution-%s.zip\", distribId);\n+    }\n+\n+    protected void checkLiveDistrib(String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkBundleGroups();\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(false);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(false);\n+    }\n+\n+    @Test\n+    public void testLiveDistribExportAndImport() {\n+        String distribName = \"my-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, false);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkLiveDistrib(distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkLiveDistrib(newDistribId);\n+    }\n+\n+    protected void checkPartialDistrib(String virtualBundleGroup, String distribId) {\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLEGROUPS);\n+        checkPartialBundleGroup(virtualBundleGroup);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_BUNDLES);\n+        checkBundles(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_COMPONENTS);\n+        checkComponents(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_EXTENSIONPOINTS);\n+        checkExtensionPoints(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_SERVICES);\n+        checkServices(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_CONTRIBUTIONS);\n+        checkContributions(true);\n+        open(ExplorerHomePage.URL + distribId + \"/\" + ApiBrowserConstants.LIST_OPERATIONS);\n+        checkOperations(true);\n+    }\n+\n+    // will be easier to maintain as a reference when a specific bundle group is used for explorer...\n+    protected void checkPartialBundleGroup(String distribName) {\n+        Locator.findElementWaitUntilEnabledAndClick(By.linkText(distribName));\n+        BundleGroupArtifactPage apage = asPage(BundleGroupArtifactPage.class);\n+        apage.checkDocumentationText(null);\n+        apage.checkSubGroup(null);\n+        apage.checkBundle(\"org.nuxeo.apidoc.core\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.repo\");\n+        apage.checkBundle(\"org.nuxeo.apidoc.webengine\");\n+    }\n+\n+    @Test\n+    public void testLivePartialDistribExportAndImport() {\n+        String distribName = \"my-partial-server\";\n+        open(DistribAdminPage.URL);\n+        String version = asPage(DistribAdminPage.class).saveCurrentLiveDistrib(distribName, true);\n+        String distribId = getDistribId(distribName, version);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(distribId);\n+        checkPartialDistrib(distribName, distribId);\n+\n+        // check importing it back\n+        open(DistribAdminPage.URL);\n+        String filename = getDistribExportName(distribId);\n+        File file = asPage(DistribAdminPage.class).exportFirstPersistedDistrib(downloadDir, filename);\n+\n+        open(DistribAdminPage.URL);\n+        String newDistribName = \"partial-imported-server\";\n+        String newVersion = \"1.0.0\";\n+        asPage(DistribAdminPage.class).importPersistedDistrib(file, newDistribName, newVersion, null);\n+        open(ExplorerHomePage.URL);\n+        String newDistribId = getDistribId(newDistribName, newVersion);\n+        asPage(ExplorerHomePage.class).checkPersistedDistrib(newDistribId);\n+        checkPartialDistrib(distribName, newDistribId);\n+    }\n+\n+    protected void createSampleZip(String sourceDirPath, String zipFilePath, boolean addMarker) throws IOException {\n+        Path p = Files.createFile(Paths.get(zipFilePath));\n+        try (ZipOutputStream zs = new ZipOutputStream(Files.newOutputStream(p))) {\n+            if (addMarker) {\n+                ZipEntry zipEntry = new ZipEntry(\".nuxeo-archive\");\n+                zs.putNextEntry(zipEntry);\n+                zs.closeEntry();\n+            }\n+            // read paths from reference file as NuxeoArchiveReader requires a given order and extra info\n+            List<String> lines = Files.readAllLines(Paths.get(sourceDirPath, \"entries.txt\"));\n+            for (int i = 0; i < lines.size(); i++) {\n+                String path = lines.get(i);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ5Mzc4Mw=="}, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 225}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjQ0ODYyOnYy", "diffSide": "RIGHT", "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/pages/AbstractExplorerPage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNzo1OToyOFrOGXsOdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNzo1OToyOFrOGXsOdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ5NTAyOA==", "bodyText": "Asyn -> Async", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427495028", "createdAt": "2020-05-19T17:59:28Z", "author": {"login": "efge"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/pages/AbstractExplorerPage.java", "diffHunk": "@@ -53,6 +71,17 @@ public void checkTitle(String expected) {\n         assertEquals(expected, driver.getTitle());\n     }\n \n+    /**\n+     * Waits for indexing to be done.\n+     */\n+    public void waitForAsynWork() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjQ1NjUxOnYy", "diffSide": "RIGHT", "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/pages/DistributionHomePage.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODowMToyNFrOGXsTWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODowMToyNFrOGXsTWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ5NjI4MQ==", "bodyText": "Could put header.getText() (used 3 times) in a local variable", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427496281", "createdAt": "2020-05-19T18:01:24Z", "author": {"login": "efge"}, "path": "ftests/nuxeo-platform-explorer-ftests/src/test/java/org/nuxeo/functionaltests/explorer/pages/DistributionHomePage.java", "diffHunk": "@@ -69,7 +70,15 @@ public DistributionHomePage(WebDriver driver) {\n     @Override\n     public void check() {\n         checkTitle(\"Nuxeo Platform Explorer\");\n-        assertTrue(header.getText(), header.getText().startsWith(\"Browsing Distribution\"));\n+        checkHeader(null);\n+    }\n+\n+    public void checkHeader(String distribId) {\n+        if (distribId != null) {\n+            assertEquals(String.format(\"Browsing Distribution '%s'\", distribId), header.getText());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjQ5MTYxOnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-repo/src/test/java/org/nuxeo/apidoc/test/TestSnapshotPersist.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODoxMDo1MVrOGXspsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODoxMDo1MVrOGXspsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUwMjAwMA==", "bodyText": "If you want you could build the whole string directly as:\nString s = bids.stream().map(snapshot::getBundle).map(this::represent).collect(Collectors.joining());", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427502000", "createdAt": "2020-05-19T18:10:51Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-repo/src/test/java/org/nuxeo/apidoc/test/TestSnapshotPersist.java", "diffHunk": "@@ -125,61 +145,86 @@ protected String represent(NuxeoArtifact artifact) {\n         return res;\n     }\n \n-    protected void checkBundles(DistributionSnapshot snapshot) throws IOException {\n+    protected void checkBundles(DistributionSnapshot snapshot, boolean partial) throws IOException {\n         List<String> bids = snapshot.getBundleIds();\n \n         StringBuilder sb = new StringBuilder();\n         bids.forEach(bid -> sb.append(represent(snapshot.getBundle(bid))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MjUwNDQ0OnYy", "diffSide": "RIGHT", "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/saved.ftl", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODoxNDowOVrOGXsxsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxODoxNDowOVrOGXsxsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUwNDA0OQ==", "bodyText": "I'm not a fan of exclamation marks in messages", "url": "https://github.com/nuxeo/nuxeo/pull/4048#discussion_r427504049", "createdAt": "2020-05-19T18:14:09Z", "author": {"login": "efge"}, "path": "modules/platform/nuxeo-apidoc-server/nuxeo-apidoc-webengine/src/main/resources/skin/views/distribution/saved.ftl", "diffHunk": "@@ -1,21 +1,14 @@\n <@extends src=\"base.ftl\">\n \n-<@block name=\"stylesheets\">\n-</@block>\n-\n-\n-<@block name=\"header_scripts\">\n-</@block>\n-\n-<@block name=\"left\">\n-</@block>\n+<@block name=\"left\" />\n \n <@block name=\"right\">\n \n-<h1> Distribution Snapshot saved OK </h1>\n-<script>\n-window.setTimeout(\"window.location.href='${Root.path}/'\",2000)\n-</script>\n+  <h1>Distribution Snapshot saved!</h1>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b998dd6a5eedc9014f1e076a26fff79f2bf597a2"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4123, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}