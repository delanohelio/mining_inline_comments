{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1NDQ1MTU3", "number": 4438, "title": "NXP-29825: keep only one install-packages.sh script", "bodyText": "", "createdAt": "2020-11-04T15:04:41Z", "url": "https://github.com/nuxeo/nuxeo/pull/4438", "merged": true, "mergeCommit": {"oid": "4de08579cebad6e339b12ed31fbe6710bcb15c88"}, "closed": true, "closedAt": "2020-11-10T14:11:52Z", "author": {"login": "troger"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZP6IogFqTUyMzQ5OTg0Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbJaJrAFqTUyNzIwMTUxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNDk5ODQ3", "url": "https://github.com/nuxeo/nuxeo/pull/4438#pullrequestreview-523499847", "createdAt": "2020-11-04T15:57:25Z", "commit": {"oid": "e978909d0776e93934a3d9dae2ab1e8905b85851"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MDYyNzUz", "url": "https://github.com/nuxeo/nuxeo/pull/4438#pullrequestreview-524062753", "createdAt": "2020-11-05T09:17:30Z", "commit": {"oid": "e978909d0776e93934a3d9dae2ab1e8905b85851"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxNzozMVrOHt6Gkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQwOToxNzozMVrOHt6Gkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg5OTkyMg==", "bodyText": "Would it make sense to separate this change (\">\" into \">>\"), which is not directly related to the merge of both scripts, and fixes the bug that empties the nuxeo.conf file when using the connect URL parameter?", "url": "https://github.com/nuxeo/nuxeo/pull/4438#discussion_r517899922", "createdAt": "2020-11-05T09:17:31Z", "author": {"login": "atchertchian"}, "path": "docker/install-packages.sh", "diffHunk": "@@ -39,11 +43,19 @@ fi\n \n if [ -n \"$connect_url\" ]; then\n   echo \"Setting Connect URL: $connect_url\"\n-  printf \"org.nuxeo.connect.url=%b\\n\" \"$connect_url\" > $NUXEO_HOME/bin/nuxeo.conf\n+  printf \"org.nuxeo.connect.url=%b\\n\" \"$connect_url\" >> $NUXEO_HOME/bin/nuxeo.conf", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e978909d0776e93934a3d9dae2ab1e8905b85851"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e978909d0776e93934a3d9dae2ab1e8905b85851", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/e978909d0776e93934a3d9dae2ab1e8905b85851", "committedDate": "2020-11-04T15:04:21Z", "message": "NXP-29825: keep only one install-packages.sh script"}, "afterCommit": {"oid": "0d86cd5d89875710b512c6bfee2ee7254796be60", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/0d86cd5d89875710b512c6bfee2ee7254796be60", "committedDate": "2020-11-05T17:02:24Z", "message": "NXP-29825: keep only one install-packages.sh script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b381cd0e2a0ae7a2852d0ced555099684f8e431a", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/b381cd0e2a0ae7a2852d0ced555099684f8e431a", "committedDate": "2020-11-05T17:09:17Z", "message": "NXP-29825: correctly append Connect URL"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0d86cd5d89875710b512c6bfee2ee7254796be60", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/0d86cd5d89875710b512c6bfee2ee7254796be60", "committedDate": "2020-11-05T17:02:24Z", "message": "NXP-29825: keep only one install-packages.sh script"}, "afterCommit": {"oid": "974ee3d93865fce3c50c3e0c5eec0783bca46306", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/974ee3d93865fce3c50c3e0c5eec0783bca46306", "committedDate": "2020-11-05T17:09:17Z", "message": "NXP-29825: keep only one install-packages.sh script"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "974ee3d93865fce3c50c3e0c5eec0783bca46306", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/974ee3d93865fce3c50c3e0c5eec0783bca46306", "committedDate": "2020-11-05T17:09:17Z", "message": "NXP-29825: keep only one install-packages.sh script"}, "afterCommit": {"oid": "f44008039f789e05c4c9d2945f49083259c93869", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f44008039f789e05c4c9d2945f49083259c93869", "committedDate": "2020-11-09T10:30:39Z", "message": "NXP-29825: keep only one install-packages.sh script"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2Mjk4Mjk5", "url": "https://github.com/nuxeo/nuxeo/pull/4438#pullrequestreview-526298299", "createdAt": "2020-11-09T14:17:22Z", "commit": {"oid": "f44008039f789e05c4c9d2945f49083259c93869"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDoxNzoyMlrOHvw4KA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNDozNTo1MVrOHvxsWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0NTkyOA==", "bodyText": "mpInstallArgs?", "url": "https://github.com/nuxeo/nuxeo/pull/4438#discussion_r519845928", "createdAt": "2020-11-09T14:17:22Z", "author": {"login": "ataillefer"}, "path": "docker/install-packages.sh", "diffHunk": "@@ -18,10 +18,14 @@ if [[ -f $NUXEO_HOME/configured ]]; then\n   exit 2\n fi\n \n+# default arguments for mp-install command\n+mp_install_args=\"--accept yes --relax no\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f44008039f789e05c4c9d2945f49083259c93869"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg1OTI4OA==", "bodyText": "RUN /install-packages.sh", "url": "https://github.com/nuxeo/nuxeo/pull/4438#discussion_r519859288", "createdAt": "2020-11-09T14:35:51Z", "author": {"login": "ataillefer"}, "path": "docker/README.md", "diffHunk": "@@ -130,23 +130,23 @@ dive nuxeo/nuxeo:latest\n \n ## Build a Custom Image From Nuxeo\n \n-We provide some utility scripts to install Nuxeo packages when building an image from the Nuxeo image:\n+We provide a utility script to install remote Nuxeo packages from [Nuxeo Connect](https://connect.nuxeo.com/) and local Nuxeo packages when building an image from the Nuxeo image:\n \n-- [install-local-packages.sh](./install-local-packages.sh): install a local Nuxeo package embedded in the image as a ZIP file.\n-- [install-packages.sh](./install-packages.sh): install a remote Nuxeo package from [Nuxeo Connect](https://connect.nuxeo.com/).\n-\n-For instance, you can use these scripts in the following `Dockerfile`:\n+For instance, you can use this script in the following `Dockerfile`:\n \n ```Dockerfile\n FROM <DOCKER_REGISTRY>/nuxeo:<TAG>\n \n ARG CLID\n ARG CONNECT_URL\n \n+COPY --chown=900:0 path/to/local-package-nodeps-*.zip $NUXEO_HOME/local-packages/local-package-nodeps.zip\n COPY --chown=900:0 path/to/local-package-*.zip $NUXEO_HOME/local-packages/local-package.zip\n \n-RUN /install-local-packages.sh $NUXEO_HOME/local-packages\n-RUN /install-packages.sh --clid ${CLID} --connect-url ${CONNECT_URL} nuxeo-web-ui nuxeo-drive\n+# Install a local package without its dependencies (`mp-install --nodeps`)\n+RUN /install-packages --offline $NUXEO_HOME/local-packages/local-package-nodeps.zip", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f44008039f789e05c4c9d2945f49083259c93869"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f780a68241d5bfe2aa87be1940d5e92b957ff9c7", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f780a68241d5bfe2aa87be1940d5e92b957ff9c7", "committedDate": "2020-11-09T18:07:08Z", "message": "NXP-29825: keep only one install-packages.sh script"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f44008039f789e05c4c9d2945f49083259c93869", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f44008039f789e05c4c9d2945f49083259c93869", "committedDate": "2020-11-09T10:30:39Z", "message": "NXP-29825: keep only one install-packages.sh script"}, "afterCommit": {"oid": "f780a68241d5bfe2aa87be1940d5e92b957ff9c7", "author": {"user": {"login": "troger", "name": "Thomas Roger"}}, "url": "https://github.com/nuxeo/nuxeo/commit/f780a68241d5bfe2aa87be1940d5e92b957ff9c7", "committedDate": "2020-11-09T18:07:08Z", "message": "NXP-29825: keep only one install-packages.sh script"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2NTgzNzIz", "url": "https://github.com/nuxeo/nuxeo/pull/4438#pullrequestreview-526583723", "createdAt": "2020-11-09T19:26:35Z", "commit": {"oid": "f780a68241d5bfe2aa87be1940d5e92b957ff9c7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjAxNTEy", "url": "https://github.com/nuxeo/nuxeo/pull/4438#pullrequestreview-527201512", "createdAt": "2020-11-10T13:30:54Z", "commit": {"oid": "f780a68241d5bfe2aa87be1940d5e92b957ff9c7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4949, "cost": 1, "resetAt": "2021-11-03T18:41:40Z"}}}