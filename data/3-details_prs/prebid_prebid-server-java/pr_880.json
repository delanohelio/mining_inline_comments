{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MTc4MDI4", "number": 880, "title": "consumable: Correct width and height reported in response.", "bodyText": "This PR corresponds to prebid/prebid-server#1459.\nCorrects the width and height specified in the bid response.\nAfter this change, Prebid Server uses the width and height specified in the bid response from Consumable.\nPreviously, Prebid Server would reuse the width and height specified in the bid request. That older behaviour was ported from an older version of the prebid.js adapter but is no longer valid.\nI am submitting this PR on behalf of Consumable, cc @naffis.", "createdAt": "2020-08-26T21:33:32Z", "url": "https://github.com/prebid/prebid-server-java/pull/880", "merged": true, "mergeCommit": {"oid": "5a6de477a5be319f323397f37c6efcbe111223c3"}, "closed": true, "closedAt": "2020-09-18T11:37:25Z", "author": {"login": "djcsdy"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCytorgH2gAyNDc0MTc4MDI4OjFlN2NhOGRjYTYwZDQ4NjBjYjZiMjQ5MjhlZmM1NGY1YmY0MDYwNjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdE9DLogFqTQ4MDg5MTI0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1e7ca8dca60d4860cb6b24928efc54f5bf406067", "author": {"user": {"login": "djcsdy", "name": "Daniel Cassidy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/1e7ca8dca60d4860cb6b24928efc54f5bf406067", "committedDate": "2020-08-26T21:30:11Z", "message": "consumable: Correct width and height reported in response.\n\nPrebid Server now responds with the width and height specified in\nthe Bid Response from Consumable. Previously it would reuse the width\nand height specified in the Bid Request. That older behaviour was\nported from an older version of the prebid.js adapter but is no longer\nvalid."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27e17d0ddd72eaf83cab03fd33971822570e6690", "author": {"user": {"login": "djcsdy", "name": "Daniel Cassidy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/27e17d0ddd72eaf83cab03fd33971822570e6690", "committedDate": "2020-08-26T21:40:24Z", "message": "consumable: Fix line exceeding maximum line length."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dd2508f65a062d4ee291d8ba91f811de69724b4", "author": {"user": {"login": "djcsdy", "name": "Daniel Cassidy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/9dd2508f65a062d4ee291d8ba91f811de69724b4", "committedDate": "2020-08-26T21:51:16Z", "message": "consumable: Delete obsolete test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "098e1c1714e7cfa6b8585ffdd05624740e23ab0f", "author": {"user": {"login": "djcsdy", "name": "Daniel Cassidy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/098e1c1714e7cfa6b8585ffdd05624740e23ab0f", "committedDate": "2020-08-26T22:05:04Z", "message": "consumable: Update test to include width and height in bid response."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NjUyNTMy", "url": "https://github.com/prebid/prebid-server-java/pull/880#pullrequestreview-476652532", "createdAt": "2020-08-27T12:06:19Z", "commit": {"oid": "098e1c1714e7cfa6b8585ffdd05624740e23ab0f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMjowNjoxOVrOHINNnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxMjozNDozM1rOHIOPIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM2NzEzMg==", "bodyText": "redundant. Pls remove", "url": "https://github.com/prebid/prebid-server-java/pull/880#discussion_r478367132", "createdAt": "2020-08-27T12:06:19Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/bidder/consumable/model/ConsumableDecision.java", "diffHunk": "@@ -25,4 +25,10 @@\n \n     @JsonProperty(\"impressionUrl\")\n     String impressionUrl;\n+\n+    @JsonProperty(\"width\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "098e1c1714e7cfa6b8585ffdd05624740e23ab0f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM2NzQ4Nw==", "bodyText": "redundant. Pls remove", "url": "https://github.com/prebid/prebid-server-java/pull/880#discussion_r478367487", "createdAt": "2020-08-27T12:06:53Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/bidder/consumable/model/ConsumableDecision.java", "diffHunk": "@@ -25,4 +25,10 @@\n \n     @JsonProperty(\"impressionUrl\")\n     String impressionUrl;\n+\n+    @JsonProperty(\"width\")\n+    Integer width;\n+\n+    @JsonProperty(\"height\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "098e1c1714e7cfa6b8585ffdd05624740e23ab0f"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM4MzkwNQ==", "bodyText": "You used same values, which we used in Banner.format[0] so for better understanding, lets use diffrent one.\n(Also correct line 306)", "url": "https://github.com/prebid/prebid-server-java/pull/880#discussion_r478383905", "createdAt": "2020-08-27T12:34:33Z", "author": {"login": "DGarbar"}, "path": "src/test/java/org/prebid/server/bidder/consumable/ConsumableBidderTest.java", "diffHunk": "@@ -287,31 +285,12 @@ public void makeBidsShouldSkipDecisionsWithNullClearPrice() throws JsonProcessin\n         assertThat(result.getErrors()).isEmpty();\n     }\n \n-    @Test\n-    public void makeBidsShouldSkipDecisionsWithAbsentImpIdAndAddError() throws JsonProcessingException {\n-        // given\n-        final Map<String, ConsumableDecision> decisionMap = new HashMap<>();\n-        decisionMap.put(\"firstImp\", ConsumableDecision.builder().pricing(ConsumablePricing.of(10.5)).build());\n-        decisionMap.put(\"missing_Imp\", ConsumableDecision.builder().pricing(ConsumablePricing.of(1.1)).build());\n-\n-        final HttpCall<ConsumableBidRequest> httpCall = givenHttpCall(() -> ConsumableBidResponse.of(decisionMap));\n-\n-        // when\n-        final Result<List<BidderBid>> result = consumableBidder.makeBids(httpCall,\n-                givenBidRequestWithTwoImpsAndTwoFormats());\n-\n-        // then\n-        assertThat(result.getErrors()).hasSize(1)\n-                .containsOnly(BidderError.badServerResponse(\"ignoring bid id=request_id, request doesn't contain any \"\n-                        + \"impression with id=missing_Imp\"));\n-        assertThat(result.getValue()).hasSize(1);\n-    }\n-\n     @Test\n     public void makeBidsShouldReturnBannerBidWithExpectedFields() throws JsonProcessingException {\n         // given\n         final HttpCall<ConsumableBidRequest> httpCall = givenHttpCall(identity(),\n                 decision -> decision.pricing(ConsumablePricing.of(11.1)).adId(123L)\n+                        .width(120).height(90)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "098e1c1714e7cfa6b8585ffdd05624740e23ab0f"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24490ab8303c3679e2316de8acaeb534e067e5c0", "author": {"user": {"login": "djcsdy", "name": "Daniel Cassidy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/24490ab8303c3679e2316de8acaeb534e067e5c0", "committedDate": "2020-08-29T02:58:04Z", "message": "consumable: Remove redundant annotations."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f383591e25141ee1f6d7a42faaf8696d54049186", "author": {"user": {"login": "djcsdy", "name": "Daniel Cassidy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/f383591e25141ee1f6d7a42faaf8696d54049186", "committedDate": "2020-08-29T02:58:09Z", "message": "consumable: Use different width and height in test."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwODkxMjQ5", "url": "https://github.com/prebid/prebid-server-java/pull/880#pullrequestreview-480891249", "createdAt": "2020-09-02T14:40:37Z", "commit": {"oid": "f383591e25141ee1f6d7a42faaf8696d54049186"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3149, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}