{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNzQ1NjY3", "number": 729, "title": "Add Aja bidder", "bodyText": "Implement new OpenRTB AJA Bidder", "createdAt": "2020-05-22T06:42:16Z", "url": "https://github.com/prebid/prebid-server-java/pull/729", "merged": true, "mergeCommit": {"oid": "0a7ae4a3f889b303f1fc961b507bf7a6107048a5"}, "closed": true, "closedAt": "2020-09-15T13:09:45Z", "author": {"login": "apaliy"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjsdO1gH2gAyNDIxNzQ1NjY3OjIwZmNjNmQ3MTVhZmRjYjZlNzA4YjU2ZDE4ZWYwOTAwNWRjNzc3MjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJHbVqgH2gAyNDIxNzQ1NjY3OmJhYTkzZDM3MTBiMGFjYjkwZDI2MDE4ODUwYTVlZjg0YmViMzAwOWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "20fcc6d715afdcb6e708b56d18ef09005dc77724", "author": {"user": {"login": "apaliy", "name": "Andrew Paliy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/20fcc6d715afdcb6e708b56d18ef09005dc77724", "committedDate": "2020-05-22T06:41:11Z", "message": "Aja Bidder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1962a4e39de7b4f33f66deac83d4488ef3361b19", "author": {"user": {"login": "apaliy", "name": "Andrew Paliy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/1962a4e39de7b4f33f66deac83d4488ef3361b19", "committedDate": "2020-05-22T07:48:02Z", "message": "unit tests add"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3814afcfe6511c2da278bcdf54c039eb1daec543", "author": {"user": {"login": "apaliy", "name": "Andrew Paliy"}}, "url": "https://github.com/prebid/prebid-server-java/commit/3814afcfe6511c2da278bcdf54c039eb1daec543", "committedDate": "2020-05-26T07:16:08Z", "message": "It test added"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1MjIwNzY2", "url": "https://github.com/prebid/prebid-server-java/pull/729#pullrequestreview-425220766", "createdAt": "2020-06-05T11:35:21Z", "commit": {"oid": "3814afcfe6511c2da278bcdf54c039eb1daec543"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMTozNToyMVrOGfq8mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxMTozNToyMVrOGfq8mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg2MjY4MQ==", "bodyText": "Probably you can remove this 'if' completely and later use impsByTagID.keySet(), the result should be the same.", "url": "https://github.com/prebid/prebid-server-java/pull/729#discussion_r435862681", "createdAt": "2020-06-05T11:35:21Z", "author": {"login": "BraslavskiyAndrey"}, "path": "src/main/java/org/prebid/server/bidder/aja/AjaBidder.java", "diffHunk": "@@ -0,0 +1,188 @@\n+package org.prebid.server.bidder.aja;\n+\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.iab.openrtb.request.BidRequest;\n+import com.iab.openrtb.request.Imp;\n+import com.iab.openrtb.response.Bid;\n+import com.iab.openrtb.response.BidResponse;\n+import com.iab.openrtb.response.SeatBid;\n+import io.netty.handler.codec.http.HttpResponseStatus;\n+import io.vertx.core.http.HttpMethod;\n+import org.prebid.server.bidder.Bidder;\n+import org.prebid.server.bidder.aja.proto.ExtImpAja;\n+import org.prebid.server.bidder.model.BidderBid;\n+import org.prebid.server.bidder.model.BidderError;\n+import org.prebid.server.bidder.model.HttpCall;\n+import org.prebid.server.bidder.model.HttpRequest;\n+import org.prebid.server.bidder.model.Result;\n+import org.prebid.server.exception.PreBidException;\n+import org.prebid.server.json.DecodeException;\n+import org.prebid.server.json.EncodeException;\n+import org.prebid.server.json.JacksonMapper;\n+import org.prebid.server.proto.openrtb.ext.ExtPrebid;\n+import org.prebid.server.proto.openrtb.ext.response.BidType;\n+import org.prebid.server.util.HttpUtil;\n+\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+import java.util.stream.Collectors;\n+\n+public class AjaBidder implements Bidder<BidRequest> {\n+\n+    private static final TypeReference<ExtPrebid<?, ExtImpAja>> AJA_EXT_TYPE_REFERENCE =\n+            new TypeReference<ExtPrebid<?, ExtImpAja>>() {\n+            };\n+\n+    private final String endpointUrl;\n+    private final JacksonMapper mapper;\n+\n+    public AjaBidder(String endpointUrl, JacksonMapper mapper) {\n+        this.endpointUrl = HttpUtil.validateUrl(Objects.requireNonNull(endpointUrl));\n+        this.mapper = Objects.requireNonNull(mapper);\n+    }\n+\n+    @Override\n+    public Result<List<HttpRequest<BidRequest>>> makeHttpRequests(BidRequest bidRequest) {\n+        final List<BidderError> errors = new ArrayList<>();\n+        final List<HttpRequest<BidRequest>> result = new ArrayList<>();\n+\n+        final List<String> tagIds = new ArrayList<>();\n+        final Map<String, Imp> impsByTagID = new HashMap<>();\n+\n+        for (Imp imp : bidRequest.getImp()) {\n+            final ExtImpAja extImpAja = parseExtAJA(imp, errors);\n+            if (extImpAja == null) {\n+                continue;\n+            }\n+            imp = imp.toBuilder()\n+                    .tagid(extImpAja.getAdSpotID())\n+                    .ext(null)\n+                    .build();\n+\n+            final String tagId = imp.getTagid();\n+            if (!impsByTagID.containsKey(tagId)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3814afcfe6511c2da278bcdf54c039eb1daec543"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c5f588653ddb8b92dce572e1dabd093189a6bfe", "author": {"user": {"login": "rpanchyk", "name": null}}, "url": "https://github.com/prebid/prebid-server-java/commit/5c5f588653ddb8b92dce572e1dabd093189a6bfe", "committedDate": "2020-08-19T12:47:56Z", "message": "Merge branch 'master' into aja-bidder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01d88272899e9b0764981bf97d8731441731c445", "author": {"user": {"login": "rpanchyk", "name": null}}, "url": "https://github.com/prebid/prebid-server-java/commit/01d88272899e9b0764981bf97d8731441731c445", "committedDate": "2020-08-19T12:54:26Z", "message": "Fix config for pbs-enforces-ccpa key"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNDI2NzE3", "url": "https://github.com/prebid/prebid-server-java/pull/729#pullrequestreview-470426717", "createdAt": "2020-08-19T12:55:08Z", "commit": {"oid": "01d88272899e9b0764981bf97d8731441731c445"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30de2850e5fea80dc96aa9ba609f47ab27fd08c0", "author": {"user": {"login": "rpanchyk", "name": null}}, "url": "https://github.com/prebid/prebid-server-java/commit/30de2850e5fea80dc96aa9ba609f47ab27fd08c0", "committedDate": "2020-09-07T08:31:03Z", "message": "Merge branch 'master' into aja-bidder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "baa93d3710b0acb90d26018850a5ef84beb3009c", "author": {"user": {"login": "rpanchyk", "name": null}}, "url": "https://github.com/prebid/prebid-server-java/commit/baa93d3710b0acb90d26018850a5ef84beb3009c", "committedDate": "2020-09-15T13:01:45Z", "message": "Merge branch 'master' into aja-bidder"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3194, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}