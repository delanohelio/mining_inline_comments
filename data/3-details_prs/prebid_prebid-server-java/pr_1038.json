{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5MjI1Mjc5", "number": 1038, "title": "Add Adform video bid response support", "bodyText": "", "createdAt": "2020-11-30T01:42:44Z", "url": "https://github.com/prebid/prebid-server-java/pull/1038", "merged": true, "mergeCommit": {"oid": "1b4ba3cc36fa83957f3b07a9887495237eaf4cc5"}, "closed": true, "closedAt": "2020-12-02T14:29:57Z", "author": {"login": "snahornyi"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdhbQnHgH2gAyNTI5MjI1Mjc5OmY5OWUwZDc5YWNiNzdkNzMwMmRiMWI1N2RhMmQ2YmZlNzBiMzIwOTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiPZ0LAH2gAyNTI5MjI1Mjc5OmExNTZmZjE2MDU4Y2FhZTJmOTc0OGM0ZGRhMGM2ZTkzNDExZjdmMjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f99e0d79acb77d7302db1b57da2d6bfe70b32099", "author": {"user": null}, "url": "https://github.com/prebid/prebid-server-java/commit/f99e0d79acb77d7302db1b57da2d6bfe70b32099", "committedDate": "2020-11-30T01:42:19Z", "message": "Add Adform video bid response support"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwOTU4Mzk5", "url": "https://github.com/prebid/prebid-server-java/pull/1038#pullrequestreview-540958399", "createdAt": "2020-11-30T14:28:04Z", "commit": {"oid": "f99e0d79acb77d7302db1b57da2d6bfe70b32099"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNDoyODowNFrOH79iLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxNDoyODozOVrOH79jog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjYzNjIwNw==", "bodyText": "Seems we don't need else here. Just if on new line.", "url": "https://github.com/prebid/prebid-server-java/pull/1038#discussion_r532636207", "createdAt": "2020-11-30T14:28:04Z", "author": {"login": "rpanchyk"}, "path": "src/main/java/org/prebid/server/bidder/adform/AdformBidder.java", "diffHunk": "@@ -291,24 +291,43 @@ private String getUrl(List<ExtImpAdform> extImpAdforms) {\n \n         for (int i = 0; i < adformBids.size(); i++) {\n             final AdformBid adformBid = adformBids.get(i);\n-            if (StringUtils.isEmpty(adformBid.getBanner()) || !Objects.equals(adformBid.getResponse(), BANNER)) {\n+            final String adm = resolveAdm(adformBid);\n+            if (StringUtils.isBlank(adm)) {\n                 continue;\n             }\n+            final BidType bidType = resolveBidType(adformBid.getResponse());\n             final Imp imp = imps.get(i);\n             bidderBids.add(BidderBid.of(Bid.builder()\n                             .id(imp.getId())\n                             .impid(imp.getId())\n                             .price(adformBid.getWinBid())\n-                            .adm(adformBid.getBanner())\n+                            .adm(adm)\n                             .w(adformBid.getWidth())\n                             .h(adformBid.getHeight())\n                             .dealid(adformBid.getDealId())\n                             .crid(adformBid.getWinCrid())\n                             .build(),\n-                    BidType.banner,\n+                    bidType,\n                     currency));\n         }\n \n         return bidderBids;\n     }\n+\n+    private String resolveAdm(AdformBid adformBid) {\n+        if (Objects.equals(adformBid.getResponse(), \"banner\")) {\n+            return adformBid.getBanner();\n+        } else if (Objects.equals(adformBid.getResponse(), \"vast_content\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f99e0d79acb77d7302db1b57da2d6bfe70b32099"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjYzNjU3OA==", "bodyText": "Can be transformed to ternary checking.", "url": "https://github.com/prebid/prebid-server-java/pull/1038#discussion_r532636578", "createdAt": "2020-11-30T14:28:39Z", "author": {"login": "rpanchyk"}, "path": "src/main/java/org/prebid/server/bidder/adform/AdformBidder.java", "diffHunk": "@@ -291,24 +291,43 @@ private String getUrl(List<ExtImpAdform> extImpAdforms) {\n \n         for (int i = 0; i < adformBids.size(); i++) {\n             final AdformBid adformBid = adformBids.get(i);\n-            if (StringUtils.isEmpty(adformBid.getBanner()) || !Objects.equals(adformBid.getResponse(), BANNER)) {\n+            final String adm = resolveAdm(adformBid);\n+            if (StringUtils.isBlank(adm)) {\n                 continue;\n             }\n+            final BidType bidType = resolveBidType(adformBid.getResponse());\n             final Imp imp = imps.get(i);\n             bidderBids.add(BidderBid.of(Bid.builder()\n                             .id(imp.getId())\n                             .impid(imp.getId())\n                             .price(adformBid.getWinBid())\n-                            .adm(adformBid.getBanner())\n+                            .adm(adm)\n                             .w(adformBid.getWidth())\n                             .h(adformBid.getHeight())\n                             .dealid(adformBid.getDealId())\n                             .crid(adformBid.getWinCrid())\n                             .build(),\n-                    BidType.banner,\n+                    bidType,\n                     currency));\n         }\n \n         return bidderBids;\n     }\n+\n+    private String resolveAdm(AdformBid adformBid) {\n+        if (Objects.equals(adformBid.getResponse(), \"banner\")) {\n+            return adformBid.getBanner();\n+        } else if (Objects.equals(adformBid.getResponse(), \"vast_content\")) {\n+            return adformBid.getVastContent();\n+        }\n+\n+        return \"\";\n+    }\n+\n+    private BidType resolveBidType(String response) {\n+        if (Objects.equals(response, BANNER)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f99e0d79acb77d7302db1b57da2d6bfe70b32099"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35c8f7b3c5bb5c15c430c7279252b503903a015e", "author": {"user": null}, "url": "https://github.com/prebid/prebid-server-java/commit/35c8f7b3c5bb5c15c430c7279252b503903a015e", "committedDate": "2020-11-30T14:36:38Z", "message": "Fixes after review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwOTY4NDgy", "url": "https://github.com/prebid/prebid-server-java/pull/1038#pullrequestreview-540968482", "createdAt": "2020-11-30T14:38:40Z", "commit": {"oid": "35c8f7b3c5bb5c15c430c7279252b503903a015e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a156ff16058caae2f9748c4dda0c6e93411f7f29", "author": {"user": {"login": "rpanchyk", "name": null}}, "url": "https://github.com/prebid/prebid-server-java/commit/a156ff16058caae2f9748c4dda0c6e93411f7f29", "committedDate": "2020-12-02T14:27:26Z", "message": "Merge branch 'master' into adform/video/support"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2950, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}