{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyNDQ0ODcw", "number": 616, "reviewThreads": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOTo1Nzo1OVrODnxlFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwOTozODoyMFrODtBp6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMDMzMzY2OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOTo1Nzo1OVrOF19u2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOTo1Nzo1OVrOF19u2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjEzMDI2Ng==", "bodyText": "Pls extract this to separate method. No consumer need here.", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r392130266", "createdAt": "2020-03-13T09:57:59Z", "author": {"login": "rpanchyk"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -100,6 +104,29 @@ public BidResponseCreator(CacheService cacheService, BidderCatalog bidderCatalog\n         this.cacheAssetUrlTemplate = Objects.requireNonNull(cacheService.getCachedAssetURLTemplate());\n         this.storedRequestProcessor = Objects.requireNonNull(storedRequestProcessor);\n         this.mapper = Objects.requireNonNull(mapper);\n+\n+        if (generateBidId) {\n+            overwriteBidIdConsumer = bidderResponses -> {\n+                if (CollectionUtils.isNotEmpty(bidderResponses)) {\n+                    bidderResponses.stream()\n+                            .filter(Objects::nonNull)\n+                            .map(BidderResponse::getSeatBid)\n+                            .filter(Objects::nonNull)\n+                            .map(BidderSeatBid::getBids)\n+                            .filter(Objects::nonNull)\n+                            .forEach(bidderBids -> {\n+                                bidderBids.stream()\n+                                        .filter(Objects::nonNull)\n+                                        .map(BidderBid::getBid)\n+                                        .filter(Objects::nonNull)\n+                                        .forEach(bid -> bid.setId(UUID.randomUUID().toString()));\n+                            });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99ee0efb84e9e3a4608acd3adab7d84bea02be53"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMDMzNTU1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/spring/config/ServiceConfiguration.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOTo1ODozMlrOF19wDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QwOTo1ODozMlrOF19wDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjEzMDU3Mg==", "bodyText": "Pls avoid default config values, just add it to application.yaml.", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r392130572", "createdAt": "2020-03-13T09:58:32Z", "author": {"login": "rpanchyk"}, "path": "src/main/java/org/prebid/server/spring/config/ServiceConfiguration.java", "diffHunk": "@@ -406,9 +406,11 @@ BidResponseCreator bidResponseCreator(\n             BidderCatalog bidderCatalog,\n             EventsService eventsService,\n             StoredRequestProcessor storedRequestProcessor,\n-            JacksonMapper mapper) {\n+            JacksonMapper mapper,\n+            @Value(\"${auction.generate-bid-id:#{false}}\") Boolean generateBidId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99ee0efb84e9e3a4608acd3adab7d84bea02be53"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTEzOTc2OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0MTowMFrOF6oGXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0MTowMFrOF6oGXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAxODcxOA==", "bodyText": "Can produce NPE.\nReplace to Boolean and use BooleanUtils.isTrue and similar methods", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397018718", "createdAt": "2020-03-24T09:41:00Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -89,9 +91,11 @@\n     private final String cachePath;\n     private final String cacheAssetUrlTemplate;\n     private final StoredRequestProcessor storedRequestProcessor;\n+    private final Consumer<BidResponse> overwriteBidIdConsumer;\n \n     public BidResponseCreator(CacheService cacheService, BidderCatalog bidderCatalog, EventsService eventsService,\n-                              StoredRequestProcessor storedRequestProcessor, JacksonMapper mapper) {\n+                              StoredRequestProcessor storedRequestProcessor,\n+                              JacksonMapper mapper, boolean generateBidId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTE0MjE3OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0MTozN1rOF6oH4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0MTozN1rOF6oH4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAxOTEwNg==", "bodyText": "replace to ? : operator", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397019106", "createdAt": "2020-03-24T09:41:37Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -100,6 +104,45 @@ public BidResponseCreator(CacheService cacheService, BidderCatalog bidderCatalog\n         this.cacheAssetUrlTemplate = Objects.requireNonNull(cacheService.getCachedAssetURLTemplate());\n         this.storedRequestProcessor = Objects.requireNonNull(storedRequestProcessor);\n         this.mapper = Objects.requireNonNull(mapper);\n+\n+        if (generateBidId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTE1MTA0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0NDowNlrOF6oNrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0NDowNlrOF6oNrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyMDU4OQ==", "bodyText": "extract into 2 values", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397020589", "createdAt": "2020-03-24T09:44:06Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -100,6 +104,45 @@ public BidResponseCreator(CacheService cacheService, BidderCatalog bidderCatalog\n         this.cacheAssetUrlTemplate = Objects.requireNonNull(cacheService.getCachedAssetURLTemplate());\n         this.storedRequestProcessor = Objects.requireNonNull(storedRequestProcessor);\n         this.mapper = Objects.requireNonNull(mapper);\n+\n+        if (generateBidId) {\n+            overwriteBidIdConsumer = overwriteBidIdConsumer();\n+        } else {\n+            overwriteBidIdConsumer = bidderResponses -> {\n+            };\n+        }\n+\n+    }\n+\n+    private Consumer<BidResponse> overwriteBidIdConsumer() {\n+        return bidderResponses -> {\n+            bidderResponses.getSeatbid().stream()\n+                    .map(SeatBid::getBid)\n+                    .forEach(bids -> bids.stream()\n+                            .filter(Objects::nonNull)\n+                            .forEach(this::replaceBidId));\n+\n+        };\n+    }\n+\n+    private void replaceBidId(Bid bid) {\n+        final ObjectNode ext = bid.getExt();\n+        final ExtBidPrebid extBidPrebid = parsePrebidExt(ext);\n+        if (extBidPrebid != null) {\n+            extBidPrebid.setBidId(UUID.randomUUID().toString());\n+            try {\n+                bid.setExt(ext.set(PREBID_EXT, mapper.mapper().readTree(mapper.encode(extBidPrebid))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTE1NTkyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0NToyOFrOF6oQsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0NToyOFrOF6oQsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyMTM2Mw==", "bodyText": "It is better to log smth if we cant set id", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397021363", "createdAt": "2020-03-24T09:45:28Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -100,6 +104,45 @@ public BidResponseCreator(CacheService cacheService, BidderCatalog bidderCatalog\n         this.cacheAssetUrlTemplate = Objects.requireNonNull(cacheService.getCachedAssetURLTemplate());\n         this.storedRequestProcessor = Objects.requireNonNull(storedRequestProcessor);\n         this.mapper = Objects.requireNonNull(mapper);\n+\n+        if (generateBidId) {\n+            overwriteBidIdConsumer = overwriteBidIdConsumer();\n+        } else {\n+            overwriteBidIdConsumer = bidderResponses -> {\n+            };\n+        }\n+\n+    }\n+\n+    private Consumer<BidResponse> overwriteBidIdConsumer() {\n+        return bidderResponses -> {\n+            bidderResponses.getSeatbid().stream()\n+                    .map(SeatBid::getBid)\n+                    .forEach(bids -> bids.stream()\n+                            .filter(Objects::nonNull)\n+                            .forEach(this::replaceBidId));\n+\n+        };\n+    }\n+\n+    private void replaceBidId(Bid bid) {\n+        final ObjectNode ext = bid.getExt();\n+        final ExtBidPrebid extBidPrebid = parsePrebidExt(ext);\n+        if (extBidPrebid != null) {\n+            extBidPrebid.setBidId(UUID.randomUUID().toString());\n+            try {\n+                bid.setExt(ext.set(PREBID_EXT, mapper.mapper().readTree(mapper.encode(extBidPrebid))));\n+            } catch (JsonProcessingException e) {\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTE2MzAzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/proto/openrtb/ext/response/ExtBidPrebid.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0NzoyNFrOF6oVSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo0NzoyNFrOF6oVSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyMjUzOA==", "bodyText": "I am not sure if it is good idea to make this mutable.\nJust imagine how hard it will be in a future to find state change if anyone can set whenever they want.\n@rpanchyk  what do you think?", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397022538", "createdAt": "2020-03-24T09:47:24Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/proto/openrtb/ext/response/ExtBidPrebid.java", "diffHunk": "@@ -2,18 +2,20 @@\n \n import com.fasterxml.jackson.annotation.JsonProperty;\n import com.iab.openrtb.request.Video;\n-import lombok.AllArgsConstructor;\n-import lombok.Value;\n+import lombok.Builder;\n+import lombok.Data;\n \n import java.util.Map;\n \n /**\n  * Defines the contract for bidresponse.seatbid.bid[i].ext.prebid\n  */\n-@AllArgsConstructor(staticName = \"of\")\n-@Value\n+@Builder(toBuilder = true)\n+@Data", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTE4MDA0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1MTo0NlrOF6ogHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1MTo0NlrOF6ogHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyNTMwOA==", "bodyText": "I'd probably just added method toSeatbid, which create appropriate objects.\nAnd modify toSeatBid", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397025308", "createdAt": "2020-03-24T09:51:46Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -514,12 +557,14 @@ private BidResponse toBidResponse(\n                 toExtBidResponse(bidderResponses, bidRequest, cacheResult, videoStoredDataResult,\n                         debugEnabled, bidErrors);\n \n-        return BidResponse.builder()\n+        BidResponse response = BidResponse.builder()\n                 .id(bidRequest.getId())\n                 .cur(bidRequest.getCur().get(0))\n                 .seatbid(seatBids)\n                 .ext(mapper.mapper().valueToTree(extBidResponse))\n                 .build();\n+        overwriteBidIdConsumer.accept(response);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTE5MDcxOnYy", "diffSide": "RIGHT", "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1NDoyNFrOF6omxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1NDoyNFrOF6omxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyNzAxMg==", "bodyText": "?", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397027012", "createdAt": "2020-03-24T09:54:24Z", "author": {"login": "DGarbar"}, "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "diffHunk": "@@ -371,6 +369,40 @@ public void shouldSkipBidderResponsesWhereSeatBidContainEmptyBids() {\n         verify(cacheService, never()).cacheBidsOpenrtb(anyList(), anyList(), any(), any(), any());\n     }\n \n+    @Test\n+    public void shouldOverwriteBidderIdToUUID() throws JsonProcessingException {\n+        // given\n+        final BidRequest bidRequest = givenBidRequest();\n+\n+        final ExtPrebid<ExtBidPrebid, ?> prebid = ExtPrebid.of(ExtBidPrebid.builder().type(banner).build(), null);\n+        final Bid bid = Bid.builder()\n+                .id(\"123\")\n+                .impid(\"imp123\")\n+                .w(123)\n+                .h(123)\n+                .price(BigDecimal.ONE)\n+                .ext(mapper.valueToTree(prebid))\n+                .build();\n+        final List<BidderResponse> bidderResponses = singletonList(\n+                BidderResponse.of(\"bidder2\", givenSeatBid(BidderBid.of(bid, banner, \"USD\")), 0));\n+\n+        final BidResponseCreator bidResponseCreator = new BidResponseCreator(cacheService, bidderCatalog, eventsService,\n+                storedRequestProcessor, jacksonMapper, true);\n+        // when\n+        final BidResponse bidResponse = bidResponseCreator.create(bidderResponses, bidRequest,\n+                null, CACHE_INFO, ACCOUNT, timeout, false).result();\n+\n+        // then\n+        assertThat(bidResponse.getSeatbid()).hasSize(1);\n+        assertThat(bidResponse.getSeatbid().get(0).getBid()).hasSize(1);\n+        final ExtBidPrebid ext = mapper.readValue(bidResponse.getSeatbid().get(0).getBid().get(0)\n+                .getExt().get(\"prebid\").toString(), ExtBidPrebid.class);\n+        assertThat(ext.getBidId()).isNotNull();\n+\n+        System.out.println(ext.getBidId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTE5MjYwOnYy", "diffSide": "RIGHT", "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1NDo1MVrOF6on7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1NDo1MVrOF6on7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyNzMwOQ==", "bodyText": "expectedExtBidPrebid", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397027309", "createdAt": "2020-03-24T09:54:51Z", "author": {"login": "DGarbar"}, "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "diffHunk": "@@ -371,6 +369,40 @@ public void shouldSkipBidderResponsesWhereSeatBidContainEmptyBids() {\n         verify(cacheService, never()).cacheBidsOpenrtb(anyList(), anyList(), any(), any(), any());\n     }\n \n+    @Test\n+    public void shouldOverwriteBidderIdToUUID() throws JsonProcessingException {\n+        // given\n+        final BidRequest bidRequest = givenBidRequest();\n+\n+        final ExtPrebid<ExtBidPrebid, ?> prebid = ExtPrebid.of(ExtBidPrebid.builder().type(banner).build(), null);\n+        final Bid bid = Bid.builder()\n+                .id(\"123\")\n+                .impid(\"imp123\")\n+                .w(123)\n+                .h(123)\n+                .price(BigDecimal.ONE)\n+                .ext(mapper.valueToTree(prebid))\n+                .build();\n+        final List<BidderResponse> bidderResponses = singletonList(\n+                BidderResponse.of(\"bidder2\", givenSeatBid(BidderBid.of(bid, banner, \"USD\")), 0));\n+\n+        final BidResponseCreator bidResponseCreator = new BidResponseCreator(cacheService, bidderCatalog, eventsService,\n+                storedRequestProcessor, jacksonMapper, true);\n+        // when\n+        final BidResponse bidResponse = bidResponseCreator.create(bidderResponses, bidRequest,\n+                null, CACHE_INFO, ACCOUNT, timeout, false).result();\n+\n+        // then\n+        assertThat(bidResponse.getSeatbid()).hasSize(1);\n+        assertThat(bidResponse.getSeatbid().get(0).getBid()).hasSize(1);\n+        final ExtBidPrebid ext = mapper.readValue(bidResponse.getSeatbid().get(0).getBid().get(0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTE5NDg1OnYy", "diffSide": "RIGHT", "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1NToyNlrOF6opUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1NToyNlrOF6opUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyNzY2NA==", "bodyText": "does this values are really required ?", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397027664", "createdAt": "2020-03-24T09:55:26Z", "author": {"login": "DGarbar"}, "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "diffHunk": "@@ -371,6 +369,40 @@ public void shouldSkipBidderResponsesWhereSeatBidContainEmptyBids() {\n         verify(cacheService, never()).cacheBidsOpenrtb(anyList(), anyList(), any(), any(), any());\n     }\n \n+    @Test\n+    public void shouldOverwriteBidderIdToUUID() throws JsonProcessingException {\n+        // given\n+        final BidRequest bidRequest = givenBidRequest();\n+\n+        final ExtPrebid<ExtBidPrebid, ?> prebid = ExtPrebid.of(ExtBidPrebid.builder().type(banner).build(), null);\n+        final Bid bid = Bid.builder()\n+                .id(\"123\")\n+                .impid(\"imp123\")\n+                .w(123)\n+                .h(123)\n+                .price(BigDecimal.ONE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ2MTIwODk3OnYy", "diffSide": "RIGHT", "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQwOTo1ODo0OFrOF6oyPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxMzoxMzo1NlrOF6vkjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyOTk1MQ==", "bodyText": "Have you tried to use .extract method?", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397029951", "createdAt": "2020-03-24T09:58:48Z", "author": {"login": "DGarbar"}, "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "diffHunk": "@@ -371,6 +369,40 @@ public void shouldSkipBidderResponsesWhereSeatBidContainEmptyBids() {\n         verify(cacheService, never()).cacheBidsOpenrtb(anyList(), anyList(), any(), any(), any());\n     }\n \n+    @Test\n+    public void shouldOverwriteBidderIdToUUID() throws JsonProcessingException {\n+        // given\n+        final BidRequest bidRequest = givenBidRequest();\n+\n+        final ExtPrebid<ExtBidPrebid, ?> prebid = ExtPrebid.of(ExtBidPrebid.builder().type(banner).build(), null);\n+        final Bid bid = Bid.builder()\n+                .id(\"123\")\n+                .impid(\"imp123\")\n+                .w(123)\n+                .h(123)\n+                .price(BigDecimal.ONE)\n+                .ext(mapper.valueToTree(prebid))\n+                .build();\n+        final List<BidderResponse> bidderResponses = singletonList(\n+                BidderResponse.of(\"bidder2\", givenSeatBid(BidderBid.of(bid, banner, \"USD\")), 0));\n+\n+        final BidResponseCreator bidResponseCreator = new BidResponseCreator(cacheService, bidderCatalog, eventsService,\n+                storedRequestProcessor, jacksonMapper, true);\n+        // when\n+        final BidResponse bidResponse = bidResponseCreator.create(bidderResponses, bidRequest,\n+                null, CACHE_INFO, ACCOUNT, timeout, false).result();\n+\n+        // then\n+        assertThat(bidResponse.getSeatbid()).hasSize(1);\n+        assertThat(bidResponse.getSeatbid().get(0).getBid()).hasSize(1);\n+        final ExtBidPrebid ext = mapper.readValue(bidResponse.getSeatbid().get(0).getBid().get(0)\n+                .getExt().get(\"prebid\").toString(), ExtBidPrebid.class);\n+        assertThat(ext.getBidId()).isNotNull();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzE0MTEzMw==", "bodyText": "assertThat(bidResponse.getSeatbid())\n                .flatExtracting(SeatBid::getBid)\n                .extracting(Bid::getExt)\n                .extracting(ext -> ext.get(\"prebid\"))\n                .extracting(extPrebid -> mapper.treeToValue(extPrebid, ExtBidPrebid.class))\n                .extracting(ExtBidPrebid::getBidId)\n                .hasSize(1)\n                .doesNotContainNull();```", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r397141133", "createdAt": "2020-03-24T13:13:56Z", "author": {"login": "DGarbar"}, "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "diffHunk": "@@ -371,6 +369,40 @@ public void shouldSkipBidderResponsesWhereSeatBidContainEmptyBids() {\n         verify(cacheService, never()).cacheBidsOpenrtb(anyList(), anyList(), any(), any(), any());\n     }\n \n+    @Test\n+    public void shouldOverwriteBidderIdToUUID() throws JsonProcessingException {\n+        // given\n+        final BidRequest bidRequest = givenBidRequest();\n+\n+        final ExtPrebid<ExtBidPrebid, ?> prebid = ExtPrebid.of(ExtBidPrebid.builder().type(banner).build(), null);\n+        final Bid bid = Bid.builder()\n+                .id(\"123\")\n+                .impid(\"imp123\")\n+                .w(123)\n+                .h(123)\n+                .price(BigDecimal.ONE)\n+                .ext(mapper.valueToTree(prebid))\n+                .build();\n+        final List<BidderResponse> bidderResponses = singletonList(\n+                BidderResponse.of(\"bidder2\", givenSeatBid(BidderBid.of(bid, banner, \"USD\")), 0));\n+\n+        final BidResponseCreator bidResponseCreator = new BidResponseCreator(cacheService, bidderCatalog, eventsService,\n+                storedRequestProcessor, jacksonMapper, true);\n+        // when\n+        final BidResponse bidResponse = bidResponseCreator.create(bidderResponses, bidRequest,\n+                null, CACHE_INFO, ACCOUNT, timeout, false).result();\n+\n+        // then\n+        assertThat(bidResponse.getSeatbid()).hasSize(1);\n+        assertThat(bidResponse.getSeatbid().get(0).getBid()).hasSize(1);\n+        final ExtBidPrebid ext = mapper.readValue(bidResponse.getSeatbid().get(0).getBid().get(0)\n+                .getExt().get(\"prebid\").toString(), ExtBidPrebid.class);\n+        assertThat(ext.getBidId()).isNotNull();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzAyOTk1MQ=="}, "originalCommit": {"oid": "91f51d5d20695e76e2acf5adf255d3b9d1beed7e"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NTE0MDk0OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo0MzowM1rOF8vdxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo0MzowM1rOF8vdxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTIzNjU1MA==", "bodyText": "we use treeToValue method", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r399236550", "createdAt": "2020-03-27T12:43:03Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -100,6 +108,48 @@ public BidResponseCreator(CacheService cacheService, BidderCatalog bidderCatalog\n         this.cacheAssetUrlTemplate = Objects.requireNonNull(cacheService.getCachedAssetURLTemplate());\n         this.storedRequestProcessor = Objects.requireNonNull(storedRequestProcessor);\n         this.mapper = Objects.requireNonNull(mapper);\n+\n+        overwriteBidIdConsumer = BooleanUtils.isTrue(generateBidId) ? overwriteBidIdConsumer() : bidResponse -> {\n+        };\n+\n+    }\n+\n+    private Consumer<BidResponse> overwriteBidIdConsumer() {\n+        return bidderResponses -> bidderResponses.getSeatbid().stream()\n+                .map(SeatBid::getBid)\n+                .forEach(bids -> bids.stream()\n+                        .filter(Objects::nonNull)\n+                        .forEach(this::replaceBidId));\n+    }\n+\n+    private void replaceBidId(Bid bid) {\n+        final ObjectNode ext = bid.getExt();\n+        final ExtBidPrebid extBidPrebid = parsePrebidExt(ext);\n+        if (extBidPrebid != null) {\n+            final ExtBidPrebid modifiedExtBidPrebid = ExtBidPrebid.of(\n+                    UUID.randomUUID().toString(),\n+                    extBidPrebid.getType(),\n+                    extBidPrebid.getTargeting(),\n+                    extBidPrebid.getCache(),\n+                    extBidPrebid.getStoredRequestAttributes(),\n+                    extBidPrebid.getEvents(),\n+                    extBidPrebid.getVideo());\n+            try {\n+                final JsonNode extBidPrebidValue = mapper.mapper().readTree(mapper.encode(modifiedExtBidPrebid));\n+                final ObjectNode prebidExtNode = ext.set(PREBID_EXT, extBidPrebidValue);\n+                bid.setExt(prebidExtNode);\n+            } catch (JsonProcessingException e) {\n+                logger.debug(\"Parsing error\", e);\n+            }\n+        }\n+    }\n+\n+    private ExtBidPrebid parsePrebidExt(ObjectNode ext) {\n+        try {\n+            return mapper.decodeValue(ext.get(PREBID_EXT).toString(), ExtBidPrebid.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85dbf6e156b6237e14c281f68bfce1d9afc22c5f"}, "originalPosition": 82}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NTE3MTI3OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1MToyOVrOF8vv5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1MToyOVrOF8vv5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTI0MTE5MA==", "bodyText": "Isn't it all the logic above but in 1 line ?\n    final String bidId = isOverwriteBidIdConsumer ? UUID.randomUUID().toString() : null;\n    final ExtBidPrebid prebidExt = ExtBidPrebid.of(bidId, bidType, targetingKeywords, cache, storedVideo,\n                events, null);", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r399241190", "createdAt": "2020-03-27T12:51:29Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -641,7 +693,9 @@ private Bid toBid(BidderBid bidderBid, String bidder, ExtRequestTargeting target\n         final Video storedVideo = impIdToStoredVideo.get(bid.getImpid());\n         final Events events = eventsEnabled ? eventsService.createEvent(bid.getId(), account.getId()) : null;\n \n-        final ExtBidPrebid prebidExt = ExtBidPrebid.of(bidType, targetingKeywords, cache, storedVideo, events, null);\n+        final ExtBidPrebid prebidExt = ExtBidPrebid.of(null, bidType, targetingKeywords, cache, storedVideo,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85dbf6e156b6237e14c281f68bfce1d9afc22c5f"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NTE3MzExOnYy", "diffSide": "RIGHT", "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1MjowMlrOF8vxDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1MjowMlrOF8vxDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTI0MTQ4NA==", "bodyText": "check your IDEA code style", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r399241484", "createdAt": "2020-03-27T12:52:02Z", "author": {"login": "DGarbar"}, "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "diffHunk": "@@ -86,8 +86,7 @@\n import static org.mockito.BDDMockito.given;\n import static org.mockito.Mockito.never;\n import static org.mockito.Mockito.verify;\n-import static org.prebid.server.proto.openrtb.ext.response.BidType.banner;\n-import static org.prebid.server.proto.openrtb.ext.response.BidType.xNative;\n+import static org.prebid.server.proto.openrtb.ext.response.BidType.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85dbf6e156b6237e14c281f68bfce1d9afc22c5f"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NTE3NTA1OnYy", "diffSide": "RIGHT", "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1MjoyOVrOF8vyEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1MjoyOVrOF8vyEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTI0MTc0NA==", "bodyText": "This is unnecessary", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r399241744", "createdAt": "2020-03-27T12:52:29Z", "author": {"login": "DGarbar"}, "path": "src/test/java/org/prebid/server/auction/BidResponseCreatorTest.java", "diffHunk": "@@ -371,6 +369,42 @@ public void shouldSkipBidderResponsesWhereSeatBidContainEmptyBids() {\n         verify(cacheService, never()).cacheBidsOpenrtb(anyList(), anyList(), any(), any(), any());\n     }\n \n+    @Test\n+    public void shouldOverwriteBidderIdToUUID() {\n+        // given\n+        final BidRequest bidRequest = givenBidRequest();\n+\n+        final ExtPrebid<ExtBidPrebid, ?> prebid = ExtPrebid.of(ExtBidPrebid.of(null, banner, null,\n+                null, null, null, null), null);\n+        final Bid bid = Bid.builder()\n+                .id(\"123\")\n+                .impid(\"imp123\")\n+                .ext(mapper.valueToTree(prebid))\n+                .build();\n+        final List<BidderResponse> bidderResponses = singletonList(\n+                BidderResponse.of(\"bidder2\", givenSeatBid(BidderBid.of(bid, banner, \"USD\")), 0));\n+\n+        final BidResponseCreator bidResponseCreator = new BidResponseCreator(cacheService, bidderCatalog, eventsService,\n+                storedRequestProcessor, jacksonMapper, true);\n+        // when\n+        final BidResponse bidResponse = bidResponseCreator.create(bidderResponses, bidRequest,\n+                null, CACHE_INFO, ACCOUNT, timeout, false).result();\n+\n+        // then\n+        assertThat(bidResponse.getSeatbid()).hasSize(1);\n+        assertThat(bidResponse.getSeatbid().get(0).getBid()).hasSize(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85dbf6e156b6237e14c281f68bfce1d9afc22c5f"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NTE3NzQ3OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1MzowNFrOF8vzaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1MzowNFrOF8vzaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTI0MjA5MQ==", "bodyText": "Too ganeral debug message", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r399242091", "createdAt": "2020-03-27T12:53:04Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -100,6 +108,48 @@ public BidResponseCreator(CacheService cacheService, BidderCatalog bidderCatalog\n         this.cacheAssetUrlTemplate = Objects.requireNonNull(cacheService.getCachedAssetURLTemplate());\n         this.storedRequestProcessor = Objects.requireNonNull(storedRequestProcessor);\n         this.mapper = Objects.requireNonNull(mapper);\n+\n+        overwriteBidIdConsumer = BooleanUtils.isTrue(generateBidId) ? overwriteBidIdConsumer() : bidResponse -> {\n+        };\n+\n+    }\n+\n+    private Consumer<BidResponse> overwriteBidIdConsumer() {\n+        return bidderResponses -> bidderResponses.getSeatbid().stream()\n+                .map(SeatBid::getBid)\n+                .forEach(bids -> bids.stream()\n+                        .filter(Objects::nonNull)\n+                        .forEach(this::replaceBidId));\n+    }\n+\n+    private void replaceBidId(Bid bid) {\n+        final ObjectNode ext = bid.getExt();\n+        final ExtBidPrebid extBidPrebid = parsePrebidExt(ext);\n+        if (extBidPrebid != null) {\n+            final ExtBidPrebid modifiedExtBidPrebid = ExtBidPrebid.of(\n+                    UUID.randomUUID().toString(),\n+                    extBidPrebid.getType(),\n+                    extBidPrebid.getTargeting(),\n+                    extBidPrebid.getCache(),\n+                    extBidPrebid.getStoredRequestAttributes(),\n+                    extBidPrebid.getEvents(),\n+                    extBidPrebid.getVideo());\n+            try {\n+                final JsonNode extBidPrebidValue = mapper.mapper().readTree(mapper.encode(modifiedExtBidPrebid));\n+                final ObjectNode prebidExtNode = ext.set(PREBID_EXT, extBidPrebidValue);\n+                bid.setExt(prebidExtNode);\n+            } catch (JsonProcessingException e) {\n+                logger.debug(\"Parsing error\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85dbf6e156b6237e14c281f68bfce1d9afc22c5f"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NTE4Mzg4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxMjo1NDo0OVrOF8v3Ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwOTo0MzowOFrOF-NloQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTI0MzA5MA==", "bodyText": "When creating event URLs and VAST IMP URLs, use this generated bidid instead of the bidder-created id.\nJust one line above.....", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r399243090", "createdAt": "2020-03-27T12:54:49Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -641,7 +693,9 @@ private Bid toBid(BidderBid bidderBid, String bidder, ExtRequestTargeting target\n         final Video storedVideo = impIdToStoredVideo.get(bid.getImpid());\n         final Events events = eventsEnabled ? eventsService.createEvent(bid.getId(), account.getId()) : null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "85dbf6e156b6237e14c281f68bfce1d9afc22c5f"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDc3ODY1Nw==", "bodyText": "?", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r400778657", "createdAt": "2020-03-31T09:43:08Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -641,7 +693,9 @@ private Bid toBid(BidderBid bidderBid, String bidder, ExtRequestTargeting target\n         final Video storedVideo = impIdToStoredVideo.get(bid.getImpid());\n         final Events events = eventsEnabled ? eventsService.createEvent(bid.getId(), account.getId()) : null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTI0MzA5MA=="}, "originalCommit": {"oid": "85dbf6e156b6237e14c281f68bfce1d9afc22c5f"}, "originalPosition": 107}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4NTM5NjI2OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwOTozODoyMFrOF-NZmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwOTozODoyMFrOF-NZmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDc3NTU3Ng==", "bodyText": "Replace with if", "url": "https://github.com/prebid/prebid-server-java/pull/616#discussion_r400775576", "createdAt": "2020-03-31T09:38:20Z", "author": {"login": "DGarbar"}, "path": "src/main/java/org/prebid/server/auction/BidResponseCreator.java", "diffHunk": "@@ -641,7 +654,10 @@ private Bid toBid(BidderBid bidderBid, String bidder, ExtRequestTargeting target\n         final Video storedVideo = impIdToStoredVideo.get(bid.getImpid());\n         final Events events = eventsEnabled ? eventsService.createEvent(bid.getId(), account.getId()) : null;\n \n-        final ExtBidPrebid prebidExt = ExtBidPrebid.of(bidType, targetingKeywords, cache, storedVideo, events, null);\n+        final String bidId = bidIdSupplier.get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "813a7d184c94f3d14b816b1b0c05031db7b391e3"}, "originalPosition": 57}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4136, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}