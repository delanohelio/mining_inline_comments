{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0MTM2MDgy", "number": 593, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo0Mjo0MlrODZLuQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo1NDo1OVrODZL6Kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3NzMzMDU3OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/bidder/facebook/FacebookBidder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo0Mjo0M1rOFfbvZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo0Mjo0M1rOFfbvZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUwNDY3Nw==", "bodyText": "This method can be transformed to list of supported sizes.", "url": "https://github.com/prebid/prebid-server-java/pull/593#discussion_r368504677", "createdAt": "2020-01-20T11:42:43Z", "author": {"login": "rpanchyk"}, "path": "src/main/java/org/prebid/server/bidder/facebook/FacebookBidder.java", "diffHunk": "@@ -207,14 +208,32 @@ private static Banner modifyBanner(Imp imp, boolean impInstlEqOne) {\n             return banner.toBuilder().w(0).h(0).format(null).build();\n         }\n \n-        if (!Objects.equals(banner.getH(), 50) && !Objects.equals(banner.getH(), 250)) {\n+        if (banner.getH() == null) {\n+            for (int i = 0; i < banner.getFormat().size(); i++) {\n+                final Format format = banner.getFormat().get(i);\n+                if (format != null && isBannerHeightValid(format.getH())) {\n+                    return banner.toBuilder()\n+                            .w(0)\n+                            .h(format.getH())\n+                            .format(null)\n+                            .build();\n+                }\n+            }\n+            throw new PreBidException(String.format(\"imp #%s: banner height required\", imp.getId()));\n+        }\n+\n+        if (!isBannerHeightValid(banner.getH())) {\n             throw new PreBidException(String.format(\"imp #%s: only banner heights 50 and 250 are supported\",\n                     imp.getId()));\n         }\n \n         return banner.toBuilder().w(-1).format(null).build();\n     }\n \n+    private static boolean isBannerHeightValid(Integer h) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2516847c483513c8c381e6cbb43f793fcaefacf0"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3NzMzMjkyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/bidder/facebook/FacebookBidder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo0MzozN1rOFfbwyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo0MzozN1rOFfbwyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUwNTAzNQ==", "bodyText": "Can banner.getFormat() be null?\nCan we use foreach here for better readability?", "url": "https://github.com/prebid/prebid-server-java/pull/593#discussion_r368505035", "createdAt": "2020-01-20T11:43:37Z", "author": {"login": "rpanchyk"}, "path": "src/main/java/org/prebid/server/bidder/facebook/FacebookBidder.java", "diffHunk": "@@ -207,14 +208,32 @@ private static Banner modifyBanner(Imp imp, boolean impInstlEqOne) {\n             return banner.toBuilder().w(0).h(0).format(null).build();\n         }\n \n-        if (!Objects.equals(banner.getH(), 50) && !Objects.equals(banner.getH(), 250)) {\n+        if (banner.getH() == null) {\n+            for (int i = 0; i < banner.getFormat().size(); i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2516847c483513c8c381e6cbb43f793fcaefacf0"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3NzM1MzYyOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/bidder/facebook/FacebookBidder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo1MTo1N1rOFfb9gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo1MTo1N1rOFfb9gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUwODI5MA==", "bodyText": "It is better to involve else if here, to prevent unnecessary code execution.", "url": "https://github.com/prebid/prebid-server-java/pull/593#discussion_r368508290", "createdAt": "2020-01-20T11:51:57Z", "author": {"login": "rpanchyk"}, "path": "src/main/java/org/prebid/server/bidder/facebook/FacebookBidder.java", "diffHunk": "@@ -207,14 +208,32 @@ private static Banner modifyBanner(Imp imp, boolean impInstlEqOne) {\n             return banner.toBuilder().w(0).h(0).format(null).build();\n         }\n \n-        if (!Objects.equals(banner.getH(), 50) && !Objects.equals(banner.getH(), 250)) {\n+        if (banner.getH() == null) {\n+            for (int i = 0; i < banner.getFormat().size(); i++) {\n+                final Format format = banner.getFormat().get(i);\n+                if (format != null && isBannerHeightValid(format.getH())) {\n+                    return banner.toBuilder()\n+                            .w(0)\n+                            .h(format.getH())\n+                            .format(null)\n+                            .build();\n+                }\n+            }\n+            throw new PreBidException(String.format(\"imp #%s: banner height required\", imp.getId()));\n+        }\n+\n+        if (!isBannerHeightValid(banner.getH())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2516847c483513c8c381e6cbb43f793fcaefacf0"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3NzM2MTA2OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/prebid/server/bidder/facebook/FacebookBidder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo1NDo1OVrOFfcCEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxMTo1NDo1OVrOFfcCEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUwOTQ1Ng==", "bodyText": "Seems we have to set w = 0 according to formal implementation.", "url": "https://github.com/prebid/prebid-server-java/pull/593#discussion_r368509456", "createdAt": "2020-01-20T11:54:59Z", "author": {"login": "rpanchyk"}, "path": "src/main/java/org/prebid/server/bidder/facebook/FacebookBidder.java", "diffHunk": "@@ -207,14 +208,32 @@ private static Banner modifyBanner(Imp imp, boolean impInstlEqOne) {\n             return banner.toBuilder().w(0).h(0).format(null).build();\n         }\n \n-        if (!Objects.equals(banner.getH(), 50) && !Objects.equals(banner.getH(), 250)) {\n+        if (banner.getH() == null) {\n+            for (int i = 0; i < banner.getFormat().size(); i++) {\n+                final Format format = banner.getFormat().get(i);\n+                if (format != null && isBannerHeightValid(format.getH())) {\n+                    return banner.toBuilder()\n+                            .w(0)\n+                            .h(format.getH())\n+                            .format(null)\n+                            .build();\n+                }\n+            }\n+            throw new PreBidException(String.format(\"imp #%s: banner height required\", imp.getId()));\n+        }\n+\n+        if (!isBannerHeightValid(banner.getH())) {\n             throw new PreBidException(String.format(\"imp #%s: only banner heights 50 and 250 are supported\",\n                     imp.getId()));\n         }\n \n         return banner.toBuilder().w(-1).format(null).build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2516847c483513c8c381e6cbb43f793fcaefacf0"}, "originalPosition": 32}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4121, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}