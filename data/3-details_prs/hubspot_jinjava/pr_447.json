{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MDgwOTcw", "number": 447, "title": "Global context", "bodyText": "JinJava can be a singleton and shared by multiple threads.  The JinJava rendering context is scoped, but the root of the context -- the global context -- is shared. However, the context should not be shared, especially they can be modified during the rendering. To alleviate the issue,\n\nwe add a read only accessor, jinjava.getGlobalContextReadOnly(),\nproxy the registering functions, so that a caller does not have to access the globalContext directly.\nmake a copy of the global context as the root of scoped context for each rendering.\n\nDrawback is once the JinJava's renderForResult is started, updating the global content (registering new filter, etc) has no effect. It might actually be desired.", "createdAt": "2020-05-27T19:52:08Z", "url": "https://github.com/HubSpot/jinjava/pull/447", "merged": true, "mergeCommit": {"oid": "82f05db8541bccf3543c5fad1db1ba614a46786f"}, "closed": true, "closedAt": "2020-06-08T18:15:29Z", "author": {"login": "hs-lsong"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjQCz7gH2gAyNDI0MDgwOTcwOmI0YmMxNzJkNDEwYzE2MjdlYTQ4YzkyNGE1MTEwZjc4NjVkMGE0NTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpUbWSgH2gAyNDI0MDgwOTcwOjQzOGE3ODQwOTJjMDdiNDY2MWU5NmUyZmNmNWI0MGNkYzdlZmNiOTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b4bc172d410c1627ea48c924a5110f7865d0a458", "author": {"user": {"login": "hs-lsong", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/b4bc172d410c1627ea48c924a5110f7865d0a458", "committedDate": "2020-05-20T21:34:59Z", "message": "Make copy of global context."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "279afee6bf6ef28eb454fa65e2d355e5bb7e6a3c", "author": {"user": {"login": "hs-lsong", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/279afee6bf6ef28eb454fa65e2d355e5bb7e6a3c", "committedDate": "2020-05-27T19:37:42Z", "message": "Make jinjava global content read only."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NTkyODc1", "url": "https://github.com/HubSpot/jinjava/pull/447#pullrequestreview-419592875", "createdAt": "2020-05-27T20:43:26Z", "commit": {"oid": "279afee6bf6ef28eb454fa65e2d355e5bb7e6a3c"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjMzNDg3", "url": "https://github.com/HubSpot/jinjava/pull/447#pullrequestreview-419633487", "createdAt": "2020-05-27T21:48:37Z", "commit": {"oid": "279afee6bf6ef28eb454fa65e2d355e5bb7e6a3c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMTo0ODozN1rOGbeXfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMTo0ODozN1rOGbeXfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ2MjI2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public Context getGlobalContextReadOnly() {\n          \n          \n            \n              public Context getGlobalContextCopy() {", "url": "https://github.com/HubSpot/jinjava/pull/447#discussion_r431462268", "createdAt": "2020-05-27T21:48:37Z", "author": {"login": "boulter"}, "path": "src/main/java/com/hubspot/jinjava/Jinjava.java", "diffHunk": "@@ -123,6 +127,10 @@ public Context getGlobalContext() {\n     return globalContext;\n   }\n \n+  public Context getGlobalContextReadOnly() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "279afee6bf6ef28eb454fa65e2d355e5bb7e6a3c"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b37f943fca1c8e8369e8c5bdae54cf0a323e565", "author": {"user": {"login": "hs-lsong", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/1b37f943fca1c8e8369e8c5bdae54cf0a323e565", "committedDate": "2020-05-29T17:37:52Z", "message": "Inherit parent interpreter context."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65636dcd85b975d4c0c9cce18c154a657d71c27b", "author": {"user": {"login": "hs-lsong", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/65636dcd85b975d4c0c9cce18c154a657d71c27b", "committedDate": "2020-05-29T18:24:16Z", "message": "Inherit parent interpreter context."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f269295aad48e26c3db37734953a2e0747f71eef", "author": {"user": {"login": "hs-lsong", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/f269295aad48e26c3db37734953a2e0747f71eef", "committedDate": "2020-05-29T20:08:38Z", "message": "Fix NPE."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec7d339c67fe1c76d4f30d90b4d1a4fc1767c617", "author": {"user": {"login": "hs-lsong", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/ec7d339c67fe1c76d4f30d90b4d1a4fc1767c617", "committedDate": "2020-06-08T18:02:26Z", "message": "Merge branch 'master' of https://github.com/HubSpot/jinjava into global-context"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "438a784092c07b4661e96e2fcf5b40cdc7efcb90", "author": {"user": {"login": "hs-lsong", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/438a784092c07b4661e96e2fcf5b40cdc7efcb90", "committedDate": "2020-06-08T18:04:57Z", "message": "Rename getGlobalContextReadOnly to getGlobalContextCopy."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2529, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}