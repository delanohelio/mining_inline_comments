{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMjk0MTg5", "number": 490, "title": "Use kwargs in truncatehtml filter", "bodyText": "The truncatehtml filter has two optional arguments, end and breakwords. The end argument is a string which specifies the trailing characters after truncation, while breakwords determines if the last word of text is discarded.\nCurrently, these two optional arguments are recognized purely by their position in the array. This means that the following code:\n{% set html_text = \"<p>I want to truncate this text without breaking my HTML<p>\" %} \n{{ html_text|truncatehtml(28, false) }}\n\nRenders this:\n<p>I want to truncate thisfalse</p>\n\nMy expectation would be that the false passed to the filter should be recognized as breakwords -- since the two arguments are different types -- but instead it is used as end.\nThis PR changes this behavior so that if there is only one optional argument present, the filter will deduce which one it is based on the type. First we try and parse it as a boolean, and if it is not a recognized boolean value, we consider it to be end. If it is a recognized boolean value, we consider it to be breakwords.\nIf we don't like this new behavior, we should instead update the docs so that the current behavior is more clear.", "createdAt": "2020-08-25T15:41:39Z", "url": "https://github.com/HubSpot/jinjava/pull/490", "merged": true, "mergeCommit": {"oid": "7fba42039ea2f2b1344dbf0861628795b0d8cb51"}, "closed": true, "closedAt": "2020-08-27T17:37:30Z", "author": {"login": "liamrharwood"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCYykBAH2gAyNDczMjk0MTg5OmIyNDczNWFlNjBiYWFlOWIwZjM0YTk2OWM5NjBiYzRkZWI1ZTY5ZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCdHQBgH2gAyNDczMjk0MTg5Ojc5YmZhZjIwNWNkM2RlYmI5Y2Q3Y2YxZjgzY2Y2OTU1Nzk3NGE5Nzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b24735ae60baae9b0f34a969c960bc4deb5e69d4", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/b24735ae60baae9b0f34a969c960bc4deb5e69d4", "committedDate": "2020-08-25T15:18:02Z", "message": "Deduce arguments from type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ec3305175d4d6017562bca069f436a159e6039e", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/5ec3305175d4d6017562bca069f436a159e6039e", "committedDate": "2020-08-25T15:20:40Z", "message": "Fix prettier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db55a42863df1b0313980643ee150d4164e8c792", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/db55a42863df1b0313980643ee150d4164e8c792", "committedDate": "2020-08-25T15:23:08Z", "message": "Fix index"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d9f56727337cdf73d716f037e9817d43fd6405c", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/4d9f56727337cdf73d716f037e9817d43fd6405c", "committedDate": "2020-08-25T15:24:40Z", "message": "fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aec0b1ba7a0a794ed678c1e74fd9b0ef361e2bf3", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/aec0b1ba7a0a794ed678c1e74fd9b0ef361e2bf3", "committedDate": "2020-08-25T19:49:07Z", "message": "Use kwargs instead"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "deb25ce8ca356eb4059ddd0f594bc00b2ff6106f", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/deb25ce8ca356eb4059ddd0f594bc00b2ff6106f", "committedDate": "2020-08-25T19:50:29Z", "message": "Fix prettier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec1e0e0385055a3a4d1027216e626fd6da5d356b", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/ec1e0e0385055a3a4d1027216e626fd6da5d356b", "committedDate": "2020-08-25T19:56:13Z", "message": "fix nulls"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0ODA5NDk4", "url": "https://github.com/HubSpot/jinjava/pull/490#pullrequestreview-474809498", "createdAt": "2020-08-25T20:00:42Z", "commit": {"oid": "ec1e0e0385055a3a4d1027216e626fd6da5d356b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDowMDo0MlrOHGnrsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDowMDo0MlrOHGnrsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcwMzY2NA==", "bodyText": "Changed this to use kwargs - there's probably a more generic way of doing this, but I figure that can be tackled when trying to bring this functionality to our other filters.", "url": "https://github.com/HubSpot/jinjava/pull/490#discussion_r476703664", "createdAt": "2020-08-25T20:00:42Z", "author": {"login": "liamrharwood"}, "path": "src/main/java/com/hubspot/jinjava/lib/filter/TruncateHtmlFilter.java", "diffHunk": "@@ -55,6 +56,47 @@ public String getName() {\n     return \"truncatehtml\";\n   }\n \n+  @Override\n+  public Object filter(\n+    Object var,\n+    JinjavaInterpreter interpreter,\n+    Object[] args,\n+    Map<String, Object> kwargs\n+  ) {\n+    String length = null;\n+    if (kwargs.containsKey((\"length\"))) {\n+      length = Objects.toString(kwargs.get(\"length\"));\n+    }\n+    String end = null;\n+    if (kwargs.containsKey(\"end\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec1e0e0385055a3a4d1027216e626fd6da5d356b"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0ODEwODA5", "url": "https://github.com/HubSpot/jinjava/pull/490#pullrequestreview-474810809", "createdAt": "2020-08-25T20:02:38Z", "commit": {"oid": "ec1e0e0385055a3a4d1027216e626fd6da5d356b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDowMjozOFrOHGnvkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDowMjozOFrOHGnvkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcwNDY1OA==", "bodyText": "nit: Can these strings be static?", "url": "https://github.com/HubSpot/jinjava/pull/490#discussion_r476704658", "createdAt": "2020-08-25T20:02:38Z", "author": {"login": "mattcoley"}, "path": "src/main/java/com/hubspot/jinjava/lib/filter/TruncateHtmlFilter.java", "diffHunk": "@@ -55,6 +56,47 @@ public String getName() {\n     return \"truncatehtml\";\n   }\n \n+  @Override\n+  public Object filter(\n+    Object var,\n+    JinjavaInterpreter interpreter,\n+    Object[] args,\n+    Map<String, Object> kwargs\n+  ) {\n+    String length = null;\n+    if (kwargs.containsKey((\"length\"))) {\n+      length = Objects.toString(kwargs.get(\"length\"));\n+    }\n+    String end = null;\n+    if (kwargs.containsKey(\"end\")) {\n+      end = Objects.toString(kwargs.get(\"end\"));\n+    }\n+    String breakword = null;\n+    if (kwargs.containsKey(\"breakword\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec1e0e0385055a3a4d1027216e626fd6da5d356b"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07b72f2e648417aaf5de248c699ccae1a6b8bc0a", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/07b72f2e648417aaf5de248c699ccae1a6b8bc0a", "committedDate": "2020-08-25T20:18:42Z", "message": "Make strings static constants"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79bfaf205cd3debb9cd7cf1f83cf69557974a977", "author": {"user": {"login": "lh-hubs-test", "name": null}}, "url": "https://github.com/HubSpot/jinjava/commit/79bfaf205cd3debb9cd7cf1f83cf69557974a977", "committedDate": "2020-08-25T20:20:15Z", "message": "Fix pom and syntax error"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1539, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}