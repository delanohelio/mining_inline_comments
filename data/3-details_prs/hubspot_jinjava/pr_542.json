{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1OTI0Mjk5", "number": 542, "title": "Add skeleton for test cases and EagerTagDecorator", "bodyText": "Part of #532\nMoved from jasmith-hs#1\nThis PR mainly serves to introduce the various tests that I'm using to test eager execution with the different tags.\nThe EagerTest uses an ExpectedTemplateInterpreter which takes the name of a jinja file (file-name.jinja) and compares its interpreted output to that of file-name.expected.jinja. Some second pass tests are added too which use a suffix of .expected.expected.jinja\nAdditionally, this adds an EagerTagFactory which is used to register the tags which are getting decorated with the EagerTagDecorator for general functionality, as well as specific functionality for each tag. The way it's currently set up, the eager overrides for tags are registered by getting an instance of one from the EagerTagFactory and registering the tag on the context. Since they have the same name as the original tag that they're decorating, they replace the original tags in the TagLibrary.\nThe tests here are marked with @Ignore because the functionality to make them pass isn't added yet.\nMost of these changes are the tests for which the logic is not included yet. cc @boulter @Joeoh @mattcoley", "createdAt": "2020-11-23T18:41:04Z", "url": "https://github.com/HubSpot/jinjava/pull/542", "merged": true, "mergeCommit": {"oid": "9528b19ae9e0e7d9f89376aa7d55fe6a20f8a30b"}, "closed": true, "closedAt": "2020-11-24T20:00:39Z", "author": {"login": "jasmith-hs"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdb1vlYAH2gAyNTI1OTI0Mjk5OmI4YmM1ZmY4YTBlNzYxNjM4YzU1NjdhZDNjMzRlYzAyZjg4MjFiMzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfuOL-gFqTUzNzgwMzA0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b8bc5ff8a0e761638c5567ad3c34ec02f8821b39", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/b8bc5ff8a0e761638c5567ad3c34ec02f8821b39", "committedDate": "2020-11-12T17:10:08Z", "message": "Pull in generic eager tag decorator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8f6c4a7b57d35c1052a557e1e8f732036a1c50e", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/e8f6c4a7b57d35c1052a557e1e8f732036a1c50e", "committedDate": "2020-11-12T17:16:58Z", "message": "Add eager test and template interpreter util"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9073889fc1617d57b962627c5cd504ca14364e9f", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/9073889fc1617d57b962627c5cd504ca14364e9f", "committedDate": "2020-11-12T17:17:34Z", "message": "Merge branch 'eager-execution-flags' of github.com:jasmith-hs/jinjava into eager-tag-decorator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9469b3c8e5d85042e65bd2fab715187006875d0", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/d9469b3c8e5d85042e65bd2fab715187006875d0", "committedDate": "2020-11-12T17:23:12Z", "message": "Skeletonize EagerTagDecorator and include test resources"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55dd8462b761d77429c6658f024e0374783c9aad", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/55dd8462b761d77429c6658f024e0374783c9aad", "committedDate": "2020-11-12T18:39:23Z", "message": "Add idempotency testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eeb6c42e50147f863621a0a874f6579e2b5cd907", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/eeb6c42e50147f863621a0a874f6579e2b5cd907", "committedDate": "2020-11-13T18:44:18Z", "message": "Merge branch 'eager-execution-flags' of github.com:jasmith-hs/jinjava into eager-tag-decorator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1fea9ad3db30f9015defca70bd8188fbd156511", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/a1fea9ad3db30f9015defca70bd8188fbd156511", "committedDate": "2020-11-13T18:46:16Z", "message": "Use execution mode in test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d009f5c000d1e9da8c4b74905e0fc456951a98a", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/7d009f5c000d1e9da8c4b74905e0fc456951a98a", "committedDate": "2020-11-13T18:46:41Z", "message": "Merge branch 'eager-tag-decorator' of github.com:jasmith-hs/jinjava into eager-tag-decorator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ce96bc5e47df9f52b91d3baf91c55b452f10e53", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/5ce96bc5e47df9f52b91d3baf91c55b452f10e53", "committedDate": "2020-11-13T19:10:05Z", "message": "Update for ExecutionMode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1e25fd251dbb9030395a54ecf0de8b8b21a85e5", "author": {"user": {"login": "jasmith-hs", "name": "Jack Smith"}}, "url": "https://github.com/HubSpot/jinjava/commit/c1e25fd251dbb9030395a54ecf0de8b8b21a85e5", "committedDate": "2020-11-24T18:34:33Z", "message": "Use already constructed instance"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3ODAzMDQ5", "url": "https://github.com/HubSpot/jinjava/pull/542#pullrequestreview-537803049", "createdAt": "2020-11-24T18:40:00Z", "commit": {"oid": "c1e25fd251dbb9030395a54ecf0de8b8b21a85e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxODo0MDowMFrOH5QSug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxODo0MDowMFrOH5QSug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTc5NzgxOA==", "bodyText": "This will get called to register each tag in the EagerExecutionMode.prepareContext() (seen here)\n@boulter This is the basic principle for how I am separating the eager execution code from the default execution code. The tags get wrapped with an EagerTagDecorator in this factory so that they can be registered to override the default tags", "url": "https://github.com/HubSpot/jinjava/pull/542#discussion_r529797818", "createdAt": "2020-11-24T18:40:00Z", "author": {"login": "jasmith-hs"}, "path": "src/main/java/com/hubspot/jinjava/lib/tag/eager/EagerTagFactory.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package com.hubspot.jinjava.lib.tag.eager;\n+\n+import com.google.common.base.Throwables;\n+import com.google.common.collect.ImmutableMap;\n+import com.hubspot.jinjava.lib.tag.Tag;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+public class EagerTagFactory {\n+  public static final Map<Class<? extends Tag>, Class<? extends EagerTagDecorator<? extends Tag>>> EAGER_TAG_OVERRIDES = ImmutableMap\n+    .<Class<? extends Tag>, Class<? extends EagerTagDecorator<?>>>builder()\n+    .build();\n+\n+  @SuppressWarnings(\"unchecked\")\n+  public static <T extends Tag> Optional<EagerTagDecorator<T>> getEagerTagDecorator(\n+    Class<T> clazz\n+  ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1e25fd251dbb9030395a54ecf0de8b8b21a85e5"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2478, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}