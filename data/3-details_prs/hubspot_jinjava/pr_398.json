{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczOTM2NTc1", "number": 398, "title": "Fix implementation for slice filter", "bodyText": "Slice filter was not implemented as according to spec. When doing list|slice(3) we should not be padding non-divisible slices with null values. When using list|slice(3, 'value') we should pad non-divisible slices with value. https://jinja.palletsprojects.com/en/2.11.x/templates/#slice", "createdAt": "2020-02-11T22:49:08Z", "url": "https://github.com/HubSpot/jinjava/pull/398", "merged": true, "mergeCommit": {"oid": "6ec3b095dcc8a6b4867b66a1bc4bcfb402889f57"}, "closed": true, "closedAt": "2020-02-12T21:24:34Z", "author": {"login": "mattcoley"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDZpgWgH2gAyMzczOTM2NTc1Ojg2OGI4NjhiZjZjMjgwNWRiYzNkZWQ4YWQ0OTVkZTdlNzIzZTc3NGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDsTy7AH2gAyMzczOTM2NTc1OjBjMzY4YjYxN2VjMjQxOWNmNjcyYTk5NDYxYzhmYjRmMDVkOThmMDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "868b868bf6c2805dbc3ded8ad495de7e723e774a", "author": {"user": null}, "url": "https://github.com/HubSpot/jinjava/commit/868b868bf6c2805dbc3ded8ad495de7e723e774a", "committedDate": "2020-02-11T22:40:49Z", "message": "Fix implementation for slice filter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e562ec513906c0a0104bc9b359a49b448aa0655b", "author": {"user": null}, "url": "https://github.com/HubSpot/jinjava/commit/e562ec513906c0a0104bc9b359a49b448aa0655b", "committedDate": "2020-02-11T22:49:02Z", "message": "update tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00ec051d282959f291f539666156c8d2108b2e02", "author": {"user": null}, "url": "https://github.com/HubSpot/jinjava/commit/00ec051d282959f291f539666156c8d2108b2e02", "committedDate": "2020-02-12T19:54:56Z", "message": "checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3NzUwNDI3", "url": "https://github.com/HubSpot/jinjava/pull/398#pullrequestreview-357750427", "createdAt": "2020-02-12T20:05:01Z", "commit": {"oid": "00ec051d282959f291f539666156c8d2108b2e02"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQyMDowNTowMVrOFo81VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQyMDowNTozMlrOFo82VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ4NDA1Mw==", "bodyText": "Any reason we default to 3 here?", "url": "https://github.com/HubSpot/jinjava/pull/398#discussion_r378484053", "createdAt": "2020-02-12T20:05:01Z", "author": {"login": "liamrharwood"}, "path": "src/main/java/com/hubspot/jinjava/lib/filter/SliceFilter.java", "diffHunk": "@@ -47,7 +51,30 @@ public Object filter(Object var, JinjavaInterpreter interpreter, String... args)\n     }\n \n     int slices = NumberUtils.toInt(args[0], 3);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00ec051d282959f291f539666156c8d2108b2e02"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ4NDMwOQ==", "bodyText": "nit: assign args[1] to something like fillWith for clarity", "url": "https://github.com/HubSpot/jinjava/pull/398#discussion_r378484309", "createdAt": "2020-02-12T20:05:32Z", "author": {"login": "liamrharwood"}, "path": "src/main/java/com/hubspot/jinjava/lib/filter/SliceFilter.java", "diffHunk": "@@ -47,7 +51,30 @@ public Object filter(Object var, JinjavaInterpreter interpreter, String... args)\n     }\n \n     int slices = NumberUtils.toInt(args[0], 3);\n-    return Iterators.paddedPartition(loop, slices);\n+    if (slices <= 0) {\n+      throw new InvalidArgumentException(interpreter, this, InvalidReason.POSITIVE_NUMBER, 0, args[0]);\n+    }\n+    List<List<Object>> result = new ArrayList<>();\n+\n+    List<Object> currentList = null;\n+    int i = 0;\n+    while (loop.hasNext()) {\n+      Object next = loop.next();\n+      if (i % slices == 0) {\n+        currentList = new ArrayList<>(slices);\n+        result.add(currentList);\n+      }\n+      currentList.add(next);\n+      i++;\n+    }\n+\n+    if (args.length > 1 && currentList != null) {\n+      while (currentList.size() < slices) {\n+        currentList.add(args[1]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00ec051d282959f291f539666156c8d2108b2e02"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d99c04980110c3849a3f4100a44c3d1c65e37655", "author": {"user": null}, "url": "https://github.com/HubSpot/jinjava/commit/d99c04980110c3849a3f4100a44c3d1c65e37655", "committedDate": "2020-02-12T20:23:42Z", "message": "better variable name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c368b617ec2419cf672a99461c8fb4f05d98f07", "author": {"user": null}, "url": "https://github.com/HubSpot/jinjava/commit/0c368b617ec2419cf672a99461c8fb4f05d98f07", "committedDate": "2020-02-12T20:25:18Z", "message": "Add documentation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1566, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}