{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5NjY2NDIx", "number": 1693, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo0OTo0MFrODgxbgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo1MjoxOVrODgxfiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NjkwODgyOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-migrate/src/main/java/ca/uhn/fhir/jpa/migrate/tasks/HapiFhirJpaMigrationTasks.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo0OTo0MFrOFrKMzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOToxMzowMlrOFrO91Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgwMDIwNQ==", "bodyText": "Can you merge master into this branch, and adjust this to put these tasks in a new init430 method with the current date on the tasks?", "url": "https://github.com/hapifhir/hapi-fhir/pull/1693#discussion_r380800205", "createdAt": "2020-02-18T16:49:40Z", "author": {"login": "jamesagnew"}, "path": "hapi-fhir-jpaserver-migrate/src/main/java/ca/uhn/fhir/jpa/migrate/tasks/HapiFhirJpaMigrationTasks.java", "diffHunk": "@@ -61,6 +61,11 @@ public HapiFhirJpaMigrationTasks(Set<String> theFlags) {\n \n \tprotected void init420() { // 20191015 - present\n \t\tBuilder version = forVersion(VersionEnum.V4_2_0);\n+\n+\t\t// Eliminate circular dependency.\n+\t\tversion.onTable(\"HFJ_RESOURCE\").dropColumn(\"20200130.1\", \"FORCED_ID_PID\");\n+\t\tversion.onTable(\"HFJ_RES_VER\").dropColumn(\"20200130.2\", \"FORCED_ID_PID\");\n+\t\tversion.onTable(\"HFJ_RES_VER\").addForeignKey(\"20200130.3\", \"FK_RESOURCE_HISTORY_RESOURCE\").toColumn(\"RES_ID\").references(\"HFJ_RESOURCE\", \"RES_ID\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d5b3d7639910e009a77cc8abdc6c2063e674d7c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg3ODI5Mw==", "bodyText": "Done.", "url": "https://github.com/hapifhir/hapi-fhir/pull/1693#discussion_r380878293", "createdAt": "2020-02-18T19:13:02Z", "author": {"login": "IanMMarshall"}, "path": "hapi-fhir-jpaserver-migrate/src/main/java/ca/uhn/fhir/jpa/migrate/tasks/HapiFhirJpaMigrationTasks.java", "diffHunk": "@@ -61,6 +61,11 @@ public HapiFhirJpaMigrationTasks(Set<String> theFlags) {\n \n \tprotected void init420() { // 20191015 - present\n \t\tBuilder version = forVersion(VersionEnum.V4_2_0);\n+\n+\t\t// Eliminate circular dependency.\n+\t\tversion.onTable(\"HFJ_RESOURCE\").dropColumn(\"20200130.1\", \"FORCED_ID_PID\");\n+\t\tversion.onTable(\"HFJ_RES_VER\").dropColumn(\"20200130.2\", \"FORCED_ID_PID\");\n+\t\tversion.onTable(\"HFJ_RES_VER\").addForeignKey(\"20200130.3\", \"FK_RESOURCE_HISTORY_RESOURCE\").toColumn(\"RES_ID\").references(\"HFJ_RESOURCE\", \"RES_ID\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgwMDIwNQ=="}, "originalCommit": {"oid": "5d5b3d7639910e009a77cc8abdc6c2063e674d7c"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NjkxOTEzOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/expunge/ExpungeEverythingService.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNjo1MjoxOVrOFrKTMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOToxMzoyMVrOFrO-Zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgwMTg0MA==", "bodyText": "Overall comment- This could use a changelog.", "url": "https://github.com/hapifhir/hapi-fhir/pull/1693#discussion_r380801840", "createdAt": "2020-02-18T16:52:19Z", "author": {"login": "jamesagnew"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/expunge/ExpungeEverythingService.java", "diffHunk": "@@ -78,8 +78,6 @@ void expungeEverything(RequestDetails theRequest) {\n \t\tourLog.info(\"BEGINNING GLOBAL $expunge\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5d5b3d7639910e009a77cc8abdc6c2063e674d7c"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg3NzYwMA==", "bodyText": "New changelog added.", "url": "https://github.com/hapifhir/hapi-fhir/pull/1693#discussion_r380877600", "createdAt": "2020-02-18T19:11:44Z", "author": {"login": "IanMMarshall"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/expunge/ExpungeEverythingService.java", "diffHunk": "@@ -78,8 +78,6 @@ void expungeEverything(RequestDetails theRequest) {\n \t\tourLog.info(\"BEGINNING GLOBAL $expunge\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgwMTg0MA=="}, "originalCommit": {"oid": "5d5b3d7639910e009a77cc8abdc6c2063e674d7c"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg3ODQzOA==", "bodyText": "New changelog added.", "url": "https://github.com/hapifhir/hapi-fhir/pull/1693#discussion_r380878438", "createdAt": "2020-02-18T19:13:21Z", "author": {"login": "IanMMarshall"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/expunge/ExpungeEverythingService.java", "diffHunk": "@@ -78,8 +78,6 @@ void expungeEverything(RequestDetails theRequest) {\n \t\tourLog.info(\"BEGINNING GLOBAL $expunge\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDgwMTg0MA=="}, "originalCommit": {"oid": "5d5b3d7639910e009a77cc8abdc6c2063e674d7c"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1991, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}