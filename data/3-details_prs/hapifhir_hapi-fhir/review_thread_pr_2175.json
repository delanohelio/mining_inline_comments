{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIxMzM1MTIz", "number": 2175, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNjo0ODo0MlrOE65hBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMTowMzo0NFrOE8ZR2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwMTk1MjA3OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-base/src/main/java/ca/uhn/fhir/util/StringUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNjo0ODo0MlrOH2O6wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxMzo1Njo0MlrOH2fxiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjYyOTU2OA==", "bodyText": "Hi, @frankjtao and @IanMMarshall.\nWhat is the issue we're trying to solve here? What was the original request?", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r526629568", "createdAt": "2020-11-19T06:48:42Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-base/src/main/java/ca/uhn/fhir/util/StringUtil.java", "diffHunk": "@@ -78,4 +79,24 @@ public static String toUtf8String(byte[] theBytes) {\n \t\treturn new String(bytes, StandardCharsets.UTF_8);\n \t}\n \n+\t/**\n+\t * Check the input string has prefix token \n+\t * \n+\t * @param theInput       the input string\n+\t * @param thePrefix      the prefix string of a token\n+\t * @return Return true if a input string token separated by space start with the prefix \n+\t */\n+\tpublic static boolean isStartsWithIgnoreCase(final String theInput, final String thePrefix) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "878c22192efc6683336465480f435b678c5326d4"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkwNTczOQ==", "bodyText": "Posted the requirements here:\n#2175 (comment)", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r526905739", "createdAt": "2020-11-19T13:56:42Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-base/src/main/java/ca/uhn/fhir/util/StringUtil.java", "diffHunk": "@@ -78,4 +79,24 @@ public static String toUtf8String(byte[] theBytes) {\n \t\treturn new String(bytes, StandardCharsets.UTF_8);\n \t}\n \n+\t/**\n+\t * Check the input string has prefix token \n+\t * \n+\t * @param theInput       the input string\n+\t * @param thePrefix      the prefix string of a token\n+\t * @return Return true if a input string token separated by space start with the prefix \n+\t */\n+\tpublic static boolean isStartsWithIgnoreCase(final String theInput, final String thePrefix) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjYyOTU2OA=="}, "originalCommit": {"oid": "878c22192efc6683336465480f435b678c5326d4"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwMTk2Mjg3OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/dstu3/FhirResourceDaoValueSetDstu3.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwNjo1MzoxNFrOH2PBDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMTozMjo0NFrOH4gNqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjYzMTE4MQ==", "bodyText": "@frankjtao and/or @IanMMarshall, can you explain/justify this change from EQUAL to EXISTS?\nReviewing the FilterOperator value set here, I'm not sure this makes sense. EQUAL seems like the most appropriate fit for a partial-to-complete match. EXISTS simply identifies whether or not the property (in this case the display) is present at all.\nI'm calling this out only here; however, I have the same concern for all of the related resource DAOs by FHIR version.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r526631181", "createdAt": "2020-11-19T06:53:14Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/dstu3/FhirResourceDaoValueSetDstu3.java", "diffHunk": "@@ -238,7 +240,7 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \tprivate void addFilterIfPresent(String theFilter, ConceptSetComponent include) {\n \t\tif (ElementUtil.isEmpty(include.getConcept())) {\n \t\t\tif (isNotBlank(theFilter)) {\n-\t\t\t\tinclude.addFilter().setProperty(\"display\").setOp(FilterOperator.EQUAL).setValue(theFilter);\n+\t\t\t\tinclude.addFilter().setProperty(\"display\").setOp(FilterOperator.EXISTS).setValue(theFilter);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "878c22192efc6683336465480f435b678c5326d4"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAxMDA4OQ==", "bodyText": "Resolved. We stuck with EQUAL.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r529010089", "createdAt": "2020-11-23T21:32:44Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/dstu3/FhirResourceDaoValueSetDstu3.java", "diffHunk": "@@ -238,7 +240,7 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \tprivate void addFilterIfPresent(String theFilter, ConceptSetComponent include) {\n \t\tif (ElementUtil.isEmpty(include.getConcept())) {\n \t\t\tif (isNotBlank(theFilter)) {\n-\t\t\t\tinclude.addFilter().setProperty(\"display\").setOp(FilterOperator.EQUAL).setValue(theFilter);\n+\t\t\t\tinclude.addFilter().setProperty(\"display\").setOp(FilterOperator.EXISTS).setValue(theFilter);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjYzMTE4MQ=="}, "originalCommit": {"oid": "878c22192efc6683336465480f435b678c5326d4"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwMzcxMTQ5OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoValueSetR4.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxMzo1ODozMlrOH2f2gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxMzo1ODozMlrOH2f2gQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkwNzAwOQ==", "bodyText": "This change warrants a changelog entry to indicate $expand with filter now evaluates the display with left-matching by string token, case-insensitive.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r526907009", "createdAt": "2020-11-19T13:58:32Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoValueSetR4.java", "diffHunk": "@@ -208,7 +210,11 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \n \t\tfor (int idx = 0; idx < theContains.size(); idx++) {\n \t\t\tValueSetExpansionContainsComponent next = theContains.get(idx);\n-\t\t\tif (isBlank(next.getDisplay()) || !org.apache.commons.lang3.StringUtils.containsIgnoreCase(next.getDisplay(), theFilter)) {\n+\t\t\t\n+\t\t\t// e.g. For a display text of \u201cBody height\u201d:\n+\t\t\t// searching on \"Bo\" or \"he\" should find it\n+\t\t\t// searching on \"ei\" or \"dy\" should not find it\n+\t\t\tif (isBlank(next.getDisplay()) || !StringUtil.isStartsWithIgnoreCase(next.getDisplay(), theFilter)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "878c22192efc6683336465480f435b678c5326d4"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwODU5MjU3OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-docs/src/main/resources/ca/uhn/hapi/fhir/changelog/5_3_0/2175_valueset_expension_filer_left_match.yaml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxMzowMjo1N1rOH3O0fA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMTozMzo0MVrOH4gPdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzY3NjU0MA==", "bodyText": "Readability.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            title: \"When expanding a ValueSet using a filter, now evaluates the display with left-matching \n          \n          \n            \n            title: \"Expanding a ValueSet using a filter now evaluates the display with left-matching", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r527676540", "createdAt": "2020-11-20T13:02:57Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-docs/src/main/resources/ca/uhn/hapi/fhir/changelog/5_3_0/2175_valueset_expension_filer_left_match.yaml", "diffHunk": "@@ -0,0 +1,5 @@\n+---\n+type: fix\n+pr: 2175\n+title: \"When expanding a ValueSet using a filter, now evaluates the display with left-matching ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e551f1837e6b21833672a8be43dac87e3c44f6e5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAxMDU0OQ==", "bodyText": "Resolving. This suggestion was applied.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r529010549", "createdAt": "2020-11-23T21:33:41Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-docs/src/main/resources/ca/uhn/hapi/fhir/changelog/5_3_0/2175_valueset_expension_filer_left_match.yaml", "diffHunk": "@@ -0,0 +1,5 @@\n+---\n+type: fix\n+pr: 2175\n+title: \"When expanding a ValueSet using a filter, now evaluates the display with left-matching ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzY3NjU0MA=="}, "originalCommit": {"oid": "e551f1837e6b21833672a8be43dac87e3c44f6e5"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxNzYzMTQyOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/dstu3/FhirResourceDaoValueSetDstu3.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMTowMDoyMlrOH4fJZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMjo0MjoxOVrOH4iPSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5MjYxMg==", "bodyText": "After examining the changes in BaseTermReadSvcImpl more closely, I agree that enabling the \"myDisplayNGram\" in the addDisplayFilterInexact() method of BaseTermReadSvcImpl class is the correct solution here. That being said, I am now wondering if there is still a need for the applyFilter method in the FhirResourceDaoValueSet classes. I think this would only really be needed now for the case where HibernateSearch is not implemented.\nCurrently the BaseTermReadSvcImpl class disallows expand with filter in cases where HibernateSearch is not enabled. As such, I would say maybe remove this for now from the FhirResourceDaoValueSetDstu3, FhirResourceDaoValueSetR4 and FhirResourceDaoValueSetR5 classes.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r528992612", "createdAt": "2020-11-23T21:00:22Z", "author": {"login": "IanMMarshall"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/dstu3/FhirResourceDaoValueSetDstu3.java", "diffHunk": "@@ -224,7 +226,7 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \n \t\tfor (int idx = 0; idx < theContains.size(); idx++) {\n \t\t\tValueSetExpansionContainsComponent next = theContains.get(idx);\n-\t\t\tif (isBlank(next.getDisplay()) || !org.apache.commons.lang3.StringUtils.containsIgnoreCase(next.getDisplay(), theFilter)) {\n+\t\t\tif (isBlank(next.getDisplay()) || !StringUtil.isStartsWithIgnoreCase(next.getDisplay(), theFilter)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a05513250c7b7f5233e4213dcd7fd359a9a87a2"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA0MzI3Mg==", "bodyText": "@IanMMarshall No. The applyFilter  method can't be removed in this case, since NGram Analyzer will return entry e.g.  for the display value of 'Systolic blood pressure' with the filter 'lood'. The applyFilter will return only left matching entries.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r529043272", "createdAt": "2020-11-23T22:42:19Z", "author": {"login": "frankjtao"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/dstu3/FhirResourceDaoValueSetDstu3.java", "diffHunk": "@@ -224,7 +226,7 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \n \t\tfor (int idx = 0; idx < theContains.size(); idx++) {\n \t\t\tValueSetExpansionContainsComponent next = theContains.get(idx);\n-\t\t\tif (isBlank(next.getDisplay()) || !org.apache.commons.lang3.StringUtils.containsIgnoreCase(next.getDisplay(), theFilter)) {\n+\t\t\tif (isBlank(next.getDisplay()) || !StringUtil.isStartsWithIgnoreCase(next.getDisplay(), theFilter)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5MjYxMg=="}, "originalCommit": {"oid": "5a05513250c7b7f5233e4213dcd7fd359a9a87a2"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxNzYzMzU3OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoValueSetR4.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMTowMTowNFrOH4fKmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMjo0MjozM1rOH4iPrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5MjkyMQ==", "bodyText": "See comments above in FhirResourceDaoValueSetDao3.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r528992921", "createdAt": "2020-11-23T21:01:04Z", "author": {"login": "IanMMarshall"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoValueSetR4.java", "diffHunk": "@@ -208,7 +210,8 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \n \t\tfor (int idx = 0; idx < theContains.size(); idx++) {\n \t\t\tValueSetExpansionContainsComponent next = theContains.get(idx);\n-\t\t\tif (isBlank(next.getDisplay()) || !org.apache.commons.lang3.StringUtils.containsIgnoreCase(next.getDisplay(), theFilter)) {\n+\t\t\t\n+\t\t\tif (isBlank(next.getDisplay()) || !StringUtil.isStartsWithIgnoreCase(next.getDisplay(), theFilter)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a05513250c7b7f5233e4213dcd7fd359a9a87a2"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA0MzM3Mg==", "bodyText": "Same as above", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r529043372", "createdAt": "2020-11-23T22:42:33Z", "author": {"login": "frankjtao"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoValueSetR4.java", "diffHunk": "@@ -208,7 +210,8 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \n \t\tfor (int idx = 0; idx < theContains.size(); idx++) {\n \t\t\tValueSetExpansionContainsComponent next = theContains.get(idx);\n-\t\t\tif (isBlank(next.getDisplay()) || !org.apache.commons.lang3.StringUtils.containsIgnoreCase(next.getDisplay(), theFilter)) {\n+\t\t\t\n+\t\t\tif (isBlank(next.getDisplay()) || !StringUtil.isStartsWithIgnoreCase(next.getDisplay(), theFilter)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5MjkyMQ=="}, "originalCommit": {"oid": "5a05513250c7b7f5233e4213dcd7fd359a9a87a2"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxNzYzNjM2OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r5/FhirResourceDaoValueSetR5.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMTowMTo1M1rOH4fMJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMjo0Mjo0M1rOH4iP3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5MzMxNw==", "bodyText": "See comments above in FhirResourceDaoValueSetDstu3 and FhirResourceDaoValueSetR4.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r528993317", "createdAt": "2020-11-23T21:01:53Z", "author": {"login": "IanMMarshall"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r5/FhirResourceDaoValueSetR5.java", "diffHunk": "@@ -208,7 +210,7 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \n \t\tfor (int idx = 0; idx < theContains.size(); idx++) {\n \t\t\tValueSetExpansionContainsComponent next = theContains.get(idx);\n-\t\t\tif (isBlank(next.getDisplay()) || !org.apache.commons.lang3.StringUtils.containsIgnoreCase(next.getDisplay(), theFilter)) {\n+\t\t\tif (isBlank(next.getDisplay()) || !StringUtil.isStartsWithIgnoreCase(next.getDisplay(), theFilter)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a05513250c7b7f5233e4213dcd7fd359a9a87a2"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA0MzQyMQ==", "bodyText": "Same as above", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r529043421", "createdAt": "2020-11-23T22:42:43Z", "author": {"login": "frankjtao"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/dao/r5/FhirResourceDaoValueSetR5.java", "diffHunk": "@@ -208,7 +210,7 @@ private void applyFilter(IntegerType theTotalElement, List<ValueSetExpansionCont\n \n \t\tfor (int idx = 0; idx < theContains.size(); idx++) {\n \t\t\tValueSetExpansionContainsComponent next = theContains.get(idx);\n-\t\t\tif (isBlank(next.getDisplay()) || !org.apache.commons.lang3.StringUtils.containsIgnoreCase(next.getDisplay(), theFilter)) {\n+\t\t\tif (isBlank(next.getDisplay()) || !StringUtil.isStartsWithIgnoreCase(next.getDisplay(), theFilter)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5MzMxNw=="}, "originalCommit": {"oid": "5a05513250c7b7f5233e4213dcd7fd359a9a87a2"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxNzY0MTg1OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/term/BaseTermReadSvcImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMTowMzo0NFrOH4fPcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQwMjozMzo1NVrOH4pWag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5NDE2Mg==", "bodyText": "I would suggest also adding a test for the expand with filter to the FhirResourceDaoR4SearchWithElasticSearchIT class as well to ensure that this change also works with the Elasticsearch mapping provider.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r528994162", "createdAt": "2020-11-23T21:03:44Z", "author": {"login": "IanMMarshall"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/term/BaseTermReadSvcImpl.java", "diffHunk": "@@ -1084,7 +1084,7 @@ private void addDisplayFilterInexact(QueryBuilder qb, BooleanJunction<?> bool, V\n \t\t\t.withSlop(2)\n \t\t\t.onField(\"myDisplay\").boostedTo(4.0f)\n \t\t\t.andField(\"myDisplayEdgeNGram\").boostedTo(2.0f)\n-\t\t\t// .andField(\"myDisplayNGram\").boostedTo(1.0f)\n+\t\t\t.andField(\"myDisplayNGram\").boostedTo(1.0f)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a05513250c7b7f5233e4213dcd7fd359a9a87a2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTE1OTc4Ng==", "bodyText": "Added 3 more test cases to FhirResourceDaoR4SearchWithElasticSearchIT", "url": "https://github.com/hapifhir/hapi-fhir/pull/2175#discussion_r529159786", "createdAt": "2020-11-24T02:33:55Z", "author": {"login": "frankjtao"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/term/BaseTermReadSvcImpl.java", "diffHunk": "@@ -1084,7 +1084,7 @@ private void addDisplayFilterInexact(QueryBuilder qb, BooleanJunction<?> bool, V\n \t\t\t.withSlop(2)\n \t\t\t.onField(\"myDisplay\").boostedTo(4.0f)\n \t\t\t.andField(\"myDisplayEdgeNGram\").boostedTo(2.0f)\n-\t\t\t// .andField(\"myDisplayNGram\").boostedTo(1.0f)\n+\t\t\t.andField(\"myDisplayNGram\").boostedTo(1.0f)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODk5NDE2Mg=="}, "originalCommit": {"oid": "5a05513250c7b7f5233e4213dcd7fd359a9a87a2"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1723, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}