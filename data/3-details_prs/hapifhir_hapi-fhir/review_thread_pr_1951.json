{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNjg3ODQx", "number": 1951, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMzo1MTo0OFrOEKG32g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo1MzowNFrOEKIt7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MDMzODE4OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-base/src/main/java/ca/uhn/fhir/util/TransactionBuilder.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMzo1MTo0OFrOGq9Yzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMzo1MTo0OFrOGq9Yzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzY5OTE1MQ==", "bodyText": "Version independent builder.  Nice!", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447699151", "createdAt": "2020-06-30T13:51:48Z", "author": {"login": "fil512"}, "path": "hapi-fhir-base/src/main/java/ca/uhn/fhir/util/TransactionBuilder.java", "diffHunk": "@@ -0,0 +1,110 @@\n+package ca.uhn.fhir.util;\n+\n+import ca.uhn.fhir.context.BaseRuntimeChildDefinition;\n+import ca.uhn.fhir.context.BaseRuntimeElementDefinition;\n+import ca.uhn.fhir.context.FhirContext;\n+import ca.uhn.fhir.context.RuntimeResourceDefinition;\n+import org.hl7.fhir.instance.model.api.IBase;\n+import org.hl7.fhir.instance.model.api.IBaseBundle;\n+import org.hl7.fhir.instance.model.api.IBaseResource;\n+import org.hl7.fhir.instance.model.api.IPrimitiveType;\n+import org.thymeleaf.util.Validate;\n+\n+/**\n+ * This class can be used to build a Bundle resource to be used as a FHIR transaction.\n+ *\n+ * This is not yet complete, and doesn't support all FHIR features. <b>USE WITH CAUTION</b> as the API\n+ * may change.\n+ *\n+ * @since 5.1.0\n+ */\n+public class TransactionBuilder {\n+\n+\tprivate final FhirContext myContext;\n+\tprivate final IBaseBundle myBundle;\n+\tprivate final RuntimeResourceDefinition myBundleDef;\n+\tprivate final BaseRuntimeChildDefinition myEntryChild;\n+\tprivate final BaseRuntimeElementDefinition<?> myEntryDef;\n+\tprivate final BaseRuntimeChildDefinition myEntryResourceChild;\n+\tprivate final BaseRuntimeChildDefinition myEntryFullUrlChild;\n+\tprivate final BaseRuntimeChildDefinition myEntryRequestChild;\n+\tprivate final BaseRuntimeElementDefinition<?> myEntryRequestDef;\n+\tprivate final BaseRuntimeChildDefinition myEntryRequestUrlChild;\n+\tprivate final BaseRuntimeChildDefinition myEntryRequestMethodChild;\n+\tprivate final BaseRuntimeElementDefinition<?> myEntryRequestMethodDef;\n+\n+\t/**\n+\t * Constructor\n+\t */\n+\tpublic TransactionBuilder(FhirContext theContext) {\n+\t\tmyContext = theContext;\n+\n+\t\tmyBundleDef = myContext.getResourceDefinition(\"Bundle\");\n+\t\tmyBundle = (IBaseBundle) myBundleDef.newInstance();\n+\n+\t\tBaseRuntimeChildDefinition typeChild = myBundleDef.getChildByName(\"type\");\n+\t\tIPrimitiveType<?> type = (IPrimitiveType<?>) typeChild.getChildByName(\"type\").newInstance(typeChild.getInstanceConstructorArguments());\n+\t\ttype.setValueAsString(\"transaction\");\n+\t\ttypeChild.getMutator().setValue(myBundle, type);\n+\n+\t\tmyEntryChild = myBundleDef.getChildByName(\"entry\");\n+\t\tmyEntryDef = myEntryChild.getChildByName(\"entry\");\n+\n+\t\tmyEntryResourceChild = myEntryDef.getChildByName(\"resource\");\n+\t\tmyEntryFullUrlChild = myEntryDef.getChildByName(\"fullUrl\");\n+\n+\t\tmyEntryRequestChild = myEntryDef.getChildByName(\"request\");\n+\t\tmyEntryRequestDef = myEntryRequestChild.getChildByName(\"request\");\n+\n+\t\tmyEntryRequestUrlChild = myEntryRequestDef.getChildByName(\"url\");\n+\t\t\n+\t\tmyEntryRequestMethodChild = myEntryRequestDef.getChildByName(\"method\");\n+\t\tmyEntryRequestMethodDef = myEntryRequestMethodChild.getChildByName(\"method\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MDM1OTcxOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/subscription/resthook/RestHookTestR4Test.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMzo1NjoxNVrOGq9mSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxODoyNjowN1rOGrJNVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcwMjYwMw==", "bodyText": "Can we move all the hapi resource extensions into their own constants class?  This class could live in a non jpa module so it's available to non-jpa implementations.", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447702603", "createdAt": "2020-06-30T13:56:15Z", "author": {"login": "fil512"}, "path": "hapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/subscription/resthook/RestHookTestR4Test.java", "diffHunk": "@@ -1013,4 +1013,39 @@ public void testCustomSearchParam() throws Exception {\n \t}\n \n \n+\t@Test\n+\tpublic void testDeliverSearchResult() throws Exception {\n+\t\t{\n+\t\t\tSubscription subscription = newSubscription(\"Observation?\", \"application/json\");\n+\t\t\tsubscription.addExtension(JpaConstants.EXT_SUBSCRIPTION_PAYLOAD_SEARCH_RESULT, new StringType(\"Observation?_id=${matched_resource_id}&_include=*\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg5MjgyMw==", "bodyText": "Done. Have created HapiExtensions", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447892823", "createdAt": "2020-06-30T18:26:07Z", "author": {"login": "jamesagnew"}, "path": "hapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/subscription/resthook/RestHookTestR4Test.java", "diffHunk": "@@ -1013,4 +1013,39 @@ public void testCustomSearchParam() throws Exception {\n \t}\n \n \n+\t@Test\n+\tpublic void testDeliverSearchResult() throws Exception {\n+\t\t{\n+\t\t\tSubscription subscription = newSubscription(\"Observation?\", \"application/json\");\n+\t\t\tsubscription.addExtension(JpaConstants.EXT_SUBSCRIPTION_PAYLOAD_SEARCH_RESULT, new StringType(\"Observation?_id=${matched_resource_id}&_include=*\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcwMjYwMw=="}, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MDM3MTE5OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-searchparam/src/main/java/ca/uhn/fhir/jpa/searchparam/MatchUrlService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxMzo1ODozOFrOGq9tcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxODoyNjozMlrOGrJOOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcwNDQzMg==", "bodyText": "nitipck: theFlags.length > 0 is redundant", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447704432", "createdAt": "2020-06-30T13:58:38Z", "author": {"login": "fil512"}, "path": "hapi-fhir-jpaserver-searchparam/src/main/java/ca/uhn/fhir/jpa/searchparam/MatchUrlService.java", "diffHunk": "@@ -79,6 +80,13 @@ public SearchParameterMap translateMatchUrl(String theMatchUrl, RuntimeResourceD\n \n \t\tfor (String nextParamName : nameToParamLists.keySet()) {\n \t\t\tList<QualifiedParamList> paramList = nameToParamLists.get(nextParamName);\n+\n+\t\t\tif (theFlags != null && theFlags.length > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg5MzA0OA==", "bodyText": "removed", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447893048", "createdAt": "2020-06-30T18:26:32Z", "author": {"login": "jamesagnew"}, "path": "hapi-fhir-jpaserver-searchparam/src/main/java/ca/uhn/fhir/jpa/searchparam/MatchUrlService.java", "diffHunk": "@@ -79,6 +80,13 @@ public SearchParameterMap translateMatchUrl(String theMatchUrl, RuntimeResourceD\n \n \t\tfor (String nextParamName : nameToParamLists.keySet()) {\n \t\t\tList<QualifiedParamList> paramList = nameToParamLists.get(nextParamName);\n+\n+\t\t\tif (theFlags != null && theFlags.length > 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcwNDQzMg=="}, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MDYwNzAwOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-subscription/src/main/java/ca/uhn/fhir/jpa/subscription/match/deliver/resthook/SubscriptionDeliveringRestHookSubscriber.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo0NjoyOVrOGq__QQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo0NjoyOVrOGq__QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc0MTc2MQ==", "bodyText": "Nitpick: this adds more than one responsibility to this class.  single-responsibility classes are easier to test.", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447741761", "createdAt": "2020-06-30T14:46:29Z", "author": {"login": "fil512"}, "path": "hapi-fhir-jpaserver-subscription/src/main/java/ca/uhn/fhir/jpa/subscription/match/deliver/resthook/SubscriptionDeliveringRestHookSubscriber.java", "diffHunk": "@@ -81,55 +90,82 @@ protected void deliverPayload(ResourceDeliveryMessage theMsg, CanonicalSubscript\n \n \tprotected void doDelivery(ResourceDeliveryMessage theMsg, CanonicalSubscription theSubscription, EncodingEnum thePayloadType, IGenericClient theClient, IBaseResource thePayloadResource) {\n \t\tIClientExecutable<?, ?> operation;\n+\n+\t\tif (isNotBlank(theSubscription.getPayloadSearchResult())) {\n+\t\t\toperation = createDeliveryRequestTransaction(theSubscription, theClient, thePayloadResource);\n+\t\t} else if (thePayloadType != null) {\n+\t\t\toperation = createDeliveryRequestNormal(theMsg, theClient, thePayloadResource);\n+\t\t} else {\n+\t\t\tsendNotification(theMsg);\n+\t\t\toperation = null;\n+\t\t}\n+\n+\t\tif (operation != null) {\n+\n+\t\t\tif (thePayloadType != null) {\n+\t\t\t\toperation.encoded(thePayloadType);\n+\t\t\t}\n+\n+\t\t\tString payloadId = thePayloadResource.getIdElement().toUnqualified().getValue();\n+\t\t\tourLog.info(\"Delivering {} rest-hook payload {} for {}\", theMsg.getOperationType(), payloadId, theSubscription.getIdElement(myFhirContext).toUnqualifiedVersionless().getValue());\n+\n+\t\t\ttry {\n+\t\t\t\toperation.execute();\n+\t\t\t} catch (ResourceNotFoundException e) {\n+\t\t\t\tourLog.error(\"Cannot reach {} \", theMsg.getSubscription().getEndpointUrl());\n+\t\t\t\tourLog.error(\"Exception: \", e);\n+\t\t\t\tthrow e;\n+\t\t\t}\n+\n+\t\t}\n+\t}\n+\n+\t@Nullable\n+\tprivate IClientExecutable<?, ?> createDeliveryRequestNormal(ResourceDeliveryMessage theMsg, IGenericClient theClient, IBaseResource thePayloadResource) {\n+\t\tIClientExecutable<?, ?> operation;\n \t\tswitch (theMsg.getOperationType()) {\n \t\t\tcase CREATE:\n \t\t\tcase UPDATE:\n-\t\t\t\tif (thePayloadResource == null || thePayloadResource.isEmpty()) {\n-\t\t\t\t\tif (thePayloadType != null) {\n-\t\t\t\t\t\toperation = theClient.create().resource(thePayloadResource);\n-\t\t\t\t\t} else {\n-\t\t\t\t\t\tsendNotification(theMsg);\n-\t\t\t\t\t\treturn;\n-\t\t\t\t\t}\n-\t\t\t\t} else {\n-\t\t\t\t\tif (thePayloadType != null) {\n-\t\t\t\t\t\toperation = theClient.update().resource(thePayloadResource);\n-\t\t\t\t\t} else {\n-\t\t\t\t\t\tsendNotification(theMsg);\n-\t\t\t\t\t\treturn;\n-\t\t\t\t\t}\n-\t\t\t\t}\n+\t\t\t\toperation = theClient.update().resource(thePayloadResource);\n \t\t\t\tbreak;\n \t\t\tcase DELETE:\n \t\t\t\toperation = theClient.delete().resourceById(theMsg.getPayloadId(myFhirContext));\n \t\t\t\tbreak;\n \t\t\tdefault:\n \t\t\t\tourLog.warn(\"Ignoring delivery message of type: {}\", theMsg.getOperationType());\n-\t\t\t\treturn;\n+\t\t\t\toperation = null;\n+\t\t\t\tbreak;\n \t\t}\n+\t\treturn operation;\n+\t}\n \n-\t\tif (thePayloadType != null) {\n-\t\t\toperation.encoded(thePayloadType);\n-\t\t}\n+\tprivate IClientExecutable<?, ?> createDeliveryRequestTransaction(CanonicalSubscription theSubscription, IGenericClient theClient, IBaseResource thePayloadResource) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 115}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MDYyNTEyOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-subscription/src/main/java/ca/uhn/fhir/jpa/subscription/model/CanonicalSubscription.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo1MDoxMFrOGrAKnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxODoyODoyN1rOGrJS2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc0NDY3MQ==", "bodyText": "Is this a payloadSearchCriteria as opposed to a payloadSearchResult?", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447744671", "createdAt": "2020-06-30T14:50:10Z", "author": {"login": "fil512"}, "path": "hapi-fhir-jpaserver-subscription/src/main/java/ca/uhn/fhir/jpa/subscription/model/CanonicalSubscription.java", "diffHunk": "@@ -64,6 +68,8 @@\n \tprivate RestHookDetails myRestHookDetails;\n \t@JsonProperty(\"extensions\")\n \tprivate Map<String, List<String>> myChannelExtensions;\n+\t@JsonProperty(\"payloadSearchResult\")\n+\tprivate String myPayloadSearchResult;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg5NDIzMg==", "bodyText": "Agree that's a better name, renaming", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447894232", "createdAt": "2020-06-30T18:28:27Z", "author": {"login": "jamesagnew"}, "path": "hapi-fhir-jpaserver-subscription/src/main/java/ca/uhn/fhir/jpa/subscription/model/CanonicalSubscription.java", "diffHunk": "@@ -64,6 +68,8 @@\n \tprivate RestHookDetails myRestHookDetails;\n \t@JsonProperty(\"extensions\")\n \tprivate Map<String, List<String>> myChannelExtensions;\n+\t@JsonProperty(\"payloadSearchResult\")\n+\tprivate String myPayloadSearchResult;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc0NDY3MQ=="}, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MDYyODgwOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-subscription/src/main/java/ca/uhn/fhir/jpa/subscription/submit/interceptor/SubscriptionValidatingInterceptor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo1MDo1MVrOGrAMuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo1MDo1MVrOGrAMuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc0NTIwOQ==", "bodyText": "nice!", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447745209", "createdAt": "2020-06-30T14:50:51Z", "author": {"login": "fil512"}, "path": "hapi-fhir-jpaserver-subscription/src/main/java/ca/uhn/fhir/jpa/subscription/submit/interceptor/SubscriptionValidatingInterceptor.java", "diffHunk": "@@ -96,39 +97,48 @@ public void validateSubmittedSubscription(IBaseResource theSubscription) {\n \n \t\tif (!finished) {\n \n-\t\t\tString query = subscription.getCriteriaString();\n-\t\t\tif (isBlank(query)) {\n-\t\t\t\tthrow new UnprocessableEntityException(\"Subscription.criteria must be populated\");\n-\t\t\t}\n-\n-\t\t\tint sep = query.indexOf('?');\n-\t\t\tif (sep <= 1) {\n-\t\t\t\tthrow new UnprocessableEntityException(\"Subscription.criteria must be in the form \\\"{Resource Type}?[params]\\\"\");\n-\t\t\t}\n+\t\t\tvalidateQuery(subscription.getCriteriaString(), \"Subscription.criteria\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MDY0MDQ2OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-structures-r4/src/test/java/ca/uhn/fhir/util/TransactionBuilderTest.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo1MzowNFrOGrAT4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMDozNjo1N1rOGrNhtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc0NzA0Mg==", "bodyText": "Unrelated question, what do you think about having a statically cached TestFhirContext.R4 ?  I wonder if it would speed up our tests...", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447747042", "createdAt": "2020-06-30T14:53:04Z", "author": {"login": "fil512"}, "path": "hapi-fhir-structures-r4/src/test/java/ca/uhn/fhir/util/TransactionBuilderTest.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package ca.uhn.fhir.util;\n+\n+import ca.uhn.fhir.context.FhirContext;\n+import org.hl7.fhir.r4.model.Bundle;\n+import org.hl7.fhir.r4.model.Patient;\n+import org.hl7.fhir.r4.model.codesystems.HttpVerb;\n+import org.junit.Test;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertSame;\n+\n+public class TransactionBuilderTest {\n+\tprivate static final Logger ourLog = LoggerFactory.getLogger(TransactionBuilderTest.class);\n+\tprivate FhirContext myFhirContext = FhirContext.forR4();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg5NDQ4Nw==", "bodyText": "I actually just did this on my JU5 branch to save memory... So, yes, agree! :)", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447894487", "createdAt": "2020-06-30T18:28:57Z", "author": {"login": "jamesagnew"}, "path": "hapi-fhir-structures-r4/src/test/java/ca/uhn/fhir/util/TransactionBuilderTest.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package ca.uhn.fhir.util;\n+\n+import ca.uhn.fhir.context.FhirContext;\n+import org.hl7.fhir.r4.model.Bundle;\n+import org.hl7.fhir.r4.model.Patient;\n+import org.hl7.fhir.r4.model.codesystems.HttpVerb;\n+import org.junit.Test;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertSame;\n+\n+public class TransactionBuilderTest {\n+\tprivate static final Logger ourLog = LoggerFactory.getLogger(TransactionBuilderTest.class);\n+\tprivate FhirContext myFhirContext = FhirContext.forR4();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc0NzA0Mg=="}, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzk2MzU3NQ==", "bodyText": "Heh funny timing", "url": "https://github.com/hapifhir/hapi-fhir/pull/1951#discussion_r447963575", "createdAt": "2020-06-30T20:36:57Z", "author": {"login": "fil512"}, "path": "hapi-fhir-structures-r4/src/test/java/ca/uhn/fhir/util/TransactionBuilderTest.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package ca.uhn.fhir.util;\n+\n+import ca.uhn.fhir.context.FhirContext;\n+import org.hl7.fhir.r4.model.Bundle;\n+import org.hl7.fhir.r4.model.Patient;\n+import org.hl7.fhir.r4.model.codesystems.HttpVerb;\n+import org.junit.Test;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertSame;\n+\n+public class TransactionBuilderTest {\n+\tprivate static final Logger ourLog = LoggerFactory.getLogger(TransactionBuilderTest.class);\n+\tprivate FhirContext myFhirContext = FhirContext.forR4();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc0NzA0Mg=="}, "originalCommit": {"oid": "11c4f9defba581132a340a2e5f189a934e829b67"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1886, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}