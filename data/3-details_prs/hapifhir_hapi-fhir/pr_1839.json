{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NzcwNDQ0", "number": 1839, "title": "resolves #1838", "bodyText": "Added %today that works like %now but with date precision instead of dateTime precision.\nResolves #1838", "createdAt": "2020-05-10T19:40:18Z", "url": "https://github.com/hapifhir/hapi-fhir/pull/1839", "merged": true, "mergeCommit": {"oid": "60e420aaa387b64039d6dba05527782355ac1d25"}, "closed": true, "closedAt": "2020-06-04T13:52:42Z", "author": {"login": "fil512"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgAZPtAH2gAyNDE1NzcwNDQ0OmQyODBkMDQ0ZmE5YjU4N2MwNmJjOGRkNDNiMWQ4MjY4M2IyZjJlNWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcn-Xy5AH2gAyNDE1NzcwNDQ0OmM3ZDc2Y2QwZThmOTFkNjAwYWM3Y2IxMGY2M2NjZWNjZmM3YzgwOWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d280d044fa9b587c06bc8dd43b1d82683b2f2e5c", "author": {"user": {"login": "fil512", "name": "Ken Stevens"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/d280d044fa9b587c06bc8dd43b1d82683b2f2e5c", "committedDate": "2020-05-10T19:39:14Z", "message": "Added %today that works like %now but with date precision instead of dateTime precision."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7aa646ed078965ee7fac7c0a5e737c661bd81914", "author": {"user": {"login": "fil512", "name": "Ken Stevens"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/7aa646ed078965ee7fac7c0a5e737c661bd81914", "committedDate": "2020-05-10T19:40:59Z", "message": "typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25298cb6cbfba9eb8155cd82882ba176b5340a45", "author": {"user": {"login": "fil512", "name": "Ken Stevens"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/25298cb6cbfba9eb8155cd82882ba176b5340a45", "committedDate": "2020-05-10T19:53:11Z", "message": "added a couple more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "711afd48bee5c0b0be8f50e13323d801c4ce94c5", "author": {"user": {"login": "fil512", "name": "Ken Stevens"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/711afd48bee5c0b0be8f50e13323d801c4ce94c5", "committedDate": "2020-05-10T20:07:36Z", "message": "prevent minute test from running between 23:59 and midnight"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4Nzc3NDM0", "url": "https://github.com/hapifhir/hapi-fhir/pull/1839#pullrequestreview-408777434", "createdAt": "2020-05-10T20:08:30Z", "commit": {"oid": "25298cb6cbfba9eb8155cd82882ba176b5340a45"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQyMDowODozMFrOGTHKWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQyMDowODozMFrOGTHKWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjY5MzQ2Ng==", "bodyText": "Presumably we'll merge post 5.0.0 - Can you put this in a new directory called 5_1_0", "url": "https://github.com/hapifhir/hapi-fhir/pull/1839#discussion_r422693466", "createdAt": "2020-05-10T20:08:30Z", "author": {"login": "jamesagnew"}, "path": "hapi-fhir-docs/src/main/resources/ca/uhn/hapi/fhir/changelog/4_3_0/1838-add-today-date-option.yaml", "diffHunk": "@@ -0,0 +1,7 @@\n+---", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25298cb6cbfba9eb8155cd82882ba176b5340a45"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MjUzMjg3", "url": "https://github.com/hapifhir/hapi-fhir/pull/1839#pullrequestreview-409253287", "createdAt": "2020-05-11T14:57:21Z", "commit": {"oid": "711afd48bee5c0b0be8f50e13323d801c4ce94c5"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNDo1NzoyMVrOGTgEvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNDo1NzoyMVrOGTgEvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzEwMTYzMA==", "bodyText": "I have a small concern/question here, as %today could be wrong if we rely on new Date(). Consider this scenario:\nIt is 2020-05-11T07:51:00-0700 in Vancouver.\nIt is 2020-05-12T00:50:00+1000 in Melbourne.\nA request coming in from a client in Melbourne using %today would expect it to resolve to the ordinal 20200512, but with current implementation, it would resolve to 20200511 if the server is in Vancouver I think. However there is no easy way to know tz on these requests. Perhaps modify the documentation to indicate that %today is for server date? If i'm mistaken and this is already spelled out, thats fine.", "url": "https://github.com/hapifhir/hapi-fhir/pull/1839#discussion_r423101630", "createdAt": "2020-05-11T14:57:21Z", "author": {"login": "tadgh"}, "path": "hapi-fhir-base/src/main/java/ca/uhn/fhir/model/primitive/BaseDateTimeDt.java", "diffHunk": "@@ -638,6 +639,9 @@ public void setValueAsString(String theValue) throws DataFormatException {\n \n \t\tif (NOW_DATE_CONSTANT.equalsIgnoreCase(theValue)) {\n \t\t\tsuper.setValueAsString(ourXmlDateTimeFormat.format(new Date()));\n+\t\t} else if (TODAY_DATE_CONSTANT.equalsIgnoreCase(theValue)) {\n+\t\t\tsuper.setValueAsString(ourXmlDateTimeFormat.format(new Date()));\n+\t\t\tsetPrecision(TemporalPrecisionEnum.DAY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "711afd48bee5c0b0be8f50e13323d801c4ce94c5"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7d76cd0e8f91d600ac7cb10f63cceccfc7c809f", "author": {"user": {"login": "fil512", "name": "Ken Stevens"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/c7d76cd0e8f91d600ac7cb10f63cceccfc7c809f", "committedDate": "2020-06-04T13:49:14Z", "message": "Merge remote-tracking branch 'remotes/origin/master' into ks-20200510-today-date-param"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4075, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}