{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MjEyNTEx", "number": 1847, "title": "Add missing indexes on ResourceIndexedSearchParamDate", "bodyText": "Add migration tasks for new indexes on ResourceIndexedSearchParamDate.\nAdd new indexes to ResourceIndexedSearchParamDate for low-high ordinal, low ordinal, and low date.", "createdAt": "2020-05-14T19:50:38Z", "url": "https://github.com/hapifhir/hapi-fhir/pull/1847", "merged": true, "mergeCommit": {"oid": "9fec726b0e63e2ddfd1c32c82829baf54720fba8"}, "closed": true, "closedAt": "2020-05-15T09:38:17Z", "author": {"login": "tadgh"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchR10MgH2gAyNDE4MjEyNTExOjI2OWMzZjJiMDQ1MjU5MDVjMDZiZGZhNGEwNGViZDZlOGRhMTg1ZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchex1XAFqTQxMjQ5NjMzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "269c3f2b04525905c06bdfa4a04ebd6e8da185d4", "author": {"user": {"login": "tadgh", "name": "Tadgh"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/269c3f2b04525905c06bdfa4a04ebd6e8da185d4", "committedDate": "2020-05-14T18:32:45Z", "message": "Add migration tasks for new indexes. Add new indexes to ResourceIndexedSearchParamDate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMTY3NTU1", "url": "https://github.com/hapifhir/hapi-fhir/pull/1847#pullrequestreview-412167555", "createdAt": "2020-05-14T20:40:18Z", "commit": {"oid": "269c3f2b04525905c06bdfa4a04ebd6e8da185d4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMDo0MDoxOFrOGVtZNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMDo0NjozM1rOGVtlTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNzAxNQ==", "bodyText": "This might be higher than the length limit.  James has a test that enforces this so hopefully that test will catch it.  I forget what the length limit is.", "url": "https://github.com/hapifhir/hapi-fhir/pull/1847#discussion_r425417015", "createdAt": "2020-05-14T20:40:18Z", "author": {"login": "fil512"}, "path": "hapi-fhir-jpaserver-migrate/src/main/java/ca/uhn/fhir/jpa/migrate/tasks/HapiFhirJpaMigrationTasks.java", "diffHunk": "@@ -122,7 +124,17 @@ private void init430() {\n \t\tversion.addNop(\"20200420.42\");\n \t}\n \n-\tprotected void init500() { // 20200218 - present\n+\n+\tprivate void init501() { //20200520 - present\n+\t\tBuilder version = forVersion(VersionEnum.V5_0_1);\n+\n+\t\tBuilder.BuilderWithTableName spidxDate = version.onTable(\"HFJ_SPIDX_DATE\");\n+\t\tspidxDate.addIndex(\"20200520.1\", \"IDX_SP_DATE_HASH_LOW\").unique(false).withColumns(\"HASH_IDENTITY\", \"SP_VALUE_LOW\");\n+\t\tspidxDate.addIndex(\"20200520.2\", \"IDX_SP_DATE_ORD_DATE_HASH\").unique(false).withColumns(\"HASH_IDENTITY\", \"SP_VALUE_LOW_DATE_ORDINAL\", \"SP_VALUE_HIGH_DATE_ORDINAL\");\n+\t\tspidxDate.addIndex(\"20200520.3\", \"IDX_SP_DATE_ORD_DATE_HASH_LOW\").unique(false).withColumns(\"HASH_IDENTITY\", \"SP_VALUE_LOW_DATE_ORDINAL\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "269c3f2b04525905c06bdfa4a04ebd6e8da185d4"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQyMDEwOQ==", "bodyText": "Shouldn't this be 20200514.1?", "url": "https://github.com/hapifhir/hapi-fhir/pull/1847#discussion_r425420109", "createdAt": "2020-05-14T20:46:33Z", "author": {"login": "fil512"}, "path": "hapi-fhir-jpaserver-migrate/src/main/java/ca/uhn/fhir/jpa/migrate/tasks/HapiFhirJpaMigrationTasks.java", "diffHunk": "@@ -122,7 +124,17 @@ private void init430() {\n \t\tversion.addNop(\"20200420.42\");\n \t}\n \n-\tprotected void init500() { // 20200218 - present\n+\n+\tprivate void init501() { //20200520 - present\n+\t\tBuilder version = forVersion(VersionEnum.V5_0_1);\n+\n+\t\tBuilder.BuilderWithTableName spidxDate = version.onTable(\"HFJ_SPIDX_DATE\");\n+\t\tspidxDate.addIndex(\"20200520.1\", \"IDX_SP_DATE_HASH_LOW\").unique(false).withColumns(\"HASH_IDENTITY\", \"SP_VALUE_LOW\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "269c3f2b04525905c06bdfa4a04ebd6e8da185d4"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7c64bcbb0a99651e145f5c2fd424afb9b4a2e72", "author": {"user": {"login": "tadgh", "name": "Tadgh"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/c7c64bcbb0a99651e145f5c2fd424afb9b4a2e72", "committedDate": "2020-05-14T22:28:10Z", "message": "fix dates on task, remove redundant index"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "325240e41124d13404bdc3a7f18addcdc29c14d2", "author": {"user": {"login": "tadgh", "name": "Tadgh"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/325240e41124d13404bdc3a7f18addcdc29c14d2", "committedDate": "2020-05-14T22:30:04Z", "message": "Today is not the 20th"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfb04dd1221f7df9998e2b7e885d9ecbbc70b59b", "author": {"user": {"login": "tadgh", "name": "Tadgh"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/dfb04dd1221f7df9998e2b7e885d9ecbbc70b59b", "committedDate": "2020-05-15T00:20:14Z", "message": "Fix incorrectly named migration indexes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2149c4ab5ef4797e78a05ca07bf487aaa045945c", "author": {"user": {"login": "tadgh", "name": "Tadgh"}}, "url": "https://github.com/hapifhir/hapi-fhir/commit/2149c4ab5ef4797e78a05ca07bf487aaa045945c", "committedDate": "2020-05-15T02:12:22Z", "message": "out of order indexes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNDk2MzM1", "url": "https://github.com/hapifhir/hapi-fhir/pull/1847#pullrequestreview-412496335", "createdAt": "2020-05-15T09:37:10Z", "commit": {"oid": "2149c4ab5ef4797e78a05ca07bf487aaa045945c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4082, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}