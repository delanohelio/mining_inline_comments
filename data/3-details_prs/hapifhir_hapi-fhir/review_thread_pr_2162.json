{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3NDA5OTAx", "number": 2162, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNTowODo1MVrOE2zz9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNjoxMzowM1rOE21tlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1OTA3NDQ3OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-base/src/main/resources/ca/uhn/fhir/i18n/hapi-messages.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNTowODo1MVrOHvzNkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNTowODo1MVrOHvzNkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg4NDE3Ng==", "bodyText": "Typo.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ca.uhn.fhir.jpa.term.BaseTermReadSvcImpl.valueSetNotYetExpanded_OffsetNotAllowed=ValueSet expansion van not combine \"offset\" with \"ValueSet.compose.exclude\" unless the ValueSet has been pre-expanded. ValueSet \"{0}\" must be pre-expanded for this operation to work.\n          \n          \n            \n            ca.uhn.fhir.jpa.term.BaseTermReadSvcImpl.valueSetNotYetExpanded_OffsetNotAllowed=ValueSet expansion can not combine \"offset\" with \"ValueSet.compose.exclude\" unless the ValueSet has been pre-expanded. ValueSet \"{0}\" must be pre-expanded for this operation to work.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2162#discussion_r519884176", "createdAt": "2020-11-09T15:08:51Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-base/src/main/resources/ca/uhn/fhir/i18n/hapi-messages.properties", "diffHunk": "@@ -1,5 +1,8 @@\n \n ca.uhn.fhir.jpa.term.BaseTermReadSvcImpl.expansionRefersToUnknownCs=Unknown CodeSystem URI \"{0}\" referenced from ValueSet\n+ca.uhn.fhir.jpa.term.BaseTermReadSvcImpl.valueSetNotYetExpanded=ValueSet \"{0}\" has not yet been pre-expanded. Performing in-memory expansion without parameters. Current status: {1} | {2}\n+ca.uhn.fhir.jpa.term.BaseTermReadSvcImpl.valueSetNotYetExpanded_OffsetNotAllowed=ValueSet expansion van not combine \"offset\" with \"ValueSet.compose.exclude\" unless the ValueSet has been pre-expanded. ValueSet \"{0}\" must be pre-expanded for this operation to work.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5514ebe4d191a0683729a4d9cd2ebed81befe42a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1OTE2OTkyOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoR4TerminologyTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNToyODozMVrOHv0Hog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQyMzowMToxMVrOHwFCBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg5OTA0Mg==", "bodyText": "FIXME", "url": "https://github.com/hapifhir/hapi-fhir/pull/2162#discussion_r519899042", "createdAt": "2020-11-09T15:28:31Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoR4TerminologyTest.java", "diffHunk": "@@ -1015,9 +1015,11 @@ public void testSearchCodeBelowBuiltInCodesystemUnqualified() {\n \t\tmyAllergyIntoleranceDao.create(ai3, mySrd).getId().toUnqualifiedVersionless().getValue();\n \n \t\tSearchParameterMap params;\n-\t\tparams = new SearchParameterMap();\n-\t\tparams.add(AllergyIntolerance.SP_CLINICAL_STATUS, new TokenParam(null, \"active\"));\n-\t\tassertThat(toUnqualifiedVersionlessIdValues(myAllergyIntoleranceDao.search(params)), containsInAnyOrder(id1));\n+\n+\t\t// FIXME: restore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5514ebe4d191a0683729a4d9cd2ebed81befe42a"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE3NjEzMw==", "bodyText": "Oops! Fixed.", "url": "https://github.com/hapifhir/hapi-fhir/pull/2162#discussion_r520176133", "createdAt": "2020-11-09T23:01:11Z", "author": {"login": "jamesagnew"}, "path": "hapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/dao/r4/FhirResourceDaoR4TerminologyTest.java", "diffHunk": "@@ -1015,9 +1015,11 @@ public void testSearchCodeBelowBuiltInCodesystemUnqualified() {\n \t\tmyAllergyIntoleranceDao.create(ai3, mySrd).getId().toUnqualifiedVersionless().getValue();\n \n \t\tSearchParameterMap params;\n-\t\tparams = new SearchParameterMap();\n-\t\tparams.add(AllergyIntolerance.SP_CLINICAL_STATUS, new TokenParam(null, \"active\"));\n-\t\tassertThat(toUnqualifiedVersionlessIdValues(myAllergyIntoleranceDao.search(params)), containsInAnyOrder(id1));\n+\n+\t\t// FIXME: restore", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg5OTA0Mg=="}, "originalCommit": {"oid": "5514ebe4d191a0683729a4d9cd2ebed81befe42a"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1OTM1NjI1OnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/term/ValueSetExpansionR4Test.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNjowNjo0MVrOHv158w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNjowNjo0MVrOHv158w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTkyODMwNw==", "bodyText": "Typo.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tfail(\"Expanded to \" + expansion.getExpansion().getContains().size() + \" but mas was \" + myDaoConfig.getMaximumExpansionSize());\n          \n          \n            \n            \t\t\tfail(\"Expanded to \" + expansion.getExpansion().getContains().size() + \" but max was \" + myDaoConfig.getMaximumExpansionSize());", "url": "https://github.com/hapifhir/hapi-fhir/pull/2162#discussion_r519928307", "createdAt": "2020-11-09T16:06:41Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-jpaserver-base/src/test/java/ca/uhn/fhir/jpa/term/ValueSetExpansionR4Test.java", "diffHunk": "@@ -877,8 +1129,8 @@ public void testExpandValueSetInMemoryRespectsMaxSize() {\n \t\tValueSet.ConceptSetComponent include = vs.getCompose().addInclude();\n \t\tinclude.setSystem(CS_URL);\n \t\ttry {\n-\t\t\tmyTermSvc.expandValueSet(null, vs);\n-\t\t\tfail();\n+\t\t\tValueSet expansion = myTermSvc.expandValueSet(null, vs);\n+\t\t\tfail(\"Expanded to \" + expansion.getExpansion().getContains().size() + \" but mas was \" + myDaoConfig.getMaximumExpansionSize());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5514ebe4d191a0683729a4d9cd2ebed81befe42a"}, "originalPosition": 328}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1OTM4NTgxOnYy", "diffSide": "RIGHT", "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/term/BaseTermReadSvcImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNjoxMzowM1rOHv2MLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNjoxMzowM1rOHv2MLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTkzMjk3NQ==", "bodyText": "Typo.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Execute in a new transasction only if we aren't already in one. We do this because in some cases\n          \n          \n            \n            \t * Execute in a new transaction only if we aren't already in one. We do this because in some cases", "url": "https://github.com/hapifhir/hapi-fhir/pull/2162#discussion_r519932975", "createdAt": "2020-11-09T16:13:03Z", "author": {"login": "dmuylwyk"}, "path": "hapi-fhir-jpaserver-base/src/main/java/ca/uhn/fhir/jpa/term/BaseTermReadSvcImpl.java", "diffHunk": "@@ -603,47 +670,49 @@ private void expandValueSet(ValueSetExpansionOptions theExpansionOptions, ValueS\n \t\tourLog.debug(\"Done working with {} in {}ms\", valueSetInfo, sw.getMillis());\n \t}\n \n+\t/**\n+\t * Execute in a new transasction only if we aren't already in one. We do this because in some cases", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5514ebe4d191a0683729a4d9cd2ebed81befe42a"}, "originalPosition": 472}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1830, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}