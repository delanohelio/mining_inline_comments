{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3MDkwODE2", "number": 882, "title": "Implementing ForceFlush for SpanProcessor", "bodyText": "With open-telemetry/opentelemetry-specification#370, the SpanProcessor interface changed introducing a new ForceFlush() method.\nShould we also provide a ForceFlush(int, TimeUnit) interface to configure an upper-bound time limit?\nThis also addresses #794.", "createdAt": "2020-02-19T10:37:12Z", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882", "merged": true, "mergeCommit": {"oid": "073ece13b89fd91821f4d498d36e05eadda42607"}, "closed": true, "closedAt": "2020-02-21T19:27:20Z", "author": {"login": "thisthat"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcF0DBWAH2gAyMzc3MDkwODE2OmVjNWQxODNmMjZmNTk1ODQ1YjY2ODk4OGQzMzdlZjIzODBiYzM1N2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGj54yAFqTM2MjgyMzE0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ec5d183f26f595845b668988d337ef2380bc357f", "author": {"user": {"login": "thisthat", "name": "Giovanni Liva"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/ec5d183f26f595845b668988d337ef2380bc357f", "committedDate": "2020-02-19T10:34:04Z", "message": "first implementation of ForceFlush"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMjU4ODY3", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#pullrequestreview-361258867", "createdAt": "2020-02-19T16:50:14Z", "commit": {"oid": "ec5d183f26f595845b668988d337ef2380bc357f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNjo1MDoxNFrOFrvFEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNjo1MDoxNFrOFrvFEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQwNDQzMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * <p>This method is called synchronously on the execution thread, should not throw or block the\n          \n          \n            \n               * <p>This method is called synchronously on the execution thread, and should not throw exceptions \n          \n          \n            \n                         or block the execution thread.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#discussion_r381404432", "createdAt": "2020-02-19T16:50:14Z", "author": {"login": "jkwatson"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/SpanProcessor.java", "diffHunk": "@@ -48,4 +48,12 @@\n \n   /** Called when {@link TracerSdkRegistry#shutdown()} is called. */\n   void shutdown();\n+\n+  /**\n+   * Exports all ended spans that have not yet been exported.\n+   *\n+   * <p>This method is called synchronously on the execution thread, should not throw or block the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec5d183f26f595845b668988d337ef2380bc357f"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMjU5MDU0", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#pullrequestreview-361259054", "createdAt": "2020-02-19T16:50:26Z", "commit": {"oid": "ec5d183f26f595845b668988d337ef2380bc357f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNjo1MDoyNlrOFrvFow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNjo1MDoyNlrOFrvFow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQwNDU3OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * execution thread.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#discussion_r381404579", "createdAt": "2020-02-19T16:50:26Z", "author": {"login": "jkwatson"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/SpanProcessor.java", "diffHunk": "@@ -48,4 +48,12 @@\n \n   /** Called when {@link TracerSdkRegistry#shutdown()} is called. */\n   void shutdown();\n+\n+  /**\n+   * Exports all ended spans that have not yet been exported.\n+   *\n+   * <p>This method is called synchronously on the execution thread, should not throw or block the\n+   * execution thread.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec5d183f26f595845b668988d337ef2380bc357f"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMjc5Mzc0", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#pullrequestreview-361279374", "createdAt": "2020-02-19T17:15:07Z", "commit": {"oid": "ec5d183f26f595845b668988d337ef2380bc357f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNzoxNTowN1rOFrwEkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNzoxNTowN1rOFrwEkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQyMDY4OQ==", "bodyText": "Rename this shutdown?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#discussion_r381420689", "createdAt": "2020-02-19T17:15:07Z", "author": {"login": "bogdandrutu"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/export/BatchSpansProcessor.java", "diffHunk": "@@ -315,14 +320,18 @@ public void run() {\n     }\n \n     private void flush() {\n+      forceFlush();\n+      executorService.shutdown();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec5d183f26f595845b668988d337ef2380bc357f"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNjQ1MTkw", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#pullrequestreview-361645190", "createdAt": "2020-02-20T05:44:15Z", "commit": {"oid": "ec5d183f26f595845b668988d337ef2380bc357f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19fe8520b6c893db6a591edcb71f7eb93da7f990", "author": {"user": {"login": "thisthat", "name": "Giovanni Liva"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/19fe8520b6c893db6a591edcb71f7eb93da7f990", "committedDate": "2020-02-20T08:58:44Z", "message": "Update sdk/src/main/java/io/opentelemetry/sdk/trace/SpanProcessor.java\n\nCo-Authored-By: John Watson <jkwatson@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26bb8ae481765bf02a106d8b6acbdad6b206428d", "author": {"user": {"login": "thisthat", "name": "Giovanni Liva"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/26bb8ae481765bf02a106d8b6acbdad6b206428d", "committedDate": "2020-02-20T09:22:31Z", "message": "Rename flush -> shutdown. Add test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxNzQ3MTQ0", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#pullrequestreview-361747144", "createdAt": "2020-02-20T09:28:33Z", "commit": {"oid": "26bb8ae481765bf02a106d8b6acbdad6b206428d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMDQ0MzQ3", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#pullrequestreview-362044347", "createdAt": "2020-02-20T16:23:59Z", "commit": {"oid": "26bb8ae481765bf02a106d8b6acbdad6b206428d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNjoyMzo1OVrOFsaHxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNjoyMzo1OVrOFsaHxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjEwOTYzOQ==", "bodyText": "I am confused about this. I think the whole purpose is to ensure flush so it will block, maybe add an issue to clarify this behavior on the specs", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#discussion_r382109639", "createdAt": "2020-02-20T16:23:59Z", "author": {"login": "bogdandrutu"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/SpanProcessor.java", "diffHunk": "@@ -48,4 +48,12 @@\n \n   /** Called when {@link TracerSdkRegistry#shutdown()} is called. */\n   void shutdown();\n+\n+  /**\n+   * Exports all ended spans that have not yet been exported.\n+   *\n+   * <p>This method is called synchronously on the execution thread, and should not throw exceptions\n+   * or block the execution thread. execution thread.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26bb8ae481765bf02a106d8b6acbdad6b206428d"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a61e5810a78d3c9d259aeb832d7627186a69eee8", "author": {"user": {"login": "thisthat", "name": "Giovanni Liva"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/a61e5810a78d3c9d259aeb832d7627186a69eee8", "committedDate": "2020-02-21T07:21:52Z", "message": "Better wording in Javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyODIzMTQ4", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#pullrequestreview-362823148", "createdAt": "2020-02-21T18:19:18Z", "commit": {"oid": "a61e5810a78d3c9d259aeb832d7627186a69eee8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxODoxOToxOVrOFtAJwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxODoxOToxOVrOFtAJwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjczMjczNw==", "bodyText": "This is not waiting for the processor thread to actually call the flush maybe just document it for the moment and add a TODO to wait for flush to be called. Or simply create an issue.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/882#discussion_r382732737", "createdAt": "2020-02-21T18:19:19Z", "author": {"login": "bogdandrutu"}, "path": "sdk_contrib/async_processor/src/main/java/io/opentelemetry/sdk/contrib/trace/export/DisruptorEventQueue.java", "diffHunk": "@@ -129,6 +130,18 @@ void shutdown() {\n     }\n   }\n \n+  void forceFlush() {\n+    if (isShutdown) {\n+      return;\n+    }\n+    synchronized (this) {\n+      if (isShutdown) {\n+        return;\n+      }\n+      enqueue(null, EventType.ON_FORCE_FLUSH);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a61e5810a78d3c9d259aeb832d7627186a69eee8"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3398, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}