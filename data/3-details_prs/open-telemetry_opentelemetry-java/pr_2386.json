{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzODQ4OTg5", "number": 2386, "title": "Reduce usage of GlobalOpenTelemetry", "bodyText": "Mostly to make the tests more readable rather than relying on what happens to be in the global at the time (possibly mutated in another test in the package).", "createdAt": "2020-12-22T03:54:44Z", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2386", "merged": true, "mergeCommit": {"oid": "8fc4e627cafa24a844378b333814a82d00277f1a"}, "closed": true, "closedAt": "2020-12-23T01:17:47Z", "author": {"login": "anuraaga"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdoiPfhAH2gAyNTQzODQ4OTg5OjBlMjI0NDk5NTFlOWUxNGJmZTcxODU5MTQ3OGE1OWMzZjFmNDZkYTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdo0OqUgH2gAyNTQzODQ4OTg5OmJkMTE4ZmY0OGEzNGEyZTA1YWMwZWVkMjAwNTBlZDQ5YzkwY2NjOWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0e22449951e9e14bfe718591478a59c3f1f46da1", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/0e22449951e9e14bfe718591478a59c3f1f46da1", "committedDate": "2020-12-22T03:47:54Z", "message": "Reduce usage of GlobalOpenTelemetry"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjY3ODYx", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2386#pullrequestreview-557267861", "createdAt": "2020-12-22T18:08:51Z", "commit": {"oid": "0e22449951e9e14bfe718591478a59c3f1f46da1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxODowODo1MVrOIKEHRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxODowODo1MVrOIKEHRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQyNDA2OA==", "bodyText": "heh...this is more of a \"how does the SDK react to bad situations\" than perf per se, but this is fine. :)", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2386#discussion_r547424068", "createdAt": "2020-12-22T18:08:51Z", "author": {"login": "jkwatson"}, "path": "perf-harness/src/test/java/io/opentelemetry/perf/OtlpPipelineStressTest.java", "diffHunk": "@@ -243,16 +245,22 @@ private static IntervalMetricReader setupSdk(MetricExporter metricExporter) {\n \n     // set up the metric exporter and wire it into the SDK and a timed reader.\n \n-    return IntervalMetricReader.builder()\n-        .setMetricExporter(metricExporter)\n-        .setMetricProducers(\n-            Collections.singleton(\n-                ((SdkMeterProvider) GlobalMetricsProvider.get()).getMetricProducer()))\n-        .setExportIntervalMillis(1000)\n-        .build();\n-  }\n+    Resource resource =\n+        Resource.create(\n+            Attributes.builder()\n+                .put(ResourceAttributes.SERVICE_NAME, \"PerfTester\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e22449951e9e14bfe718591478a59c3f1f46da1"}, "originalPosition": 84}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjY5MzI4", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2386#pullrequestreview-557269328", "createdAt": "2020-12-22T18:11:36Z", "commit": {"oid": "0e22449951e9e14bfe718591478a59c3f1f46da1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxODoxMTozNlrOIKELmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxODoxMTozNlrOIKELmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQyNTE3OA==", "bodyText": "Do we need the whole SdkTracerProvider here, or is the management interface enough?  I actually struggled with this kind of decision in the examples, as well.  It's so easy to end up with the SDK tracer provider and to use it for instrumentation, and we'd definitely like to discourage that pattern as much as possible.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2386#discussion_r547425178", "createdAt": "2020-12-22T18:11:36Z", "author": {"login": "jkwatson"}, "path": "perf-harness/src/test/java/io/opentelemetry/perf/OtlpPipelineStressTest.java", "diffHunk": "@@ -101,6 +102,8 @@\n \n   private final InMemoryMetricExporter metricExporter = InMemoryMetricExporter.create();\n \n+  private SdkTracerProvider tracerProvider;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e22449951e9e14bfe718591478a59c3f1f46da1"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MjcxNjU5", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2386#pullrequestreview-557271659", "createdAt": "2020-12-22T18:13:31Z", "commit": {"oid": "0e22449951e9e14bfe718591478a59c3f1f46da1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd118ff48a34a2e05ac0eed20050ed49c90ccc9c", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/bd118ff48a34a2e05ac0eed20050ed49c90ccc9c", "committedDate": "2020-12-23T00:45:17Z", "message": "Cleanup"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3520, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}