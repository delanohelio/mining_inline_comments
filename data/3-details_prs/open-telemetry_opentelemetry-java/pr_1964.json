{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzNzcyMzIw", "number": 1964, "title": "Don't throw exceptions for invalid baggage like other APIs", "bodyText": "I noticed that our baggage APIs validate parameters with exceptions, which isn't what we do in other APIs. This makes Entry creation package private (#1960 is a bit related) and ignores bad input in baggage construction.", "createdAt": "2020-11-02T04:14:17Z", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964", "merged": true, "mergeCommit": {"oid": "46408ef3fd7f5c7afb1b91e62fd14e4cd5fdeda8"}, "closed": true, "closedAt": "2020-11-17T02:30:17Z", "author": {"login": "anuraaga"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYcgL_gH2gAyNTEzNzcyMzIwOmZjNmI3MjQyNDI3NGMwOTlmZmJlMzIwYWE4MThiZWQ3ZjQ2NGZlYWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddP7UAAH2gAyNTEzNzcyMzIwOjA3MTg0MTdkNjIyMTUwYTczZmJhNGIxODIzNzY2MGNmNjViYWM2MGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/fc6b72424274c099ffbe320aa818bed7f464feaa", "committedDate": "2020-11-02T04:03:55Z", "message": "Don't throw exceptions for invalid baggage like other APIs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxODEwNTU0", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#pullrequestreview-521810554", "createdAt": "2020-11-02T16:48:29Z", "commit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxODIwODU0", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#pullrequestreview-521820854", "createdAt": "2020-11-02T16:59:12Z", "commit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNjo1OToxM1rOHsNSjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNjo1OToxM1rOHsNSjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjExNzEzNA==", "bodyText": "Maybe we should do a fine-level logging here (can be discussed in/as a follow-up).", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#discussion_r516117134", "createdAt": "2020-11-02T16:59:13Z", "author": {"login": "carlosalberto"}, "path": "api/src/main/java/io/opentelemetry/api/baggage/ImmutableBaggage.java", "diffHunk": "@@ -135,6 +136,9 @@ public String toString() {\n \n     @Override\n     public Baggage.Builder put(String key, String value, EntryMetadata entryMetadata) {\n+      if (!isKeyValid(key) || !isValueValid(value)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxODIxMjcw", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#pullrequestreview-521821270", "createdAt": "2020-11-02T16:59:39Z", "commit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxOTc0MDc5", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#pullrequestreview-521974079", "createdAt": "2020-11-02T20:36:30Z", "commit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "state": "DISMISSED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDozNjozMVrOHsUwPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDozODoxMVrOHsUzTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIzOTQyMw==", "bodyText": "Mark metadata as Nullable", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#discussion_r516239423", "createdAt": "2020-11-02T20:36:31Z", "author": {"login": "bogdandrutu"}, "path": "api/src/main/java/io/opentelemetry/api/baggage/EntryMetadata.java", "diffHunk": "@@ -26,6 +26,9 @@\n    * @return an {@code EntryMetadata}.\n    */\n   public static EntryMetadata create(String metadata) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIzOTYyMg==", "bodyText": "why not throwing exception?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#discussion_r516239622", "createdAt": "2020-11-02T20:36:55Z", "author": {"login": "bogdandrutu"}, "path": "api/src/main/java/io/opentelemetry/api/baggage/ImmutableBaggage.java", "diffHunk": "@@ -135,6 +136,9 @@ public String toString() {\n \n     @Override\n     public Baggage.Builder put(String key, String value, EntryMetadata entryMetadata) {\n+      if (!isKeyValid(key) || !isValueValid(value)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjExNzEzNA=="}, "originalCommit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDAzNA==", "bodyText": "This is wrong, either not allow and check for null or throw exception.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#discussion_r516240034", "createdAt": "2020-11-02T20:37:47Z", "author": {"login": "bogdandrutu"}, "path": "api/src/main/java/io/opentelemetry/api/baggage/ImmutableBaggage.java", "diffHunk": "@@ -146,14 +150,14 @@ public String toString() {\n \n     @Override\n     public Baggage.Builder put(String key, String value) {\n-      entries.put(\n-          Objects.requireNonNull(key, \"key\"),\n-          Entry.create(key, Objects.requireNonNull(value, \"value\"), EntryMetadata.EMPTY));\n-      return this;\n+      return put(key, value, EntryMetadata.EMPTY);\n     }\n \n     @Override\n     public Baggage.Builder remove(String key) {\n+      if (key == null) {\n+        return this;\n+      }\n       entries.remove(Objects.requireNonNull(key, \"key\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDIwNw==", "bodyText": "Either throw exception or allow Nullable", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1964#discussion_r516240207", "createdAt": "2020-11-02T20:38:11Z", "author": {"login": "bogdandrutu"}, "path": "api/src/main/java/io/opentelemetry/api/baggage/ImmutableBaggage.java", "diffHunk": "@@ -135,6 +136,9 @@ public String toString() {\n \n     @Override\n     public Baggage.Builder put(String key, String value, EntryMetadata entryMetadata) {\n+      if (!isKeyValid(key) || !isValueValid(value)) {\n+        return this;\n+      }\n       entries.put(\n           Objects.requireNonNull(key, \"key\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc6b72424274c099ffbe320aa818bed7f464feaa"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54f68a4121aebe8c9dd924f8462a7ef3813d111d", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/54f68a4121aebe8c9dd924f8462a7ef3813d111d", "committedDate": "2020-11-03T05:59:41Z", "message": "Remove redundant null check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85de66ceb6541eaaa7c9873b60689e7b6ba1c724", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/85de66ceb6541eaaa7c9873b60689e7b6ba1c724", "committedDate": "2020-11-03T06:05:26Z", "message": "Remove redundant null checks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0718417d622150a73fba4b18237660cf65bac60d", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/0718417d622150a73fba4b18237660cf65bac60d", "committedDate": "2020-11-17T02:14:24Z", "message": "Merge branch 'master' of github.com:open-telemetry/opentelemetry-java into etry-o-throw"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3898, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}