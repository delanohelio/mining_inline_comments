{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzMjQ2NjE4", "number": 2373, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQwNjowNDo1OVrOFHrKWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQxNzoxMDowNVrOFH3hNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzNTkxNTEzOnYy", "diffSide": "LEFT", "path": "opencensus-shim/src/test/java/io/opentelemetry/opencensusshim/TraceInteroperabilityTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQwNjowNDo1OVrOIJNNDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQwNjowNDo1OVrOIJNNDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjUyNDQyOA==", "bodyText": "span processor leak fixed :)", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2373#discussion_r546524428", "createdAt": "2020-12-21T06:04:59Z", "author": {"login": "anuraaga"}, "path": "opencensus-shim/src/test/java/io/opentelemetry/opencensusshim/TraceInteroperabilityTest.java", "diffHunk": "@@ -56,20 +59,32 @@\n \n   private static final String NULL_SPAN_ID = \"0000000000000000\";\n \n-  @Captor private ArgumentCaptor<Collection<SpanData>> spanDataCaptor;\n-\n-  @Spy private SpanExporter spanExporter;\n+  // Initialize OpenTelemetry statically because OpenCensus is.\n+  private static final SpanExporter spanExporter;\n+  private static final OpenTelemetry openTelemetry;\n \n-  @BeforeEach\n-  public void init() {\n+  static {\n+    spanExporter = spy(SpanExporter.class);\n     when(spanExporter.export(anyList())).thenReturn(CompletableResultCode.ofSuccess());\n+\n     SpanProcessor spanProcessor = SimpleSpanProcessor.builder(spanExporter).build();\n-    OpenTelemetrySdk.getGlobalTracerManagement().addSpanProcessor(spanProcessor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df1153af95ea9b74747c5192b2acab653295d20a"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzNzY0MDQ0OnYy", "diffSide": "RIGHT", "path": "sdk/testing/src/test/java/io/opentelemetry/sdk/testing/exporter/InMemorySpanExporterTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQxNTo0Njo1OVrOIJcyxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQxNTo0Njo1OVrOIJcyxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njc3OTg0NQ==", "bodyText": "I don't think Simple processor needs this, but it is a good pattern to follow and shutdown the sdk/processor all the time.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2373#discussion_r546779845", "createdAt": "2020-12-21T15:46:59Z", "author": {"login": "bogdandrutu"}, "path": "sdk/testing/src/test/java/io/opentelemetry/sdk/testing/exporter/InMemorySpanExporterTest.java", "diffHunk": "@@ -23,13 +23,17 @@\n \n /** Unit tests for {@link InMemorySpanExporter}. */\n class InMemorySpanExporterTest {\n-  private final SdkTracerProvider sdkTracerProvider = SdkTracerProvider.builder().build();\n-  private final Tracer tracer = sdkTracerProvider.get(\"InMemorySpanExporterTest\");\n   private final InMemorySpanExporter exporter = InMemorySpanExporter.create();\n \n+  private Tracer tracer;\n+\n   @BeforeEach\n   void setup() {\n-    sdkTracerProvider.addSpanProcessor(SimpleSpanProcessor.builder(exporter).build());\n+    tracer =\n+        SdkTracerProvider.builder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df1153af95ea9b74747c5192b2acab653295d20a"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzNzkzOTczOnYy", "diffSide": "RIGHT", "path": "integration-tests/src/main/java/io/opentelemetry/SendTraceToJaeger.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQxNzoxMDowNVrOIJfj-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQwMjoxNjowMFrOIJr96g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjgyNTIxMQ==", "bodyText": "it's a little odd to use this class name to call a static method on itself, but it's not a deal breaker.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2373#discussion_r546825211", "createdAt": "2020-12-21T17:10:05Z", "author": {"login": "jkwatson"}, "path": "integration-tests/src/main/java/io/opentelemetry/SendTraceToJaeger.java", "diffHunk": "@@ -78,8 +83,8 @@ public static void main(String[] args) {\n \n     // Start the example\n     SendTraceToJaeger example = new SendTraceToJaeger(ip, port);\n-    example.setupJaegerExporter();\n-    example.myWonderfulUseCase();\n+    OpenTelemetry openTelemetry = example.initOpenTelemetry();\n+    SendTraceToJaeger.myWonderfulUseCase(openTelemetry);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df1153af95ea9b74747c5192b2acab653295d20a"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzAwODc1Mg==", "bodyText": "you mean just write this as myWonderfulUseCase(openTelemetry); ?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2373#discussion_r547008752", "createdAt": "2020-12-22T01:01:53Z", "author": {"login": "bogdandrutu"}, "path": "integration-tests/src/main/java/io/opentelemetry/SendTraceToJaeger.java", "diffHunk": "@@ -78,8 +83,8 @@ public static void main(String[] args) {\n \n     // Start the example\n     SendTraceToJaeger example = new SendTraceToJaeger(ip, port);\n-    example.setupJaegerExporter();\n-    example.myWonderfulUseCase();\n+    OpenTelemetry openTelemetry = example.initOpenTelemetry();\n+    SendTraceToJaeger.myWonderfulUseCase(openTelemetry);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjgyNTIxMQ=="}, "originalCommit": {"oid": "df1153af95ea9b74747c5192b2acab653295d20a"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzAyMzE0NQ==", "bodyText": "Error prone doesn't like", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2373#discussion_r547023145", "createdAt": "2020-12-22T01:56:04Z", "author": {"login": "anuraaga"}, "path": "integration-tests/src/main/java/io/opentelemetry/SendTraceToJaeger.java", "diffHunk": "@@ -78,8 +83,8 @@ public static void main(String[] args) {\n \n     // Start the example\n     SendTraceToJaeger example = new SendTraceToJaeger(ip, port);\n-    example.setupJaegerExporter();\n-    example.myWonderfulUseCase();\n+    OpenTelemetry openTelemetry = example.initOpenTelemetry();\n+    SendTraceToJaeger.myWonderfulUseCase(openTelemetry);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjgyNTIxMQ=="}, "originalCommit": {"oid": "df1153af95ea9b74747c5192b2acab653295d20a"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzAyNTkyMQ==", "bodyText": "Can you paste the error? I am curious", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2373#discussion_r547025921", "createdAt": "2020-12-22T02:06:07Z", "author": {"login": "bogdandrutu"}, "path": "integration-tests/src/main/java/io/opentelemetry/SendTraceToJaeger.java", "diffHunk": "@@ -78,8 +83,8 @@ public static void main(String[] args) {\n \n     // Start the example\n     SendTraceToJaeger example = new SendTraceToJaeger(ip, port);\n-    example.setupJaegerExporter();\n-    example.myWonderfulUseCase();\n+    OpenTelemetry openTelemetry = example.initOpenTelemetry();\n+    SendTraceToJaeger.myWonderfulUseCase(openTelemetry);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjgyNTIxMQ=="}, "originalCommit": {"oid": "df1153af95ea9b74747c5192b2acab653295d20a"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzAyODQ1OA==", "bodyText": "Sorry my bad - error prone didn't like example.static(), but static() no problem. Error message earlier threw me off\n/Users/aanuraag/git/opentelemetry-java/integration-tests/src/main/java/io/opentelemetry/SendTraceToJaeger.java:87: warning: [static] static method should be qualified by type name, SendTraceToJaeger, instead of by an expression\n    example.myWonderfulUseCase(openTelemetry);\n           ^", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2373#discussion_r547028458", "createdAt": "2020-12-22T02:16:00Z", "author": {"login": "anuraaga"}, "path": "integration-tests/src/main/java/io/opentelemetry/SendTraceToJaeger.java", "diffHunk": "@@ -78,8 +83,8 @@ public static void main(String[] args) {\n \n     // Start the example\n     SendTraceToJaeger example = new SendTraceToJaeger(ip, port);\n-    example.setupJaegerExporter();\n-    example.myWonderfulUseCase();\n+    OpenTelemetry openTelemetry = example.initOpenTelemetry();\n+    SendTraceToJaeger.myWonderfulUseCase(openTelemetry);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjgyNTIxMQ=="}, "originalCommit": {"oid": "df1153af95ea9b74747c5192b2acab653295d20a"}, "originalPosition": 64}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1597, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}