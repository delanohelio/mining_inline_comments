{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwNzU3ODQ4", "number": 2175, "title": "Use key as AttributeKey.toString", "bodyText": "I find unit test assertion messages and IntelliJ debugging to be quite hard to grok with this looking like {type = STRING, value = foo}. While using the key name does lose the type, I don't think people will find that a loss since presumably the value is right next to it.", "createdAt": "2020-12-02T05:28:59Z", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2175", "merged": true, "mergeCommit": {"oid": "262dd7a866b8d7a0a47e8c3a1680ddc774e4ad42"}, "closed": true, "closedAt": "2020-12-15T03:49:46Z", "author": {"login": "anuraaga"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiHreegH2gAyNTMwNzU3ODQ4Ojk3ZmU3YTE2NzVhODM3MDU0MzFlZWRjNzRjNWJkZTBiZjVjMjMyNzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmPv5bgH2gAyNTMwNzU3ODQ4Ojc2NTcyOTQ2ZGMwMzIyODliZDVjMGIyNzExMGNiMzE3MzA5OTA1OTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "97fe7a1675a83705431eedc74c5bde0bf5c23274", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/97fe7a1675a83705431eedc74c5bde0bf5c23274", "committedDate": "2020-12-02T05:27:29Z", "message": "Use key as AttributeKey.toString"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNTE4NzQ0", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2175#pullrequestreview-542518744", "createdAt": "2020-12-02T05:57:01Z", "commit": {"oid": "97fe7a1675a83705431eedc74c5bde0bf5c23274"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNTo1NzowMVrOH9LlIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNTo1NzowMVrOH9LlIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzkxNDkxMw==", "bodyText": "It might be nice to at least delineate that this isn't just a String. Maybe put a colon in front of it, so it looks like an elixir atom or a ruby symbol?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2175#discussion_r533914913", "createdAt": "2020-12-02T05:57:01Z", "author": {"login": "jkwatson"}, "path": "api/src/main/java/io/opentelemetry/api/common/AttributeKeyImpl.java", "diffHunk": "@@ -24,6 +24,11 @@ public String getKey() {\n   @Nullable\n   abstract String key();\n \n+  @Override\n+  public final String toString() {\n+    return getKey();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97fe7a1675a83705431eedc74c5bde0bf5c23274"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8df5ac1ba161adb7e1e8c9547f85477995b568b1", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/8df5ac1ba161adb7e1e8c9547f85477995b568b1", "committedDate": "2020-12-02T08:18:10Z", "message": "Fix / more tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfbbc5cab17bcbf39095986f4351d6b2ab7eb6b1", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/bfbbc5cab17bcbf39095986f4351d6b2ab7eb6b1", "committedDate": "2020-12-02T08:40:15Z", "message": "Add toString test for SpanWrapper"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNjAzMzMx", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2175#pullrequestreview-542603331", "createdAt": "2020-12-02T08:40:05Z", "commit": {"oid": "8df5ac1ba161adb7e1e8c9547f85477995b568b1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwODo0MDowNlrOH9P4EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwODo0MDowNlrOH9P4EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk4NTI5Ng==", "bodyText": "@jkwatson @Oberon00 I know what you're getting at, but here's the example we should be looking at - I'd say I like this output and anything else might just add confusion (adding quotes around the key is a possible option that I'm ambivalent on). In unit test failures, we want to eventually look something like\nSpanWrapper{name=HTTP GET, attributes={error=true, http.response_size=100}}\nwhere the attributes become extremely readable to me. SpanWrapper is very far away from looking like this though, lots to do to it.\nBy the way I added our current SpanWrapper toString for kicks (this is literally what we see in instrumentation tests which uses Spock to diff toStrings) - it was even worse than I expected ; ;", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2175#discussion_r533985296", "createdAt": "2020-12-02T08:40:06Z", "author": {"login": "anuraaga"}, "path": "api/src/test/java/io/opentelemetry/api/common/AttributesTest.java", "diffHunk": "@@ -370,4 +367,20 @@ void nullsAreNoOps() {\n     assertThat(attributes.get(doubleArrayKey(\"arrayDouble\"))).isEqualTo(singletonList(1.0d));\n     assertThat(attributes.get(booleanArrayKey(\"arrayBool\"))).isEqualTo(singletonList(true));\n   }\n+\n+  @Test\n+  void attributesToString() {\n+    Attributes attributes =\n+        Attributes.builder()\n+            .put(\"otel.status_code\", \"OK\")\n+            .put(\"http.response_size\", 100)\n+            .put(\"process.cpu_consumed\", 33.44)\n+            .put(\"error\", true)\n+            .build();\n+\n+    assertThat(attributes.toString())\n+        .isEqualTo(\n+            \"{error=true, http.response_size=100, \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8df5ac1ba161adb7e1e8c9547f85477995b568b1"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ebd5be2d3c1853a88998e5afdb14e22436fcb35", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/2ebd5be2d3c1853a88998e5afdb14e22436fcb35", "committedDate": "2020-12-12T05:15:45Z", "message": "Merge branch 'master' of github.com:open-telemetry/opentelemetry-java into attributekey-tostring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b60db428718867e322cae8ae570fb6c93860bb95", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/b60db428718867e322cae8ae570fb6c93860bb95", "committedDate": "2020-12-12T05:23:04Z", "message": "Quote string values"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxNTc1MDI2", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2175#pullrequestreview-551575026", "createdAt": "2020-12-14T16:37:39Z", "commit": {"oid": "b60db428718867e322cae8ae570fb6c93860bb95"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozNzozOVrOIFZWzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozNzozOVrOIFZWzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyOTIzMQ==", "bodyText": "shouldn't this one have quotes around the value1 ?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2175#discussion_r542529231", "createdAt": "2020-12-14T16:37:39Z", "author": {"login": "jkwatson"}, "path": "api/common/src/test/java/io/opentelemetry/api/common/AttributesTest.java", "diffHunk": "@@ -118,10 +118,7 @@ void asMap() {\n     assertThat(map.values().contains(\"value1\")).isTrue();\n     assertThat(map.values().contains(\"value3\")).isFalse();\n \n-    assertThat(map.toString())\n-        .isEqualTo(\n-            \"ReadOnlyArrayMap{AttributeKeyImpl{getType=STRING, key=key1}=value1,\"\n-                + \"AttributeKeyImpl{getType=LONG, key=key2}=333}\");\n+    assertThat(map.toString()).isEqualTo(\"ReadOnlyArrayMap{key1=value1,key2=333}\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b60db428718867e322cae8ae570fb6c93860bb95"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxNTgyMDU3", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2175#pullrequestreview-551582057", "createdAt": "2020-12-14T16:41:08Z", "commit": {"oid": "b60db428718867e322cae8ae570fb6c93860bb95"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0c80b33ecb4f20817dd5fdf35521aaa8165ad21", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/b0c80b33ecb4f20817dd5fdf35521aaa8165ad21", "committedDate": "2020-12-15T00:45:15Z", "message": "Merge branch 'master' of github.com:open-telemetry/opentelemetry-java into attributekey-tostring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76572946dc032289bd5c0b27110cb31730990598", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/76572946dc032289bd5c0b27110cb31730990598", "committedDate": "2020-12-15T01:07:15Z", "message": "Fix"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3837, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}