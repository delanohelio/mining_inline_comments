{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0ODgwODkz", "number": 1288, "title": "Apply platforms to resolved classpaths instead of dependency containe\u2026", "bodyText": "\u2026rs and have maven publication use resolution result for all variants.\nThis is an alternative to #1281. I think it's better since BOMs aren't in the published POMs at all - the platforms are used to manage versions for this project but aren't meant for users. It removes worries related to gRPC version, etc too for free.\nAPI POM - no BOMs\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n  <modelVersion>4.0.0</modelVersion>\n  <groupId>io.opentelemetry</groupId>\n  <artifactId>opentelemetry-api</artifactId>\n  <version>0.5.0-SNAPSHOT</version>\n  <name>OpenTelemetry Java</name>\n  <description>OpenTelemetry API</description>\n  <url>https://github.com/open-telemetry/opentelemetry-java</url>\n  <licenses>\n    <license>\n      <name>The Apache License, Version 2.0</name>\n      <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>\n    </license>\n  </licenses>\n  <developers>\n    <developer>\n      <id>opentelemetry</id>\n      <name>OpenTelemetry Gitter</name>\n      <url>https://gitter.im/open-telemetry/community</url>\n    </developer>\n  </developers>\n  <scm>\n    <connection>scm:git:git@github.com:open-telemetry/opentelemetry-java.git</connection>\n    <developerConnection>scm:git:git@github.com:open-telemetry/opentelemetry-java.git</developerConnection>\n    <url>git@github.com:open-telemetry/opentelemetry-java.git</url>\n  </scm>\n  <dependencies>\n    <dependency>\n      <groupId>javax.annotation</groupId>\n      <artifactId>javax.annotation-api</artifactId>\n      <version>1.3.2</version>\n      <scope>compile</scope>\n    </dependency>\n    <dependency>\n      <groupId>io.opentelemetry</groupId>\n      <artifactId>opentelemetry-context-prop</artifactId>\n      <version>0.5.0-SNAPSHOT</version>\n      <scope>compile</scope>\n    </dependency>\n  </dependencies>\n</project>\n\nSDK POM - Guava version filled in\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n  <modelVersion>4.0.0</modelVersion>\n  <groupId>io.opentelemetry</groupId>\n  <artifactId>opentelemetry-sdk</artifactId>\n  <version>0.5.0-SNAPSHOT</version>\n  <name>OpenTelemetry Java</name>\n  <description>OpenTelemetry SDK</description>\n  <url>https://github.com/open-telemetry/opentelemetry-java</url>\n  <licenses>\n    <license>\n      <name>The Apache License, Version 2.0</name>\n      <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>\n    </license>\n  </licenses>\n  <developers>\n    <developer>\n      <id>opentelemetry</id>\n      <name>OpenTelemetry Gitter</name>\n      <url>https://gitter.im/open-telemetry/community</url>\n    </developer>\n  </developers>\n  <scm>\n    <connection>scm:git:git@github.com:open-telemetry/opentelemetry-java.git</connection>\n    <developerConnection>scm:git:git@github.com:open-telemetry/opentelemetry-java.git</developerConnection>\n    <url>git@github.com:open-telemetry/opentelemetry-java.git</url>\n  </scm>\n  <dependencies>\n    <dependency>\n      <groupId>javax.annotation</groupId>\n      <artifactId>javax.annotation-api</artifactId>\n      <version>1.3.2</version>\n      <scope>compile</scope>\n    </dependency>\n    <dependency>\n      <groupId>io.opentelemetry</groupId>\n      <artifactId>opentelemetry-api</artifactId>\n      <version>0.5.0-SNAPSHOT</version>\n      <scope>compile</scope>\n    </dependency>\n    <dependency>\n      <groupId>com.google.guava</groupId>\n      <artifactId>guava</artifactId>\n      <version>28.2-android</version>\n      <scope>runtime</scope>\n    </dependency>\n  </dependencies>\n</project>", "createdAt": "2020-05-29T04:41:19Z", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288", "merged": true, "mergeCommit": {"oid": "04eb87b3071622d2429ae4159cb92b1e59b5305f"}, "closed": true, "closedAt": "2020-06-11T15:37:15Z", "author": {"login": "anuraaga"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcl898zgFqTQyMDY5OTQ3Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqQHFLgFqTQyOTAzNzI2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNjk5NDcy", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#pullrequestreview-420699472", "createdAt": "2020-05-29T07:03:15Z", "commit": {"oid": "f44a791bcb880081b28cd7378529cb408d991eba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwNzowMzoxNVrOGcRDTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwNzowMzoxNVrOGcRDTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI5MjY4Ng==", "bodyText": "One usually does not add anything directly to XXClasspath configuration. Why is this needed in this case?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#discussion_r432292686", "createdAt": "2020-05-29T07:03:15Z", "author": {"login": "iNikem"}, "path": "build.gradle", "diffHunk": "@@ -179,11 +179,14 @@ configure(opentelemetryProjects) {\n     }\n \n     dependencies {\n-\n-        implementation platform(boms.grpc),\n-                platform(boms.guava),\n-                platform(boms.protobuf),\n-                platform(boms.zipkin_reporter)\n+        configurations.all {\n+            if (it.name.endsWith('Classpath')) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f44a791bcb880081b28cd7378529cb408d991eba"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNzAxNDk3", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#pullrequestreview-420701497", "createdAt": "2020-05-29T07:06:58Z", "commit": {"oid": "f44a791bcb880081b28cd7378529cb408d991eba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwNzowNjo1OFrOGcRJSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwNzowNjo1OFrOGcRJSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI5NDIxOQ==", "bodyText": "The classpath configurations are only for resolving dependencies, not publishing them. Since we want to use the BOMs for resolving, not publishing (as we see in the large thread on the other PR ;) ), it makes sense to add them to the classpath configurations instead.\nThis is the recommended approach by Gradle for this use case - gradle/gradle#10861 (comment)", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#discussion_r432294219", "createdAt": "2020-05-29T07:06:58Z", "author": {"login": "anuraaga"}, "path": "build.gradle", "diffHunk": "@@ -179,11 +179,14 @@ configure(opentelemetryProjects) {\n     }\n \n     dependencies {\n-\n-        implementation platform(boms.grpc),\n-                platform(boms.guava),\n-                platform(boms.protobuf),\n-                platform(boms.zipkin_reporter)\n+        configurations.all {\n+            if (it.name.endsWith('Classpath')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI5MjY4Ng=="}, "originalCommit": {"oid": "f44a791bcb880081b28cd7378529cb408d991eba"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwODQyOTE0", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#pullrequestreview-420842914", "createdAt": "2020-05-29T10:42:46Z", "commit": {"oid": "f44a791bcb880081b28cd7378529cb408d991eba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxMDo0Mjo0NlrOGcXw6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxMDo0Mjo0NlrOGcXw6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQwMjY2Nw==", "bodyText": "maybe we should use here forcedPlatform instead of platform what's ur opinion @anuraaga", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#discussion_r432402667", "createdAt": "2020-05-29T10:42:46Z", "author": {"login": "DotSpy"}, "path": "build.gradle", "diffHunk": "@@ -179,11 +179,14 @@ configure(opentelemetryProjects) {\n     }\n \n     dependencies {\n-\n-        implementation platform(boms.grpc),\n-                platform(boms.guava),\n-                platform(boms.protobuf),\n-                platform(boms.zipkin_reporter)\n+        configurations.all {\n+            if (it.name.endsWith('Classpath')) {\n+                add(it.name, platform(boms.grpc))\n+                add(it.name, platform(boms.guava))\n+                add(it.name, platform(boms.protobuf))\n+                add(it.name, platform(boms.zipkin_reporter))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f44a791bcb880081b28cd7378529cb408d991eba"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13b15a5614c1949f041819ee8942842380767640", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/13b15a5614c1949f041819ee8942842380767640", "committedDate": "2020-06-01T16:12:57Z", "message": "Apply platforms to resolved classpaths instead of dependency containers and have maven publication use resolution result for all variants."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "58f949615f952a1e6f5e72ef62117d5b907c4a11", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/58f949615f952a1e6f5e72ef62117d5b907c4a11", "committedDate": "2020-05-29T11:12:58Z", "message": "enforcedPlatform"}, "afterCommit": {"oid": "13b15a5614c1949f041819ee8942842380767640", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/13b15a5614c1949f041819ee8942842380767640", "committedDate": "2020-06-01T16:12:57Z", "message": "Apply platforms to resolved classpaths instead of dependency containers and have maven publication use resolution result for all variants."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d76cb5401bf0a70023f0b01c57d89a25e7064258", "author": {"user": {"login": "anuraaga", "name": "Anuraag Agrawal"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/d76cb5401bf0a70023f0b01c57d89a25e7064258", "committedDate": "2020-06-01T16:14:26Z", "message": "Revert unintended"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyMzU1OTcy", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#pullrequestreview-422355972", "createdAt": "2020-06-02T05:39:49Z", "commit": {"oid": "d76cb5401bf0a70023f0b01c57d89a25e7064258"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNDQ2NTM2", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#pullrequestreview-422446536", "createdAt": "2020-06-02T08:18:58Z", "commit": {"oid": "d76cb5401bf0a70023f0b01c57d89a25e7064258"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MDI0MDAz", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#pullrequestreview-429024003", "createdAt": "2020-06-11T15:24:21Z", "commit": {"oid": "d76cb5401bf0a70023f0b01c57d89a25e7064258"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MDM3MjYy", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1288#pullrequestreview-429037262", "createdAt": "2020-06-11T15:37:07Z", "commit": {"oid": "d76cb5401bf0a70023f0b01c57d89a25e7064258"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2815, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}