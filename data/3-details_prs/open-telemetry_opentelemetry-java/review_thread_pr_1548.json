{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5MzY1MTQ2", "number": 1548, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDoyNDo1MFrOEZaVLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDoyNToxMlrOEZaV2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MDgxMjYyOnYy", "diffSide": "RIGHT", "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "isResolved": false, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDoyNDo1MFrOHCNNGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNToxNjoyM1rOHCZb_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTU0NA==", "bodyText": "We should probably add a property with a CSV list of implementation class name to exclude to allow users to disable resources they don't want to include automatically.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472075544", "createdAt": "2020-08-18T10:24:50Z", "author": {"login": "anuraaga"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "diffHunk": "@@ -74,6 +75,14 @@ private static String readVersion() {\n     return properties.getProperty(\"sdk.version\");\n   }\n \n+  private static Resource readResourceFromProviders() {\n+    Resource result = Resource.EMPTY;\n+    for (ResourceProvider resourceProvider : ServiceLoader.load(ResourceProvider.class)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA4NzIxOQ==", "bodyText": "Cannot the same be achieved via controlling application classpath?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472087219", "createdAt": "2020-08-18T10:47:55Z", "author": {"login": "iNikem"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "diffHunk": "@@ -74,6 +75,14 @@ private static String readVersion() {\n     return properties.getProperty(\"sdk.version\");\n   }\n \n+  private static Resource readResourceFromProviders() {\n+    Resource result = Resource.EMPTY;\n+    for (ResourceProvider resourceProvider : ServiceLoader.load(ResourceProvider.class)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTU0NA=="}, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjEwMzM5Mw==", "bodyText": "If every resource provider is in a separate artifact I think so but will that be the case? Not sure - but I sort of figured that SDK will have one extension artifact with a few providers so disabling one of them only by classpath manipulation could be tough.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472103393", "createdAt": "2020-08-18T11:21:08Z", "author": {"login": "anuraaga"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "diffHunk": "@@ -74,6 +75,14 @@ private static String readVersion() {\n     return properties.getProperty(\"sdk.version\");\n   }\n \n+  private static Resource readResourceFromProviders() {\n+    Resource result = Resource.EMPTY;\n+    for (ResourceProvider resourceProvider : ServiceLoader.load(ResourceProvider.class)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTU0NA=="}, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjEyMjg5Mw==", "bodyText": "The only use-case for this that I currently know of is for auto-instrumentation to provide telemetry.auto.version. Which, btw, I wouldn't want end-users to disable :)", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472122893", "createdAt": "2020-08-18T11:57:55Z", "author": {"login": "iNikem"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "diffHunk": "@@ -74,6 +75,14 @@ private static String readVersion() {\n     return properties.getProperty(\"sdk.version\");\n   }\n \n+  private static Resource readResourceFromProviders() {\n+    Resource result = Resource.EMPTY;\n+    for (ResourceProvider resourceProvider : ServiceLoader.load(ResourceProvider.class)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTU0NA=="}, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjE0NDcxMQ==", "bodyText": "There are many resources we haven't implemented in Java yet, like docker container ID or process. I figure they should also be implemented with this SPI\nopen-telemetry/opentelemetry-specification#811 (comment)\nWe'll probably have a lot of these providers for full data coverage but for startup time or possible privacy reasons presumably they should be disablable and classpath probably won't be enough. In agent we would probably bundle everything and need a property anyways I think?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472144711", "createdAt": "2020-08-18T12:36:16Z", "author": {"login": "anuraaga"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "diffHunk": "@@ -74,6 +75,14 @@ private static String readVersion() {\n     return properties.getProperty(\"sdk.version\");\n   }\n \n+  private static Resource readResourceFromProviders() {\n+    Resource result = Resource.EMPTY;\n+    for (ResourceProvider resourceProvider : ServiceLoader.load(ResourceProvider.class)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTU0NA=="}, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjIwNDQ4NQ==", "bodyText": "Ok, fair enough.\n\nShould I do this in this very same PR?\nShould new config property go to TraceConfig?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472204485", "createdAt": "2020-08-18T13:39:32Z", "author": {"login": "iNikem"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "diffHunk": "@@ -74,6 +75,14 @@ private static String readVersion() {\n     return properties.getProperty(\"sdk.version\");\n   }\n \n+  private static Resource readResourceFromProviders() {\n+    Resource result = Resource.EMPTY;\n+    for (ResourceProvider resourceProvider : ServiceLoader.load(ResourceProvider.class)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTU0NA=="}, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjIxNTEwNA==", "bodyText": "Think follow-up PR is fine.\nProbably not TraceConfig - we'd have to stop using the static instance, and I guess this doesn't need to be programmatic (can just programmatically set Resource instead) so it's only for control from command line.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472215104", "createdAt": "2020-08-18T13:54:26Z", "author": {"login": "anuraaga"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "diffHunk": "@@ -74,6 +75,14 @@ private static String readVersion() {\n     return properties.getProperty(\"sdk.version\");\n   }\n \n+  private static Resource readResourceFromProviders() {\n+    Resource result = Resource.EMPTY;\n+    for (ResourceProvider resourceProvider : ServiceLoader.load(ResourceProvider.class)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTU0NA=="}, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI3NTk2NA==", "bodyText": "Added #1551", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472275964", "createdAt": "2020-08-18T15:16:23Z", "author": {"login": "iNikem"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/Resource.java", "diffHunk": "@@ -74,6 +75,14 @@ private static String readVersion() {\n     return properties.getProperty(\"sdk.version\");\n   }\n \n+  private static Resource readResourceFromProviders() {\n+    Resource result = Resource.EMPTY;\n+    for (ResourceProvider resourceProvider : ServiceLoader.load(ResourceProvider.class)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTU0NA=="}, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MDgxNDMyOnYy", "diffSide": "RIGHT", "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/ResourceProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDoyNToxMlrOHCNOCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDozMTowNFrOHCNZPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTc4Nw==", "bodyText": "Attributes is immutable guess you don't need to copy?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472075787", "createdAt": "2020-08-18T10:25:12Z", "author": {"login": "anuraaga"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/ResourceProvider.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package io.opentelemetry.sdk.resources;\n+\n+import io.opentelemetry.common.AttributeValue;\n+import io.opentelemetry.common.Attributes;\n+import io.opentelemetry.common.ReadableKeyValuePairs.KeyValueConsumer;\n+import javax.annotation.concurrent.ThreadSafe;\n+\n+/**\n+ * ResourceProvider is a service provider for additional {@link Resource}s.\n+ * Users of OpenTelemetry SDK can use it to add custom {@link Resource} attributes.\n+ *\n+ * <p>Fully qualified class name of the implementation should be registered in {@code\n+ * META-INF/services/io.opentelemetry.sdk.resources.ResourceProvider}.\n+ *\n+ * <p>Resources specified via system properties or environment variables will take precedence\n+ * over any value supplied via {@code ResourceProvider}.\n+ *\n+ * @see EnvAutodetectResource\n+ */\n+@ThreadSafe\n+public abstract class ResourceProvider {\n+\n+  public Resource create() {\n+    final Attributes.Builder attrBuilder = Attributes.newBuilder();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3ODY1NA==", "bodyText": "oi, indeed", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1548#discussion_r472078654", "createdAt": "2020-08-18T10:31:04Z", "author": {"login": "iNikem"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/resources/ResourceProvider.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package io.opentelemetry.sdk.resources;\n+\n+import io.opentelemetry.common.AttributeValue;\n+import io.opentelemetry.common.Attributes;\n+import io.opentelemetry.common.ReadableKeyValuePairs.KeyValueConsumer;\n+import javax.annotation.concurrent.ThreadSafe;\n+\n+/**\n+ * ResourceProvider is a service provider for additional {@link Resource}s.\n+ * Users of OpenTelemetry SDK can use it to add custom {@link Resource} attributes.\n+ *\n+ * <p>Fully qualified class name of the implementation should be registered in {@code\n+ * META-INF/services/io.opentelemetry.sdk.resources.ResourceProvider}.\n+ *\n+ * <p>Resources specified via system properties or environment variables will take precedence\n+ * over any value supplied via {@code ResourceProvider}.\n+ *\n+ * @see EnvAutodetectResource\n+ */\n+@ThreadSafe\n+public abstract class ResourceProvider {\n+\n+  public Resource create() {\n+    final Attributes.Builder attrBuilder = Attributes.newBuilder();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA3NTc4Nw=="}, "originalCommit": {"oid": "15f7d1af43e25d018c5466d8984c04faa8be76d5"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1347, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}