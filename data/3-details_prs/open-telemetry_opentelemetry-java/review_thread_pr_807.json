{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4OTI1MTM4", "number": 807, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMDo0MTo0MlrODb3pSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxMzozOToyM1rODoVgRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNTQ5ODMyOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMDo0MTo0MlrOFjmhIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjo0MzozOVrOFjx_mA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjg3NTU1NQ==", "bodyText": "This will throw if null is passed, same for double and long below.\nAttempts to set null (array) attributes should be silently ignored as decided in #765.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r372875555", "createdAt": "2020-01-30T10:41:42Z", "author": {"login": "arminru"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {\n+      return new AutoValue_AttributeValue_AttributeValueStringArray(Arrays.asList(stringValues));\n+    }\n+\n+    @Override\n+    public final Type getType() {\n+      return Type.STRING_ARRAY;\n+    }\n+\n+    @Override\n+    public abstract List<String> getStringArrayValue();\n+  }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueBooleanArray extends AttributeValue {\n+\n+    AttributeValueBooleanArray() {}\n+\n+    static AttributeValue create(boolean... booleanValues) {\n+      List<Boolean> values = new ArrayList<>(booleanValues.length);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 160}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAwMTU1MA==", "bodyText": "Thanks for fixing the calls coming from RecordEventsReadableSpan in the SDK!\nSince this is in the API, I'd add that null must not be passed to AttributeValue's apidoc and probably annotate the params with @NotNull.\nHere in this code you should still handle it gracefully in order to not crash if it's misused by returning an AttributeValueBooleanArray holding a value of null like AttributeValueString.create(null) does.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373001550", "createdAt": "2020-01-30T15:03:32Z", "author": {"login": "arminru"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {\n+      return new AutoValue_AttributeValue_AttributeValueStringArray(Arrays.asList(stringValues));\n+    }\n+\n+    @Override\n+    public final Type getType() {\n+      return Type.STRING_ARRAY;\n+    }\n+\n+    @Override\n+    public abstract List<String> getStringArrayValue();\n+  }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueBooleanArray extends AttributeValue {\n+\n+    AttributeValueBooleanArray() {}\n+\n+    static AttributeValue create(boolean... booleanValues) {\n+      List<Boolean> values = new ArrayList<>(booleanValues.length);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjg3NTU1NQ=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 160}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAwODI1OQ==", "bodyText": "I would argue to annotate the Javadoc with @throws NullPointerException as it is currently for the AttributeValue.stringAttributeValue(String) method. WDYT?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373008259", "createdAt": "2020-01-30T15:14:19Z", "author": {"login": "thisthat"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {\n+      return new AutoValue_AttributeValue_AttributeValueStringArray(Arrays.asList(stringValues));\n+    }\n+\n+    @Override\n+    public final Type getType() {\n+      return Type.STRING_ARRAY;\n+    }\n+\n+    @Override\n+    public abstract List<String> getStringArrayValue();\n+  }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueBooleanArray extends AttributeValue {\n+\n+    AttributeValueBooleanArray() {}\n+\n+    static AttributeValue create(boolean... booleanValues) {\n+      List<Boolean> values = new ArrayList<>(booleanValues.length);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjg3NTU1NQ=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 160}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyNjQyMA==", "bodyText": "Oh, that annotation is actually wrong since it doesn't throw --> #808\nRegarding error handling, the spec defines:\n\nAPI methods MUST NOT throw unhandled exceptions when used incorrectly by end users. The API and SDK SHOULD provide safe defaults for missing or invalid arguments. For instance, a name like empty may be used if the user passes in null as the span name argument during Span construction.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373026420", "createdAt": "2020-01-30T15:43:05Z", "author": {"login": "arminru"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {\n+      return new AutoValue_AttributeValue_AttributeValueStringArray(Arrays.asList(stringValues));\n+    }\n+\n+    @Override\n+    public final Type getType() {\n+      return Type.STRING_ARRAY;\n+    }\n+\n+    @Override\n+    public abstract List<String> getStringArrayValue();\n+  }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueBooleanArray extends AttributeValue {\n+\n+    AttributeValueBooleanArray() {}\n+\n+    static AttributeValue create(boolean... booleanValues) {\n+      List<Boolean> values = new ArrayList<>(booleanValues.length);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjg3NTU1NQ=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 160}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA1Nzc4NA==", "bodyText": "Ugh. I don't think the SDK should be doing anything like that. That's definitely an exporter responsibility, not the SDK itself.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373057784", "createdAt": "2020-01-30T16:33:26Z", "author": {"login": "jkwatson"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {\n+      return new AutoValue_AttributeValue_AttributeValueStringArray(Arrays.asList(stringValues));\n+    }\n+\n+    @Override\n+    public final Type getType() {\n+      return Type.STRING_ARRAY;\n+    }\n+\n+    @Override\n+    public abstract List<String> getStringArrayValue();\n+  }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueBooleanArray extends AttributeValue {\n+\n+    AttributeValueBooleanArray() {}\n+\n+    static AttributeValue create(boolean... booleanValues) {\n+      List<Boolean> values = new ArrayList<>(booleanValues.length);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjg3NTU1NQ=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 160}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA2MzU3Ng==", "bodyText": "Well, the exporter could also drop null-strings \ud83d\ude09", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373063576", "createdAt": "2020-01-30T16:43:39Z", "author": {"login": "Oberon00"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {\n+      return new AutoValue_AttributeValue_AttributeValueStringArray(Arrays.asList(stringValues));\n+    }\n+\n+    @Override\n+    public final Type getType() {\n+      return Type.STRING_ARRAY;\n+    }\n+\n+    @Override\n+    public abstract List<String> getStringArrayValue();\n+  }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueBooleanArray extends AttributeValue {\n+\n+    AttributeValueBooleanArray() {}\n+\n+    static AttributeValue create(boolean... booleanValues) {\n+      List<Boolean> values = new ArrayList<>(booleanValues.length);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjg3NTU1NQ=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 160}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNTUwNzI3OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/io/opentelemetry/trace/DefaultSpan.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMDo0NDozNFrOFjmmbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMDo0NDozNFrOFjmmbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjg3NjkwOQ==", "bodyText": "Please add tests in DefaultSpanTest.doNotCrash for passing (String[]) null and so on.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r372876909", "createdAt": "2020-01-30T10:44:34Z", "author": {"login": "arminru"}, "path": "api/src/main/java/io/opentelemetry/trace/DefaultSpan.java", "diffHunk": "@@ -91,6 +91,26 @@ public void setAttribute(String key, boolean value) {\n     Utils.checkNotNull(key, \"key\");\n   }\n \n+  @Override\n+  public void setAttribute(String key, String... values) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNTUzNTg2OnYy", "diffSide": "RIGHT", "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/RecordEventsReadableSpan.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMDo1NDowOVrOFjm4WQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMDo1NDowOVrOFjm4WQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjg4MTQ5Nw==", "bodyText": "Please add tests in RecordEventsReadableSpanTest.setAttribute.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r372881497", "createdAt": "2020-01-30T10:54:09Z", "author": {"login": "arminru"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/RecordEventsReadableSpan.java", "diffHunk": "@@ -314,6 +314,26 @@ public void setAttribute(String key, boolean value) {\n     setAttribute(key, AttributeValue.booleanAttributeValue(value));\n   }\n \n+  @Override\n+  public void setAttribute(String key, String... values) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNTY3NzgyOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxMTo0NDoyM1rOFjoL7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNzoxMjozNFrOFwn3Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkwMjg5NA==", "bodyText": "Also, what should happen if null or empty strings are passed inside the array? I'm strongly against dropping them silently as done with #771 for single strings, as this would preclude use cases such as having corresponding key and value arrays where value_array[i] is the value for key_array[i].", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r372902894", "createdAt": "2020-01-30T11:44:23Z", "author": {"login": "Oberon00"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mjk1MjMyNA==", "bodyText": "The current implementation does not ignore null or empty strings inside the array and inserts them into the list of values for the given key.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r372952324", "createdAt": "2020-01-30T13:40:36Z", "author": {"login": "thisthat"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkwMjg5NA=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzEzMzM2NQ==", "bodyText": "I'd be up with @Oberon00's suggestion on at least not allowing null values pass through (this check would also have to apply to the other array values).", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373133365", "createdAt": "2020-01-30T18:59:37Z", "author": {"login": "carlosalberto"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkwMjg5NA=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM3NTUzMQ==", "bodyText": "@carlosalberto I'm not sure that's the same thing I meant. What do you mean by not letting them pass through? I don't think that is necessarily the best idea but I'd still prefer it over dropping them. Maybe we should make them into empty strings?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373375531", "createdAt": "2020-01-31T09:03:33Z", "author": {"login": "Oberon00"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkwMjg5NA=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQxNDkzMA==", "bodyText": "@Oberon00  Either way, I want us to be clear on the expectations, one way or another. I personally think it would be very dirty/lazy to let go through null values in the arrays - but if we decide another way, I'm fine as long as we document it.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373414930", "createdAt": "2020-01-31T10:36:41Z", "author": {"login": "carlosalberto"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkwMjg5NA=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQxNzUzMg==", "bodyText": "So what is the alternative if we don't let them go through, what do we do if we encounter one?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373417532", "createdAt": "2020-01-31T10:42:47Z", "author": {"login": "Oberon00"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkwMjg5NA=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQzNjQ4MA==", "bodyText": "I put this topic in the SIG notes for today, so we can have the feedback of the others", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373436480", "createdAt": "2020-01-31T11:31:10Z", "author": {"login": "thisthat"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkwMjg5NA=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUyOTA4Mg==", "bodyText": "@thisthat Maybe resolve this comment? IIRC this was resolved in a previous SIG call.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r386529082", "createdAt": "2020-03-02T17:12:34Z", "author": {"login": "carlosalberto"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +320,92 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjkwMjg5NA=="}, "originalCommit": {"oid": "f38eb5779769ec9afbe42d42b2a819357c5944f0"}, "originalPosition": 140}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjk3NTY3OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxODoxMDowMVrOFj0vqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxODoxMDowMVrOFj0vqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzEwODY0OQ==", "bodyText": "Make them immutable?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373108649", "createdAt": "2020-01-30T18:10:01Z", "author": {"login": "bogdandrutu"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -221,4 +321,107 @@ public final Type getType() {\n     @Override\n     public abstract double getDoubleValue();\n   }\n+\n+  @Immutable\n+  @AutoValue\n+  abstract static class AttributeValueStringArray extends AttributeValue {\n+\n+    AttributeValueStringArray() {}\n+\n+    static AttributeValue create(String... stringValues) {\n+      if (stringValues == null) {\n+        return new AutoValue_AttributeValue_AttributeValueStringArray(\n+            Collections.<String>emptyList());\n+      }\n+      return new AutoValue_AttributeValue_AttributeValueStringArray(Arrays.asList(stringValues));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95ab9a0bf80518bfd709e10a4fc0c5ff26b4e9eb"}, "originalPosition": 146}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjk4NDM5OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/io/opentelemetry/trace/Span.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxODoxMzowOVrOFj01Zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxOTowNToxMlrOFj2cRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzExMDExOQ==", "bodyText": "I wouldn't add this to the Span Api to keep the surface low. I would rely on the version with AttributeValue for this usecase.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373110119", "createdAt": "2020-01-30T18:13:09Z", "author": {"login": "bogdandrutu"}, "path": "api/src/main/java/io/opentelemetry/trace/Span.java", "diffHunk": "@@ -122,6 +122,49 @@\n    */\n   void setAttribute(String key, boolean value);\n \n+  /**\n+   * Sets an attribute to the {@code Span}. If the {@code Span} previously contained a mapping for\n+   * the key, the old value is replaced by the specified value.\n+   *\n+   * <p>If a null or empty String {@code value} is passed in, the attribute will be silently\n+   * dropped. Note: this behavior could change in the future.\n+   *\n+   * @param key the key for this attribute.\n+   * @param values the value for this attribute.\n+   * @since 0.1.0\n+   */\n+  void setAttribute(String key, String... values);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95ab9a0bf80518bfd709e10a4fc0c5ff26b4e9eb"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzEzNjQ1Mw==", "bodyText": "I agree with this. Let's try to keep the Span surface whenever possible.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r373136453", "createdAt": "2020-01-30T19:05:12Z", "author": {"login": "carlosalberto"}, "path": "api/src/main/java/io/opentelemetry/trace/Span.java", "diffHunk": "@@ -122,6 +122,49 @@\n    */\n   void setAttribute(String key, boolean value);\n \n+  /**\n+   * Sets an attribute to the {@code Span}. If the {@code Span} previously contained a mapping for\n+   * the key, the old value is replaced by the specified value.\n+   *\n+   * <p>If a null or empty String {@code value} is passed in, the attribute will be silently\n+   * dropped. Note: this behavior could change in the future.\n+   *\n+   * @param key the key for this attribute.\n+   * @param values the value for this attribute.\n+   * @since 0.1.0\n+   */\n+  void setAttribute(String key, String... values);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzExMDExOQ=="}, "originalCommit": {"oid": "95ab9a0bf80518bfd709e10a4fc0c5ff26b4e9eb"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4ODU1Mjg5OnYy", "diffSide": "RIGHT", "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/RecordEventsReadableSpan.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMjowMDo1NVrOFvyuZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMjowMDo1NVrOFvyuZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY1ODQ3MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (value.getStringArrayValue().size() == 0) {\n          \n          \n            \n                    if (value.getStringArrayValue().isEmpty()) {\n          \n      \n    \n    \n  \n\nSubject to #948.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r385658471", "createdAt": "2020-02-28T12:00:55Z", "author": {"login": "Oberon00"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/RecordEventsReadableSpan.java", "diffHunk": "@@ -318,8 +317,34 @@ public void setAttribute(String key, boolean value) {\n   public void setAttribute(String key, AttributeValue value) {\n     Preconditions.checkNotNull(key, \"key\");\n     Preconditions.checkNotNull(value, \"value\");\n-    if (value.getType() == Type.STRING && StringUtils.isNullOrEmpty(value.getStringValue())) {\n-      return;\n+    switch (value.getType()) {\n+      case STRING:\n+        if (StringUtils.isNullOrEmpty(value.getStringValue())) {\n+          return;\n+        }\n+        break;\n+      case STRING_ARRAY:\n+        if (value.getStringArrayValue().size() == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dfd8b2768c072c91a2a6f2a0566e4d3c9a9161d"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4ODU1NDkzOnYy", "diffSide": "RIGHT", "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/RecordEventsReadableSpan.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMjowMTo0NVrOFvyvlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMDowNjo0NVrOFwZ0TQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY1ODc3NA==", "bodyText": "Is this required?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r385658774", "createdAt": "2020-02-28T12:01:45Z", "author": {"login": "Oberon00"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/RecordEventsReadableSpan.java", "diffHunk": "@@ -318,8 +317,34 @@ public void setAttribute(String key, boolean value) {\n   public void setAttribute(String key, AttributeValue value) {\n     Preconditions.checkNotNull(key, \"key\");\n     Preconditions.checkNotNull(value, \"value\");\n-    if (value.getType() == Type.STRING && StringUtils.isNullOrEmpty(value.getStringValue())) {\n-      return;\n+    switch (value.getType()) {\n+      case STRING:\n+        if (StringUtils.isNullOrEmpty(value.getStringValue())) {\n+          return;\n+        }\n+        break;\n+      case STRING_ARRAY:\n+        if (value.getStringArrayValue().size() == 0) {\n+          return;\n+        }\n+        break;\n+      case BOOLEAN_ARRAY:\n+        if (value.getBooleanArrayValue().size() == 0) {\n+          return;\n+        }\n+        break;\n+      case LONG_ARRAY:\n+        if (value.getLongArrayValue().size() == 0) {\n+          return;\n+        }\n+        break;\n+      case DOUBLE_ARRAY:\n+        if (value.getDoubleArrayValue().size() == 0) {\n+          return;\n+        }\n+        break;\n+      default:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dfd8b2768c072c91a2a6f2a0566e4d3c9a9161d"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjI5ODk1Nw==", "bodyText": "Yes, otherwise the checkstyle plugin will fail the build", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r386298957", "createdAt": "2020-03-02T10:06:45Z", "author": {"login": "thisthat"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/RecordEventsReadableSpan.java", "diffHunk": "@@ -318,8 +317,34 @@ public void setAttribute(String key, boolean value) {\n   public void setAttribute(String key, AttributeValue value) {\n     Preconditions.checkNotNull(key, \"key\");\n     Preconditions.checkNotNull(value, \"value\");\n-    if (value.getType() == Type.STRING && StringUtils.isNullOrEmpty(value.getStringValue())) {\n-      return;\n+    switch (value.getType()) {\n+      case STRING:\n+        if (StringUtils.isNullOrEmpty(value.getStringValue())) {\n+          return;\n+        }\n+        break;\n+      case STRING_ARRAY:\n+        if (value.getStringArrayValue().size() == 0) {\n+          return;\n+        }\n+        break;\n+      case BOOLEAN_ARRAY:\n+        if (value.getBooleanArrayValue().size() == 0) {\n+          return;\n+        }\n+        break;\n+      case LONG_ARRAY:\n+        if (value.getLongArrayValue().size() == 0) {\n+          return;\n+        }\n+        break;\n+      case DOUBLE_ARRAY:\n+        if (value.getDoubleArrayValue().size() == 0) {\n+          return;\n+        }\n+        break;\n+      default:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY1ODc3NA=="}, "originalCommit": {"oid": "4dfd8b2768c072c91a2a6f2a0566e4d3c9a9161d"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTg2NTMxOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxODo0ODoxMVrOFv_JMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNzoyNTowOFrOFwoRDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg2MTkzNw==", "bodyText": "Since API calls are not supposed to throw exceptions, should we instead just return an empty List for these cases? I'm not sure of what the right behavior is.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r385861937", "createdAt": "2020-02-28T18:48:11Z", "author": {"login": "jkwatson"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -136,6 +188,54 @@ public double getDoubleValue() {\n         String.format(\"This type can only return %s data\", getType().name()));\n   }\n \n+  /**\n+   * Returns the String array value of this {@code AttributeValue}. An UnsupportedOperationException\n+   * will be thrown if getType() is not {@link Type#STRING_ARRAY}.\n+   *\n+   * @return the array values of this {@code AttributeValue}.\n+   * @since 0.3.0\n+   */\n+  public List<String> getStringArrayValue() {\n+    throw new UnsupportedOperationException(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4dfd8b2768c072c91a2a6f2a0566e4d3c9a9161d"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjI3NjEzNA==", "bodyText": "Also basic types return an exception...\nMy proposal is to left as is. In a further follow up PR that addresses the renaming of the AttributeValue class (context), we should rethink the APIs.\nWDYT?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r386276134", "createdAt": "2020-03-02T09:24:43Z", "author": {"login": "thisthat"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -136,6 +188,54 @@ public double getDoubleValue() {\n         String.format(\"This type can only return %s data\", getType().name()));\n   }\n \n+  /**\n+   * Returns the String array value of this {@code AttributeValue}. An UnsupportedOperationException\n+   * will be thrown if getType() is not {@link Type#STRING_ARRAY}.\n+   *\n+   * @return the array values of this {@code AttributeValue}.\n+   * @since 0.3.0\n+   */\n+  public List<String> getStringArrayValue() {\n+    throw new UnsupportedOperationException(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg2MTkzNw=="}, "originalCommit": {"oid": "4dfd8b2768c072c91a2a6f2a0566e4d3c9a9161d"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQzMTMyOQ==", "bodyText": "Btw, these ones are meant to throw exceptions, by design - user is expected, upon getting an attr, to do a check like this:\nswitch (attr.getType()) {\n  case STRING:\n    return attr.getStringValue();\n  case LONG:\n    return attr.getLongValue();\n}", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r386431329", "createdAt": "2020-03-02T14:40:50Z", "author": {"login": "carlosalberto"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -136,6 +188,54 @@ public double getDoubleValue() {\n         String.format(\"This type can only return %s data\", getType().name()));\n   }\n \n+  /**\n+   * Returns the String array value of this {@code AttributeValue}. An UnsupportedOperationException\n+   * will be thrown if getType() is not {@link Type#STRING_ARRAY}.\n+   *\n+   * @return the array values of this {@code AttributeValue}.\n+   * @since 0.3.0\n+   */\n+  public List<String> getStringArrayValue() {\n+    throw new UnsupportedOperationException(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg2MTkzNw=="}, "originalCommit": {"oid": "4dfd8b2768c072c91a2a6f2a0566e4d3c9a9161d"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUzNTY5NA==", "bodyText": "as long as we're consistent, then \ud83d\udc4d", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r386535694", "createdAt": "2020-03-02T17:25:08Z", "author": {"login": "jkwatson"}, "path": "api/src/main/java/io/opentelemetry/trace/AttributeValue.java", "diffHunk": "@@ -136,6 +188,54 @@ public double getDoubleValue() {\n         String.format(\"This type can only return %s data\", getType().name()));\n   }\n \n+  /**\n+   * Returns the String array value of this {@code AttributeValue}. An UnsupportedOperationException\n+   * will be thrown if getType() is not {@link Type#STRING_ARRAY}.\n+   *\n+   * @return the array values of this {@code AttributeValue}.\n+   * @since 0.3.0\n+   */\n+  public List<String> getStringArrayValue() {\n+    throw new UnsupportedOperationException(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTg2MTkzNw=="}, "originalCommit": {"oid": "4dfd8b2768c072c91a2a6f2a0566e4d3c9a9161d"}, "originalPosition": 87}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNjIxOTU5OnYy", "diffSide": "RIGHT", "path": "exporters/otlp/src/main/java/io/opentelemetry/exporters/otlp/CommonAdapter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxMzozOToyM1rOF20j5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxMzozOToyM1rOF20j5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzAyODU4MQ==", "bodyText": "#1020", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/807#discussion_r393028581", "createdAt": "2020-03-16T13:39:23Z", "author": {"login": "thisthat"}, "path": "exporters/otlp/src/main/java/io/opentelemetry/exporters/otlp/CommonAdapter.java", "diffHunk": "@@ -43,6 +43,11 @@ static AttributeKeyValue toProtoAttribute(String key, AttributeValue attributeVa\n             .setType(ValueType.DOUBLE)\n             .setDoubleValue(attributeValue.getDoubleValue())\n             .build();\n+      case BOOLEAN_ARRAY:\n+      case LONG_ARRAY:\n+      case DOUBLE_ARRAY:\n+      case STRING_ARRAY:\n+        return builder.setType(ValueType.UNRECOGNIZED).build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9ff82c107d3903828f601abad71df34b3b95405"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1056, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}