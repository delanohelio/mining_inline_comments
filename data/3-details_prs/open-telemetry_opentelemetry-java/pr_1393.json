{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzMjk3MTYw", "number": 1393, "title": "Added InMemoryMetricExporter", "bodyText": "Fixes #1360\nImplemented InMemoryMetricExporter similar to InMemorySpanExporter and also added InMemoryMetricExporterTest for testing InMemoryMetricExporter. Used LinkedBlockingQueue for maintaining inmemory MetricData and avoiding manual locks for synchronization.", "createdAt": "2020-07-02T06:09:55Z", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393", "merged": true, "mergeCommit": {"oid": "a59748a904e0cb1e2e4f8df50dd346a82f26ff1e"}, "closed": true, "closedAt": "2020-07-04T21:52:14Z", "author": {"login": "neeraj97"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcw4aM6gH2gAyNDQzMjk3MTYwOmY4NWRlMDI5MzEyZWRiYmY1ODMyZmYzYTZjMTY1NTMxOGVlOWY5NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxD5xFgFqTQ0MTk2MjU4NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f85de029312edbbf5832ff3a6c1655318ee9f954", "author": {"user": {"login": "neeraj97", "name": "Neeraj"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/f85de029312edbbf5832ff3a6c1655318ee9f954", "committedDate": "2020-07-02T05:57:45Z", "message": "Added InMemoryMetricExporter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMzgzNjk4", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#pullrequestreview-441383698", "createdAt": "2020-07-02T06:30:40Z", "commit": {"oid": "f85de029312edbbf5832ff3a6c1655318ee9f954"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwNjozMDo0MFrOGr_IiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwNjozMzoxMFrOGr_MVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3NjMyOA==", "bodyText": "Please, add the copyright", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#discussion_r448776328", "createdAt": "2020-07-02T06:30:40Z", "author": {"login": "thisthat"}, "path": "exporters/inmemory/src/main/java/io/opentelemetry/exporters/inmemory/InMemoryMetricExporter.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package io.opentelemetry.exporters.inmemory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85de029312edbbf5832ff3a6c1655318ee9f954"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3NjQyNQ==", "bodyText": "Also here the copyright header is missing", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#discussion_r448776425", "createdAt": "2020-07-02T06:30:57Z", "author": {"login": "thisthat"}, "path": "exporters/inmemory/src/test/java/io/opentelemetry/exporters/inmemory/InMemoryMetricExporterTest.java", "diffHunk": "@@ -0,0 +1,100 @@\n+package io.opentelemetry.exporters.inmemory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85de029312edbbf5832ff3a6c1655318ee9f954"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc3NzMwMg==", "bodyText": "Please, add some code in the Javadoc to show the usage of this exporter", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#discussion_r448777302", "createdAt": "2020-07-02T06:33:10Z", "author": {"login": "thisthat"}, "path": "exporters/inmemory/src/main/java/io/opentelemetry/exporters/inmemory/InMemoryMetricExporter.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package io.opentelemetry.exporters.inmemory;\n+\n+import io.opentelemetry.sdk.metrics.data.MetricData;\n+import io.opentelemetry.sdk.metrics.export.MetricExporter;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Queue;\n+import java.util.concurrent.LinkedBlockingQueue;\n+\n+/**\n+ * A {@link MetricExporter} implementation that can be used to test OpenTelemetry integration.\n+ */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f85de029312edbbf5832ff3a6c1655318ee9f954"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e61b37b0ba1ed575b4705c69970eae71a540c8e3", "author": {"user": {"login": "neeraj97", "name": "Neeraj"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/e61b37b0ba1ed575b4705c69970eae71a540c8e3", "committedDate": "2020-07-02T08:42:11Z", "message": "Added Javadoc and copyrights to InMemoryMetricExporter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxNDc2NzAw", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#pullrequestreview-441476700", "createdAt": "2020-07-02T08:48:48Z", "commit": {"oid": "e61b37b0ba1ed575b4705c69970eae71a540c8e3"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwODo0ODo0OFrOGsDg-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwODo1MzoyMlrOGsDsJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg0ODEyMg==", "bodyText": "nit: 2020", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#discussion_r448848122", "createdAt": "2020-07-02T08:48:48Z", "author": {"login": "thisthat"}, "path": "exporters/inmemory/src/main/java/io/opentelemetry/exporters/inmemory/InMemoryMetricExporter.java", "diffHunk": "@@ -1,3 +1,19 @@\n+/*\n+ * Copyright 2019, OpenTelemetry Authors", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e61b37b0ba1ed575b4705c69970eae71a540c8e3"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg0ODgzNQ==", "bodyText": "nit: 2020", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#discussion_r448848835", "createdAt": "2020-07-02T08:50:02Z", "author": {"login": "thisthat"}, "path": "exporters/inmemory/src/test/java/io/opentelemetry/exporters/inmemory/InMemoryMetricExporterTest.java", "diffHunk": "@@ -1,5 +1,23 @@\n+/*\n+ * Copyright 2019, OpenTelemetry Authors", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e61b37b0ba1ed575b4705c69970eae71a540c8e3"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODg1MDk4Mw==", "bodyText": "I would just inline all methods, but setup() and use a single meter. The idea is to have just a minimal example to showcase the usage.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#discussion_r448850983", "createdAt": "2020-07-02T08:53:22Z", "author": {"login": "thisthat"}, "path": "exporters/inmemory/src/main/java/io/opentelemetry/exporters/inmemory/InMemoryMetricExporter.java", "diffHunk": "@@ -11,11 +27,68 @@\n \n /**\n  * A {@link MetricExporter} implementation that can be used to test OpenTelemetry integration.\n+ *\n+ * <p>Can be created using {@code InMemoryMetricExporter.create()}\n+ *\n+ * <p>Example usage:\n+ *\n+ * <pre><code>\n+ * public class InMemoryMetricExporterExample {\n+ *\n+ *   // creating InMemoryMetricExporter\n+ *   private final InMemoryMetricExporter exporter = InMemoryMetricExporter.create();\n+ *   private final MeterSdkProvider meterSdkProvider = OpenTelemetrySdk.getMeterProvider();\n+ *   private final Meter meter = meterSdkProvider.get(\"InMemoryMetricExporterExample\");\n+ *   private IntervalMetricReader intervalMetricReader;\n+ *\n+ *   void setup() {\n+ *     intervalMetricReader =\n+ *         IntervalMetricReader.builder()\n+ *             .setMetricExporter(exporter)\n+ *             .setMetricProducers(Collections.singletonList(meterSdkProvider.getMetricProducer()))\n+ *             .setExportIntervalMillis(1000)\n+ *             .build();\n+ *   }\n+ *\n+ *   List&lt;MetricData&gt; readExportedMetrics() {\n+ *     return exporter.getFinishedMetricItems();\n+ *   }\n+ *\n+ *   void shutdown() {\n+ *     intervalMetricReader.shutdown();\n+ *   }\n+ *\n+ *   LongCounter generateLongMeter(String name) {\n+ *     return meter.longCounterBuilder(name).setDescription(\"Sample LongCounter\").build();\n+ *   }\n+ *\n+ *   DoubleCounter generateDoubleMeter(String name) {\n+ *     return meter.doubleCounterBuilder(name).setDescription(\"Sample DoubleCounter\").build();\n+ *   }\n+ *\n+ *\n+ *   public static void main(String[] args) throws InterruptedException {\n+ *     InMemoryMetricExporterExample example = new InMemoryMetricExporterExample();\n+ *\n+ *     example.setup();\n+ *     example.generateLongMeter(\"counter-1\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e61b37b0ba1ed575b4705c69970eae71a540c8e3"}, "originalPosition": 68}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "141083a6c949fd26936e3ef379e09cd681a1501f", "author": {"user": {"login": "neeraj97", "name": "Neeraj"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/141083a6c949fd26936e3ef379e09cd681a1501f", "committedDate": "2020-07-02T10:19:19Z", "message": "Edited Javadoc and copyright info in InMemoryMetricExporter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxOTYyNTg0", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1393#pullrequestreview-441962584", "createdAt": "2020-07-02T19:21:11Z", "commit": {"oid": "141083a6c949fd26936e3ef379e09cd681a1501f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2524, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}