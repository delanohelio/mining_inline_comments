{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwNjE3NTI2", "number": 1256, "title": "Add public Samplers.emptyDecision(boolean) and decision(boolean, Map).", "bodyText": "This is meant for use by custom Sampler implementations. As of now, you have to use an anonymous inner class or otherwise derive a new class because there is no publicly accessible implementation of Decision.", "createdAt": "2020-05-20T09:13:22Z", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256", "merged": true, "mergeCommit": {"oid": "f137182fe973a3c62c6c133e3bbed984f5547db9"}, "closed": true, "closedAt": "2020-05-28T04:01:10Z", "author": {"login": "Oberon00"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjFzckgFqTQxNTE2MjU5Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcldVH8AFqTQxOTQ4Njg2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTYyNTky", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256#pullrequestreview-415162592", "createdAt": "2020-05-20T09:39:09Z", "commit": {"oid": "e0a5d9485ea4f5f6bb39b4b237582f8c5a870c5b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOTozOTowOVrOGYDgGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOTozOTowOVrOGYDgGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg3NjM3OQ==", "bodyText": "I would expect custom Samplers to use something like:\nSamplers.alwaysOn/Off().shouldSample(...)\n\nso attributes can be set", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256#discussion_r427876379", "createdAt": "2020-05-20T09:39:09Z", "author": {"login": "thisthat"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/Samplers.java", "diffHunk": "@@ -51,6 +51,20 @@\n   // No instance of this class.\n   private Samplers() {}\n \n+  /**\n+   * Returns a {@link Decision} with empty attributes and {@link Decision#isSampled()} returning the\n+   * value of the parameter {@code isSampled}.\n+   *\n+   * <p>This is meant for use by custom {@link Sampler} implementations.\n+   *\n+   * @param isSampled The value to return from {@link Decision#isSampled()}.\n+   * @return A {@link Decision} with empty attributes and {@link Decision#isSampled()} returning the\n+   *     value of the parameter {@code isSampled}.\n+   */\n+  public static final Decision emptyDecision(boolean isSampled) {\n+    return isSampled ? ALWAYS_ON_DECISION : ALWAYS_OFF_DECISION;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0a5d9485ea4f5f6bb39b4b237582f8c5a870c5b"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e0a5d9485ea4f5f6bb39b4b237582f8c5a870c5b", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/e0a5d9485ea4f5f6bb39b4b237582f8c5a870c5b", "committedDate": "2020-05-20T09:13:04Z", "message": "Add public Samplers.emptyDecision(boolean).\n\nThis is meant for use by custom Sampler implementations. As of now, you have to use an anonymous inner class or otherwise derive a new class because there is no publicly accessible implementation of Decision."}, "afterCommit": {"oid": "4ace28be07e3c8c526b702b8cd69b3befd05bc44", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/4ace28be07e3c8c526b702b8cd69b3befd05bc44", "committedDate": "2020-05-25T08:41:20Z", "message": "Fix build, add unit test."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ace28be07e3c8c526b702b8cd69b3befd05bc44", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/4ace28be07e3c8c526b702b8cd69b3befd05bc44", "committedDate": "2020-05-25T08:41:20Z", "message": "Fix build, add unit test."}, "afterCommit": {"oid": "920064305c5eaadfd3b527bf298088525a93456a", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/920064305c5eaadfd3b527bf298088525a93456a", "committedDate": "2020-05-25T08:46:07Z", "message": "Fix build, add unit test."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3NzgzNjcw", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256#pullrequestreview-417783670", "createdAt": "2020-05-25T15:38:35Z", "commit": {"oid": "920064305c5eaadfd3b527bf298088525a93456a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3OTI4OTY2", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256#pullrequestreview-417928966", "createdAt": "2020-05-26T02:06:51Z", "commit": {"oid": "920064305c5eaadfd3b527bf298088525a93456a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwMjowNjo1MlrOGaMjkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwMjowNjo1MlrOGaMjkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDEyMTg3Mg==", "bodyText": "What about having just a decision(bool, map) and you would call that with a emptyMap?\npublic static final Decision decision(boolean isSampled, Map<String, AttributeValue> attributes) {\n  Objects.requireNotNull(attributes, \"attributes\");\n  if (attributes.isEmpty()) {\n    return isSampled ? EMPTY_SAMPLED_DECISION : EMPTY_NOT_SAMPLED_DECISION;\n  }\n  return DecisionImpl.create(isSampled, attributes);\n}", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256#discussion_r430121872", "createdAt": "2020-05-26T02:06:52Z", "author": {"login": "bogdandrutu"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/Samplers.java", "diffHunk": "@@ -63,6 +63,20 @@\n   // No instance of this class.\n   private Samplers() {}\n \n+  /**\n+   * Returns a {@link Decision} with empty attributes and {@link Decision#isSampled()} returning the\n+   * value of the parameter {@code isSampled}.\n+   *\n+   * <p>This is meant for use by custom {@link Sampler} implementations.\n+   *\n+   * @param isSampled The value to return from {@link Decision#isSampled()}.\n+   * @return A {@link Decision} with empty attributes and {@link Decision#isSampled()} returning the\n+   *     value of the parameter {@code isSampled}.\n+   */\n+  public static final Decision emptyDecision(boolean isSampled) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "920064305c5eaadfd3b527bf298088525a93456a"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "596bf995c877b1d0928c9580f2ea038b09ce22d2", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/596bf995c877b1d0928c9580f2ea038b09ce22d2", "committedDate": "2020-05-26T08:47:52Z", "message": "Add public Samplers.emptyDecision(boolean).\n\nThis is meant for use by custom Sampler implementations. As of now, you have to use an anonymous inner class or otherwise derive a new class because there is no publicly accessible implementation of Decision."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e71149967450ae448986c121022691fd9644c351", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/e71149967450ae448986c121022691fd9644c351", "committedDate": "2020-05-26T08:47:53Z", "message": "Fix build, add unit test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62173ad8cbba5b1c1f5cb4280104a0d914d67b60", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/62173ad8cbba5b1c1f5cb4280104a0d914d67b60", "committedDate": "2020-05-26T09:20:03Z", "message": "Add Samplers.decision(boolean, Map).\n\nCo-authored-by: Bogdan Drutu <bogdandrutu@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "920064305c5eaadfd3b527bf298088525a93456a", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/920064305c5eaadfd3b527bf298088525a93456a", "committedDate": "2020-05-25T08:46:07Z", "message": "Fix build, add unit test."}, "afterCommit": {"oid": "62173ad8cbba5b1c1f5cb4280104a0d914d67b60", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/62173ad8cbba5b1c1f5cb4280104a0d914d67b60", "committedDate": "2020-05-26T09:20:03Z", "message": "Add Samplers.decision(boolean, Map).\n\nCo-authored-by: Bogdan Drutu <bogdandrutu@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4NDU3NTIx", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256#pullrequestreview-418457521", "createdAt": "2020-05-26T16:11:41Z", "commit": {"oid": "62173ad8cbba5b1c1f5cb4280104a0d914d67b60"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxNjoxMTo0MVrOGalw1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxNjoxMTo0MVrOGalw1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDUzNDg2OA==", "bodyText": "Just having this note in here, rather than copying the attributes, feels too weak. If having the map be non-modified is truly a hard requirement, the API should protect itself, rather than relying on implementors to read this javadoc.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256#discussion_r430534868", "createdAt": "2020-05-26T16:11:41Z", "author": {"login": "jkwatson"}, "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/Samplers.java", "diffHunk": "@@ -63,6 +64,45 @@\n   // No instance of this class.\n   private Samplers() {}\n \n+  /**\n+   * Returns a {@link Decision} with the given {@code attributes} and {@link Decision#isSampled()}\n+   * returning {@code isSampled}.\n+   *\n+   * <p>This is meant for use by custom {@link Sampler} implementations.\n+   *\n+   * <p>Using {@link #emptyDecision(boolean)} instead of this method is slightly faster and shorter\n+   * if you don't need attributes.\n+   *\n+   * @param isSampled The value to return from {@link Decision#isSampled()}.\n+   * @param attributes The attributes to return from {@link Decision#getAttributes()}. A different\n+   *     object instance with the same elements may be returned. The map must not be modified after\n+   *     being passed to this function. Use {@link Collections#emptyMap()} for an empty decision.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62173ad8cbba5b1c1f5cb4280104a0d914d67b60"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de83c10f978d1cd283ef0342e75cf7426dbfa186", "author": {"user": {"login": "Oberon00", "name": "Christian Neum\u00fcller"}}, "url": "https://github.com/open-telemetry/opentelemetry-java/commit/de83c10f978d1cd283ef0342e75cf7426dbfa186", "committedDate": "2020-05-27T18:01:50Z", "message": "Copy decision attributes, fix comment."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NDg2ODY4", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1256#pullrequestreview-419486868", "createdAt": "2020-05-27T18:11:36Z", "commit": {"oid": "de83c10f978d1cd283ef0342e75cf7426dbfa186"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2758, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}