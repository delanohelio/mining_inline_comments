{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNTc0NTE2", "number": 1891, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1MzozMFrOEySieQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1MzozMFrOEySieQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxMTY3OTkzOnYy", "diffSide": "RIGHT", "path": "context/src/jmh/java/io/opentelemetry/context/ContextBenchmark.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMDo1MzozMFrOHo2C6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwMDowNjo1NlrOHpVWQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MDU3MQ==", "bodyText": "Would it a get to the middle element make sense?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1891#discussion_r512590571", "createdAt": "2020-10-27T10:53:30Z", "author": {"login": "thisthat"}, "path": "context/src/jmh/java/io/opentelemetry/context/ContextBenchmark.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package io.opentelemetry.context;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.concurrent.TimeUnit;\n+import org.openjdk.jmh.annotations.Benchmark;\n+import org.openjdk.jmh.annotations.Fork;\n+import org.openjdk.jmh.annotations.Measurement;\n+import org.openjdk.jmh.annotations.OutputTimeUnit;\n+import org.openjdk.jmh.annotations.Param;\n+import org.openjdk.jmh.annotations.Scope;\n+import org.openjdk.jmh.annotations.Setup;\n+import org.openjdk.jmh.annotations.State;\n+import org.openjdk.jmh.annotations.Threads;\n+import org.openjdk.jmh.annotations.Warmup;\n+import org.openjdk.jmh.infra.Blackhole;\n+\n+/** Benchmark for Context. */\n+@Threads(value = 1)\n+@Fork(3)\n+@Warmup(iterations = 10, time = 1)\n+@Measurement(iterations = 5, time = 1)\n+@OutputTimeUnit(TimeUnit.MILLISECONDS)\n+@State(Scope.Benchmark)\n+public class ContextBenchmark {\n+\n+  @Param({\"2\", \"3\", \"4\", \"5\", \"10\", \"20\", \"40\"})\n+  private int size;\n+\n+  private List<ContextKey<String>> keys;\n+  private Context context = Context.root();\n+\n+  @Setup\n+  public void setup() {\n+    keys = new ArrayList<>();\n+    for (int i = 0; i < size; i++) {\n+      ContextKey<String> key = ContextKey.named(Integer.toString(i));\n+      context = context.with(key, \"value\");\n+      keys.add(key);\n+    }\n+  }\n+\n+  /** Read value for first key. */\n+  @Benchmark\n+  public String readFirst() {\n+    return context.get(keys.get(0));\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7fbf21a95b53906830c15f337c3a5b5e7efd74e"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2MDQzNw==", "bodyText": "For trie getting any element should have almost the same impact.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1891#discussion_r512760437", "createdAt": "2020-10-27T14:52:27Z", "author": {"login": "bogdandrutu"}, "path": "context/src/jmh/java/io/opentelemetry/context/ContextBenchmark.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package io.opentelemetry.context;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.concurrent.TimeUnit;\n+import org.openjdk.jmh.annotations.Benchmark;\n+import org.openjdk.jmh.annotations.Fork;\n+import org.openjdk.jmh.annotations.Measurement;\n+import org.openjdk.jmh.annotations.OutputTimeUnit;\n+import org.openjdk.jmh.annotations.Param;\n+import org.openjdk.jmh.annotations.Scope;\n+import org.openjdk.jmh.annotations.Setup;\n+import org.openjdk.jmh.annotations.State;\n+import org.openjdk.jmh.annotations.Threads;\n+import org.openjdk.jmh.annotations.Warmup;\n+import org.openjdk.jmh.infra.Blackhole;\n+\n+/** Benchmark for Context. */\n+@Threads(value = 1)\n+@Fork(3)\n+@Warmup(iterations = 10, time = 1)\n+@Measurement(iterations = 5, time = 1)\n+@OutputTimeUnit(TimeUnit.MILLISECONDS)\n+@State(Scope.Benchmark)\n+public class ContextBenchmark {\n+\n+  @Param({\"2\", \"3\", \"4\", \"5\", \"10\", \"20\", \"40\"})\n+  private int size;\n+\n+  private List<ContextKey<String>> keys;\n+  private Context context = Context.root();\n+\n+  @Setup\n+  public void setup() {\n+    keys = new ArrayList<>();\n+    for (int i = 0; i < size; i++) {\n+      ContextKey<String> key = ContextKey.named(Integer.toString(i));\n+      context = context.with(key, \"value\");\n+      keys.add(key);\n+    }\n+  }\n+\n+  /** Read value for first key. */\n+  @Benchmark\n+  public String readFirst() {\n+    return context.get(keys.get(0));\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MDU3MQ=="}, "originalCommit": {"oid": "c7fbf21a95b53906830c15f337c3a5b5e7efd74e"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2MDc1OA==", "bodyText": "So yes a test for the middle should be acceptable", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1891#discussion_r512760758", "createdAt": "2020-10-27T14:52:51Z", "author": {"login": "bogdandrutu"}, "path": "context/src/jmh/java/io/opentelemetry/context/ContextBenchmark.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package io.opentelemetry.context;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.concurrent.TimeUnit;\n+import org.openjdk.jmh.annotations.Benchmark;\n+import org.openjdk.jmh.annotations.Fork;\n+import org.openjdk.jmh.annotations.Measurement;\n+import org.openjdk.jmh.annotations.OutputTimeUnit;\n+import org.openjdk.jmh.annotations.Param;\n+import org.openjdk.jmh.annotations.Scope;\n+import org.openjdk.jmh.annotations.Setup;\n+import org.openjdk.jmh.annotations.State;\n+import org.openjdk.jmh.annotations.Threads;\n+import org.openjdk.jmh.annotations.Warmup;\n+import org.openjdk.jmh.infra.Blackhole;\n+\n+/** Benchmark for Context. */\n+@Threads(value = 1)\n+@Fork(3)\n+@Warmup(iterations = 10, time = 1)\n+@Measurement(iterations = 5, time = 1)\n+@OutputTimeUnit(TimeUnit.MILLISECONDS)\n+@State(Scope.Benchmark)\n+public class ContextBenchmark {\n+\n+  @Param({\"2\", \"3\", \"4\", \"5\", \"10\", \"20\", \"40\"})\n+  private int size;\n+\n+  private List<ContextKey<String>> keys;\n+  private Context context = Context.root();\n+\n+  @Setup\n+  public void setup() {\n+    keys = new ArrayList<>();\n+    for (int i = 0; i < size; i++) {\n+      ContextKey<String> key = ContextKey.named(Integer.toString(i));\n+      context = context.with(key, \"value\");\n+      keys.add(key);\n+    }\n+  }\n+\n+  /** Read value for first key. */\n+  @Benchmark\n+  public String readFirst() {\n+    return context.get(keys.get(0));\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MDU3MQ=="}, "originalCommit": {"oid": "c7fbf21a95b53906830c15f337c3a5b5e7efd74e"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzEwMzQyNg==", "bodyText": "Seems interesting to have, will try to run it later. Thanks for the suggestion!", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1891#discussion_r513103426", "createdAt": "2020-10-28T00:06:56Z", "author": {"login": "anuraaga"}, "path": "context/src/jmh/java/io/opentelemetry/context/ContextBenchmark.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package io.opentelemetry.context;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.concurrent.TimeUnit;\n+import org.openjdk.jmh.annotations.Benchmark;\n+import org.openjdk.jmh.annotations.Fork;\n+import org.openjdk.jmh.annotations.Measurement;\n+import org.openjdk.jmh.annotations.OutputTimeUnit;\n+import org.openjdk.jmh.annotations.Param;\n+import org.openjdk.jmh.annotations.Scope;\n+import org.openjdk.jmh.annotations.Setup;\n+import org.openjdk.jmh.annotations.State;\n+import org.openjdk.jmh.annotations.Threads;\n+import org.openjdk.jmh.annotations.Warmup;\n+import org.openjdk.jmh.infra.Blackhole;\n+\n+/** Benchmark for Context. */\n+@Threads(value = 1)\n+@Fork(3)\n+@Warmup(iterations = 10, time = 1)\n+@Measurement(iterations = 5, time = 1)\n+@OutputTimeUnit(TimeUnit.MILLISECONDS)\n+@State(Scope.Benchmark)\n+public class ContextBenchmark {\n+\n+  @Param({\"2\", \"3\", \"4\", \"5\", \"10\", \"20\", \"40\"})\n+  private int size;\n+\n+  private List<ContextKey<String>> keys;\n+  private Context context = Context.root();\n+\n+  @Setup\n+  public void setup() {\n+    keys = new ArrayList<>();\n+    for (int i = 0; i < size; i++) {\n+      ContextKey<String> key = ContextKey.named(Integer.toString(i));\n+      context = context.with(key, \"value\");\n+      keys.add(key);\n+    }\n+  }\n+\n+  /** Read value for first key. */\n+  @Benchmark\n+  public String readFirst() {\n+    return context.get(keys.get(0));\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU5MDU3MQ=="}, "originalCommit": {"oid": "c7fbf21a95b53906830c15f337c3a5b5e7efd74e"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2025, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}