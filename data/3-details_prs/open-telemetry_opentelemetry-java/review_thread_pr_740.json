{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNzA0NDA3", "number": 740, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNjoyMTozNVrODW6Kpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxNzoxMzo0NVrODXN7SA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MzQ4MjYyOnYy", "diffSide": "RIGHT", "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "isResolved": false, "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNjoyMTozNVrOFb7ohA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMTozMTo0NFrOFcD-BA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA==", "bodyText": "Consider to remove the other versions for the moment?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364832900", "createdAt": "2020-01-09T16:21:35Z", "author": {"login": "bogdandrutu"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzOTYyOA==", "bodyText": "I'm ok with that if everyone else is. It's definitely a simpler API to have only one method. We can add more over time if people ask for it. The only consideration is the no-op case, where we'd now be forcing people to create an extra Map which will then be thrown away.\nWhat about having this one, plus a varargs version that requires key-value pairs of arguments, which should cover all possible cases, and let the no-op case not require creation of extra garbage when it's not needed?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364839628", "createdAt": "2020-01-09T16:33:30Z", "author": {"login": "jkwatson"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg0MzcxMA==", "bodyText": "varargs version creates an extra array as well. Can you show me a short code how you want the varargs version that requires key-value pairs of arguments?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364843710", "createdAt": "2020-01-09T16:41:02Z", "author": {"login": "bogdandrutu"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg1MDExOQ==", "bodyText": "A single String[] is a very very small amount of memory compared to a Map, and all of the overhead of all the Map.Entry instances (and the buckets, etc).\nI had an example of what this would look like in an earlier version of this PR. :) Let me dig it up.\nThis was the varargs implementation in LabelSetSdk:\nstatic LabelSet create(String... keyValuePairs) {\n    if (keyValuePairs.length == 0) {\n      return EMPTY;\n    }\n    Preconditions.checkArgument(\n        (keyValuePairs.length % 2) == 0,\n        \"LabelSets must be created with the same number of keys as values.\");\n    Map<String, String> data = new HashMap<>(keyValuePairs.length / 2);\n    for (int i = 0; i < keyValuePairs.length; i++) {\n      String key = keyValuePairs[i];\n      data.put(key, keyValuePairs[++i]);\n    }\n    return new AutoValue_SdkLabelSet(Collections.unmodifiableMap(data));\n  }", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364850119", "createdAt": "2020-01-09T16:51:26Z", "author": {"login": "jkwatson"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg1MDQyMg==", "bodyText": "note: this would be way simpler with java 8 streams.  ;)", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364850422", "createdAt": "2020-01-09T16:52:03Z", "author": {"login": "jkwatson"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg1MTkwNQ==", "bodyText": "I think I like that. Does anybody have experience with varargs API? Are there any pros/cons that we should consider?", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364851905", "createdAt": "2020-01-09T16:54:47Z", "author": {"login": "bogdandrutu"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg3Nzg3MQ==", "bodyText": "The big thing to watch out for is that you really need to make sure you don't try to mix varargs and lists in overloaded methods. Other than that, it's very easy to use, assuming its well documented. I'd love other opinions, though!", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364877871", "createdAt": "2020-01-09T17:51:10Z", "author": {"login": "jkwatson"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg5MTMzMw==", "bodyText": "as a note, if we have a varargs based creator, we can get rid of the emptyLabelSet method on the API, since we get that for free with the empty varargs call.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364891333", "createdAt": "2020-01-09T18:23:08Z", "author": {"login": "jkwatson"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk0NTc4OA==", "bodyText": "I think you can make the change for the moment until we wait for feedback.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364945788", "createdAt": "2020-01-09T20:30:03Z", "author": {"login": "bogdandrutu"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk0Nzg0Mg==", "bodyText": "ok, I'll put in varargs and we can see how it looks", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364947842", "createdAt": "2020-01-09T20:35:33Z", "author": {"login": "jkwatson"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2OTQ3Ng==", "bodyText": "belay that. I'll do varargs as a followup PR", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r364969476", "createdAt": "2020-01-09T21:31:44Z", "author": {"login": "jkwatson"}, "path": "api/src/test/java/io/opentelemetry/OpenTelemetryTest.java", "diffHunk": "@@ -393,6 +395,12 @@ public LabelSet createLabelSet(\n       return null;\n     }\n \n+    @Nullable\n+    @Override\n+    public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzMjkwMA=="}, "originalCommit": {"oid": "95b5438590ddb3c784227189aa96163e1f56d808"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NjcyMDA4OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/io/opentelemetry/metrics/DefaultMeter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxNzoxMzo0NVrOFcal-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxNzoyMToxN1rOFcayGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM0MDE1Mg==", "bodyText": "We don't use Nonnull anywhere else, probably just remove it for the moment.", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r365340152", "createdAt": "2020-01-10T17:13:45Z", "author": {"login": "bogdandrutu"}, "path": "api/src/main/java/io/opentelemetry/metrics/DefaultMeter.java", "diffHunk": "@@ -164,6 +165,12 @@ public LabelSet createLabelSet(\n     return NoopLabelSet.INSTANCE;\n   }\n \n+  @Override\n+  public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8c84e912499727722a693496522557fe8144c9b"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM0MzI1OA==", "bodyText": "done", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/740#discussion_r365343258", "createdAt": "2020-01-10T17:21:17Z", "author": {"login": "jkwatson"}, "path": "api/src/main/java/io/opentelemetry/metrics/DefaultMeter.java", "diffHunk": "@@ -164,6 +165,12 @@ public LabelSet createLabelSet(\n     return NoopLabelSet.INSTANCE;\n   }\n \n+  @Override\n+  public LabelSet createLabelSet(@Nonnull Map<String, String> labels) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM0MDE1Mg=="}, "originalCommit": {"oid": "b8c84e912499727722a693496522557fe8144c9b"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1145, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}