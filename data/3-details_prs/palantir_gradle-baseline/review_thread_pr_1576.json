{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NTY3NTM5", "number": 1576, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODoxMzowNlrOE-x0Ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODoxMzowNlrOE-x0Ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0MjYzMjk4OnYy", "diffSide": "RIGHT", "path": "gradle-baseline-java/src/main/groovy/com/palantir/baseline/plugins/BaselineTesting.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODoxMzowNlrOH8Hi0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxODozNzoxMlrOH8Ib0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgwMDIwOQ==", "bodyText": "@CRogers can we try to not apply this to the ./gradlew test tasks which are normally just unit-tests??", "url": "https://github.com/palantir/gradle-baseline/pull/1576#discussion_r532800209", "createdAt": "2020-11-30T18:13:06Z", "author": {"login": "iamdanfox"}, "path": "gradle-baseline-java/src/main/groovy/com/palantir/baseline/plugins/BaselineTesting.java", "diffHunk": "@@ -140,8 +142,17 @@ private static void enableJunit5ForTestTask(Test task) {\n         // Computes the desired parallelism based on the number of available processors/cores\n         task.systemProperty(\"junit.jupiter.execution.parallel.config.strategy\", \"dynamic\");\n \n-        // provide some stdout feedback when tests fail\n-        task.testLogging(testLogging -> testLogging.events(\"failed\"));\n+        // provide some stdout feedback when tests fail when running on CI and locally\n+        task.getTestLogging().getEvents().add(TestLogEvent.FAILED);\n+\n+        // Only on CI, print out more detailed test information to avoid hitting the circleci 10 min deadline if\n+        // there are lots of tests. Don't do this locally to avoid spamming massive amount of info for people running\n+        // unit tests through the command line\n+        if (\"true\".equals(System.getenv(\"CI\"))) {\n+            task.getTestLogging()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d702a859a0e8a6254a280f372ec24bb22eb05dda"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgwNjIwOA==", "bodyText": "Yep, I have a commit to do this actually, I was just distracted by testing it on c-v-s that had the silently not running tests problem :p", "url": "https://github.com/palantir/gradle-baseline/pull/1576#discussion_r532806208", "createdAt": "2020-11-30T18:23:05Z", "author": {"login": "CRogers"}, "path": "gradle-baseline-java/src/main/groovy/com/palantir/baseline/plugins/BaselineTesting.java", "diffHunk": "@@ -140,8 +142,17 @@ private static void enableJunit5ForTestTask(Test task) {\n         // Computes the desired parallelism based on the number of available processors/cores\n         task.systemProperty(\"junit.jupiter.execution.parallel.config.strategy\", \"dynamic\");\n \n-        // provide some stdout feedback when tests fail\n-        task.testLogging(testLogging -> testLogging.events(\"failed\"));\n+        // provide some stdout feedback when tests fail when running on CI and locally\n+        task.getTestLogging().getEvents().add(TestLogEvent.FAILED);\n+\n+        // Only on CI, print out more detailed test information to avoid hitting the circleci 10 min deadline if\n+        // there are lots of tests. Don't do this locally to avoid spamming massive amount of info for people running\n+        // unit tests through the command line\n+        if (\"true\".equals(System.getenv(\"CI\"))) {\n+            task.getTestLogging()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgwMDIwOQ=="}, "originalCommit": {"oid": "d702a859a0e8a6254a280f372ec24bb22eb05dda"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgxNDgwMA==", "bodyText": "Pushed", "url": "https://github.com/palantir/gradle-baseline/pull/1576#discussion_r532814800", "createdAt": "2020-11-30T18:37:12Z", "author": {"login": "CRogers"}, "path": "gradle-baseline-java/src/main/groovy/com/palantir/baseline/plugins/BaselineTesting.java", "diffHunk": "@@ -140,8 +142,17 @@ private static void enableJunit5ForTestTask(Test task) {\n         // Computes the desired parallelism based on the number of available processors/cores\n         task.systemProperty(\"junit.jupiter.execution.parallel.config.strategy\", \"dynamic\");\n \n-        // provide some stdout feedback when tests fail\n-        task.testLogging(testLogging -> testLogging.events(\"failed\"));\n+        // provide some stdout feedback when tests fail when running on CI and locally\n+        task.getTestLogging().getEvents().add(TestLogEvent.FAILED);\n+\n+        // Only on CI, print out more detailed test information to avoid hitting the circleci 10 min deadline if\n+        // there are lots of tests. Don't do this locally to avoid spamming massive amount of info for people running\n+        // unit tests through the command line\n+        if (\"true\".equals(System.getenv(\"CI\"))) {\n+            task.getTestLogging()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjgwMDIwOQ=="}, "originalCommit": {"oid": "d702a859a0e8a6254a280f372ec24bb22eb05dda"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2165, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}