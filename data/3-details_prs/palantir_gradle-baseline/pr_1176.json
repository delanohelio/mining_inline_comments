{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0OTEzMzYy", "number": 1176, "title": "Fix 6.1 checkstyle report finalizer failure", "bodyText": "Before this PR\nSee #1173 for a good explanation.\nAfter this PR\n==COMMIT_MSG==\nErrors of the form The value for Report xml property 'required' is final and cannot be changed any further. are now fixed for the com.palantir.junit-reports plugin.\n==COMMIT_MSG==\nPossible downsides?\nI had to change the configuration of the Checkstyle task to be set at configuration time rather than task runtime as it is being finalised. I think this is actually better though - I assume the previous way was to try and \"force\" despite any other configuration or because an older version of the API didn't use the Property API.\nFixes #1173.", "createdAt": "2020-01-20T16:19:47Z", "url": "https://github.com/palantir/gradle-baseline/pull/1176", "merged": true, "mergeCommit": {"oid": "055867d36bc0c65c24bc76387da5e3879aa7c3bf"}, "closed": true, "closedAt": "2020-01-23T14:15:07Z", "author": {"login": "CRogers"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8NLlKAH2gAyMzY0OTEzMzYyOmM1MjZhMjE4ZTE0YWI1M2FiZmFkY2IyYTAyNWIyNjFiYjM5OGE2M2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9K4JKgH2gAyMzY0OTEzMzYyOjA5NjFkNTQ0M2UxM2I1NTI2YWM4NThlYmQxYTZlNmY3N2EyZGM3Yjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c526a218e14ab53abfadcb2a025b261bb398a63d", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/c526a218e14ab53abfadcb2a025b261bb398a63d", "committedDate": "2020-01-20T14:11:48Z", "message": "Start writing a test and fix deprecation warnings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea379d844a0027656fc135fe4e442f2b3d260e58", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/ea379d844a0027656fc135fe4e442f2b3d260e58", "committedDate": "2020-01-20T14:25:30Z", "message": "Finally get a test failure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fec27a31a4b83b9b3d800a8b7069c835eaa90863", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/fec27a31a4b83b9b3d800a8b7069c835eaa90863", "committedDate": "2020-01-20T14:54:12Z", "message": "Jump throguh some hoops"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "320ecbec58b227741b66392ddc7fe4266ee0979a", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/320ecbec58b227741b66392ddc7fe4266ee0979a", "committedDate": "2020-01-20T14:58:27Z", "message": "Fix problem and upgrade to 6.1 to get new code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01ca418bb3df081160c27858b4d6dd599786ad95", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/01ca418bb3df081160c27858b4d6dd599786ad95", "committedDate": "2020-01-20T15:25:27Z", "message": "Configure the task eagerly before the property is finalised, also downgrade gradle back"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "529ce44159f18f18799068a4ee42f5e48bbe9ed1", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/529ce44159f18f18799068a4ee42f5e48bbe9ed1", "committedDate": "2020-01-20T16:16:50Z", "message": "Fix mistakenly changed files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "272e3cee099c67091bd58217e9df2d6f04362e85", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/272e3cee099c67091bd58217e9df2d6f04362e85", "committedDate": "2020-01-20T16:16:50Z", "message": "Add generated changelog entries"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NDIxMjI5", "url": "https://github.com/palantir/gradle-baseline/pull/1176#pullrequestreview-345421229", "createdAt": "2020-01-20T16:27:22Z", "commit": {"oid": "272e3cee099c67091bd58217e9df2d6f04362e85"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNjoyNzoyMlrOFfjsgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNjoyNzoyMlrOFfjsgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODYzNTAxMQ==", "bodyText": "would it make sense to just not use nebula for this one test? i.e. to go through all the ProjectBuilder stuff manually?", "url": "https://github.com/palantir/gradle-baseline/pull/1176#discussion_r368635011", "createdAt": "2020-01-20T16:27:22Z", "author": {"login": "iamdanfox"}, "path": "gradle-baseline-java/src/test/groovy/com/palantir/baseline/JunitReportsPluginSpec.groovy", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * (c) Copyright 2020 Palantir Technologies Inc. All rights reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.palantir.baseline\n+\n+import nebula.test.IntegrationSpec\n+import nebula.test.functional.ExecutionResult\n+import spock.lang.Unroll\n+\n+@Unroll\n+class JunitReportsPluginSpec extends IntegrationSpec {\n+    private static final List<String> GRADLE_TEST_VERSIONS = ['5.6.4', '6.1']\n+\n+    def '#gradleVersionNumber: configures the checkstlye plugin correctly'() {\n+        setup:\n+        gradleVersion = gradleVersionNumber\n+\n+        when:\n+        buildFile << '''\n+            apply plugin: 'java'\n+            apply plugin: 'checkstyle'\n+            apply plugin: 'com.palantir.junit-reports'\n+            \n+            repositories {\n+                jcenter()\n+            }\n+        '''.stripIndent()\n+\n+        file('src/main/java/foo/Foo.java') << '''\n+            package foo;\n+            public class Foo {}\n+        '''.stripIndent()\n+\n+        ExecutionResult executionResult = runTasks('checkstyleMain')\n+\n+        then:\n+        // Running checkstyle inside nebula does not work as there are classpath problems that result in the `groovy-all`\n+        // not being on Gradle's classpath. So the best we can do to verify that the checkstyle actually ran is to\n+        // verify we get the classpath error that happens when the checkstyle class runs :(\n+        // https://github.com/gradle/gradle/issues/3995\n+        executionResult.standardError.contains 'java.lang.ClassNotFoundException: groovy.util.AntBuilder'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "272e3cee099c67091bd58217e9df2d6f04362e85"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "642a72badaf0b23af1a9617628ad070ac4d58810", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/642a72badaf0b23af1a9617628ad070ac4d58810", "committedDate": "2020-01-23T12:08:02Z", "message": "Attempt to use testkit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c3e659666cbee262c55f5c41ccd9fe14a85015b", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/1c3e659666cbee262c55f5c41ccd9fe14a85015b", "committedDate": "2020-01-23T12:08:06Z", "message": "Revert \"Attempt to use testkit\"\n\nThis reverts commit 642a72badaf0b23af1a9617628ad070ac4d58810."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc4ba461134b8d7be241cb0007863a896e7a4e8e", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/dc4ba461134b8d7be241cb0007863a896e7a4e8e", "committedDate": "2020-01-23T12:08:08Z", "message": "Merge branch 'fix-junit-reportsw-gradle-6.1' of github.com:palantir/gradle-baseline into fix-junit-reportsw-gradle-6.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c72f068d25281ed0469b1c9d843f7927c674098c", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/c72f068d25281ed0469b1c9d843f7927c674098c", "committedDate": "2020-01-23T12:20:47Z", "message": "Use afterEvaluate to really make sure it works"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d362d93c3bb97095c5ed1ed3032f708b2f3b80a", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/4d362d93c3bb97095c5ed1ed3032f708b2f3b80a", "committedDate": "2020-01-23T12:29:52Z", "message": "Fix imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbbe9edcf9736095caa00726e0868f7b83b7b935", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/bbbe9edcf9736095caa00726e0868f7b83b7b935", "committedDate": "2020-01-23T12:32:55Z", "message": "Format files before merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95245eb9cc902af7a189a43a2496d1b5f66dd658", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/95245eb9cc902af7a189a43a2496d1b5f66dd658", "committedDate": "2020-01-23T12:33:35Z", "message": "Merge branch 'develop' of github.com:palantir/gradle-baseline into fix-junit-reportsw-gradle-6.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7a016393d35c4a4340eaaebe0375e38c8b35c40", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/b7a016393d35c4a4340eaaebe0375e38c8b35c40", "committedDate": "2020-01-23T12:37:12Z", "message": "Fix format"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3MzExMjYy", "url": "https://github.com/palantir/gradle-baseline/pull/1176#pullrequestreview-347311262", "createdAt": "2020-01-23T13:54:34Z", "commit": {"oid": "b7a016393d35c4a4340eaaebe0375e38c8b35c40"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0961d5443e13b5526ac858ebd1a6e6f77a2dc7b7", "author": {"user": {"login": "CRogers", "name": "Callum Rogers"}}, "url": "https://github.com/palantir/gradle-baseline/commit/0961d5443e13b5526ac858ebd1a6e6f77a2dc7b7", "committedDate": "2020-01-23T14:04:41Z", "message": "Remove deprecation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2198, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}