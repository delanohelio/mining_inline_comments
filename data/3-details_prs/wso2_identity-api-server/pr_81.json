{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NTE1NzUw", "number": 81, "title": "Script library management REST API", "bodyText": "This PR Subjected to Script Library REST API", "createdAt": "2020-01-19T09:42:40Z", "url": "https://github.com/wso2/identity-api-server/pull/81", "merged": true, "mergeCommit": {"oid": "524d99e5859edf42cbf608dc1627ad3d24634443"}, "closed": true, "closedAt": "2020-01-27T12:39:31Z", "author": {"login": "Wathsara"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb70mkTgH2gAyMzY0NTE1NzUwOjBjYzQ2NmU4MTU4MTc3Y2IxZGRiY2VlMWJlMWY2NWZkMmZjNjE3N2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-bftFAH2gAyMzY0NTE1NzUwOjRhMmJjNDJhYWRkN2QyYTMwMjk2NjU0NWE2Y2JmMzViMDUwNjUzMDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0cc466e8158177cb1ddbcee1be1f65fd2fc6177f", "author": {"user": {"login": "Wathsara", "name": "Wathsara Wishwantha Daluwatta"}}, "url": "https://github.com/wso2/identity-api-server/commit/0cc466e8158177cb1ddbcee1be1f65fd2fc6177f", "committedDate": "2020-01-19T09:33:39Z", "message": "Implimented functionality of SCL REST API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237", "author": {"user": {"login": "Wathsara", "name": "Wathsara Wishwantha Daluwatta"}}, "url": "https://github.com/wso2/identity-api-server/commit/1146e34aa05bb68140c27f08dbfe7e9e41470237", "committedDate": "2020-01-19T09:38:42Z", "message": "Added the license to the pom files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MDA1NjQ3", "url": "https://github.com/wso2/identity-api-server/pull/81#pullrequestreview-345005647", "createdAt": "2020-01-19T14:29:47Z", "commit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "state": "DISMISSED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQxNDoyOTo0N1rOFfPJCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQxNDozMjo1NFrOFfPJsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI5ODI1MQ==", "bodyText": "Better expand the imports with explicit classes.  Wildcard imports are discouraged as it does not show what classes we actually need.", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368298251", "createdAt": "2020-01-19T14:29:47Z", "author": {"login": "ruwanta"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/gen/java/org/wso2/carbon/identity/api/server/script/library/v1/ScriptLibrariesApi.java", "diffHunk": "@@ -0,0 +1,180 @@\n+/*\n+ * Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.wso2.carbon.identity.api.server.script.library.v1;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.apache.cxf.jaxrs.ext.multipart.Attachment;\n+import org.apache.cxf.jaxrs.ext.multipart.Multipart;\n+\n+import java.io.InputStream;\n+\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.Error;\n+\n+import java.io.File;\n+\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryListResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.ScriptLibrariesApiService;\n+\n+import javax.validation.Valid;\n+import javax.ws.rs.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI5ODMwMg==", "bodyText": "We need a class comment explaining what this supposed to do and the purpose, usage", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368298302", "createdAt": "2020-01-19T14:30:41Z", "author": {"login": "ruwanta"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/gen/java/org/wso2/carbon/identity/api/server/script/library/v1/ScriptLibrariesApiService.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+* Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+*\n+* Licensed under the Apache License, Version 2.0 (the \"License\");\n+* you may not use this file except in compliance with the License.\n+* You may obtain a copy of the License at\n+*\n+* http://www.apache.org/licenses/LICENSE-2.0\n+*\n+* Unless required by applicable law or agreed to in writing, software\n+* distributed under the License is distributed on an \"AS IS\" BASIS,\n+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+* See the License for the specific language governing permissions and\n+* limitations under the License.\n+*/\n+\n+package org.wso2.carbon.identity.api.server.script.library.v1;\n+\n+import org.wso2.carbon.identity.api.server.script.library.v1.*;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.*;\n+import org.apache.cxf.jaxrs.ext.multipart.Attachment;\n+import org.apache.cxf.jaxrs.ext.multipart.Multipart;\n+import java.io.InputStream;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.Error;\n+import java.io.File;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryListResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryResponse;\n+import javax.ws.rs.core.Response;\n+\n+\n+public interface ScriptLibrariesApiService {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI5ODMyMw==", "bodyText": "Interface does not need \"public\". any method declared is public by definition", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368298323", "createdAt": "2020-01-19T14:31:10Z", "author": {"login": "ruwanta"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/gen/java/org/wso2/carbon/identity/api/server/script/library/v1/ScriptLibrariesApiService.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+* Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+*\n+* Licensed under the Apache License, Version 2.0 (the \"License\");\n+* you may not use this file except in compliance with the License.\n+* You may obtain a copy of the License at\n+*\n+* http://www.apache.org/licenses/LICENSE-2.0\n+*\n+* Unless required by applicable law or agreed to in writing, software\n+* distributed under the License is distributed on an \"AS IS\" BASIS,\n+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+* See the License for the specific language governing permissions and\n+* limitations under the License.\n+*/\n+\n+package org.wso2.carbon.identity.api.server.script.library.v1;\n+\n+import org.wso2.carbon.identity.api.server.script.library.v1.*;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.*;\n+import org.apache.cxf.jaxrs.ext.multipart.Attachment;\n+import org.apache.cxf.jaxrs.ext.multipart.Multipart;\n+import java.io.InputStream;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.Error;\n+import java.io.File;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryListResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryResponse;\n+import javax.ws.rs.core.Response;\n+\n+\n+public interface ScriptLibrariesApiService {\n+\n+      public Response addScriptLibrary(String name, InputStream contentInputStream, Attachment contentDetail, String description);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI5ODM2Nw==", "bodyText": "Class comment is necessary.", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368298367", "createdAt": "2020-01-19T14:31:48Z", "author": {"login": "ruwanta"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/gen/java/org/wso2/carbon/identity/api/server/script/library/v1/model/Error.java", "diffHunk": "@@ -0,0 +1,159 @@\n+/*\n+* Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+*\n+* Licensed under the Apache License, Version 2.0 (the \"License\");\n+* you may not use this file except in compliance with the License.\n+* You may obtain a copy of the License at\n+*\n+* http://www.apache.org/licenses/LICENSE-2.0\n+*\n+* Unless required by applicable law or agreed to in writing, software\n+* distributed under the License is distributed on an \"AS IS\" BASIS,\n+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+* See the License for the specific language governing permissions and\n+* limitations under the License.\n+*/\n+\n+package org.wso2.carbon.identity.api.server.script.library.v1.model;\n+\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import io.swagger.annotations.ApiModel;\n+import io.swagger.annotations.ApiModelProperty;\n+import javax.validation.constraints.*;\n+\n+\n+import io.swagger.annotations.*;\n+import java.util.Objects;\n+import javax.validation.Valid;\n+import javax.xml.bind.annotation.*;\n+\n+public class Error  {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI5ODQxOQ==", "bodyText": "We do not depend on snapshot versions. It has to be a proper release version.", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368298419", "createdAt": "2020-01-19T14:32:54Z", "author": {"login": "ruwanta"}, "path": "pom.xml", "diffHunk": "@@ -440,7 +454,7 @@\n         <maven.buildnumber.plugin.version>1.4</maven.buildnumber.plugin.version>\n         <org.apache.felix.annotations.version>1.2.4</org.apache.felix.annotations.version>\n         <identity.governance.version>1.3.15</identity.governance.version>\n-        <carbon.identity.framework.version>5.15.36</carbon.identity.framework.version>\n+        <carbon.identity.framework.version>5.16.25-SNAPSHOT</carbon.identity.framework.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MTAzODA1", "url": "https://github.com/wso2/identity-api-server/pull/81#pullrequestreview-345103805", "createdAt": "2020-01-20T06:47:14Z", "commit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwNjo0NzoxNFrOFfUtzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQwNzoyNTo0M1rOFfVQvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM4OTU4MQ==", "bodyText": "change year", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368389581", "createdAt": "2020-01-20T06:47:14Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.common/src/main/java/org/wso2/carbon/identity/api/server/script/library/common/Constants.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM4OTY5Ng==", "bodyText": "change year", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368389696", "createdAt": "2020-01-20T06:47:43Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.common/src/main/java/org/wso2/carbon/identity/api/server/script/library/common/ScriptLibraryServiceHolder.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/*\n+ * Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM5NTEzNA==", "bodyText": "let's throw an error (Bad request ) if offset is negative. Return default value for null offset", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368395134", "createdAt": "2020-01-20T07:11:40Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/main/java/org/wso2/carbon/identity/api/server/script/library/v1/core/ServerScriptLibrariesService.java", "diffHunk": "@@ -0,0 +1,439 @@\n+/*\n+ * Copyright (c) 2020 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.identity.api.server.script.library.v1.core;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.apache.commons.io.IOUtils;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.identity.api.server.common.ContextLoader;\n+import org.wso2.carbon.identity.api.server.common.Util;\n+import org.wso2.carbon.identity.api.server.common.error.APIError;\n+import org.wso2.carbon.identity.api.server.common.error.ErrorResponse;\n+import org.wso2.carbon.identity.api.server.script.library.common.Constants;\n+import org.wso2.carbon.identity.api.server.script.library.common.ScriptLibraryServiceHolder;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibrary;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryListResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryPOSTRequest;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryPUTRequest;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryResponse;\n+import org.wso2.carbon.identity.core.util.IdentityUtil;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementClientException;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementException;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementServerException;\n+import org.wso2.carbon.identity.functions.library.mgt.model.FunctionLibrary;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import javax.ws.rs.core.Response;\n+\n+import static org.wso2.carbon.identity.api.server.common.Constants.V1_API_PATH_COMPONENT;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_CONTENT_PATH;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_PATH_COMPONENT;\n+\n+/**\n+ * Call internal osgi services to perform server script library management operations.\n+ */\n+public class ServerScriptLibrariesService {\n+\n+    private static final Log log = LogFactory.getLog(ServerScriptLibrariesService.class);\n+    private static final int DEFAULT_OFFSET = 0;\n+\n+    /**\n+     * Get list of Script Libraries.\n+     *\n+     * @param limit  Items per page.\n+     * @param offset Offset.\n+     * @return ScriptLibraryListResponse.\n+     */\n+    public ScriptLibraryListResponse getScriptLibraries(Integer limit, Integer offset) {\n+\n+        List<FunctionLibrary> functionLibraries;\n+        try {\n+            functionLibraries = ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                    .listFunctionLibraries(ContextLoader.getTenantDomainFromContext());\n+        } catch (FunctionLibraryManagementException e) {\n+            throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_LISTING_SCRIPT_LIBRARIES);\n+        }\n+        return createScriptLibrariesList(functionLibraries, validateLimit(limit), validateOffset(offset));\n+    }\n+\n+    /**\n+     * Validate the offset.\n+     *\n+     * @param offset Offset value\n+     * @return Validated offset.\n+     */\n+    private int validateOffset(Integer offset) {\n+\n+        if (offset != null && offset >= 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM5NTI3Ng==", "bodyText": "let's throw an error (Bad request ) if limit is negative. Return default value for null limit", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368395276", "createdAt": "2020-01-20T07:12:10Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/main/java/org/wso2/carbon/identity/api/server/script/library/v1/core/ServerScriptLibrariesService.java", "diffHunk": "@@ -0,0 +1,439 @@\n+/*\n+ * Copyright (c) 2020 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.identity.api.server.script.library.v1.core;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.apache.commons.io.IOUtils;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.identity.api.server.common.ContextLoader;\n+import org.wso2.carbon.identity.api.server.common.Util;\n+import org.wso2.carbon.identity.api.server.common.error.APIError;\n+import org.wso2.carbon.identity.api.server.common.error.ErrorResponse;\n+import org.wso2.carbon.identity.api.server.script.library.common.Constants;\n+import org.wso2.carbon.identity.api.server.script.library.common.ScriptLibraryServiceHolder;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibrary;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryListResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryPOSTRequest;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryPUTRequest;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryResponse;\n+import org.wso2.carbon.identity.core.util.IdentityUtil;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementClientException;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementException;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementServerException;\n+import org.wso2.carbon.identity.functions.library.mgt.model.FunctionLibrary;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import javax.ws.rs.core.Response;\n+\n+import static org.wso2.carbon.identity.api.server.common.Constants.V1_API_PATH_COMPONENT;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_CONTENT_PATH;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_PATH_COMPONENT;\n+\n+/**\n+ * Call internal osgi services to perform server script library management operations.\n+ */\n+public class ServerScriptLibrariesService {\n+\n+    private static final Log log = LogFactory.getLog(ServerScriptLibrariesService.class);\n+    private static final int DEFAULT_OFFSET = 0;\n+\n+    /**\n+     * Get list of Script Libraries.\n+     *\n+     * @param limit  Items per page.\n+     * @param offset Offset.\n+     * @return ScriptLibraryListResponse.\n+     */\n+    public ScriptLibraryListResponse getScriptLibraries(Integer limit, Integer offset) {\n+\n+        List<FunctionLibrary> functionLibraries;\n+        try {\n+            functionLibraries = ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                    .listFunctionLibraries(ContextLoader.getTenantDomainFromContext());\n+        } catch (FunctionLibraryManagementException e) {\n+            throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_LISTING_SCRIPT_LIBRARIES);\n+        }\n+        return createScriptLibrariesList(functionLibraries, validateLimit(limit), validateOffset(offset));\n+    }\n+\n+    /**\n+     * Validate the offset.\n+     *\n+     * @param offset Offset value\n+     * @return Validated offset.\n+     */\n+    private int validateOffset(Integer offset) {\n+\n+        if (offset != null && offset >= 0) {\n+            return offset;\n+        } else {\n+            return DEFAULT_OFFSET;\n+        }\n+    }\n+\n+    /**\n+     * Validate the limit.\n+     *\n+     * @param limit Limit value.\n+     * @return Validated limit.\n+     */\n+    private int validateLimit(Integer limit) {\n+\n+        final int maximumItemPerPage = IdentityUtil.getMaximumItemPerPage();\n+        if (limit != null && limit > 0 && limit <= maximumItemPerPage) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM5NTQ5OA==", "bodyText": "can't we inline 207 and 208", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368395498", "createdAt": "2020-01-20T07:13:02Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/main/java/org/wso2/carbon/identity/api/server/script/library/v1/core/ServerScriptLibrariesService.java", "diffHunk": "@@ -0,0 +1,439 @@\n+/*\n+ * Copyright (c) 2020 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.identity.api.server.script.library.v1.core;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.apache.commons.io.IOUtils;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.identity.api.server.common.ContextLoader;\n+import org.wso2.carbon.identity.api.server.common.Util;\n+import org.wso2.carbon.identity.api.server.common.error.APIError;\n+import org.wso2.carbon.identity.api.server.common.error.ErrorResponse;\n+import org.wso2.carbon.identity.api.server.script.library.common.Constants;\n+import org.wso2.carbon.identity.api.server.script.library.common.ScriptLibraryServiceHolder;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibrary;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryListResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryPOSTRequest;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryPUTRequest;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryResponse;\n+import org.wso2.carbon.identity.core.util.IdentityUtil;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementClientException;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementException;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementServerException;\n+import org.wso2.carbon.identity.functions.library.mgt.model.FunctionLibrary;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import javax.ws.rs.core.Response;\n+\n+import static org.wso2.carbon.identity.api.server.common.Constants.V1_API_PATH_COMPONENT;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_CONTENT_PATH;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_PATH_COMPONENT;\n+\n+/**\n+ * Call internal osgi services to perform server script library management operations.\n+ */\n+public class ServerScriptLibrariesService {\n+\n+    private static final Log log = LogFactory.getLog(ServerScriptLibrariesService.class);\n+    private static final int DEFAULT_OFFSET = 0;\n+\n+    /**\n+     * Get list of Script Libraries.\n+     *\n+     * @param limit  Items per page.\n+     * @param offset Offset.\n+     * @return ScriptLibraryListResponse.\n+     */\n+    public ScriptLibraryListResponse getScriptLibraries(Integer limit, Integer offset) {\n+\n+        List<FunctionLibrary> functionLibraries;\n+        try {\n+            functionLibraries = ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                    .listFunctionLibraries(ContextLoader.getTenantDomainFromContext());\n+        } catch (FunctionLibraryManagementException e) {\n+            throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_LISTING_SCRIPT_LIBRARIES);\n+        }\n+        return createScriptLibrariesList(functionLibraries, validateLimit(limit), validateOffset(offset));\n+    }\n+\n+    /**\n+     * Validate the offset.\n+     *\n+     * @param offset Offset value\n+     * @return Validated offset.\n+     */\n+    private int validateOffset(Integer offset) {\n+\n+        if (offset != null && offset >= 0) {\n+            return offset;\n+        } else {\n+            return DEFAULT_OFFSET;\n+        }\n+    }\n+\n+    /**\n+     * Validate the limit.\n+     *\n+     * @param limit Limit value.\n+     * @return Validated limit.\n+     */\n+    private int validateLimit(Integer limit) {\n+\n+        final int maximumItemPerPage = IdentityUtil.getMaximumItemPerPage();\n+        if (limit != null && limit > 0 && limit <= maximumItemPerPage) {\n+            return limit;\n+        } else {\n+            return IdentityUtil.getDefaultItemsPerPage();\n+        }\n+    }\n+\n+    /**\n+     * Get a script library identified by resource ID.\n+     *\n+     * @param scriptLibraryId resource ID.\n+     * @return ScriptLibrary.\n+     */\n+    public ScriptLibraryResponse getScriptLibrary(String scriptLibraryId) {\n+\n+        if (isScriptLibraryAvailable(scriptLibraryId)) {\n+            FunctionLibrary functionLibrary;\n+            try {\n+                functionLibrary = ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                        .getFunctionLibrary(scriptLibraryId,\n+                                ContextLoader.getTenantDomainFromContext());\n+            } catch (FunctionLibraryManagementException e) {\n+                throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_RETRIEVING_SCRIPT_LIBRARY);\n+            }\n+            return createScriptLibraryResponse(functionLibrary);\n+        } else {\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_NOT_FOUND,\n+                    Response.Status.NOT_FOUND, scriptLibraryId, ContextLoader.getTenantDomainFromContext());\n+        }\n+\n+    }\n+\n+    /**\n+     * Add a script library.\n+     *\n+     * @param name               Name of the script library.\n+     * @param contentInputStream Content of the script library code.\n+     * @param description        Description of the script library\n+     */\n+    public void addScriptLibrary(String name, InputStream contentInputStream, String description) {\n+\n+        ScriptLibraryPOSTRequest scriptLibraryPOSTRequest = new ScriptLibraryPOSTRequest();\n+        scriptLibraryPOSTRequest.setName(name);\n+        scriptLibraryPOSTRequest.setDescription(description);\n+        try {\n+            scriptLibraryPOSTRequest.setContent(\n+                    new File(IOUtils.toString(contentInputStream, StandardCharsets.UTF_8.name())));\n+        } catch (IOException e) {\n+            log.error(\"Error occurred while reading contentInputStream: \" + e);\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_CODE_ERROR_ADDING_SCRIPT_LIBRARY,\n+                    Response.Status.INTERNAL_SERVER_ERROR);\n+        }\n+        if (isScriptLibraryAvailable(scriptLibraryPOSTRequest.getName())) {\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_ALREADY_FOUND,\n+                    Response.Status.CONFLICT, scriptLibraryPOSTRequest.getName(),\n+                    ContextLoader.getTenantDomainFromContext());\n+        } else {\n+            FunctionLibrary functionLibrary = createScriptLibrary(scriptLibraryPOSTRequest);\n+            try {\n+                if (scriptLibraryPOSTRequest.getName().contains(Constants.SCRIPT_LIBRARY_EXTENSION)) {\n+                    ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                            .createFunctionLibrary(functionLibrary,\n+                                    ContextLoader.getTenantDomainFromContext());\n+                } else {\n+                    throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_NAME_VALIDATION,\n+                            Response.Status.BAD_REQUEST);\n+                }\n+            } catch (FunctionLibraryManagementException e) {\n+                throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_ADDING_SCRIPT_LIBRARY);\n+            }\n+        }\n+\n+    }\n+\n+    /**\n+     * Update a script library identified by resource ID.\n+     *\n+     * @param scriptLibraryName  Name of the script library.\n+     * @param contentInputStream Content of the script library code.\n+     * @param description        Description of the script library\n+     * @return ScriptLibrary.\n+     */\n+    public ScriptLibraryResponse updateScriptLibrary(String scriptLibraryName, InputStream contentInputStream,\n+                                                     String description) {\n+\n+        ScriptLibraryPUTRequest scriptLibraryPUTRequest = new ScriptLibraryPUTRequest();\n+        scriptLibraryPUTRequest.setDescription(description);\n+        try {\n+            scriptLibraryPUTRequest.setContent(\n+                    new File(IOUtils.toString(contentInputStream, StandardCharsets.UTF_8.name())));\n+        } catch (IOException e) {\n+            log.error(\"Error occurred while reading contentInputStream: \" + e);\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_CODE_ERROR_UPDATING_SCRIPT_LIBRARY,\n+                    Response.Status.INTERNAL_SERVER_ERROR);\n+        }\n+        if (isScriptLibraryAvailable(scriptLibraryName)) {\n+            FunctionLibrary functionLibrary = createScriptLibraryPut(scriptLibraryName, scriptLibraryPUTRequest);\n+            try {\n+                ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                        .updateFunctionLibrary(scriptLibraryName, functionLibrary,\n+                                ContextLoader.getTenantDomainFromContext());\n+            } catch (FunctionLibraryManagementException e) {\n+                throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_UPDATING_SCRIPT_LIBRARY", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 207}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM5ODUyNA==", "bodyText": "change year", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r368398524", "createdAt": "2020-01-20T07:25:43Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/main/resources/META-INF/cxf/script-libraries-server-v1-cxf.xml", "diffHunk": "@@ -0,0 +1,29 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Copyright (c) 2019, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1146e34aa05bb68140c27f08dbfe7e9e41470237"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1f24a495063022b48d0fe2a91be8b83c6cf07de", "author": {"user": {"login": "Wathsara", "name": "Wathsara Wishwantha Daluwatta"}}, "url": "https://github.com/wso2/identity-api-server/commit/f1f24a495063022b48d0fe2a91be8b83c6cf07de", "committedDate": "2020-01-20T09:05:52Z", "message": "Fixed PR Comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NDQwMzg0", "url": "https://github.com/wso2/identity-api-server/pull/81#pullrequestreview-348440384", "createdAt": "2020-01-27T04:52:23Z", "commit": {"oid": "f1f24a495063022b48d0fe2a91be8b83c6cf07de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNDo1MjoyNFrOFh381g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNDo1MjoyNFrOFh381g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA2NDAyMg==", "bodyText": "cant we merge line 252 and 253", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r371064022", "createdAt": "2020-01-27T04:52:24Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/main/java/org/wso2/carbon/identity/api/server/script/library/v1/core/ServerScriptLibrariesService.java", "diffHunk": "@@ -0,0 +1,438 @@\n+/*\n+ * Copyright (c) 2020 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.wso2.carbon.identity.api.server.script.library.v1.core;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.apache.commons.io.IOUtils;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.identity.api.server.common.ContextLoader;\n+import org.wso2.carbon.identity.api.server.common.Util;\n+import org.wso2.carbon.identity.api.server.common.error.APIError;\n+import org.wso2.carbon.identity.api.server.common.error.ErrorResponse;\n+import org.wso2.carbon.identity.api.server.script.library.common.Constants;\n+import org.wso2.carbon.identity.api.server.script.library.common.ScriptLibraryServiceHolder;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibrary;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryListResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryPOSTRequest;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryPUTRequest;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryResponse;\n+import org.wso2.carbon.identity.core.util.IdentityUtil;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementClientException;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementException;\n+import org.wso2.carbon.identity.functions.library.mgt.exception.FunctionLibraryManagementServerException;\n+import org.wso2.carbon.identity.functions.library.mgt.model.FunctionLibrary;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.nio.charset.StandardCharsets;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import javax.ws.rs.core.Response;\n+\n+import static org.wso2.carbon.identity.api.server.common.Constants.V1_API_PATH_COMPONENT;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_CONTENT_PATH;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_PATH_COMPONENT;\n+\n+/**\n+ * Call internal osgi services to perform server script library management operations.\n+ */\n+public class ServerScriptLibrariesService {\n+\n+    private static final Log log = LogFactory.getLog(ServerScriptLibrariesService.class);\n+\n+    /**\n+     * Get list of Script Libraries.\n+     *\n+     * @param limit  Items per page.\n+     * @param offset Offset.\n+     * @return ScriptLibraryListResponse.\n+     */\n+    public ScriptLibraryListResponse getScriptLibraries(Integer limit, Integer offset) {\n+\n+        List<FunctionLibrary> functionLibraries;\n+        try {\n+            functionLibraries = ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                    .listFunctionLibraries(ContextLoader.getTenantDomainFromContext());\n+        } catch (FunctionLibraryManagementException e) {\n+            throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_LISTING_SCRIPT_LIBRARIES);\n+        }\n+        return createScriptLibrariesList(functionLibraries, validateLimit(limit), validateOffset(offset));\n+    }\n+\n+    /**\n+     * Validate the offset.\n+     *\n+     * @param offset Offset value\n+     * @return Validated offset.\n+     */\n+    private int validateOffset(Integer offset) {\n+\n+        if (offset != null && offset >= 0) {\n+            return offset;\n+        } else {\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_OFFSET_VALIDATION,\n+                    Response.Status.BAD_REQUEST);\n+        }\n+    }\n+\n+    /**\n+     * Validate the limit.\n+     *\n+     * @param limit Limit value.\n+     * @return Validated limit.\n+     */\n+    private int validateLimit(Integer limit) {\n+\n+        final int maximumItemPerPage = IdentityUtil.getMaximumItemPerPage();\n+        if (limit != null && limit > 0 && limit <= maximumItemPerPage) {\n+            return limit;\n+        } else {\n+            return IdentityUtil.getDefaultItemsPerPage();\n+        }\n+    }\n+\n+    /**\n+     * Get a script library identified by resource ID.\n+     *\n+     * @param scriptLibraryId resource ID.\n+     * @return ScriptLibrary.\n+     */\n+    public ScriptLibraryResponse getScriptLibrary(String scriptLibraryId) {\n+\n+        if (isScriptLibraryAvailable(scriptLibraryId)) {\n+            FunctionLibrary functionLibrary;\n+            try {\n+                functionLibrary = ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                        .getFunctionLibrary(scriptLibraryId,\n+                                ContextLoader.getTenantDomainFromContext());\n+            } catch (FunctionLibraryManagementException e) {\n+                throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_RETRIEVING_SCRIPT_LIBRARY);\n+            }\n+            return createScriptLibraryResponse(functionLibrary);\n+        } else {\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_NOT_FOUND,\n+                    Response.Status.NOT_FOUND, scriptLibraryId, ContextLoader.getTenantDomainFromContext());\n+        }\n+\n+    }\n+\n+    /**\n+     * Add a script library.\n+     *\n+     * @param name               Name of the script library.\n+     * @param contentInputStream Content of the script library code.\n+     * @param description        Description of the script library\n+     */\n+    public void addScriptLibrary(String name, InputStream contentInputStream, String description) {\n+\n+        ScriptLibraryPOSTRequest scriptLibraryPOSTRequest = new ScriptLibraryPOSTRequest();\n+        scriptLibraryPOSTRequest.setName(name);\n+        scriptLibraryPOSTRequest.setDescription(description);\n+        try {\n+            scriptLibraryPOSTRequest.setContent(\n+                    new File(IOUtils.toString(contentInputStream, StandardCharsets.UTF_8.name())));\n+        } catch (IOException e) {\n+            log.error(\"Error occurred while reading contentInputStream: \" + e);\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_CODE_ERROR_ADDING_SCRIPT_LIBRARY,\n+                    Response.Status.INTERNAL_SERVER_ERROR);\n+        }\n+        if (isScriptLibraryAvailable(scriptLibraryPOSTRequest.getName())) {\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_ALREADY_FOUND,\n+                    Response.Status.CONFLICT, scriptLibraryPOSTRequest.getName(),\n+                    ContextLoader.getTenantDomainFromContext());\n+        } else {\n+            FunctionLibrary functionLibrary = createScriptLibrary(scriptLibraryPOSTRequest);\n+            try {\n+                if (scriptLibraryPOSTRequest.getName().contains(Constants.SCRIPT_LIBRARY_EXTENSION)) {\n+                    ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                            .createFunctionLibrary(functionLibrary,\n+                                    ContextLoader.getTenantDomainFromContext());\n+                } else {\n+                    throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_NAME_VALIDATION,\n+                            Response.Status.BAD_REQUEST);\n+                }\n+            } catch (FunctionLibraryManagementException e) {\n+                throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_ADDING_SCRIPT_LIBRARY);\n+            }\n+        }\n+\n+    }\n+\n+    /**\n+     * Update a script library identified by resource ID.\n+     *\n+     * @param scriptLibraryName  Name of the script library.\n+     * @param contentInputStream Content of the script library code.\n+     * @param description        Description of the script library\n+     * @return ScriptLibrary.\n+     */\n+    public ScriptLibraryResponse updateScriptLibrary(String scriptLibraryName, InputStream contentInputStream,\n+                                                     String description) {\n+\n+        ScriptLibraryPUTRequest scriptLibraryPUTRequest = new ScriptLibraryPUTRequest();\n+        scriptLibraryPUTRequest.setDescription(description);\n+        try {\n+            scriptLibraryPUTRequest.setContent(\n+                    new File(IOUtils.toString(contentInputStream, StandardCharsets.UTF_8.name())));\n+        } catch (IOException e) {\n+            log.error(\"Error occurred while reading contentInputStream: \" + e);\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_CODE_ERROR_UPDATING_SCRIPT_LIBRARY,\n+                    Response.Status.INTERNAL_SERVER_ERROR);\n+        }\n+        if (isScriptLibraryAvailable(scriptLibraryName)) {\n+            FunctionLibrary functionLibrary = createScriptLibraryPut(scriptLibraryName, scriptLibraryPUTRequest);\n+            try {\n+                ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                        .updateFunctionLibrary(scriptLibraryName, functionLibrary,\n+                                ContextLoader.getTenantDomainFromContext());\n+            } catch (FunctionLibraryManagementException e) {\n+                throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_UPDATING_SCRIPT_LIBRARY);\n+            }\n+            return createScriptLibraryResponse(functionLibrary);\n+        } else {\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_NOT_FOUND,\n+                    Response.Status.NOT_FOUND, scriptLibraryName, ContextLoader.getTenantDomainFromContext());\n+        }\n+\n+    }\n+\n+    /**\n+     * Get the script library content.\n+     *\n+     * @param scriptLibraryName Name of the script library\n+     * @return Script library content\n+     */\n+    public String getScriptLibraryContentByName(String scriptLibraryName) {\n+\n+        if (isScriptLibraryAvailable(scriptLibraryName)) {\n+            try {\n+                FunctionLibrary functionLibrary = ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                        .getFunctionLibrary(scriptLibraryName,\n+                                ContextLoader.getTenantDomainFromContext());\n+                return functionLibrary.getFunctionLibraryScript();\n+            } catch (FunctionLibraryManagementException e) {\n+                throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_RETRIEVING_SCRIPT_LIBRARY);\n+            }\n+        } else {\n+            throw handleScriptLibraryClientError(Constants.ErrorMessage.ERROR_SCRIPT_LIBRARY_NOT_FOUND,\n+                    Response.Status.NOT_FOUND, scriptLibraryName, ContextLoader.getTenantDomainFromContext());\n+        }\n+    }\n+\n+    /**\n+     * Delete a script library.\n+     *\n+     * @param scriptLibraryId script library resource ID.\n+     */\n+    public void deleteScriptLibrary(String scriptLibraryId) {\n+\n+        if (isScriptLibraryAvailable(scriptLibraryId)) {\n+            try {\n+                ScriptLibraryServiceHolder.getScriptLibraryManagementService()\n+                        .deleteFunctionLibrary(scriptLibraryId, ContextLoader.getTenantDomainFromContext());\n+            } catch (FunctionLibraryManagementException e) {\n+                throw handleScriptLibraryError(e, Constants.ErrorMessage.ERROR_CODE_ERROR_DELETING_SCRIPT_LIBRARY", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1f24a495063022b48d0fe2a91be8b83c6cf07de"}, "originalPosition": 252}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NDQwNzAy", "url": "https://github.com/wso2/identity-api-server/pull/81#pullrequestreview-348440702", "createdAt": "2020-01-27T04:54:42Z", "commit": {"oid": "f1f24a495063022b48d0fe2a91be8b83c6cf07de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNDo1NDo0MlrOFh39-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNDo1NDo0MlrOFh39-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA2NDMxNA==", "bodyText": "let's avoid sending any response in update requests as discussed in the code-review. Only the status code will be enough.", "url": "https://github.com/wso2/identity-api-server/pull/81#discussion_r371064314", "createdAt": "2020-01-27T04:54:42Z", "author": {"login": "emswbandara"}, "path": "components/org.wso2.carbon.identity.api.server.script.library/org.wso2.carbon.identity.api.server.script.library.v1/src/main/java/org/wso2/carbon/identity/api/server/script/library/v1/impl/ScriptLibrariesApiServiceImpl.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.wso2.carbon.identity.api.server.script.library.v1.impl;\n+\n+import org.apache.cxf.jaxrs.ext.multipart.Attachment;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.wso2.carbon.identity.api.server.common.ContextLoader;\n+import org.wso2.carbon.identity.api.server.script.library.v1.ScriptLibrariesApiService;\n+import org.wso2.carbon.identity.api.server.script.library.v1.core.ServerScriptLibrariesService;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryListResponse;\n+import org.wso2.carbon.identity.api.server.script.library.v1.model.ScriptLibraryResponse;\n+\n+import java.io.InputStream;\n+import java.net.URI;\n+\n+import javax.ws.rs.core.Response;\n+\n+import static org.wso2.carbon.identity.api.server.common.Constants.V1_API_PATH_COMPONENT;\n+import static org.wso2.carbon.identity.api.server.script.library.common.Constants.SCRIPT_LIBRARY_PATH_COMPONENT;\n+\n+/**\n+ * Implementation of the script library Rest API.\n+ */\n+public class ScriptLibrariesApiServiceImpl implements ScriptLibrariesApiService {\n+\n+    @Autowired\n+    private ServerScriptLibrariesService serverScriptLibrariesService;\n+\n+    @Override\n+    public Response addScriptLibrary(String name, InputStream contentInputStream, Attachment contentDetail,\n+                                     String description) {\n+\n+        serverScriptLibrariesService.addScriptLibrary(name, contentInputStream, description);\n+        URI location =\n+                ContextLoader.buildURIForHeader(V1_API_PATH_COMPONENT + SCRIPT_LIBRARY_PATH_COMPONENT + \"/\" + name);\n+        return Response.created(location).build();\n+    }\n+\n+    @Override\n+    public Response deleteScriptLibrary(String scriptLibraryName) {\n+\n+        serverScriptLibrariesService.deleteScriptLibrary(scriptLibraryName);\n+        return Response.noContent().build();\n+    }\n+\n+    @Override\n+    public Response getScriptLibraries(Integer limit, Integer offset) {\n+\n+        ScriptLibraryListResponse scriptLibraryListResponse = serverScriptLibrariesService.getScriptLibraries(limit,\n+                offset);\n+        return Response.ok().entity(scriptLibraryListResponse).build();\n+    }\n+\n+    @Override\n+    public Response getScriptLibraryByName(String scriptLibraryName) {\n+\n+        ScriptLibraryResponse scriptLibraryResponse = serverScriptLibrariesService.getScriptLibrary(scriptLibraryName);\n+        return Response.ok().entity(scriptLibraryResponse).build();\n+    }\n+\n+    @Override\n+    public Response getScriptLibraryContentByName(String scriptLibraryName) {\n+\n+        return Response.ok().entity(serverScriptLibrariesService.getScriptLibraryContentByName(scriptLibraryName))\n+                .build();\n+    }\n+\n+    @Override\n+    public Response updateScriptLibrary(String scriptLibraryName, InputStream contentInputStream,\n+                                        Attachment contentDetail, String description) {\n+\n+        ScriptLibraryResponse scriptLibraryResponse =\n+                serverScriptLibrariesService.updateScriptLibrary(scriptLibraryName, contentInputStream, description);\n+        return Response.ok().entity(scriptLibraryResponse).build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1f24a495063022b48d0fe2a91be8b83c6cf07de"}, "originalPosition": 88}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2800691d849b18ddbdf4fb3acff4c9f75b8e2795", "author": {"user": {"login": "Wathsara", "name": "Wathsara Wishwantha Daluwatta"}}, "url": "https://github.com/wso2/identity-api-server/commit/2800691d849b18ddbdf4fb3acff4c9f75b8e2795", "committedDate": "2020-01-27T05:26:41Z", "message": "Fixed the response of the update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fabd00fd3df7dd96fcfadb66eaab70ba8d0b56ed", "author": {"user": {"login": "Wathsara", "name": "Wathsara Wishwantha Daluwatta"}}, "url": "https://github.com/wso2/identity-api-server/commit/fabd00fd3df7dd96fcfadb66eaab70ba8d0b56ed", "committedDate": "2020-01-27T06:15:52Z", "message": "Fixed the limit validation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NDU3NDY0", "url": "https://github.com/wso2/identity-api-server/pull/81#pullrequestreview-348457464", "createdAt": "2020-01-27T06:25:12Z", "commit": {"oid": "fabd00fd3df7dd96fcfadb66eaab70ba8d0b56ed"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a2bc42aadd7d2a302966545a6cbf35b05065308", "author": {"user": {"login": "Wathsara", "name": "Wathsara Wishwantha Daluwatta"}}, "url": "https://github.com/wso2/identity-api-server/commit/4a2bc42aadd7d2a302966545a6cbf35b05065308", "committedDate": "2020-01-27T12:00:18Z", "message": "Updated the identity framework version"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1404, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}