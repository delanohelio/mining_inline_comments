{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MTg5MjIy", "number": 222, "title": "Add API to check tenant availability.", "bodyText": "Purpose\n\nAdding API to get tenant by domain and just check the availability.\n\nEg.\nCheck domain availability\ncurl -k -v -X HEAD -H \"Authorization: Client ZGFzaGJvYXJkOmRhc2hib2FyZA==\"  \"https://localhost:9443/t/carbon.super/api/server/v1/tenants/domain/test.com\" \nResponse:\n200 --> Domain is taken.\n404 --> Domain is available.\nGet tenant by domain\ncurl -k -v -X GET -H \"Authorization: Client ZGFzaGJvYXJkOmRhc2hib2FyZA==\"  \"https://localhost:9443/t/carbon.super/api/server/v1/tenants/domain/test2.com\" \n{\"domain\":\"test.com\",\"owners\":[{\"username\":\"test\"}],\"createdDate\":\"2020-11-03T13:41:43.427Z\",\"lifecycleStatus\":{\"activated\":true}}\nFIxiing wso2/product-is#10044", "createdAt": "2020-11-02T16:50:18Z", "url": "https://github.com/wso2/identity-api-server/pull/222", "merged": true, "mergeCommit": {"oid": "7ec3f443cc26615eba9bfb2f667193a6aacf2aa5"}, "closed": true, "closedAt": "2020-11-04T03:29:05Z", "author": {"login": "Pushpalanka"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYncE9gH2gAyNTE0MTg5MjIyOjQ2YTlhNDQ2ZjEyZWU2MmFmMzdhYzE1N2JiMzMyNzI0OTdjNmY1NmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY9ejeAFqTUyMjc3MDk2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "46a9a446f12ee62af37ac157bb33272497c6f56b", "author": {"user": {"login": "Pushpalanka", "name": "Pushpalanka Jayawardhana"}}, "url": "https://github.com/wso2/identity-api-server/commit/46a9a446f12ee62af37ac157bb33272497c6f56b", "committedDate": "2020-11-02T16:48:23Z", "message": "Add API to check tenant availability."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0d5ce0418be6f056e5973cb5d93ecbb2954496a", "author": {"user": {"login": "Pushpalanka", "name": "Pushpalanka Jayawardhana"}}, "url": "https://github.com/wso2/identity-api-server/commit/d0d5ce0418be6f056e5973cb5d93ecbb2954496a", "committedDate": "2020-11-03T17:25:07Z", "message": "Add API to get tenant by domain and check domain existance."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNzM3MjUx", "url": "https://github.com/wso2/identity-api-server/pull/222#pullrequestreview-522737251", "createdAt": "2020-11-03T17:43:54Z", "commit": {"oid": "d0d5ce0418be6f056e5973cb5d93ecbb2954496a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzo0Mzo1NVrOHs51NA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzo0Mzo1NVrOHs51NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg0NjkwMA==", "bodyText": "summery: check tenant availability?", "url": "https://github.com/wso2/identity-api-server/pull/222#discussion_r516846900", "createdAt": "2020-11-03T17:43:55Z", "author": {"login": "IsuraD"}, "path": "components/org.wso2.carbon.identity.api.server.tenant.management/org.wso2.carbon.identity.api.server.tenant.management.v1/src/main/resources/tenant-management.yaml", "diffHunk": "@@ -171,6 +171,69 @@ paths:\n           $ref: '#/components/responses/NotFound'\n         '500':\n           $ref: '#/components/responses/ServerError'\n+  '/tenants/domain/{tenant-domain}':\n+    get:\n+      tags:\n+        - Tenants\n+      summary: Get tenant by domain.\n+      operationId: getTenantByDomain\n+      description: |\n+        Get the tenant using domain.\n+\n+        <b>Permission required:</b>\n+        * /permission/protected/manage/monitor/tenants/list\n+\n+        <b>scope required:</b>\n+        * internal_list_tenants\n+      parameters:\n+        - $ref: '#/components/parameters/tenantDomainPathParam'\n+      responses:\n+        '200':\n+          description: OK\n+          content:\n+            'application/json':\n+              schema:\n+                $ref: '#/components/schemas/TenantResponseModel'\n+        '400':\n+          $ref: '#/components/responses/InvalidInput'\n+        '401':\n+          $ref: '#/components/responses/Unauthorized'\n+        '403':\n+          $ref: '#/components/responses/Forbidden'\n+        '404':\n+          $ref: '#/components/responses/NotFound'\n+        '500':\n+          $ref: '#/components/responses/ServerError'\n+\n+    head:\n+      tags:\n+        - Tenants\n+      summary: Get tenant by domain.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0d5ce0418be6f056e5973cb5d93ecbb2954496a"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNzQxMDE0", "url": "https://github.com/wso2/identity-api-server/pull/222#pullrequestreview-522741014", "createdAt": "2020-11-03T17:48:49Z", "commit": {"oid": "d0d5ce0418be6f056e5973cb5d93ecbb2954496a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzo0ODo0OVrOHs6BEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzo0ODo0OVrOHs6BEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg0OTkzOQ==", "bodyText": "The method name and the response is contradicting, isn't it?\nwe return NOT_FOUND if the domain is available,\nand\nReturn OK if the domain is not available", "url": "https://github.com/wso2/identity-api-server/pull/222#discussion_r516849939", "createdAt": "2020-11-03T17:48:49Z", "author": {"login": "IsuraD"}, "path": "components/org.wso2.carbon.identity.api.server.tenant.management/org.wso2.carbon.identity.api.server.tenant.management.v1/src/main/java/org/wso2/carbon/identity/api/server/tenant/management/v1/impl/TenantsApiServiceImpl.java", "diffHunk": "@@ -74,4 +74,20 @@ private URI getResourceLocation(String resourceId) {\n         return ContextLoader.buildURIForHeader(Constants.V1_API_PATH_COMPONENT +\n                 TenantManagementConstants.TENANT_MANAGEMENT_PATH_COMPONENT + \"/\" + resourceId);\n     }\n+\n+    @Override\n+    public Response getTenantByDomain(String tenantDomain) {\n+\n+        return Response.ok().entity(tenantManagementService.getTenantByDomain(tenantDomain)).build();\n+    }\n+\n+    @Override\n+    public Response isDomainAvailable(String tenantDomain) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0d5ce0418be6f056e5973cb5d93ecbb2954496a"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4aaa4f14ea1f869d61dbf824109b1054d0f5ddca", "author": {"user": {"login": "Pushpalanka", "name": "Pushpalanka Jayawardhana"}}, "url": "https://github.com/wso2/identity-api-server/commit/4aaa4f14ea1f869d61dbf824109b1054d0f5ddca", "committedDate": "2020-11-03T17:49:03Z", "message": "Address review comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNzQzOTI4", "url": "https://github.com/wso2/identity-api-server/pull/222#pullrequestreview-522743928", "createdAt": "2020-11-03T17:52:30Z", "commit": {"oid": "4aaa4f14ea1f869d61dbf824109b1054d0f5ddca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzo1MjozMVrOHs6KTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzo1MjozMVrOHs6KTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg1MjMwMw==", "bodyText": "isDomainExists", "url": "https://github.com/wso2/identity-api-server/pull/222#discussion_r516852303", "createdAt": "2020-11-03T17:52:31Z", "author": {"login": "IsuraD"}, "path": "components/org.wso2.carbon.identity.api.server.tenant.management/org.wso2.carbon.identity.api.server.tenant.management.v1/src/main/resources/tenant-management.yaml", "diffHunk": "@@ -171,6 +171,69 @@ paths:\n           $ref: '#/components/responses/NotFound'\n         '500':\n           $ref: '#/components/responses/ServerError'\n+  '/tenants/domain/{tenant-domain}':\n+    get:\n+      tags:\n+        - Tenants\n+      summary: Get tenant by domain.\n+      operationId: getTenantByDomain\n+      description: |\n+        Get the tenant using domain.\n+\n+        <b>Permission required:</b>\n+        * /permission/protected/manage/monitor/tenants/list\n+\n+        <b>scope required:</b>\n+        * internal_list_tenants\n+      parameters:\n+        - $ref: '#/components/parameters/tenantDomainPathParam'\n+      responses:\n+        '200':\n+          description: OK\n+          content:\n+            'application/json':\n+              schema:\n+                $ref: '#/components/schemas/TenantResponseModel'\n+        '400':\n+          $ref: '#/components/responses/InvalidInput'\n+        '401':\n+          $ref: '#/components/responses/Unauthorized'\n+        '403':\n+          $ref: '#/components/responses/Forbidden'\n+        '404':\n+          $ref: '#/components/responses/NotFound'\n+        '500':\n+          $ref: '#/components/responses/ServerError'\n+\n+    head:\n+      tags:\n+        - Tenants\n+      summary: Check domain availability.\n+      operationId: isDomainAvailable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4aaa4f14ea1f869d61dbf824109b1054d0f5ddca"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "692cc9b3dac2ff7cf074c2e288a2ef4cbfe0f3d2", "author": {"user": {"login": "Pushpalanka", "name": "Pushpalanka Jayawardhana"}}, "url": "https://github.com/wso2/identity-api-server/commit/692cc9b3dac2ff7cf074c2e288a2ef4cbfe0f3d2", "committedDate": "2020-11-03T18:22:55Z", "message": "Address review comments."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "869e06cb23854d9ef2969fecb50c023a4fdd86f0", "author": {"user": {"login": "Pushpalanka", "name": "Pushpalanka Jayawardhana"}}, "url": "https://github.com/wso2/identity-api-server/commit/869e06cb23854d9ef2969fecb50c023a4fdd86f0", "committedDate": "2020-11-03T18:24:22Z", "message": "Address review comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNzcwOTYx", "url": "https://github.com/wso2/identity-api-server/pull/222#pullrequestreview-522770961", "createdAt": "2020-11-03T18:29:00Z", "commit": {"oid": "869e06cb23854d9ef2969fecb50c023a4fdd86f0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1402, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}