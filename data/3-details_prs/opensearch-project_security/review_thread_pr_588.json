{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MzY5MTc2", "number": 588, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwMTowNzoxMFrOESnM9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwMTowODozM1rOESnN7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3OTUyMTE4OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwMTowNzoxMFrOG347RA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwMTozMzoyMFrOG35XsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1NzU0MA==", "bodyText": "Why are we ignoring non cluster admin?", "url": "https://github.com/opensearch-project/security/pull/588#discussion_r461257540", "createdAt": "2020-07-28T01:07:10Z", "author": {"login": "debjanibnrj"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -272,6 +272,21 @@ public void logGrantedPrivileges(String privilege, TransportRequest request, Tas\n         }\n     }\n \n+    @Override\n+    public void logIndexEvent(String privilege, TransportRequest request, Task task) {\n+        if(!checkTransportFilter(AuditCategory.INDEX_EVENT, privilege, getUser(), request)) {\n+            return;\n+        }\n+        // log only cluster admin action\n+        if (!privilege.startsWith(\"indices:admin/\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd689ab92b72adfe7bafa2f885ed6205e4c267e7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1ODIxNg==", "bodyText": "We are interested only in Index actions https://opendistro.github.io/for-elasticsearch-docs/docs/security/access-control/permissions/#indices", "url": "https://github.com/opensearch-project/security/pull/588#discussion_r461258216", "createdAt": "2020-07-28T01:09:40Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -272,6 +272,21 @@ public void logGrantedPrivileges(String privilege, TransportRequest request, Tas\n         }\n     }\n \n+    @Override\n+    public void logIndexEvent(String privilege, TransportRequest request, Task task) {\n+        if(!checkTransportFilter(AuditCategory.INDEX_EVENT, privilege, getUser(), request)) {\n+            return;\n+        }\n+        // log only cluster admin action\n+        if (!privilege.startsWith(\"indices:admin/\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1NzU0MA=="}, "originalCommit": {"oid": "cd689ab92b72adfe7bafa2f885ed6205e4c267e7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1ODk1NQ==", "bodyText": "Index actions also include indices:data/* and indices:monitor/* options", "url": "https://github.com/opensearch-project/security/pull/588#discussion_r461258955", "createdAt": "2020-07-28T01:12:20Z", "author": {"login": "debjanibnrj"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -272,6 +272,21 @@ public void logGrantedPrivileges(String privilege, TransportRequest request, Tas\n         }\n     }\n \n+    @Override\n+    public void logIndexEvent(String privilege, TransportRequest request, Task task) {\n+        if(!checkTransportFilter(AuditCategory.INDEX_EVENT, privilege, getUser(), request)) {\n+            return;\n+        }\n+        // log only cluster admin action\n+        if (!privilege.startsWith(\"indices:admin/\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1NzU0MA=="}, "originalCommit": {"oid": "cd689ab92b72adfe7bafa2f885ed6205e4c267e7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI2MTg2MQ==", "bodyText": "indices:data involves document indexing and indices:monitor involves monitoring requests.\nWe are only interested in requests affecting an index like index is created, deleted, settings updated, close, open, update mappings so on.", "url": "https://github.com/opensearch-project/security/pull/588#discussion_r461261861", "createdAt": "2020-07-28T01:22:43Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -272,6 +272,21 @@ public void logGrantedPrivileges(String privilege, TransportRequest request, Tas\n         }\n     }\n \n+    @Override\n+    public void logIndexEvent(String privilege, TransportRequest request, Task task) {\n+        if(!checkTransportFilter(AuditCategory.INDEX_EVENT, privilege, getUser(), request)) {\n+            return;\n+        }\n+        // log only cluster admin action\n+        if (!privilege.startsWith(\"indices:admin/\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1NzU0MA=="}, "originalCommit": {"oid": "cd689ab92b72adfe7bafa2f885ed6205e4c267e7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI2MjY1OQ==", "bodyText": "Also document data access is already covered under compliance", "url": "https://github.com/opensearch-project/security/pull/588#discussion_r461262659", "createdAt": "2020-07-28T01:25:24Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -272,6 +272,21 @@ public void logGrantedPrivileges(String privilege, TransportRequest request, Tas\n         }\n     }\n \n+    @Override\n+    public void logIndexEvent(String privilege, TransportRequest request, Task task) {\n+        if(!checkTransportFilter(AuditCategory.INDEX_EVENT, privilege, getUser(), request)) {\n+            return;\n+        }\n+        // log only cluster admin action\n+        if (!privilege.startsWith(\"indices:admin/\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1NzU0MA=="}, "originalCommit": {"oid": "cd689ab92b72adfe7bafa2f885ed6205e4c267e7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI2NDgxNw==", "bodyText": "Thanks for the information.", "url": "https://github.com/opensearch-project/security/pull/588#discussion_r461264817", "createdAt": "2020-07-28T01:33:20Z", "author": {"login": "debjanibnrj"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -272,6 +272,21 @@ public void logGrantedPrivileges(String privilege, TransportRequest request, Tas\n         }\n     }\n \n+    @Override\n+    public void logIndexEvent(String privilege, TransportRequest request, Task task) {\n+        if(!checkTransportFilter(AuditCategory.INDEX_EVENT, privilege, getUser(), request)) {\n+            return;\n+        }\n+        // log only cluster admin action\n+        if (!privilege.startsWith(\"indices:admin/\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1NzU0MA=="}, "originalCommit": {"oid": "cd689ab92b72adfe7bafa2f885ed6205e4c267e7"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3OTUyMzY1OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/DisabledCategoriesTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwMTowODozM1rOG348rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwMToyMzozNVrOG35NGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1NzkwMg==", "bodyText": "nit: empty line", "url": "https://github.com/opensearch-project/security/pull/588#discussion_r461257902", "createdAt": "2020-07-28T01:08:33Z", "author": {"login": "debjanibnrj"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/DisabledCategoriesTest.java", "diffHunk": "@@ -209,6 +209,8 @@ protected void logAll(AuditLog auditLog) {\n \t\tlogTransportBadHeaders(auditLog);\n \t\tlogTransportFailedLogin(auditLog);\n \t\tlogTransportSucceededLogin(auditLog);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd689ab92b72adfe7bafa2f885ed6205e4c267e7"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI2MjEwNQ==", "bodyText": "There are new line separations above it hence added.", "url": "https://github.com/opensearch-project/security/pull/588#discussion_r461262105", "createdAt": "2020-07-28T01:23:35Z", "author": {"login": "sujithvm"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/DisabledCategoriesTest.java", "diffHunk": "@@ -209,6 +209,8 @@ protected void logAll(AuditLog auditLog) {\n \t\tlogTransportBadHeaders(auditLog);\n \t\tlogTransportFailedLogin(auditLog);\n \t\tlogTransportSucceededLogin(auditLog);\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI1NzkwMg=="}, "originalCommit": {"oid": "cd689ab92b72adfe7bafa2f885ed6205e4c267e7"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2374, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}