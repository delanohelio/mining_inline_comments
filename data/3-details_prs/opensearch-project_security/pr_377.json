{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzMzU2MDI2", "number": 377, "title": "[opendistro-0.9 backport] Implement APIs and datamodel to configure nodes_dn dynamically.", "bodyText": "This is a backport of pull request #362\nThe primary usecase is targeted at cross-cluster where in nodes restart\ncan be avoided by populating the coordinating cluster's nodes_dn values\nto facilitate cross-cluster usecases.\nSummary of changes:\n\nIntroduce \"nodesdn\" datatype to be stored in security index. In a way\nit is another permission entity similar to internaluser, role etc\nMake the above datatype backward compatible i.e do not fail other\noperations (roles, users etc)\nImplement APIs for CRUD operations that are only super-admin\naccessible and are only enabled based on a YML config value.\n\n\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.", "createdAt": "2020-04-14T18:53:04Z", "url": "https://github.com/opensearch-project/security/pull/377", "merged": true, "mergeCommit": {"oid": "d40cfc409c2080b1d580c91de3c909964c5208b0"}, "closed": true, "closedAt": "2020-04-21T07:18:55Z", "author": {"login": "krishna-ggk"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXoAlhgH2gAyNDAzMzU2MDI2OjQ2MGJlYzlmMjg5ZTgxOWIzNjM0ODA2ZmI5MTM5MTg1NThjNDBiNmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZuafAgFqTM5NzA1MTA1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "460bec9f289e819b3634806fb913918558c40b6f", "author": {"user": {"login": "krishna-ggk", "name": "Gopala Krishna A"}}, "url": "https://github.com/opensearch-project/security/commit/460bec9f289e819b3634806fb913918558c40b6f", "committedDate": "2020-04-14T18:43:11Z", "message": "Implement APIs and datamodel to configure nodes_dn dynamically.\n\nThis is a backport of pull request #362\n\nThe primary usecase is targeted at cross-cluster where in nodes restart\ncan be avoided by populating the coordinating cluster's nodes_dn values\nto facilitate cross-cluster usecases.\n\n**Summary of changes**:\n\n- Introduce \"nodesdn\" datatype to be stored in security index. In a way\n  it is another permission entity similar to internaluser, role etc\n- Make the above datatype backward compatible i.e do not fail other\n  operations (roles, users etc)\n- Implement APIs for CRUD operations that are only super-admin\n  accessible and are only enabled based on a YML config value."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f36d8bf36aefbed4a3fc8d2b5fa26da5b026ef56", "author": {"user": {"login": "krishna-ggk", "name": "Gopala Krishna A"}}, "url": "https://github.com/opensearch-project/security/commit/f36d8bf36aefbed4a3fc8d2b5fa26da5b026ef56", "committedDate": "2020-04-14T19:09:57Z", "message": "Fix ccs test."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MTEyNjIz", "url": "https://github.com/opensearch-project/security/pull/377#pullrequestreview-395112623", "createdAt": "2020-04-17T01:58:38Z", "commit": {"oid": "f36d8bf36aefbed4a3fc8d2b5fa26da5b026ef56"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwMTo1ODozOFrOGG9R2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwMjowMzowMVrOGG9V8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTk0ODYzMw==", "bodyText": "nit: use Settings.Empty", "url": "https://github.com/opensearch-project/security/pull/377#discussion_r409948633", "createdAt": "2020-04-17T01:58:38Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/configuration/ConfigurationLoader.java", "diffHunk": "@@ -103,6 +103,10 @@ public void singleFailure(Failure failure) {\n             @Override\n             public void noData(String id) {\n                 log.warn(\"No data for {} while retrieving configuration for {}  (index={})\", id, Arrays.toString(events), opendistrosecurityIndex);\n+                if (ConfigConstants.NEW_CONFIG_NAMES.contains(id)) {\n+                    rs.put(id, new Tuple<>(IndexBaseConfigurationRepository.EMPTY_DOCUMENT_VERSION, Settings.builder().build()));\n+                    latch.countDown();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f36d8bf36aefbed4a3fc8d2b5fa26da5b026ef56"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTk0OTY4Mg==", "bodyText": "nit: Is it possible to make another constant variable for this?\nConfigConstants.ALL_CONFIG_NAMES.toArray(new String[0]) as it seems to be used quite a lot.", "url": "https://github.com/opensearch-project/security/pull/377#discussion_r409949682", "createdAt": "2020-04-17T02:03:01Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/AbstractApiAction.java", "diffHunk": "@@ -346,7 +346,7 @@ public ConfigUpdatingActionListener(Client client, ActionListener<Response> dele\n \t\t@Override\n \t\tpublic void onResponse(Response response) {\n \n-\t\t\tfinal ConfigUpdateRequest cur = new ConfigUpdateRequest(new String[] { \"config\", \"roles\", \"rolesmapping\", \"internalusers\", \"actiongroups\" });\n+\t\t\tfinal ConfigUpdateRequest cur = new ConfigUpdateRequest(ConfigConstants.ALL_CONFIG_NAMES.toArray(new String[0]));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f36d8bf36aefbed4a3fc8d2b5fa26da5b026ef56"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3MDUxMDUy", "url": "https://github.com/opensearch-project/security/pull/377#pullrequestreview-397051052", "createdAt": "2020-04-21T07:18:45Z", "commit": {"oid": "f36d8bf36aefbed4a3fc8d2b5fa26da5b026ef56"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2875, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}