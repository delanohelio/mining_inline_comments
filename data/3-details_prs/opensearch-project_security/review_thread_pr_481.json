{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2MTA5NTMw", "number": 481, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNDo1Mzo1OFrOEBl89w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNTozMjoxM1rOEBmWWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMTA1ODQ3OnYy", "diffSide": "RIGHT", "path": ".github/workflows/cd.yml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNDo1Mzo1OFrOGdiBbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNDo1Mzo1OFrOGdiBbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYxOTMxMA==", "bodyText": "I think clean target is not necessary as it is already part of the Build step.", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r433619310", "createdAt": "2020-06-02T04:53:58Z", "author": {"login": "vrozov"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMTA5OTQ0OnYy", "diffSide": "RIGHT", "path": ".github/workflows/cd.yml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNToxOTo1NFrOGdiaNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNToxOTo1NFrOGdiaNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNTY1NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n          \n          \n            \n                   gpg --batch --import --no-tty <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\")", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r433625655", "createdAt": "2020-06-02T05:19:54Z", "author": {"login": "vrozov"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMTEwMzAyOnYy", "diffSide": "RIGHT", "path": ".github/workflows/cd.yml", "isResolved": true, "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNToyMTo0MFrOGdicPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMjoyOToyNVrOGeGFSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg==", "bodyText": "GPG_PASSPHRASE -> PGP_PASSPHRASE or PGP_PRIVATE_KEY -> GPG_PRIVATE_KEY", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r433626172", "createdAt": "2020-06-02T05:21:40Z", "author": {"login": "vrozov"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAwNjQwMg==", "bodyText": "@gaiksaya Could you confirm this? Looks like we have GPG_PASSPHRASE and PGP_PRIVATE_KEY", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434006402", "createdAt": "2020-06-02T16:18:36Z", "author": {"login": "sujithvm"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAwOTMwMg==", "bodyText": "Yes that's right @sujithvm along with pgp public key", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434009302", "createdAt": "2020-06-02T16:23:05Z", "author": {"login": "gaiksaya"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDAyNDQxOQ==", "bodyText": "It should be consistent, either PGP or GPG. Public key is not a secret.", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434024419", "createdAt": "2020-06-02T16:47:17Z", "author": {"login": "vrozov"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDA0MzQxMg==", "bodyText": "Are you saying the key/passphrase itself or the names here must be consistent? I don't know how both were generated.\nI think we just private key to sign the artifact and public key seems to be already distributed here http://pool.sks-keyservers.net/pks/lookup?search=OpenDistroForElasticsearch&fingerprint=on&op=index", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434043412", "createdAt": "2020-06-02T17:19:12Z", "author": {"login": "sujithvm"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDEwNzYzOA==", "bodyText": "Actually both, passphrase should be for the generated private key and names needs to be consistent as they refer to a related settings.\nPublic key does not need to be added to the secrets.", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434107638", "createdAt": "2020-06-02T18:56:28Z", "author": {"login": "vrozov"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE3MDgzNQ==", "bodyText": "Not referencing public key here so it is not added to secrets.\nLooking at this https://blog.sonatype.com/2010/01/how-to-generate-pgp-signatures-with-maven/ it looks fine to have pgp signing key with gpg passphrase and names need not be consistent.\nThe passphrase seems to be generated for the private key only.\n@vrozov Am I missing something?", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434170835", "createdAt": "2020-06-02T20:56:45Z", "author": {"login": "sujithvm"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwMzUzMg==", "bodyText": "Not referencing public key here so it is not added to secrets.\n\nCorrect, I replied to @gaiksaya in response to\n\nYes that's right @sujithvm along with pgp public key\n\n\nLooking at this https://blog.sonatype.com/2010/01/how-to-generate-pgp-signatures-with-maven/ it looks fine to have pgp signing key with gpg passphrase and names need not be consistent.\n\nThere is only (pgp/gpg) signing key that is protected by (pgp/gpg) password. If you refer to it as a pgp key, should not it be pgp password/passphrase? Note that gpg is one of implementations of pgp spec, so it will be better either to use implementation (gpg) or spec (pgp) to refer to a (private) key and it's passphrase.", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434203532", "createdAt": "2020-06-02T22:11:07Z", "author": {"login": "vrozov"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwNTMxNA==", "bodyText": "Are you asking to rename the secret secrets.GPG_PASSPHRASE to secrets.PGP_PASSPHRASE  ? And have -Dgpg.passphrase=${{ secrets.PGP_PASSPHRASE }} ?", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434205314", "createdAt": "2020-06-02T22:15:58Z", "author": {"login": "sujithvm"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwNzYyNQ==", "bodyText": "Yes :)", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434207625", "createdAt": "2020-06-02T22:22:29Z", "author": {"login": "vrozov"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIxMDEyMQ==", "bodyText": "\ud83d\ude04 I was assuming there was some mistake in the way the signatures were made making them incompatible", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r434210121", "createdAt": "2020-06-02T22:29:25Z", "author": {"login": "sujithvm"}, "path": ".github/workflows/cd.yml", "diffHunk": "@@ -53,6 +56,14 @@ jobs:\n         aws s3 cp artifacts/*.rpm $s3_path/rpms/opendistro-security/\n         aws cloudfront create-invalidation --distribution-id ${{ secrets.DISTRIBUTION_ID }} --paths '/downloads/*'\n \n+    - name: Upload Artifacts to Maven Central\n+      env:\n+        SONATYPE_USER: ${{ secrets.SONATYPE_USER }}\n+        SONATYPE_PASSWORD: ${{ secrets.SONATYPE_PASSWORD }}\n+      run: |\n+        cat <(echo -e \"${{ secrets.PGP_PRIVATE_KEY }}\") | gpg --batch --import\n+        mvn -B clean deploy -Padvanced -Prelease -DskipTests -Dgpg.passphrase=${{ secrets.GPG_PASSPHRASE }}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyNjE3Mg=="}, "originalCommit": null, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwMTEyMzQ3OnYy", "diffSide": "RIGHT", "path": "pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNTozMjoxM1rOGdioOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwNTozMjoxM1rOGdioOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzYyOTI0MQ==", "bodyText": "Consider moving to release profile.", "url": "https://github.com/opensearch-project/security/pull/481#discussion_r433629241", "createdAt": "2020-06-02T05:32:13Z", "author": {"login": "vrozov"}, "path": "pom.xml", "diffHunk": "@@ -58,6 +58,14 @@\n         </developer>\n     </developers>\n \n+    <distributionManagement>", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2460, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}