{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwNDIwMjk1", "number": 653, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMToxMjo0M1rOEaJ0nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMToxMjo0M1rOEaJ0nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1ODU5MzU3OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMToxMjo0M1rOHDZfxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwMDozNjoyMFrOHDiwtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMyNTUwOQ==", "bodyText": "What are the actions under internal: ?", "url": "https://github.com/opensearch-project/security/pull/653#discussion_r473325509", "createdAt": "2020-08-19T21:12:43Z", "author": {"login": "hardik-k-shah"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -646,19 +646,7 @@ boolean checkTransportFilter(final AuditCategory category, final String action,\n         }\n \n         //skip internals\n-        if(action != null\n-                &&\n-                ( action.startsWith(\"internal:\")\n-                        || action.startsWith(\"cluster:monitor\")\n-                        || action.startsWith(\"indices:monitor\")\n-                )\n-        ) {\n-\n-\n-            //if(log.isTraceEnabled()) {\n-            //    log.trace(\"Skipped audit log message due to category ({}) or action ({}) does not match\", category, action);\n-            //}\n-\n+        if (action != null && action.startsWith(\"internal:\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1beafcc7623a6c570740ea1b4ff02ecc2ef716c1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ3NzMwMQ==", "bodyText": "Internal actions seem to be used for core ES functionality only and not for user generated actions. Here are some of the internal actions\n\ninternal:coordination/fault_detection/leader_check\ninternal:coordination/fault_detection/follower_check\ninternal:cluster/coordination/join\ninternal:cluster/coordination/join/validate\ninternal:cluster/coordination/start_join\ninternal:cluster/request_pre_vote\ninternal:cluster/coordination/publish_state\ninternal:cluster/coordination/commit_state\ninternal:cluster/node/mapping/refresh\ninternal:cluster/shard/started\ninternal:cluster/shard/failure\ninternal:admin/tasks/ban\ninternal:index/shard/recovery/start_recovery\ninternal:index/shard/recovery/reestablish_recovery\ninternal:index/shard/recovery/filesInfo\ninternal:index/shard/recovery/file_chunk\ninternal:index/shard/recovery/clean_files\ninternal:index/shard/recovery/translog_ops\ninternal:index/shard/recovery/prepare_translog\ninternal:index/shard/recovery/finalize\ninternal:index/shard/recovery/handoff_primary_context\ninternal:index/shard/exists\ninternal:cluster/nodes/indices/shard/store\ninternal:tcp/handshake\ninternal:transport/handshake\ninternal:transport/proxy/\ninternal:cluster/snapshot/update_snapshot_status\ninternal:admin/repository/verify\ninternal:indices/admin/upgrade\ninternal:indices/flush/synced/pre\ninternal:index/seq_no/resync\ninternal:gateway/local/started_shards\ninternal:gateway/local/meta_state\ninternal:gateway/local/allocate_dangled", "url": "https://github.com/opensearch-project/security/pull/653#discussion_r473477301", "createdAt": "2020-08-20T00:36:20Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/auditlog/impl/AbstractAuditLog.java", "diffHunk": "@@ -646,19 +646,7 @@ boolean checkTransportFilter(final AuditCategory category, final String action,\n         }\n \n         //skip internals\n-        if(action != null\n-                &&\n-                ( action.startsWith(\"internal:\")\n-                        || action.startsWith(\"cluster:monitor\")\n-                        || action.startsWith(\"indices:monitor\")\n-                )\n-        ) {\n-\n-\n-            //if(log.isTraceEnabled()) {\n-            //    log.trace(\"Skipped audit log message due to category ({}) or action ({}) does not match\", category, action);\n-            //}\n-\n+        if (action != null && action.startsWith(\"internal:\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMyNTUwOQ=="}, "originalCommit": {"oid": "1beafcc7623a6c570740ea1b4ff02ecc2ef716c1"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2283, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}