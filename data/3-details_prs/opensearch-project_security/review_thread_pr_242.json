{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MjgzNjA2", "number": 242, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxOTozMzowNlrODi0u4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMDo1NjoxMFrODjPOtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3ODQyMTQ0OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/AbstractApiAction.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxOTozMzowNlrOFuSXMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxOTo0NToxMVrOFuSw1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA3OTY2Nw==", "bodyText": "PR looks good to me.\nNot sure if there is a better name for isReservedAndAccessibleToSuperAdmin or maybe use isReserved itself and document that super admins can update reserved resources.", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384079667", "createdAt": "2020-02-25T19:33:06Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/AbstractApiAction.java", "diffHunk": "@@ -537,4 +538,17 @@ public String getName() {\n \n \tprotected abstract Endpoint getEndpoint();\n \n+\tprotected boolean isSuperAdmin() {\n+\t\tUser user = threadPool.getThreadContext().getTransient(ConfigConstants.OPENDISTRO_SECURITY_USER);\n+\t\treturn adminDNs.isAdmin(user);\n+\t}\n+\n+\tprotected boolean isReservedAndAccessibleToSuperAdmin(final SecurityDynamicConfiguration<?> existingConfiguration,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd25120141ebf3a969f28d87d04c09a60a786458"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA4MDI4OQ==", "bodyText": "What are your thoughts?", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384080289", "createdAt": "2020-02-25T19:34:19Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/AbstractApiAction.java", "diffHunk": "@@ -537,4 +538,17 @@ public String getName() {\n \n \tprotected abstract Endpoint getEndpoint();\n \n+\tprotected boolean isSuperAdmin() {\n+\t\tUser user = threadPool.getThreadContext().getTransient(ConfigConstants.OPENDISTRO_SECURITY_USER);\n+\t\treturn adminDNs.isAdmin(user);\n+\t}\n+\n+\tprotected boolean isReservedAndAccessibleToSuperAdmin(final SecurityDynamicConfiguration<?> existingConfiguration,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA3OTY2Nw=="}, "originalCommit": {"oid": "dd25120141ebf3a969f28d87d04c09a60a786458"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA4MjUzOA==", "bodyText": "I think rename is required. From what I think, isReservedAndAccessible should be the one. Because it will make more sense. isReserved we can do but I think it wont go with the code.\nYour call - isReserved or isReservedAndAccessible?", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384082538", "createdAt": "2020-02-25T19:38:26Z", "author": {"login": "palashhedau"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/AbstractApiAction.java", "diffHunk": "@@ -537,4 +538,17 @@ public String getName() {\n \n \tprotected abstract Endpoint getEndpoint();\n \n+\tprotected boolean isSuperAdmin() {\n+\t\tUser user = threadPool.getThreadContext().getTransient(ConfigConstants.OPENDISTRO_SECURITY_USER);\n+\t\treturn adminDNs.isAdmin(user);\n+\t}\n+\n+\tprotected boolean isReservedAndAccessibleToSuperAdmin(final SecurityDynamicConfiguration<?> existingConfiguration,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA3OTY2Nw=="}, "originalCommit": {"oid": "dd25120141ebf3a969f28d87d04c09a60a786458"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA4MzkyNw==", "bodyText": "Are there any resources which are reserved and not accessible to super-admins ?", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384083927", "createdAt": "2020-02-25T19:41:02Z", "author": {"login": "sujithvm"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/AbstractApiAction.java", "diffHunk": "@@ -537,4 +538,17 @@ public String getName() {\n \n \tprotected abstract Endpoint getEndpoint();\n \n+\tprotected boolean isSuperAdmin() {\n+\t\tUser user = threadPool.getThreadContext().getTransient(ConfigConstants.OPENDISTRO_SECURITY_USER);\n+\t\treturn adminDNs.isAdmin(user);\n+\t}\n+\n+\tprotected boolean isReservedAndAccessibleToSuperAdmin(final SecurityDynamicConfiguration<?> existingConfiguration,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA3OTY2Nw=="}, "originalCommit": {"oid": "dd25120141ebf3a969f28d87d04c09a60a786458"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA4NjIyOA==", "bodyText": "We are allowing actiongroups, internalusers, roles, rolesmapping, tenants.\nAccount & Permission is not allowed to edit.\nAre they also required?", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384086228", "createdAt": "2020-02-25T19:45:11Z", "author": {"login": "palashhedau"}, "path": "src/main/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/AbstractApiAction.java", "diffHunk": "@@ -537,4 +538,17 @@ public String getName() {\n \n \tprotected abstract Endpoint getEndpoint();\n \n+\tprotected boolean isSuperAdmin() {\n+\t\tUser user = threadPool.getThreadContext().getTransient(ConfigConstants.OPENDISTRO_SECURITY_USER);\n+\t\treturn adminDNs.isAdmin(user);\n+\t}\n+\n+\tprotected boolean isReservedAndAccessibleToSuperAdmin(final SecurityDynamicConfiguration<?> existingConfiguration,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA3OTY2Nw=="}, "originalCommit": {"oid": "dd25120141ebf3a969f28d87d04c09a60a786458"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MjcwNTc2OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/ActionGroupsApiTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMDozOTowMFrOFu7XDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoyNTo1NlrOFu-pww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1MTM3Mw==", "bodyText": "Should we rename it to testActionGroupsApiForNonSuperAdmin() ?", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384751373", "createdAt": "2020-02-26T20:39:00Z", "author": {"login": "hardik-k-shah"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/ActionGroupsApiTest.java", "diffHunk": "@@ -298,4 +307,36 @@ public void testActionGroupsApi() throws Exception {\n         Assert.assertEquals(1, permissions.size());\n         Assert.assertTrue(permissions.contains(\"READ_UT\"));        \n \t}\n+\n+    @Test\n+    public void testActionGroupsApiWithoutCertificate() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "321817c808e0f54529d5220fece033a491c78070"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgwNTMxNQ==", "bodyText": "Make sense. Changed.", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384805315", "createdAt": "2020-02-26T22:25:56Z", "author": {"login": "palashhedau"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/ActionGroupsApiTest.java", "diffHunk": "@@ -298,4 +307,36 @@ public void testActionGroupsApi() throws Exception {\n         Assert.assertEquals(1, permissions.size());\n         Assert.assertTrue(permissions.contains(\"READ_UT\"));        \n \t}\n+\n+    @Test\n+    public void testActionGroupsApiWithoutCertificate() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1MTM3Mw=="}, "originalCommit": {"oid": "321817c808e0f54529d5220fece033a491c78070"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4Mjc2Mjc3OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/ActionGroupsApiTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMDo1NjoxMVrOFu75ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoyNTozN1rOFu-pMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc2MDI1OQ==", "bodyText": "lets rename sendHTTPClientCertificate to presentAdminCertificate or sendAdminCertificate", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384760259", "createdAt": "2020-02-26T20:56:11Z", "author": {"login": "hardik-k-shah"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/ActionGroupsApiTest.java", "diffHunk": "@@ -193,9 +195,10 @@ public void testActionGroupsApi() throws Exception {\n         Assert.assertEquals(HttpStatus.SC_NOT_FOUND, response.getStatusCode());\n \n         // PATCH read only resource, must be forbidden\n+        // SuperAdmin can patch read only resource", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "321817c808e0f54529d5220fece033a491c78070"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgwNTE3MQ==", "bodyText": "renamed to sendAdminCertificate", "url": "https://github.com/opensearch-project/security/pull/242#discussion_r384805171", "createdAt": "2020-02-26T22:25:37Z", "author": {"login": "palashhedau"}, "path": "src/test/java/com/amazon/opendistroforelasticsearch/security/dlic/rest/api/ActionGroupsApiTest.java", "diffHunk": "@@ -193,9 +195,10 @@ public void testActionGroupsApi() throws Exception {\n         Assert.assertEquals(HttpStatus.SC_NOT_FOUND, response.getStatusCode());\n \n         // PATCH read only resource, must be forbidden\n+        // SuperAdmin can patch read only resource", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc2MDI1OQ=="}, "originalCommit": {"oid": "321817c808e0f54529d5220fece033a491c78070"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2527, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}