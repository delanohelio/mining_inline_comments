{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NzIxOTE1", "number": 836, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo1MDoyMFrOE3aGJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjoxMjozMFrOE3gOEA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTM0NjkzOnYy", "diffSide": "RIGHT", "path": "src/main/resources/static_config/static_roles.yml", "isResolved": true, "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMDo1MDoyMFrOHwvGhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzo0Mjo1MFrOHwz9CQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ==", "bodyText": "Why kibana_server role needs this permission?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520865415", "createdAt": "2020-11-10T20:50:20Z", "author": {"login": "hardik-k-shah"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg3Mzg3OA==", "bodyText": "Kibana reporting plugin runs a background thread to poll job from ES reporting plugin. The Kibana executes the job in background and sends notification. It also updates status of the reports.", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520873878", "createdAt": "2020-11-10T21:06:38Z", "author": {"login": "akbhatta"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkyNzgyMQ==", "bodyText": "And I believe we are planning to use kibanaserver user (which is mapped to kibana_server role) for running those background job ?\nWhat exactly these two permissions are ? Can you describe more in details?\n'cluster:admin/opendistro/reports/'\n'cluster:admin/opendistro/notifications/'\nis there any other option to avoid using kibanaserver user?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520927821", "createdAt": "2020-11-10T22:58:24Z", "author": {"login": "hardik-k-shah"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkyNzkxMw==", "bodyText": "Also please keep formatting same and use double quote instead single and move them before \"indices:admin\"", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520927913", "createdAt": "2020-11-10T22:58:34Z", "author": {"login": "hardik-k-shah"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMjA2NQ==", "bodyText": "And I believe we are planning to use kibanaserver user (which is mapped to kibana_server role) for running those background job ?\nWhat exactly these two permissions are ? Can you describe more in details?\n'cluster:admin/opendistro/reports/' 'cluster:admin/opendistro/notifications/'\nis there any other option to avoid using kibanaserver user?\n\nWould it be better to add a new user and grant the permission to it?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520932065", "createdAt": "2020-11-10T23:08:56Z", "author": {"login": "cliu123"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMjA3OQ==", "bodyText": "Yes. kibanaserver is used for running background job.\ncluster:admin/opendistro/notifications/* --> Send mail operation using notification plugin(currently there is only 1 operation).\ncluster:admin/opendistro/reports/ --> all operations of reports plugin (currently we are using get_all, get, update, poll operations)\nWe are open to suggestion on using any system user for background operation. We cannot use the user role as until we pick the job we don't know which user is that job for.\nWill update quite ' --> \" and move before indices:admin", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520932079", "createdAt": "2020-11-10T23:08:59Z", "author": {"login": "akbhatta"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNDgwMA==", "bodyText": "is it preferred to explicitly add all used operations or use \"*\"?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520934800", "createdAt": "2020-11-10T23:15:59Z", "author": {"login": "akbhatta"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNzg0NQ==", "bodyText": "I would really prefer to use different user for background jobs instead piggybacking on kibanaserver user.\nYou can have that user in reporting/notification configuration and if needed we can also add it into kibana config\nkibanaserver is just for kibana to run healthcheck and other calls for kibana UI. And hence kept it with very minimal set of permissions.\nAdditionally, due to security threat associated with kibanaserver user, we want to keep permission very minimal to avoid any kibana user to gain benefit of kibanaserver user permission.\nAre reporting and notification plugins read 'kibanaserver' user and credential from kibana.yml and use it for background job?\nif yes, then can each plugin have their own user with its own default role with limited set of permission?  And can this user be defined in plugin configuration file ?  (I would prefer it into plugin yml file instead kibana.yml if possible)", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520937845", "createdAt": "2020-11-10T23:23:51Z", "author": {"login": "hardik-k-shah"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk0NDkwNQ==", "bodyText": "Are reporting and notification plugins read 'kibanaserver' user and credential from kibana.yml and use it for background job? --> NO. I believe kibana is already running with this user and no need to store/manage credential (refer \u201ccallWithInternalUser\u201c). Please let me know if my understanding is wrong.\nLet me add explicit operation instead of *", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520944905", "createdAt": "2020-11-10T23:42:50Z", "author": {"login": "akbhatta"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -85,6 +85,8 @@ kibana_server:\n   - \"cluster:admin/xpack/monitoring*\"\n   - \"indices:admin/template*\"\n   - \"indices:data/read/scroll*\"\n+  - 'cluster:admin/opendistro/reports/*'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDg2NTQxNQ=="}, "originalCommit": null, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTc3MDA3OnYy", "diffSide": "RIGHT", "path": "securityconfig/elasticsearch.yml.example", "isResolved": true, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzowNTo0N1rOHwzGQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzozNTo0MVrOHwzyuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMDg4MA==", "bodyText": "This is example, but curious why you want to add reports to protected_indices?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520930880", "createdAt": "2020-11-10T23:05:47Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/elasticsearch.yml.example", "diffHunk": "@@ -215,11 +215,11 @@ opendistro_security.audit.type: internal_elasticsearch\n # Specify a list of roles a user must be member of to touch any protected index.\n # opendistro_security.protected_indices.roles: ['all_access']\n # Specify a list of indices to mark as protected. These indices will only be visible / mutable by members of the above setting, in addition to needing permission to the index via a normal role.\n-# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*']\n+# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*', '.opendistro-reports-*', '.opendistro-notifications-*']", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNTM1Nw==", "bodyText": "If system index is not enabled then could it be configured as protected?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520935357", "createdAt": "2020-11-10T23:17:23Z", "author": {"login": "akbhatta"}, "path": "securityconfig/elasticsearch.yml.example", "diffHunk": "@@ -215,11 +215,11 @@ opendistro_security.audit.type: internal_elasticsearch\n # Specify a list of roles a user must be member of to touch any protected index.\n # opendistro_security.protected_indices.roles: ['all_access']\n # Specify a list of indices to mark as protected. These indices will only be visible / mutable by members of the above setting, in addition to needing permission to the index via a normal role.\n-# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*']\n+# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*', '.opendistro-reports-*', '.opendistro-notifications-*']", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMDg4MA=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzODY4Mg==", "bodyText": "are these indices created only for plugin to consume (like alerting and ISM indices )?\ndoes any of the users including admin need direct access to this indices using ES APIs?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520938682", "createdAt": "2020-11-10T23:26:05Z", "author": {"login": "hardik-k-shah"}, "path": "securityconfig/elasticsearch.yml.example", "diffHunk": "@@ -215,11 +215,11 @@ opendistro_security.audit.type: internal_elasticsearch\n # Specify a list of roles a user must be member of to touch any protected index.\n # opendistro_security.protected_indices.roles: ['all_access']\n # Specify a list of indices to mark as protected. These indices will only be visible / mutable by members of the above setting, in addition to needing permission to the index via a normal role.\n-# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*']\n+# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*', '.opendistro-reports-*', '.opendistro-notifications-*']", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMDg4MA=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzOTQ1MQ==", "bodyText": "are these indices created only for plugin to consume (like alerting and ISM indices )? --> YES\ndoes any of the users including admin need direct access to this indices using ES APIs? --> NO. users should not have direct access", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520939451", "createdAt": "2020-11-10T23:28:08Z", "author": {"login": "akbhatta"}, "path": "securityconfig/elasticsearch.yml.example", "diffHunk": "@@ -215,11 +215,11 @@ opendistro_security.audit.type: internal_elasticsearch\n # Specify a list of roles a user must be member of to touch any protected index.\n # opendistro_security.protected_indices.roles: ['all_access']\n # Specify a list of indices to mark as protected. These indices will only be visible / mutable by members of the above setting, in addition to needing permission to the index via a normal role.\n-# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*']\n+# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*', '.opendistro-reports-*', '.opendistro-notifications-*']", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMDg4MA=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk0MDM0NA==", "bodyText": "then these indices should be part of system indices and not protected indices.\nprotected indices will be deprecated once all plugin move their indices to system indices.", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520940344", "createdAt": "2020-11-10T23:30:28Z", "author": {"login": "hardik-k-shah"}, "path": "securityconfig/elasticsearch.yml.example", "diffHunk": "@@ -215,11 +215,11 @@ opendistro_security.audit.type: internal_elasticsearch\n # Specify a list of roles a user must be member of to touch any protected index.\n # opendistro_security.protected_indices.roles: ['all_access']\n # Specify a list of indices to mark as protected. These indices will only be visible / mutable by members of the above setting, in addition to needing permission to the index via a normal role.\n-# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*']\n+# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*', '.opendistro-reports-*', '.opendistro-notifications-*']", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMDg4MA=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk0MjEzMA==", "bodyText": "Yes, protected_indices will be deprecated.", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520942130", "createdAt": "2020-11-10T23:35:21Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/elasticsearch.yml.example", "diffHunk": "@@ -215,11 +215,11 @@ opendistro_security.audit.type: internal_elasticsearch\n # Specify a list of roles a user must be member of to touch any protected index.\n # opendistro_security.protected_indices.roles: ['all_access']\n # Specify a list of indices to mark as protected. These indices will only be visible / mutable by members of the above setting, in addition to needing permission to the index via a normal role.\n-# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*']\n+# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*', '.opendistro-reports-*', '.opendistro-notifications-*']", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMDg4MA=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk0MjI2NA==", "bodyText": "will remove.", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520942264", "createdAt": "2020-11-10T23:35:41Z", "author": {"login": "akbhatta"}, "path": "securityconfig/elasticsearch.yml.example", "diffHunk": "@@ -215,11 +215,11 @@ opendistro_security.audit.type: internal_elasticsearch\n # Specify a list of roles a user must be member of to touch any protected index.\n # opendistro_security.protected_indices.roles: ['all_access']\n # Specify a list of indices to mark as protected. These indices will only be visible / mutable by members of the above setting, in addition to needing permission to the index via a normal role.\n-# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*']\n+# opendistro_security.protected_indices.indices: ['.opendistro-alerting-config', '.opendistro-ism-*', '.opendistro-reports-*', '.opendistro-notifications-*']", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMDg4MA=="}, "originalCommit": null, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTc3NTkzOnYy", "diffSide": "RIGHT", "path": "securityconfig/roles.yml", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzowODowNFrOHwzJow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQyMDoxNTowMVrOHyMZWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMTc0Nw==", "bodyText": "What the difference betweenget and get_all ? Why we have to two API?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520931747", "createdAt": "2020-11-10T23:08:04Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMjkzMg==", "bodyText": "yes they are 2 different APIs. thinking again may be it makes sense to rename get_all to list", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520932932", "createdAt": "2020-11-10T23:11:10Z", "author": {"login": "akbhatta"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMTc0Nw=="}, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNTE3Nw==", "bodyText": "Standard way is have action as cluster:admin/opendistro/reports/instance/get and API like GET reports\\{id} gets single report GET \\reports get all reports. You also can support filters as required.  This is how we do on Alerting: https://github.com/opendistro-for-elasticsearch/alerting/blob/master/alerting/src/main/kotlin/com/amazon/opendistroforelasticsearch/alerting/resthandler/RestGetDestinationsAction.kt", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520935177", "createdAt": "2020-11-10T23:16:58Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMTc0Nw=="}, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzNzQ1Nw==", "bodyText": "How to support response uniformity with pagination support? Initially we had the same way but then changed to 2 separate APIs.", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520937457", "createdAt": "2020-11-10T23:22:46Z", "author": {"login": "akbhatta"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMTc0Nw=="}, "originalCommit": null, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM5Mzk0Ng==", "bodyText": "example: https://restfulapi.net/http-methods/#get", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r522393946", "createdAt": "2020-11-12T20:15:01Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMTc0Nw=="}, "originalCommit": null, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTc3ODc4OnYy", "diffSide": "RIGHT", "path": "securityconfig/roles.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzowOToxNlrOHwzLXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQyMzoxMDo0OVrOHwzNsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMjE5MA==", "bodyText": "What the difference between get and get_all ? Why we have to two API?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520932190", "createdAt": "2020-11-10T23:09:16Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to read and download Reports and Report-definitions\n+reports_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/get'\n+    - 'cluster:admin/opendistro/reports/definition/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMjc4NQ==", "bodyText": "yes they are 2 different APIs. thinking again may be it makes sense to rename get_all to list", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520932785", "createdAt": "2020-11-10T23:10:49Z", "author": {"login": "akbhatta"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to read and download Reports and Report-definitions\n+reports_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/get'\n+    - 'cluster:admin/opendistro/reports/definition/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get_all'\n+    - 'cluster:admin/opendistro/reports/instance/get'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDkzMjE5MA=="}, "originalCommit": null, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NTk0MDI3OnYy", "diffSide": "RIGHT", "path": "src/main/resources/static_config/static_roles.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMDoxNzoxNFrOHw0rHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMDoyMzo1MVrOHw0zoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk1NjcwMw==", "bodyText": "Can you describe each of these permissions?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520956703", "createdAt": "2020-11-11T00:17:14Z", "author": {"login": "hardik-k-shah"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -83,6 +83,10 @@ kibana_server:\n   - \"cluster_monitor\"\n   - \"cluster_composite_ops\"\n   - \"cluster:admin/xpack/monitoring*\"\n+  - \"cluster:admin/opendistro/reports/instance/poll\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk1ODg4MQ==", "bodyText": "\"cluster:admin/opendistro/reports/instance/poll\" --> Get scheduled report instance information (metadata from configuration index).\n\"cluster:admin/opendistro/reports/instance/get\" --> get information of specific report instance\n\"cluster:admin/opendistro/reports/instance/update_status\" --> change status of report instance from scheduled to success/failure\n\"cluster:admin/opendistro/notifications/send\" --> send notification mail to email ids configured in report instance", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r520958881", "createdAt": "2020-11-11T00:23:51Z", "author": {"login": "akbhatta"}, "path": "src/main/resources/static_config/static_roles.yml", "diffHunk": "@@ -83,6 +83,10 @@ kibana_server:\n   - \"cluster_monitor\"\n   - \"cluster_composite_ops\"\n   - \"cluster:admin/xpack/monitoring*\"\n+  - \"cluster:admin/opendistro/reports/instance/poll\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk1NjcwMw=="}, "originalCommit": null, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NjMzNTQwOnYy", "diffSide": "RIGHT", "path": "securityconfig/roles.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjowODoyOVrOHw4sAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNzo0MjoyNlrOHxXnIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTAyMjQ2Nw==", "bodyText": "Whats the difference between instance list and get?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r521022467", "createdAt": "2020-11-11T02:08:29Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/list'", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyOTEyMA==", "bodyText": "get -> get one item\nlist -> get all paginated response for items", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r521529120", "createdAt": "2020-11-11T17:42:26Z", "author": {"login": "akbhatta"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/list'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTAyMjQ2Nw=="}, "originalCommit": null, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NjMzODU2OnYy", "diffSide": "RIGHT", "path": "securityconfig/roles.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjowOToxNFrOHw4uPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxNzo0MjozM1rOHxXnZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTAyMzAzNw==", "bodyText": "similar,  definition get vs list?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r521023037", "createdAt": "2020-11-11T02:09:14Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/list'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to read and download Reports and Report-definitions\n+reports_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/get'\n+    - 'cluster:admin/opendistro/reports/definition/list'", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyOTE4OQ==", "bodyText": "similar", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r521529189", "createdAt": "2020-11-11T17:42:33Z", "author": {"login": "akbhatta"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/list'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to read and download Reports and Report-definitions\n+reports_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/get'\n+    - 'cluster:admin/opendistro/reports/definition/list'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTAyMzAzNw=="}, "originalCommit": null, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2NjM1MDI0OnYy", "diffSide": "RIGHT", "path": "securityconfig/roles.yml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQwMjoxMjozMFrOHw42NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQyMDoxNjozM1rOHyMefw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTAyNTA3Nw==", "bodyText": "Curious, why did you separate create and update?", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r521025077", "createdAt": "2020-11-11T02:12:30Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/list'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to read and download Reports and Report-definitions\n+reports_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/get'\n+    - 'cluster:admin/opendistro/reports/definition/list'\n+    - 'cluster:admin/opendistro/reports/instance/list'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to all Reports functionality\n+reports_full_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/create'\n+    - 'cluster:admin/opendistro/reports/definition/update'", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUzMDQ0Mw==", "bodyText": "validation for create and update are different", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r521530443", "createdAt": "2020-11-11T17:44:47Z", "author": {"login": "akbhatta"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/list'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to read and download Reports and Report-definitions\n+reports_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/get'\n+    - 'cluster:admin/opendistro/reports/definition/list'\n+    - 'cluster:admin/opendistro/reports/instance/list'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to all Reports functionality\n+reports_full_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/create'\n+    - 'cluster:admin/opendistro/reports/definition/update'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTAyNTA3Nw=="}, "originalCommit": null, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM5NTI2Mw==", "bodyText": "reference : https://restfulapi.net/http-methods/#put", "url": "https://github.com/opensearch-project/security/pull/836#discussion_r522395263", "createdAt": "2020-11-12T20:16:33Z", "author": {"login": "skkosuri-amzn"}, "path": "securityconfig/roles.yml", "diffHunk": "@@ -61,3 +61,35 @@ anomaly_full_access:\n         - 'indices_monitor'\n         - 'indices:admin/aliases/get'\n         - 'indices:admin/mappings/get'\n+\n+# Allows users to read and download Reports\n+reports_instances_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/instance/list'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to read and download Reports and Report-definitions\n+reports_read_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/get'\n+    - 'cluster:admin/opendistro/reports/definition/list'\n+    - 'cluster:admin/opendistro/reports/instance/list'\n+    - 'cluster:admin/opendistro/reports/instance/get'\n+    - 'cluster:admin/opendistro/reports/menu/download'\n+\n+# Allows users to all Reports functionality\n+reports_full_access:\n+  reserved: true\n+  cluster_permissions:\n+    - 'cluster:admin/opendistro/reports/definition/create'\n+    - 'cluster:admin/opendistro/reports/definition/update'", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTAyNTA3Nw=="}, "originalCommit": null, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2235, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}