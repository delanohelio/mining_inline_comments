{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNTIzNzQw", "number": 2208, "title": "[CALCITE-4333] The Sort rel should be decorrelated even though it has\u2026", "bodyText": "\u2026 fetch or limit when its parent is not a Correlate", "createdAt": "2020-10-12T11:47:14Z", "url": "https://github.com/apache/calcite/pull/2208", "merged": true, "mergeCommit": {"oid": "74785aae40cdb48b02e4b8ef885e897c74bf629f"}, "closed": true, "closedAt": "2020-10-14T04:15:20Z", "author": {"login": "danny0405"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRyrDzABqjM4NjYyNzcxOTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdR-1szgBqjM4Njg5NDIyMDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e07708794627fa357e0f58277447967b9bae5d2d", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/e07708794627fa357e0f58277447967b9bae5d2d", "committedDate": "2020-10-12T11:46:48Z", "message": "[CALCITE-4333] The Sort rel should be decorrelated even though it has fetch or limit when its parent is not a Correlate"}, "afterCommit": {"oid": "bd6333a5d52d46ac7971f9802884150aed4bb96c", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/bd6333a5d52d46ac7971f9802884150aed4bb96c", "committedDate": "2020-10-12T11:55:57Z", "message": "[CALCITE-4333] The Sort rel should be decorrelated even though it has fetch or limit when its parent is not a Correlate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NTY1NDIy", "url": "https://github.com/apache/calcite/pull/2208#pullrequestreview-506565422", "createdAt": "2020-10-12T12:15:48Z", "commit": {"oid": "bd6333a5d52d46ac7971f9802884150aed4bb96c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMjoxNTo0OVrOHf8Nmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxMjoxNTo0OVrOHf8Nmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzI1NDQyNg==", "bodyText": "Does this code check only the parent or any ancestor? Is it valid to check only the parent?", "url": "https://github.com/apache/calcite/pull/2208#discussion_r503254426", "createdAt": "2020-10-12T12:15:49Z", "author": {"login": "zabetak"}, "path": "core/src/main/java/org/apache/calcite/sql2rel/RelDecorrelator.java", "diffHunk": "@@ -680,6 +677,17 @@ private static void shiftMapping(Map<Integer, Integer> mapping, int startIndex,\n \n   public Frame getInvoke(RelNode r, RelNode parent) {\n     final Frame frame = dispatcher.invoke(r);\n+    if (frame != null && parent instanceof Correlate && r instanceof Sort) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd6333a5d52d46ac7971f9802884150aed4bb96c"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "858882965ae872ab3776127eb3b8608535b7f9a1", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/858882965ae872ab3776127eb3b8608535b7f9a1", "committedDate": "2020-10-13T02:00:36Z", "message": "[CALCITE-4333] The Sort rel should be decorrelated even though it has fetch or limit when its parent is not a Correlate\n\nWhen the sort input has been written, cancels the rewrite if:\n* the sort has a parent, that means the sort is a branch of the\nCorrelate\n* the sort has fetch or limit"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bd6333a5d52d46ac7971f9802884150aed4bb96c", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/bd6333a5d52d46ac7971f9802884150aed4bb96c", "committedDate": "2020-10-12T11:55:57Z", "message": "[CALCITE-4333] The Sort rel should be decorrelated even though it has fetch or limit when its parent is not a Correlate"}, "afterCommit": {"oid": "858882965ae872ab3776127eb3b8608535b7f9a1", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/858882965ae872ab3776127eb3b8608535b7f9a1", "committedDate": "2020-10-13T02:00:36Z", "message": "[CALCITE-4333] The Sort rel should be decorrelated even though it has fetch or limit when its parent is not a Correlate\n\nWhen the sort input has been written, cancels the rewrite if:\n* the sort has a parent, that means the sort is a branch of the\nCorrelate\n* the sort has fetch or limit"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2943, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}