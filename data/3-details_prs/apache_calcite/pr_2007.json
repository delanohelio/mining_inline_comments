{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMwODMwOTI3", "number": 2007, "title": "[CALCITE-4049] Reduce the time complexity of getting shortest distances", "bodyText": "Currently, we have Graphs#makeImmutable to compute the shortest paths between all pairs of nodes. For many scenarios, however, we do not need the exact paths between nodes. Instead, we are only interested in the lengths of the shortest paths.\nTo get the path length, we need to get the shortest path first, which is returned as a List, then we call the List#size() method. According to the current implementation, the returned list is of type ConsList. The time complexity of ConsList#size is O(p) (p is the number of vertices on the path), which is inefficient.\nIn this issue, we revise the implementation of ConsList#size so that it takes O(1) time. In addition, we also give a utiltiy to get the shortest distances between nodes.", "createdAt": "2020-06-08T06:57:38Z", "url": "https://github.com/apache/calcite/pull/2007", "merged": true, "mergeCommit": {"oid": "f9e8413b46f4c648736b529a55e25b57ab5dee74"}, "closed": true, "closedAt": "2020-06-09T07:57:21Z", "author": {"login": "liyafan82"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpMhI1AFqTQyNjAzMDMwNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpPQ52gBqjM0MTk3MTUxNDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MDMwMzA1", "url": "https://github.com/apache/calcite/pull/2007#pullrequestreview-426030305", "createdAt": "2020-06-08T08:52:02Z", "commit": {"oid": "143b539e4cc1ff3a77bf87ed4988d1c220aaa4b9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwODo1MjowMlrOGgUp5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwODo1MjowMlrOGgUp5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU0NjAyMg==", "bodyText": "(minor) Maybe adding a unit test for the same node scenario?\nassertEquals(0, frozenGraph.getShortestDistance(\"B\", \"B\"));", "url": "https://github.com/apache/calcite/pull/2007#discussion_r436546022", "createdAt": "2020-06-08T08:52:02Z", "author": {"login": "rubenada"}, "path": "core/src/test/java/org/apache/calcite/util/graph/DirectedGraphTest.java", "diffHunk": "@@ -215,6 +215,34 @@\n     assertEquals(\"[D, E]\", frozenGraph.getShortestPath(\"D\", \"E\").toString());\n   }\n \n+  @Test void testDistances() {\n+    //       B -> C\n+    //      /      \\\n+    //     A        E\n+    //      \\      /\n+    //       D -->\n+    final DefaultDirectedGraph<String, DefaultEdge> graph =\n+        DefaultDirectedGraph.create();\n+    graph.addVertex(\"A\");\n+    graph.addVertex(\"B\");\n+    graph.addVertex(\"C\");\n+    graph.addVertex(\"D\");\n+    graph.addVertex(\"E\");\n+    graph.addVertex(\"F\");\n+    graph.addEdge(\"A\", \"B\");\n+    graph.addEdge(\"B\", \"C\");\n+    graph.addEdge(\"A\", \"D\");\n+    graph.addEdge(\"D\", \"E\");\n+    graph.addEdge(\"C\", \"E\");\n+    final Graphs.FrozenGraph<String, DefaultEdge> frozenGraph =\n+        Graphs.makeImmutable(graph);\n+    assertEquals(1, frozenGraph.getShortestDistance(\"A\", \"B\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "143b539e4cc1ff3a77bf87ed4988d1c220aaa4b9"}, "originalPosition": 25}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "143b539e4cc1ff3a77bf87ed4988d1c220aaa4b9", "author": {"user": {"login": "liyafan82", "name": null}}, "url": "https://github.com/apache/calcite/commit/143b539e4cc1ff3a77bf87ed4988d1c220aaa4b9", "committedDate": "2020-06-08T06:52:21Z", "message": "[CALCITE-4049] Reduce the time complexity of getting shortest distances"}, "afterCommit": {"oid": "80067b5b67f8ced064f1c7006b996e0966ea3173", "author": {"user": {"login": "liyafan82", "name": null}}, "url": "https://github.com/apache/calcite/commit/80067b5b67f8ced064f1c7006b996e0966ea3173", "committedDate": "2020-06-08T08:57:35Z", "message": "[CALCITE-4049] Reduce the time complexity of getting shortest distances"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MDY2ODg5", "url": "https://github.com/apache/calcite/pull/2007#pullrequestreview-426066889", "createdAt": "2020-06-08T09:40:02Z", "commit": {"oid": "80067b5b67f8ced064f1c7006b996e0966ea3173"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOTo0MDowMlrOGgWVow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOTo0MDowMlrOGgWVow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU3MzYwMw==", "bodyText": "May I suggest another formatting to make it clearer that all edges are directed? e.g.:\n// A+-->B+-->C+-->E\n// +              ^\n// |              |\n// +----->D+------+", "url": "https://github.com/apache/calcite/pull/2007#discussion_r436573603", "createdAt": "2020-06-08T09:40:02Z", "author": {"login": "rubenada"}, "path": "core/src/test/java/org/apache/calcite/util/graph/DirectedGraphTest.java", "diffHunk": "@@ -215,6 +215,35 @@\n     assertEquals(\"[D, E]\", frozenGraph.getShortestPath(\"D\", \"E\").toString());\n   }\n \n+  @Test void testDistances() {\n+    //       B -> C", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80067b5b67f8ced064f1c7006b996e0966ea3173"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dceb5a9447bfadc199b24a295e82b56bd3e429dd", "author": {"user": {"login": "liyafan82", "name": null}}, "url": "https://github.com/apache/calcite/commit/dceb5a9447bfadc199b24a295e82b56bd3e429dd", "committedDate": "2020-06-08T12:03:28Z", "message": "[CALCITE-4049] Reduce the time complexity of getting shortest distances"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "80067b5b67f8ced064f1c7006b996e0966ea3173", "author": {"user": {"login": "liyafan82", "name": null}}, "url": "https://github.com/apache/calcite/commit/80067b5b67f8ced064f1c7006b996e0966ea3173", "committedDate": "2020-06-08T08:57:35Z", "message": "[CALCITE-4049] Reduce the time complexity of getting shortest distances"}, "afterCommit": {"oid": "dceb5a9447bfadc199b24a295e82b56bd3e429dd", "author": {"user": {"login": "liyafan82", "name": null}}, "url": "https://github.com/apache/calcite/commit/dceb5a9447bfadc199b24a295e82b56bd3e429dd", "committedDate": "2020-06-08T12:03:28Z", "message": "[CALCITE-4049] Reduce the time complexity of getting shortest distances"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3573, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}