{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyNzI2MDAy", "number": 2211, "title": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an ag\u2026", "bodyText": "\u2026gregate should not return a zero field Aggregate.", "createdAt": "2020-10-13T19:17:47Z", "url": "https://github.com/apache/calcite/pull/2211", "merged": true, "mergeCommit": {"oid": "c9d7f5ed28e898beffe86d68fa7d637adbfbff5f"}, "closed": true, "closedAt": "2020-11-29T10:20:05Z", "author": {"login": "a-rafay"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSOfMggBqjM4NzMzNjkyMDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeMgS9AFqTUzNDk5NDYwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f383a79fac2ec4e6746510b27847d8b02bf46f97", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/f383a79fac2ec4e6746510b27847d8b02bf46f97", "committedDate": "2020-10-13T18:53:49Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate."}, "afterCommit": {"oid": "f5e6f94e6ac0fd7db9f4db24aeecaa6eaed0eab0", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/f5e6f94e6ac0fd7db9f4db24aeecaa6eaed0eab0", "committedDate": "2020-10-13T20:20:23Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f5e6f94e6ac0fd7db9f4db24aeecaa6eaed0eab0", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/f5e6f94e6ac0fd7db9f4db24aeecaa6eaed0eab0", "committedDate": "2020-10-13T20:20:23Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate."}, "afterCommit": {"oid": "dbd33c1d28369200a8431cefdd82e0e4084e3c0d", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/dbd33c1d28369200a8431cefdd82e0e4084e3c0d", "committedDate": "2020-10-13T20:38:54Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NzgwMjMz", "url": "https://github.com/apache/calcite/pull/2211#pullrequestreview-508780233", "createdAt": "2020-10-14T21:38:34Z", "commit": {"oid": "dbd33c1d28369200a8431cefdd82e0e4084e3c0d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQyMTozODozNFrOHhl-Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQyMTozODozNFrOHhl-Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDk4NzIwMg==", "bodyText": "Maybe an empty value rel should be used here instead", "url": "https://github.com/apache/calcite/pull/2211#discussion_r504987202", "createdAt": "2020-10-14T21:38:34Z", "author": {"login": "jamesstarr"}, "path": "core/src/main/java/org/apache/calcite/sql2rel/RelFieldTrimmer.java", "diffHunk": "@@ -1072,6 +1074,26 @@ public TrimResult trimFields(\n       ++j;\n     }\n \n+    if (newAggCallList.isEmpty() && newGroupSet.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbd33c1d28369200a8431cefdd82e0e4084e3c0d"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dbd33c1d28369200a8431cefdd82e0e4084e3c0d", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/dbd33c1d28369200a8431cefdd82e0e4084e3c0d", "committedDate": "2020-10-13T20:38:54Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate."}, "afterCommit": {"oid": "8a0180dd1a809dc8fd9571ef92c3a2827d4a361a", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/8a0180dd1a809dc8fd9571ef92c3a2827d4a361a", "committedDate": "2020-10-19T18:22:35Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e875d1b132f2a7db638acf79310e8f7cc688097a", "author": {"user": {"login": "julianhyde", "name": "Julian Hyde"}}, "url": "https://github.com/apache/calcite/commit/e875d1b132f2a7db638acf79310e8f7cc688097a", "committedDate": "2020-10-19T19:06:52Z", "message": "Refactor SqlToRelTestBase to allow custom Context in tests\n\nIn particular, allows a RelOptRulesTest to use a custom\noperator table."}, "afterCommit": {"oid": "f2e3d70fba97fbcaff6f36c598c6523fbe6ce93d", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/f2e3d70fba97fbcaff6f36c598c6523fbe6ce93d", "committedDate": "2020-10-19T19:38:25Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f2e3d70fba97fbcaff6f36c598c6523fbe6ce93d", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/f2e3d70fba97fbcaff6f36c598c6523fbe6ce93d", "committedDate": "2020-10-19T19:38:25Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate."}, "afterCommit": {"oid": "03560c9f9d4d466e68e65760436a5fb4d944983c", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/03560c9f9d4d466e68e65760436a5fb4d944983c", "committedDate": "2020-11-05T09:52:42Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate (Rafay)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03560c9f9d4d466e68e65760436a5fb4d944983c", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/03560c9f9d4d466e68e65760436a5fb4d944983c", "committedDate": "2020-11-05T09:52:42Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate (Rafay)"}, "afterCommit": {"oid": "edf1da7fce1a9153c90543f87c51cc7b4b4393ad", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/edf1da7fce1a9153c90543f87c51cc7b4b4393ad", "committedDate": "2020-11-05T09:55:57Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate (Rafay)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MTgxMjE5", "url": "https://github.com/apache/calcite/pull/2211#pullrequestreview-524181219", "createdAt": "2020-11-05T11:45:54Z", "commit": {"oid": "edf1da7fce1a9153c90543f87c51cc7b4b4393ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMTo0NTo1NFrOHt_nUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxMTo0NTo1NFrOHt_nUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzk5MDIyNw==", "bodyText": "Shouldn't this new test be added inside RelFieldTrimmerTest rather than RelOptRulesTest?", "url": "https://github.com/apache/calcite/pull/2211#discussion_r517990227", "createdAt": "2020-11-05T11:45:54Z", "author": {"login": "rubenada"}, "path": "core/src/test/java/org/apache/calcite/test/RelOptRulesTest.java", "diffHunk": "@@ -6827,6 +6828,62 @@ protected MyProjectRule(Config config) {\n         .check();\n   }\n \n+  /**\n+   * Test case for\n+   * <a href=\"https://issues.apache.org/jira/browse/CALCITE-4317\">[CALCITE-4317]\n+   * RelFieldTrimmer after trimming all the fields in an aggregate\n+   * should not return a zero field Aggregate</a>. */\n+  @Test void testProjectJoinTransposeRuleOnAggWithNoFieldsWithTrimmer() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "edf1da7fce1a9153c90543f87c51cc7b4b4393ad"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0MTk5NTEz", "url": "https://github.com/apache/calcite/pull/2211#pullrequestreview-534199513", "createdAt": "2020-11-19T08:54:45Z", "commit": {"oid": "edf1da7fce1a9153c90543f87c51cc7b4b4393ad"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwODo1NDo0NVrOH2SrWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQwODo1NDo0NVrOH2SrWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY5MTE2Mg==", "bodyText": "I'm not quite sure about adding this new trimRelNode that by default does nothing (hence does not trim the input RelNode).\nAre we sure this is the right place for this method?", "url": "https://github.com/apache/calcite/pull/2211#discussion_r526691162", "createdAt": "2020-11-19T08:54:45Z", "author": {"login": "rubenada"}, "path": "core/src/test/java/org/apache/calcite/test/SqlToRelTestBase.java", "diffHunk": "@@ -263,6 +263,11 @@ Tester withCatalogReaderFactory(\n \n     /** Returns a tester that uses a given context. */\n     Tester withContext(UnaryOperator<Context> transform);\n+\n+    /** Trims a RelNode. */\n+    default RelNode trimRelNode(RelNode relNode) {\n+      return relNode;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "edf1da7fce1a9153c90543f87c51cc7b4b4393ad"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d329bf0addc977053316a1c67664cac510ddabaa", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/d329bf0addc977053316a1c67664cac510ddabaa", "committedDate": "2020-11-20T00:47:39Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate (Rafay)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "edf1da7fce1a9153c90543f87c51cc7b4b4393ad", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/edf1da7fce1a9153c90543f87c51cc7b4b4393ad", "committedDate": "2020-11-05T09:55:57Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate (Rafay)"}, "afterCommit": {"oid": "d329bf0addc977053316a1c67664cac510ddabaa", "author": {"user": {"login": "a-rafay", "name": "Rafay"}}, "url": "https://github.com/apache/calcite/commit/d329bf0addc977053316a1c67664cac510ddabaa", "committedDate": "2020-11-20T00:47:39Z", "message": "[CALCITE-4317] RelFieldTrimmer after trimming all the fields in an aggregate should not return a zero field Aggregate (Rafay)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0OTk0NjAy", "url": "https://github.com/apache/calcite/pull/2211#pullrequestreview-534994602", "createdAt": "2020-11-20T00:49:06Z", "commit": {"oid": "d329bf0addc977053316a1c67664cac510ddabaa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwMDo0OTowNlrOH25B2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwMDo0OTowNlrOH25B2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzMxOTUxNQ==", "bodyText": "@rubenada Done.", "url": "https://github.com/apache/calcite/pull/2211#discussion_r527319515", "createdAt": "2020-11-20T00:49:06Z", "author": {"login": "a-rafay"}, "path": "core/src/test/java/org/apache/calcite/test/SqlToRelTestBase.java", "diffHunk": "@@ -263,6 +263,9 @@ Tester withCatalogReaderFactory(\n \n     /** Returns a tester that uses a given context. */\n     Tester withContext(UnaryOperator<Context> transform);\n+\n+    /** Trims a RelNode. */\n+    RelNode trimRelNode(RelNode relNode);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d329bf0addc977053316a1c67664cac510ddabaa"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2953, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}