{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyMzA2NjI3", "number": 1790, "title": "[CALCITE-3769] Deprecate TableScanRule", "bodyText": "Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\nRelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScan\nRemove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\nFix the plan change", "createdAt": "2020-02-07T09:10:29Z", "url": "https://github.com/apache/calcite/pull/1790", "merged": true, "mergeCommit": {"oid": "6a322f9fff51362744b326246e49590f850449bb"}, "closed": true, "closedAt": "2020-02-14T02:24:25Z", "author": {"login": "danny0405"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcB8G6wABqjMwMTY5OTMxNzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcD13TpABqjMwMzM3MjA4ODg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "12faf91e530cd0e5a6c36881c8552430ef1cb2d2", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/12faf91e530cd0e5a6c36881c8552430ef1cb2d2", "committedDate": "2020-02-07T09:06:20Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScan\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}, "afterCommit": {"oid": "b83a244312c9862938cb9c9cacc93428d2e6e786", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/b83a244312c9862938cb9c9cacc93428d2e6e786", "committedDate": "2020-02-07T09:41:34Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScan\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b83a244312c9862938cb9c9cacc93428d2e6e786", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/b83a244312c9862938cb9c9cacc93428d2e6e786", "committedDate": "2020-02-07T09:41:34Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScan\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}, "afterCommit": {"oid": "86c5040807bfe061ccb0db8af67bd3bd72fd92ec", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/86c5040807bfe061ccb0db8af67bd3bd72fd92ec", "committedDate": "2020-02-07T10:15:16Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScan\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86c5040807bfe061ccb0db8af67bd3bd72fd92ec", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/86c5040807bfe061ccb0db8af67bd3bd72fd92ec", "committedDate": "2020-02-07T10:15:16Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScan\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}, "afterCommit": {"oid": "b2cbc4a94f74bb80166b30d8864914e8f47f0082", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/b2cbc4a94f74bb80166b30d8864914e8f47f0082", "committedDate": "2020-02-09T02:51:54Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScanRule\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2cbc4a94f74bb80166b30d8864914e8f47f0082", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/b2cbc4a94f74bb80166b30d8864914e8f47f0082", "committedDate": "2020-02-09T02:51:54Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScanRule\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}, "afterCommit": {"oid": "de20b8280aebfde0f9afda7f2c8d7ee5418e44c5", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/de20b8280aebfde0f9afda7f2c8d7ee5418e44c5", "committedDate": "2020-02-10T04:30:21Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScanRule\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MjM3Mjcz", "url": "https://github.com/apache/calcite/pull/1790#pullrequestreview-357237273", "createdAt": "2020-02-12T07:35:47Z", "commit": {"oid": "de20b8280aebfde0f9afda7f2c8d7ee5418e44c5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzozNTo0OFrOFokLiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzozNTo0OFrOFokLiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA4MDEzNw==", "bodyText": "This looks odd.\nCan you clarify why is this replacement needed?", "url": "https://github.com/apache/calcite/pull/1790#discussion_r378080137", "createdAt": "2020-02-12T07:35:48Z", "author": {"login": "vlsi"}, "path": "core/src/main/java/org/apache/calcite/tools/RelRunners.java", "diffHunk": "@@ -29,6 +35,19 @@ private RelRunners() {}\n \n   /** Runs a relational expression by creating a JDBC connection. */\n   public static PreparedStatement run(RelNode rel) {\n+    final RelShuttle shuttle = new RelHomogeneousShuttle() {\n+      @Override public RelNode visit(TableScan scan) {\n+        final RelOptTable table = scan.getTable();\n+        if (scan instanceof LogicalTableScan\n+            && Bindables.BindableTableScan.canHandle(table)) {\n+          // Always replace the LogicalTableScan with BindableTableScan\n+          // because it's implementation does not require a \"schema\" as context.\n+          return Bindables.BindableTableScan.create(scan.getCluster(), table);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de20b8280aebfde0f9afda7f2c8d7ee5418e44c5"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d461de903dbc98ff99895204c96b0da6ed0552f", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/5d461de903dbc98ff99895204c96b0da6ed0552f", "committedDate": "2020-02-13T07:32:59Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScanRule\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de20b8280aebfde0f9afda7f2c8d7ee5418e44c5", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/de20b8280aebfde0f9afda7f2c8d7ee5418e44c5", "committedDate": "2020-02-10T04:30:21Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScanRule\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}, "afterCommit": {"oid": "5d461de903dbc98ff99895204c96b0da6ed0552f", "author": {"user": {"login": "danny0405", "name": "Danny Chan"}}, "url": "https://github.com/apache/calcite/commit/5d461de903dbc98ff99895204c96b0da6ed0552f", "committedDate": "2020-02-13T07:32:59Z", "message": "[CALCITE-3769] Deprecate TableScanRule\n\n* Deprecate TableScanRule and always invoke RelOptTable#toRel for\nRelBuilder#scan\n* RelOptTableImpl#toRel does not translate to EnumerableTableScan\nanymore, the EnumerableTableScan conversion logic has been moved to\nEnumerableTableScanRule\n* Remove the BindableTableScanRule from the default prepare ruleset, we\nonly add it where we really need that\n* Fix the plan change"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4220, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}