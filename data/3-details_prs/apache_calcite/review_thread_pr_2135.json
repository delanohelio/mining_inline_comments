{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4MTQwMzkw", "number": 2135, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDowOToyNFrOEgAjGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDowOToyNFrOEgAjGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTk4ODc0OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "isResolved": false, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNDowOToyNFrOHMoang==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yN1QyMTowNTowMlrOHYqAmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwNzEzNA==", "bodyText": "Why is this null? How about SqlTypeName.ANY ?", "url": "https://github.com/apache/calcite/pull/2135#discussion_r483007134", "createdAt": "2020-09-03T14:09:24Z", "author": {"login": "xy2953396112"}, "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "diffHunk": "@@ -217,6 +217,12 @@ public int getScale() {\n     return SCALE_NOT_SPECIFIED;\n   }\n \n+  /**\n+   * Gets the {@link SqlTypeName} of this type.\n+   * Sub-classes must override the method to ensure the resulting value is non-nullable.\n+   *\n+   * @return SqlTypeName, never null\n+   */\n   public SqlTypeName getSqlTypeName() {\n     return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d1d445ffe132608a250710aa960e9be17bc4fcc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzA3NTg3OA==", "bodyText": "The code was like that for ages, and this return null is never used in Calcite (it is always overridden).\nAnother option could be removing this implementation (the class is abstract anyway), however, that sounds like a backward-incompatible change, so I just kept the method as is.", "url": "https://github.com/apache/calcite/pull/2135#discussion_r483075878", "createdAt": "2020-09-03T15:41:50Z", "author": {"login": "vlsi"}, "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "diffHunk": "@@ -217,6 +217,12 @@ public int getScale() {\n     return SCALE_NOT_SPECIFIED;\n   }\n \n+  /**\n+   * Gets the {@link SqlTypeName} of this type.\n+   * Sub-classes must override the method to ensure the resulting value is non-nullable.\n+   *\n+   * @return SqlTypeName, never null\n+   */\n   public SqlTypeName getSqlTypeName() {\n     return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwNzEzNA=="}, "originalCommit": {"oid": "7d1d445ffe132608a250710aa960e9be17bc4fcc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM0NzI5Nw==", "bodyText": "The code looks weird, the document says it never returns null but there is a default code returns null.", "url": "https://github.com/apache/calcite/pull/2135#discussion_r483347297", "createdAt": "2020-09-04T02:13:58Z", "author": {"login": "danny0405"}, "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "diffHunk": "@@ -217,6 +217,12 @@ public int getScale() {\n     return SCALE_NOT_SPECIFIED;\n   }\n \n+  /**\n+   * Gets the {@link SqlTypeName} of this type.\n+   * Sub-classes must override the method to ensure the resulting value is non-nullable.\n+   *\n+   * @return SqlTypeName, never null\n+   */\n   public SqlTypeName getSqlTypeName() {\n     return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwNzEzNA=="}, "originalCommit": {"oid": "7d1d445ffe132608a250710aa960e9be17bc4fcc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM0OTQ0NA==", "bodyText": "Can we replace it with another SqlTypeName instead of null ?", "url": "https://github.com/apache/calcite/pull/2135#discussion_r483349444", "createdAt": "2020-09-04T02:23:02Z", "author": {"login": "xy2953396112"}, "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "diffHunk": "@@ -217,6 +217,12 @@ public int getScale() {\n     return SCALE_NOT_SPECIFIED;\n   }\n \n+  /**\n+   * Gets the {@link SqlTypeName} of this type.\n+   * Sub-classes must override the method to ensure the resulting value is non-nullable.\n+   *\n+   * @return SqlTypeName, never null\n+   */\n   public SqlTypeName getSqlTypeName() {\n     return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwNzEzNA=="}, "originalCommit": {"oid": "7d1d445ffe132608a250710aa960e9be17bc4fcc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwMTc0OA==", "bodyText": "I'm afraid no any default value is suitable here, for example SqlTypeName .ANY, because each SqlTypeName has a specific semantic, there is no default, returns a default value will cause confusion in some cases.", "url": "https://github.com/apache/calcite/pull/2135#discussion_r483401748", "createdAt": "2020-09-04T05:52:41Z", "author": {"login": "danny0405"}, "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "diffHunk": "@@ -217,6 +217,12 @@ public int getScale() {\n     return SCALE_NOT_SPECIFIED;\n   }\n \n+  /**\n+   * Gets the {@link SqlTypeName} of this type.\n+   * Sub-classes must override the method to ensure the resulting value is non-nullable.\n+   *\n+   * @return SqlTypeName, never null\n+   */\n   public SqlTypeName getSqlTypeName() {\n     return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwNzEzNA=="}, "originalCommit": {"oid": "7d1d445ffe132608a250710aa960e9be17bc4fcc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUxMjU2Mw==", "bodyText": "If no default value is suitable, maybe we should throw an UnSupportedOperationException here to make sure it is always overriden.", "url": "https://github.com/apache/calcite/pull/2135#discussion_r483512563", "createdAt": "2020-09-04T09:48:52Z", "author": {"login": "liyafan82"}, "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "diffHunk": "@@ -217,6 +217,12 @@ public int getScale() {\n     return SCALE_NOT_SPECIFIED;\n   }\n \n+  /**\n+   * Gets the {@link SqlTypeName} of this type.\n+   * Sub-classes must override the method to ensure the resulting value is non-nullable.\n+   *\n+   * @return SqlTypeName, never null\n+   */\n   public SqlTypeName getSqlTypeName() {\n     return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwNzEzNA=="}, "originalCommit": {"oid": "7d1d445ffe132608a250710aa960e9be17bc4fcc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUxODU0OQ==", "bodyText": "I would love to un-implement the method, however, it might happen that there is third-party code that extends the class, and it keeps the default return null implementation. It might even be the case that the default null implementation works because the code never tries to call methods on the result of getSqlTypeName().\nThat is why I'm inclined to keep the default return null, and deal with it later (e.g. announce the method would become abstract in 6 months).", "url": "https://github.com/apache/calcite/pull/2135#discussion_r483518549", "createdAt": "2020-09-04T10:00:50Z", "author": {"login": "vlsi"}, "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "diffHunk": "@@ -217,6 +217,12 @@ public int getScale() {\n     return SCALE_NOT_SPECIFIED;\n   }\n \n+  /**\n+   * Gets the {@link SqlTypeName} of this type.\n+   * Sub-classes must override the method to ensure the resulting value is non-nullable.\n+   *\n+   * @return SqlTypeName, never null\n+   */\n   public SqlTypeName getSqlTypeName() {\n     return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwNzEzNA=="}, "originalCommit": {"oid": "7d1d445ffe132608a250710aa960e9be17bc4fcc"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTYxNjE1Mg==", "bodyText": "Just in case, there's getSqlIdentifier:\n  public SqlTypeName getSqlTypeName() {\n    // The implementations must provide non-null value, however, we keep this for compatibility\n    return castNonNull(null);\n  }\n\n  public @Nullable SqlIdentifier getSqlIdentifier() {\n    SqlTypeName typeName = getSqlTypeName();\n    if (typeName == null) {\n      return null;\n    }\nSo I would keep the method return null as before.", "url": "https://github.com/apache/calcite/pull/2135#discussion_r495616152", "createdAt": "2020-09-27T21:05:02Z", "author": {"login": "vlsi"}, "path": "core/src/main/java/org/apache/calcite/rel/type/RelDataTypeImpl.java", "diffHunk": "@@ -217,6 +217,12 @@ public int getScale() {\n     return SCALE_NOT_SPECIFIED;\n   }\n \n+  /**\n+   * Gets the {@link SqlTypeName} of this type.\n+   * Sub-classes must override the method to ensure the resulting value is non-nullable.\n+   *\n+   * @return SqlTypeName, never null\n+   */\n   public SqlTypeName getSqlTypeName() {\n     return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAwNzEzNA=="}, "originalCommit": {"oid": "7d1d445ffe132608a250710aa960e9be17bc4fcc"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 127, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}