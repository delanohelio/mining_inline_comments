{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMTA2Mzkw", "number": 2049, "title": "[CALCITE-4094] Allow SqlOperator of SqlKind#OTHER_FUNCTION to define a Strong.Policy", "bodyText": "Jira: CALCITE-4094", "createdAt": "2020-06-30T15:22:43Z", "url": "https://github.com/apache/calcite/pull/2049", "merged": true, "mergeCommit": {"oid": "3fb68f6c22a7bcbc4cb1fff114bc911b1e31c4de"}, "closed": true, "closedAt": "2020-07-09T09:04:22Z", "author": {"login": "rubenada"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcw22TXAFqTQ0MTMzMTE5Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABczJiRcABqjM1MjgyNjEzMjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMzMxMTky", "url": "https://github.com/apache/calcite/pull/2049#pullrequestreview-441331192", "createdAt": "2020-07-02T03:49:32Z", "commit": {"oid": "192a1fbc854b47992e3c049c94029a80960012c0"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwMzo0OTozMlrOGr8dqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQwMzo1MDo0M1rOGr8esw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODczMjU4Nw==", "bodyText": "I was thinking of adding an interface in SqlFunction, something like SqlFunction#getStrongPolicy and give it a default value.", "url": "https://github.com/apache/calcite/pull/2049#discussion_r448732587", "createdAt": "2020-07-02T03:49:32Z", "author": {"login": "danny0405"}, "path": "core/src/main/java/org/apache/calcite/plan/Strong.java", "diffHunk": "@@ -294,4 +319,10 @@ private boolean anyNull(List<RexNode> operands) {\n     /** This kind of expression may be null. There is no way to rewrite. */\n     AS_IS,\n   }\n+\n+  /** Interface to allow {@link SqlOperator} of kind {@link SqlKind#OTHER_FUNCTION}\n+   * to define their own {@link Policy}. */\n+  public interface PolicySupplier {\n+    Policy getPolicy();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "192a1fbc854b47992e3c049c94029a80960012c0"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODczMjg1MQ==", "bodyText": "Is there any strong reason we must deprecate this interface ?\nIf we add an interface SqlFunction#getStrongPolicy, the only exception is the SqlKind.OTHER_FUNCTION, when we encounter that, a SqlFunction instance should be passed in.\nFor the other SqlKind and policy mapping, it is great if we can make the mapping configurable and pluggable, just like what we do to SqlTypeMappingRule", "url": "https://github.com/apache/calcite/pull/2049#discussion_r448732851", "createdAt": "2020-07-02T03:50:43Z", "author": {"login": "danny0405"}, "path": "core/src/main/java/org/apache/calcite/plan/Strong.java", "diffHunk": "@@ -85,8 +86,32 @@ public static boolean isNotTrue(RexNode node, ImmutableBitSet nullColumns) {\n   }\n \n   /** Returns how to deduce whether a particular kind of expression is null,\n-   * given whether its arguments are null. */\n+   * given whether its arguments are null.\n+   * @deprecated Use {@link Strong#policy(RexNode)} or {@link Strong#policy(SqlOperator)} */\n+  @Deprecated // to be removed before 2.0\n   public static Policy policy(SqlKind kind) {\n+    return getPolicy(kind);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "192a1fbc854b47992e3c049c94029a80960012c0"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MjM5NTMx", "url": "https://github.com/apache/calcite/pull/2049#pullrequestreview-445239531", "createdAt": "2020-07-09T01:56:56Z", "commit": {"oid": "698c8cb70b10c2d85dd666b1f312a04d057cb952"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b54feb45b91d8206815a77cbd9786251806033a0", "author": {"user": {"login": "rubenada", "name": null}}, "url": "https://github.com/apache/calcite/commit/b54feb45b91d8206815a77cbd9786251806033a0", "committedDate": "2020-07-09T06:56:40Z", "message": "[CALCITE-4094] Allow SqlOperator of SqlKind#OTHER_FUNCTION to define a Strong.Policy"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "698c8cb70b10c2d85dd666b1f312a04d057cb952", "author": {"user": {"login": "rubenada", "name": null}}, "url": "https://github.com/apache/calcite/commit/698c8cb70b10c2d85dd666b1f312a04d057cb952", "committedDate": "2020-07-08T14:15:41Z", "message": "[CALCITE-4094] Allow SqlOperator of SqlKind#OTHER_FUNCTION to define a Strong.Policy"}, "afterCommit": {"oid": "b54feb45b91d8206815a77cbd9786251806033a0", "author": {"user": {"login": "rubenada", "name": null}}, "url": "https://github.com/apache/calcite/commit/b54feb45b91d8206815a77cbd9786251806033a0", "committedDate": "2020-07-09T06:56:40Z", "message": "[CALCITE-4094] Allow SqlOperator of SqlKind#OTHER_FUNCTION to define a Strong.Policy"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3799, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}