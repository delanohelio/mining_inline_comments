{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwMTEyNjc5", "number": 1833, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMToyNjo0MFrODjCl7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMTo1MjozMVrODjDCgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MDY5MjMwOnYy", "diffSide": "RIGHT", "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMToyNjo0MFrOFun9ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMToyNjo0MFrOFun9ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQzMzU2Ng==", "bodyText": "we are done -> we are done. ?", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384433566", "createdAt": "2020-02-26T11:26:40Z", "author": {"login": "chunweilei"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,\n+        // if we reach a null key, we are done\n+        if (leftKey == null || rightKey == null) {\n+          done = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MDc2NTQ2OnYy", "diffSide": "RIGHT", "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "isResolved": true, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMTo1MjozMlrOFuoqtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwODoyOTo1MFrOFvJCzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTExMA==", "bodyText": "Is it documented anywhere?", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384445110", "createdAt": "2020-02-26T11:52:32Z", "author": {"login": "vlsi"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ1MjU3Ng==", "bodyText": "I'll add a comment about it in the javadoc of EnumerableDefaults#mergeJoin and EnumerableDefaults#MergeJoinEnumerator", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384452576", "createdAt": "2020-02-26T12:09:40Z", "author": {"login": "rubenada"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTExMA=="}, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ1NjcxNA==", "bodyText": "Comments have been added.", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384456714", "createdAt": "2020-02-26T12:19:09Z", "author": {"login": "rubenada"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTExMA=="}, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ1NzYxMA==", "bodyText": "The nulls order is actually defined by the RelFieldCollation, did we set it anywhere ?", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384457610", "createdAt": "2020-02-26T12:21:11Z", "author": {"login": "danny0405"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTExMA=="}, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ1OTAxMQ==", "bodyText": "It's set by EnumerableMergeJoinRule:\n\n  \n    \n      calcite/core/src/main/java/org/apache/calcite/adapter/enumerable/EnumerableMergeJoinRule.java\n    \n    \n         Line 72\n      in\n      e427180\n    \n    \n    \n    \n\n        \n          \n           fieldCollations.add( \n        \n    \n  \n\n\nwhich forces EnumerableMergeJoin's inputs to be sorted by key ascending, nulls last.\nSo, this sort collation is assumed when we arrive to EnumerableDefaults#MergeJoinEnumerator (note that there is already some IllegalStateException in there if inputs are not in ascending order)", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384459011", "createdAt": "2020-02-26T12:24:26Z", "author": {"login": "rubenada"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTExMA=="}, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDg4MTY4Ng==", "bodyText": "Reasonable, can you add this comments into the EnumerableDefaults code block.", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384881686", "createdAt": "2020-02-27T02:29:18Z", "author": {"login": "danny0405"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTExMA=="}, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDk3NTU2Nw==", "bodyText": "@danny0405 , comment has been added in the javadoc of EnumerableDefaults#mergeJoin and EnumerableDefaults#MergeJoinEnumerator", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384975567", "createdAt": "2020-02-27T08:29:50Z", "author": {"login": "rubenada"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTExMA=="}, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 312, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}