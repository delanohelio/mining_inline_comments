{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MTMxMzYw", "number": 2000, "title": "[CALCITE-4040] An aggregate function that does not support roll up throws an exception when it is rolled up", "bodyText": "https://issues.apache.org/jira/browse/CALCITE-4040", "createdAt": "2020-06-03T11:11:28Z", "url": "https://github.com/apache/calcite/pull/2000", "merged": true, "mergeCommit": {"oid": "fde9697a564b8b9f98775ca768ffb7f880ca8da2"}, "closed": true, "closedAt": "2020-06-06T09:25:34Z", "author": {"login": "xy2953396112"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcn1NQzgFqTQyNDA3MTEyOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoiXuEAH2gAyNDI3MTMxMzYwOjMzM2EzZTRjNzgzZjVlYmFlMDJjY2NiZmJmMDRhZmU0OTE5OGUzYTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MDcxMTI4", "url": "https://github.com/apache/calcite/pull/2000#pullrequestreview-424071128", "createdAt": "2020-06-04T03:07:16Z", "commit": {"oid": "02e8ad91d14d32c088b56d51f094ce0adee0e0d4"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMzowNzoxNlrOGe0QsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwMzowODozMlrOGe0R2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk2NjcwNQ==", "bodyText": "How about some doc here to explain why matching should fail.", "url": "https://github.com/apache/calcite/pull/2000#discussion_r434966705", "createdAt": "2020-06-04T03:07:16Z", "author": {"login": "jinxing64"}, "path": "core/src/test/java/org/apache/calcite/test/MaterializedViewSubstitutionVisitorTest.java", "diffHunk": "@@ -410,6 +410,18 @@\n     sql(mv, query).noMat();\n   }\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02e8ad91d14d32c088b56d51f094ce0adee0e0d4"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk2NzAwMQ==", "bodyText": "How about some doc to explain why matching should fail when the function doesn't support roll-up.", "url": "https://github.com/apache/calcite/pull/2000#discussion_r434967001", "createdAt": "2020-06-04T03:08:32Z", "author": {"login": "jinxing64"}, "path": "core/src/main/java/org/apache/calcite/plan/SubstitutionVisitor.java", "diffHunk": "@@ -1899,8 +1899,12 @@ public static MutableRel unifyAggregates(MutableAggregate query,\n         if (i < 0) {\n           return null;\n         }\n+        SqlAggFunction aggFunction = getRollup(aggregateCall.getAggregation());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02e8ad91d14d32c088b56d51f094ce0adee0e0d4"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02e8ad91d14d32c088b56d51f094ce0adee0e0d4", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/02e8ad91d14d32c088b56d51f094ce0adee0e0d4", "committedDate": "2020-06-03T11:09:57Z", "message": "[CALCITE-4040] Nonstandard SqlAggFunction rollup Exception (Xu Zhaohui)"}, "afterCommit": {"oid": "2708d2c8cec33078749af8347b102aabd591af92", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/2708d2c8cec33078749af8347b102aabd591af92", "committedDate": "2020-06-04T06:28:57Z", "message": "[CALCITE-4040] Nonstandard SqlAggFunction rollup Exception (Xu Zhaohui)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2708d2c8cec33078749af8347b102aabd591af92", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/2708d2c8cec33078749af8347b102aabd591af92", "committedDate": "2020-06-04T06:28:57Z", "message": "[CALCITE-4040] Nonstandard SqlAggFunction rollup Exception (Xu Zhaohui)"}, "afterCommit": {"oid": "489e3b608d89626c4759e938b62b176847d962dd", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/489e3b608d89626c4759e938b62b176847d962dd", "committedDate": "2020-06-04T06:39:13Z", "message": "[CALCITE-4040] Nonstandard SqlAggFunction rollup Exception (Xu Zhaohui)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0MjY3NDU5", "url": "https://github.com/apache/calcite/pull/2000#pullrequestreview-424267459", "createdAt": "2020-06-04T09:32:31Z", "commit": {"oid": "489e3b608d89626c4759e938b62b176847d962dd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwOTozMjozMlrOGe9oRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwOTozMjozMlrOGe9oRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTEyMDE5OA==", "bodyText": "In current MaterializedViewSubstitutionVisitorTest.java, there's already an testAggregateRollUp. How about rename this as testSqlAggFunctionRollup2 and put it after testAggregateRollUp ?", "url": "https://github.com/apache/calcite/pull/2000#discussion_r435120198", "createdAt": "2020-06-04T09:32:32Z", "author": {"login": "jinxing64"}, "path": "core/src/test/java/org/apache/calcite/test/MaterializedViewSubstitutionVisitorTest.java", "diffHunk": "@@ -410,6 +410,21 @@\n     sql(mv, query).noMat();\n   }\n \n+  /**\n+   * stddev_pop aggregate function does not support roll up.\n+   */\n+  @Test public void testSqlAggFunctionRollup() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "489e3b608d89626c4759e938b62b176847d962dd"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "489e3b608d89626c4759e938b62b176847d962dd", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/489e3b608d89626c4759e938b62b176847d962dd", "committedDate": "2020-06-04T06:39:13Z", "message": "[CALCITE-4040] Nonstandard SqlAggFunction rollup Exception (Xu Zhaohui)"}, "afterCommit": {"oid": "6bb083a605928df6a625e2c6400006a6d996d0e4", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/6bb083a605928df6a625e2c6400006a6d996d0e4", "committedDate": "2020-06-04T09:58:48Z", "message": "[CALCITE-4040] Nonstandard SqlAggFunction rollup Exception (Xu Zhaohui)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6bb083a605928df6a625e2c6400006a6d996d0e4", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/6bb083a605928df6a625e2c6400006a6d996d0e4", "committedDate": "2020-06-04T09:58:48Z", "message": "[CALCITE-4040] Nonstandard SqlAggFunction rollup Exception (Xu Zhaohui)"}, "afterCommit": {"oid": "38ba704427fadf365f75769a42045a7114d2e9e0", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/38ba704427fadf365f75769a42045a7114d2e9e0", "committedDate": "2020-06-04T10:08:51Z", "message": "[CALCITE-4040] An aggregate function that does not support roll up throws an exception when it is rolled up (Xu Zhaohui)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NzE3NzE1", "url": "https://github.com/apache/calcite/pull/2000#pullrequestreview-425717715", "createdAt": "2020-06-06T06:13:35Z", "commit": {"oid": "38ba704427fadf365f75769a42045a7114d2e9e0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQwNjoxMzozNVrOGgCJnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQwNjoxMzozNVrOGgCJnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI0Mjg0NQ==", "bodyText": "public is not needed. Please remove.", "url": "https://github.com/apache/calcite/pull/2000#discussion_r436242845", "createdAt": "2020-06-06T06:13:35Z", "author": {"login": "jinxing64"}, "path": "core/src/test/java/org/apache/calcite/test/MaterializedViewSubstitutionVisitorTest.java", "diffHunk": "@@ -509,6 +509,21 @@\n         .ok();\n   }\n \n+  /**\n+   * stddev_pop aggregate function does not support roll up.\n+   */\n+  @Test public void testAggregateRollUp2() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38ba704427fadf365f75769a42045a7114d2e9e0"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "38ba704427fadf365f75769a42045a7114d2e9e0", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/38ba704427fadf365f75769a42045a7114d2e9e0", "committedDate": "2020-06-04T10:08:51Z", "message": "[CALCITE-4040] An aggregate function that does not support roll up throws an exception when it is rolled up (Xu Zhaohui)"}, "afterCommit": {"oid": "333a3e4c783f5ebae02cccbfbf04afe49198e3a7", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/333a3e4c783f5ebae02cccbfbf04afe49198e3a7", "committedDate": "2020-06-06T07:45:44Z", "message": "[CALCITE-4040] An aggregate function that does not support roll up throws an exception when it is rolled up (Xu Zhaohui)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "333a3e4c783f5ebae02cccbfbf04afe49198e3a7", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/333a3e4c783f5ebae02cccbfbf04afe49198e3a7", "committedDate": "2020-06-06T07:45:44Z", "message": "[CALCITE-4040] An aggregate function that does not support roll up throws an exception when it is rolled up (Xu Zhaohui)"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3531, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}