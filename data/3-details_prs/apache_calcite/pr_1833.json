{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwMTEyNjc5", "number": 1833, "title": "[CALCITE-3828] MergeJoin throws NPE in case of null keys", "bodyText": "Jira ticket: CALCITE-3828\nEnumerableDefaults#MergeJoinEnumerator throws a NPE in case of null keys.\nMergeJoin algorithm assumes that inputs sorted in ascending order, with nulls last (see EnumerableMergeJoinRule), so when reaching a null key on the left / right side means that we are done.", "createdAt": "2020-02-26T09:39:59Z", "url": "https://github.com/apache/calcite/pull/1833", "merged": true, "mergeCommit": {"oid": "bfde14be1284efc6d4560868fef3724238c35dc3"}, "closed": true, "closedAt": "2020-03-06T09:11:28Z", "author": {"login": "rubenada"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIFAaRgFqTM2NDgyMjExNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKpvbNABqjMxMDA3NzY2MTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0ODIyMTE3", "url": "https://github.com/apache/calcite/pull/1833#pullrequestreview-364822117", "createdAt": "2020-02-26T11:26:39Z", "commit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMToyNjo0MFrOFun9ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMToyNjo0MFrOFun9ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQzMzU2Ng==", "bodyText": "we are done -> we are done. ?", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384433566", "createdAt": "2020-02-26T11:26:40Z", "author": {"login": "chunweilei"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,\n+        // if we reach a null key, we are done\n+        if (leftKey == null || rightKey == null) {\n+          done = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0ODI1ODgz", "url": "https://github.com/apache/calcite/pull/1833#pullrequestreview-364825883", "createdAt": "2020-02-26T11:33:18Z", "commit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0ODM2Nzkz", "url": "https://github.com/apache/calcite/pull/1833#pullrequestreview-364836793", "createdAt": "2020-02-26T11:52:31Z", "commit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMTo1MjozMlrOFuoqtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMTo1MjozMlrOFuoqtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ0NTExMA==", "bodyText": "Is it documented anywhere?", "url": "https://github.com/apache/calcite/pull/1833#discussion_r384445110", "createdAt": "2020-02-26T11:52:32Z", "author": {"login": "vlsi"}, "path": "linq4j/src/main/java/org/apache/calcite/linq4j/EnumerableDefaults.java", "diffHunk": "@@ -3829,6 +3829,12 @@ private boolean advance() {\n       TInner right = rightEnumerator.current();\n       TKey rightKey = innerKeySelector.apply(right);\n       for (;;) {\n+        // mergeJoin assumes inputs sorted in ascending order with nulls last,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8693f6a2b66eea56034fbcd2265adea0c86436e5"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MTUyNjE5", "url": "https://github.com/apache/calcite/pull/1833#pullrequestreview-366152619", "createdAt": "2020-02-28T04:17:02Z", "commit": {"oid": "7484e6172b1bcf71401ca44b4280bed509ed236d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dbd859e59a462638e5261f71e2e05e75112d9000", "author": {"user": {"login": "rubenada", "name": null}}, "url": "https://github.com/apache/calcite/commit/dbd859e59a462638e5261f71e2e05e75112d9000", "committedDate": "2020-02-28T08:32:25Z", "message": "[CALCITE-3828] MergeJoin throws NPE in case of null keys"}, "afterCommit": {"oid": "f4e7ba51392a7bded79dc646133ab8b867f00aad", "author": {"user": {"login": "rubenada", "name": null}}, "url": "https://github.com/apache/calcite/commit/f4e7ba51392a7bded79dc646133ab8b867f00aad", "committedDate": "2020-03-05T10:46:28Z", "message": "[CALCITE-3828] MergeJoin throws NPE in case of null keys"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4693635b0134b83d0a94814754398c89f9278ad2", "author": {"user": {"login": "rubenada", "name": null}}, "url": "https://github.com/apache/calcite/commit/4693635b0134b83d0a94814754398c89f9278ad2", "committedDate": "2020-03-05T11:22:40Z", "message": "[CALCITE-3828] MergeJoin throws NPE in case of null keys"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f4e7ba51392a7bded79dc646133ab8b867f00aad", "author": {"user": {"login": "rubenada", "name": null}}, "url": "https://github.com/apache/calcite/commit/f4e7ba51392a7bded79dc646133ab8b867f00aad", "committedDate": "2020-03-05T10:46:28Z", "message": "[CALCITE-3828] MergeJoin throws NPE in case of null keys"}, "afterCommit": {"oid": "4693635b0134b83d0a94814754398c89f9278ad2", "author": {"user": {"login": "rubenada", "name": null}}, "url": "https://github.com/apache/calcite/commit/4693635b0134b83d0a94814754398c89f9278ad2", "committedDate": "2020-03-05T11:22:40Z", "message": "[CALCITE-3828] MergeJoin throws NPE in case of null keys"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4306, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}