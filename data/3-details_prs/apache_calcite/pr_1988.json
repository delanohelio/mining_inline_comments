{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyMzU1ODQ4", "number": 1988, "title": "[CALCITE-4019] Visit SqlInsert with SqlShuttle cause NullPointerException", "bodyText": "https://issues.apache.org/jira/browse/CALCITE-4019", "createdAt": "2020-05-24T03:08:29Z", "url": "https://github.com/apache/calcite/pull/1988", "merged": true, "mergeCommit": {"oid": "abe772018a6adb5007429e0c1c83b6e7d83a1c71"}, "closed": true, "closedAt": "2020-05-29T01:34:26Z", "author": {"login": "xy2953396112"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckSzgFABqjMzNjc2MDU4NDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclQP56AFqTQxODgyNDA5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "26ab92827ce2eabd8d89ee587b894ba4139c2c3a", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/26ab92827ce2eabd8d89ee587b894ba4139c2c3a", "committedDate": "2020-05-24T03:07:41Z", "message": "[CALCITE-4019] Fix visit SqlInsert with SqlShuttle cause NullPointerException (Xu Zhaohui)"}, "afterCommit": {"oid": "c4e8cfd45b4e19dd957c4ab7e312dc981a25fd8b", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/c4e8cfd45b4e19dd957c4ab7e312dc981a25fd8b", "committedDate": "2020-05-24T03:21:40Z", "message": "[CALCITE-4019] Fix visit SqlInsert with SqlShuttle cause NullPointerException (Xu Zhaohui)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3NDE5MDQ0", "url": "https://github.com/apache/calcite/pull/1988#pullrequestreview-417419044", "createdAt": "2020-05-25T01:44:46Z", "commit": {"oid": "c4e8cfd45b4e19dd957c4ab7e312dc981a25fd8b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwMTo0NDo0NlrOGZy4WQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQwMTo0NDo0NlrOGZy4WQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTcwMTIwOQ==", "bodyText": "why create a new  SqlInsert instance, can we just make a cast from call object?", "url": "https://github.com/apache/calcite/pull/1988#discussion_r429701209", "createdAt": "2020-05-25T01:44:46Z", "author": {"login": "yanlin-Lynn"}, "path": "core/src/main/java/org/apache/calcite/sql/SqlUtil.java", "diffHunk": "@@ -261,6 +261,32 @@ public static boolean isLiteralChain(SqlNode node) {\n     }\n   }\n \n+  /**\n+   * Unparses a call to an operator which has special syntax.\n+   *\n+   * @param operator The operator\n+   * @param writer   Writer\n+   * @param call     List of 0 or more operands\n+   */\n+  public static void unparseSpecialSyntax(SqlOperator operator,\n+      SqlWriter writer,\n+      SqlCall call) {\n+    final List<SqlNode> operands = call.getOperandList();\n+    switch (operator.getKind()) {\n+    case INSERT:\n+      assert operands.size() == 3 || operands.size() == 4;\n+      final SqlInsert insert = new SqlInsert(call.getParserPosition(),\n+          (SqlNodeList) operands.get(0), operands.get(1), operands.get(2),\n+          operands.size() == 3 ? null : (SqlNodeList) call.getOperandList().get(3));\n+      insert.unparse(writer, operator.getLeftPrec(), operator.getRightPrec());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4e8cfd45b4e19dd957c4ab7e312dc981a25fd8b"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c4e8cfd45b4e19dd957c4ab7e312dc981a25fd8b", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/c4e8cfd45b4e19dd957c4ab7e312dc981a25fd8b", "committedDate": "2020-05-24T03:21:40Z", "message": "[CALCITE-4019] Fix visit SqlInsert with SqlShuttle cause NullPointerException (Xu Zhaohui)"}, "afterCommit": {"oid": "a026e159f2084bcc7b2254589d5ddff40d48f009", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/a026e159f2084bcc7b2254589d5ddff40d48f009", "committedDate": "2020-05-25T03:20:06Z", "message": "[CALCITE-4019] Change SqlInsert getOperandList method (Xu Zhaohui)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a026e159f2084bcc7b2254589d5ddff40d48f009", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/a026e159f2084bcc7b2254589d5ddff40d48f009", "committedDate": "2020-05-25T03:20:06Z", "message": "[CALCITE-4019] Change SqlInsert getOperandList method (Xu Zhaohui)"}, "afterCommit": {"oid": "9a90c5c1a4d3d0e0815f00e5842779105d32ec52", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/9a90c5c1a4d3d0e0815f00e5842779105d32ec52", "committedDate": "2020-05-25T03:55:37Z", "message": "[CALCITE-4019] Change SqlInsert getOperandList method (Xu ZhaoHui)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3OTM0NzA4", "url": "https://github.com/apache/calcite/pull/1988#pullrequestreview-417934708", "createdAt": "2020-05-26T02:30:47Z", "commit": {"oid": "9a90c5c1a4d3d0e0815f00e5842779105d32ec52"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwMjozMDo0N1rOGaM2pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwMjozMDo0N1rOGaM2pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDEyNjc1Nw==", "bodyText": "how about add  some checks for the result of accept", "url": "https://github.com/apache/calcite/pull/1988#discussion_r430126757", "createdAt": "2020-05-26T02:30:47Z", "author": {"login": "yanlin-Lynn"}, "path": "core/src/test/java/org/apache/calcite/sql/parser/SqlParserTest.java", "diffHunk": "@@ -5747,6 +5748,17 @@ public void subTestIntervalMonthFailsValidation() {\n         .ok(\"INTERVAL '0' MONTH(0)\");\n   }\n \n+  @Test void testSqlParserPosPlus() throws Exception {\n+    final String sql = \"insert into emps select * from emps\";\n+    final SqlNode sqlNode = getSqlParser(sql).parseStmt();\n+    sqlNode.accept(new SqlShuttle() {\n+      @Override public SqlNode visit(SqlIdentifier identifier) {\n+        return new SqlIdentifier(identifier.names,\n+            identifier.getParserPosition());\n+      }\n+    });\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a90c5c1a4d3d0e0815f00e5842779105d32ec52"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a90c5c1a4d3d0e0815f00e5842779105d32ec52", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/9a90c5c1a4d3d0e0815f00e5842779105d32ec52", "committedDate": "2020-05-25T03:55:37Z", "message": "[CALCITE-4019] Change SqlInsert getOperandList method (Xu ZhaoHui)"}, "afterCommit": {"oid": "0fe2a42033511a0a33e24f5dfbb5b67511c371d0", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/0fe2a42033511a0a33e24f5dfbb5b67511c371d0", "committedDate": "2020-05-26T02:35:08Z", "message": "[CALCITE-4019] Visit SqlInsert with SqlShuttle cause NullPointerException (Xu ZhaoHui)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7ca1091f5a44af5debba7e3ef134c397992c924", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/a7ca1091f5a44af5debba7e3ef134c397992c924", "committedDate": "2020-05-26T02:44:16Z", "message": "[CALCITE-4019] Visit SqlInsert with SqlShuttle cause NullPointerException (Xu ZhaoHui)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0fe2a42033511a0a33e24f5dfbb5b67511c371d0", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/0fe2a42033511a0a33e24f5dfbb5b67511c371d0", "committedDate": "2020-05-26T02:35:08Z", "message": "[CALCITE-4019] Visit SqlInsert with SqlShuttle cause NullPointerException (Xu ZhaoHui)"}, "afterCommit": {"oid": "a7ca1091f5a44af5debba7e3ef134c397992c924", "author": {"user": {"login": "xy2953396112", "name": "xzh"}}, "url": "https://github.com/apache/calcite/commit/a7ca1091f5a44af5debba7e3ef134c397992c924", "committedDate": "2020-05-26T02:44:16Z", "message": "[CALCITE-4019] Visit SqlInsert with SqlShuttle cause NullPointerException (Xu ZhaoHui)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MjY5NjQ3", "url": "https://github.com/apache/calcite/pull/1988#pullrequestreview-418269647", "createdAt": "2020-05-26T12:57:29Z", "commit": {"oid": "a7ca1091f5a44af5debba7e3ef134c397992c924"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4ODI0MDk0", "url": "https://github.com/apache/calcite/pull/1988#pullrequestreview-418824094", "createdAt": "2020-05-27T02:57:08Z", "commit": {"oid": "a7ca1091f5a44af5debba7e3ef134c397992c924"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwMjo1NzowOFrOGa3xzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QwMjo1NzowOFrOGa3xzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgzMDAyOA==", "bodyText": "Is it possible that targetTable is null or source is null?", "url": "https://github.com/apache/calcite/pull/1988#discussion_r430830028", "createdAt": "2020-05-27T02:57:08Z", "author": {"login": "DonnyZone"}, "path": "core/src/main/java/org/apache/calcite/sql/SqlInsert.java", "diffHunk": "@@ -62,7 +62,11 @@ public SqlOperator getOperator() {\n   }\n \n   public List<SqlNode> getOperandList() {\n-    return ImmutableNullableList.of(keywords, targetTable, source, columnList);\n+    if (columnList == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7ca1091f5a44af5debba7e3ef134c397992c924"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3439, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}