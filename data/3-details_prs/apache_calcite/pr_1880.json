{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0Njc5NzY4", "number": 1880, "title": "Make ubenchmark clases executable from IDEA", "bodyText": "This makes ubenchmark / .main classes executable from IDEA", "createdAt": "2020-03-27T10:45:15Z", "url": "https://github.com/apache/calcite/pull/1880", "merged": true, "mergeCommit": {"oid": "c9acc5bb03983915084557ac75afeb2866074d90"}, "closed": true, "closedAt": "2020-04-10T06:57:26Z", "author": {"login": "vlsi"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRymLegFqTM4Mjk3Mjg1Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWLgubgBqjMyMjA5NzE2MzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyOTcyODUy", "url": "https://github.com/apache/calcite/pull/1880#pullrequestreview-382972852", "createdAt": "2020-03-27T15:39:44Z", "commit": {"oid": "abb34080b0ea79917cb3a930baae52ae773c7acc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNTozOTo0NVrOF82wfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNTozOTo0NVrOF82wfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM1NjAyOQ==", "bodyText": "I merge the update to my local branch, I am afraid we should add one more to make it work.\nclasspath(File(buildDir, \"jmh-generated-sources\"))", "url": "https://github.com/apache/calcite/pull/1880#discussion_r399356029", "createdAt": "2020-03-27T15:39:45Z", "author": {"login": "neoremind"}, "path": "ubenchmark/build.gradle.kts", "diffHunk": "@@ -22,12 +22,29 @@ dependencies {\n     // Make jmhCompileClasspath resolvable\n     @Suppress(\"DEPRECATION\")\n     jmhCompileClasspath(platform(project(\":bom\")))\n-    jmh(project(\":core\"))\n-    jmh(project(\":linq4j\"))\n-    jmh(\"com.google.guava:guava\")\n-    jmh(\"org.codehaus.janino:commons-compiler\")\n-    jmh(\"org.openjdk.jmh:jmh-core\")\n-    jmh(\"org.openjdk.jmh:jmh-generator-annprocess\")\n+    jmhImplementation(project(\":core\"))\n+    jmhImplementation(project(\":linq4j\"))\n+    jmhImplementation(\"com.google.guava:guava\")\n+    jmhImplementation(\"org.codehaus.janino:commons-compiler\")\n+    jmhImplementation(\"org.openjdk.jmh:jmh-core\")\n+    jmhImplementation(\"org.openjdk.jmh:jmh-generator-annprocess\")\n }\n \n // See https://github.com/melix/jmh-gradle-plugin\n+// Unfortunately, current jmh-gradle-plugin does not allow to cusomize jmh parameters from the\n+// command line, so the workarounds are:\n+// a) Build and execute the jar itself: ./gradlew jmhJar && java -jar build/libs/calcite-...jar JMH_OPTIONS\n+// b) Execute benchmarks via .main() methods from IDE (you might want to activate \"power save mode\"\n+//    in the IDE to minimize the impact of the IDE itself on the benchmark results)\n+\n+tasks.withType<JavaExec>().configureEach {\n+    // Execution of .main methods from IDEA should re-generate benchmark classes if required\n+    dependsOn(\"jmhCompileGeneratedClasses\")\n+    doFirst {\n+        // At best jmh plugin should add the generated directories to the Gradle model, however,\n+        // currently it builds the jar only :-/\n+        // IntelliJ IDEA \"execute main method\" adds a JavaExec task, so we configure it\n+        classpath(File(buildDir, \"jmh-generated-classes\"))\n+        classpath(File(buildDir, \"jmh-generated-resources\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abb34080b0ea79917cb3a930baae52ae773c7acc"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9acc5bb03983915084557ac75afeb2866074d90", "author": {"user": {"login": "vlsi", "name": "Vladimir Sitnikov"}}, "url": "https://github.com/apache/calcite/commit/c9acc5bb03983915084557ac75afeb2866074d90", "committedDate": "2020-04-10T06:56:57Z", "message": "Make ubenchmark clases executable from IDEA"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "abb34080b0ea79917cb3a930baae52ae773c7acc", "author": {"user": {"login": "vlsi", "name": "Vladimir Sitnikov"}}, "url": "https://github.com/apache/calcite/commit/abb34080b0ea79917cb3a930baae52ae773c7acc", "committedDate": "2020-03-27T10:24:45Z", "message": "Make ubenchmark clases executable from IDEA"}, "afterCommit": {"oid": "c9acc5bb03983915084557ac75afeb2866074d90", "author": {"user": {"login": "vlsi", "name": "Vladimir Sitnikov"}}, "url": "https://github.com/apache/calcite/commit/c9acc5bb03983915084557ac75afeb2866074d90", "committedDate": "2020-04-10T06:56:57Z", "message": "Make ubenchmark clases executable from IDEA"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3964, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}