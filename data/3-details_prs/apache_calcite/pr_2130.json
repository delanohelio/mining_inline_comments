{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3NTkyNTc2", "number": 2130, "title": "[CALCITE-4207] Validation fails for positional aggregate with current_date in 'case' expression", "bodyText": "", "createdAt": "2020-09-02T06:03:39Z", "url": "https://github.com/apache/calcite/pull/2130", "merged": true, "mergeCommit": {"oid": "a8be094664eddd14daf5de35bca4de8797a1d4c2"}, "closed": true, "closedAt": "2020-09-23T23:56:14Z", "author": {"login": "ihuzenko"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdE4vvtAH2gAyNDc3NTkyNTc2OmJjMTNlMDBhZTU5YzJiMGM3MzllODg2NzEzZjAxZTYyYTFmZDk3YTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHHAY-AFqTQ4NDcyODQwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bc13e00ae59c2b0c739e886713f01e62a1fd97a6", "author": {"user": {"login": "ihuzenko", "name": "Igor Guzenko"}}, "url": "https://github.com/apache/calcite/commit/bc13e00ae59c2b0c739e886713f01e62a1fd97a6", "committedDate": "2020-09-02T09:39:46Z", "message": "[CALCITE-4207] Validation fails for positional aggregate with current_date in 'case' expression"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c19c4a14fa7095762ac3de70aece1d234d5e079", "author": {"user": {"login": "ihuzenko", "name": "Igor Guzenko"}}, "url": "https://github.com/apache/calcite/commit/1c19c4a14fa7095762ac3de70aece1d234d5e079", "committedDate": "2020-09-02T06:00:57Z", "message": "[CALCITE-4207] Validation fails for positional aggregate with current_date in 'case' expression"}, "afterCommit": {"oid": "bc13e00ae59c2b0c739e886713f01e62a1fd97a6", "author": {"user": {"login": "ihuzenko", "name": "Igor Guzenko"}}, "url": "https://github.com/apache/calcite/commit/bc13e00ae59c2b0c739e886713f01e62a1fd97a6", "committedDate": "2020-09-02T09:39:46Z", "message": "[CALCITE-4207] Validation fails for positional aggregate with current_date in 'case' expression"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNTA0MjMz", "url": "https://github.com/apache/calcite/pull/2130#pullrequestreview-482504233", "createdAt": "2020-09-04T09:30:46Z", "commit": {"oid": "bc13e00ae59c2b0c739e886713f01e62a1fd97a6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwOTozMDo0N1rOHNGsVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwOTozMDo0N1rOHNGsVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzUwMzE5MA==", "bodyText": "I'm confused by why the current_date caused the problem, does other non-param function triggers the bug too ?", "url": "https://github.com/apache/calcite/pull/2130#discussion_r483503190", "createdAt": "2020-09-04T09:30:47Z", "author": {"login": "danny0405"}, "path": "core/src/test/java/org/apache/calcite/test/SqlValidatorTest.java", "diffHunk": "@@ -11685,6 +11685,19 @@ private void checkCustomColumnResolving(String table) {\n             + \"MYFUN\\\\(<NUMERIC>, <NUMERIC>\\\\).*\");\n   }\n \n+  @Test void testPositionalAggregateWithExpandedCurrentDateFunction() {\n+    SqlConformance defaultPlusOrdinalGroupBy =\n+        new SqlDelegatingConformance(SqlConformanceEnum.DEFAULT) {\n+          @Override public boolean isGroupByOrdinal() {\n+            return true;\n+          }\n+        };\n+    sql(\"SELECT HIREDATE >= CURRENT_DATE, COUNT(*) \"\n+        + \"FROM EMP GROUP BY 1\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc13e00ae59c2b0c739e886713f01e62a1fd97a6"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NzI4NDA1", "url": "https://github.com/apache/calcite/pull/2130#pullrequestreview-484728405", "createdAt": "2020-09-09T07:24:28Z", "commit": {"oid": "bc13e00ae59c2b0c739e886713f01e62a1fd97a6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3285, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}