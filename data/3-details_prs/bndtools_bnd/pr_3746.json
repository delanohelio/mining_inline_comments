{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY4MDk1OTMz", "number": 3746, "title": "junit-platform: Fix Sub-request to handle plain DiscoverySelector", "bodyText": "JUnit 5.5 changed to call getSelectorsByType with the base\nDiscoverySelector type which caused us to fail to substitute the OSGi\nready selectors.\nWe change to call the original request and then filter out the selector\nwe will supply. We then add the selectors we will supply to the stream.\nFixes #3745", "createdAt": "2020-01-28T16:02:31Z", "url": "https://github.com/bndtools/bnd/pull/3746", "merged": true, "mergeCommit": {"oid": "9b541a2c1ea33b7ab461bb90f18e9a5ea940366b"}, "closed": true, "closedAt": "2020-01-29T17:48:17Z", "author": {"login": "bjhargrave"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-5itWAFqTM0OTc2NTQwNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_JO55gH2gAyMzY4MDk1OTMzOjk3MTk4MTcyOTgxZDY4MDNkMmEzNDBiMjFiY2U1MWZhM2IyMDkxMWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NzY1NDA2", "url": "https://github.com/bndtools/bnd/pull/3746#pullrequestreview-349765406", "createdAt": "2020-01-28T23:00:16Z", "commit": {"oid": "0ede8ebe2570f6c48d32fb0d6b5041911516283c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQyMzowMDoxNlrOFi3mEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQyMzowMDoxNlrOFi3mEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjEwNjc3MQ==", "bodyText": "I'm wondering if it might be a useful optimisation to retain this as a short-circuit just before the main return statement?", "url": "https://github.com/bndtools/bnd/pull/3746#discussion_r372106771", "createdAt": "2020-01-28T23:00:16Z", "author": {"login": "kriegfrj"}, "path": "biz.aQute.tester.junit-platform/src/aQute/tester/bundle/engine/discovery/BundleSelectorResolver.java", "diffHunk": "@@ -520,16 +520,14 @@ private boolean elementHasJUnit4Annotations(AnnotatedElement element) {\n \t\t@Override\n \t\tpublic <T extends DiscoverySelector> List<T> getSelectorsByType(Class<T> selectorType) {\n \t\t\tinfo(() -> \"Getting selectors from sub-request for: \" + selectorType);\n-\t\t\tif (selectorType.equals(ClassSelector.class) || selectorType.equals(MethodSelector.class)) {\n-\t\t\t\treturn selectors.stream()\n-\t\t\t\t\t.filter(selectorType::isInstance)\n-\t\t\t\t\t.map(selectorType::cast)\n-\t\t\t\t\t.collect(toList());\n-\t\t\t}\n-\t\t\tif (selectorType.equals(BundleSelector.class)) {\n-\t\t\t\treturn new ArrayList<>();\n-\t\t\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ede8ebe2570f6c48d32fb0d6b5041911516283c"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5806d704d1f635995bef1016e37ca2803e56a636", "author": {"user": {"login": "bjhargrave", "name": "BJ Hargrave"}}, "url": "https://github.com/bndtools/bnd/commit/5806d704d1f635995bef1016e37ca2803e56a636", "committedDate": "2020-01-29T15:42:13Z", "message": "junit-platform: Fix Sub-request to handle plain DiscoverySelector\n\nJUnit 5.5 changed to call getSelectorsByType with the base\nDiscoverySelector type which caused us to fail to substitute the OSGi\nready selectors.\n\nWe change to call the original request and then filter out the selector\nwe will supply. We then add the selectors we will supply to the stream.\n\nFixes https://github.com/bndtools/bnd/issues/3745\n\nSigned-off-by: BJ Hargrave <bj@bjhargrave.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e53da052c73f1d4926104a4f4caf54444a1574cb", "author": {"user": {"login": "bjhargrave", "name": "BJ Hargrave"}}, "url": "https://github.com/bndtools/bnd/commit/e53da052c73f1d4926104a4f4caf54444a1574cb", "committedDate": "2020-01-29T16:07:23Z", "message": "tester: Rename test case to disambiguate test results\n\nSigned-off-by: BJ Hargrave <bj@bjhargrave.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97198172981d6803d2a340b21bce51fa3b20911b", "author": {"user": {"login": "bjhargrave", "name": "BJ Hargrave"}}, "url": "https://github.com/bndtools/bnd/commit/97198172981d6803d2a340b21bce51fa3b20911b", "committedDate": "2020-01-29T17:17:35Z", "message": "junit-platform: Some improvements to selector resolution\n\nThis also fixed a bug where the bundle class loader was not used to\nfind test methods from the Test-Cases header string.\n\nSigned-off-by: BJ Hargrave <bj@bjhargrave.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3062, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}