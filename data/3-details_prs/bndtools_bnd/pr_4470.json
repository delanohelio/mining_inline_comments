{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzNzE2Mzk1", "number": 4470, "title": "running tests with remote agent hangs forever #4469", "bodyText": "", "createdAt": "2020-12-21T20:48:32Z", "url": "https://github.com/bndtools/bnd/pull/4470", "merged": true, "mergeCommit": {"oid": "8473689e6988a0e1874831f02cc7be3d721ff89d"}, "closed": true, "closedAt": "2021-01-04T21:30:45Z", "author": {"login": "rotty3000"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdocX2gAFqTU1NjY1Nzc3NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABds5ffIgBqjQxNjU4ODMwNjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2NjU3Nzc1", "url": "https://github.com/bndtools/bnd/pull/4470#pullrequestreview-556657775", "createdAt": "2020-12-21T20:54:53Z", "commit": {"oid": "dff67a6b900cd0f577961df65a326e632fe0be37"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQyMDo1NDo1M1rOIJlpGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQyMDo1NzoyNVrOIJltLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkyNDgyNg==", "bodyText": "This seems an unwanted side effect. We already add me to the launcher above. Jamming into the project seems wrong. Every time you launch, you will add it again, no? I think some other solution is needed.", "url": "https://github.com/bndtools/bnd/pull/4470#discussion_r546924826", "createdAt": "2020-12-21T20:54:53Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.tester/src/aQute/tester/plugin/ProjectTesterImpl.java", "diffHunk": "@@ -83,6 +83,14 @@ protected void updateFromProject() throws Exception {\n \n \t\tlauncher.addRunBundle(me.getFile()\n \t\t\t.getAbsolutePath());\n+\n+\t\t//\n+\t\t// We also add it to the project to handle the case of the remote\n+\t\t// launcher that wants to sync the bundles with the runtime dynamically\n+\t\t//\n+\n+\t\tgetProject().getRunbundles()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dff67a6b900cd0f577961df65a326e632fe0be37"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkyNTg3MA==", "bodyText": "Doesn't this just stack up side effects since the system properties are not restored when done?", "url": "https://github.com/bndtools/bnd/pull/4470#discussion_r546925870", "createdAt": "2020-12-21T20:57:25Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.remote/src/aQute/remote/plugin/RunSessionImpl.java", "diffHunk": "@@ -96,8 +97,13 @@ public int launch() throws Exception {\n \n \t\t\tAgent agent = supervisor.getAgent();\n \n-\t\t\tif (agent.isEnvoy())\n+\t\t\tif (agent.isEnvoy()) {\n \t\t\t\tinstallFramework(agent, dto, properties);\n+\t\t\t} else {\n+\t\t\t\tfor (Entry<String, String> entry : properties.entrySet()) {\n+\t\t\t\t\tagent.setSystemProperty(entry.getKey(), entry.getValue());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dff67a6b900cd0f577961df65a326e632fe0be37"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dff67a6b900cd0f577961df65a326e632fe0be37", "author": {"user": {"login": "rotty3000", "name": "Raymond Aug\u00e9"}}, "url": "https://github.com/bndtools/bnd/commit/dff67a6b900cd0f577961df65a326e632fe0be37", "committedDate": "2020-12-21T20:46:58Z", "message": "[remote] enable the agent to set system properties\n\nthis enables the tester to set it's tester properties when running in a remote configuration\n\nfixes #4469\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>"}, "afterCommit": {"oid": "c6144f0549f981bad66d6b3bd743f5de7b08bdcd", "author": {"user": {"login": "rotty3000", "name": "Raymond Aug\u00e9"}}, "url": "https://github.com/bndtools/bnd/commit/c6144f0549f981bad66d6b3bd743f5de7b08bdcd", "committedDate": "2020-12-22T15:53:16Z", "message": "[remote] enable the agent to set system properties\n\nthis enables the tester to set it's tester properties when running in a remote configuration\n\nfixes #4469\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c6144f0549f981bad66d6b3bd743f5de7b08bdcd", "author": {"user": {"login": "rotty3000", "name": "Raymond Aug\u00e9"}}, "url": "https://github.com/bndtools/bnd/commit/c6144f0549f981bad66d6b3bd743f5de7b08bdcd", "committedDate": "2020-12-22T15:53:16Z", "message": "[remote] enable the agent to set system properties\n\nthis enables the tester to set it's tester properties when running in a remote configuration\n\nfixes #4469\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>"}, "afterCommit": {"oid": "bfb122cceb30465e5478d62cfdb657afb1b6c681", "author": {"user": {"login": "rotty3000", "name": "Raymond Aug\u00e9"}}, "url": "https://github.com/bndtools/bnd/commit/bfb122cceb30465e5478d62cfdb657afb1b6c681", "committedDate": "2020-12-23T20:36:27Z", "message": "[tester, launcher] ensure proper interleaving of prepare and updateFromProject\n\nfixes #4469\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9edd9b00c2af190bb76dcf879e7e4efe7b3be62e", "author": {"user": {"login": "rotty3000", "name": "Raymond Aug\u00e9"}}, "url": "https://github.com/bndtools/bnd/commit/9edd9b00c2af190bb76dcf879e7e4efe7b3be62e", "committedDate": "2021-01-04T17:06:00Z", "message": "[tester] part 1 (API only): allow for tester to release the remote link without terminating the framework\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bfb122cceb30465e5478d62cfdb657afb1b6c681", "author": {"user": {"login": "rotty3000", "name": "Raymond Aug\u00e9"}}, "url": "https://github.com/bndtools/bnd/commit/bfb122cceb30465e5478d62cfdb657afb1b6c681", "committedDate": "2020-12-23T20:36:27Z", "message": "[tester, launcher] ensure proper interleaving of prepare and updateFromProject\n\nfixes #4469\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>"}, "afterCommit": {"oid": "9edd9b00c2af190bb76dcf879e7e4efe7b3be62e", "author": {"user": {"login": "rotty3000", "name": "Raymond Aug\u00e9"}}, "url": "https://github.com/bndtools/bnd/commit/9edd9b00c2af190bb76dcf879e7e4efe7b3be62e", "committedDate": "2021-01-04T17:06:00Z", "message": "[tester] part 1 (API only): allow for tester to release the remote link without terminating the framework\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3088, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}