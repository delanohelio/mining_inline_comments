{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNDA3MTcz", "number": 4006, "title": "[generate] Minor fixes", "bodyText": "Force now cleans all files\nNo check anymore\nMethod to clean and check if build is needed\nBetter error handling\nbndgenerate marker does not inherit other bnd marker\n\nSigned-off-by: Peter Kriens Peter.Kriens@aqute.biz", "createdAt": "2020-05-05T09:36:42Z", "url": "https://github.com/bndtools/bnd/pull/4006", "merged": true, "mergeCommit": {"oid": "28dbfe50374b9c35369fd173ee37ec184e0e632a"}, "closed": true, "closedAt": "2020-05-05T16:32:01Z", "author": {"login": "pkriens"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceQwhAgH2gAyNDEzNDA3MTczOmI2ZDFjMzk5MjI3NDgwNWRlY2U3ODEyZjhjMDQ5OTgzODQ1OWNiMDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceWvphAFqTQwNTk1OTg4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b6d1c3992274805dece7812f8c0499838459cb03", "author": {"user": {"login": "pkriens", "name": "Peter Kriens"}}, "url": "https://github.com/bndtools/bnd/commit/b6d1c3992274805dece7812f8c0499838459cb03", "committedDate": "2020-05-05T09:35:17Z", "message": "[generate] Minor fixes\n\n- Force now cleans all files\n- No check anymore\n- Method to clean and check if build is needed\n- Better error handling\n- bndgenerate marker does not inherit other bnd marker\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1OTU5ODgz", "url": "https://github.com/bndtools/bnd/pull/4006#pullrequestreview-405959883", "createdAt": "2020-05-05T16:33:20Z", "commit": {"oid": "b6d1c3992274805dece7812f8c0499838459cb03"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjozMzoyMVrOGQxwPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjozMzoyOFrOGQxwsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI0NTU2Ng==", "bodyText": "Did you mean to commit this println?", "url": "https://github.com/bndtools/bnd/pull/4006#discussion_r420245566", "createdAt": "2020-05-05T16:33:21Z", "author": {"login": "bjhargrave"}, "path": "bndtools.builder/src/org/bndtools/builder/BndSourceGenerateCompilationParticipant.java", "diffHunk": "@@ -16,26 +16,20 @@\n \tprivate static final ILogger\tlogger\t\t\t\t= Logger\n \t\t.getLogger(BndSourceGenerateCompilationParticipant.class);\n \tpublic static final String\t\tMARKER_BND_GENERATE\t= \"bndtools.builder.bndgenerate\";\n-\tprivate Project\t\t\t\t\tproject;\n \n \t@Override\n \tpublic boolean isActive(IJavaProject javaProject) {\n \t\ttry {\n \t\t\tMarkerSupport markers = new MarkerSupport(javaProject.getProject());\n-\t\t\tproject = Central.getProject(javaProject.getProject());\n+\t\t\tProject project = Central.getProject(javaProject.getProject());\n \t\t\tif (project == null)\n \t\t\t\treturn false;\n \n-\t\t\tResult<Set<File>, String> inputs = project.getGenerate()\n-\t\t\t\t.getInputs();\n-\t\t\tif (inputs.isErr()) {\n-\t\t\t\t// handle any errors\n-\t\t\t\t// in the aboutToBuild method\n-\t\t\t\treturn true;\n-\t\t\t}\n+\t\t\tboolean result = project.getGenerate()\n+\t\t\t\t.needsBuild();\n \n-\t\t\treturn !inputs.unwrap()\n-\t\t\t\t.isEmpty();\n+\t\t\tSystem.out.println(\"isActive \" + project + \" \" + result);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6d1c3992274805dece7812f8c0499838459cb03"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI0NTY4MA==", "bodyText": "Did you mean to commit this println?", "url": "https://github.com/bndtools/bnd/pull/4006#discussion_r420245680", "createdAt": "2020-05-05T16:33:28Z", "author": {"login": "bjhargrave"}, "path": "bndtools.builder/src/org/bndtools/builder/BndSourceGenerateCompilationParticipant.java", "diffHunk": "@@ -45,11 +39,16 @@ public boolean isActive(IJavaProject javaProject) {\n \t@Override\n \tpublic int aboutToBuild(IJavaProject javaProject) {\n \t\ttry {\n+\t\t\tProject project = Central.getProject(javaProject.getProject());\n+\t\t\tif (project == null)\n+\t\t\t\treturn READY_FOR_BUILD;\n+\n+\t\t\tSystem.out.println(\"aboutToBuild \" + project);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6d1c3992274805dece7812f8c0499838459cb03"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3200, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}