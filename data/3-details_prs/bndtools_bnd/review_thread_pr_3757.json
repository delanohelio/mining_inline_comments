{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwMjY4ODM4", "number": 3757, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMjo1Mzo0OVrODcnyBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMjo1NDoyM1rODcnyow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMzM4NTAyOnYy", "diffSide": "LEFT", "path": "org.bndtools.templating.gitrepo/resources/processed/org/bndtools/templating/jgit/initialrepos.txt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMjo1Mzo0OVrOFkwW-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMjo1Mzo0OVrOFkwW-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDA4NTM2OA==", "bodyText": "This is wrong. We must have version specific branches so older versions of Bndtools don't stop working when we update master for newer branches. We just forgot to update the repo for 5.0.0. (Need to add this task to the release process checklist.)", "url": "https://github.com/bndtools/bnd/pull/3757#discussion_r374085368", "createdAt": "2020-02-03T12:53:49Z", "author": {"login": "bjhargrave"}, "path": "org.bndtools.templating.gitrepo/resources/processed/org/bndtools/templating/jgit/initialrepos.txt", "diffHunk": "@@ -1 +1 @@\n-bndtools/workspace;branch=origin/${version;==;${base.version}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f650796cf4a0165b1c70b548fb4d8ca829591062"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMzM4NjU5OnYy", "diffSide": "RIGHT", "path": "org.bndtools.templating.gitrepo/src/org/bndtools/templating/jgit/Cache.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QxMjo1NDoyM1rOFkwX8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwODozMzo1MlrOFpK3iA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDA4NTYxNw==", "bodyText": "You should close this HttpClient. The old code does this.", "url": "https://github.com/bndtools/bnd/pull/3757#discussion_r374085617", "createdAt": "2020-02-03T12:54:23Z", "author": {"login": "bjhargrave"}, "path": "org.bndtools.templating.gitrepo/src/org/bndtools/templating/jgit/Cache.java", "diffHunk": "@@ -10,14 +10,21 @@\n import aQute.bnd.service.url.TaggedData;\n import aQute.lib.io.IO;\n import aQute.libg.tuple.Pair;\n+import bndtools.central.Central;\n \n public class Cache {\n \n     private final ConcurrentMap<URI, Pair<String, byte[]>> cache = new ConcurrentHashMap<>();\n \n-    public byte[] download(URI uri) throws IOException {\n+\tpublic byte[] download(URI uri) throws Exception {\n         byte[] data;\n-        try (HttpClient client = new HttpClient()) {\n+\t\ttry {\n+\t\t\tHttpClient client = Central.getWorkspace()\n+\t\t\t\t.getPlugin(HttpClient.class);\n+\n+\t\t\tif (client == null)\n+\t\t\t\tclient = new HttpClient();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f650796cf4a0165b1c70b548fb4d8ca829591062"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODcxMzk5Mg==", "bodyText": "I've removed it, it must be there always", "url": "https://github.com/bndtools/bnd/pull/3757#discussion_r378713992", "createdAt": "2020-02-13T08:33:52Z", "author": {"login": "pkriens"}, "path": "org.bndtools.templating.gitrepo/src/org/bndtools/templating/jgit/Cache.java", "diffHunk": "@@ -10,14 +10,21 @@\n import aQute.bnd.service.url.TaggedData;\n import aQute.lib.io.IO;\n import aQute.libg.tuple.Pair;\n+import bndtools.central.Central;\n \n public class Cache {\n \n     private final ConcurrentMap<URI, Pair<String, byte[]>> cache = new ConcurrentHashMap<>();\n \n-    public byte[] download(URI uri) throws IOException {\n+\tpublic byte[] download(URI uri) throws Exception {\n         byte[] data;\n-        try (HttpClient client = new HttpClient()) {\n+\t\ttry {\n+\t\t\tHttpClient client = Central.getWorkspace()\n+\t\t\t\t.getPlugin(HttpClient.class);\n+\n+\t\t\tif (client == null)\n+\t\t\t\tclient = new HttpClient();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDA4NTYxNw=="}, "originalCommit": {"oid": "f650796cf4a0165b1c70b548fb4d8ca829591062"}, "originalPosition": 19}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1482, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}