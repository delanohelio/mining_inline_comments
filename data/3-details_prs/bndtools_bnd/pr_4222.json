{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3MTUxMzEz", "number": 4222, "title": "set equinox configuration app args", "bodyText": "", "createdAt": "2020-07-10T00:00:05Z", "url": "https://github.com/bndtools/bnd/pull/4222", "merged": true, "mergeCommit": {"oid": "647b2d6600f3dd8bb914989f1a14e8d2ca8186c0"}, "closed": true, "closedAt": "2020-07-10T14:52:34Z", "author": {"login": "gamerson"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczZ36VgFqTQ0NjA3NjMzNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABczkY-ggFqTQ0NjQ0MTA2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MDc2MzM0", "url": "https://github.com/bndtools/bnd/pull/4222#pullrequestreview-446076334", "createdAt": "2020-07-10T02:00:55Z", "commit": {"oid": "8c0a1febc2e71edf465c0775e3de533321f66ab1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMjowMDo1NVrOGvnccg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMjowMDo1NVrOGvnccg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU4MjUxNA==", "bodyText": "Typo in retrieved", "url": "https://github.com/bndtools/bnd/pull/4222#discussion_r452582514", "createdAt": "2020-07-10T02:00:55Z", "author": {"login": "rotty3000"}, "path": "org.bndtools.applaunch/src/org/bndtools/applaunch/Activator.java", "diffHunk": "@@ -69,6 +73,38 @@ private static Filter createFilter() {\n \t\treturn context.registerService(ApplicationLauncher.class, new BndApplicationLauncher(context), null);\n \t}\n \n+\tprivate void setEquinoxConfigAppArgs(BundleContext context) {\n+\t\tString[] parameters = null;\n+\t\ttry {\n+\t\t\tServiceReference<?>[] serviceReferences = context.getServiceReferences(\"aQute.launcher.Launcher\",\n+\t\t\t\t\"(launcher.arguments=*)\");\n+\t\t\tif (serviceReferences != null && serviceReferences.length > 0) {\n+\t\t\t\tObject property = serviceReferences[0].getProperty(\"launcher.arguments\");\n+\n+\t\t\t\tif (property instanceof String[]) {\n+\t\t\t\t\tparameters = (String[]) property;\n+\n+\t\t\t\t\tServiceReference<EnvironmentInfo> srvcRef = context.getServiceReference(EnvironmentInfo.class);\n+\t\t\t\t\tif (srvcRef != null) {\n+\t\t\t\t\t\tEnvironmentInfo service = context.getService(srvcRef);\n+\t\t\t\t\t\tif (service instanceof EquinoxConfiguration) {\n+\t\t\t\t\t\t\tEquinoxConfiguration equinoxConfig = (EquinoxConfiguration) service;\n+\t\t\t\t\t\t\tequinoxConfig.setAllArgs(parameters);\n+\t\t\t\t\t\t\tequinoxConfig.setAppArgs(parameters);\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\n+\t\t\t\t\tlog.fine(\"configured program arguments \" + parameters);\n+\t\t\t\t}\n+\t\t\t} else {\n+\t\t\t\tlog.log(Level.SEVERE,\n+\t\t\t\t\t\"service aQute.launcher.Launcher with props launcher.arguments could not be retireved\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c0a1febc2e71edf465c0775e3de533321f66ab1"}, "originalPosition": 47}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8c0a1febc2e71edf465c0775e3de533321f66ab1", "author": {"user": {"login": "gamerson", "name": "Gregory Amerson"}}, "url": "https://github.com/bndtools/bnd/commit/8c0a1febc2e71edf465c0775e3de533321f66ab1", "committedDate": "2020-07-09T23:58:54Z", "message": "set equinox configuration app args\n\nSigned-off-by: Gregory Amerson <gregory.amerson@liferay.com>"}, "afterCommit": {"oid": "150a520edd6375ad8d148746c11a06780ef94d6a", "author": {"user": {"login": "gamerson", "name": "Gregory Amerson"}}, "url": "https://github.com/bndtools/bnd/commit/150a520edd6375ad8d148746c11a06780ef94d6a", "committedDate": "2020-07-10T11:40:25Z", "message": "set equinox configuration app args\n\nSigned-off-by: Gregory Amerson <gregory.amerson@liferay.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MzYxMzc5", "url": "https://github.com/bndtools/bnd/pull/4222#pullrequestreview-446361379", "createdAt": "2020-07-10T12:30:28Z", "commit": {"oid": "150a520edd6375ad8d148746c11a06780ef94d6a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxMjozMDoyOFrOGv1fUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxMjozNjo0OVrOGv1rcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgxMjYyNw==", "bodyText": "I think Arrays.toString(args) is probably fine and simpler.\nWhy is this log log.fine( when the other logs are like log.log(Level.? It seems a bit inconsistent.", "url": "https://github.com/bndtools/bnd/pull/4222#discussion_r452812627", "createdAt": "2020-07-10T12:30:28Z", "author": {"login": "bjhargrave"}, "path": "org.bndtools.applaunch/src/org/bndtools/applaunch/Activator.java", "diffHunk": "@@ -69,6 +75,39 @@ private static Filter createFilter() {\n \t\treturn context.registerService(ApplicationLauncher.class, new BndApplicationLauncher(context), null);\n \t}\n \n+\tprivate void setEquinoxConfigAppArgs(BundleContext context) {\n+\t\tString[] args = null;\n+\t\ttry {\n+\t\t\tServiceReference<?>[] serviceReferences = context.getServiceReferences(\"aQute.launcher.Launcher\",\n+\t\t\t\t\"(launcher.arguments=*)\");\n+\t\t\tif (serviceReferences != null && serviceReferences.length > 0) {\n+\t\t\t\tObject property = serviceReferences[0].getProperty(\"launcher.arguments\");\n+\n+\t\t\t\tif (property instanceof String[]) {\n+\t\t\t\t\targs = (String[]) property;\n+\n+\t\t\t\t\tServiceReference<EnvironmentInfo> srvcRef = context.getServiceReference(EnvironmentInfo.class);\n+\t\t\t\t\tif (srvcRef != null) {\n+\t\t\t\t\t\tEnvironmentInfo service = context.getService(srvcRef);\n+\t\t\t\t\t\tif (service instanceof EquinoxConfiguration) {\n+\t\t\t\t\t\t\tEquinoxConfiguration equinoxConfig = (EquinoxConfiguration) service;\n+\t\t\t\t\t\t\tequinoxConfig.setAllArgs(args);\n+\t\t\t\t\t\t\tequinoxConfig.setAppArgs(args);\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\n+\t\t\t\t\tlog.fine(\"configured program arguments \" + Arrays.stream(args)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "150a520edd6375ad8d148746c11a06780ef94d6a"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgxNDA5NA==", "bodyText": "What about ungeting the service?", "url": "https://github.com/bndtools/bnd/pull/4222#discussion_r452814094", "createdAt": "2020-07-10T12:33:19Z", "author": {"login": "bjhargrave"}, "path": "org.bndtools.applaunch/src/org/bndtools/applaunch/Activator.java", "diffHunk": "@@ -69,6 +75,39 @@ private static Filter createFilter() {\n \t\treturn context.registerService(ApplicationLauncher.class, new BndApplicationLauncher(context), null);\n \t}\n \n+\tprivate void setEquinoxConfigAppArgs(BundleContext context) {\n+\t\tString[] args = null;\n+\t\ttry {\n+\t\t\tServiceReference<?>[] serviceReferences = context.getServiceReferences(\"aQute.launcher.Launcher\",\n+\t\t\t\t\"(launcher.arguments=*)\");\n+\t\t\tif (serviceReferences != null && serviceReferences.length > 0) {\n+\t\t\t\tObject property = serviceReferences[0].getProperty(\"launcher.arguments\");\n+\n+\t\t\t\tif (property instanceof String[]) {\n+\t\t\t\t\targs = (String[]) property;\n+\n+\t\t\t\t\tServiceReference<EnvironmentInfo> srvcRef = context.getServiceReference(EnvironmentInfo.class);\n+\t\t\t\t\tif (srvcRef != null) {\n+\t\t\t\t\t\tEnvironmentInfo service = context.getService(srvcRef);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "150a520edd6375ad8d148746c11a06780ef94d6a"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjgxNTcyOQ==", "bodyText": "Why are the command line args (setAllArgs) and the non-framework args (setAppArgs) set to the same value?", "url": "https://github.com/bndtools/bnd/pull/4222#discussion_r452815729", "createdAt": "2020-07-10T12:36:49Z", "author": {"login": "bjhargrave"}, "path": "org.bndtools.applaunch/src/org/bndtools/applaunch/Activator.java", "diffHunk": "@@ -69,6 +75,39 @@ private static Filter createFilter() {\n \t\treturn context.registerService(ApplicationLauncher.class, new BndApplicationLauncher(context), null);\n \t}\n \n+\tprivate void setEquinoxConfigAppArgs(BundleContext context) {\n+\t\tString[] args = null;\n+\t\ttry {\n+\t\t\tServiceReference<?>[] serviceReferences = context.getServiceReferences(\"aQute.launcher.Launcher\",\n+\t\t\t\t\"(launcher.arguments=*)\");\n+\t\t\tif (serviceReferences != null && serviceReferences.length > 0) {\n+\t\t\t\tObject property = serviceReferences[0].getProperty(\"launcher.arguments\");\n+\n+\t\t\t\tif (property instanceof String[]) {\n+\t\t\t\t\targs = (String[]) property;\n+\n+\t\t\t\t\tServiceReference<EnvironmentInfo> srvcRef = context.getServiceReference(EnvironmentInfo.class);\n+\t\t\t\t\tif (srvcRef != null) {\n+\t\t\t\t\t\tEnvironmentInfo service = context.getService(srvcRef);\n+\t\t\t\t\t\tif (service instanceof EquinoxConfiguration) {\n+\t\t\t\t\t\t\tEquinoxConfiguration equinoxConfig = (EquinoxConfiguration) service;\n+\t\t\t\t\t\t\tequinoxConfig.setAllArgs(args);\n+\t\t\t\t\t\t\tequinoxConfig.setAppArgs(args);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "150a520edd6375ad8d148746c11a06780ef94d6a"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NDE0MTA5", "url": "https://github.com/bndtools/bnd/pull/4222#pullrequestreview-446414109", "createdAt": "2020-07-10T13:46:11Z", "commit": {"oid": "150a520edd6375ad8d148746c11a06780ef94d6a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "150a520edd6375ad8d148746c11a06780ef94d6a", "author": {"user": {"login": "gamerson", "name": "Gregory Amerson"}}, "url": "https://github.com/bndtools/bnd/commit/150a520edd6375ad8d148746c11a06780ef94d6a", "committedDate": "2020-07-10T11:40:25Z", "message": "set equinox configuration app args\n\nSigned-off-by: Gregory Amerson <gregory.amerson@liferay.com>"}, "afterCommit": {"oid": "59f1d97c2cc950f15d82c6f3f60f4fdfced4a026", "author": {"user": {"login": "gamerson", "name": "Gregory Amerson"}}, "url": "https://github.com/bndtools/bnd/commit/59f1d97c2cc950f15d82c6f3f60f4fdfced4a026", "committedDate": "2020-07-10T14:05:57Z", "message": "set equinox configuration app args\n\nSigned-off-by: Gregory Amerson <gregory.amerson@liferay.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NDMxNjkz", "url": "https://github.com/bndtools/bnd/pull/4222#pullrequestreview-446431693", "createdAt": "2020-07-10T14:08:19Z", "commit": {"oid": "59f1d97c2cc950f15d82c6f3f60f4fdfced4a026"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNDowODoxOVrOGv4y2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNDowODoxOVrOGv4y2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjg2Njc3Ng==", "bodyText": "envInfo could be null here, no?", "url": "https://github.com/bndtools/bnd/pull/4222#discussion_r452866776", "createdAt": "2020-07-10T14:08:19Z", "author": {"login": "bjhargrave"}, "path": "org.bndtools.applaunch/src/org/bndtools/applaunch/Activator.java", "diffHunk": "@@ -69,8 +75,40 @@ private static Filter createFilter() {\n \t\treturn context.registerService(ApplicationLauncher.class, new BndApplicationLauncher(context), null);\n \t}\n \n+\tprivate void setEquinoxConfigAppArgs(BundleContext context) {\n+\t\tString[] args = null;\n+\t\ttry {\n+\t\t\tServiceReference<?>[] serviceReferences = context.getServiceReferences(\"aQute.launcher.Launcher\",\n+\t\t\t\t\"(launcher.arguments=*)\");\n+\t\t\tif (serviceReferences != null && serviceReferences.length > 0) {\n+\t\t\t\tObject property = serviceReferences[0].getProperty(\"launcher.arguments\");\n+\n+\t\t\t\tif (property instanceof String[]) {\n+\t\t\t\t\targs = (String[]) property;\n+\n+\t\t\t\t\tenvInfo = context.getServiceReference(EnvironmentInfo.class);\n+\t\t\t\t\tif (envInfo != null) {\n+\t\t\t\t\t\tEnvironmentInfo service = context.getService(envInfo);\n+\t\t\t\t\t\tif (service instanceof EquinoxConfiguration) {\n+\t\t\t\t\t\t\tEquinoxConfiguration equinoxConfig = (EquinoxConfiguration) service;\n+\t\t\t\t\t\t\tequinoxConfig.setAppArgs(args);\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\n+\t\t\t\t\tlog.log(Level.FINE, \"configured program arguments \" + Arrays.toString(args));\n+\t\t\t\t}\n+\t\t\t} else {\n+\t\t\t\tlog.log(Level.SEVERE,\n+\t\t\t\t\t\"service aQute.launcher.Launcher with props launcher.arguments could not be retrieved\");\n+\t\t\t}\n+\t\t} catch (Exception e) {\n+\t\t\tlog.log(Level.SEVERE, \"command line parameters could not be configured.\");\n+\t\t}\n+\t}\n+\n \t@Override\n \tpublic void removedService(ServiceReference<Object> reference, ServiceRegistration<ApplicationLauncher> service) {\n+\t\tcontext.ungetService(envInfo);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "59f1d97c2cc950f15d82c6f3f60f4fdfced4a026"}, "originalPosition": 66}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa20af37aeb38602558645577b4f796ed62bf804", "author": {"user": {"login": "gamerson", "name": "Gregory Amerson"}}, "url": "https://github.com/bndtools/bnd/commit/fa20af37aeb38602558645577b4f796ed62bf804", "committedDate": "2020-07-10T14:09:12Z", "message": "set equinox configuration app args\n\nSigned-off-by: Gregory Amerson <gregory.amerson@liferay.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "59f1d97c2cc950f15d82c6f3f60f4fdfced4a026", "author": {"user": {"login": "gamerson", "name": "Gregory Amerson"}}, "url": "https://github.com/bndtools/bnd/commit/59f1d97c2cc950f15d82c6f3f60f4fdfced4a026", "committedDate": "2020-07-10T14:05:57Z", "message": "set equinox configuration app args\n\nSigned-off-by: Gregory Amerson <gregory.amerson@liferay.com>"}, "afterCommit": {"oid": "fa20af37aeb38602558645577b4f796ed62bf804", "author": {"user": {"login": "gamerson", "name": "Gregory Amerson"}}, "url": "https://github.com/bndtools/bnd/commit/fa20af37aeb38602558645577b4f796ed62bf804", "committedDate": "2020-07-10T14:09:12Z", "message": "set equinox configuration app args\n\nSigned-off-by: Gregory Amerson <gregory.amerson@liferay.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NDQxMDYy", "url": "https://github.com/bndtools/bnd/pull/4222#pullrequestreview-446441062", "createdAt": "2020-07-10T14:20:05Z", "commit": {"oid": "fa20af37aeb38602558645577b4f796ed62bf804"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3171, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}