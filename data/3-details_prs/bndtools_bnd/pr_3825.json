{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NzI3NTYy", "number": 3825, "title": "[repository] Error reporting on Repositories in RepositoriesView", "bodyText": "Currently, the error handling of repositories is quite bad. Some repositories throw an exception in the setProperties, others throw one at the first usage. These errors go into the Workspace but there are no mechanisms to see those errors.\nThis patch provides a mechanism to allow a repository to provide its status. Additionally, the RepositoriesView was adapted to show an icon (defined by the repository itself). This icon is decorated with the error status if it's a read-only repo and a remote repo.\nThe extra information we need from the repository is obtained via the RepositoryPlugin interface. The new methods all have defaults.\nThe MavenBndRepository was adjusted to take advantage of these new capabilities. It was changed to not throw exceptions on errors. It keeps a status field and reports this status. If it is still called, it will silently return a valid result like not found or empty collection.\nWe need a discussion to define this strategy. Likely, before a build, we should verify that all repositories -workspace have a null status. This should be cheap and aborts builds that will be erroneous anyway. After we have this discussion, I'll adapt all the other repositories.", "createdAt": "2020-03-06T09:48:53Z", "url": "https://github.com/bndtools/bnd/pull/3825", "merged": true, "mergeCommit": {"oid": "039990bb4d710c5e5b11680e2a83578776ff4ac0"}, "closed": true, "closedAt": "2020-03-06T17:04:24Z", "author": {"login": "pkriens"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKvSFcgH2gAyMzg0NzI3NTYyOjdkNjk1ZDE5MGVkMzRkMWVkZDQ3ZTJlNDAzZTFjMmExMzM2MWMzMTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLBYPhAH2gAyMzg0NzI3NTYyOjY2YmYwZDIxZWI2Y2U1ZDAyYzUwMTNkNGExZjJmZGM1ZDBiYWQzYzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7d695d190ed34d1edd47e2e403e1c2a13361c312", "author": {"user": {"login": "pkriens", "name": "Peter Kriens"}}, "url": "https://github.com/bndtools/bnd/commit/7d695d190ed34d1edd47e2e403e1c2a13361c312", "committedDate": "2020-03-05T17:50:37Z", "message": "[libg] Additions\n\n- IO.closeAll\n- A name for an exception type to display\n- Remote test for URI\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dff1f986100a3fafa449993ca6b064b46aaa375c", "author": {"user": {"login": "pkriens", "name": "Peter Kriens"}}, "url": "https://github.com/bndtools/bnd/commit/dff1f986100a3fafa449993ca6b064b46aaa375c", "committedDate": "2020-03-05T17:52:11Z", "message": "[icons] Added an Icon manager\n\nThis manager caches and it can created decorated \nimages.\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "910bdb329243e6259f179db65a9bcfa1b1bb56be", "author": {"user": {"login": "pkriens", "name": "Peter Kriens"}}, "url": "https://github.com/bndtools/bnd/commit/910bdb329243e6259f179db65a9bcfa1b1bb56be", "committedDate": "2020-03-05T17:55:13Z", "message": "[icon] Icon support for repos\n\nAdded icons support to the repositories view. The\nrepository can now return an icon name and status\ninformation that is used to visualize any problems\nwith the repo\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b011e9dbd953ba194e47599fb87c92c1a4a6444", "author": {"user": {"login": "pkriens", "name": "Peter Kriens"}}, "url": "https://github.com/bndtools/bnd/commit/2b011e9dbd953ba194e47599fb87c92c1a4a6444", "committedDate": "2020-03-06T09:18:26Z", "message": "[icons2] Adaptation of the MavenBndRepository\n\nThe MavenBndRepository is overhauled to support the\nnew icons and to have better error handling.\n\nThe plugin will now do more validation but it will\nnot throw an exception when validation fails. It\nwill have a non-null status and return default\nanswers to the API.\n\n\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a59a22607ec8d758ad636d1675fd8071d3e3173c", "author": {"user": {"login": "pkriens", "name": "Peter Kriens"}}, "url": "https://github.com/bndtools/bnd/commit/a59a22607ec8d758ad636d1675fd8071d3e3173c", "committedDate": "2020-03-06T12:26:40Z", "message": "[lgtm] Too many format specifiers\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMzU0OTM2", "url": "https://github.com/bndtools/bnd/pull/3825#pullrequestreview-370354936", "createdAt": "2020-03-06T14:21:07Z", "commit": {"oid": "7d695d190ed34d1edd47e2e403e1c2a13361c312"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNDoyMTowN1rOFy6Uqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNDoyODoyOFrOFy6lHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkyODY4Mw==", "bodyText": "This should be final, no?", "url": "https://github.com/bndtools/bnd/pull/3825#discussion_r388928683", "createdAt": "2020-03-06T14:21:07Z", "author": {"login": "bjhargrave"}, "path": "aQute.libg/src/aQute/lib/exceptions/Exceptions.java", "diffHunk": "@@ -63,4 +65,24 @@ public static String causes(Throwable t) {\n \t\treturn sj.toString();\n \t}\n \n+\tstatic Pattern DISPLAY_P = Pattern.compile(\"(.*)(Exception|Error)\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d695d190ed34d1edd47e2e403e1c2a13361c312"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkzMjg5NQ==", "bodyText": "Could this be a static method? It does not seem to use any instance members.", "url": "https://github.com/bndtools/bnd/pull/3825#discussion_r388932895", "createdAt": "2020-03-06T14:28:28Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.bndlib/src/aQute/bnd/http/HttpClient.java", "diffHunk": "@@ -881,4 +882,24 @@ private boolean isUpdateInfo(int code, URLConnection con) {\n \t\t}\n \n \t}\n+\n+\t/**\n+\t * Validate a URI to see if it is supported by this client\n+\t *\n+\t * @param u the uri\n+\t * @return null if ok, otherwise a reason why it is invalid\n+\t */\n+\tpublic String validateURI(URI u) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b011e9dbd953ba194e47599fb87c92c1a4a6444"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1e5257d9390e633664204bb545b2b995866e7a3", "author": {"user": {"login": "pkriens", "name": "Peter Kriens"}}, "url": "https://github.com/bndtools/bnd/commit/d1e5257d9390e633664204bb545b2b995866e7a3", "committedDate": "2020-03-06T14:52:34Z", "message": "[test] Failed name change of workspace test\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66bf0d21eb6ce5d02c5013d4a1f2fdc5d0bad3c2", "author": {"user": {"login": "pkriens", "name": "Peter Kriens"}}, "url": "https://github.com/bndtools/bnd/commit/66bf0d21eb6ce5d02c5013d4a1f2fdc5d0bad3c2", "committedDate": "2020-03-06T14:55:38Z", "message": "[exceptions] Made pattern final at the request of BJ\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3085, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}