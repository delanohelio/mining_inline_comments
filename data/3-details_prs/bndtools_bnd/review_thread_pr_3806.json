{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNDE4ODY5", "number": 3806, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjo0NzowMlrODkV0jA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMjo0Nzo0OFrODqXKug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDMyODQ0OnYy", "diffSide": "RIGHT", "path": "biz.aQute.repository/bnd.bnd", "isResolved": true, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjo0NzowMlrOFwm6jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxMjo0NzoyMFrOFxEX2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxMzU1MQ==", "bodyText": "I think it is wrong to put a copy of a core OSGi package in this jar. It if needs to go somewhere, it should centrally be in biz.aQute.bndlib.", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r386513551", "createdAt": "2020-03-02T16:47:02Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.repository/bnd.bnd", "diffHunk": "@@ -41,7 +41,8 @@ Export-Package: \\\n \taQute.maven.*, \\\n \n -includepackage: \\\n-\taQute.p2.provider\n+\taQute.p2.provider,\\\n+\torg.osgi.dto;-split-package:=first", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df9b979615bcf90b0e21268e7243508a0f20927a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg2OTM0OA==", "bodyText": "@pkriens wrote to me on slack, that we should put it in the gradle plugin. My gut feeling tells me, that bndlib is the better place. Outside of an OSGi FW the package is missing anyway and inside the FW, it does not matter if we export it too. I furthermore take an educated guess by predicting, that the P2Repo might not be the only thing that will use DTOs in the future.\nBTW: Is there any significant difference between the aQute.bnd.util.dto.DTO and the org.osgi.dto.DTO?", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r386869348", "createdAt": "2020-03-03T08:45:20Z", "author": {"login": "juergen-albert"}, "path": "biz.aQute.repository/bnd.bnd", "diffHunk": "@@ -41,7 +41,8 @@ Export-Package: \\\n \taQute.maven.*, \\\n \n -includepackage: \\\n-\taQute.p2.provider\n+\taQute.p2.provider,\\\n+\torg.osgi.dto;-split-package:=first", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxMzU1MQ=="}, "originalCommit": {"oid": "df9b979615bcf90b0e21268e7243508a0f20927a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njg4MDk2OA==", "bodyText": "This means that bndlib potentially conflicts in Eclipse since there is already an OSGi framework around. For this reason, I think it makes more sense to get the OSGi classes from the driver? If not, you might run into a class space separation with the uses constraints if you run on a framework that has a different version? This is a fuzzy area so I am not dogmatic.\n@juergen-albert The aQute classes were the inspiration for the OSGi DTO. So they existed long before the OSGi variant.", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r386880968", "createdAt": "2020-03-03T09:06:59Z", "author": {"login": "pkriens"}, "path": "biz.aQute.repository/bnd.bnd", "diffHunk": "@@ -41,7 +41,8 @@ Export-Package: \\\n \taQute.maven.*, \\\n \n -includepackage: \\\n-\taQute.p2.provider\n+\taQute.p2.provider,\\\n+\torg.osgi.dto;-split-package:=first", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxMzU1MQ=="}, "originalCommit": {"oid": "df9b979615bcf90b0e21268e7243508a0f20927a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk5MTk2Nw==", "bodyText": "bndlib already contains many OSGi Core packages that it imports but does not export. So when used in an OSGi runtime, bndlib uses the imported package. When used in a flat classpath, bndlib can use its own copy of the classes. So adding org.osgi.dto in this manner, like org.osgi.framework and org.osgi.resource, make sense.\nIf we want to make the driver provide these classes, we will need to make larger changes. I am fine with this also. It will affect maven, gradle and bnd (standalone). It will also affect anyone else who is using bndlib as they will need to change to provide these OSGi Core classes.\norg/osgi/framework/AdaptPermission$1.class\norg/osgi/framework/AdaptPermission.class\norg/osgi/framework/AdaptPermissionCollection.class\norg/osgi/framework/AdminPermission$1.class\norg/osgi/framework/AdminPermission.class\norg/osgi/framework/AdminPermissionCollection.class\norg/osgi/framework/AllServiceListener.class\norg/osgi/framework/Bundle.class\norg/osgi/framework/BundleActivator.class\norg/osgi/framework/BundleContext.class\norg/osgi/framework/BundleEvent.class\norg/osgi/framework/BundleException.class\norg/osgi/framework/BundleListener.class\norg/osgi/framework/BundlePermission.class\norg/osgi/framework/BundlePermissionCollection.class\norg/osgi/framework/BundleReference.class\norg/osgi/framework/CapabilityPermission$1.class\norg/osgi/framework/CapabilityPermission$Properties.class\norg/osgi/framework/CapabilityPermission.class\norg/osgi/framework/CapabilityPermissionCollection.class\norg/osgi/framework/Configurable.class\norg/osgi/framework/Constants.class\norg/osgi/framework/Filter.class\norg/osgi/framework/FrameworkEvent.class\norg/osgi/framework/FrameworkListener.class\norg/osgi/framework/FrameworkUtil$1.class\norg/osgi/framework/FrameworkUtil$CaseInsensitiveMap.class\norg/osgi/framework/FrameworkUtil$DNChainMatching.class\norg/osgi/framework/FrameworkUtil$FilterImpl$Parser.class\norg/osgi/framework/FrameworkUtil$FilterImpl.class\norg/osgi/framework/FrameworkUtil$ServiceReferenceMap.class\norg/osgi/framework/FrameworkUtil$SetAccessibleAction.class\norg/osgi/framework/FrameworkUtil.class\norg/osgi/framework/InvalidSyntaxException.class\norg/osgi/framework/PackagePermission$1.class\norg/osgi/framework/PackagePermission.class\norg/osgi/framework/PackagePermissionCollection.class\norg/osgi/framework/PrototypeServiceFactory.class\norg/osgi/framework/ServiceEvent.class\norg/osgi/framework/ServiceException.class\norg/osgi/framework/ServiceFactory.class\norg/osgi/framework/ServiceListener.class\norg/osgi/framework/ServiceObjects.class\norg/osgi/framework/ServicePermission$1.class\norg/osgi/framework/ServicePermission$Properties$Entry.class\norg/osgi/framework/ServicePermission$Properties.class\norg/osgi/framework/ServicePermission.class\norg/osgi/framework/ServicePermissionCollection.class\norg/osgi/framework/ServiceReference.class\norg/osgi/framework/ServiceRegistration.class\norg/osgi/framework/SignerProperty.class\norg/osgi/framework/SynchronousBundleListener.class\norg/osgi/framework/UnfilteredServiceListener.class\norg/osgi/framework/Version.class\norg/osgi/framework/VersionRange.class\norg/osgi/framework/launch/Framework.class\norg/osgi/framework/launch/FrameworkFactory.class\norg/osgi/framework/launch/package-info.class\norg/osgi/framework/launch/packageinfo\norg/osgi/framework/package-info.class\norg/osgi/framework/packageinfo\norg/osgi/resource/Capability.class\norg/osgi/resource/Namespace.class\norg/osgi/resource/Requirement.class\norg/osgi/resource/Resource.class\norg/osgi/resource/Wire.class\norg/osgi/resource/Wiring.class\norg/osgi/resource/package-info.class\norg/osgi/resource/packageinfo\norg/osgi/util/tracker/AbstractTracked.class\norg/osgi/util/tracker/BundleTracker$Tracked.class\norg/osgi/util/tracker/BundleTracker.class\norg/osgi/util/tracker/BundleTrackerCustomizer.class\norg/osgi/util/tracker/ServiceTracker$AllTracked.class\norg/osgi/util/tracker/ServiceTracker$Tracked.class\norg/osgi/util/tracker/ServiceTracker.class\norg/osgi/util/tracker/ServiceTrackerCustomizer.class\norg/osgi/util/tracker/package-info.class\norg/osgi/util/tracker/packageinfo", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r386991967", "createdAt": "2020-03-03T12:38:54Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.repository/bnd.bnd", "diffHunk": "@@ -41,7 +41,8 @@ Export-Package: \\\n \taQute.maven.*, \\\n \n -includepackage: \\\n-\taQute.p2.provider\n+\taQute.p2.provider,\\\n+\torg.osgi.dto;-split-package:=first", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxMzU1MQ=="}, "originalCommit": {"oid": "df9b979615bcf90b0e21268e7243508a0f20927a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk5MzE2NA==", "bodyText": "a) if they are private I guess it should be ok since we do not rely on OSGi classes in bndlib for internal functionality. I think they are all about OSGi knowledge?\nb) The driver approach seems a lot cleaner\nI leave it up to you ...", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r386993164", "createdAt": "2020-03-03T12:41:21Z", "author": {"login": "pkriens"}, "path": "biz.aQute.repository/bnd.bnd", "diffHunk": "@@ -41,7 +41,8 @@ Export-Package: \\\n \taQute.maven.*, \\\n \n -includepackage: \\\n-\taQute.p2.provider\n+\taQute.p2.provider,\\\n+\torg.osgi.dto;-split-package:=first", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxMzU1MQ=="}, "originalCommit": {"oid": "df9b979615bcf90b0e21268e7243508a0f20927a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk5NTY1OQ==", "bodyText": "So you are ok with removing the org.osgi.framework, org.osgi.resource packages from bndlib and requiring all users of bndlib, such as the maven plugins, gradle plugins, bnd.jar and all others to provide any needed OSGi packages?\nFor maven and gradle, it is easy to make the required OSGi packages available by using maven dependencies in the POM. For bnd.jar, we just need to -includepackage the necessary packages. External users of bndlib will need to know which packages they need if they are not using maven dependencies in the POM to build their classpath.", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r386995659", "createdAt": "2020-03-03T12:46:12Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.repository/bnd.bnd", "diffHunk": "@@ -41,7 +41,8 @@ Export-Package: \\\n \taQute.maven.*, \\\n \n -includepackage: \\\n-\taQute.p2.provider\n+\taQute.p2.provider,\\\n+\torg.osgi.dto;-split-package:=first", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxMzU1MQ=="}, "originalCommit": {"oid": "df9b979615bcf90b0e21268e7243508a0f20927a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njk5NjE4NQ==", "bodyText": "hmm, that is true. Shall we discuss this Friday?", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r386996185", "createdAt": "2020-03-03T12:47:20Z", "author": {"login": "pkriens"}, "path": "biz.aQute.repository/bnd.bnd", "diffHunk": "@@ -41,7 +41,8 @@ Export-Package: \\\n \taQute.maven.*, \\\n \n -includepackage: \\\n-\taQute.p2.provider\n+\taQute.p2.provider,\\\n+\torg.osgi.dto;-split-package:=first", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUxMzU1MQ=="}, "originalCommit": {"oid": "df9b979615bcf90b0e21268e7243508a0f20927a"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NDY5NDc0OnYy", "diffSide": "RIGHT", "path": "biz.aQute.bndlib/bnd.bnd", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxNzo0ODoyNFrOF5qurQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxMDoxNDowNVrOF5ukDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjAxMzIyOQ==", "bodyText": "osgi.core (above) already contains the dto package. So you do not need to add org.osgi.dto to the buildpath.", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r396013229", "createdAt": "2020-03-21T17:48:24Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.bndlib/bnd.bnd", "diffHunk": "@@ -73,6 +75,7 @@ Import-Package: \\\n \torg.osgi.service.repository;version=latest,\\\n \torg.osgi.util.function;version=latest,\\\n \torg.osgi.util.promise;version=latest,\\\n+\torg.osgi.dto;version=latest,\\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b43c671b4f38c02c6305e2d928a910a38c0be9b3"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA3NjA0Ng==", "bodyText": "I think you deleted the wrong line. You need org.osgi.dto in the Import-Package statement. You do not need org.osgi.dto in the -buildpath instruction since osgi.core is already in the -buildpath instruction and it contains the org.osgi.dto package.", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r396076046", "createdAt": "2020-03-22T10:14:05Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.bndlib/bnd.bnd", "diffHunk": "@@ -73,6 +75,7 @@ Import-Package: \\\n \torg.osgi.service.repository;version=latest,\\\n \torg.osgi.util.function;version=latest,\\\n \torg.osgi.util.promise;version=latest,\\\n+\torg.osgi.dto;version=latest,\\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjAxMzIyOQ=="}, "originalCommit": {"oid": "b43c671b4f38c02c6305e2d928a910a38c0be9b3"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzQ2MzYyOnYy", "diffSide": "RIGHT", "path": "biz.aQute.bndlib/bnd.bnd", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMjo0Nzo0OFrOF6D1cA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMjo0Nzo0OFrOF6D1cA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQyNDU2MA==", "bodyText": "This is still wrong. You don't need this since bndlib itself contains the package for non-OSGi use cases. Doing thing just adds a second copy of the package to the classpath for maven/gradle.\nAlso, you need to readd the Import-Package statement for org.osgi.dto. Even though bndlib itself does not currently use the org.osgi.dto package, it does no harm to import it and it prevents us from making silly mistakes in the future when we actually do start to use it in bndlib and then forget to add the Import-Package for it.", "url": "https://github.com/bndtools/bnd/pull/3806#discussion_r396424560", "createdAt": "2020-03-23T12:47:48Z", "author": {"login": "bjhargrave"}, "path": "biz.aQute.bndlib/bnd.bnd", "diffHunk": "@@ -62,6 +63,12 @@ Import-Package: \\\n \n -maven-scope: provided\n \n+-maven-dependencies.core: \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a71c592a6168d5d1468ae4817284c4a419c8ec8"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1502, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}