{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyNzQ0Mzg2", "number": 3268, "title": "chore: update showcase version for sequence tests", "bodyText": "This updates the version of Showcase used for generation in CI to v0.12.0 and adds a test for the new SequenceService to assert the basic retry attempt logic and timeout-backoff behavior works as implemented.", "createdAt": "2020-08-24T20:19:49Z", "url": "https://github.com/googleapis/gapic-generator/pull/3268", "merged": true, "mergeCommit": {"oid": "6c4b62ab71b6be799bd8f96f4ca58c7973062374"}, "closed": true, "closedAt": "2020-08-25T15:23:37Z", "author": {"login": "noahdietz"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCJb2dgH2gAyNDcyNzQ0Mzg2OjRjZGU0NDAzMzJhMGMyYTAxYmMzZTJlZGY0ZDhiM2VlNTg0YjM0MTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCNKbBAH2gAyNDcyNzQ0Mzg2OjhjNjUzYjUwOGNmNGYzYmExODBhNzQ4ZmQyZTg4MWZmODY2YWZkOTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4cde440332a0c2a01bc3e2edf4d8b3ee584b3414", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/4cde440332a0c2a01bc3e2edf4d8b3ee584b3414", "committedDate": "2020-08-24T21:24:39Z", "message": "chore: update showcase version for sequence tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3594e1cd07bfad61f77a9d5d13acf3f550581c5e", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/3594e1cd07bfad61f77a9d5d13acf3f550581c5e", "committedDate": "2020-08-24T21:11:18Z", "message": "add SequenceService to showcase test config"}, "afterCommit": {"oid": "4cde440332a0c2a01bc3e2edf4d8b3ee584b3414", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/4cde440332a0c2a01bc3e2edf4d8b3ee584b3414", "committedDate": "2020-08-24T21:24:39Z", "message": "chore: update showcase version for sequence tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczOTIzNDk3", "url": "https://github.com/googleapis/gapic-generator/pull/3268#pullrequestreview-473923497", "createdAt": "2020-08-24T22:30:31Z", "commit": {"oid": "4cde440332a0c2a01bc3e2edf4d8b3ee584b3414"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMjozMDozMlrOHF4ebg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMjozMjozMlrOHF4hLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkzMDIyMg==", "bodyText": "Why not just int i = 1 in the for loop declaration?", "url": "https://github.com/googleapis/gapic-generator/pull/3268#discussion_r475930222", "createdAt": "2020-08-24T22:30:32Z", "author": {"login": "vam-google"}, "path": "showcase/java/src/test/java/com/google/api/showcase/ShowcaseTest.java", "diffHunk": "@@ -258,4 +277,66 @@ public void block() {\n                 .build());\n     assertThat(result.getContent()).isEqualTo(\"Hello, World!\");\n   }\n+\n+  @Test\n+  public void attemptSequence() {\n+    Sequence toCreate =\n+        Sequence.newBuilder()\n+            .addResponses(\n+                Sequence.Response.newBuilder()\n+                    .setStatus(Status.newBuilder().setCode(Code.UNAVAILABLE_VALUE)))\n+            .addResponses(\n+                Sequence.Response.newBuilder()\n+                    .setStatus(Status.newBuilder().setCode(Code.UNAVAILABLE_VALUE)))\n+            .addResponses(\n+                Sequence.Response.newBuilder()\n+                    .setStatus(Status.newBuilder().setCode(Code.OK_VALUE)))\n+            .build();\n+    Sequence sequence = seqClient.createSequence(toCreate);\n+    assertThat(sequence.getName()).isNotNull();\n+\n+    seqClient.attemptSequence(sequence.getName());\n+\n+    SequenceReport report = seqClient.getSequenceReport(sequence.getName() + \"/sequenceReport\");\n+    assertThat(report.getAttemptsList()).isNotNull();\n+    assertThat(report.getAttemptsList().size()).isEqualTo(3);\n+  }\n+\n+  @Test\n+  public void attemptSequenceTimeoutBackoff() {\n+    Sequence toCreate =\n+        Sequence.newBuilder()\n+            .addResponses(\n+                Sequence.Response.newBuilder()\n+                    .setDelay(Duration.newBuilder().setSeconds(2L))\n+                    .setStatus(Status.newBuilder().setCode(Code.UNAVAILABLE_VALUE)))\n+            .addResponses(\n+                Sequence.Response.newBuilder()\n+                    .setDelay(Duration.newBuilder().setSeconds(2L))\n+                    .setStatus(Status.newBuilder().setCode(Code.UNAVAILABLE_VALUE)))\n+            .addResponses(\n+                Sequence.Response.newBuilder()\n+                    .setStatus(Status.newBuilder().setCode(Code.OK_VALUE)))\n+            .build();\n+    Sequence sequence = seqClient.createSequence(toCreate);\n+    assertThat(sequence.getName()).isNotNull();\n+\n+    seqClient.attemptSequence(\n+        AttemptSequenceRequest.newBuilder().setName(sequence.getName()).build());\n+\n+    SequenceReport report = seqClient.getSequenceReport(sequence.getName() + \"/sequenceReport\");\n+    assertThat(report.getAttemptsList()).isNotNull();\n+    assertThat(report.getAttemptsList().size()).isEqualTo(3);\n+    for (int i = 0; i < report.getAttemptsList().size(); i++) {\n+      if (i == 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cde440332a0c2a01bc3e2edf4d8b3ee584b3414"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkzMDkyNA==", "bodyText": "The other test is TimeoutBackoff, can you be more specific about what this test tests?", "url": "https://github.com/googleapis/gapic-generator/pull/3268#discussion_r475930924", "createdAt": "2020-08-24T22:32:32Z", "author": {"login": "vam-google"}, "path": "showcase/java/src/test/java/com/google/api/showcase/ShowcaseTest.java", "diffHunk": "@@ -258,4 +277,66 @@ public void block() {\n                 .build());\n     assertThat(result.getContent()).isEqualTo(\"Hello, World!\");\n   }\n+\n+  @Test\n+  public void attemptSequence() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cde440332a0c2a01bc3e2edf4d8b3ee584b3414"}, "originalPosition": 68}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "989d842a980984dbff14e8b43a71b670bd358956", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/989d842a980984dbff14e8b43a71b670bd358956", "committedDate": "2020-08-24T22:37:45Z", "message": "incorporate feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cba9f3018faac9110280d694be49ace9ff09d95c", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/cba9f3018faac9110280d694be49ace9ff09d95c", "committedDate": "2020-08-25T00:19:31Z", "message": "regen ruby showcase without sequence service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "764eb14af18fec6991f4dc87352875b818b3d008", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/764eb14af18fec6991f4dc87352875b818b3d008", "committedDate": "2020-08-25T00:25:40Z", "message": "fix languages flag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28468c8072fd26fe4807e7e79c4fded64bb3819e", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/28468c8072fd26fe4807e7e79c4fded64bb3819e", "committedDate": "2020-08-25T00:55:21Z", "message": "remove Sequence service from config for ruby"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6412c4ec202b6034f2fb989609d63b863509bd35", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/6412c4ec202b6034f2fb989609d63b863509bd35", "committedDate": "2020-08-25T01:07:16Z", "message": "fix sed maybe"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d26709114d2f13ba02fd27a2609cd77ccbfca181", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/d26709114d2f13ba02fd27a2609cd77ccbfca181", "committedDate": "2020-08-25T01:39:29Z", "message": "fix gen script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c653b508cf4f3ba180a748fd2e881ff866afd95", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/8c653b508cf4f3ba180a748fd2e881ff866afd95", "committedDate": "2020-08-25T01:45:14Z", "message": "fix gen script maybe"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1345, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}