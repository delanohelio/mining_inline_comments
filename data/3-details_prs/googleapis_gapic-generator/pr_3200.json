{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwMzY2NTY2", "number": 3200, "title": "all: grpc_service_config timeout settings", "bodyText": "When using grpc_service_config the max & initial rpc timeout should be the same as the total timeout. This essentially renders the hedging logic unused because the initial timeout is the limit. This means one RPC is made with the desired (total) timeout rather than several smaller ones that are backed off until the total is reached.\nPreviously, the max & initial timeout would be 0 which I believe is incorrect, because that means there is no client-side timeout on the RPC, even if total_timeout was provided. So the server would have to close the connection before the client would. This could've caused client calls to hang.\nOther changes:\n\nswitch showcase to gapic v2 & grpc_service_config\nretry mapping: fix NPE when a Service in the config is not present in protos\nshowcase: add blockTimeout test\nshowcase: add valid block showcase test\nupdate gapic-showcase image for java to v0.10.1\nlengthen delay on flaky showcase java streaming tests\n\nNote: the ShowcaseTest.java was tested locally against gapic-showcase as well as in CI.", "createdAt": "2020-05-19T21:08:36Z", "url": "https://github.com/googleapis/gapic-generator/pull/3200", "merged": true, "mergeCommit": {"oid": "1a9835a9483d705723ed6bfce8133cb88f9e0575"}, "closed": true, "closedAt": "2020-05-27T20:56:23Z", "author": {"login": "noahdietz"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjKUfmABqjMzNTY4NzQyNzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclfpsugFqTQxOTYwMDA4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab2aa2576f6c8805ffdc99cd6d4b3357a3675bb2", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/ab2aa2576f6c8805ffdc99cd6d4b3357a3675bb2", "committedDate": "2020-05-20T14:53:32Z", "message": "restore messaging.proto"}, "afterCommit": {"oid": "c8ea25177ee4ed8aa349d32f5eb4efef212c71da", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/c8ea25177ee4ed8aa349d32f5eb4efef212c71da", "committedDate": "2020-05-20T14:54:45Z", "message": "restore messaging.proto"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c8ea25177ee4ed8aa349d32f5eb4efef212c71da", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/c8ea25177ee4ed8aa349d32f5eb4efef212c71da", "committedDate": "2020-05-20T14:54:45Z", "message": "restore messaging.proto"}, "afterCommit": {"oid": "89ff070031a0cc0598ee4ed2d0464a30dcd6e287", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/89ff070031a0cc0598ee4ed2d0464a30dcd6e287", "committedDate": "2020-05-20T21:16:38Z", "message": "restore messaging.proto"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "993cbf305a664678ea9f6ba0c132c8ec2a145404", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/993cbf305a664678ea9f6ba0c132c8ec2a145404", "committedDate": "2020-05-21T00:24:34Z", "message": "all: set max & initial timeouts to total timeout\n\nWhen using grpc_service_config the max & initial rpc timeout\nshould be the same as the total timeout. This essentially\nrenders the hedging logic unused because the initial timeout\nis the limit. This means one RPC is made rather than several\nsmaller ones that are backed off until the total is reached.\n\n* switch showcase to gapic v2 & grpc_service_config\n* retry mapping: fix NPE when a Service is not present in protos\n* add blockTimeout showcase test\n* add valid block showcase test\n* update gapic-showcase image for java to v0.10.1\n* lengthen delay on flaky showcase java streaming tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc7231bf45f2f0cb09feb4892be75fd38ad39b25", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/dc7231bf45f2f0cb09feb4892be75fd38ad39b25", "committedDate": "2020-05-21T00:12:07Z", "message": "lengthen delay on streaming tests"}, "afterCommit": {"oid": "993cbf305a664678ea9f6ba0c132c8ec2a145404", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/993cbf305a664678ea9f6ba0c132c8ec2a145404", "committedDate": "2020-05-21T00:24:34Z", "message": "all: set max & initial timeouts to total timeout\n\nWhen using grpc_service_config the max & initial rpc timeout\nshould be the same as the total timeout. This essentially\nrenders the hedging logic unused because the initial timeout\nis the limit. This means one RPC is made rather than several\nsmaller ones that are backed off until the total is reached.\n\n* switch showcase to gapic v2 & grpc_service_config\n* retry mapping: fix NPE when a Service is not present in protos\n* add blockTimeout showcase test\n* add valid block showcase test\n* update gapic-showcase image for java to v0.10.1\n* lengthen delay on flaky showcase java streaming tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1OTExNTI4", "url": "https://github.com/googleapis/gapic-generator/pull/3200#pullrequestreview-415911528", "createdAt": "2020-05-21T06:35:43Z", "commit": {"oid": "993cbf305a664678ea9f6ba0c132c8ec2a145404"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNjozNTo0NFrOGYn2ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQwNjozNzozM1rOGYn49Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MTk3MQ==", "bodyText": "Is it necessary to set them both to 0? My naive understanding of this suggests that if timeout is 0 it does not matter what the multiplier is, because it will be multiplied by 0, so the total result will always be 0 anyways (well, unless the multiplier is infinity, but it is not practically possible).", "url": "https://github.com/googleapis/gapic-generator/pull/3200#discussion_r428471971", "createdAt": "2020-05-21T06:35:44Z", "author": {"login": "vam-google"}, "path": "src/main/java/com/google/api/codegen/config/GrpcGapicRetryMapping.java", "diffHunk": "@@ -151,11 +155,17 @@ private static void applyRetryPolicyToName(\n \n   private static RetryParamsDefinitionProto.Builder retryPolicyToParamsBuilder(\n       RetryPolicy retryPolicy, long timeout, String policyName) {\n+    // If the timeout is 0, make the timeout multiplier 0 as well, otherwise", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "993cbf305a664678ea9f6ba0c132c8ec2a145404"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ3MjU2NQ==", "bodyText": "Why is all this removed?", "url": "https://github.com/googleapis/gapic-generator/pull/3200#discussion_r428472565", "createdAt": "2020-05-21T06:37:33Z", "author": {"login": "vam-google"}, "path": "src/test/java/com/google/api/codegen/testsrc/showcase/showcase_gapic.yaml", "diffHunk": "@@ -20,139 +20,3 @@ language_settings:\n     package_name: Google\\Showcase\\V1beta1\n   nodejs:\n     package_name: showcase.v1beta1\n-# The configuration for the license header to put on generated files.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "993cbf305a664678ea9f6ba0c132c8ec2a145404"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c009ceb3f5a9d6c0648b4ddc559d81c6547fb3cf", "author": {"user": {"login": "noahdietz", "name": "Noah Dietz"}}, "url": "https://github.com/googleapis/gapic-generator/commit/c009ceb3f5a9d6c0648b4ddc559d81c6547fb3cf", "committedDate": "2020-05-26T16:46:43Z", "message": "always set timeout multiplier to 1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjAwMDgx", "url": "https://github.com/googleapis/gapic-generator/pull/3200#pullrequestreview-419600081", "createdAt": "2020-05-27T20:53:53Z", "commit": {"oid": "c009ceb3f5a9d6c0648b4ddc559d81c6547fb3cf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1396, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}