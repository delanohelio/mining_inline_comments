{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NDI1NzUy", "number": 675, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNjoxNzoyNFrOEHTgzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNjo1NjoxNFrOEHToJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MDk1MTgzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/gluonhq/substrate/util/FileDeps.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNjoxNzoyNFrOGmnQSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNjozNTo1MFrOGmnUpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE0MjIxNg==", "bodyText": "this looks like all packages will be downloaded, not only the missing ones?", "url": "https://github.com/gluonhq/substrate/pull/675#discussion_r443142216", "createdAt": "2020-06-20T16:17:24Z", "author": {"login": "johanvos"}, "path": "src/main/java/com/gluonhq/substrate/util/FileDeps.java", "diffHunk": "@@ -134,6 +137,24 @@ public Path getAndroidNDKPath() throws IOException {\n         return resolvePath(configuration.getAndroidNdkPath(),\"Fatal error, could not install Android NDK \");\n     }\n \n+    /**\n+     * Checks that the required Android packages are present, else proceeds to\n+     * install them\n+     *\n+     * @param androidSdk The path to the Android SDK\n+     * @throws IOException\n+     * @throws InterruptedException\n+     */\n+    public void checkAndroidPackages(String androidSdk) throws IOException, InterruptedException {\n+        if (Stream.of(ANDROID_SDK_PACKAGES)\n+                .filter(s -> !s.contains(\"ndk\"))\n+                .map(s -> Path.of(androidSdk, s.split(\";\")))\n+                .anyMatch(p -> !Files.exists(p))) {\n+            Logger.logInfo(\"Some required Android packages were not found, they will be downloaded.\");\n+            fetchFromSdkManager();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efcfe509c11a876cd782806b4e2242bc95ca76c9"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE0MzMzMw==", "bodyText": "No, the SdkManager verifies what is already installed and what needs to be installed or updated.", "url": "https://github.com/gluonhq/substrate/pull/675#discussion_r443143333", "createdAt": "2020-06-20T16:35:50Z", "author": {"login": "jperedadnr"}, "path": "src/main/java/com/gluonhq/substrate/util/FileDeps.java", "diffHunk": "@@ -134,6 +137,24 @@ public Path getAndroidNDKPath() throws IOException {\n         return resolvePath(configuration.getAndroidNdkPath(),\"Fatal error, could not install Android NDK \");\n     }\n \n+    /**\n+     * Checks that the required Android packages are present, else proceeds to\n+     * install them\n+     *\n+     * @param androidSdk The path to the Android SDK\n+     * @throws IOException\n+     * @throws InterruptedException\n+     */\n+    public void checkAndroidPackages(String androidSdk) throws IOException, InterruptedException {\n+        if (Stream.of(ANDROID_SDK_PACKAGES)\n+                .filter(s -> !s.contains(\"ndk\"))\n+                .map(s -> Path.of(androidSdk, s.split(\";\")))\n+                .anyMatch(p -> !Files.exists(p))) {\n+            Logger.logInfo(\"Some required Android packages were not found, they will be downloaded.\");\n+            fetchFromSdkManager();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE0MjIxNg=="}, "originalCommit": {"oid": "efcfe509c11a876cd782806b4e2242bc95ca76c9"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MDk3MDYxOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/gluonhq/substrate/util/FileDeps.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNjo1NjoxNFrOGmnZ3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQxNzoxMDo0NlrOGmndYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE0NDY2OA==", "bodyText": "It would be good to print the missing packages here, so that the developer (or we) can verify", "url": "https://github.com/gluonhq/substrate/pull/675#discussion_r443144668", "createdAt": "2020-06-20T16:56:14Z", "author": {"login": "johanvos"}, "path": "src/main/java/com/gluonhq/substrate/util/FileDeps.java", "diffHunk": "@@ -134,6 +137,24 @@ public Path getAndroidNDKPath() throws IOException {\n         return resolvePath(configuration.getAndroidNdkPath(),\"Fatal error, could not install Android NDK \");\n     }\n \n+    /**\n+     * Checks that the required Android packages are present, else proceeds to\n+     * install them\n+     *\n+     * @param androidSdk The path to the Android SDK\n+     * @throws IOException\n+     * @throws InterruptedException\n+     */\n+    public void checkAndroidPackages(String androidSdk) throws IOException, InterruptedException {\n+        if (Stream.of(ANDROID_SDK_PACKAGES)\n+                .filter(s -> !s.contains(\"ndk\"))\n+                .map(s -> Path.of(androidSdk, s.split(\";\")))\n+                .anyMatch(p -> !Files.exists(p))) {\n+            Logger.logInfo(\"Some required Android packages were not found, they will be downloaded.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efcfe509c11a876cd782806b4e2242bc95ca76c9"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE0NTU3MA==", "bodyText": "Fixed", "url": "https://github.com/gluonhq/substrate/pull/675#discussion_r443145570", "createdAt": "2020-06-20T17:10:46Z", "author": {"login": "jperedadnr"}, "path": "src/main/java/com/gluonhq/substrate/util/FileDeps.java", "diffHunk": "@@ -134,6 +137,24 @@ public Path getAndroidNDKPath() throws IOException {\n         return resolvePath(configuration.getAndroidNdkPath(),\"Fatal error, could not install Android NDK \");\n     }\n \n+    /**\n+     * Checks that the required Android packages are present, else proceeds to\n+     * install them\n+     *\n+     * @param androidSdk The path to the Android SDK\n+     * @throws IOException\n+     * @throws InterruptedException\n+     */\n+    public void checkAndroidPackages(String androidSdk) throws IOException, InterruptedException {\n+        if (Stream.of(ANDROID_SDK_PACKAGES)\n+                .filter(s -> !s.contains(\"ndk\"))\n+                .map(s -> Path.of(androidSdk, s.split(\";\")))\n+                .anyMatch(p -> !Files.exists(p))) {\n+            Logger.logInfo(\"Some required Android packages were not found, they will be downloaded.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE0NDY2OA=="}, "originalCommit": {"oid": "efcfe509c11a876cd782806b4e2242bc95ca76c9"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2924, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}