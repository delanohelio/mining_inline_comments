{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0ODYyNzA5", "number": 478, "title": "pass user.home on ios to GraalVM", "bodyText": "fix for #313", "createdAt": "2020-03-27T16:50:01Z", "url": "https://github.com/gluonhq/substrate/pull/478", "merged": true, "mergeCommit": {"oid": "6536f75ed731c3536839dcf1172e7b7759d90279"}, "closed": true, "closedAt": "2020-03-30T09:22:32Z", "author": {"login": "johanvos"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRzlr7gH2gAyMzk0ODYyNzA5OjA2ZTUzZmFhYWY0NGNjM2MxYTJlZjRiYzkwNzlkOWI4ZWUxYjg0MTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcR2QAUgFqTM4MzE2MDA0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416", "author": {"user": {"login": "johanvos", "name": "Johan Vos"}}, "url": "https://github.com/gluonhq/substrate/commit/06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416", "committedDate": "2020-03-27T16:49:07Z", "message": "pass user.home on ios to GraalVM"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMDQ3NTIz", "url": "https://github.com/gluonhq/substrate/pull/478#pullrequestreview-383047523", "createdAt": "2020-03-27T17:08:19Z", "commit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzowODoyMFrOF86YHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzoxMjo0OFrOF86iYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNTMyNg==", "bodyText": "Update year in license header", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399415326", "createdAt": "2020-03-27T17:08:20Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -51,12 +51,9 @@ @interface AppDelegate : UIResponder <UIApplicationDelegate>\n \n @end\n \n-int startGVM();\n+int startGVM(const char* userHome);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNjE0MQ==", "bodyText": "Probably no need to create new objects, just inline:\nNSString *folderPath = [documentsDir stringByAppendingPathComponent:@\"gluon\"];\nNSString *userhomeProp = [@\"-Duser.home=\" stringByAppendingString: folderPath];", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399416141", "createdAt": "2020-03-27T17:09:42Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNjk1OA==", "bodyText": "Update message log", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399416958", "createdAt": "2020-03-27T17:11:07Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];\n+\n+    if (!folderPath) {\n+        NSLog(@\"Error getting the private storage path\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNzE3Mg==", "bodyText": "Update message log", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399417172", "createdAt": "2020-03-27T17:11:31Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];\n+\n+    if (!folderPath) {\n+        NSLog(@\"Error getting the private storage path\");\n+    }\n+\n+    NSFileManager *manager = [NSFileManager defaultManager];\n+    [manager createDirectoryAtPath: folderPath withIntermediateDirectories: NO attributes: nil error: nil];\n+\n+    NSLog(@\"Done creating private storage %@\", folderPath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNzk1Mg==", "bodyText": "Is this a critical error? Anyway, the check should be done before NSString *userhomeProp = ...?", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399417952", "createdAt": "2020-03-27T17:12:48Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];\n+\n+    if (!folderPath) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63033ac481c5164eccdff2f1e372d00ba355f0dc", "author": {"user": {"login": "johanvos", "name": "Johan Vos"}}, "url": "https://github.com/gluonhq/substrate/commit/63033ac481c5164eccdff2f1e372d00ba355f0dc", "committedDate": "2020-03-27T19:44:28Z", "message": "process comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMTYwMDQz", "url": "https://github.com/gluonhq/substrate/pull/478#pullrequestreview-383160043", "createdAt": "2020-03-27T19:55:09Z", "commit": {"oid": "63033ac481c5164eccdff2f1e372d00ba355f0dc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2160, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}