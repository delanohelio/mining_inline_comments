{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0ODYyNzA5", "number": 478, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzowODoyMFrODsJ58Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzoxMjo0OFrODsKAOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjI2MjI1OnYy", "diffSide": "RIGHT", "path": "src/main/resources/native/ios/AppDelegate.m", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzowODoyMFrOF86YHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzowODoyMFrOF86YHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNTMyNg==", "bodyText": "Update year in license header", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399415326", "createdAt": "2020-03-27T17:08:20Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -51,12 +51,9 @@ @interface AppDelegate : UIResponder <UIApplicationDelegate>\n \n @end\n \n-int startGVM();\n+int startGVM(const char* userHome);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjI2NzI0OnYy", "diffSide": "RIGHT", "path": "src/main/resources/native/ios/AppDelegate.m", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzowOTo0MlrOF86bTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxOTozOToyNlrOF8_fAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNjE0MQ==", "bodyText": "Probably no need to create new objects, just inline:\nNSString *folderPath = [documentsDir stringByAppendingPathComponent:@\"gluon\"];\nNSString *userhomeProp = [@\"-Duser.home=\" stringByAppendingString: folderPath];", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399416141", "createdAt": "2020-03-27T17:09:42Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ5OTAxMQ==", "bodyText": "I prefer to keep those on separate lines. The resulting native code is the same, but I want to keep linenumber info as small as possible (if we see a crash in line X, I want a single statement to be the possible cause).", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399499011", "createdAt": "2020-03-27T19:39:26Z", "author": {"login": "johanvos"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNjE0MQ=="}, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjI3MjM0OnYy", "diffSide": "RIGHT", "path": "src/main/resources/native/ios/AppDelegate.m", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzoxMTowN1rOF86efg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzoxMTowN1rOF86efg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNjk1OA==", "bodyText": "Update message log", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399416958", "createdAt": "2020-03-27T17:11:07Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];\n+\n+    if (!folderPath) {\n+        NSLog(@\"Error getting the private storage path\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjI3MzU3OnYy", "diffSide": "RIGHT", "path": "src/main/resources/native/ios/AppDelegate.m", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzoxMTozMVrOF86fVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzoxMTozMVrOF86fVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNzE3Mg==", "bodyText": "Update message log", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399417172", "createdAt": "2020-03-27T17:11:31Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];\n+\n+    if (!folderPath) {\n+        NSLog(@\"Error getting the private storage path\");\n+    }\n+\n+    NSFileManager *manager = [NSFileManager defaultManager];\n+    [manager createDirectoryAtPath: folderPath withIntermediateDirectories: NO attributes: nil error: nil];\n+\n+    NSLog(@\"Done creating private storage %@\", folderPath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjI3ODMyOnYy", "diffSide": "RIGHT", "path": "src/main/resources/native/ios/AppDelegate.m", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzoxMjo0OFrOF86iYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxNzoxMjo0OFrOF86iYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQxNzk1Mg==", "bodyText": "Is this a critical error? Anyway, the check should be done before NSString *userhomeProp = ...?", "url": "https://github.com/gluonhq/substrate/pull/478#discussion_r399417952", "createdAt": "2020-03-27T17:12:48Z", "author": {"login": "jperedadnr"}, "path": "src/main/resources/native/ios/AppDelegate.m", "diffHunk": "@@ -74,7 +71,23 @@ @implementation AppDelegate\n \n -(void)startVM:(id)selector {\n     gvmlog(@\"Starting vm...\");\n-    startGVM();\n+    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);\n+    NSString *documentsDir = [documentPaths objectAtIndex:0];\n+    NSString *folder = @\"gluon\";\n+    NSString *folderPath = [documentsDir stringByAppendingPathComponent:folder];\n+    NSString *prop = @\"-Duser.home=\";\n+    NSString *userhomeProp = [prop stringByAppendingString: folderPath];\n+\n+    if (!folderPath) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06e53faaaf44cc3c1a2ef4bc9079d9b8ee1b8416"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3002, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}