{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0NTI1NDIz", "number": 468, "title": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode", "bodyText": "Fix #240\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile\nDescription\n\nType of change\n\n\n Bug fix (non-breaking change which fixes an issue)\n Feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to change\n Chore (non-breaking change which doesn't affect codebase;\ntest, version modification, documentation, etc.)\n\nChecklist\n\n I have read the contributing guidelines\n I signed-off my commit with a user that has signed the Eclipse Contributor Agreement\n I Added CHANGELOG entry\n I have implemented unit tests to cover my changes\n I have updated the documentation accordingly\n No new bugs, code smells, etc. in SonarCloud report\n I tested my code in Kubernetes\n I tested my code in OpenShift", "createdAt": "2020-11-03T06:51:04Z", "url": "https://github.com/eclipse/jkube/pull/468", "merged": true, "mergeCommit": {"oid": "7cfd1277a84b1fc6c30019c1754d408431c35492"}, "closed": true, "closedAt": "2020-11-05T05:16:25Z", "author": {"login": "rohanKanojia"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdY0CkMgBqjM5NTE0Njg3ODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZQb6vgFqTUyMzUzNDkxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e07c1c04d9c1bae026114bf9246fa63123518411", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/e07c1c04d9c1bae026114bf9246fa63123518411", "committedDate": "2020-11-03T06:13:10Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}, "afterCommit": {"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/d0176a2d8275433d17496a02ccfa81449fb12ac4", "committedDate": "2020-11-03T07:29:02Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMDcxMDIz", "url": "https://github.com/eclipse/jkube/pull/468#pullrequestreview-523071023", "createdAt": "2020-11-04T06:26:19Z", "commit": {"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNjoyNjoxOVrOHtKhcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNjoyNjoxOVrOHtKhcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEyMDM2OA==", "bodyText": "nit: Please make it consistent, rename to extractPorts", "url": "https://github.com/eclipse/jkube/pull/468#discussion_r517120368", "createdAt": "2020-11-04T06:26:19Z", "author": {"login": "manusa"}, "path": "jkube-kit/build/api/src/main/java/org/eclipse/jkube/kit/build/api/helper/DockerFileUtil.java", "diffHunk": "@@ -312,4 +317,23 @@ private static String trimSurroundingQuotes(String argStringValue) {\n         }\n         return argStringValue;\n     }\n+\n+    static List<String> getPortsFromDockerFile(File dockerFile) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMDcxODQ3", "url": "https://github.com/eclipse/jkube/pull/468#pullrequestreview-523071847", "createdAt": "2020-11-04T06:28:33Z", "commit": {"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNjoyODozNFrOHtKj7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNjoyODozNFrOHtKj7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEyMTAwNA==", "bodyText": "If this is visible for testing, make it private and test using the dependent method (should be easy enough).\nAlso, nit: rename it to be consistent: extractPorts", "url": "https://github.com/eclipse/jkube/pull/468#discussion_r517121004", "createdAt": "2020-11-04T06:28:34Z", "author": {"login": "manusa"}, "path": "jkube-kit/build/api/src/main/java/org/eclipse/jkube/kit/build/api/helper/DockerFileUtil.java", "diffHunk": "@@ -312,4 +317,23 @@ private static String trimSurroundingQuotes(String argStringValue) {\n         }\n         return argStringValue;\n     }\n+\n+    static List<String> getPortsFromDockerFile(File dockerFile) {\n+        Properties properties = new Properties();\n+        try {\n+            return getPortsFromDockerFileLines(extractLines(dockerFile, \"EXPOSE\", properties, null));\n+        } catch (IOException ioException) {\n+            throw new IllegalArgumentException(\"Error in reading Dockerfile\", ioException);\n+        }\n+    }\n+\n+    static List<String> getPortsFromDockerFileLines(List<String[]> dockerLinesContainingExpose) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzMDc0NDE4", "url": "https://github.com/eclipse/jkube/pull/468#pullrequestreview-523074418", "createdAt": "2020-11-04T06:35:31Z", "commit": {"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNjozNTozMVrOHtKsDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQwNjozNTozMVrOHtKsDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEyMzA4NA==", "bodyText": "Use a corner-case scenario to validate it works as expected:\n\nAdd several EXPOSE lines (top of the document, bottom, in the middle lines).\nAdd expose using all possible formats: EXPOSE 80, EXPOSE 80/http, EXPOSE 99/udp, EXPOSE 8080...\nAdd duplicate EXPOSE values", "url": "https://github.com/eclipse/jkube/pull/468#discussion_r517123084", "createdAt": "2020-11-04T06:35:31Z", "author": {"login": "manusa"}, "path": "jkube-kit/build/api/src/test/resources/docker/Dockerfile_expose_ports", "diffHunk": "@@ -0,0 +1,7 @@\n+ARG VERSION=latest\n+FROM openjdk:$VERSION\n+COPY maven/target/docker-file-simple.jar /deployments/docker-file-simple.jar\n+# Copying a file inside project root directory\n+COPY maven/static-dir-in-project-root/my-file.txt /deployments/my-file.txt\n+EXPOSE 8080", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/d0176a2d8275433d17496a02ccfa81449fb12ac4", "committedDate": "2020-11-03T07:29:02Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}, "afterCommit": {"oid": "5abe78535105dc144aa3ba72807823e036b62b73", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/5abe78535105dc144aa3ba72807823e036b62b73", "committedDate": "2020-11-04T13:33:18Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5abe78535105dc144aa3ba72807823e036b62b73", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/5abe78535105dc144aa3ba72807823e036b62b73", "committedDate": "2020-11-04T13:33:18Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}, "afterCommit": {"oid": "f654d8198b15ecca080112d97f6196db3d816761", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/f654d8198b15ecca080112d97f6196db3d816761", "committedDate": "2020-11-04T13:34:19Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a93076c810e5781c9dcc50cb4f0a953ace985e3", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/4a93076c810e5781c9dcc50cb4f0a953ace985e3", "committedDate": "2020-11-04T14:47:51Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f654d8198b15ecca080112d97f6196db3d816761", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/f654d8198b15ecca080112d97f6196db3d816761", "committedDate": "2020-11-04T13:34:19Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}, "afterCommit": {"oid": "4a93076c810e5781c9dcc50cb4f0a953ace985e3", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/4a93076c810e5781c9dcc50cb4f0a953ace985e3", "committedDate": "2020-11-04T14:47:51Z", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNTM0OTE0", "url": "https://github.com/eclipse/jkube/pull/468#pullrequestreview-523534914", "createdAt": "2020-11-04T16:34:19Z", "commit": {"oid": "4a93076c810e5781c9dcc50cb4f0a953ace985e3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 226, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}