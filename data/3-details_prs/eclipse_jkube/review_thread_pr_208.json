{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNDAyNDEw", "number": 208, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNTowOTowOVrOD-onEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDo0MTowMVrOEDY93Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MDAzNjY1OnYy", "diffSide": "RIGHT", "path": "jkube-kit/generator/api/src/main/java/org/eclipse/jkube/generator/api/support/BaseGenerator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNTowOTowOVrOGY2u1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwNDo1ODozNVrOGZKrhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODcxNTczMw==", "bodyText": "It would be good to split this statement too:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return !containsBuildConfiguration(configs) || Configs.asBoolean(getConfig(Config.add));\n          \n          \n            \n                    if (containsBuildConfiguration(configs)) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }        \n          \n          \n            \n                    return Configs.asBoolean(getConfig(Config.add));", "url": "https://github.com/eclipse/jkube/pull/208#discussion_r428715733", "createdAt": "2020-05-21T15:09:09Z", "author": {"login": "manusa"}, "path": "jkube-kit/generator/api/src/main/java/org/eclipse/jkube/generator/api/support/BaseGenerator.java", "diffHunk": "@@ -204,6 +205,9 @@ protected String getAlias() {\n     }\n \n     protected boolean shouldAddImageConfiguration(List<ImageConfiguration> configs) {\n+        if (isSimpleDockerfileMode()) {\n+            return false;\n+        }\n         return !containsBuildConfiguration(configs) || Configs.asBoolean(getConfig(Config.add));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24aa029d50f0ba9916e84ed23c6eb5926894a572"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA0MjU2Nw==", "bodyText": "Trying to figure out the logic within this statement:\n\nadd: When this set to\u00a0true, then the generator\u00a0adds\u00a0to an existing image configuration. By default this is disabled, so that a generator only kicks in when there are no other image configurations in the build, which are either configured directly for a\u00a0k8s:build\u00a0or already added by a generator which has been run previously.\n\nI think this should translate into this:\n        if (containsBuildConfiguration(configs)) {\n            return Configs.asBoolean(getConfig(Config.add));\n        }        \n        return true;\n\nWhich is more or less what was there and what you did, but the logic is more readable (IMHO)\nI would also change the method name to shouldAddGeneratedImageConfiguration", "url": "https://github.com/eclipse/jkube/pull/208#discussion_r429042567", "createdAt": "2020-05-22T04:58:35Z", "author": {"login": "manusa"}, "path": "jkube-kit/generator/api/src/main/java/org/eclipse/jkube/generator/api/support/BaseGenerator.java", "diffHunk": "@@ -204,6 +205,9 @@ protected String getAlias() {\n     }\n \n     protected boolean shouldAddImageConfiguration(List<ImageConfiguration> configs) {\n+        if (isSimpleDockerfileMode()) {\n+            return false;\n+        }\n         return !containsBuildConfiguration(configs) || Configs.asBoolean(getConfig(Config.add));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODcxNTczMw=="}, "originalCommit": {"oid": "24aa029d50f0ba9916e84ed23c6eb5926894a572"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3OTgyNzQ0OnYy", "diffSide": "LEFT", "path": "quickstarts/maven/docker-file-provided/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoxMjo0MlrOGaTWMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoxMjo0MlrOGaTWMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzMzEzOQ==", "bodyText": "I think this is related to what we discussed during the stand-up, this example highlights how the contextDir is computed from the actual Dockerfile location.\nExample expects no contextDirto be defined and also Dockerfile to be located under src/main/docker\nhttps://github.com/eclipse/jkube/tree/a32319023d658ba8a646bf63dffc08b18944ffe9/quickstarts/maven/docker-file-provided#contextdir-and-dockerfile", "url": "https://github.com/eclipse/jkube/pull/208#discussion_r430233139", "createdAt": "2020-05-26T08:12:42Z", "author": {"login": "manusa"}, "path": "quickstarts/maven/docker-file-provided/pom.xml", "diffHunk": "@@ -103,7 +103,8 @@\n                                 <image>\n                                     <name>jkube/docker-file-provided</name>\n                                     <build>\n-                                        <dockerFile>subdir/Dockerfile</dockerFile>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a32319023d658ba8a646bf63dffc08b18944ffe9"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxOTg5NTE1OnYy", "diffSide": "RIGHT", "path": "quickstarts/maven/docker-file-provided/pom.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDozODo0N1rOGgYN9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDozODo0N1rOGgYN9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYwNDQwNQ==", "bodyText": "This example showcases the use case of a docker file provided with just the contextDir configuration tag. Adding a dockerFile configuration defeats the purpose.\nExample should work just by providing this setting:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                                    <contextDir>${project.basedir}</contextDir>\n          \n          \n            \n                                                    <dockerFile>${project.basedir}/src/main/assembly-dockerfile/Dockerfile</dockerFile>\n          \n          \n            \n                                                    <contextDir>${project.basedir}/src/main/assembly-dockerfile</contextDir>", "url": "https://github.com/eclipse/jkube/pull/208#discussion_r436604405", "createdAt": "2020-06-08T10:38:47Z", "author": {"login": "manusa"}, "path": "quickstarts/maven/docker-file-provided/pom.xml", "diffHunk": "@@ -147,6 +147,7 @@\n                                     <name>jkube/context-and-assembly</name>\n                                     <build>\n                                         <contextDir>${project.basedir}</contextDir>\n+                                        <dockerFile>${project.basedir}/src/main/assembly-dockerfile/Dockerfile</dockerFile>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d97ddaf382d97d787e870984785b3a077e3539"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxOTkwMjM3OnYy", "diffSide": "RIGHT", "path": "quickstarts/maven/simple-dockerfile/Dockerfile", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDo0MTowMVrOGgYSaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDo0MTowMVrOGgYSaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYwNTU0NA==", "bodyText": "Maybe the quickstart would be clearer if we provided a COPY statement with a file that exists in the project root directory in order to showcase how the inferred contextdirectory + assembly behaves.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            COPY maven/target/zero-config-dockerfile.jar /tmp/zero-config-dockerfile.jar\n          \n          \n            \n            CMD [\"java\", \"-jar\", \"/tmp/zero-config-dockerfile.jar\"]\n          \n          \n            \n            COPY maven/target/zero-config-dockerfile.jar /tmp/zero-config-dockerfile.jar\n          \n          \n            \n            COPY maven/static-dir-in-project-root/my-file.txt /tmp/my-file.txt\n          \n          \n            \n            CMD [\"java\", \"-jar\", \"/tmp/zero-config-dockerfile.jar\"]", "url": "https://github.com/eclipse/jkube/pull/208#discussion_r436605544", "createdAt": "2020-06-08T10:41:01Z", "author": {"login": "manusa"}, "path": "quickstarts/maven/simple-dockerfile/Dockerfile", "diffHunk": "@@ -0,0 +1,17 @@\n+#\n+# Copyright (c) 2019 Red Hat, Inc.\n+# This program and the accompanying materials are made\n+# available under the terms of the Eclipse Public License 2.0\n+# which is available at:\n+#\n+#     https://www.eclipse.org/legal/epl-2.0/\n+#\n+# SPDX-License-Identifier: EPL-2.0\n+#\n+# Contributors:\n+#   Red Hat, Inc. - initial API and implementation\n+#\n+\n+FROM openjdk:latest\n+COPY maven/target/zero-config-dockerfile.jar /tmp/zero-config-dockerfile.jar\n+CMD [\"java\", \"-jar\", \"/tmp/zero-config-dockerfile.jar\"]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64d97ddaf382d97d787e870984785b3a077e3539"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1942, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}