{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyMjcwMzk0", "number": 454, "title": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub", "bodyText": "Description\n\nFix #146: ApplyMojo now uses ApplyService from JKubeServiceHub\n\nMoved applyEntities logic as static methods in ApplyService in order to make ApplyMojo slim\n\nType of change\n\n\n Bug fix (non-breaking change which fixes an issue)\n Feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to change\n Chore (non-breaking change which doesn't affect codebase;\ntest, version modification, documentation, etc.)\n\nChecklist\n\n I have read the contributing guidelines\n I signed-off my commit with a user that has signed the Eclipse Contributor Agreement\n I Added CHANGELOG entry\n I have implemented unit tests to cover my changes\n I have updated the documentation accordingly\n No new bugs, code smells, etc. in SonarCloud report\n I tested my code in Kubernetes\n I tested my code in OpenShift", "createdAt": "2020-10-29T13:20:39Z", "url": "https://github.com/eclipse/jkube/pull/454", "merged": true, "mergeCommit": {"oid": "104a4d9795eb1c4b8290723a23311328cc619ce4"}, "closed": true, "closedAt": "2021-01-11T18:33:58Z", "author": {"login": "rohanKanojia"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXUUb7gBqjM5MzcxMTQwODA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdvCYB8ABqjQxODk1MDM0NTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a4f6c08a0458b2373baeae19628103bf525a5a5", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/0a4f6c08a0458b2373baeae19628103bf525a5a5", "committedDate": "2020-10-29T13:18:07Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "8543c817ba402303d43981536cc7f68b84f1e1de", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/8543c817ba402303d43981536cc7f68b84f1e1de", "committedDate": "2020-10-29T15:51:59Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8543c817ba402303d43981536cc7f68b84f1e1de", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/8543c817ba402303d43981536cc7f68b84f1e1de", "committedDate": "2020-10-29T15:51:59Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "bd749e7d80c16d808d7c77827f0e8b9ec2f471aa", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/bd749e7d80c16d808d7c77827f0e8b9ec2f471aa", "committedDate": "2020-10-29T17:46:39Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bd749e7d80c16d808d7c77827f0e8b9ec2f471aa", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/bd749e7d80c16d808d7c77827f0e8b9ec2f471aa", "committedDate": "2020-10-29T17:46:39Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "922671c064002ae589c5b699b14502e89120d3d2", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/922671c064002ae589c5b699b14502e89120d3d2", "committedDate": "2020-10-30T06:12:07Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "922671c064002ae589c5b699b14502e89120d3d2", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/922671c064002ae589c5b699b14502e89120d3d2", "committedDate": "2020-10-30T06:12:07Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73", "committedDate": "2020-11-02T13:28:32Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMzYyNzIx", "url": "https://github.com/eclipse/jkube/pull/454#pullrequestreview-531362721", "createdAt": "2020-11-16T14:20:45Z", "commit": {"oid": "2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoyMDo0NlrOH0A0_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoyMDo0NlrOH0A0_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDMwMTU2NA==", "bodyText": "Why would this be exposed?", "url": "https://github.com/eclipse/jkube/pull/454#discussion_r524301564", "createdAt": "2020-11-16T14:20:46Z", "author": {"login": "manusa"}, "path": "jkube-kit/config/service/src/main/java/org/eclipse/jkube/kit/config/service/ApplyService.java", "diffHunk": "@@ -307,6 +311,10 @@ public OpenShiftClient getOpenShiftClient() {\n         return OpenshiftHelper.asOpenShiftClient(kubernetesClient);\n     }\n \n+    public KubernetesClient getKubernetesClient() {\n+        return kubernetesClient;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMzYzNTU4", "url": "https://github.com/eclipse/jkube/pull/454#pullrequestreview-531363558", "createdAt": "2020-11-16T14:21:40Z", "commit": {"oid": "2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoyMTo0MFrOH0A3eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoyMTo0MFrOH0A3eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDMwMjIwMg==", "bodyText": "This has no sense.\nYou have a private static method where you provide an instance of the containing class? Just remove the static modifier then.", "url": "https://github.com/eclipse/jkube/pull/454#discussion_r524302202", "createdAt": "2020-11-16T14:21:40Z", "author": {"login": "manusa"}, "path": "jkube-kit/config/service/src/main/java/org/eclipse/jkube/kit/config/service/ApplyService.java", "diffHunk": "@@ -1390,4 +1398,55 @@ public void processCustomEntities(List<String> customResourceDefinitions, File r\n             }\n         }\n     }\n+\n+    public static void applyNamespaceOrProjectIfPresent(ApplyService applyService, Collection<HasMetadata> entities) {\n+        List<HasMetadata> projectOrNamespaceList = entities.stream()\n+                .filter(e -> e instanceof Namespace || e instanceof Project)\n+                .collect(Collectors.toList());\n+\n+        for (HasMetadata projectOrNamespace : projectOrNamespaceList) {\n+            if (projectOrNamespace instanceof Namespace) {\n+                Namespace ns = (Namespace) projectOrNamespace;\n+                applyService.applyNamespace(ns);\n+            } else if (projectOrNamespace instanceof Project) {\n+                Project project = (Project) projectOrNamespace;\n+                applyService.applyProject(project);\n+            }\n+        }\n+    }\n+\n+    public static void applyEntities(ApplyService applyService, String fileName, Set<HasMetadata> entities, KitLogger serviceLogger,\n+                                 long serviceUrlWaitTimeSeconds, ResourceConfig resources, File resourceDir,\n+                                 String environment) throws Exception {\n+        // Apply all items\n+        applyStandardEntities(applyService, fileName, entities);\n+        logExposeServiceUrl(applyService, entities, serviceLogger, serviceUrlWaitTimeSeconds);\n+        applyService.processCustomEntities(resources != null ? resources.getCustomResourceDefinitions() : null,\n+                resourceDir, environment, resources != null ? resources.getRemotes() : null);\n+    }\n+\n+    private static void logExposeServiceUrl(ApplyService applyService, Set<HasMetadata> entities, KitLogger serviceLogger, long serviceUrlWaitTimeSeconds) throws InterruptedException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73"}, "originalPosition": 65}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxMzY1MTQ1", "url": "https://github.com/eclipse/jkube/pull/454#pullrequestreview-531365145", "createdAt": "2020-11-16T14:23:22Z", "commit": {"oid": "2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoyMzoyMlrOH0A8PA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNDoyMzoyMlrOH0A8PA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDMwMzQyMA==", "bodyText": "Take this comment and apply it here https://github.com/eclipse/jkube/pull/454/files#r524302202\nIf you pass an instance of the enclosing class, then it really makes no sense to make this method static", "url": "https://github.com/eclipse/jkube/pull/454#discussion_r524303420", "createdAt": "2020-11-16T14:23:22Z", "author": {"login": "manusa"}, "path": "jkube-kit/config/service/src/main/java/org/eclipse/jkube/kit/config/service/ApplyService.java", "diffHunk": "@@ -1390,4 +1398,55 @@ public void processCustomEntities(List<String> customResourceDefinitions, File r\n             }\n         }\n     }\n+\n+    public static void applyNamespaceOrProjectIfPresent(ApplyService applyService, Collection<HasMetadata> entities) {\n+        List<HasMetadata> projectOrNamespaceList = entities.stream()\n+                .filter(e -> e instanceof Namespace || e instanceof Project)\n+                .collect(Collectors.toList());\n+\n+        for (HasMetadata projectOrNamespace : projectOrNamespaceList) {\n+            if (projectOrNamespace instanceof Namespace) {\n+                Namespace ns = (Namespace) projectOrNamespace;\n+                applyService.applyNamespace(ns);\n+            } else if (projectOrNamespace instanceof Project) {\n+                Project project = (Project) projectOrNamespace;\n+                applyService.applyProject(project);\n+            }\n+        }\n+    }\n+\n+    public static void applyEntities(ApplyService applyService, String fileName, Set<HasMetadata> entities, KitLogger serviceLogger,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73"}, "originalPosition": 55}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/2b45ed2b1cdb1828fe2c51a0c95f5c1767933b73", "committedDate": "2020-11-02T13:28:32Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "58779130c8b0c2c2767f0b7f11705881830351d9", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/58779130c8b0c2c2767f0b7f11705881830351d9", "committedDate": "2020-11-16T17:09:53Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "58779130c8b0c2c2767f0b7f11705881830351d9", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/58779130c8b0c2c2767f0b7f11705881830351d9", "committedDate": "2020-11-16T17:09:53Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "8dd2f6402f50606051a7f3db6e7666a9a1260857", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/8dd2f6402f50606051a7f3db6e7666a9a1260857", "committedDate": "2020-11-16T19:03:02Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8dd2f6402f50606051a7f3db6e7666a9a1260857", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/8dd2f6402f50606051a7f3db6e7666a9a1260857", "committedDate": "2020-11-16T19:03:02Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "b52e92851cb890b68f0829bfc891241aa2af37fb", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/b52e92851cb890b68f0829bfc891241aa2af37fb", "committedDate": "2020-11-16T19:11:08Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyMjY0Mjgx", "url": "https://github.com/eclipse/jkube/pull/454#pullrequestreview-532264281", "createdAt": "2020-11-17T11:22:29Z", "commit": {"oid": "b52e92851cb890b68f0829bfc891241aa2af37fb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMToyMjoyOVrOH0wTjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxMToyMjoyOVrOH0wTjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA3OTQzNg==", "bodyText": "Same as the others. Static method which accepts an instance of the enclosing class.\n\n\nRemove static modifier and ApplyService instance parameter", "url": "https://github.com/eclipse/jkube/pull/454#discussion_r525079436", "createdAt": "2020-11-17T11:22:29Z", "author": {"login": "manusa"}, "path": "jkube-kit/config/service/src/main/java/org/eclipse/jkube/kit/config/service/ApplyService.java", "diffHunk": "@@ -1390,4 +1394,55 @@ public void processCustomEntities(List<String> customResourceDefinitions, File r\n             }\n         }\n     }\n+\n+    public static void applyNamespaceOrProjectIfPresent(ApplyService applyService, Collection<HasMetadata> entities) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b52e92851cb890b68f0829bfc891241aa2af37fb"}, "originalPosition": 694}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b52e92851cb890b68f0829bfc891241aa2af37fb", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/b52e92851cb890b68f0829bfc891241aa2af37fb", "committedDate": "2020-11-16T19:11:08Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "07b6a8f70788a2f5ffc1b4fe6bbf709bf94a8c0f", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/07b6a8f70788a2f5ffc1b4fe6bbf709bf94a8c0f", "committedDate": "2020-11-17T13:24:34Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "07b6a8f70788a2f5ffc1b4fe6bbf709bf94a8c0f", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/07b6a8f70788a2f5ffc1b4fe6bbf709bf94a8c0f", "committedDate": "2020-11-17T13:24:34Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "894d273f84ae028edb894f9a4bff6bb3d2cd8e9f", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/894d273f84ae028edb894f9a4bff6bb3d2cd8e9f", "committedDate": "2020-12-01T07:33:51Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODg3MzE3", "url": "https://github.com/eclipse/jkube/pull/454#pullrequestreview-543887317", "createdAt": "2020-12-03T12:06:41Z", "commit": {"oid": "894d273f84ae028edb894f9a4bff6bb3d2cd8e9f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjowNjo0MlrOH-YKIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjowNjo0MlrOH-YKIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE2OTU3MA==", "bodyText": "why not do a forEach here.\nYou are generating a list of HasMetadata, and then re-iterating over that list.", "url": "https://github.com/eclipse/jkube/pull/454#discussion_r535169570", "createdAt": "2020-12-03T12:06:42Z", "author": {"login": "manusa"}, "path": "jkube-kit/config/service/src/main/java/org/eclipse/jkube/kit/config/service/ApplyService.java", "diffHunk": "@@ -1390,4 +1394,55 @@ public void processCustomEntities(List<String> customResourceDefinitions, File r\n             }\n         }\n     }\n+\n+    public void applyNamespaceOrProjectIfPresent(Collection<HasMetadata> entities) {\n+        List<HasMetadata> projectOrNamespaceList = entities.stream()\n+                .filter(e -> e instanceof Namespace || e instanceof Project)\n+                .collect(Collectors.toList());\n+\n+        for (HasMetadata projectOrNamespace : projectOrNamespaceList) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "894d273f84ae028edb894f9a4bff6bb3d2cd8e9f"}, "originalPosition": 699}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODk0Nzg0", "url": "https://github.com/eclipse/jkube/pull/454#pullrequestreview-543894784", "createdAt": "2020-12-03T12:16:40Z", "commit": {"oid": "894d273f84ae028edb894f9a4bff6bb3d2cd8e9f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjoxNjo0MFrOH-YxqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMjoxNjo0MFrOH-YxqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE3OTY4OA==", "bodyText": "This is weird and unclear.\nCould you explain what's going on?\nWe retrieve the namespace, but the namespace is only set/configured later on in the method.\nIn addition, the invocation in line 188 (applyService.applyNamespaceOrProjectIfPresent) suggests we are already doing something here, but we only configure the namespace later on.\nThere's also a call configureApplyService in line 181. It feels that the namespace part should be really configured there.\nMy understanding is that if the namespace is configured later, is because it has something to do with the processing and it affects the end result.\nIf this is the case setNamespace should be completely removed and shifted to an argument of any method that performs processing.", "url": "https://github.com/eclipse/jkube/pull/454#discussion_r535179688", "createdAt": "2020-12-03T12:16:40Z", "author": {"login": "manusa"}, "path": "kubernetes-maven-plugin/plugin/src/main/java/org/eclipse/jkube/maven/plugin/mojo/build/ApplyMojo.java", "diffHunk": "@@ -186,55 +178,18 @@ public void executeInternal() throws MojoExecutionException {\n             KubernetesResourceUtil.validateKubernetesMasterUrl(masterUrl);\n             log.info(\"Using %s at %s in namespace %s with manifest %s \", clusterKind, masterUrl, clusterAccess.getNamespace(), manifest);\n \n-            applyService.setAllowCreate(createNewResources);\n-            applyService.setServicesOnlyMode(servicesOnly);\n-            applyService.setIgnoreServiceMode(ignoreServices);\n-            applyService.setLogJsonDir(jsonLogDir);\n-            applyService.setBasedir(getRootProjectFolder());\n-            applyService.setIgnoreRunningOAuthClients(ignoreRunningOAuthClients);\n-            applyService.setProcessTemplatesLocally(processTemplatesLocally);\n-            applyService.setDeletePodsOnReplicationControllerUpdate(deletePodsOnReplicationControllerUpdate);\n-            applyService.setRollingUpgrade(rollingUpgrades);\n-            applyService.setRollingUpgradePreserveScale(isRollingUpgradePreserveScale());\n-            applyService.setRecreateMode(recreate);\n-\n-            boolean openShift = OpenshiftHelper.isOpenShift(kubernetes);\n-            if (openShift) {\n-                log.info(\"[[B]]OpenShift[[B]] platform detected\");\n-            } else {\n-                disableOpenShiftFeatures(applyService);\n-            }\n+            configureApplyService(kubernetes);\n \n             Set<HasMetadata> entities = KubernetesResourceUtil.loadResources(manifest);\n-\n+            // Configure Namespace: Check if new namespace needs to be created and create if\n+            // it's provided in manifests first. Then use that namespace for applying rest of\n+            // the manifests\n             String namespace = clusterAccess.getNamespace();\n-            boolean namespaceEntityExist = false;\n-\n-            for (HasMetadata entity: entities) {\n-                if (entity instanceof Namespace) {\n-                    Namespace ns = (Namespace)entity;\n-                    namespace = ns.getMetadata().getName();\n-                    applyService.applyNamespace((ns));\n-                    namespaceEntityExist = true;\n-                    entities.remove(entity);\n-                    break;\n-                }\n-                if (entity instanceof Project) {\n-                    Project project = (Project)entity;\n-                    namespace = project.getMetadata().getName();\n-                    applyService.applyProject(project);\n-                    namespaceEntityExist = true;\n-                    entities.remove(entity);\n-                    break;\n-                }\n-            }\n-\n-            if (!namespaceEntityExist) {\n-                applyService.applyNamespace(namespace);\n-            }\n-\n+            applyService.applyNamespaceOrProjectIfPresent(entities);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "894d273f84ae028edb894f9a4bff6bb3d2cd8e9f"}, "originalPosition": 93}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "894d273f84ae028edb894f9a4bff6bb3d2cd8e9f", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/894d273f84ae028edb894f9a4bff6bb3d2cd8e9f", "committedDate": "2020-12-01T07:33:51Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "e473b3a90497ebf1ff32d487466289052edda1c3", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/e473b3a90497ebf1ff32d487466289052edda1c3", "committedDate": "2020-12-03T14:12:01Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e473b3a90497ebf1ff32d487466289052edda1c3", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/e473b3a90497ebf1ff32d487466289052edda1c3", "committedDate": "2020-12-03T14:12:01Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}, "afterCommit": {"oid": "9a2c48a8edc995705d7bb63cd994e38547483871", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/9a2c48a8edc995705d7bb63cd994e38547483871", "committedDate": "2020-12-03T14:33:44Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MDIwNDg3", "url": "https://github.com/eclipse/jkube/pull/454#pullrequestreview-544020487", "createdAt": "2020-12-03T14:40:33Z", "commit": {"oid": "9a2c48a8edc995705d7bb63cd994e38547483871"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNDo0MDozM1rOH-fNpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNDo0MDozM1rOH-fNpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI4NTE1OA==", "bodyText": "Sorry, but I'm still unsure why this method is not part of applyService#applyEntities logic.\nWhy do we have to call it separately?\nIs it something that applies specifically to Maven projects, or is this something we want for the Kit API?", "url": "https://github.com/eclipse/jkube/pull/454#discussion_r535285158", "createdAt": "2020-12-03T14:40:33Z", "author": {"login": "manusa"}, "path": "kubernetes-maven-plugin/plugin/src/main/java/org/eclipse/jkube/maven/plugin/mojo/build/ApplyMojo.java", "diffHunk": "@@ -184,58 +176,15 @@ public void executeInternal() throws MojoExecutionException {\n                 clusterKind = \"OpenShift\";\n             }\n             KubernetesResourceUtil.validateKubernetesMasterUrl(masterUrl);\n-            log.info(\"Using %s at %s in namespace %s with manifest %s \", clusterKind, masterUrl, clusterAccess.getNamespace(), manifest);\n-\n-            applyService.setAllowCreate(createNewResources);\n-            applyService.setServicesOnlyMode(servicesOnly);\n-            applyService.setIgnoreServiceMode(ignoreServices);\n-            applyService.setLogJsonDir(jsonLogDir);\n-            applyService.setBasedir(getRootProjectFolder());\n-            applyService.setIgnoreRunningOAuthClients(ignoreRunningOAuthClients);\n-            applyService.setProcessTemplatesLocally(processTemplatesLocally);\n-            applyService.setDeletePodsOnReplicationControllerUpdate(deletePodsOnReplicationControllerUpdate);\n-            applyService.setRollingUpgrade(rollingUpgrades);\n-            applyService.setRollingUpgradePreserveScale(isRollingUpgradePreserveScale());\n-            applyService.setRecreateMode(recreate);\n-\n-            boolean openShift = OpenshiftHelper.isOpenShift(kubernetes);\n-            if (openShift) {\n-                log.info(\"[[B]]OpenShift[[B]] platform detected\");\n-            } else {\n-                disableOpenShiftFeatures(applyService);\n-            }\n-\n             Set<HasMetadata> entities = KubernetesResourceUtil.loadResources(manifest);\n+            log.info(\"Using %s at %s in namespace %s with manifest %s \", clusterKind, masterUrl, clusterAccess.getNamespace(), manifest);\n \n-            String namespace = clusterAccess.getNamespace();\n-            boolean namespaceEntityExist = false;\n-\n-            for (HasMetadata entity: entities) {\n-                if (entity instanceof Namespace) {\n-                    Namespace ns = (Namespace)entity;\n-                    namespace = ns.getMetadata().getName();\n-                    applyService.applyNamespace((ns));\n-                    namespaceEntityExist = true;\n-                    entities.remove(entity);\n-                    break;\n-                }\n-                if (entity instanceof Project) {\n-                    Project project = (Project)entity;\n-                    namespace = project.getMetadata().getName();\n-                    applyService.applyProject(project);\n-                    namespaceEntityExist = true;\n-                    entities.remove(entity);\n-                    break;\n-                }\n-            }\n-\n-            if (!namespaceEntityExist) {\n-                applyService.applyNamespace(namespace);\n-            }\n+            configureApplyService(kubernetes, entities);\n \n-            applyService.setNamespace(namespace);\n+            applyService.applyNamespaceOrProjectIfPresent(entities);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9a2c48a8edc995705d7bb63cd994e38547483871"}, "originalPosition": 103}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6fe5917c5c02c9d8720f83115322c0d15da2df3", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/d6fe5917c5c02c9d8720f83115322c0d15da2df3", "committedDate": "2020-12-03T14:56:37Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}, "afterCommit": {"oid": "3d66dd14f46d4878b1baccb7f89f598a93bb468c", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/3d66dd14f46d4878b1baccb7f89f598a93bb468c", "committedDate": "2020-12-04T13:17:27Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0OTYxNjE1", "url": "https://github.com/eclipse/jkube/pull/454#pullrequestreview-544961615", "createdAt": "2020-12-04T13:33:59Z", "commit": {"oid": "3d66dd14f46d4878b1baccb7f89f598a93bb468c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d66dd14f46d4878b1baccb7f89f598a93bb468c", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/3d66dd14f46d4878b1baccb7f89f598a93bb468c", "committedDate": "2020-12-04T13:17:27Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}, "afterCommit": {"oid": "4597143888d7df3ed86111229436b12391d7625c", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/4597143888d7df3ed86111229436b12391d7625c", "committedDate": "2020-12-08T07:56:42Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4597143888d7df3ed86111229436b12391d7625c", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/4597143888d7df3ed86111229436b12391d7625c", "committedDate": "2020-12-08T07:56:42Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}, "afterCommit": {"oid": "f0cfa9d8652f2d4b67a4ec1b8a3bb9bd9771c94e", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/f0cfa9d8652f2d4b67a4ec1b8a3bb9bd9771c94e", "committedDate": "2020-12-23T19:05:23Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b947e5db3608e04a59ce0784a72245acda1f4cda", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/b947e5db3608e04a59ce0784a72245acda1f4cda", "committedDate": "2021-01-11T07:38:59Z", "message": "Fix #146: ApplyMojo should use ApplyService in JKubeServiceHub"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b9cb15a1f64dcbbe36942347188f3b4ba202f90", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/2b9cb15a1f64dcbbe36942347188f3b4ba202f90", "committedDate": "2021-01-11T07:39:00Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f0cfa9d8652f2d4b67a4ec1b8a3bb9bd9771c94e", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/f0cfa9d8652f2d4b67a4ec1b8a3bb9bd9771c94e", "committedDate": "2020-12-23T19:05:23Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}, "afterCommit": {"oid": "2b9cb15a1f64dcbbe36942347188f3b4ba202f90", "author": {"user": {"login": "rohanKanojia", "name": "Rohan Kumar "}}, "url": "https://github.com/eclipse/jkube/commit/2b9cb15a1f64dcbbe36942347188f3b4ba202f90", "committedDate": "2021-01-11T07:39:00Z", "message": "Move applyNamespaceOrProjectIfPresent to ApplyService"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 260, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}