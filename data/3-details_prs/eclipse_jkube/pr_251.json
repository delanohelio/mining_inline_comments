{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2NDg2MjY5", "number": 251, "title": "unit test for sprintbootutil added", "bodyText": "Description\n\nFixes #207\nType of change\n\n\n Bug fix (non-breaking change which fixes an issue)\n Feature (non-breaking change which adds functionality)\n Breaking change (fix or feature that would cause existing functionality to change)\n\nChecklist\n\n I have read the contributing guidelines\n I signed-off my commit with a user that has signed the Eclipse Contributor Agreement\n I Added CHANGELOG entry\n I have implemented unit tests to cover my changes\n I have updated the documentation accordingly\n No new bugs, code smells, etc. in SonarCloud report\n I tested my code in Kubernetes\n I tested my code in OpenShift", "createdAt": "2020-06-18T13:48:54Z", "url": "https://github.com/eclipse/jkube/pull/251", "merged": true, "mergeCommit": {"oid": "c6298f06a4f2fdaab176dd1a23fbdbf0359191dd"}, "closed": true, "closedAt": "2020-06-23T07:22:12Z", "author": {"login": "anandrkskd"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcse-OUAFqTQzMzMxNjUwMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuAOEfAFqTQzNTUwNzIyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMzE2NTAz", "url": "https://github.com/eclipse/jkube/pull/251#pullrequestreview-433316503", "createdAt": "2020-06-18T14:03:51Z", "commit": {"oid": "e1a5d4b891d6a7330fed56daff0bd59330a69172"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNDowMzo1MVrOGlw3xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNDowMzo1MVrOGlw3xA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI1MTIwNA==", "bodyText": "Please add license headers with mvn -N license:format", "url": "https://github.com/eclipse/jkube/pull/251#discussion_r442251204", "createdAt": "2020-06-18T14:03:51Z", "author": {"login": "rohanKanojia"}, "path": "jkube-kit/common/src/test/java/org/eclipse/jkube/kit/common/util/SpringBootUtilTest.java", "diffHunk": "@@ -0,0 +1,114 @@\n+package org.eclipse.jkube.kit.common.util;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1a5d4b891d6a7330fed56daff0bd59330a69172"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzMzE4MTY0", "url": "https://github.com/eclipse/jkube/pull/251#pullrequestreview-433318164", "createdAt": "2020-06-18T14:05:30Z", "commit": {"oid": "e1a5d4b891d6a7330fed56daff0bd59330a69172"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNDowNTozMFrOGlw84Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNDowNTozMFrOGlw84Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI1MjUxMw==", "bodyText": "I think it would be better if you use builders provided by Lombok", "url": "https://github.com/eclipse/jkube/pull/251#discussion_r442252513", "createdAt": "2020-06-18T14:05:30Z", "author": {"login": "rohanKanojia"}, "path": "jkube-kit/common/src/test/java/org/eclipse/jkube/kit/common/util/SpringBootUtilTest.java", "diffHunk": "@@ -0,0 +1,114 @@\n+package org.eclipse.jkube.kit.common.util;\n+\n+import mockit.Expectations;\n+import mockit.Mocked;\n+import org.apache.commons.io.FileUtils;\n+import org.eclipse.jkube.kit.common.Dependency;\n+import org.eclipse.jkube.kit.common.JavaProject;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.net.URLClassLoader;\n+import java.util.Arrays;\n+import java.util.Optional;\n+import java.util.Properties;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+public class SpringBootUtilTest {\n+    @Rule\n+    public TemporaryFolder temporaryFolder = new TemporaryFolder();\n+\n+    @Test\n+    public void testGetSpringBootApplicationProperties() throws IOException {\n+\n+        //Given\n+        File applicationProp =  new File(getClass().getResource(\"/application.properties\").getPath());\n+        String springActiveProfile = null;\n+        File targetFolder = temporaryFolder.newFolder(\"target\");\n+        File classesInTarget = new File(targetFolder, \"classes\");\n+        boolean isTargetClassesCreated = classesInTarget.mkdirs();\n+        File applicationPropertiesInsideTarget = new File(classesInTarget, \"application.properties\");\n+        FileUtils.copyFile(applicationProp, applicationPropertiesInsideTarget);\n+        URLClassLoader urlClassLoader = ClassUtil.createClassLoader(Arrays.asList(classesInTarget.getAbsolutePath(), applicationProp.getAbsolutePath()), classesInTarget.getAbsolutePath());\n+\n+        //When\n+        Properties result =  SpringBootUtil.getSpringBootApplicationProperties(springActiveProfile ,urlClassLoader);\n+\n+        //Then\n+        assertTrue(isTargetClassesCreated);\n+        assertEquals(\"demoservice\" ,result.getProperty(\"spring.application.name\"));\n+        assertEquals(\"9090\" ,result.getProperty(\"server.port\"));\n+    }\n+\n+    @Test\n+    public void testGetSpringBootDevToolsVersion(@Mocked JavaProject maven_project) {\n+\n+        //Given\n+        Dependency p = new Dependency();\n+        p.setGroupId(\"org.springframework.boot\");\n+        p.setVersion(\"1.6.3\");\n+        new Expectations() {{\n+            maven_project.getDependencies();\n+            result=p;\n+        }};\n+\n+        //when\n+        Optional<String> result = SpringBootUtil.getSpringBootDevToolsVersion(maven_project);\n+\n+        //Then\n+        assertEquals(\"1.6.3\",result.get());\n+\n+    }\n+\n+\n+    @Test\n+    public void testGetSpringBootVersion(@Mocked JavaProject maven_project) {\n+\n+        //Given\n+        Dependency p = new Dependency();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1a5d4b891d6a7330fed56daff0bd59330a69172"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzODA4ODcw", "url": "https://github.com/eclipse/jkube/pull/251#pullrequestreview-433808870", "createdAt": "2020-06-19T05:21:39Z", "commit": {"oid": "e1a5d4b891d6a7330fed56daff0bd59330a69172"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwNToyMTozOVrOGmIX7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwNToyMTozOVrOGmIX7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjYzNjI3MQ==", "bodyText": "maybe move this file to src/test/resources/util/spring-boot-application.properties so that it remains in the context of the test-suite (we'll probably have more)", "url": "https://github.com/eclipse/jkube/pull/251#discussion_r442636271", "createdAt": "2020-06-19T05:21:39Z", "author": {"login": "manusa"}, "path": "jkube-kit/common/src/test/resources/application.properties", "diffHunk": "@@ -0,0 +1,2 @@\n+spring.application.name:demoservice", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1a5d4b891d6a7330fed56daff0bd59330a69172"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e1a5d4b891d6a7330fed56daff0bd59330a69172", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/e1a5d4b891d6a7330fed56daff0bd59330a69172", "committedDate": "2020-06-18T13:21:12Z", "message": "unit test for sprintbootutil added\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}, "afterCommit": {"oid": "0c70de02c6603c8dc0c287d21f0b209dc04b427b", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/0c70de02c6603c8dc0c287d21f0b209dc04b427b", "committedDate": "2020-06-22T05:14:33Z", "message": "Unit test added for SpringBootUtil\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NjMyMzk1", "url": "https://github.com/eclipse/jkube/pull/251#pullrequestreview-434632395", "createdAt": "2020-06-22T06:24:49Z", "commit": {"oid": "0c70de02c6603c8dc0c287d21f0b209dc04b427b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNjoyNDo0OVrOGmzTtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwNjoyNDo0OVrOGmzTtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMzOTcwMQ==", "bodyText": "I don't understand how this can be working, getDependencies() method returns a List, your mock returns an instance of Dependency.", "url": "https://github.com/eclipse/jkube/pull/251#discussion_r443339701", "createdAt": "2020-06-22T06:24:49Z", "author": {"login": "manusa"}, "path": "jkube-kit/common/src/test/java/org/eclipse/jkube/kit/common/util/SpringBootUtilTest.java", "diffHunk": "@@ -0,0 +1,125 @@\n+/**\n+ * Copyright (c) 2019 Red Hat, Inc.\n+ * This program and the accompanying materials are made\n+ * available under the terms of the Eclipse Public License 2.0\n+ * which is available at:\n+ *\n+ *     https://www.eclipse.org/legal/epl-2.0/\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Contributors:\n+ *   Red Hat, Inc. - initial API and implementation\n+ */\n+package org.eclipse.jkube.kit.common.util;\n+\n+import mockit.Expectations;\n+import mockit.Mocked;\n+import org.apache.commons.io.FileUtils;\n+import org.eclipse.jkube.kit.common.Dependency;\n+import org.eclipse.jkube.kit.common.JavaProject;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.net.URLClassLoader;\n+import java.util.Arrays;\n+import java.util.Optional;\n+import java.util.Properties;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+public class SpringBootUtilTest {\n+    @Rule\n+    public TemporaryFolder temporaryFolder = new TemporaryFolder();\n+\n+    @Test\n+    public void testGetSpringBootApplicationProperties() throws IOException {\n+\n+        //Given\n+        File applicationProp =  new File(getClass().getResource(\"/util/spring-boot-application.properties\").getPath());\n+        String springActiveProfile = null;\n+        File targetFolder = temporaryFolder.newFolder(\"target\");\n+        File classesInTarget = new File(targetFolder, \"classes\");\n+        boolean isTargetClassesCreated = classesInTarget.mkdirs();\n+        File applicationPropertiesInsideTarget = new File(classesInTarget, \"application.properties\");\n+        FileUtils.copyFile(applicationProp, applicationPropertiesInsideTarget);\n+        URLClassLoader urlClassLoader = ClassUtil.createClassLoader(Arrays.asList(classesInTarget.getAbsolutePath(), applicationProp.getAbsolutePath()), classesInTarget.getAbsolutePath());\n+\n+        //When\n+        Properties result =  SpringBootUtil.getSpringBootApplicationProperties(springActiveProfile ,urlClassLoader);\n+\n+        //Then\n+        assertTrue(isTargetClassesCreated);\n+        assertEquals(\"demoservice\" ,result.getProperty(\"spring.application.name\"));\n+        assertEquals(\"9090\" ,result.getProperty(\"server.port\"));\n+    }\n+\n+    @Test\n+    public void testGetSpringBootDevToolsVersion(@Mocked JavaProject maven_project) {\n+\n+        //Given\n+        Dependency p = new Dependency();\n+        p.setGroupId(\"org.springframework.boot\");\n+        p.setVersion(\"1.6.3\");\n+        new Expectations() {{\n+            maven_project.getDependencies();\n+            result=p;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c70de02c6603c8dc0c287d21f0b209dc04b427b"}, "originalPosition": 71}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0c70de02c6603c8dc0c287d21f0b209dc04b427b", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/0c70de02c6603c8dc0c287d21f0b209dc04b427b", "committedDate": "2020-06-22T05:14:33Z", "message": "Unit test added for SpringBootUtil\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}, "afterCommit": {"oid": "33402add3515d1f5e61ec3cc6e6f56be10ff0f75", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/33402add3515d1f5e61ec3cc6e6f56be10ff0f75", "committedDate": "2020-06-22T07:18:24Z", "message": "Unit test added for SpringBootUtil\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "33402add3515d1f5e61ec3cc6e6f56be10ff0f75", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/33402add3515d1f5e61ec3cc6e6f56be10ff0f75", "committedDate": "2020-06-22T07:18:24Z", "message": "Unit test added for SpringBootUtil\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}, "afterCommit": {"oid": "78ce1e4ea3d2ce52ba54107973ee0eb290e44a1d", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/78ce1e4ea3d2ce52ba54107973ee0eb290e44a1d", "committedDate": "2020-06-22T18:28:13Z", "message": "Unit test added for SpringBootUtil\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac14ab3933c8e79a45eb9ca9446f57f94ecabfd4", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/ac14ab3933c8e79a45eb9ca9446f57f94ecabfd4", "committedDate": "2020-06-23T05:38:49Z", "message": "UT added for springbootutil\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "78ce1e4ea3d2ce52ba54107973ee0eb290e44a1d", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/78ce1e4ea3d2ce52ba54107973ee0eb290e44a1d", "committedDate": "2020-06-22T18:28:13Z", "message": "Unit test added for SpringBootUtil\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}, "afterCommit": {"oid": "ac14ab3933c8e79a45eb9ca9446f57f94ecabfd4", "author": {"user": {"login": "anandrkskd", "name": "Anand Kumar Singh"}}, "url": "https://github.com/eclipse/jkube/commit/ac14ab3933c8e79a45eb9ca9446f57f94ecabfd4", "committedDate": "2020-06-23T05:38:49Z", "message": "UT added for springbootutil\n\nSigned-off-by: anandrkskd <anandrkskd@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1NDc4MDU0", "url": "https://github.com/eclipse/jkube/pull/251#pullrequestreview-435478054", "createdAt": "2020-06-23T06:32:08Z", "commit": {"oid": "ac14ab3933c8e79a45eb9ca9446f57f94ecabfd4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1NTA3MjI3", "url": "https://github.com/eclipse/jkube/pull/251#pullrequestreview-435507227", "createdAt": "2020-06-23T07:21:58Z", "commit": {"oid": "ac14ab3933c8e79a45eb9ca9446f57f94ecabfd4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 278, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}