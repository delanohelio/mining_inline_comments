{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3ODM3Nzg2", "number": 1949, "title": "Test published dependencies", "bodyText": "Has been tested to fail when the leaking internal dependency change fixed in #1911 was added back.", "createdAt": "2020-10-05T13:02:18Z", "url": "https://github.com/DataDog/dd-trace-java/pull/1949", "merged": true, "mergeCommit": {"oid": "cfb66ee3874f2c570cc5e274e0b49b83ca85f0b9"}, "closed": true, "closedAt": "2020-10-06T10:56:31Z", "author": {"login": "bantonsson"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPkFBZABqjM4NDA1NTI3MDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdP6PCUgFqTUwMzEwMDU5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8fe382dc205fec4bec237a752bfa498246944539", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/8fe382dc205fec4bec237a752bfa498246944539", "committedDate": "2020-10-05T13:27:34Z", "message": "Test that it fails"}, "afterCommit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/ad8ddfedb70218b93a3d8039c90380b659ab2c2f", "committedDate": "2020-10-05T13:01:02Z", "message": "Test published dependencies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMDc0NDAy", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#pullrequestreview-502074402", "createdAt": "2020-10-05T13:48:23Z", "commit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMDk1Njcx", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#pullrequestreview-502095671", "createdAt": "2020-10-05T14:10:06Z", "commit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNDoxMDowN1rOHce1aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNDoyMDoxNlrOHcfRMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYyNzM3MQ==", "bodyText": "This shouldn't actually be published...", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#discussion_r499627371", "createdAt": "2020-10-05T14:10:07Z", "author": {"login": "tylerbenson"}, "path": "test-published-dependencies/build.gradle", "diffHunk": "@@ -0,0 +1,62 @@\n+plugins {\n+\tid 'java'\n+\tid 'application'\n+\n+\tid 'com.diffplug.gradle.spotless' version '4.3.0'\n+\tid 'pl.allegro.tech.build.axion-release' version '1.10.3'\n+}\n+\n+repositories {\n+\tmavenLocal()\n+\tjcenter()\n+\tmavenCentral()\n+}\n+\n+spotless {\n+\tjava {\n+\t\tgoogleJavaFormat()\n+\t}\n+\tgroovyGradle {\n+\t\ttarget '*.gradle'\n+\t\tgreclipse()\n+\t}\n+\tformat 'misc', {\n+\t\ttarget '.gitignore'\n+\t\tindentWithSpaces(2)\n+\t\ttrimTrailingWhitespace()\n+\t\tendWithNewline()\n+\t}\n+}\n+task formatCode(dependsOn: ['spotlessApply'])\n+\n+scmVersion {\n+\ttag {\n+\t\tprefix = 'v'\n+\t\tversionSeparator = ''\n+\t}\n+\n+\tversionIncrementer 'incrementMinor'\n+\n+\tchecks {\n+\t\tuncommittedChanges = false\n+\t\taheadOfRemote = true\n+\t\tsnapshotDependencies = false\n+\t}\n+\n+\trepository {\n+\t\tdirectory = project.rootProject.file('../')\n+\t}\n+}\n+\n+def dd_trace_version = scmVersion.version\n+\n+dependencies {\n+\timplementation \"com.datadoghq:dd-java-agent:${dd_trace_version}\"\n+\timplementation \"com.datadoghq:dd-trace-api:${dd_trace_version}\"\n+\timplementation \"com.datadoghq:dd-trace-java:${dd_trace_version}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzMDY3Nw==", "bodyText": "is it worth explicitly referencing some of the included classes so that the compile fails if the dependency link fails somehow?", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#discussion_r499630677", "createdAt": "2020-10-05T14:14:56Z", "author": {"login": "tylerbenson"}, "path": "test-published-dependencies/src/main/java/test/published/dependencies/App.java", "diffHunk": "@@ -0,0 +1,7 @@\n+package test.published.dependencies;\n+\n+public class App {\n+  public static void main(String[] args) {\n+    System.out.println(\"Test published dependencies!\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzMTQ3Ng==", "bodyText": "It might be better to remove these to ensure the dependency only comes from the install", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#discussion_r499631476", "createdAt": "2020-10-05T14:16:04Z", "author": {"login": "tylerbenson"}, "path": "test-published-dependencies/build.gradle", "diffHunk": "@@ -0,0 +1,62 @@\n+plugins {\n+\tid 'java'\n+\tid 'application'\n+\n+\tid 'com.diffplug.gradle.spotless' version '4.3.0'\n+\tid 'pl.allegro.tech.build.axion-release' version '1.10.3'\n+}\n+\n+repositories {\n+\tmavenLocal()\n+\tjcenter()\n+\tmavenCentral()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzMjY5Mw==", "bodyText": "can you just apply the ../gradle/spotless.gradle file instead?", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#discussion_r499632693", "createdAt": "2020-10-05T14:17:46Z", "author": {"login": "tylerbenson"}, "path": "test-published-dependencies/build.gradle", "diffHunk": "@@ -0,0 +1,62 @@\n+plugins {\n+\tid 'java'\n+\tid 'application'\n+\n+\tid 'com.diffplug.gradle.spotless' version '4.3.0'\n+\tid 'pl.allegro.tech.build.axion-release' version '1.10.3'\n+}\n+\n+repositories {\n+\tmavenLocal()\n+\tjcenter()\n+\tmavenCentral()\n+}\n+\n+spotless {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzNDQ4Mg==", "bodyText": "If referencing the spotless file works, perhaps this code should be pulled out of dd-trace-java.gradle and referenced the same way.", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#discussion_r499634482", "createdAt": "2020-10-05T14:20:16Z", "author": {"login": "tylerbenson"}, "path": "test-published-dependencies/build.gradle", "diffHunk": "@@ -0,0 +1,62 @@\n+plugins {\n+\tid 'java'\n+\tid 'application'\n+\n+\tid 'com.diffplug.gradle.spotless' version '4.3.0'\n+\tid 'pl.allegro.tech.build.axion-release' version '1.10.3'\n+}\n+\n+repositories {\n+\tmavenLocal()\n+\tjcenter()\n+\tmavenCentral()\n+}\n+\n+spotless {\n+\tjava {\n+\t\tgoogleJavaFormat()\n+\t}\n+\tgroovyGradle {\n+\t\ttarget '*.gradle'\n+\t\tgreclipse()\n+\t}\n+\tformat 'misc', {\n+\t\ttarget '.gitignore'\n+\t\tindentWithSpaces(2)\n+\t\ttrimTrailingWhitespace()\n+\t\tendWithNewline()\n+\t}\n+}\n+task formatCode(dependsOn: ['spotlessApply'])\n+\n+scmVersion {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f"}, "originalPosition": 32}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ad8ddfedb70218b93a3d8039c90380b659ab2c2f", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/ad8ddfedb70218b93a3d8039c90380b659ab2c2f", "committedDate": "2020-10-05T13:01:02Z", "message": "Test published dependencies"}, "afterCommit": {"oid": "41b029920762ebf4f158b1f194501af1be66257c", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/41b029920762ebf4f158b1f194501af1be66257c", "committedDate": "2020-10-06T07:57:43Z", "message": "Apply spotless to root project"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNzcwMjM5", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#pullrequestreview-502770239", "createdAt": "2020-10-06T09:52:18Z", "commit": {"oid": "6053721fe0f2886c2334097f7b5792942842022d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTo1MjoxOVrOHc-rCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTo1MjoxOVrOHc-rCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE0OTAwMA==", "bodyText": "nitpick: mvn_local_repo would be more accurate as a variable name - mvn_home is typically used to refer to where the maven binary is installed", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#discussion_r500149000", "createdAt": "2020-10-06T09:52:19Z", "author": {"login": "mcculls"}, "path": ".circleci/config.yml", "diffHunk": "@@ -146,6 +146,16 @@ jobs:\n             << pipeline.parameters.gradle_flags >>\n             --max-workers=8\n \n+      - run:\n+          name: Test Published Dependencies\n+          command: |\n+            mvn_home=$(mvn help:evaluate -Dexpression=settings.localRepository -q -DforceStdout)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6053721fe0f2886c2334097f7b5792942842022d"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ce91be250fafb440b56927f791e9c9df2fa25d8", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/5ce91be250fafb440b56927f791e9c9df2fa25d8", "committedDate": "2020-10-06T09:59:34Z", "message": "Test published dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1743fbe1cea91d6181b6dbda452373a87440713", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/f1743fbe1cea91d6181b6dbda452373a87440713", "committedDate": "2020-10-06T09:59:44Z", "message": "Apply spotless to root project"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6053721fe0f2886c2334097f7b5792942842022d", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/6053721fe0f2886c2334097f7b5792942842022d", "committedDate": "2020-10-06T09:24:26Z", "message": "Exclude otel 0.9.0 that started failing muzzle"}, "afterCommit": {"oid": "f1743fbe1cea91d6181b6dbda452373a87440713", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/f1743fbe1cea91d6181b6dbda452373a87440713", "committedDate": "2020-10-06T09:59:44Z", "message": "Apply spotless to root project"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyNzc2NTY1", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#pullrequestreview-502776565", "createdAt": "2020-10-06T10:00:20Z", "commit": {"oid": "f1743fbe1cea91d6181b6dbda452373a87440713"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzMTAwNTkx", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#pullrequestreview-503100591", "createdAt": "2020-10-06T15:37:00Z", "commit": {"oid": "f1743fbe1cea91d6181b6dbda452373a87440713"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNTozNzowMFrOHdN53A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQxNTozNzowMFrOHdN53A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDM5ODU1Ng==", "bodyText": "Who has access to mark this check as required? We should do that", "url": "https://github.com/DataDog/dd-trace-java/pull/1949#discussion_r500398556", "createdAt": "2020-10-06T15:37:00Z", "author": {"login": "devinsba"}, "path": ".circleci/config.yml", "diffHunk": "@@ -146,6 +146,16 @@ jobs:\n             << pipeline.parameters.gradle_flags >>\n             --max-workers=8\n \n+      - run:\n+          name: Test Published Dependencies", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1743fbe1cea91d6181b6dbda452373a87440713"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1935, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}