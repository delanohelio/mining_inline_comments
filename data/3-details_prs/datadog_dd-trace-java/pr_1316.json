{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3NTMwMDY2", "number": 1316, "title": "Remove hostname and port from HttpClientDecorator", "bodyText": "Was talking to @tylerbenson and saw that our traces were doing a lot of parsing of URIs. I've found the culprit to be in the hostname(REQUEST request) and port(REQUEST request) methods. Since this data is already computed via the initial URI parse to build the url, I see no need to delegate the extra calls for tags.", "createdAt": "2020-03-13T00:12:38Z", "url": "https://github.com/DataDog/dd-trace-java/pull/1316", "merged": true, "mergeCommit": {"oid": "a1fdfa51a6e3cef74c8f9fa40cb305c480277208"}, "closed": true, "closedAt": "2020-03-13T18:27:26Z", "author": {"login": "aarya123"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNSPxcgFqTM3NDQwMDMyNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNUeE3gFqTM3NDUxNzM4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NDAwMzI1", "url": "https://github.com/DataDog/dd-trace-java/pull/1316#pullrequestreview-374400325", "createdAt": "2020-03-13T15:36:13Z", "commit": {"oid": "4f9e4bf00dfd0445bc1421ab869315b6a8034305"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNTozNjoxM1rOF2IVYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNTo0MDoxMlrOF2Ieiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMwMzk3MQ==", "bodyText": "We avoid having wildcards... you can increase your threshold in your ide.", "url": "https://github.com/DataDog/dd-trace-java/pull/1316#discussion_r392303971", "createdAt": "2020-03-13T15:36:13Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/aws-java-sdk-1.11.0/src/test/groovy/AWSClientTest.groovy", "diffHunk": "@@ -1,16 +1,5 @@\n-import com.amazonaws.AmazonClientException\n-import com.amazonaws.AmazonWebServiceClient\n-import com.amazonaws.ClientConfiguration\n-import com.amazonaws.Request\n-import com.amazonaws.SDKGlobalConfiguration\n-import com.amazonaws.SdkClientException\n-import com.amazonaws.auth.AWSCredentialsProviderChain\n-import com.amazonaws.auth.AWSStaticCredentialsProvider\n-import com.amazonaws.auth.AnonymousAWSCredentials\n-import com.amazonaws.auth.BasicAWSCredentials\n-import com.amazonaws.auth.EnvironmentVariableCredentialsProvider\n-import com.amazonaws.auth.InstanceProfileCredentialsProvider\n-import com.amazonaws.auth.SystemPropertiesCredentialsProvider\n+import com.amazonaws.*\n+import com.amazonaws.auth.*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f9e4bf00dfd0445bc1421ab869315b6a8034305"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMwNjMxNQ==", "bodyText": "Groovy will allow the following:\n      1 * span.setTag(Tags.PEER_HOSTNAME.key, req.url.host)\n      1 * span.setTag(Tags.PEER_PORT.key, req.url.port)\n      if (renameService) {\n        1 * span.setTag(DDTags.SERVICE_NAME, req.url.host)\n      }\nStandard getters (get*() methods) can be accessed like a field.", "url": "https://github.com/DataDog/dd-trace-java/pull/1316#discussion_r392306315", "createdAt": "2020-03-13T15:40:12Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-bootstrap/src/test/groovy/datadog/trace/bootstrap/instrumentation/decorator/HttpClientDecoratorTest.groovy", "diffHunk": "@@ -28,10 +28,10 @@ class HttpClientDecoratorTest extends ClientDecoratorTest {\n     if (req) {\n       1 * span.setTag(Tags.HTTP_METHOD.key, req.method)\n       1 * span.setTag(Tags.HTTP_URL.key, \"$req.url\")\n-      1 * span.setTag(Tags.PEER_HOSTNAME.key, req.host)\n-      1 * span.setTag(Tags.PEER_PORT.key, req.port)\n+      1 * span.setTag(Tags.PEER_HOSTNAME.key, req.url.getHost())\n+      1 * span.setTag(Tags.PEER_PORT.key, req.url.getPort())\n       if (renameService) {\n-        1 * span.setTag(DDTags.SERVICE_NAME, req.host)\n+        1 * span.setTag(DDTags.SERVICE_NAME, req.url.getHost())\n       }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f9e4bf00dfd0445bc1421ab869315b6a8034305"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0344cff386b19528c8f64078be0250a97ea45cf0", "author": {"user": {"login": "aarya123", "name": "Anubhaw Arya"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/0344cff386b19528c8f64078be0250a97ea45cf0", "committedDate": "2020-03-13T17:47:10Z", "message": "Remove hostname and port from HttpClientDecorator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0069c101b343ef4e0b0afbd77f69513b23fa9a16", "author": {"user": {"login": "aarya123", "name": "Anubhaw Arya"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/0069c101b343ef4e0b0afbd77f69513b23fa9a16", "committedDate": "2020-03-13T18:06:00Z", "message": "oops"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NTE3Mzg2", "url": "https://github.com/DataDog/dd-trace-java/pull/1316#pullrequestreview-374517386", "createdAt": "2020-03-13T18:18:03Z", "commit": {"oid": "0069c101b343ef4e0b0afbd77f69513b23fa9a16"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2580, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}