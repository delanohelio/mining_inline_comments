{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2ODgyNjk1", "number": 1228, "title": "Cache the result of toString in BigInteger", "bodyText": "I'm currently testing out the new datadog profiling feature and am seeing a high number of MutableBigIntegers being allocated. Because it was pretty much exclusively due to toString(), I've created a simple wrapper that caches the result, which will (hopefully) reduce our overhead of logging the same trace id multiple times.", "createdAt": "2020-02-18T23:10:50Z", "url": "https://github.com/DataDog/dd-trace-java/pull/1228", "merged": true, "mergeCommit": {"oid": "b805bf59942c5969229df342e913e6e1f8f271e4"}, "closed": true, "closedAt": "2020-02-21T00:10:32Z", "author": {"login": "aarya123"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFqMAlAH2gAyMzc2ODgyNjk1OjNjNmI4NDBkNjk4Nzc0N2I3MjYyYjUwZDhjNzZjYTUyNzYxZGQzYTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGUUb3gFqTM2MjMyNDE1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3c6b840d6987747b7262b50d8c76ca52761dd3a7", "author": {"user": {"login": "aarya123", "name": "Anubhaw Arya"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/3c6b840d6987747b7262b50d8c76ca52761dd3a7", "committedDate": "2020-02-18T23:04:50Z", "message": "Cache the result of toString in BigInteger"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ee46882532b0d3e3df803d46c2b29d2c9d1b01b", "author": {"user": {"login": "aarya123", "name": "Anubhaw Arya"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/4ee46882532b0d3e3df803d46c2b29d2c9d1b01b", "committedDate": "2020-02-18T23:20:53Z", "message": "java 8"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc6c327705d784d4d3c46cea973ad63502603409", "author": {"user": {"login": "aarya123", "name": "Anubhaw Arya"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/fc6c327705d784d4d3c46cea973ad63502603409", "committedDate": "2020-02-19T01:40:06Z", "message": "formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMDQ4NDcx", "url": "https://github.com/DataDog/dd-trace-java/pull/1228#pullrequestreview-362048471", "createdAt": "2020-02-20T16:28:53Z", "commit": {"oid": "fc6c327705d784d4d3c46cea973ad63502603409"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNjoyODo1M1rOFsaUSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxNjoyODo1M1rOFsaUSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjExMjg0Mg==", "bodyText": "Technically this isn't threadsafe, but in practice I don't think it matters.", "url": "https://github.com/DataDog/dd-trace-java/pull/1228#discussion_r382112842", "createdAt": "2020-02-20T16:28:53Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/StringCachingBigInteger.java", "diffHunk": "@@ -0,0 +1,56 @@\n+package datadog.opentracing;\n+\n+import java.math.BigInteger;\n+import java.util.Random;\n+\n+/**\n+ * Because we are using BigInteger for Trace and Span Id, the toString() operator may result in\n+ * heavy computation and string allocation overhead. In order to limit this, we are caching the\n+ * result of toString, thereby taking advantage of the immutability of BigInteger.\n+ */\n+public class StringCachingBigInteger extends BigInteger {\n+\n+  private String cachedString;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc6c327705d784d4d3c46cea973ad63502603409"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17b4fae39c88f7cf7f34bc9d8d97096e596f3583", "author": {"user": {"login": "aarya123", "name": "Anubhaw Arya"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/17b4fae39c88f7cf7f34bc9d8d97096e596f3583", "committedDate": "2020-02-20T20:00:28Z", "message": "Ignores for coverage"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMzI0MTU5", "url": "https://github.com/DataDog/dd-trace-java/pull/1228#pullrequestreview-362324159", "createdAt": "2020-02-21T00:10:03Z", "commit": {"oid": "17b4fae39c88f7cf7f34bc9d8d97096e596f3583"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2724, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}