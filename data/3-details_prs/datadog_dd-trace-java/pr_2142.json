{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwNDAyNjM5", "number": 2142, "title": "Select low and high version in every range for Muzzle", "bodyText": "This changes how we select versions to test in the muzzle step, to select  the low and high version in every major.minor range, and then limiting that to the max allowed number of versions by randomizing. This leads to a reduction  from 3982 muzzle tasks to 2289 since a lot of libraries have large micro ranges.", "createdAt": "2020-12-01T15:54:34Z", "url": "https://github.com/DataDog/dd-trace-java/pull/2142", "merged": true, "mergeCommit": {"oid": "459c4afc9fa0dc9421225449ed8ac43763459c4e"}, "closed": true, "closedAt": "2020-12-02T09:04:49Z", "author": {"login": "bantonsson"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdh8TlhAFqTU0MjA2MjAzNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiJ5H6ABqjQwNjA5NTQwNDU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMDYyMDM3", "url": "https://github.com/DataDog/dd-trace-java/pull/2142#pullrequestreview-542062037", "createdAt": "2020-12-01T16:12:26Z", "commit": {"oid": "721704482297c319eda7a649782ed437166ae2f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNjoxMjoyNlrOH80fkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNjoxMjoyNlrOH80fkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUzNjY1Ng==", "bodyText": "Why are we filtering after shuffling?", "url": "https://github.com/DataDog/dd-trace-java/pull/2142#discussion_r533536656", "createdAt": "2020-12-01T16:12:26Z", "author": {"login": "richardstartin"}, "path": "buildSrc/src/main/groovy/MuzzlePlugin.groovy", "diffHunk": "@@ -292,18 +292,25 @@ class MuzzlePlugin implements Plugin<Project> {\n   }\n \n   private static Set<Version> limitLargeRanges(VersionRangeResult result, Set<Version> versions, Set<String> skipVersions) {\n+    if (versions.size() <= 1) {\n+      return versions\n+    }\n+\n     List<Version> versionsCopy = new ArrayList<>(versions)\n-    Set<String> skipCopy = new HashSet<>(skipVersions)\n+    def beforeSize = versionsCopy.size()\n     versionsCopy.removeAll(skipVersions)\n+    VersionSet versionSet = new VersionSet(versionsCopy)\n+    versionsCopy = versionSet.lowAndHighForMajorMinor.toList()\n     Collections.shuffle(versionsCopy)\n     while (RANGE_COUNT_LIMIT <= versionsCopy.size()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "721704482297c319eda7a649782ed437166ae2f8"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMjk3MzMz", "url": "https://github.com/DataDog/dd-trace-java/pull/2142#pullrequestreview-542297333", "createdAt": "2020-12-01T21:08:39Z", "commit": {"oid": "721704482297c319eda7a649782ed437166ae2f8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMTowODozOVrOH8_1QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMTowODozOVrOH8_1QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcyMjQzMg==", "bodyText": "Thanks for adding some tests!", "url": "https://github.com/DataDog/dd-trace-java/pull/2142#discussion_r533722432", "createdAt": "2020-12-01T21:08:39Z", "author": {"login": "tylerbenson"}, "path": "buildSrc/src/test/groovy/VersionSetTest.groovy", "diffHunk": "@@ -0,0 +1,90 @@\n+import org.eclipse.aether.version.Version\n+import spock.lang.Specification\n+\n+import static VersionSet.ParsedVersion\n+\n+class VersionSetTest extends Specification {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "721704482297c319eda7a649782ed437166ae2f8"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNTc1Njc2", "url": "https://github.com/DataDog/dd-trace-java/pull/2142#pullrequestreview-542575676", "createdAt": "2020-12-02T07:59:29Z", "commit": {"oid": "721704482297c319eda7a649782ed437166ae2f8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eeeb51b3fe8e86e9cbe9f4bf817274ffd5081e1", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/9eeeb51b3fe8e86e9cbe9f4bf817274ffd5081e1", "committedDate": "2020-12-02T08:02:00Z", "message": "Select low and high version in every range for Muzzle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "721704482297c319eda7a649782ed437166ae2f8", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/721704482297c319eda7a649782ed437166ae2f8", "committedDate": "2020-12-01T15:45:44Z", "message": "Select low and high version in every range for Muzzle"}, "afterCommit": {"oid": "9eeeb51b3fe8e86e9cbe9f4bf817274ffd5081e1", "author": {"user": {"login": "bantonsson", "name": "Bj\u00f6rn Antonsson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/9eeeb51b3fe8e86e9cbe9f4bf817274ffd5081e1", "committedDate": "2020-12-02T08:02:00Z", "message": "Select low and high version in every range for Muzzle"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2898, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}