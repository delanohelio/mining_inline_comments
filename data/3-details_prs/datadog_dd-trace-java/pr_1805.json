{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MDY1MzI5", "number": 1805, "title": "cache boxed integers in a radix tree, make HTTP status and port primitives", "bodyText": "", "createdAt": "2020-08-26T17:58:49Z", "url": "https://github.com/DataDog/dd-trace-java/pull/1805", "merged": true, "mergeCommit": {"oid": "3c9d38059f86a4df6723c29147d8745819773cb8"}, "closed": true, "closedAt": "2020-08-27T06:45:44Z", "author": {"login": "richardstartin"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCvwHxgBqjM2OTYwMDExMTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdC6lscgFqTQ3NjQyNTc3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b83b3b4389b11b23d3dadb34160784ab14f7104b", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/b83b3b4389b11b23d3dadb34160784ab14f7104b", "committedDate": "2020-08-26T17:57:14Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "3abde15010b94701a0ae2617e313cae6828565d0", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/3abde15010b94701a0ae2617e313cae6828565d0", "committedDate": "2020-08-26T18:03:01Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3abde15010b94701a0ae2617e313cae6828565d0", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/3abde15010b94701a0ae2617e313cae6828565d0", "committedDate": "2020-08-26T18:03:01Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "bc60ea983bfe09887d4ed275d1a327af81d7ce7b", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/bc60ea983bfe09887d4ed275d1a327af81d7ce7b", "committedDate": "2020-08-26T18:08:32Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc60ea983bfe09887d4ed275d1a327af81d7ce7b", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/bc60ea983bfe09887d4ed275d1a327af81d7ce7b", "committedDate": "2020-08-26T18:08:32Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "8161c79cf6da3a132c419487994468e4bac7781c", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/8161c79cf6da3a132c419487994468e4bac7781c", "committedDate": "2020-08-26T19:03:52Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8161c79cf6da3a132c419487994468e4bac7781c", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/8161c79cf6da3a132c419487994468e4bac7781c", "committedDate": "2020-08-26T19:03:52Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "29d90d71420b5fbdd5813f307014c555bd1623fd", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/29d90d71420b5fbdd5813f307014c555bd1623fd", "committedDate": "2020-08-26T19:14:13Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "29d90d71420b5fbdd5813f307014c555bd1623fd", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/29d90d71420b5fbdd5813f307014c555bd1623fd", "committedDate": "2020-08-26T19:14:13Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "0cc99a51ba8c77aa77eaef92b16eecc32d136646", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/0cc99a51ba8c77aa77eaef92b16eecc32d136646", "committedDate": "2020-08-26T19:28:36Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0cc99a51ba8c77aa77eaef92b16eecc32d136646", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/0cc99a51ba8c77aa77eaef92b16eecc32d136646", "committedDate": "2020-08-26T19:28:36Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "54ed9d6f58c0a49272d693b785b56692a769cd39", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/54ed9d6f58c0a49272d693b785b56692a769cd39", "committedDate": "2020-08-26T20:21:51Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "54ed9d6f58c0a49272d693b785b56692a769cd39", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/54ed9d6f58c0a49272d693b785b56692a769cd39", "committedDate": "2020-08-26T20:21:51Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "f3388987687cedc0b5ae91762ded03028cf10b06", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/f3388987687cedc0b5ae91762ded03028cf10b06", "committedDate": "2020-08-26T20:22:46Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1ODQ1MTQx", "url": "https://github.com/DataDog/dd-trace-java/pull/1805#pullrequestreview-475845141", "createdAt": "2020-08-26T20:44:41Z", "commit": {"oid": "f3388987687cedc0b5ae91762ded03028cf10b06"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3388987687cedc0b5ae91762ded03028cf10b06", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/f3388987687cedc0b5ae91762ded03028cf10b06", "committedDate": "2020-08-26T20:22:46Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "bcbf8a3c616264ab884f4a00765dadf1405556dc", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/bcbf8a3c616264ab884f4a00765dadf1405556dc", "committedDate": "2020-08-26T20:45:04Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1OTU0MzA5", "url": "https://github.com/DataDog/dd-trace-java/pull/1805#pullrequestreview-475954309", "createdAt": "2020-08-26T22:27:23Z", "commit": {"oid": "bcbf8a3c616264ab884f4a00765dadf1405556dc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjoyNzoyM1rOHHf2fQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjoyNzoyM1rOHHf2fQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzYyMzkzMw==", "bodyText": "Is 9090 common enough to warrant caching here?", "url": "https://github.com/DataDog/dd-trace-java/pull/1805#discussion_r477623933", "createdAt": "2020-08-26T22:27:23Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-bootstrap/src/main/java/datadog/trace/bootstrap/instrumentation/cache/RadixTreeBoxCache.java", "diffHunk": "@@ -0,0 +1,61 @@\n+package datadog.trace.bootstrap.instrumentation.cache;\n+\n+import java.util.concurrent.atomic.AtomicReferenceArray;\n+\n+/** Sparse cache of commonly boxed values */\n+public final class RadixTreeBoxCache {\n+\n+  public static final RadixTreeBoxCache HTTP_STATUSES =\n+      new RadixTreeBoxCache(8, 64, 200, 201, 301, 307, 400, 401, 403, 404, 500, 502, 503);\n+\n+  public static final RadixTreeBoxCache PORTS =\n+      new RadixTreeBoxCache(256, 256, 80, 443, 8080, 9090);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcbf8a3c616264ab884f4a00765dadf1405556dc"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1OTY1Njk3", "url": "https://github.com/DataDog/dd-trace-java/pull/1805#pullrequestreview-475965697", "createdAt": "2020-08-26T22:30:56Z", "commit": {"oid": "bcbf8a3c616264ab884f4a00765dadf1405556dc"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjozMDo1NlrOHHf7jA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMjozMDo1NlrOHHf7jA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzYyNTIyOA==", "bodyText": "A comment with how you determined your l1 and l2 sizes would be helpful.", "url": "https://github.com/DataDog/dd-trace-java/pull/1805#discussion_r477625228", "createdAt": "2020-08-26T22:30:56Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-bootstrap/src/main/java/datadog/trace/bootstrap/instrumentation/cache/RadixTreeBoxCache.java", "diffHunk": "@@ -0,0 +1,61 @@\n+package datadog.trace.bootstrap.instrumentation.cache;\n+\n+import java.util.concurrent.atomic.AtomicReferenceArray;\n+\n+/** Sparse cache of commonly boxed values */\n+public final class RadixTreeBoxCache {\n+\n+  public static final RadixTreeBoxCache HTTP_STATUSES =\n+      new RadixTreeBoxCache(8, 64, 200, 201, 301, 307, 400, 401, 403, 404, 500, 502, 503);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcbf8a3c616264ab884f4a00765dadf1405556dc"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7cc284006468f742ff2f839fb76778afda32f4a6", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/7cc284006468f742ff2f839fb76778afda32f4a6", "committedDate": "2020-08-27T05:18:10Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bcbf8a3c616264ab884f4a00765dadf1405556dc", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/bcbf8a3c616264ab884f4a00765dadf1405556dc", "committedDate": "2020-08-26T20:45:04Z", "message": "cache boxed integers in a radix tree"}, "afterCommit": {"oid": "7cc284006468f742ff2f839fb76778afda32f4a6", "author": {"user": {"login": "richardstartin", "name": "Richard Startin"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/7cc284006468f742ff2f839fb76778afda32f4a6", "committedDate": "2020-08-27T05:18:10Z", "message": "cache boxed integers in a radix tree"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2NDI1Nzc1", "url": "https://github.com/DataDog/dd-trace-java/pull/1805#pullrequestreview-476425775", "createdAt": "2020-08-27T06:40:45Z", "commit": {"oid": "7cc284006468f742ff2f839fb76778afda32f4a6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1957, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}