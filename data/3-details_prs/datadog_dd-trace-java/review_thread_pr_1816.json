{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2MzkyOTA3", "number": 1816, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoxMDowMlrOEeX0oA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoxMTo1OVrOEeX3Zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjgzMDQwOnYy", "diffSide": "RIGHT", "path": "dd-trace-core/src/main/java/datadog/trace/common/writer/ddagent/DDAgentApi.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoxMDowMlrOHJ_LRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoxMDowMlrOHJ_LRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIzNDMwOQ==", "bodyText": "Actually use the timeout when trying to connect.", "url": "https://github.com/DataDog/dd-trace-java/pull/1816#discussion_r480234309", "createdAt": "2020-08-31T16:10:02Z", "author": {"login": "bantonsson"}, "path": "dd-trace-core/src/main/java/datadog/trace/common/writer/ddagent/DDAgentApi.java", "diffHunk": "@@ -397,16 +397,15 @@ String detectEndpointAndBuildClient() {\n     } else {\n       log.warn(\"No connectivity to datadog agent\");\n     }\n-    if (null == detectedVersion) {\n-      log.debug(\"Tried all of {}, no connectivity to datadog agent\", endpoints);\n+    if (null == detectedVersion && log.isDebugEnabled()) {\n+      log.debug(\"Tried all of {}, no connectivity to datadog agent\", Arrays.asList(endpoints));\n     }\n     return detectedVersion;\n   }\n \n-  private boolean isAgentRunning() {\n+  private boolean isAgentRunning(final long timeoutMillis) {\n     try (Socket socket = new Socket()) {\n-      socket.setSoTimeout(CONNECT_TIMEOUT_MS);\n-      socket.connect(new InetSocketAddress(host, port));\n+      socket.connect(new InetSocketAddress(host, port), (int) timeoutMillis);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71b3da35ad47b7012076a4a8060c376edd809261"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjgzNzUxOnYy", "diffSide": "RIGHT", "path": "dd-trace-core/src/main/java/datadog/trace/common/writer/ddagent/DDAgentApi.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjoxMTo1OVrOHJ_Pgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxOToxMToxNFrOHKFNfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIzNTM5NA==", "bodyText": "This only logged the first element of the endpoints array.", "url": "https://github.com/DataDog/dd-trace-java/pull/1816#discussion_r480235394", "createdAt": "2020-08-31T16:11:59Z", "author": {"login": "bantonsson"}, "path": "dd-trace-core/src/main/java/datadog/trace/common/writer/ddagent/DDAgentApi.java", "diffHunk": "@@ -397,16 +397,15 @@ String detectEndpointAndBuildClient() {\n     } else {\n       log.warn(\"No connectivity to datadog agent\");\n     }\n-    if (null == detectedVersion) {\n-      log.debug(\"Tried all of {}, no connectivity to datadog agent\", endpoints);\n+    if (null == detectedVersion && log.isDebugEnabled()) {\n+      log.debug(\"Tried all of {}, no connectivity to datadog agent\", Arrays.asList(endpoints));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71b3da35ad47b7012076a4a8060c376edd809261"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDMzMzE4Mw==", "bodyText": "This is shameful :(", "url": "https://github.com/DataDog/dd-trace-java/pull/1816#discussion_r480333183", "createdAt": "2020-08-31T19:11:14Z", "author": {"login": "richardstartin"}, "path": "dd-trace-core/src/main/java/datadog/trace/common/writer/ddagent/DDAgentApi.java", "diffHunk": "@@ -397,16 +397,15 @@ String detectEndpointAndBuildClient() {\n     } else {\n       log.warn(\"No connectivity to datadog agent\");\n     }\n-    if (null == detectedVersion) {\n-      log.debug(\"Tried all of {}, no connectivity to datadog agent\", endpoints);\n+    if (null == detectedVersion && log.isDebugEnabled()) {\n+      log.debug(\"Tried all of {}, no connectivity to datadog agent\", Arrays.asList(endpoints));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIzNTM5NA=="}, "originalCommit": {"oid": "71b3da35ad47b7012076a4a8060c376edd809261"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4919, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}