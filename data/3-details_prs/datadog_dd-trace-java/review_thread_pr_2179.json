{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NDA4NjMy", "number": 2179, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxOToyNDo0NlrOFDGNEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxOToyNDo0NlrOFDGNEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NzkxNjk4OnYy", "diffSide": "RIGHT", "path": "dd-trace-core/src/main/java/datadog/trace/core/monitor/Timer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxOToyNDo0NlrOIClhPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxOToyNjoyNVrOIClljQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4Mjc4Mw==", "bodyText": "I assume the thread safety concerns are already encapsulated?", "url": "https://github.com/DataDog/dd-trace-java/pull/2179#discussion_r539582783", "createdAt": "2020-12-09T19:24:46Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-core/src/main/java/datadog/trace/core/monitor/Timer.java", "diffHunk": "@@ -67,7 +66,7 @@ public void stop() {\n \n   private void record(long now) {\n     // if it's longer than 30s, we have bigger problems\n-    histogram.recordValue(Math.min(now - start, THIRTY_SECONDS_AS_NANOS));\n+    histogram.accept(Math.min(NANOSECONDS.toMicros(now - start), THIRTY_SECONDS_AS_MICROS));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "734824dde86225375a75fb62282252c6174d86e6"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4Mzg4NQ==", "bodyText": "yes, indeed. PackedHistogram wasn't threadsafe either.", "url": "https://github.com/DataDog/dd-trace-java/pull/2179#discussion_r539583885", "createdAt": "2020-12-09T19:26:25Z", "author": {"login": "richardstartin"}, "path": "dd-trace-core/src/main/java/datadog/trace/core/monitor/Timer.java", "diffHunk": "@@ -67,7 +66,7 @@ public void stop() {\n \n   private void record(long now) {\n     // if it's longer than 30s, we have bigger problems\n-    histogram.recordValue(Math.min(now - start, THIRTY_SECONDS_AS_NANOS));\n+    histogram.accept(Math.min(NANOSECONDS.toMicros(now - start), THIRTY_SECONDS_AS_MICROS));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4Mjc4Mw=="}, "originalCommit": {"oid": "734824dde86225375a75fb62282252c6174d86e6"}, "originalPosition": 51}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4517, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}