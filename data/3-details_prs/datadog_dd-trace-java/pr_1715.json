{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MzM2ODQ5", "number": 1715, "title": "Serverless support for tracing through logging", "bodyText": "This is a port of DataDog/dd-trace-py#1276 and DataDog/dd-trace-py#1291 .  The goal is to print traces to standard out instead of sending to an agent when in a serverless environment.  Through a log forwarding layer, traces can get to the datadog backend.\nThere are 4 parts:\n\nA new Writer that prints traces to standard out using hex ids.  This is very similar to LoggingWriter so I created a new base class.  Alternatively, I could have extracted the moshi json code and had both writers use the extracted class.\nDetecting if any agent arguments were set.  If an agent is explicitly set, we still want to send traces to it\nDetect if running in a serverless environment.  I followed the ContainerInfo style.\nUsing the PrintingWriter in the correct conditions", "createdAt": "2020-07-27T18:44:46Z", "url": "https://github.com/DataDog/dd-trace-java/pull/1715", "merged": true, "mergeCommit": {"oid": "4f6b13b9ac530e0ca1b292ed6bd68722ea5dc57a"}, "closed": true, "closedAt": "2020-07-28T18:09:06Z", "author": {"login": "randomanderson"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4KvCQAH2gAyNDU3MzM2ODQ5OmQ2YmMxNWEzYmQwYzI5YzMyMzYzNWJiOTg0MzFhZjAyOTUxYWRmNDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5ZVM6gFqTQ1NjgyNDMzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d6bc15a3bd0c29c323635bb98431af02951adf40", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/d6bc15a3bd0c29c323635bb98431af02951adf40", "committedDate": "2020-07-24T21:16:16Z", "message": "Std out printing writer and tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "398f679a0663aa9745cec3aaff9d3b41c3b9a68d", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/398f679a0663aa9745cec3aaff9d3b41c3b9a68d", "committedDate": "2020-07-27T16:31:25Z", "message": "Add \"agentConfigureUsingDefault\" property"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf9a65ccf1ed1ec35808c277de86ba3dfde0bec4", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/bf9a65ccf1ed1ec35808c277de86ba3dfde0bec4", "committedDate": "2020-07-27T17:09:37Z", "message": "Default to PrintingWriter if in serverless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91e40330e377bfb9e25ee5d0eecb0b901b85d9ce", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/91e40330e377bfb9e25ee5d0eecb0b901b85d9ce", "committedDate": "2020-07-27T18:50:34Z", "message": "Add case where agent is explicitly set to the default"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2MDc4MjU5", "url": "https://github.com/DataDog/dd-trace-java/pull/1715#pullrequestreview-456078259", "createdAt": "2020-07-27T19:38:41Z", "commit": {"oid": "91e40330e377bfb9e25ee5d0eecb0b901b85d9ce"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fca81bef0c7eb0a354c5362093d8b16512b34312", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/fca81bef0c7eb0a354c5362093d8b16512b34312", "committedDate": "2020-07-27T22:07:51Z", "message": "Fix codenarc violations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6796ac3f7161de5f611544f7291dc7ed636903ef", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/6796ac3f7161de5f611544f7291dc7ed636903ef", "committedDate": "2020-07-27T22:16:44Z", "message": "Remove failing test not testing anything"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2Mzg4OTcx", "url": "https://github.com/DataDog/dd-trace-java/pull/1715#pullrequestreview-456388971", "createdAt": "2020-07-28T07:55:28Z", "commit": {"oid": "6796ac3f7161de5f611544f7291dc7ed636903ef"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwNzo1NToyOFrOG4A-2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQwNzo1NToyOFrOG4A-2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4OTUzMA==", "bodyText": "Not sure why this test is removed. Are we checking in some other test that the magic _dd.agent_psr metric is set correctly?", "url": "https://github.com/DataDog/dd-trace-java/pull/1715#discussion_r461389530", "createdAt": "2020-07-28T07:55:28Z", "author": {"login": "bantonsson"}, "path": "dd-trace-core/src/test/groovy/datadog/trace/core/DDSpanSerializationTest.groovy", "diffHunk": "@@ -20,74 +17,9 @@ import java.nio.ByteBuffer\n \n class DDSpanSerializationTest extends DDSpecification {\n \n-  def \"serialize trace with sampling #samplingPriority\"() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6796ac3f7161de5f611544f7291dc7ed636903ef"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb052f183eb5069ef9d034135709a4f35ac8a53e", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/cb052f183eb5069ef9d034135709a4f35ac8a53e", "committedDate": "2020-07-28T16:14:28Z", "message": "Testing for ServerlessInfo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2ODI0MzMy", "url": "https://github.com/DataDog/dd-trace-java/pull/1715#pullrequestreview-456824332", "createdAt": "2020-07-28T16:50:33Z", "commit": {"oid": "cb052f183eb5069ef9d034135709a4f35ac8a53e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2039, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}