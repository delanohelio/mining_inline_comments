{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4NDI2NzIy", "number": 1248, "title": "Avoid calling superclass matcher where possible", "bodyText": "Saves about 300ms of startup time on test app", "createdAt": "2020-02-21T19:02:31Z", "url": "https://github.com/DataDog/dd-trace-java/pull/1248", "merged": true, "mergeCommit": {"oid": "833f67816e4e7a41a1dbf89d64b22bc809c95dcf"}, "closed": true, "closedAt": "2020-02-22T02:16:53Z", "author": {"login": "mar-kolya"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGknNLAFqTM2Mjg1MjE0NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGoh3KgFqTM2Mjk3OTA5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyODUyMTQ0", "url": "https://github.com/DataDog/dd-trace-java/pull/1248#pullrequestreview-362852144", "createdAt": "2020-02-21T19:08:40Z", "commit": {"oid": "dea85909044f0f5d3cf0f67d2d6852fc9e493259"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxOTowODo0MVrOFtBihg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxOTowODo0MVrOFtBihg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc1NTQ2Mg==", "bodyText": "I think some of these are safe, but many aren't.  For example, HystrixCommand is intended to be extended, so most usages of this won't match the package prefix.  I'm guessing many of these others have a similar issue.", "url": "https://github.com/DataDog/dd-trace-java/pull/1248#discussion_r382755462", "createdAt": "2020-02-21T19:08:41Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/hystrix-1.4/src/main/java/datadog/trace/instrumentation/hystrix/HystrixInstrumentation.java", "diffHunk": "@@ -29,9 +30,11 @@ public HystrixInstrumentation() {\n \n   @Override\n   public ElementMatcher<TypeDescription> typeMatcher() {\n-    return safeExtendsClass(\n-        named(\"com.netflix.hystrix.HystrixCommand\")\n-            .or(named(\"com.netflix.hystrix.HystrixObservableCommand\")));\n+    return nameStartsWith(\"com.netflix.hystrix.\")\n+        .and(\n+            safeExtendsClass(\n+                named(\"com.netflix.hystrix.HystrixCommand\")\n+                    .or(named(\"com.netflix.hystrix.HystrixObservableCommand\"))));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dea85909044f0f5d3cf0f67d2d6852fc9e493259"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyODUzODQ5", "url": "https://github.com/DataDog/dd-trace-java/pull/1248#pullrequestreview-362853849", "createdAt": "2020-02-21T19:11:27Z", "commit": {"oid": "dea85909044f0f5d3cf0f67d2d6852fc9e493259"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxOToxMToyOFrOFtBnnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxOToxMToyOFrOFtBnnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc1Njc2NQ==", "bodyText": "I don't think this one can be done. I've seen custom Criteria classes before", "url": "https://github.com/DataDog/dd-trace-java/pull/1248#discussion_r382756765", "createdAt": "2020-02-21T19:11:28Z", "author": {"login": "devinsba"}, "path": "dd-java-agent/instrumentation/hibernate/core-3.3/src/main/java/datadog/trace/instrumentation/hibernate/core/v3_3/CriteriaInstrumentation.java", "diffHunk": "@@ -31,7 +32,9 @@\n \n   @Override\n   public ElementMatcher<TypeDescription> typeMatcher() {\n-    return not(isInterface()).and(safeHasInterface(named(\"org.hibernate.Criteria\")));\n+    return nameStartsWith(\"org.hibernate.\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dea85909044f0f5d3cf0f67d2d6852fc9e493259"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dea85909044f0f5d3cf0f67d2d6852fc9e493259", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/dea85909044f0f5d3cf0f67d2d6852fc9e493259", "committedDate": "2020-02-21T19:01:48Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 300ms of startup time on test app"}, "afterCommit": {"oid": "c3a41b65af66c4d75be39707392884b464b6e60d", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/c3a41b65af66c4d75be39707392884b464b6e60d", "committedDate": "2020-02-21T19:18:41Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 300ms of startup time on test app"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3a41b65af66c4d75be39707392884b464b6e60d", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/c3a41b65af66c4d75be39707392884b464b6e60d", "committedDate": "2020-02-21T19:18:41Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 300ms of startup time on test app"}, "afterCommit": {"oid": "2fd79fdfb1d5eba8864a5fd057b555cc13bb778f", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/2fd79fdfb1d5eba8864a5fd057b555cc13bb778f", "committedDate": "2020-02-21T19:22:11Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 300ms of startup time on test app"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2fd79fdfb1d5eba8864a5fd057b555cc13bb778f", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/2fd79fdfb1d5eba8864a5fd057b555cc13bb778f", "committedDate": "2020-02-21T19:22:11Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 300ms of startup time on test app"}, "afterCommit": {"oid": "ef575a79369d7cfdf2a86104a35d1c95e7b0c331", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/ef575a79369d7cfdf2a86104a35d1c95e7b0c331", "committedDate": "2020-02-21T19:25:02Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 300ms of startup time on test app"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef575a79369d7cfdf2a86104a35d1c95e7b0c331", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/ef575a79369d7cfdf2a86104a35d1c95e7b0c331", "committedDate": "2020-02-21T19:25:02Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 300ms of startup time on test app"}, "afterCommit": {"oid": "91a56b3dcde05e2c72fe4aa22bf3365351de2db1", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/91a56b3dcde05e2c72fe4aa22bf3365351de2db1", "committedDate": "2020-02-21T19:49:26Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 100ms of startup time on test app"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6d374e3a0aaaffdcbdec4933c06888a198acc11", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/b6d374e3a0aaaffdcbdec4933c06888a198acc11", "committedDate": "2020-02-21T20:08:39Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 100ms of startup time on test app"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91a56b3dcde05e2c72fe4aa22bf3365351de2db1", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/91a56b3dcde05e2c72fe4aa22bf3365351de2db1", "committedDate": "2020-02-21T19:49:26Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 100ms of startup time on test app"}, "afterCommit": {"oid": "b6d374e3a0aaaffdcbdec4933c06888a198acc11", "author": {"user": {"login": "mar-kolya", "name": "Nikolay Martynov"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/b6d374e3a0aaaffdcbdec4933c06888a198acc11", "committedDate": "2020-02-21T20:08:39Z", "message": "Avoid calling superclass matcher where possible\n\nSaves about 100ms of startup time on test app"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyOTc5MDk0", "url": "https://github.com/DataDog/dd-trace-java/pull/1248#pullrequestreview-362979094", "createdAt": "2020-02-21T23:42:49Z", "commit": {"oid": "b6d374e3a0aaaffdcbdec4933c06888a198acc11"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2750, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}