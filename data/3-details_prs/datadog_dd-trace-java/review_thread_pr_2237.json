{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0NjgzMjc3", "number": 2237, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTo1NzowM1rOFIhc4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTo1NzozN1rOFIhdjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NDgwOTk1OnYy", "diffSide": "RIGHT", "path": "internal-api/src/test/groovy/datadog/trace/util/AgentTaskSchedulerTest.groovy", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTo1NzowM1rOIKfm8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTo1NzowM1rOIKfm8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg3NDU0NQ==", "bodyText": "If the task starts executing and is executing when we call taskCount, it will return 0.", "url": "https://github.com/DataDog/dd-trace-java/pull/2237#discussion_r547874545", "createdAt": "2020-12-23T09:57:03Z", "author": {"login": "bantonsson"}, "path": "internal-api/src/test/groovy/datadog/trace/util/AgentTaskSchedulerTest.groovy", "diffHunk": "@@ -39,12 +39,11 @@ class AgentTaskSchedulerTest extends DDSpecification {\n     !scheduler.isShutdown()\n \n     when:\n-    scheduler.scheduleAtFixedRate(task, latch, 10, 10, MILLISECONDS)\n+    scheduler.scheduleAtFixedRate(task, latch, 50, 10, MILLISECONDS)\n     scheduler.taskCount() == 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37dbb4ef69e72a6095230103ea6e451a4a45d0b4"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NDgxMTY2OnYy", "diffSide": "LEFT", "path": "internal-api/src/test/groovy/datadog/trace/util/AgentTaskSchedulerTest.groovy", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTo1NzozN1rOIKfoBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QwOTo1NzozN1rOIKfoBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Nzg3NDgyMQ==", "bodyText": "If the task is executing taskCount will return 0. I think it's enough that the task counts down the latch more than once.", "url": "https://github.com/DataDog/dd-trace-java/pull/2237#discussion_r547874821", "createdAt": "2020-12-23T09:57:37Z", "author": {"login": "bantonsson"}, "path": "internal-api/src/test/groovy/datadog/trace/util/AgentTaskSchedulerTest.groovy", "diffHunk": "@@ -39,12 +39,11 @@ class AgentTaskSchedulerTest extends DDSpecification {\n     !scheduler.isShutdown()\n \n     when:\n-    scheduler.scheduleAtFixedRate(task, latch, 10, 10, MILLISECONDS)\n+    scheduler.scheduleAtFixedRate(task, latch, 50, 10, MILLISECONDS)\n     scheduler.taskCount() == 1\n \n     then:\n     latch.await(500, MILLISECONDS)\n-    scheduler.taskCount() == 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37dbb4ef69e72a6095230103ea6e451a4a45d0b4"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4574, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}