{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwOTQ1ODg0", "number": 1266, "title": "Imply not(isInterface()) call for expensive matchers", "bodyText": "Also remove from simple named(\"some.name\") matchers to avoid metadata lookup.", "createdAt": "2020-02-27T16:26:38Z", "url": "https://github.com/DataDog/dd-trace-java/pull/1266", "merged": true, "mergeCommit": {"oid": "68e4bf8375dabad857a9893494db4db94951834a"}, "closed": true, "closedAt": "2020-02-27T20:54:16Z", "author": {"login": "tylerbenson"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIePTygBqjMwNzg2MTM3NDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIhfvogFqTM2NTk4MTM0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6bf098feb4b73074d147d89b28bb589bf25927b1", "author": {"user": {"login": "tylerbenson", "name": "Tyler Benson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/6bf098feb4b73074d147d89b28bb589bf25927b1", "committedDate": "2020-02-27T16:25:36Z", "message": "Imply not(isInterface()) call for expensive matchers\n\nAlso remove from simple named(\"some.name\") matchers to avoid metadata lookup."}, "afterCommit": {"oid": "59b5e1874d63175dee3854f9ef2c9bd3255764d3", "author": {"user": {"login": "tylerbenson", "name": "Tyler Benson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/59b5e1874d63175dee3854f9ef2c9bd3255764d3", "committedDate": "2020-02-27T16:51:11Z", "message": "Imply not(isInterface()) call for expensive matchers\n\nAlso remove from simple named(\"some.name\") matchers to avoid metadata lookup."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35e00686b304534d7e5cb54daedd45e1011a9915", "author": {"user": {"login": "tylerbenson", "name": "Tyler Benson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/35e00686b304534d7e5cb54daedd45e1011a9915", "committedDate": "2020-02-27T20:13:42Z", "message": "Imply not(isInterface()) call for expensive matchers\n\nAlso remove from simple named(\"some.name\") matchers to avoid metadata lookup."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "59b5e1874d63175dee3854f9ef2c9bd3255764d3", "author": {"user": {"login": "tylerbenson", "name": "Tyler Benson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/59b5e1874d63175dee3854f9ef2c9bd3255764d3", "committedDate": "2020-02-27T16:51:11Z", "message": "Imply not(isInterface()) call for expensive matchers\n\nAlso remove from simple named(\"some.name\") matchers to avoid metadata lookup."}, "afterCommit": {"oid": "35e00686b304534d7e5cb54daedd45e1011a9915", "author": {"user": {"login": "tylerbenson", "name": "Tyler Benson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/35e00686b304534d7e5cb54daedd45e1011a9915", "committedDate": "2020-02-27T20:13:42Z", "message": "Imply not(isInterface()) call for expensive matchers\n\nAlso remove from simple named(\"some.name\") matchers to avoid metadata lookup."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTczOTA1", "url": "https://github.com/DataDog/dd-trace-java/pull/1266#pullrequestreview-365973905", "createdAt": "2020-02-27T20:26:20Z", "commit": {"oid": "35e00686b304534d7e5cb54daedd45e1011a9915"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDoyNjoyMFrOFvgEVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDoyNjoyMFrOFvgEVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM1Mjc5MQ==", "bodyText": "Had to split this out as a separate method because some instrumentation uses hasInterface in method matchers to match method parameter and return types, so it can't exclude interfaces.", "url": "https://github.com/DataDog/dd-trace-java/pull/1266#discussion_r385352791", "createdAt": "2020-02-27T20:26:20Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/matcher/DDElementMatchers.java", "diffHunk": "@@ -15,28 +17,26 @@\n \n   public static <T extends TypeDescription> ElementMatcher.Junction<T> extendsClass(\n       final ElementMatcher<? super TypeDescription> matcher) {\n-    return new SafeExtendsClassMatcher<>(new SafeErasureMatcher<>(matcher));\n+    return not(isInterface()).and(new SafeExtendsClassMatcher<>(new SafeErasureMatcher<>(matcher)));\n+  }\n+\n+  public static <T extends TypeDescription> ElementMatcher.Junction<T> implementsInterface(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35e00686b304534d7e5cb54daedd45e1011a9915"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTgxMzQx", "url": "https://github.com/DataDog/dd-trace-java/pull/1266#pullrequestreview-365981341", "createdAt": "2020-02-27T20:39:01Z", "commit": {"oid": "35e00686b304534d7e5cb54daedd45e1011a9915"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2534, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}