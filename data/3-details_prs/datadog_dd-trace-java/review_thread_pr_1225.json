{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1NDk2NjM3", "number": 1225, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo0ODo1NFrODjRYIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjo1NzozOFrODjiLIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzExNDU5OnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDSpan.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo0ODo1NFrOFu_QXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo0ODo1NFrOFu_QXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxNTE5Ng==", "bodyText": "What about making the previous behavior be the default logHandler?\nThen this method would simply call\nlogHandler.log(map);", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r384815196", "createdAt": "2020-02-26T22:48:54Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDSpan.java", "diffHunk": "@@ -227,7 +242,9 @@ public final DDSpan setOperationName(final String operationName) {\n    */\n   @Override\n   public final DDSpan log(final Map<String, ?> map) {\n-    if (!extractError(map)) {\n+    if (!extractError(map) && logsHandler != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c287dbbf895e0c6182b9a33170b693f354d11244"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzExNzA5OnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo1MDowM1rOFu_R-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo1MDowM1rOFu_R-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxNTYwOA==", "bodyText": "This could start with the Default implementation instead of null.", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r384815608", "createdAt": "2020-02-26T22:50:03Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "diffHunk": "@@ -580,6 +580,7 @@ private static DDScopeEventFactory createScopeEventFactory() {\n     private boolean errorFlag;\n     private String spanType;\n     private boolean ignoreScope = false;\n+    private LogsHandler logsHandler = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c287dbbf895e0c6182b9a33170b693f354d11244"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzExODA4OnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo1MDoyNVrOFu_Shg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo1MDoyNVrOFu_Shg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxNTc1MA==", "bodyText": "Assert logsHandler is never set to null.", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r384815750", "createdAt": "2020-02-26T22:50:25Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "diffHunk": "@@ -670,6 +671,11 @@ public DDSpanBuilder withSpanType(final String spanType) {\n       return parent.baggageItems();\n     }\n \n+    public DDSpanBuilder withLogsHandler(LogsHandler logsHandler) {\n+      this.logsHandler = logsHandler;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c287dbbf895e0c6182b9a33170b693f354d11244"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzEyMzMzOnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/LogsHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo1MjoyNFrOFu_Vpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjo1MjoyNFrOFu_Vpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxNjU1MQ==", "bodyText": "One more thing... lets go with LogHandler", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r384816551", "createdAt": "2020-02-26T22:52:24Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/LogsHandler.java", "diffHunk": "@@ -0,0 +1,40 @@\n+package datadog.opentracing;\n+\n+import java.util.Map;\n+\n+public interface LogsHandler {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c287dbbf895e0c6182b9a33170b693f354d11244"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NDkzMTkyOnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDSpan.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMjoyODozOVrOFvQX0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDoxNjo0MFrOFvfzBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA5NTYzMg==", "bodyText": "I guess this should stay here...it is decorating the current span with the relevant information from the map (attributes). I don't think it's the LogHandler's responsibility to do this.", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r385095632", "createdAt": "2020-02-27T12:28:39Z", "author": {"login": "mariusc83"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDSpan.java", "diffHunk": "@@ -238,9 +252,8 @@ public final DDSpan log(final Map<String, ?> map) {\n    */\n   @Override\n   public final DDSpan log(final long l, final Map<String, ?> map) {\n-    if (!extractError(map)) {\n-      log.debug(\"`log` method is not implemented. Doing nothing\");\n-    }\n+    extractError(map);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bdc8a27fe97b4d599ec346d8f3f3f96657a7abec"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTIzOTMyOA==", "bodyText": "My suggestion was to move this into the logHandler...  For that to work, you may need to pass DDSpan in as the first argument of each method.\nWhy don't you like that idea?", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r385239328", "createdAt": "2020-02-27T16:55:13Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDSpan.java", "diffHunk": "@@ -238,9 +252,8 @@ public final DDSpan log(final Map<String, ?> map) {\n    */\n   @Override\n   public final DDSpan log(final long l, final Map<String, ?> map) {\n-    if (!extractError(map)) {\n-      log.debug(\"`log` method is not implemented. Doing nothing\");\n-    }\n+    extractError(map);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA5NTYzMg=="}, "originalCommit": {"oid": "bdc8a27fe97b4d599ec346d8f3f3f96657a7abec"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI4ODAyNg==", "bodyText": "Because exactly that :D . Did no want to modify the arguments to pass the Span, but if you like it more like that I will pass it and handle it there ;)", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r385288026", "createdAt": "2020-02-27T18:21:49Z", "author": {"login": "mariusc83"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDSpan.java", "diffHunk": "@@ -238,9 +252,8 @@ public final DDSpan log(final Map<String, ?> map) {\n    */\n   @Override\n   public final DDSpan log(final long l, final Map<String, ?> map) {\n-    if (!extractError(map)) {\n-      log.debug(\"`log` method is not implemented. Doing nothing\");\n-    }\n+    extractError(map);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA5NTYzMg=="}, "originalCommit": {"oid": "bdc8a27fe97b4d599ec346d8f3f3f96657a7abec"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM0ODM1Nw==", "bodyText": "Alternatively, you could split up the logHandler and a factory that takes a span and returns the logHandler.", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r385348357", "createdAt": "2020-02-27T20:16:40Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDSpan.java", "diffHunk": "@@ -238,9 +252,8 @@ public final DDSpan log(final Map<String, ?> map) {\n    */\n   @Override\n   public final DDSpan log(final long l, final Map<String, ?> map) {\n-    if (!extractError(map)) {\n-      log.debug(\"`log` method is not implemented. Doing nothing\");\n-    }\n+    extractError(map);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA5NTYzMg=="}, "originalCommit": {"oid": "bdc8a27fe97b4d599ec346d8f3f3f96657a7abec"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NTg2NjU3OnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjo1NzozOFrOFvZPOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNjo1NzozOFrOFvZPOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI0MDg5MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  assert logHandler != null : \"LogHandler must not be null\";\n          \n          \n            \n                  this.logHandler = logHandler;\n          \n          \n            \n                  if(logHandler != null) {\n          \n          \n            \n                      this.logHandler = logHandler;\n          \n          \n            \n                  }\n          \n      \n    \n    \n  \n\nNow that I think about it, I think this is a better option...  Avoids the risk of harmful exceptions.", "url": "https://github.com/DataDog/dd-trace-java/pull/1225#discussion_r385240890", "createdAt": "2020-02-27T16:57:38Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "diffHunk": "@@ -670,6 +671,12 @@ public DDSpanBuilder withSpanType(final String spanType) {\n       return parent.baggageItems();\n     }\n \n+    public DDSpanBuilder withLogHandler(final LogHandler logHandler) {\n+      assert logHandler != null : \"LogHandler must not be null\";\n+      this.logHandler = logHandler;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f523ee26075d62577cad486b985923305dabd068"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 516, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}