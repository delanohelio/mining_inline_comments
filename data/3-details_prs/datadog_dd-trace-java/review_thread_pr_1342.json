{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MDY3NzE0", "number": 1342, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNTowMzo1N1rODrsA5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNTowMzo1N1rODrsA5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3MTM2NDg0OnYy", "diffSide": "RIGHT", "path": ".circleci/copy_artifact_s3.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNTowMzo1N1rOF8LTYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNjoyNzozMFrOF8PaKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY0NDA2NQ==", "bodyText": "Just checking that we want to completely overwrite this file everytime", "url": "https://github.com/DataDog/dd-trace-java/pull/1342#discussion_r398644065", "createdAt": "2020-03-26T15:03:57Z", "author": {"login": "devinsba"}, "path": ".circleci/copy_artifact_s3.py", "diffHunk": "@@ -0,0 +1,23 @@\n+import boto3\n+import re\n+import os\n+import tempfile\n+\n+LIBS_PATH = './workspace/dd-java-agent/build/libs'\n+p = re.compile(r\"dd-java-agent.*jar$\")\n+\n+S3_BUCKET_NAME = 'datadog-reliability-env'\n+client = boto3.client('s3', aws_access_key_id=os.getenv('AWS_ACCESS_KEY_ID'),aws_secret_access_key=os.getenv('AWS_SECRET_ACCESS_KEY'))\n+transfer = boto3.s3.transfer.S3Transfer(client)\n+\n+for path, sub_dirs, files in os.walk(LIBS_PATH):\n+    for name in files:\n+      if p.match(name):\n+        # Write the artifact to S3\n+        transfer.upload_file(os.path.join(path, name), S3_BUCKET_NAME, f'java/{name}')\n+        # write additional information used by the build\n+        with tempfile.NamedTemporaryFile(mode='w') as fp:\n+          for line in [os.getenv('CIRCLE_BRANCH'), os.getenv('CIRCLE_SHA1'), name, os.getenv('CIRCLE_USERNAME')]:\n+            fp.write(f'{line}\\n')\n+          fp.seek(0)\n+          transfer.upload_file(fp.name, S3_BUCKET_NAME, 'java/index.txt')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4083212814b3bf2b85aeeae6dbb821fc5f39c643"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcxMTMzNg==", "bodyText": "Yes I confirm, the purpose is to write the last version built with a set of information we want to propagate to the build", "url": "https://github.com/DataDog/dd-trace-java/pull/1342#discussion_r398711336", "createdAt": "2020-03-26T16:27:30Z", "author": {"login": "3as-DD"}, "path": ".circleci/copy_artifact_s3.py", "diffHunk": "@@ -0,0 +1,23 @@\n+import boto3\n+import re\n+import os\n+import tempfile\n+\n+LIBS_PATH = './workspace/dd-java-agent/build/libs'\n+p = re.compile(r\"dd-java-agent.*jar$\")\n+\n+S3_BUCKET_NAME = 'datadog-reliability-env'\n+client = boto3.client('s3', aws_access_key_id=os.getenv('AWS_ACCESS_KEY_ID'),aws_secret_access_key=os.getenv('AWS_SECRET_ACCESS_KEY'))\n+transfer = boto3.s3.transfer.S3Transfer(client)\n+\n+for path, sub_dirs, files in os.walk(LIBS_PATH):\n+    for name in files:\n+      if p.match(name):\n+        # Write the artifact to S3\n+        transfer.upload_file(os.path.join(path, name), S3_BUCKET_NAME, f'java/{name}')\n+        # write additional information used by the build\n+        with tempfile.NamedTemporaryFile(mode='w') as fp:\n+          for line in [os.getenv('CIRCLE_BRANCH'), os.getenv('CIRCLE_SHA1'), name, os.getenv('CIRCLE_USERNAME')]:\n+            fp.write(f'{line}\\n')\n+          fp.seek(0)\n+          transfer.upload_file(fp.name, S3_BUCKET_NAME, 'java/index.txt')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY0NDA2NQ=="}, "originalCommit": {"oid": "4083212814b3bf2b85aeeae6dbb821fc5f39c643"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 428, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}