{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NDMwMjk1", "number": 2180, "title": "Audit and cleanup ScopeManagerTest", "bodyText": "Cleanup ScopeManagerTests:\n\nRemove unnecessary casts\nSplitting tests that did too much\nRenaming tests/adding inline comments to when/then\nCleanup of when/then flows\nRemoving redundant tests\nRemoving unnecessary @Timeout\n\nI did uncover an issue.  See\n\n\"exception thrown in TraceInterceptor does not leave scope manager in bad state when reporting through PendingTraceBuffer\"\n\nI will fix that in a separate pull request.", "createdAt": "2020-12-09T20:01:33Z", "url": "https://github.com/DataDog/dd-trace-java/pull/2180", "merged": true, "mergeCommit": {"oid": "687c2fe8cd331977ae2e71f744f922ce23c5098a"}, "closed": true, "closedAt": "2020-12-10T16:22:11Z", "author": {"login": "randomanderson"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkkZccgFqTU0ODU2MTcxNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdk0cGgAFqTU0OTI2NTk0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NTYxNzE1", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#pullrequestreview-548561715", "createdAt": "2020-12-09T20:02:52Z", "commit": {"oid": "ff0bbd2f8d8237e0c5083c448ee79a699cc2e69d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMDowMjo1MlrOICnBfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMDowMjo1MlrOICnBfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTYwNzQyMg==", "bodyText": "This test was backwards with our current logic.  It only mostly passed because of the race between GC and PendingTraceBuffer", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#discussion_r539607422", "createdAt": "2020-12-09T20:02:52Z", "author": {"login": "randomanderson"}, "path": "dd-trace-core/src/test/groovy/datadog/trace/core/scopemanager/ScopeManagerTest.groovy", "diffHunk": "@@ -208,107 +219,97 @@ class ScopeManagerTest extends DDSpecification {\n     concurrent << [false, true]\n   }\n \n-  @Timeout(value = 60, unit = SECONDS)\n-  def \"hard reference on continuation prevents trace from reporting\"() {\n-    setup:\n+  def \"hard reference on continuation does not prevent trace from reporting\"() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ff0bbd2f8d8237e0c5083c448ee79a699cc2e69d"}, "originalPosition": 196}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NTYyMjU1", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#pullrequestreview-548562255", "createdAt": "2020-12-09T20:03:34Z", "commit": {"oid": "ff0bbd2f8d8237e0c5083c448ee79a699cc2e69d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMDowMzozNFrOICnDHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMDowMzozNFrOICnDHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTYwNzgzOQ==", "bodyText": "This test was redundant with the other continuation tests", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#discussion_r539607839", "createdAt": "2020-12-09T20:03:34Z", "author": {"login": "randomanderson"}, "path": "dd-trace-core/src/test/groovy/datadog/trace/core/scopemanager/ScopeManagerTest.groovy", "diffHunk": "@@ -361,36 +367,6 @@ class ScopeManagerTest extends DDSpecification {\n     concurrent << [false, true]\n   }\n \n-  def \"DDScope put in threadLocal after continuation activation\"() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ff0bbd2f8d8237e0c5083c448ee79a699cc2e69d"}, "originalPosition": 377}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NTYyODUw", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#pullrequestreview-548562850", "createdAt": "2020-12-09T20:04:22Z", "commit": {"oid": "ff0bbd2f8d8237e0c5083c448ee79a699cc2e69d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMDowNDoyM1rOICnFEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQyMDowNDoyM1rOICnFEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTYwODMzOA==", "bodyText": "This test had too many different assertions between noop and regular spans so I split it", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#discussion_r539608338", "createdAt": "2020-12-09T20:04:23Z", "author": {"login": "randomanderson"}, "path": "dd-trace-core/src/test/groovy/datadog/trace/core/scopemanager/ScopeManagerTest.groovy", "diffHunk": "@@ -112,45 +104,59 @@ class ScopeManagerTest extends DDSpecification {\n   }\n \n   def \"sets parent as current upon close\"() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ff0bbd2f8d8237e0c5083c448ee79a699cc2e69d"}, "originalPosition": 75}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff0bbd2f8d8237e0c5083c448ee79a699cc2e69d", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/ff0bbd2f8d8237e0c5083c448ee79a699cc2e69d", "committedDate": "2020-12-09T19:48:29Z", "message": "Audit and cleanup ScopeManagerTest"}, "afterCommit": {"oid": "dbeb904990c5120354dbcf85aaba8d2f9751f308", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/dbeb904990c5120354dbcf85aaba8d2f9751f308", "committedDate": "2020-12-09T20:37:27Z", "message": "Audit and cleanup ScopeManagerTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd1e42676384614e79ca73d328446fb4c42536d1", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/cd1e42676384614e79ca73d328446fb4c42536d1", "committedDate": "2020-12-09T20:57:24Z", "message": "Audit and cleanup ScopeManagerTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dbeb904990c5120354dbcf85aaba8d2f9751f308", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/dbeb904990c5120354dbcf85aaba8d2f9751f308", "committedDate": "2020-12-09T20:37:27Z", "message": "Audit and cleanup ScopeManagerTest"}, "afterCommit": {"oid": "cd1e42676384614e79ca73d328446fb4c42536d1", "author": {"user": {"login": "randomanderson", "name": "Laplie Anderson"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/cd1e42676384614e79ca73d328446fb4c42536d1", "committedDate": "2020-12-09T20:57:24Z", "message": "Audit and cleanup ScopeManagerTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NjI4OTEy", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#pullrequestreview-548628912", "createdAt": "2020-12-09T21:34:40Z", "commit": {"oid": "cd1e42676384614e79ca73d328446fb4c42536d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4ODkyMzg1", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#pullrequestreview-548892385", "createdAt": "2020-12-10T06:40:26Z", "commit": {"oid": "cd1e42676384614e79ca73d328446fb4c42536d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MjY1OTQz", "url": "https://github.com/DataDog/dd-trace-java/pull/2180#pullrequestreview-549265943", "createdAt": "2020-12-10T14:44:16Z", "commit": {"oid": "cd1e42676384614e79ca73d328446fb4c42536d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2726, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}