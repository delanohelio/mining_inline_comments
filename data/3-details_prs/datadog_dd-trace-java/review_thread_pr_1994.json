{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0MjM5NTY5", "number": 1994, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODozOToyOVrOEuIBGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0NDo0NFrOEuIISQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODAxMzA2OnYy", "diffSide": "RIGHT", "path": "dd-smoke-tests/opentracing/src/main/java/datadog/smoketest/opentracing/IncorrectSetupWithAgentApplication.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODozOToyOVrOHiVM4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODozOToyOVrOHiVM4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2MDk5NQ==", "bodyText": "Do you want to throw an assertion error after this in case it doesn't fail as expected?", "url": "https://github.com/DataDog/dd-trace-java/pull/1994#discussion_r505760995", "createdAt": "2020-10-15T18:39:29Z", "author": {"login": "tylerbenson"}, "path": "dd-smoke-tests/opentracing/src/main/java/datadog/smoketest/opentracing/IncorrectSetupWithAgentApplication.java", "diffHunk": "@@ -0,0 +1,17 @@\n+package datadog.smoketest.opentracing;\n+\n+import datadog.opentracing.DDTracer;\n+\n+public class IncorrectSetupWithAgentApplication {\n+  public static void main(final String[] args) {\n+    try {\n+      DDTracer.builder().build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5aa7ff1e07e897c332202614a42759a5722c985"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODAyNDE5OnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0MjozNFrOHiVUNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0MjozNFrOHiVUNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2Mjg3MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      \"Datadog Tracer already installed. NOTE: Manually creating the tracer while using the java agent is not supported\");\n          \n          \n            \n                      \"Datadog Tracer already installed by `dd-java-agent`. NOTE: Manually creating the tracer while using `dd-java-agent` is not supported\");", "url": "https://github.com/DataDog/dd-trace-java/pull/1994#discussion_r505762870", "createdAt": "2020-10-15T18:42:34Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "diffHunk": "@@ -197,6 +198,14 @@ private DDTracer(\n       final LogHandler logHandler,\n       final StatsDClient statsDClient) {\n \n+    // Check if the tracer is already installed by the agent\n+    // Unable to use \"instanceof\" because of class renaming\n+    if (GlobalTracer.get().getClass().getName().equals(\"datadog.trace.agent.core.CoreTracer\")) {\n+      log.warn(\n+          \"Datadog Tracer already installed. NOTE: Manually creating the tracer while using the java agent is not supported\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5aa7ff1e07e897c332202614a42759a5722c985"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODAyNjE2OnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0MzowM1rOHiVVjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0MzowM1rOHiVVjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2MzIxMw==", "bodyText": "Since we're throwing an exception, perhaps this should be\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  log.warn(\n          \n          \n            \n                  log.error(", "url": "https://github.com/DataDog/dd-trace-java/pull/1994#discussion_r505763213", "createdAt": "2020-10-15T18:43:03Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "diffHunk": "@@ -197,6 +198,14 @@ private DDTracer(\n       final LogHandler logHandler,\n       final StatsDClient statsDClient) {\n \n+    // Check if the tracer is already installed by the agent\n+    // Unable to use \"instanceof\" because of class renaming\n+    if (GlobalTracer.get().getClass().getName().equals(\"datadog.trace.agent.core.CoreTracer\")) {\n+      log.warn(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5aa7ff1e07e897c332202614a42759a5722c985"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODAzMDQ4OnYy", "diffSide": "RIGHT", "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0NDoyNFrOHiVYNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0NDoyNFrOHiVYNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2Mzg5NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  throw new RuntimeException(\"Datadog Tracer already installed\");\n          \n          \n            \n                  throw new IllegalStateException(\"Datadog Tracer already installed\");", "url": "https://github.com/DataDog/dd-trace-java/pull/1994#discussion_r505763895", "createdAt": "2020-10-15T18:44:24Z", "author": {"login": "tylerbenson"}, "path": "dd-trace-ot/src/main/java/datadog/opentracing/DDTracer.java", "diffHunk": "@@ -197,6 +198,14 @@ private DDTracer(\n       final LogHandler logHandler,\n       final StatsDClient statsDClient) {\n \n+    // Check if the tracer is already installed by the agent\n+    // Unable to use \"instanceof\" because of class renaming\n+    if (GlobalTracer.get().getClass().getName().equals(\"datadog.trace.agent.core.CoreTracer\")) {\n+      log.warn(\n+          \"Datadog Tracer already installed. NOTE: Manually creating the tracer while using the java agent is not supported\");\n+      throw new RuntimeException(\"Datadog Tracer already installed\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5aa7ff1e07e897c332202614a42759a5722c985"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2ODAzMTQ1OnYy", "diffSide": "RIGHT", "path": "dd-smoke-tests/opentracing/src/main/java/datadog/smoketest/opentracing/IncorrectSetupWithAgentApplication.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0NDo0NFrOHiVY1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0NDo0NFrOHiVY1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2NDA1Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                } catch (RuntimeException e) {\n          \n          \n            \n                } catch (IllegalStateException e) {", "url": "https://github.com/DataDog/dd-trace-java/pull/1994#discussion_r505764052", "createdAt": "2020-10-15T18:44:44Z", "author": {"login": "tylerbenson"}, "path": "dd-smoke-tests/opentracing/src/main/java/datadog/smoketest/opentracing/IncorrectSetupWithAgentApplication.java", "diffHunk": "@@ -0,0 +1,17 @@\n+package datadog.smoketest.opentracing;\n+\n+import datadog.opentracing.DDTracer;\n+\n+public class IncorrectSetupWithAgentApplication {\n+  public static void main(final String[] args) {\n+    try {\n+      DDTracer.builder().build();\n+    } catch (RuntimeException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5aa7ff1e07e897c332202614a42759a5722c985"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4716, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}