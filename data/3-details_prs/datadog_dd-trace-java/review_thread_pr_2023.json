{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4MzMxMDI4", "number": 2023, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDozMDoyMVrOEwy7fQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMDowNzo0MFrOEw7NhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NjAxNTMzOnYy", "diffSide": "RIGHT", "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/ExceptionHandlers.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNDozMDoyMVrOHmkvHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNTowNzo0NVrOHmmiOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwOTgyMA==", "bodyText": "Should this be a more interesting exit code than just 1?", "url": "https://github.com/DataDog/dd-trace-java/pull/2023#discussion_r510209820", "createdAt": "2020-10-22T14:30:21Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/ExceptionHandlers.java", "diffHunk": "@@ -70,9 +84,13 @@ public Size apply(final MethodVisitor mv, final Implementation.Context context)\n               mv.visitMethodInsn(\n                   Opcodes.INVOKEINTERFACE,\n                   LOGGER_NAME,\n-                  \"debug\",\n+                  logMethod,\n                   \"(Ljava/lang/String;Ljava/lang/Throwable;)V\",\n                   true);\n+              if (exitOnFailure) {\n+                mv.visitInsn(Opcodes.ICONST_1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76a6a847c702a16b2b6a1e4306066d16baa0f3c1"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIxMTk2MA==", "bodyText": "Have you anything special in mind? I picked 1 since it's defined as Catchall for general errors.", "url": "https://github.com/DataDog/dd-trace-java/pull/2023#discussion_r510211960", "createdAt": "2020-10-22T14:33:00Z", "author": {"login": "bantonsson"}, "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/ExceptionHandlers.java", "diffHunk": "@@ -70,9 +84,13 @@ public Size apply(final MethodVisitor mv, final Implementation.Context context)\n               mv.visitMethodInsn(\n                   Opcodes.INVOKEINTERFACE,\n                   LOGGER_NAME,\n-                  \"debug\",\n+                  logMethod,\n                   \"(Ljava/lang/String;Ljava/lang/Throwable;)V\",\n                   true);\n+              if (exitOnFailure) {\n+                mv.visitInsn(Opcodes.ICONST_1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwOTgyMA=="}, "originalCommit": {"oid": "76a6a847c702a16b2b6a1e4306066d16baa0f3c1"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIyMjU1NQ==", "bodyText": "Yeah, I understand.  I was just thinking if a program exits with code 1, it can be sometimes tricky to identify the cause.  That said, I don't have strong feelings about this either way.", "url": "https://github.com/DataDog/dd-trace-java/pull/2023#discussion_r510222555", "createdAt": "2020-10-22T14:46:15Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/ExceptionHandlers.java", "diffHunk": "@@ -70,9 +84,13 @@ public Size apply(final MethodVisitor mv, final Implementation.Context context)\n               mv.visitMethodInsn(\n                   Opcodes.INVOKEINTERFACE,\n                   LOGGER_NAME,\n-                  \"debug\",\n+                  logMethod,\n                   \"(Ljava/lang/String;Ljava/lang/Throwable;)V\",\n                   true);\n+              if (exitOnFailure) {\n+                mv.visitInsn(Opcodes.ICONST_1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwOTgyMA=="}, "originalCommit": {"oid": "76a6a847c702a16b2b6a1e4306066d16baa0f3c1"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIzOTI4OA==", "bodyText": "I'll leave it as 1 for now. It's just a means to forcefully fail someone else's test if we throw inside an advice.", "url": "https://github.com/DataDog/dd-trace-java/pull/2023#discussion_r510239288", "createdAt": "2020-10-22T15:07:45Z", "author": {"login": "bantonsson"}, "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/ExceptionHandlers.java", "diffHunk": "@@ -70,9 +84,13 @@ public Size apply(final MethodVisitor mv, final Implementation.Context context)\n               mv.visitMethodInsn(\n                   Opcodes.INVOKEINTERFACE,\n                   LOGGER_NAME,\n-                  \"debug\",\n+                  logMethod,\n                   \"(Ljava/lang/String;Ljava/lang/Throwable;)V\",\n                   true);\n+              if (exitOnFailure) {\n+                mv.visitInsn(Opcodes.ICONST_1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDIwOTgyMA=="}, "originalCommit": {"oid": "76a6a847c702a16b2b6a1e4306066d16baa0f3c1"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NzM3MjIxOnYy", "diffSide": "RIGHT", "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/ExceptionHandlers.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQyMDowNzo0MFrOHmx7mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QwNjozNToyN1rOHnAe7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQyNjAxMA==", "bodyText": "Where do you intend to enable this config?", "url": "https://github.com/DataDog/dd-trace-java/pull/2023#discussion_r510426010", "createdAt": "2020-10-22T20:07:40Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/ExceptionHandlers.java", "diffHunk": "@@ -33,13 +34,26 @@ public boolean isValid() {\n             public Size apply(final MethodVisitor mv, final Implementation.Context context) {\n               final String name = context.getInstrumentedType().getName();\n               final ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n+              final boolean exitOnFailure = Config.get().isInternalExitOnFailure();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6105285fec5f9bcb61c05f6f37fe5be72775e362"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY2NDQyOA==", "bodyText": "In the test harness of the other project that I'm testing, to make sure that the types of issues that I first missed while running the play tests will fail the test suite.", "url": "https://github.com/DataDog/dd-trace-java/pull/2023#discussion_r510664428", "createdAt": "2020-10-23T06:35:27Z", "author": {"login": "bantonsson"}, "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/bytebuddy/ExceptionHandlers.java", "diffHunk": "@@ -33,13 +34,26 @@ public boolean isValid() {\n             public Size apply(final MethodVisitor mv, final Implementation.Context context) {\n               final String name = context.getInstrumentedType().getName();\n               final ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n+              final boolean exitOnFailure = Config.get().isInternalExitOnFailure();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQyNjAxMA=="}, "originalCommit": {"oid": "6105285fec5f9bcb61c05f6f37fe5be72775e362"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4753, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}