{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NzI4NDYw", "number": 1192, "title": "Add support for Spring Scheduling", "bodyText": "These additions provide instrumentation for the Spring scheduling annotation. These changes will generate a trace for the annotated method.", "createdAt": "2020-01-27T22:07:57Z", "url": "https://github.com/DataDog/dd-trace-java/pull/1192", "merged": true, "mergeCommit": {"oid": "a81f4dc2231d2ae8c2ca900c77177ccb831fbe18"}, "closed": true, "closedAt": "2020-02-18T19:07:07Z", "author": {"login": "heathkd"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-k-_SgFqTM0OTAyOTA1MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcFlZ4yAFqTM2MDUzMzE3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5MDI5MDUx", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#pullrequestreview-349029051", "createdAt": "2020-01-27T22:46:05Z", "commit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMjo0NjowNVrOFiUHww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QyMzowMzoyNlrOFiUfXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyNTU3MQ==", "bodyText": "Need to add a compileOnly dependency to fix the build error.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r371525571", "createdAt": "2020-01-27T22:46:05Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling/spring-scheduling.gradle", "diffHunk": "@@ -0,0 +1,5 @@\n+apply from: \"${rootDir}/gradle/java.gradle\"\n+dependencies {\n+  testCompile group: 'org.springframework', name: 'spring-context', version: '5.2.3.RELEASE'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyNTc4Nw==", "bodyText": "Apply formatting.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r371525787", "createdAt": "2020-01-27T22:46:33Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-data-1.8/src/main/java/datadog/trace/instrumentation/springdata/SpringRepositoryInstrumentation.java", "diffHunk": "@@ -29,6 +18,18 @@\n import org.springframework.data.repository.core.support.RepositoryFactorySupport;\n import org.springframework.data.repository.core.support.RepositoryProxyPostProcessor;\n \n+import java.lang.reflect.Method;\n+import java.util.Collections;\n+import java.util.Map;\n+\n+import static datadog.trace.instrumentation.api.AgentTracer.activateSpan;\n+import static datadog.trace.instrumentation.api.AgentTracer.startSpan;\n+import static datadog.trace.instrumentation.springdata.SpringDataDecorator.DECORATOR;\n+import static net.bytebuddy.matcher.ElementMatchers.isConstructor;\n+import static net.bytebuddy.matcher.ElementMatchers.isInterface;\n+import static net.bytebuddy.matcher.ElementMatchers.named;\n+import static net.bytebuddy.matcher.ElementMatchers.not;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyNjExOQ==", "bodyText": "Need to add a muzzle check.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r371526119", "createdAt": "2020-01-27T22:47:24Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling/spring-scheduling.gradle", "diffHunk": "@@ -0,0 +1,5 @@\n+apply from: \"${rootDir}/gradle/java.gradle\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUyNjE5NQ==", "bodyText": "delete this.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r371526195", "createdAt": "2020-01-27T22:47:37Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling/src/main/java/datadog/trace/instrumentation/springscheduling/SpringSchedulingDecorator.java", "diffHunk": "@@ -0,0 +1,47 @@\n+// This file includes software developed at SignalFx", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUzMDgzOQ==", "bodyText": "Instead, use spanNameForClass.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r371530839", "createdAt": "2020-01-27T23:01:10Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling/src/main/java/datadog/trace/instrumentation/springscheduling/SpringSchedulingDecorator.java", "diffHunk": "@@ -0,0 +1,47 @@\n+// This file includes software developed at SignalFx\n+\n+package datadog.trace.instrumentation.springscheduling;\n+\n+import datadog.trace.agent.decorator.BaseDecorator;\n+import datadog.trace.api.DDTags;\n+import datadog.trace.instrumentation.api.AgentSpan;\n+import lombok.extern.slf4j.Slf4j;\n+import org.springframework.scheduling.support.ScheduledMethodRunnable;\n+\n+@Slf4j\n+public class SpringSchedulingDecorator extends BaseDecorator {\n+  public static final SpringSchedulingDecorator DECORATE = new SpringSchedulingDecorator();\n+\n+  private SpringSchedulingDecorator() {}\n+\n+  @Override\n+  protected String[] instrumentationNames() {\n+    return new String[] {\"spring-scheduling\"};\n+  }\n+\n+  @Override\n+  protected String spanType() {\n+    return null;\n+  }\n+\n+  @Override\n+  protected String component() {\n+    return \"spring-scheduling\";\n+  }\n+\n+  public AgentSpan onRun(final AgentSpan span, final Runnable runnable) {\n+    if (runnable != null) {\n+      String resourceName = \"\";\n+      if (runnable instanceof ScheduledMethodRunnable) {\n+        final ScheduledMethodRunnable scheduledMethodRunnable = (ScheduledMethodRunnable) runnable;\n+        resourceName = spanNameForMethod(scheduledMethodRunnable.getMethod());\n+      } else {\n+        final String className = runnable.getClass().getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUzMTE2Ng==", "bodyText": "To circle back, MethodInvokingRunnable is the legacy system that was deprecated in 3.0.  Probably not worth explicitly worrying about for now.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r371531166", "createdAt": "2020-01-27T23:02:09Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling/src/main/java/datadog/trace/instrumentation/springscheduling/SpringSchedulingDecorator.java", "diffHunk": "@@ -0,0 +1,47 @@\n+// This file includes software developed at SignalFx\n+\n+package datadog.trace.instrumentation.springscheduling;\n+\n+import datadog.trace.agent.decorator.BaseDecorator;\n+import datadog.trace.api.DDTags;\n+import datadog.trace.instrumentation.api.AgentSpan;\n+import lombok.extern.slf4j.Slf4j;\n+import org.springframework.scheduling.support.ScheduledMethodRunnable;\n+\n+@Slf4j\n+public class SpringSchedulingDecorator extends BaseDecorator {\n+  public static final SpringSchedulingDecorator DECORATE = new SpringSchedulingDecorator();\n+\n+  private SpringSchedulingDecorator() {}\n+\n+  @Override\n+  protected String[] instrumentationNames() {\n+    return new String[] {\"spring-scheduling\"};\n+  }\n+\n+  @Override\n+  protected String spanType() {\n+    return null;\n+  }\n+\n+  @Override\n+  protected String component() {\n+    return \"spring-scheduling\";\n+  }\n+\n+  public AgentSpan onRun(final AgentSpan span, final Runnable runnable) {\n+    if (runnable != null) {\n+      String resourceName = \"\";\n+      if (runnable instanceof ScheduledMethodRunnable) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUzMTMwNg==", "bodyText": "^^^ This can all be removed.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r371531306", "createdAt": "2020-01-27T23:02:38Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling/src/test/java/IntervalTask.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2012-2015 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// import datadog.trace.api.DDTags;\n+// import datadog.trace.instrumentation.api.AgentScope;\n+// import datadog.trace.instrumentation.api.AgentSpan;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUzMTYxMg==", "bodyText": "Version number needs to be updated.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r371531612", "createdAt": "2020-01-27T23:03:26Z", "author": {"login": "tylerbenson"}, "path": "settings.gradle", "diffHunk": "@@ -119,6 +119,7 @@ include ':dd-java-agent:instrumentation:servlet:request-3'\n include ':dd-java-agent:instrumentation:slf4j-mdc'\n include ':dd-java-agent:instrumentation:sparkjava-2.3'\n include ':dd-java-agent:instrumentation:spring-data-1.8'\n+include ':dd-java-agent:instrumentation:spring-scheduling'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e032d19408f7236f198c64036e506510b8edbedc", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/e032d19408f7236f198c64036e506510b8edbedc", "committedDate": "2020-01-27T21:12:10Z", "message": "rename classes and update composition of trace resource name"}, "afterCommit": {"oid": "8ec5d69e2af7d784decca91e1e7815c60be3f2e0", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/8ec5d69e2af7d784decca91e1e7815c60be3f2e0", "committedDate": "2020-01-30T20:28:16Z", "message": "address PR comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba7181702226e529e3f49fc6ee0807c35bdd3d33", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/ba7181702226e529e3f49fc6ee0807c35bdd3d33", "committedDate": "2020-02-01T22:14:08Z", "message": "change version of spring context library"}, "afterCommit": {"oid": "931ac63eca7416c0bb15b08134a12c5896ae2939", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/931ac63eca7416c0bb15b08134a12c5896ae2939", "committedDate": "2020-02-01T23:04:33Z", "message": "change version of spring context library"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "931ac63eca7416c0bb15b08134a12c5896ae2939", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/931ac63eca7416c0bb15b08134a12c5896ae2939", "committedDate": "2020-02-01T23:04:33Z", "message": "change version of spring context library"}, "afterCommit": {"oid": "ffc57fb07411c8b207049486571d65432fb1346d", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/ffc57fb07411c8b207049486571d65432fb1346d", "committedDate": "2020-02-03T21:46:13Z", "message": "increase spring-context version number to 3.2.3 so unit tests build"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMDk4NjA3", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#pullrequestreview-353098607", "createdAt": "2020-02-04T16:04:19Z", "commit": {"oid": "2574ab89a41031bc28bcb9f1529a74611689152f"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNjowNDoxOVrOFlZyoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNjowOTowN1rOFlZ-ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc2NDE5Mw==", "bodyText": "Do you know why 3.2.4 is the earliest release this works with?", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r374764193", "createdAt": "2020-02-04T16:04:19Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.4/spring-scheduling-3.2.4.gradle", "diffHunk": "@@ -0,0 +1,24 @@\n+muzzle {\n+  pass {\n+    group = 'org.springframework'\n+    module = 'spring-context'\n+    versions = \"[3.2.4.RELEASE,]\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2574ab89a41031bc28bcb9f1529a74611689152f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc2NDc2MA==", "bodyText": "This should be pinned to the latest version to support Java 7 with a comment to that effect.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r374764760", "createdAt": "2020-02-04T16:05:14Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.4/spring-scheduling-3.2.4.gradle", "diffHunk": "@@ -0,0 +1,24 @@\n+muzzle {\n+  pass {\n+    group = 'org.springframework'\n+    module = 'spring-context'\n+    versions = \"[3.2.4.RELEASE,]\"\n+    assertInverse = false\n+  }\n+}\n+\n+apply from: \"${rootDir}/gradle/java.gradle\"\n+\n+apply plugin: 'org.unbroken-dome.test-sets'\n+\n+testSets {\n+  latestDepTest {\n+    dirName = 'test'\n+  }\n+}\n+\n+dependencies {\n+  compileOnly group: 'org.springframework', name: 'spring-context', version: '3.2.4.RELEASE'\n+  testCompile group: 'org.springframework', name: 'spring-context', version: '3.2.4.RELEASE'\n+  latestDepTestCompile group: 'org.springframework', name: 'spring-context', version: '+'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2574ab89a41031bc28bcb9f1529a74611689152f"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc2NTg1NA==", "bodyText": "You shouldn't need this lock.  These tests will never run at the same time.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r374765854", "createdAt": "2020-02-04T16:06:58Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.4/src/test/groovy/SpringSchedulingTest.groovy", "diffHunk": "@@ -0,0 +1,71 @@\n+import datadog.trace.agent.test.AgentTestRunner\n+import datadog.trace.instrumentation.api.Tags\n+import org.springframework.context.annotation.AnnotationConfigApplicationContext\n+\n+import java.util.concurrent.locks.Lock\n+import java.util.concurrent.locks.ReentrantLock\n+\n+class SpringSchedulingTest extends AgentTestRunner {\n+\n+  Lock lock = new ReentrantLock()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2574ab89a41031bc28bcb9f1529a74611689152f"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc2Njg3Nw==", "bodyText": "This is introducing a race condition.  The trace you want to assert on may be generated on the other thread before this executes and will then get cleared.  Why are you trying to clear this?", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r374766877", "createdAt": "2020-02-04T16:08:38Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.4/src/test/groovy/SpringSchedulingTest.groovy", "diffHunk": "@@ -0,0 +1,71 @@\n+import datadog.trace.agent.test.AgentTestRunner\n+import datadog.trace.instrumentation.api.Tags\n+import org.springframework.context.annotation.AnnotationConfigApplicationContext\n+\n+import java.util.concurrent.locks.Lock\n+import java.util.concurrent.locks.ReentrantLock\n+\n+class SpringSchedulingTest extends AgentTestRunner {\n+\n+  Lock lock = new ReentrantLock()\n+\n+  def \"schedule interval test\"() {\n+    setup:\n+    def context = new AnnotationConfigApplicationContext(IntervalTaskConfig)\n+    def task = context.getBean(IntervalTask)\n+    \n+    lock.lock()\n+    TEST_WRITER.clear()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2574ab89a41031bc28bcb9f1529a74611689152f"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc2NzA4MA==", "bodyText": "Remove this.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r374767080", "createdAt": "2020-02-04T16:08:57Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.4/src/test/java/IntervalTask.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Copyright 2012-2015 the original author or authors.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2574ab89a41031bc28bcb9f1529a74611689152f"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc2NzIwNA==", "bodyText": "Remove this.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r374767204", "createdAt": "2020-02-04T16:09:07Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.4/src/test/java/TriggerTask.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Copyright 2012-2015 the original author or authors.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2574ab89a41031bc28bcb9f1529a74611689152f"}, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2574ab89a41031bc28bcb9f1529a74611689152f", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/2574ab89a41031bc28bcb9f1529a74611689152f", "committedDate": "2020-02-04T15:02:50Z", "message": "add lock around tests to prevent multiple thread access to TEST_WRITER"}, "afterCommit": {"oid": "3bb564b38f18ea6ff030d799af63f8425093df6a", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/3bb564b38f18ea6ff030d799af63f8425093df6a", "committedDate": "2020-02-06T00:14:34Z", "message": "remove locks and clearing of TEST_WRITER"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3bb564b38f18ea6ff030d799af63f8425093df6a", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/3bb564b38f18ea6ff030d799af63f8425093df6a", "committedDate": "2020-02-06T00:14:34Z", "message": "remove locks and clearing of TEST_WRITER"}, "afterCommit": {"oid": "fa388902489d3db95a54c36b437b6f3bdd331ac5", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/fa388902489d3db95a54c36b437b6f3bdd331ac5", "committedDate": "2020-02-06T00:39:20Z", "message": "remove locks and clearing of TEST_WRITER"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fa388902489d3db95a54c36b437b6f3bdd331ac5", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/fa388902489d3db95a54c36b437b6f3bdd331ac5", "committedDate": "2020-02-06T00:39:20Z", "message": "remove locks and clearing of TEST_WRITER"}, "afterCommit": {"oid": "ee31d33b7bf5ad67c77250a683f119306217147d", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/ee31d33b7bf5ad67c77250a683f119306217147d", "committedDate": "2020-02-07T16:00:43Z", "message": "update versions in gradle file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1MzQyNTg1", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#pullrequestreview-355342585", "createdAt": "2020-02-07T18:15:33Z", "commit": {"oid": "ee31d33b7bf5ad67c77250a683f119306217147d"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxODoxNTozM1rOFnFxog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QxODoxOTo1MVrOFnF5hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUzMzQxMA==", "bodyText": "make this 4.+", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r376533410", "createdAt": "2020-02-07T18:15:33Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.3/spring-scheduling-3.2.3.gradle", "diffHunk": "@@ -0,0 +1,26 @@\n+muzzle {\n+  pass {\n+    group = 'org.springframework'\n+    module = 'spring-context'\n+    versions = \"[3.2.3.RELEASE,]\"\n+    assertInverse = false\n+  }\n+}\n+\n+apply from: \"${rootDir}/gradle/java.gradle\"\n+\n+apply plugin: 'org.unbroken-dome.test-sets'\n+\n+testSets {\n+  latestDepTest {\n+    dirName = 'test'\n+  }\n+}\n+\n+dependencies {\n+  compileOnly group: 'org.springframework', name: 'spring-context', version: '3.2.3.RELEASE'\n+  testCompile group: 'org.springframework', name: 'spring-context', version: '3.2.3.RELEASE'\n+\n+  // this is the latest version that supports Java 7\n+  latestDepTestCompile group: 'org.springframework', name: 'spring-context', version: '4.3.26.RELEASE'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee31d33b7bf5ad67c77250a683f119306217147d"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUzMzk2NQ==", "bodyText": "true", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r376533965", "createdAt": "2020-02-07T18:16:46Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.3/spring-scheduling-3.2.3.gradle", "diffHunk": "@@ -0,0 +1,26 @@\n+muzzle {\n+  pass {\n+    group = 'org.springframework'\n+    module = 'spring-context'\n+    versions = \"[3.2.3.RELEASE,]\"\n+    assertInverse = false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee31d33b7bf5ad67c77250a683f119306217147d"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUzNDY1OQ==", "bodyText": "remove this.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r376534659", "createdAt": "2020-02-07T18:18:20Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.3/src/test/java/TriggerTask.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Copyright 2012-2015 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee31d33b7bf5ad67c77250a683f119306217147d"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUzNDgxNA==", "bodyText": "remove this.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r376534814", "createdAt": "2020-02-07T18:18:42Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.3/src/test/java/IntervalTask.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Copyright 2012-2015 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee31d33b7bf5ad67c77250a683f119306217147d"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUzNTQzMA==", "bodyText": "not really needed.", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#discussion_r376535430", "createdAt": "2020-02-07T18:19:51Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/instrumentation/spring-scheduling-3.2.3/src/test/java/TriggerTask.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Copyright 2012-2015 the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n+import org.springframework.scheduling.annotation.Scheduled;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class TriggerTask implements Runnable {\n+\n+  public TriggerTask() {\n+    System.out.println(\"in the ScheduledTasks constructor\");\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee31d33b7bf5ad67c77250a683f119306217147d"}, "originalPosition": 27}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0df9f530c85de9fed4c8e3ebf0a03c1552789519", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/0df9f530c85de9fed4c8e3ebf0a03c1552789519", "committedDate": "2020-02-14T18:46:18Z", "message": "change module and file names to match version of earliest supported version of spring-context"}, "afterCommit": {"oid": "39dbee7b37154863e7ac95d159bfb44b235cdf70", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/39dbee7b37154863e7ac95d159bfb44b235cdf70", "committedDate": "2020-02-14T18:50:10Z", "message": "change module and file names to match version of earliest supported version of spring-context"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "39dbee7b37154863e7ac95d159bfb44b235cdf70", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/39dbee7b37154863e7ac95d159bfb44b235cdf70", "committedDate": "2020-02-14T18:50:10Z", "message": "change module and file names to match version of earliest supported version of spring-context"}, "afterCommit": {"oid": "3de452b1879194462afc1e52c5fd2062978af84c", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/3de452b1879194462afc1e52c5fd2062978af84c", "committedDate": "2020-02-15T00:53:27Z", "message": "change imports to use bootstrap api package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68c323ac567a7762dd7e3431fc47aa0da7b3828a", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/68c323ac567a7762dd7e3431fc47aa0da7b3828a", "committedDate": "2020-02-15T01:46:00Z", "message": "create ScheduledTasks bean and application context config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc1aaf5fc5b9529d28876a26450e674a04c569af", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/cc1aaf5fc5b9529d28876a26450e674a04c569af", "committedDate": "2020-02-15T01:46:26Z", "message": "replace Trace annotation with regular API interaction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b21e36159182129ae8e9371652898b3e4f488834", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/b21e36159182129ae8e9371652898b3e4f488834", "committedDate": "2020-02-15T01:46:26Z", "message": "add test for interval task and trigger task"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb51248cd0281fed0cb6d7f655f93ec9c838781", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/9eb51248cd0281fed0cb6d7f655f93ec9c838781", "committedDate": "2020-02-15T01:47:16Z", "message": "address PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3537e16650ae83f73f97f47c7ae95404f86e3b5", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/f3537e16650ae83f73f97f47c7ae95404f86e3b5", "committedDate": "2020-02-15T01:47:16Z", "message": "change module and file names to match version of earliest supported version of spring-context"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "917deb19becdab0d3ef8192febf417d6995ee4d1", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/917deb19becdab0d3ef8192febf417d6995ee4d1", "committedDate": "2020-02-15T01:48:18Z", "message": "change imports to use bootstrap api package"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3de452b1879194462afc1e52c5fd2062978af84c", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/3de452b1879194462afc1e52c5fd2062978af84c", "committedDate": "2020-02-15T00:53:27Z", "message": "change imports to use bootstrap api package"}, "afterCommit": {"oid": "917deb19becdab0d3ef8192febf417d6995ee4d1", "author": {"user": {"login": "heathkd", "name": "Heather D'Souza"}}, "url": "https://github.com/DataDog/dd-trace-java/commit/917deb19becdab0d3ef8192febf417d6995ee4d1", "committedDate": "2020-02-15T01:48:18Z", "message": "change imports to use bootstrap api package"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNTMzMTcx", "url": "https://github.com/DataDog/dd-trace-java/pull/1192#pullrequestreview-360533171", "createdAt": "2020-02-18T17:30:28Z", "commit": {"oid": "917deb19becdab0d3ef8192febf417d6995ee4d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2687, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}