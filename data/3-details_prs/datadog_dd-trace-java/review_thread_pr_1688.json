{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5ODMzMTMy", "number": 1688, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjo0ODoyNFrOEPYEYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNjo0MDoyMFrOEQSKRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTU4NDMzOnYy", "diffSide": "RIGHT", "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/HelperInjector.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjo0ODoyNFrOGzDiUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjo0ODoyNFrOGzDiUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4ODQ5Nw==", "bodyText": "This is just more debug logging not really related to this change", "url": "https://github.com/DataDog/dd-trace-java/pull/1688#discussion_r456188497", "createdAt": "2020-07-17T02:48:24Z", "author": {"login": "lpriima"}, "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/HelperInjector.java", "diffHunk": "@@ -204,6 +204,9 @@ private static void deleteTempDir(final File file) {\n     final boolean deleted = file.delete();\n     if (!deleted) {\n       file.deleteOnExit();\n+      log.debug(\"file '{}' added to shutdown delete hook\", file);\n+    } else {\n+      log.debug(\"file '{}' deleted\", file);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f99c506149a301c7946457ceb9660bb44e256920"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTEwMjEzOnYy", "diffSide": "RIGHT", "path": "dd-java-agent/agent-tooling/src/test/groovy/datadog/trace/agent/test/ClassLoaderMatcherTest.groovy", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNjo0MDoyMFrOG0Wctg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjoyNjozOVrOG1MB1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0NjkzNA==", "bodyText": "I don't understand the point of this test.  Why would you want to assert the full name of these classes?", "url": "https://github.com/DataDog/dd-trace-java/pull/1688#discussion_r457546934", "createdAt": "2020-07-20T16:40:20Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-tooling/src/test/groovy/datadog/trace/agent/test/ClassLoaderMatcherTest.groovy", "diffHunk": "@@ -38,6 +40,12 @@ class ClassLoaderMatcherTest extends DDSpecification {\n     DatadogClassLoader.name == \"datadog.trace.bootstrap.DatadogClassLoader\"\n   }\n \n+  def \"helper class names are hardcoded in Log Instrumentations\"() {\n+    expect:\n+    LogContextScopeListener.name == \"datadog.trace.agent.tooling.log.LogContextScopeListener\"\n+    ThreadLocalWithDDTagsInitValue.name == \"datadog.trace.agent.tooling.log.ThreadLocalWithDDTagsInitValue\"\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7aa02256a8d9f60ce58f467ef2730a072eed27b1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMxNzMyOA==", "bodyText": "I would assume the purpose is to guard against automated refactoring changing the classes but not the class names hard coded in various places. i.e this test would fail if either of these classes were renamed.", "url": "https://github.com/DataDog/dd-trace-java/pull/1688#discussion_r458317328", "createdAt": "2020-07-21T18:52:50Z", "author": {"login": "richardstartin"}, "path": "dd-java-agent/agent-tooling/src/test/groovy/datadog/trace/agent/test/ClassLoaderMatcherTest.groovy", "diffHunk": "@@ -38,6 +40,12 @@ class ClassLoaderMatcherTest extends DDSpecification {\n     DatadogClassLoader.name == \"datadog.trace.bootstrap.DatadogClassLoader\"\n   }\n \n+  def \"helper class names are hardcoded in Log Instrumentations\"() {\n+    expect:\n+    LogContextScopeListener.name == \"datadog.trace.agent.tooling.log.LogContextScopeListener\"\n+    ThreadLocalWithDDTagsInitValue.name == \"datadog.trace.agent.tooling.log.ThreadLocalWithDDTagsInitValue\"\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0NjkzNA=="}, "originalCommit": {"oid": "7aa02256a8d9f60ce58f467ef2730a072eed27b1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM2NzE3Mg==", "bodyText": "I believe most refactoring tools would actually detect this usage and also update the string since it's a fully qualified class name.", "url": "https://github.com/DataDog/dd-trace-java/pull/1688#discussion_r458367172", "createdAt": "2020-07-21T20:26:42Z", "author": {"login": "tylerbenson"}, "path": "dd-java-agent/agent-tooling/src/test/groovy/datadog/trace/agent/test/ClassLoaderMatcherTest.groovy", "diffHunk": "@@ -38,6 +40,12 @@ class ClassLoaderMatcherTest extends DDSpecification {\n     DatadogClassLoader.name == \"datadog.trace.bootstrap.DatadogClassLoader\"\n   }\n \n+  def \"helper class names are hardcoded in Log Instrumentations\"() {\n+    expect:\n+    LogContextScopeListener.name == \"datadog.trace.agent.tooling.log.LogContextScopeListener\"\n+    ThreadLocalWithDDTagsInitValue.name == \"datadog.trace.agent.tooling.log.ThreadLocalWithDDTagsInitValue\"\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0NjkzNA=="}, "originalCommit": {"oid": "7aa02256a8d9f60ce58f467ef2730a072eed27b1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyNDc4OQ==", "bodyText": "Yes, this is for possible class renaming and it's temporary solution.\nBetter solution should be running tests with actual classpath restricted by this method:\nhttps://github.com/DataDog/dd-trace-java/pull/1688/files#diff-ddc855d905a56896d1c42dfd404e8541R50-R53", "url": "https://github.com/DataDog/dd-trace-java/pull/1688#discussion_r458424789", "createdAt": "2020-07-21T22:26:39Z", "author": {"login": "lpriima"}, "path": "dd-java-agent/agent-tooling/src/test/groovy/datadog/trace/agent/test/ClassLoaderMatcherTest.groovy", "diffHunk": "@@ -38,6 +40,12 @@ class ClassLoaderMatcherTest extends DDSpecification {\n     DatadogClassLoader.name == \"datadog.trace.bootstrap.DatadogClassLoader\"\n   }\n \n+  def \"helper class names are hardcoded in Log Instrumentations\"() {\n+    expect:\n+    LogContextScopeListener.name == \"datadog.trace.agent.tooling.log.LogContextScopeListener\"\n+    ThreadLocalWithDDTagsInitValue.name == \"datadog.trace.agent.tooling.log.ThreadLocalWithDDTagsInitValue\"\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU0NjkzNA=="}, "originalCommit": {"oid": "7aa02256a8d9f60ce58f467ef2730a072eed27b1"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 147, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}