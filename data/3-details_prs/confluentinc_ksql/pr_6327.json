{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1Njk4NTQy", "number": 6327, "title": "chore: ensure CLI works with other key formats", "bodyText": "Description\nfixes: #6218\nUpdates a few places in the rest api, cli and the new Java client to specify the key format as well as the value format.\nUnfortunately, the value format was called format.  This change introduces a keyFormat and valueFormat to hold the two formats, but both the CLI and new Java client are backwards compatible with the old JSON schema.\nAlso in this commit, streams also indicate if there key is windowed.  This means the key is serialized using the windowed serializer. It is possible to have a stream over a topic with a windowed key. Now the CLI and Java client expose this info.\nMain change was to show tables and show streams response.  Previously, these returned\nksql> show streams;\n\n Stream Name | Kafka Topic | Format\n---------------------------------------\n PAGEVIEWS   | pageviews   | DELIMITED\n---------------------------------------\n\nksql> show tables;\n\n Table Name | Kafka Topic | Format | Windowed\n----------------------------------------------\n USERS      | users       | JSON   | false\n----------------------------------------------\n\nAnd now return:\nksql> show streams;\n\n Stream Name | Kafka Topic | Key Format | Value Format | Windowed\n-----------------------------------------------------------------\n PAGEVIEWS   | pageviews   | KAFKA      | DELIMITED    | false\n-----------------------------------------------------------------\n\nksql> show tables;\n\n Table Name | Kafka Topic | Key Format | Value Format | Windowed\n----------------------------------------------------------------\n USERS      | users       | KAFKA      | JSON          | false\n----------------------------------------------------------------\n\nTesting done\nUsual + manually created streams and tables with non-KAFKA keys and ensured it all worked.\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-09-30T18:29:13Z", "url": "https://github.com/confluentinc/ksql/pull/6327", "merged": true, "mergeCommit": {"oid": "3fc838245033e0789e47e2fa348144ac088ef363"}, "closed": true, "closedAt": "2020-10-01T18:00:11Z", "author": {"login": "big-andy-coates"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOBFfwgH2gAyNDk1Njk4NTQyOjE5ZmY0MjcyYzdlMzAwOGMwMzY0ODg4MzMzYTI2ZGEwNzNkMmMyMDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOQtIUgH2gAyNDk1Njk4NTQyOmVmYjY2YzViOWY1NDM3ZGExNjJjMzUzMDVkNjc2YWUwYTBlYTAwNzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "19ff4272c7e3008c0364888333a26da073d2c203", "author": {"user": {"login": "big-andy-coates", "name": "Andy Coates"}}, "url": "https://github.com/confluentinc/ksql/commit/19ff4272c7e3008c0364888333a26da073d2c203", "committedDate": "2020-09-30T18:28:05Z", "message": "chore: ensure CLI works with other key formats\n\nfixes: https://github.com/confluentinc/ksql/issues/6218\n\nUpdates a few places in the rest api, cli and the new Java client to specify the key format as well as the value format.\n\nUnfortunately, the value format was called `format`.  This change introduces a `keyFormat` and `valueFormat` to hold the two formats, but both the CLI and new Java client are backwards compatible with the old JSON schema.\n\nAlso in this commit, streams also indicate if there key is windowed.  This means the key is serialized using the windowed serializer. It is possible to have a stream over a topic with a windowed key. Now the CLI and Java client expose this info.\n\nMain change was to `show tables` and `show streams` response.  Previously, these returned\n\n```\nksql> show streams;\n\n Stream Name | Kafka Topic | Format\n---------------------------------------\n PAGEVIEWS   | pageviews   | DELIMITED\n---------------------------------------\n\nksql> show tables;\n\n Table Name | Kafka Topic | Format | Windowed\n----------------------------------------------\n USERS      | users       | JSON   | false\n----------------------------------------------\n```\n\nAnd now return:\n\n```\nksql> show streams;\n\n Stream Name | Kafka Topic | Key Format | Value Format | Windowed\n-----------------------------------------------------------------\n PAGEVIEWS   | pageviews   | KAFKA      | DELIMITED    | false\n-----------------------------------------------------------------\n\nksql> show tables;\n\n Table Name | Kafka Topic | Key Format | Value Format | Windowed\n----------------------------------------------------------------\n USERS      | users       | KAFKA      | JSON          | false\n----------------------------------------------------------------\n```"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NzgyNzIx", "url": "https://github.com/confluentinc/ksql/pull/6327#pullrequestreview-499782721", "createdAt": "2020-09-30T20:23:28Z", "commit": {"oid": "19ff4272c7e3008c0364888333a26da073d2c203"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12d0728b23019c2878b0d8a9c11e8e5c770b74e2", "author": {"user": {"login": "big-andy-coates", "name": "Andy Coates"}}, "url": "https://github.com/confluentinc/ksql/commit/12d0728b23019c2878b0d8a9c11e8e5c770b74e2", "committedDate": "2020-10-01T09:13:30Z", "message": "chore: fix test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMjc4NDU5", "url": "https://github.com/confluentinc/ksql/pull/6327#pullrequestreview-500278459", "createdAt": "2020-10-01T12:08:32Z", "commit": {"oid": "12d0728b23019c2878b0d8a9c11e8e5c770b74e2"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxMjowODozMlrOHbHTgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxMjowODozN1rOHbHTsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE5MzI4Mg==", "bodyText": "This is a public API. Should we leave it here and mark as deprecated, to be removed in a future release?", "url": "https://github.com/confluentinc/ksql/pull/6327#discussion_r498193282", "createdAt": "2020-10-01T12:08:32Z", "author": {"login": "vcrfxia"}, "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/impl/StreamInfoImpl.java", "diffHunk": "@@ -41,8 +51,18 @@ public String getTopic() {\n   }\n \n   @Override\n-  public String getFormat() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "12d0728b23019c2878b0d8a9c11e8e5c770b74e2"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE5MzMyOA==", "bodyText": "As above.", "url": "https://github.com/confluentinc/ksql/pull/6327#discussion_r498193328", "createdAt": "2020-10-01T12:08:37Z", "author": {"login": "vcrfxia"}, "path": "ksqldb-api-client/src/main/java/io/confluent/ksql/api/client/impl/TableInfoImpl.java", "diffHunk": "@@ -48,13 +51,18 @@ public String getTopic() {\n   }\n \n   @Override\n-  public String getFormat() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "12d0728b23019c2878b0d8a9c11e8e5c770b74e2"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efb66c5b9f5437da162c35305d676ae0a0ea0075", "author": {"user": {"login": "big-andy-coates", "name": "Andy Coates"}}, "url": "https://github.com/confluentinc/ksql/commit/efb66c5b9f5437da162c35305d676ae0a0ea0075", "committedDate": "2020-10-01T12:39:57Z", "message": "chore: add back deprecated methods"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4612, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}