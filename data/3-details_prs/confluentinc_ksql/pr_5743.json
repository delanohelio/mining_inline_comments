{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMzcwMDUy", "number": 5743, "title": "fix: windowed tables now have cleanup policy compact+delete", "bodyText": "Description\nFixes #5554\nBREAKING CHANGE: ksqlDB now creates windowed tables with cleanup policy \"compact,delete\", rather than \"compact\". Also, topics that back streams are always created with cleanup policy \"delete\", rather than the broker default (by default, \"delete\").\nTesting done\nUnit tests + manual.\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-07-01T00:26:35Z", "url": "https://github.com/confluentinc/ksql/pull/5743", "merged": true, "mergeCommit": {"oid": "2038770633ccff02c4efd39a8feb5dccbf36839b"}, "closed": true, "closedAt": "2020-07-09T04:12:08Z", "author": {"login": "vcrfxia"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcweQxTgH2gAyNDQyMzcwMDUyOjBkNjU2MDEyZmE2N2UwMWM5NjlkYjRjYjZiNzMzNDEzNzgzMmUzNWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABczCrK5gH2gAyNDQyMzcwMDUyOmRmODMzNzE5NzQzZDIxZGUyMmUxODUzNjU4MGIyM2IwN2FhMmJmYmM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0d656012fa67e01c969db4cb6b7334137832e35c", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/0d656012fa67e01c969db4cb6b7334137832e35c", "committedDate": "2020-06-30T23:29:55Z", "message": "fix: windowed tables now have cleanup policy compact+delete"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMDAzOTQw", "url": "https://github.com/confluentinc/ksql/pull/5743#pullrequestreview-441003940", "createdAt": "2020-07-01T16:00:52Z", "commit": {"oid": "0d656012fa67e01c969db4cb6b7334137832e35c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNjowMDo1M1rOGrsFyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNjowMDo1M1rOGrsFyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ2NDMzMA==", "bodyText": "it seems that for create stream previously we were using the default for the cluster, but now we've changed that to explicitly specify delete. Is that correct/desired?", "url": "https://github.com/confluentinc/ksql/pull/5743#discussion_r448464330", "createdAt": "2020-07-01T16:00:53Z", "author": {"login": "agavra"}, "path": "ksqldb-engine/src/main/java/io/confluent/ksql/topic/TopicCreateInjector.java", "diffHunk": "@@ -175,13 +183,12 @@ public TopicCreateInjector(\n \n   private TopicProperties createTopic(\n       final Builder topicPropertiesBuilder,\n-      final boolean shouldCompactTopic\n+      final String topicCleanUpPolicy\n   ) {\n     final TopicProperties info = topicPropertiesBuilder.build();\n \n-    final Map<String, ?> config = shouldCompactTopic\n-        ? ImmutableMap.of(TopicConfig.CLEANUP_POLICY_CONFIG, TopicConfig.CLEANUP_POLICY_COMPACT)\n-        : Collections.emptyMap();\n+    final Map<String, ?> config =\n+        ImmutableMap.of(TopicConfig.CLEANUP_POLICY_CONFIG, topicCleanUpPolicy);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d656012fa67e01c969db4cb6b7334137832e35c"}, "originalPosition": 63}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5770306c711d3ea3cbef86c9aec169aaff9472e8", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/5770306c711d3ea3cbef86c9aec169aaff9472e8", "committedDate": "2020-07-06T17:27:12Z", "message": "fix: kafka topic client now properly handles compact delete"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ca1560a75dcfcb233bc3519d87f3d824c9c2c2a", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/7ca1560a75dcfcb233bc3519d87f3d824c9c2c2a", "committedDate": "2020-07-07T23:18:20Z", "message": "chore: use default instead of specifying delete"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df833719743d21de22e18536580b23b07aa2bfbc", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/df833719743d21de22e18536580b23b07aa2bfbc", "committedDate": "2020-07-08T23:03:11Z", "message": "Revert \"chore: use default instead of specifying delete\"\n\nThis reverts commit 7ca1560a75dcfcb233bc3519d87f3d824c9c2c2a."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 301, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}