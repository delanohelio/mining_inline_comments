{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMjY3NDg1", "number": 6709, "title": "fix: change locate() error message for a more user-friendly message", "bodyText": "Description\nWhat behavior do you want to change, why, how does your patch achieve the changes?\nFixes #6249\nAdd a better error message when the issue in #6249 is thrown.\nksql> CREATE TABLE MSG_COUNT WITH (KAFKA_TOPIC='MSG_COUNT', PARTITIONS=1, REPLICAS=1) AS SELECT\n  'X' X,\n  COUNT(*) MSG_CT\nFROM PAGEVIEWS PAGEVIEWS\nGROUP BY 'X'\nEMIT CHANGES;\n\nksql> SELECT * FROM MSG_COUNT WHERE X='X';\nMaterialized data for key ['X'] is not available yet. Please try again later.\n\nThere was another fix that retry the failing request here (#6633), but seems pull queries must fail fast. Instead, the user should be warned about the issue and let them know they need to retry.\nTesting done\nUni tests\nManually\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-12-02T20:20:30Z", "url": "https://github.com/confluentinc/ksql/pull/6709", "merged": true, "mergeCommit": {"oid": "e6ba436536a10678eb9cbafa150c3fd0501d31ab"}, "closed": true, "closedAt": "2020-12-03T04:58:23Z", "author": {"login": "spena"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiUYzNgH2gAyNTMxMjY3NDg1OjRiOTU3ZThhOTFiMWViYjk4MTA3MjFmNWU4N2M4NzIzNzRmYjQ5ZjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiXMD3gFqTU0MzMyNDk0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4b957e8a91b1ebb9810721f5e87c872374fb49f5", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/4b957e8a91b1ebb9810721f5e87c872374fb49f5", "committedDate": "2020-12-02T20:15:51Z", "message": "fix: change locate() error message for a more user-friendly message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjA2MjIy", "url": "https://github.com/confluentinc/ksql/pull/6709#pullrequestreview-543206222", "createdAt": "2020-12-02T20:21:49Z", "commit": {"oid": "4b957e8a91b1ebb9810721f5e87c872374fb49f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMDoyMTo0OVrOH9spHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQyMDoyMTo0OVrOH9spHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ1NjYwNg==", "bodyText": "I removed the state store %s because seems not useful for the user. The LOG will print it in the ksql.log debugging purposes.", "url": "https://github.com/confluentinc/ksql/pull/6709#discussion_r534456606", "createdAt": "2020-12-02T20:21:49Z", "author": {"login": "spena"}, "path": "ksqldb-streams/src/main/java/io/confluent/ksql/execution/streams/materialization/ks/KsLocator.java", "diffHunk": "@@ -89,10 +89,11 @@\n \n       // Fail fast if Streams not ready. Let client handle it\n       if (metadata == KeyQueryMetadata.NOT_AVAILABLE) {\n-        LOG.debug(\"KeyQueryMetadata not available for state store {} and key {}\",\n+        LOG.debug(\"KeyQueryMetadata not available for state store '{}' and key {}\",\n             stateStoreName, key);\n         throw new MaterializationException(String.format(\n-            \"KeyQueryMetadata not available for state store %s and key %s\", stateStoreName, key));\n+            \"Materialized data for key %s is not available yet. \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b957e8a91b1ebb9810721f5e87c872374fb49f5"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMzI0OTQ4", "url": "https://github.com/confluentinc/ksql/pull/6709#pullrequestreview-543324948", "createdAt": "2020-12-02T23:31:39Z", "commit": {"oid": "4b957e8a91b1ebb9810721f5e87c872374fb49f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4565, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}