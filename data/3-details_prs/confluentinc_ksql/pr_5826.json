{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5MTQ4NDAw", "number": 5826, "title": "chore: add validation to the metastore for create or replace", "bodyText": "Description\nThe next step in the CREATE OR REPLACE saga, this validates that the upgrades are compatible from a schema perspective. It does not yet implement the physical plan check to make sure that we allow the topology evolution.\nTesting done\nMore unit testing\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-07-14T22:40:11Z", "url": "https://github.com/confluentinc/ksql/pull/5826", "merged": true, "mergeCommit": {"oid": "b2dd772f15797c08684a0f09d51fbfb594dfb0fc"}, "closed": true, "closedAt": "2020-07-15T20:22:20Z", "author": {"login": "agavra"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc096UPgH2gAyNDQ5MTQ4NDAwOmZjZjhlNDc2ZjczMjMxMDQ4NmJjODEzZGI5MDZjZDFiNzMwOTdmYTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1P3HrgFqTQ0OTI2ODUxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fcf8e476f732310486bc813db906cd1b73097fa9", "author": {"user": {"login": "agavra", "name": "Almog Gavra"}}, "url": "https://github.com/confluentinc/ksql/commit/fcf8e476f732310486bc813db906cd1b73097fa9", "committedDate": "2020-07-14T22:38:03Z", "message": "chore: add validation to the metastore for create or replace"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NTE0Mzkz", "url": "https://github.com/confluentinc/ksql/pull/5826#pullrequestreview-448514393", "createdAt": "2020-07-14T22:40:37Z", "commit": {"oid": "fcf8e476f732310486bc813db906cd1b73097fa9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQyMjo0MDozN1rOGxn1ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQyMjo0MDozN1rOGxn1ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDY4NjA1Mg==", "bodyText": "this is just a minor refactor that will help me in the next PR, but since the next one is bigger figured I'd just add it here", "url": "https://github.com/confluentinc/ksql/pull/5826#discussion_r454686052", "createdAt": "2020-07-14T22:40:37Z", "author": {"login": "agavra"}, "path": "ksqldb-engine/src/main/java/io/confluent/ksql/engine/EngineExecutor.java", "diffHunk": "@@ -102,17 +102,20 @@ static EngineExecutor create(\n     return new EngineExecutor(engineContext, serviceContext, ksqlConfig, overriddenProperties);\n   }\n \n-  @SuppressWarnings(\"OptionalGetWithoutIsPresent\") // Known to be non-empty\n   ExecuteResult execute(final KsqlPlan plan) {\n-    final Optional<String> ddlResult = plan.getDdlCommand()\n-        .map(ddl -> executeDdl(ddl, plan.getStatementText(), plan.getQueryPlan().isPresent()));\n-\n-    final Optional<PersistentQueryMetadata> queryMetadata = plan.getQueryPlan()\n-        .map(qp -> executePersistentQuery(qp, plan.getStatementText()));\n+    if (!plan.getQueryPlan().isPresent()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcf8e476f732310486bc813db906cd1b73097fa9"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd12db768c06cb970a703d027b068519ef9a7d4a", "author": {"user": {"login": "agavra", "name": "Almog Gavra"}}, "url": "https://github.com/confluentinc/ksql/commit/cd12db768c06cb970a703d027b068519ef9a7d4a", "committedDate": "2020-07-15T00:04:27Z", "message": "chore: immutability fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5MjY4NTEw", "url": "https://github.com/confluentinc/ksql/pull/5826#pullrequestreview-449268510", "createdAt": "2020-07-15T19:32:51Z", "commit": {"oid": "cd12db768c06cb970a703d027b068519ef9a7d4a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4834, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}