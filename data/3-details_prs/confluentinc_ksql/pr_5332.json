{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2MjI1MjY1", "number": 5332, "title": "fix: Allow value delimiter to be specified for datagen", "bodyText": "Description\nFixes: #4481\nNow value delimiter can be specified when using datagen with delimited format.\nTesting done\nManually tested\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-05-11T16:57:10Z", "url": "https://github.com/confluentinc/ksql/pull/5332", "merged": true, "mergeCommit": {"oid": "865e834f9c075705cbe43515925943149e638984"}, "closed": true, "closedAt": "2020-05-13T12:07:15Z", "author": {"login": "purplefox"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgSxj4gFqTQwOTM2MTA0Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcg25nkABqjMzMzE1NDY1ODk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MzYxMDQ3", "url": "https://github.com/confluentinc/ksql/pull/5332#pullrequestreview-409361047", "createdAt": "2020-05-11T17:04:04Z", "commit": {"oid": "3e4ba59ae77306f54fc61165c64b6a389a54db74"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzowNDowNFrOGTlRdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzowNDowNFrOGTlRdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE4NjgwNw==", "bodyText": "A note: The config is already weird in that it uses both snake case and camel case for arg names :(\nSo I had to choose one. I chose camel case because more properties seem to use that than snake case.", "url": "https://github.com/confluentinc/ksql/pull/5332#discussion_r423186807", "createdAt": "2020-05-11T17:04:04Z", "author": {"login": "purplefox"}, "path": "ksqldb-examples/src/main/java/io/confluent/ksql/datagen/DataGen.java", "diffHunk": "@@ -229,7 +233,7 @@ private static void usage() {\n               .put(\"value-format\", (builder, arg) -> builder.valueFormat = parseFormat(arg))\n               // \"format\" is maintained for backwards compatibility, but should be removed later.\n               .put(\"format\", (builder, argVal) -> builder.valueFormat = parseFormat(argVal))\n-              .put(\"value_delimiter\",\n+              .put(\"valueDelimiter\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e4ba59ae77306f54fc61165c64b6a389a54db74"}, "originalPosition": 61}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NTU0MjI0", "url": "https://github.com/confluentinc/ksql/pull/5332#pullrequestreview-409554224", "createdAt": "2020-05-11T21:45:33Z", "commit": {"oid": "3e4ba59ae77306f54fc61165c64b6a389a54db74"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo0NTozM1rOGTuhmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMTo0NTozM1rOGTuhmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMzODM5NA==", "bodyText": "might want to check valueFormat is delimited before setting this, and throw an error if its not.", "url": "https://github.com/confluentinc/ksql/pull/5332#discussion_r423338394", "createdAt": "2020-05-11T21:45:33Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-examples/src/main/java/io/confluent/ksql/datagen/ProducerFactory.java", "diffHunk": "@@ -50,8 +54,13 @@ static DataGenProducer getProducer(\n     final SerializerFactory<Struct> keySerializerFactory =\n         keySerializerFactory(keyFormat, ksqlConfig, srClient);\n \n+    final Map<String, String> formatInfoProperties = new HashMap<>();\n+    if (valueDelimiter != null) {\n+      formatInfoProperties.put(DelimitedFormat.DELIMITER, valueDelimiter.toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e4ba59ae77306f54fc61165c64b6a389a54db74"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMDA1MTM0", "url": "https://github.com/confluentinc/ksql/pull/5332#pullrequestreview-410005134", "createdAt": "2020-05-12T12:49:16Z", "commit": {"oid": "81c36b19a86bb9cf1e6e720ef7f7aeac750a789d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjo0OToxN1rOGUE7oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxMjo0OToxN1rOGUE7oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzcwNTUwNQ==", "bodyText": "nite: consider moving this into the if block below that already checks valueDelimiter != null", "url": "https://github.com/confluentinc/ksql/pull/5332#discussion_r423705505", "createdAt": "2020-05-12T12:49:17Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-examples/src/main/java/io/confluent/ksql/datagen/ProducerFactory.java", "diffHunk": "@@ -50,8 +54,18 @@ static DataGenProducer getProducer(\n     final SerializerFactory<Struct> keySerializerFactory =\n         keySerializerFactory(keyFormat, ksqlConfig, srClient);\n \n+    if (valueDelimiter != null && !(valueFormat instanceof DelimitedFormat)) {\n+      throw new IllegalArgumentException(\n+          \"valueDelimiter can only be specified with delimited format\");\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81c36b19a86bb9cf1e6e720ef7f7aeac750a789d"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3de1fd06c11f7f800fddfacb6dd5d69aa2fcf12a", "author": {"user": {"login": "purplefox", "name": "Tim Fox"}}, "url": "https://github.com/confluentinc/ksql/commit/3de1fd06c11f7f800fddfacb6dd5d69aa2fcf12a", "committedDate": "2020-05-13T11:09:10Z", "message": "fix: Allow value delimiter to be specified for datagen"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3a75afb112d6f98021b6f4d991264e90a3274de9", "author": {"user": {"login": "purplefox", "name": "Tim Fox"}}, "url": "https://github.com/confluentinc/ksql/commit/3a75afb112d6f98021b6f4d991264e90a3274de9", "committedDate": "2020-05-12T14:14:24Z", "message": "tweak"}, "afterCommit": {"oid": "3de1fd06c11f7f800fddfacb6dd5d69aa2fcf12a", "author": {"user": {"login": "purplefox", "name": "Tim Fox"}}, "url": "https://github.com/confluentinc/ksql/commit/3de1fd06c11f7f800fddfacb6dd5d69aa2fcf12a", "committedDate": "2020-05-13T11:09:10Z", "message": "fix: Allow value delimiter to be specified for datagen"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4739, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}