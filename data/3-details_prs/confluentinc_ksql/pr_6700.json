{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwNjc0NDg1", "number": 6700, "title": "docs: docs for AVRO and JSON_SR keys", "bodyText": "Description\nDocs to accompany #6694\nTesting done\nDocs-only change.\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-12-02T01:16:46Z", "url": "https://github.com/confluentinc/ksql/pull/6700", "merged": true, "mergeCommit": {"oid": "06957b86714a2511414f06b05ae9850c29c674e6"}, "closed": true, "closedAt": "2020-12-04T17:20:59Z", "author": {"login": "vcrfxia"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiEEeTAH2gAyNTMwNjc0NDg1OjM5OTMxYTFhNmNjNDI1ZWIzODQyOWUxOThlYTgyYjA3YzQ2NzJlNTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiTdAEAH2gAyNTMwNjc0NDg1OmQyOWQ3ZTZiNjc5NjZkOWU5M2NkYzA3ZDBhZTRkYzc5M2JiYjhjYzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "39931a1a6cc425eb38429e198ea82b07c4672e53", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/39931a1a6cc425eb38429e198ea82b07c4672e53", "committedDate": "2020-12-02T01:15:10Z", "message": "docs: docs for AVRO and JSON_SR keys"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNDcxNjky", "url": "https://github.com/confluentinc/ksql/pull/6700#pullrequestreview-542471692", "createdAt": "2020-12-02T03:27:02Z", "commit": {"oid": "39931a1a6cc425eb38429e198ea82b07c4672e53"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwMzoyNzowM1rOH9I-BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwMzoyNzowM1rOH9I-BQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzg3MjEzMw==", "bodyText": "should we also mention FORMAT='AVRO'? I suspect this might be somewhat common", "url": "https://github.com/confluentinc/ksql/pull/6700#discussion_r533872133", "createdAt": "2020-12-02T03:27:03Z", "author": {"login": "agavra"}, "path": "docs/concepts/schemas.md", "diffHunk": "@@ -141,6 +136,27 @@ time the statement is first executed.\n \r\n #### With a key column\r\n \r\n+The following statement shows how to create a new `pageviews` stream by reading\r\n+from a {{ site.ak }} topic that has Avro-formatted key and message values.\r\n+\r\n+```sql\r\n+CREATE STREAM pageviews WITH (\r\n+    KAFKA_TOPIC='pageviews-avro-topic',\r\n+    KEY_FORMAT='AVRO',\r\n+    VALUE_FORMAT='AVRO'\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39931a1a6cc425eb38429e198ea82b07c4672e53"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDI0MjEy", "url": "https://github.com/confluentinc/ksql/pull/6700#pullrequestreview-543024212", "createdAt": "2020-12-02T16:37:44Z", "commit": {"oid": "39931a1a6cc425eb38429e198ea82b07c4672e53"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNjozNzo0NVrOH9j23A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNjozNzo0NVrOH9j23A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMjY2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If declaring a stream or table with a key format that is different from its\n          \n          \n            \n            If you're declaring a stream or table with a key format that's different from its", "url": "https://github.com/confluentinc/ksql/pull/6700#discussion_r534312668", "createdAt": "2020-12-02T16:37:45Z", "author": {"login": "JimGalasyn"}, "path": "docs/concepts/schemas.md", "diffHunk": "@@ -77,30 +77,25 @@ ksqlDB is [configured to use it](../operate-and-deploy/installation/server-confi\n \r\n Here's what you can do with schema inference in ksqlDB:\r\n \r\n--   Declare streams and tables on {{ site.ak }} topics with supported value formats by using \r\n-    `CREATE STREAM` and `CREATE TABLE` statements, without needing to declare the value columns.\r\n+-   Declare streams and tables on {{ site.ak }} topics with supported key and value formats by using \r\n+    `CREATE STREAM` and `CREATE TABLE` statements, without needing to declare the key and/or value columns.\r\n -   Declare derived views with `CREATE STREAM AS SELECT` and `CREATE TABLE AS SELECT` statements.\r\n     The schema of the view is registered in {{ site.sr }} automatically.\r\n -   Convert data to different formats with `CREATE STREAM AS SELECT` and\r\n     `CREATE TABLE AS SELECT` statements, by declaring the required output\r\n     format in the `WITH` clause. For example, you can convert a stream from\r\n     Avro to JSON.\r\n \r\n-Only the schema of the message *value* can be retrieved from {{ site.sr }}. Message\r\n-*keys* must be compatible with the [`KAFKA` format](../developer-guide/serialization.md#kafka)\r\n-to be accessible within ksqlDB. ksqlDB ignores schemas that have been registered\r\n-for message keys. \r\n-\r\n !!! note\r\n-    Message *keys* in Avro and Protobuf are not supported. If your message keys\r\n+    Message *keys* in Protobuf are not supported. If your message keys\r\n     are in an unsupported format, see [What to do if your key is not set or is in a different format](../developer-guide/syntax-reference.md#what-to-do-if-your-key-is-not-set-or-is-in-a-different-format). \r\n-    JSON message keys can be accessed by defining the key as a single `STRING` value, which will \r\n-    contain the JSON document.\r\n     \r\n-Although ksqlDB doesn't support loading the message key's schema from {{ site.sr }},\r\n-you can provide the key column definition within the `CREATE TABLE` or `CREATE STREAM`\r\n-statement, if the data records are compatible with ksqlDB. This is known as\r\n-_partial schema inference_, because the key schema is provided explicitly.\r\n+If declaring a stream or table with a key format that is different from its\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39931a1a6cc425eb38429e198ea82b07c4672e53"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDI0ODEx", "url": "https://github.com/confluentinc/ksql/pull/6700#pullrequestreview-543024811", "createdAt": "2020-12-02T16:38:21Z", "commit": {"oid": "39931a1a6cc425eb38429e198ea82b07c4672e53"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNjozODoyMVrOH9j4fQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNjozODoyMVrOH9j4fQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMzA4NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            from m {{ site.sr }}. This is known as _partial schema inference_. To infer value columns\n          \n          \n            \n            from {{ site.sr }}. This is known as _partial schema inference_. To infer value columns", "url": "https://github.com/confluentinc/ksql/pull/6700#discussion_r534313085", "createdAt": "2020-12-02T16:38:21Z", "author": {"login": "JimGalasyn"}, "path": "docs/concepts/schemas.md", "diffHunk": "@@ -77,30 +77,25 @@ ksqlDB is [configured to use it](../operate-and-deploy/installation/server-confi\n \r\n Here's what you can do with schema inference in ksqlDB:\r\n \r\n--   Declare streams and tables on {{ site.ak }} topics with supported value formats by using \r\n-    `CREATE STREAM` and `CREATE TABLE` statements, without needing to declare the value columns.\r\n+-   Declare streams and tables on {{ site.ak }} topics with supported key and value formats by using \r\n+    `CREATE STREAM` and `CREATE TABLE` statements, without needing to declare the key and/or value columns.\r\n -   Declare derived views with `CREATE STREAM AS SELECT` and `CREATE TABLE AS SELECT` statements.\r\n     The schema of the view is registered in {{ site.sr }} automatically.\r\n -   Convert data to different formats with `CREATE STREAM AS SELECT` and\r\n     `CREATE TABLE AS SELECT` statements, by declaring the required output\r\n     format in the `WITH` clause. For example, you can convert a stream from\r\n     Avro to JSON.\r\n \r\n-Only the schema of the message *value* can be retrieved from {{ site.sr }}. Message\r\n-*keys* must be compatible with the [`KAFKA` format](../developer-guide/serialization.md#kafka)\r\n-to be accessible within ksqlDB. ksqlDB ignores schemas that have been registered\r\n-for message keys. \r\n-\r\n !!! note\r\n-    Message *keys* in Avro and Protobuf are not supported. If your message keys\r\n+    Message *keys* in Protobuf are not supported. If your message keys\r\n     are in an unsupported format, see [What to do if your key is not set or is in a different format](../developer-guide/syntax-reference.md#what-to-do-if-your-key-is-not-set-or-is-in-a-different-format). \r\n-    JSON message keys can be accessed by defining the key as a single `STRING` value, which will \r\n-    contain the JSON document.\r\n     \r\n-Although ksqlDB doesn't support loading the message key's schema from {{ site.sr }},\r\n-you can provide the key column definition within the `CREATE TABLE` or `CREATE STREAM`\r\n-statement, if the data records are compatible with ksqlDB. This is known as\r\n-_partial schema inference_, because the key schema is provided explicitly.\r\n+If declaring a stream or table with a key format that is different from its\r\n+value format, and only one of the two formats supports schema inference,\r\n+you can explicitly provide the columns for the format that does not support schema inference\r\n+while still having ksqlDB load columns for the format that does support schema inference\r\n+from m {{ site.sr }}. This is known as _partial schema inference_. To infer value columns\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39931a1a6cc425eb38429e198ea82b07c4672e53"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDI2NTk3", "url": "https://github.com/confluentinc/ksql/pull/6700#pullrequestreview-543026597", "createdAt": "2020-12-02T16:40:10Z", "commit": {"oid": "39931a1a6cc425eb38429e198ea82b07c4672e53"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d29d7e6b67966d9e93cdc07d0ae4dc793bbb8cc1", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/d29d7e6b67966d9e93cdc07d0ae4dc793bbb8cc1", "committedDate": "2020-12-02T19:10:32Z", "message": "chore: feedback"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4562, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}