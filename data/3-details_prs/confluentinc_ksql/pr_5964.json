{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MjkzOTEw", "number": 5964, "title": "feat: Allow udfs to be provided via a new flag to KsqlTestingTool", "bodyText": "Description\nThe tool KsqlTestingTool allows you to run tests easily on the command line, but it does't currently allow the testing of UDFs, which are some of the things you'd want to test in such a scenario.\nThis PR adds a flag -e that allows you to point to an extensions directory where you can provide your own jar of udfs.\nFixes #5870\nTesting done\nAdded new tests for the flag.  Ran existing tests.\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-08-06T22:29:21Z", "url": "https://github.com/confluentinc/ksql/pull/5964", "merged": true, "mergeCommit": {"oid": "a85ef142bfd3202f9f4f0ddb09cb18e2fadee35a"}, "closed": true, "closedAt": "2020-08-07T20:26:29Z", "author": {"login": "AlanConfluent"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8XfoJAH2gAyNDY0MjkzOTEwOjZkNTkyZDRlNmE5YmQwMDNiMGE0MmE0NDM5ZjE4M2VhMzNhY2VjNjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8qMnkAFqTQ2MzUxNTk5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6d592d4e6a9bd003b0a42a4439f183ea33acec66", "author": {"user": {"login": "AlanConfluent", "name": "Alan Sheinberg"}}, "url": "https://github.com/confluentinc/ksql/commit/6d592d4e6a9bd003b0a42a4439f183ea33acec66", "committedDate": "2020-08-06T22:23:54Z", "message": "feat: Allow udfs to be provided via a new flag to KsqlTestingTool"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyOTI1NjY5", "url": "https://github.com/confluentinc/ksql/pull/5964#pullrequestreview-462925669", "createdAt": "2020-08-06T22:48:01Z", "commit": {"oid": "6d592d4e6a9bd003b0a42a4439f183ea33acec66"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMzg2MjUz", "url": "https://github.com/confluentinc/ksql/pull/5964#pullrequestreview-463386253", "createdAt": "2020-08-07T15:03:16Z", "commit": {"oid": "6d592d4e6a9bd003b0a42a4439f183ea33acec66"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxNTowMzoxNlrOG9dXJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxNTowNDoxOFrOG9dZQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA5NzM4Mw==", "bodyText": "Unrelated to your change, but noticed this class is in the production code, yet is clearly a test class.  Can we move it into the test directory please?\nthe functional testing module already depends on the engine's test jar.", "url": "https://github.com/confluentinc/ksql/pull/5964#discussion_r467097383", "createdAt": "2020-08-07T15:03:16Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-engine/src/main/java/io/confluent/ksql/function/UdfLoaderUtil.java", "diffHunk": "@@ -22,10 +22,11 @@\n public final class UdfLoaderUtil {\n   private UdfLoaderUtil() {}\n \n-  public static FunctionRegistry load(final MutableFunctionRegistry functionRegistry) {\n+  public static FunctionRegistry load(final MutableFunctionRegistry functionRegistry,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d592d4e6a9bd003b0a42a4439f183ea33acec66"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA5NzkyMA==", "bodyText": "Can we just inline this version?", "url": "https://github.com/confluentinc/ksql/pull/5964#discussion_r467097920", "createdAt": "2020-08-07T15:04:18Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-functional-tests/src/main/java/io/confluent/ksql/test/tools/TestExecutor.java", "diffHunk": "@@ -90,14 +94,18 @@\n   private final TopicInfoCache topicInfoCache;\n \n   public static TestExecutor create() {\n+    return create(Optional.empty());\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6d592d4e6a9bd003b0a42a4439f183ea33acec66"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b0fbd4552867fa8930427da17a8e164596ee7e2", "author": {"user": {"login": "AlanConfluent", "name": "Alan Sheinberg"}}, "url": "https://github.com/confluentinc/ksql/commit/7b0fbd4552867fa8930427da17a8e164596ee7e2", "committedDate": "2020-08-07T19:02:00Z", "message": "Inlines empty extension dir"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNTE1OTk5", "url": "https://github.com/confluentinc/ksql/pull/5964#pullrequestreview-463515999", "createdAt": "2020-08-07T18:23:20Z", "commit": {"oid": "6d592d4e6a9bd003b0a42a4439f183ea33acec66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODoyMzoyMFrOG9jp4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QxODoyMzoyMFrOG9jp4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIwMDQ4MQ==", "bodyText": "I tried moving it, but TestExecutor which references it, is itself in the main scope of ksqldb-functional-tests.  The existing dependency is I believe between the ksqldb-functional-tests test scope and the ksqldb-engine test scope.\nI think TestExecutor as well as possibly some other things under ksqldb-functional-tests/src/main/java/io/confluent/ksql/test (e.g. TestFunctionRegistry) would have to be moved to the testing scope -- unless there's a way to make the ksqldb-functional-tests main scope depend on ksqldb-engine test scope?  It's kind of a weird thing since even the main scope of ksqldb-functional-tests is related to testing ksql, but it's seemingly more tooling than unit tests.\nSo maybe things are actually in a reasonable place where they are? And if not, this refactoring seems like it would be bigger and belong in a followup.  I'm not going to block on it, but am curious about your thoughts.", "url": "https://github.com/confluentinc/ksql/pull/5964#discussion_r467200481", "createdAt": "2020-08-07T18:23:20Z", "author": {"login": "AlanConfluent"}, "path": "ksqldb-engine/src/main/java/io/confluent/ksql/function/UdfLoaderUtil.java", "diffHunk": "@@ -22,10 +22,11 @@\n public final class UdfLoaderUtil {\n   private UdfLoaderUtil() {}\n \n-  public static FunctionRegistry load(final MutableFunctionRegistry functionRegistry) {\n+  public static FunctionRegistry load(final MutableFunctionRegistry functionRegistry,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzA5NzM4Mw=="}, "originalCommit": {"oid": "6d592d4e6a9bd003b0a42a4439f183ea33acec66"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4794, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}