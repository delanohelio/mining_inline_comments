{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzMDEzNzE5", "number": 5757, "title": "chore: update KSQL metrics context labels", "bodyText": "Description\n\nlower case the resource type\nadds the following configs to ksqlConfig when initializing KSQL for either headless or interactive mode so that all components get the same base set of labels\n\nmetrics.context.resource.kafka.cluster.id\nmetrics.context.resource.type\nmetrics.context.resource.cluster.id\nmetrics.context.resource.version\nmetrics.context.resource.commit.id\n\nTesting done\nRechecking labels present in the staging URL for Druid\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-07-01T21:58:34Z", "url": "https://github.com/confluentinc/ksql/pull/5757", "merged": true, "mergeCommit": {"oid": "6edd20b9bff6d566fac8c8fd6b3fa89e8ad785ec"}, "closed": true, "closedAt": "2020-07-15T17:27:18Z", "author": {"login": "stevenpyzhang"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwyKb9AH2gAyNDQzMDEzNzE5OjdjN2VjZDE1ZDRlOTBkNGM2ZjIyZmQ2YzZhOGRlMDI2ZGU1NzMzYzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1Nlx7AFqTQ0OTEzNzk5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6", "committedDate": "2020-07-01T22:41:06Z", "message": "chore: update KSQL metrics context labels"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0c016b26d2d4c366e973b8b198618f9350116272", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/0c016b26d2d4c366e973b8b198618f9350116272", "committedDate": "2020-07-01T21:49:46Z", "message": "chore: update KSQL metrics context labels"}, "afterCommit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6", "committedDate": "2020-07-01T22:41:06Z", "message": "chore: update KSQL metrics context labels"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NzYzMDg4", "url": "https://github.com/confluentinc/ksql/pull/5757#pullrequestreview-446763088", "createdAt": "2020-07-11T00:57:01Z", "commit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwMDo1NzowMVrOGwJJrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwMDo1NzowMVrOGwJJrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEzNDc2Nw==", "bodyText": "if ksql.cluster.id and ksql.service.id are the same, why do we need both?", "url": "https://github.com/confluentinc/ksql/pull/5757#discussion_r453134767", "createdAt": "2020-07-11T00:57:01Z", "author": {"login": "xiaodongdu"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/metrics/MetricCollectors.java", "diffHunk": "@@ -143,22 +142,16 @@ public static void addConfigurableReporter(\n   }\n \n   public static Map<String, Object> addConfluentMetricsContextConfigs(\n-      final String ksqlServiceId\n+      final String ksqlServiceId,\n+      final String kafkaClusterId\n   ) {\n     final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_TYPE, KSQL_RESOURCE_TYPE);\n     updatedProps.put(RESOURCE_LABEL_CLUSTER_ID, ksqlServiceId);\n-    return updatedProps;\n-  }\n-\n-  public static Map<String, Object> addConfluentMetricsContextConfigsForKsql(\n-      final String ksqlServiceId\n-  ) {\n-    final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_KSQL_SERVICE_ID, ksqlServiceId);\n+    updatedProps.put(RESOURCE_LABEL_KAFKA_CLUSTER_ID, kafkaClusterId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6977a0c8051ea7bf1352715262dc7564c02a7d54", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/6977a0c8051ea7bf1352715262dc7564c02a7d54", "committedDate": "2020-07-14T00:38:06Z", "message": "remove cluster.id label"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "19bb22b6816cdef4f98c0e019e0b3047796f372b", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/19bb22b6816cdef4f98c0e019e0b3047796f372b", "committedDate": "2020-07-13T20:00:33Z", "message": "remove service.id from metrics context label"}, "afterCommit": {"oid": "6977a0c8051ea7bf1352715262dc7564c02a7d54", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/6977a0c8051ea7bf1352715262dc7564c02a7d54", "committedDate": "2020-07-14T00:38:06Z", "message": "remove cluster.id label"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a815fdb8b76636fca47c4048d483a40244311ca", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/4a815fdb8b76636fca47c4048d483a40244311ca", "committedDate": "2020-07-14T20:19:39Z", "message": "Revert \"remove cluster.id label\"\n\nThis reverts commit 6977a0c8051ea7bf1352715262dc7564c02a7d54."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f45cd3e6c66e028778f5ccf177830ef5cdca8cf8", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/f45cd3e6c66e028778f5ccf177830ef5cdca8cf8", "committedDate": "2020-07-14T22:04:21Z", "message": "use cluster.id instead of service.id for label"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5eb1d051afc8054517af1eb616dae999812a6bc2", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/5eb1d051afc8054517af1eb616dae999812a6bc2", "committedDate": "2020-07-14T20:20:33Z", "message": "use cluster.id instead of service.id for label"}, "afterCommit": {"oid": "f45cd3e6c66e028778f5ccf177830ef5cdca8cf8", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/f45cd3e6c66e028778f5ccf177830ef5cdca8cf8", "committedDate": "2020-07-14T22:04:21Z", "message": "use cluster.id instead of service.id for label"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5MTM3OTk4", "url": "https://github.com/confluentinc/ksql/pull/5757#pullrequestreview-449137998", "createdAt": "2020-07-15T16:54:06Z", "commit": {"oid": "f45cd3e6c66e028778f5ccf177830ef5cdca8cf8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 306, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}