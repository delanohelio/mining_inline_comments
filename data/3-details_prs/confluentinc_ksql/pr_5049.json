{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMDg2MTI4", "number": 5049, "title": "refactor: return single status based on aggregate results in state field", "bodyText": "Description\n#4875 changed the state field to return a string representation of all host query statuses. However, the C3 UI expects a single status in the state field and wouldn't be able to properly render multiple host query statuses right now.\nChanged getState in RunningQuery and QueryDescription classes to return a single status based on the aggregated query statuses.\nTesting done\nUnit Tests\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-04-10T22:06:29Z", "url": "https://github.com/confluentinc/ksql/pull/5049", "merged": true, "mergeCommit": {"oid": "11c6a3c3ad65cbe17874ec31d077c5c4a8041f87"}, "closed": true, "closedAt": "2020-04-15T20:16:05Z", "author": {"login": "stevenpyzhang"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXJlfRABqjMyMjYxODI0NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcX8fKegBqjMyMzY3NzI2MDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1756f1e24ca4fe324af7a6fbe316aaca2e5b6f9e", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/1756f1e24ca4fe324af7a6fbe316aaca2e5b6f9e", "committedDate": "2020-04-10T20:58:15Z", "message": "refactor: return aggregate status of query in state field"}, "afterCommit": {"oid": "874828ba0eba8edfb40f9acb7a974f51cc10a812", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/874828ba0eba8edfb40f9acb7a974f51cc10a812", "committedDate": "2020-04-13T06:57:15Z", "message": "refactor: return aggregate status of query in state field"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "874828ba0eba8edfb40f9acb7a974f51cc10a812", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/874828ba0eba8edfb40f9acb7a974f51cc10a812", "committedDate": "2020-04-13T06:57:15Z", "message": "refactor: return aggregate status of query in state field"}, "afterCommit": {"oid": "14b27464a8cbf046ab89bbc4019b9b3746dc5642", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/14b27464a8cbf046ab89bbc4019b9b3746dc5642", "committedDate": "2020-04-13T07:47:51Z", "message": "refactor: return aggregate status of query in state field"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTA5ODYz", "url": "https://github.com/confluentinc/ksql/pull/5049#pullrequestreview-392509863", "createdAt": "2020-04-13T23:40:31Z", "commit": {"oid": "14b27464a8cbf046ab89bbc4019b9b3746dc5642"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzo0MDozMVrOGE4-KA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QyMzo0MDozMVrOGE4-KA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc4MDkwNA==", "bodyText": "Aren't there other states like REBALANCING, PENDING_SHUTDOWN etc.?  Should we document our rationale for clubbing all non-error states as RUNNING?", "url": "https://github.com/confluentinc/ksql/pull/5049#discussion_r407780904", "createdAt": "2020-04-13T23:40:31Z", "author": {"login": "apurvam"}, "path": "ksqldb-rest-model/src/main/java/io/confluent/ksql/rest/entity/QueryDescription.java", "diffHunk": "@@ -116,7 +116,13 @@ public String getExecutionPlan() {\n   // kept for backwards compatibility\n   @JsonProperty(\"state\")\n   public Optional<String> getState() {\n-    return Optional.of(ksqlHostQueryStatus.toString());\n+    if (ksqlHostQueryStatus.isEmpty()) {\n+      return Optional.empty();\n+    }\n+\n+    return Optional.of(\n+        (ksqlHostQueryStatus.containsValue(KsqlQueryStatus.ERROR)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14b27464a8cbf046ab89bbc4019b9b3746dc5642"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzOTEzNzUz", "url": "https://github.com/confluentinc/ksql/pull/5049#pullrequestreview-393913753", "createdAt": "2020-04-15T15:57:15Z", "commit": {"oid": "14b27464a8cbf046ab89bbc4019b9b3746dc5642"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b54dee6bd876f11ca44085b67c926d066dbe2d47", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/b54dee6bd876f11ca44085b67c926d066dbe2d47", "committedDate": "2020-04-15T18:34:34Z", "message": "refactor: return aggregate status of query in state field"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "14b27464a8cbf046ab89bbc4019b9b3746dc5642", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/14b27464a8cbf046ab89bbc4019b9b3746dc5642", "committedDate": "2020-04-13T07:47:51Z", "message": "refactor: return aggregate status of query in state field"}, "afterCommit": {"oid": "b54dee6bd876f11ca44085b67c926d066dbe2d47", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/b54dee6bd876f11ca44085b67c926d066dbe2d47", "committedDate": "2020-04-15T18:34:34Z", "message": "refactor: return aggregate status of query in state field"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4828, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}