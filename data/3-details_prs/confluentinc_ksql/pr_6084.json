{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyNTc2MTg1", "number": 6084, "title": "feat: add serialization exceptions to processing logger", "bodyText": "Description\nFixes #5364\nTwo changes in this PR (corresponding to the first two commits):\n\nadd serialization exceptions to the processing log: currently deserialization exceptions are logged but serialization exceptions aren't\nthrow a more informative error message in the event that serialization exceptions are caused by UDFs with return types with non-optional schemas, since the error message from Connect (Struct schemas do not match.) isn't particularly actionable by users.\n\nTesting done\nAdded unit tests. Manual testing underway.\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-08-24T14:52:23Z", "url": "https://github.com/confluentinc/ksql/pull/6084", "merged": true, "mergeCommit": {"oid": "8ab98a5b5bee3335c2d791a7b9bcd5b2ccfd5736"}, "closed": true, "closedAt": "2020-08-25T14:36:16Z", "author": {"login": "vcrfxia"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCDqQKgH2gAyNDcyNTc2MTg1OmM3ZmE3M2M4ODA1MzhjNmEwZGFmODliZThkYmEyOTBhNjFjODMwYmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCW5vmAH2gAyNDcyNTc2MTg1OmNkZDQzY2U4YTBlMTU2MTMwZGY2YWQzYjhiZTJlOWUzMTI5NWNjMjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c7fa73c880538c6a0daf89be8dba290a61c830bf", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/c7fa73c880538c6a0daf89be8dba290a61c830bf", "committedDate": "2020-08-24T14:40:57Z", "message": "feat: add serialization exceptions to processing logger"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a421c3debf3a679155d64e2d727d7bb404b64102", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/a421c3debf3a679155d64e2d727d7bb404b64102", "committedDate": "2020-08-24T14:40:57Z", "message": "chore: more informative error on non-optional schema"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a1de0bdc6289b4ec7a6647dd82ae7f1936f3f75", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/8a1de0bdc6289b4ec7a6647dd82ae7f1936f3f75", "committedDate": "2020-08-24T15:52:23Z", "message": "test: fix test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNjM2MDE1", "url": "https://github.com/confluentinc/ksql/pull/6084#pullrequestreview-473636015", "createdAt": "2020-08-24T15:56:04Z", "commit": {"oid": "8a1de0bdc6289b4ec7a6647dd82ae7f1936f3f75"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06bf9198722352ae546ce2a1ae013cce1fccebed", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/06bf9198722352ae546ce2a1ae013cce1fccebed", "committedDate": "2020-08-24T19:01:27Z", "message": "fix: fix processing logger name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczOTc4ODQw", "url": "https://github.com/confluentinc/ksql/pull/6084#pullrequestreview-473978840", "createdAt": "2020-08-24T23:01:20Z", "commit": {"oid": "06bf9198722352ae546ce2a1ae013cce1fccebed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMzowMToyMFrOHF5HMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMzowMToyMFrOHF5HMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk0MDY1OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            :   The Kafka topic of the record for which deserialization failed.\n          \n          \n            \n            :   The {{ site.ak }} topic of the record for which deserialization failed.", "url": "https://github.com/confluentinc/ksql/pull/6084#discussion_r475940658", "createdAt": "2020-08-24T23:01:20Z", "author": {"login": "JimGalasyn"}, "path": "docs/developer-guide/test-and-debug/processing-log.md", "diffHunk": "@@ -130,6 +130,15 @@ message.deserializationError.recordB64 (STRING)\n \n :   The Kafka record, encoded in Base64.\n \n+message.deserializationError.cause (LIST<STRING>)\n+\n+:   A list of strings containing human-readable error messages\n+    for the chain of exceptions that caused the main error.\n+\n+message.deserializationError.topic (STRING)\n+\n+:   The Kafka topic of the record for which deserialization failed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06bf9198722352ae546ce2a1ae013cce1fccebed"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczOTc5OTI1", "url": "https://github.com/confluentinc/ksql/pull/6084#pullrequestreview-473979925", "createdAt": "2020-08-24T23:01:59Z", "commit": {"oid": "06bf9198722352ae546ce2a1ae013cce1fccebed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMzowMTo1OVrOHF5H4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQyMzowMTo1OVrOHF5H4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk0MDgzNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            :   The Kafka topic to which the ksqlDB row that failed to serialize\n          \n          \n            \n            :   The {{ site.ak }} topic to which the ksqlDB row that failed to serialize", "url": "https://github.com/confluentinc/ksql/pull/6084#discussion_r475940834", "createdAt": "2020-08-24T23:01:59Z", "author": {"login": "JimGalasyn"}, "path": "docs/developer-guide/test-and-debug/processing-log.md", "diffHunk": "@@ -155,6 +169,30 @@ message.productionError.errorMessage (STRING)\n \n :   A string containing a human-readable error message detailing the\n     error encountered.\n+    \n+message.serializationError (STRUCT)\n+\n+:   The contents of a message with type 3 (SERIALIZATION_ERROR).\n+    Logged when a serializer fails to serialize a ksqlDB row.\n+\n+message.serializationError.errorMessage (STRING)\n+\n+:   A string containing a human-readable error message detailing the\n+    error encountered.\n+\n+message.serializationError.record (STRING)\n+\n+:   The ksqlDB row, as a human-readable string.\n+\n+message.serializationError.cause (LIST<STRING>)\n+\n+:   A list of strings containing human-readable error messages\n+    for the chain of exceptions that caused the main error.\n+\n+message.serializationError.topic (STRING)\n+\n+:   The Kafka topic to which the ksqlDB row that failed to serialize", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "06bf9198722352ae546ce2a1ae013cce1fccebed"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczOTgwODg2", "url": "https://github.com/confluentinc/ksql/pull/6084#pullrequestreview-473980886", "createdAt": "2020-08-24T23:02:31Z", "commit": {"oid": "06bf9198722352ae546ce2a1ae013cce1fccebed"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdd43ce8a0e156130df6ad3b8be2e9e31295cc22", "author": {"user": {"login": "vcrfxia", "name": "Victoria Xia"}}, "url": "https://github.com/confluentinc/ksql/commit/cdd43ce8a0e156130df6ad3b8be2e9e31295cc22", "committedDate": "2020-08-25T13:06:04Z", "message": "docs: use Apache Kafka rather than Kafka"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4731, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}