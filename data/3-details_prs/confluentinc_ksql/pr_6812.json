{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzNzI2NTA3", "number": 6812, "title": "refactor: Tune Package Relationship", "bodyText": "Remove (package) dependency on rest-utils as its not needed.\nAdd Virtual Package \"Provides\" to \"provide\" community-ksqldb release.\nConditinalize RPM_VERSION setting.\n\nDescription\nWith respect to KSQLDB and independent releases and OS packages, these changes are required in order to:\n\nAllow the ksqldb OS package to be \"independent\" of any other confluent-* packages\nSupport building CP-versioned packages with a community-ksqldb \"Virtual\" package that \"provides\" said KSQLDB community version  (Other names may be suggested)\n\nTesting done\nYou will have to take my word for it, but you can build these artifacts as follows:\nDEB:\ngit checkout -b debian-0.14.0-ksqldb origin/0.14.0-ksqldb\ndch --newversion \"6.1.0-0.ksqldb0.14.0\" \"Release version 6.1.0-0.ksqldb0.14.0\"\ndch --release --distribution unstable \"\"\ngit commit ...\ngbp buildpackage -us -uc --git-debian-branch=\"debian-0.14.0-ksqldb\" --git-upstream-tree=0.14.0-ksqldb --git-builder=\"debuild --set-envvar=VERSION=0.14.0  -i -I\"\n\nRPM:\nmake RPM_VERSION=6.1.0 VERSION=0.14.0 PACKAGE_TYPE=rpm REVISION=ksqldb -f debian/Makefile rpm\n\nArchive:\nmake VERSION=0.14.0 PACKAGE_TYPE=archive -f debian/Makefile archive\n\nThese commands made these artifacts (in a container):\nconfluent-ksqldb_6.1.0-0.ksqldb0.14.0.debian.tar.xz  confluent-ksqldb_6.1.0-0.ksqldb0.14.0_amd64.build\t    confluent-ksqldb_6.1.0.orig.tar.gz\nconfluent-ksqldb_6.1.0-0.ksqldb0.14.0.dsc\t     confluent-ksqldb_6.1.0-0.ksqldb0.14.0_amd64.buildinfo  ksql\nconfluent-ksqldb_6.1.0-0.ksqldb0.14.0_all.deb\t     confluent-ksqldb_6.1.0-0.ksqldb0.14.0_amd64.changes\nroot@12821d6b1502:/tmp/confluent/ksql# ls /tmp/\napt.conf.ak6yjx  confluent  confluent-ksqldb-0.14.0.tar.gz  confluent-ksqldb-0.14.0.zip  confluent-ksqldb-6.1.0-0.ksqldb.0.14.0.noarch.rpm\n\nThese changes have also been tested in the packaging job here: confluentinc/packaging#871 A green build there indicates that the packaging job was successful in building everything.\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-12-21T21:12:46Z", "url": "https://github.com/confluentinc/ksql/pull/6812", "merged": true, "mergeCommit": {"oid": "57bc25591c2b32d9510fcb4997b4c1d07ff0a5fb"}, "closed": true, "closedAt": "2021-01-06T22:07:36Z", "author": {"login": "andrewegel"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABds5pIUgFqTU2MTE5OTk0Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdtlRYbABqjQxNzY4NDYxNjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxMTk5OTQ3", "url": "https://github.com/confluentinc/ksql/pull/6812#pullrequestreview-561199947", "createdAt": "2021-01-04T17:19:24Z", "commit": {"oid": "420b467941c03636c14f55f8854042993552b651"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxNzoxOToyNFrOIN6GOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxNzoxOToyNFrOIN6GOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTQ1NDI2Ng==", "bodyText": "previously, the release process didn't include bumping anything in these files - at a minimum, we should add this as a manual step to the release wiki but that is of course always error prone (as people tend to miss manual steps). Is there any way to either automate this or have an automatic verification that we're not producing duplicate packages? (Or if this is in your plans and this is just something incremental, that is OK as well)", "url": "https://github.com/confluentinc/ksql/pull/6812#discussion_r551454266", "createdAt": "2021-01-04T17:19:24Z", "author": {"login": "agavra"}, "path": "debian/confluent-ksqldb.spec.in", "diffHunk": "@@ -11,8 +11,7 @@ Vendor: Confluent, Inc.\n Packager: Confluent Packaging <packages@confluent.io>\n BuildArch: noarch\n \n-Requires: confluent-rest-utils\n-\n+Provides: community-ksqldb = 0.14.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "420b467941c03636c14f55f8854042993552b651"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxMjMxOTM4", "url": "https://github.com/confluentinc/ksql/pull/6812#pullrequestreview-561231938", "createdAt": "2021-01-04T18:08:42Z", "commit": {"oid": "420b467941c03636c14f55f8854042993552b651"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "420b467941c03636c14f55f8854042993552b651", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/420b467941c03636c14f55f8854042993552b651", "committedDate": "2020-12-18T17:54:20Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting."}, "afterCommit": {"oid": "db2e2bbc1160f023bcf80793fb1c565f5718385d", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/db2e2bbc1160f023bcf80793fb1c565f5718385d", "committedDate": "2021-01-04T22:30:28Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "db2e2bbc1160f023bcf80793fb1c565f5718385d", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/db2e2bbc1160f023bcf80793fb1c565f5718385d", "committedDate": "2021-01-04T22:30:28Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting."}, "afterCommit": {"oid": "c3ba03972cb425097413a16c0f6b520dd368c138", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/c3ba03972cb425097413a16c0f6b520dd368c138", "committedDate": "2021-01-05T17:24:09Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting.\n- Fix VERSION default value: Use maven helpers to query project version."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3ba03972cb425097413a16c0f6b520dd368c138", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/c3ba03972cb425097413a16c0f6b520dd368c138", "committedDate": "2021-01-05T17:24:09Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting.\n- Fix VERSION default value: Use maven helpers to query project version."}, "afterCommit": {"oid": "8e4043b273fe2f56f4c637756543a807daaa90ab", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/8e4043b273fe2f56f4c637756543a807daaa90ab", "committedDate": "2021-01-06T03:57:52Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting.\n- Fix VERSION default value: Use maven helpers to query project version."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyOTQ4OTUw", "url": "https://github.com/confluentinc/ksql/pull/6812#pullrequestreview-562948950", "createdAt": "2021-01-06T18:35:22Z", "commit": {"oid": "8e4043b273fe2f56f4c637756543a807daaa90ab"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxODozNToyMlrOIPR4Vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxODozNToyMlrOIPR4Vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjg5MjUwMw==", "bodyText": "out of curiosity why are we touching these files?", "url": "https://github.com/confluentinc/ksql/pull/6812#discussion_r552892503", "createdAt": "2021-01-06T18:35:22Z", "author": {"login": "agavra"}, "path": "debian/Makefile", "diffHunk": "@@ -51,13 +52,15 @@ ifeq ($(APPLY_PATCHES),yes)\n \tgit reset --hard HEAD\n \tcat debian/patches/series | xargs -iPATCH bash -c 'patch -p1 < debian/patches/PATCH'\n endif\n+\ttouch apply-patches", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e4043b273fe2f56f4c637756543a807daaa90ab"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8acfa9ee8a1839a9d60737781235f40394b1e87f", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/8acfa9ee8a1839a9d60737781235f40394b1e87f", "committedDate": "2021-01-06T20:07:21Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting.\n- Fix VERSION default value: Use maven helpers to query project version.\n- Add touch <target> in build and apply-patches for incremental build\nsupport (otherwise we'd have to rebuild ksql for every package type).\nAlso cleaned this up in the clean target"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8e4043b273fe2f56f4c637756543a807daaa90ab", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/8e4043b273fe2f56f4c637756543a807daaa90ab", "committedDate": "2021-01-06T03:57:52Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting.\n- Fix VERSION default value: Use maven helpers to query project version."}, "afterCommit": {"oid": "8acfa9ee8a1839a9d60737781235f40394b1e87f", "author": {"user": {"login": "andrewegel", "name": "Ego"}}, "url": "https://github.com/confluentinc/ksql/commit/8acfa9ee8a1839a9d60737781235f40394b1e87f", "committedDate": "2021-01-06T20:07:21Z", "message": "refactor: Tune Package Relationship\n\n- Remove dependency on rest-utils as its not needed.\n- Add Virtual Package \"Provides\" to \"provide\" comminuty-ksqldb release.\n- Conditinalize RPM_VERSION setting.\n- Fix VERSION default value: Use maven helpers to query project version.\n- Add touch <target> in build and apply-patches for incremental build\nsupport (otherwise we'd have to rebuild ksql for every package type).\nAlso cleaned this up in the clean target"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4536, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}