{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2NDczMDU4", "number": 4371, "title": "fix: delimiters reset across non-delimited types (reverts #4366)", "bodyText": "Description\nReverting #4366 and instead preventing delimiters from being piped through across non-delimited formats (see #4368 for an alternative solution) after discussing with @big-andy-coates.\nTesting done\n\nUpdated the unit tests (kept the QTT tests testing the converting from DELIMITED->JSON/AVRO)\n\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-01-23T17:13:43Z", "url": "https://github.com/confluentinc/ksql/pull/4371", "merged": true, "mergeCommit": {"oid": "578872946530d1ef63fc4a726b4de96141858c1e"}, "closed": true, "closedAt": "2020-01-24T00:38:57Z", "author": {"login": "agavra"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9Nli0gFqTM0NzQ2ODg5MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9T8exAH2gAyMzY2NDczMDU4Ojc4MTAxODVjNmUxOWRiNTVjMDExYzE2MzEyMDE1ZTBjNTM0N2IxM2U=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3NDY4ODkx", "url": "https://github.com/confluentinc/ksql/pull/4371#pullrequestreview-347468891", "createdAt": "2020-01-23T17:14:05Z", "commit": {"oid": "fd29e4fab6c5a712c157559229dfee301b03df3c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNzoxNDowNVrOFhGIhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNzoxNDowNVrOFhGIhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI0NzgxNA==", "bodyText": "I added this so that I can get a green build - will remove before merging (separate PR to fix this - see #4373)", "url": "https://github.com/confluentinc/ksql/pull/4371#discussion_r370247814", "createdAt": "2020-01-23T17:14:05Z", "author": {"login": "agavra"}, "path": "ksql-engine/src/test/java/io/confluent/ksql/integration/SecureIntegrationTest.java", "diffHunk": "@@ -153,6 +152,7 @@ public void after() {\n     }\n   }\n \n+  @SuppressWarnings(\"deprecation\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd29e4fab6c5a712c157559229dfee301b03df3c"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b537f708bbb64e2c264203e2e44d5313d2064c4d", "author": {"user": {"login": "agavra", "name": "Almog Gavra"}}, "url": "https://github.com/confluentinc/ksql/commit/b537f708bbb64e2c264203e2e44d5313d2064c4d", "committedDate": "2020-01-23T18:16:10Z", "message": "fix: delimiters reset across non-delimited types (reverts #4366)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd29e4fab6c5a712c157559229dfee301b03df3c", "author": {"user": {"login": "agavra", "name": "Almog Gavra"}}, "url": "https://github.com/confluentinc/ksql/commit/fd29e4fab6c5a712c157559229dfee301b03df3c", "committedDate": "2020-01-23T17:03:44Z", "message": "fix: delimiters reset across non-delimited types (reverts #4368)"}, "afterCommit": {"oid": "b537f708bbb64e2c264203e2e44d5313d2064c4d", "author": {"user": {"login": "agavra", "name": "Almog Gavra"}}, "url": "https://github.com/confluentinc/ksql/commit/b537f708bbb64e2c264203e2e44d5313d2064c4d", "committedDate": "2020-01-23T18:16:10Z", "message": "fix: delimiters reset across non-delimited types (reverts #4366)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3Njk3NDU3", "url": "https://github.com/confluentinc/ksql/pull/4371#pullrequestreview-347697457", "createdAt": "2020-01-24T00:36:59Z", "commit": {"oid": "b537f708bbb64e2c264203e2e44d5313d2064c4d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwMDozNjo1OVrOFhRDBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwMDozNjo1OVrOFhRDBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQyNjYyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // will use the default limiter, as opposed to |)\n          \n          \n            \n                    // will use the default delimiter, as opposed to |)\n          \n      \n    \n    \n  \n\nnit: typo", "url": "https://github.com/confluentinc/ksql/pull/4371#discussion_r370426629", "createdAt": "2020-01-24T00:36:59Z", "author": {"login": "vcrfxia"}, "path": "ksql-engine/src/main/java/io/confluent/ksql/analyzer/Analyzer.java", "diffHunk": "@@ -258,6 +258,16 @@ private Format getValueFormat(final Sink sink) {\n     }\n \n     private Optional<Delimiter> getValueDelimiter(final Sink sink) {\n+      if (getValueFormat(sink) != Format.DELIMITED) {\n+        // the delimiter is not inherited across non-delimited types\n+        // (e.g. if source A is DELIMITED with |, and I create sink B\n+        // with JSON from A and then sink C with DELIMITED from B, C\n+        // will use the default limiter, as opposed to |)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b537f708bbb64e2c264203e2e44d5313d2064c4d"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7810185c6e19db55c011c16312015e0c5347b13e", "author": {"user": {"login": "agavra", "name": "Almog Gavra"}}, "url": "https://github.com/confluentinc/ksql/commit/7810185c6e19db55c011c16312015e0c5347b13e", "committedDate": "2020-01-24T00:38:34Z", "message": "chore: fix typo\n\nCo-Authored-By: Victoria Xia <victoria.f.xia281@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 135, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}