{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExNjIzMjUz", "number": 6537, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNjozNzo0MFrOEy5rfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNzo1NzowN1rOEy74Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODA5Mjc3OnYy", "diffSide": "RIGHT", "path": "ksqldb-cli/src/main/java/io/confluent/ksql/cli/Cli.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNjozNzo0MFrOHpzRZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNjozNzo0MFrOHpzRZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU5MzcwMw==", "bodyText": "nit: would help future reviews if we javadoc that this is used only for the -e usecase", "url": "https://github.com/confluentinc/ksql/pull/6537#discussion_r513593703", "createdAt": "2020-10-28T16:37:40Z", "author": {"login": "agavra"}, "path": "ksqldb-cli/src/main/java/io/confluent/ksql/cli/Cli.java", "diffHunk": "@@ -220,10 +219,9 @@ public void runScript(final String scriptFile) {\n   public void runCommand(final String command) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcd8cf2e07ede4fdb4c173b86ad7b82eb08f984f"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODQ0NzI5OnYy", "diffSide": "RIGHT", "path": "ksqldb-cli/src/main/java/io/confluent/ksql/cli/Cli.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNzo1NTo1MVrOHp2vkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNzo1NTo1MVrOHp2vkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY1MDU3Ng==", "bodyText": "should we use Iterables.getOnlyElement here to make sure it fails if there's more than 1?", "url": "https://github.com/confluentinc/ksql/pull/6537#discussion_r513650576", "createdAt": "2020-10-28T17:55:51Z", "author": {"login": "agavra"}, "path": "ksqldb-cli/src/main/java/io/confluent/ksql/cli/Cli.java", "diffHunk": "@@ -354,22 +352,21 @@ private boolean isVariableSubstitutionEnabled() {\n     return KsqlConfig.KSQL_VARIABLE_SUBSTITUTION_ENABLE_DEFAULT;\n   }\n \n-  private List<ParsedStatement> substituteVariables(final List<ParsedStatement> statements) {\n+  private ParsedStatement substituteVariables(final ParsedStatement statement) {\n     if (isVariableSubstitutionEnabled()) {\n-      return statements.stream()\n-          .map(stmt -> VariableSubstitutor.substitute(stmt, sessionVariables))\n-          .flatMap(replacedSql -> KSQL_PARSER.parse(replacedSql).stream())\n-          .collect(Collectors.toList());\n+      final String replacedStmt = VariableSubstitutor.substitute(statement, sessionVariables);\n+      return KSQL_PARSER.parse(replacedStmt).get(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcd8cf2e07ede4fdb4c173b86ad7b82eb08f984f"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxODQ1MjkxOnYy", "diffSide": "RIGHT", "path": "ksqldb-rest-model/src/main/java/io/confluent/ksql/rest/entity/VariablesList.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNzo1NzowN1rOHp2zIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxODoxMDozN1rOHp3WYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY1MTQ5MQ==", "bodyText": "this has never been released, right? should be safe to change", "url": "https://github.com/confluentinc/ksql/pull/6537#discussion_r513651491", "createdAt": "2020-10-28T17:57:07Z", "author": {"login": "agavra"}, "path": "ksqldb-rest-model/src/main/java/io/confluent/ksql/rest/entity/VariablesList.java", "diffHunk": "@@ -80,7 +80,7 @@ public String toString() {\n   @JsonCreator\n   public VariablesList(\n       @JsonProperty(\"statementText\") final String statementText,\n-      @JsonProperty(\"properties\") final List<Variable> variables\n+      @JsonProperty(\"variables\") final List<Variable> variables", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcd8cf2e07ede4fdb4c173b86ad7b82eb08f984f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY2MDUxMg==", "bodyText": "Yeap, never released, so we're good here.", "url": "https://github.com/confluentinc/ksql/pull/6537#discussion_r513660512", "createdAt": "2020-10-28T18:10:37Z", "author": {"login": "spena"}, "path": "ksqldb-rest-model/src/main/java/io/confluent/ksql/rest/entity/VariablesList.java", "diffHunk": "@@ -80,7 +80,7 @@ public String toString() {\n   @JsonCreator\n   public VariablesList(\n       @JsonProperty(\"statementText\") final String statementText,\n-      @JsonProperty(\"properties\") final List<Variable> variables\n+      @JsonProperty(\"variables\") final List<Variable> variables", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY1MTQ5MQ=="}, "originalCommit": {"oid": "fcd8cf2e07ede4fdb4c173b86ad7b82eb08f984f"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2586, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}