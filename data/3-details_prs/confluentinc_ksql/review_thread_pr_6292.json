{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyMzM3MDA3", "number": 6292, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNDo1MzowMlrOEoHjTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNDo1MzowMlrOEoHjTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwNTAyMjIzOnYy", "diffSide": "RIGHT", "path": "ksqldb-functional-tests/src/test/resources/query-validation-tests/json.json", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNDo1MzowMlrOHZBh4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNTowNzo1M1rOHZCl8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAwMTUwNQ==", "bodyText": "The PR description says this test is currently disabled. How so?", "url": "https://github.com/confluentinc/ksql/pull/6292#discussion_r496001505", "createdAt": "2020-09-28T14:53:02Z", "author": {"login": "vcrfxia"}, "path": "ksqldb-functional-tests/src/test/resources/query-validation-tests/json.json", "diffHunk": "@@ -1,31 +1,426 @@\n {\n   \"tests\": [\n     {\n-      \"name\": \"deserialize anonymous primitive - value\",\n+      \"name\": \"BOOLEAN - key\",\n       \"statements\": [\n-        \"CREATE STREAM INPUT (K STRING KEY, foo INT) WITH (WRAP_SINGLE_VALUE=false, kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM INPUT (K BOOLEAN KEY, V INT) WITH (kafka_topic='input_topic', format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"properties\": {\n+        \"ksql.key.format.enabled\": true\n+      },\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"key\": true, \"value\": {\"V\": 0}},\n+        {\"topic\": \"input_topic\", \"key\": false, \"value\": {\"V\": 0}},\n+        {\"topic\": \"input_topic\", \"key\": null, \"value\": {\"V\": 0}}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"key\": true, \"value\": {\"V\": 0}},\n+        {\"topic\": \"OUTPUT\", \"key\": false, \"value\": {\"V\": 0}},\n+        {\"topic\": \"OUTPUT\", \"key\": null, \"value\": {\"V\": 0}}\n+      ]\n+    },\n+    {\n+      \"name\": \"BOOLEAN - value - anonymous - deserialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V BOOLEAN) WITH (WRAP_SINGLE_VALUE=false, kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": true},\n+        {\"topic\": \"input_topic\", \"value\": false},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": {\"V\": true}},\n+        {\"topic\": \"OUTPUT\", \"value\": {\"V\": false}},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"BOOLEAN - value - anonymous - serialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V BOOLEAN) WITH (kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT WITH (WRAP_SINGLE_VALUE=false) AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": {\"V\": true}},\n+        {\"topic\": \"input_topic\", \"value\": {\"V\": false}},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": true},\n+        {\"topic\": \"OUTPUT\", \"value\": false},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"INT - key\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (K INT KEY, V INT) WITH (kafka_topic='input_topic', format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"properties\": {\n+        \"ksql.key.format.enabled\": true\n+      },\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"key\": 33, \"value\": {\"V\": 0}},\n+        {\"topic\": \"input_topic\", \"key\": null, \"value\": {\"V\": 0}}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"key\": 33, \"value\": {\"V\": 0}},\n+        {\"topic\": \"OUTPUT\", \"key\": null, \"value\": {\"V\": 0}}\n+      ]\n+    },\n+    {\n+      \"name\": \"INT - value - anonymous - deserialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V INT) WITH (WRAP_SINGLE_VALUE=false, kafka_topic='input_topic', value_format='JSON');\",\n         \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n       ],\n       \"inputs\": [\n         {\"topic\": \"input_topic\", \"value\": 10},\n         {\"topic\": \"input_topic\", \"value\": null}\n       ],\n       \"outputs\": [\n-        {\"topic\": \"OUTPUT\", \"value\": {\"FOO\": 10}},\n+        {\"topic\": \"OUTPUT\", \"value\": {\"V\": 10}},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"INT - value - anonymous - serialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V INT) WITH (kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT WITH (WRAP_SINGLE_VALUE=false) AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": {\"V\": 123}},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": 123},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"BIGINT - key\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (K BIGINT KEY, V INT) WITH (kafka_topic='input_topic', format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"properties\": {\n+        \"ksql.key.format.enabled\": true\n+      },\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"key\": 998877665544332211, \"value\": {\"V\": 0}},\n+        {\"topic\": \"input_topic\", \"key\": null, \"value\": {\"V\": 0}}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"key\": 998877665544332211, \"value\": {\"V\": 0}},\n+        {\"topic\": \"OUTPUT\", \"key\": null, \"value\": {\"V\": 0}}\n+      ]\n+    },\n+    {\n+      \"name\": \"BIGINT - value - anonymous - deserialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V BIGINT) WITH (WRAP_SINGLE_VALUE=false, kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": 10827272222},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": {\"V\": 10827272222}},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"BIGINT - value - anonymous - serialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V BIGINT) WITH (kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT WITH (WRAP_SINGLE_VALUE=false) AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": {\"V\": 1234567890}},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": 1234567890},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"DOUBLE - key\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2adf60bca0f18cc2dddaf466e548374222dbb1f5"}, "originalPosition": 157}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAxODkyOQ==", "bodyText": "Ah, I'll update the title.  I pushed another commit after creating the PR to enable the double testing.", "url": "https://github.com/confluentinc/ksql/pull/6292#discussion_r496018929", "createdAt": "2020-09-28T15:07:53Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-functional-tests/src/test/resources/query-validation-tests/json.json", "diffHunk": "@@ -1,31 +1,426 @@\n {\n   \"tests\": [\n     {\n-      \"name\": \"deserialize anonymous primitive - value\",\n+      \"name\": \"BOOLEAN - key\",\n       \"statements\": [\n-        \"CREATE STREAM INPUT (K STRING KEY, foo INT) WITH (WRAP_SINGLE_VALUE=false, kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM INPUT (K BOOLEAN KEY, V INT) WITH (kafka_topic='input_topic', format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"properties\": {\n+        \"ksql.key.format.enabled\": true\n+      },\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"key\": true, \"value\": {\"V\": 0}},\n+        {\"topic\": \"input_topic\", \"key\": false, \"value\": {\"V\": 0}},\n+        {\"topic\": \"input_topic\", \"key\": null, \"value\": {\"V\": 0}}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"key\": true, \"value\": {\"V\": 0}},\n+        {\"topic\": \"OUTPUT\", \"key\": false, \"value\": {\"V\": 0}},\n+        {\"topic\": \"OUTPUT\", \"key\": null, \"value\": {\"V\": 0}}\n+      ]\n+    },\n+    {\n+      \"name\": \"BOOLEAN - value - anonymous - deserialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V BOOLEAN) WITH (WRAP_SINGLE_VALUE=false, kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": true},\n+        {\"topic\": \"input_topic\", \"value\": false},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": {\"V\": true}},\n+        {\"topic\": \"OUTPUT\", \"value\": {\"V\": false}},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"BOOLEAN - value - anonymous - serialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V BOOLEAN) WITH (kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT WITH (WRAP_SINGLE_VALUE=false) AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": {\"V\": true}},\n+        {\"topic\": \"input_topic\", \"value\": {\"V\": false}},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": true},\n+        {\"topic\": \"OUTPUT\", \"value\": false},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"INT - key\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (K INT KEY, V INT) WITH (kafka_topic='input_topic', format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"properties\": {\n+        \"ksql.key.format.enabled\": true\n+      },\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"key\": 33, \"value\": {\"V\": 0}},\n+        {\"topic\": \"input_topic\", \"key\": null, \"value\": {\"V\": 0}}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"key\": 33, \"value\": {\"V\": 0}},\n+        {\"topic\": \"OUTPUT\", \"key\": null, \"value\": {\"V\": 0}}\n+      ]\n+    },\n+    {\n+      \"name\": \"INT - value - anonymous - deserialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V INT) WITH (WRAP_SINGLE_VALUE=false, kafka_topic='input_topic', value_format='JSON');\",\n         \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n       ],\n       \"inputs\": [\n         {\"topic\": \"input_topic\", \"value\": 10},\n         {\"topic\": \"input_topic\", \"value\": null}\n       ],\n       \"outputs\": [\n-        {\"topic\": \"OUTPUT\", \"value\": {\"FOO\": 10}},\n+        {\"topic\": \"OUTPUT\", \"value\": {\"V\": 10}},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"INT - value - anonymous - serialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V INT) WITH (kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT WITH (WRAP_SINGLE_VALUE=false) AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": {\"V\": 123}},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": 123},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"BIGINT - key\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (K BIGINT KEY, V INT) WITH (kafka_topic='input_topic', format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"properties\": {\n+        \"ksql.key.format.enabled\": true\n+      },\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"key\": 998877665544332211, \"value\": {\"V\": 0}},\n+        {\"topic\": \"input_topic\", \"key\": null, \"value\": {\"V\": 0}}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"key\": 998877665544332211, \"value\": {\"V\": 0}},\n+        {\"topic\": \"OUTPUT\", \"key\": null, \"value\": {\"V\": 0}}\n+      ]\n+    },\n+    {\n+      \"name\": \"BIGINT - value - anonymous - deserialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V BIGINT) WITH (WRAP_SINGLE_VALUE=false, kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": 10827272222},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": {\"V\": 10827272222}},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"BIGINT - value - anonymous - serialize\",\n+      \"statements\": [\n+        \"CREATE STREAM INPUT (V BIGINT) WITH (kafka_topic='input_topic', value_format='JSON');\",\n+        \"CREATE STREAM OUTPUT WITH (WRAP_SINGLE_VALUE=false) AS SELECT * FROM INPUT;\"\n+      ],\n+      \"inputs\": [\n+        {\"topic\": \"input_topic\", \"value\": {\"V\": 1234567890}},\n+        {\"topic\": \"input_topic\", \"value\": null}\n+      ],\n+      \"outputs\": [\n+        {\"topic\": \"OUTPUT\", \"value\": 1234567890},\n+        {\"topic\": \"OUTPUT\", \"value\": null}\n+      ]\n+    },\n+    {\n+      \"name\": \"DOUBLE - key\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAwMTUwNQ=="}, "originalCommit": {"oid": "2adf60bca0f18cc2dddaf466e548374222dbb1f5"}, "originalPosition": 157}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2838, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}