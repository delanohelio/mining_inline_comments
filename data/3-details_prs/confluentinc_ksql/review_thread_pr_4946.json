{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2MjI3ODE3", "number": 4946, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwMDo0Njo1MFrODtVleQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNDo0MjoyOFrODwpTIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4ODY2MTY5OnYy", "diffSide": "RIGHT", "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwMDo0Njo1MFrOF-tG8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzoxMzo0NlrOF-_-dQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTI5NTA5MQ==", "bodyText": "What happens if neither of these handlers is called (i.e., the jaasAuthHandler is present but an invalid auth header was provided, and no pluginHandler is present)? Do we appropriately fail the request in this case?", "url": "https://github.com/confluentinc/ksql/pull/4946#discussion_r401295091", "createdAt": "2020-04-01T00:46:50Z", "author": {"login": "vcrfxia"}, "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "diffHunk": "@@ -221,7 +196,46 @@ private static void unhandledExceptionHandler(final Throwable t) {\n     log.error(\"Unhandled exception\", t);\n   }\n \n-  private static Optional<AuthHandler> getAuthHandler(final Server server) {\n+  private void setupAuthHandlers(final Router router) {\n+    final Optional<Handler<RoutingContext>> jaasAuthHandler = getJaasAuthHandler(server);\n+    final KsqlSecurityExtension securityExtension = server.getSecurityExtension();\n+    final Optional<AuthenticationPlugin> authenticationPlugin = server.getAuthenticationPlugin();\n+    final Optional<Handler<RoutingContext>> pluginHandler =\n+        authenticationPlugin.map(plugin -> new AuthenticationPluginHandler(server, plugin));\n+\n+    if (jaasAuthHandler.isPresent() || authenticationPlugin.isPresent()) {\n+      routeToNonProxiedEndpoints(router, ServerVerticle::pauseHandler);\n+\n+      routeToNonProxiedEndpoints(router,\n+          rc -> wrappedAuthHandler(rc, jaasAuthHandler, pluginHandler));\n+\n+      // For authorization use auth provider configured via security extension (if any)\n+      securityExtension.getAuthorizationProvider()\n+          .ifPresent(ksqlAuthorizationProvider -> routeToNonProxiedEndpoints(router,\n+              new KsqlAuthorizationProviderHandler(server.getWorkerExecutor(),\n+                  ksqlAuthorizationProvider)));\n+\n+      routeToNonProxiedEndpoints(router, ServerVerticle::resumeHandler);\n+    }\n+  }\n+\n+  // If we have a Jaas handler configured and we have Basic credentials then we should auth\n+  // with that\n+  private static void wrappedAuthHandler(final RoutingContext routingContext,\n+      final Optional<Handler<RoutingContext>> jaasAuthHandler,\n+      final Optional<Handler<RoutingContext>> pluginHandler) {\n+    if (jaasAuthHandler.isPresent()) {\n+      final String authHeader = routingContext.request().getHeader(\"Authorization\");\n+      if (authHeader == null || authHeader.toLowerCase().startsWith(\"basic \")) {\n+        jaasAuthHandler.get().handle(routingContext);\n+        return;\n+      }\n+    }\n+    pluginHandler\n+        .ifPresent(routingContextHandler -> routingContextHandler.handle(routingContext));\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66c23f1766189ccd98ae630104e9d65be3297e50"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYwNDIxMw==", "bodyText": "Oops! Good catch", "url": "https://github.com/confluentinc/ksql/pull/4946#discussion_r401604213", "createdAt": "2020-04-01T13:13:46Z", "author": {"login": "purplefox"}, "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "diffHunk": "@@ -221,7 +196,46 @@ private static void unhandledExceptionHandler(final Throwable t) {\n     log.error(\"Unhandled exception\", t);\n   }\n \n-  private static Optional<AuthHandler> getAuthHandler(final Server server) {\n+  private void setupAuthHandlers(final Router router) {\n+    final Optional<Handler<RoutingContext>> jaasAuthHandler = getJaasAuthHandler(server);\n+    final KsqlSecurityExtension securityExtension = server.getSecurityExtension();\n+    final Optional<AuthenticationPlugin> authenticationPlugin = server.getAuthenticationPlugin();\n+    final Optional<Handler<RoutingContext>> pluginHandler =\n+        authenticationPlugin.map(plugin -> new AuthenticationPluginHandler(server, plugin));\n+\n+    if (jaasAuthHandler.isPresent() || authenticationPlugin.isPresent()) {\n+      routeToNonProxiedEndpoints(router, ServerVerticle::pauseHandler);\n+\n+      routeToNonProxiedEndpoints(router,\n+          rc -> wrappedAuthHandler(rc, jaasAuthHandler, pluginHandler));\n+\n+      // For authorization use auth provider configured via security extension (if any)\n+      securityExtension.getAuthorizationProvider()\n+          .ifPresent(ksqlAuthorizationProvider -> routeToNonProxiedEndpoints(router,\n+              new KsqlAuthorizationProviderHandler(server.getWorkerExecutor(),\n+                  ksqlAuthorizationProvider)));\n+\n+      routeToNonProxiedEndpoints(router, ServerVerticle::resumeHandler);\n+    }\n+  }\n+\n+  // If we have a Jaas handler configured and we have Basic credentials then we should auth\n+  // with that\n+  private static void wrappedAuthHandler(final RoutingContext routingContext,\n+      final Optional<Handler<RoutingContext>> jaasAuthHandler,\n+      final Optional<Handler<RoutingContext>> pluginHandler) {\n+    if (jaasAuthHandler.isPresent()) {\n+      final String authHeader = routingContext.request().getHeader(\"Authorization\");\n+      if (authHeader == null || authHeader.toLowerCase().startsWith(\"basic \")) {\n+        jaasAuthHandler.get().handle(routingContext);\n+        return;\n+      }\n+    }\n+    pluginHandler\n+        .ifPresent(routingContextHandler -> routingContextHandler.handle(routingContext));\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTI5NTA5MQ=="}, "originalCommit": {"oid": "66c23f1766189ccd98ae630104e9d65be3297e50"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4ODY2Mjg4OnYy", "diffSide": "RIGHT", "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwMDo0NzozNVrOF-tHtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzoxNTo0N1rOF_ADoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTI5NTI4Nw==", "bodyText": "Why do we always route to the jaasAuthHandler if no auth header is provided? Is it true that all pluginHandlers require the auth header to be set?", "url": "https://github.com/confluentinc/ksql/pull/4946#discussion_r401295287", "createdAt": "2020-04-01T00:47:35Z", "author": {"login": "vcrfxia"}, "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "diffHunk": "@@ -221,7 +196,46 @@ private static void unhandledExceptionHandler(final Throwable t) {\n     log.error(\"Unhandled exception\", t);\n   }\n \n-  private static Optional<AuthHandler> getAuthHandler(final Server server) {\n+  private void setupAuthHandlers(final Router router) {\n+    final Optional<Handler<RoutingContext>> jaasAuthHandler = getJaasAuthHandler(server);\n+    final KsqlSecurityExtension securityExtension = server.getSecurityExtension();\n+    final Optional<AuthenticationPlugin> authenticationPlugin = server.getAuthenticationPlugin();\n+    final Optional<Handler<RoutingContext>> pluginHandler =\n+        authenticationPlugin.map(plugin -> new AuthenticationPluginHandler(server, plugin));\n+\n+    if (jaasAuthHandler.isPresent() || authenticationPlugin.isPresent()) {\n+      routeToNonProxiedEndpoints(router, ServerVerticle::pauseHandler);\n+\n+      routeToNonProxiedEndpoints(router,\n+          rc -> wrappedAuthHandler(rc, jaasAuthHandler, pluginHandler));\n+\n+      // For authorization use auth provider configured via security extension (if any)\n+      securityExtension.getAuthorizationProvider()\n+          .ifPresent(ksqlAuthorizationProvider -> routeToNonProxiedEndpoints(router,\n+              new KsqlAuthorizationProviderHandler(server.getWorkerExecutor(),\n+                  ksqlAuthorizationProvider)));\n+\n+      routeToNonProxiedEndpoints(router, ServerVerticle::resumeHandler);\n+    }\n+  }\n+\n+  // If we have a Jaas handler configured and we have Basic credentials then we should auth\n+  // with that\n+  private static void wrappedAuthHandler(final RoutingContext routingContext,\n+      final Optional<Handler<RoutingContext>> jaasAuthHandler,\n+      final Optional<Handler<RoutingContext>> pluginHandler) {\n+    if (jaasAuthHandler.isPresent()) {\n+      final String authHeader = routingContext.request().getHeader(\"Authorization\");\n+      if (authHeader == null || authHeader.toLowerCase().startsWith(\"basic \")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66c23f1766189ccd98ae630104e9d65be3297e50"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYwNTUzNw==", "bodyText": "This was to catch the case where no auth header was provided but we still want request to be rejected, but the fix in above changes this anyway.", "url": "https://github.com/confluentinc/ksql/pull/4946#discussion_r401605537", "createdAt": "2020-04-01T13:15:47Z", "author": {"login": "purplefox"}, "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "diffHunk": "@@ -221,7 +196,46 @@ private static void unhandledExceptionHandler(final Throwable t) {\n     log.error(\"Unhandled exception\", t);\n   }\n \n-  private static Optional<AuthHandler> getAuthHandler(final Server server) {\n+  private void setupAuthHandlers(final Router router) {\n+    final Optional<Handler<RoutingContext>> jaasAuthHandler = getJaasAuthHandler(server);\n+    final KsqlSecurityExtension securityExtension = server.getSecurityExtension();\n+    final Optional<AuthenticationPlugin> authenticationPlugin = server.getAuthenticationPlugin();\n+    final Optional<Handler<RoutingContext>> pluginHandler =\n+        authenticationPlugin.map(plugin -> new AuthenticationPluginHandler(server, plugin));\n+\n+    if (jaasAuthHandler.isPresent() || authenticationPlugin.isPresent()) {\n+      routeToNonProxiedEndpoints(router, ServerVerticle::pauseHandler);\n+\n+      routeToNonProxiedEndpoints(router,\n+          rc -> wrappedAuthHandler(rc, jaasAuthHandler, pluginHandler));\n+\n+      // For authorization use auth provider configured via security extension (if any)\n+      securityExtension.getAuthorizationProvider()\n+          .ifPresent(ksqlAuthorizationProvider -> routeToNonProxiedEndpoints(router,\n+              new KsqlAuthorizationProviderHandler(server.getWorkerExecutor(),\n+                  ksqlAuthorizationProvider)));\n+\n+      routeToNonProxiedEndpoints(router, ServerVerticle::resumeHandler);\n+    }\n+  }\n+\n+  // If we have a Jaas handler configured and we have Basic credentials then we should auth\n+  // with that\n+  private static void wrappedAuthHandler(final RoutingContext routingContext,\n+      final Optional<Handler<RoutingContext>> jaasAuthHandler,\n+      final Optional<Handler<RoutingContext>> pluginHandler) {\n+    if (jaasAuthHandler.isPresent()) {\n+      final String authHeader = routingContext.request().getHeader(\"Authorization\");\n+      if (authHeader == null || authHeader.toLowerCase().startsWith(\"basic \")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTI5NTI4Nw=="}, "originalCommit": {"oid": "66c23f1766189ccd98ae630104e9d65be3297e50"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4ODY2NDEzOnYy", "diffSide": "RIGHT", "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwMDo0ODoxNFrOF-tIcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMzoyODowNFrOF_AltA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTI5NTQ3Mw==", "bodyText": "Should we change this to a more specific type, since the method only works if this first auth handler is for basic authentication?", "url": "https://github.com/confluentinc/ksql/pull/4946#discussion_r401295473", "createdAt": "2020-04-01T00:48:14Z", "author": {"login": "vcrfxia"}, "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "diffHunk": "@@ -221,7 +196,46 @@ private static void unhandledExceptionHandler(final Throwable t) {\n     log.error(\"Unhandled exception\", t);\n   }\n \n-  private static Optional<AuthHandler> getAuthHandler(final Server server) {\n+  private void setupAuthHandlers(final Router router) {\n+    final Optional<Handler<RoutingContext>> jaasAuthHandler = getJaasAuthHandler(server);\n+    final KsqlSecurityExtension securityExtension = server.getSecurityExtension();\n+    final Optional<AuthenticationPlugin> authenticationPlugin = server.getAuthenticationPlugin();\n+    final Optional<Handler<RoutingContext>> pluginHandler =\n+        authenticationPlugin.map(plugin -> new AuthenticationPluginHandler(server, plugin));\n+\n+    if (jaasAuthHandler.isPresent() || authenticationPlugin.isPresent()) {\n+      routeToNonProxiedEndpoints(router, ServerVerticle::pauseHandler);\n+\n+      routeToNonProxiedEndpoints(router,\n+          rc -> wrappedAuthHandler(rc, jaasAuthHandler, pluginHandler));\n+\n+      // For authorization use auth provider configured via security extension (if any)\n+      securityExtension.getAuthorizationProvider()\n+          .ifPresent(ksqlAuthorizationProvider -> routeToNonProxiedEndpoints(router,\n+              new KsqlAuthorizationProviderHandler(server.getWorkerExecutor(),\n+                  ksqlAuthorizationProvider)));\n+\n+      routeToNonProxiedEndpoints(router, ServerVerticle::resumeHandler);\n+    }\n+  }\n+\n+  // If we have a Jaas handler configured and we have Basic credentials then we should auth\n+  // with that\n+  private static void wrappedAuthHandler(final RoutingContext routingContext,\n+      final Optional<Handler<RoutingContext>> jaasAuthHandler,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66c23f1766189ccd98ae630104e9d65be3297e50"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYxNDI2MA==", "bodyText": "I don't have a strong opinion on this one.", "url": "https://github.com/confluentinc/ksql/pull/4946#discussion_r401614260", "createdAt": "2020-04-01T13:28:04Z", "author": {"login": "purplefox"}, "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "diffHunk": "@@ -221,7 +196,46 @@ private static void unhandledExceptionHandler(final Throwable t) {\n     log.error(\"Unhandled exception\", t);\n   }\n \n-  private static Optional<AuthHandler> getAuthHandler(final Server server) {\n+  private void setupAuthHandlers(final Router router) {\n+    final Optional<Handler<RoutingContext>> jaasAuthHandler = getJaasAuthHandler(server);\n+    final KsqlSecurityExtension securityExtension = server.getSecurityExtension();\n+    final Optional<AuthenticationPlugin> authenticationPlugin = server.getAuthenticationPlugin();\n+    final Optional<Handler<RoutingContext>> pluginHandler =\n+        authenticationPlugin.map(plugin -> new AuthenticationPluginHandler(server, plugin));\n+\n+    if (jaasAuthHandler.isPresent() || authenticationPlugin.isPresent()) {\n+      routeToNonProxiedEndpoints(router, ServerVerticle::pauseHandler);\n+\n+      routeToNonProxiedEndpoints(router,\n+          rc -> wrappedAuthHandler(rc, jaasAuthHandler, pluginHandler));\n+\n+      // For authorization use auth provider configured via security extension (if any)\n+      securityExtension.getAuthorizationProvider()\n+          .ifPresent(ksqlAuthorizationProvider -> routeToNonProxiedEndpoints(router,\n+              new KsqlAuthorizationProviderHandler(server.getWorkerExecutor(),\n+                  ksqlAuthorizationProvider)));\n+\n+      routeToNonProxiedEndpoints(router, ServerVerticle::resumeHandler);\n+    }\n+  }\n+\n+  // If we have a Jaas handler configured and we have Basic credentials then we should auth\n+  // with that\n+  private static void wrappedAuthHandler(final RoutingContext routingContext,\n+      final Optional<Handler<RoutingContext>> jaasAuthHandler,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTI5NTQ3Mw=="}, "originalCommit": {"oid": "66c23f1766189ccd98ae630104e9d65be3297e50"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyMzM0ODgwOnYy", "diffSide": "RIGHT", "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNDo0MjoyOFrOGDw3BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwNzozNzo0N1rOGDzfuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU5OTQyOQ==", "bodyText": "To confirm my understanding - this is what would handle authenticating/authorizing alternative credentials? (e.g. a bearer token like ccloud supports)", "url": "https://github.com/confluentinc/ksql/pull/4946#discussion_r406599429", "createdAt": "2020-04-10T04:42:28Z", "author": {"login": "rodesai"}, "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "diffHunk": "@@ -219,23 +219,31 @@ private void setupAuthHandlers(final Router router) {\n     }\n   }\n \n-  // If we have a Jaas handler configured and we have Basic credentials then we should auth\n-  // with that\n   private static void wrappedAuthHandler(final RoutingContext routingContext,\n-      final Optional<Handler<RoutingContext>> jaasAuthHandler,\n+      final Optional<AuthHandler> jaasAuthHandler,\n       final Optional<Handler<RoutingContext>> pluginHandler) {\n     if (jaasAuthHandler.isPresent()) {\n+      // If we have a Jaas handler configured and we have Basic credentials then we should auth\n+      // with that\n       final String authHeader = routingContext.request().getHeader(\"Authorization\");\n-      if (authHeader == null || authHeader.toLowerCase().startsWith(\"basic \")) {\n+      if (authHeader != null && authHeader.toLowerCase().startsWith(\"basic \")) {\n         jaasAuthHandler.get().handle(routingContext);\n         return;\n       }\n     }\n-    pluginHandler\n-        .ifPresent(routingContextHandler -> routingContextHandler.handle(routingContext));\n+    // Fall through to authing with any authentication plugin\n+    if (pluginHandler.isPresent()) {\n+      pluginHandler.get().handle(routingContext);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0da577786dfa3e5bf5b7e5306d3c1eb750d1022a"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY0MjYxOQ==", "bodyText": "Yes", "url": "https://github.com/confluentinc/ksql/pull/4946#discussion_r406642619", "createdAt": "2020-04-10T07:37:47Z", "author": {"login": "purplefox"}, "path": "ksqldb-rest-app/src/main/java/io/confluent/ksql/api/server/ServerVerticle.java", "diffHunk": "@@ -219,23 +219,31 @@ private void setupAuthHandlers(final Router router) {\n     }\n   }\n \n-  // If we have a Jaas handler configured and we have Basic credentials then we should auth\n-  // with that\n   private static void wrappedAuthHandler(final RoutingContext routingContext,\n-      final Optional<Handler<RoutingContext>> jaasAuthHandler,\n+      final Optional<AuthHandler> jaasAuthHandler,\n       final Optional<Handler<RoutingContext>> pluginHandler) {\n     if (jaasAuthHandler.isPresent()) {\n+      // If we have a Jaas handler configured and we have Basic credentials then we should auth\n+      // with that\n       final String authHeader = routingContext.request().getHeader(\"Authorization\");\n-      if (authHeader == null || authHeader.toLowerCase().startsWith(\"basic \")) {\n+      if (authHeader != null && authHeader.toLowerCase().startsWith(\"basic \")) {\n         jaasAuthHandler.get().handle(routingContext);\n         return;\n       }\n     }\n-    pluginHandler\n-        .ifPresent(routingContextHandler -> routingContextHandler.handle(routingContext));\n+    // Fall through to authing with any authentication plugin\n+    if (pluginHandler.isPresent()) {\n+      pluginHandler.get().handle(routingContext);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU5OTQyOQ=="}, "originalCommit": {"oid": "0da577786dfa3e5bf5b7e5306d3c1eb750d1022a"}, "originalPosition": 33}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3713, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}