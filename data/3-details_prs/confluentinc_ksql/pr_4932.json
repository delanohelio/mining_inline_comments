{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1NzkyODIx", "number": 4932, "title": "docs: migration instructions for KSQL 5.4 to ksqlDB 5.5 (DOCS-3744)", "bodyText": "Description\nWorking draft for migration instructions.\nAlso fixes some indentation issues.", "createdAt": "2020-03-30T17:28:47Z", "url": "https://github.com/confluentinc/ksql/pull/4932", "merged": true, "mergeCommit": {"oid": "504b53ed2abefecb1de52cd2afbedee7e2339075"}, "closed": true, "closedAt": "2020-04-08T20:02:40Z", "author": {"login": "JimGalasyn"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSx6xsAH2gAyMzk1NzkyODIxOmI0MjBiZjE2YmQ3NjhkMDFmMDcyMTRhYmI3ZTllNjAzYjU3MWVkZjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVsN04gH2gAyMzk1NzkyODIxOjc2ZGRiN2Y4NjNhMTFiMTkzZjk4ZjI2Nzg0YzQzZWI2ZmE1Mjg5OWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b420bf16bd768d01f07214abb7e9e603b571edf4", "author": {"user": {"login": "JimGalasyn", "name": "Jim Galasyn"}}, "url": "https://github.com/confluentinc/ksql/commit/b420bf16bd768d01f07214abb7e9e603b571edf4", "committedDate": "2020-03-30T17:26:16Z", "message": "docs: migration instructions for KSQL 5.4 to ksqlDB 5.5 (DOCS-3744)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MjAzNDc5", "url": "https://github.com/confluentinc/ksql/pull/4932#pullrequestreview-384203479", "createdAt": "2020-03-30T20:26:31Z", "commit": {"oid": "b420bf16bd768d01f07214abb7e9e603b571edf4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMDoyNjozMVrOF964wQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMDoyNjozMVrOF964wQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ3MjI1Nw==", "bodyText": "could be role bindings if you use rbac, acls if you use acls, or skip if you don't use authorization.\nRole-bindings should be assigned to the ksql service principal.", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r400472257", "createdAt": "2020-03-30T20:26:31Z", "author": {"login": "stan-confluent"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -6,26 +6,80 @@ Upgrading KSQL\n Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n capacity to take over temporarily for unavailable, restarting servers.\n \n+Upgrading to ksqlDB 5.5 from KSQL 5.4\n+-------------------------------------\n+\n+#. Prepare a list of SQL statements for migration. One way is to dump the command\n+   topic.\n+\n+   ```bash\n+   ./bin/kafka-console-consumer --bootstrap-server localhost:9092 --topic _confluent-ksql-default__command_topic --from-beginning | jq \".statement\" \n+   ```\n+\n+#. List your application's streams, tables, and types. Don't use the EXTENDED\n+   option. Go through each list, and find the the last CREATE statement for each\n+   stream/table/type name. Order the CREATE statements so they show the correct\n+   dependencies.\n+   \n+#. Make other compatibility-related changes, as shown in the\n+   `upgrade guide <https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/#how-to-upgrade>`__.\n+\n+#. Stop the ``ksql`` service.\n+\n+#. Uninstall the v5.4 ksql rpm package.\n+\n+#. Install the v5.5 ksqldb rpm package.\n+\n+#. Copy the v5.4 configuration file to the v5.5 ksqldb configuration\n+   folder, which is located at ``${CONFLUENT_HOME}/etc/ksqldb``:\n+\n+   ```bash\n+   cp /etc/ksql/ksql-server.properties /etc/ksqldb/ksql-server.properties\n+   ```\n+\n+#. Change the ``ksql.service.id`` in the property file, for example, from\n+   ``default_`` to ``ksqldb_``.\n+\n+#. Create role bindings for the ``ksql`` service principal. For more information,\n+   see :ref:`ksql-rbac`.\n+\n+#. Create three new role bindings:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b420bf16bd768d01f07214abb7e9e603b571edf4"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MjA0NzA4", "url": "https://github.com/confluentinc/ksql/pull/4932#pullrequestreview-384204708", "createdAt": "2020-03-30T20:28:18Z", "commit": {"oid": "b420bf16bd768d01f07214abb7e9e603b571edf4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMDoyODoxOFrOF968lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMDoyODoxOFrOF968lQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ3MzIzNw==", "bodyText": "5.4 -> 5.5 is not a rolling restart, ie you'll need to shut down all ksql instances and then start up all ksqldb instances, meaning there will be downtime - but please double check with ksql folks.", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r400473237", "createdAt": "2020-03-30T20:28:18Z", "author": {"login": "stan-confluent"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -6,26 +6,80 @@ Upgrading KSQL\n Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n capacity to take over temporarily for unavailable, restarting servers.\n \n+Upgrading to ksqlDB 5.5 from KSQL 5.4\n+-------------------------------------\n+\n+#. Prepare a list of SQL statements for migration. One way is to dump the command", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b420bf16bd768d01f07214abb7e9e603b571edf4"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MjA1Njc0", "url": "https://github.com/confluentinc/ksql/pull/4932#pullrequestreview-384205674", "createdAt": "2020-03-30T20:29:33Z", "commit": {"oid": "b420bf16bd768d01f07214abb7e9e603b571edf4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMDoyOTozM1rOF96_xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMDoyOTozM1rOF96_xA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ3NDA1Mg==", "bodyText": "Would be good to include general 5.4 ksql to 5.5 ksqldb upgrade info from https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/ - or have a link to that upgrade doc at the beginning of 5.4->5.5 section", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r400474052", "createdAt": "2020-03-30T20:29:33Z", "author": {"login": "stan-confluent"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -6,26 +6,80 @@ Upgrading KSQL\n Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n capacity to take over temporarily for unavailable, restarting servers.\n \n+Upgrading to ksqlDB 5.5 from KSQL 5.4", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b420bf16bd768d01f07214abb7e9e603b571edf4"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525", "author": {"user": {"login": "JimGalasyn", "name": "Jim Galasyn"}}, "url": "https://github.com/confluentinc/ksql/commit/2ed5e20e2bea66e9af952111af9919bbe6d19525", "committedDate": "2020-03-31T20:23:04Z", "message": "docs: incorporate feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NTM0NzM5", "url": "https://github.com/confluentinc/ksql/pull/4932#pullrequestreview-386534739", "createdAt": "2020-04-02T15:21:40Z", "commit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNToyMTo0MFrOF_wfvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNTo1Njo0NFrOF_yE6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM5OTE2NQ==", "bodyText": "I'm not sure about using this command. I might have a mix of CREATE & DROP statements that end up on dropped streams, The user will need to walk through that list and figure out which streams and tables do not exist anymore.\nAlso, what's the difference between this step and the next one that says List your application's streams ...?  Isn't the same?", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r402399165", "createdAt": "2020-04-02T15:21:40Z", "author": {"login": "spena"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -1,31 +1,97 @@\n .. _upgrading-ksql:\n \n-Upgrading KSQL\n-==============\n+Upgrading ksqlDB\n+================\n \n-Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n-capacity to take over temporarily for unavailable, restarting servers.\n+Upgrade one server at a time in a \"rolling restart\". The remaining servers\n+should have sufficient spare capacity to take over temporarily for unavailable,\n+restarting servers.\n+\n+For general guidance on upgrading, see\n+[Upgrade ksqlDB](https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/).\n+\n+Upgrading to ksqlDB 5.5 from KSQL 5.4\n+-------------------------------------\n+\n+.. important::\n+\n+   The upgrade from KSQL 5.4 to ksqlDB 5.5 is not a rolling restart. You must\n+   shut down all KSQL instances and then start up all ksqlDB instances, so there\n+   will be downtime.\n+\n+#. Prepare a list of SQL statements for migration. One way is to dump the command\n+   topic.\n+\n+   ```bash\n+   ./bin/kafka-console-consumer --bootstrap-server localhost:9092 --topic _confluent-ksql-default__command_topic --from-beginning | jq \".statement\" ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxMzQ1Mw==", "bodyText": "Which command are you recommending here? I just used DESCRIBE without EXTENDED. However, there is no CREATE statement in the DESCRIBE command.\nksql> describe ps1;\n\nName                 : PS1\n Field   | Type                      \n\n ROWTIME | BIGINT           (system) \n ROWKEY  | VARCHAR(STRING)  (system) \n ID      | INTEGER                   \n\nFor runtime statistics and query details run: DESCRIBE EXTENDED <Stream,Table>;\n\nShould we say the user needs to re-create the CREATE statement based on the displayed schema?", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r402413453", "createdAt": "2020-04-02T15:40:50Z", "author": {"login": "spena"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -1,31 +1,97 @@\n .. _upgrading-ksql:\n \n-Upgrading KSQL\n-==============\n+Upgrading ksqlDB\n+================\n \n-Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n-capacity to take over temporarily for unavailable, restarting servers.\n+Upgrade one server at a time in a \"rolling restart\". The remaining servers\n+should have sufficient spare capacity to take over temporarily for unavailable,\n+restarting servers.\n+\n+For general guidance on upgrading, see\n+[Upgrade ksqlDB](https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/).\n+\n+Upgrading to ksqlDB 5.5 from KSQL 5.4\n+-------------------------------------\n+\n+.. important::\n+\n+   The upgrade from KSQL 5.4 to ksqlDB 5.5 is not a rolling restart. You must\n+   shut down all KSQL instances and then start up all ksqlDB instances, so there\n+   will be downtime.\n+\n+#. Prepare a list of SQL statements for migration. One way is to dump the command\n+   topic.\n+\n+   ```bash\n+   ./bin/kafka-console-consumer --bootstrap-server localhost:9092 --topic _confluent-ksql-default__command_topic --from-beginning | jq \".statement\" \n+   ```\n+\n+#. List your application's streams, tables, and types. Don't use the EXTENDED\n+   option. Go through each list, and find the the last CREATE statement for each\n+   stream/table/type name. Order the CREATE statements so they show the correct\n+   dependencies.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyMjYzMQ==", "bodyText": "Should this be a sub-section of the previous step in case the user has RBAC or ACLs enabled? If not, then this step is not essential for users without security.\nAlso, what permissions des ksql need? write, read, describe?", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r402422631", "createdAt": "2020-04-02T15:53:31Z", "author": {"login": "spena"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -1,31 +1,97 @@\n .. _upgrading-ksql:\n \n-Upgrading KSQL\n-==============\n+Upgrading ksqlDB\n+================\n \n-Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n-capacity to take over temporarily for unavailable, restarting servers.\n+Upgrade one server at a time in a \"rolling restart\". The remaining servers\n+should have sufficient spare capacity to take over temporarily for unavailable,\n+restarting servers.\n+\n+For general guidance on upgrading, see\n+[Upgrade ksqlDB](https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/).\n+\n+Upgrading to ksqlDB 5.5 from KSQL 5.4\n+-------------------------------------\n+\n+.. important::\n+\n+   The upgrade from KSQL 5.4 to ksqlDB 5.5 is not a rolling restart. You must\n+   shut down all KSQL instances and then start up all ksqlDB instances, so there\n+   will be downtime.\n+\n+#. Prepare a list of SQL statements for migration. One way is to dump the command\n+   topic.\n+\n+   ```bash\n+   ./bin/kafka-console-consumer --bootstrap-server localhost:9092 --topic _confluent-ksql-default__command_topic --from-beginning | jq \".statement\" \n+   ```\n+\n+#. List your application's streams, tables, and types. Don't use the EXTENDED\n+   option. Go through each list, and find the the last CREATE statement for each\n+   stream/table/type name. Order the CREATE statements so they show the correct\n+   dependencies.\n+   \n+#. Make other compatibility-related changes, as shown in the\n+   `upgrade guide <https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/#how-to-upgrade>`__.\n+\n+#. Stop the ``ksql`` service.\n+\n+#. Uninstall the ksql 5.4 DEB or RPM package.\n+\n+#. Install the ksqldb 5.5 DEB or RPM package.\n+\n+#. Copy the version 5.4 configuration file to the ksqldb 5.5 configuration\n+   folder, which is located at ``${CONFLUENT_HOME}/etc/ksqldb``:\n+\n+   ```bash\n+   cp /etc/ksql/ksql-server.properties /etc/ksqldb/ksql-server.properties\n+   ```\n+\n+#. Change the ``ksql.service.id`` in the property file, for example, from\n+   ``default_`` to ``ksqldb_``.\n+\n+#. Set up security for your ksqlDB app. ksqlDB supports using\n+   :ref:`role-based access control (RBAC) <ksql-rbac>`,\n+   :ref:`ACLs <config-security-ksql-acl>`, and no authorization.\n+\n+#. Create three new role bindings or assign ACLs for the ``ksql`` service\n+   principal:\n+\n+   - Topic: ``__consumer_offsets``\n+   - Topic: ``__transaction_state``\n+   - TransactionalId: ``ksqldb_``. Use the value that you set in the\n+     configuration file.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyMzgxNw==", "bodyText": "Could you put an example of how to run the file? Also, the first step didn't mention writing the list of statements to a file.", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r402423817", "createdAt": "2020-04-02T15:55:00Z", "author": {"login": "spena"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -1,31 +1,97 @@\n .. _upgrading-ksql:\n \n-Upgrading KSQL\n-==============\n+Upgrading ksqlDB\n+================\n \n-Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n-capacity to take over temporarily for unavailable, restarting servers.\n+Upgrade one server at a time in a \"rolling restart\". The remaining servers\n+should have sufficient spare capacity to take over temporarily for unavailable,\n+restarting servers.\n+\n+For general guidance on upgrading, see\n+[Upgrade ksqlDB](https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/).\n+\n+Upgrading to ksqlDB 5.5 from KSQL 5.4\n+-------------------------------------\n+\n+.. important::\n+\n+   The upgrade from KSQL 5.4 to ksqlDB 5.5 is not a rolling restart. You must\n+   shut down all KSQL instances and then start up all ksqlDB instances, so there\n+   will be downtime.\n+\n+#. Prepare a list of SQL statements for migration. One way is to dump the command\n+   topic.\n+\n+   ```bash\n+   ./bin/kafka-console-consumer --bootstrap-server localhost:9092 --topic _confluent-ksql-default__command_topic --from-beginning | jq \".statement\" \n+   ```\n+\n+#. List your application's streams, tables, and types. Don't use the EXTENDED\n+   option. Go through each list, and find the the last CREATE statement for each\n+   stream/table/type name. Order the CREATE statements so they show the correct\n+   dependencies.\n+   \n+#. Make other compatibility-related changes, as shown in the\n+   `upgrade guide <https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/#how-to-upgrade>`__.\n+\n+#. Stop the ``ksql`` service.\n+\n+#. Uninstall the ksql 5.4 DEB or RPM package.\n+\n+#. Install the ksqldb 5.5 DEB or RPM package.\n+\n+#. Copy the version 5.4 configuration file to the ksqldb 5.5 configuration\n+   folder, which is located at ``${CONFLUENT_HOME}/etc/ksqldb``:\n+\n+   ```bash\n+   cp /etc/ksql/ksql-server.properties /etc/ksqldb/ksql-server.properties\n+   ```\n+\n+#. Change the ``ksql.service.id`` in the property file, for example, from\n+   ``default_`` to ``ksqldb_``.\n+\n+#. Set up security for your ksqlDB app. ksqlDB supports using\n+   :ref:`role-based access control (RBAC) <ksql-rbac>`,\n+   :ref:`ACLs <config-security-ksql-acl>`, and no authorization.\n+\n+#. Create three new role bindings or assign ACLs for the ``ksql`` service\n+   principal:\n+\n+   - Topic: ``__consumer_offsets``\n+   - Topic: ``__transaction_state``\n+   - TransactionalId: ``ksqldb_``. Use the value that you set in the\n+     configuration file.\n+\n+#. Start the ``ksqldb`` service.\n+\n+#. Run the file that you prepared previously.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyNTA2NA==", "bodyText": "Should this be part of the step of copying the configuration files to ksqldb? I think it should be there as the users are starting ksql at that point, then they will find out this extra step to copy other configs.", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r402425064", "createdAt": "2020-04-02T15:56:44Z", "author": {"login": "spena"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -1,31 +1,97 @@\n .. _upgrading-ksql:\n \n-Upgrading KSQL\n-==============\n+Upgrading ksqlDB\n+================\n \n-Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n-capacity to take over temporarily for unavailable, restarting servers.\n+Upgrade one server at a time in a \"rolling restart\". The remaining servers\n+should have sufficient spare capacity to take over temporarily for unavailable,\n+restarting servers.\n+\n+For general guidance on upgrading, see\n+[Upgrade ksqlDB](https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/).\n+\n+Upgrading to ksqlDB 5.5 from KSQL 5.4\n+-------------------------------------\n+\n+.. important::\n+\n+   The upgrade from KSQL 5.4 to ksqlDB 5.5 is not a rolling restart. You must\n+   shut down all KSQL instances and then start up all ksqlDB instances, so there\n+   will be downtime.\n+\n+#. Prepare a list of SQL statements for migration. One way is to dump the command\n+   topic.\n+\n+   ```bash\n+   ./bin/kafka-console-consumer --bootstrap-server localhost:9092 --topic _confluent-ksql-default__command_topic --from-beginning | jq \".statement\" \n+   ```\n+\n+#. List your application's streams, tables, and types. Don't use the EXTENDED\n+   option. Go through each list, and find the the last CREATE statement for each\n+   stream/table/type name. Order the CREATE statements so they show the correct\n+   dependencies.\n+   \n+#. Make other compatibility-related changes, as shown in the\n+   `upgrade guide <https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/#how-to-upgrade>`__.\n+\n+#. Stop the ``ksql`` service.\n+\n+#. Uninstall the ksql 5.4 DEB or RPM package.\n+\n+#. Install the ksqldb 5.5 DEB or RPM package.\n+\n+#. Copy the version 5.4 configuration file to the ksqldb 5.5 configuration\n+   folder, which is located at ``${CONFLUENT_HOME}/etc/ksqldb``:\n+\n+   ```bash\n+   cp /etc/ksql/ksql-server.properties /etc/ksqldb/ksql-server.properties\n+   ```\n+\n+#. Change the ``ksql.service.id`` in the property file, for example, from\n+   ``default_`` to ``ksqldb_``.\n+\n+#. Set up security for your ksqlDB app. ksqlDB supports using\n+   :ref:`role-based access control (RBAC) <ksql-rbac>`,\n+   :ref:`ACLs <config-security-ksql-acl>`, and no authorization.\n+\n+#. Create three new role bindings or assign ACLs for the ``ksql`` service\n+   principal:\n+\n+   - Topic: ``__consumer_offsets``\n+   - Topic: ``__transaction_state``\n+   - TransactionalId: ``ksqldb_``. Use the value that you set in the\n+     configuration file.\n+\n+#. Start the ``ksqldb`` service.\n+\n+#. Run the file that you prepared previously.\n+\n+.. note::\n+\n+    In addition to copying the properties file from ``ksql`` to ``ksqldb``, you may\n+    need to copy other configs, like log4j and systemd overrides, depending on how\n+    you have customized your deployment.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NTc0MTU1", "url": "https://github.com/confluentinc/ksql/pull/4932#pullrequestreview-386574155", "createdAt": "2020-04-02T16:04:05Z", "commit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowNDowNVrOF_yZVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNjowNDowNVrOF_yZVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQzMDI5Mg==", "bodyText": "for RPM - you can just use yum swap (not sure if we want to mention that here though because I guess what you have would work)", "url": "https://github.com/confluentinc/ksql/pull/4932#discussion_r402430292", "createdAt": "2020-04-02T16:04:05Z", "author": {"login": "agavra"}, "path": "docs/installation/upgrading.rst", "diffHunk": "@@ -1,31 +1,97 @@\n .. _upgrading-ksql:\n \n-Upgrading KSQL\n-==============\n+Upgrading ksqlDB\n+================\n \n-Upgrade one KSQL server at a time (i.e. rolling restart). The remaining KSQL servers should have sufficient spare\n-capacity to take over temporarily for unavailable, restarting servers.\n+Upgrade one server at a time in a \"rolling restart\". The remaining servers\n+should have sufficient spare capacity to take over temporarily for unavailable,\n+restarting servers.\n+\n+For general guidance on upgrading, see\n+[Upgrade ksqlDB](https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/).\n+\n+Upgrading to ksqlDB 5.5 from KSQL 5.4\n+-------------------------------------\n+\n+.. important::\n+\n+   The upgrade from KSQL 5.4 to ksqlDB 5.5 is not a rolling restart. You must\n+   shut down all KSQL instances and then start up all ksqlDB instances, so there\n+   will be downtime.\n+\n+#. Prepare a list of SQL statements for migration. One way is to dump the command\n+   topic.\n+\n+   ```bash\n+   ./bin/kafka-console-consumer --bootstrap-server localhost:9092 --topic _confluent-ksql-default__command_topic --from-beginning | jq \".statement\" \n+   ```\n+\n+#. List your application's streams, tables, and types. Don't use the EXTENDED\n+   option. Go through each list, and find the the last CREATE statement for each\n+   stream/table/type name. Order the CREATE statements so they show the correct\n+   dependencies.\n+   \n+#. Make other compatibility-related changes, as shown in the\n+   `upgrade guide <https://docs.ksqldb.io/en/latest/operate-and-deploy/installation/upgrading/#how-to-upgrade>`__.\n+\n+#. Stop the ``ksql`` service.\n+\n+#. Uninstall the ksql 5.4 DEB or RPM package.\n+\n+#. Install the ksqldb 5.5 DEB or RPM package.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ed5e20e2bea66e9af952111af9919bbe6d19525"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00d9182c30f9c1fdc8f50f03aa772591eb83eca6", "author": {"user": {"login": "JimGalasyn", "name": "Jim Galasyn"}}, "url": "https://github.com/confluentinc/ksql/commit/00d9182c30f9c1fdc8f50f03aa772591eb83eca6", "committedDate": "2020-04-03T17:49:01Z", "message": "docs: incorporate feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0a390056e0cd15a81b244b5f29aa4c091c43ce7", "author": {"user": {"login": "JimGalasyn", "name": "Jim Galasyn"}}, "url": "https://github.com/confluentinc/ksql/commit/b0a390056e0cd15a81b244b5f29aa4c091c43ce7", "committedDate": "2020-04-07T18:25:25Z", "message": "docs: incorporate feedback; rework steps for creating SQL file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76ddb7f863a11b193f98f26784c43eb6fa52899b", "author": {"user": {"login": "JimGalasyn", "name": "Jim Galasyn"}}, "url": "https://github.com/confluentinc/ksql/commit/76ddb7f863a11b193f98f26784c43eb6fa52899b", "committedDate": "2020-04-08T18:29:25Z", "message": "docs: add ACLs and role bindings"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4957, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}