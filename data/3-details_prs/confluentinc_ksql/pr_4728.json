{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MDE5MjAz", "number": 4728, "title": "feat: add REGEXP_EXTRACT UDF", "bodyText": "Description\n#878\nBased it off of these docs\nhttps://prestodb.io/docs/current/functions/regexp.html\nGoing to generate the new topology plans after the re-name is done and I rebase.\nTesting done\nUnit test for UDF\nQTT test\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-03-06T21:00:43Z", "url": "https://github.com/confluentinc/ksql/pull/4728", "merged": true, "mergeCommit": {"oid": "a25f0fbb07a6414a62e8149ed9d0dd6cf90cf21e"}, "closed": true, "closedAt": "2020-03-14T00:20:50Z", "author": {"login": "stevenpyzhang"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcLH_pLABqjMxMDcwOTg4MDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNYZEWABqjMxMjg1NDMyNDA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "11c2af8c0d0d17562d02582b5472249006dd315b", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/11c2af8c0d0d17562d02582b5472249006dd315b", "committedDate": "2020-03-05T21:51:36Z", "message": "feat: add REGEXP_EXTRACT UDF"}, "afterCommit": {"oid": "2afc198910e536cd7e986bdd8ea4b8680b3a0f1c", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/2afc198910e536cd7e986bdd8ea4b8680b3a0f1c", "committedDate": "2020-03-06T22:37:59Z", "message": "feat: add REGEXP_EXTRACT UDF"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2afc198910e536cd7e986bdd8ea4b8680b3a0f1c", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/2afc198910e536cd7e986bdd8ea4b8680b3a0f1c", "committedDate": "2020-03-06T22:37:59Z", "message": "feat: add REGEXP_EXTRACT UDF"}, "afterCommit": {"oid": "698178d4e3cd001e3ecc97ba735d43234cc534ae", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/698178d4e3cd001e3ecc97ba735d43234cc534ae", "committedDate": "2020-03-09T23:13:56Z", "message": "feat: add REGEXP_EXTRACT UDF"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "698178d4e3cd001e3ecc97ba735d43234cc534ae", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/698178d4e3cd001e3ecc97ba735d43234cc534ae", "committedDate": "2020-03-09T23:13:56Z", "message": "feat: add REGEXP_EXTRACT UDF"}, "afterCommit": {"oid": "6c10e30beffd9d05ee4062a2513025a56a4e2364", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/6c10e30beffd9d05ee4062a2513025a56a4e2364", "committedDate": "2020-03-11T20:52:16Z", "message": "feat: add REGEXP_EXTRACT UDF"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6c10e30beffd9d05ee4062a2513025a56a4e2364", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/6c10e30beffd9d05ee4062a2513025a56a4e2364", "committedDate": "2020-03-11T20:52:16Z", "message": "feat: add REGEXP_EXTRACT UDF"}, "afterCommit": {"oid": "06b6b22f0d30f2ce3865667e8a07df2164096a2f", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/06b6b22f0d30f2ce3865667e8a07df2164096a2f", "committedDate": "2020-03-11T20:57:01Z", "message": "feat: add REGEXP_EXTRACT UDF"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "06b6b22f0d30f2ce3865667e8a07df2164096a2f", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/06b6b22f0d30f2ce3865667e8a07df2164096a2f", "committedDate": "2020-03-11T20:57:01Z", "message": "feat: add REGEXP_EXTRACT UDF"}, "afterCommit": {"oid": "2b330a1ccbd971b5291c8c0a219d0d7599aa37fc", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/2b330a1ccbd971b5291c8c0a219d0d7599aa37fc", "committedDate": "2020-03-11T21:53:05Z", "message": "feat: add REGEXP_EXTRACT UDF"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b330a1ccbd971b5291c8c0a219d0d7599aa37fc", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/2b330a1ccbd971b5291c8c0a219d0d7599aa37fc", "committedDate": "2020-03-11T21:53:05Z", "message": "feat: add REGEXP_EXTRACT UDF"}, "afterCommit": {"oid": "fd1a29695263160302b2a499213afc45434a40b8", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/fd1a29695263160302b2a499213afc45434a40b8", "committedDate": "2020-03-11T22:12:09Z", "message": "feat: add REGEXP_EXTRACT UDF"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd1a29695263160302b2a499213afc45434a40b8", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/fd1a29695263160302b2a499213afc45434a40b8", "committedDate": "2020-03-11T22:12:09Z", "message": "feat: add REGEXP_EXTRACT UDF"}, "afterCommit": {"oid": "7f5d3f75de1ecbf814764daa2a6762e6d7def6e8", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/7f5d3f75de1ecbf814764daa2a6762e6d7def6e8", "committedDate": "2020-03-12T18:35:55Z", "message": "feat: add REGEXP_EXTRACT udf"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNzc4Nzcy", "url": "https://github.com/confluentinc/ksql/pull/4728#pullrequestreview-373778772", "createdAt": "2020-03-12T17:54:37Z", "commit": {"oid": "fd1a29695263160302b2a499213afc45434a40b8"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNzo1NDozOFrOF1pPJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxNzo1OToxNFrOF1pZpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5NDQ2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  @UdfParameter(description = \"The regex pattern.\") final String pattern,\n          \n          \n            \n                  @UdfParameter(description = \"The regex pattern\") final String pattern,\n          \n      \n    \n    \n  \n\nsuper nit \ud83d\ude02 to keep it consistent", "url": "https://github.com/confluentinc/ksql/pull/4728#discussion_r391794469", "createdAt": "2020-03-12T17:54:38Z", "author": {"login": "agavra"}, "path": "ksql-engine/src/main/java/io/confluent/ksql/function/udf/string/RegexpExtract.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.function.udf.string;\n+\n+import io.confluent.ksql.function.udf.Udf;\n+import io.confluent.ksql.function.udf.UdfDescription;\n+import io.confluent.ksql.function.udf.UdfParameter;\n+import io.confluent.ksql.util.KsqlConstants;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+@UdfDescription(\n+    name = \"regexp_extract\",\n+    author = KsqlConstants.CONFLUENT_AUTHOR,\n+    description = \"extract the first subtring matched by a regex pattern\")\n+public class RegexpExtract {\n+  @Udf(description = \"Returns first substring of the input that matches the given regex pattern\")\n+  public String regexpExtract(\n+      @UdfParameter(description = \"The regex pattern.\") final String pattern,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd1a29695263160302b2a499213afc45434a40b8"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5NTk1NQ==", "bodyText": "should we return null or \"\" - I think to be consistent with other UDFs null might be a better option here, and that also differentiates a result that couldn't find it with an empty result", "url": "https://github.com/confluentinc/ksql/pull/4728#discussion_r391795955", "createdAt": "2020-03-12T17:57:11Z", "author": {"login": "agavra"}, "path": "ksql-engine/src/main/java/io/confluent/ksql/function/udf/string/RegexpExtract.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.function.udf.string;\n+\n+import io.confluent.ksql.function.udf.Udf;\n+import io.confluent.ksql.function.udf.UdfDescription;\n+import io.confluent.ksql.function.udf.UdfParameter;\n+import io.confluent.ksql.util.KsqlConstants;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+@UdfDescription(\n+    name = \"regexp_extract\",\n+    author = KsqlConstants.CONFLUENT_AUTHOR,\n+    description = \"extract the first subtring matched by a regex pattern\")\n+public class RegexpExtract {\n+  @Udf(description = \"Returns first substring of the input that matches the given regex pattern\")\n+  public String regexpExtract(\n+      @UdfParameter(description = \"The regex pattern.\") final String pattern,\n+      @UdfParameter(description = \"The input string to apply regex on\") final String input\n+  ) {\n+    if (pattern == null || input == null) {\n+      return null;\n+    }\n+    final Pattern p = Pattern.compile(pattern);\n+    final Matcher m = p.matcher(input);\n+    return m.find() ? m.group(0) : \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd1a29695263160302b2a499213afc45434a40b8"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5NjI5Ng==", "bodyText": "nit: the above method should call this method with 0 as the group", "url": "https://github.com/confluentinc/ksql/pull/4728#discussion_r391796296", "createdAt": "2020-03-12T17:57:47Z", "author": {"login": "agavra"}, "path": "ksql-engine/src/main/java/io/confluent/ksql/function/udf/string/RegexpExtract.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.function.udf.string;\n+\n+import io.confluent.ksql.function.udf.Udf;\n+import io.confluent.ksql.function.udf.UdfDescription;\n+import io.confluent.ksql.function.udf.UdfParameter;\n+import io.confluent.ksql.util.KsqlConstants;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+@UdfDescription(\n+    name = \"regexp_extract\",\n+    author = KsqlConstants.CONFLUENT_AUTHOR,\n+    description = \"extract the first subtring matched by a regex pattern\")\n+public class RegexpExtract {\n+  @Udf(description = \"Returns first substring of the input that matches the given regex pattern\")\n+  public String regexpExtract(\n+      @UdfParameter(description = \"The regex pattern.\") final String pattern,\n+      @UdfParameter(description = \"The input string to apply regex on\") final String input\n+  ) {\n+    if (pattern == null || input == null) {\n+      return null;\n+    }\n+    final Pattern p = Pattern.compile(pattern);\n+    final Matcher m = p.matcher(input);\n+    return m.find() ? m.group(0) : \"\";\n+  }\n+\n+  @Udf(description = \"Returns the first substring of the \"\n+      + \"input that matches the regex pattern and the capturing group number specified\")\n+  public String regexpExtract(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd1a29695263160302b2a499213afc45434a40b8"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5NzE1OA==", "bodyText": "nit: add null tests to both of these cases", "url": "https://github.com/confluentinc/ksql/pull/4728#discussion_r391797158", "createdAt": "2020-03-12T17:59:14Z", "author": {"login": "agavra"}, "path": "ksql-functional-tests/src/test/resources/query-validation-tests/regex.json", "diffHunk": "@@ -0,0 +1,45 @@\n+{\n+  \"comments\": [\n+    \"Tests covering the use of the REGEXP_EXTRACT UDF.\"\n+  ],\n+  \"tests\": [", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd1a29695263160302b2a499213afc45434a40b8"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7f5d3f75de1ecbf814764daa2a6762e6d7def6e8", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/7f5d3f75de1ecbf814764daa2a6762e6d7def6e8", "committedDate": "2020-03-12T18:35:55Z", "message": "feat: add REGEXP_EXTRACT udf"}, "afterCommit": {"oid": "1d62dddedacc36992279b33aa4d30b7672324523", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/1d62dddedacc36992279b33aa4d30b7672324523", "committedDate": "2020-03-12T21:02:01Z", "message": "feat: add REGEXP_EXTRACT udf"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d62dddedacc36992279b33aa4d30b7672324523", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/1d62dddedacc36992279b33aa4d30b7672324523", "committedDate": "2020-03-12T21:02:01Z", "message": "feat: add REGEXP_EXTRACT udf"}, "afterCommit": {"oid": "0d227af2c88c3a70971fe5ac748959fc35dc5bf5", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/0d227af2c88c3a70971fe5ac748959fc35dc5bf5", "committedDate": "2020-03-13T21:31:40Z", "message": "feat: add REGEXP_EXTRACT udf"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0d227af2c88c3a70971fe5ac748959fc35dc5bf5", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/0d227af2c88c3a70971fe5ac748959fc35dc5bf5", "committedDate": "2020-03-13T21:31:40Z", "message": "feat: add REGEXP_EXTRACT udf"}, "afterCommit": {"oid": "e2455d2f59db06de2ac8d39f3d67a3aa62056935", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/e2455d2f59db06de2ac8d39f3d67a3aa62056935", "committedDate": "2020-03-13T22:28:48Z", "message": "feat: add REGEXP_EXTRACT udf"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5cac52dbb4dd400cce00b635548a367b605a2d7", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/c5cac52dbb4dd400cce00b635548a367b605a2d7", "committedDate": "2020-03-13T22:37:04Z", "message": "feat add REGEXP_EXTRACT UDF"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2455d2f59db06de2ac8d39f3d67a3aa62056935", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/e2455d2f59db06de2ac8d39f3d67a3aa62056935", "committedDate": "2020-03-13T22:28:48Z", "message": "feat: add REGEXP_EXTRACT udf"}, "afterCommit": {"oid": "b909c326e9b0846dd357b3eb8450b69ad90ebe04", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/b909c326e9b0846dd357b3eb8450b69ad90ebe04", "committedDate": "2020-03-13T22:51:00Z", "message": "plans"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1133a47e7f611583877cf673cf39ebadb1836816", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/1133a47e7f611583877cf673cf39ebadb1836816", "committedDate": "2020-03-13T22:52:04Z", "message": "plans"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b909c326e9b0846dd357b3eb8450b69ad90ebe04", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/b909c326e9b0846dd357b3eb8450b69ad90ebe04", "committedDate": "2020-03-13T22:51:00Z", "message": "plans"}, "afterCommit": {"oid": "1133a47e7f611583877cf673cf39ebadb1836816", "author": {"user": {"login": "stevenpyzhang", "name": "Steven Zhang"}}, "url": "https://github.com/confluentinc/ksql/commit/1133a47e7f611583877cf673cf39ebadb1836816", "committedDate": "2020-03-13T22:52:04Z", "message": "plans"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4925, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}