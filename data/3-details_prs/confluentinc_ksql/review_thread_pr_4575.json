{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1NzQ5NDIz", "number": 4575, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0MDo0NlrODgzyHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0MTozNlrODgzzHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NzI5NDM2OnYy", "diffSide": "RIGHT", "path": "ksql-streams/src/main/java/io/confluent/ksql/execution/streams/GroupByParamsFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0MDo0NlrOFrN7Yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0MDo0NlrOFrN7Yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg2MTI4Mg==", "bodyText": "Do we want to remove the LOG.error line below now that we have this?  Seems unnecessary to log the error twice.\nOther uses of the processing logger don't double log.", "url": "https://github.com/confluentinc/ksql/pull/4575#discussion_r380861282", "createdAt": "2020-02-18T18:40:46Z", "author": {"login": "big-andy-coates"}, "path": "ksql-streams/src/main/java/io/confluent/ksql/execution/streams/GroupByParamsFactory.java", "diffHunk": "@@ -82,16 +93,36 @@ private static LogicalSchema buildSchema(\n   private static Object processColumn(\n       final int index,\n       final ExpressionMetadata exp,\n-      final GenericRow row\n+      final GenericRow row,\n+      final ProcessingLogger logger\n   ) {\n     try {\n       final Object result = exp.evaluate(row);\n       if (result == null) {\n+        logger.error(\n+            EngineProcessingLogMessageFactory.recordProcessingError(\n+               String.format(\n+                   \"Group-by column with index %d resolved to null.\"\n+                       + \" The source row will be excluded from the table.\",\n+                   index),\n+                row\n+            )\n+        );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05cd4803a9b906c9530172cd5350834f1dba285c"}, "originalPosition": 89}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NzI5NjkzOnYy", "diffSide": "RIGHT", "path": "ksql-streams/src/main/java/io/confluent/ksql/execution/streams/GroupByParamsFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0MTozNlrOFrN9Eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0MTozNlrOFrN9Eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg2MTcxNA==", "bodyText": "Same again - remove the LOG.error below.  - and you can remove the LOG field too.", "url": "https://github.com/confluentinc/ksql/pull/4575#discussion_r380861714", "createdAt": "2020-02-18T18:41:36Z", "author": {"login": "big-andy-coates"}, "path": "ksql-streams/src/main/java/io/confluent/ksql/execution/streams/GroupByParamsFactory.java", "diffHunk": "@@ -82,16 +93,36 @@ private static LogicalSchema buildSchema(\n   private static Object processColumn(\n       final int index,\n       final ExpressionMetadata exp,\n-      final GenericRow row\n+      final GenericRow row,\n+      final ProcessingLogger logger\n   ) {\n     try {\n       final Object result = exp.evaluate(row);\n       if (result == null) {\n+        logger.error(\n+            EngineProcessingLogMessageFactory.recordProcessingError(\n+               String.format(\n+                   \"Group-by column with index %d resolved to null.\"\n+                       + \" The source row will be excluded from the table.\",\n+                   index),\n+                row\n+            )\n+        );\n         LOG.error(\"Group-by column with index {} resolved to null. \"\n             + \"The source row will be excluded from the table.\", index);\n       }\n       return result;\n     } catch (final Exception e) {\n+      logger.error(\n+          EngineProcessingLogMessageFactory.recordProcessingError(\n+              String.format(\n+                  \"Error calculating group-by column with index %d. \"\n+                      + \"The source row will be excluded from the table: %s\",\n+                  index, e.getMessage()),\n+              e,\n+              row\n+          )\n+      );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05cd4803a9b906c9530172cd5350834f1dba285c"}, "originalPosition": 104}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2175, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}