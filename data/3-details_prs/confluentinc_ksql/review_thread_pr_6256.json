{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5MzIxMzA3", "number": 6256, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzozOTozMVrOEk-WXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxOTo1NToyM1rOElGQ8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjA1NzI0OnYy", "diffSide": "LEFT", "path": "ksqldb-common/src/main/java/io/confluent/ksql/serde/SerdeOptions.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzozOTozMVrOHUNkhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzozOTozMVrOHUNkhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk1NTkwOA==", "bodyText": "Dropped these in favour of findAny, which is more generic.", "url": "https://github.com/confluentinc/ksql/pull/6256#discussion_r490955908", "createdAt": "2020-09-18T13:39:31Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/serde/SerdeOptions.java", "diffHunk": "@@ -60,33 +59,22 @@ private SerdeOptions(final ImmutableSet<SerdeOption> options) {\n     validate(this.options);\n   }\n \n-  @SuppressWarnings(\"MethodMayBeStatic\")\n   public EnabledSerdeFeatures keyFeatures() {\n-    // Currently there are no key features:\n-    return EnabledSerdeFeatures.of();\n+    return features(true);\n   }\n \n   public EnabledSerdeFeatures valueFeatures() {\n-    // Currently there are no key features, so all are value features:\n-    return EnabledSerdeFeatures.from(options.stream()\n-        .map(SerdeOption::requiredFeature)\n-        .collect(Collectors.toSet()));\n+    return features(false);\n   }\n \n   public Set<SerdeOption> all() {\n     return options;\n   }\n \n-  public Optional<SerdeOption> keyWrapping() {\n-    return Optional.ofNullable(\n-        Iterables.getFirst(Sets.intersection(options, KEY_WRAPPING_OPTIONS), null)\n-    );\n-  }\n-\n-  public Optional<SerdeOption> valueWrapping() {\n-    return Optional.ofNullable(\n-        Iterables.getFirst(Sets.intersection(options, VALUE_WRAPPING_OPTIONS), null)\n-    );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19321cfae6d50aa1d73845825d51d18f1de82d27"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MjA1OTc3OnYy", "diffSide": "RIGHT", "path": "ksqldb-common/src/main/java/io/confluent/ksql/serde/SerdeOptions.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzo0MDowN1rOHUNl9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMzo0MDowN1rOHUNl9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk1NjI3Ng==", "bodyText": "key features are now returned as key features, not value features!", "url": "https://github.com/confluentinc/ksql/pull/6256#discussion_r490956276", "createdAt": "2020-09-18T13:40:07Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/serde/SerdeOptions.java", "diffHunk": "@@ -111,6 +99,13 @@ public String toString() {\n     return options.toString();\n   }\n \n+  private EnabledSerdeFeatures features(final boolean key) {\n+    return EnabledSerdeFeatures.from(options.stream()\n+        .filter(option -> option.isKeyOption() == key)\n+        .map(SerdeOption::requiredFeature)\n+        .collect(Collectors.toSet()));\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19321cfae6d50aa1d73845825d51d18f1de82d27"}, "originalPosition": 71}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MzM1NDExOnYy", "diffSide": "RIGHT", "path": "ksqldb-common/src/main/java/io/confluent/ksql/serde/SerdeOption.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxOTo1NToyM1rOHUaE4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDo0NzoxMVrOHUbb9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE2MDgwMg==", "bodyText": "Does it make sense to assume all serde options will always be either key- or value-specific, never both nor neither? Can't think of why this wouldn't be true in the future but seemed worth double-checking.", "url": "https://github.com/confluentinc/ksql/pull/6256#discussion_r491160802", "createdAt": "2020-09-18T19:55:23Z", "author": {"login": "vcrfxia"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/serde/SerdeOption.java", "diffHunk": "@@ -38,19 +38,25 @@\n    *\n    * @see SerdeOption#WRAP_SINGLE_VALUES\n    */\n-  UNWRAP_SINGLE_VALUES(SerdeFeature.UNWRAP_SINGLES),\n+  UNWRAP_SINGLE_VALUES(SerdeFeature.UNWRAP_SINGLES, false),\n \n   /**\n    * Key version of {@link #UNWRAP_SINGLE_VALUES}.\n    */\n-  UNWRAP_SINGLE_KEYS(SerdeFeature.UNWRAP_SINGLES);\n+  UNWRAP_SINGLE_KEYS(SerdeFeature.UNWRAP_SINGLES, true);\n \n+  private final boolean isKey;\n   private final SerdeFeature requiredFeature;\n \n-  SerdeOption(final SerdeFeature requiredFeature) {\n+  SerdeOption(final SerdeFeature requiredFeature, final boolean isKey) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19321cfae6d50aa1d73845825d51d18f1de82d27"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE4MzA5Mw==", "bodyText": "That's the assumption at the moment.  If that changes... we change the code! ;)\nIdeally, we'd ditch SerdeOption and just keep SerdeFeature, but that's a bigger change.", "url": "https://github.com/confluentinc/ksql/pull/6256#discussion_r491183093", "createdAt": "2020-09-18T20:47:11Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/serde/SerdeOption.java", "diffHunk": "@@ -38,19 +38,25 @@\n    *\n    * @see SerdeOption#WRAP_SINGLE_VALUES\n    */\n-  UNWRAP_SINGLE_VALUES(SerdeFeature.UNWRAP_SINGLES),\n+  UNWRAP_SINGLE_VALUES(SerdeFeature.UNWRAP_SINGLES, false),\n \n   /**\n    * Key version of {@link #UNWRAP_SINGLE_VALUES}.\n    */\n-  UNWRAP_SINGLE_KEYS(SerdeFeature.UNWRAP_SINGLES);\n+  UNWRAP_SINGLE_KEYS(SerdeFeature.UNWRAP_SINGLES, true);\n \n+  private final boolean isKey;\n   private final SerdeFeature requiredFeature;\n \n-  SerdeOption(final SerdeFeature requiredFeature) {\n+  SerdeOption(final SerdeFeature requiredFeature, final boolean isKey) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE2MDgwMg=="}, "originalCommit": {"oid": "19321cfae6d50aa1d73845825d51d18f1de82d27"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2802, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}