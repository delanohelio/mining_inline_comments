{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3MTQ5OTYx", "number": 4591, "title": "test: Add ImmutabilityTest", "bodyText": "Description\nThis PR adds Immutability test which makes sure classes marked with @immutable really are immutable.\nIt also removes @immutable from 3 classes as making them @immutable serves little purpose and we don't want to be forced to make too many copies in perf sensitive code.\nAlso please see #4410\nTesting done\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-02-19T12:45:52Z", "url": "https://github.com/confluentinc/ksql/pull/4591", "merged": true, "mergeCommit": {"oid": "817ef4200ec771cd4bed2f0ff99d3a2ed94e5071"}, "closed": true, "closedAt": "2020-02-28T11:11:19Z", "author": {"login": "purplefox"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcF6lnYgFqTM2MTMxNzY1NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcItMgiABqjMwODEzNzA3Mzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMzE3NjU1", "url": "https://github.com/confluentinc/ksql/pull/4591#pullrequestreview-361317655", "createdAt": "2020-02-19T18:08:26Z", "commit": {"oid": "99bdd2052fb150342536cdbb966867298b016d26"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODowODoyNlrOFrx63A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxODoxMDozMVrOFrx_NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ1MDk3Mg==", "bodyText": "It would be preferable to have all the protocol model classes immutable.\nAll you need to do is change the JsonObject to ImmutableMap.  This is actually preferable, as exposing properties is currently exposing mutable internal state, which ain't pretty.\n public final ImmutableMap<String, Object> properties;\n\n...   \n\nthis.properties = properties == null \n    ? ImmutableMap.of()\n     : ImmutableMap.copyOf(properties);", "url": "https://github.com/confluentinc/ksql/pull/4591#discussion_r381450972", "createdAt": "2020-02-19T18:08:26Z", "author": {"login": "big-andy-coates"}, "path": "ksql-api/src/main/java/io/confluent/ksql/api/server/protocol/InsertsStreamArgs.java", "diffHunk": "@@ -16,15 +16,13 @@\n package io.confluent.ksql.api.server.protocol;\n \n import com.fasterxml.jackson.annotation.JsonProperty;\n-import com.google.errorprone.annotations.Immutable;\n import io.vertx.core.json.JsonObject;\n import java.util.Map;\n import java.util.Objects;\n \n /**\n  * Represents the arguments to an insert stream request\n  */\n-@Immutable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99bdd2052fb150342536cdbb966867298b016d26"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ1MTkxMg==", "bodyText": "As above.", "url": "https://github.com/confluentinc/ksql/pull/4591#discussion_r381451912", "createdAt": "2020-02-19T18:10:12Z", "author": {"login": "big-andy-coates"}, "path": "ksql-api/src/main/java/io/confluent/ksql/api/server/protocol/QueryResponseMetadata.java", "diffHunk": "@@ -15,14 +15,12 @@\n \n package io.confluent.ksql.api.server.protocol;\n \n-import com.google.errorprone.annotations.Immutable;\n import java.util.List;\n import java.util.Objects;\n \n /**\n  * Represents the metadata of a query stream response\n  */\n-@Immutable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99bdd2052fb150342536cdbb966867298b016d26"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ1MjA4NQ==", "bodyText": "As above.", "url": "https://github.com/confluentinc/ksql/pull/4591#discussion_r381452085", "createdAt": "2020-02-19T18:10:31Z", "author": {"login": "big-andy-coates"}, "path": "ksql-api/src/main/java/io/confluent/ksql/api/server/protocol/QueryStreamArgs.java", "diffHunk": "@@ -16,15 +16,13 @@\n package io.confluent.ksql.api.server.protocol;\n \n import com.fasterxml.jackson.annotation.JsonProperty;\n-import com.google.errorprone.annotations.Immutable;\n import io.vertx.core.json.JsonObject;\n import java.util.Map;\n import java.util.Objects;\n \n /**\n  * Represents the arguments to a query stream request\n  */\n-@Immutable", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99bdd2052fb150342536cdbb966867298b016d26"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79e0c81d7403be2d3f39bbe2eacaa0ce144188a8", "author": {"user": {"login": "purplefox", "name": "Tim Fox"}}, "url": "https://github.com/confluentinc/ksql/commit/79e0c81d7403be2d3f39bbe2eacaa0ce144188a8", "committedDate": "2020-02-28T10:15:31Z", "message": "Make QueryResponseMetadata immutable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "99bdd2052fb150342536cdbb966867298b016d26", "author": {"user": {"login": "purplefox", "name": "Tim Fox"}}, "url": "https://github.com/confluentinc/ksql/commit/99bdd2052fb150342536cdbb966867298b016d26", "committedDate": "2020-02-19T12:43:24Z", "message": "immutability test"}, "afterCommit": {"oid": "79e0c81d7403be2d3f39bbe2eacaa0ce144188a8", "author": {"user": {"login": "purplefox", "name": "Tim Fox"}}, "url": "https://github.com/confluentinc/ksql/commit/79e0c81d7403be2d3f39bbe2eacaa0ce144188a8", "committedDate": "2020-02-28T10:15:31Z", "message": "Make QueryResponseMetadata immutable"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 55, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}