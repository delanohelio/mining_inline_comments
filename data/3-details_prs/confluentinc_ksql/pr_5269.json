{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNTkwNDU0", "number": 5269, "title": "docs: klip-27: Enhanced UDF Configuration Options", "bodyText": "", "createdAt": "2020-05-05T15:31:12Z", "url": "https://github.com/confluentinc/ksql/pull/5269", "merged": true, "mergeCommit": {"oid": "270290aae92bc606288f1e96b0d2790f7dd66ece"}, "closed": true, "closedAt": "2020-06-25T16:09:47Z", "author": {"login": "hpgrahsl"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciw946gFqTQxNDI2MTQxNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuw0uhAH2gAyNDEzNTkwNDU0OjZhZDc5N2U4MWMzOTI5MGM2NmE4MGI3MzIyYzI2MjVhYWYyYWJhYjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0MjYxNDE3", "url": "https://github.com/confluentinc/ksql/pull/5269#pullrequestreview-414261417", "createdAt": "2020-05-19T09:22:33Z", "commit": {"oid": "d97e147bfc082d45ca395bca2b5699ec2b7329fb"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28ac18aa19a81d6acaacd3ebb981805333025416", "author": {"user": {"login": "hpgrahsl", "name": "Hans-Peter Grahsl"}}, "url": "https://github.com/confluentinc/ksql/commit/28ac18aa19a81d6acaacd3ebb981805333025416", "committedDate": "2020-05-30T07:42:10Z", "message": "docs: klip-27: Enhanced UDF Configuration Options\n\nupdates according to the PR discussion #5269"}, "afterCommit": {"oid": "9d9f6bbc1801a8b56d4e6252aa6eb761887017fd", "author": {"user": {"login": "hpgrahsl", "name": "Hans-Peter Grahsl"}}, "url": "https://github.com/confluentinc/ksql/commit/9d9f6bbc1801a8b56d4e6252aa6eb761887017fd", "committedDate": "2020-05-30T07:57:57Z", "message": "docs: klip-27: Enhanced UDF Configuration Options\n\nupdates according to the PR discussion #5269"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNzY2MzY4", "url": "https://github.com/confluentinc/ksql/pull/5269#pullrequestreview-421766368", "createdAt": "2020-06-01T11:14:46Z", "commit": {"oid": "9d9f6bbc1801a8b56d4e6252aa6eb761887017fd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNDo0N1rOGdG-hQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQxMToxNDo0N1rOGdG-hQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3NjE5Nw==", "bodyText": "Will the scope cover UDAFs and UDTFs too?", "url": "https://github.com/confluentinc/ksql/pull/5269#discussion_r433176197", "createdAt": "2020-06-01T11:14:47Z", "author": {"login": "big-andy-coates"}, "path": "design-proposals/klip-27-enhanced-udf-configuration-options.md", "diffHunk": "@@ -0,0 +1,80 @@\n+# KLIP 27 - Enhanced UDF Configuration Options\n+\n+**Author**: Hans-Peter Grahsl (@hpgrahsl) | \n+**Release Target**: ??? | \n+**Status**: _Approved_ | \n+**Discussion**: [GitHub PR](https://github.com/confluentinc/ksql/pull/5269)\n+\n+**tl;dr:** This KLIP suggests to introduce a new configuration option in order to externally define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. At the same time, support for the `_global_` scope of configuration settings should get dropped.\n+\n+## Motivation and background\n+\n+Currently, ksqlDB supports two different ways to configure UDFs based on entries defined in `ksql-server.properties`:\n+\n+* either the configuration properties are directly bound to a single, specific UDF class and applicable to potentially existing overloaded methods - e.g. `ksql.functions.<myudfname>.<mysetting>=foo`\n+\n+* or we can have properties defined in a special scope, making them globally accessible - e.g. `ksql.functions._global_.<mysetting>=1234`\n+\n+The latter approach means that properties are readable by any(!) other UDF that gets loaded during bootstrap. While this may or may not be an issue depending on the type of properties, in general, it can be considered less than ideal. For instance, this leads to security concerns for sensitive configuration properties such as secrets / tokens / passwords, which is why the `_global_` scope should get dropped.\n+\n+## What is in scope\n+\n+This KLIP aims to allow for multiple, yet specifically defined UDFs, to share configuration properties other than \"misusing\" the global properties scope.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d9f6bbc1801a8b56d4e6252aa6eb761887017fd"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8063abf0f5aec8887b0578681d99b30ef3b429b0", "author": {"user": {"login": "hpgrahsl", "name": "Hans-Peter Grahsl"}}, "url": "https://github.com/confluentinc/ksql/commit/8063abf0f5aec8887b0578681d99b30ef3b429b0", "committedDate": "2020-06-23T06:59:19Z", "message": "docs: klip-27: Enhanced UDF Configuration Options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d81a49000834aa3d2146d676d18e89644c2f2985", "author": {"user": {"login": "hpgrahsl", "name": "Hans-Peter Grahsl"}}, "url": "https://github.com/confluentinc/ksql/commit/d81a49000834aa3d2146d676d18e89644c2f2985", "committedDate": "2020-06-23T06:59:20Z", "message": "docs: klip-27: Enhanced UDF Configuration Options\n\nupdates according to the PR discussion #5269"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e", "author": {"user": {"login": "hpgrahsl", "name": "Hans-Peter Grahsl"}}, "url": "https://github.com/confluentinc/ksql/commit/0637c823eebcc8278c25a667bdf64ba95349466e", "committedDate": "2020-06-23T06:59:21Z", "message": "docs: klip-27: Enhanced UDF Configuration Options\n\nfurther updates according to latest PR discussion #5269"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9d9f6bbc1801a8b56d4e6252aa6eb761887017fd", "author": {"user": {"login": "hpgrahsl", "name": "Hans-Peter Grahsl"}}, "url": "https://github.com/confluentinc/ksql/commit/9d9f6bbc1801a8b56d4e6252aa6eb761887017fd", "committedDate": "2020-05-30T07:57:57Z", "message": "docs: klip-27: Enhanced UDF Configuration Options\n\nupdates according to the PR discussion #5269"}, "afterCommit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e", "author": {"user": {"login": "hpgrahsl", "name": "Hans-Peter Grahsl"}}, "url": "https://github.com/confluentinc/ksql/commit/0637c823eebcc8278c25a667bdf64ba95349466e", "committedDate": "2020-06-23T06:59:21Z", "message": "docs: klip-27: Enhanced UDF Configuration Options\n\nfurther updates according to latest PR discussion #5269"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MjQ3MTg1", "url": "https://github.com/confluentinc/ksql/pull/5269#pullrequestreview-436247185", "createdAt": "2020-06-24T00:30:44Z", "commit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwMDozMjoxNlrOGn_A3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwMDozMjoxNlrOGn_A3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU4MDA2MQ==", "bodyText": "this seems no longer accurate either (* is not being introduced). With this newer approach, can we just make it backwards compatible and keep the _global_ scope?", "url": "https://github.com/confluentinc/ksql/pull/5269#discussion_r444580061", "createdAt": "2020-06-24T00:32:16Z", "author": {"login": "agavra"}, "path": "design-proposals/klip-27-enhanced-udf-configuration-options.md", "diffHunk": "@@ -0,0 +1,111 @@\n+# KLIP 27 - Enhanced UDF Configuration Options\n+\n+**Author**: Hans-Peter Grahsl (@hpgrahsl) | \n+**Release Target**: ??? | \n+**Status**: _Approved_ | \n+**Discussion**: [GitHub PR](https://github.com/confluentinc/ksql/pull/5269)\n+\n+**tl;dr:** This KLIP suggests to introduce a new configuration option in order to define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. At the same time, support for the `_global_` scope of configuration settings should get dropped.\n+\n+## Motivation and background\n+\n+Currently, ksqlDB supports two different ways to configure UDFs based on entries defined in `ksql-server.properties`:\n+\n+* either the configuration properties are directly bound to a single, specific UDF class and applicable to potentially existing overloaded methods - e.g. `ksql.functions.<myudfname>.<mysetting>=foo`\n+\n+* or we can have properties defined in a special scope, making them globally accessible - e.g. `ksql.functions._global_.<mysetting>=1234`\n+\n+The latter approach means that properties are readable by any(!) other UDF that gets loaded during bootstrap. While this may or may not be an issue depending on the type of properties, in general, it can be considered less than ideal. For instance, this leads to security concerns for sensitive configuration properties such as secrets / tokens / passwords, which is why the `_global_` scope should get dropped.\n+\n+## What is in scope\n+\n+This KLIP aims to allow for multiple, yet specifically defined UDFs, to share configuration properties other than \"misusing\" the global properties scope.\n+\n+## What is not in scope\n+\n+The scope of this KLIP is not a complete rewrite of the current configuration mechanisms, but a modified implementation that suppports the sharing of configuration properties between specific (custom) UDFs.\n+\n+## Value/Return\n+\n+The main value of this KLIP lies in the fact that users can easily define certain configuration properties that are shared by N >= 2 UDFs. This can be done without specifying such properties multiple times, once for each UDF in need, or without \"misusing the global scope\", both of which can be considered workarounds at best.\n+\n+## Public APIS\n+\n+There should neither be public API changes nor any KSQL query language modifications necessary. Ideally, the chosen implementation allows for existing configurations to be upgraded / migrated to newer ksqlDB versions without changes for configurations tied to specific UDFs.\n+\n+**Note however, that for workloads which make use of the `_global_` scope it will lead to a breaking change since support for this  gets dropped.**\n+\n+## Design\n+\n+A simple approach is to extend the function meta-data and add a _groups_ option to the `@UdfDecription` annotation, which takes a list of strings. Each string entry in _groups_ explicitly defines a name used to logically group functions for which to share configuration properties.\n+\n+Given the following example:\n+\n+```java\n+@UdfDescription(\n+    name = \"someudf\",\n+    description = \"...\",\n+    author = \"...\",\n+    version = \"...\",\n+    groups = {\"shareit\"/*,\"...\"*/})\n+public class SomeUdf implements Configurable {\n+    //...\n+}\n+```\n+\n+allows to configure the function _someudf_ using `ksql.functions.someudf.my.value.x=foo` (basic, single-UDF config) or `ksql.groups.functions.shareit.my.value.x=foo` (grouped config across several functions declaring the same group name(s)). This distinction also makes it obvious, whether configuration properties are set for single functions or several grouped functions respectively.\n+\n+A drawback of the meta-data driven approach is that the group information must be declared in the code. If this restriction turns out to be an issue, a future enhancement could allow to explicitly define the group information in the configuration properties like so:  ?`ksql.groups.define.group_name=...,...` which for the particular example above would read `ksql.groups.define.shareit=someudf`.\n+\n+The benefits of this design are:\n+\n+* full backwards compatibility because groups config meta-data is a new option\n+* the default and most common case is to configure a single function which means that it stays simple for users\n+* it is easy to add new configurations\n+* the grouping is neither derived from the name itself (e.g. prefix matching) nor is it tied to java package naming convention\n+\n+## Test plan\n+\n+Test and failure scenarios are rather straight-foward, focusing only on different ways to set and read configuration properties for UDFs. There shouldn't be a need for scale/load/performance testing because this KLIP doesn't affect any criticial areas in that regard.\n+\n+## LOEs and Delivery Milestones\n+\n+To be defined by product manager and team.\n+\n+## Documentation Updates\n+\n+The current documentation regarding configuration options for custom UDFs isn't overly specific but of course needs to be updated accordingly. **It's important to be very clear and call out the dropped support of the `_global_` configuration scope which leads to a breaking change for upgrading/migrating workloads.**\n+\n+## Compatibility Implications\n+\n+As the design proposal suggests to remove support of the `_global_` scope, this means that upgrading the ksqlDB version will lead to a breaking change in that regard. However, the implementation of the `*` wildcard prefix matching of UDFs' names should be carried out in a backwards compatible way such that it can reasonably support the \"old\" (i.e. current) and the \"new\" (i.e. what's proposed here) configuration options in parallel.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e"}, "originalPosition": 81}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NzUxOTUy", "url": "https://github.com/confluentinc/ksql/pull/5269#pullrequestreview-436751952", "createdAt": "2020-06-24T15:18:13Z", "commit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNToxODoxM1rOGoXCHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNzowNTo0NVrOGobSMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk3MzU5OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            **tl;dr:** This KLIP suggests to introduce a new configuration option in order to define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. At the same time, support for the `_global_` scope of configuration settings should get dropped.\n          \n          \n            \n            **tl;dr:** This KLIP suggests to introduce a new configuration option in order to define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. \n          \n      \n    \n    \n  \n\nI'm with @agavra here - I think this new functionality is complimentary to the existing functionality. I don't think we lose anything by keeping the existing _global_ scope, do we?  But we do gain backwards compatibility.", "url": "https://github.com/confluentinc/ksql/pull/5269#discussion_r444973599", "createdAt": "2020-06-24T15:18:13Z", "author": {"login": "big-andy-coates"}, "path": "design-proposals/klip-27-enhanced-udf-configuration-options.md", "diffHunk": "@@ -0,0 +1,111 @@\n+# KLIP 27 - Enhanced UDF Configuration Options\n+\n+**Author**: Hans-Peter Grahsl (@hpgrahsl) | \n+**Release Target**: ??? | \n+**Status**: _Approved_ | \n+**Discussion**: [GitHub PR](https://github.com/confluentinc/ksql/pull/5269)\n+\n+**tl;dr:** This KLIP suggests to introduce a new configuration option in order to define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. At the same time, support for the `_global_` scope of configuration settings should get dropped.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA0MDUwMA==", "bodyText": "Can we call out UDTFs and UDAFs in the scope to be clear please?", "url": "https://github.com/confluentinc/ksql/pull/5269#discussion_r445040500", "createdAt": "2020-06-24T17:01:05Z", "author": {"login": "big-andy-coates"}, "path": "design-proposals/klip-27-enhanced-udf-configuration-options.md", "diffHunk": "@@ -0,0 +1,80 @@\n+# KLIP 27 - Enhanced UDF Configuration Options\n+\n+**Author**: Hans-Peter Grahsl (@hpgrahsl) | \n+**Release Target**: ??? | \n+**Status**: _Approved_ | \n+**Discussion**: [GitHub PR](https://github.com/confluentinc/ksql/pull/5269)\n+\n+**tl;dr:** This KLIP suggests to introduce a new configuration option in order to externally define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. At the same time, support for the `_global_` scope of configuration settings should get dropped.\n+\n+## Motivation and background\n+\n+Currently, ksqlDB supports two different ways to configure UDFs based on entries defined in `ksql-server.properties`:\n+\n+* either the configuration properties are directly bound to a single, specific UDF class and applicable to potentially existing overloaded methods - e.g. `ksql.functions.<myudfname>.<mysetting>=foo`\n+\n+* or we can have properties defined in a special scope, making them globally accessible - e.g. `ksql.functions._global_.<mysetting>=1234`\n+\n+The latter approach means that properties are readable by any(!) other UDF that gets loaded during bootstrap. While this may or may not be an issue depending on the type of properties, in general, it can be considered less than ideal. For instance, this leads to security concerns for sensitive configuration properties such as secrets / tokens / passwords, which is why the `_global_` scope should get dropped.\n+\n+## What is in scope\n+\n+This KLIP aims to allow for multiple, yet specifically defined UDFs, to share configuration properties other than \"misusing\" the global properties scope.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzE3NjE5Nw=="}, "originalCommit": {"oid": "9d9f6bbc1801a8b56d4e6252aa6eb761887017fd"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA0MTYyOQ==", "bodyText": "Can you mention adding group to @UdtfDescription and @UdafDescription too please.", "url": "https://github.com/confluentinc/ksql/pull/5269#discussion_r445041629", "createdAt": "2020-06-24T17:02:58Z", "author": {"login": "big-andy-coates"}, "path": "design-proposals/klip-27-enhanced-udf-configuration-options.md", "diffHunk": "@@ -0,0 +1,111 @@\n+# KLIP 27 - Enhanced UDF Configuration Options\n+\n+**Author**: Hans-Peter Grahsl (@hpgrahsl) | \n+**Release Target**: ??? | \n+**Status**: _Approved_ | \n+**Discussion**: [GitHub PR](https://github.com/confluentinc/ksql/pull/5269)\n+\n+**tl;dr:** This KLIP suggests to introduce a new configuration option in order to define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. At the same time, support for the `_global_` scope of configuration settings should get dropped.\n+\n+## Motivation and background\n+\n+Currently, ksqlDB supports two different ways to configure UDFs based on entries defined in `ksql-server.properties`:\n+\n+* either the configuration properties are directly bound to a single, specific UDF class and applicable to potentially existing overloaded methods - e.g. `ksql.functions.<myudfname>.<mysetting>=foo`\n+\n+* or we can have properties defined in a special scope, making them globally accessible - e.g. `ksql.functions._global_.<mysetting>=1234`\n+\n+The latter approach means that properties are readable by any(!) other UDF that gets loaded during bootstrap. While this may or may not be an issue depending on the type of properties, in general, it can be considered less than ideal. For instance, this leads to security concerns for sensitive configuration properties such as secrets / tokens / passwords, which is why the `_global_` scope should get dropped.\n+\n+## What is in scope\n+\n+This KLIP aims to allow for multiple, yet specifically defined UDFs, to share configuration properties other than \"misusing\" the global properties scope.\n+\n+## What is not in scope\n+\n+The scope of this KLIP is not a complete rewrite of the current configuration mechanisms, but a modified implementation that suppports the sharing of configuration properties between specific (custom) UDFs.\n+\n+## Value/Return\n+\n+The main value of this KLIP lies in the fact that users can easily define certain configuration properties that are shared by N >= 2 UDFs. This can be done without specifying such properties multiple times, once for each UDF in need, or without \"misusing the global scope\", both of which can be considered workarounds at best.\n+\n+## Public APIS\n+\n+There should neither be public API changes nor any KSQL query language modifications necessary. Ideally, the chosen implementation allows for existing configurations to be upgraded / migrated to newer ksqlDB versions without changes for configurations tied to specific UDFs.\n+\n+**Note however, that for workloads which make use of the `_global_` scope it will lead to a breaking change since support for this  gets dropped.**\n+\n+## Design\n+\n+A simple approach is to extend the function meta-data and add a _groups_ option to the `@UdfDecription` annotation, which takes a list of strings. Each string entry in _groups_ explicitly defines a name used to logically group functions for which to share configuration properties.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA0MjQ4MA==", "bodyText": "Do we feel there is benefit from allowing a Udf to be a member of multiple groups?  Can we think of usecases where this would be useful.  I guess we could have a company group, and a department group...", "url": "https://github.com/confluentinc/ksql/pull/5269#discussion_r445042480", "createdAt": "2020-06-24T17:04:22Z", "author": {"login": "big-andy-coates"}, "path": "design-proposals/klip-27-enhanced-udf-configuration-options.md", "diffHunk": "@@ -0,0 +1,111 @@\n+# KLIP 27 - Enhanced UDF Configuration Options\n+\n+**Author**: Hans-Peter Grahsl (@hpgrahsl) | \n+**Release Target**: ??? | \n+**Status**: _Approved_ | \n+**Discussion**: [GitHub PR](https://github.com/confluentinc/ksql/pull/5269)\n+\n+**tl;dr:** This KLIP suggests to introduce a new configuration option in order to define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. At the same time, support for the `_global_` scope of configuration settings should get dropped.\n+\n+## Motivation and background\n+\n+Currently, ksqlDB supports two different ways to configure UDFs based on entries defined in `ksql-server.properties`:\n+\n+* either the configuration properties are directly bound to a single, specific UDF class and applicable to potentially existing overloaded methods - e.g. `ksql.functions.<myudfname>.<mysetting>=foo`\n+\n+* or we can have properties defined in a special scope, making them globally accessible - e.g. `ksql.functions._global_.<mysetting>=1234`\n+\n+The latter approach means that properties are readable by any(!) other UDF that gets loaded during bootstrap. While this may or may not be an issue depending on the type of properties, in general, it can be considered less than ideal. For instance, this leads to security concerns for sensitive configuration properties such as secrets / tokens / passwords, which is why the `_global_` scope should get dropped.\n+\n+## What is in scope\n+\n+This KLIP aims to allow for multiple, yet specifically defined UDFs, to share configuration properties other than \"misusing\" the global properties scope.\n+\n+## What is not in scope\n+\n+The scope of this KLIP is not a complete rewrite of the current configuration mechanisms, but a modified implementation that suppports the sharing of configuration properties between specific (custom) UDFs.\n+\n+## Value/Return\n+\n+The main value of this KLIP lies in the fact that users can easily define certain configuration properties that are shared by N >= 2 UDFs. This can be done without specifying such properties multiple times, once for each UDF in need, or without \"misusing the global scope\", both of which can be considered workarounds at best.\n+\n+## Public APIS\n+\n+There should neither be public API changes nor any KSQL query language modifications necessary. Ideally, the chosen implementation allows for existing configurations to be upgraded / migrated to newer ksqlDB versions without changes for configurations tied to specific UDFs.\n+\n+**Note however, that for workloads which make use of the `_global_` scope it will lead to a breaking change since support for this  gets dropped.**\n+\n+## Design\n+\n+A simple approach is to extend the function meta-data and add a _groups_ option to the `@UdfDecription` annotation, which takes a list of strings. Each string entry in _groups_ explicitly defines a name used to logically group functions for which to share configuration properties.\n+\n+Given the following example:\n+\n+```java\n+@UdfDescription(\n+    name = \"someudf\",\n+    description = \"...\",\n+    author = \"...\",\n+    version = \"...\",\n+    groups = {\"shareit\"/*,\"...\"*/})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA0MzI0OA==", "bodyText": "ksql.groups.functions.shareit.my.value.x=foo would more normally be ksql.functions.groups.shareit.my.value.x=foo.  I guess there is a risk this would clash with a groups udf...", "url": "https://github.com/confluentinc/ksql/pull/5269#discussion_r445043248", "createdAt": "2020-06-24T17:05:45Z", "author": {"login": "big-andy-coates"}, "path": "design-proposals/klip-27-enhanced-udf-configuration-options.md", "diffHunk": "@@ -0,0 +1,111 @@\n+# KLIP 27 - Enhanced UDF Configuration Options\n+\n+**Author**: Hans-Peter Grahsl (@hpgrahsl) | \n+**Release Target**: ??? | \n+**Status**: _Approved_ | \n+**Discussion**: [GitHub PR](https://github.com/confluentinc/ksql/pull/5269)\n+\n+**tl;dr:** This KLIP suggests to introduce a new configuration option in order to define UDF properties, that can be shared among a group / family of (custom) UDFs which logically belong together. At the same time, support for the `_global_` scope of configuration settings should get dropped.\n+\n+## Motivation and background\n+\n+Currently, ksqlDB supports two different ways to configure UDFs based on entries defined in `ksql-server.properties`:\n+\n+* either the configuration properties are directly bound to a single, specific UDF class and applicable to potentially existing overloaded methods - e.g. `ksql.functions.<myudfname>.<mysetting>=foo`\n+\n+* or we can have properties defined in a special scope, making them globally accessible - e.g. `ksql.functions._global_.<mysetting>=1234`\n+\n+The latter approach means that properties are readable by any(!) other UDF that gets loaded during bootstrap. While this may or may not be an issue depending on the type of properties, in general, it can be considered less than ideal. For instance, this leads to security concerns for sensitive configuration properties such as secrets / tokens / passwords, which is why the `_global_` scope should get dropped.\n+\n+## What is in scope\n+\n+This KLIP aims to allow for multiple, yet specifically defined UDFs, to share configuration properties other than \"misusing\" the global properties scope.\n+\n+## What is not in scope\n+\n+The scope of this KLIP is not a complete rewrite of the current configuration mechanisms, but a modified implementation that suppports the sharing of configuration properties between specific (custom) UDFs.\n+\n+## Value/Return\n+\n+The main value of this KLIP lies in the fact that users can easily define certain configuration properties that are shared by N >= 2 UDFs. This can be done without specifying such properties multiple times, once for each UDF in need, or without \"misusing the global scope\", both of which can be considered workarounds at best.\n+\n+## Public APIS\n+\n+There should neither be public API changes nor any KSQL query language modifications necessary. Ideally, the chosen implementation allows for existing configurations to be upgraded / migrated to newer ksqlDB versions without changes for configurations tied to specific UDFs.\n+\n+**Note however, that for workloads which make use of the `_global_` scope it will lead to a breaking change since support for this  gets dropped.**\n+\n+## Design\n+\n+A simple approach is to extend the function meta-data and add a _groups_ option to the `@UdfDecription` annotation, which takes a list of strings. Each string entry in _groups_ explicitly defines a name used to logically group functions for which to share configuration properties.\n+\n+Given the following example:\n+\n+```java\n+@UdfDescription(\n+    name = \"someudf\",\n+    description = \"...\",\n+    author = \"...\",\n+    version = \"...\",\n+    groups = {\"shareit\"/*,\"...\"*/})\n+public class SomeUdf implements Configurable {\n+    //...\n+}\n+```\n+\n+allows to configure the function _someudf_ using `ksql.functions.someudf.my.value.x=foo` (basic, single-UDF config) or `ksql.groups.functions.shareit.my.value.x=foo` (grouped config across several functions declaring the same group name(s)). This distinction also makes it obvious, whether configuration properties are set for single functions or several grouped functions respectively.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0637c823eebcc8278c25a667bdf64ba95349466e"}, "originalPosition": 56}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ad797e81c39290c66a80b7322c2625aaf2abab1", "author": {"user": {"login": "hpgrahsl", "name": "Hans-Peter Grahsl"}}, "url": "https://github.com/confluentinc/ksql/commit/6ad797e81c39290c66a80b7322c2625aaf2abab1", "committedDate": "2020-06-25T15:59:38Z", "message": "docs: klip-27: Enhanced UDF Configuration Options\n\nyet more updates according to latest PR discussion #5269"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4814, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}