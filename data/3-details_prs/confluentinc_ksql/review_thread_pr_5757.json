{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzMDEzNzE5", "number": 5757, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwMDo1NzowMVrOENc9fw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwMDo1NzowMVrOENc9fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgyNTQxNDM5OnYy", "diffSide": "RIGHT", "path": "ksqldb-common/src/main/java/io/confluent/ksql/metrics/MetricCollectors.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwMDo1NzowMVrOGwJJrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQyMDoyMzo0OFrOGxj6Gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEzNDc2Nw==", "bodyText": "if ksql.cluster.id and ksql.service.id are the same, why do we need both?", "url": "https://github.com/confluentinc/ksql/pull/5757#discussion_r453134767", "createdAt": "2020-07-11T00:57:01Z", "author": {"login": "xiaodongdu"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/metrics/MetricCollectors.java", "diffHunk": "@@ -143,22 +142,16 @@ public static void addConfigurableReporter(\n   }\n \n   public static Map<String, Object> addConfluentMetricsContextConfigs(\n-      final String ksqlServiceId\n+      final String ksqlServiceId,\n+      final String kafkaClusterId\n   ) {\n     final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_TYPE, KSQL_RESOURCE_TYPE);\n     updatedProps.put(RESOURCE_LABEL_CLUSTER_ID, ksqlServiceId);\n-    return updatedProps;\n-  }\n-\n-  public static Map<String, Object> addConfluentMetricsContextConfigsForKsql(\n-      final String ksqlServiceId\n-  ) {\n-    final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_KSQL_SERVICE_ID, ksqlServiceId);\n+    updatedProps.put(RESOURCE_LABEL_KAFKA_CLUSTER_ID, kafkaClusterId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkwMDMwNQ==", "bodyText": "we can remove RESOURCE_LABEL_KSQL_SERVICE_ID and just keep the cluster id label. The service id of a KSQL server is the only id for it so it essentially is the cluster id", "url": "https://github.com/confluentinc/ksql/pull/5757#discussion_r453900305", "createdAt": "2020-07-13T20:05:10Z", "author": {"login": "stevenpyzhang"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/metrics/MetricCollectors.java", "diffHunk": "@@ -143,22 +142,16 @@ public static void addConfigurableReporter(\n   }\n \n   public static Map<String, Object> addConfluentMetricsContextConfigs(\n-      final String ksqlServiceId\n+      final String ksqlServiceId,\n+      final String kafkaClusterId\n   ) {\n     final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_TYPE, KSQL_RESOURCE_TYPE);\n     updatedProps.put(RESOURCE_LABEL_CLUSTER_ID, ksqlServiceId);\n-    return updatedProps;\n-  }\n-\n-  public static Map<String, Object> addConfluentMetricsContextConfigsForKsql(\n-      final String ksqlServiceId\n-  ) {\n-    final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_KSQL_SERVICE_ID, ksqlServiceId);\n+    updatedProps.put(RESOURCE_LABEL_KAFKA_CLUSTER_ID, kafkaClusterId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEzNDc2Nw=="}, "originalCommit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzk4MjU0Ng==", "bodyText": "RESOURCE_LABEL_CLUSTER_ID and RESOURCE_LABEL_KAFKA_CLUSTER_ID are the same. I would recommend to keep RESOURCE_LABEL_KSQL_SERVICE_ID which is more meaningful for KSQL.", "url": "https://github.com/confluentinc/ksql/pull/5757#discussion_r453982546", "createdAt": "2020-07-13T22:31:10Z", "author": {"login": "xiaodongdu"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/metrics/MetricCollectors.java", "diffHunk": "@@ -143,22 +142,16 @@ public static void addConfigurableReporter(\n   }\n \n   public static Map<String, Object> addConfluentMetricsContextConfigs(\n-      final String ksqlServiceId\n+      final String ksqlServiceId,\n+      final String kafkaClusterId\n   ) {\n     final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_TYPE, KSQL_RESOURCE_TYPE);\n     updatedProps.put(RESOURCE_LABEL_CLUSTER_ID, ksqlServiceId);\n-    return updatedProps;\n-  }\n-\n-  public static Map<String, Object> addConfluentMetricsContextConfigsForKsql(\n-      final String ksqlServiceId\n-  ) {\n-    final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_KSQL_SERVICE_ID, ksqlServiceId);\n+    updatedProps.put(RESOURCE_LABEL_KAFKA_CLUSTER_ID, kafkaClusterId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEzNDc2Nw=="}, "originalCommit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAyODU5NQ==", "bodyText": "Oh I see, I was under the impression that the cluster id meant the ksql cluster id, not the kafka one. If that's the case, then I'll keep RESOURCE_LABEL_KSQL_SERVICE_ID", "url": "https://github.com/confluentinc/ksql/pull/5757#discussion_r454028595", "createdAt": "2020-07-14T00:39:14Z", "author": {"login": "stevenpyzhang"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/metrics/MetricCollectors.java", "diffHunk": "@@ -143,22 +142,16 @@ public static void addConfigurableReporter(\n   }\n \n   public static Map<String, Object> addConfluentMetricsContextConfigs(\n-      final String ksqlServiceId\n+      final String ksqlServiceId,\n+      final String kafkaClusterId\n   ) {\n     final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_TYPE, KSQL_RESOURCE_TYPE);\n     updatedProps.put(RESOURCE_LABEL_CLUSTER_ID, ksqlServiceId);\n-    return updatedProps;\n-  }\n-\n-  public static Map<String, Object> addConfluentMetricsContextConfigsForKsql(\n-      final String ksqlServiceId\n-  ) {\n-    final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_KSQL_SERVICE_ID, ksqlServiceId);\n+    updatedProps.put(RESOURCE_LABEL_KAFKA_CLUSTER_ID, kafkaClusterId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEzNDc2Nw=="}, "originalCommit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDA1NTIwMw==", "bodyText": "@stevenpyzhang @xiaodongdu I think it makes more sense to keep ksql.cluster.id as the KSQL service ID, and ksql.kafka.cluster.id as the backing cluster id to align with the terminology we already use in RBAC https://docs.confluent.io/current/security/rbac/rbac-get-cluster-ids.html#ksqldb-example\nWe should fix the other components if they don't align.", "url": "https://github.com/confluentinc/ksql/pull/5757#discussion_r454055203", "createdAt": "2020-07-14T02:10:05Z", "author": {"login": "xvrl"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/metrics/MetricCollectors.java", "diffHunk": "@@ -143,22 +142,16 @@ public static void addConfigurableReporter(\n   }\n \n   public static Map<String, Object> addConfluentMetricsContextConfigs(\n-      final String ksqlServiceId\n+      final String ksqlServiceId,\n+      final String kafkaClusterId\n   ) {\n     final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_TYPE, KSQL_RESOURCE_TYPE);\n     updatedProps.put(RESOURCE_LABEL_CLUSTER_ID, ksqlServiceId);\n-    return updatedProps;\n-  }\n-\n-  public static Map<String, Object> addConfluentMetricsContextConfigsForKsql(\n-      final String ksqlServiceId\n-  ) {\n-    final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_KSQL_SERVICE_ID, ksqlServiceId);\n+    updatedProps.put(RESOURCE_LABEL_KAFKA_CLUSTER_ID, kafkaClusterId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEzNDc2Nw=="}, "originalCommit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDYyMTcyMw==", "bodyText": "@xvrl I've updated the PR to match with this ^", "url": "https://github.com/confluentinc/ksql/pull/5757#discussion_r454621723", "createdAt": "2020-07-14T20:23:48Z", "author": {"login": "stevenpyzhang"}, "path": "ksqldb-common/src/main/java/io/confluent/ksql/metrics/MetricCollectors.java", "diffHunk": "@@ -143,22 +142,16 @@ public static void addConfigurableReporter(\n   }\n \n   public static Map<String, Object> addConfluentMetricsContextConfigs(\n-      final String ksqlServiceId\n+      final String ksqlServiceId,\n+      final String kafkaClusterId\n   ) {\n     final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_TYPE, KSQL_RESOURCE_TYPE);\n     updatedProps.put(RESOURCE_LABEL_CLUSTER_ID, ksqlServiceId);\n-    return updatedProps;\n-  }\n-\n-  public static Map<String, Object> addConfluentMetricsContextConfigsForKsql(\n-      final String ksqlServiceId\n-  ) {\n-    final Map<String, Object> updatedProps = new HashMap<>();\n     updatedProps.put(RESOURCE_LABEL_KSQL_SERVICE_ID, ksqlServiceId);\n+    updatedProps.put(RESOURCE_LABEL_KAFKA_CLUSTER_ID, kafkaClusterId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEzNDc2Nw=="}, "originalCommit": {"oid": "7c7ecd15d4e90d4c6f22fd6c6a8de026de5733c6"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3266, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}