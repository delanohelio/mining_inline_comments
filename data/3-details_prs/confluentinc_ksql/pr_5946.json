{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNTEwNDQ0", "number": 5946, "title": "chore: Add query error timestamp to QueryError list, and return on API", "bodyText": "Description\nThe current list of query errors displayed in the Console and API only includes an error message and the error type. This PR adds the timestamp when the error was generated.\nTesting done\nUpdated unit tests\nReviewer checklist\n\n Ensure docs are updated if necessary. (eg. if a user visible feature is being added or changed).\n Ensure relevant issues are linked (description should include text like \"Fixes #\")", "createdAt": "2020-08-05T16:33:46Z", "url": "https://github.com/confluentinc/ksql/pull/5946", "merged": true, "mergeCommit": {"oid": "37b9a7e627f764c8831d30e031dd6e1be1ecf1df"}, "closed": true, "closedAt": "2020-08-07T03:04:26Z", "author": {"login": "spena"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8PmBvgFqTQ2MjUwMDg5NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8XdtGABqjM2MzEwNDQ0MDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNTAwODk0", "url": "https://github.com/confluentinc/ksql/pull/5946#pullrequestreview-462500894", "createdAt": "2020-08-06T13:09:03Z", "commit": {"oid": "23eaaeba6db27cc8ed12d2a4bd247d720d383483"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMzowOTowM1rOG8yvCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMzoxMToyNFrOG8y1AA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM5ODk4NQ==", "bodyText": "Don't think we need the Sql Timestamp type here...\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  final Timestamp timestamp = new Timestamp(error.getTimestamp());\n          \n          \n            \n                  final String errorDate = timestamp.toInstant()\n          \n          \n            \n                      .atZone(ZoneId.systemDefault()).format(dateFormatter);\n          \n          \n            \n                  final Instant ts = Instant.ofEpochMilli(error.getTimestamp());\n          \n          \n            \n                  final String errorDate =ts\n          \n          \n            \n                      .atZone(ZoneId.systemDefault()).format(dateFormatter);", "url": "https://github.com/confluentinc/ksql/pull/5946#discussion_r466398985", "createdAt": "2020-08-06T13:09:03Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-cli/src/main/java/io/confluent/ksql/cli/console/Console.java", "diffHunk": "@@ -574,7 +577,14 @@ private void printOverriddenProperties(final QueryDescription queryDescription)\n \n   private void printQueryError(final QueryDescription query) {\n     writer().println();\n+\n+    final DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern(\"yyyy-MM-dd hh:mm:ss.SSS\");\n     for (final QueryError error : query.getQueryErrors()) {\n+      final Timestamp timestamp = new Timestamp(error.getTimestamp());\n+      final String errorDate = timestamp.toInstant()\n+          .atZone(ZoneId.systemDefault()).format(dateFormatter);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23eaaeba6db27cc8ed12d2a4bd247d720d383483"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjQwMDUxMg==", "bodyText": "It's always worth including timezone info in the formatter. Otherwise, users are never quite sure if the output datetime is UTC, local time or something else.", "url": "https://github.com/confluentinc/ksql/pull/5946#discussion_r466400512", "createdAt": "2020-08-06T13:11:24Z", "author": {"login": "big-andy-coates"}, "path": "ksqldb-cli/src/main/java/io/confluent/ksql/cli/console/Console.java", "diffHunk": "@@ -574,7 +577,14 @@ private void printOverriddenProperties(final QueryDescription queryDescription)\n \n   private void printQueryError(final QueryDescription query) {\n     writer().println();\n+\n+    final DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern(\"yyyy-MM-dd hh:mm:ss.SSS\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23eaaeba6db27cc8ed12d2a4bd247d720d383483"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f320daf5a3fd38cb4f78a7b5c517d56d10e50c2", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/9f320daf5a3fd38cb4f78a7b5c517d56d10e50c2", "committedDate": "2020-08-06T17:37:36Z", "message": "chore: Add query error timestamp to QueryError list, and return on API"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "23eaaeba6db27cc8ed12d2a4bd247d720d383483", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/23eaaeba6db27cc8ed12d2a4bd247d720d383483", "committedDate": "2020-08-05T16:30:42Z", "message": "chore: Add query error timestamp to QueryError list, and return on API"}, "afterCommit": {"oid": "387948f70e023f478a6a426adf33d0c36382df7e", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/387948f70e023f478a6a426adf33d0c36382df7e", "committedDate": "2020-08-06T17:37:36Z", "message": "fix: add timezone when printing timestamp on console"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "387948f70e023f478a6a426adf33d0c36382df7e", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/387948f70e023f478a6a426adf33d0c36382df7e", "committedDate": "2020-08-06T17:37:36Z", "message": "fix: add timezone when printing timestamp on console"}, "afterCommit": {"oid": "e4fe1a7f2a0f6485eb5862e01e746f3e9ecf8e8a", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/e4fe1a7f2a0f6485eb5862e01e746f3e9ecf8e8a", "committedDate": "2020-08-06T19:50:05Z", "message": "fix: add timezone when printing timestamp on console"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6695aaf6cf6e2bea345cb975e81fb221c53522a4", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/6695aaf6cf6e2bea345cb975e81fb221c53522a4", "committedDate": "2020-08-06T22:21:38Z", "message": "fix: add timezone when printing timestamp on console"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e4fe1a7f2a0f6485eb5862e01e746f3e9ecf8e8a", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/e4fe1a7f2a0f6485eb5862e01e746f3e9ecf8e8a", "committedDate": "2020-08-06T19:50:05Z", "message": "fix: add timezone when printing timestamp on console"}, "afterCommit": {"oid": "6695aaf6cf6e2bea345cb975e81fb221c53522a4", "author": {"user": {"login": "spena", "name": "Sergio Pe\u00f1a"}}, "url": "https://github.com/confluentinc/ksql/commit/6695aaf6cf6e2bea345cb975e81fb221c53522a4", "committedDate": "2020-08-06T22:21:38Z", "message": "fix: add timezone when printing timestamp on console"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4783, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}