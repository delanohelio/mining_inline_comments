{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNzcyMDIz", "number": 1934, "title": "Use new profile parameter to select routing profile", "bodyText": "This PR fixes #1859 and #1708 (without custom weighting still). Its now based on #1958.\nStarting with this PR the recommended way to do routing with GraphHopper is specifying a profile for every request that determines the costing function used for the routing calculation (same for /isochrone and /spt as well). The profile must match one of the profile names in the GraphHopper configuration (either via the Java API or config.yml). The web layer still supports the vehicle, weighting and turn_costs parameters but these are only used to select the profile (which can be done directly using the profile parameter) and this is only still possible to maintain backward compatibility. This PR also removes the HintsMap.\nCurrent todo:\n\n update web UI: use profile parameter and profiles for 'vehicle icons' do later -> #1993", "createdAt": "2020-02-27T10:54:47Z", "url": "https://github.com/graphhopper/graphhopper/pull/1934", "merged": true, "mergeCommit": {"oid": "a3d08784145d8f61a1bc5fa714b4b26df56d9924"}, "closed": true, "closedAt": "2020-04-17T13:51:15Z", "author": {"login": "easbar"}, "timelineItems": {"totalCount": 70, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcH2wmzgH2gAyMzgwNzcyMDIzOjM3OGQ3YzU1YWRmY2JlMGVhYjRkZjVlNzkyYjkwYTRhOWM1NjRjNjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYpiligFqTM5NTgxODM1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "378d7c55adfcbe0eab4df5e792b90a4a9c564c62", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/378d7c55adfcbe0eab4df5e792b90a4a9c564c62", "committedDate": "2020-02-25T18:51:31Z", "message": "Make sure profiles are configured for every test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f0396d9c3f1b032a30547309d26281efef4300c", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/1f0396d9c3f1b032a30547309d26281efef4300c", "committedDate": "2020-02-26T22:45:14Z", "message": "Throw an error when there is a routing request with no profile and start fixing tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "733111888087eec64d7f266f83f5549798501bd2", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/733111888087eec64d7f266f83f5549798501bd2", "committedDate": "2020-02-27T08:36:46Z", "message": "Adjust web exceptions test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1697573176e33c201a5bbe8fd524d28ed42dbde5", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/1697573176e33c201a5bbe8fd524d28ed42dbde5", "committedDate": "2020-02-27T08:51:28Z", "message": "Adjust GraphHopperIT tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "772710492e88d17ac31c8cdad0377e40d1b8b4ed", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/772710492e88d17ac31c8cdad0377e40d1b8b4ed", "committedDate": "2020-02-27T08:51:57Z", "message": "Make vehicle an instance variable in Measurement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da949dc10b5f015377f57ae6d9d4302f6e77b09a", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/da949dc10b5f015377f57ae6d9d4302f6e77b09a", "committedDate": "2020-02-27T09:50:39Z", "message": "Adjust a few more tests in GraphHopperIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaa27de22c912637c6af3648cf159ad58960c0dc", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/aaa27de22c912637c6af3648cf159ad58960c0dc", "committedDate": "2020-02-27T09:50:58Z", "message": "Add todos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "624f9697226b34b85b27ae4c601936db8615ce64", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/624f9697226b34b85b27ae4c601936db8615ce64", "committedDate": "2020-02-27T09:51:29Z", "message": "Remove some more GHRequest#setVehicle/Weighting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7cd51c605818bf4734aa714d3f81d674aa79fa5", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/c7cd51c605818bf4734aa714d3f81d674aa79fa5", "committedDate": "2020-02-27T10:04:10Z", "message": "Fix remaining tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d2e208acbfa518f6345db3603e8c400b76de483", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/1d2e208acbfa518f6345db3603e8c400b76de483", "committedDate": "2020-02-27T10:24:02Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5200ca30a5ecf9d6d3067b32cf18963de153e8e5", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/5200ca30a5ecf9d6d3067b32cf18963de153e8e5", "committedDate": "2020-02-27T12:50:10Z", "message": "Error if vehicle/weighting is still set on GHRequest, tests failing mostly because request is manipulated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27cd44204566a5ab760749a688c35b06210774a8", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/27cd44204566a5ab760749a688c35b06210774a8", "committedDate": "2020-02-27T17:14:52Z", "message": "Actually select CH/LM profiles by name, remove Weighting#matches, many todos left"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8108e8fa11329132b157beaca79a7d9f36579786", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/8108e8fa11329132b157beaca79a7d9f36579786", "committedDate": "2020-02-29T13:36:21Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3dc9fd74439f5a6082c01dd5d1ed092c0c959b0", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/c3dc9fd74439f5a6082c01dd5d1ed092c0c959b0", "committedDate": "2020-02-29T14:11:45Z", "message": "Add comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NjE5OTA1", "url": "https://github.com/graphhopper/graphhopper/pull/1934#pullrequestreview-365619905", "createdAt": "2020-02-27T11:52:27Z", "commit": {"oid": "1d2e208acbfa518f6345db3603e8c400b76de483"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMTo1MjoyN1rOFvPX1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxMTo1OTo0N1rOFvPk-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA3OTI1Mg==", "bodyText": "To improve readability also in tests we could remove the comments and reuse the previously defined variable carWithoutTurnCosts=\"profile1\" instead of just \"profile1\"?\nAnd why are the assertMoscowEdge/NodeBased calls removed? Because it is expected to work once the converter is tested?", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r385079252", "createdAt": "2020-02-27T11:52:27Z", "author": {"login": "karussell"}, "path": "reader-osm/src/test/java/com/graphhopper/GraphHopperIT.java", "diffHunk": "@@ -1385,17 +1416,26 @@ public void testDisablingLM() {\n \n     @Test\n     public void testTurnCostsOnOff() {\n+        final String profile1 = \"profile1\";\n+        final String profile2 = \"profile2\";\n+        final String vehicle = \"car\";\n+        final String weighting = \"fastest\";\n         GraphHopper hopper = createGraphHopper(\"car|turn_costs=true\").\n                 setOSMFile(MOSCOW).\n+                setProfiles(\n+                        new ProfileConfig(profile1).setVehicle(vehicle).setWeighting(weighting).setTurnCosts(false),\n+                        new ProfileConfig(profile2).setVehicle(vehicle).setWeighting(weighting).setTurnCosts(true)\n+                ).\n                 setStoreOnFlush(true);\n         hopper.importOrLoad();\n \n-        // no edge_based parameter -> use edge-based (since encoder supports it and no CH)\n-        assertMoscowEdgeBased(hopper, \"none\", false);\n-        // edge_based=false -> use node-based\n-        assertMoscowNodeBased(hopper, \"false\", false);\n-        // edge_based=true -> use edge-based\n-        assertMoscowEdgeBased(hopper, \"true\", false);\n+        GHRequest req = new GHRequest(55.813357, 37.5958585, 55.811042, 37.594689);\n+        // without turn costs\n+        req.setProfile(\"profile1\");\n+        assertEquals(400, hopper.route(req).getBest().getDistance(), 1);\n+        // with turn costs\n+        req.setProfile(\"profile2\");\n+        assertEquals(1044, hopper.route(req).getBest().getDistance(), 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d2e208acbfa518f6345db3603e8c400b76de483"}, "originalPosition": 869}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA4MTI1MA==", "bodyText": "Yes to both :) ? (profile should be in hints as long as the DefaultWeightingFactory gets only the HintsMap)", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r385081250", "createdAt": "2020-02-27T11:56:47Z", "author": {"login": "karussell"}, "path": "api/src/main/java/com/graphhopper/GHRequest.java", "diffHunk": "@@ -34,6 +34,9 @@\n  */\n public class GHRequest {\n     private List<GHPoint> points;\n+    // todonow: keep this here or put it into hints, and even more important: can we remove vehicle+weighting from\n+    // hints?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d2e208acbfa518f6345db3603e8c400b76de483"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA4MTcxMA==", "bodyText": "Why is this necessary? The only exception should be the key parameter that should go into the URL.", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r385081710", "createdAt": "2020-02-27T11:57:46Z", "author": {"login": "karussell"}, "path": "client-hc/src/main/java/com/graphhopper/api/GraphHopperWeb.java", "diffHunk": "@@ -236,6 +236,11 @@ private Request createPostRequest(GHRequest ghRequest) {\n         String url = tmpServiceURL + \"?\";\n         if (!Helper.isEmpty(key))\n             url += \"key=\" + key;\n+        if (!Helper.isEmpty(ghRequest.getProfile())) {\n+            if (!url.endsWith(\"?\"))\n+                url += \"&\";\n+            url += \"profile=\" + ghRequest.getProfile();\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d2e208acbfa518f6345db3603e8c400b76de483"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA4MjYxNw==", "bodyText": "We did this for backward compatibility but we should probably not do this anymore and just ensure that the created profiles follow a certain standard (lower case and no spaces etc)", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r385082617", "createdAt": "2020-02-27T11:59:47Z", "author": {"login": "karussell"}, "path": "core/src/main/java/com/graphhopper/GraphHopper.java", "diffHunk": "@@ -1027,16 +1028,32 @@ public GHResponse route(GHRequest request) {\n         if (locationIndex == null)\n             throw new IllegalStateException(\"Location index not initialized\");\n \n-        // default handling\n-        String vehicle = request.getVehicle();\n-        if (vehicle.isEmpty()) {\n-            vehicle = getDefaultVehicle().toString();\n-            request.setVehicle(vehicle);\n-        }\n-\n         Lock readLock = readWriteLock.readLock();\n         readLock.lock();\n         try {\n+\n+            if (profilesByName.isEmpty()) {\n+                // todonow\n+                throw new IllegalArgumentException(\"XXX\");\n+            }\n+\n+            if (request.getProfile().isEmpty()) {\n+                throw new IllegalArgumentException(\"You need to specify a profile to perform a routing request\");\n+            }\n+\n+            // todonow: make sure trimmed, lower case etc.?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d2e208acbfa518f6345db3603e8c400b76de483"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01a9e115e6ae16a523b142aee3b1029b178f82b6", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/01a9e115e6ae16a523b142aee3b1029b178f82b6", "committedDate": "2020-03-10T09:55:44Z", "message": "Merge branch 'master' into profile_parameter\n\n# Conflicts:\n#\tcore/src/main/java/com/graphhopper/GraphHopper.java\n#\tcore/src/main/java/com/graphhopper/routing/lm/LMPreparationHandler.java\n#\tcore/src/test/java/com/graphhopper/routing/RoutingAlgorithmIT.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "737b740d73076800303b31a4ff86d109b0fc0bdf", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/737b740d73076800303b31a4ff86d109b0fc0bdf", "committedDate": "2020-03-10T13:58:19Z", "message": "Some updates from profile_resolver branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2adb95c74e41a9b94cf32008a03c5613d755f2c8", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/2adb95c74e41a9b94cf32008a03c5613d755f2c8", "committedDate": "2020-03-10T13:58:36Z", "message": "Remove profile url parameter for POST"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5124841a0c39334b09651bab02e790e637bea8cc", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/5124841a0c39334b09651bab02e790e637bea8cc", "committedDate": "2020-03-10T22:25:34Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c771948ed2eb8655a8658df5b1c31b8336d46d6", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/7c771948ed2eb8655a8658df5b1c31b8336d46d6", "committedDate": "2020-03-10T22:27:41Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4fd48236361478ade9a1a50709ec8acc69f4c14", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/c4fd48236361478ade9a1a50709ec8acc69f4c14", "committedDate": "2020-03-15T21:41:33Z", "message": "Merge branch 'master' into profile_parameter\n\n# Conflicts:\n#\tcore/src/main/java/com/graphhopper/GraphHopper.java\n#\tcore/src/main/java/com/graphhopper/routing/ProfileResolver.java\n#\tcore/src/test/java/com/graphhopper/routing/RoutingAlgorithmIT.java\n#\tweb/src/test/java/com/graphhopper/http/GraphHopperLandmarksTest.java\n#\tweb/src/test/java/com/graphhopper/http/SpatialRulesTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/ChangeGraphResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/GtfsTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceIssue1574Test.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceWithEleTest.java\n#\tweb/src/test/java/com/graphhopper/http/util/TestUtils.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "321935a69025ed0eef7eadac368c2caf363beb30", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/321935a69025ed0eef7eadac368c2caf363beb30", "committedDate": "2020-03-15T22:11:56Z", "message": "adjust to master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86e67cc4a227444d6ef684b1a23d611eac76bdb3", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/86e67cc4a227444d6ef684b1a23d611eac76bdb3", "committedDate": "2020-03-17T22:20:24Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "000512738aebf44a2b483e7bbf54e9fff225b88a", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/000512738aebf44a2b483e7bbf54e9fff225b88a", "committedDate": "2020-03-17T22:38:27Z", "message": "Update to profile_parameter2 branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "444d14124b5fe1ba78ed409efeaa51138b6247da", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/444d14124b5fe1ba78ed409efeaa51138b6247da", "committedDate": "2020-03-19T15:17:19Z", "message": "Merge branch 'master' into profile_parameter\n\n# Conflicts:\n#\tcore/src/main/java/com/graphhopper/routing/ProfileResolver.java\n#\tcore/src/test/java/com/graphhopper/routing/RoutingAlgorithmIT.java\n#\treader-osm/src/test/java/com/graphhopper/GraphHopperIT.java\n#\treader-osm/src/test/java/com/graphhopper/reader/osm/GraphHopperOSMTest.java\n#\ttools/src/main/java/com/graphhopper/tools/CHMeasurement.java\n#\ttools/src/main/java/com/graphhopper/tools/Measurement.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/IsochroneResource.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/RouteResource.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/SPTResource.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "097ed56985091246588308b1a9ee2d4f844d3340", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/097ed56985091246588308b1a9ee2d4f844d3340", "committedDate": "2020-03-19T15:20:06Z", "message": "More updates to p2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9efde55f52a30212e10b850b6d18034547c91728", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/9efde55f52a30212e10b850b6d18034547c91728", "committedDate": "2020-03-19T18:43:48Z", "message": "Update to p2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3783aa1fbad14bd00a5a1c5f3b1a26e87f1d9f7d", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/3783aa1fbad14bd00a5a1c5f3b1a26e87f1d9f7d", "committedDate": "2020-03-19T23:16:51Z", "message": "Adjust to pp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43d0751c04ec64bb16f413c0fd8c1003322fa83f", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/43d0751c04ec64bb16f413c0fd8c1003322fa83f", "committedDate": "2020-03-20T07:35:07Z", "message": "Reset entire branch to profile_parameter2 branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "813470015fd0906820fb0e9deff0f018aa0720a1", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/813470015fd0906820fb0e9deff0f018aa0720a1", "committedDate": "2020-03-20T07:35:17Z", "message": "Replace vehicle/weighting parameters with profile parameter in GET /route"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b947e706912fc9a473a2154a0ac4825766550d59", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/b947e706912fc9a473a2154a0ac4825766550d59", "committedDate": "2020-03-20T07:35:32Z", "message": "Implement profile parameter in RouteResource and GraphHopperWeb, use it in tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df975f6f082004b60c3828f82bfeb23f07b32bd8", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/df975f6f082004b60c3828f82bfeb23f07b32bd8", "committedDate": "2020-03-20T07:35:37Z", "message": "whitespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3867d4c3369bdc3dd6d155ad6639acb4b63a851", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/d3867d4c3369bdc3dd6d155ad6639acb4b63a851", "committedDate": "2020-03-20T07:35:40Z", "message": "Adjusts a few more tests with missing profile"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c11b4c2e0a885b27d2a89686fcb95f12b1d6d9a3", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/c11b4c2e0a885b27d2a89686fcb95f12b1d6d9a3", "committedDate": "2020-03-20T07:35:42Z", "message": "Remove HintsMap from RoutingAlgorithm(OSM)IT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69e7d6971ba416d8df61adbe86f2f83c3946f5f4", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/69e7d6971ba416d8df61adbe86f2f83c3946f5f4", "committedDate": "2020-03-20T07:35:44Z", "message": "Change hints map to pmap in block area"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33b9f9ed6d5da3d85d66bd0a3a272de6c11e6fe9", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/33b9f9ed6d5da3d85d66bd0a3a272de6c11e6fe9", "committedDate": "2020-03-20T07:35:47Z", "message": "Add profile parameter to /isochrone & /spt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d96e7f99f6671b123a2966c0699e0e2b4d87e4d3", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/d96e7f99f6671b123a2966c0699e0e2b4d87e4d3", "committedDate": "2020-03-20T08:48:28Z", "message": "fix mixin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b92c8749ea52eb6a2b876b78951d189f8361b2f", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/1b92c8749ea52eb6a2b876b78951d189f8361b2f", "committedDate": "2020-03-20T09:23:19Z", "message": "Add integration for profile selection using profile or legacy parameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48bdadfecacee6bcecca528c506775e98b23e09a", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/48bdadfecacee6bcecca528c506775e98b23e09a", "committedDate": "2020-03-20T09:30:58Z", "message": "Reduce usages of HintsMap"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2779b251415d1a037caa350c28aaaafcb522953d", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/2779b251415d1a037caa350c28aaaafcb522953d", "committedDate": "2020-03-20T10:00:41Z", "message": "Fix broken url for get requests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8f8073b71a19fd0a3648319adeac78e497c0d3d", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/b8f8073b71a19fd0a3648319adeac78e497c0d3d", "committedDate": "2020-03-20T10:02:32Z", "message": "Update todo comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1d9e93a36c10d9ac799c67282748ee28c6b4cba", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/c1d9e93a36c10d9ac799c67282748ee28c6b4cba", "committedDate": "2020-03-20T10:08:12Z", "message": "Merge branch 'master' into profile_parameter\n\n# Conflicts:\n#\tcore/src/main/java/com/graphhopper/routing/ProfileResolver.java\n#\treader-gtfs/src/test/java/com/graphhopper/AnotherAgencyIT.java\n#\treader-gtfs/src/test/java/com/graphhopper/ExtendedRouteTypeIT.java\n#\treader-gtfs/src/test/java/com/graphhopper/GraphHopperGtfsIT.java\n#\treader-gtfs/src/test/java/com/graphhopper/GraphHopperMultimodalIT.java\n#\treader-gtfs/src/test/java/com/graphhopper/RealtimeIT.java\n#\treader-osm/src/test/java/com/graphhopper/GraphHopperIT.java\n#\treader-osm/src/test/java/com/graphhopper/reader/osm/GraphHopperOSMTest.java\n#\tweb/src/test/java/com/graphhopper/http/SpatialRulesTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/ChangeGraphResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/GtfsTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/I18nResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/IsochroneResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/MvtResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/NearestResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/NearestResourceWithEleTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/PtIsochroneTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceWithEleTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/SPTResourceTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86e4ddcd6df469382036e1fa044918c3c18637f6", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/86e4ddcd6df469382036e1fa044918c3c18637f6", "committedDate": "2020-03-20T11:15:21Z", "message": "web ui, tmp"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7be0639462953a899655be580fd6ebea8284c681", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/7be0639462953a899655be580fd6ebea8284c681", "committedDate": "2020-03-23T18:26:20Z", "message": "Merge branch 'master' into profile_parameter\n\n# Conflicts:\n#\tcore/src/main/java/com/graphhopper/routing/ProfileResolver.java\n#\ttools/src/main/java/com/graphhopper/tools/Measurement.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/RouteResource.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceProfileSelectionTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e165edf1822dcfdc4767f0c97480ff24f30bb23e", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/e165edf1822dcfdc4767f0c97480ff24f30bb23e", "committedDate": "2020-03-23T18:41:10Z", "message": "Some picks from p2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b7fb8ff644cb885e1695ca890488b7eb1d9bb9a", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/6b7fb8ff644cb885e1695ca890488b7eb1d9bb9a", "committedDate": "2020-03-23T21:12:43Z", "message": "Merge branch 'master' into p3\n\n# Conflicts:\n#\tcore/files/changelog.txt\n#\tcore/src/main/java/com/graphhopper/GraphHopper.java\n#\tcore/src/main/java/com/graphhopper/routing/ProfileResolver.java\n#\tcore/src/test/java/com/graphhopper/routing/RoutingAlgorithmIT.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/IsochroneResource.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/RouteResource.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/SPTResource.java\n#\tweb/src/test/java/com/graphhopper/http/resources/ChangeGraphResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/IsochroneResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceIssue1574Test.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceProfileSelectionTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceTurnCostsTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceWithEleTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a68317d888413450cfa1ccd541b03d34d19f02d8", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/a68317d888413450cfa1ccd541b03d34d19f02d8", "committedDate": "2020-03-24T06:45:53Z", "message": "Adjust after merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65d9ea2e64db41ffb10b546a67c4319a8fa386a1", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/65d9ea2e64db41ffb10b546a67c4319a8fa386a1", "committedDate": "2020-03-25T18:21:01Z", "message": "Add comment/todo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e705bc2ea7455506a52a46979b0ea24d797f50b9", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/e705bc2ea7455506a52a46979b0ea24d797f50b9", "committedDate": "2020-04-09T07:00:18Z", "message": "Merge branch 'master' into profile_parameter\n\n# Conflicts:\n#\tweb-bundle/src/main/java/com/graphhopper/resources/IsochroneResource.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/RouteResource.java\n#\tweb-bundle/src/main/java/com/graphhopper/resources/SPTResource.java\n#\tweb/src/test/java/com/graphhopper/http/resources/ChangeGraphResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/IsochroneResourceTest.java\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceTurnCostsTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fc91f9de6fae3910f155ccdb9154c623010de99", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/3fc91f9de6fae3910f155ccdb9154c623010de99", "committedDate": "2020-04-09T07:09:35Z", "message": "Minor cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db8ed3ead9d0d6fb9fe8e64eb5db6d0e84fd7757", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/db8ed3ead9d0d6fb9fe8e64eb5db6d0e84fd7757", "committedDate": "2020-04-14T10:43:18Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d75f924ca6c228ad05eb4ad52dc82926c4cd905b", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/d75f924ca6c228ad05eb4ad52dc82926c4cd905b", "committedDate": "2020-04-14T11:52:13Z", "message": "Update some todos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08339c8e39f9c7dadf600ef5b15e245202487629", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/08339c8e39f9c7dadf600ef5b15e245202487629", "committedDate": "2020-04-16T09:07:51Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "677ef7acf1527f7cf11855e59dcc5312a767a58a", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/677ef7acf1527f7cf11855e59dcc5312a767a58a", "committedDate": "2020-04-16T09:11:16Z", "message": "Revert web ui stuff"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad9fab074c2264b8a9f129b0ae02dd583e5499d0", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/ad9fab074c2264b8a9f129b0ae02dd583e5499d0", "committedDate": "2020-04-16T11:24:56Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91b3fb747847eae67d8cdf572a764961fb119f18", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/91b3fb747847eae67d8cdf572a764961fb119f18", "committedDate": "2020-04-16T11:27:10Z", "message": "No longer allow legacy parameters when profile parameter is used"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba6b9aff22cb05d730121efe00fd352f71dededd", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/ba6b9aff22cb05d730121efe00fd352f71dededd", "committedDate": "2020-04-16T13:10:38Z", "message": "Update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23913ccf3386771ea23bea7cf248b125673983e3", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/23913ccf3386771ea23bea7cf248b125673983e3", "committedDate": "2020-04-16T21:12:20Z", "message": "Merge branch 'master' into profile_parameter\n\n# Conflicts:\n#\tweb/src/test/java/com/graphhopper/http/resources/RouteResourceTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/97b2c8ee6f5d3ad6c215f062cb56fe1772fed943", "committedDate": "2020-04-16T22:19:45Z", "message": "A few more tests and fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MjAzMjI1", "url": "https://github.com/graphhopper/graphhopper/pull/1934#pullrequestreview-395203225", "createdAt": "2020-04-17T06:55:20Z", "commit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNjo1NToyMVrOGHCCLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNjo1NzoxM1rOGHCFPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNjU0Mw==", "bodyText": "I wonder if we should remove get/SetVehicle/Weighting from HintsMap now? The problem is that when using GraphHopper as a Java library we pass GHRequest including a HintsMap to GraphHopper#route, but this method no longer accepts weighting/vehicle but needs a profile instead. On the other hand when we use GHRequest on the client side via GraphHopperWeb one can still use vehicle/weighting due to the ProfileResolver in the RouteResource (even though also here profile is the recommended parameter now). We could also  copy&paste GHRequest and HintsMap on the client side and adjust both versions accordingly, but I do not see a real reason to keep vehicle/weighting? When someone is updating the client version there will be a compile error and he/she will be forced to replace setVehicle/Weighting with setProfile, but is this a problem? Using older clients still works of course (because of ProfileResolver).\nUpdate: This is what it would look like without HintsMap: d2cc097. Maybe we could extract a constant for \"vehicle\" and \"weighting\", but otherwise I do not see a reason not to remove it at the moment.", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410026543", "createdAt": "2020-04-17T06:55:21Z", "author": {"login": "easbar"}, "path": "api/src/main/java/com/graphhopper/GHRequest.java", "diffHunk": "@@ -243,6 +243,8 @@ public String getWeighting() {\n      * By default it supports fastest and shortest. Or specify empty to use default.\n      */\n     public GHRequest setWeighting(String w) {\n+        // todonow: setting weighting/vehicle only works on the client side, but no longer with GHRequest in GraphHopper\n+        // should we remove it?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNjkyOA==", "bodyText": "I guess this is so because the POST endpoint does not support gpx and we can leave as is here?", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410026928", "createdAt": "2020-04-17T06:56:13Z", "author": {"login": "easbar"}, "path": "client-hc/src/test/java/com/graphhopper/api/GraphHopperWebIT.java", "diffHunk": "@@ -248,6 +248,8 @@ public void doNotReadFinishInstruction() {\n \n     @Test\n     public void testSimpleExport() {\n+        // todonow: is it ok/meant to be that export() always uses get (regardless of the setting), looks like our\n+        // POST endpoint does not support gpx yet?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNzI0NQ==", "bodyText": "Do you remember the reason this is done here instead of in GraphHopper? Can we move it over now?", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410027245", "createdAt": "2020-04-17T06:57:01Z", "author": {"login": "easbar"}, "path": "web-bundle/src/main/java/com/graphhopper/resources/RouteResource.java", "diffHunk": "@@ -112,6 +107,7 @@ public Response doGet(\n                     + \"or equal to the number of points (\" + requestPoints.size() + \")\");\n \n         // TODO these checks should be only necessary once in the core, e.g. pointHints problems are currently ignored for POST requests\n+        // todonow: maybe its time to fix this?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNzMyNQ==", "bodyText": "Probably not?", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410027325", "createdAt": "2020-04-17T06:57:13Z", "author": {"login": "easbar"}, "path": "web-bundle/src/main/java/com/graphhopper/resources/RouteResource.java", "diffHunk": "@@ -151,10 +148,11 @@ public Response doGet(\n \n         GHResponse ghResponse = graphHopper.route(request);\n \n-        float took = sw.stop().getSeconds();\n+        long took = sw.stop().getNanos() / 1000;\n         String infoStr = httpReq.getRemoteAddr() + \" \" + httpReq.getLocale() + \" \" + httpReq.getHeader(\"User-Agent\");\n+        // todonow: is there any reason we should keep logging vehicle/weighting? maybe to keep track of the number of 'legacy' requests or something?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0bfc645a56808602b8b2b43a55e2b1343b66f60b", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/0bfc645a56808602b8b2b43a55e2b1343b66f60b", "committedDate": "2020-04-17T11:13:45Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2cc0978c3dd284007816c7de5a1107d90284d7a", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/d2cc0978c3dd284007816c7de5a1107d90284d7a", "committedDate": "2020-04-17T11:14:13Z", "message": "Remove HintsMap"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MzY2OTY4", "url": "https://github.com/graphhopper/graphhopper/pull/1934#pullrequestreview-395366968", "createdAt": "2020-04-17T11:13:49Z", "commit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxMToxMzo0OVrOGHJ7zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxMToyMzozNlrOGHKMNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE1NTk4Mw==", "bodyText": "When someone is updating the client version there will be a compile error and he/she will be forced to replace setVehicle/Weighting with setProfile, but is this a problem?\n\nIn general this would be nice to have. Could we even remove HintsMap completely (replace with PMap)?\nAnd I see hints().putObject(\"vehicle\", \"bike\") is still possible so removing this should not be a problem. (E.g. we might not be fast enough to accept \"profile\" in the public API)", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410155983", "createdAt": "2020-04-17T11:13:49Z", "author": {"login": "karussell"}, "path": "api/src/main/java/com/graphhopper/GHRequest.java", "diffHunk": "@@ -243,6 +243,8 @@ public String getWeighting() {\n      * By default it supports fastest and shortest. Or specify empty to use default.\n      */\n     public GHRequest setWeighting(String w) {\n+        // todonow: setting weighting/vehicle only works on the client side, but no longer with GHRequest in GraphHopper\n+        // should we remove it?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNjU0Mw=="}, "originalCommit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE1NzcxMQ==", "bodyText": "Ah, good catch. I think we should always prefer POST as the request is optionally compressed and has no other limitations (?)\n\nlooks like our POST endpoint does not support gpx yet?\n\ndoPost should support it or why do you think it does not?", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410157711", "createdAt": "2020-04-17T11:17:57Z", "author": {"login": "karussell"}, "path": "client-hc/src/test/java/com/graphhopper/api/GraphHopperWebIT.java", "diffHunk": "@@ -248,6 +248,8 @@ public void doNotReadFinishInstruction() {\n \n     @Test\n     public void testSimpleExport() {\n+        // todonow: is it ok/meant to be that export() always uses get (regardless of the setting), looks like our\n+        // POST endpoint does not support gpx yet?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNjkyOA=="}, "originalCommit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE1OTI3Nw==", "bodyText": "Good question. I do not remember a reason why this is here.", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410159277", "createdAt": "2020-04-17T11:21:34Z", "author": {"login": "karussell"}, "path": "web-bundle/src/main/java/com/graphhopper/resources/RouteResource.java", "diffHunk": "@@ -112,6 +107,7 @@ public Response doGet(\n                     + \"or equal to the number of points (\" + requestPoints.size() + \")\");\n \n         // TODO these checks should be only necessary once in the core, e.g. pointHints problems are currently ignored for POST requests\n+        // todonow: maybe its time to fix this?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNzI0NQ=="}, "originalCommit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE2MDE4Mw==", "bodyText": "I would indeed probably keep it until 2.0?", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410160183", "createdAt": "2020-04-17T11:23:36Z", "author": {"login": "karussell"}, "path": "web-bundle/src/main/java/com/graphhopper/resources/RouteResource.java", "diffHunk": "@@ -151,10 +148,11 @@ public Response doGet(\n \n         GHResponse ghResponse = graphHopper.route(request);\n \n-        float took = sw.stop().getSeconds();\n+        long took = sw.stop().getNanos() / 1000;\n         String infoStr = httpReq.getRemoteAddr() + \" \" + httpReq.getLocale() + \" \" + httpReq.getHeader(\"User-Agent\");\n+        // todonow: is there any reason we should keep logging vehicle/weighting? maybe to keep track of the number of 'legacy' requests or something?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNzMyNQ=="}, "originalCommit": {"oid": "97b2c8ee6f5d3ad6c215f062cb56fe1772fed943"}, "originalPosition": 61}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "891d3337f3ea227ee01023c74e673d565909ae6e", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/891d3337f3ea227ee01023c74e673d565909ae6e", "committedDate": "2020-04-17T11:44:39Z", "message": "Remove some todos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "faf8ea2458edb2f25c1e44eb81cb661f38c7c95a", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/faf8ea2458edb2f25c1e44eb81cb661f38c7c95a", "committedDate": "2020-04-17T12:21:45Z", "message": "Put back vehicle/weighting logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "612e430c8401fc0fc4b1e22c7fa676d2a04e97f3", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/612e430c8401fc0fc4b1e22c7fa676d2a04e97f3", "committedDate": "2020-04-17T13:13:49Z", "message": "Update todo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cddbfedc29699f8846ab8f5c58939ed4633f7804", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/cddbfedc29699f8846ab8f5c58939ed4633f7804", "committedDate": "2020-04-17T13:14:46Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c07fa0263fb0b286f89375701019355c0f5740a5", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/c07fa0263fb0b286f89375701019355c0f5740a5", "committedDate": "2020-04-17T13:45:34Z", "message": "Merge branch 'master' into profile_parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a59067edb773c7d48bdda9cdb9663d261df81e4e", "author": {"user": {"login": "easbar", "name": "Andi"}}, "url": "https://github.com/graphhopper/graphhopper/commit/a59067edb773c7d48bdda9cdb9663d261df81e4e", "committedDate": "2020-04-17T13:47:20Z", "message": "Update changelog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1ODE4MzUx", "url": "https://github.com/graphhopper/graphhopper/pull/1934#pullrequestreview-395818351", "createdAt": "2020-04-17T23:04:08Z", "commit": {"oid": "a59067edb773c7d48bdda9cdb9663d261df81e4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMzowNDowOVrOGHfbpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMzowNDowOVrOGHfbpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUwODE5OA==", "bodyText": "@easbar for better readability IMO we should use milliseconds: + took/1000f + \"ms...? (or just Math.round(took/1000))", "url": "https://github.com/graphhopper/graphhopper/pull/1934#discussion_r410508198", "createdAt": "2020-04-17T23:04:09Z", "author": {"login": "karussell"}, "path": "web-bundle/src/main/java/com/graphhopper/resources/RouteResource.java", "diffHunk": "@@ -151,10 +148,10 @@ public Response doGet(\n \n         GHResponse ghResponse = graphHopper.route(request);\n \n-        float took = sw.stop().getSeconds();\n+        long took = sw.stop().getNanos() / 1000;\n         String infoStr = httpReq.getRemoteAddr() + \" \" + httpReq.getLocale() + \" \" + httpReq.getHeader(\"User-Agent\");\n         String logStr = httpReq.getQueryString() + \" \" + infoStr + \" \" + requestPoints + \", took:\"\n-                + took + \", \" + algoStr + \", \" + weighting + \", \" + vehicleStr;\n+                + took + \"micros, algo: \" + algoStr + \", profile: \" + profileName + \", \" + weightingVehicleLogStr;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a59067edb773c7d48bdda9cdb9663d261df81e4e"}, "originalPosition": 64}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4586, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}