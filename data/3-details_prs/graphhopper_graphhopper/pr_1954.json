{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3ODg0OTQx", "number": 1954, "title": "use enum instead of int", "bodyText": "@easbar as discussed in #1950 :)", "createdAt": "2020-03-13T17:03:42Z", "url": "https://github.com/graphhopper/graphhopper/pull/1954", "merged": true, "mergeCommit": {"oid": "d19d57f716fcce0dc291110946f4eb3093ac2280"}, "closed": true, "closedAt": "2020-03-15T22:17:44Z", "author": {"login": "karussell"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNTSspgH2gAyMzg3ODg0OTQxOmVhMjM2YWVlM2FlZTk1MWY3NzU0OTVjODYxYzVjM2NmZjU5ZWQxYTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOAsPugH2gAyMzg3ODg0OTQxOjAwZDI2N2Y5YjU4Y2UzMmUyNTEwM2JhNDE2NTMxYmJkODJkMzU4OWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ea236aee3aee951f775495c861c5c3cff59ed1a4", "author": {"user": {"login": "karussell", "name": "Peter"}}, "url": "https://github.com/graphhopper/graphhopper/commit/ea236aee3aee951f775495c861c5c3cff59ed1a4", "committedDate": "2020-03-13T16:55:43Z", "message": "use enum instead of int"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NDY5MjA5", "url": "https://github.com/graphhopper/graphhopper/pull/1954#pullrequestreview-374469209", "createdAt": "2020-03-13T17:05:17Z", "commit": {"oid": "ea236aee3aee951f775495c861c5c3cff59ed1a4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNzowNToxN1rOF2Loxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNzowNToxN1rOF2Loxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM1ODA4Nw==", "bodyText": "This is a bit more lengthy now ;)", "url": "https://github.com/graphhopper/graphhopper/pull/1954#discussion_r392358087", "createdAt": "2020-03-13T17:05:17Z", "author": {"login": "karussell"}, "path": "core/src/main/java/com/graphhopper/storage/BaseGraph.java", "diffHunk": "@@ -968,14 +968,14 @@ private PointList fetchWayGeometry_(long edgePointer, boolean reverse, int mode,\n             geoRef += 4L;\n             bytes = new byte[count * nodeAccess.getDimension() * 4];\n             wayGeometry.getBytes(geoRef, bytes, bytes.length);\n-        } else if (mode == 0)\n+        } else if (mode == FetchWayGeometry.PILLAR_ONLY)\n             return PointList.EMPTY;\n \n-        PointList pillarNodes = new PointList(count + mode, nodeAccess.is3D());\n+        PointList pillarNodes = new PointList(FetchWayGeometry.count(count, mode), nodeAccess.is3D());\n         if (reverse) {\n-            if ((mode & 2) != 0)\n+            if (mode == FetchWayGeometry.ALL || mode == FetchWayGeometry.PILLAR_AND_ADJ)\n                 pillarNodes.add(nodeAccess, adjNode);\n-        } else if ((mode & 1) != 0)\n+        } else if (mode == FetchWayGeometry.ALL || mode == FetchWayGeometry.BASE_AND_PILLAR)\n             pillarNodes.add(nodeAccess, baseNode);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea236aee3aee951f775495c861c5c3cff59ed1a4"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NzA1MDMz", "url": "https://github.com/graphhopper/graphhopper/pull/1954#pullrequestreview-374705033", "createdAt": "2020-03-14T07:33:45Z", "commit": {"oid": "ea236aee3aee951f775495c861c5c3cff59ed1a4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwNzozMzo0NVrOF2YR2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwNzozMzo0NVrOF2YR2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTIxMA==", "bodyText": "I do not really like the enum name FetchWayGeometry too much. Its not a noun and it does not really tell us anything. Maybe we can use this name to communicate that this enum is used to specify how many nodes we fetch? For example GeometryNodes.ALL? FetchMode.ALL? WayGeometryFetchMode.ALL?", "url": "https://github.com/graphhopper/graphhopper/pull/1954#discussion_r392565210", "createdAt": "2020-03-14T07:33:45Z", "author": {"login": "easbar"}, "path": "core/src/main/java/com/graphhopper/util/FetchWayGeometry.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package com.graphhopper.util;\n+\n+public enum FetchWayGeometry {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea236aee3aee951f775495c861c5c3cff59ed1a4"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NzA1Mzk1", "url": "https://github.com/graphhopper/graphhopper/pull/1954#pullrequestreview-374705395", "createdAt": "2020-03-14T07:42:41Z", "commit": {"oid": "ea236aee3aee951f775495c861c5c3cff59ed1a4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwNzo0Mjo0MVrOF2YTgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNFQwNzo0Mjo0MVrOF2YTgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU2NTYzMg==", "bodyText": "The names here could be more expressive. int count(int count does not tell me anything about what this method does. Apparently the method returns the total number of nodes that will be returned by fetchWayGeometry given the number of pillar nodes? So maybe we can at least rename the count parameter to pillarNodes? Maybe rename the method to getFetchedNodeCount or countFetchedNodes?", "url": "https://github.com/graphhopper/graphhopper/pull/1954#discussion_r392565632", "createdAt": "2020-03-14T07:42:41Z", "author": {"login": "easbar"}, "path": "core/src/main/java/com/graphhopper/util/FetchWayGeometry.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package com.graphhopper.util;\n+\n+public enum FetchWayGeometry {\n+    TOWER_ONLY, PILLAR_ONLY, BASE_AND_PILLAR, PILLAR_AND_ADJ, ALL;\n+\n+    public static int count(int count, FetchWayGeometry mode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea236aee3aee951f775495c861c5c3cff59ed1a4"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1d84d09d0dcd14ae55dd74321c22fa26b88c698", "author": {"user": {"login": "karussell", "name": "Peter"}}, "url": "https://github.com/graphhopper/graphhopper/commit/e1d84d09d0dcd14ae55dd74321c22fa26b88c698", "committedDate": "2020-03-14T15:26:23Z", "message": "use noun FetchMode instead of FetchWayGeometry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5dc2c742cc78f0247381d89de5e1cff4d0ab2269", "author": {"user": {"login": "karussell", "name": "Peter"}}, "url": "https://github.com/graphhopper/graphhopper/commit/5dc2c742cc78f0247381d89de5e1cff4d0ab2269", "committedDate": "2020-03-14T15:30:18Z", "message": "minor doc changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fdfc85d1c1f70b79c188403d8eae1e5ea826fd2a", "author": {"user": {"login": "karussell", "name": "Peter"}}, "url": "https://github.com/graphhopper/graphhopper/commit/fdfc85d1c1f70b79c188403d8eae1e5ea826fd2a", "committedDate": "2020-03-15T18:33:34Z", "message": "Merge branch 'master' into fetchwaygeometry_enum"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b07cd6408003413aa90a87ecb0b48ab71a425e7", "author": {"user": {"login": "karussell", "name": "Peter"}}, "url": "https://github.com/graphhopper/graphhopper/commit/1b07cd6408003413aa90a87ecb0b48ab71a425e7", "committedDate": "2020-03-15T18:35:16Z", "message": "javadoc change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0ODIzMjIy", "url": "https://github.com/graphhopper/graphhopper/pull/1954#pullrequestreview-374823222", "createdAt": "2020-03-15T18:40:27Z", "commit": {"oid": "1b07cd6408003413aa90a87ecb0b48ab71a425e7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxODo0MDoyN1rOF2gijw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxODo0MDoyN1rOF2gijw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjcwMDU1OQ==", "bodyText": "I'd still change count to pillarNodes (if thats what it is?)", "url": "https://github.com/graphhopper/graphhopper/pull/1954#discussion_r392700559", "createdAt": "2020-03-15T18:40:27Z", "author": {"login": "easbar"}, "path": "core/src/main/java/com/graphhopper/storage/BaseGraph.java", "diffHunk": "@@ -993,16 +993,31 @@ private PointList fetchWayGeometry_(long edgePointer, boolean reverse, int mode,\n         }\n \n         if (reverse) {\n-            if ((mode & 1) != 0)\n+            if (mode == FetchMode.ALL || mode == FetchMode.BASE_AND_PILLAR)\n                 pillarNodes.add(nodeAccess, baseNode);\n \n             pillarNodes.reverse();\n-        } else if ((mode & 2) != 0)\n+        } else if (mode == FetchMode.ALL || mode == FetchMode.PILLAR_AND_ADJ)\n             pillarNodes.add(nodeAccess, adjNode);\n \n         return pillarNodes;\n     }\n \n+    static int getPointListLength(int count, FetchMode mode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b07cd6408003413aa90a87ecb0b48ab71a425e7"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0ODIzMjMz", "url": "https://github.com/graphhopper/graphhopper/pull/1954#pullrequestreview-374823233", "createdAt": "2020-03-15T18:40:37Z", "commit": {"oid": "1b07cd6408003413aa90a87ecb0b48ab71a425e7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00d267f9b58ce32e25103ba416531bbd82d3589f", "author": {"user": {"login": "karussell", "name": "Peter"}}, "url": "https://github.com/graphhopper/graphhopper/commit/00d267f9b58ce32e25103ba416531bbd82d3589f", "committedDate": "2020-03-15T21:49:21Z", "message": "rename param"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4609, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}