{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzODIwMDA0", "number": 10612, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMDo1Nzo1NFrODY79BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxMTo0MDo1NVrODbMIFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3NDc0NjkzOnYy", "diffSide": "RIGHT", "path": "gradle.properties", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMDo1Nzo1NFrOFfFFXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxOTo1MjoyNFrOFgGxhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzMzQ3MQ==", "bodyText": "Elsewhere, we use underscores in our docker image names (e.g. java_sdk). We should use an underscore here to keep it consistent.", "url": "https://github.com/apache/beam/pull/10612#discussion_r368133471", "createdAt": "2020-01-17T20:57:54Z", "author": {"login": "ibzib"}, "path": "gradle.properties", "diffHunk": "@@ -27,3 +27,6 @@ version=2.20.0-SNAPSHOT\n sdk_version=2.20.0.dev\n \n javaVersion=1.8\n+\n+docker_image_default_repo_root=apache\n+docker_image_default_repo_prefix=beam-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc7bbd270bc5be7fa81c85c10fb9216f0189fcc7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE2NjgwOA==", "bodyText": "This is intended in order to distinguish project name and image name.", "url": "https://github.com/apache/beam/pull/10612#discussion_r369166808", "createdAt": "2020-01-21T18:24:27Z", "author": {"login": "Hannah-Jiang"}, "path": "gradle.properties", "diffHunk": "@@ -27,3 +27,6 @@ version=2.20.0-SNAPSHOT\n sdk_version=2.20.0.dev\n \n javaVersion=1.8\n+\n+docker_image_default_repo_root=apache\n+docker_image_default_repo_prefix=beam-", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzMzQ3MQ=="}, "originalCommit": {"oid": "fc7bbd270bc5be7fa81c85c10fb9216f0189fcc7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE5MDk4MA==", "bodyText": "Ideally we would be able to use a subrepo or a slash in the image name, but since those are not supported by Docker, I don't think mixing hyphens and underscores is a good alternative. I think most users would expect either only hyphens or only underscores (the two are seldom mixed within the same string), so having both makes tags more difficult to use for humans (harder to remember and easy to make typos).", "url": "https://github.com/apache/beam/pull/10612#discussion_r369190980", "createdAt": "2020-01-21T19:13:24Z", "author": {"login": "ibzib"}, "path": "gradle.properties", "diffHunk": "@@ -27,3 +27,6 @@ version=2.20.0-SNAPSHOT\n sdk_version=2.20.0.dev\n \n javaVersion=1.8\n+\n+docker_image_default_repo_root=apache\n+docker_image_default_repo_prefix=beam-", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzMzQ3MQ=="}, "originalCommit": {"oid": "fc7bbd270bc5be7fa81c85c10fb9216f0189fcc7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE5OTk3MQ==", "bodyText": "changed it to underscore.", "url": "https://github.com/apache/beam/pull/10612#discussion_r369199971", "createdAt": "2020-01-21T19:31:44Z", "author": {"login": "Hannah-Jiang"}, "path": "gradle.properties", "diffHunk": "@@ -27,3 +27,6 @@ version=2.20.0-SNAPSHOT\n sdk_version=2.20.0.dev\n \n javaVersion=1.8\n+\n+docker_image_default_repo_root=apache\n+docker_image_default_repo_prefix=beam-", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzMzQ3MQ=="}, "originalCommit": {"oid": "fc7bbd270bc5be7fa81c85c10fb9216f0189fcc7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIwOTczNQ==", "bodyText": "Thanks! Make sure you also change the prefix everywhere it needs to be hard-coded.", "url": "https://github.com/apache/beam/pull/10612#discussion_r369209735", "createdAt": "2020-01-21T19:52:24Z", "author": {"login": "ibzib"}, "path": "gradle.properties", "diffHunk": "@@ -27,3 +27,6 @@ version=2.20.0-SNAPSHOT\n sdk_version=2.20.0.dev\n \n javaVersion=1.8\n+\n+docker_image_default_repo_root=apache\n+docker_image_default_repo_prefix=beam-", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzMzQ3MQ=="}, "originalCommit": {"oid": "fc7bbd270bc5be7fa81c85c10fb9216f0189fcc7"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3NDc1MzcwOnYy", "diffSide": "RIGHT", "path": "runners/spark/job-server/container/build.gradle", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMTowMTowN1rOFfFJsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxOTowMjo0MVrOFgFUpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzNDU3Ng==", "bodyText": "Looks like we lost spark here.", "url": "https://github.com/apache/beam/pull/10612#discussion_r368134576", "createdAt": "2020-01-17T21:01:07Z", "author": {"login": "ibzib"}, "path": "runners/spark/job-server/container/build.gradle", "diffHunk": "@@ -54,9 +54,10 @@ task copyDockerfileDependencies(type: Copy) {\n }\n \n docker {\n-  name containerImageName(name: 'spark-job-server',\n+  name containerImageName(name: ${project.docker_image_default_repo_prefix} + 'job-server',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc7bbd270bc5be7fa81c85c10fb9216f0189fcc7"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE2NzIyMw==", "bodyText": "Fixed it.\nIs there any reason we used - instead of _ for spark-job-server?", "url": "https://github.com/apache/beam/pull/10612#discussion_r369167223", "createdAt": "2020-01-21T18:25:13Z", "author": {"login": "Hannah-Jiang"}, "path": "runners/spark/job-server/container/build.gradle", "diffHunk": "@@ -54,9 +54,10 @@ task copyDockerfileDependencies(type: Copy) {\n }\n \n docker {\n-  name containerImageName(name: 'spark-job-server',\n+  name containerImageName(name: ${project.docker_image_default_repo_prefix} + 'job-server',", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzNDU3Ng=="}, "originalCommit": {"oid": "fc7bbd270bc5be7fa81c85c10fb9216f0189fcc7"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE4NTk1OQ==", "bodyText": "I suppose it should probably use underscores like everywhere else.", "url": "https://github.com/apache/beam/pull/10612#discussion_r369185959", "createdAt": "2020-01-21T19:02:41Z", "author": {"login": "ibzib"}, "path": "runners/spark/job-server/container/build.gradle", "diffHunk": "@@ -54,9 +54,10 @@ task copyDockerfileDependencies(type: Copy) {\n }\n \n docker {\n-  name containerImageName(name: 'spark-job-server',\n+  name containerImageName(name: ${project.docker_image_default_repo_prefix} + 'job-server',", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzNDU3Ng=="}, "originalCommit": {"oid": "fc7bbd270bc5be7fa81c85c10fb9216f0189fcc7"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4NTEwOTc3OnYy", "diffSide": "RIGHT", "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/util/ReleaseInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODowMzo0MVrOFgltFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODowMzo0MVrOFgltFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTcxNjUwMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              /** Provides docker image default repo prefix (beam-). */\n          \n          \n            \n              /** Provides docker image default repo prefix (beam_). */", "url": "https://github.com/apache/beam/pull/10612#discussion_r369716503", "createdAt": "2020-01-22T18:03:41Z", "author": {"login": "ibzib"}, "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/util/ReleaseInfo.java", "diffHunk": "@@ -59,10 +59,22 @@ public String getSdkVersion() {\n     return getProperties().get(\"sdk_version\");\n   }\n \n+  /** Provides docker image default root (apache). */\n+  public String getDefaultDockerRepoRoot() {\n+    return getProperties().get(\"docker_image_default_repo_root\");\n+  }\n+\n+  /** Provides docker image default repo prefix (beam-). */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afd5aa7ce5fc7232b24ebaf98c94fa0f141c49f8"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4NTExMDA4OnYy", "diffSide": "RIGHT", "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/util/ReleaseInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODowMzo0OVrOFgltSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxODowMzo0OVrOFgltSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTcxNjU1NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private static final String DEFAULT_DOCKER_IMAGE_PREFIX = \"beam-\";\n          \n          \n            \n              private static final String DEFAULT_DOCKER_IMAGE_PREFIX = \"beam_\";", "url": "https://github.com/apache/beam/pull/10612#discussion_r369716555", "createdAt": "2020-01-22T18:03:49Z", "author": {"login": "ibzib"}, "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/util/ReleaseInfo.java", "diffHunk": "@@ -59,10 +59,22 @@ public String getSdkVersion() {\n     return getProperties().get(\"sdk_version\");\n   }\n \n+  /** Provides docker image default root (apache). */\n+  public String getDefaultDockerRepoRoot() {\n+    return getProperties().get(\"docker_image_default_repo_root\");\n+  }\n+\n+  /** Provides docker image default repo prefix (beam-). */\n+  public String getDefaultDockerRepoPrefix() {\n+    return getProperties().get(\"docker_image_default_repo_prefix\");\n+  }\n+\n   /////////////////////////////////////////////////////////////////////////\n   private static final Logger LOG = LoggerFactory.getLogger(ReleaseInfo.class);\n   private static final String DEFAULT_NAME = \"Apache Beam SDK for Java\";\n   private static final String DEFAULT_VERSION = \"Unknown\";\n+  private static final String DEFAULT_DOCKER_IMAGE_ROOT = \"apache\";\n+  private static final String DEFAULT_DOCKER_IMAGE_PREFIX = \"beam-\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afd5aa7ce5fc7232b24ebaf98c94fa0f141c49f8"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5ODM2Nzg1OnYy", "diffSide": "RIGHT", "path": "release/src/main/scripts/build_release_candidate.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxMTo0MDo0N1rOFih-dA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxNzo1ODo1MVrOFiu5SA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTc1MjU2NA==", "bodyText": "Would it be worth sourcing these from a script?", "url": "https://github.com/apache/beam/pull/10612#discussion_r371752564", "createdAt": "2020-01-28T11:40:47Z", "author": {"login": "mxm"}, "path": "release/src/main/scripts/build_release_candidate.sh", "diffHunk": "@@ -45,6 +45,9 @@ PYTHON_ARTIFACTS_DIR=python\n BEAM_ROOT_DIR=beam\n WEBSITE_ROOT_DIR=beam-site\n \n+DOCKER_IMAGE_DEFAULT_REPO_ROOT=apache\n+DOCKER_IMAGE_DEFAULT_REPO_PREFIX=beam_", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90c0f49930ce0385951e409b7bf7988972f1e1a5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTk2NDIzMg==", "bodyText": "Yeap, that's a great idea and I think it's better to have a script which holds all variables and shared by all release scripts, so I haven't used a script this time. I created a ticket to fix it. BEAM-9207", "url": "https://github.com/apache/beam/pull/10612#discussion_r371964232", "createdAt": "2020-01-28T17:58:51Z", "author": {"login": "Hannah-Jiang"}, "path": "release/src/main/scripts/build_release_candidate.sh", "diffHunk": "@@ -45,6 +45,9 @@ PYTHON_ARTIFACTS_DIR=python\n BEAM_ROOT_DIR=beam\n WEBSITE_ROOT_DIR=beam-site\n \n+DOCKER_IMAGE_DEFAULT_REPO_ROOT=apache\n+DOCKER_IMAGE_DEFAULT_REPO_PREFIX=beam_", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTc1MjU2NA=="}, "originalCommit": {"oid": "90c0f49930ce0385951e409b7bf7988972f1e1a5"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5ODM2ODIwOnYy", "diffSide": "RIGHT", "path": "release/src/main/scripts/publish_docker_images.sh", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxMTo0MDo1NVrOFih-pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOFQxMTo0MDo1NVrOFih-pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTc1MjYxNQ==", "bodyText": "Would it be worth sourcing these from a script?", "url": "https://github.com/apache/beam/pull/10612#discussion_r371752615", "createdAt": "2020-01-28T11:40:55Z", "author": {"login": "mxm"}, "path": "release/src/main/scripts/publish_docker_images.sh", "diffHunk": "@@ -24,6 +24,9 @@\n \n set -e\n \n+DOCKER_IMAGE_DEFAULT_REPO_ROOT=apache\n+DOCKER_IMAGE_DEFAULT_REPO_PREFIX=beam_", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "90c0f49930ce0385951e409b7bf7988972f1e1a5"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2187, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}