{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4Mzg5NzE2", "number": 12239, "title": "[BEAM-9980] dataflow test-suite tasks tied with Python versions configurable", "bodyText": "Made it possible for some dataflow test-suite tasks  to configure which python version to use  with gradle properties\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n---\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-07-13T17:24:39Z", "url": "https://github.com/apache/beam/pull/12239", "merged": true, "mergeCommit": {"oid": "b9bb2a4bbad6cdf9ed22b1a9156f71d0d789eb02"}, "closed": true, "closedAt": "2020-08-17T22:06:07Z", "author": {"login": "lazylynx"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4PzoqgFqTQ1MjcxMjg3NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc_5ETaAFqTQ2ODgzNjI4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNzEyODc0", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-452712874", "createdAt": "2020-07-21T18:15:05Z", "commit": {"oid": "53e5b7746dca97939487f1cf73b1c927a55ac3a5"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxODoxNTowNVrOG1EKaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwMjoxMDo1M1rOG3BonQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI5NTkxMw==", "bodyText": "I am not sure I understand which suites we include in this postcommit suite and how we select which version are high priority.", "url": "https://github.com/apache/beam/pull/12239#discussion_r458295913", "createdAt": "2020-07-21T18:15:05Z", "author": {"login": "tvalentyn"}, "path": "build.gradle", "diffHunk": "@@ -243,13 +241,16 @@ task pythonFormatterPreCommit() {\n   dependsOn 'sdks:python:test-suites:tox:py38:formatter'\n }\n \n+task pythonPostCommit() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53e5b7746dca97939487f1cf73b1c927a55ac3a5"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1MTY0NQ==", "bodyText": "This is a great reduction of  chaos in our test configurations! This would be super helpful for Python 2 deprecation.", "url": "https://github.com/apache/beam/pull/12239#discussion_r460351645", "createdAt": "2020-07-25T02:10:53Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,39 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53e5b7746dca97939487f1cf73b1c927a55ac3a5"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "53e5b7746dca97939487f1cf73b1c927a55ac3a5", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/53e5b7746dca97939487f1cf73b1c927a55ac3a5", "committedDate": "2020-07-13T17:09:21Z", "message": "[BEAM-9980] made tests tied with Python versions switchable with gradle properties"}, "afterCommit": {"oid": "4001d5b211b8a483f98c7e3b4c5025da8aaab914", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/4001d5b211b8a483f98c7e3b4c5025da8aaab914", "committedDate": "2020-07-30T15:06:57Z", "message": "[BEAM-9980] update portable test-suites to switch python versions using in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NTI3MDg3", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-459527087", "createdAt": "2020-07-31T23:52:06Z", "commit": {"oid": "7daa16c59ef13763ff08a3b4d5898eecaed40a84"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMzo1MjowN1rOG6ZmsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMVQwMjo0NzozMVrOG6a6qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg5MDA5Ng==", "bodyText": "Can enablePythonPerformanceTest() be moved to common.gradle as well?", "url": "https://github.com/apache/beam/pull/12239#discussion_r463890096", "createdAt": "2020-07-31T23:52:07Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/dataflow/py37/build.gradle", "diffHunk": "@@ -20,10 +20,6 @@ apply plugin: org.apache.beam.gradle.BeamModulePlugin\n applyPythonNature()\n enablePythonPerformanceTest()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7daa16c59ef13763ff08a3b4d5898eecaed40a84"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkwODUyMQ==", "bodyText": "Note that this is a load test, and we also have integration test suite: \n  \n    \n      beam/.test-infra/jenkins/job_PostCommit_Python_MongoDBIO_IT.groovy\n    \n    \n         Line 35\n      in\n      d971ba1\n    \n    \n    \n    \n\n        \n          \n           tasks(':sdks:python:test-suites:direct:py35:mongodbioIT')", "url": "https://github.com/apache/beam/pull/12239#discussion_r463908521", "createdAt": "2020-08-01T02:21:59Z", "author": {"login": "tvalentyn"}, "path": ".test-infra/jenkins/job_PostCommit_Python_MongoDBIO_Load_Test.groovy", "diffHunk": "@@ -51,7 +51,7 @@ job(jobName) {\n       rootBuildScriptDir(common.checkoutDir)\n       common.setGradleSwitches(delegate)\n       switches(\"-Popts=\\'${common.mapToArgString(pipelineOptions)}\\'\")\n-      tasks(\":sdks:python:test-suites:dataflow:py35:mongodbioIT\")\n+      tasks(\":sdks:python:test-suites:dataflow:mongodbioIT\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7daa16c59ef13763ff08a3b4d5898eecaed40a84"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkwOTQzMA==", "bodyText": "(missed this comment) I think I understand what you mean.\nLet's consider a contributor who is adding a new test or test suite that needs to run in postcommit (after PR is merged). How would they configure their suite? Looking at this file it may not be obvious, for example hdfs test suite is added in PostCommit and Py38 PostCommit but MongoDBIO suite is only defined in PostCommit.\nHow can we make the configuration more straightforward?\nWe should also consider what guidance we can give contributors when to create a new jenkins job and when to add to add to existing postcommit jobs. For example we have a separate job for MongoDB IO, but do not for HDFS, probably because both tests were added by different people and the configuration was not easy to figure out.", "url": "https://github.com/apache/beam/pull/12239#discussion_r463909430", "createdAt": "2020-08-01T02:29:40Z", "author": {"login": "tvalentyn"}, "path": "build.gradle", "diffHunk": "@@ -243,13 +241,16 @@ task pythonFormatterPreCommit() {\n   dependsOn 'sdks:python:test-suites:tox:py38:formatter'\n }\n \n+task pythonPostCommit() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI5NTkxMw=="}, "originalCommit": {"oid": "53e5b7746dca97939487f1cf73b1c927a55ac3a5"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkxMDczNw==", "bodyText": "I think adding a new Jenkins job in this PR might add more confusion until we clarify how to reconcile this suite with other postcommit suites.\nHow about we keep the test suites in the jenkins jobs where they are defined right now, but make the python versions configurable in the gradle.properties file? This would allow us to merge most of these changes faster, including the refactoring to use suites definitions from common.gradle.\nLater we can reconsider the shapes of Jenkins job when we define High Priortity/Low priority versions.", "url": "https://github.com/apache/beam/pull/12239#discussion_r463910737", "createdAt": "2020-08-01T02:39:02Z", "author": {"login": "tvalentyn"}, "path": "build.gradle", "diffHunk": "@@ -243,13 +241,16 @@ task pythonFormatterPreCommit() {\n   dependsOn 'sdks:python:test-suites:tox:py38:formatter'\n }\n \n+task pythonPostCommit() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI5NTkxMw=="}, "originalCommit": {"oid": "53e5b7746dca97939487f1cf73b1c927a55ac3a5"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkxMTU5NQ==", "bodyText": "I think for a reader getListProperty name might be confusing  and they would have to look up the implementation. We could consider the name getVersionsAsList or use getProperty('dataflow_precommit_it_task_py_versions').split(',').each directly.", "url": "https://github.com/apache/beam/pull/12239#discussion_r463911595", "createdAt": "2020-08-01T02:47:31Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/dataflow/build.gradle", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: org.apache.beam.gradle.BeamModulePlugin\n+applyPythonNature()\n+\n+dependencies {\n+  distTarBall project(path: \":sdks:python\", configuration: \"distTarBall\")\n+}\n+\n+task preCommitIT {\n+  getListProperty('dataflow_precommit_it_task_py_versions').each {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4001d5b211b8a483f98c7e3b4c5025da8aaab914"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81b3b07952231659f9ac5840925b9cc563507cd0", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/81b3b07952231659f9ac5840925b9cc563507cd0", "committedDate": "2020-08-03T15:31:25Z", "message": "[BEAM-9980] add groovy functions for python versions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1f69d72b577aacef2e8ac905298f494723210cc", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/e1f69d72b577aacef2e8ac905298f494723210cc", "committedDate": "2020-08-03T16:16:00Z", "message": "[BEAM-9980] update dataflow test-suites to switch python versions using in tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4001d5b211b8a483f98c7e3b4c5025da8aaab914", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/4001d5b211b8a483f98c7e3b4c5025da8aaab914", "committedDate": "2020-07-30T15:06:57Z", "message": "[BEAM-9980] update portable test-suites to switch python versions using in tests"}, "afterCommit": {"oid": "0f9aadb69a2a273627cbc96e2387dc34bc424d81", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/0f9aadb69a2a273627cbc96e2387dc34bc424d81", "committedDate": "2020-08-03T16:20:22Z", "message": "[BEAM-9980] update portable test-suites to switch python versions using in tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyMDM0MjEw", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-462034210", "createdAt": "2020-08-05T21:23:26Z", "commit": {"oid": "e1f69d72b577aacef2e8ac905298f494723210cc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMToyMzoyN1rOG8bIjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQyMToyMzoyN1rOG8bIjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAxMjMwMQ==", "bodyText": "why do we need build.gradle in addition to common.grade?", "url": "https://github.com/apache/beam/pull/12239#discussion_r466012301", "createdAt": "2020-08-05T21:23:27Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/dataflow/build.gradle", "diffHunk": "@@ -0,0 +1,50 @@\n+/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1f69d72b577aacef2e8ac905298f494723210cc"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNzA4Mzkx", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-463708391", "createdAt": "2020-08-08T01:49:59Z", "commit": {"oid": "099ceddd70854bbca003fe00bc85a992ffa1e158"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwMTo1MDowMFrOG9slOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwMjowNTozN1rOG9srLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0Njc0NQ==", "bodyText": "We can remove this comment.", "url": "https://github.com/apache/beam/pull/12239#discussion_r467346745", "createdAt": "2020-08-08T01:50:00Z", "author": {"login": "tvalentyn"}, "path": "build.gradle", "diffHunk": "@@ -220,13 +220,12 @@ task pythonPreCommit() {\n   dependsOn \":sdks:python:test-suites:tox:py36:preCommitPy36\"\n   dependsOn \":sdks:python:test-suites:tox:py37:preCommitPy37\"\n   dependsOn \":sdks:python:test-suites:tox:py38:preCommitPy38\"\n-  dependsOn \":sdks:python:test-suites:dataflow:py2:preCommitIT\"\n-  dependsOn \":sdks:python:test-suites:dataflow:py2:preCommitIT_V2\"\n-  dependsOn \":sdks:python:test-suites:dataflow:py37:preCommitIT\"\n-  dependsOn \":sdks:python:test-suites:dataflow:py37:preCommitIT_V2\"\n-  // We don't include Py35, Py36 precommit ITs to reduce quota footprint.\n-  // We can reconsider if we ever see an issue that these suites would\n-  // have caught. Note that the same tests will still run in postcommit.\n+  dependsOn \":sdks:python:test-suites:dataflow:preCommitIT\"\n+  dependsOn \":sdks:python:test-suites:dataflow:preCommitIT_V2\"\n+  // We don't include all supported Python versions precommit ITs to", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "099ceddd70854bbca003fe00bc85a992ffa1e158"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0ODI3MQ==", "bodyText": "I'm not sure I follow this change - this is currently still a python2 PostCommit suite, so it should include py2 only tests.\nHowever you could convert the targets that are not version-specific, such as\ntask portablePythonPreCommit() \ntask pythonSparkPostCommit() \n\nto point to portable/build.gradle", "url": "https://github.com/apache/beam/pull/12239#discussion_r467348271", "createdAt": "2020-08-08T02:05:37Z", "author": {"login": "tvalentyn"}, "path": "build.gradle", "diffHunk": "@@ -248,9 +247,9 @@ task pythonFormatterPreCommit() {\n \n task python2PostCommit() {\n   dependsOn \":sdks:python:test-suites:portable:py2:crossLanguagePythonJavaKafkaIOFlink\"\n-  dependsOn \":sdks:python:test-suites:portable:py2:crossLanguageTests\"\n+  dependsOn \":sdks:python:test-suites:portable:crossLanguageTests\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "099ceddd70854bbca003fe00bc85a992ffa1e158"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNzEyNTE3", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-463712517", "createdAt": "2020-08-08T02:57:39Z", "commit": {"oid": "a3146e6e5f72d4d1590f33c8cec24bc2845d3ccc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwMjo1Nzo0MFrOG9s89w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwMjo1Nzo0MFrOG9s89w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM1MjgyMw==", "bodyText": "Let's modify https://github.com/apache/beam/blob/master/.test-infra/jenkins/job_PostCommit_Python_MongoDBIO_IT.groovy as well to point to direct/build.gradle.\nAlso, it seems like there is a duplication in MongoDBIO suites. I think we can remove the separate jenkins Job for MongoDB IO and include it into the direct runner suites in a separate change.\nAlso we can add version specifiers for MongoDB performance tests in another change.", "url": "https://github.com/apache/beam/pull/12239#discussion_r467352823", "createdAt": "2020-08-08T02:57:40Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5\n+dataflow_chicago_taxi_example_task_py_versions=2.7\n+\n+# direct test-suites\n+hdfs_integration_test_task_py_versions=2.7,3.8\n+direct_mongodbio_it_task_py_versions=2.7,3.5", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3146e6e5f72d4d1590f33c8cec24bc2845d3ccc"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NzE1ODg2", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-464715886", "createdAt": "2020-08-11T02:58:21Z", "commit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMjo1ODoyMlrOG-mphA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMzoxMDoyNVrOG-m1Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI5ODExNg==", "bodyText": "it looks like portable test suite configurations currently don't not have any effect, because the tasks from portable/build.gradle are not referenced in any groovy files or top-level tasks.  let's not add these configs and not add /portable/build.gradle in this change, and make those changes once we are ready to switch to using tasks from portable/build.gradle.\nIn current form, configs in portable section make an illusion that they control the versions of suites being used, but they currently don't.", "url": "https://github.com/apache/beam/pull/12239#discussion_r468298116", "createdAt": "2020-08-11T02:58:22Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5\n+dataflow_chicago_taxi_example_task_py_versions=2.7\n+\n+# direct test-suites\n+hdfs_integration_test_task_py_versions=2.7,3.8\n+direct_mongodbio_it_task_py_versions=2.7,3.5\n+direct_runner_it_task_py_versions=2.7\n+\n+# portable test-suites\n+cross_language_task_py_versions=2.7", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwMTEwMw==", "bodyText": "I don't think we have a dataflow MongoDB suite - I only see a direct runner suite.", "url": "https://github.com/apache/beam/pull/12239#discussion_r468301103", "createdAt": "2020-08-11T03:10:25Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NzIyMzg0", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-464722384", "createdAt": "2020-08-11T03:22:11Z", "commit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMzoyMjoxMVrOG-m_tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMzoyMjoxMVrOG-m_tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwMzc5OQ==", "bodyText": "Does this configuration have any effect?", "url": "https://github.com/apache/beam/pull/12239#discussion_r468303799", "createdAt": "2020-08-11T03:22:11Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5\n+dataflow_chicago_taxi_example_task_py_versions=2.7", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NzIyNDM4", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-464722438", "createdAt": "2020-08-11T03:22:23Z", "commit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMzoyMjoyM1rOG-m_5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMzoyNzo0NlrOG-nEvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwMzg0Nw==", "bodyText": "Does this configuration have any effect?", "url": "https://github.com/apache/beam/pull/12239#discussion_r468303847", "createdAt": "2020-08-11T03:22:23Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5\n+dataflow_chicago_taxi_example_task_py_versions=2.7\n+\n+# direct test-suites\n+hdfs_integration_test_task_py_versions=2.7,3.8", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNDIxNg==", "bodyText": "This task appears to be unused.", "url": "https://github.com/apache/beam/pull/12239#discussion_r468304216", "createdAt": "2020-08-11T03:24:06Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/direct/build.gradle", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+plugins { id 'org.apache.beam.module' }\n+applyPythonNature()\n+\n+task directRunnerIT {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNDI0Mw==", "bodyText": "This task appears to be unused.", "url": "https://github.com/apache/beam/pull/12239#discussion_r468304243", "createdAt": "2020-08-11T03:24:17Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/direct/build.gradle", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+plugins { id 'org.apache.beam.module' }\n+applyPythonNature()\n+\n+task directRunnerIT {\n+  getVersionsAsList('direct_runner_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:direct:py${getVersionSuffix(it)}:directRunnerIT\")\n+  }\n+}\n+\n+task hdfsIntegrationTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNDM2OA==", "bodyText": "This task appears to be unused", "url": "https://github.com/apache/beam/pull/12239#discussion_r468304368", "createdAt": "2020-08-11T03:24:47Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/dataflow/build.gradle", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: org.apache.beam.gradle.BeamModulePlugin\n+applyPythonNature()\n+\n+dependencies {\n+  distTarBall project(path: \":sdks:python\", configuration: \"distTarBall\")\n+}\n+\n+task preCommitIT {\n+  getVersionsAsList('dataflow_precommit_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:preCommitIT_batch\")\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:preCommitIT_streaming\")\n+  }\n+}\n+\n+task preCommitIT_V2{\n+  getVersionsAsList('dataflow_precommit_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:preCommitIT_batch_V2\")\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:preCommitIT_streaming_V2\")\n+  }\n+}\n+\n+task mongodbioIT {\n+  getVersionsAsList('dataflow_mongodbio_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:mongodbioIT\")\n+  }\n+}\n+\n+task chicagoTaxiExample {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNTA4NQ==", "bodyText": "Please also take a look at other build.gradle files, let's only add new tasks when we connect them with top-level test tasks or groovy files that trigger test suites.", "url": "https://github.com/apache/beam/pull/12239#discussion_r468305085", "createdAt": "2020-08-11T03:27:46Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/test-suites/direct/build.gradle", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+plugins { id 'org.apache.beam.module' }\n+applyPythonNature()\n+\n+task directRunnerIT {\n+  getVersionsAsList('direct_runner_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:direct:py${getVersionSuffix(it)}:directRunnerIT\")\n+  }\n+}\n+\n+task hdfsIntegrationTest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNDI0Mw=="}, "originalCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd7dda28a5bb85f6e73f47a0e3898db11a97ef0e", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/dd7dda28a5bb85f6e73f47a0e3898db11a97ef0e", "committedDate": "2020-08-12T16:52:17Z", "message": "[BEAM-9980] version switchable dataflow tasks to be invoked"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a", "committedDate": "2020-08-12T16:54:11Z", "message": "[BEAM-9980] :sdks:python:test-suites:dataflow included in settings.gradle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "committedDate": "2020-08-10T12:23:29Z", "message": "fixup: use direct test-suites mongodbioIT task in postcommit job"}, "afterCommit": {"oid": "e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a", "author": {"user": {"login": "lazylynx", "name": "yoshiki.obata"}}, "url": "https://github.com/apache/beam/commit/e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a", "committedDate": "2020-08-12T16:54:11Z", "message": "[BEAM-9980] :sdks:python:test-suites:dataflow included in settings.gradle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4ODM2Mjg2", "url": "https://github.com/apache/beam/pull/12239#pullrequestreview-468836286", "createdAt": "2020-08-17T21:12:36Z", "commit": {"oid": "e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4070, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}