{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NTM5MTI4", "number": 11652, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzo0MjozOFrOD7VwuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMDozMzo1M1rOD7ZPvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNTQ5MTEzOnYy", "diffSide": "RIGHT", "path": "model/pipeline/src/main/proto/metrics.proto", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzo0MjozOFrOGTmrSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzo0MjozOFrOGTmrSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIwOTgwMQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                // For an SDK that processe items sequentially, this is equivalently the\n          \n          \n            \n                // For an SDK that processes items sequentially, this is equivalently the", "url": "https://github.com/apache/beam/pull/11652#discussion_r423209801", "createdAt": "2020-05-11T17:42:38Z", "author": {"login": "lukecwik"}, "path": "model/pipeline/src/main/proto/metrics.proto", "diffHunk": "@@ -292,6 +292,21 @@ message MonitoringInfoSpecs {\n         value: \"The remaining amount of work for each active element. Each active element represents an independent amount of work not shared with any other active element.\"\n       }]\n     }];\n+\n+    // The (0-based) index of the latest item processed from the data channel.\n+    // This gives an indication of the SDKs progress through the data channel,\n+    // and is a lower bound on where it is able to split.\n+    // For an SDK that processe items sequentially, this is equivalently the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ee03bca4f36e8e40055d7651d8cb3e5461bc8eb"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNTUwNjA3OnYy", "diffSide": "RIGHT", "path": "model/pipeline/src/main/proto/metrics.proto", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzo0NzowOVrOGTm0-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzo0NzowOVrOGTm0-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIxMjI4Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                // number of items fully processed (or -1 if reading has not yet started).\n          \n          \n            \n                // number of items fully processed (or -1 if processing has not yet started).", "url": "https://github.com/apache/beam/pull/11652#discussion_r423212282", "createdAt": "2020-05-11T17:47:09Z", "author": {"login": "lukecwik"}, "path": "model/pipeline/src/main/proto/metrics.proto", "diffHunk": "@@ -292,6 +292,21 @@ message MonitoringInfoSpecs {\n         value: \"The remaining amount of work for each active element. Each active element represents an independent amount of work not shared with any other active element.\"\n       }]\n     }];\n+\n+    // The (0-based) index of the latest item processed from the data channel.\n+    // This gives an indication of the SDKs progress through the data channel,\n+    // and is a lower bound on where it is able to split.\n+    // For an SDK that processe items sequentially, this is equivalently the\n+    // number of items fully processed (or -1 if reading has not yet started).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ee03bca4f36e8e40055d7651d8cb3e5461bc8eb"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNTUyMjUzOnYy", "diffSide": "RIGHT", "path": "model/pipeline/src/main/proto/metrics.proto", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzo1MjowNVrOGTm_rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzo1MjowNVrOGTm_rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIxNTAyMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    value: \"The number of items processed from a data channel.\"\n          \n          \n            \n                    value: \"The read index of the data channel.\"", "url": "https://github.com/apache/beam/pull/11652#discussion_r423215022", "createdAt": "2020-05-11T17:52:05Z", "author": {"login": "lukecwik"}, "path": "model/pipeline/src/main/proto/metrics.proto", "diffHunk": "@@ -292,6 +292,21 @@ message MonitoringInfoSpecs {\n         value: \"The remaining amount of work for each active element. Each active element represents an independent amount of work not shared with any other active element.\"\n       }]\n     }];\n+\n+    // The (0-based) index of the latest item processed from the data channel.\n+    // This gives an indication of the SDKs progress through the data channel,\n+    // and is a lower bound on where it is able to split.\n+    // For an SDK that processe items sequentially, this is equivalently the\n+    // number of items fully processed (or -1 if reading has not yet started).\n+    DATA_CHANNEL_READ_INDEX = 18 [(monitoring_info_spec) = {\n+      urn: \"beam:metric:data_channel:read_index:v1\",\n+      type: \"beam:metrics:sum_int64:v1\",\n+      required_labels: [ \"PTRANSFORM\" ],\n+      annotations: [{\n+        key: \"description\",\n+        value: \"The number of items processed from a data channel.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ee03bca4f36e8e40055d7651d8cb3e5461bc8eb"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNTUyMzQyOnYy", "diffSide": "RIGHT", "path": "sdks/go/pkg/beam/core/runtime/harness/monitoring.go", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzo1MjoyMlrOGTnATA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxODo1Mzo1NFrOGTpGAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIxNTE4MA==", "bodyText": "spacing", "url": "https://github.com/apache/beam/pull/11652#discussion_r423215180", "createdAt": "2020-05-11T17:52:22Z", "author": {"login": "lukecwik"}, "path": "sdks/go/pkg/beam/core/runtime/harness/monitoring.go", "diffHunk": "@@ -265,8 +269,9 @@ func monitoring(p *exec.Plan) ([]*pipepb.MonitoringInfo, map[string][]byte) {\n \t\tif err != nil {\n \t\t\tpanic(err)\n \t\t}\n-\t\tpayloads[getShortID(metrics.PCollectionLabels(snapshot.PID), urnElementCount)] = payload\n \n+    // TODO(BEAM-9934): This metric should account for elements in multiple windows.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ee03bca4f36e8e40055d7651d8cb3e5461bc8eb"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzI0OTQwOA==", "bodyText": "Ah, tabs.", "url": "https://github.com/apache/beam/pull/11652#discussion_r423249408", "createdAt": "2020-05-11T18:53:54Z", "author": {"login": "robertwb"}, "path": "sdks/go/pkg/beam/core/runtime/harness/monitoring.go", "diffHunk": "@@ -265,8 +269,9 @@ func monitoring(p *exec.Plan) ([]*pipepb.MonitoringInfo, map[string][]byte) {\n \t\tif err != nil {\n \t\t\tpanic(err)\n \t\t}\n-\t\tpayloads[getShortID(metrics.PCollectionLabels(snapshot.PID), urnElementCount)] = payload\n \n+    // TODO(BEAM-9934): This metric should account for elements in multiple windows.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIxNTE4MA=="}, "originalCommit": {"oid": "4ee03bca4f36e8e40055d7651d8cb3e5461bc8eb"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNjA2MjA0OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/metrics/monitoring_infos.py", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMDozMzo1M1rOGTsVrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQyMDo1Mzo1OVrOGTs_ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMwMjU3NQ==", "bodyText": "Looks like you are missing spec here.", "url": "https://github.com/apache/beam/pull/11652#discussion_r423302575", "createdAt": "2020-05-11T20:33:53Z", "author": {"login": "ibzib"}, "path": "sdks/python/apache_beam/metrics/monitoring_infos.py", "diffHunk": "@@ -56,6 +56,8 @@\n     [USER_COUNTER_URN, USER_DISTRIBUTION_URN, USER_GAUGE_URN])\n WORK_REMAINING_URN = common_urns.monitoring_info_specs.WORK_REMAINING.spec.urn\n WORK_COMPLETED_URN = common_urns.monitoring_info_specs.WORK_COMPLETED.spec.urn\n+DATA_CHANNEL_READ_INDEX = (\n+    common_urns.monitoring_info_specs.DATA_CHANNEL_READ_INDEX.urn)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2fbb79f9935f2b9488888e1a4ba193d0d3e5af93"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMxMjkyMw==", "bodyText": "good find", "url": "https://github.com/apache/beam/pull/11652#discussion_r423312923", "createdAt": "2020-05-11T20:53:22Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/metrics/monitoring_infos.py", "diffHunk": "@@ -56,6 +56,8 @@\n     [USER_COUNTER_URN, USER_DISTRIBUTION_URN, USER_GAUGE_URN])\n WORK_REMAINING_URN = common_urns.monitoring_info_specs.WORK_REMAINING.spec.urn\n WORK_COMPLETED_URN = common_urns.monitoring_info_specs.WORK_COMPLETED.spec.urn\n+DATA_CHANNEL_READ_INDEX = (\n+    common_urns.monitoring_info_specs.DATA_CHANNEL_READ_INDEX.urn)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMwMjU3NQ=="}, "originalCommit": {"oid": "2fbb79f9935f2b9488888e1a4ba193d0d3e5af93"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMxMzMxNQ==", "bodyText": "Yeah, I just found that myself... Not sure why it has a urn and a spec.urn.", "url": "https://github.com/apache/beam/pull/11652#discussion_r423313315", "createdAt": "2020-05-11T20:53:59Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/metrics/monitoring_infos.py", "diffHunk": "@@ -56,6 +56,8 @@\n     [USER_COUNTER_URN, USER_DISTRIBUTION_URN, USER_GAUGE_URN])\n WORK_REMAINING_URN = common_urns.monitoring_info_specs.WORK_REMAINING.spec.urn\n WORK_COMPLETED_URN = common_urns.monitoring_info_specs.WORK_COMPLETED.spec.urn\n+DATA_CHANNEL_READ_INDEX = (\n+    common_urns.monitoring_info_specs.DATA_CHANNEL_READ_INDEX.urn)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMwMjU3NQ=="}, "originalCommit": {"oid": "2fbb79f9935f2b9488888e1a4ba193d0d3e5af93"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3889, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}