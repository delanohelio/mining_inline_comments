{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NTc3ODA1", "number": 11502, "title": "[BEAM-9797] use virtualenv for Java license pulling", "bodyText": "Please add a meaningful description for your change here\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-04-22T22:21:17Z", "url": "https://github.com/apache/beam/pull/11502", "merged": true, "mergeCommit": {"oid": "99155258f958f41aa02bf455217042dc77d77a1e"}, "closed": true, "closedAt": "2020-04-27T22:21:45Z", "author": {"login": "Hannah-Jiang"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaP_kBgBqjMyNjI2NzUzMDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcchz6iAFqTQwMzEyNjI4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "35c44357c2065e17f33c5a0f45544f75502a4861", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/35c44357c2065e17f33c5a0f45544f75502a4861", "committedDate": "2020-04-22T22:22:09Z", "message": "Merge branch 'master' into license_java_fix"}, "afterCommit": {"oid": "b0ae8d0117641fea7c35d61a1ddbf6d834828ad0", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/b0ae8d0117641fea7c35d61a1ddbf6d834828ad0", "committedDate": "2020-04-22T22:25:52Z", "message": "use tox for license pulling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b0ae8d0117641fea7c35d61a1ddbf6d834828ad0", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/b0ae8d0117641fea7c35d61a1ddbf6d834828ad0", "committedDate": "2020-04-22T22:25:52Z", "message": "use tox for license pulling"}, "afterCommit": {"oid": "5283245656cebd10e3319f4fba13f57e0d43a9a9", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/5283245656cebd10e3319f4fba13f57e0d43a9a9", "committedDate": "2020-04-22T22:28:36Z", "message": "use tox for license pulling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5283245656cebd10e3319f4fba13f57e0d43a9a9", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/5283245656cebd10e3319f4fba13f57e0d43a9a9", "committedDate": "2020-04-22T22:28:36Z", "message": "use tox for license pulling"}, "afterCommit": {"oid": "fc6d0ee8c573ba4dd50191c75f8c5cf2a43fb519", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/fc6d0ee8c573ba4dd50191c75f8c5cf2a43fb519", "committedDate": "2020-04-22T22:29:55Z", "message": "use tox for license pulling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6293211dd6aa59a42773bac55e6614954324ccd4", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/6293211dd6aa59a42773bac55e6614954324ccd4", "committedDate": "2020-04-22T22:31:44Z", "message": "Merge branch 'master' into license_java_fix"}, "afterCommit": {"oid": "11079e3dd5c8e3e2970dc2ac4f219173afa456b4", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/11079e3dd5c8e3e2970dc2ac4f219173afa456b4", "committedDate": "2020-04-22T23:06:56Z", "message": "use tox for license pulling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "11079e3dd5c8e3e2970dc2ac4f219173afa456b4", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/11079e3dd5c8e3e2970dc2ac4f219173afa456b4", "committedDate": "2020-04-22T23:06:56Z", "message": "use tox for license pulling"}, "afterCommit": {"oid": "5bbf32dd2ba727f9125d63d2c9a8fc07ebfb2752", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/5bbf32dd2ba727f9125d63d2c9a8fc07ebfb2752", "committedDate": "2020-04-23T21:51:28Z", "message": "use tox for license pulling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5bbf32dd2ba727f9125d63d2c9a8fc07ebfb2752", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/5bbf32dd2ba727f9125d63d2c9a8fc07ebfb2752", "committedDate": "2020-04-23T21:51:28Z", "message": "use tox for license pulling"}, "afterCommit": {"oid": "05f5a6684e53f9d9eeae7dc808acee3f2907b0ff", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/05f5a6684e53f9d9eeae7dc808acee3f2907b0ff", "committedDate": "2020-04-23T22:08:23Z", "message": "use tox for license pulling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05f5a6684e53f9d9eeae7dc808acee3f2907b0ff", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/05f5a6684e53f9d9eeae7dc808acee3f2907b0ff", "committedDate": "2020-04-23T22:08:23Z", "message": "use tox for license pulling"}, "afterCommit": {"oid": "3b71cbd59599aff0654c2b449e4e4b9e5559c943", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/3b71cbd59599aff0654c2b449e4e4b9e5559c943", "committedDate": "2020-04-23T22:35:03Z", "message": "use tox for license pulling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3b71cbd59599aff0654c2b449e4e4b9e5559c943", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/3b71cbd59599aff0654c2b449e4e4b9e5559c943", "committedDate": "2020-04-23T22:35:03Z", "message": "use tox for license pulling"}, "afterCommit": {"oid": "1e037036cb3a73914d87e606871a08537ba8805d", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/1e037036cb3a73914d87e606871a08537ba8805d", "committedDate": "2020-04-23T22:48:31Z", "message": "use tox for license pulling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NTYwOTM4", "url": "https://github.com/apache/beam/pull/11502#pullrequestreview-399560938", "createdAt": "2020-04-24T00:14:39Z", "commit": {"oid": "1e037036cb3a73914d87e606871a08537ba8805d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwMDoxNDozOVrOGLBNCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwMDoxNDozOVrOGLBNCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDIwNzI0Mg==", "bodyText": "The solution could be to do something like:\n# Creates a new directory $env_path and installs a virtual environment in it.\nenv_path=$ROOT_DIR/build/license_scripts_env\nvirtualenv $env_path --python python3.7\nsource $env_path/bin/activate\n# Install tox, or just install the packages directly. Might be less complicated to skip using tox in this case.\npip install ...", "url": "https://github.com/apache/beam/pull/11502#discussion_r414207242", "createdAt": "2020-04-24T00:14:39Z", "author": {"login": "udim"}, "path": "sdks/java/container/license_scripts/license_script.sh", "diffHunk": "@@ -15,39 +15,33 @@\n  # limitations under the License.\n \n set -e\n+ROOT_DIR=$(pwd)\n+CONTAINER_DIR=\"$ROOT_DIR/sdks/java/container\"\n+\n # reports are generated at ~/beam/java_third_party_licenses\n ./gradlew generateLicenseReport --rerun-tasks\n \n-# install packages needed for pull_licenses_java.py\n-pip install \"beautifulsoup4>=4.9.0,<5.0\"\n-pip install \"future>=0.16.0,<1.0.0\"\n-pip install \"pyyaml>=3.12,<6.0.0\"\n-pip install \"tenacity>=5.0.2,<6.0\"\n+# pip install 'tox>=3.14.6,<3.15.0'\n+pip install --no-cache-dir tox==3.11.1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e037036cb3a73914d87e606871a08537ba8805d"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "046393d9f4ed7f83dc3a639fd795ddba508e06be", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/046393d9f4ed7f83dc3a639fd795ddba508e06be", "committedDate": "2020-04-24T03:20:17Z", "message": "use virtualenv"}, "afterCommit": {"oid": "7400a017179f12c8ede11419b58a24a86b0e29dc", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/7400a017179f12c8ede11419b58a24a86b0e29dc", "committedDate": "2020-04-24T03:40:08Z", "message": "use virtualenv"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7400a017179f12c8ede11419b58a24a86b0e29dc", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/7400a017179f12c8ede11419b58a24a86b0e29dc", "committedDate": "2020-04-24T03:40:08Z", "message": "use virtualenv"}, "afterCommit": {"oid": "c8052cd4914158516d2f01b26cf149d63fb6bed7", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/c8052cd4914158516d2f01b26cf149d63fb6bed7", "committedDate": "2020-04-24T03:55:03Z", "message": "use virtualenv"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "72e24e82b8b2253b49d1234720f795025ed64e29", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/72e24e82b8b2253b49d1234720f795025ed64e29", "committedDate": "2020-04-24T23:10:46Z", "message": "use virtualenv"}, "afterCommit": {"oid": "152e8894f2f7f2e41f6954c6c55e57b5806eccd5", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/152e8894f2f7f2e41f6954c6c55e57b5806eccd5", "committedDate": "2020-04-24T23:20:58Z", "message": "virtualenv"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "152e8894f2f7f2e41f6954c6c55e57b5806eccd5", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/152e8894f2f7f2e41f6954c6c55e57b5806eccd5", "committedDate": "2020-04-24T23:20:58Z", "message": "virtualenv"}, "afterCommit": {"oid": "327f5b63469e7bfa59ae9d3e2264ed16343a8cf5", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/327f5b63469e7bfa59ae9d3e2264ed16343a8cf5", "committedDate": "2020-04-24T23:29:49Z", "message": "virtualenv"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "436997c1776e2fcece0395dbcadedb8cb97a6dc7", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/436997c1776e2fcece0395dbcadedb8cb97a6dc7", "committedDate": "2020-04-25T00:11:53Z", "message": "virtualenv"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "327f5b63469e7bfa59ae9d3e2264ed16343a8cf5", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/327f5b63469e7bfa59ae9d3e2264ed16343a8cf5", "committedDate": "2020-04-24T23:29:49Z", "message": "virtualenv"}, "afterCommit": {"oid": "436997c1776e2fcece0395dbcadedb8cb97a6dc7", "author": {"user": {"login": "Hannah-Jiang", "name": "Hannah Jiang"}}, "url": "https://github.com/apache/beam/commit/436997c1776e2fcece0395dbcadedb8cb97a6dc7", "committedDate": "2020-04-25T00:11:53Z", "message": "virtualenv"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMzY3Nzkw", "url": "https://github.com/apache/beam/pull/11502#pullrequestreview-401367790", "createdAt": "2020-04-27T22:18:55Z", "commit": {"oid": "436997c1776e2fcece0395dbcadedb8cb97a6dc7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzMTI2Mjgy", "url": "https://github.com/apache/beam/pull/11502#pullrequestreview-403126282", "createdAt": "2020-04-30T00:19:31Z", "commit": {"oid": "436997c1776e2fcece0395dbcadedb8cb97a6dc7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQwMDoxOTozMVrOGOVi9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQwMDoxOTozMVrOGOVi9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY4NjI2Mw==", "bodyText": "@Hannah-Jiang @udim should we keep the py2 imports for now? I still have python 2 as the default python on my machine, so this change broke :sdks:java:container:docker for me\nOr maybe I should have changed the default by now?", "url": "https://github.com/apache/beam/pull/11502#discussion_r417686263", "createdAt": "2020-04-30T00:19:31Z", "author": {"login": "TheNeuralBit"}, "path": "sdks/java/container/license_scripts/pull_licenses_java.py", "diffHunk": "@@ -35,18 +35,9 @@\n from tenacity import retry\n from tenacity import stop_after_attempt\n from tenacity import wait_exponential\n+from urllib.request import urlopen, URLError, HTTPError\n+\n \n-try:\n-    # py2\n-    from future.moves.urllib.request import urlopen\n-    from future.moves.urllib.request import URLError, HTTPError\n-except:\n-    # py3\n-    from future import standard_library\n-    from urllib.request import urlopen, URLError, HTTPError", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "436997c1776e2fcece0395dbcadedb8cb97a6dc7"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3913, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}