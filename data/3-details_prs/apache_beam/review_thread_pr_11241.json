{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0NDYwMjQy", "number": 11241, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDowNToyMFrODuKWHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDowNToyMFrODuKWHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5NzMwNTkxOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/DynamicDestinations.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwMDowNToyMFrOGAAs3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMzowNDoxMVrOGCdX1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY2NDY2OQ==", "bodyText": "Should we update Python SDK as well ?\ncc: @pabloem", "url": "https://github.com/apache/beam/pull/11241#discussion_r402664669", "createdAt": "2020-04-03T00:05:20Z", "author": {"login": "chamikaramj"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/DynamicDestinations.java", "diffHunk": "@@ -142,7 +142,11 @@ void setSideInputAccessorFromProcessContext(DoFn<?, ?>.ProcessContext context) {\n     return null;\n   }\n \n-  /** Returns a {@link TableDestination} object for the destination. May not return null. */\n+  /**\n+   * Returns a {@link TableDestination} object for the destination. May not return null. Return\n+   * value needs to be unique to each destination: may not return the same {@link TableDestination}\n+   * for different destinations.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c70d30bd3e6c0e5b349e975ead21315b7df5de2f"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE5ODI4Nw==", "bodyText": "Hm I do not think this is necessary in Python. In Python, we expect table names to be returned as the destination, so this case may not occur...", "url": "https://github.com/apache/beam/pull/11241#discussion_r405198287", "createdAt": "2020-04-08T00:56:58Z", "author": {"login": "pabloem"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/DynamicDestinations.java", "diffHunk": "@@ -142,7 +142,11 @@ void setSideInputAccessorFromProcessContext(DoFn<?, ?>.ProcessContext context) {\n     return null;\n   }\n \n-  /** Returns a {@link TableDestination} object for the destination. May not return null. */\n+  /**\n+   * Returns a {@link TableDestination} object for the destination. May not return null. Return\n+   * value needs to be unique to each destination: may not return the same {@link TableDestination}\n+   * for different destinations.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY2NDY2OQ=="}, "originalCommit": {"oid": "c70d30bd3e6c0e5b349e975ead21315b7df5de2f"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIzMTU3NQ==", "bodyText": "TLDR: Pablo is right.\nIn Python SDK, a user function translates an element to a TableReference.\nIn Java SDK, a user DynamicDestinations instance translates an element to a DestinationT, and then to a TableDestination.\nJava does a reshuffle on (DestinationT, element) pairs, while Python does it on (TableReference, element) pairs.\n(Not sure why Java uses an intermediate DestinationT. Convenience? Better GBK performance? Lower resource use?)", "url": "https://github.com/apache/beam/pull/11241#discussion_r405231575", "createdAt": "2020-04-08T03:04:11Z", "author": {"login": "udim"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/DynamicDestinations.java", "diffHunk": "@@ -142,7 +142,11 @@ void setSideInputAccessorFromProcessContext(DoFn<?, ?>.ProcessContext context) {\n     return null;\n   }\n \n-  /** Returns a {@link TableDestination} object for the destination. May not return null. */\n+  /**\n+   * Returns a {@link TableDestination} object for the destination. May not return null. Return\n+   * value needs to be unique to each destination: may not return the same {@link TableDestination}\n+   * for different destinations.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY2NDY2OQ=="}, "originalCommit": {"oid": "c70d30bd3e6c0e5b349e975ead21315b7df5de2f"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1545, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}