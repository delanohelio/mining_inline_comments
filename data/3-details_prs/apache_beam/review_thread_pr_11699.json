{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3NjE2MjMx", "number": 11699, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMzozMDoxNVrOD8RYLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMzozMDoxNVrOD8RYLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NTI1ODcwOnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/io/parquetio.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMzozMDoxNVrOGVHA8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwMzo1MDowMVrOGVLHGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc4ODIwOA==", "bodyText": "Thanks for tracking this down!\nI wonder what changed in 0.17 to reveal this. Maybe the parquet writer (which we use to generate test data) wasn't eliding the null buffer before?", "url": "https://github.com/apache/beam/pull/11699#discussion_r424788208", "createdAt": "2020-05-13T23:30:15Z", "author": {"login": "TheNeuralBit"}, "path": "sdks/python/apache_beam/io/parquetio.py", "diffHunk": "@@ -567,5 +567,6 @@ def _flush_buffer(self):\n     size = 0\n     for x in arrays:\n       for b in x.buffers():\n-        size = size + b.size\n+        if b is not None:\n+          size = size + b.size", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "be41f42ddadf199c3d81d08006cd830d227261c7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDg1NTMyMA==", "bodyText": "Maybe the array factory function (pa.array()) is smarter (x there was created just several lines ago, using that factory function)", "url": "https://github.com/apache/beam/pull/11699#discussion_r424855320", "createdAt": "2020-05-14T03:50:01Z", "author": {"login": "brills"}, "path": "sdks/python/apache_beam/io/parquetio.py", "diffHunk": "@@ -567,5 +567,6 @@ def _flush_buffer(self):\n     size = 0\n     for x in arrays:\n       for b in x.buffers():\n-        size = size + b.size\n+        if b is not None:\n+          size = size + b.size", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc4ODIwOA=="}, "originalCommit": {"oid": "be41f42ddadf199c3d81d08006cd830d227261c7"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3759, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}