{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNzI3NDE2", "number": 11167, "title": "[BEAM-4374] Define the protos for a \"short\" id mechanism for metrics", "bodyText": "Typical flow:\nRunner requests metrics and SDK responds with metrics data and ids, SDK stores id -> full MonitoringInfo mapping.\nif Runner is missing ids:\n  Runner requests full data given for missing ids and SDK provides full data\n  Runner \"remembers\" id -> full mapping for future process bundle responses\n\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-03-19T00:08:34Z", "url": "https://github.com/apache/beam/pull/11167", "merged": true, "mergeCommit": {"oid": "e9430a0a6ca04041dc52011bf4058cd6a29c3c59"}, "closed": true, "closedAt": "2020-03-20T04:39:43Z", "author": {"login": "lukecwik"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPAhCfAH2gAyMzkwNzI3NDE2OmUwZjJhZjViM2ZlMzg4Y2Q4ZjBlNDNkOTViZGNlMzFhY2QxYmQ4NDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPR5_AAH2gAyMzkwNzI3NDE2OjJiM2UzNWRiNzkwYWQ5N2RlNDZkM2E5ZjIzYTY4MDVhNzJlYzVhZmE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e0f2af5b3fe388cd8f0e43d95bdce31acd1bd846", "author": {"user": {"login": "lukecwik", "name": "Lukasz Cwik"}}, "url": "https://github.com/apache/beam/commit/e0f2af5b3fe388cd8f0e43d95bdce31acd1bd846", "committedDate": "2020-03-19T00:11:02Z", "message": "[BEAM-4374] Define the protos for a \"short\" id mechanism for metrics"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "25fa73e3819d9d9f21543b9a5ba44404e9e08f3b", "author": {"user": {"login": "lukecwik", "name": "Lukasz Cwik"}}, "url": "https://github.com/apache/beam/commit/25fa73e3819d9d9f21543b9a5ba44404e9e08f3b", "committedDate": "2020-03-18T23:41:00Z", "message": "[BEAM-4374] Define the protos for a \"short\" id mechanism for metrics"}, "afterCommit": {"oid": "e0f2af5b3fe388cd8f0e43d95bdce31acd1bd846", "author": {"user": {"login": "lukecwik", "name": "Lukasz Cwik"}}, "url": "https://github.com/apache/beam/commit/e0f2af5b3fe388cd8f0e43d95bdce31acd1bd846", "committedDate": "2020-03-19T00:11:02Z", "message": "[BEAM-4374] Define the protos for a \"short\" id mechanism for metrics"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3OTYyMzk4", "url": "https://github.com/apache/beam/pull/11167#pullrequestreview-377962398", "createdAt": "2020-03-19T17:55:13Z", "commit": {"oid": "e0f2af5b3fe388cd8f0e43d95bdce31acd1bd846"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzo1NToxM1rOF46Cvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzo1NToxM1rOF46Cvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxNTU1MA==", "bodyText": "Maybe call this monitioring_info_id to distinguish this from the many other ids (like instruction id, process bundle id, etc.)", "url": "https://github.com/apache/beam/pull/11167#discussion_r395215550", "createdAt": "2020-03-19T17:55:13Z", "author": {"login": "robertwb"}, "path": "model/fn-execution/src/main/proto/beam_fn_api.proto", "diffHunk": "@@ -277,6 +291,21 @@ message ProcessBundleProgressRequest {\n   string instruction_id = 1;\n }\n \n+// A request to provide full MonitoringInfo for a given bundle.\n+//\n+// An SDK can report metrics using an identifier that only contains the\n+// associated payload. A runner who wants to receive the full metrics\n+// information can request all the monitoring metadata via a\n+// ProcessBundleProgressMetadataRequest providing a list of ids as necessary.\n+//\n+// The SDK is allowed to reuse the identifiers across multiple bundles as long\n+// as the MonitoringInfo could be reconstructed fully by overwriting its\n+// payload field with the bytes specified here.\n+message ProcessBundleProgressMetadataRequest {\n+  // A list of ids for which the full MonitoringInfo is requested for.\n+  repeated string id = 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0f2af5b3fe388cd8f0e43d95bdce31acd1bd846"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b3e35db790ad97de46d3a9f23a6805a72ec5afa", "author": {"user": {"login": "lukecwik", "name": "Lukasz Cwik"}}, "url": "https://github.com/apache/beam/commit/2b3e35db790ad97de46d3a9f23a6805a72ec5afa", "committedDate": "2020-03-19T20:26:40Z", "message": "fixup! Address PR comments."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2842, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}