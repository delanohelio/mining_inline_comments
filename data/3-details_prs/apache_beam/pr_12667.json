{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxODYxNDU2", "number": 12667, "title": "[BEAM-9918] Adding tests and documentation to xlang components", "bodyText": "All xlang components are documented.\nAll primitive Beam transforms are tested to work.\nUnit tests added wherever possible.\n\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-08-21T21:25:11Z", "url": "https://github.com/apache/beam/pull/12667", "merged": true, "mergeCommit": {"oid": "bdb71bc7753f5043ad1195b310315161596a50a1"}, "closed": true, "closedAt": "2020-08-22T01:47:09Z", "author": {"login": "pskevin"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdA-6cRgH2gAyNDcxODYxNDU2OjNiMTEwZjJiZmQwZGQzYjBhNTIwYWJiZThlOWRkM2RjYTA2YjNiMDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdBPWiQgFqTQ3Mjg4NzQ2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3b110f2bfd0dd3b0a520abbe8e9dd3dca06b3b06", "author": {"user": {"login": "pskevin", "name": "Kevin Sijo Puthusseri"}}, "url": "https://github.com/apache/beam/commit/3b110f2bfd0dd3b0a520abbe8e9dd3dca06b3b06", "committedDate": "2020-08-21T06:35:11Z", "message": "[BEAM-9918]: adding primitive transforms xlang tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ada1c59ff1b64c3bbf82248247af9b9c94a06cb6", "author": {"user": {"login": "pskevin", "name": "Kevin Sijo Puthusseri"}}, "url": "https://github.com/apache/beam/commit/ada1c59ff1b64c3bbf82248247af9b9c94a06cb6", "committedDate": "2020-08-21T10:14:44Z", "message": "[BEAM-9918] Adding basic tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28303cc5cee7fd6b5ebd8a9efd0f042d5ebb69d1", "author": {"user": {"login": "pskevin", "name": "Kevin Sijo Puthusseri"}}, "url": "https://github.com/apache/beam/commit/28303cc5cee7fd6b5ebd8a9efd0f042d5ebb69d1", "committedDate": "2020-08-21T21:21:48Z", "message": "[BEAM-9918] adding documentation to all xlang components"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147", "author": {"user": {"login": "pskevin", "name": "Kevin Sijo Puthusseri"}}, "url": "https://github.com/apache/beam/commit/f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147", "committedDate": "2020-08-21T21:22:31Z", "message": "[BEAM-9918]: adding unit tests for xlang components"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyODY3OTQw", "url": "https://github.com/apache/beam/pull/12667#pullrequestreview-472867940", "createdAt": "2020-08-21T23:41:51Z", "commit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQyMzo0MTo1MVrOHFAclA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMlQwMDoxNToxOFrOHFA2QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxMjI0NA==", "bodyText": "Please consolidate these imports into two groups, standard library followed by the github imports.\nSeparating out and commenting on the _ imports however is a good practice.\nThis comnment applies to all these example files.", "url": "https://github.com/apache/beam/pull/12667#discussion_r475012244", "createdAt": "2020-08-21T23:41:51Z", "author": {"login": "lostluck"}, "path": "sdks/go/examples/xlang/group_by/group_by.go", "diffHunk": "@@ -0,0 +1,109 @@\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//    http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+// group_by exemplifies using a cross-language group by key transform from a test expansion service.\n+//\n+// Prerequisites to run wordcount:\n+// \u2013> [Required] Job needs to be submitted to a portable runner (--runner=universal)\n+// \u2013> [Required] Endpoint of job service needs to be passed (--endpoint=<ip:port>)\n+// \u2013> [Required] Endpoint of expansion service needs to be passed (--expansion_addr=<ip:port>)\n+// \u2013> [Optional] Environment type can be LOOPBACK. Defaults to DOCKER. (--environment_type=LOOPBACK|DOCKER)\n+package main\n+\n+import (\n+\t\"fmt\"\n+\t\"reflect\"\n+\t\"sort\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/core/util/reflectx\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/testing/passert\"\n+\n+\t\"context\"\n+\t\"flag\"\n+\t\"log\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/core/typex\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/x/beamx\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxMjM3Ng==", "bodyText": "There's no need to have an extra blank line at the end of init blocks.", "url": "https://github.com/apache/beam/pull/12667#discussion_r475012376", "createdAt": "2020-08-21T23:42:40Z", "author": {"login": "lostluck"}, "path": "sdks/go/examples/xlang/group_by/group_by.go", "diffHunk": "@@ -0,0 +1,109 @@\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//    http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+// group_by exemplifies using a cross-language group by key transform from a test expansion service.\n+//\n+// Prerequisites to run wordcount:\n+// \u2013> [Required] Job needs to be submitted to a portable runner (--runner=universal)\n+// \u2013> [Required] Endpoint of job service needs to be passed (--endpoint=<ip:port>)\n+// \u2013> [Required] Endpoint of expansion service needs to be passed (--expansion_addr=<ip:port>)\n+// \u2013> [Optional] Environment type can be LOOPBACK. Defaults to DOCKER. (--environment_type=LOOPBACK|DOCKER)\n+package main\n+\n+import (\n+\t\"fmt\"\n+\t\"reflect\"\n+\t\"sort\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/core/util/reflectx\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/testing/passert\"\n+\n+\t\"context\"\n+\t\"flag\"\n+\t\"log\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/core/typex\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/x/beamx\"\n+\n+\t// Imports to enable correct filesystem access and runner setup in LOOPBACK mode\n+\t_ \"github.com/apache/beam/sdks/go/pkg/beam/io/filesystem/gcs\"\n+\t_ \"github.com/apache/beam/sdks/go/pkg/beam/io/filesystem/local\"\n+\t_ \"github.com/apache/beam/sdks/go/pkg/beam/runners/universal\"\n+)\n+\n+var (\n+\texpansionAddr = flag.String(\"expansion_addr\", \"\", \"Address of Expansion Service\")\n+)\n+\n+// formatFn is a DoFn that formats a word and its count as a string.\n+func formatFn(w string, c []int) string {\n+\tsort.Ints(c)\n+\treturn fmt.Sprintf(\"%v:%v\", w, c)\n+}\n+\n+// KV used to represent KV PCollection values\n+type KV struct {\n+\tX string\n+\tY int64\n+}\n+\n+func getKV(kv KV, emit func(string, int64)) {\n+\temit(kv.X, kv.Y)\n+}\n+\n+func collectValues(key string, iter func(*int64) bool) (string, []int) {\n+\tvar count int64\n+\tvar values []int\n+\tfor iter(&count) {\n+\t\tvalues = append(values, int(count))\n+\t}\n+\treturn key, values\n+}\n+\n+func init() {\n+\tbeam.RegisterType(reflect.TypeOf((*KV)(nil)).Elem())\n+\tbeam.RegisterFunction(formatFn)\n+\tbeam.RegisterFunction(getKV)\n+\tbeam.RegisterFunction(collectValues)\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxMjQ4Nw==", "bodyText": "There's no need for an empty init block, please remove.", "url": "https://github.com/apache/beam/pull/12667#discussion_r475012487", "createdAt": "2020-08-21T23:43:16Z", "author": {"login": "lostluck"}, "path": "sdks/go/examples/xlang/multi_input_output/multi.go", "diffHunk": "@@ -0,0 +1,79 @@\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//    http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+// multi exemplifies using a cross-language transform with multiple inputs and\n+// outputs from a test expansion service.\n+//\n+// Prerequisites to run wordcount:\n+// \u2013> [Required] Job needs to be submitted to a portable runner (--runner=universal)\n+// \u2013> [Required] Endpoint of job service needs to be passed (--endpoint=<ip:port>)\n+// \u2013> [Required] Endpoint of expansion service needs to be passed (--expansion_addr=<ip:port>)\n+// \u2013> [Optional] Environment type can be LOOPBACK. Defaults to DOCKER. (--environment_type=LOOPBACK|DOCKER)\n+package main\n+\n+import (\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/core/util/reflectx\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/testing/passert\"\n+\n+\t\"context\"\n+\t\"flag\"\n+\t\"log\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/core/typex\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/x/beamx\"\n+\n+\t// Imports to enable correct filesystem access and runner setup in LOOPBACK mode\n+\t_ \"github.com/apache/beam/sdks/go/pkg/beam/io/filesystem/gcs\"\n+\t_ \"github.com/apache/beam/sdks/go/pkg/beam/io/filesystem/local\"\n+\t_ \"github.com/apache/beam/sdks/go/pkg/beam/runners/universal\"\n+)\n+\n+var (\n+\texpansionAddr = flag.String(\"expansion_addr\", \"\", \"Address of Expansion Service\")\n+)\n+\n+func init() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxMzMyNg==", "bodyText": "Just a style comment: In Go New has the implication that it's creating and initializing a single new pointer object. In this case, there's no need for the New prefix, as it doesn't clarify that. While this is creating new Inbound instances and a map, it's doing much more than a single value creation, so I would drop the prefix.\nSimilar for NewNamedOutboundLinks below.", "url": "https://github.com/apache/beam/pull/12667#discussion_r475013326", "createdAt": "2020-08-21T23:47:44Z", "author": {"login": "lostluck"}, "path": "sdks/go/pkg/beam/core/graph/edge.go", "diffHunk": "@@ -303,11 +304,22 @@ func NewCrossLanguage(g *Graph, s *Scope, ext *ExternalTransform, ins []*Inbound\n \treturn edge, isBoundedUpdater\n }\n \n+// NewNamedInboundLinks returns an array of new Inbound links and a map (tag ->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxMzgwMw==", "bodyText": "I'd consider not including the credit in the public documentation to the function. It doesn't help a caller use the DoFn, it's describing an implementation detail.", "url": "https://github.com/apache/beam/pull/12667#discussion_r475013803", "createdAt": "2020-08-21T23:50:15Z", "author": {"login": "lostluck"}, "path": "sdks/go/pkg/beam/core/graph/xlang.go", "diffHunk": "@@ -71,8 +93,10 @@ func (ext ExternalTransform) WithNamedOutputs(outputsMap map[string]int) Externa\n \treturn ext\n }\n \n-// TODO(pskevin): Credit one of the best stackoverflow answers @ https://stackoverflow.com/questions/22892120/how-to-generate-a-random-string-of-a-fixed-length-in-go\n-\n+// NewNamespaceGenerator returns a functions that generates a random string of n alphabets\n+//\n+// Adopted from icza's stackoverflow answer @\n+// https://stackoverflow.com/questions/22892120/how-to-generate-a-random-string-of-a-fixed-length-in-go", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxNjYzNg==", "bodyText": "Please convert this to the expect panic format used in the other tests.", "url": "https://github.com/apache/beam/pull/12667#discussion_r475016636", "createdAt": "2020-08-22T00:06:45Z", "author": {"login": "lostluck"}, "path": "sdks/go/pkg/beam/core/runtime/xlangx/namespace_test.go", "diffHunk": "@@ -0,0 +1,584 @@\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//    http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package xlangx\n+\n+import (\n+\t\"strings\"\n+\t\"testing\"\n+\n+\tpipepb \"github.com/apache/beam/sdks/go/pkg/beam/model/pipeline_v1\"\n+\t\"github.com/google/go-cmp/cmp\"\n+\t\"google.golang.org/protobuf/testing/protocmp\"\n+)\n+\n+func assertPanic(t *testing.T, f func(), err string) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAxODgxNw==", "bodyText": "The naming here is a bit confusing. As a sink, the expectation is 1 input and 0 outputs, rather than 1, with many outputs.  Similarly for the source, we would expect 0 inputs, but get 1 output. rather than many inputs, with 1 output.\nIt's certainly out of scope given the time remaining, given how many place would need to change, but we will probably consider changing these to helper functions which generate the input or output maps with the magic tags, and users always call the top level CrossLanguage call instead.", "url": "https://github.com/apache/beam/pull/12667#discussion_r475018817", "createdAt": "2020-08-22T00:15:18Z", "author": {"login": "lostluck"}, "path": "sdks/go/pkg/beam/xlang.go", "diffHunk": "@@ -21,91 +21,154 @@ import (\n \t\"github.com/apache/beam/sdks/go/pkg/beam/core/graph\"\n \t\"github.com/apache/beam/sdks/go/pkg/beam/core/runtime/graphx\"\n \t\"github.com/apache/beam/sdks/go/pkg/beam/core/runtime/xlangx\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/core/typex\"\n \t\"github.com/apache/beam/sdks/go/pkg/beam/internal/errors\"\n \tjobpb \"github.com/apache/beam/sdks/go/pkg/beam/model/jobmanagement_v1\"\n )\n \n-// This is an experimetnal API and subject to change\n-func CrossLanguage(s Scope, urn string, payload []byte, expansionAddr string, inputs map[string]PCollection, outputTypes map[string]FullType) map[string]PCollection {\n+// xlang exposes an API to execute cross-language transforms within the Go SDK.\n+// It is experimental and likely to change. It exposes convenient wrappers\n+// around the core functions to pass in any combination of named/unnamed\n+// inputs/outputs.\n+\n+// CrossLanguage executes a cross-language transform that uses named inputs and\n+// returns named outputs.\n+func CrossLanguage(\n+\ts Scope,\n+\turn string,\n+\tpayload []byte,\n+\texpansionAddr string,\n+\tnamedInputs map[string]PCollection,\n+\tnamedOutputTypes map[string]FullType,\n+) map[string]PCollection {\n \tif !s.IsValid() {\n \t\tpanic(errors.New(\"invalid scope\"))\n \t}\n \n-\tnamedInputNodes := mapPCollectionToNode(inputs)\n-\n-\tinputsMap, inboundLinks := graph.NewNamedInboundLinks(namedInputNodes)\n-\toutputsMap, outboundLinks := graph.NewNamedOutboundLinks(s.real, outputTypes)\n+\tinputsMap, inboundLinks := graph.NewNamedInboundLinks(mapPCollectionToNode(namedInputs))\n+\toutputsMap, outboundLinks := graph.NewNamedOutboundLinks(s.real, namedOutputTypes)\n \n \text := graph.ExternalTransform{\n \t\tUrn:           urn,\n \t\tPayload:       payload,\n \t\tExpansionAddr: expansionAddr,\n \t}.WithNamedInputs(inputsMap).WithNamedOutputs(outputsMap)\n \n-\toutputNodes, err := TryCrossLanguage(s, &ext, inboundLinks, outboundLinks)\n+\tnamedOutputs, err := TryCrossLanguage(s, &ext, inboundLinks, outboundLinks)\n \tif err != nil {\n \t\tpanic(errors.WithContextf(err, \"tried cross-language and failed\"))\n \t}\n-\treturn mapNodeToPCollection(outputNodes)\n+\treturn mapNodeToPCollection(namedOutputs)\n }\n \n-/*\n-func CrossLanguageWithSink(s Scope, urn string, payload []byte, expansionAddr string, inputs map[string]PCollection, outputType FullType) PCollection {\n-\tinputNodes := mapPCollectionToNode(inputs)\n+// CrossLanguageWithSingleInputOutput executes a cross-language transform that\n+// uses a single unnamed input and returns a single unnamed output.\n+func CrossLanguageWithSingleInputOutput(\n+\ts Scope,\n+\turn string,\n+\tpayload []byte,\n+\texpansionAddr string,\n+\tinput PCollection,\n+\toutputType FullType,\n+) PCollection {\n+\tif !s.IsValid() {\n+\t\tpanic(errors.New(\"invalid scope\"))\n+\t}\n+\n+\t// Adding dummy SourceInputTag to process it as a named input\n+\tnamedInput := mapPCollectionToNode(map[string]PCollection{graph.SourceInputTag: input})\n+\t// Adding dummy SinkOutputTag to process it as a named output\n+\tnamedOutputType := map[string]typex.FullType{graph.SinkOutputTag: outputType}\n \n-\tinputsMap, inboundLinks := graph.NewNamedInboundLinks(inputNodes)\n-\toutputsMap, outboundLinks := graph.NewNamedOutboundLinks(s.real, map[string]typex.FullType{graph.SinkOutputTag: outputType})\n+\tinputsMap, inboundLinks := graph.NewNamedInboundLinks(namedInput)\n+\toutputsMap, outboundLinks := graph.NewNamedOutboundLinks(s.real, namedOutputType)\n \n \text := graph.ExternalTransform{\n \t\tUrn:           urn,\n \t\tPayload:       payload,\n \t\tExpansionAddr: expansionAddr,\n-\t}.WithNamedInputs(inputNodes).WithNamedOutputs(outputTypes)\n+\t}.WithNamedInputs(inputsMap).WithNamedOutputs(outputsMap)\n \n-\toutputNodes, err := TryCrossLanguage(s, &ext, inboundLinks, outboundLinks)\n+\tnamedOutput, err := TryCrossLanguage(s, &ext, inboundLinks, outboundLinks)\n \tif err != nil {\n \t\tpanic(errors.WithContextf(err, \"tried cross-language and failed\"))\n \t}\n-\tnamedOutputNode := mapNodeToPCollection(outputNodes)\n+\treturn nodeToPCollection(namedOutput[graph.SinkOutputTag])\n+}\n \n-\toutputNode, exists := namedOutputNode[graph.SinkOutputTag]\n-\tif !exists {\n-\t\tpanic(\"a\")\n+// CrossLanguageWithSink executes a cross-language transform that uses named\n+// inputs and returns a single unnamed output.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0928e3f71ca7b3bee4024a8ccf9a2e932e7e147"}, "originalPosition": 126}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "845d645f75eda2dc1880f48190216fbc270b9ac7", "author": {"user": {"login": "pskevin", "name": "Kevin Sijo Puthusseri"}}, "url": "https://github.com/apache/beam/commit/845d645f75eda2dc1880f48190216fbc270b9ac7", "committedDate": "2020-08-22T01:08:40Z", "message": "fix(beam/sdks/go): formatting imports and cleaning up"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyODg3NDYz", "url": "https://github.com/apache/beam/pull/12667#pullrequestreview-472887463", "createdAt": "2020-08-22T01:44:21Z", "commit": {"oid": "845d645f75eda2dc1880f48190216fbc270b9ac7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4879, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}