{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MDAwODI0", "number": 11731, "title": "[BEAM-10018] Fix timestamps in two windowing Python katas", "bodyText": "The two Python katas about windowing fail because the timestamps for the elements are calculated based on the local timezone, and my timezone does not match the timezone hardcoded in the tests, and because parsing from strings using fromisoformat was failing.\nIn the first Kata, the timestamp was calculated from time objects, and converted to a timestamp in the local timezone. Thus, the results of the test depended on the configuration of the local timezone in the running system.\nThe tests were hardcoded with a timezone different to mine, and thus I always failed to pass this Kata. The changes in this commit change the type in Event to be a datetime, the timestamps are set in UTC, and the output in the tests is hardcoded in UTC too. This should ensure that the kata works regardless the timezone configured in the system running the kata.\nIn the second Kata, the code was failing with the following error:\nAttributeError: type object 'datetime.datetime' has no attribute 'fromisoformat'\nI changed the timestamps to be set using the datetime constructor, rather than parsing from strings using fromisoformat.\nBoth katas now pass with the examples hardcoded in the corresponding tests.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-05-16T17:49:24Z", "url": "https://github.com/apache/beam/pull/11731", "merged": true, "mergeCommit": {"oid": "1f21a4ce9d983ff95193a0fed81d99ce5f6dddfc"}, "closed": true, "closedAt": "2020-05-18T19:09:20Z", "author": {"login": "iht"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABch6BuvAH2gAyNDE5MDAwODI0OmZjNWM5ODE4N2VjYzIwZTI2NmFiMWE3MThjNWY0YTgwZDYyMjc5OWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABciW-ZDAFqTQxMzI0NjEwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fc5c98187ecc20e266ab1a718c5f4a80d622799c", "author": {"user": {"login": "iht", "name": "Israel Herraiz"}}, "url": "https://github.com/apache/beam/commit/fc5c98187ecc20e266ab1a718c5f4a80d622799c", "committedDate": "2020-05-16T17:21:58Z", "message": "[BEAM-10018] Fix timestamps in windowing kata\n\nIn this Kata, the timestamp was calculated from time objects, and converted to a\ntimestamp in the local timezone. Thus, the results of the test depended on the\nconfiguration of the local timezone in the running system.\n\nThe tests were hardcoded with a timezone different to mine, and thus I always\nfailed to pass this Kata. The changes in this commit change the type in Event to\nbe a datetime, the timestamps are set in UTC, and the output in the tests is\nhardcoded in UTC too. This should ensure that the kata works regardless the\ntimezone configured in the system running the kata."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db5004cfc8dc407f32d57f49ab7aa6ac6d3771ad", "author": {"user": {"login": "iht", "name": "Israel Herraiz"}}, "url": "https://github.com/apache/beam/commit/db5004cfc8dc407f32d57f49ab7aa6ac6d3771ad", "committedDate": "2020-05-16T17:43:02Z", "message": "[BEAM-10018] Kata failing due to failed parsing\n\nParsing the timestamps as strings using fromisoformat was failing, and the Kata\nfailed silently regardless the code written in the boxes.\n\nThis change sets the same timestamps, with UTC timezone, without parsing\nstrings."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMTMxODA4", "url": "https://github.com/apache/beam/pull/11731#pullrequestreview-413131808", "createdAt": "2020-05-17T06:39:50Z", "commit": {"oid": "db5004cfc8dc407f32d57f49ab7aa6ac6d3771ad"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwNjozOTo1MFrOGWep2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwNjo1MzoxOVrOGWeuBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIyNDA5MA==", "bodyText": "We need to fix the answer placeholders.", "url": "https://github.com/apache/beam/pull/11731#discussion_r426224090", "createdAt": "2020-05-17T06:39:50Z", "author": {"login": "henryken"}, "path": "learning/katas/python/Windowing/Adding Timestamp/ParDo/task-info.yaml", "diffHunk": "@@ -22,10 +22,10 @@ files:\n - name: task.py\n   visible: true\n   placeholders:\n-  - offset: 1211\n-    length: 163\n+  - offset: 1243", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db5004cfc8dc407f32d57f49ab7aa6ac6d3771ad"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIyNDE1MQ==", "bodyText": "Remove unused import", "url": "https://github.com/apache/beam/pull/11731#discussion_r426224151", "createdAt": "2020-05-17T06:40:26Z", "author": {"login": "henryken"}, "path": "learning/katas/python/Windowing/Adding Timestamp/ParDo/task.py", "diffHunk": "@@ -16,6 +16,7 @@\n \n import datetime\n import time", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db5004cfc8dc407f32d57f49ab7aa6ac6d3771ad"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIyNTA2OA==", "bodyText": "Need to change the task.html description\nPlease assign each element a timestamp based on the the <code>Event.timestamp</code>", "url": "https://github.com/apache/beam/pull/11731#discussion_r426225068", "createdAt": "2020-05-17T06:52:29Z", "author": {"login": "henryken"}, "path": "learning/katas/python/Windowing/Adding Timestamp/ParDo/task.py", "diffHunk": "@@ -24,30 +25,30 @@\n \n \n class Event:\n-    def __init__(self, id, event, date):\n+    def __init__(self, id, event, timestamp):\n         self.id = id\n         self.event = event\n-        self.date = date\n+        self.timestamp = timestamp", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db5004cfc8dc407f32d57f49ab7aa6ac6d3771ad"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIyNTE1Ng==", "bodyText": "Need to fix the answer placeholder", "url": "https://github.com/apache/beam/pull/11731#discussion_r426225156", "createdAt": "2020-05-17T06:53:19Z", "author": {"login": "henryken"}, "path": "learning/katas/python/Windowing/Fixed Time Window/Fixed Time Window/task-info.yaml", "diffHunk": "@@ -22,7 +22,7 @@ files:\n - name: task.py\n   visible: true\n   placeholders:\n-  - offset: 2074\n+  - offset: 2067", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db5004cfc8dc407f32d57f49ab7aa6ac6d3771ad"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f21435286a010fe2752e8b569c106660b2c1ef41", "author": {"user": {"login": "iht", "name": "Israel Herraiz"}}, "url": "https://github.com/apache/beam/commit/f21435286a010fe2752e8b569c106660b2c1ef41", "committedDate": "2020-05-17T08:42:37Z", "message": "Remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b18ea2a5ca3f7fb90f8786ab5c0ab4ecc9fbf2f0", "author": {"user": {"login": "iht", "name": "Israel Herraiz"}}, "url": "https://github.com/apache/beam/commit/b18ea2a5ca3f7fb90f8786ab5c0ab4ecc9fbf2f0", "committedDate": "2020-05-17T08:43:02Z", "message": "Add missing dependency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80bc61376a44ce55bf0a5ead6473ccf6c3692046", "author": {"user": {"login": "iht", "name": "Israel Herraiz"}}, "url": "https://github.com/apache/beam/commit/80bc61376a44ce55bf0a5ead6473ccf6c3692046", "committedDate": "2020-05-17T08:43:36Z", "message": "Fix member variable name in Kata documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45a0b85941213eb8a58c18e84aeb558c1e971e4e", "author": {"user": {"login": "iht", "name": "Israel Herraiz"}}, "url": "https://github.com/apache/beam/commit/45a0b85941213eb8a58c18e84aeb558c1e971e4e", "committedDate": "2020-05-17T08:47:17Z", "message": "Fix placeholder location"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMjQ2MTAz", "url": "https://github.com/apache/beam/pull/11731#pullrequestreview-413246103", "createdAt": "2020-05-18T03:05:34Z", "commit": {"oid": "45a0b85941213eb8a58c18e84aeb558c1e971e4e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4619, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}