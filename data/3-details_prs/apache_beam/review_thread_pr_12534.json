{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2MzE1ODkz", "number": 12534, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxOTo0NjozMVrOEYNavA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxOTo0OTo0OVrOEYNeww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzODIxMTE2OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/dataframe/frames.py", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxOTo0NjozMVrOHAbGFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQwMDowNDoxNVrOHAhoIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNTk3NQ==", "bodyText": "Only tangentially related to this PR, but I realized the docstring for ComputedExpression is slightly incorrect: \n  \n    \n      beam/sdks/python/apache_beam/dataframe/expressions.py\n    \n    \n         Line 202\n      in\n      a098130\n    \n    \n    \n    \n\n        \n          \n                 requires_partition_by_index: Whether this expression requires its", "url": "https://github.com/apache/beam/pull/12534#discussion_r470205975", "createdAt": "2020-08-13T19:46:31Z", "author": {"login": "ibzib"}, "path": "sdks/python/apache_beam/dataframe/frames.py", "diffHunk": "@@ -29,9 +29,46 @@ def __array__(self, dtype=None):\n     raise frame_base.WontImplementError(\n         'Conversion to a non-deferred a numpy array.')\n \n+  astype = frame_base._elementwise_method('astype')\n+\n+  between = frame_base._elementwise_method('between')\n+\n+  @frame_base.args_to_kwargs(pd.Series)\n+  @frame_base.populate_defaults(pd.Series)\n+  @frame_base.maybe_inplace\n+  def dropna(self, **kwargs):\n+    return frame_base.DeferredFrame.wrap(\n+        expressions.ComputedExpression(\n+            'dropna',\n+            lambda df: df.dropna(**kwargs), [self._expr],\n+            preserves_partition_by=partitionings.Singleton(),\n+            requires_partition_by=partitionings.Nothing()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0dc9be295bb472e224c870cf5fedb62e60d8400"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMxMTgyNA==", "bodyText": "Ah, yeah, that wasn't updated when the arguments chagned. Fixed.", "url": "https://github.com/apache/beam/pull/12534#discussion_r470311824", "createdAt": "2020-08-13T23:59:46Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/dataframe/frames.py", "diffHunk": "@@ -29,9 +29,46 @@ def __array__(self, dtype=None):\n     raise frame_base.WontImplementError(\n         'Conversion to a non-deferred a numpy array.')\n \n+  astype = frame_base._elementwise_method('astype')\n+\n+  between = frame_base._elementwise_method('between')\n+\n+  @frame_base.args_to_kwargs(pd.Series)\n+  @frame_base.populate_defaults(pd.Series)\n+  @frame_base.maybe_inplace\n+  def dropna(self, **kwargs):\n+    return frame_base.DeferredFrame.wrap(\n+        expressions.ComputedExpression(\n+            'dropna',\n+            lambda df: df.dropna(**kwargs), [self._expr],\n+            preserves_partition_by=partitionings.Singleton(),\n+            requires_partition_by=partitionings.Nothing()))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNTk3NQ=="}, "originalCommit": {"oid": "b0dc9be295bb472e224c870cf5fedb62e60d8400"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMxMjk5NA==", "bodyText": "Thanks!", "url": "https://github.com/apache/beam/pull/12534#discussion_r470312994", "createdAt": "2020-08-14T00:04:15Z", "author": {"login": "ibzib"}, "path": "sdks/python/apache_beam/dataframe/frames.py", "diffHunk": "@@ -29,9 +29,46 @@ def __array__(self, dtype=None):\n     raise frame_base.WontImplementError(\n         'Conversion to a non-deferred a numpy array.')\n \n+  astype = frame_base._elementwise_method('astype')\n+\n+  between = frame_base._elementwise_method('between')\n+\n+  @frame_base.args_to_kwargs(pd.Series)\n+  @frame_base.populate_defaults(pd.Series)\n+  @frame_base.maybe_inplace\n+  def dropna(self, **kwargs):\n+    return frame_base.DeferredFrame.wrap(\n+        expressions.ComputedExpression(\n+            'dropna',\n+            lambda df: df.dropna(**kwargs), [self._expr],\n+            preserves_partition_by=partitionings.Singleton(),\n+            requires_partition_by=partitionings.Nothing()))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNTk3NQ=="}, "originalCommit": {"oid": "b0dc9be295bb472e224c870cf5fedb62e60d8400"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzODIyMTQ3OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/dataframe/pandas_doctests_test.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxOTo0OTo0OVrOHAbMbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQwMDowMTowMFrOHAhk_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNzU5OQ==", "bodyText": "What is \"doctest issue\" referring to? Is it worth filing a JIRA?", "url": "https://github.com/apache/beam/pull/12534#discussion_r470207599", "createdAt": "2020-08-13T19:49:49Z", "author": {"login": "ibzib"}, "path": "sdks/python/apache_beam/dataframe/pandas_doctests_test.py", "diffHunk": "@@ -156,19 +157,14 @@ def test_series_tests(self):\n             'pandas.core.series.Series.repeat': ['*'],\n             'pandas.core.series.Series.replace': ['*'],\n             'pandas.core.series.Series.reset_index': ['*'],\n-            'pandas.core.series.Series.round': ['*'],\n-            'pandas.core.series.Series.searchsorted': ['*'],\n-            'pandas.core.series.Series.shift': ['*'],\n+            'pandas.core.series.Series.searchsorted': ['*'],  # doctest issue", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0dc9be295bb472e224c870cf5fedb62e60d8400"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMxMjE4OA==", "bodyText": "I haven't dug into this too much, but it seems to be an issue in the underlying doctest parsing code. I've narrowed it down and added a better comment.", "url": "https://github.com/apache/beam/pull/12534#discussion_r470312188", "createdAt": "2020-08-14T00:01:00Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/dataframe/pandas_doctests_test.py", "diffHunk": "@@ -156,19 +157,14 @@ def test_series_tests(self):\n             'pandas.core.series.Series.repeat': ['*'],\n             'pandas.core.series.Series.replace': ['*'],\n             'pandas.core.series.Series.reset_index': ['*'],\n-            'pandas.core.series.Series.round': ['*'],\n-            'pandas.core.series.Series.searchsorted': ['*'],\n-            'pandas.core.series.Series.shift': ['*'],\n+            'pandas.core.series.Series.searchsorted': ['*'],  # doctest issue", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNzU5OQ=="}, "originalCommit": {"oid": "b0dc9be295bb472e224c870cf5fedb62e60d8400"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 638, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}