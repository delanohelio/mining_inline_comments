{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MTM5Njc1", "number": 13004, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMToxODo0M1rOEp85WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODozNjowN1rOEqb4Ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNDI0NzkyOnYy", "diffSide": "LEFT", "path": "sdks/python/apache_beam/transforms/combiners.py", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMToxODo0M1rOHb74jA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTo0NjoxNFrOHcrSqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1NDczMg==", "bodyText": "upgrading to the latest mypy lets us drop these", "url": "https://github.com/apache/beam/pull/13004#discussion_r499054732", "createdAt": "2020-10-02T21:18:43Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/combiners.py", "diffHunk": "@@ -968,13 +968,13 @@ def expand(self, pcoll):\n         return (\n             pcoll\n             | core.ParDo(self.add_timestamp).with_output_types(\n-                Tuple[T, TimestampType])  # type: ignore[misc]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dba4827d1ceb7034a2f778f5586513a36dc1b7d1"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4NzAyMA==", "bodyText": "Nice? Does it cause any other issues?", "url": "https://github.com/apache/beam/pull/13004#discussion_r499787020", "createdAt": "2020-10-05T18:21:24Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/combiners.py", "diffHunk": "@@ -968,13 +968,13 @@ def expand(self, pcoll):\n         return (\n             pcoll\n             | core.ParDo(self.add_timestamp).with_output_types(\n-                Tuple[T, TimestampType])  # type: ignore[misc]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1NDczMg=="}, "originalCommit": {"oid": "dba4827d1ceb7034a2f778f5586513a36dc1b7d1"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgzMTQ2NA==", "bodyText": "No, I was pretty surprised.", "url": "https://github.com/apache/beam/pull/13004#discussion_r499831464", "createdAt": "2020-10-05T19:46:14Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/combiners.py", "diffHunk": "@@ -968,13 +968,13 @@ def expand(self, pcoll):\n         return (\n             pcoll\n             | core.ParDo(self.add_timestamp).with_output_types(\n-                Tuple[T, TimestampType])  # type: ignore[misc]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1NDczMg=="}, "originalCommit": {"oid": "dba4827d1ceb7034a2f778f5586513a36dc1b7d1"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNDI1MDA1OnYy", "diffSide": "LEFT", "path": "sdks/python/apache_beam/transforms/combiners_test.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMToxOTo0NVrOHb756A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMToxOTo0NVrOHb756A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1NTA4MA==", "bodyText": "I split these into two tests to avoid overwriting the same variable with different types, and it seemed better to test smaller units, regardless", "url": "https://github.com/apache/beam/pull/13004#discussion_r499055080", "createdAt": "2020-10-02T21:19:45Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/combiners_test.py", "diffHunk": "@@ -416,7 +416,7 @@ def test_tuple_combine_fn_without_defaults(self):\n                   max).with_common_input()).without_defaults())\n       assert_that(result, equal_to([(1, 7.0 / 4, 3)]))\n \n-  def test_to_list_and_to_dict(self):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dba4827d1ceb7034a2f778f5586513a36dc1b7d1"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNDI1OTMwOnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/transforms/userstate.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMToyMzo1NFrOHb7_jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODozMTowMlrOHco5OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1NjUyNQ==", "bodyText": "I added a base class so that I could have a return type for UserStateContext.get_timer().  Also see bundle_processor. OutputTimer (at the top of the PR).\nAn alternative to this would be to create a Protocol, but that seemed needlessly complex.", "url": "https://github.com/apache/beam/pull/13004#discussion_r499056525", "createdAt": "2020-10-02T21:23:54Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/userstate.py", "diffHunk": "@@ -305,23 +323,37 @@ def validate_stateful_dofn(dofn):\n                        (timer_spec, method_name, dofn))\n \n \n-class RuntimeTimer(object):\n+class BaseTimer(object):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dba4827d1ceb7034a2f778f5586513a36dc1b7d1"}, "originalPosition": 152}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5MjE4NQ==", "bodyText": "This is good.", "url": "https://github.com/apache/beam/pull/13004#discussion_r499792185", "createdAt": "2020-10-05T18:31:02Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/userstate.py", "diffHunk": "@@ -305,23 +323,37 @@ def validate_stateful_dofn(dofn):\n                        (timer_spec, method_name, dofn))\n \n \n-class RuntimeTimer(object):\n+class BaseTimer(object):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA1NjUyNQ=="}, "originalCommit": {"oid": "dba4827d1ceb7034a2f778f5586513a36dc1b7d1"}, "originalPosition": 152}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTI4MjM1OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/transforms/core.py", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODoyMzowM1rOHcoooA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNjo1OTowMlrOHiRYUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4NzkzNg==", "bodyText": "Is there any advantage to (untyped) typing.Callable?", "url": "https://github.com/apache/beam/pull/13004#discussion_r499787936", "createdAt": "2020-10-05T18:23:03Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/core.py", "diffHunk": "@@ -2394,8 +2399,8 @@ class GroupBy(PTransform):\n   \"\"\"\n   def __init__(\n       self,\n-      *fields,  # type: typing.Union[str, callable]\n-      **kwargs  # type: typing.Union[str, callable]\n+      *fields,  # type: typing.Union[str, typing.Callable]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgzMjA4MA==", "bodyText": "mypy does not accept callable: Function \"builtins.callable\" is not valid as a type", "url": "https://github.com/apache/beam/pull/13004#discussion_r499832080", "createdAt": "2020-10-05T19:47:30Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/core.py", "diffHunk": "@@ -2394,8 +2399,8 @@ class GroupBy(PTransform):\n   \"\"\"\n   def __init__(\n       self,\n-      *fields,  # type: typing.Union[str, callable]\n-      **kwargs  # type: typing.Union[str, callable]\n+      *fields,  # type: typing.Union[str, typing.Callable]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4NzkzNg=="}, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTY5ODM4NQ==", "bodyText": "Oh, yes, of course. callable is a function returning whether its argument is callable.", "url": "https://github.com/apache/beam/pull/13004#discussion_r505698385", "createdAt": "2020-10-15T16:59:02Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/core.py", "diffHunk": "@@ -2394,8 +2399,8 @@ class GroupBy(PTransform):\n   \"\"\"\n   def __init__(\n       self,\n-      *fields,  # type: typing.Union[str, callable]\n-      **kwargs  # type: typing.Union[str, callable]\n+      *fields,  # type: typing.Union[str, typing.Callable]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4NzkzNg=="}, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTI4NjQxOnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/transforms/core.py", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODoyNDoyOVrOHcoraQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMjo1NToxMlrOHcwaSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4ODY0OQ==", "bodyText": "Is it possible to suppress the warning rather than take this branch at runtime-only (which feels odd)?", "url": "https://github.com/apache/beam/pull/13004#discussion_r499788649", "createdAt": "2020-10-05T18:24:29Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/core.py", "diffHunk": "@@ -2465,22 +2470,28 @@ def expand(self, pcoll):\n     return pcoll | Map(lambda x: (self._key_func()(x), x)) | GroupByKey()\n \n \n-_dynamic_named_tuple_cache = {}\n+_dynamic_named_tuple_cache = {\n+}  # type: typing.Dict[typing.Tuple[str, typing.Tuple[str, ...]], typing.Type[tuple]]\n \n \n def _dynamic_named_tuple(type_name, field_names):\n+  # type: (str, typing.Tuple[str, ...]) -> typing.Type[tuple]\n   cache_key = (type_name, field_names)\n   result = _dynamic_named_tuple_cache.get(cache_key)\n   if result is None:\n     import collections\n     result = _dynamic_named_tuple_cache[cache_key] = collections.namedtuple(\n         type_name, field_names)\n-    result.__reduce__ = lambda self: (\n-        _unpickle_dynamic_named_tuple, (type_name, field_names, tuple(self)))\n+    if not typing.TYPE_CHECKING:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgzMjU5Mg==", "bodyText": "Sure, I'll make that change.", "url": "https://github.com/apache/beam/pull/13004#discussion_r499832592", "createdAt": "2020-10-05T19:48:22Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/core.py", "diffHunk": "@@ -2465,22 +2470,28 @@ def expand(self, pcoll):\n     return pcoll | Map(lambda x: (self._key_func()(x), x)) | GroupByKey()\n \n \n-_dynamic_named_tuple_cache = {}\n+_dynamic_named_tuple_cache = {\n+}  # type: typing.Dict[typing.Tuple[str, typing.Tuple[str, ...]], typing.Type[tuple]]\n \n \n def _dynamic_named_tuple(type_name, field_names):\n+  # type: (str, typing.Tuple[str, ...]) -> typing.Type[tuple]\n   cache_key = (type_name, field_names)\n   result = _dynamic_named_tuple_cache.get(cache_key)\n   if result is None:\n     import collections\n     result = _dynamic_named_tuple_cache[cache_key] = collections.namedtuple(\n         type_name, field_names)\n-    result.__reduce__ = lambda self: (\n-        _unpickle_dynamic_named_tuple, (type_name, field_names, tuple(self)))\n+    if not typing.TYPE_CHECKING:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4ODY0OQ=="}, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxNTMzNw==", "bodyText": "Done", "url": "https://github.com/apache/beam/pull/13004#discussion_r499915337", "createdAt": "2020-10-05T22:55:12Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/core.py", "diffHunk": "@@ -2465,22 +2470,28 @@ def expand(self, pcoll):\n     return pcoll | Map(lambda x: (self._key_func()(x), x)) | GroupByKey()\n \n \n-_dynamic_named_tuple_cache = {}\n+_dynamic_named_tuple_cache = {\n+}  # type: typing.Dict[typing.Tuple[str, typing.Tuple[str, ...]], typing.Type[tuple]]\n \n \n def _dynamic_named_tuple(type_name, field_names):\n+  # type: (str, typing.Tuple[str, ...]) -> typing.Type[tuple]\n   cache_key = (type_name, field_names)\n   result = _dynamic_named_tuple_cache.get(cache_key)\n   if result is None:\n     import collections\n     result = _dynamic_named_tuple_cache[cache_key] = collections.namedtuple(\n         type_name, field_names)\n-    result.__reduce__ = lambda self: (\n-        _unpickle_dynamic_named_tuple, (type_name, field_names, tuple(self)))\n+    if not typing.TYPE_CHECKING:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4ODY0OQ=="}, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 93}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTI5MjA3OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/transforms/environments.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODoyNjoxMlrOHcovIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODoyNjoxMlrOHcovIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4OTYwMg==", "bodyText": "It'll be good to actually start enforcing these type checks so they don't go out of date...", "url": "https://github.com/apache/beam/pull/13004#discussion_r499789602", "createdAt": "2020-10-05T18:26:12Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/environments.py", "diffHunk": "@@ -52,7 +55,7 @@\n from apache_beam.utils import proto_utils\n \n if TYPE_CHECKING:\n-  from apache_beam.options.pipeline_options import PortablePipelineOptions\n+  from apache_beam.options.pipeline_options import PortableOptions", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTMwMDI2OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/transforms/stats.py", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODoyODo0NVrOHco0Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxOTowMjo1NlrOHeBhIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5MDkxNA==", "bodyText": "T?", "url": "https://github.com/apache/beam/pull/13004#discussion_r499790914", "createdAt": "2020-10-05T18:28:45Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/stats.py", "diffHunk": "@@ -426,14 +432,15 @@ def __next__(self):\n     return QuantileBufferIterator(self.elements, self.weighted, self.weight)\n \n \n-class _QuantileState(object):\n+class _QuantileState(Generic[T]):\n   \"\"\"\n   Compact summarization of a collection on which quantiles can be estimated.\n   \"\"\"\n-  min_val = None  # Holds smallest item in the list\n-  max_val = None  # Holds largest item in the list\n+  min_val = None  # type: Any  # Holds smallest item in the list", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkwNzIwOQ==", "bodyText": "Short answer: true.\nLong answer:  everywhere that I've typed this as T is actually Union[Tuple[T, float], T].  I just tried fully typing this module and it's a quagmire, because this module has several classes that vary their types based on an attribute (weighted).  Furthermore, we can't distinguish between the types using isinstance (because it's always a list, it's just the element type that varies).  So typing this properly either involves lots of typing.cast or breaking these classes into weighted and non-weighted subclasses.  I'd like to defer this until later.", "url": "https://github.com/apache/beam/pull/13004#discussion_r499907209", "createdAt": "2020-10-05T22:30:11Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/stats.py", "diffHunk": "@@ -426,14 +432,15 @@ def __next__(self):\n     return QuantileBufferIterator(self.elements, self.weighted, self.weight)\n \n \n-class _QuantileState(object):\n+class _QuantileState(Generic[T]):\n   \"\"\"\n   Compact summarization of a collection on which quantiles can be estimated.\n   \"\"\"\n-  min_val = None  # Holds smallest item in the list\n-  max_val = None  # Holds largest item in the list\n+  min_val = None  # type: Any  # Holds smallest item in the list", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5MDkxNA=="}, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI0NDE5NA==", "bodyText": "Ack, thanks for the explanation.", "url": "https://github.com/apache/beam/pull/13004#discussion_r501244194", "createdAt": "2020-10-07T19:02:56Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/stats.py", "diffHunk": "@@ -426,14 +432,15 @@ def __next__(self):\n     return QuantileBufferIterator(self.elements, self.weighted, self.weight)\n \n \n-class _QuantileState(object):\n+class _QuantileState(Generic[T]):\n   \"\"\"\n   Compact summarization of a collection on which quantiles can be estimated.\n   \"\"\"\n-  min_val = None  # Holds smallest item in the list\n-  max_val = None  # Holds largest item in the list\n+  min_val = None  # type: Any  # Holds smallest item in the list", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5MDkxNA=="}, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTMxMjMxOnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/transforms/window.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODozMjozMFrOHco7_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMDoxNToxOVrOHcsM9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5Mjg5Mw==", "bodyText": "This should be a Coder[BoundedWindow].  We could even make WindowFn parameterized by the window type, and restrict this further.", "url": "https://github.com/apache/beam/pull/13004#discussion_r499792893", "createdAt": "2020-10-05T18:32:30Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/window.py", "diffHunk": "@@ -164,14 +168,19 @@ def merge(self, merge_context):\n     raise NotImplementedError\n \n   def is_merging(self):\n+    # type: () -> bool\n+\n     \"\"\"Returns whether this WindowFn merges windows.\"\"\"\n     return True\n \n   @abc.abstractmethod\n   def get_window_coder(self):\n+    # type: () -> coders.Coder", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg0NjM4OA==", "bodyText": "coder.Coder is not yet Generic, so we can't do that just yet, though we can do this in a future PR.  So this should not be one of the *WindowCoder types?", "url": "https://github.com/apache/beam/pull/13004#discussion_r499846388", "createdAt": "2020-10-05T20:15:19Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/window.py", "diffHunk": "@@ -164,14 +168,19 @@ def merge(self, merge_context):\n     raise NotImplementedError\n \n   def is_merging(self):\n+    # type: () -> bool\n+\n     \"\"\"Returns whether this WindowFn merges windows.\"\"\"\n     return True\n \n   @abc.abstractmethod\n   def get_window_coder(self):\n+    # type: () -> coders.Coder", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5Mjg5Mw=="}, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyOTMyMzg2OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/transforms/util.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxODozNjowN1rOHcpDPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQyMjoyMzoxN1rOHcvw3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5NDc0OA==", "bodyText": "PythonFormatter needs another pass here.", "url": "https://github.com/apache/beam/pull/13004#discussion_r499794748", "createdAt": "2020-10-05T18:36:07Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/util.py", "diffHunk": "@@ -709,10 +710,10 @@ def expand(self, pcoll):\n     return (\n         pcoll\n         | 'AddRandomKeys' >> Map(lambda t: (random.getrandbits(32), t)).\n-        with_input_types(T).with_output_types(KeyedT)  # type: ignore[misc]\n+        with_input_types(T).with_output_types(KeyedT)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkwNDczNQ==", "bodyText": "fixed", "url": "https://github.com/apache/beam/pull/13004#discussion_r499904735", "createdAt": "2020-10-05T22:23:17Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/transforms/util.py", "diffHunk": "@@ -709,10 +710,10 @@ def expand(self, pcoll):\n     return (\n         pcoll\n         | 'AddRandomKeys' >> Map(lambda t: (random.getrandbits(32), t)).\n-        with_input_types(T).with_output_types(KeyedT)  # type: ignore[misc]\n+        with_input_types(T).with_output_types(KeyedT)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5NDc0OA=="}, "originalCommit": {"oid": "36724f74b7dd6157d3fdee7093cb2ef7d1c5388d"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3107, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}