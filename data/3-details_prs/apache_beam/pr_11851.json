{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0NjY1NzM2", "number": 11851, "title": "[BEAM-10144] Update PipelineOptions snippets for best practices", "bodyText": "Updating PipelineOptions snippets to mirror best practices. Making setting pipeline options programmatically less cumbersome, and adding the necessary imports to each snippet.\nR: @aaltay\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-05-28T18:44:21Z", "url": "https://github.com/apache/beam/pull/11851", "merged": true, "mergeCommit": {"oid": "f2f91f0dbe745103f9e9a2de1faf9b110b05c742"}, "closed": true, "closedAt": "2020-06-10T01:08:11Z", "author": {"login": "davidcavazos"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclycB8gBqjMzODQxNjE3NDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcpozuwgH2gAyNDI0NjY1NzM2OmZjMWU1N2Y2ODFlZjY5ZDEyY2MyYWI3OGNhNDU0ZmM2ODJkNWRmZjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e45282c7ca1121174d1e9f88f5e6b4ee31ada033", "author": {"user": {"login": "davidcavazos", "name": "David Cavazos"}}, "url": "https://github.com/apache/beam/commit/e45282c7ca1121174d1e9f88f5e6b4ee31ada033", "committedDate": "2020-05-28T18:42:11Z", "message": "[BEAM-10144] Update PipelineOptions snippets for best practices"}, "afterCommit": {"oid": "58427194c5832a9a0ed3e5e378b6bc483fdbd97f", "author": {"user": {"login": "davidcavazos", "name": "David Cavazos"}}, "url": "https://github.com/apache/beam/commit/58427194c5832a9a0ed3e5e378b6bc483fdbd97f", "committedDate": "2020-05-28T18:46:53Z", "message": "[BEAM-10144] Update PipelineOptions snippets for best practices"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87df7a41ae2d751d66b9d87476408902e073f441", "author": {"user": {"login": "davidcavazos", "name": "David Cavazos"}}, "url": "https://github.com/apache/beam/commit/87df7a41ae2d751d66b9d87476408902e073f441", "committedDate": "2020-05-28T18:47:46Z", "message": "[BEAM-10144] Update PipelineOptions snippets for best practices"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "58427194c5832a9a0ed3e5e378b6bc483fdbd97f", "author": {"user": {"login": "davidcavazos", "name": "David Cavazos"}}, "url": "https://github.com/apache/beam/commit/58427194c5832a9a0ed3e5e378b6bc483fdbd97f", "committedDate": "2020-05-28T18:46:53Z", "message": "[BEAM-10144] Update PipelineOptions snippets for best practices"}, "afterCommit": {"oid": "87df7a41ae2d751d66b9d87476408902e073f441", "author": {"user": {"login": "davidcavazos", "name": "David Cavazos"}}, "url": "https://github.com/apache/beam/commit/87df7a41ae2d751d66b9d87476408902e073f441", "committedDate": "2020-05-28T18:47:46Z", "message": "[BEAM-10144] Update PipelineOptions snippets for best practices"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMzk2MDY4", "url": "https://github.com/apache/beam/pull/11851#pullrequestreview-420396068", "createdAt": "2020-05-28T18:50:54Z", "commit": {"oid": "58427194c5832a9a0ed3e5e378b6bc483fdbd97f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxODo1MTozMFrOGcCOFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxODo1MTozMFrOGcCOFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA0OTY4NQ==", "bodyText": "Note: This is commented out because if we leave it uncommented, even if it doesn't do anything, it makes the test fail with an error. But I still wanted it here for reference.\nsubprocess.CalledProcessError: Command '['/Users/dcavazos/src/beam/env/bin/python', '-m', 'pip', 'download', '--dest', '/var/folders/z2/zp_k4l5n2cq84fsn4y633mg400dsyy/T/tmpdv09ddqk', 'apache-beam==2.22.0.dev0', '--no-deps', '--no-binary', ':all:']' returned non-zero exit status 1.\n\nPip install failed for package: apache-beam==2.22.0.dev0           \nOutput from execution of subprocess: b''\n\nERROR: Could not find a version that satisfies the requirement apache-beam==2.22.0.dev0 (from versions: 0.6.0, 2.0.0, 2.1.0, 2.1.1, 2.2.0, 2.11.0, 2.12.0, 2.13.0, 2.14.0, 2.15.0, 2.16.0, 2.17.0, 2.18.0, 2.19.0, 2.20.0, 2.21.0)\nERROR: No matching distribution found for apache-beam==2.22.0.dev0", "url": "https://github.com/apache/beam/pull/11851#discussion_r432049685", "createdAt": "2020-05-28T18:51:30Z", "author": {"login": "davidcavazos"}, "path": "sdks/python/apache_beam/examples/snippets/snippets.py", "diffHunk": "@@ -226,35 +227,33 @@ def _add_argparse_args(cls, parser):\n \n   # [END pipeline_options_define_custom]\n \n-  from apache_beam.options.pipeline_options import GoogleCloudOptions\n-  from apache_beam.options.pipeline_options import StandardOptions\n-\n   # [START pipeline_options_dataflow_service]\n-  # Create and set your PipelineOptions.\n-  options = PipelineOptions(flags=argv)\n+  import apache_beam as beam\n+  from apache_beam.options.pipeline_options import PipelineOptions\n \n+  # Create and set your PipelineOptions.\n   # For Cloud execution, specify DataflowRunner and set the Cloud Platform\n-  # project, job name, staging file location, temp file location, and region.\n-  options.view_as(StandardOptions).runner = 'DataflowRunner'\n-  google_cloud_options = options.view_as(GoogleCloudOptions)\n-  google_cloud_options.project = 'my-project-id'\n-  google_cloud_options.job_name = 'myjob'\n-  google_cloud_options.staging_location = 'gs://my-bucket/binaries'\n-  google_cloud_options.temp_location = 'gs://my-bucket/temp'\n-  google_cloud_options.region = 'us-central1'\n+  # project, job name, temporary files location, and region.\n+  # For more information about regions, check:\n+  # https://cloud.google.com/dataflow/docs/concepts/regional-endpoints\n+  options = PipelineOptions(\n+      flags=argv,\n+      runner='DataflowRunner',\n+      project='my-project-id',\n+      job_name='unique-job-name',\n+      temp_location='gs://my-bucket/temp',\n+      region='us-central1')\n \n   # Create the Pipeline with the specified options.\n-  p = Pipeline(options=options)\n+  # with beam.Pipeline(options=options) as pipeline:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87df7a41ae2d751d66b9d87476408902e073f441"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNDY0NDMz", "url": "https://github.com/apache/beam/pull/11851#pullrequestreview-420464433", "createdAt": "2020-05-28T20:24:25Z", "commit": {"oid": "87df7a41ae2d751d66b9d87476408902e073f441"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc54f292beb42233e4c6235901475c872a0ab1f1", "author": {"user": {"login": "davidcavazos", "name": "David Cavazos"}}, "url": "https://github.com/apache/beam/commit/dc54f292beb42233e4c6235901475c872a0ab1f1", "committedDate": "2020-06-09T17:48:23Z", "message": "Merge branch 'master' of https://github.com/apache/beam into snippets-pipeline-options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc1e57f681ef69d12cc2ab78ca454fc682d5dff3", "author": {"user": {"login": "davidcavazos", "name": "David Cavazos"}}, "url": "https://github.com/apache/beam/commit/fc1e57f681ef69d12cc2ab78ca454fc682d5dff3", "committedDate": "2020-06-09T17:49:41Z", "message": "Use argv to parse the pipeline options in pipeline_options_local"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4416, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}