{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzMjM3NzM4", "number": 12804, "title": "Fix translations.optimize_pipeline() failure on empty pipelines", "bodyText": "Previously, translations.optimize_pipeline() failed on an empty pipeline because the leaf_transform_stages() returned no stages for an empty pipeline. This change makes leaf_transform_stages() return the root transform of an empty pipeline, and adds a test that calls translations.optimize_pipeline() on an empty pipeline.\n\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-09-10T00:42:47Z", "url": "https://github.com/apache/beam/pull/12804", "merged": true, "mergeCommit": {"oid": "fc53397fc7619fa57d61f09f4405e0a180b014a1"}, "closed": true, "closedAt": "2020-10-02T00:17:34Z", "author": {"login": "yifanmai"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHpBXJAFqTQ4NjM2NzUxNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOarhvgFqTUwMDc5NjUzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MzY3NTE1", "url": "https://github.com/apache/beam/pull/12804#pullrequestreview-486367515", "createdAt": "2020-09-10T23:01:16Z", "commit": {"oid": "930120a6eb5e03f060c56bf0fc7625426bed7c75"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzowMToxN1rOHQIkjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzowMToxN1rOHQIkjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3OTY5Mg==", "bodyText": "The convention in Beam is to use ()'s rather than backslashes for multi-line statements.", "url": "https://github.com/apache/beam/pull/12804#discussion_r486679692", "createdAt": "2020-09-10T23:01:17Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/runners/portability/fn_api_runner/translations.py", "diffHunk": "@@ -478,8 +478,10 @@ def leaf_transform_stages(\n     if root.spec.urn in known_composites:\n       yield Stage(root_id, [root], parent=parent)\n     elif not root.subtransforms:\n-      # Make sure its outputs are not a subset of its inputs.\n-      if set(root.outputs.values()) - set(root.inputs.values()):\n+      # Yield if its outputs are not a subset of its inputs,\n+      # or if it has no inputs and no outputs.\n+      if set(root.outputs.values()) - set(root.inputs.values()) or \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "930120a6eb5e03f060c56bf0fc7625426bed7c75"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "930120a6eb5e03f060c56bf0fc7625426bed7c75", "author": {"user": {"login": "yifanmai", "name": "Yifan Mai"}}, "url": "https://github.com/apache/beam/commit/930120a6eb5e03f060c56bf0fc7625426bed7c75", "committedDate": "2020-09-10T00:37:32Z", "message": "Change test name"}, "afterCommit": {"oid": "945140ce518acabfd617690b65d5711af63fa599", "author": {"user": {"login": "yifanmai", "name": "Yifan Mai"}}, "url": "https://github.com/apache/beam/commit/945140ce518acabfd617690b65d5711af63fa599", "committedDate": "2020-09-23T16:37:29Z", "message": "Change test name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "182f589f508de567dc63179fdae1b686f73eef72", "author": {"user": {"login": "yifanmai", "name": "Yifan Mai"}}, "url": "https://github.com/apache/beam/commit/182f589f508de567dc63179fdae1b686f73eef72", "committedDate": "2020-09-24T17:54:43Z", "message": "Fix tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b376c0da497ba10ea2d4e96ffd607ba0e0a6d429", "author": {"user": {"login": "yifanmai", "name": "Yifan Mai"}}, "url": "https://github.com/apache/beam/commit/b376c0da497ba10ea2d4e96ffd607ba0e0a6d429", "committedDate": "2020-09-23T16:41:07Z", "message": "Lint"}, "afterCommit": {"oid": "182f589f508de567dc63179fdae1b686f73eef72", "author": {"user": {"login": "yifanmai", "name": "Yifan Mai"}}, "url": "https://github.com/apache/beam/commit/182f589f508de567dc63179fdae1b686f73eef72", "committedDate": "2020-09-24T17:54:43Z", "message": "Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e641bc1be1a2a7e77015959ad0c70341ae44fac", "author": {"user": {"login": "yifanmai", "name": "Yifan Mai"}}, "url": "https://github.com/apache/beam/commit/2e641bc1be1a2a7e77015959ad0c70341ae44fac", "committedDate": "2020-09-24T17:58:33Z", "message": "Lint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c083ba6e391cd5cabbd2a39e10c10b60dc55952", "author": {"user": {"login": "yifanmai", "name": "Yifan Mai"}}, "url": "https://github.com/apache/beam/commit/4c083ba6e391cd5cabbd2a39e10c10b60dc55952", "committedDate": "2020-09-24T20:15:33Z", "message": "lint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNzk2NTM5", "url": "https://github.com/apache/beam/pull/12804#pullrequestreview-500796539", "createdAt": "2020-10-02T00:17:15Z", "commit": {"oid": "4c083ba6e391cd5cabbd2a39e10c10b60dc55952"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2623, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}