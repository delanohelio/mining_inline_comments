{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3MzYwMzc1", "number": 11492, "title": "[BEAM-9801] Pass in fire timestamp to timer callback", "bodyText": "Pass in the timestamp to avoid:\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n\nPlease add a meaningful description for your change here\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-04-22T15:19:38Z", "url": "https://github.com/apache/beam/pull/11492", "merged": true, "mergeCommit": {"oid": "cfa4ffa9b5de795fc80e632878f44d01f64b69fa"}, "closed": true, "closedAt": "2020-05-01T21:31:46Z", "author": {"login": "mxm"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaLx9JAFqTM5ODQxNTA5Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcdog8GAFqTQwNDYwNDY0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NDE1MDk2", "url": "https://github.com/apache/beam/pull/11492#pullrequestreview-398415096", "createdAt": "2020-04-22T17:27:31Z", "commit": {"oid": "6c840654747306a2135a55ed1f6f9e426dea2748"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzoyNzozMVrOGKCOIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzoyNzozMVrOGKCOIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE3NTMzMA==", "bodyText": "The paneinfo should also be passed in here. You can get paneinfo from timer.paneinfo", "url": "https://github.com/apache/beam/pull/11492#discussion_r413175330", "createdAt": "2020-04-22T17:27:31Z", "author": {"login": "boyuanzz"}, "path": "sdks/python/apache_beam/runners/common.py", "diffHunk": "@@ -229,7 +229,7 @@ def invoke_timer_callback(self, user_state_context, key, window, timestamp):\n         kwargs[kw] = user_state_context.get_state(state_spec, key, window)\n       for kw, timer_spec in self.timer_args_to_replace.items():\n         kwargs[kw] = user_state_context.get_timer(\n-            timer_spec, key, window, None, None)\n+            timer_spec, key, window, timestamp, None)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c840654747306a2135a55ed1f6f9e426dea2748"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6c840654747306a2135a55ed1f6f9e426dea2748", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/6c840654747306a2135a55ed1f6f9e426dea2748", "committedDate": "2020-04-22T15:19:14Z", "message": "[BEAM-9801] Pass in fire timestamp to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}, "afterCommit": {"oid": "9961394d4e25c8c3dd1ed5e59983b9a238664957", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/9961394d4e25c8c3dd1ed5e59983b9a238664957", "committedDate": "2020-04-22T19:41:13Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NTcxNjc0", "url": "https://github.com/apache/beam/pull/11492#pullrequestreview-398571674", "createdAt": "2020-04-22T20:42:02Z", "commit": {"oid": "9961394d4e25c8c3dd1ed5e59983b9a238664957"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMDo0MjowM1rOGKKvEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMDo0MjowM1rOGKKvEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzMxNDgzNQ==", "bodyText": "timer_data.paneinfo", "url": "https://github.com/apache/beam/pull/11492#discussion_r413314835", "createdAt": "2020-04-22T20:42:03Z", "author": {"login": "boyuanzz"}, "path": "sdks/python/apache_beam/runners/worker/operations.py", "diffHunk": "@@ -685,7 +685,8 @@ def process_timer(self, tag, timer_data):\n         timer_spec,\n         timer_data.user_key,\n         timer_data.windows[0],\n-        timer_data.fire_timestamp)\n+        timer_data.fire_timestamp,\n+        timer_data.pane_info)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9961394d4e25c8c3dd1ed5e59983b9a238664957"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9961394d4e25c8c3dd1ed5e59983b9a238664957", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/9961394d4e25c8c3dd1ed5e59983b9a238664957", "committedDate": "2020-04-22T19:41:13Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}, "afterCommit": {"oid": "1134a70919e65f3af4a939da76750ac416d0eab3", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/1134a70919e65f3af4a939da76750ac416d0eab3", "committedDate": "2020-04-23T10:35:57Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1134a70919e65f3af4a939da76750ac416d0eab3", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/1134a70919e65f3af4a939da76750ac416d0eab3", "committedDate": "2020-04-23T10:35:57Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}, "afterCommit": {"oid": "ef32a4d84c4c6c5c936c20a7cbb32257a276ebd8", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/ef32a4d84c4c6c5c936c20a7cbb32257a276ebd8", "committedDate": "2020-04-23T14:04:32Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef32a4d84c4c6c5c936c20a7cbb32257a276ebd8", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/ef32a4d84c4c6c5c936c20a7cbb32257a276ebd8", "committedDate": "2020-04-23T14:04:32Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}, "afterCommit": {"oid": "109d1f1c1a230c4a8ff62d25d228a9bbea8d5aec", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/109d1f1c1a230c4a8ff62d25d228a9bbea8d5aec", "committedDate": "2020-04-23T14:26:55Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "109d1f1c1a230c4a8ff62d25d228a9bbea8d5aec", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/109d1f1c1a230c4a8ff62d25d228a9bbea8d5aec", "committedDate": "2020-04-23T14:26:55Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}, "afterCommit": {"oid": "10f217fb8adf21e54d5f7b2641bb8d0568372f9e", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/10f217fb8adf21e54d5f7b2641bb8d0568372f9e", "committedDate": "2020-04-23T16:30:39Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NjI1NDEy", "url": "https://github.com/apache/beam/pull/11492#pullrequestreview-399625412", "createdAt": "2020-04-24T04:05:15Z", "commit": {"oid": "10f217fb8adf21e54d5f7b2641bb8d0568372f9e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwNDowNToxNVrOGLFbFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQwNDowNToxNVrOGLFbFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI3NjM3NA==", "bodyText": "I don't think we should set timer_buffer.cleared to False here.  There is an assumption around FnApiRunner.ListBuffer that per key the timer is only fired once. It seems like the assumption is broken by setting a new timer when firing the timer. If that's the case, we should consider updating the logic around timer buffer.", "url": "https://github.com/apache/beam/pull/11492#discussion_r414276374", "createdAt": "2020-04-24T04:05:15Z", "author": {"login": "boyuanzz"}, "path": "sdks/python/apache_beam/runners/portability/fn_api_runner/fn_runner.py", "diffHunk": "@@ -845,10 +845,12 @@ def process_bundle(self,\n           (result_future.is_done() and result_future.get().error)):\n         if isinstance(output, beam_fn_api_pb2.Elements.Timers) and not dry_run:\n           with BundleManager._lock:\n-            self.bundle_context_manager.get_buffer(\n+            timer_buffer = self.bundle_context_manager.get_buffer(\n                 expected_output_timers[(\n                     output.transform_id, output.timer_family_id)],\n-                output.transform_id).append(output.timers)\n+                output.transform_id)\n+            timer_buffer.cleared = False", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10f217fb8adf21e54d5f7b2641bb8d0568372f9e"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "10f217fb8adf21e54d5f7b2641bb8d0568372f9e", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/10f217fb8adf21e54d5f7b2641bb8d0568372f9e", "committedDate": "2020-04-23T16:30:39Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}, "afterCommit": {"oid": "0294cc5a36e98cc9f38be659233667051935ddac", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/0294cc5a36e98cc9f38be659233667051935ddac", "committedDate": "2020-04-24T10:33:42Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0294cc5a36e98cc9f38be659233667051935ddac", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/0294cc5a36e98cc9f38be659233667051935ddac", "committedDate": "2020-04-24T10:33:42Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}, "afterCommit": {"oid": "7ac3e0acf3d9693aff261e13830219aae837005a", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/7ac3e0acf3d9693aff261e13830219aae837005a", "committedDate": "2020-04-25T12:12:48Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7ac3e0acf3d9693aff261e13830219aae837005a", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/7ac3e0acf3d9693aff261e13830219aae837005a", "committedDate": "2020-04-25T12:12:48Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}, "afterCommit": {"oid": "c986a53b88cba891c64d320a2ef2cf497868001f", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/c986a53b88cba891c64d320a2ef2cf497868001f", "committedDate": "2020-04-29T10:40:15Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c986a53b88cba891c64d320a2ef2cf497868001f", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/c986a53b88cba891c64d320a2ef2cf497868001f", "committedDate": "2020-04-29T10:40:15Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}, "afterCommit": {"oid": "07fb5aad4d7b697b39d49e82b40372def75b6ccf", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/07fb5aad4d7b697b39d49e82b40372def75b6ccf", "committedDate": "2020-04-29T11:03:21Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzMDkwMTc4", "url": "https://github.com/apache/beam/pull/11492#pullrequestreview-403090178", "createdAt": "2020-04-29T22:40:35Z", "commit": {"oid": "07fb5aad4d7b697b39d49e82b40372def75b6ccf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "07fb5aad4d7b697b39d49e82b40372def75b6ccf", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/07fb5aad4d7b697b39d49e82b40372def75b6ccf", "committedDate": "2020-04-29T11:03:21Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}, "afterCommit": {"oid": "f656ad0ba5f1a6f0ba345071b3244c69714ed752", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/f656ad0ba5f1a6f0ba345071b3244c69714ed752", "committedDate": "2020-04-30T09:31:56Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f656ad0ba5f1a6f0ba345071b3244c69714ed752", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/f656ad0ba5f1a6f0ba345071b3244c69714ed752", "committedDate": "2020-04-30T09:31:56Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}, "afterCommit": {"oid": "3cfc993ad47f14bcca0aecb2201c3a085fef4b1f", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/3cfc993ad47f14bcca0aecb2201c3a085fef4b1f", "committedDate": "2020-04-30T14:22:46Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3a042b69a8bd97f322a674ac3753a09938648919", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/3a042b69a8bd97f322a674ac3753a09938648919", "committedDate": "2020-04-30T14:25:12Z", "message": "[BEAM-9801] Pass in fire timestamp and pane info to timer callback\n\nPass in the timestamp to avoid:\n\n```\nINFO:apache_beam.utils.subprocess_server:Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 245, in _execute\nINFO:apache_beam.utils.subprocess_server: response = task()\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 302, in <lambda>\nINFO:apache_beam.utils.subprocess_server: lambda: self.create_worker().do_instruction(request), request)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 471, in do_instruction\nINFO:apache_beam.utils.subprocess_server: getattr(request, request_type), request.instruction_id)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/sdk_worker.py\", line 506, in process_bundle\nINFO:apache_beam.utils.subprocess_server: bundle_processor.process_bundle(instruction_id))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 910, in process_bundle\nINFO:apache_beam.utils.subprocess_server: element.timer_family_id, timer_data)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/operations.py\", line 688, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer_data.fire_timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 990, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self._reraise_augmented(exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1043, in _reraise_augmented\nINFO:apache_beam.utils.subprocess_server: raise_with_traceback(new_exn)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 988, in process_user_timer\nINFO:apache_beam.utils.subprocess_server: self.do_fn_invoker.invoke_user_timer(timer_spec, key, window, timestamp)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 517, in invoke_user_timer\nINFO:apache_beam.utils.subprocess_server: self.user_state_context, key, window, timestamp))\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/common.py\", line 1093, in process_outputs\nINFO:apache_beam.utils.subprocess_server: for result in results:\nINFO:apache_beam.utils.subprocess_server: File \"/Users/max/Dev/beam/sdks/python/apache_beam/testing/load_tests/pardo_test.py\", line 185, in process_timer\nINFO:apache_beam.utils.subprocess_server: timer.set(0)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/runners/worker/bundle_processor.py\", line 589, in set\nINFO:apache_beam.utils.subprocess_server: self._timer_coder_impl.encode_to_stream(timer, self._output_stream, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 651, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: value.hold_timestamp, out, True)\nINFO:apache_beam.utils.subprocess_server: File \"apache_beam/coders/coder_impl.py\", line 608, in encode_to_stream\nINFO:apache_beam.utils.subprocess_server: millis = value.micros // 1000\nINFO:apache_beam.utils.subprocess_server:AttributeError: 'NoneType' object has no attribute 'micros' [while running 'GenerateLoad']\n```"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc8f17e7b18eab520dd5edff48b7c5c4eb385d31", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/dc8f17e7b18eab520dd5edff48b7c5c4eb385d31", "committedDate": "2020-04-30T14:25:12Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3cfc993ad47f14bcca0aecb2201c3a085fef4b1f", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/3cfc993ad47f14bcca0aecb2201c3a085fef4b1f", "committedDate": "2020-04-30T14:22:46Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}, "afterCommit": {"oid": "dc8f17e7b18eab520dd5edff48b7c5c4eb385d31", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/dc8f17e7b18eab520dd5edff48b7c5c4eb385d31", "committedDate": "2020-04-30T14:25:12Z", "message": "[BEAM-9733] Repeatedly fire in batch mode until there are no more timers"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NDQ2OTk0", "url": "https://github.com/apache/beam/pull/11492#pullrequestreview-404446994", "createdAt": "2020-05-01T23:31:44Z", "commit": {"oid": "dc8f17e7b18eab520dd5edff48b7c5c4eb385d31"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQyMzozMTo0NFrOGPYOdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQyMzozMTo0NFrOGPYOdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODc3ODc0MA==", "bodyText": "It makes sense to do this in batch as well since the processing timers should get dropped and any newly scheduled event time timers should be continually fired.\nThis would require updating FlinkExecutableStageFunction and SparkExecutableStageFunction", "url": "https://github.com/apache/beam/pull/11492#discussion_r418778740", "createdAt": "2020-05-01T23:31:44Z", "author": {"login": "lukecwik"}, "path": "runners/flink/src/main/java/org/apache/beam/runners/flink/translation/functions/FlinkExecutableStageFunction.java", "diffHunk": "@@ -247,25 +247,27 @@ public void reduce(Iterable<WindowedValue<InputT>> iterable, Collector<RawUnionV\n     timerInternals.advanceSynchronizedProcessingTime(BoundedWindow.TIMESTAMP_MAX_VALUE);\n \n     // Now we fire the timers and process elements generated by timers (which may be timers itself)\n-    try (RemoteBundle bundle =\n-        stageBundleFactory.getBundle(\n-            receiverFactory, timerReceiverFactory, stateRequestHandler, progressHandler)) {\n-\n-      PipelineTranslatorUtils.fireEligibleTimers(\n-          timerInternals,\n-          (KV<String, String> transformAndTimerId, Timer<?> timerValue) -> {\n-            FnDataReceiver<Timer> fnTimerReceiver =\n-                bundle.getTimerReceivers().get(transformAndTimerId);\n-            Preconditions.checkNotNull(\n-                fnTimerReceiver, \"No FnDataReceiver found for %s\", transformAndTimerId);\n-            try {\n-              fnTimerReceiver.accept(timerValue);\n-            } catch (Exception e) {\n-              throw new RuntimeException(\n-                  String.format(Locale.ENGLISH, \"Failed to process timer: %s\", timerValue));\n-            }\n-          },\n-          currentTimerKey);\n+    while (timerInternals.hasPendingTimers()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc8f17e7b18eab520dd5edff48b7c5c4eb385d31"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NjA0NjQ2", "url": "https://github.com/apache/beam/pull/11492#pullrequestreview-404604646", "createdAt": "2020-05-03T10:42:04Z", "commit": {"oid": "dc8f17e7b18eab520dd5edff48b7c5c4eb385d31"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4389, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}