{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNzQ4MTc1", "number": 12685, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMTowNjo1OVrOEe2qxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMzoyNDoyOFrOEe5uIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwNzg4NDIyOnYy", "diffSide": "RIGHT", "path": ".test-infra/jenkins/metrics_report/templates/Metrics_Report.template", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMTowNjo1OVrOHKxYrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMTozNzoxNlrOHKyTwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA1Njk0Mw==", "bodyText": "A regressions is defined as >=10 % increase in runtime?", "url": "https://github.com/apache/beam/pull/12685#discussion_r481056943", "createdAt": "2020-09-01T11:06:59Z", "author": {"login": "mxm"}, "path": ".test-infra/jenkins/metrics_report/templates/Metrics_Report.template", "diffHunk": "@@ -0,0 +1,141 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+<html>\n+<body>\n+\n+<h1>Beam Metrics Report</h1>\n+\n+Color legend:\n+<table>\n+    <tr>\n+        <td style=\"background-color:Red;padding:9px;text-align:center;\">>= 20</td>\n+        <td style=\"background-color:Yellow;padding:9px;text-align:center;\">>= 10</td>\n+        <td style=\"background-color:YellowGreen;padding:9px;text-align:center;\"><= -10</td>\n+        <td style=\"background-color:Green;padding:9px;text-align:center;\"><= -20</td>\n+    </tr>\n+</table>\n+\n+\n+<h2>Possible regression</h2>\n+\n+<table>\n+<tr>\n+    {% for header in headers -%}\n+        <td style=\"border-bottom:1px solid #ddd\"><b>{{ header }}</b></td>\n+    {% endfor %}\n+</tr>\n+\n+{% for row in metrics_data -%}\n+    {% if row[5] >= 10 %}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da4d8cdc029c7c6e88686b69771aa13d0be87b67"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA3MjA2NQ==", "bodyText": "Yes. It is related to difference of mean metric values from the last and previous week. Usually it is runtime but it can be read_time or write_time as well.", "url": "https://github.com/apache/beam/pull/12685#discussion_r481072065", "createdAt": "2020-09-01T11:37:16Z", "author": {"login": "TobKed"}, "path": ".test-infra/jenkins/metrics_report/templates/Metrics_Report.template", "diffHunk": "@@ -0,0 +1,141 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+<html>\n+<body>\n+\n+<h1>Beam Metrics Report</h1>\n+\n+Color legend:\n+<table>\n+    <tr>\n+        <td style=\"background-color:Red;padding:9px;text-align:center;\">>= 20</td>\n+        <td style=\"background-color:Yellow;padding:9px;text-align:center;\">>= 10</td>\n+        <td style=\"background-color:YellowGreen;padding:9px;text-align:center;\"><= -10</td>\n+        <td style=\"background-color:Green;padding:9px;text-align:center;\"><= -20</td>\n+    </tr>\n+</table>\n+\n+\n+<h2>Possible regression</h2>\n+\n+<table>\n+<tr>\n+    {% for header in headers -%}\n+        <td style=\"border-bottom:1px solid #ddd\"><b>{{ header }}</b></td>\n+    {% endfor %}\n+</tr>\n+\n+{% for row in metrics_data -%}\n+    {% if row[5] >= 10 %}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA1Njk0Mw=="}, "originalCommit": {"oid": "da4d8cdc029c7c6e88686b69771aa13d0be87b67"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwODM4NDMzOnYy", "diffSide": "RIGHT", "path": ".test-infra/jenkins/build.gradle", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxMzoyNDoyOFrOHK2HCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQyMDowODoyOFrOHLGaeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEzNDM0NA==", "bodyText": "Your report would be generated every time someone builds the whole project (by executing ./gradlew build). I think this is not what we wanted. Could you remove this line?", "url": "https://github.com/apache/beam/pull/12685#discussion_r481134344", "createdAt": "2020-09-01T13:24:28Z", "author": {"login": "kamilwu"}, "path": ".test-infra/jenkins/build.gradle", "diffHunk": "@@ -20,3 +20,32 @@ plugins {\n   id 'org.apache.beam.module'\n }\n applyGroovyNature()\n+applyPythonNature()\n+\n+pythonVersion = '3.8'\n+\n+task generateMetricsReport {\n+  dependsOn setupVirtualenv\n+  def metricsReportFilename = \"beam-metrics_report.html\"\n+  def generateMetricsReportDir = \"${rootDir}/.test-infra/jenkins/metrics_report\"\n+  def generateMetricsReportPath = \"${generateMetricsReportDir}/${metricsReportFilename}\"\n+  def toxConfigFilePath = \"${rootDir}/.test-infra/jenkins/metrics_report/tox.ini\"\n+\n+  def influxDb = project.findProperty('influxDb')\n+  def influxHost = project.findProperty('influxHost')\n+  def influxPort = project.findProperty('influxPort')\n+\n+  doLast {\n+    exec {\n+      executable 'sh'\n+      args '-c', \". ${envdir}/bin/activate && tox -e py38-test -c ${toxConfigFilePath}\"\n+    }\n+    exec {\n+      executable 'sh'\n+      args '-c', \". ${envdir}/bin/activate && tox -e py38-generate-report -c ${toxConfigFilePath} -- --influx-db=${influxDb} --influx-host=${influxHost} --influx-port=${influxPort} --output-file=${generateMetricsReportPath}\"\n+    }\n+    logger.info('Create metrics report file {}', generateMetricsReportPath)\n+  }\n+  outputs.file \"${generateMetricsReportPath}\"\n+}\n+build.dependsOn generateMetricsReport", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da4d8cdc029c7c6e88686b69771aa13d0be87b67"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQwMTQ2NQ==", "bodyText": "Sure. It is removed. Thank you for pointing this out.", "url": "https://github.com/apache/beam/pull/12685#discussion_r481401465", "createdAt": "2020-09-01T20:08:28Z", "author": {"login": "TobKed"}, "path": ".test-infra/jenkins/build.gradle", "diffHunk": "@@ -20,3 +20,32 @@ plugins {\n   id 'org.apache.beam.module'\n }\n applyGroovyNature()\n+applyPythonNature()\n+\n+pythonVersion = '3.8'\n+\n+task generateMetricsReport {\n+  dependsOn setupVirtualenv\n+  def metricsReportFilename = \"beam-metrics_report.html\"\n+  def generateMetricsReportDir = \"${rootDir}/.test-infra/jenkins/metrics_report\"\n+  def generateMetricsReportPath = \"${generateMetricsReportDir}/${metricsReportFilename}\"\n+  def toxConfigFilePath = \"${rootDir}/.test-infra/jenkins/metrics_report/tox.ini\"\n+\n+  def influxDb = project.findProperty('influxDb')\n+  def influxHost = project.findProperty('influxHost')\n+  def influxPort = project.findProperty('influxPort')\n+\n+  doLast {\n+    exec {\n+      executable 'sh'\n+      args '-c', \". ${envdir}/bin/activate && tox -e py38-test -c ${toxConfigFilePath}\"\n+    }\n+    exec {\n+      executable 'sh'\n+      args '-c', \". ${envdir}/bin/activate && tox -e py38-generate-report -c ${toxConfigFilePath} -- --influx-db=${influxDb} --influx-host=${influxHost} --influx-port=${influxPort} --output-file=${generateMetricsReportPath}\"\n+    }\n+    logger.info('Create metrics report file {}', generateMetricsReportPath)\n+  }\n+  outputs.file \"${generateMetricsReportPath}\"\n+}\n+build.dependsOn generateMetricsReport", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEzNDM0NA=="}, "originalCommit": {"oid": "da4d8cdc029c7c6e88686b69771aa13d0be87b67"}, "originalPosition": 32}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 592, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}