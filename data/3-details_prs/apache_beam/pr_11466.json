{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MjM5ODU3", "number": 11466, "title": "[BEAM-9787] Clear error message on UW + BQSource", "bodyText": "Please add a meaningful description for your change here\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-04-20T18:55:04Z", "url": "https://github.com/apache/beam/pull/11466", "merged": true, "mergeCommit": {"oid": "1572d57b2ee27d3af7a073815659cec60f59e1ad"}, "closed": true, "closedAt": "2020-04-21T18:07:00Z", "author": {"login": "pabloem"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZjv8ZAH2gAyNDA2MjM5ODU3OjVmNWY2MjJlM2YzNDNjMWMxODdmNWQyOThiOTFhZWU0MDhiM2E5MWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZkV-9gH2gAyNDA2MjM5ODU3OjcwN2VlOTgyM2E4Njg5ODkwZWVmNWVlYjQzMWJkYjQ0MmU0ZGNhNDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5f5f622e3f343c1c187f5d298b91aee408b3a91c", "author": {"user": {"login": "pabloem", "name": "Pablo"}}, "url": "https://github.com/apache/beam/commit/5f5f622e3f343c1c187f5d298b91aee408b3a91c", "committedDate": "2020-04-20T18:53:14Z", "message": "Clear error message on UW + BQSource"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NzQwOTU3", "url": "https://github.com/apache/beam/pull/11466#pullrequestreview-396740957", "createdAt": "2020-04-20T19:17:37Z", "commit": {"oid": "5f5f622e3f343c1c187f5d298b91aee408b3a91c"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxOToxNzozOFrOGIjwVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxOToxOTozMFrOGIj0vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYyNzYwNQ==", "bodyText": "s/Unified Worker/Dataflow runner V2 I believe.\ncc: @robertwb @ananvay for the correct wording here.", "url": "https://github.com/apache/beam/pull/11466#discussion_r411627605", "createdAt": "2020-04-20T19:17:38Z", "author": {"login": "chamikaramj"}, "path": "sdks/python/apache_beam/runners/dataflow/dataflow_runner.py", "diffHunk": "@@ -91,6 +91,12 @@\n _LOGGER = logging.getLogger(__name__)\n \n \n+BQ_SOURCE_UW_ERROR = (\n+    'The Read(BigQuerySource(...)) transform is not supported with newer stack '\n+    'features (Fn API, Unified Worker, etc). Please use the transform '", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f5f622e3f343c1c187f5d298b91aee408b3a91c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYyODE5MA==", "bodyText": "Should we also check for experiment use_runner_v2 or is this adequate ?", "url": "https://github.com/apache/beam/pull/11466#discussion_r411628190", "createdAt": "2020-04-20T19:18:32Z", "author": {"login": "chamikaramj"}, "path": "sdks/python/apache_beam/runners/dataflow/dataflow_runner.py", "diffHunk": "@@ -1182,6 +1188,11 @@ def run_Read(self, transform_node, options):\n         raise ValueError(\n             'BigQuery source is not currently available for use '\n             'in streaming pipelines.')\n+      debug_options = options.view_as(DebugOptions)\n+      use_fn_api = (debug_options.experiments and\n+                    'beam_fn_api' in debug_options.experiments)\n+      if use_fn_api:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f5f622e3f343c1c187f5d298b91aee408b3a91c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYyODczNQ==", "bodyText": "fnapi_fail (to be consistent with the above check).", "url": "https://github.com/apache/beam/pull/11466#discussion_r411628735", "createdAt": "2020-04-20T19:19:30Z", "author": {"login": "chamikaramj"}, "path": "sdks/python/apache_beam/runners/dataflow/dataflow_runner_test.py", "diffHunk": "@@ -258,6 +259,18 @@ def test_biqquery_read_streaming_fail(self):\n                     PipelineOptions(self.default_properties)) as p:\n         _ = p | beam.io.Read(beam.io.BigQuerySource('some.table'))\n \n+  def test_biqquery_read_uw_fail(self):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f5f622e3f343c1c187f5d298b91aee408b3a91c"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7752409ed868cb78edd3679b43d85475117291ef", "author": {"user": {"login": "pabloem", "name": "Pablo"}}, "url": "https://github.com/apache/beam/commit/7752409ed868cb78edd3679b43d85475117291ef", "committedDate": "2020-04-20T19:26:29Z", "message": "address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "707ee9823a8689890eef5eeb431bdb442e4dca47", "author": {"user": {"login": "pabloem", "name": "Pablo"}}, "url": "https://github.com/apache/beam/commit/707ee9823a8689890eef5eeb431bdb442e4dca47", "committedDate": "2020-04-20T19:34:47Z", "message": "fix lint, formatter"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4326, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}