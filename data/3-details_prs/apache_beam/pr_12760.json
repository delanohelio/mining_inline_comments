{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3OTYyMTg2", "number": 12760, "title": "[BEAM-10861] Adds URNs and payloads to PubSub transforms to allow runner-native overrides", "bodyText": "This is needed to allow runners to override portable definition of transforms.\nPlease add a meaningful description for your change here\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-09-02T16:48:01Z", "url": "https://github.com/apache/beam/pull/12760", "merged": true, "mergeCommit": {"oid": "a19d06eaf5d9639df330915ec175c8c8082c4980"}, "closed": true, "closedAt": "2020-09-12T19:09:04Z", "author": {"login": "chamikaramj"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdG7NP3gBqjM3NDIwOTc2NjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdIARw9AFqTQ4NzE5NDQyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "94dde80b8e8b81a057344efc152961673ec737ce", "author": {"user": {"login": "chamikaramj", "name": "Chamikara Jayalath"}}, "url": "https://github.com/apache/beam/commit/94dde80b8e8b81a057344efc152961673ec737ce", "committedDate": "2020-09-08T17:38:28Z", "message": "Adds URNs and payloads for PubSub transforms."}, "afterCommit": {"oid": "03771266a8d83ac24564a8fb39d5e694f6111342", "author": {"user": {"login": "chamikaramj", "name": "Chamikara Jayalath"}}, "url": "https://github.com/apache/beam/commit/03771266a8d83ac24564a8fb39d5e694f6111342", "committedDate": "2020-09-08T17:39:26Z", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e37f14ee50c8725f5e1f9be410f28c7f022d604e", "author": {"user": {"login": "chamikaramj", "name": "Chamikara Jayalath"}}, "url": "https://github.com/apache/beam/commit/e37f14ee50c8725f5e1f9be410f28c7f022d604e", "committedDate": "2020-09-08T17:49:25Z", "message": "updates"}, "afterCommit": {"oid": "9dd622c90e44b903c5aea4210bd84c60b52572e9", "author": {"user": {"login": "chamikaramj", "name": "Chamikara Jayalath"}}, "url": "https://github.com/apache/beam/commit/9dd622c90e44b903c5aea4210bd84c60b52572e9", "committedDate": "2020-09-08T17:49:42Z", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c131ca0a1f762685de0c5254d4392ca794aea95a", "author": {"user": {"login": "chamikaramj", "name": "Chamikara Jayalath"}}, "url": "https://github.com/apache/beam/commit/c131ca0a1f762685de0c5254d4392ca794aea95a", "committedDate": "2020-09-10T00:13:20Z", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9dd622c90e44b903c5aea4210bd84c60b52572e9", "author": {"user": {"login": "chamikaramj", "name": "Chamikara Jayalath"}}, "url": "https://github.com/apache/beam/commit/9dd622c90e44b903c5aea4210bd84c60b52572e9", "committedDate": "2020-09-08T17:49:42Z", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides"}, "afterCommit": {"oid": "c131ca0a1f762685de0c5254d4392ca794aea95a", "author": {"user": {"login": "chamikaramj", "name": "Chamikara Jayalath"}}, "url": "https://github.com/apache/beam/commit/c131ca0a1f762685de0c5254d4392ca794aea95a", "committedDate": "2020-09-10T00:13:20Z", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MTc0MTIx", "url": "https://github.com/apache/beam/pull/12760#pullrequestreview-487174121", "createdAt": "2020-09-11T23:32:25Z", "commit": {"oid": "c131ca0a1f762685de0c5254d4392ca794aea95a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMzozMjoyNVrOHQwbRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMzozMjoyNVrOHQwbRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMzMjY3Nw==", "bodyText": "Just curious why we use string not bytes for serialized fn.", "url": "https://github.com/apache/beam/pull/12760#discussion_r487332677", "createdAt": "2020-09-11T23:32:25Z", "author": {"login": "boyuanzz"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -650,6 +656,54 @@ message WriteFilesPayload {\n   map<string, SideInput> side_inputs = 5;\n }\n \n+// Payload used by Google Cloud Pub/Sub read transform.\n+// This can be used by runners that wish to override Beam Pub/Sub read transform\n+// with a native implementation.\n+message PubSubReadPayload {\n+\n+  // Topic to read from. Exactly one of topic or subscription should be set.\n+  string topic = 1;\n+\n+  // Subscription to read from. Exactly one of topic or subscription should be set.\n+  string subscription = 2;\n+\n+  // Attribute that provides element timestamps.\n+  string timestamp_attribute = 3;\n+\n+  // Attribute to be used for uniquely identifying messages.\n+  string id_attribute = 4;\n+\n+  // If true, reads Pub/Sub payload as well as attributes. If false, reads only the payload.\n+  bool with_attributes = 5;\n+\n+  // Parse function for attibutes.\n+  string serialized_attribute_fn = 6;\n+}\n+\n+// Payload used by Google Cloud Pub/Sub write transform.\n+// This can be used by runners that wish to override Beam Pub/Sub write transform\n+// with a native implementation.\n+message PubSubWritePayload {\n+\n+  // Topic to write to.\n+  string topic = 1;\n+\n+  // Attribute that provides element timestamps.\n+  string timestamp_attribute = 2;\n+\n+  // Attribute that uniquely identify messages.\n+  string id_attribute = 3;\n+\n+  // If true, writes Pub/Sub payload as well as attributes. If false, reads only the payload.\n+  bool with_attributes = 4;\n+\n+  // Parse function for attributes.\n+  string serialized_attribute_fn = 5;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c131ca0a1f762685de0c5254d4392ca794aea95a"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MTc0Nzk1", "url": "https://github.com/apache/beam/pull/12760#pullrequestreview-487174795", "createdAt": "2020-09-11T23:35:34Z", "commit": {"oid": "c131ca0a1f762685de0c5254d4392ca794aea95a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72058e49a00eb85caf0fe2301d353c6fd2708db4", "author": {"user": {"login": "chamikaramj", "name": "Chamikara Jayalath"}}, "url": "https://github.com/apache/beam/commit/72058e49a00eb85caf0fe2301d353c6fd2708db4", "committedDate": "2020-09-12T02:06:43Z", "message": "Documentation update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MTk0NDIx", "url": "https://github.com/apache/beam/pull/12760#pullrequestreview-487194421", "createdAt": "2020-09-12T02:07:56Z", "commit": {"oid": "72058e49a00eb85caf0fe2301d353c6fd2708db4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMjowNzo1NlrOHQxvhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMlQwMjowNzo1NlrOHQxvhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1NDI0Nw==", "bodyText": "This is to be provided as JSON serialized bytes. Slightly updated the documentation.\nThis is to be compatible with Dataflow implementation which is the only runner that will perform a native override of PubSub transforms.", "url": "https://github.com/apache/beam/pull/12760#discussion_r487354247", "createdAt": "2020-09-12T02:07:56Z", "author": {"login": "chamikaramj"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -650,6 +656,54 @@ message WriteFilesPayload {\n   map<string, SideInput> side_inputs = 5;\n }\n \n+// Payload used by Google Cloud Pub/Sub read transform.\n+// This can be used by runners that wish to override Beam Pub/Sub read transform\n+// with a native implementation.\n+message PubSubReadPayload {\n+\n+  // Topic to read from. Exactly one of topic or subscription should be set.\n+  string topic = 1;\n+\n+  // Subscription to read from. Exactly one of topic or subscription should be set.\n+  string subscription = 2;\n+\n+  // Attribute that provides element timestamps.\n+  string timestamp_attribute = 3;\n+\n+  // Attribute to be used for uniquely identifying messages.\n+  string id_attribute = 4;\n+\n+  // If true, reads Pub/Sub payload as well as attributes. If false, reads only the payload.\n+  bool with_attributes = 5;\n+\n+  // Parse function for attibutes.\n+  string serialized_attribute_fn = 6;\n+}\n+\n+// Payload used by Google Cloud Pub/Sub write transform.\n+// This can be used by runners that wish to override Beam Pub/Sub write transform\n+// with a native implementation.\n+message PubSubWritePayload {\n+\n+  // Topic to write to.\n+  string topic = 1;\n+\n+  // Attribute that provides element timestamps.\n+  string timestamp_attribute = 2;\n+\n+  // Attribute that uniquely identify messages.\n+  string id_attribute = 3;\n+\n+  // If true, writes Pub/Sub payload as well as attributes. If false, reads only the payload.\n+  bool with_attributes = 4;\n+\n+  // Parse function for attributes.\n+  string serialized_attribute_fn = 5;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMzMjY3Nw=="}, "originalCommit": {"oid": "c131ca0a1f762685de0c5254d4392ca794aea95a"}, "originalPosition": 59}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4636, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}