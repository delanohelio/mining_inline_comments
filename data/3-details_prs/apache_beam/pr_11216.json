{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzMzYyMTE0", "number": 11216, "title": "[BEAM-9562] Remove TimerSpec from Proto", "bodyText": "This PR removes TimerSpec from Proto. Timer will be translated into TimerFamilySpec over fnapi.\nR: @lukecwik\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-03-25T03:21:49Z", "url": "https://github.com/apache/beam/pull/11216", "merged": true, "mergeCommit": {"oid": "33d78c56dcffe73aaff540ee360d85b9219b6caf"}, "closed": true, "closedAt": "2020-03-27T04:20:59Z", "author": {"login": "boyuanzz"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRJQZZgFqTM4MTI1NTA5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRoHS9ABqjMxNzA4MzQzMDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMjU1MDk5", "url": "https://github.com/apache/beam/pull/11216#pullrequestreview-381255099", "createdAt": "2020-03-25T15:21:18Z", "commit": {"oid": "b0a0b85e4f6b6a1e0679bfdf8caea499f9d46157"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNToyMToxOFrOF7gVgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNToyNTo1MVrOF7gkFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk0MDA5OQ==", "bodyText": "I would suggest not changing the proto tag numbers otherwise you'll have a more difficult import/update issue with Google.\nIt will be much easier as a separate change to renumber them in increasing order, so timer_family_specs is 5, restriction_coder_id is 6, requests_finalization is 7, ... (making the import into Google much simpler to do).", "url": "https://github.com/apache/beam/pull/11216#discussion_r397940099", "createdAt": "2020-03-25T15:21:18Z", "author": {"login": "lukecwik"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -442,35 +442,30 @@ message ParDoPayload {\n   // be placed in the pipeline requirements.\n   map<string, StateSpec> state_specs = 4;\n \n-  // (Optional) A mapping of local timer names to timer specifications.\n-  // If this is set, the stateful processing requirement should also\n-  // be placed in the pipeline requirements.\n-  map<string, TimerSpec> timer_specs = 5;\n-\n-  // (Optional) A mapping of local timer family names to timer specifications.\n-  // If this is set, the stateful processing requirement should also\n-  // be placed in the pipeline requirements.\n-  map<string, TimerFamilySpec> timer_family_specs = 9;\n+  // (Optional) A mapping of local timer family names to timer family\n+  // specifications. If this is set, the stateful processing requirement should\n+  // also be placed in the pipeline requirements.\n+  map<string, TimerFamilySpec> timer_family_specs = 8;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0a0b85e4f6b6a1e0679bfdf8caea499f9d46157"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk0MjcyNg==", "bodyText": "shouldn't this method replace to_runner_api?", "url": "https://github.com/apache/beam/pull/11216#discussion_r397942726", "createdAt": "2020-03-25T15:24:27Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/transforms/userstate.py", "diffHunk": "@@ -141,6 +143,13 @@ def __init__(self, name, time_domain):\n   def __repr__(self):\n     return '%s(%s)' % (self.__class__.__name__, self.name)\n \n+  def to_timer_family_runner_api(self, context):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0a0b85e4f6b6a1e0679bfdf8caea499f9d46157"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk0MzgyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # TODO(BEAM-9602): Provide support of dynamic timer\n          \n          \n            \n            # TODO(BEAM-9602): Provide support for dynamic timer", "url": "https://github.com/apache/beam/pull/11216#discussion_r397943829", "createdAt": "2020-03-25T15:25:51Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/transforms/userstate.py", "diffHunk": "@@ -149,6 +158,26 @@ def to_runner_api(self, context):\n             coders._TimerCoder(coders.SingletonCoder(None))))\n \n \n+# TODO(BEAM-9602): Provide support of dynamic timer", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0a0b85e4f6b6a1e0679bfdf8caea499f9d46157"}, "originalPosition": 30}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "907b5699e9299436b7ac624a45ada3c7f944df8a", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/907b5699e9299436b7ac624a45ada3c7f944df8a", "committedDate": "2020-03-26T04:05:38Z", "message": "Update again"}, "afterCommit": {"oid": "3cd45e0ebc255c396e862f48acad335b7c568ed9", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/3cd45e0ebc255c396e862f48acad335b7c568ed9", "committedDate": "2020-03-26T18:22:53Z", "message": "Remove TimeSpec from proto"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMjk4NzU3", "url": "https://github.com/apache/beam/pull/11216#pullrequestreview-382298757", "createdAt": "2020-03-26T18:31:38Z", "commit": {"oid": "3cd45e0ebc255c396e862f48acad335b7c568ed9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxODozMTozOVrOF8U5AA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxODozMTozOVrOF8U5AA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgwMTE1Mg==", "bodyText": "You can rename this method to to_runner_api and remove the method below.", "url": "https://github.com/apache/beam/pull/11216#discussion_r398801152", "createdAt": "2020-03-26T18:31:39Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/transforms/userstate.py", "diffHunk": "@@ -141,6 +143,13 @@ def __init__(self, name, time_domain):\n   def __repr__(self):\n     return '%s(%s)' % (self.__class__.__name__, self.name)\n \n+  def to_timer_family_runner_api(self, context):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk0MjcyNg=="}, "originalCommit": {"oid": "b0a0b85e4f6b6a1e0679bfdf8caea499f9d46157"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3cd45e0ebc255c396e862f48acad335b7c568ed9", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/3cd45e0ebc255c396e862f48acad335b7c568ed9", "committedDate": "2020-03-26T18:22:53Z", "message": "Remove TimeSpec from proto"}, "afterCommit": {"oid": "60d298adcef07eeb1aec42c864246301f43c1582", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/60d298adcef07eeb1aec42c864246301f43c1582", "committedDate": "2020-03-26T18:57:01Z", "message": "Remove TimeSpec from proto"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMzI2MTIx", "url": "https://github.com/apache/beam/pull/11216#pullrequestreview-382326121", "createdAt": "2020-03-26T19:01:57Z", "commit": {"oid": "60d298adcef07eeb1aec42c864246301f43c1582"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39703c640b785349719f05278c8ee8b1944076d6", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/39703c640b785349719f05278c8ee8b1944076d6", "committedDate": "2020-03-27T03:26:45Z", "message": "Remove TimeSpec from proto"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "60d298adcef07eeb1aec42c864246301f43c1582", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/60d298adcef07eeb1aec42c864246301f43c1582", "committedDate": "2020-03-26T18:57:01Z", "message": "Remove TimeSpec from proto"}, "afterCommit": {"oid": "39703c640b785349719f05278c8ee8b1944076d6", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/39703c640b785349719f05278c8ee8b1944076d6", "committedDate": "2020-03-27T03:26:45Z", "message": "Remove TimeSpec from proto"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4678, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}