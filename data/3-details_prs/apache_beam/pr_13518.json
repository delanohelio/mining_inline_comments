{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NTc3NDIy", "number": 13518, "title": "[BEAM-11415][BEAM-11416] Move Go ValidatesRunner tests and add filtering", "bodyText": "Merges the ValidatesRunner tests (basically just cross-language) and framework with the existing integration test code and adds the ability to filter/sickbay tests. Adjusts existing integration tests to also work with the new framework. Finally, adds gradle targets for running the script with Spark and Python Portable runners.\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-12-10T01:43:08Z", "url": "https://github.com/apache/beam/pull/13518", "merged": true, "mergeCommit": {"oid": "a9291415709848c1b3fe54bbb346da1b21f78ed4"}, "closed": true, "closedAt": "2020-12-23T06:11:38Z", "author": {"login": "youngoli"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkpPzugH2gAyNTM1NTc3NDIyOmUwYTkwZGY1ZWQwNjRlNzE0ZDcwNGY5NGM3ZWNhMTc4MGY0ODcxNmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdo4JcIAH2gAyNTM1NTc3NDIyOmFmZTA5OTg2NTkxZGM2NTM3YzFkZGIzZDQ0ZTcxMGNjMzczZWNhMGE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e0a90df5ed064e714d704f94c7eca1780f48716a", "author": {"user": {"login": "youngoli", "name": "Daniel Oliveira"}}, "url": "https://github.com/apache/beam/commit/e0a90df5ed064e714d704f94c7eca1780f48716a", "committedDate": "2020-12-10T01:41:53Z", "message": "[BEAM-11415] [BEAM-11416] Move Go ValidatesRunner tests and add filtering.\n\nMerges the ValidatesRunner tests (basically just cross-language) and framework with the existing integration test code and adds the ability to filter/sickbay tests. Adjusts existing integration tests to also work with the new framework. Finally, adds gradle targets for running the script with Spark and Python Portable runners."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxOTAwODQ3", "url": "https://github.com/apache/beam/pull/13518#pullrequestreview-551900847", "createdAt": "2020-12-14T21:18:24Z", "commit": {"oid": "e0a90df5ed064e714d704f94c7eca1780f48716a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQyMToxODoyNFrOIFp1_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQyMToxODoyNFrOIFp1_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc5OTM1Nw==", "bodyText": "In open source Go the package name practically must match the folder the package lives in, unless it's a package main for a binary. That's probably the source of the pre and post commit failures.\nSo this would be xlang", "url": "https://github.com/apache/beam/pull/13518#discussion_r542799357", "createdAt": "2020-12-14T21:18:24Z", "author": {"login": "lostluck"}, "path": "sdks/go/test/integration/xlang/xlang_test.go", "diffHunk": "@@ -0,0 +1,260 @@\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//    http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package validatesrunner", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0a90df5ed064e714d704f94c7eca1780f48716a"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMDExNDkw", "url": "https://github.com/apache/beam/pull/13518#pullrequestreview-552011490", "createdAt": "2020-12-15T00:22:58Z", "commit": {"oid": "e0a90df5ed064e714d704f94c7eca1780f48716a"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMDoyMjo1OFrOIFzDVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMDoyMjo1OFrOIFzDVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjk1MDIyOA==", "bodyText": "We should consider (at some future time) to make these into flags, so they can be overridden as needed.\nhttps://pkg.go.dev/github.com/spf13/pflag#StringSlice\nNot super important as someone would still want to edit the default if they're trying to fix/resolve some of these.", "url": "https://github.com/apache/beam/pull/13518#discussion_r542950228", "createdAt": "2020-12-15T00:22:58Z", "author": {"login": "lostluck"}, "path": "sdks/go/test/integration/integration.go", "diffHunk": "@@ -0,0 +1,108 @@\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//    http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+// Package integration provides functionality that needs to be shared between all\n+// integration tests.\n+package integration\n+\n+import (\n+\t\"fmt\"\n+\t\"regexp\"\n+\t\"testing\"\n+\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/testing/ptest\"\n+)\n+\n+// Filters for temporarily skipping integration tests. All filters are regex\n+// matchers that must match the full name of a test at the point where\n+// CheckFilters is called. Multiple tests can be skipped by using regex\n+// wildcards. (ex. \"TestXLang_.*\" filters all tests starting with TestXLang_)\n+//\n+// It is strongly recommended to include, TODOs, Jira issues, or just comments\n+// describing why tests are being skipped.\n+\n+// sickbay filters tests that fail due to Go SDK errors. These tests will not\n+// execute on any runners.\n+var sickbay = []string{\n+\t// TODO(BEAM-11418): These tests are currently failing with the Go SDK.\n+\t\"TestXLang_CoGroupBy\",\n+\t\"TestXLang_Multi\",\n+\t\"TestXLang_Partition\",\n+}\n+\n+// Runner-specific test filters, for features that are not yet supported on\n+// specific runners.\n+\n+var directFilters = []string{\n+\t// The direct runner does not yet support cross-language.\n+\t\"TestXLang.*\",\n+}\n+\n+var portableFilters = []string{}\n+\n+var flinkFilters = []string{}\n+\n+var sparkFilters = []string{}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0a90df5ed064e714d704f94c7eca1780f48716a"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f3c93c274be2d02cc4b12a40a9f89d901d8e9de", "author": {"user": {"login": "youngoli", "name": "Daniel Oliveira"}}, "url": "https://github.com/apache/beam/commit/0f3c93c274be2d02cc4b12a40a9f89d901d8e9de", "committedDate": "2020-12-18T03:43:53Z", "message": "[BEAM-11415] [BEAM-11416] Remove old VR tests and add additional filtering.\n\nThe old validatesrunner tests were causing Pre and Post-commit failures because they were automatically being tested by GoTest. Also, added filtering so that the ULR, Flink, and Spark gradle targets will pass."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afe09986591dc6537c1ddb3d44e710cc373eca0a", "author": {"user": {"login": "youngoli", "name": "Daniel Oliveira"}}, "url": "https://github.com/apache/beam/commit/afe09986591dc6537c1ddb3d44e710cc373eca0a", "committedDate": "2020-12-23T05:19:12Z", "message": "fixup"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4394, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}