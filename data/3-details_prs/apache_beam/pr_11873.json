{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NjAzMTkw", "number": 11873, "title": "[BEAM-3489] DataflowRunner to read PubsubMessage if getNeedsMessageId is true", "bodyText": "Make sure PUBSUB_SERIALIZED_ATTRIBUTES_FN is set if getNeedsMessageId is true. Based on a comment in https://issues.apache.org/jira/browse/BEAM-3489?focusedCommentId=17110444&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-17110444.\nR: @lukecwik\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-05-31T12:15:39Z", "url": "https://github.com/apache/beam/pull/11873", "merged": true, "mergeCommit": {"oid": "c0dd6e72ebe5103f817d8c7ccaf02f1a67368aa5"}, "closed": true, "closedAt": "2020-06-17T20:27:31Z", "author": {"login": "thinhha"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcmq0TogBqjMzOTA1NjU1MTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsMhzcAFqTQzMjU3NjUxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3e9cdadd959bc1459f012366f3f0b7fae2a6d0dc", "author": {"user": {"login": "thinhha", "name": "Thinh Ha"}}, "url": "https://github.com/apache/beam/commit/3e9cdadd959bc1459f012366f3f0b7fae2a6d0dc", "committedDate": "2020-05-31T12:10:32Z", "message": "DataflowRunner to read PubsubMessage if getNeedsMessageId is true"}, "afterCommit": {"oid": "803d3ff9b35a5ebd17c5463718f79152c42c55a2", "author": {"user": {"login": "thinhha", "name": "Thinh Ha"}}, "url": "https://github.com/apache/beam/commit/803d3ff9b35a5ebd17c5463718f79152c42c55a2", "committedDate": "2020-05-31T12:28:02Z", "message": "DataflowRunner to read PubsubMessage if getNeedsMessageId is true"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f2c05f0883dcbdfb2cab8cb4ea141b9353017b6", "author": {"user": {"login": "thinhha", "name": "Thinh Ha"}}, "url": "https://github.com/apache/beam/commit/5f2c05f0883dcbdfb2cab8cb4ea141b9353017b6", "committedDate": "2020-05-31T12:31:07Z", "message": "DataflowRunner to read PubsubMessage if getNeedsMessageId is true"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "803d3ff9b35a5ebd17c5463718f79152c42c55a2", "author": {"user": {"login": "thinhha", "name": "Thinh Ha"}}, "url": "https://github.com/apache/beam/commit/803d3ff9b35a5ebd17c5463718f79152c42c55a2", "committedDate": "2020-05-31T12:28:02Z", "message": "DataflowRunner to read PubsubMessage if getNeedsMessageId is true"}, "afterCommit": {"oid": "5f2c05f0883dcbdfb2cab8cb4ea141b9353017b6", "author": {"user": {"login": "thinhha", "name": "Thinh Ha"}}, "url": "https://github.com/apache/beam/commit/5f2c05f0883dcbdfb2cab8cb4ea141b9353017b6", "committedDate": "2020-05-31T12:31:07Z", "message": "DataflowRunner to read PubsubMessage if getNeedsMessageId is true"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzMDczOTcz", "url": "https://github.com/apache/beam/pull/11873#pullrequestreview-423073973", "createdAt": "2020-06-02T21:34:09Z", "commit": {"oid": "5f2c05f0883dcbdfb2cab8cb4ea141b9353017b6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMTozNDowOVrOGeEw4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMTozNDowOVrOGeEw4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE4ODUxNQ==", "bodyText": "Minor suggestion:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  if (overriddenTransform.getNeedsAttributes() | overriddenTransform.getNeedsMessageId()) {\n          \n          \n            \n                  if (overriddenTransform.getNeedsAttributes() || overriddenTransform.getNeedsMessageId()) {", "url": "https://github.com/apache/beam/pull/11873#discussion_r434188515", "createdAt": "2020-06-02T21:34:09Z", "author": {"login": "lukecwik"}, "path": "runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/DataflowRunner.java", "diffHunk": "@@ -1353,14 +1353,14 @@ public void translate(StreamingPubsubIORead transform, TranslationContext contex\n             PropertyNames.PUBSUB_ID_ATTRIBUTE, overriddenTransform.getIdAttribute());\n       }\n       // In both cases, the transform needs to read PubsubMessage. However, in case it needs\n-      // the attributes, we supply an identity \"parse fn\" so the worker will read PubsubMessage's\n-      // from Windmill and simply pass them around; and in case it doesn't need attributes,\n-      // we're already implicitly using a \"Coder\" that interprets the data as a PubsubMessage's\n-      // payload.\n-      if (overriddenTransform.getNeedsAttributes()) {\n+      // the attributes or messageId, we supply an identity \"parse fn\" so the worker will\n+      // read PubsubMessage's from Windmill and simply pass them around; and in case it\n+      // doesn't need attributes, we're already implicitly using a \"Coder\" that interprets\n+      // the data as a PubsubMessage's payload.\n+      if (overriddenTransform.getNeedsAttributes() | overriddenTransform.getNeedsMessageId()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f2c05f0883dcbdfb2cab8cb4ea141b9353017b6"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "026cfe45dee318bbfff410362e6436a9203aae57", "author": {"user": {"login": "thinhha", "name": "Thinh Ha"}}, "url": "https://github.com/apache/beam/commit/026cfe45dee318bbfff410362e6436a9203aae57", "committedDate": "2020-06-03T18:26:23Z", "message": "changed | to ||"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d0286f5b53900055d1834883f4162fd189c09fc", "author": {"user": {"login": "thinhha", "name": "Thinh Ha"}}, "url": "https://github.com/apache/beam/commit/0d0286f5b53900055d1834883f4162fd189c09fc", "committedDate": "2020-06-13T08:03:10Z", "message": "spotless apply"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNTc2NTEy", "url": "https://github.com/apache/beam/pull/11873#pullrequestreview-432576512", "createdAt": "2020-06-17T16:34:32Z", "commit": {"oid": "0d0286f5b53900055d1834883f4162fd189c09fc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4478, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}