{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwMDYzODQ1", "number": 10974, "title": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types", "bodyText": "R: @aromanenko-dev @reuvenlax", "createdAt": "2020-02-26T07:59:37Z", "url": "https://github.com/apache/beam/pull/10974", "merged": true, "mergeCommit": {"oid": "116c5e8b7a43a7e40342248b00f0bfac69ca9cb9"}, "closed": true, "closedAt": "2020-03-01T06:13:08Z", "author": {"login": "iemejia"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcICF_nABqjMwNzI1MzQ3Mzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIco7DgFqTM2NTczNjIyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "61f1c498d63a7fda4223b586d008170854cd5a36", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/61f1c498d63a7fda4223b586d008170854cd5a36", "committedDate": "2020-02-26T07:57:40Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}, "afterCommit": {"oid": "afe344ba9c29c0fe9a849001824b3512703bb2dd", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/afe344ba9c29c0fe9a849001824b3512703bb2dd", "committedDate": "2020-02-26T08:03:35Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "afe344ba9c29c0fe9a849001824b3512703bb2dd", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/afe344ba9c29c0fe9a849001824b3512703bb2dd", "committedDate": "2020-02-26T08:03:35Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}, "afterCommit": {"oid": "e6e4a1103c348c0d9b477f0cee864aba688f9fe3", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/e6e4a1103c348c0d9b477f0cee864aba688f9fe3", "committedDate": "2020-02-26T17:21:47Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MDk0MTMw", "url": "https://github.com/apache/beam/pull/10974#pullrequestreview-365094130", "createdAt": "2020-02-26T17:24:20Z", "commit": {"oid": "e6e4a1103c348c0d9b477f0cee864aba688f9fe3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxNzoyNDoyMFrOFu055w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxNzoyNDoyMFrOFu055w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY0NTYwNw==", "bodyText": "This looks fine, but can you explain the use case? The goal was for users to never have to deal with SchemaCoder (the fact that schemas are implemented via a special coder should be a Beam implementation details), but I'd understand if we have cases where the coder is still needed.", "url": "https://github.com/apache/beam/pull/10974#discussion_r384645607", "createdAt": "2020-02-26T17:24:20Z", "author": {"login": "reuvenlax"}, "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/schemas/SchemaRegistry.java", "diffHunk": "@@ -288,6 +281,38 @@ public void registerSchemaProvider(SchemaProvider schemaProvider) {\n     return getProviderResult((SchemaProvider p) -> p.fromRowFunction(typeDescriptor));\n   }\n \n+  /**\n+   * Retrieve a {@link SchemaCoder} for a given {@link Class} type. If no schema exists, throws\n+   * {@link * NoSuchSchemaException}.\n+   */\n+  public <T> SchemaCoder<T> getSchemaCoder(Class<T> clazz) throws NoSuchSchemaException {\n+    return getSchemaCoder(TypeDescriptor.of(clazz));\n+  }\n+\n+  /**\n+   * Retrieve a {@link SchemaCoder} for a given {@link TypeDescriptor} type. If no schema exists,\n+   * throws {@link * NoSuchSchemaException}.\n+   */\n+  public <T> SchemaCoder<T> getSchemaCoder(TypeDescriptor<T> typeDescriptor)\n+      throws NoSuchSchemaException {\n+    return SchemaCoder.of(\n+        getSchema(typeDescriptor),\n+        typeDescriptor,\n+        getToRowFunction(typeDescriptor),\n+        getFromRowFunction(typeDescriptor));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6e4a1103c348c0d9b477f0cee864aba688f9fe3"}, "originalPosition": 73}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e6e4a1103c348c0d9b477f0cee864aba688f9fe3", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/e6e4a1103c348c0d9b477f0cee864aba688f9fe3", "committedDate": "2020-02-26T17:21:47Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}, "afterCommit": {"oid": "17d8c1005066721dcfc2bd8ac95b60702b8f50a6", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/17d8c1005066721dcfc2bd8ac95b60702b8f50a6", "committedDate": "2020-02-27T09:37:52Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "612d3d1f213155c2df89ff5172343a23a0268cf9", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/612d3d1f213155c2df89ff5172343a23a0268cf9", "committedDate": "2020-02-27T14:57:27Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "17d8c1005066721dcfc2bd8ac95b60702b8f50a6", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/17d8c1005066721dcfc2bd8ac95b60702b8f50a6", "committedDate": "2020-02-27T09:37:52Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}, "afterCommit": {"oid": "612d3d1f213155c2df89ff5172343a23a0268cf9", "author": {"user": {"login": "iemejia", "name": "Isma\u00ebl Mej\u00eda"}}, "url": "https://github.com/apache/beam/commit/612d3d1f213155c2df89ff5172343a23a0268cf9", "committedDate": "2020-02-27T14:57:27Z", "message": "[BEAM-9384] Add SchemaRegistry.getSchemaCoder to get SchemaCoders for registered types"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NzM2MjI3", "url": "https://github.com/apache/beam/pull/10974#pullrequestreview-365736227", "createdAt": "2020-02-27T14:59:30Z", "commit": {"oid": "612d3d1f213155c2df89ff5172343a23a0268cf9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNDo1OTozMVrOFvU3jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNDo1OTozMVrOFvU3jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE2OTI5NQ==", "bodyText": "This change is required because we should not be exposing Guava (even our own vendored version) in the public API and it was surfaced by a GcpCoreApiSurfaceTest break", "url": "https://github.com/apache/beam/pull/10974#discussion_r385169295", "createdAt": "2020-02-27T14:59:31Z", "author": {"login": "iemejia"}, "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/schemas/SchemaCoder.java", "diffHunk": "@@ -59,7 +60,7 @@\n @Experimental(Kind.SCHEMAS)\n public class SchemaCoder<T> extends CustomCoder<T> {\n   // This contains a map of primitive types to their coders.\n-  public static final ImmutableMap<TypeName, Coder> CODER_MAP =\n+  public static final Map<TypeName, Coder> CODER_MAP =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "612d3d1f213155c2df89ff5172343a23a0268cf9"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2942, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}