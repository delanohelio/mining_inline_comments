{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNjg4NzA3", "number": 10536, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMToxNTo1MlrODWtzYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMjo1Mjo0MVrODXAdQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MTQ1Njk2OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/options/pipeline_options.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQwMToxNTo1MlrOFbokrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNzowOTo1NlrOFb9Q5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDUyMDYyMg==", "bodyText": "Would it make sense to add another choice for EmbeddedWorkerHandler and change the default to that, instead of defaulting to None?", "url": "https://github.com/apache/beam/pull/10536#discussion_r364520622", "createdAt": "2020-01-09T01:15:52Z", "author": {"login": "aaltay"}, "path": "sdks/python/apache_beam/options/pipeline_options.py", "diffHunk": "@@ -438,6 +438,12 @@ def _add_argparse_args(cls, parser):\n         type=int,\n         default=1,\n         help='number of parallel running workers.')\n+    parser.add_argument(\n+        '--direct_running_mode',\n+        default=None,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c394c532935e12e00aeb56dd08c4c5e217d140ca"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg1OTYyMw==", "bodyText": "Yes, that makes more sense, I will make a commit.", "url": "https://github.com/apache/beam/pull/10536#discussion_r364859623", "createdAt": "2020-01-09T17:09:56Z", "author": {"login": "Hannah-Jiang"}, "path": "sdks/python/apache_beam/options/pipeline_options.py", "diffHunk": "@@ -438,6 +438,12 @@ def _add_argparse_args(cls, parser):\n         type=int,\n         default=1,\n         help='number of parallel running workers.')\n+    parser.add_argument(\n+        '--direct_running_mode',\n+        default=None,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDUyMDYyMg=="}, "originalCommit": {"oid": "c394c532935e12e00aeb56dd08c4c5e217d140ca"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NDA3NzE1OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/runners/portability/fn_api_runner.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxOTo0OTozNFrOFcBg2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMjoxNjoyN1rOFcFCUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkyOTI0Mw==", "bodyText": "Could this be None any more? Since it has a default value.", "url": "https://github.com/apache/beam/pull/10536#discussion_r364929243", "createdAt": "2020-01-09T19:49:34Z", "author": {"login": "aaltay"}, "path": "sdks/python/apache_beam/runners/portability/fn_api_runner.py", "diffHunk": "@@ -450,6 +450,21 @@ def run_pipeline(self,\n         pipeline_options.DirectOptions).direct_runner_bundle_repeat\n     self._num_workers = options.view_as(\n         pipeline_options.DirectOptions).direct_num_workers or self._num_workers\n+\n+    # set direct workers running mode if it is defined with pipeline options.\n+    if options.view_as(pipeline_options.DirectOptions).direct_running_mode \\\n+        is not None:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3f33d96d571c0e455bea8e08e4ed7b2ff2e7f79"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk4Njk2Mw==", "bodyText": "Rephrased it. Thank you for catching it.", "url": "https://github.com/apache/beam/pull/10536#discussion_r364986963", "createdAt": "2020-01-09T22:16:27Z", "author": {"login": "Hannah-Jiang"}, "path": "sdks/python/apache_beam/runners/portability/fn_api_runner.py", "diffHunk": "@@ -450,6 +450,21 @@ def run_pipeline(self,\n         pipeline_options.DirectOptions).direct_runner_bundle_repeat\n     self._num_workers = options.view_as(\n         pipeline_options.DirectOptions).direct_num_workers or self._num_workers\n+\n+    # set direct workers running mode if it is defined with pipeline options.\n+    if options.view_as(pipeline_options.DirectOptions).direct_running_mode \\\n+        is not None:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkyOTI0Mw=="}, "originalCommit": {"oid": "b3f33d96d571c0e455bea8e08e4ed7b2ff2e7f79"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NDUxMzI4OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/runners/portability/fn_api_runner.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMjo1Mjo0MVrOFcFywg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMzo0ODo0MVrOFcGwKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk5OTM2Mg==", "bodyText": "Why not utf-8?", "url": "https://github.com/apache/beam/pull/10536#discussion_r364999362", "createdAt": "2020-01-09T22:52:41Z", "author": {"login": "ibzib"}, "path": "sdks/python/apache_beam/runners/portability/fn_api_runner.py", "diffHunk": "@@ -450,6 +450,19 @@ def run_pipeline(self,\n         pipeline_options.DirectOptions).direct_runner_bundle_repeat\n     self._num_workers = options.view_as(\n         pipeline_options.DirectOptions).direct_num_workers or self._num_workers\n+\n+    # set direct workers running mode if it is defined with pipeline options.\n+    running_mode = \\\n+      options.view_as(pipeline_options.DirectOptions).direct_running_mode\n+    if running_mode == 'multi_threading':\n+      self._default_environment = environments.EmbeddedPythonGrpcEnvironment()\n+    elif running_mode == 'multi_processing':\n+      command_bytes = b'%s -m apache_beam.runners.worker.sdk_worker_main' \\\n+                       % sys.executable.encode('ascii')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6faf9cf05d72af69b6934b164ee6e2a64afe290"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTAxNTA4MQ==", "bodyText": "I removed command_bytes because we don't need it anymore.", "url": "https://github.com/apache/beam/pull/10536#discussion_r365015081", "createdAt": "2020-01-09T23:48:41Z", "author": {"login": "Hannah-Jiang"}, "path": "sdks/python/apache_beam/runners/portability/fn_api_runner.py", "diffHunk": "@@ -450,6 +450,19 @@ def run_pipeline(self,\n         pipeline_options.DirectOptions).direct_runner_bundle_repeat\n     self._num_workers = options.view_as(\n         pipeline_options.DirectOptions).direct_num_workers or self._num_workers\n+\n+    # set direct workers running mode if it is defined with pipeline options.\n+    running_mode = \\\n+      options.view_as(pipeline_options.DirectOptions).direct_running_mode\n+    if running_mode == 'multi_threading':\n+      self._default_environment = environments.EmbeddedPythonGrpcEnvironment()\n+    elif running_mode == 'multi_processing':\n+      command_bytes = b'%s -m apache_beam.runners.worker.sdk_worker_main' \\\n+                       % sys.executable.encode('ascii')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk5OTM2Mg=="}, "originalCommit": {"oid": "e6faf9cf05d72af69b6934b164ee6e2a64afe290"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2300, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}