{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAzNzUzNjE3", "number": 13123, "title": "[BEAM-10959] Fix circle buffer.", "bodyText": "Fix the off by one error in the circle buffer and add a test.\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-10-15T02:09:26Z", "url": "https://github.com/apache/beam/pull/13123", "merged": true, "mergeCommit": {"oid": "b4544233be41869daab60650b1c47b50e42f5194"}, "closed": true, "closedAt": "2020-10-15T04:26:24Z", "author": {"login": "lostluck"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSoCsYgH2gAyNTAzNzUzNjE3Ojk0MDJhODc2MWM0MWUxNzZlOTEzNTZhODI5NjRhMGIwZDdiYzZmNDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSp8_iAH2gAyNTAzNzUzNjE3OjJmODFjMWM4YWFhODU1MmNmNTljMGQwNGE0M2ExNTA3NTI4YzZlZTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9402a8761c41e176e91356a82964a0b0d7bc6f40", "author": {"user": {"login": "lostluck", "name": "Robert Burke"}}, "url": "https://github.com/apache/beam/commit/9402a8761c41e176e91356a82964a0b0d7bc6f40", "committedDate": "2020-10-15T02:07:01Z", "message": "[BEAM-10959] Fix circle buffer."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd6bc938809c93aa407796fd255c859dd16401d1", "author": {"user": {"login": "lostluck", "name": "Robert Burke"}}, "url": "https://github.com/apache/beam/commit/cd6bc938809c93aa407796fd255c859dd16401d1", "committedDate": "2020-10-15T02:36:30Z", "message": "[BEAM-10959] abstract out circle buffer and test it."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4OTE3NzQy", "url": "https://github.com/apache/beam/pull/13123#pullrequestreview-508917742", "createdAt": "2020-10-15T03:49:23Z", "commit": {"oid": "cd6bc938809c93aa407796fd255c859dd16401d1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwMzo0OToyM1rOHhvyBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQwMzo0OToyM1rOHhvyBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTE0NzkxMQ==", "bodyText": "nit: This comment doesn't make sense anymore because there's no indication that this map is for inactive plans. Can probably adjust these comments a bit, maybe delete this one and amend the one below to refer to \"buf\" instead of \"inactive map\".", "url": "https://github.com/apache/beam/pull/13123#discussion_r505147911", "createdAt": "2020-10-15T03:49:23Z", "author": {"login": "youngoli"}, "path": "sdks/go/pkg/beam/core/runtime/harness/harness.go", "diffHunk": "@@ -158,6 +158,60 @@ func Main(ctx context.Context, loggingEndpoint, controlEndpoint string) error {\n type bundleDescriptorID string\n type instructionID string\n \n+const circleBufferCap = 1000\n+\n+// circleBuffer is an ordered eviction buffer\n+type circleBuffer struct {\n+\t// a plan that's either about to start or has finished recently", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd6bc938809c93aa407796fd255c859dd16401d1"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f81c1c8aaa8552cf59c0d04a43a1507528c6ee4", "author": {"user": {"login": "lostluck", "name": "Robert Burke"}}, "url": "https://github.com/apache/beam/commit/2f81c1c8aaa8552cf59c0d04a43a1507528c6ee4", "committedDate": "2020-10-15T04:20:36Z", "message": "Fix documentation on circleBuffer fields."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2079, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}