{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNjI3NDI1", "number": 11162, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzo1MDozOFrODpnX4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzo1MTo1NVrODpnZnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0OTYzMjk3OnYy", "diffSide": "RIGHT", "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzo1MDozOFrOF4538g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxOToyOToyNFrOF49U8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxMjc4Ng==", "bodyText": "I'm not convinced that using the presence of a restriction coder is better than explicitly marking things as splittable, but could possibly be persuaded.", "url": "https://github.com/apache/beam/pull/11162#discussion_r395212786", "createdAt": "2020-03-19T17:50:38Z", "author": {"login": "robertwb"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -457,10 +457,9 @@ message ParDoPayload {\n   // be placed in the pipeline requirements.\n   map<string, TimerFamilySpec> timer_family_specs = 9;\n \n-  // Whether the DoFn is splittable\n-  bool splittable = 6;\n-\n-  // (Required if splittable == true) Id of the restriction coder.\n+  // (Optional) Only set when this ParDo contains a splittable DoFn.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "17b021624d249dde650980e552f41a6c6fd44994"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIyMDM5MQ==", "bodyText": "splittable is invalid without the other field being set so why have it?\nIt would allow for bugs where one is set and the other is not.", "url": "https://github.com/apache/beam/pull/11162#discussion_r395220391", "createdAt": "2020-03-19T18:02:58Z", "author": {"login": "lukecwik"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -457,10 +457,9 @@ message ParDoPayload {\n   // be placed in the pipeline requirements.\n   map<string, TimerFamilySpec> timer_family_specs = 9;\n \n-  // Whether the DoFn is splittable\n-  bool splittable = 6;\n-\n-  // (Required if splittable == true) Id of the restriction coder.\n+  // (Optional) Only set when this ParDo contains a splittable DoFn.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxMjc4Ng=="}, "originalCommit": {"oid": "17b021624d249dde650980e552f41a6c6fd44994"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI2OTM2Mw==", "bodyText": "Because it's not as obvious. But I can see the pros and cons.", "url": "https://github.com/apache/beam/pull/11162#discussion_r395269363", "createdAt": "2020-03-19T19:29:24Z", "author": {"login": "robertwb"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -457,10 +457,9 @@ message ParDoPayload {\n   // be placed in the pipeline requirements.\n   map<string, TimerFamilySpec> timer_family_specs = 9;\n \n-  // Whether the DoFn is splittable\n-  bool splittable = 6;\n-\n-  // (Required if splittable == true) Id of the restriction coder.\n+  // (Optional) Only set when this ParDo contains a splittable DoFn.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxMjc4Ng=="}, "originalCommit": {"oid": "17b021624d249dde650980e552f41a6c6fd44994"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0OTYzNzQzOnYy", "diffSide": "RIGHT", "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNzo1MTo1NVrOF4562Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxOToyOToyNVrOF49U_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxMzUyOQ==", "bodyText": "Is this a requirement, given that the pipeline would still execute correctly were expansion not performed? (Maybe the performance is bad enough to merit this, but then again, maybe SDF is so primitive that all runners should do something do support sources.)", "url": "https://github.com/apache/beam/pull/11162#discussion_r395213529", "createdAt": "2020-03-19T17:51:55Z", "author": {"login": "robertwb"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -1355,6 +1355,10 @@ message StandardRequirements {\n     // This requirement indicates the requires_time_sorted_input field of ParDo\n     // transform payloads must be inspected.\n     REQUIRES_TIME_SORTED_INPUT = 3 [(beam_urn) = \"beam:requirement:pardo:time_sorted_input:v1\"];\n+\n+    // This requirement indicates the restriction_coder_id field of ParDo\n+    // transform payloads must be inspected.\n+    REQUIRES_SPLITTABLE_DOFN = 4 [(beam_urn) = \"beam:requirement:pardo:splittable_dofn:v1\"];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "17b021624d249dde650980e552f41a6c6fd44994"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxNjE2NA==", "bodyText": "If its unbounded, a runner will never be able to execute it without expansion which requires the runner to at least inspect whether its capable of doing it.", "url": "https://github.com/apache/beam/pull/11162#discussion_r395216164", "createdAt": "2020-03-19T17:56:13Z", "author": {"login": "lukecwik"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -1355,6 +1355,10 @@ message StandardRequirements {\n     // This requirement indicates the requires_time_sorted_input field of ParDo\n     // transform payloads must be inspected.\n     REQUIRES_TIME_SORTED_INPUT = 3 [(beam_urn) = \"beam:requirement:pardo:time_sorted_input:v1\"];\n+\n+    // This requirement indicates the restriction_coder_id field of ParDo\n+    // transform payloads must be inspected.\n+    REQUIRES_SPLITTABLE_DOFN = 4 [(beam_urn) = \"beam:requirement:pardo:splittable_dofn:v1\"];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxMzUyOQ=="}, "originalCommit": {"oid": "17b021624d249dde650980e552f41a6c6fd44994"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI2OTM3Mw==", "bodyText": "Fair point.", "url": "https://github.com/apache/beam/pull/11162#discussion_r395269373", "createdAt": "2020-03-19T19:29:25Z", "author": {"login": "robertwb"}, "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -1355,6 +1355,10 @@ message StandardRequirements {\n     // This requirement indicates the requires_time_sorted_input field of ParDo\n     // transform payloads must be inspected.\n     REQUIRES_TIME_SORTED_INPUT = 3 [(beam_urn) = \"beam:requirement:pardo:time_sorted_input:v1\"];\n+\n+    // This requirement indicates the restriction_coder_id field of ParDo\n+    // transform payloads must be inspected.\n+    REQUIRES_SPLITTABLE_DOFN = 4 [(beam_urn) = \"beam:requirement:pardo:splittable_dofn:v1\"];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxMzUyOQ=="}, "originalCommit": {"oid": "17b021624d249dde650980e552f41a6c6fd44994"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1685, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}