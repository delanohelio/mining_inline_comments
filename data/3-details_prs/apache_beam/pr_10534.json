{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNjQyMjg0", "number": 10534, "title": "Beam-2535: Support timer output timestamps in the flink runner", "bodyText": "Adds the appropriate watermark holds in the flink runner", "createdAt": "2020-01-08T20:33:11Z", "url": "https://github.com/apache/beam/pull/10534", "merged": true, "mergeCommit": {"oid": "dd0b00194cce4efa928f116e301e877db7b6a874"}, "closed": true, "closedAt": "2020-01-22T19:01:01Z", "author": {"login": "reuvenlax"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4t1OSgFqTM0MDY5MTAzNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb85P_BABqjI5NzA5NTU0MDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNjkxMDM3", "url": "https://github.com/apache/beam/pull/10534#pullrequestreview-340691037", "createdAt": "2020-01-09T17:28:05Z", "commit": {"oid": "609c9c45a4038ae4bac7c3409865b54aee948b78"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNzoyODowNlrOFb9xgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNzoyODowNlrOFb9xgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg2Nzk3MA==", "bodyText": "This was the missing piece. Without this, we can't make progress when a timer has fired.", "url": "https://github.com/apache/beam/pull/10534#discussion_r364867970", "createdAt": "2020-01-09T17:28:06Z", "author": {"login": "mxm"}, "path": "runners/flink/src/main/java/org/apache/beam/runners/flink/translation/wrappers/streaming/DoFnOperator.java", "diffHunk": "@@ -1171,6 +1173,8 @@ private void cancelPendingTimerById(String contextTimerId) throws Exception {\n     void cleanupPendingTimer(TimerData timer) {\n       try {\n         pendingTimersById.remove(getContextTimerId(timer.getTimerId(), timer.getNamespace()));\n+        // Always update watermark hold after a timer has been fired or removed\n+        updateWatermarkHold();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "609c9c45a4038ae4bac7c3409865b54aee948b78"}, "originalPosition": 40}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "609c9c45a4038ae4bac7c3409865b54aee948b78", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/609c9c45a4038ae4bac7c3409865b54aee948b78", "committedDate": "2020-01-09T17:23:25Z", "message": "Update timer watermark hold after removing pending timers"}, "afterCommit": {"oid": "657f4f997c0ebf6b1d4db86c6ed1b46333840956", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/657f4f997c0ebf6b1d4db86c6ed1b46333840956", "committedDate": "2020-01-09T19:38:49Z", "message": "fix"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "777d7f1b0d9716ffc44a5fdc425c4357dd5526bf", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/777d7f1b0d9716ffc44a5fdc425c4357dd5526bf", "committedDate": "2020-01-13T04:00:11Z", "message": "Fix issues"}, "afterCommit": {"oid": "2b817d579eb1f319b5e458b7d9f6d8a8ece290ec", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/2b817d579eb1f319b5e458b7d9f6d8a8ece290ec", "committedDate": "2020-01-13T22:58:06Z", "message": "foo"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2b817d579eb1f319b5e458b7d9f6d8a8ece290ec", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/2b817d579eb1f319b5e458b7d9f6d8a8ece290ec", "committedDate": "2020-01-13T22:58:06Z", "message": "foo"}, "afterCommit": {"oid": "fb686f27b211a900ebcee5cd62b34d441d2a5203", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/fb686f27b211a900ebcee5cd62b34d441d2a5203", "committedDate": "2020-01-14T05:53:44Z", "message": "support flink runner"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb686f27b211a900ebcee5cd62b34d441d2a5203", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/fb686f27b211a900ebcee5cd62b34d441d2a5203", "committedDate": "2020-01-14T05:53:44Z", "message": "support flink runner"}, "afterCommit": {"oid": "806be60f549641e7515ee9efc06f3f28fd6174cf", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/806be60f549641e7515ee9efc06f3f28fd6174cf", "committedDate": "2020-01-14T22:14:57Z", "message": "support flink runner"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d58c2e8033de3dacbba1f47d499da6243fc522f", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/5d58c2e8033de3dacbba1f47d499da6243fc522f", "committedDate": "2020-01-15T03:21:26Z", "message": "fix timestamps"}, "afterCommit": {"oid": "df68f73364404e8c059a84c9c6d9249ecf8f90d1", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/df68f73364404e8c059a84c9c6d9249ecf8f90d1", "committedDate": "2020-01-15T18:15:13Z", "message": "Support output timestamps in flink runner."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f1942d92ccf8ae08eb230ecc139600597897568", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/9f1942d92ccf8ae08eb230ecc139600597897568", "committedDate": "2020-01-22T00:34:54Z", "message": "Fix issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec8aa244895d55d0d0c1da0971c2b1696c42632b", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/ec8aa244895d55d0d0c1da0971c2b1696c42632b", "committedDate": "2020-01-22T00:36:10Z", "message": "fix tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6ed644843aaa828bb09cf1e424f4bdd21e3ccfe4", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/6ed644843aaa828bb09cf1e424f4bdd21e3ccfe4", "committedDate": "2020-01-21T23:43:18Z", "message": "fix tests"}, "afterCommit": {"oid": "ec8aa244895d55d0d0c1da0971c2b1696c42632b", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/ec8aa244895d55d0d0c1da0971c2b1696c42632b", "committedDate": "2020-01-22T00:36:10Z", "message": "fix tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2NDY4ODk5", "url": "https://github.com/apache/beam/pull/10534#pullrequestreview-346468899", "createdAt": "2020-01-22T10:05:39Z", "commit": {"oid": "ec8aa244895d55d0d0c1da0971c2b1696c42632b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxMDowNTozOVrOFgWhng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQxMDowNTozOVrOFgWhng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQ2NzgwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private Instant currentOutputTimestamp = null;\n          \n          \n            \n                @Nullable private Instant currentOutputTimestamp;", "url": "https://github.com/apache/beam/pull/10534#discussion_r369467806", "createdAt": "2020-01-22T10:05:39Z", "author": {"login": "mxm"}, "path": "sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnApiDoFnRunner.java", "diffHunk": "@@ -805,6 +805,7 @@ public void tearDown() {\n     private final Instant currentTimestamp;\n     private final Duration allowedLateness;\n     private final WindowedValue<?> currentElementOrTimer;\n+    private Instant currentOutputTimestamp = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ec8aa244895d55d0d0c1da0971c2b1696c42632b"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15ecdc22f33999246d25a820a3cb9b5b93365cbc", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/15ecdc22f33999246d25a820a3cb9b5b93365cbc", "committedDate": "2020-01-22T17:32:19Z", "message": "set nullable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac4dba340601feb387e75edf654cf638f2dee578", "author": {"user": {"login": "reuvenlax", "name": null}}, "url": "https://github.com/apache/beam/commit/ac4dba340601feb387e75edf654cf638f2dee578", "committedDate": "2020-01-22T17:26:59Z", "message": "Update sdks/java/harness/src/main/java/org/apache/beam/fn/harness/FnApiDoFnRunner.java\n\nCo-Authored-By: Maximilian Michels <mxm@apache.org>"}, "afterCommit": {"oid": "15ecdc22f33999246d25a820a3cb9b5b93365cbc", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/15ecdc22f33999246d25a820a3cb9b5b93365cbc", "committedDate": "2020-01-22T17:32:19Z", "message": "set nullable"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3676, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}