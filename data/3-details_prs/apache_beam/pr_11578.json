{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExMzMyMDA1", "number": 11578, "title": "[BEAM-8025] Increase the number of retrials and retrial delay in case of load in CassandraIOTest", "bodyText": "Please add a meaningful description for your change here\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-04-30T10:38:02Z", "url": "https://github.com/apache/beam/pull/11578", "merged": true, "mergeCommit": {"oid": "11de82569af509b08dbb50d555dcb3d4d4f2dd87"}, "closed": true, "closedAt": "2020-05-04T09:42:20Z", "author": {"login": "echauchot"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccqo-mAH2gAyNDExMzMyMDA1OjU2MWIzNjg4Y2Q5NjNjNWM0YmQ2ZmIxMzlmNWJjZjk0YmQyYTQzZTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcd8QC9gFqTQwNDgzOTgxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "561b3688cd963c5c4bd6fb139f5bcf94bd2a43e7", "author": {"user": {"login": "echauchot", "name": "Etienne Chauchot"}}, "url": "https://github.com/apache/beam/commit/561b3688cd963c5c4bd6fb139f5bcf94bd2a43e7", "committedDate": "2020-04-30T10:36:44Z", "message": "[BEAM-8025] Increase the number of retrials en retrial delay in case of load"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MDk3NzI2", "url": "https://github.com/apache/beam/pull/11578#pullrequestreview-404097726", "createdAt": "2020-05-01T10:07:06Z", "commit": {"oid": "561b3688cd963c5c4bd6fb139f5bcf94bd2a43e7"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxMDowNzowNlrOGPGbXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxMDoxMTo0M1rOGPGf5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ4NzEzMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                int tried = 0;\n          \n          \n            \n                Exception exception = null;\n          \n          \n            \n                int tried = 0;", "url": "https://github.com/apache/beam/pull/11578#discussion_r418487133", "createdAt": "2020-05-01T10:07:06Z", "author": {"login": "mxm"}, "path": "sdks/java/io/cassandra/src/test/java/org/apache/beam/sdk/io/cassandra/CassandraIOTest.java", "diffHunk": "@@ -153,18 +153,22 @@ public static void beforeClass() throws Exception {\n \n   private static Cluster buildCluster(CassandraEmbeddedServerBuilder builder) {\n     int tried = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "561b3688cd963c5c4bd6fb139f5bcf94bd2a43e7"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ4NzQwMg==", "bodyText": "I couldn't find that this exception of type RuntimeException is thrown during cluster startup. We may want to catch all Exception here.", "url": "https://github.com/apache/beam/pull/11578#discussion_r418487402", "createdAt": "2020-05-01T10:08:18Z", "author": {"login": "mxm"}, "path": "sdks/java/io/cassandra/src/test/java/org/apache/beam/sdk/io/cassandra/CassandraIOTest.java", "diffHunk": "@@ -153,18 +153,22 @@ public static void beforeClass() throws Exception {\n \n   private static Cluster buildCluster(CassandraEmbeddedServerBuilder builder) {\n     int tried = 0;\n-    while (tried < 3) {\n+    int delay = 5000;\n+    while (tried < 5) {\n       try {\n         return builder.buildNativeCluster();\n       } catch (NoHostAvailableException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "561b3688cd963c5c4bd6fb139f5bcf94bd2a43e7"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ4NzYxMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    tried++;\n          \n          \n            \n                    if (exception == null) {\n          \n          \n            \n                      exception = e;\n          \n          \n            \n                    } else {\n          \n          \n            \n                      exception.addSuppressed(e);\n          \n          \n            \n                    }\n          \n          \n            \n                    tried++;", "url": "https://github.com/apache/beam/pull/11578#discussion_r418487612", "createdAt": "2020-05-01T10:08:57Z", "author": {"login": "mxm"}, "path": "sdks/java/io/cassandra/src/test/java/org/apache/beam/sdk/io/cassandra/CassandraIOTest.java", "diffHunk": "@@ -153,18 +153,22 @@ public static void beforeClass() throws Exception {\n \n   private static Cluster buildCluster(CassandraEmbeddedServerBuilder builder) {\n     int tried = 0;\n-    while (tried < 3) {\n+    int delay = 5000;\n+    while (tried < 5) {\n       try {\n         return builder.buildNativeCluster();\n       } catch (NoHostAvailableException e) {\n         tried++;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "561b3688cd963c5c4bd6fb139f5bcf94bd2a43e7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ4Nzg3MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                throw new RuntimeException(\n          \n          \n            \n                    String.format(\n          \n          \n            \n                        \"Unable to create embedded Cassandra cluster: tried %d times with %d delay\",\n          \n          \n            \n                        tried, delay));\n          \n          \n            \n                throw new RuntimeException(\n          \n          \n            \n                    String.format(\n          \n          \n            \n                        \"Unable to create embedded Cassandra cluster: tried %d times with %d delay\",\n          \n          \n            \n                            tried, delay), \n          \n          \n            \n                        exception);", "url": "https://github.com/apache/beam/pull/11578#discussion_r418487871", "createdAt": "2020-05-01T10:10:03Z", "author": {"login": "mxm"}, "path": "sdks/java/io/cassandra/src/test/java/org/apache/beam/sdk/io/cassandra/CassandraIOTest.java", "diffHunk": "@@ -153,18 +153,22 @@ public static void beforeClass() throws Exception {\n \n   private static Cluster buildCluster(CassandraEmbeddedServerBuilder builder) {\n     int tried = 0;\n-    while (tried < 3) {\n+    int delay = 5000;\n+    while (tried < 5) {\n       try {\n         return builder.buildNativeCluster();\n       } catch (NoHostAvailableException e) {\n         tried++;\n         try {\n-          Thread.sleep(1000L);\n+          Thread.sleep(delay);\n         } catch (InterruptedException e1) {\n         }\n       }\n     }\n-    throw new RuntimeException(\"Unable to create embedded Cassandra cluster\");\n+    throw new RuntimeException(\n+        String.format(\n+            \"Unable to create embedded Cassandra cluster: tried %d times with %d delay\",\n+            tried, delay));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "561b3688cd963c5c4bd6fb139f5bcf94bd2a43e7"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ4ODI5NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    } catch (InterruptedException e1) {\n          \n          \n            \n                    } catch (InterruptedException e1) {\n          \n          \n            \n                      Thread.currentThread().interrupt();\n          \n          \n            \n                      throw new RuntimeException(\"interrupted\");\n          \n          \n            \n                    }", "url": "https://github.com/apache/beam/pull/11578#discussion_r418488295", "createdAt": "2020-05-01T10:11:43Z", "author": {"login": "mxm"}, "path": "sdks/java/io/cassandra/src/test/java/org/apache/beam/sdk/io/cassandra/CassandraIOTest.java", "diffHunk": "@@ -153,18 +153,22 @@ public static void beforeClass() throws Exception {\n \n   private static Cluster buildCluster(CassandraEmbeddedServerBuilder builder) {\n     int tried = 0;\n-    while (tried < 3) {\n+    int delay = 5000;\n+    while (tried < 5) {\n       try {\n         return builder.buildNativeCluster();\n       } catch (NoHostAvailableException e) {\n         tried++;\n         try {\n-          Thread.sleep(1000L);\n+          Thread.sleep(delay);\n         } catch (InterruptedException e1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "561b3688cd963c5c4bd6fb139f5bcf94bd2a43e7"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e93ccd2880728440490c38b90c6d48fcc736d1f", "author": {"user": {"login": "echauchot", "name": "Etienne Chauchot"}}, "url": "https://github.com/apache/beam/commit/0e93ccd2880728440490c38b90c6d48fcc736d1f", "committedDate": "2020-05-04T08:45:46Z", "message": "[BEAM-8025] Trace caught NoHostAvailableException and InterruptedException"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODM5ODE5", "url": "https://github.com/apache/beam/pull/11578#pullrequestreview-404839819", "createdAt": "2020-05-04T09:41:43Z", "commit": {"oid": "0e93ccd2880728440490c38b90c6d48fcc736d1f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4119, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}