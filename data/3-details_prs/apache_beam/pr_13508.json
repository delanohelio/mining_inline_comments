{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0NzUyMzU2", "number": 13508, "title": "Better logging for Python Docker environment", "bodyText": "As we introduce custom containers (mostly for Python), there are a couple of misleading or unclear log messages.\n\n\nPortableRunner currently attempts to pull the container and ignores errors, defaulting to local images. Logging added to make this path clearer.\n\n\nDockerEnvironment.default_docker_image can be called even if we don't use the default image - currently this outputs a message saying Using default image \"...\" which is very confusing. I edited to make sure it's clearer when we are using provided container image vs default container image.\n\n\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-12-08T22:00:27Z", "url": "https://github.com/apache/beam/pull/13508", "merged": true, "mergeCommit": {"oid": "adf55159b1810719688bffca3d0fadb4176685ad"}, "closed": true, "closedAt": "2020-12-09T19:47:26Z", "author": {"login": "emilymye"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkRcuMAH2gAyNTM0NzUyMzU2OmQzNWUxYWExNzMwMWI3ODEzYTNjNDllN2Q0OTcxMGY3ZTI0NzhiNTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkpzQSAFqTU0ODc2OTAzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d35e1aa17301b7813a3c49e7d49710f7e2478b59", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/d35e1aa17301b7813a3c49e7d49710f7e2478b59", "committedDate": "2020-12-08T21:58:16Z", "message": "better logging for py Docker environment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3Njc0NzE4", "url": "https://github.com/apache/beam/pull/13508#pullrequestreview-547674718", "createdAt": "2020-12-08T22:10:10Z", "commit": {"oid": "d35e1aa17301b7813a3c49e7d49710f7e2478b59"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "306b77c3082debf81e671fa4f35ee3c9fdba2227", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/306b77c3082debf81e671fa4f35ee3c9fdba2227", "committedDate": "2020-12-08T22:11:38Z", "message": "format"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3Njc3MTg4", "url": "https://github.com/apache/beam/pull/13508#pullrequestreview-547677188", "createdAt": "2020-12-08T22:14:08Z", "commit": {"oid": "306b77c3082debf81e671fa4f35ee3c9fdba2227"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMjoxNDowOFrOIB4omg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQyMjoxNDowOFrOIB4omg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODg0NzM4Ng==", "bodyText": "This would be a good place to tell the user how to provide an image if they want to.", "url": "https://github.com/apache/beam/pull/13508#discussion_r538847386", "createdAt": "2020-12-08T22:14:08Z", "author": {"login": "ibzib"}, "path": "sdks/python/apache_beam/transforms/environments.py", "diffHunk": "@@ -240,15 +240,16 @@ def __init__(\n     super(DockerEnvironment, self).__init__(capabilities, artifacts)\n     if container_image:\n       logging.info(\n-        'Using provided Python SDK container image: %s' % (container_image))\n+          'Using provided Python SDK container image: %s' % (container_image))\n       self.container_image = container_image\n     else:\n-      logging.info('No image given - inferring default Python SDK container image')\n+      logging.info(\n+          'No image given - inferring default Python SDK container image')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "306b77c3082debf81e671fa4f35ee3c9fdba2227"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae61d7e035430ebd7d0a069ce272cdca0cbf7e3d", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/ae61d7e035430ebd7d0a069ce272cdca0cbf7e3d", "committedDate": "2020-12-08T22:43:06Z", "message": "add name of parameter to DockerEnvironment logging message"}, "afterCommit": {"oid": "306b77c3082debf81e671fa4f35ee3c9fdba2227", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/306b77c3082debf81e671fa4f35ee3c9fdba2227", "committedDate": "2020-12-08T22:11:38Z", "message": "format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d2ac88eb6906d9dd8fe21a61cd7737aaf3bed11", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/9d2ac88eb6906d9dd8fe21a61cd7737aaf3bed11", "committedDate": "2020-12-08T22:46:12Z", "message": "fix message"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "447a4bb3021382bdaee553cfcffc673a6f52ec82", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/447a4bb3021382bdaee553cfcffc673a6f52ec82", "committedDate": "2020-12-08T22:45:49Z", "message": "fix message"}, "afterCommit": {"oid": "9d2ac88eb6906d9dd8fe21a61cd7737aaf3bed11", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/9d2ac88eb6906d9dd8fe21a61cd7737aaf3bed11", "committedDate": "2020-12-08T22:46:12Z", "message": "fix message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4MzUxMDE1", "url": "https://github.com/apache/beam/pull/13508#pullrequestreview-548351015", "createdAt": "2020-12-09T16:14:17Z", "commit": {"oid": "9d2ac88eb6906d9dd8fe21a61cd7737aaf3bed11"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37db67c9467e29e9487b7a061e05a6ebc4f9308e", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/37db67c9467e29e9487b7a061e05a6ebc4f9308e", "committedDate": "2020-12-09T18:57:53Z", "message": "fix message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "102cb71a83a6f0d7a8564970a7c4f14307945038", "author": {"user": {"login": "emilymye", "name": "emily"}}, "url": "https://github.com/apache/beam/commit/102cb71a83a6f0d7a8564970a7c4f14307945038", "committedDate": "2020-12-09T19:03:39Z", "message": "fmt"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4NzY5MDMx", "url": "https://github.com/apache/beam/pull/13508#pullrequestreview-548769031", "createdAt": "2020-12-10T02:20:36Z", "commit": {"oid": "102cb71a83a6f0d7a8564970a7c4f14307945038"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwMjoyMDozNlrOICyZcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwMjoyMDozNlrOICyZcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTc5Mzc3OA==", "bodyText": "thanks for fixing this!", "url": "https://github.com/apache/beam/pull/13508#discussion_r539793778", "createdAt": "2020-12-10T02:20:36Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/apache_beam/transforms/environments.py", "diffHunk": "@@ -312,9 +319,7 @@ def default_docker_image():\n     image = (\n         'apache/beam_python{version_suffix}_sdk:{tag}'.format(\n             version_suffix=version_suffix, tag=sdk_version))\n-    logging.info(\n-        'Using Python SDK docker image: %s. If the image is not '\n-        'available at local, we will try to pull from hub.docker.com' % (image))\n+    logging.info('Default Python SDK image for environment is %s' % (image))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "102cb71a83a6f0d7a8564970a7c4f14307945038"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4372, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}