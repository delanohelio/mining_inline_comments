{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5ODYzMTQ0", "number": 12626, "title": "[BEAM-10545] Added the inspector of PCollections and pipelines", "bodyText": "Added the InteractiveInspector component and its sub components. The\nhierarchy can be found in the code documentation.\nThe component allows listing all user defined pipelines and\nPCollections in the kernel of the current notebook session,\ndisplaying pipeline graphs, and visualizing PCollection data.\n\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n \n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-08-19T01:04:27Z", "url": "https://github.com/apache/beam/pull/12626", "merged": true, "mergeCommit": {"oid": "cfe172f10701ebf61d355b16b0f423140ad859d3"}, "closed": true, "closedAt": "2020-09-02T18:54:07Z", "author": {"login": "KevinGG"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdARE-FgBqjM2Njg2NjAyNTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEY9AEgBqjM3MTE1ODg3OTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c714895e0649866a26c7beda4304bd034e24be58", "author": {"user": {"login": "KevinGG", "name": "Ning Kang"}}, "url": "https://github.com/apache/beam/commit/c714895e0649866a26c7beda4304bd034e24be58", "committedDate": "2020-08-19T00:52:59Z", "message": "[BEAM-10545] Added the inspector of PCollections and pipelines\n\n1. Added the InteractiveInspector component and its sub components. The\n   hierarchy can be found in the code documentation.\n2. The component allows listing all user defined pipelines and\n   PCollections in the kernel of the current notebook session,\n   displaying pipeline graphs, and visualizing PCollection data."}, "afterCommit": {"oid": "a52a2fa0373da56ed2a373680a90484ee8abd0b5", "author": {"user": {"login": "KevinGG", "name": "Ning Kang"}}, "url": "https://github.com/apache/beam/commit/a52a2fa0373da56ed2a373680a90484ee8abd0b5", "committedDate": "2020-08-19T01:10:23Z", "message": "[BEAM-10545] Added the inspector of PCollections and pipelines\n\n1. Added the InteractiveInspector component and its sub components. The\n   hierarchy can be found in the code documentation.\n2. The component allows listing all user defined pipelines and\n   PCollections in the kernel of the current notebook session,\n   displaying pipeline graphs, and visualizing PCollection data."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTQ5OTE0", "url": "https://github.com/apache/beam/pull/12626#pullrequestreview-473549914", "createdAt": "2020-08-24T14:35:04Z", "commit": {"oid": "a52a2fa0373da56ed2a373680a90484ee8abd0b5"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDozNTowNFrOHFn3iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDozNjo1NlrOHFn8tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY1ODEyMw==", "bodyText": "Just a nit, but you could probably move this and the onClick function out to private methods to make the logical separation a bit more readable. Or, since there is no state to this component, you could write it as a pure functional component that accepts props and returns the React node.", "url": "https://github.com/apache/beam/pull/12626#discussion_r475658123", "createdAt": "2020-08-24T14:35:04Z", "author": {"login": "prodonjs"}, "path": "sdks/python/apache_beam/runners/interactive/extensions/apache-beam-jupyterlab-sidepanel/src/inspector/InspectableList.tsx", "diffHunk": "@@ -0,0 +1,99 @@\n+// Licensed under the Apache License, Version 2.0 (the 'License'); you may not\n+// use this file except in compliance with the License. You may obtain a copy of\n+// the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an 'AS IS' BASIS, WITHOUT\n+// WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+// License for the specific language governing permissions and limitations under\n+// the License.\n+\n+import * as React from 'react';\n+\n+import { CollapsibleList, SimpleListItem, ListDivider } from '@rmwc/list';\n+\n+import { InspectableListItem } from './InspectableListItem';\n+import { InspectableViewModel } from './InspectableViewModel';\n+\n+import '@rmwc/list/styles';\n+\n+export interface IInspectableMeta {\n+  name: string;\n+  // The id() value of the inspectable item in the kernel.\n+  inMemoryId: number;\n+  type: string;\n+}\n+\n+interface IKeyedInspectableMeta {\n+  [key: string]: IInspectableMeta;\n+}\n+\n+interface IInspectableListProps {\n+  inspectableViewModel?: InspectableViewModel;\n+  id: string;\n+  metadata: IInspectableMeta;\n+  pcolls: IKeyedInspectableMeta;\n+}\n+\n+/**\n+ * The PCollection sub list of the side list of the InteractiveInspector parent\n+ * component.\n+ *\n+ * Each sub list only contains listing of PCollections for one pipeline.\n+ *\n+ * The pipeline item functions as a header of the collapsible sub list. It\n+ * alters the shared inspectableViewModel of the display area on click to query\n+ * and display a graph that is the DOT representation of the pipeline.\n+ */\n+export class InspectableList extends React.Component<\n+  IInspectableListProps,\n+  {}\n+> {\n+  constructor(props: IInspectableListProps) {\n+    super(props);\n+  }\n+\n+  render(): React.ReactNode {\n+    const pcollListItems = Object.entries(this.props.pcolls).map(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a52a2fa0373da56ed2a373680a90484ee8abd0b5"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY1OTQ0Ng==", "bodyText": "nit you can reduce the nesting level for the pcollection case if you put put the inverse condition first and short-circuit the return for the empty span.", "url": "https://github.com/apache/beam/pull/12626#discussion_r475659446", "createdAt": "2020-08-24T14:36:56Z", "author": {"login": "prodonjs"}, "path": "sdks/python/apache_beam/runners/interactive/extensions/apache-beam-jupyterlab-sidepanel/src/inspector/InspectableView.tsx", "diffHunk": "@@ -0,0 +1,128 @@\n+// Licensed under the Apache License, Version 2.0 (the 'License'); you may not\n+// use this file except in compliance with the License. You may obtain a copy of\n+// the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an 'AS IS' BASIS, WITHOUT\n+// WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+// License for the specific language governing permissions and limitations under\n+// the License.\n+\n+import * as React from 'react';\n+\n+import { Checkbox } from '@rmwc/checkbox';\n+\n+import {\n+  InspectableViewModel,\n+  IOptions,\n+  IShowOptions\n+} from './InspectableViewModel';\n+import { HtmlView } from '../common/HtmlView';\n+import { IHtmlProvider } from '../common/HtmlView';\n+\n+import '@rmwc/checkbox/styles';\n+\n+interface IInspectableViewProps {\n+  model: InspectableViewModel;\n+}\n+\n+interface IInspectableViewState {\n+  inspectableType: string;\n+  // options used in kernel messaging.\n+  options: IOptions;\n+}\n+\n+/**\n+ * The display area of the InteractiveInspector parent component.\n+ *\n+ * The react component is composed with a top checkbox section of display\n+ * options and a main HtmlView area that displays HTML from IOPub messaging of\n+ * its kernel model.\n+ */\n+export class InspectableView extends React.Component<\n+  IInspectableViewProps,\n+  IInspectableViewState\n+> {\n+  constructor(props: IInspectableViewProps) {\n+    super(props);\n+    this.state = {\n+      inspectableType: 'pipeline',\n+      options: props.model.options\n+    };\n+  }\n+\n+  componentDidMount(): void {\n+    this._updateRenderTimerId = setInterval(() => this.updateRender(), 1500);\n+  }\n+\n+  componentWillUnmount(): void {\n+    clearInterval(this._updateRenderTimerId);\n+  }\n+\n+  updateRender(): void {\n+    if (this.props.model.inspectableType === 'pcollection') {\n+      this.setState({\n+        inspectableType: 'pcollection',\n+        options: this._buildShowOptions(this.props.model.options)\n+      });\n+    } else {\n+      this.setState({\n+        inspectableType: 'pipeline',\n+        options: {}\n+      });\n+    }\n+  }\n+\n+  renderOptions(): React.ReactNode {\n+    if (this.props.model.inspectableType === 'pcollection') {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a52a2fa0373da56ed2a373680a90484ee8abd0b5"}, "originalPosition": 79}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3MDE1ODU1", "url": "https://github.com/apache/beam/pull/12626#pullrequestreview-477015855", "createdAt": "2020-08-27T19:25:22Z", "commit": {"oid": "18b1dc5dbaa28743ba8632a67459dd9ef0a909a9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b440b91ddb113dd0a00021bddda1eb4312d450d", "author": {"user": {"login": "KevinGG", "name": "Ning Kang"}}, "url": "https://github.com/apache/beam/commit/7b440b91ddb113dd0a00021bddda1eb4312d450d", "committedDate": "2020-08-31T20:37:02Z", "message": "[BEAM-10545] Added the inspector of PCollections and pipelines\n\n1. Added the InteractiveInspector component and its sub components. The\n   hierarchy can be found in the code documentation.\n2. The component allows listing all user defined pipelines and\n   PCollections in the kernel of the current notebook session,\n   displaying pipeline graphs, and visualizing PCollection data."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a49ae35a56cb7bc44dc2b4a457393b9136814e6e", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/a49ae35a56cb7bc44dc2b4a457393b9136814e6e", "committedDate": "2020-08-31T20:37:02Z", "message": "Simplified some of the code based on comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc3144d54c1f2adcc4f71520d5c1468a4a48e735", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/dc3144d54c1f2adcc4f71520d5c1468a4a48e735", "committedDate": "2020-08-31T20:37:02Z", "message": "Fixed lint issues."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18b1dc5dbaa28743ba8632a67459dd9ef0a909a9", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/18b1dc5dbaa28743ba8632a67459dd9ef0a909a9", "committedDate": "2020-08-27T19:05:55Z", "message": "Fixed lint issues."}, "afterCommit": {"oid": "dc3144d54c1f2adcc4f71520d5c1468a4a48e735", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/dc3144d54c1f2adcc4f71520d5c1468a4a48e735", "committedDate": "2020-08-31T20:37:02Z", "message": "Fixed lint issues."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4784, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}