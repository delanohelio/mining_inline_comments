{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0Mzc3MDAw", "number": 12695, "title": "[BEAM-8758] Google-cloud-spanner upgrade to 1.59.0 and google_cloud_bigtable_client_core to 1.16.0", "bodyText": "Fixes https://issues.apache.org/jira/browse/BEAM-8758\nR: @chamikaramj\nCC: @suztomo\nThe changes are:\n\nThe main purpose of this commit is upgrading spanner library to 1.59.0, but to upgrade it, I need to also upgrade bigtable_client_core to 1.16.0 and other dependencies;\nUpdate spanner type parser to be able to recognize NUMERIC.\n\nNote:\n\nI have run \"/bin/bash sdks/java/build-tools/beam-linkage-check.sh\" and confirmed that there is no linkage errors.\nI have run presubmit job and passed.\n./gradlew spotlessApply && ./gradlew checkstyleMain checkstyleTest javadoc spotbugsMain compileJava compileTestJava\n\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-08-27T00:38:30Z", "url": "https://github.com/apache/beam/pull/12695", "merged": true, "mergeCommit": {"oid": "39f37ee8610512b5807db8cd1b77414008ffae08"}, "closed": true, "closedAt": "2020-09-10T16:27:24Z", "author": {"login": "terryxian78"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6Gnq3gH2gAyNDc0Mzc3MDAwOjAwYmZkYzY2MmQyYzBmNWNhYTM5ZWJlMmJjNWFiMDFkOTM4YzU1MjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHT04sAFqTQ4NTQ0MzAwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "00bfdc662d2c0f5caa39ebe2bc5ab01d938c5523", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/00bfdc662d2c0f5caa39ebe2bc5ab01d938c5523", "committedDate": "2020-07-30T21:36:27Z", "message": "Upgrade cloud spanner version to 1.59.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cec6e6dd13e8220a8ff95b671f522be9a557a957", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/cec6e6dd13e8220a8ff95b671f522be9a557a957", "committedDate": "2020-07-30T22:22:02Z", "message": "Upgrade gax_version to 1.57.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5126f1898a59511d80d71250da4a8d9799a74a10", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/5126f1898a59511d80d71250da4a8d9799a74a10", "committedDate": "2020-07-30T23:44:45Z", "message": "Upgrade google_cloud_core_version and google_cloud_bigtable_client_core"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "597f6a992d5d33754ce468eb25200c56a003c7fa", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/597f6a992d5d33754ce468eb25200c56a003c7fa", "committedDate": "2020-07-31T17:50:37Z", "message": "Bump gax_httpjson to 0.74.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "899fa27b9c2037005d85c25a6622146531327b63", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/899fa27b9c2037005d85c25a6622146531327b63", "committedDate": "2020-07-31T19:42:11Z", "message": "Bump com.google.cloud:google-cloud-core-http to 1.93.7"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d884c5feb851d22d8f5e181e1c91c1a5a324f22c", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/d884c5feb851d22d8f5e181e1c91c1a5a324f22c", "committedDate": "2020-08-01T14:58:56Z", "message": "Revert version bump of google-cloud-core-http"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb74fb7836dafadbf6d741078b52ce2d07a056b", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/9eb74fb7836dafadbf6d741078b52ce2d07a056b", "committedDate": "2020-08-01T15:00:58Z", "message": "Revert \"Bump gax_httpjson to 0.74.1\"\n\nThis reverts commit 597f6a99"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41c14ba96ebcad3d00f60810a99f19af725abfc7", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/41c14ba96ebcad3d00f60810a99f19af725abfc7", "committedDate": "2020-08-01T15:21:34Z", "message": "Update bigtable-client-core to 1.14.1 (released version)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b419e509609e0db4dea494b51ca1bd6017a3da4a", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/b419e509609e0db4dea494b51ca1bd6017a3da4a", "committedDate": "2020-08-01T16:30:22Z", "message": "Update bigtable-client-core to 1.15.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5960b772c775ff5eea48d7b105a741ef889f0d95", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/5960b772c775ff5eea48d7b105a741ef889f0d95", "committedDate": "2020-08-06T06:34:56Z", "message": "Bump google_cloud_bigtable_client_core to 1.15.1 (local build)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c52d9b8edc98a78c3756649238e16c588b2e5163", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/c52d9b8edc98a78c3756649238e16c588b2e5163", "committedDate": "2020-08-06T07:08:00Z", "message": "Add local maven repo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17b67ae51d3a54285457bbfa08e67d5b250a3f6c", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/17b67ae51d3a54285457bbfa08e67d5b250a3f6c", "committedDate": "2020-08-06T07:13:16Z", "message": "Revert \"Add local maven repo\"\n\nThis reverts commit c52d9b8e"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8113cebdfb5cd2d1a9092a143e6bc377571801c6", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/8113cebdfb5cd2d1a9092a143e6bc377571801c6", "committedDate": "2020-08-06T07:14:37Z", "message": "Add local maven repo again"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9154a8fafaa968ebaece9ca949029051e1a256d", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/f9154a8fafaa968ebaece9ca949029051e1a256d", "committedDate": "2020-08-06T07:19:03Z", "message": "Update bigtable-client-core to 1.15.1-SNAPSHOT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52cea2c27641d28639b373bf68da332a777a39e3", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/52cea2c27641d28639b373bf68da332a777a39e3", "committedDate": "2020-08-25T23:23:16Z", "message": "Update bigtable-client-core to 1.16.0,\nalso update SpannerSchema to be able to parse NUMERIC type."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "260fe6f0dc86bbb24bd08e85ecbec88598454de2", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/260fe6f0dc86bbb24bd08e85ecbec88598454de2", "committedDate": "2020-08-26T19:36:14Z", "message": "Revert change of adding mavenLocal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bfd4785d2bf5affb53d0058cc6be5a0b16d593c", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/1bfd4785d2bf5affb53d0058cc6be5a0b16d593c", "committedDate": "2020-08-28T00:04:01Z", "message": "Fix test failure of GcpApiSurfaceTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3OTExMzA2", "url": "https://github.com/apache/beam/pull/12695#pullrequestreview-477911306", "createdAt": "2020-08-28T17:36:34Z", "commit": {"oid": "1bfd4785d2bf5affb53d0058cc6be5a0b16d593c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNzozNjozNFrOHJPBiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxNzozOTowNVrOHJPF5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ0NTM4Nw==", "bodyText": "@terryxian78 Is this new?", "url": "https://github.com/apache/beam/pull/12695#discussion_r479445387", "createdAt": "2020-08-28T17:36:34Z", "author": {"login": "suztomo"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/spanner/SpannerSchema.java", "diffHunk": "@@ -169,7 +169,9 @@ private static Type parseSpannerType(String spannerType) {\n       if (\"DATE\".equals(spannerType)) {\n         return Type.date();\n       }\n-\n+      if (\"NUMERIC\".equals(spannerType)) {\n+        return Type.numeric();\n+      }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1bfd4785d2bf5affb53d0058cc6be5a0b16d593c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ0NjUwMA==", "bodyText": "You may want to be more specific here. This includes all the classes in Guava's collection, ImmutableList, ImmutableSet, etc. I believe Beam team has intentionally avoided the classes to be exposed as APIs.", "url": "https://github.com/apache/beam/pull/12695#discussion_r479446500", "createdAt": "2020-08-28T17:39:05Z", "author": {"login": "suztomo"}, "path": "sdks/java/io/google-cloud-platform/src/test/java/org/apache/beam/sdk/io/gcp/GcpApiSurfaceTest.java", "diffHunk": "@@ -65,11 +65,13 @@ public void testGcpApiSurface() throws Exception {\n             classesInPackage(\"com.google.bigtable.v2\"),\n             classesInPackage(\"com.google.cloud.bigquery.storage.v1beta1\"),\n             classesInPackage(\"com.google.cloud.bigtable.config\"),\n+            classesInPackage(\"com.google.common.collect\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1bfd4785d2bf5affb53d0058cc6be5a0b16d593c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d26c522625ecca0c1b2027d6494eafa1f89e40e", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/6d26c522625ecca0c1b2027d6494eafa1f89e40e", "committedDate": "2020-08-31T19:16:36Z", "message": "Speficically call out exposed classes (instead of an entire package) in GcpApiSurfaceTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4OTgzMDk2", "url": "https://github.com/apache/beam/pull/12695#pullrequestreview-478983096", "createdAt": "2020-08-31T21:57:36Z", "commit": {"oid": "6d26c522625ecca0c1b2027d6494eafa1f89e40e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4OTk3NzU0", "url": "https://github.com/apache/beam/pull/12695#pullrequestreview-478997754", "createdAt": "2020-08-31T22:17:44Z", "commit": {"oid": "6d26c522625ecca0c1b2027d6494eafa1f89e40e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5MDEwMjM3", "url": "https://github.com/apache/beam/pull/12695#pullrequestreview-479010237", "createdAt": "2020-08-31T22:24:45Z", "commit": {"oid": "6d26c522625ecca0c1b2027d6494eafa1f89e40e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTM3MTA4", "url": "https://github.com/apache/beam/pull/12695#pullrequestreview-480137108", "createdAt": "2020-09-01T21:40:26Z", "commit": {"oid": "6d26c522625ecca0c1b2027d6494eafa1f89e40e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwMTQxNjgx", "url": "https://github.com/apache/beam/pull/12695#pullrequestreview-480141681", "createdAt": "2020-09-01T21:49:09Z", "commit": {"oid": "6d26c522625ecca0c1b2027d6494eafa1f89e40e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4efc91b56d682bfc90a279b0652015226f973310", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/4efc91b56d682bfc90a279b0652015226f973310", "committedDate": "2020-09-01T22:44:59Z", "message": "Revert change of SpannerSchema and will make it a separate PR."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a81c5a36485cc4838aa3fd5d563f86c009fde70b", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/a81c5a36485cc4838aa3fd5d563f86c009fde70b", "committedDate": "2020-09-01T22:49:47Z", "message": "Add a separate blank line."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1c6846f1bcc15207927aa704a8091b768003c1a", "author": {"user": {"login": "terryxian78", "name": null}}, "url": "https://github.com/apache/beam/commit/f1c6846f1bcc15207927aa704a8091b768003c1a", "committedDate": "2020-09-08T16:45:21Z", "message": "Add TODO in GcpApiSurfaceTest: TODO: remove newly-exposed clasess once spanner updates its APIs."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1NDQzMDAw", "url": "https://github.com/apache/beam/pull/12695#pullrequestreview-485443000", "createdAt": "2020-09-09T22:20:40Z", "commit": {"oid": "f1c6846f1bcc15207927aa704a8091b768003c1a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4939, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}