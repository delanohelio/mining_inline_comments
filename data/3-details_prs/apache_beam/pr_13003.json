{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MDgyMDI2", "number": 13003, "title": "[BEAM-10992] Add @SchemaCaseFormat annotation", "bodyText": "Adds an @SchemaCaseFormat annotation that can be used to control the case format used in schema field names. For example:\n@DefaultSchema(JavaFieldSchema.class)\n@SchemaCaseFormat(CaseFormat.LOWER_UNDERSCORE)\nclass MyClass {\n   public String user;\n   public int ageInYears;\n   @SchemaCaseFormat(CaseFormat.UPPER_CAMEL)\n   public boolean knowsJavascript;\n}\nWill produce a schema with fields \"user\", \"age_in_years\", and \"KnowsJavascript\".\nI think the primary application of this will be using lower_underscore for schemas that will be used across languages (e.g. in LogicalType base types, and cross-language transform configuration objects), but I figured a general purpose solution based on CaseFormat would be more valuable.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-10-02T18:58:36Z", "url": "https://github.com/apache/beam/pull/13003", "merged": true, "mergeCommit": {"oid": "47a602295fe14db469116d329d7965d2fc78acd7"}, "closed": true, "closedAt": "2020-11-13T22:02:42Z", "author": {"login": "TheNeuralBit"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOqQhXAH2gAyNDk3MDgyMDI2OjhlNzBjZjY2OTg1MjIxMjc0NTA2MTFlN2M3ODkyMDE1ZTA3NGI2ZjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcMZiQAH2gAyNDk3MDgyMDI2OmE2Y2Q4NGM1MWVmNWY0NjA2NjI0NmRhMjkwNTE5NjJjOTAxNWEyZTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8e70cf6698522127450611e7c7892015e074b6f0", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/8e70cf6698522127450611e7c7892015e074b6f0", "committedDate": "2020-10-02T18:26:14Z", "message": "More helpful error when we can't find a way to construct a POJO"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9fe3f8f48d5507142b26d73fcc592b6e392a819", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/d9fe3f8f48d5507142b26d73fcc592b6e392a819", "committedDate": "2020-10-02T18:26:14Z", "message": "More helpful error when we can't construct a Java Bean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17c9d4920ec5627ffedce97679bb978a528f8d7e", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/17c9d4920ec5627ffedce97679bb978a528f8d7e", "committedDate": "2020-10-02T19:01:09Z", "message": "Add @SchemaCaseFormat, test with AutoValue beans and POJOs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "01e9d67d918aaa06ba87ca48bfbcd20d616ac9fb", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/01e9d67d918aaa06ba87ca48bfbcd20d616ac9fb", "committedDate": "2020-10-02T18:47:12Z", "message": "Add @SchemaCaseFormat, test with AutoValue beans and POJOs"}, "afterCommit": {"oid": "17c9d4920ec5627ffedce97679bb978a528f8d7e", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/17c9d4920ec5627ffedce97679bb978a528f8d7e", "committedDate": "2020-10-02T19:01:09Z", "message": "Add @SchemaCaseFormat, test with AutoValue beans and POJOs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMzg2MjYx", "url": "https://github.com/apache/beam/pull/13003#pullrequestreview-501386261", "createdAt": "2020-10-02T19:14:44Z", "commit": {"oid": "17c9d4920ec5627ffedce97679bb978a528f8d7e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxOToxNDo0NFrOHb421A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxOToxNDo0NFrOHb421A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTAwNTE0MA==", "bodyText": "I hate inheritance but I have to ask: what happens with\n@SchemaCaseFormat(A)\nclass Parent {\n  ... fields ...\n}\n\n@SchemaCaseFormat(B)\nclass Child extends Parent { }\nI'm honestly not sure what should happen. I think in your case anything not overridden will get case format A. That seems right but just want to highlight it.", "url": "https://github.com/apache/beam/pull/13003#discussion_r499005140", "createdAt": "2020-10-02T19:14:44Z", "author": {"login": "kennknowles"}, "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/schemas/FieldValueTypeInformation.java", "diffHunk": "@@ -118,6 +123,29 @@ public static FieldValueTypeInformation forField(Field field) {\n         .build();\n   }\n \n+  public static <T extends AnnotatedElement & Member> String getNameOverride(\n+      String original, T member) {\n+    SchemaFieldName fieldName = member.getAnnotation(SchemaFieldName.class);\n+    SchemaCaseFormat caseFormatAnnotation = member.getAnnotation(SchemaCaseFormat.class);\n+    SchemaCaseFormat classCaseFormatAnnotation =\n+        member.getDeclaringClass().getAnnotation(SchemaCaseFormat.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "17c9d4920ec5627ffedce97679bb978a528f8d7e"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjM4ODA0", "url": "https://github.com/apache/beam/pull/13003#pullrequestreview-502238804", "createdAt": "2020-10-05T16:45:49Z", "commit": {"oid": "17c9d4920ec5627ffedce97679bb978a528f8d7e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6cd84c51ef5f46066246da29051962c9015a2e9", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/a6cd84c51ef5f46066246da29051962c9015a2e9", "committedDate": "2020-11-13T19:33:52Z", "message": "lint"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2257, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}