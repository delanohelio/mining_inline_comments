{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0MDg0ODMx", "number": 12811, "title": "[BEAM-10705] Fixes a bug when passing whl files in --sdk_location from https locations", "bodyText": "The fix does the following:\n\nIt extracts and uses the filename when downloading a remote wheel file (http, https) specified in --sdk_location at the staging phase.\nIt refactored the test_sdk_location_remote_wheel as the initial unittest didn't cover well the remote wheel case\n\nCC: @tvalentyn\nFixes when the --sdk_location\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n[ x ] Choose reviewer(s) and mention them in a comment (R: @username).\n[ x ] Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n[  ] Update CHANGES.md with noteworthy changes.\n[ NA ] If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-09-10T16:37:18Z", "url": "https://github.com/apache/beam/pull/12811", "merged": true, "mergeCommit": {"oid": "75ee51a76daf8bac73d4072fc0147677ec2c8f4f"}, "closed": true, "closedAt": "2020-09-15T17:08:34Z", "author": {"login": "samatix"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHjU1EAH2gAyNDg0MDg0ODMxOjQ4MjhiMzEwNTBhYzMzNTZkMTZhMDcyMjcxNTFhMzcwMzg1YWJmM2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJK8GbgFqTQ4ODg5MDA5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4828b31050ac3356d16a07227151a370385abf3b", "author": {"user": {"login": "samatix", "name": "Ayoub ENNASSIRI"}}, "url": "https://github.com/apache/beam/commit/4828b31050ac3356d16a07227151a370385abf3b", "committedDate": "2020-09-10T16:24:08Z", "message": "[BEAM-10705] Extracting and using the filename when downloading a remote wheel file (http, https) specified in --sdk_location at the staging phase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f5464f2c09858add5999b59e33d029aeae9b0a5", "author": {"user": {"login": "samatix", "name": "Ayoub ENNASSIRI"}}, "url": "https://github.com/apache/beam/commit/6f5464f2c09858add5999b59e33d029aeae9b0a5", "committedDate": "2020-09-13T13:55:26Z", "message": "Using from future.moves.urllib.parse import urlparse instead of urlllib.parse for python2.7 compatibility (the same library in other python sdk files)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "238cd3ad7136f9859d0c46db3ad7201f60fea2bb", "author": {"user": {"login": "samatix", "name": "Ayoub ENNASSIRI"}}, "url": "https://github.com/apache/beam/commit/238cd3ad7136f9859d0c46db3ad7201f60fea2bb", "committedDate": "2020-09-14T17:26:52Z", "message": "Correcting formatting issue in stager_test file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a99c520091e18ce485a2ad010c0cf0281347ecaa", "author": {"user": {"login": "samatix", "name": "Ayoub ENNASSIRI"}}, "url": "https://github.com/apache/beam/commit/a99c520091e18ce485a2ad010c0cf0281347ecaa", "committedDate": "2020-09-14T17:51:11Z", "message": "Correcting formatting issue in stager.py"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODkwMDk1", "url": "https://github.com/apache/beam/pull/12811#pullrequestreview-488890095", "createdAt": "2020-09-15T17:06:25Z", "commit": {"oid": "238cd3ad7136f9859d0c46db3ad7201f60fea2bb"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzowNjoyNVrOHSLgaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNzowNjoyNVrOHSLgaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyNDkzOQ==", "bodyText": "Nit: implicit line joining (with parenthesis instead of backslash)  is preferable by PIP8. Since Beam does not officially use PIP8, I will merge as is, just FYI.", "url": "https://github.com/apache/beam/pull/12811#discussion_r488824939", "createdAt": "2020-09-15T17:06:25Z", "author": {"login": "tvalentyn"}, "path": "sdks/python/apache_beam/runners/portability/stager_test.py", "diffHunk": "@@ -448,7 +448,8 @@ def test_sdk_location_remote_source_file(self, *unused_mocks):\n   def test_sdk_location_remote_wheel_file(self, *unused_mocks):\n     staging_dir = self.make_temp_dir()\n     sdk_filename = 'apache_beam-1.0.0-cp27-cp27mu-manylinux1_x86_64.whl'\n-    sdk_location = 'https://storage.googleapis.com/my-gcs-bucket/' + sdk_filename\n+    sdk_location = 'https://storage.googleapis.com/my-gcs-bucket/' + \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "238cd3ad7136f9859d0c46db3ad7201f60fea2bb"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2648, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}