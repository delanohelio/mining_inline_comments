{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1MTU5MTM1", "number": 10860, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNVQwMjoxOTozM1rODgDyKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOToyNzo0NlrODg0uAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0OTQzMDE3OnYy", "diffSide": "RIGHT", "path": "CHANGES.md", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNVQwMjoxOTozM1rOFqHtEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOTo0NzowNlrOFrQDfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTcxMDczNw==", "bodyText": "Are you sure, that we would like to change the default in the first release of the change?", "url": "https://github.com/apache/beam/pull/10860#discussion_r379710737", "createdAt": "2020-02-15T02:19:33Z", "author": {"login": "aaltay"}, "path": "CHANGES.md", "diffHunk": "@@ -36,6 +36,7 @@\n \n * ReadFromPubSub(topic=<topic>) in Python previously created a subscription under the same project as the topic. Now it will create the subscription under the project specified in pipeline_options. If the project is not specified in pipeline_options, then it will create the subscription under the same project as the topic. ([BEAM-3453](https://issues.apache.org/jira/browse/BEAM-3453)).\n * SpannerAccessor in Java is now package-private to reduce API surface. `SpannerConfig.connectToSpanner` has been moved to `SpannerAccessor.create`. ([BEAM-9310](https://issues.apache.org/jira/browse/BEAM-9310)).\n+* PCollections will now have their tags correctly propagated through the Pipeline. Users may expect the old implementation which gave PCollection output ids a monotonically increasing id. To go back to the old implementation, use the \"force_generated_pcollection_output_ids\" experiment. The default is the new implementation (force_generated_pcollection_output_ids=False).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d43d8522b29d73cf140be8a9b1e17f4ba9344119"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg1MTMwNg==", "bodyText": "I looked into your question a bit more about determinism in the generated ids, and I found that since it traverses dicts, the order is non-deterministic. DoOutputsTuple manually add themselves correctly to their producer. For Tuples, I'm keeping the old implementation. For PValues, I fixed the bug to now correctly propagate the tag.\nUnless I'm mistaken, for the user to want to use the old implementation they are then either:\n\nRelying on a bug (PValue)\nRelying on non-deterministic behavior for generated tags (dicts)\nOr using Tuples, which I didn't change.\n\nIs this okay to leave the default as-is?", "url": "https://github.com/apache/beam/pull/10860#discussion_r380851306", "createdAt": "2020-02-18T18:21:16Z", "author": {"login": "rohdesamuel"}, "path": "CHANGES.md", "diffHunk": "@@ -36,6 +36,7 @@\n \n * ReadFromPubSub(topic=<topic>) in Python previously created a subscription under the same project as the topic. Now it will create the subscription under the project specified in pipeline_options. If the project is not specified in pipeline_options, then it will create the subscription under the same project as the topic. ([BEAM-3453](https://issues.apache.org/jira/browse/BEAM-3453)).\n * SpannerAccessor in Java is now package-private to reduce API surface. `SpannerConfig.connectToSpanner` has been moved to `SpannerAccessor.create`. ([BEAM-9310](https://issues.apache.org/jira/browse/BEAM-9310)).\n+* PCollections will now have their tags correctly propagated through the Pipeline. Users may expect the old implementation which gave PCollection output ids a monotonically increasing id. To go back to the old implementation, use the \"force_generated_pcollection_output_ids\" experiment. The default is the new implementation (force_generated_pcollection_output_ids=False).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTcxMDczNw=="}, "originalCommit": {"oid": "d43d8522b29d73cf140be8a9b1e17f4ba9344119"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg1MTU0OQ==", "bodyText": "What is the best practice for rolling out experiments in Beam? In any case, we should set it as the default at least within interactive runner.", "url": "https://github.com/apache/beam/pull/10860#discussion_r380851549", "createdAt": "2020-02-18T18:21:45Z", "author": {"login": "davidyan74"}, "path": "CHANGES.md", "diffHunk": "@@ -36,6 +36,7 @@\n \n * ReadFromPubSub(topic=<topic>) in Python previously created a subscription under the same project as the topic. Now it will create the subscription under the project specified in pipeline_options. If the project is not specified in pipeline_options, then it will create the subscription under the same project as the topic. ([BEAM-3453](https://issues.apache.org/jira/browse/BEAM-3453)).\n * SpannerAccessor in Java is now package-private to reduce API surface. `SpannerConfig.connectToSpanner` has been moved to `SpannerAccessor.create`. ([BEAM-9310](https://issues.apache.org/jira/browse/BEAM-9310)).\n+* PCollections will now have their tags correctly propagated through the Pipeline. Users may expect the old implementation which gave PCollection output ids a monotonically increasing id. To go back to the old implementation, use the \"force_generated_pcollection_output_ids\" experiment. The default is the new implementation (force_generated_pcollection_output_ids=False).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTcxMDczNw=="}, "originalCommit": {"oid": "d43d8522b29d73cf140be8a9b1e17f4ba9344119"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg3ODQ2Nw==", "bodyText": "Sam, I would say that the existing behavior was a bug for the points that you mentioned or that the user never really cared what the tag names are (e.g. for a partition transform).", "url": "https://github.com/apache/beam/pull/10860#discussion_r380878467", "createdAt": "2020-02-18T19:13:26Z", "author": {"login": "lukecwik"}, "path": "CHANGES.md", "diffHunk": "@@ -36,6 +36,7 @@\n \n * ReadFromPubSub(topic=<topic>) in Python previously created a subscription under the same project as the topic. Now it will create the subscription under the project specified in pipeline_options. If the project is not specified in pipeline_options, then it will create the subscription under the same project as the topic. ([BEAM-3453](https://issues.apache.org/jira/browse/BEAM-3453)).\n * SpannerAccessor in Java is now package-private to reduce API surface. `SpannerConfig.connectToSpanner` has been moved to `SpannerAccessor.create`. ([BEAM-9310](https://issues.apache.org/jira/browse/BEAM-9310)).\n+* PCollections will now have their tags correctly propagated through the Pipeline. Users may expect the old implementation which gave PCollection output ids a monotonically increasing id. To go back to the old implementation, use the \"force_generated_pcollection_output_ids\" experiment. The default is the new implementation (force_generated_pcollection_output_ids=False).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTcxMDczNw=="}, "originalCommit": {"oid": "d43d8522b29d73cf140be8a9b1e17f4ba9344119"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg5NjEyNQ==", "bodyText": "With this explanation, I think it is fine to change the default in this release.\nFWIW, dictionaries have deterministic iteration order for py >= 3.6.", "url": "https://github.com/apache/beam/pull/10860#discussion_r380896125", "createdAt": "2020-02-18T19:47:06Z", "author": {"login": "aaltay"}, "path": "CHANGES.md", "diffHunk": "@@ -36,6 +36,7 @@\n \n * ReadFromPubSub(topic=<topic>) in Python previously created a subscription under the same project as the topic. Now it will create the subscription under the project specified in pipeline_options. If the project is not specified in pipeline_options, then it will create the subscription under the same project as the topic. ([BEAM-3453](https://issues.apache.org/jira/browse/BEAM-3453)).\n * SpannerAccessor in Java is now package-private to reduce API surface. `SpannerConfig.connectToSpanner` has been moved to `SpannerAccessor.create`. ([BEAM-9310](https://issues.apache.org/jira/browse/BEAM-9310)).\n+* PCollections will now have their tags correctly propagated through the Pipeline. Users may expect the old implementation which gave PCollection output ids a monotonically increasing id. To go back to the old implementation, use the \"force_generated_pcollection_output_ids\" experiment. The default is the new implementation (force_generated_pcollection_output_ids=False).", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTcxMDczNw=="}, "originalCommit": {"oid": "d43d8522b29d73cf140be8a9b1e17f4ba9344119"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NzQ0NzY5OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/pipeline.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOToyNzo0NlrOFrPb7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQyMToyNDozM1rOFrS8cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg4NTk5OA==", "bodyText": "nit:\nright below new_output assignment, please assert that it is one of the supported types:\nassert isinstance(result, (dict, pvalue.PValue, pvalue.DoOutputsTuple))", "url": "https://github.com/apache/beam/pull/10860#discussion_r380885998", "createdAt": "2020-02-18T19:27:46Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/pipeline.py", "diffHunk": "@@ -314,7 +314,15 @@ def _replace_if_needed(self, original_transform_node):\n             new_output.element_type = None", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d43d8522b29d73cf140be8a9b1e17f4ba9344119"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDk0MzQ3NQ==", "bodyText": "Added the assert", "url": "https://github.com/apache/beam/pull/10860#discussion_r380943475", "createdAt": "2020-02-18T21:24:33Z", "author": {"login": "rohdesamuel"}, "path": "sdks/python/apache_beam/pipeline.py", "diffHunk": "@@ -314,7 +314,15 @@ def _replace_if_needed(self, original_transform_node):\n             new_output.element_type = None", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg4NTk5OA=="}, "originalCommit": {"oid": "d43d8522b29d73cf140be8a9b1e17f4ba9344119"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2016, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}