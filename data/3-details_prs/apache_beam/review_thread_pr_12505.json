{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0ODY3MzAx", "number": 12505, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjoyMzo0N1rOEjq-8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjo0MDo0NFrOEjrYIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1ODM5ODU2OnYy", "diffSide": "RIGHT", "path": "runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/Environments.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjoyMzo0N1rOHSJ6zQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwMDozMzoyNFrOHSb2hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc5ODkyNQ==", "bodyText": "nit: could you make this an exact check for 8 and 11 and throw an exception for other (unsupported) versions", "url": "https://github.com/apache/beam/pull/12505#discussion_r488798925", "createdAt": "2020-09-15T16:23:47Z", "author": {"login": "TheNeuralBit"}, "path": "runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/Environments.java", "diffHunk": "@@ -357,4 +354,14 @@ private static File zipDirectory(File directory) throws IOException {\n       return env;\n     }\n   }\n+\n+  private static String getDefaultJavaSdkHarnessContainerUrl() {\n+    String javaVersionId =\n+        Float.parseFloat(System.getProperty(\"java.specification.version\")) >= 9 ? \"java11\" : \"java8\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA5Mjc0MA==", "bodyText": "I went ahead and added an Enum to Environments, and removed similar checks in DataflowRunner", "url": "https://github.com/apache/beam/pull/12505#discussion_r489092740", "createdAt": "2020-09-16T00:33:24Z", "author": {"login": "emilymye"}, "path": "runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/Environments.java", "diffHunk": "@@ -357,4 +354,14 @@ private static File zipDirectory(File directory) throws IOException {\n       return env;\n     }\n   }\n+\n+  private static String getDefaultJavaSdkHarnessContainerUrl() {\n+    String javaVersionId =\n+        Float.parseFloat(System.getProperty(\"java.specification.version\")) >= 9 ? \"java11\" : \"java8\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc5ODkyNQ=="}, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1ODQzNTcxOnYy", "diffSide": "RIGHT", "path": "website/www/site/content/en/documentation/runtime/environments.md", "isResolved": false, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjozMzozOFrOHSKScw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QwMzoxMDoxNVrOHTOSRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwNDk3OQ==", "bodyText": "typo here:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            apache/beam_java_8sdk              latest              16ca619d489e        2 weeks ago        550MB\n          \n          \n            \n            apache/beam_java8_sdk              latest              16ca619d489e        2 weeks ago        550MB\n          \n      \n    \n    \n  \n\nI'm assuming this change and the others like it are the result of a search to find and update all the references to beam_java_sdk, so we don't need to worry about there being other references?", "url": "https://github.com/apache/beam/pull/12505#discussion_r488804979", "createdAt": "2020-09-15T16:33:38Z", "author": {"login": "TheNeuralBit"}, "path": "website/www/site/content/en/documentation/runtime/environments.md", "diffHunk": "@@ -116,8 +116,8 @@ By default, no licenses/notices are added to the docker images.\n \n To examine the containers that you built, run `docker images` from anywhere in the command line. If you successfully built all of the container images, the command prints a table like the following:\n ```\n-REPOSITORY                          TAG                 IMAGE ID            CREATED           SIZE\n-apache/beam_java_sdk               latest              16ca619d489e        2 weeks ago        550MB\n+REPOSITORY                         TAG                 IMAGE ID            CREATED           SIZE\n+apache/beam_java_8sdk              latest              16ca619d489e        2 weeks ago        550MB", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgxODgyNQ==", "bodyText": "Let's make sure that the correct container name is set in the environment send to the remote SDKs that use Java transforms as cross-language transforms. (We don't have integration tests setup for this by we can just try existing Kafka/SQL x-lang examples to confirm)\nhttps://github.com/apache/beam/tree/master/sdks/python/apache_beam/examples/kafkataxi\nhttps://github.com/apache/beam/blob/master/sdks/python/apache_beam/examples/sql_taxi.py", "url": "https://github.com/apache/beam/pull/12505#discussion_r488818825", "createdAt": "2020-09-15T16:56:19Z", "author": {"login": "chamikaramj"}, "path": "website/www/site/content/en/documentation/runtime/environments.md", "diffHunk": "@@ -116,8 +116,8 @@ By default, no licenses/notices are added to the docker images.\n \n To examine the containers that you built, run `docker images` from anywhere in the command line. If you successfully built all of the container images, the command prints a table like the following:\n ```\n-REPOSITORY                          TAG                 IMAGE ID            CREATED           SIZE\n-apache/beam_java_sdk               latest              16ca619d489e        2 weeks ago        550MB\n+REPOSITORY                         TAG                 IMAGE ID            CREATED           SIZE\n+apache/beam_java_8sdk              latest              16ca619d489e        2 weeks ago        550MB", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwNDk3OQ=="}, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTYwNDIwMg==", "bodyText": "We should make sure the references to beam_java_sdk are updated in those examples too", "url": "https://github.com/apache/beam/pull/12505#discussion_r489604202", "createdAt": "2020-09-16T17:28:57Z", "author": {"login": "TheNeuralBit"}, "path": "website/www/site/content/en/documentation/runtime/environments.md", "diffHunk": "@@ -116,8 +116,8 @@ By default, no licenses/notices are added to the docker images.\n \n To examine the containers that you built, run `docker images` from anywhere in the command line. If you successfully built all of the container images, the command prints a table like the following:\n ```\n-REPOSITORY                          TAG                 IMAGE ID            CREATED           SIZE\n-apache/beam_java_sdk               latest              16ca619d489e        2 weeks ago        550MB\n+REPOSITORY                         TAG                 IMAGE ID            CREATED           SIZE\n+apache/beam_java_8sdk              latest              16ca619d489e        2 weeks ago        550MB", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwNDk3OQ=="}, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTYyMjg0Mg==", "bodyText": "Weird! I don't know why they didn't show up in my initial ctrl-f", "url": "https://github.com/apache/beam/pull/12505#discussion_r489622842", "createdAt": "2020-09-16T18:01:59Z", "author": {"login": "emilymye"}, "path": "website/www/site/content/en/documentation/runtime/environments.md", "diffHunk": "@@ -116,8 +116,8 @@ By default, no licenses/notices are added to the docker images.\n \n To examine the containers that you built, run `docker images` from anywhere in the command line. If you successfully built all of the container images, the command prints a table like the following:\n ```\n-REPOSITORY                          TAG                 IMAGE ID            CREATED           SIZE\n-apache/beam_java_sdk               latest              16ca619d489e        2 weeks ago        550MB\n+REPOSITORY                         TAG                 IMAGE ID            CREATED           SIZE\n+apache/beam_java_8sdk              latest              16ca619d489e        2 weeks ago        550MB", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwNDk3OQ=="}, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTYyNDMwNg==", "bodyText": "I bet it was a race condition, those examples were added in just the last couple of months", "url": "https://github.com/apache/beam/pull/12505#discussion_r489624306", "createdAt": "2020-09-16T18:04:41Z", "author": {"login": "TheNeuralBit"}, "path": "website/www/site/content/en/documentation/runtime/environments.md", "diffHunk": "@@ -116,8 +116,8 @@ By default, no licenses/notices are added to the docker images.\n \n To examine the containers that you built, run `docker images` from anywhere in the command line. If you successfully built all of the container images, the command prints a table like the following:\n ```\n-REPOSITORY                          TAG                 IMAGE ID            CREATED           SIZE\n-apache/beam_java_sdk               latest              16ca619d489e        2 weeks ago        550MB\n+REPOSITORY                         TAG                 IMAGE ID            CREATED           SIZE\n+apache/beam_java_8sdk              latest              16ca619d489e        2 weeks ago        550MB", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwNDk3OQ=="}, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTg4NzY3OQ==", "bodyText": "I went ahead and ran the Kafka example \"from local Beam repo\" without specifying the --sdk_harness_container_image_overrides to see if we should pass the correct URL, which it seems to do (based on the worker container manifest):\n{\n      \"args\": [ ... ],\n      \"image\": \"apache/beam_java8_sdk:2.25.0.dev\",\n      \"imagePullPolicy\": \"IfNotPresent\",\n      \"name\": \"sdk-1-0\",\n      \"volumeMounts\": [ {\n        \"mountPath\": \"/var/opt/google\",\n        \"name\": \"persist\"\n},     \n\nDataflow can't actually grab that container because it doesn't exist (on hub.docker.com), so the job itself doesn't work, but it seems to be grabbing the right URL.", "url": "https://github.com/apache/beam/pull/12505#discussion_r489887679", "createdAt": "2020-09-17T02:20:07Z", "author": {"login": "emilymye"}, "path": "website/www/site/content/en/documentation/runtime/environments.md", "diffHunk": "@@ -116,8 +116,8 @@ By default, no licenses/notices are added to the docker images.\n \n To examine the containers that you built, run `docker images` from anywhere in the command line. If you successfully built all of the container images, the command prints a table like the following:\n ```\n-REPOSITORY                          TAG                 IMAGE ID            CREATED           SIZE\n-apache/beam_java_sdk               latest              16ca619d489e        2 weeks ago        550MB\n+REPOSITORY                         TAG                 IMAGE ID            CREATED           SIZE\n+apache/beam_java_8sdk              latest              16ca619d489e        2 weeks ago        550MB", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwNDk3OQ=="}, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTkxOTA0Ng==", "bodyText": "That looks correct. Thanks.", "url": "https://github.com/apache/beam/pull/12505#discussion_r489919046", "createdAt": "2020-09-17T03:10:15Z", "author": {"login": "chamikaramj"}, "path": "website/www/site/content/en/documentation/runtime/environments.md", "diffHunk": "@@ -116,8 +116,8 @@ By default, no licenses/notices are added to the docker images.\n \n To examine the containers that you built, run `docker images` from anywhere in the command line. If you successfully built all of the container images, the command prints a table like the following:\n ```\n-REPOSITORY                          TAG                 IMAGE ID            CREATED           SIZE\n-apache/beam_java_sdk               latest              16ca619d489e        2 weeks ago        550MB\n+REPOSITORY                         TAG                 IMAGE ID            CREATED           SIZE\n+apache/beam_java_8sdk              latest              16ca619d489e        2 weeks ago        550MB", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwNDk3OQ=="}, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1ODQ2MzA2OnYy", "diffSide": "RIGHT", "path": "sdks/java/container/Dockerfile-java11", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjo0MDo0NFrOHSKjhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjo0Mjo1NVrOHSKoqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwOTM0OQ==", "bodyText": "I'm +1 for just removing this. Looks like it was added in #8053 in order to start running a job for testing Java 11. As long as the jobs that use Java 11 still pass after removing this I think it's fine.\nI don't think users should be referencing this Dockerfile directly, if they're building a Java 11 container at all it should be through the gradle command (and even then we don't support Java 11 so they shouldn't be doing it).", "url": "https://github.com/apache/beam/pull/12505#discussion_r488809349", "createdAt": "2020-09-15T16:40:44Z", "author": {"login": "TheNeuralBit"}, "path": "sdks/java/container/Dockerfile-java11", "diffHunk": "@@ -16,6 +16,10 @@\n # limitations under the License.\n ###############################################################################\n \n+##\n+# NOTE: This image is now deprecated.\n+# Use Dockerfile with the appropriate java_version build argument.\n+##", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgxMDY2NQ==", "bodyText": "Also the fact that this Dockerfile doesn't copy LICENSE and NOTICE is problematic.", "url": "https://github.com/apache/beam/pull/12505#discussion_r488810665", "createdAt": "2020-09-15T16:42:55Z", "author": {"login": "TheNeuralBit"}, "path": "sdks/java/container/Dockerfile-java11", "diffHunk": "@@ -16,6 +16,10 @@\n # limitations under the License.\n ###############################################################################\n \n+##\n+# NOTE: This image is now deprecated.\n+# Use Dockerfile with the appropriate java_version build argument.\n+##", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgwOTM0OQ=="}, "originalCommit": {"oid": "ba2a1fabec8ce7e0b09240e6f92df3ba4664f313"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 605, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}