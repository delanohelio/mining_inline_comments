{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNzg5NzMz", "number": 12107, "title": "Interactive Environment Inspector for messaging", "bodyText": "Added messaging package to expose interactive environment state\nthrough a singleton interactive environment inspector.\nAdded a to_json util to convert native python objects to json string\nfor messaging.\nApplications can use the inspector's API to communicate with a\nrunning kernel.\n\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\n\n\n\n\nGo\n\n---\n\n---\n\n\n\nJava\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n\n\nXLang\n---\n---\n\n---\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-06-26T21:15:13Z", "url": "https://github.com/apache/beam/pull/12107", "merged": true, "mergeCommit": {"oid": "2ff08a46e04bd07550f6a4a86099da2d1a1dd414"}, "closed": true, "closedAt": "2020-07-10T00:34:25Z", "author": {"login": "KevinGG"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwKWvOAH2gAyNDQwNzg5NzMzOmU2OGU5NGNiMWYzZmYyYTA1M2NiZTE2ZmVlNzliZDQwNmM3NDFjZWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyujd0AH2gAyNDQwNzg5NzMzOjU1NzA2ODhlMzc2ZjczYmUxMmZiMTRjMDEwMGU3MmE3MDFmN2I3Yzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e68e94cb1f3ff2a053cbe16fee79bd406c741cec", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/e68e94cb1f3ff2a053cbe16fee79bd406c741cec", "committedDate": "2020-06-30T00:18:20Z", "message": "Interactive Environment Inspector for messaging\n\n1. Added messaging package to expose interactive environment state\n   through a singleton interactive environment inspector.\n2. Added a to_json util to convert native python objects to json string\n   for messaging.\n3. Applications can use the inspector's API to communicate with a\n   running kernel."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b6d7e561e31138e799f988272a19824baadaab1", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/4b6d7e561e31138e799f988272a19824baadaab1", "committedDate": "2020-06-26T21:14:01Z", "message": "Interactive Environment Inspector for messaging\n\n1. Added messaging package to expose interactive environment state\n   through a singleton interactive environment inspector.\n2. Added a to_json util to convert native python objects to json string\n   for messaging.\n3. Applications can use the inspector's API to communicate with a\n   running kernel."}, "afterCommit": {"oid": "e68e94cb1f3ff2a053cbe16fee79bd406c741cec", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/e68e94cb1f3ff2a053cbe16fee79bd406c741cec", "committedDate": "2020-06-30T00:18:20Z", "message": "Interactive Environment Inspector for messaging\n\n1. Added messaging package to expose interactive environment state\n   through a singleton interactive environment inspector.\n2. Added a to_json util to convert native python objects to json string\n   for messaging.\n3. Applications can use the inspector's API to communicate with a\n   running kernel."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bfa564050aa79580ae9b25b97afefc3e934acef", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/9bfa564050aa79580ae9b25b97afefc3e934acef", "committedDate": "2020-06-30T21:48:17Z", "message": "Restrict the test environment constraint."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNTQyODY4", "url": "https://github.com/apache/beam/pull/12107#pullrequestreview-440542868", "createdAt": "2020-07-01T04:47:04Z", "commit": {"oid": "9bfa564050aa79580ae9b25b97afefc3e934acef"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNDo0NzowNFrOGrWoug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNTowNzoyMlrOGrW7tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODExMjgyNg==", "bodyText": "The callable returns string, right?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              # type: (Callable[..., Any]) -> Callable[..., Any]\n          \n          \n            \n              # type: (Callable[..., Any]) -> Callable[..., str]", "url": "https://github.com/apache/beam/pull/12107#discussion_r448112826", "createdAt": "2020-07-01T04:47:04Z", "author": {"login": "pabloem"}, "path": "sdks/python/apache_beam/runners/interactive/utils.py", "diffHunk": "@@ -204,3 +205,23 @@ def run_within_progress_indicator(*args, **kwargs):\n       return func(*args, **kwargs)\n \n   return run_within_progress_indicator\n+\n+\n+def as_json(func):\n+  # type: (Callable[..., Any]) -> Callable[..., Any]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9bfa564050aa79580ae9b25b97afefc3e934acef"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODExNzY4NQ==", "bodyText": "nit: you could do something like json.loads(dummy(), SAMPLE_DATA) instead of depending on the ordering.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    dummy(), '{\"a\": [1, 2, 3], \"b\": 4, \"c\": \"5\", \"d\": {\"e\": \"f\"}}')\n          \n          \n            \n                    json.loads(dummy()), {\"a\": [1, 2, 3], \"b\": 4, \"c\": \"5\", \"d\": {\"e\": \"f\"}})", "url": "https://github.com/apache/beam/pull/12107#discussion_r448117685", "createdAt": "2020-07-01T05:07:22Z", "author": {"login": "pabloem"}, "path": "sdks/python/apache_beam/runners/interactive/utils_test.py", "diffHunk": "@@ -195,5 +195,25 @@ def progress_indicated_dummy():\n     mocked_javascript.assert_called_once()\n \n \n+@unittest.skipIf(\n+    not ie.current_env().is_interactive_ready,\n+    '[interactive] dependency is not installed.')\n+@unittest.skipIf(\n+    sys.version_info < (3, 6), 'The tests require at least Python 3.6 to work.')\n+class MessagingUtilTest(unittest.TestCase):\n+  def setUp(self):\n+    ie.new_env()\n+\n+  def test_as_json_decorator(self):\n+    @utils.as_json\n+    def dummy():\n+      return {'a': [1, 2, 3], 'b': 4, 'c': '5', 'd': {'e': 'f'}}\n+\n+    # As of Python 3.6, for the CPython implementation of Python,\n+    # dictionaries remember the order of items inserted.\n+    self.assertEqual(\n+        dummy(), '{\"a\": [1, 2, 3], \"b\": 4, \"c\": \"5\", \"d\": {\"e\": \"f\"}}')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9bfa564050aa79580ae9b25b97afefc3e934acef"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5570688e376f73be12fb14c0100e72a701f7b7c9", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/5570688e376f73be12fb14c0100e72a701f7b7c9", "committedDate": "2020-07-07T23:36:40Z", "message": "fix comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3176, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}