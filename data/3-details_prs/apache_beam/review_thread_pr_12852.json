{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3NjA1OTM5", "number": 12852, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNjo0NDoxM1rOEmsEjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQyMzozNDoxMlrOFRIC1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDAzNDA0OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNjo0NDoxM1rOHW3a9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNjo0NDoxM1rOHW3a9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzczODc0Mw==", "bodyText": "Is there a pattern here in java for this. I.e. * MILLIS_PER_SEC. Or converting to duration objects and comparing those?", "url": "https://github.com/apache/beam/pull/12852#discussion_r493738743", "createdAt": "2020-09-23T16:44:13Z", "author": {"login": "ajamato"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "diffHunk": "@@ -150,24 +143,42 @@ public void finishBundle(FinishBundleContext context) throws Exception {\n     for (ValueInSingleWindow<ErrorT> row : failedInserts) {\n       context.output(failedOutputTag, row.getValue(), row.getTimestamp(), row.getWindow());\n     }\n-\n-    long currentTimeMillis = System.currentTimeMillis();\n-    if (histogram.getTotalCount() > 0\n-        && (currentTimeMillis - lastReportedSystemClockMillis)\n-            > options.getLatencyLoggingFrequency() * 1000L) {\n-      logPercentiles();\n-      histogram.clear();\n-      lastReportedSystemClockMillis = currentTimeMillis;\n-    }\n+    reportStreamingApiLogging(options);\n   }\n \n-  private void logPercentiles() {\n-    LOG.info(\n-        \"Total number of streaming insert requests: {}, P99: {}ms, P90: {}ms, P50: {}ms\",\n-        histogram.getTotalCount(),\n-        DoubleMath.roundToInt(histogram.p99(), RoundingMode.HALF_UP),\n-        DoubleMath.roundToInt(histogram.p90(), RoundingMode.HALF_UP),\n-        DoubleMath.roundToInt(histogram.p50(), RoundingMode.HALF_UP));\n+  private void reportStreamingApiLogging(BigQueryOptions options) {\n+    if (reportingLock.tryLock()) {\n+      try {\n+        long currentTimeMillis = System.currentTimeMillis();\n+        if (currentTimeMillis - lastReportedSystemClockMillis\n+            > options.getBqStreamingApiLoggingFrequencySec() * 1000L) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf75bf2414838f3edb83790963d3e8dd6e589039"}, "originalPosition": 90}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5MDA0OTgyOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNjo0ODoxOFrOHW3ktw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNjo0ODoxOFrOHW3ktw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc0MTIzOQ==", "bodyText": "Please make this message mention BigQuery", "url": "https://github.com/apache/beam/pull/12852#discussion_r493741239", "createdAt": "2020-09-23T16:48:18Z", "author": {"login": "ajamato"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "diffHunk": "@@ -150,24 +143,42 @@ public void finishBundle(FinishBundleContext context) throws Exception {\n     for (ValueInSingleWindow<ErrorT> row : failedInserts) {\n       context.output(failedOutputTag, row.getValue(), row.getTimestamp(), row.getWindow());\n     }\n-\n-    long currentTimeMillis = System.currentTimeMillis();\n-    if (histogram.getTotalCount() > 0\n-        && (currentTimeMillis - lastReportedSystemClockMillis)\n-            > options.getLatencyLoggingFrequency() * 1000L) {\n-      logPercentiles();\n-      histogram.clear();\n-      lastReportedSystemClockMillis = currentTimeMillis;\n-    }\n+    reportStreamingApiLogging(options);\n   }\n \n-  private void logPercentiles() {\n-    LOG.info(\n-        \"Total number of streaming insert requests: {}, P99: {}ms, P90: {}ms, P50: {}ms\",\n-        histogram.getTotalCount(),\n-        DoubleMath.roundToInt(histogram.p99(), RoundingMode.HALF_UP),\n-        DoubleMath.roundToInt(histogram.p90(), RoundingMode.HALF_UP),\n-        DoubleMath.roundToInt(histogram.p50(), RoundingMode.HALF_UP));\n+  private void reportStreamingApiLogging(BigQueryOptions options) {\n+    if (reportingLock.tryLock()) {\n+      try {\n+        long currentTimeMillis = System.currentTimeMillis();\n+        if (currentTimeMillis - lastReportedSystemClockMillis\n+            > options.getBqStreamingApiLoggingFrequencySec() * 1000L) {\n+          StringBuilder logMessage = new StringBuilder();\n+          logMessage.append(\n+              String.format(\n+                  \"[Streaming Insert API Statistics since %s]\\n\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf75bf2414838f3edb83790963d3e8dd6e589039"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUzNDkxMDA2OnYy", "diffSide": "RIGHT", "path": "sdks/java/extensions/google-cloud-platform-core/src/main/java/org/apache/beam/sdk/extensions/gcp/util/LatencyRecordingHttpRequestInitializer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQyMjo1NDoxN1rOIXWxVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQwMzoyNzoxM1rOIXimbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM2MTIzNg==", "bodyText": "Remove space from start of string.\nPlease call this API_REQUEST_LATENCIES_URN latencies. Rather than HISTOGRAM_URN", "url": "https://github.com/apache/beam/pull/12852#discussion_r561361236", "createdAt": "2021-01-20T22:54:17Z", "author": {"login": "ajamato"}, "path": "sdks/java/extensions/google-cloud-platform-core/src/main/java/org/apache/beam/sdk/extensions/gcp/util/LatencyRecordingHttpRequestInitializer.java", "diffHunk": "@@ -31,6 +31,7 @@\n \n /** HttpRequestInitializer for recording request to response latency of Http-based API calls. */\n public class LatencyRecordingHttpRequestInitializer implements HttpRequestInitializer {\n+  // TODO: Import the URN from MonitoringInfoConstants.Urns when it's available\n   public static final String HISTOGRAM_URN = \" beam:metric:io:api_request_latencies:v1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTU1NTA1NQ==", "bodyText": "Done.", "url": "https://github.com/apache/beam/pull/12852#discussion_r561555055", "createdAt": "2021-01-21T03:27:13Z", "author": {"login": "ihji"}, "path": "sdks/java/extensions/google-cloud-platform-core/src/main/java/org/apache/beam/sdk/extensions/gcp/util/LatencyRecordingHttpRequestInitializer.java", "diffHunk": "@@ -31,6 +31,7 @@\n \n /** HttpRequestInitializer for recording request to response latency of Http-based API calls. */\n public class LatencyRecordingHttpRequestInitializer implements HttpRequestInitializer {\n+  // TODO: Import the URN from MonitoringInfoConstants.Urns when it's available\n   public static final String HISTOGRAM_URN = \" beam:metric:io:api_request_latencies:v1\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM2MTIzNg=="}, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUzNDkyMjEyOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQyMjo1ODoxMlrOIXW4Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQwMzoyNzozMVrOIXinog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM2MzAyMg==", "bodyText": "I feel like KV isn't an appropriate type here. Isn't there a built in Pair or Tuple we could use in Java instead?\nAs KV is designed for pcollections. I see a org.apache.beam.vendor.calcite.v1_20_0.org.apache.calcite.util.Pair being used in the repo:\nhttps://github.com/apache/beam/search?q=%22Pair%3C%22", "url": "https://github.com/apache/beam/pull/12852#discussion_r561363022", "createdAt": "2021-01-20T22:58:12Z", "author": {"login": "ajamato"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "diffHunk": "@@ -70,6 +73,15 @@\n   /** Tracks bytes written, exposed as \"ByteCount\" Counter. */\n   private Counter byteCounter = SinkMetrics.bytesWritten();\n \n+  private Set<KV<String, String>> metricFilter =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTU1NTM2Mg==", "bodyText": "Using MetricName instead.", "url": "https://github.com/apache/beam/pull/12852#discussion_r561555362", "createdAt": "2021-01-21T03:27:31Z", "author": {"login": "ihji"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "diffHunk": "@@ -70,6 +73,15 @@\n   /** Tracks bytes written, exposed as \"ByteCount\" Counter. */\n   private Counter byteCounter = SinkMetrics.bytesWritten();\n \n+  private Set<KV<String, String>> metricFilter =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM2MzAyMg=="}, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUzNDk2NzE4OnYy", "diffSide": "RIGHT", "path": "sdks/java/extensions/google-cloud-platform-core/src/main/java/org/apache/beam/sdk/extensions/gcp/util/LatencyRecordingHttpRequestInitializer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQyMzoxNTozMVrOIXXT6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQwMzoyODowMFrOIXipmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM3MDA5MQ==", "bodyText": "Since you are instantiing the latency monitoring info, please add a MonitoringInfoSpec for it, and pull it its urn as the constant here\n\n  \n    \n      beam/model/pipeline/src/main/proto/metrics.proto\n    \n    \n         Line 69\n      in\n      eca935b\n    \n    \n    \n    \n\n        \n          \n           USER_SUM_INT64 = 0 [(monitoring_info_spec) = { \n        \n    \n  \n\n\nThis would be ideal, as we should not instantiate metrics for URNs without a MonitoringInfoSpec.\nIt should be very similar to the API_REQUEST_COUNT, without STATUS label, a different URN, and a histogram type\ni.e. you can use\nAPI_REQUEST_LATENCIES = 20 [(monitoring_info_spec) = {\n  urn: \"beam:metric:io:api_request_latencies:v1\",\n  type: \"beam:metrics:histogram_int64:v1\",\n  required_labels: [\n    \"SERVICE\",\n    \"METHOD\",\n    \"RESOURCE\",\n    \"PTRANSFORM\"\n  ],\n  annotations: [\n     {\n        key: \"description\",\n        value: \"Histogram counts for request latencies made to an IO\u2019s service APIs to batch read or write elements.\"\n    }, \n    {\n      key: \"units\",\n      value: \"Milliseconds\"\n    },\n    {\n      key: \"process_metric\",  // Should be reported as a process metric\n                              // instead of a bundle metric\n      value: \"true\"\n    }\n  ]\n}];", "url": "https://github.com/apache/beam/pull/12852#discussion_r561370091", "createdAt": "2021-01-20T23:15:31Z", "author": {"login": "ajamato"}, "path": "sdks/java/extensions/google-cloud-platform-core/src/main/java/org/apache/beam/sdk/extensions/gcp/util/LatencyRecordingHttpRequestInitializer.java", "diffHunk": "@@ -31,6 +31,7 @@\n \n /** HttpRequestInitializer for recording request to response latency of Http-based API calls. */\n public class LatencyRecordingHttpRequestInitializer implements HttpRequestInitializer {\n+  // TODO: Import the URN from MonitoringInfoConstants.Urns when it's available\n   public static final String HISTOGRAM_URN = \" beam:metric:io:api_request_latencies:v1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTU1NTg2Nw==", "bodyText": "Done.", "url": "https://github.com/apache/beam/pull/12852#discussion_r561555867", "createdAt": "2021-01-21T03:28:00Z", "author": {"login": "ihji"}, "path": "sdks/java/extensions/google-cloud-platform-core/src/main/java/org/apache/beam/sdk/extensions/gcp/util/LatencyRecordingHttpRequestInitializer.java", "diffHunk": "@@ -31,6 +31,7 @@\n \n /** HttpRequestInitializer for recording request to response latency of Http-based API calls. */\n public class LatencyRecordingHttpRequestInitializer implements HttpRequestInitializer {\n+  // TODO: Import the URN from MonitoringInfoConstants.Urns when it's available\n   public static final String HISTOGRAM_URN = \" beam:metric:io:api_request_latencies:v1\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM3MDA5MQ=="}, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUzNTAxNjA3OnYy", "diffSide": "RIGHT", "path": "runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQyMzozMjo1M1rOIXXwUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQwMzoyOTowMFrOIXitpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM3NzM2Mg==", "bodyText": "HashSet metricFilter\nI think it would make more sense to make the metricFilter just be a Set of MetricNames as well.  MetricName has a hash code so you can do efficient set lookups this way as well. It is used with Map types as a key normally, so this should work.\nAlso, make the metric  you are defining uses a MonitoringInfoMetricName, which doesn't have a name+namespace concept, it instead has a urn and labels. Instantiate a MonitoringInfoMetricName for it using the full URN and labels. Don't parse the URN and put it in a MetricName as a namespace+name\n\n  \n    \n      beam/runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MonitoringInfoMetricName.java\n    \n    \n         Line 105\n      in\n      a724602\n    \n    \n    \n    \n\n        \n          \n           public boolean equals(@Nullable Object o) {", "url": "https://github.com/apache/beam/pull/12852#discussion_r561377362", "createdAt": "2021-01-20T23:32:53Z", "author": {"login": "ajamato"}, "path": "runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerImpl.java", "diffHunk": "@@ -411,20 +412,23 @@ public int hashCode() {\n   }\n \n   /**\n-   * Match a MetricName with a given namespace and a name. If the namespace or the name is null, it\n-   * will be ignored for the match.\n+   * Match a MetricName with a given metric filter. If the metric filter is null, the method always\n+   * returns true.\n    */\n   private boolean matchMetricName(\n-      MetricName metricName, @Nullable String namespace, @Nullable String name) {\n-    return (namespace == null || namespace.equals(metricName.getNamespace()))\n-        && (name == null || name.equals(metricName.getName()));\n+      MetricName metricName, @Nullable Set<KV<String, String>> metricFilter) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTU1NjkwMg==", "bodyText": "Done. Using MetricName instead.", "url": "https://github.com/apache/beam/pull/12852#discussion_r561556902", "createdAt": "2021-01-21T03:29:00Z", "author": {"login": "ihji"}, "path": "runners/core-java/src/main/java/org/apache/beam/runners/core/metrics/MetricsContainerImpl.java", "diffHunk": "@@ -411,20 +412,23 @@ public int hashCode() {\n   }\n \n   /**\n-   * Match a MetricName with a given namespace and a name. If the namespace or the name is null, it\n-   * will be ignored for the match.\n+   * Match a MetricName with a given metric filter. If the metric filter is null, the method always\n+   * returns true.\n    */\n   private boolean matchMetricName(\n-      MetricName metricName, @Nullable String namespace, @Nullable String name) {\n-    return (namespace == null || namespace.equals(metricName.getNamespace()))\n-        && (name == null || name.equals(metricName.getName()));\n+      MetricName metricName, @Nullable Set<KV<String, String>> metricFilter) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM3NzM2Mg=="}, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUzNTAxOTA5OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQyMzozNDoxMlrOIXXyLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQwMzoyOToxMlrOIXiuew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM3NzgzOQ==", "bodyText": "It looks like you are parsing the URN and treating it as if it were the \"namespace\" and \"name\" of the metric.\nHowever, this metric does not have a namespace+name, and should not be modeled as such.\nRemember, namespace+name is a concept that only applies to user defined metrics. The namespace and name are simply labels populated with the keys \"namespace\" and \"name\"\nSee the MonitoringInfoSpec on USER_SUM_INT64\n\n  \n    \n      beam/model/pipeline/src/main/proto/metrics.proto\n    \n    \n         Line 69\n      in\n      eca935b\n    \n    \n    \n    \n\n        \n          \n           USER_SUM_INT64 = 0 [(monitoring_info_spec) = { \n        \n    \n  \n\n\nThis metric should be identified using the urn, and it's labels.\nInstantiate a MonitoringInfoMetricName for it instead, and update the comparison logic to just filter using MetricNames (MonitoringInfoMetricName is a subclass of MetricName).", "url": "https://github.com/apache/beam/pull/12852#discussion_r561377839", "createdAt": "2021-01-20T23:34:12Z", "author": {"login": "ajamato"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "diffHunk": "@@ -70,6 +73,15 @@\n   /** Tracks bytes written, exposed as \"ByteCount\" Counter. */\n   private Counter byteCounter = SinkMetrics.bytesWritten();\n \n+  private Set<KV<String, String>> metricFilter =\n+      ImmutableSet.of(\n+          KV.of(\n+              LatencyRecordingHttpRequestInitializer.HISTOGRAM_URN.split(\":\", 2)[0],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTU1NzExNQ==", "bodyText": "Done.", "url": "https://github.com/apache/beam/pull/12852#discussion_r561557115", "createdAt": "2021-01-21T03:29:12Z", "author": {"login": "ihji"}, "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/bigquery/StreamingWriteFn.java", "diffHunk": "@@ -70,6 +73,15 @@\n   /** Tracks bytes written, exposed as \"ByteCount\" Counter. */\n   private Counter byteCounter = SinkMetrics.bytesWritten();\n \n+  private Set<KV<String, String>> metricFilter =\n+      ImmutableSet.of(\n+          KV.of(\n+              LatencyRecordingHttpRequestInitializer.HISTOGRAM_URN.split(\":\", 2)[0],", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTM3NzgzOQ=="}, "originalCommit": {"oid": "014c76c49523172c367079001f1a525c5f3387a9"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3325, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}