{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMDExNDc1", "number": 11764, "title": "[BEAM-10048] Clean up release guide.", "bodyText": "Remove redundancies between the release guide and build_release_candidate.sh.\nUpdate website-related instructions for Hugo.\n\nSome of the steps under the \"Alternative\" section were not covered by the script, so I added them to \"Tasks you need to do manually\" instead.\nEven though this PR deletes a lot of instructions, no information should have been lost. Please verify this in your review.\ncc: @aaltay @TheNeuralBit\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-05-20T20:47:52Z", "url": "https://github.com/apache/beam/pull/11764", "merged": true, "mergeCommit": {"oid": "dfa1e475194ac6f65c42da7b8cb8d5055dd1952c"}, "closed": true, "closedAt": "2020-05-21T19:21:20Z", "author": {"login": "ibzib"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjPbeWgBqjMzNTgyNzY3MzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjhfftAH2gAyNDIxMDExNDc1OjBjMzc4MGM0MzhiYzFlM2M5ZTMxNGU4N2U4NjQ2ZTNmNGU4OTcyYjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "792f9d7eb0864a583e50541a7bd5a40633f6b683", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/792f9d7eb0864a583e50541a7bd5a40633f6b683", "committedDate": "2020-05-20T20:42:59Z", "message": "[BEAM-10048] Clean up release guide.\n\n- Remove redundancies between the release guide and build_release_candidate.sh.\n- Update website-related instructions for Hugo."}, "afterCommit": {"oid": "29d19d0cc97473a23ff0d9d4a048377b5e2b3ae1", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/29d19d0cc97473a23ff0d9d4a048377b5e2b3ae1", "committedDate": "2020-05-20T20:51:46Z", "message": "[BEAM-10048] Clean up release guide.\n\n- Remove redundancies between the release guide and build_release_candidate.sh.\n- Update website-related instructions for Hugo."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "29d19d0cc97473a23ff0d9d4a048377b5e2b3ae1", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/29d19d0cc97473a23ff0d9d4a048377b5e2b3ae1", "committedDate": "2020-05-20T20:51:46Z", "message": "[BEAM-10048] Clean up release guide.\n\n- Remove redundancies between the release guide and build_release_candidate.sh.\n- Update website-related instructions for Hugo."}, "afterCommit": {"oid": "58520452dc8afa3d92babd9796ea9556b35c2e5a", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/58520452dc8afa3d92babd9796ea9556b35c2e5a", "committedDate": "2020-05-20T20:52:21Z", "message": "[BEAM-10048] Clean up release guide.\n\n- Remove redundancies between the release guide and build_release_candidate.sh.\n- Update website-related instructions for Hugo."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21da8903180e58244f817d956a080d5a8c5e66a8", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/21da8903180e58244f817d956a080d5a8c5e66a8", "committedDate": "2020-05-20T20:56:04Z", "message": "[BEAM-10048] Clean up release guide.\n\n- Remove redundancies between the release guide and build_release_candidate.sh.\n- Update website-related instructions for Hugo."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "58520452dc8afa3d92babd9796ea9556b35c2e5a", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/58520452dc8afa3d92babd9796ea9556b35c2e5a", "committedDate": "2020-05-20T20:52:21Z", "message": "[BEAM-10048] Clean up release guide.\n\n- Remove redundancies between the release guide and build_release_candidate.sh.\n- Update website-related instructions for Hugo."}, "afterCommit": {"oid": "21da8903180e58244f817d956a080d5a8c5e66a8", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/21da8903180e58244f817d956a080d5a8c5e66a8", "committedDate": "2020-05-20T20:56:04Z", "message": "[BEAM-10048] Clean up release guide.\n\n- Remove redundancies between the release guide and build_release_candidate.sh.\n- Update website-related instructions for Hugo."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1404c6a1ab3ca7e9ff3267c7bd28e18472c33e2a", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/1404c6a1ab3ca7e9ff3267c7bd28e18472c33e2a", "committedDate": "2020-05-20T21:13:06Z", "message": "Remove checklist from build_release_candidate.sh.\n\nIt is included in the release guide."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3179f21f7b817c6541405ef085de26ac7210a0ea", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/3179f21f7b817c6541405ef085de26ac7210a0ea", "committedDate": "2020-05-20T21:10:21Z", "message": "Remove checklist from build_release_candidate.sh.\n\nIt is included in the release guide."}, "afterCommit": {"oid": "1404c6a1ab3ca7e9ff3267c7bd28e18472c33e2a", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/1404c6a1ab3ca7e9ff3267c7bd28e18472c33e2a", "committedDate": "2020-05-20T21:13:06Z", "message": "Remove checklist from build_release_candidate.sh.\n\nIt is included in the release guide."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NzgzNTI4", "url": "https://github.com/apache/beam/pull/11764#pullrequestreview-415783528", "createdAt": "2020-05-20T23:31:44Z", "commit": {"oid": "1404c6a1ab3ca7e9ff3267c7bd28e18472c33e2a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMzozMTo0NFrOGYhUhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMzozNDo1MlrOGYhYfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM2NDkzNA==", "bodyText": "nit: say \"by clicking the CLOSE button\". I was confused on how to close.", "url": "https://github.com/apache/beam/pull/11764#discussion_r428364934", "createdAt": "2020-05-20T23:31:44Z", "author": {"login": "amaliujia"}, "path": "website/www/site/content/en/contribute/release-guide.md", "diffHunk": "@@ -583,189 +582,44 @@ For this step, we recommend you using automation script to create a RC, but you\n   1. Stage source release into dist.apache.org dev [repo](https://dist.apache.org/repos/dist/dev/beam/).\n   1. Stage,sign and hash python binaries into dist.apache.ord dev repo python dir\n   1. Stage SDK docker images to [docker hub Apache organization](https://hub.docker.com/search?q=apache%2Fbeam&type=image).\n-  1. Create a PR to update beam and beam-site, changes includes:\n+  1. Create a PR to update beam-site, changes includes:\n      * Copy python doc into beam-site\n      * Copy java doc into beam-site\n-     * Update release version into [_config.yml](https://github.com/apache/beam/blob/master/website/_config.yml).\n      \n #### Tasks you need to do manually\n-  1. Add new release into `website/src/get-started/downloads.md`.\n-  1. Update last release download links in `website/src/get-started/downloads.md`.\n-  1. Update `website/src/.htaccess` to redirect to the new version.\n-  1. Build and stage python wheels.\n+  1. Verify the script worked.\n+      1. Verify that the source and Python binaries are present in [dist.apache.org](https://dist.apache.org/repos/dist/dev/beam).\n+      1. Verify Docker images are published. How to find images:\n+          1. Visit [https://hub.docker.com/u/apache](https://hub.docker.com/search?q=apache%2Fbeam&type=image)\n+          2. Visit each repository and navigate to *tags* tab.\n+          3. Verify images are pushed with tags: ${RELEASE}_rc{RC_NUM}\n+      1. Verify that third party licenses are included in Docker containers by logging in to the images.\n+          - For Python SDK images, there should be around 80 ~ 100 dependencies.\n+          Please note that dependencies for the SDKs with different Python versions vary.\n+          Need to verify all Python images by replacing `${ver}` with each supported Python version `X.Y`.\n+          ```\n+          docker run -it --entrypoint=/bin/bash apache/beam_python${ver}_sdk:${RELEASE}_rc{RC_NUM}\n+          ls -al /opt/apache/beam/third_party_licenses/ | wc -l\n+          ```\n+          - For Java SDK images, there should be around 1400 dependencies.\n+          ```\n+          docker run -it --entrypoint=/bin/bash apache/beam_java_sdk:${RELEASE}_rc{RC_NUM}\n+          ls -al /opt/apache/beam/third_party_licenses/ | wc -l\n+          ```\n   1. Publish staging artifacts\n-      1. Go to the staging repo to close the staging repository on [Apache Nexus](https://repository.apache.org/#stagingRepositories). \n+      1. Go to the staging repo to close the staging repository on [Apache Nexus](https://repository.apache.org/#stagingRepositories).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1404c6a1ab3ca7e9ff3267c7bd28e18472c33e2a"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM2NTEyNg==", "bodyText": "Removing this big chunk of text because?", "url": "https://github.com/apache/beam/pull/11764#discussion_r428365126", "createdAt": "2020-05-20T23:32:23Z", "author": {"login": "amaliujia"}, "path": "website/www/site/content/en/contribute/release-guide.md", "diffHunk": "@@ -583,189 +582,44 @@ For this step, we recommend you using automation script to create a RC, but you\n   1. Stage source release into dist.apache.org dev [repo](https://dist.apache.org/repos/dist/dev/beam/).\n   1. Stage,sign and hash python binaries into dist.apache.ord dev repo python dir\n   1. Stage SDK docker images to [docker hub Apache organization](https://hub.docker.com/search?q=apache%2Fbeam&type=image).\n-  1. Create a PR to update beam and beam-site, changes includes:\n+  1. Create a PR to update beam-site, changes includes:\n      * Copy python doc into beam-site\n      * Copy java doc into beam-site\n-     * Update release version into [_config.yml](https://github.com/apache/beam/blob/master/website/_config.yml).\n      \n #### Tasks you need to do manually\n-  1. Add new release into `website/src/get-started/downloads.md`.\n-  1. Update last release download links in `website/src/get-started/downloads.md`.\n-  1. Update `website/src/.htaccess` to redirect to the new version.\n-  1. Build and stage python wheels.\n+  1. Verify the script worked.\n+      1. Verify that the source and Python binaries are present in [dist.apache.org](https://dist.apache.org/repos/dist/dev/beam).\n+      1. Verify Docker images are published. How to find images:\n+          1. Visit [https://hub.docker.com/u/apache](https://hub.docker.com/search?q=apache%2Fbeam&type=image)\n+          2. Visit each repository and navigate to *tags* tab.\n+          3. Verify images are pushed with tags: ${RELEASE}_rc{RC_NUM}\n+      1. Verify that third party licenses are included in Docker containers by logging in to the images.\n+          - For Python SDK images, there should be around 80 ~ 100 dependencies.\n+          Please note that dependencies for the SDKs with different Python versions vary.\n+          Need to verify all Python images by replacing `${ver}` with each supported Python version `X.Y`.\n+          ```\n+          docker run -it --entrypoint=/bin/bash apache/beam_python${ver}_sdk:${RELEASE}_rc{RC_NUM}\n+          ls -al /opt/apache/beam/third_party_licenses/ | wc -l\n+          ```\n+          - For Java SDK images, there should be around 1400 dependencies.\n+          ```\n+          docker run -it --entrypoint=/bin/bash apache/beam_java_sdk:${RELEASE}_rc{RC_NUM}\n+          ls -al /opt/apache/beam/third_party_licenses/ | wc -l\n+          ```\n   1. Publish staging artifacts\n-      1. Go to the staging repo to close the staging repository on [Apache Nexus](https://repository.apache.org/#stagingRepositories). \n+      1. Go to the staging repo to close the staging repository on [Apache Nexus](https://repository.apache.org/#stagingRepositories).\n       1. When prompted for a description, enter \u201cApache Beam, version X, release candidate Y\u201d.\n-\n-\n-### (Alternative) Run all steps manually", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1404c6a1ab3ca7e9ff3267c7bd28e18472c33e2a"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM2NTk1MA==", "bodyText": "Add that ssh-add trick to cache ssh password?", "url": "https://github.com/apache/beam/pull/11764#discussion_r428365950", "createdAt": "2020-05-20T23:34:52Z", "author": {"login": "amaliujia"}, "path": "release/src/main/scripts/build_release_candidate.sh", "diffHunk": "@@ -113,7 +113,7 @@ if [[ $confirmation = \"y\" ]]; then\n   echo \"-------------Staging Java Artifacts into Maven---------------\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1404c6a1ab3ca7e9ff3267c7bd28e18472c33e2a"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79e84e98f7de076de72302a4bce9086236e1e947", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/79e84e98f7de076de72302a4bce9086236e1e947", "committedDate": "2020-05-21T16:40:06Z", "message": "Include additional instructions for staging repository."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MzU5Mjgy", "url": "https://github.com/apache/beam/pull/11764#pullrequestreview-416359282", "createdAt": "2020-05-21T17:45:57Z", "commit": {"oid": "79e84e98f7de076de72302a4bce9086236e1e947"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c3780c438bc1e3c9e314e87e8646e3f4e8972b4", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/0c3780c438bc1e3c9e314e87e8646e3f4e8972b4", "committedDate": "2020-05-21T17:54:42Z", "message": "Clarify the usage of sign_hash_python_wheels.sh."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4739, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}