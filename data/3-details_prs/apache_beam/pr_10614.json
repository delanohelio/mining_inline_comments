{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzODI4NzMz", "number": 10614, "title": "[BEAM-8695] Upgrade google-http-client to 1.34.0", "bodyText": "https://issues.apache.org/jira/browse/BEAM-8695. This revival of #10414 .\nAfter BEAM-9000, BEAM-9010, BEAM-9020, BEAM-8696, BEAM-8685,  BEAM-8676, this PR finally upgrades google-http-client dependency to 1.34.0 (the latest)!\nLinkage Check result\nThe following modules use google-http-client.\nbeam-sdks-java-io-google-cloud-platform\nbefore: https://gist.github.com/suztomo/6fd301b9694e13c0cdbbe28b5b3b239a\nafter: https://gist.github.com/suztomo/c0567987b81e80a09d9c51c868359c0a\nThis change removes one linkage error:\nsuztomo@suxtomo24:~/beam6$ diff /tmp/linkagecheck-beam-sdks-java-io-google-cloud-platform-f5e69bed /tmp/linkagecheck-beam-sdks-java-io-google-cloud-platform-40e3e72f \n16,18d15\n< Class com.google.api.client.http.apache.ApacheHttpTransport$Builder is not found;\n<   referenced by 1 class file\n<     com.google.cloud.hadoop.util.HttpTransportFactory (util-1.9.16.jar)\n8145c8142\n< BUILD SUCCESSFUL in 31s\n---\n> BUILD SUCCESSFUL in 30s\n\nbeam-sdks-java-extensions-google-cloud-platform-core\nbefore: https://gist.github.com/suztomo/3df39f73f07985602aadfbe690f41af9\nafter: https://gist.github.com/suztomo/16fbf50d1f5d63c6289d91e65d6605a8\nThis change removes one linkage error (same as above):\nsuztomo@suxtomo24:~/beam6$ diff /tmp/linkagecheck-beam-sdks-java-extensions-google-cloud-platform-core-f5e69bed /tmp/linkagecheck-beam-sdks-java-extensions-google-cloud-platform-core-40e3e72f \n16,18d15\n< Class com.google.api.client.http.apache.ApacheHttpTransport$Builder is not found;\n<   referenced by 1 class file\n<     com.google.cloud.hadoop.util.HttpTransportFactory (util-1.9.16.jar)\n32c29\n< BUILD SUCCESSFUL in 14s\n---\n> BUILD SUCCESSFUL in 12s\n\nbeam-runners-google-cloud-dataflow-java\nbefore: https://gist.github.com/suztomo/07cd43a19d6e7016878354d9b607b0c9\nafter: https://gist.github.com/suztomo/c03e8cee857dbacfd6839c1843c0d80d\nThis change removes the following linkage errors.\nsuztomo@suxtomo24:~/beam6$ diff /tmp/linkagecheck-beam-runners-google-cloud-dataflow-java-f5e69bed /tmp/linkagecheck-beam-runners-google-cloud-dataflow-java-40e3e72f \n16,18d15\n< Class com.google.api.client.http.apache.ApacheHttpTransport$Builder is not found;\n<   referenced by 1 class file\n<     com.google.cloud.hadoop.util.HttpTransportFactory (util-1.9.16.jar)\n22,27d18\n< Class io.opencensus.tags.TagMetadata$TagTtl is not found;\n<   referenced by 1 class file\n<     io.grpc.internal.testing.StatsTestUtils (grpc-testing-1.25.0.jar)\n< Class io.opencensus.tags.TagMetadata is not found;\n<   referenced by 1 class file\n<     io.grpc.internal.testing.StatsTestUtils (grpc-testing-1.25.0.jar)\n8141,8159d8131\n< (opencensus-api-0.18.0.jar) io.opencensus.trace.unsafe.ContextUtils's method getValue(io.grpc.Context arg1) is not found;\n<   referenced by 1 class file\n<     io.grpc.internal.CensusTracingModule (grpc-core-1.25.0.jar)\n< (opencensus-api-0.18.0.jar) io.opencensus.tags.TagContextBuilder's method putLocal(io.opencensus.tags.TagKey arg1, io.opencensus.tags.TagValue arg2) is not found;\n<   referenced by 2 class files\n<     io.grpc.internal.CensusStatsModule (grpc-core-1.25.0.jar)\n<     io.grpc.internal.testing.StatsTestUtils (grpc-testing-1.25.0.jar)\n< (opencensus-api-0.18.0.jar) io.opencensus.trace.unsafe.ContextUtils's method withValue(io.grpc.Context arg1, io.opencensus.trace.Span arg2) is not found;\n<   referenced by 1 class file\n<     io.grpc.internal.CensusTracingModule (grpc-core-1.25.0.jar)\n< (opencensus-api-0.18.0.jar) io.opencensus.tags.unsafe.ContextUtils's method withValue(io.grpc.Context arg1, io.opencensus.tags.TagContext arg2) is not found;\n<   referenced by 1 class file\n<     io.grpc.internal.CensusStatsModule (grpc-core-1.25.0.jar)\n< (opencensus-api-0.18.0.jar) io.opencensus.tags.unsafe.ContextUtils's method getValue(io.grpc.Context arg1) is not found;\n<   referenced by 1 class file\n<     io.grpc.internal.testing.StatsTestUtils (grpc-testing-1.25.0.jar)\n< (opencensus-api-0.18.0.jar) io.opencensus.tags.Tag's method create(io.opencensus.tags.TagKey arg1, io.opencensus.tags.TagValue arg2, io.opencensus.tags.TagMetadata arg3) is not found;\n<   referenced by 1 class file\n<     io.grpc.internal.testing.StatsTestUtils (grpc-testing-1.25.0.jar)\n8170c8142\n< BUILD SUCCESSFUL in 34s\n---\n> BUILD SUCCESSFUL in 30s\n\nNote:\n\nOld google-http-client 1.28.0 had OpenCensus 0.18.0 dependency.\nNew google-http-client 1.34.0 has OpenCensus 0.24.0 dependency.\n\nThe following artifacts are not installed to Maven local repository.\n\nbeam-sdks-java-testing-test-utils\nbeam-runners-google-cloud-dataflow-java-worker-legacy-worker\nbeam-runners-google-cloud-dataflow-java-worker\n\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-01-16T20:22:26Z", "url": "https://github.com/apache/beam/pull/10614", "merged": true, "mergeCommit": {"oid": "c78ebc513342394a1b12e0aaa663c9deca690e11"}, "closed": true, "closedAt": "2020-01-17T17:59:09Z", "author": {"login": "suztomo"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7ACN8gH2gAyMzYzODI4NzMzOjQwZTNlNzJmZTUxN2RhZDMzNDgwY2VlN2YyODNlYmQ4N2U3N2MyZGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb7SZrcAFqTM0NDczODA3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "40e3e72fe517dad33480cee7f283ebd87e77c2df", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/apache/beam/commit/40e3e72fe517dad33480cee7f283ebd87e77c2df", "committedDate": "2020-01-16T20:18:53Z", "message": "google-http-client 1.34.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40c1052ba604c448fb324a22d09172ef7478ec34", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/apache/beam/commit/40c1052ba604c448fb324a22d09172ef7478ec34", "committedDate": "2020-01-16T22:40:54Z", "message": "Fixed test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64cfcbab20300c9d1f717e771a6b401db91f28c8", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/apache/beam/commit/64cfcbab20300c9d1f717e771a6b401db91f28c8", "committedDate": "2020-01-16T23:24:22Z", "message": "Equals as per spotBugMain"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "398bcdaa548a3e3e92c902c12b3e46b0242495b1", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/apache/beam/commit/398bcdaa548a3e3e92c902c12b3e46b0242495b1", "committedDate": "2020-01-17T02:33:04Z", "message": "Added tests for equality"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NjYyMDE3", "url": "https://github.com/apache/beam/pull/10614#pullrequestreview-344662017", "createdAt": "2020-01-17T15:39:47Z", "commit": {"oid": "398bcdaa548a3e3e92c902c12b3e46b0242495b1"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxNTozOTo0N1rOFe84gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxNTo0NzoxOFrOFe9ICg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzk5OTEwNQ==", "bodyText": "Note: 1.29.2 is the latest (last) version of google-http-client-jackson.", "url": "https://github.com/apache/beam/pull/10614#discussion_r367999105", "createdAt": "2020-01-17T15:39:47Z", "author": {"login": "suztomo"}, "path": "buildSrc/src/main/groovy/org/apache/beam/gradle/BeamModulePlugin.groovy", "diffHunk": "@@ -457,10 +458,10 @@ class BeamModulePlugin implements Plugin<Project> {\n         google_cloud_dataflow_java_proto_library_all: \"com.google.cloud.dataflow:google-cloud-dataflow-java-proto-library-all:0.5.160304\",\n         google_cloud_datastore_v1_proto_client      : \"com.google.cloud.datastore:datastore-v1-proto-client:1.6.3\",\n         google_cloud_spanner                        : \"com.google.cloud:google-cloud-spanner:$google_cloud_spanner_version\",\n-        google_http_client                          : \"com.google.http-client:google-http-client:$google_clients_version\",\n-        google_http_client_jackson                  : \"com.google.http-client:google-http-client-jackson:$google_clients_version\",\n-        google_http_client_jackson2                 : \"com.google.http-client:google-http-client-jackson2:$google_clients_version\",\n-        google_http_client_protobuf                 : \"com.google.http-client:google-http-client-protobuf:$google_clients_version\",\n+        google_http_client                          : \"com.google.http-client:google-http-client:$google_http_clients_version\",\n+        google_http_client_jackson                  : \"com.google.http-client:google-http-client-jackson:1.29.2\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "398bcdaa548a3e3e92c902c12b3e46b0242495b1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzk5OTI5Mw==", "bodyText": "This is for EqualsTester.", "url": "https://github.com/apache/beam/pull/10614#discussion_r367999293", "createdAt": "2020-01-17T15:40:11Z", "author": {"login": "suztomo"}, "path": "runners/google-cloud-dataflow-java/build.gradle", "diffHunk": "@@ -83,6 +83,7 @@ dependencies {\n   compile library.java.slf4j_api\n   compile library.java.vendored_grpc_1_26_0\n   testCompile library.java.hamcrest_core\n+  testCompile library.java.guava_testlib", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "398bcdaa548a3e3e92c902c12b3e46b0242495b1"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAwMTY3OQ==", "bodyText": "Overriding equals because spotBugsMain complained as below:\n\nGoogle-http-client's GenericData has its own equals method (googleapis/google-http-java-client#589) now.", "url": "https://github.com/apache/beam/pull/10614#discussion_r368001679", "createdAt": "2020-01-17T15:44:37Z", "author": {"login": "suztomo"}, "path": "runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/util/CloudObject.java", "diffHunk": "@@ -182,4 +183,18 @@ public String getClassName() {\n   public CloudObject clone() {\n     return (CloudObject) super.clone();\n   }\n+\n+  @Override\n+  public boolean equals(Object otherObject) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "398bcdaa548a3e3e92c902c12b3e46b0242495b1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAwMjA4OQ==", "bodyText": "Same reason as CloudObject.", "url": "https://github.com/apache/beam/pull/10614#discussion_r368002089", "createdAt": "2020-01-17T15:45:25Z", "author": {"login": "suztomo"}, "path": "runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/util/OutputReference.java", "diffHunk": "@@ -40,4 +41,21 @@ public OutputReference(String stepName, String outputName) {\n     this.stepName = checkNotNull(stepName);\n     this.outputName = checkNotNull(outputName);\n   }\n+\n+  @Override\n+  public boolean equals(Object otherObject) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "398bcdaa548a3e3e92c902c12b3e46b0242495b1"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAwMzA4Mg==", "bodyText": "GenericData now has its own toString implementation\ngoogleapis/google-http-java-client#589. Previously it was AbstractMap's toString.", "url": "https://github.com/apache/beam/pull/10614#discussion_r368003082", "createdAt": "2020-01-17T15:47:18Z", "author": {"login": "suztomo"}, "path": "runners/google-cloud-dataflow-java/worker/src/test/java/org/apache/beam/runners/dataflow/worker/testing/GenericJsonMatcherTest.java", "diffHunk": "@@ -53,7 +53,9 @@ public void testMatchFailure() {\n       assertThat(actual, is(jsonOf(expected)));\n     } catch (AssertionError ex) {\n       assertEquals(\n-          \"\\nExpected: is {\\\"foo\\\":\\\"expected\\\"}\\n     but: was <{foo=actual}>\", ex.getMessage());\n+          \"\\nExpected: is {\\\"foo\\\":\\\"expected\\\"}\\n\"\n+              + \"     but: was <GenericData{classInfo=[], {foo=actual}}>\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "398bcdaa548a3e3e92c902c12b3e46b0242495b1"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0NzM4MDc1", "url": "https://github.com/apache/beam/pull/10614#pullrequestreview-344738075", "createdAt": "2020-01-17T17:42:48Z", "commit": {"oid": "398bcdaa548a3e3e92c902c12b3e46b0242495b1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3487, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}