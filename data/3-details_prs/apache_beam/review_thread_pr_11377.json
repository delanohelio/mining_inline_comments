{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxODcwMzQ1", "number": 11377, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNToyMDo0MFrOD6TIcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNToyMDo0MFrOD6TIcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYyNDU3NDU4OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/kinesis/src/main/java/org/apache/beam/sdk/io/kinesis/ShardRecordsIterator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxNToyMDo0MFrOGSDutg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxOToyNjoxN1rOGSM_VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU4ODY2Mg==", "bodyText": "Why AtomicReference no more used here?", "url": "https://github.com/apache/beam/pull/11377#discussion_r421588662", "createdAt": "2020-05-07T15:20:40Z", "author": {"login": "aromanenko-dev"}, "path": "sdks/java/io/kinesis/src/main/java/org/apache/beam/sdk/io/kinesis/ShardRecordsIterator.java", "diffHunk": "@@ -43,22 +42,23 @@\n   private final RecordFilter filter;\n   private final String streamName;\n   private final String shardId;\n-  private AtomicReference<ShardCheckpoint> checkpoint;\n+  private final AtomicReference<ShardCheckpoint> checkpoint;\n+  private final WatermarkPolicy watermarkPolicy;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e182c6abc8e265f3e4b670747d448df70bb7bb0"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0MDM3Mw==", "bodyText": "I don't know why it was used in the first place, maybe it was some leftover after some previous changes to the code. The value of watermarkPolicy is only set in constructor and then only accessed (never changed), so there's no need to have an AtomicReference for that. From the perspective of memory visiblity, making the field as final ensures that the value of the field is correctly published to other threads, so there's no difference also in that aspect.", "url": "https://github.com/apache/beam/pull/11377#discussion_r421740373", "createdAt": "2020-05-07T19:26:17Z", "author": {"login": "sgraca"}, "path": "sdks/java/io/kinesis/src/main/java/org/apache/beam/sdk/io/kinesis/ShardRecordsIterator.java", "diffHunk": "@@ -43,22 +42,23 @@\n   private final RecordFilter filter;\n   private final String streamName;\n   private final String shardId;\n-  private AtomicReference<ShardCheckpoint> checkpoint;\n+  private final AtomicReference<ShardCheckpoint> checkpoint;\n+  private final WatermarkPolicy watermarkPolicy;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTU4ODY2Mg=="}, "originalCommit": {"oid": "1e182c6abc8e265f3e4b670747d448df70bb7bb0"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1469, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}