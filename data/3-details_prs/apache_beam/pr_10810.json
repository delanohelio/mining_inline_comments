{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyNzkxMTM5", "number": 10810, "title": "[BEAM-9274] Support running yapf in a git pre-commit hook", "bodyText": "With this config in place, setting up your local repo to run yapf in a pre-commit hook is as simple as this:\npip install pre-commit\npre-commit install\n\nMore info here: https://pre-commit.com/\nThe great thing about pre-commit is that it supports runnings tools written in various languages, using various sanboxing strategies like virtualenvs and docker images.\nI'd eventually like to grow this config to include any linters or autoformatters that can be run quickly:\n\nisort (in auto-fix mode)\npylint\nspotless\nmypy (maybe.  at 10s this is borderline too slow.  the daemon will be faster, but it can be prone to error)\n\nA registered pre-commit tool will only run if a modified file matches the file types and patterns specified for the tool.\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-02-09T05:14:20Z", "url": "https://github.com/apache/beam/pull/10810", "merged": true, "mergeCommit": {"oid": "da6f759aed5866c12475b23940446eef25c7bd48"}, "closed": true, "closedAt": "2020-03-07T01:05:05Z", "author": {"login": "chadrik"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcChl90ABqjMwMjAzNTQzNTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKfVVUgBqjMwOTg5OTI1Nzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d5c430f8db3b3dfa4f5589779fa15b1fd0108bee", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/d5c430f8db3b3dfa4f5589779fa15b1fd0108bee", "committedDate": "2020-02-09T04:57:52Z", "message": "Support running yapf in a git pre-commit hook"}, "afterCommit": {"oid": "4fe1e45c2eac3e2f8bd190e004cd12597bf4f5d9", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/4fe1e45c2eac3e2f8bd190e004cd12597bf4f5d9", "committedDate": "2020-02-09T05:22:04Z", "message": "Support running yapf in a git pre-commit hook"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2MjA1Mjg3", "url": "https://github.com/apache/beam/pull/10810#pullrequestreview-356205287", "createdAt": "2020-02-10T19:33:22Z", "commit": {"oid": "4fe1e45c2eac3e2f8bd190e004cd12597bf4f5d9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxOTozMzoyM1rOFny1fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQxOTozMzoyM1rOFny1fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI3MTY3OA==", "bodyText": "Please add a similar comment in tox.ini.", "url": "https://github.com/apache/beam/pull/10810#discussion_r377271678", "createdAt": "2020-02-10T19:33:23Z", "author": {"login": "udim"}, "path": ".pre-commit-config.yaml", "diffHunk": "@@ -0,0 +1,32 @@\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+# http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+repos:\n+  - repo: https://github.com/pre-commit/mirrors-yapf\n+    # this rev is a release tag in the repo above and corresponds with a yapf\n+    # version. make sure this matches the version of yapf in tox.ini.\n+    rev: v0.29.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4fe1e45c2eac3e2f8bd190e004cd12597bf4f5d9"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2OTM4NDUy", "url": "https://github.com/apache/beam/pull/10810#pullrequestreview-356938452", "createdAt": "2020-02-11T19:37:35Z", "commit": {"oid": "4fe1e45c2eac3e2f8bd190e004cd12597bf4f5d9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxOTozNzozNlrOFoWblg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxOTozNzozNlrOFoWblg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NDg3MA==", "bodyText": "What happens if we don't keep these in sync? Will we run yapf unnecessarily (OK) or skip it when we should run it?", "url": "https://github.com/apache/beam/pull/10810#discussion_r377854870", "createdAt": "2020-02-11T19:37:36Z", "author": {"login": "robertwb"}, "path": ".pre-commit-config.yaml", "diffHunk": "@@ -0,0 +1,32 @@\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+# http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+repos:\n+  - repo: https://github.com/pre-commit/mirrors-yapf\n+    # this rev is a release tag in the repo above and corresponds with a yapf\n+    # version. make sure this matches the version of yapf in tox.ini.\n+    rev: v0.29.0\n+    hooks:\n+      - id: yapf\n+        files: ^sdks/python/apache_beam/\n+        # keep these in sync with sdks/python/.yapfignore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4fe1e45c2eac3e2f8bd190e004cd12597bf4f5d9"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4fe1e45c2eac3e2f8bd190e004cd12597bf4f5d9", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/4fe1e45c2eac3e2f8bd190e004cd12597bf4f5d9", "committedDate": "2020-02-09T05:22:04Z", "message": "Support running yapf in a git pre-commit hook"}, "afterCommit": {"oid": "f547fe32b71ae91ed9776d00d5bcc37ab17cffe1", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/f547fe32b71ae91ed9776d00d5bcc37ab17cffe1", "committedDate": "2020-03-02T22:20:43Z", "message": "[BEAM-9274] Support running yapf in a git pre-commit hook"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f547fe32b71ae91ed9776d00d5bcc37ab17cffe1", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/f547fe32b71ae91ed9776d00d5bcc37ab17cffe1", "committedDate": "2020-03-02T22:20:43Z", "message": "[BEAM-9274] Support running yapf in a git pre-commit hook"}, "afterCommit": {"oid": "ccdcc22f84943f98ca12384e4afceb72b2194e6f", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/ccdcc22f84943f98ca12384e4afceb72b2194e6f", "committedDate": "2020-03-03T05:39:10Z", "message": "Support running yapf in a git pre-commit hook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e07e65b67f9cef21cd295feef955e448d253d70d", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/e07e65b67f9cef21cd295feef955e448d253d70d", "committedDate": "2020-03-03T18:33:38Z", "message": "[BEAM-9274] Support running yapf in a git pre-commit hook"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ccdcc22f84943f98ca12384e4afceb72b2194e6f", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/ccdcc22f84943f98ca12384e4afceb72b2194e6f", "committedDate": "2020-03-03T05:39:10Z", "message": "Support running yapf in a git pre-commit hook"}, "afterCommit": {"oid": "e07e65b67f9cef21cd295feef955e448d253d70d", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/e07e65b67f9cef21cd295feef955e448d253d70d", "committedDate": "2020-03-03T18:33:38Z", "message": "[BEAM-9274] Support running yapf in a git pre-commit hook"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzI3NTk3", "url": "https://github.com/apache/beam/pull/10810#pullrequestreview-368327597", "createdAt": "2020-03-03T21:12:19Z", "commit": {"oid": "e07e65b67f9cef21cd295feef955e448d253d70d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e07e65b67f9cef21cd295feef955e448d253d70d", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/e07e65b67f9cef21cd295feef955e448d253d70d", "committedDate": "2020-03-03T18:33:38Z", "message": "[BEAM-9274] Support running yapf in a git pre-commit hook"}, "afterCommit": {"oid": "ccdcc22f84943f98ca12384e4afceb72b2194e6f", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/ccdcc22f84943f98ca12384e4afceb72b2194e6f", "committedDate": "2020-03-03T05:39:10Z", "message": "Support running yapf in a git pre-commit hook"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ccdcc22f84943f98ca12384e4afceb72b2194e6f", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/ccdcc22f84943f98ca12384e4afceb72b2194e6f", "committedDate": "2020-03-03T05:39:10Z", "message": "Support running yapf in a git pre-commit hook"}, "afterCommit": {"oid": "e07e65b67f9cef21cd295feef955e448d253d70d", "author": {"user": {"login": "chadrik", "name": "Chad Dombrova"}}, "url": "https://github.com/apache/beam/commit/e07e65b67f9cef21cd295feef955e448d253d70d", "committedDate": "2020-03-03T18:33:38Z", "message": "[BEAM-9274] Support running yapf in a git pre-commit hook"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3016, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}