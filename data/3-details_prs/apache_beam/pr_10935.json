{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4NTI2MTg3", "number": 10935, "title": "[BEAM-9296] Clean up and add type-hints to SDF API", "bodyText": "R: @chadrik\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-02-22T00:29:21Z", "url": "https://github.com/apache/beam/pull/10935", "merged": true, "mergeCommit": {"oid": "3169579df6177910bf83f44db8e9160ec878692f"}, "closed": true, "closedAt": "2020-02-24T23:57:54Z", "author": {"login": "boyuanzz"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGpLhLgH2gAyMzc4NTI2MTg3OmMyZGZhOGQ2NzQzYWVhMWM2OWI0MWUyMzJmNWIyOTA5N2MwMjI5ZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcHlqVmgH2gAyMzc4NTI2MTg3OjExMTdmNDc3MjA0N2M1YjhmMzZmNzRkYzBiYjVmNjBjODkyNDcwZjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c2dfa8d6743aea1c69b41e232f5b29097c0229d4", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/c2dfa8d6743aea1c69b41e232f5b29097c0229d4", "committedDate": "2020-02-22T00:28:19Z", "message": "Clean up and add type-hints to SDF API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDQ2NDU2", "url": "https://github.com/apache/beam/pull/10935#pullrequestreview-363046456", "createdAt": "2020-02-22T19:31:28Z", "commit": {"oid": "c2dfa8d6743aea1c69b41e232f5b29097c0229d4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxOTozMToyOFrOFtMiAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxOTozNTo1M1rOFtMjKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNTU1NA==", "bodyText": "Our linters do not enforce alphanumeric order for modules inside the TYPE_CHECKING block, but we should still be diligent about it.  Can you move this up one, please.", "url": "https://github.com/apache/beam/pull/10935#discussion_r382935554", "createdAt": "2020-02-22T19:31:28Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/runners/sdf_utils.py", "diffHunk": "@@ -38,6 +38,8 @@\n \n if TYPE_CHECKING:\n   from apache_beam.io.iobase import RestrictionTracker\n+  from apache_beam.io.iobase import RestrictionProgress", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2dfa8d6743aea1c69b41e232f5b29097c0229d4"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNTg0OQ==", "bodyText": "A slight refactor here will avoid introducing a new mypy error:\n  def get_restriction_coder(self):\n    # type: () -> Optional[TupleCoder]\n    \"\"\"Get coder for a restriction when processing an SDF. \"\"\"\n    if self.is_splittable_dofn():\n      return TupleCoder([\n          (self.get_restriction_provider().restriction_coder()),\n          (self.get_watermark_estimator_provider().estimator_state_coder())\n      ])\n    else:\n      return None\nThis avoids having to declare  the restriction_coder variable as Optional[TupleCoder].", "url": "https://github.com/apache/beam/pull/10935#discussion_r382935849", "createdAt": "2020-02-22T19:35:53Z", "author": {"login": "chadrik"}, "path": "sdks/python/apache_beam/runners/common.py", "diffHunk": "@@ -333,6 +336,7 @@ def is_splittable_dofn(self):\n     return self.get_restriction_provider() is not None\n \n   def get_restriction_coder(self):\n+    # type: () -> Optional[TupleCoder]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2dfa8d6743aea1c69b41e232f5b29097c0229d4"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43e0f645d6b9cd1401ef8cea42c7c2ef71a39085", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/43e0f645d6b9cd1401ef8cea42c7c2ef71a39085", "committedDate": "2020-02-24T22:54:49Z", "message": "Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1117f4772047c5b8f36f74dc0bb5f60c892470f3", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/1117f4772047c5b8f36f74dc0bb5f60c892470f3", "committedDate": "2020-02-24T22:56:17Z", "message": "Address comments again"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2852, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}