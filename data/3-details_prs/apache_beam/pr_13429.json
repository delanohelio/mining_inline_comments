{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3Njc2NzQ4", "number": 13429, "title": "Add start_times to MonitoringInfos and populate them in the python SDK", "bodyText": "Add start_times to MonitoringInfos and populate them in the python SDK\nStart time indicates when the first value was populated by the SDK Harness. This is needed by some external metric aggregation services to indicate when the reporter of the metric first began collecting the cumulative value for the timeseries. If the SDK Harness restarts, it should reset the start_time, and reset the collection of cumulative metrics (i.e. start to count again from 0). HarnessMonitoringInfos should set this start_time once, when the MonitoringInfo is first reported. ProcessBundle MonitoringInfos should set a start_time for each bundle.\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-11-25T20:25:25Z", "url": "https://github.com/apache/beam/pull/13429", "merged": true, "mergeCommit": {"oid": "eca935bc36036dd11c5f2bd20052b08049375bfc"}, "closed": true, "closedAt": "2020-12-02T14:50:30Z", "author": {"login": "ajamato"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgFmOEgFqTUzODg2NjM0OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiFpbPABqjQwNjAxODkyMzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4ODY2MzQ4", "url": "https://github.com/apache/beam/pull/13429#pullrequestreview-538866348", "createdAt": "2020-11-25T21:50:40Z", "commit": {"oid": "9f4f1ea96347d1016794cd2b5c132775270f050c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQyMTo1MDo0MVrOH6E5qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQyMTo1Mzo0N1rOH6E-Bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDY1OTc1Mg==", "bodyText": "Could simplify this a bit by putting the start time logic in MetricCell.to_runner_api_monitoring_info and having that call a to_runner_api_monitoring_info_impl on each of the subclasses", "url": "https://github.com/apache/beam/pull/13429#discussion_r530659752", "createdAt": "2020-11-25T21:50:41Z", "author": {"login": "dpmills"}, "path": "sdks/python/apache_beam/metrics/cells.py", "diffHunk": "@@ -77,6 +79,13 @@ def reset(self):\n     # type: () -> None\n     raise NotImplementedError\n \n+  @property\n+  def start_time(self):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f4f1ea96347d1016794cd2b5c132775270f050c"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDY2MDg3MA==", "bodyText": "Maybe \"This indicates the start of the time range over which this value was measured\"?", "url": "https://github.com/apache/beam/pull/13429#discussion_r530660870", "createdAt": "2020-11-25T21:53:47Z", "author": {"login": "dpmills"}, "path": "model/pipeline/src/main/proto/metrics.proto", "diffHunk": "@@ -401,6 +402,17 @@ message MonitoringInfo {\n   // as Stackdriver will be able to aggregate the metrics using a subset of the\n   // provided labels\n   map<string, string> labels = 4;\n+\n+  // This indicates when the first value was populated by the SDK Harness.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f4f1ea96347d1016794cd2b5c132775270f050c"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9f4f1ea96347d1016794cd2b5c132775270f050c", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/9f4f1ea96347d1016794cd2b5c132775270f050c", "committedDate": "2020-11-25T20:23:45Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}, "afterCommit": {"oid": "96fdaba4e6b16807887d659569bf2800d939a5a4", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/96fdaba4e6b16807887d659569bf2800d939a5a4", "committedDate": "2020-12-02T01:24:34Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "96fdaba4e6b16807887d659569bf2800d939a5a4", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/96fdaba4e6b16807887d659569bf2800d939a5a4", "committedDate": "2020-12-02T01:24:34Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}, "afterCommit": {"oid": "8009b5a939578cfb00909c4797a0490089f4289a", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/8009b5a939578cfb00909c4797a0490089f4289a", "committedDate": "2020-12-02T01:26:48Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8009b5a939578cfb00909c4797a0490089f4289a", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/8009b5a939578cfb00909c4797a0490089f4289a", "committedDate": "2020-12-02T01:26:48Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}, "afterCommit": {"oid": "53d8847f9263f972d981c2a4806ccb280f965476", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/53d8847f9263f972d981c2a4806ccb280f965476", "committedDate": "2020-12-02T02:12:17Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "53d8847f9263f972d981c2a4806ccb280f965476", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/53d8847f9263f972d981c2a4806ccb280f965476", "committedDate": "2020-12-02T02:12:17Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}, "afterCommit": {"oid": "c2364c1d92acc8a10756a336eb4a88434fec3640", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/c2364c1d92acc8a10756a336eb4a88434fec3640", "committedDate": "2020-12-02T02:16:00Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c25bc082e809246989ca8a459c36c5b4d247f20", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/6c25bc082e809246989ca8a459c36c5b4d247f20", "committedDate": "2020-12-02T02:19:55Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c2364c1d92acc8a10756a336eb4a88434fec3640", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/c2364c1d92acc8a10756a336eb4a88434fec3640", "committedDate": "2020-12-02T02:16:00Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}, "afterCommit": {"oid": "6c25bc082e809246989ca8a459c36c5b4d247f20", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/6c25bc082e809246989ca8a459c36c5b4d247f20", "committedDate": "2020-12-02T02:19:55Z", "message": "Add start_times to MonitoringInfos and populate them in the python SDK"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4583, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}