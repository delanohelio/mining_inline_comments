{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5Nzc3NzIw", "number": 13444, "title": "[BEAM-11363] Create `:sdks:java:extensions:ml:integrationTest` target, run in Java PostCommit", "bodyText": "Instead of running IT classes in the :test task, this PR runs them in a separate :integrationTest task, which is run by the Java PostCommit.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-11-30T19:58:46Z", "url": "https://github.com/apache/beam/pull/13444", "merged": true, "mergeCommit": {"oid": "0a4bdb16a332e3b48b79486f1cda5c7a366cdf49"}, "closed": true, "closedAt": "2020-12-03T18:12:31Z", "author": {"login": "TheNeuralBit"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdhq5ojAH2gAyNTI5Nzc3NzIwOjQyZGY5Nzc5MTk5ZGFmMTQ2MDU5ZmQ0YTZjOTVjMGVhODczMDAyYTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdinOB-gFqTU0NDI0MzkzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "42df9779199daf146059fd4a6c95c0ea873002a1", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/42df9779199daf146059fd4a6c95c0ea873002a1", "committedDate": "2020-11-30T19:55:42Z", "message": "creates :sdks:java:extensions:ml:integrationTest target, run in java PostCommit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MjQzODgx", "url": "https://github.com/apache/beam/pull/13444#pullrequestreview-544243881", "createdAt": "2020-12-03T18:12:13Z", "commit": {"oid": "42df9779199daf146059fd4a6c95c0ea873002a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoxMjoxM1rOH-qTyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoxMjoxM1rOH-qTyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ2Njk1Mg==", "bodyText": "Just want to note that \"UP-TO-DATE\" and \"FROM-CACHE\" are two different Gradle statuses for a task. I presume if it is never up to date it is also never cached...", "url": "https://github.com/apache/beam/pull/13444#discussion_r535466952", "createdAt": "2020-12-03T18:12:13Z", "author": {"login": "kennknowles"}, "path": "sdks/java/extensions/ml/build.gradle", "diffHunk": "@@ -44,11 +44,30 @@ dependencies {\n     testRuntimeOnly project(\":runners:google-cloud-dataflow-java\")\n }\n \n-project.test {\n-    def gcpProject = project.findProperty(\"gcpProject\") ?: 'apache-beam-testing'\n-    include \"**/**IT.class\"\n-    def pipelineOptions = [\n-            \"--project=${gcpProject}\"\n-    ]\n-    systemProperty \"beamTestPipelineOptions\", JsonOutput.toJson(pipelineOptions)\n+/**\n+ * These are integration tests with the GCP ML services and the DirectRunner.\n+ */\n+task integrationTest(type: Test) {\n+  group = \"Verification\"\n+  def gcpProject = project.findProperty('gcpProject') ?: 'apache-beam-testing'\n+  def gcpTempRoot = project.findProperty('gcpTempRoot') ?: 'gs://temp-storage-for-end-to-end-tests'\n+  systemProperty \"beamTestPipelineOptions\", JsonOutput.toJson([\n+          \"--runner=DirectRunner\",\n+          \"--project=${gcpProject}\",\n+          \"--tempRoot=${gcpTempRoot}\",\n+  ])\n+\n+  // Disable Gradle cache: these ITs interact with live service that should always be considered \"out of date\"\n+  outputs.upToDateWhen { false }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42df9779199daf146059fd4a6c95c0ea873002a1"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MjQzOTMy", "url": "https://github.com/apache/beam/pull/13444#pullrequestreview-544243932", "createdAt": "2020-12-03T18:12:17Z", "commit": {"oid": "42df9779199daf146059fd4a6c95c0ea873002a1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4652, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}