{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4NzY3NzIw", "number": 11939, "title": "[BEAM-10197] Support typehints for Python's frozenset", "bodyText": "This PR improves Beam's parameterized type hint coverage by adding support for Python's frozenset container. Type annotations should now work with frozenset, typing.FrozenSet, and typehints.FrozenSet.\nThe same level of unit test coverage that exists for set has been added for frozenset. When possible, similar tests were refactored via inheritance to support both set and frozenset to make the code extensible and reduce code duplication.\nThe website documentation here has been updated to reflect these changes.\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-06-05T21:17:40Z", "url": "https://github.com/apache/beam/pull/11939", "merged": true, "mergeCommit": {"oid": "80de47655c90594eead2f51eece206e8c4fe0227"}, "closed": true, "closedAt": "2020-07-10T19:16:01Z", "author": {"login": "saavannanavati"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoa37CAFqTQyNTY1NTQ4MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABczAW3sAH2gAyNDI4NzY3NzIwOjc1N2ZmNGMzMDRlOTkxODBkZTk5NTEzZmMwYmI1YjQxMTM3ZTM1ZDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NjU1NDgx", "url": "https://github.com/apache/beam/pull/11939#pullrequestreview-425655481", "createdAt": "2020-06-05T22:07:26Z", "commit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQyMjowNzoyNlrOGf-sZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQyMjoxMzoyNlrOGf-y3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4NjIxNA==", "bodyText": "If BaseSetHintTest inherited from TypeHintTestCase you could avoid multiple inheritance in the sub-classes below.", "url": "https://github.com/apache/beam/pull/11939#discussion_r436186214", "createdAt": "2020-06-05T22:07:26Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -612,54 +613,70 @@ def test_match_type_variables(self):\n                      hint.match_type_variables(typehints.Dict[int, str]))\n \n \n-class SetHintTestCase(TypeHintTestCase):\n+class BaseSetHintTest:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4Nzg3MQ==", "bodyText": "You should omit *args, **kwargs if there aren't any more args allowed. This is the style we follow in this codebase. Here and below as well.\nFor example: if some code called BaseSetHintTest('Set', set, typehints.Set, typehints.FrozenSet) would you rather it be silently ignored or raised as an incorrect number of arguments?", "url": "https://github.com/apache/beam/pull/11939#discussion_r436187871", "createdAt": "2020-06-05T22:13:26Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -612,54 +613,70 @@ def test_match_type_variables(self):\n                      hint.match_type_variables(typehints.Dict[int, str]))\n \n \n-class SetHintTestCase(TypeHintTestCase):\n+class BaseSetHintTest:\n+  def __init__(self, string_type, py_type, beam_type, *args, **kwargs):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NTA3MTcx", "url": "https://github.com/apache/beam/pull/11939#pullrequestreview-426507171", "createdAt": "2020-06-08T18:32:33Z", "commit": {"oid": "970f2ce55ca4478a1106f0ba40068759198a2f3b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxODozMjozM1rOGgq7Hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxODozMjozM1rOGgq7Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkxMDg3OA==", "bodyText": "This is fine, but I would leave method_name out. We don't use this feature", "url": "https://github.com/apache/beam/pull/11939#discussion_r436910878", "createdAt": "2020-06-08T18:32:33Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -615,8 +615,8 @@ def test_match_type_variables(self):\n \n class BaseSetHintTest:\n   class CommonTests(TypeHintTestCase):\n-    def __init__(self, string_type, py_type, beam_type, *args, **kwargs):\n-      super().__init__(*args, **kwargs)\n+    def __init__(self, string_type, py_type, beam_type, method_name='runTest'):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "970f2ce55ca4478a1106f0ba40068759198a2f3b"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NTA5OTky", "url": "https://github.com/apache/beam/pull/11939#pullrequestreview-426509992", "createdAt": "2020-06-08T18:36:35Z", "commit": {"oid": "970f2ce55ca4478a1106f0ba40068759198a2f3b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NTI2Nzg1", "url": "https://github.com/apache/beam/pull/11939#pullrequestreview-426526785", "createdAt": "2020-06-08T18:56:09Z", "commit": {"oid": "970f2ce55ca4478a1106f0ba40068759198a2f3b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cfeba6c2c8b13a96b9c44cec1c73bd3229c6c153", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/cfeba6c2c8b13a96b9c44cec1c73bd3229c6c153", "committedDate": "2020-06-08T20:41:26Z", "message": "Fixed broken test by removing name comparison from the TypeVariable equality check"}, "afterCommit": {"oid": "d6b7d0eb9ead0d9f841f94fb035c2e814398745b", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/d6b7d0eb9ead0d9f841f94fb035c2e814398745b", "committedDate": "2020-06-09T01:09:31Z", "message": "Merge remote-tracking branch 'origin/master' into BEAM-10197-support-frozenset-typehints"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6b7d0eb9ead0d9f841f94fb035c2e814398745b", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/d6b7d0eb9ead0d9f841f94fb035c2e814398745b", "committedDate": "2020-06-09T01:09:31Z", "message": "Merge remote-tracking branch 'origin/master' into BEAM-10197-support-frozenset-typehints"}, "afterCommit": {"oid": "ff6ee7be7507dbf8930ac2e7b299a34e2f211dfc", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/ff6ee7be7507dbf8930ac2e7b299a34e2f211dfc", "committedDate": "2020-06-09T01:17:30Z", "message": "Merge remote-tracking branch 'origin/master' into BEAM-10197-support-frozenset-typehints"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c909a79cac501e0c324e22eb24dc6f109ad4b68", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/5c909a79cac501e0c324e22eb24dc6f109ad4b68", "committedDate": "2020-06-15T23:13:10Z", "message": "BEAM 10197 - Support typehints for frozenset"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2c370a50eae9e65ff5ad22ff8b58c29abbd7840", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/d2c370a50eae9e65ff5ad22ff8b58c29abbd7840", "committedDate": "2020-06-15T23:13:10Z", "message": "Added unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd99a9f50127033ea682fae51209a0a446a790c9", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/cd99a9f50127033ea682fae51209a0a446a790c9", "committedDate": "2020-06-15T23:13:10Z", "message": "Add additional unit tests for FrozenSet by refactoring existing Set tests with inheritance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20f4f30ddd5ca634b0703a8c33f0181419648e53", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/20f4f30ddd5ca634b0703a8c33f0181419648e53", "committedDate": "2020-06-15T23:13:10Z", "message": "Fixup: apply YAPF"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9916b82c7080732f1b51abaff562465e7e1d217e", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/9916b82c7080732f1b51abaff562465e7e1d217e", "committedDate": "2020-06-15T23:13:10Z", "message": "Update Python type safety documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0aa6e696734970d8a5a5bb59091c995c65cc60c8", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/0aa6e696734970d8a5a5bb59091c995c65cc60c8", "committedDate": "2020-06-15T23:13:10Z", "message": "Refactor unit test design from multiple inheritance to single inheritance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "820300032f2bc16f57fdda4e54fc9dca56e41e1e", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/820300032f2bc16f57fdda4e54fc9dca56e41e1e", "committedDate": "2020-06-15T23:13:10Z", "message": "Remove unnecessary *args, **kwargs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5931a401b3c70ac720d989ce70160da3d9a66706", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/5931a401b3c70ac720d989ce70160da3d9a66706", "committedDate": "2020-06-15T23:13:10Z", "message": "Fixed broken test by adding a test-only kwarg used in TypeVariable equality checks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88e7e4f8f1f23fb035b4630fe84a6372df7ec2aa", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/88e7e4f8f1f23fb035b4630fe84a6372df7ec2aa", "committedDate": "2020-06-15T23:15:49Z", "message": "Rebase with master"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff6ee7be7507dbf8930ac2e7b299a34e2f211dfc", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/ff6ee7be7507dbf8930ac2e7b299a34e2f211dfc", "committedDate": "2020-06-09T01:17:30Z", "message": "Merge remote-tracking branch 'origin/master' into BEAM-10197-support-frozenset-typehints"}, "afterCommit": {"oid": "88e7e4f8f1f23fb035b4630fe84a6372df7ec2aa", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/88e7e4f8f1f23fb035b4630fe84a6372df7ec2aa", "committedDate": "2020-06-15T23:15:49Z", "message": "Rebase with master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxMTAwODE4", "url": "https://github.com/apache/beam/pull/11939#pullrequestreview-431100818", "createdAt": "2020-06-16T01:37:32Z", "commit": {"oid": "5931a401b3c70ac720d989ce70160da3d9a66706"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwMTozNzozMlrOGkIPmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwMTozNzozMlrOGkIPmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUzNjk4NA==", "bodyText": "I think the logic here is reversed? (I don't see ignore_name used in any test in this commit.)\nAbout naming: (optional ideas)\n\nI'd recommend to be more descriptive about when name is ignored. Ex: ignore_name_in_eq\nI find using positive variable names easier to reason about. if use_name_in_eq is easier to read than if not ignore_name_in_eq.", "url": "https://github.com/apache/beam/pull/11939#discussion_r440536984", "createdAt": "2020-06-16T01:37:32Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints.py", "diffHunk": "@@ -435,10 +435,14 @@ def type_check(self, instance):\n \n \n class TypeVariable(AnyTypeConstraint):\n-  def __init__(self, name):\n+  def __init__(self, name, ignore_name=False):\n     self.name = name\n+    self.ignore_name = ignore_name\n \n   def __eq__(self, other):\n+    if self.ignore_name:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5931a401b3c70ac720d989ce70160da3d9a66706"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "870a53736073e4a8da86c4bd1c0189290cedd1af", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/870a53736073e4a8da86c4bd1c0189290cedd1af", "committedDate": "2020-06-16T19:59:06Z", "message": "Fixing TypeVariable's __eq__ and adding unit tests"}, "afterCommit": {"oid": "88df478b030f7f5821951de2fa89c9ecb6d5c370", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/88df478b030f7f5821951de2fa89c9ecb6d5c370", "committedDate": "2020-06-16T20:08:05Z", "message": "Fixing TypeVariable's __eq__ and adding unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "141467b700425417d5333266d28f3ccdd41fdfe4", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/141467b700425417d5333266d28f3ccdd41fdfe4", "committedDate": "2020-06-16T20:13:48Z", "message": "Fixing TypeVariable's __eq__ and adding unit tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88df478b030f7f5821951de2fa89c9ecb6d5c370", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/88df478b030f7f5821951de2fa89c9ecb6d5c370", "committedDate": "2020-06-16T20:08:05Z", "message": "Fixing TypeVariable's __eq__ and adding unit tests"}, "afterCommit": {"oid": "141467b700425417d5333266d28f3ccdd41fdfe4", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/141467b700425417d5333266d28f3ccdd41fdfe4", "committedDate": "2020-06-16T20:13:48Z", "message": "Fixing TypeVariable's __eq__ and adding unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0796eb9682c2260e0fb7a877f780b2ca179bd35f", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/0796eb9682c2260e0fb7a877f780b2ca179bd35f", "committedDate": "2020-07-07T20:42:26Z", "message": "Alphabetically sort imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62b980308084e04ef009a3b6971e7b5c7aa28931", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/62b980308084e04ef009a3b6971e7b5c7aa28931", "committedDate": "2020-07-08T19:44:34Z", "message": "Fix lint errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "757ff4c304e99180de99513fc0bb5b41137e35d6", "author": {"user": {"login": "saavannanavati", "name": "Saavan Nanavati"}}, "url": "https://github.com/apache/beam/commit/757ff4c304e99180de99513fc0bb5b41137e35d6", "committedDate": "2020-07-08T20:21:12Z", "message": "Alphabetically order imports"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4117, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}