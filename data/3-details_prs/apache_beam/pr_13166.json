{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4MTYzMjYy", "number": 13166, "title": "[BEAM-11091] Allow to specify coder for HadoopFormatIO.Read", "bodyText": "[BEAM-11091] Allow to specify coder for HadoopFormatIO.Read\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-10-22T09:51:51Z", "url": "https://github.com/apache/beam/pull/13166", "merged": true, "mergeCommit": {"oid": "eeb1497875bd9f9ae1be60e4b8d2d05dd834064e"}, "closed": true, "closedAt": "2020-11-04T12:08:06Z", "author": {"login": "JozoVilcek"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdU-3hogH2gAyNTA4MTYzMjYyOjY5NmVmM2IxMzE2MGRmMGYwYTM0NzgxMTBmMzY4NzM0ODFiYTY3ODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdY-ymYAH2gAyNTA4MTYzMjYyOjIxYjNhNzAxMTU1YjcyOTcxYThlNWVkZDMwZTU4ZDhlZjZjZjRiYmE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "696ef3b13160df0f0a3478110f36873481ba6782", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/696ef3b13160df0f0a3478110f36873481ba6782", "committedDate": "2020-10-22T09:50:29Z", "message": "[BEAM-11091] Allow to specify coder for HadoopFormatIO.Read"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0ODY1NDA3", "url": "https://github.com/apache/beam/pull/13166#pullrequestreview-514865407", "createdAt": "2020-10-22T15:39:45Z", "commit": {"oid": "696ef3b13160df0f0a3478110f36873481ba6782"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNTozOTo0NVrOHmoAyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxNTo0Mzo0MVrOHmoMFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI2MzQ5Nw==", "bodyText": "You need to clear the keyCoder/valueCoder in the non coder based variants otherwise we won't honor the typedescriptor when the user changes the translation function", "url": "https://github.com/apache/beam/pull/13166#discussion_r510263497", "createdAt": "2020-10-22T15:39:45Z", "author": {"login": "lukecwik"}, "path": "sdks/java/io/hadoop-format/src/main/java/org/apache/beam/sdk/io/hadoop/format/HadoopFormatIO.java", "diffHunk": "@@ -437,6 +445,12 @@\n           .build();\n     }\n \n+    /** Transforms the keys read from the source using the given key translation function. */\n+    public Read<K, V> withKeyTranslation(SimpleFunction<?, K> function, Coder<K> coder) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "696ef3b13160df0f0a3478110f36873481ba6782"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI2NjM5MQ==", "bodyText": "Since we don't need the type information anymore, we should use SerializableFunction instead of SimpleFunction. SimpleFunction implements SerializableFunction so this change enables using simpler lambdas.", "url": "https://github.com/apache/beam/pull/13166#discussion_r510266391", "createdAt": "2020-10-22T15:43:41Z", "author": {"login": "lukecwik"}, "path": "sdks/java/io/hadoop-format/src/main/java/org/apache/beam/sdk/io/hadoop/format/HadoopFormatIO.java", "diffHunk": "@@ -437,6 +445,12 @@\n           .build();\n     }\n \n+    /** Transforms the keys read from the source using the given key translation function. */\n+    public Read<K, V> withKeyTranslation(SimpleFunction<?, K> function, Coder<K> coder) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "696ef3b13160df0f0a3478110f36873481ba6782"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35d9b2ad710bb05731be87998705976ef37f120f", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/35d9b2ad710bb05731be87998705976ef37f120f", "committedDate": "2020-10-29T12:49:55Z", "message": "[BEAM-11091] Allow reset back translation to not use coder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "875e90f2e9d03faac29ac9a09973ceaa230c3257", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/875e90f2e9d03faac29ac9a09973ceaa230c3257", "committedDate": "2020-10-29T13:45:14Z", "message": "[BEAM-11091] Fix coder reset"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f060fad8c8701e0eb07e2640edeccf7fb0b613d", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/3f060fad8c8701e0eb07e2640edeccf7fb0b613d", "committedDate": "2020-10-29T16:14:01Z", "message": "[BEAM-11091] Fix checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNzI4MjQ3", "url": "https://github.com/apache/beam/pull/13166#pullrequestreview-522728247", "createdAt": "2020-11-03T17:32:36Z", "commit": {"oid": "3f060fad8c8701e0eb07e2640edeccf7fb0b613d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzozMjozNlrOHs5bJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNzozMjozNlrOHs5bJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg0MDIzMQ==", "bodyText": "nit: I guess the word Function is redundant here (like you called a similar key test testReadObjectCreationFailsIfKeyCoderIsNull )", "url": "https://github.com/apache/beam/pull/13166#discussion_r516840231", "createdAt": "2020-11-03T17:32:36Z", "author": {"login": "aromanenko-dev"}, "path": "sdks/java/io/hadoop-format/src/test/java/org/apache/beam/sdk/io/hadoop/format/HadoopFormatIOReadTest.java", "diffHunk": "@@ -229,6 +284,14 @@ public void testReadObjectCreationFailsIfValueTranslationFunctionIsNull() {\n     HadoopFormatIO.<Text, String>read().withConfiguration(serConf.get()).withValueTranslation(null);\n   }\n \n+  @Test\n+  public void testReadObjectCreationFailsIfValueCoderFunctionIsNull() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f060fad8c8701e0eb07e2640edeccf7fb0b613d"}, "originalPosition": 116}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21b3a701155b72971a8e5edd30e58d8ef6cf4bba", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/21b3a701155b72971a8e5edd30e58d8ef6cf4bba", "committedDate": "2020-11-03T20:00:48Z", "message": "[BEAM-11091] Improve test case name"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4929, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}