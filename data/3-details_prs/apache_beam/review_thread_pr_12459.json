{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyMzkxNzkz", "number": 12459, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxODo0NToxOVrOEVH5AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxOToxMDo1MVrOEVIadA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTg0ODMzOnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/dataframe/frame_base.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxODo0NToxOVrOG7s9xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxODo0NToxOVrOG7s9xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI1NTg3OA==", "bodyText": "This seems generic and useful enough that I'm surprised it isn't in a dataframes library.", "url": "https://github.com/apache/beam/pull/12459#discussion_r465255878", "createdAt": "2020-08-04T18:45:19Z", "author": {"login": "apilloud"}, "path": "sdks/python/apache_beam/dataframe/frame_base.py", "diffHunk": "@@ -226,6 +232,68 @@ def wrapper(self, *args, **kwargs):\n   return wrapper\n \n \n+def maybe_inplace(func):\n+  @functools.wraps(func)\n+  def wrapper(self, inplace=False, **kwargs):\n+    result = func(self, **kwargs)\n+    if inplace:\n+      self._expr = result._expr\n+    else:\n+      return result\n+\n+  return wrapper\n+\n+\n+def args_to_kwargs(base_type):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe97086cd4b45de1e2c5f40c590027bc5d643629"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTg1NjQ0OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/dataframe/frame_base.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxODo0Nzo0NVrOG7tC7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMDoyNjoxOFrOG716cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI1NzE5OA==", "bodyText": "nit: this appears more than once in this file, might it be worth adding a getargspec helper function?", "url": "https://github.com/apache/beam/pull/12459#discussion_r465257198", "createdAt": "2020-08-04T18:47:45Z", "author": {"login": "apilloud"}, "path": "sdks/python/apache_beam/dataframe/frame_base.py", "diffHunk": "@@ -147,7 +149,11 @@ def wrapper(*args, **kwargs):\n       else:\n         try:\n           # pylint: disable=deprecated-method\n-          ix = inspect.getargspec(func).args.index(key)\n+          if sys.version_info < (3, ):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe97086cd4b45de1e2c5f40c590027bc5d643629"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQwMjQ4Mg==", "bodyText": "Good point.", "url": "https://github.com/apache/beam/pull/12459#discussion_r465402482", "createdAt": "2020-08-05T00:26:18Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/dataframe/frame_base.py", "diffHunk": "@@ -147,7 +149,11 @@ def wrapper(*args, **kwargs):\n       else:\n         try:\n           # pylint: disable=deprecated-method\n-          ix = inspect.getargspec(func).args.index(key)\n+          if sys.version_info < (3, ):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI1NzE5OA=="}, "originalCommit": {"oid": "fe97086cd4b45de1e2c5f40c590027bc5d643629"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTkyOTU2OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/dataframe/frame_base.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxOTowOTozOFrOG7tv2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMDoyNzoxOFrOG717jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2ODY5OQ==", "bodyText": "This comment is a little confusing, I believe it is describing the contents of populate_defaults?\nAfter spending some time reading through this, it might be clearer if you broke this into a function that returned arg_to_default, and a second that returned populate_defaults.", "url": "https://github.com/apache/beam/pull/12459#discussion_r465268699", "createdAt": "2020-08-04T19:09:38Z", "author": {"login": "apilloud"}, "path": "sdks/python/apache_beam/dataframe/frame_base.py", "diffHunk": "@@ -226,6 +232,68 @@ def wrapper(self, *args, **kwargs):\n   return wrapper\n \n \n+def maybe_inplace(func):\n+  @functools.wraps(func)\n+  def wrapper(self, inplace=False, **kwargs):\n+    result = func(self, **kwargs)\n+    if inplace:\n+      self._expr = result._expr\n+    else:\n+      return result\n+\n+  return wrapper\n+\n+\n+def args_to_kwargs(base_type):\n+  def wrap(func):\n+    if sys.version_info < (3, ):\n+      getargspec = inspect.getargspec\n+    else:\n+      getargspec = inspect.getfullargspec\n+\n+    # This is used to map all positional arguments to keyword arguments.\n+    base = getattr(base_type, func.__name__)\n+    while hasattr(base, '__wrapped__'):\n+      base = base.__wrapped__\n+    base_argspec = getargspec(base)\n+    arg_names = base_argspec.args\n+\n+    # These are used to populate any defaults in base for arguments in func.\n+    if base_argspec.defaults:\n+      arg_to_default = dict(\n+          zip(\n+              base_argspec.args[-len(base_argspec.defaults):],\n+              base_argspec.defaults))\n+    else:\n+      arg_to_default = {}\n+\n+    unwrapped_func = func\n+    while hasattr(unwrapped_func, '__wrapped__'):\n+      unwrapped_func = unwrapped_func.__wrapped__\n+    # args that do not have defaults in func, but do have defaults in base", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe97086cd4b45de1e2c5f40c590027bc5d643629"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQwMjc2Nw==", "bodyText": "I think I never want one without the other, but I'll see what it looks like to break them up.", "url": "https://github.com/apache/beam/pull/12459#discussion_r465402767", "createdAt": "2020-08-05T00:27:18Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/dataframe/frame_base.py", "diffHunk": "@@ -226,6 +232,68 @@ def wrapper(self, *args, **kwargs):\n   return wrapper\n \n \n+def maybe_inplace(func):\n+  @functools.wraps(func)\n+  def wrapper(self, inplace=False, **kwargs):\n+    result = func(self, **kwargs)\n+    if inplace:\n+      self._expr = result._expr\n+    else:\n+      return result\n+\n+  return wrapper\n+\n+\n+def args_to_kwargs(base_type):\n+  def wrap(func):\n+    if sys.version_info < (3, ):\n+      getargspec = inspect.getargspec\n+    else:\n+      getargspec = inspect.getfullargspec\n+\n+    # This is used to map all positional arguments to keyword arguments.\n+    base = getattr(base_type, func.__name__)\n+    while hasattr(base, '__wrapped__'):\n+      base = base.__wrapped__\n+    base_argspec = getargspec(base)\n+    arg_names = base_argspec.args\n+\n+    # These are used to populate any defaults in base for arguments in func.\n+    if base_argspec.defaults:\n+      arg_to_default = dict(\n+          zip(\n+              base_argspec.args[-len(base_argspec.defaults):],\n+              base_argspec.defaults))\n+    else:\n+      arg_to_default = {}\n+\n+    unwrapped_func = func\n+    while hasattr(unwrapped_func, '__wrapped__'):\n+      unwrapped_func = unwrapped_func.__wrapped__\n+    # args that do not have defaults in func, but do have defaults in base", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2ODY5OQ=="}, "originalCommit": {"oid": "fe97086cd4b45de1e2c5f40c590027bc5d643629"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwNTkzMzk2OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/dataframe/frame_base.py", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxOToxMDo1MVrOG7tyaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxOToxMDo1MVrOG7tyaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTI2OTM1NQ==", "bodyText": "arg_to_default might be clearer as arg_to_base_default or base_defaults?", "url": "https://github.com/apache/beam/pull/12459#discussion_r465269355", "createdAt": "2020-08-04T19:10:51Z", "author": {"login": "apilloud"}, "path": "sdks/python/apache_beam/dataframe/frame_base.py", "diffHunk": "@@ -226,6 +232,68 @@ def wrapper(self, *args, **kwargs):\n   return wrapper\n \n \n+def maybe_inplace(func):\n+  @functools.wraps(func)\n+  def wrapper(self, inplace=False, **kwargs):\n+    result = func(self, **kwargs)\n+    if inplace:\n+      self._expr = result._expr\n+    else:\n+      return result\n+\n+  return wrapper\n+\n+\n+def args_to_kwargs(base_type):\n+  def wrap(func):\n+    if sys.version_info < (3, ):\n+      getargspec = inspect.getargspec\n+    else:\n+      getargspec = inspect.getfullargspec\n+\n+    # This is used to map all positional arguments to keyword arguments.\n+    base = getattr(base_type, func.__name__)\n+    while hasattr(base, '__wrapped__'):\n+      base = base.__wrapped__\n+    base_argspec = getargspec(base)\n+    arg_names = base_argspec.args\n+\n+    # These are used to populate any defaults in base for arguments in func.\n+    if base_argspec.defaults:\n+      arg_to_default = dict(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe97086cd4b45de1e2c5f40c590027bc5d643629"}, "originalPosition": 55}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 803, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}