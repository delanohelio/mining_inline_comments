{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyOTAwMzk0", "number": 13372, "title": "Enable more runner v2 tests.", "bodyText": "r: @tysonjh\ncc:  @kennknowles\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\nWhitespace\nTypescript\n\n\n\n\nNon-portable\n\n \n\n\n\n\n\n\nPortable\n---\n\n---\n---\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\n\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-11-18T04:21:43Z", "url": "https://github.com/apache/beam/pull/13372", "merged": true, "mergeCommit": {"oid": "208690c40ca6003e05129a1ce8c18f13dbcac61a"}, "closed": true, "closedAt": "2020-11-23T20:24:16Z", "author": {"login": "boyuanzz"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdd0R-QAFqTUzMzg1Mzk3OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfaRdCgBqjQwMjkyODQ3Mjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODUzOTc4", "url": "https://github.com/apache/beam/pull/13372#pullrequestreview-533853978", "createdAt": "2020-11-18T20:35:43Z", "commit": {"oid": "5138a9bbf06f2e5d380cfb8fb71f3eab563944be"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDozNTo0NFrOH2BIMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDozNTo0NFrOH2BIMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQwMzYzMg==", "bodyText": "These are already excluded by commonRunnerV2ExcludeCategories via category exclusion, so maybe they can just be removed from here?", "url": "https://github.com/apache/beam/pull/13372#discussion_r526403632", "createdAt": "2020-11-18T20:35:44Z", "author": {"login": "tysonjh"}, "path": "runners/google-cloud-dataflow-java/build.gradle", "diffHunk": "@@ -359,25 +359,20 @@ task validatesRunnerV2 {\n     name: 'validatesRunnerV2Test',\n     excludedCategories: [\n       'org.apache.beam.sdk.testing.UsesRequiresTimeSortedInput',\n+      'org.apache.beam.sdk.testing.UsesUnboundedSplittableParDo',\n     ],\n     excludedTests: [\n       'org.apache.beam.sdk.transforms.windowing.WindowingTest.testNonPartitioningWindowing',\n       'org.apache.beam.sdk.transforms.windowing.WindowTest.testMergingCustomWindowsKeyedCollection',\n       'org.apache.beam.sdk.transforms.windowing.WindowTest.testMergingCustomWindows',\n \n-      'org.apache.beam.sdk.transforms.SplittableDoFnTest.testBundleFinalizationOccursOnUnboundedSplittableDoFn',\n-      'org.apache.beam.sdk.transforms.SplittableDoFnTest.testOutputAfterCheckpointBounded',\n-      'org.apache.beam.sdk.transforms.SplittableDoFnTest.testOutputAfterCheckpointUnbounded',\n-      'org.apache.beam.sdk.transforms.SplittableDoFnTest.testPairWithIndexBasicBounded',\n-      'org.apache.beam.sdk.transforms.SplittableDoFnTest.testPairWithIndexBasicUnbounded',\n-      'org.apache.beam.sdk.transforms.SplittableDoFnTest.testPairWithIndexWindowedTimestampedBounded',\n-      'org.apache.beam.sdk.transforms.SplittableDoFnTest.testWindowedSideInputWithCheckpointsBounded',\n-\n       'org.apache.beam.sdk.transforms.ReshuffleTest.testReshuffleWithTimestampsStreaming',\n \n+      // These tests are using TestStream, which is not supported in batch.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5138a9bbf06f2e5d380cfb8fb71f3eab563944be"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzODU1NzQ3", "url": "https://github.com/apache/beam/pull/13372#pullrequestreview-533855747", "createdAt": "2020-11-18T20:38:15Z", "commit": {"oid": "5138a9bbf06f2e5d380cfb8fb71f3eab563944be"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDozODoxNVrOH2BNig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQyMDozODoxNVrOH2BNig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQwNTAwMg==", "bodyText": "This should probably move to the commonRunnerV2ExcludeCategories as well since it applies to both streaming/batch.", "url": "https://github.com/apache/beam/pull/13372#discussion_r526405002", "createdAt": "2020-11-18T20:38:15Z", "author": {"login": "tysonjh"}, "path": "runners/google-cloud-dataflow-java/build.gradle", "diffHunk": "@@ -359,25 +359,20 @@ task validatesRunnerV2 {\n     name: 'validatesRunnerV2Test',\n     excludedCategories: [\n       'org.apache.beam.sdk.testing.UsesRequiresTimeSortedInput',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5138a9bbf06f2e5d380cfb8fb71f3eab563944be"}, "originalPosition": 3}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3c8fb3948c853b1da49eb0631ab442a41730cab", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/c3c8fb3948c853b1da49eb0631ab442a41730cab", "committedDate": "2020-11-18T20:48:59Z", "message": "[TEST ONLY] will revert"}, "afterCommit": {"oid": "75d6cd9e843f71ca67a460ec9b8be9141e774922", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/75d6cd9e843f71ca67a460ec9b8be9141e774922", "committedDate": "2020-11-19T00:46:17Z", "message": "Enable more runner v2 tests."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NjcyMzE2", "url": "https://github.com/apache/beam/pull/13372#pullrequestreview-534672316", "createdAt": "2020-11-19T17:15:45Z", "commit": {"oid": "75d6cd9e843f71ca67a460ec9b8be9141e774922"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNzoxNTo0NlrOH2pK4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNzoyMToxMVrOH2pZgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA1OTY4MQ==", "bodyText": "Exclude UsesUnboundedPCollection here?", "url": "https://github.com/apache/beam/pull/13372#discussion_r527059681", "createdAt": "2020-11-19T17:15:46Z", "author": {"login": "kennknowles"}, "path": "runners/google-cloud-dataflow-java/build.gradle", "diffHunk": "@@ -358,26 +359,19 @@ task validatesRunnerV2 {\n   dependsOn(createRunnerV2ValidatesRunnerTest(\n     name: 'validatesRunnerV2Test',\n     excludedCategories: [\n-      'org.apache.beam.sdk.testing.UsesRequiresTimeSortedInput',\n+      'org.apache.beam.sdk.testing.UsesUnboundedSplittableParDo',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75d6cd9e843f71ca67a460ec9b8be9141e774922"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA2MDg1Mg==", "bodyText": "This I am confused about. I did not think that Dataflow supported requiring time-sorted input in streaming either runner v1 or v2.", "url": "https://github.com/apache/beam/pull/13372#discussion_r527060852", "createdAt": "2020-11-19T17:17:26Z", "author": {"login": "kennknowles"}, "path": "runners/google-cloud-dataflow-java/build.gradle", "diffHunk": "@@ -418,10 +412,6 @@ task validatesRunnerV2Streaming {\n     name: 'validatesRunnerV2TestStreaming',\n     pipelineOptions: runnerV2PipelineOptions + ['--streaming=true'],\n     excludedCategories: [\n-      // Not supported in Dataflow streaming mode.\n-      'org.apache.beam.sdk.testing.UsesRequiresTimeSortedInput',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75d6cd9e843f71ca67a460ec9b8be9141e774922"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA2MzQyNA==", "bodyText": "This value is runner-specific. For many configurations a much smaller number is appropriate. This number is probably safe for all runners so it OK. But can you set it in the gradle file to some large number that will work for all the ValidatesRunner tests? Probably 900 is safe for any of them since they are small compliance tests and none are high load.", "url": "https://github.com/apache/beam/pull/13372#discussion_r527063424", "createdAt": "2020-11-19T17:21:11Z", "author": {"login": "kennknowles"}, "path": "sdks/java/core/src/test/java/org/apache/beam/sdk/transforms/SplittableDoFnTest.java", "diffHunk": "@@ -304,6 +305,7 @@ public void testOutputAfterCheckpointBounded() {\n   @Test\n   @Category({ValidatesRunner.class, UsesUnboundedSplittableParDo.class})\n   public void testOutputAfterCheckpointUnbounded() {\n+    p.getOptions().as(TestPipelineOptions.class).setTestTimeoutSeconds(900L);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75d6cd9e843f71ca67a460ec9b8be9141e774922"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NzA3ODIy", "url": "https://github.com/apache/beam/pull/13372#pullrequestreview-535707822", "createdAt": "2020-11-20T19:12:10Z", "commit": {"oid": "6b38ed4f982ce89e8b07cb2dc3cb7426d79a7040"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6b38ed4f982ce89e8b07cb2dc3cb7426d79a7040", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/6b38ed4f982ce89e8b07cb2dc3cb7426d79a7040", "committedDate": "2020-11-19T19:01:54Z", "message": "Address comments."}, "afterCommit": {"oid": "ba9210e759f3e00a8cb54abfedd3005f62d3dcac", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/ba9210e759f3e00a8cb54abfedd3005f62d3dcac", "committedDate": "2020-11-20T23:21:50Z", "message": "Enable more runner v2 tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07cbed52ec185c3c4b1eeff7d237a35a6da107fd", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/07cbed52ec185c3c4b1eeff7d237a35a6da107fd", "committedDate": "2020-11-23T19:25:20Z", "message": "Enable more runner v2 tests."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba9210e759f3e00a8cb54abfedd3005f62d3dcac", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/ba9210e759f3e00a8cb54abfedd3005f62d3dcac", "committedDate": "2020-11-20T23:21:50Z", "message": "Enable more runner v2 tests."}, "afterCommit": {"oid": "07cbed52ec185c3c4b1eeff7d237a35a6da107fd", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/07cbed52ec185c3c4b1eeff7d237a35a6da107fd", "committedDate": "2020-11-23T19:25:20Z", "message": "Enable more runner v2 tests."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4469, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}