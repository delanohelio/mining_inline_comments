{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI4NzY3NzIw", "number": 11939, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQyMjowNzoyNlrOEDHGjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwMTozNzozMlrOEFwGSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNjk3NTUwOnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/typehints/typehints_test.py", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQyMjowNzoyNlrOGf-sZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxODo1MDowOFrOGgrglw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4NjIxNA==", "bodyText": "If BaseSetHintTest inherited from TypeHintTestCase you could avoid multiple inheritance in the sub-classes below.", "url": "https://github.com/apache/beam/pull/11939#discussion_r436186214", "createdAt": "2020-06-05T22:07:26Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -612,54 +613,70 @@ def test_match_type_variables(self):\n                      hint.match_type_variables(typehints.Dict[int, str]))\n \n \n-class SetHintTestCase(TypeHintTestCase):\n+class BaseSetHintTest:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQxNTMzOQ==", "bodyText": "Just pushed a fix - BaseSetHintTest is now a wrapper for a nested class that inherits from TypeHintTestCase (which inherits from TestCase), thereby removing the multiple inheritance.\nI think BaseSetHintTest can't directly inherit from TypeHintTestCase because that would cause the unittest library to accidentally run the BaseSetHintTest tests which cannot be run without first being instantiated by the child classes (SetHintTestCase, FrozenSetHintTestCase). The nested class solves this issue - see here.", "url": "https://github.com/apache/beam/pull/11939#discussion_r436415339", "createdAt": "2020-06-08T00:13:34Z", "author": {"login": "saavannanavati"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -612,54 +613,70 @@ def test_match_type_variables(self):\n                      hint.match_type_variables(typehints.Dict[int, str]))\n \n \n-class SetHintTestCase(TypeHintTestCase):\n+class BaseSetHintTest:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4NjIxNA=="}, "originalCommit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkwODQ2NA==", "bodyText": "Nice solution! I've run into this in the past.\nWhat's happening is that pytest is loading all modules and inspecting their attributes looking for tests to run. Another solution solution would have been to set BaseSetHintTest = None near the bottom of this module. Effectively both solutions are hiding the base class from being collected by pytest.", "url": "https://github.com/apache/beam/pull/11939#discussion_r436908464", "createdAt": "2020-06-08T18:28:21Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -612,54 +613,70 @@ def test_match_type_variables(self):\n                      hint.match_type_variables(typehints.Dict[int, str]))\n \n \n-class SetHintTestCase(TypeHintTestCase):\n+class BaseSetHintTest:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4NjIxNA=="}, "originalCommit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkyMDQ3MQ==", "bodyText": "That makes sense, thanks for the explanation!", "url": "https://github.com/apache/beam/pull/11939#discussion_r436920471", "createdAt": "2020-06-08T18:50:08Z", "author": {"login": "saavannanavati"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -612,54 +613,70 @@ def test_match_type_variables(self):\n                      hint.match_type_variables(typehints.Dict[int, str]))\n \n \n-class SetHintTestCase(TypeHintTestCase):\n+class BaseSetHintTest:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4NjIxNA=="}, "originalCommit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNjk4NTY5OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/typehints/typehints_test.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQyMjoxMzoyNlrOGf-y3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwMDozNDowNlrOGgMyQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4Nzg3MQ==", "bodyText": "You should omit *args, **kwargs if there aren't any more args allowed. This is the style we follow in this codebase. Here and below as well.\nFor example: if some code called BaseSetHintTest('Set', set, typehints.Set, typehints.FrozenSet) would you rather it be silently ignored or raised as an incorrect number of arguments?", "url": "https://github.com/apache/beam/pull/11939#discussion_r436187871", "createdAt": "2020-06-05T22:13:26Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -612,54 +613,70 @@ def test_match_type_variables(self):\n                      hint.match_type_variables(typehints.Dict[int, str]))\n \n \n-class SetHintTestCase(TypeHintTestCase):\n+class BaseSetHintTest:\n+  def __init__(self, string_type, py_type, beam_type, *args, **kwargs):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQxNzA5MA==", "bodyText": "That was there to forward arguments needed for the TestCase constructor but it looks like there is only one optional parameter, methodName, so I've pushed a fix to inline the parameter and remove *args, **kwargs. Thanks for the catch", "url": "https://github.com/apache/beam/pull/11939#discussion_r436417090", "createdAt": "2020-06-08T00:34:06Z", "author": {"login": "saavannanavati"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -612,54 +613,70 @@ def test_match_type_variables(self):\n                      hint.match_type_variables(typehints.Dict[int, str]))\n \n \n-class SetHintTestCase(TypeHintTestCase):\n+class BaseSetHintTest:\n+  def __init__(self, string_type, py_type, beam_type, *args, **kwargs):", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4Nzg3MQ=="}, "originalCommit": {"oid": "20dc6e0bdf6669639188fb72d545715fc9ab40b6"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyMTgzMTUxOnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/typehints/typehints_test.py", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxODozMjozM1rOGgq7Hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxODozMjozM1rOGgq7Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkxMDg3OA==", "bodyText": "This is fine, but I would leave method_name out. We don't use this feature", "url": "https://github.com/apache/beam/pull/11939#discussion_r436910878", "createdAt": "2020-06-08T18:32:33Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints_test.py", "diffHunk": "@@ -615,8 +615,8 @@ def test_match_type_variables(self):\n \n class BaseSetHintTest:\n   class CommonTests(TypeHintTestCase):\n-    def __init__(self, string_type, py_type, beam_type, *args, **kwargs):\n-      super().__init__(*args, **kwargs)\n+    def __init__(self, string_type, py_type, beam_type, method_name='runTest'):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "970f2ce55ca4478a1106f0ba40068759198a2f3b"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0NDY2Mzc2OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/typehints/typehints.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQwMTozNzozMlrOGkIPmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQyMDoyNToxNVrOGkr2Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUzNjk4NA==", "bodyText": "I think the logic here is reversed? (I don't see ignore_name used in any test in this commit.)\nAbout naming: (optional ideas)\n\nI'd recommend to be more descriptive about when name is ignored. Ex: ignore_name_in_eq\nI find using positive variable names easier to reason about. if use_name_in_eq is easier to read than if not ignore_name_in_eq.", "url": "https://github.com/apache/beam/pull/11939#discussion_r440536984", "createdAt": "2020-06-16T01:37:32Z", "author": {"login": "udim"}, "path": "sdks/python/apache_beam/typehints/typehints.py", "diffHunk": "@@ -435,10 +435,14 @@ def type_check(self, instance):\n \n \n class TypeVariable(AnyTypeConstraint):\n-  def __init__(self, name):\n+  def __init__(self, name, ignore_name=False):\n     self.name = name\n+    self.ignore_name = ignore_name\n \n   def __eq__(self, other):\n+    if self.ignore_name:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5931a401b3c70ac720d989ce70160da3d9a66706"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTEyMDMyMw==", "bodyText": "Thanks, pushed a fix - it's used for one test in native_type_compatability_test.py\nAlso added unit tests for the new changes to TypeVariable", "url": "https://github.com/apache/beam/pull/11939#discussion_r441120323", "createdAt": "2020-06-16T20:25:15Z", "author": {"login": "saavannanavati"}, "path": "sdks/python/apache_beam/typehints/typehints.py", "diffHunk": "@@ -435,10 +435,14 @@ def type_check(self, instance):\n \n \n class TypeVariable(AnyTypeConstraint):\n-  def __init__(self, name):\n+  def __init__(self, name, ignore_name=False):\n     self.name = name\n+    self.ignore_name = ignore_name\n \n   def __eq__(self, other):\n+    if self.ignore_name:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDUzNjk4NA=="}, "originalCommit": {"oid": "5931a401b3c70ac720d989ce70160da3d9a66706"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3633, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}