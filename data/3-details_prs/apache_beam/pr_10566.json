{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYyMTkzNzU4", "number": 10566, "title": "[BEAM-6008] Propagate errors during pipeline execution in Java's PortableRunner", "bodyText": "The error reporting for Java test cases currently yields:\njava.lang.AssertionError: Pipeline did not succeed.\nExpected: is <DONE>\n     but: was <FAILED>\n\nNot particularly helpful. This improves the situation by retrieving the error\nmessages from the job service.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-01-13T15:59:41Z", "url": "https://github.com/apache/beam/pull/10566", "merged": true, "mergeCommit": {"oid": "d35195f4c40ff154ff0c4aa33f402acc10937e37"}, "closed": true, "closedAt": "2020-01-13T21:48:41Z", "author": {"login": "mxm"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb5-fi9gH2gAyMzYyMTkzNzU4OjFkYjJlMzk3NmZiMmE1YzE1Yzc3ZTU1OTI4ZTE5YzAwM2RiM2IzODc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6DRJjgFqTM0MjE1MjQ1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1db2e3976fb2a5c15c77e55928e19c003db3b387", "author": {"user": {"login": "mxm", "name": "Maximilian Michels"}}, "url": "https://github.com/apache/beam/commit/1db2e3976fb2a5c15c77e55928e19c003db3b387", "committedDate": "2020-01-13T15:57:11Z", "message": "[BEAM-6008] Propagate errors during pipeline execution in Java's PortableRunner\n\nThe error reporting for Java test cases currently yields:\n\n```\njava.lang.AssertionError: Pipeline did not succeed.\nExpected: is <DONE>\n     but: was <FAILED>\n```\n\nNot particularly helpful. This improves the situation by retrieving the error\nmessages from the job service."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMDA5NzU1", "url": "https://github.com/apache/beam/pull/10566#pullrequestreview-342009755", "createdAt": "2020-01-13T17:25:26Z", "commit": {"oid": "1db2e3976fb2a5c15c77e55928e19c003db3b387"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxNzoyNToyN1rOFc-hJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxNzoyNToyN1rOFc-hJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTkyODc0MA==", "bodyText": "I've added this to make it consistent with the state updates, which we also save. However, this may be too memory intense, I'm seeing that the test time increased here: https://builds.apache.org/job/beam_PreCommit_Python2_PVR_Flink_Commit/2320/\nNeed to check if this is due to this change. If so, we could subscribe to the messages before running the pipeline which would remove the need to save the messages.", "url": "https://github.com/apache/beam/pull/10566#discussion_r365928740", "createdAt": "2020-01-13T17:25:27Z", "author": {"login": "mxm"}, "path": "runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/jobsubmission/JobInvocation.java", "diffHunk": "@@ -243,6 +249,7 @@ private synchronized void setState(JobState.Enum state) {\n   }\n \n   private synchronized void sendMessage(JobMessage message) {\n+    messageHistory.add(message);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1db2e3976fb2a5c15c77e55928e19c003db3b387"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMTUyNDUy", "url": "https://github.com/apache/beam/pull/10566#pullrequestreview-342152452", "createdAt": "2020-01-13T21:30:59Z", "commit": {"oid": "1db2e3976fb2a5c15c77e55928e19c003db3b387"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3758, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}