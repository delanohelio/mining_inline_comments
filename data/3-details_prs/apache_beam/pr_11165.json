{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNzEzOTIw", "number": 11165, "title": "[BEAM-9340] Populate requirements for Java.", "bodyText": "Thank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-03-18T23:22:08Z", "url": "https://github.com/apache/beam/pull/11165", "merged": true, "mergeCommit": {"oid": "71b0c9c6d5e537e431e72d63f5258f7b6db86617"}, "closed": true, "closedAt": "2020-03-25T17:02:25Z", "author": {"login": "robertwb"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPAqCqABqjMxNDM2MTM5Mjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQgzzegFqTM3OTU5NDYzMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9a4ab9122202e65775ff99a68be5f61a19cfd19", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/c9a4ab9122202e65775ff99a68be5f61a19cfd19", "committedDate": "2020-03-18T23:21:26Z", "message": "[BEAM-9340] Populate requirements for Java DoFn properties."}, "afterCommit": {"oid": "6072eb4d68f25c31871f64f493d42096c2e6b025", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/6072eb4d68f25c31871f64f493d42096c2e6b025", "committedDate": "2020-03-19T00:20:44Z", "message": "[BEAM-9340] Populate requirements for Java DoFn properties."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MDc2NzY1", "url": "https://github.com/apache/beam/pull/11165#pullrequestreview-378076765", "createdAt": "2020-03-19T20:39:58Z", "commit": {"oid": "6072eb4d68f25c31871f64f493d42096c2e6b025"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQyMDozOTo1OFrOF4_mow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQyMDo0NzoxMVrOF4_0pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTMwNjY1OQ==", "bodyText": "Please define string constants and then validate that they match in the static initializer. This allows for the string constants to be used in switch/case statements since they are compile time constants.\nI have pr/11162 which duplicates this effort, which ever goes in second needs to get updated.", "url": "https://github.com/apache/beam/pull/11165#discussion_r395306659", "createdAt": "2020-03-19T20:39:58Z", "author": {"login": "lukecwik"}, "path": "runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/PTransformTranslation.java", "diffHunk": "@@ -124,6 +124,15 @@\n   public static final String SPLITTABLE_PROCESS_SIZED_ELEMENTS_AND_RESTRICTIONS_URN =\n       \"beam:transform:sdf_process_sized_element_and_restrictions:v1\";\n \n+  public static final String REQUIRES_STATEFUL_PROCESSING_URN =\n+      getUrn(RunnerApi.StandardRequirements.Enum.REQUIRES_STATEFUL_PROCESSING);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6072eb4d68f25c31871f64f493d42096c2e6b025"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTMwODc5OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                  public void process(ProcessContext ctxt) {}CreateExecutableStageNodeFunction.java\n          \n          \n            \n                                  public void process(ProcessContext ctxt) {}", "url": "https://github.com/apache/beam/pull/11165#discussion_r395308799", "createdAt": "2020-03-19T20:44:11Z", "author": {"login": "lukecwik"}, "path": "runners/core-construction-java/src/test/java/org/apache/beam/runners/core/construction/EnvironmentsTest.java", "diffHunk": "@@ -115,7 +115,7 @@ public void getEnvironmentPTransform() throws IOException {\n             ParDo.of(\n                     new DoFn<String, String>() {\n                       @ProcessElement\n-                      public void process(ProcessContext ctxt) {}\n+                      public void process(ProcessContext ctxt) {}CreateExecutableStageNodeFunction.java", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6072eb4d68f25c31871f64f493d42096c2e6b025"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTMxMDE1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  Components components, Collection<String> requirements, String newIdPrefix) {\n          \n          \n            \n                  Components components, @Nullable Collection<String> requirements, String newIdPrefix) {", "url": "https://github.com/apache/beam/pull/11165#discussion_r395310152", "createdAt": "2020-03-19T20:46:59Z", "author": {"login": "lukecwik"}, "path": "runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/SdkComponents.java", "diffHunk": "@@ -86,25 +91,30 @@ public static SdkComponents create(RunnerApi.Components components) {\n   }\n \n   public static SdkComponents create(PipelineOptions options) {\n-    SdkComponents sdkComponents = new SdkComponents(RunnerApi.Components.getDefaultInstance(), \"\");\n+    SdkComponents sdkComponents =\n+        new SdkComponents(RunnerApi.Components.getDefaultInstance(), null, \"\");\n     PortablePipelineOptions portablePipelineOptions = options.as(PortablePipelineOptions.class);\n     sdkComponents.registerEnvironment(\n         Environments.createOrGetDefaultEnvironment(portablePipelineOptions));\n     return sdkComponents;\n   }\n \n-  private SdkComponents(RunnerApi.Components components, String newIdPrefix) {\n+  private SdkComponents(\n+      Components components, Collection<String> requirements, String newIdPrefix) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6072eb4d68f25c31871f64f493d42096c2e6b025"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTMxMDI0Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public void mergeFrom(RunnerApi.Components components, Collection<String> requirements) {\n          \n          \n            \n              public void mergeFrom(RunnerApi.Components components, @Nullable Collection<String> requirements) {", "url": "https://github.com/apache/beam/pull/11165#discussion_r395310246", "createdAt": "2020-03-19T20:47:11Z", "author": {"login": "lukecwik"}, "path": "runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/SdkComponents.java", "diffHunk": "@@ -86,25 +91,30 @@ public static SdkComponents create(RunnerApi.Components components) {\n   }\n \n   public static SdkComponents create(PipelineOptions options) {\n-    SdkComponents sdkComponents = new SdkComponents(RunnerApi.Components.getDefaultInstance(), \"\");\n+    SdkComponents sdkComponents =\n+        new SdkComponents(RunnerApi.Components.getDefaultInstance(), null, \"\");\n     PortablePipelineOptions portablePipelineOptions = options.as(PortablePipelineOptions.class);\n     sdkComponents.registerEnvironment(\n         Environments.createOrGetDefaultEnvironment(portablePipelineOptions));\n     return sdkComponents;\n   }\n \n-  private SdkComponents(RunnerApi.Components components, String newIdPrefix) {\n+  private SdkComponents(\n+      Components components, Collection<String> requirements, String newIdPrefix) {\n     this.newIdPrefix = newIdPrefix;\n+    this.requirements = new HashSet<>();\n \n     if (components == null) {\n-      return;\n+      if (requirements != null) {\n+        this.requirements.addAll(requirements);\n+      }\n+    } else {\n+      mergeFrom(components, requirements);\n     }\n-\n-    mergeFrom(components);\n   }\n \n   /** Merge Components proto into this SdkComponents instance. */\n-  public void mergeFrom(RunnerApi.Components components) {\n+  public void mergeFrom(RunnerApi.Components components, Collection<String> requirements) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6072eb4d68f25c31871f64f493d42096c2e6b025"}, "originalPosition": 90}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f96214b2ec3f88747e65b48d907fb89880dedcc", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/4f96214b2ec3f88747e65b48d907fb89880dedcc", "committedDate": "2020-03-20T18:56:12Z", "message": "[BEAM-9340] Plumb requirements through Java SDK."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2fbcc549f6c0f3d45a87f6dffb49db53e5ba96d7", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/2fbcc549f6c0f3d45a87f6dffb49db53e5ba96d7", "committedDate": "2020-03-20T19:20:48Z", "message": "[BEAM-9340] Populate requirements for Java DoFn properties."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6072eb4d68f25c31871f64f493d42096c2e6b025", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/6072eb4d68f25c31871f64f493d42096c2e6b025", "committedDate": "2020-03-19T00:20:44Z", "message": "[BEAM-9340] Populate requirements for Java DoFn properties."}, "afterCommit": {"oid": "2fbcc549f6c0f3d45a87f6dffb49db53e5ba96d7", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/2fbcc549f6c0f3d45a87f6dffb49db53e5ba96d7", "committedDate": "2020-03-20T19:20:48Z", "message": "[BEAM-9340] Populate requirements for Java DoFn properties."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5NTk0NjMz", "url": "https://github.com/apache/beam/pull/11165#pullrequestreview-379594633", "createdAt": "2020-03-23T16:22:25Z", "commit": {"oid": "2fbcc549f6c0f3d45a87f6dffb49db53e5ba96d7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2829, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}