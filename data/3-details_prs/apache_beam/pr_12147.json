{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNjMxODk0", "number": 12147, "title": "[BEAM 7624] Added Null Behavior in JsonToRow", "bodyText": "Added support for changing the null read behavior of JsonToRow using the changes done in RowJson.\nAdded NullBehavior to JsonToRow, and some corresponding tests.\nNotes:\nI needed to add the volatile flag on the NullBehavior on JsonToRowFn because spotbugs would complain about threading issues if I didn't.\nDidn't end up doing anything with the BeamSQL Json stuff as I don't have any experience with BeamSQL and looked like quite a lot of internal code surrounding it.\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-07-01T11:20:14Z", "url": "https://github.com/apache/beam/pull/12147", "merged": true, "mergeCommit": {"oid": "e0a16e0a3ed3aeb5e13e5adf083a7b50ff194c58"}, "closed": true, "closedAt": "2020-07-17T16:40:01Z", "author": {"login": "reubenvanammers"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcz3ZZGABqjM1MzYyNTUzMTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1zNAbAH2gAyNDQyNjMxODk0OjkyZmYyNWQ4NjQ4YzA4ZGE4NWIwZmIzZmZhMTY1ODJjNjRjMTczZDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d2bc2d2f70cc43608449d50af6b74e541e59029c", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/d2bc2d2f70cc43608449d50af6b74e541e59029c", "committedDate": "2020-07-01T11:52:38Z", "message": "Some minor formatting and renaming"}, "afterCommit": {"oid": "527a5108747e7013286ec3ffb73ecccec3ad611d", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/527a5108747e7013286ec3ffb73ecccec3ad611d", "committedDate": "2020-07-11T12:12:34Z", "message": "Some minor formatting and renaming"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff9e08e43a7a882ac1c0b91a91b17e10f9f9bb1d", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/ff9e08e43a7a882ac1c0b91a91b17e10f9f9bb1d", "committedDate": "2020-07-12T05:40:21Z", "message": "Added support for JsonToRow with Missing fields"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6593274e18e590b4da7e17ae29e8a77f8e47a4bf", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/6593274e18e590b4da7e17ae29e8a77f8e47a4bf", "committedDate": "2020-07-12T05:40:26Z", "message": "Changed default null handling behavior to be in line with RowJson"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96dca0e01af615ef0128ed5fca5fde34603d32cb", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/96dca0e01af615ef0128ed5fca5fde34603d32cb", "committedDate": "2020-07-12T05:40:26Z", "message": "Changed default for deadletter as well"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f63c29306ad1a801eccf0d5f62defad357f80d03", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/f63c29306ad1a801eccf0d5f62defad357f80d03", "committedDate": "2020-07-12T05:40:26Z", "message": "Some minor formatting and renaming"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cb245cf67aede60d2e849fa1584aa2ae92557ec8", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/cb245cf67aede60d2e849fa1584aa2ae92557ec8", "committedDate": "2020-07-11T12:31:53Z", "message": "Merge fixes with updated master branch"}, "afterCommit": {"oid": "f63c29306ad1a801eccf0d5f62defad357f80d03", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/f63c29306ad1a801eccf0d5f62defad357f80d03", "committedDate": "2020-07-12T05:40:26Z", "message": "Some minor formatting and renaming"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMzM3MTQx", "url": "https://github.com/apache/beam/pull/12147#pullrequestreview-450337141", "createdAt": "2020-07-17T02:38:28Z", "commit": {"oid": "f63c29306ad1a801eccf0d5f62defad357f80d03"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjozODoyOFrOGzDYgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMjo0NDo0N1rOGzDe4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4NTk4NA==", "bodyText": "Why is this volatile? Can you make it private final and add it to the constructor? So each instance is immutable", "url": "https://github.com/apache/beam/pull/12147#discussion_r456185984", "createdAt": "2020-07-17T02:38:28Z", "author": {"login": "pabloem"}, "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/JsonToRow.java", "diffHunk": "@@ -91,6 +92,7 @@\n   static class JsonToRowFn extends PTransform<PCollection<String>, PCollection<Row>> {\n     private transient volatile @Nullable ObjectMapper objectMapper;\n     private Schema schema;\n+    private volatile NullBehavior nullBehavior = NullBehavior.ACCEPT_MISSING_OR_NULL;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f63c29306ad1a801eccf0d5f62defad357f80d03"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4NzM4Ng==", "bodyText": "Perhaps the schema should also be final.", "url": "https://github.com/apache/beam/pull/12147#discussion_r456187386", "createdAt": "2020-07-17T02:43:55Z", "author": {"login": "pabloem"}, "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/JsonToRow.java", "diffHunk": "@@ -91,6 +92,7 @@\n   static class JsonToRowFn extends PTransform<PCollection<String>, PCollection<Row>> {\n     private transient volatile @Nullable ObjectMapper objectMapper;\n     private Schema schema;\n+    private volatile NullBehavior nullBehavior = NullBehavior.ACCEPT_MISSING_OR_NULL;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4NTk4NA=="}, "originalCommit": {"oid": "f63c29306ad1a801eccf0d5f62defad357f80d03"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE4NzYxNg==", "bodyText": "Can you please add javadoc for the default null behavior?", "url": "https://github.com/apache/beam/pull/12147#discussion_r456187616", "createdAt": "2020-07-17T02:44:47Z", "author": {"login": "pabloem"}, "path": "sdks/java/core/src/main/java/org/apache/beam/sdk/transforms/JsonToRow.java", "diffHunk": "@@ -91,6 +92,7 @@\n   static class JsonToRowFn extends PTransform<PCollection<String>, PCollection<Row>> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f63c29306ad1a801eccf0d5f62defad357f80d03"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92ff25d8648c08da85b0fb3ffa16582c64c173d6", "author": {"user": null}, "url": "https://github.com/apache/beam/commit/92ff25d8648c08da85b0fb3ffa16582c64c173d6", "committedDate": "2020-07-17T12:43:26Z", "message": "Responded to comments of the PR"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3284, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}