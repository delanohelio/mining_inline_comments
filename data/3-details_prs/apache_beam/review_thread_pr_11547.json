{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5ODUyNDUw", "number": 11547, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwNDowNDo1N1rOD3AbyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwNDowNDo1N1rOD3AbyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5MDA1Mzg1OnYy", "diffSide": "RIGHT", "path": "sdks/python/apache_beam/runners/direct/transform_evaluator.py", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwNDowNDo1N1rOGNBlXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxNzoxNDozM1rOGNeiVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjMxMDYyMA==", "bodyText": "Does the runner re-instantiate the DoFn for each bundle? That is the contract of teardown. The DoFn instance can never be touched again. (I'm mostly trying to learn more about the Python SDK and runners)", "url": "https://github.com/apache/beam/pull/11547#discussion_r416310620", "createdAt": "2020-04-28T04:04:57Z", "author": {"login": "kennknowles"}, "path": "sdks/python/apache_beam/runners/direct/transform_evaluator.py", "diffHunk": "@@ -874,6 +875,7 @@ def process_element(self, element):\n \n   def finish_bundle(self):\n     self.runner.finish()\n+    self.runner.teardown()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ed8b4277f20acf11b674ef6f39d69bf6aa0356a"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc2ODUzMA==", "bodyText": "Yes, it does re-instantiate for each bundle. I remember we had a jira somewhere to re-use dofn instances for more than one bundle, we never implemented that.", "url": "https://github.com/apache/beam/pull/11547#discussion_r416768530", "createdAt": "2020-04-28T16:49:43Z", "author": {"login": "aaltay"}, "path": "sdks/python/apache_beam/runners/direct/transform_evaluator.py", "diffHunk": "@@ -874,6 +875,7 @@ def process_element(self, element):\n \n   def finish_bundle(self):\n     self.runner.finish()\n+    self.runner.teardown()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjMxMDYyMA=="}, "originalCommit": {"oid": "0ed8b4277f20acf11b674ef6f39d69bf6aa0356a"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc4NDk4Mg==", "bodyText": "I need to check this, but in Python, generally, we do not reuse Dofns, so they're recreated for each bundle. Let me confirm..", "url": "https://github.com/apache/beam/pull/11547#discussion_r416784982", "createdAt": "2020-04-28T17:14:33Z", "author": {"login": "pabloem"}, "path": "sdks/python/apache_beam/runners/direct/transform_evaluator.py", "diffHunk": "@@ -874,6 +875,7 @@ def process_element(self, element):\n \n   def finish_bundle(self):\n     self.runner.finish()\n+    self.runner.teardown()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjMxMDYyMA=="}, "originalCommit": {"oid": "0ed8b4277f20acf11b674ef6f39d69bf6aa0356a"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1169, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}