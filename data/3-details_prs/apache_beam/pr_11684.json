{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2ODk5NDkw", "number": 11684, "title": "[BEAM-9622] Add Python SqlTransform test that joins tagged PCollections", "bodyText": "Turns out this \"just works\". Thanks @ihji and @chamikaramj for the great work on cross-language that enabled it :)\nR: @robertwb\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-05-12T18:35:21Z", "url": "https://github.com/apache/beam/pull/11684", "merged": true, "mergeCommit": {"oid": "59cdfb68b6141b65d4aadb875f11ad49e1914425"}, "closed": true, "closedAt": "2020-05-12T23:50:55Z", "author": {"login": "TheNeuralBit"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgom0sAH2gAyNDE2ODk5NDkwOjJiMmQyOTlmMDZmNDMwOWE2NTFkNzk2NzhiODY2YzY2NTU0OTQ4NTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgsjS5AH2gAyNDE2ODk5NDkwOjQzMjc3MjFkNzhmYjk2MDA3N2U4MmE5MjMzOGRhN2QzYmZkM2JmOTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2b2d299f06f4309a651d79678b866c6655494859", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/2b2d299f06f4309a651d79678b866c6655494859", "committedDate": "2020-05-12T18:30:16Z", "message": "Add test that joins tagged pcollections"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNDUyOTI2", "url": "https://github.com/apache/beam/pull/11684#pullrequestreview-410452926", "createdAt": "2020-05-12T21:58:44Z", "commit": {"oid": "2b2d299f06f4309a651d79678b866c6655494859"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMTo1ODo0NFrOGUadnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMTo1ODo0NFrOGUadnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA1ODI3MQ==", "bodyText": "Could we choose names that don't require so much quoting? (Or is that part of the test?)", "url": "https://github.com/apache/beam/pull/11684#discussion_r424058271", "createdAt": "2020-05-12T21:58:44Z", "author": {"login": "robertwb"}, "path": "sdks/python/apache_beam/transforms/sql_test.py", "diffHunk": "@@ -111,6 +114,27 @@ def test_agg(self):\n               FROM PCOLLECTION GROUP BY `str`\"\"\"))\n       assert_that(out, equal_to([(\"foo\", 3, 3, 2), (\"bar\", 4, 8, 1.414)]))\n \n+  def test_tagged_join(self):\n+    with TestPipeline() as p:\n+      enrich = (\n+          p | \"Create enrich\" >> beam.Create(\n+              [Enrich(1, \"a\"), Enrich(2, \"b\"), Enrich(26, \"z\")]))\n+      rows = (\n+          p | \"Create rows\" >> beam.Create([\n+              SimpleRow(1, \"foo\", 3.14),\n+              SimpleRow(26, \"bar\", 1.11),\n+              SimpleRow(1, \"baz\", 2.34)\n+          ]))\n+      out = ({\n+          'rows': rows, 'enrich': enrich\n+      }\n+             | SqlTransform(\n+                 \"\"\"\n+              SELECT\n+                `rows`.`int` AS `int`, `enrich`.`metadata` AS `metadata`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2b2d299f06f4309a651d79678b866c6655494859"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4327721d78fb960077e82a92338da7d3bfd3bf94", "author": {"user": {"login": "TheNeuralBit", "name": "Brian Hulette"}}, "url": "https://github.com/apache/beam/commit/4327721d78fb960077e82a92338da7d3bfd3bf94", "committedDate": "2020-05-12T23:06:02Z", "message": "remove unnecessary backticks"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4961, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}