{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MDAwNDYx", "number": 11235, "title": "[BEAM-9618] Pull bundle descriptors.", "bodyText": "Thank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-03-26T07:26:08Z", "url": "https://github.com/apache/beam/pull/11235", "merged": true, "mergeCommit": {"oid": "08335d6acb544b674d5d47365c1fc0772399f7ec"}, "closed": true, "closedAt": "2020-04-06T21:53:21Z", "author": {"login": "robertwb"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcReSUEgFqTM4MjE1NzI4OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVDXmVgH2gAyMzk0MDAwNDYxOjQ4ZmIyZTY3ZGEwMzk1MTA2OWFhMmM1OTYwMTg1Y2U3NDBhY2I2NDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMTU3Mjg5", "url": "https://github.com/apache/beam/pull/11235#pullrequestreview-382157289", "createdAt": "2020-03-26T15:59:56Z", "commit": {"oid": "b3073a346ebbd53e9dcf18680b089570402c800a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNTo1OTo1NlrOF8OEjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxNTo1OTo1NlrOF8OEjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY4OTQyMQ==", "bodyText": "I would have expected this to be a separate stream containing SDK requests similar to how Control works or made Control bidirectional for requests and responses by making a singular Instruction field that is streamed both ways that contains both Request and Response fields.\nThe advantage of using a stream is that it may be important to provide ordering over SDK requests/responses. Putting it into the Control stream allows for a total ordering between all Runner and SDK requests/responses (to solve the instruction id collision issue, we can assign servers the \"s\" prefix and clients the \"c\" prefix).", "url": "https://github.com/apache/beam/pull/11235#discussion_r398689421", "createdAt": "2020-03-26T15:59:56Z", "author": {"login": "lukecwik"}, "path": "model/fn-execution/src/main/proto/beam_fn_api.proto", "diffHunk": "@@ -81,6 +81,13 @@ service BeamFnControl {\n       returns (\n           // A stream of instructions requested of the SDK to be performed.\n           stream InstructionRequest) {}\n+\n+  rpc GetProcessBundleDescriptor(GetProcessBundleDescriptorRequest) returns (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3073a346ebbd53e9dcf18680b089570402c800a"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b3073a346ebbd53e9dcf18680b089570402c800a", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/b3073a346ebbd53e9dcf18680b089570402c800a", "committedDate": "2020-03-26T07:23:05Z", "message": "Java FnApiClient support."}, "afterCommit": {"oid": "cebab89aa6221ea4e981baec6eebf610b172dbb6", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/cebab89aa6221ea4e981baec6eebf610b172dbb6", "committedDate": "2020-03-26T23:28:04Z", "message": "DO NOT MERGE test ignoring registration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b0be3434af3494e097de2a655baba9c205eaaec", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/0b0be3434af3494e097de2a655baba9c205eaaec", "committedDate": "2020-03-30T16:25:31Z", "message": "yapf"}, "afterCommit": {"oid": "590a6698303040c99781c37dfaf2f38993ae8f3f", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/590a6698303040c99781c37dfaf2f38993ae8f3f", "committedDate": "2020-04-01T08:15:35Z", "message": "DO NOT MERGE test ignoring registration"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "590a6698303040c99781c37dfaf2f38993ae8f3f", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/590a6698303040c99781c37dfaf2f38993ae8f3f", "committedDate": "2020-04-01T08:15:35Z", "message": "DO NOT MERGE test ignoring registration"}, "afterCommit": {"oid": "6620c70ed996b50a63fa7268b7d5e98906d09608", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/6620c70ed996b50a63fa7268b7d5e98906d09608", "committedDate": "2020-04-01T09:27:21Z", "message": "DO NOT MERGE test ignoring registration"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1OTg5MDA3", "url": "https://github.com/apache/beam/pull/11235#pullrequestreview-385989007", "createdAt": "2020-04-01T22:18:58Z", "commit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjoxODo1OFrOF_Uq0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMjo1MDo0OVrOF_Varw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0MzI0OQ==", "bodyText": "Since this is a new method, we should force all users to supply it.", "url": "https://github.com/apache/beam/pull/11235#discussion_r401943249", "createdAt": "2020-04-01T22:18:58Z", "author": {"login": "lukecwik"}, "path": "runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/FnApiControlClientPoolService.java", "diffHunk": "@@ -105,12 +105,38 @@ public static FnApiControlClientPoolService offeringClientsToPool(\n     return newClient.asResponseObserver();\n   }\n \n+  @Override\n+  public void getProcessBundleDescriptor(\n+      BeamFnApi.GetProcessBundleDescriptorRequest request,\n+      StreamObserver<BeamFnApi.ProcessBundleDescriptor> responseObserver) {\n+    final String workerId = headerAccessor.getSdkWorkerId();\n+    if (Strings.isNullOrEmpty(workerId)) {\n+      // TODO(BEAM-4149): Enforce proper worker id.\n+      LOG.warn(\"No worker_id header provided in getProcessBundleDescriptor request\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0NTU1Mw==", "bodyText": "Please return the NOT_FOUND status error if the process bundle descriptor is null.", "url": "https://github.com/apache/beam/pull/11235#discussion_r401945553", "createdAt": "2020-04-01T22:24:31Z", "author": {"login": "lukecwik"}, "path": "runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/FnApiControlClientPoolService.java", "diffHunk": "@@ -105,12 +105,38 @@ public static FnApiControlClientPoolService offeringClientsToPool(\n     return newClient.asResponseObserver();\n   }\n \n+  @Override\n+  public void getProcessBundleDescriptor(\n+      BeamFnApi.GetProcessBundleDescriptorRequest request,\n+      StreamObserver<BeamFnApi.ProcessBundleDescriptor> responseObserver) {\n+    final String workerId = headerAccessor.getSdkWorkerId();\n+    if (Strings.isNullOrEmpty(workerId)) {\n+      // TODO(BEAM-4149): Enforce proper worker id.\n+      LOG.warn(\"No worker_id header provided in getProcessBundleDescriptor request\");\n+    }\n+\n+    LOG.info(\"getProcessBundleDescriptor request with id {}\", workerId);\n+\n+    FnApiControlClient client;\n+    synchronized (lock) {\n+      client = vendedClients.get(workerId);\n+    }\n+    LOG.warn(\"getProcessBundleDescriptor client {}\", client);\n+    LOG.warn(\"getProcessBundleDescriptor id {}\", request.getProcessBundleDescriptorId());\n+    LOG.warn(\n+        \"getProcessBundleDescriptor result {}\",\n+        client.getProcessBundleDescriptor(request.getProcessBundleDescriptorId()));\n+    responseObserver.onNext(\n+        client.getProcessBundleDescriptor(request.getProcessBundleDescriptorId()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0NjIxMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                LOG.info(\"getProcessBundleDescriptor request with id {}\", workerId);\n          \n          \n            \n                LOG.info(\"getProcessBundleDescriptor: descriptor {} worker id {}\", request.getProcessBundleDescriptorId(), workerId);", "url": "https://github.com/apache/beam/pull/11235#discussion_r401946210", "createdAt": "2020-04-01T22:26:02Z", "author": {"login": "lukecwik"}, "path": "runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/FnApiControlClientPoolService.java", "diffHunk": "@@ -105,12 +105,38 @@ public static FnApiControlClientPoolService offeringClientsToPool(\n     return newClient.asResponseObserver();\n   }\n \n+  @Override\n+  public void getProcessBundleDescriptor(\n+      BeamFnApi.GetProcessBundleDescriptorRequest request,\n+      StreamObserver<BeamFnApi.ProcessBundleDescriptor> responseObserver) {\n+    final String workerId = headerAccessor.getSdkWorkerId();\n+    if (Strings.isNullOrEmpty(workerId)) {\n+      // TODO(BEAM-4149): Enforce proper worker id.\n+      LOG.warn(\"No worker_id header provided in getProcessBundleDescriptor request\");\n+    }\n+\n+    LOG.info(\"getProcessBundleDescriptor request with id {}\", workerId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0NjI2MQ==", "bodyText": "Did you intend to keep all these logs?", "url": "https://github.com/apache/beam/pull/11235#discussion_r401946261", "createdAt": "2020-04-01T22:26:11Z", "author": {"login": "lukecwik"}, "path": "runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/FnApiControlClientPoolService.java", "diffHunk": "@@ -105,12 +105,38 @@ public static FnApiControlClientPoolService offeringClientsToPool(\n     return newClient.asResponseObserver();\n   }\n \n+  @Override\n+  public void getProcessBundleDescriptor(\n+      BeamFnApi.GetProcessBundleDescriptorRequest request,\n+      StreamObserver<BeamFnApi.ProcessBundleDescriptor> responseObserver) {\n+    final String workerId = headerAccessor.getSdkWorkerId();\n+    if (Strings.isNullOrEmpty(workerId)) {\n+      // TODO(BEAM-4149): Enforce proper worker id.\n+      LOG.warn(\"No worker_id header provided in getProcessBundleDescriptor request\");\n+    }\n+\n+    LOG.info(\"getProcessBundleDescriptor request with id {}\", workerId);\n+\n+    FnApiControlClient client;\n+    synchronized (lock) {\n+      client = vendedClients.get(workerId);\n+    }\n+    LOG.warn(\"getProcessBundleDescriptor client {}\", client);\n+    LOG.warn(\"getProcessBundleDescriptor id {}\", request.getProcessBundleDescriptorId());\n+    LOG.warn(\n+        \"getProcessBundleDescriptor result {}\",\n+        client.getProcessBundleDescriptor(request.getProcessBundleDescriptorId()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0NjY0Ng==", "bodyText": "We should check that we are not closed.", "url": "https://github.com/apache/beam/pull/11235#discussion_r401946646", "createdAt": "2020-04-01T22:27:09Z", "author": {"login": "lukecwik"}, "path": "runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/FnApiControlClientPoolService.java", "diffHunk": "@@ -105,12 +105,38 @@ public static FnApiControlClientPoolService offeringClientsToPool(\n     return newClient.asResponseObserver();\n   }\n \n+  @Override\n+  public void getProcessBundleDescriptor(\n+      BeamFnApi.GetProcessBundleDescriptorRequest request,\n+      StreamObserver<BeamFnApi.ProcessBundleDescriptor> responseObserver) {\n+    final String workerId = headerAccessor.getSdkWorkerId();\n+    if (Strings.isNullOrEmpty(workerId)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0ODA0MQ==", "bodyText": "if we can, we should test the registration lookup failure case.\nThe success case will be easily be covered by other tests.", "url": "https://github.com/apache/beam/pull/11235#discussion_r401948041", "createdAt": "2020-04-01T22:30:31Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/runners/worker/sdk_worker_test.py", "diffHunk": "@@ -115,8 +115,9 @@ def _check_fn_registration_multi_request(self, *args):\n           {item.id: item\n            for item in process_bundle_descriptors})\n \n-  def test_fn_registration(self):\n-    self._check_fn_registration_multi_request((1, 4), (4, 4))\n+\n+#   def test_fn_registration(self):\n+#     self._check_fn_registration_multi_request((1, 4), (4, 4))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0ODY2NQ==", "bodyText": "You might as well and implement the UnaryStreamClientInterceptor and StreamUnaryClientInterceptor now.", "url": "https://github.com/apache/beam/pull/11235#discussion_r401948665", "createdAt": "2020-04-01T22:32:09Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/runners/worker/worker_id_interceptor.py", "diffHunk": "@@ -48,17 +49,23 @@ def __init__(self, worker_id=None):\n     if worker_id:\n       self._worker_id = worker_id\n \n+  def intercept_unary_unary(self, continuation, client_call_details, request):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1MjE5MQ==", "bodyText": "Hmm, each RPC will need to pass the worker_id which is a minor argument for bidi stream but not worth the complexity of it compared to the unary RPC. We also don't expect this to happen a lot.", "url": "https://github.com/apache/beam/pull/11235#discussion_r401952191", "createdAt": "2020-04-01T22:41:47Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/runners/worker/worker_id_interceptor.py", "diffHunk": "@@ -48,17 +49,23 @@ def __init__(self, worker_id=None):\n     if worker_id:\n       self._worker_id = worker_id\n \n+  def intercept_unary_unary(self, continuation, client_call_details, request):\n+    return self._intercept(continuation, client_call_details, request)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1MjYwOQ==", "bodyText": "Please add failure tests to FnApiControlClientPoolService for NOT_FOUND and missing worker id.", "url": "https://github.com/apache/beam/pull/11235#discussion_r401952609", "createdAt": "2020-04-01T22:42:52Z", "author": {"login": "lukecwik"}, "path": "runners/java-fn-execution/src/main/java/org/apache/beam/runners/fnexecution/control/FnApiControlClientPoolService.java", "diffHunk": "@@ -105,12 +105,38 @@ public static FnApiControlClientPoolService offeringClientsToPool(\n     return newClient.asResponseObserver();\n   }\n \n+  @Override\n+  public void getProcessBundleDescriptor(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NDYyMw==", "bodyText": "What appears in the default dict if GetProcessBundleDescriptor raises an error because the call fails?\nDoes it get propagated to the caller and it fails processing the bundle (is anything left in the map)?", "url": "https://github.com/apache/beam/pull/11235#discussion_r401954623", "createdAt": "2020-04-01T22:48:33Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/runners/worker/sdk_worker.py", "diffHunk": "@@ -112,7 +113,11 @@ def __init__(self,\n     self._state_handler_factory = GrpcStateHandlerFactory(\n         self._state_cache, credentials)\n     self._profiler_factory = profiler_factory\n-    self._fns = {}  # type: Dict[str, beam_fn_api_pb2.ProcessBundleDescriptor]\n+    self._fns = KeyedDefaultDict(\n+        lambda id: self._control_stub.GetProcessBundleDescriptor(\n+            beam_fn_api_pb2.GetProcessBundleDescriptorRequest(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1NTUwMw==", "bodyText": "test?", "url": "https://github.com/apache/beam/pull/11235#discussion_r401955503", "createdAt": "2020-04-01T22:50:49Z", "author": {"login": "lukecwik"}, "path": "sdks/python/apache_beam/runners/worker/worker_id_interceptor.py", "diffHunk": "@@ -35,7 +35,8 @@ class _ClientCallDetails(collections.namedtuple(\n   pass\n \n \n-class WorkerIdInterceptor(grpc.StreamStreamClientInterceptor):\n+class WorkerIdInterceptor(grpc.UnaryUnaryClientInterceptor,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MTQ3NzAx", "url": "https://github.com/apache/beam/pull/11235#pullrequestreview-386147701", "createdAt": "2020-04-02T06:51:24Z", "commit": {"oid": "3b986380e56cc58a29264bb2e37cef7d415b6528"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NDM3OTQy", "url": "https://github.com/apache/beam/pull/11235#pullrequestreview-388437942", "createdAt": "2020-04-06T16:52:25Z", "commit": {"oid": "71dbda7bc3b2c82c35bef75789b80ff64702723f"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo1MjoyNVrOGBg9Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo1Mjo1MlrOGBg-fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI0MTc0Nw==", "bodyText": "Validate the \"not found\" shows up in the status message and/or status code to ensure that we got the right StatusException", "url": "https://github.com/apache/beam/pull/11235#discussion_r404241747", "createdAt": "2020-04-06T16:52:25Z", "author": {"login": "lukecwik"}, "path": "runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/FnApiControlClientPoolServiceTest.java", "diffHunk": "@@ -120,4 +121,16 @@ public void onCompleted() {\n     latch.await();\n     assertThat(sawComplete.get(), is(true));\n   }\n+\n+  @Test\n+  public void testUnknownBundle() throws Exception {\n+    BeamFnApi.GetProcessBundleDescriptorRequest request =\n+        BeamFnApi.GetProcessBundleDescriptorRequest.newBuilder()\n+            .setProcessBundleDescriptorId(\"missing\")\n+            .build();\n+    StreamObserver<BeamFnApi.ProcessBundleDescriptor> responseObserver = mock(StreamObserver.class);\n+    controlService.getProcessBundleDescriptor(request, responseObserver);\n+\n+    verify(responseObserver).onError(any(StatusException.class));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71dbda7bc3b2c82c35bef75789b80ff64702723f"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI0MjA0Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public void testRegisterNundle() {\n          \n          \n            \n              public void testRegisterBundle() {", "url": "https://github.com/apache/beam/pull/11235#discussion_r404242047", "createdAt": "2020-04-06T16:52:52Z", "author": {"login": "lukecwik"}, "path": "runners/java-fn-execution/src/test/java/org/apache/beam/runners/fnexecution/control/FnApiControlClientTest.java", "diffHunk": "@@ -175,4 +179,23 @@ public void testOnCloseMultipleListener() throws Exception {\n     verify(mockConsumer1).accept(client);\n     verify(mockConsumer2).accept(client);\n   }\n+\n+  @Test\n+  public void testRegisterNundle() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71dbda7bc3b2c82c35bef75789b80ff64702723f"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cb79b83712b8244a18935fe714cb04fbb2a4d34", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/1cb79b83712b8244a18935fe714cb04fbb2a4d34", "committedDate": "2020-04-06T17:45:42Z", "message": "[BEAM-9618] Add protocol for requesting process bundle descriptors."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe5f6698155bdab45d5eab40dc1a439882717b28", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/fe5f6698155bdab45d5eab40dc1a439882717b28", "committedDate": "2020-04-06T17:46:07Z", "message": "[BEAM-9618] Update Python to support process bundle descriptor fetching."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c7f83deabdf655185f9bfaed7a75938ff8552d2", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/1c7f83deabdf655185f9bfaed7a75938ff8552d2", "committedDate": "2020-04-06T17:46:26Z", "message": "[BEAM-9618] Java FnApiClient support for process bundle descriptor pulling."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1a36adab5b1614b44c2175cd8fbadbfd64d8cc8a", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/1a36adab5b1614b44c2175cd8fbadbfd64d8cc8a", "committedDate": "2020-04-04T00:29:43Z", "message": "test fix"}, "afterCommit": {"oid": "1c7f83deabdf655185f9bfaed7a75938ff8552d2", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/1c7f83deabdf655185f9bfaed7a75938ff8552d2", "committedDate": "2020-04-06T17:46:26Z", "message": "[BEAM-9618] Java FnApiClient support for process bundle descriptor pulling."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48fb2e67da03951069aa2c5960185ce740acb644", "author": {"user": {"login": "robertwb", "name": "Robert Bradshaw"}}, "url": "https://github.com/apache/beam/commit/48fb2e67da03951069aa2c5960185ce740acb644", "committedDate": "2020-04-06T18:53:59Z", "message": "Typo fix."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4729, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}