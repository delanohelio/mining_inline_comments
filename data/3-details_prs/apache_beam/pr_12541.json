{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2NTcwMDA3", "number": 12541, "title": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac", "bodyText": "Workflow run with java tests\nBefore merging\nBefore merging it is required to setup related secrets:\n\nGCP_TESTING_BUCKET - beam-github-actions-tests\nGCP_PROJECT_ID - apache-beam-testing\nGCP_REGION - us-central1\n\nBefore merging it Service Account should have elevated permissions:\n\nStorage Admin (roles/storage.admin)\nDataflow Admin (roles/dataflow.admin)\n\nit was requested in https://issues.apache.org/jira/browse/INFRA-20675\nInformation about PR\nExample run on my local fork: https://github.com/TobKed/beam/actions/runs/205143020\nFor tests failing on windows I created JIRA BEAM-10683.\nI didn't want to solve them here since I am not so much familiar with java and Beam logic so I didn't want just make tests green, what could hide potentially real issue.\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nDataflow\nFlink\nSamza\nSpark\nTwister2\n\n\n\n\nGo\n\n---\n\n---\n\n---\n\n\nJava\n\n\n\n\n\n\n\n\nPython\n\n\n\n---\n\n---\n\n\nXLang\n\n---\n\n---\n\n---\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.\nGitHub Actions Tests Status (on master branch)\n\nSee CI.md for more information about GitHub Actions CI.", "createdAt": "2020-08-12T07:12:45Z", "url": "https://github.com/apache/beam/pull/12541", "merged": true, "mergeCommit": {"oid": "094d06c19fccfa960f608d43ddfba8eca18bd88a"}, "closed": true, "closedAt": "2020-08-24T13:06:31Z", "author": {"login": "TobKed"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc--BT8AFqTQ2NzkxOTY5Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdA_DZhABqjM2NzgyNzE5OTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3OTE5Njk3", "url": "https://github.com/apache/beam/pull/12541#pullrequestreview-467919697", "createdAt": "2020-08-14T23:24:52Z", "commit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQyMzoyNDo1MlrOHBFpew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNVQwMDoyMzo0OVrOHBGRvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkwMzE2Mw==", "bodyText": "Is there an equivalent for python or go tests somewhere?", "url": "https://github.com/apache/beam/pull/12541#discussion_r470903163", "createdAt": "2020-08-14T23:24:52Z", "author": {"login": "tysonjh"}, "path": ".github/workflows/cancel.yml", "diffHunk": "@@ -32,3 +35,18 @@ jobs:\n         with:\n           workflow_id: ${{ env.WORKFLOW_ID }}\n           access_token: ${{ github.token }}\n+\n+  cancel_java_tests:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkwMzQ1NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  - name: Get build_wheels workflow id\n          \n          \n            \n                  - name: Get java_tests workflow id", "url": "https://github.com/apache/beam/pull/12541#discussion_r470903455", "createdAt": "2020-08-14T23:26:20Z", "author": {"login": "tysonjh"}, "path": ".github/workflows/cancel.yml", "diffHunk": "@@ -32,3 +35,18 @@ jobs:\n         with:\n           workflow_id: ${{ env.WORKFLOW_ID }}\n           access_token: ${{ github.token }}\n+\n+  cancel_java_tests:\n+    name: 'Cancel Previous Runs of Java Tests'\n+    runs-on: ubuntu-latest\n+    timeout-minutes: 3\n+    steps:\n+      - name: Get build_wheels workflow id", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkwNjMyNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if: ${{ always() }}\n          \n          \n            \n                    if: always()", "url": "https://github.com/apache/beam/pull/12541#discussion_r470906326", "createdAt": "2020-08-14T23:42:08Z", "author": {"login": "tysonjh"}, "path": ".github/workflows/java_tests.yml", "diffHunk": "@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+# To learn more about GitHub Actions in Apache Beam check the CI.md\n+\n+name: Java Tests\n+\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      runDataflow:\n+        description: 'Type \"true\" if you want to run Dataflow tests (GCP variables must be configured, check CI.md)'\n+        default: false\n+  schedule:\n+    - cron: '10 2 * * *'\n+  push:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+  pull_request:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+    paths: ['sdks/java/**', 'model/**', 'runners/**', 'examples/java/**', 'examples/kotlin/**', 'release/**']\n+\n+\n+jobs:\n+\n+  check_gcp_variables:\n+    timeout-minutes: 5\n+    name: \"Check GCP variables set\"\n+    runs-on: ubuntu-latest\n+    outputs:\n+      gcp-variables-set: ${{ steps.check_gcp_variables.outputs.gcp-variables-set }}\n+    steps:\n+      - uses: actions/checkout@v2\n+      - name: \"Check are GCP variables set\"\n+        run: \"./scripts/ci/ci_check_are_gcp_variables_set.sh\"\n+        id: check_gcp_variables\n+        env:\n+          GCP_PROJECT_ID: ${{ secrets.GCP_PROJECT_ID }}\n+          GCP_SA_EMAIL: ${{ secrets.GCP_SA_EMAIL }}\n+          GCP_SA_KEY: ${{ secrets.GCP_SA_KEY }}\n+          GCP_TESTING_BUCKET: ${{ secrets.GCP_TESTING_BUCKET }}\n+\n+  java_unit_tests:\n+    name: 'Java Unit Tests'\n+    runs-on: ${{ matrix.os }}\n+    strategy:\n+      fail-fast: false\n+      matrix:\n+        os: [ubuntu-latest, macos-latest, windows-latest]\n+    steps:\n+      - name: Checkout code\n+        uses: actions/checkout@v2\n+      # :sdks:java:core:test\n+      - name: Run :sdks:java:core:test\n+        run: ./gradlew :sdks:java:core:test\n+      - name: Upload test logs for :sdks:java:core:test\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_unit_tests-sdks-java-core-test-${{ matrix.os }}\n+          path: sdks/java/core/build/reports/tests/test/**\n+      # :sdks:java:harness:test\n+      - name: Run :sdks:java:harness:test\n+        if: ${{ always() }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkwNjc4Ng==", "bodyText": "If if: always() is always true, is this condition really needed? (here and elsewhere in this workflow)", "url": "https://github.com/apache/beam/pull/12541#discussion_r470906786", "createdAt": "2020-08-14T23:44:34Z", "author": {"login": "tysonjh"}, "path": ".github/workflows/java_tests.yml", "diffHunk": "@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+# To learn more about GitHub Actions in Apache Beam check the CI.md\n+\n+name: Java Tests\n+\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      runDataflow:\n+        description: 'Type \"true\" if you want to run Dataflow tests (GCP variables must be configured, check CI.md)'\n+        default: false\n+  schedule:\n+    - cron: '10 2 * * *'\n+  push:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+  pull_request:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+    paths: ['sdks/java/**', 'model/**', 'runners/**', 'examples/java/**', 'examples/kotlin/**', 'release/**']\n+\n+\n+jobs:\n+\n+  check_gcp_variables:\n+    timeout-minutes: 5\n+    name: \"Check GCP variables set\"\n+    runs-on: ubuntu-latest\n+    outputs:\n+      gcp-variables-set: ${{ steps.check_gcp_variables.outputs.gcp-variables-set }}\n+    steps:\n+      - uses: actions/checkout@v2\n+      - name: \"Check are GCP variables set\"\n+        run: \"./scripts/ci/ci_check_are_gcp_variables_set.sh\"\n+        id: check_gcp_variables\n+        env:\n+          GCP_PROJECT_ID: ${{ secrets.GCP_PROJECT_ID }}\n+          GCP_SA_EMAIL: ${{ secrets.GCP_SA_EMAIL }}\n+          GCP_SA_KEY: ${{ secrets.GCP_SA_KEY }}\n+          GCP_TESTING_BUCKET: ${{ secrets.GCP_TESTING_BUCKET }}\n+\n+  java_unit_tests:\n+    name: 'Java Unit Tests'\n+    runs-on: ${{ matrix.os }}\n+    strategy:\n+      fail-fast: false\n+      matrix:\n+        os: [ubuntu-latest, macos-latest, windows-latest]\n+    steps:\n+      - name: Checkout code\n+        uses: actions/checkout@v2\n+      # :sdks:java:core:test\n+      - name: Run :sdks:java:core:test\n+        run: ./gradlew :sdks:java:core:test\n+      - name: Upload test logs for :sdks:java:core:test\n+        uses: actions/upload-artifact@v2\n+        if: always()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkwODczMw==", "bodyText": "Is there a risk that concurrently running workflows could race to write this artifact since it doesn't contain any globally unique information (e.g. date)? Or are artifact names unique to each individual workflow run?", "url": "https://github.com/apache/beam/pull/12541#discussion_r470908733", "createdAt": "2020-08-14T23:54:25Z", "author": {"login": "tysonjh"}, "path": ".github/workflows/java_tests.yml", "diffHunk": "@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+# To learn more about GitHub Actions in Apache Beam check the CI.md\n+\n+name: Java Tests\n+\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      runDataflow:\n+        description: 'Type \"true\" if you want to run Dataflow tests (GCP variables must be configured, check CI.md)'\n+        default: false\n+  schedule:\n+    - cron: '10 2 * * *'\n+  push:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+  pull_request:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+    paths: ['sdks/java/**', 'model/**', 'runners/**', 'examples/java/**', 'examples/kotlin/**', 'release/**']\n+\n+\n+jobs:\n+\n+  check_gcp_variables:\n+    timeout-minutes: 5\n+    name: \"Check GCP variables set\"\n+    runs-on: ubuntu-latest\n+    outputs:\n+      gcp-variables-set: ${{ steps.check_gcp_variables.outputs.gcp-variables-set }}\n+    steps:\n+      - uses: actions/checkout@v2\n+      - name: \"Check are GCP variables set\"\n+        run: \"./scripts/ci/ci_check_are_gcp_variables_set.sh\"\n+        id: check_gcp_variables\n+        env:\n+          GCP_PROJECT_ID: ${{ secrets.GCP_PROJECT_ID }}\n+          GCP_SA_EMAIL: ${{ secrets.GCP_SA_EMAIL }}\n+          GCP_SA_KEY: ${{ secrets.GCP_SA_KEY }}\n+          GCP_TESTING_BUCKET: ${{ secrets.GCP_TESTING_BUCKET }}\n+\n+  java_unit_tests:\n+    name: 'Java Unit Tests'\n+    runs-on: ${{ matrix.os }}\n+    strategy:\n+      fail-fast: false\n+      matrix:\n+        os: [ubuntu-latest, macos-latest, windows-latest]\n+    steps:\n+      - name: Checkout code\n+        uses: actions/checkout@v2\n+      # :sdks:java:core:test\n+      - name: Run :sdks:java:core:test\n+        run: ./gradlew :sdks:java:core:test\n+      - name: Upload test logs for :sdks:java:core:test\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_unit_tests-sdks-java-core-test-${{ matrix.os }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMDg2NQ==", "bodyText": "Why is a shell used in some jobs but not others (specified here as a config and used in the run config below)? Just curious if it is needed for some reason here specifically since it is an integration test.", "url": "https://github.com/apache/beam/pull/12541#discussion_r470910865", "createdAt": "2020-08-15T00:06:29Z", "author": {"login": "tysonjh"}, "path": ".github/workflows/java_tests.yml", "diffHunk": "@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+# To learn more about GitHub Actions in Apache Beam check the CI.md\n+\n+name: Java Tests\n+\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      runDataflow:\n+        description: 'Type \"true\" if you want to run Dataflow tests (GCP variables must be configured, check CI.md)'\n+        default: false\n+  schedule:\n+    - cron: '10 2 * * *'\n+  push:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+  pull_request:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+    paths: ['sdks/java/**', 'model/**', 'runners/**', 'examples/java/**', 'examples/kotlin/**', 'release/**']\n+\n+\n+jobs:\n+\n+  check_gcp_variables:\n+    timeout-minutes: 5\n+    name: \"Check GCP variables set\"\n+    runs-on: ubuntu-latest\n+    outputs:\n+      gcp-variables-set: ${{ steps.check_gcp_variables.outputs.gcp-variables-set }}\n+    steps:\n+      - uses: actions/checkout@v2\n+      - name: \"Check are GCP variables set\"\n+        run: \"./scripts/ci/ci_check_are_gcp_variables_set.sh\"\n+        id: check_gcp_variables\n+        env:\n+          GCP_PROJECT_ID: ${{ secrets.GCP_PROJECT_ID }}\n+          GCP_SA_EMAIL: ${{ secrets.GCP_SA_EMAIL }}\n+          GCP_SA_KEY: ${{ secrets.GCP_SA_KEY }}\n+          GCP_TESTING_BUCKET: ${{ secrets.GCP_TESTING_BUCKET }}\n+\n+  java_unit_tests:\n+    name: 'Java Unit Tests'\n+    runs-on: ${{ matrix.os }}\n+    strategy:\n+      fail-fast: false\n+      matrix:\n+        os: [ubuntu-latest, macos-latest, windows-latest]\n+    steps:\n+      - name: Checkout code\n+        uses: actions/checkout@v2\n+      # :sdks:java:core:test\n+      - name: Run :sdks:java:core:test\n+        run: ./gradlew :sdks:java:core:test\n+      - name: Upload test logs for :sdks:java:core:test\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_unit_tests-sdks-java-core-test-${{ matrix.os }}\n+          path: sdks/java/core/build/reports/tests/test/**\n+      # :sdks:java:harness:test\n+      - name: Run :sdks:java:harness:test\n+        if: ${{ always() }}\n+        run: ./gradlew :sdks:java:harness:test\n+      - name: Upload test logs for :sdks:java:harness:test\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_unit_tests-sdks-java-harness-test-${{ matrix.os }}\n+          path: sdks/java/harness/build/reports/tests/test/**\n+      # :runners:core-java:test\n+      - name: Run :runners:core-java:test\n+        if: ${{ always() }}\n+        run: ./gradlew :runners:core-java:test\n+      - name: Upload test logs for :runners:core-java:test\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_unit_tests-runners-core-java-test-${{ matrix.os }}\n+          path: runners/core-java/build/reports/tests/test/**\n+\n+  java_wordcount_direct_runner:\n+    name: 'Java Wordcount Direct Runner'\n+    runs-on: ${{ matrix.os }}\n+    strategy:\n+      fail-fast: false\n+      matrix:\n+        os: [ubuntu-latest, macos-latest, windows-latest]\n+    steps:\n+      - name: Checkout code\n+        uses: actions/checkout@v2\n+      - name: Run WordCount Unix\n+        shell: bash\n+        run: |", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMjA2NQ==", "bodyText": "Why upload the whole directory here instead of a globstar? Just curious.", "url": "https://github.com/apache/beam/pull/12541#discussion_r470912065", "createdAt": "2020-08-15T00:14:12Z", "author": {"login": "tysonjh"}, "path": ".github/workflows/java_tests.yml", "diffHunk": "@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+# To learn more about GitHub Actions in Apache Beam check the CI.md\n+\n+name: Java Tests\n+\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      runDataflow:\n+        description: 'Type \"true\" if you want to run Dataflow tests (GCP variables must be configured, check CI.md)'\n+        default: false\n+  schedule:\n+    - cron: '10 2 * * *'\n+  push:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+  pull_request:\n+    branches: ['master', 'release-*']\n+    tags: 'v*'\n+    paths: ['sdks/java/**', 'model/**', 'runners/**', 'examples/java/**', 'examples/kotlin/**', 'release/**']\n+\n+\n+jobs:\n+\n+  check_gcp_variables:\n+    timeout-minutes: 5\n+    name: \"Check GCP variables set\"\n+    runs-on: ubuntu-latest\n+    outputs:\n+      gcp-variables-set: ${{ steps.check_gcp_variables.outputs.gcp-variables-set }}\n+    steps:\n+      - uses: actions/checkout@v2\n+      - name: \"Check are GCP variables set\"\n+        run: \"./scripts/ci/ci_check_are_gcp_variables_set.sh\"\n+        id: check_gcp_variables\n+        env:\n+          GCP_PROJECT_ID: ${{ secrets.GCP_PROJECT_ID }}\n+          GCP_SA_EMAIL: ${{ secrets.GCP_SA_EMAIL }}\n+          GCP_SA_KEY: ${{ secrets.GCP_SA_KEY }}\n+          GCP_TESTING_BUCKET: ${{ secrets.GCP_TESTING_BUCKET }}\n+\n+  java_unit_tests:\n+    name: 'Java Unit Tests'\n+    runs-on: ${{ matrix.os }}\n+    strategy:\n+      fail-fast: false\n+      matrix:\n+        os: [ubuntu-latest, macos-latest, windows-latest]\n+    steps:\n+      - name: Checkout code\n+        uses: actions/checkout@v2\n+      # :sdks:java:core:test\n+      - name: Run :sdks:java:core:test\n+        run: ./gradlew :sdks:java:core:test\n+      - name: Upload test logs for :sdks:java:core:test\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_unit_tests-sdks-java-core-test-${{ matrix.os }}\n+          path: sdks/java/core/build/reports/tests/test/**\n+      # :sdks:java:harness:test\n+      - name: Run :sdks:java:harness:test\n+        if: ${{ always() }}\n+        run: ./gradlew :sdks:java:harness:test\n+      - name: Upload test logs for :sdks:java:harness:test\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_unit_tests-sdks-java-harness-test-${{ matrix.os }}\n+          path: sdks/java/harness/build/reports/tests/test/**\n+      # :runners:core-java:test\n+      - name: Run :runners:core-java:test\n+        if: ${{ always() }}\n+        run: ./gradlew :runners:core-java:test\n+      - name: Upload test logs for :runners:core-java:test\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_unit_tests-runners-core-java-test-${{ matrix.os }}\n+          path: runners/core-java/build/reports/tests/test/**\n+\n+  java_wordcount_direct_runner:\n+    name: 'Java Wordcount Direct Runner'\n+    runs-on: ${{ matrix.os }}\n+    strategy:\n+      fail-fast: false\n+      matrix:\n+        os: [ubuntu-latest, macos-latest, windows-latest]\n+    steps:\n+      - name: Checkout code\n+        uses: actions/checkout@v2\n+      - name: Run WordCount Unix\n+        shell: bash\n+        run: |\n+          bash ./gradlew -p examples/ \\\n+             integrationTest -DintegrationTestPipelineOptions='[\n+          \t \"--runner=DirectRunner\", \"--tempRoot=./tmp\" ]' \\\n+             --tests org.apache.beam.examples.WordCountIT \\\n+             -DintegrationTestRunner=direct\n+      - name: Upload test logs\n+        uses: actions/upload-artifact@v2\n+        if: always()\n+        with:\n+          name: java_wordcount_direct_runner-${{matrix.os}}\n+          path: examples/java/build/reports/tests/integrationTest", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMjMyOQ==", "bodyText": "A user can set these secrets themselves though to test on their own fork?", "url": "https://github.com/apache/beam/pull/12541#discussion_r470912329", "createdAt": "2020-08-15T00:15:45Z", "author": {"login": "tysonjh"}, "path": "CI.md", "diffHunk": "@@ -75,8 +75,27 @@ run categories. Here is a summary of the run categories with regards of the jobs\n Those jobs often have matrix run strategy which runs several different variations of the jobs\n (with different platform type / Python version to run for example)\n \n+### Google Cloud Platform Credentials\n+\n+Some of the jobs require variables stored as a [GitHub Secrets](https://docs.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets)\n+to perform operations on Google Cloud Platform. Currently these jobs are limited to Apache repository only.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxMzQ2OQ==", "bodyText": "Can you create a Jira issue per failing test suite as subtasks of BEAM-10683 please? Having a list of failing test suites will be easier for tracking and hopefully encourage people to chip away at it instead of one large issue for them all.", "url": "https://github.com/apache/beam/pull/12541#discussion_r470913469", "createdAt": "2020-08-15T00:23:49Z", "author": {"login": "tysonjh"}, "path": "sdks/java/core/src/test/java/org/apache/beam/sdk/io/DefaultFilenamePolicyTest.java", "diffHunk": "@@ -28,6 +31,12 @@\n @RunWith(JUnit4.class)\n public class DefaultFilenamePolicyTest {\n \n+  @Before\n+  public void setup() {\n+    // TODO: Fix failing on windows, https://issues.apache.org/jira/browse/BEAM-10683.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc3e39a5740ef2670ccad1edc87c602be758bf25"}, "originalPosition": 18}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e50c0b482fc7277aafaf7581948870400fb93ab7", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/e50c0b482fc7277aafaf7581948870400fb93ab7", "committedDate": "2020-08-17T13:03:41Z", "message": "Apply suggestions from code review\n\nCo-authored-by: Tyson Hamilton <tyson.j.hamilton@gmail.com>"}, "afterCommit": {"oid": "96a317fef25b2b3918d5d5a30ee2f6d0519e1221", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/96a317fef25b2b3918d5d5a30ee2f6d0519e1221", "committedDate": "2020-08-17T14:22:35Z", "message": "Unify artifacts upload paths"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4OTA2NTQ0", "url": "https://github.com/apache/beam/pull/12541#pullrequestreview-468906544", "createdAt": "2020-08-18T00:00:54Z", "commit": {"oid": "96a317fef25b2b3918d5d5a30ee2f6d0519e1221"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2fc97045de5ff141bdb78a3554d055b5718ec3f", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/b2fc97045de5ff141bdb78a3554d055b5718ec3f", "committedDate": "2020-08-18T11:22:45Z", "message": "Seperate jiras for failing tests"}, "afterCommit": {"oid": "31e983dfffb5bac503d1f157bd08c63eca8df18d", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/31e983dfffb5bac503d1f157bd08c63eca8df18d", "committedDate": "2020-08-18T11:33:42Z", "message": "fixup! Seperate jiras for failing tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31e983dfffb5bac503d1f157bd08c63eca8df18d", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/31e983dfffb5bac503d1f157bd08c63eca8df18d", "committedDate": "2020-08-18T11:33:42Z", "message": "fixup! Seperate jiras for failing tests"}, "afterCommit": {"oid": "8f9853b68170ad355923b9b65d796569eedec864", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/8f9853b68170ad355923b9b65d796569eedec864", "committedDate": "2020-08-18T11:35:15Z", "message": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8f9853b68170ad355923b9b65d796569eedec864", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/8f9853b68170ad355923b9b65d796569eedec864", "committedDate": "2020-08-18T11:35:15Z", "message": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac"}, "afterCommit": {"oid": "646fdd70b8eefd8ec5df314ccb144fa836d053cb", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/646fdd70b8eefd8ec5df314ccb144fa836d053cb", "committedDate": "2020-08-19T10:02:34Z", "message": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "646fdd70b8eefd8ec5df314ccb144fa836d053cb", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/646fdd70b8eefd8ec5df314ccb144fa836d053cb", "committedDate": "2020-08-19T10:02:34Z", "message": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac"}, "afterCommit": {"oid": "15312669851b9e4854f7f67d2607ecd0e0f33812", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/15312669851b9e4854f7f67d2607ecd0e0f33812", "committedDate": "2020-08-19T11:19:03Z", "message": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e164d170eb6b5ec1dddd99f09e79dfb0147b84ae", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/e164d170eb6b5ec1dddd99f09e79dfb0147b84ae", "committedDate": "2020-08-21T06:44:43Z", "message": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "15312669851b9e4854f7f67d2607ecd0e0f33812", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/15312669851b9e4854f7f67d2607ecd0e0f33812", "committedDate": "2020-08-19T11:19:03Z", "message": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac"}, "afterCommit": {"oid": "e164d170eb6b5ec1dddd99f09e79dfb0147b84ae", "author": {"user": {"login": "TobKed", "name": "Tobiasz K\u0119dzierski"}}, "url": "https://github.com/apache/beam/commit/e164d170eb6b5ec1dddd99f09e79dfb0147b84ae", "committedDate": "2020-08-21T06:44:43Z", "message": "[BEAM-10682] Add workflow to run Java tests on Linux/Windows/Mac"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3466, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}