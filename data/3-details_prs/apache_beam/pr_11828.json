{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzOTAzNzUx", "number": 11828, "title": "[BEAM-10106] Script the deployment of artifacts to pypi", "bodyText": "R: @tvalentyn\ncc: @TheNeuralBit\n\nThank you for your contribution! Follow this checklist to help us incorporate your contribution quickly and easily:\n\n Choose reviewer(s) and mention them in a comment (R: @username).\n Format the pull request title like [BEAM-XXX] Fixes bug in ApproximateQuantiles, where you replace BEAM-XXX with the appropriate JIRA issue, if applicable. This will automatically link the pull request to the issue.\n Update CHANGES.md with noteworthy changes.\n If this contribution is large, please file an Apache Individual Contributor License Agreement.\n\nSee the Contributor Guide for more tips on how to make review process smoother.\nPost-Commit Tests Status (on master branch)\n\n\n\nLang\nSDK\nApex\nDataflow\nFlink\nGearpump\nSamza\nSpark\n\n\n\n\nGo\n\n---\n---\n\n---\n---\n\n\n\nJava\n\n\n\n\n\n\n\n\n\nPython\n\n---\n\n\n---\n---\n\n\n\nXLang\n---\n---\n---\n\n---\n---\n\n\n\n\nPre-Commit Tests Status (on master branch)\n\n\n\n---\nJava\nPython\nGo\nWebsite\n\n\n\n\nNon-portable\n\n\n\n\n\n\nPortable\n---\n\n---\n---\n\n\n\nSee .test-infra/jenkins/README for trigger phrase, status and link of all Jenkins jobs.", "createdAt": "2020-05-27T14:45:03Z", "url": "https://github.com/apache/beam/pull/11828", "merged": true, "mergeCommit": {"oid": "409607ac8054d1e9be1970b223d3d614c619300b"}, "closed": true, "closedAt": "2020-05-28T17:30:13Z", "author": {"login": "ibzib"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclaakfABqjMzNzg1Mjg1NDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcljT3DgFqTQxOTcxMjAwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "37fdba9335709058e3f582a6ff7bc0971271925f", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/37fdba9335709058e3f582a6ff7bc0971271925f", "committedDate": "2020-05-27T14:41:09Z", "message": "Add pypi script to release guide."}, "afterCommit": {"oid": "5265b0b492efb920943b7804881c150a5e55fb8a", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/5265b0b492efb920943b7804881c150a5e55fb8a", "committedDate": "2020-05-27T14:47:26Z", "message": "Add pypi script to release guide."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4676c438b087b1ddbdb49547fddae6b5edcb1e0c", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/4676c438b087b1ddbdb49547fddae6b5edcb1e0c", "committedDate": "2020-05-27T14:50:45Z", "message": "[BEAM-10106] Script the deployment of artifacts to pypi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/10732c7549a09015b97f18e80b2af69b0c8a4390", "committedDate": "2020-05-27T14:50:49Z", "message": "Add pypi script to release guide."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5265b0b492efb920943b7804881c150a5e55fb8a", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/5265b0b492efb920943b7804881c150a5e55fb8a", "committedDate": "2020-05-27T14:47:26Z", "message": "Add pypi script to release guide."}, "afterCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/10732c7549a09015b97f18e80b2af69b0c8a4390", "committedDate": "2020-05-27T14:50:49Z", "message": "Add pypi script to release guide."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NDExODU2", "url": "https://github.com/apache/beam/pull/11828#pullrequestreview-419411856", "createdAt": "2020-05-27T16:38:39Z", "commit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxNjozODozOVrOGbTl5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxNjo1NjozNVrOGbUW7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4NTczMw==", "bodyText": "How about also print the path that will be cleaned up?", "url": "https://github.com/apache/beam/pull/11828#discussion_r431285733", "createdAt": "2020-05-27T16:38:39Z", "author": {"login": "tvalentyn"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5MjU1NQ==", "bodyText": "Nit: Cleaned up local repo.", "url": "https://github.com/apache/beam/pull/11828#discussion_r431292555", "createdAt": "2020-05-27T16:49:50Z", "author": {"login": "tvalentyn"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5MzI1Mw==", "bodyText": "Let's add a message here that the folder was found, and so it's being deleted.", "url": "https://github.com/apache/beam/pull/11828#discussion_r431293253", "createdAt": "2020-05-27T16:50:56Z", "author": {"login": "tvalentyn"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"\n+  fi\n+}\n+\n+echo \"Enter the release version, e.g. 2.21.0:\"\n+read RELEASE\n+LOCAL_CLONE_DIR=\"beam_release_${RELEASE}\"\n+cd ~\n+if [[ -d ${LOCAL_CLONE_DIR} ]]; then\n+  rm -rf ${LOCAL_CLONE_DIR}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NTA5MA==", "bodyText": "Can we do this in a virtual environment? On my machine this would fail with:\nCould not install packages due to an EnvironmentError: [Errno 13] Permission denied: '/usr/local/lib/python2.7/dist-packages/requests_toolbelt'\nConsider using the `--user` option or check the permissions.", "url": "https://github.com/apache/beam/pull/11828#discussion_r431295090", "createdAt": "2020-05-27T16:52:58Z", "author": {"login": "tvalentyn"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"\n+  fi\n+}\n+\n+echo \"Enter the release version, e.g. 2.21.0:\"\n+read RELEASE\n+LOCAL_CLONE_DIR=\"beam_release_${RELEASE}\"\n+cd ~\n+if [[ -d ${LOCAL_CLONE_DIR} ]]; then\n+  rm -rf ${LOCAL_CLONE_DIR}\n+fi\n+mkdir ${LOCAL_CLONE_DIR}\n+cd ${LOCAL_CLONE_DIR}\n+\n+wget -r --no-parent -A zip,whl \"https://dist.apache.org/repos/dist/dev/beam/${RELEASE}/python\"\n+cd \"dist.apache.org/repos/dist/dev/beam/${RELEASE}/python/\"\n+pip install twine", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NzY0NA==", "bodyText": "nit: s/Exit/Exiting", "url": "https://github.com/apache/beam/pull/11828#discussion_r431297644", "createdAt": "2020-05-27T16:55:35Z", "author": {"login": "tvalentyn"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"\n+  fi\n+}\n+\n+echo \"Enter the release version, e.g. 2.21.0:\"\n+read RELEASE\n+LOCAL_CLONE_DIR=\"beam_release_${RELEASE}\"\n+cd ~\n+if [[ -d ${LOCAL_CLONE_DIR} ]]; then\n+  rm -rf ${LOCAL_CLONE_DIR}\n+fi\n+mkdir ${LOCAL_CLONE_DIR}\n+cd ${LOCAL_CLONE_DIR}\n+\n+wget -r --no-parent -A zip,whl \"https://dist.apache.org/repos/dist/dev/beam/${RELEASE}/python\"\n+cd \"dist.apache.org/repos/dist/dev/beam/${RELEASE}/python/\"\n+pip install twine\n+echo \"Will upload the following files to PyPI:\"\n+ls\n+echo \"Are the files listed correct? [y|N]\"\n+read confirmation\n+if [[ $confirmation != \"y\" ]]; then\n+  echo \"Exit without deploying artifacts to PyPI.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5ODI4Ng==", "bodyText": "Assuming this a verbose command. If not please add some messages to guide the user what is happening.", "url": "https://github.com/apache/beam/pull/11828#discussion_r431298286", "createdAt": "2020-05-27T16:56:35Z", "author": {"login": "tvalentyn"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"\n+  fi\n+}\n+\n+echo \"Enter the release version, e.g. 2.21.0:\"\n+read RELEASE\n+LOCAL_CLONE_DIR=\"beam_release_${RELEASE}\"\n+cd ~\n+if [[ -d ${LOCAL_CLONE_DIR} ]]; then\n+  rm -rf ${LOCAL_CLONE_DIR}\n+fi\n+mkdir ${LOCAL_CLONE_DIR}\n+cd ${LOCAL_CLONE_DIR}\n+\n+wget -r --no-parent -A zip,whl \"https://dist.apache.org/repos/dist/dev/beam/${RELEASE}/python\"\n+cd \"dist.apache.org/repos/dist/dev/beam/${RELEASE}/python/\"\n+pip install twine\n+echo \"Will upload the following files to PyPI:\"\n+ls\n+echo \"Are the files listed correct? [y|N]\"\n+read confirmation\n+if [[ $confirmation != \"y\" ]]; then\n+  echo \"Exit without deploying artifacts to PyPI.\"\n+  clean_up\n+  exit\n+fi\n+twine upload *", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eae2113d43f206e263dd2e6bff3cb19b95f5b81e", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/eae2113d43f206e263dd2e6bff3cb19b95f5b81e", "committedDate": "2020-05-27T21:26:08Z", "message": "Improve log messages in release scripts."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6100fd017c43f6a9e10307574ece718a152943b", "author": {"user": {"login": "ibzib", "name": "Kyle Weaver"}}, "url": "https://github.com/apache/beam/commit/b6100fd017c43f6a9e10307574ece718a152943b", "committedDate": "2020-05-27T21:30:37Z", "message": "Install twine in virtual env."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjE4MDU5", "url": "https://github.com/apache/beam/pull/11828#pullrequestreview-419618059", "createdAt": "2020-05-27T21:21:50Z", "commit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMToyMTo1MFrOGbdmow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMTozMDo1MlrOGbd31Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ0OTc2Mw==", "bodyText": "Done", "url": "https://github.com/apache/beam/pull/11828#discussion_r431449763", "createdAt": "2020-05-27T21:21:50Z", "author": {"login": "ibzib"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI4NTczMw=="}, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ0OTg2NQ==", "bodyText": "Done", "url": "https://github.com/apache/beam/pull/11828#discussion_r431449865", "createdAt": "2020-05-27T21:22:02Z", "author": {"login": "ibzib"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5MjU1NQ=="}, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ1MTIyOQ==", "bodyText": "Done", "url": "https://github.com/apache/beam/pull/11828#discussion_r431451229", "createdAt": "2020-05-27T21:24:49Z", "author": {"login": "ibzib"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"\n+  fi\n+}\n+\n+echo \"Enter the release version, e.g. 2.21.0:\"\n+read RELEASE\n+LOCAL_CLONE_DIR=\"beam_release_${RELEASE}\"\n+cd ~\n+if [[ -d ${LOCAL_CLONE_DIR} ]]; then\n+  rm -rf ${LOCAL_CLONE_DIR}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5MzI1Mw=="}, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ1MTQ2Nw==", "bodyText": "Done", "url": "https://github.com/apache/beam/pull/11828#discussion_r431451467", "createdAt": "2020-05-27T21:25:17Z", "author": {"login": "ibzib"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"\n+  fi\n+}\n+\n+echo \"Enter the release version, e.g. 2.21.0:\"\n+read RELEASE\n+LOCAL_CLONE_DIR=\"beam_release_${RELEASE}\"\n+cd ~\n+if [[ -d ${LOCAL_CLONE_DIR} ]]; then\n+  rm -rf ${LOCAL_CLONE_DIR}\n+fi\n+mkdir ${LOCAL_CLONE_DIR}\n+cd ${LOCAL_CLONE_DIR}\n+\n+wget -r --no-parent -A zip,whl \"https://dist.apache.org/repos/dist/dev/beam/${RELEASE}/python\"\n+cd \"dist.apache.org/repos/dist/dev/beam/${RELEASE}/python/\"\n+pip install twine\n+echo \"Will upload the following files to PyPI:\"\n+ls\n+echo \"Are the files listed correct? [y|N]\"\n+read confirmation\n+if [[ $confirmation != \"y\" ]]; then\n+  echo \"Exit without deploying artifacts to PyPI.\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NzY0NA=="}, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ1NDE2NQ==", "bodyText": "Done", "url": "https://github.com/apache/beam/pull/11828#discussion_r431454165", "createdAt": "2020-05-27T21:30:52Z", "author": {"login": "ibzib"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -0,0 +1,57 @@\n+#!/bin/bash\n+#\n+#    Licensed to the Apache Software Foundation (ASF) under one or more\n+#    contributor license agreements.  See the NOTICE file distributed with\n+#    this work for additional information regarding copyright ownership.\n+#    The ASF licenses this file to You under the Apache License, Version 2.0\n+#    (the \"License\"); you may not use this file except in compliance with\n+#    the License.  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#    Unless required by applicable law or agreed to in writing, software\n+#    distributed under the License is distributed on an \"AS IS\" BASIS,\n+#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#    See the License for the specific language governing permissions and\n+#    limitations under the License.\n+#\n+\n+# This script uploads Python artifacts staged at dist.apache.org to PyPI.\n+\n+set -e\n+\n+function clean_up(){\n+  echo \"Do you want to clean local clone repo? [y|N]\"\n+  read confirmation\n+  if [[ $confirmation = \"y\" ]]; then\n+    cd ~\n+    rm -rf ${LOCAL_CLONE_DIR}\n+    echo \"Clean up local repo.\"\n+  fi\n+}\n+\n+echo \"Enter the release version, e.g. 2.21.0:\"\n+read RELEASE\n+LOCAL_CLONE_DIR=\"beam_release_${RELEASE}\"\n+cd ~\n+if [[ -d ${LOCAL_CLONE_DIR} ]]; then\n+  rm -rf ${LOCAL_CLONE_DIR}\n+fi\n+mkdir ${LOCAL_CLONE_DIR}\n+cd ${LOCAL_CLONE_DIR}\n+\n+wget -r --no-parent -A zip,whl \"https://dist.apache.org/repos/dist/dev/beam/${RELEASE}/python\"\n+cd \"dist.apache.org/repos/dist/dev/beam/${RELEASE}/python/\"\n+pip install twine", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTI5NTA5MA=="}, "originalCommit": {"oid": "10732c7549a09015b97f18e80b2af69b0c8a4390"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NzExOTcz", "url": "https://github.com/apache/beam/pull/11828#pullrequestreview-419711973", "createdAt": "2020-05-28T01:09:31Z", "commit": {"oid": "b6100fd017c43f6a9e10307574ece718a152943b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMTowOTozMVrOGbiW-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwMTowOTozMVrOGbiW-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTUyNzY3NA==", "bodyText": "Consider  creating virtualenv in a /tmp/... directory or in the directory that you create and later clean up (assuming it won't interfere with pypi uploads).", "url": "https://github.com/apache/beam/pull/11828#discussion_r431527674", "createdAt": "2020-05-28T01:09:31Z", "author": {"login": "tvalentyn"}, "path": "release/src/main/scripts/deploy_pypi.sh", "diffHunk": "@@ -41,9 +41,12 @@ fi\n mkdir ${LOCAL_CLONE_DIR}\n cd ${LOCAL_CLONE_DIR}\n \n+virtualenv deploy_pypi_env\n+source ./deploy_pypi_env/bin/activate\n+pip install twine", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6100fd017c43f6a9e10307574ece718a152943b"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NzEyMDA3", "url": "https://github.com/apache/beam/pull/11828#pullrequestreview-419712007", "createdAt": "2020-05-28T01:09:39Z", "commit": {"oid": "b6100fd017c43f6a9e10307574ece718a152943b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4387, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}