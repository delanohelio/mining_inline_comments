{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU0ODQ2MTMz", "number": 12335, "reviewThreads": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxODoyNjoyN1rOERKskg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNzo1ODozMFrOERjoBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NDM2NDk4OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxODoyNjoyN1rOG1u5mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDo1OTozOFrOG10AUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk5NjEyMQ==", "bodyText": "Remove this empty method?", "url": "https://github.com/apache/beam/pull/12335#discussion_r458996121", "createdAt": "2020-07-22T18:26:27Z", "author": {"login": "pabloem"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,311 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common gcs paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);\n+    assertEquals(a, b);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"a/b/c/\");\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"x/y/z\");\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), \"other-container\", a.getBlob());\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(\"other-account\", a.getContainer(), a.getBlob());\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\"));\n+  }\n+\n+  @Test\n+  public void testFromComponents() {\n+    AzfsResourceId resourceId = AzfsResourceId.fromComponents(\"account\", \"container\", \"blob\");\n+    assertEquals(\"azfs\", resourceId.getScheme());\n+    assertEquals(\"account\", resourceId.getAccount());\n+    assertEquals(\"container\", resourceId.getContainer());\n+    assertEquals(\"blob\", resourceId.getBlob());\n+    assertEquals(\n+        \"virtualDir/blob\",\n+        AzfsResourceId.fromComponents(\"account\", \"container\", \"virtualDir/blob\").getBlob());\n+    assertEquals(null, AzfsResourceId.fromComponents(\"account\", \"container\").getBlob());\n+  }\n+\n+  @Test\n+  public void testFromUri() {\n+    AzfsResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/blob\");\n+    assertEquals(\"azfs\", resourceId.getScheme());\n+    assertEquals(\"account\", resourceId.getAccount());\n+    assertEquals(\"container\", resourceId.getContainer());\n+    assertEquals(\"blob\", resourceId.getBlob());\n+    assertEquals(\n+        \"virtualDir/blob\",\n+        AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob\").getBlob());\n+    assertEquals(null, AzfsResourceId.fromUri(\"azfs://account/container\").getBlob());\n+  }\n+\n+  @Test\n+  public void testIsDirectory() {\n+    assertTrue(AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/\").isDirectory());\n+    assertTrue(AzfsResourceId.fromUri(\"azfs://account/container\").isDirectory());\n+    assertFalse(AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob\").isDirectory());\n+  }\n+\n+  @Test\n+  public void testGetCurrentDirectory() {\n+    // test azfs path\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/\").getCurrentDirectory());\n+    // test path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u6587\u4ef601.txt\").getCurrentDirectory());\n+    // test path without ending '/'\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container\").getCurrentDirectory());\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/blob\").getCurrentDirectory());\n+  }\n+\n+  @Test\n+  public void testInvalidPathNoContainer() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Invalid AZFS URI: [azfs://]\");\n+    AzfsResourceId.fromUri(\"azfs://\");\n+  }\n+\n+  @Test\n+  public void testInvalidPathNoContainerAndSlash() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Invalid AZFS URI: [azfs:///]\");\n+    AzfsResourceId.fromUri(\"azfs:///\");\n+  }\n+\n+  @Test\n+  public void testGetScheme() {\n+    // Tests azfs paths.\n+    assertEquals(\n+        \"azfs\", AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/\").getScheme());\n+    // Tests bucket with no ending '/'.\n+    assertEquals(\"azfs\", AzfsResourceId.fromUri(\"azfs://account/container\").getScheme());\n+  }\n+\n+  @Test\n+  public void testGetFilename() {\n+    assertNull(AzfsResourceId.fromUri(\"azfs://account/container\").getFilename());\n+    assertEquals(\"blob\", AzfsResourceId.fromUri(\"azfs://account/container/blob\").getFilename());\n+    assertEquals(\"blob\", AzfsResourceId.fromUri(\"azfs://account/container/blob/\").getFilename());\n+    assertEquals(\n+        \"blob\", AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob\").getFilename());\n+    assertEquals(\n+        \"blob\", AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob/\").getFilename());\n+    assertEquals(\n+        \"blob.txt\",\n+        AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob.txt/\").getFilename());\n+  }\n+\n+  @Test\n+  public void testContainerParsing() {\n+    AzfsResourceId path1 = AzfsResourceId.fromUri(\"azfs://account/container\");\n+    AzfsResourceId path2 = AzfsResourceId.fromUri(\"azfs://account/container/\");\n+    assertEquals(path1, path2);\n+    assertEquals(path1.toString(), path2.toString());\n+  }\n+\n+  @Test\n+  public void testAzfsResourceIdToString() {\n+    String filename = \"azfs://account/container/dir/file.txt\";\n+    AzfsResourceId path = AzfsResourceId.fromUri(filename);\n+    assertEquals(filename, path.toString());\n+\n+    filename = \"azfs://account/container/blob/\";\n+    path = AzfsResourceId.fromUri(filename);\n+    assertEquals(filename, path.toString());\n+\n+    filename = \"azfs://account/container/\";\n+    path = AzfsResourceId.fromUri(filename);\n+    assertEquals(filename, path.toString());\n+  }\n+\n+  @Test\n+  public void testInvalidAzfsResourceId() {\n+    thrown.expect(IllegalArgumentException.class);\n+    AzfsResourceId.fromUri(\"file://an/invalid/azfs/path\");\n+  }\n+\n+  @Test\n+  public void testInvalidContainer() {\n+    thrown.expect(IllegalArgumentException.class);\n+    AzfsResourceId.fromComponents(\"account\", \"invalid/\", \"\");\n+  }\n+\n+  @Test\n+  public void testResourceIdTester() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e56f4df5fd958d68018a629f7d74c5eba860423"}, "originalPosition": 308}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA3OTc2Mw==", "bodyText": "Done", "url": "https://github.com/apache/beam/pull/12335#discussion_r459079763", "createdAt": "2020-07-22T20:59:38Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,311 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common gcs paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);\n+    assertEquals(a, b);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"a/b/c/\");\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"x/y/z\");\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), \"other-container\", a.getBlob());\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(\"other-account\", a.getContainer(), a.getBlob());\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\"));\n+  }\n+\n+  @Test\n+  public void testFromComponents() {\n+    AzfsResourceId resourceId = AzfsResourceId.fromComponents(\"account\", \"container\", \"blob\");\n+    assertEquals(\"azfs\", resourceId.getScheme());\n+    assertEquals(\"account\", resourceId.getAccount());\n+    assertEquals(\"container\", resourceId.getContainer());\n+    assertEquals(\"blob\", resourceId.getBlob());\n+    assertEquals(\n+        \"virtualDir/blob\",\n+        AzfsResourceId.fromComponents(\"account\", \"container\", \"virtualDir/blob\").getBlob());\n+    assertEquals(null, AzfsResourceId.fromComponents(\"account\", \"container\").getBlob());\n+  }\n+\n+  @Test\n+  public void testFromUri() {\n+    AzfsResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/blob\");\n+    assertEquals(\"azfs\", resourceId.getScheme());\n+    assertEquals(\"account\", resourceId.getAccount());\n+    assertEquals(\"container\", resourceId.getContainer());\n+    assertEquals(\"blob\", resourceId.getBlob());\n+    assertEquals(\n+        \"virtualDir/blob\",\n+        AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob\").getBlob());\n+    assertEquals(null, AzfsResourceId.fromUri(\"azfs://account/container\").getBlob());\n+  }\n+\n+  @Test\n+  public void testIsDirectory() {\n+    assertTrue(AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/\").isDirectory());\n+    assertTrue(AzfsResourceId.fromUri(\"azfs://account/container\").isDirectory());\n+    assertFalse(AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob\").isDirectory());\n+  }\n+\n+  @Test\n+  public void testGetCurrentDirectory() {\n+    // test azfs path\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/\").getCurrentDirectory());\n+    // test path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u6587\u4ef601.txt\").getCurrentDirectory());\n+    // test path without ending '/'\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container\").getCurrentDirectory());\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/blob\").getCurrentDirectory());\n+  }\n+\n+  @Test\n+  public void testInvalidPathNoContainer() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Invalid AZFS URI: [azfs://]\");\n+    AzfsResourceId.fromUri(\"azfs://\");\n+  }\n+\n+  @Test\n+  public void testInvalidPathNoContainerAndSlash() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Invalid AZFS URI: [azfs:///]\");\n+    AzfsResourceId.fromUri(\"azfs:///\");\n+  }\n+\n+  @Test\n+  public void testGetScheme() {\n+    // Tests azfs paths.\n+    assertEquals(\n+        \"azfs\", AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/\").getScheme());\n+    // Tests bucket with no ending '/'.\n+    assertEquals(\"azfs\", AzfsResourceId.fromUri(\"azfs://account/container\").getScheme());\n+  }\n+\n+  @Test\n+  public void testGetFilename() {\n+    assertNull(AzfsResourceId.fromUri(\"azfs://account/container\").getFilename());\n+    assertEquals(\"blob\", AzfsResourceId.fromUri(\"azfs://account/container/blob\").getFilename());\n+    assertEquals(\"blob\", AzfsResourceId.fromUri(\"azfs://account/container/blob/\").getFilename());\n+    assertEquals(\n+        \"blob\", AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob\").getFilename());\n+    assertEquals(\n+        \"blob\", AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob/\").getFilename());\n+    assertEquals(\n+        \"blob.txt\",\n+        AzfsResourceId.fromUri(\"azfs://account/container/virtualDir/blob.txt/\").getFilename());\n+  }\n+\n+  @Test\n+  public void testContainerParsing() {\n+    AzfsResourceId path1 = AzfsResourceId.fromUri(\"azfs://account/container\");\n+    AzfsResourceId path2 = AzfsResourceId.fromUri(\"azfs://account/container/\");\n+    assertEquals(path1, path2);\n+    assertEquals(path1.toString(), path2.toString());\n+  }\n+\n+  @Test\n+  public void testAzfsResourceIdToString() {\n+    String filename = \"azfs://account/container/dir/file.txt\";\n+    AzfsResourceId path = AzfsResourceId.fromUri(filename);\n+    assertEquals(filename, path.toString());\n+\n+    filename = \"azfs://account/container/blob/\";\n+    path = AzfsResourceId.fromUri(filename);\n+    assertEquals(filename, path.toString());\n+\n+    filename = \"azfs://account/container/\";\n+    path = AzfsResourceId.fromUri(filename);\n+    assertEquals(filename, path.toString());\n+  }\n+\n+  @Test\n+  public void testInvalidAzfsResourceId() {\n+    thrown.expect(IllegalArgumentException.class);\n+    AzfsResourceId.fromUri(\"file://an/invalid/azfs/path\");\n+  }\n+\n+  @Test\n+  public void testInvalidContainer() {\n+    thrown.expect(IllegalArgumentException.class);\n+    AzfsResourceId.fromComponents(\"account\", \"invalid/\", \"\");\n+  }\n+\n+  @Test\n+  public void testResourceIdTester() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk5NjEyMQ=="}, "originalCommit": {"oid": "5e56f4df5fd958d68018a629f7d74c5eba860423"}, "originalPosition": 308}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NDc1OTE4OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/build.gradle", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDoyMDo1MFrOG1yw6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMTowNToxMlrOG10LYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA1OTQzNQ==", "bodyText": "Let's remove this dependency for now, as we're not really using it.\nLet's also remove azure-storage-blob:12.6.0 until we start using it.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459059435", "createdAt": "2020-07-22T20:20:50Z", "author": {"login": "pabloem"}, "path": "sdks/java/io/azure/build.gradle", "diffHunk": "@@ -17,7 +17,11 @@\n  */\n \n plugins { id 'org.apache.beam.module' }\n-applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure')\n+applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure', enableChecker: false)\n \n dependencies {\n+  compile \"com.azure:azure-storage-blob:12.6.0\"\n+  compile project(path: \":sdks:java:core\", configuration: \"shadow\")\n+  compile \"com.azure:azure-identity:1.0.8\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84f0a0ad7f4b2013f39958c54350e1dc5929b1f5"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA3NTQ0Nw==", "bodyText": "Which dependency?  Just the 1st and 3rd, or also the 2nd?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459075447", "createdAt": "2020-07-22T20:51:17Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/build.gradle", "diffHunk": "@@ -17,7 +17,11 @@\n  */\n \n plugins { id 'org.apache.beam.module' }\n-applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure')\n+applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure', enableChecker: false)\n \n dependencies {\n+  compile \"com.azure:azure-storage-blob:12.6.0\"\n+  compile project(path: \":sdks:java:core\", configuration: \"shadow\")\n+  compile \"com.azure:azure-identity:1.0.8\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA1OTQzNQ=="}, "originalCommit": {"oid": "84f0a0ad7f4b2013f39958c54350e1dc5929b1f5"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA3OTA2Mg==", "bodyText": "Any dependency that we're not using. I believe that's compile \"com.azure:azure-storage-blob:12.6.0\" and compile \"com.azure:azure-identity:1.0.8\" -\n:sdks:java:core contains the base classes for filesystem, so we keep that one, and junit.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459079062", "createdAt": "2020-07-22T20:58:19Z", "author": {"login": "pabloem"}, "path": "sdks/java/io/azure/build.gradle", "diffHunk": "@@ -17,7 +17,11 @@\n  */\n \n plugins { id 'org.apache.beam.module' }\n-applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure')\n+applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure', enableChecker: false)\n \n dependencies {\n+  compile \"com.azure:azure-storage-blob:12.6.0\"\n+  compile project(path: \":sdks:java:core\", configuration: \"shadow\")\n+  compile \"com.azure:azure-identity:1.0.8\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA1OTQzNQ=="}, "originalCommit": {"oid": "84f0a0ad7f4b2013f39958c54350e1dc5929b1f5"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA4MjU5NA==", "bodyText": "Got it, thanks.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459082594", "createdAt": "2020-07-22T21:05:12Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/build.gradle", "diffHunk": "@@ -17,7 +17,11 @@\n  */\n \n plugins { id 'org.apache.beam.module' }\n-applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure')\n+applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure', enableChecker: false)\n \n dependencies {\n+  compile \"com.azure:azure-storage-blob:12.6.0\"\n+  compile project(path: \":sdks:java:core\", configuration: \"shadow\")\n+  compile \"com.azure:azure-identity:1.0.8\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA1OTQzNQ=="}, "originalCommit": {"oid": "84f0a0ad7f4b2013f39958c54350e1dc5929b1f5"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NDgyOTkxOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDo0MjozN1rOG1zdmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMDo0MjozN1rOG1zdmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA3MDg3Mw==", "bodyText": "Update comment, heh.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                // Tests for common gcs paths.\n          \n          \n            \n                // Tests for common Azure paths.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459070873", "createdAt": "2020-07-22T20:42:37Z", "author": {"login": "pabloem"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,311 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common gcs paths.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84f0a0ad7f4b2013f39958c54350e1dc5929b1f5"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTE0MjIzOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/build.gradle", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjoyODo1MFrOG12byw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDoxODoxOVrOG14hwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExOTU2Mw==", "bodyText": "Any reason that we want to disable enableChecker?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459119563", "createdAt": "2020-07-22T22:28:50Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/build.gradle", "diffHunk": "@@ -17,7 +17,9 @@\n  */\n \n plugins { id 'org.apache.beam.module' }\n-applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure')\n+applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure', enableChecker: false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE0OTkwNw==", "bodyText": "I disabled enableChecker because I was returning null in functions that I didn't write yet, and that was causing tests to fail.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459149907", "createdAt": "2020-07-23T00:03:24Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/build.gradle", "diffHunk": "@@ -17,7 +17,9 @@\n  */\n \n plugins { id 'org.apache.beam.module' }\n-applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure')\n+applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure', enableChecker: false)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExOTU2Mw=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1Mzg1OA==", "bodyText": "I see that AWS also disables enableChecker, as do most of the modules.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459153858", "createdAt": "2020-07-23T00:18:19Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/build.gradle", "diffHunk": "@@ -17,7 +17,9 @@\n  */\n \n plugins { id 'org.apache.beam.module' }\n-applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure')\n+applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.azure', enableChecker: false)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExOTU2Mw=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTE3MTM4OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjo0MToyN1rOG12txw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDowOTo0N1rOG14Y2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNDE2Nw==", "bodyText": "What if blob is empty?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459124167", "createdAt": "2020-07-22T22:41:27Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1MTU3OA==", "bodyText": "I just updated the constructor so that if blob is empty it is set to null.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459151578", "createdAt": "2020-07-23T00:09:47Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNDE2Nw=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTE4MDg5OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjo0NTozMFrOG12zlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDo1ODowM1rOG15Igw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNTY1Mg==", "bodyText": "It seems like this function is not called anywhere. Also what if blob is null?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459125652", "createdAt": "2020-07-22T22:45:30Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE2Mzc3OQ==", "bodyText": "I will use this function in working with resource ids containing blobs in the filesystem.  For now I added unit tests for this function so that it is being called.  I also took care of the case where blob is null.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459163779", "createdAt": "2020-07-23T00:58:03Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNTY1Mg=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 101}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTE4NDA0OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjo0Njo1OFrOG121kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMToxNzo1NlrOG15buQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNjE2Mw==", "bodyText": "It seems like this function is not used?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459126163", "createdAt": "2020-07-22T22:46:58Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();\n+  }\n+\n+  String getBlobNonWildcardPrefix() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 104}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE2ODY5Nw==", "bodyText": "I think I will need it later to work with globs in the Azure filesystem, but I will remove it for now.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459168697", "createdAt": "2020-07-23T01:17:56Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();\n+  }\n+\n+  String getBlobNonWildcardPrefix() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNjE2Mw=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 104}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTE4NzM5OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjo0ODoxOVrOG123eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDoxODo1NFrOG14iWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNjY0OQ==", "bodyText": "What if blob is empty?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459126649", "createdAt": "2020-07-22T22:48:19Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();\n+  }\n+\n+  String getBlobNonWildcardPrefix() {\n+    Matcher m = GLOB_PREFIX.matcher(blob);\n+    checkArgument(m.matches(), String.format(\"Glob expression: [%s] is not expandable.\", blob));\n+    return m.group(\"PREFIX\");\n+  }\n+\n+  @Override\n+  public ResourceId getCurrentDirectory() {\n+    if (isDirectory()) {\n+      return this;\n+    }\n+    if (blob.lastIndexOf('/') == -1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 115}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1NDAxMQ==", "bodyText": "I updated the constructor so if blob is empty it is set to null.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459154011", "createdAt": "2020-07-23T00:18:54Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();\n+  }\n+\n+  String getBlobNonWildcardPrefix() {\n+    Matcher m = GLOB_PREFIX.matcher(blob);\n+    checkArgument(m.matches(), String.format(\"Glob expression: [%s] is not expandable.\", blob));\n+    return m.group(\"PREFIX\");\n+  }\n+\n+  @Override\n+  public ResourceId getCurrentDirectory() {\n+    if (isDirectory()) {\n+      return this;\n+    }\n+    if (blob.lastIndexOf('/') == -1) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNjY0OQ=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 115}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTE5NTg3OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjo1MjowMVrOG128hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDo0MDowMFrOG143dQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNzk0Mw==", "bodyText": "You could use Objects.equals(): https://docs.oracle.com/javase/8/docs/api/java/util/Objects.html#equals-java.lang.Object-java.lang.Object-", "url": "https://github.com/apache/beam/pull/12335#discussion_r459127943", "createdAt": "2020-07-22T22:52:01Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();\n+  }\n+\n+  String getBlobNonWildcardPrefix() {\n+    Matcher m = GLOB_PREFIX.matcher(blob);\n+    checkArgument(m.matches(), String.format(\"Glob expression: [%s] is not expandable.\", blob));\n+    return m.group(\"PREFIX\");\n+  }\n+\n+  @Override\n+  public ResourceId getCurrentDirectory() {\n+    if (isDirectory()) {\n+      return this;\n+    }\n+    if (blob.lastIndexOf('/') == -1) {\n+      return fromComponents(account, container);\n+    }\n+    return fromComponents(account, container, blob.substring(0, blob.lastIndexOf('/') + 1));\n+  }\n+\n+  @Nullable\n+  @Override\n+  public String getFilename() {\n+    if (blob == null) {\n+      return null;\n+    }\n+    if (!isDirectory()) {\n+      return blob.substring(blob.lastIndexOf('/') + 1);\n+    }\n+    String blobWithoutTrailingSlash = blob.substring(0, blob.length() - 1);\n+    return blobWithoutTrailingSlash.substring(blobWithoutTrailingSlash.lastIndexOf('/') + 1);\n+  }\n+\n+  // TODO: ensure that this function lines up with what the filesystem match method expects\n+  @Override\n+  public String toString() {\n+    if (blob != null) {\n+      return String.format(\"%s://%s/%s/%s\", SCHEME, account, container, blob);\n+    }\n+    return String.format(\"%s://%s/%s/\", SCHEME, account, container);\n+  }\n+\n+  @Override\n+  public boolean equals(Object obj) {\n+    if (!(obj instanceof AzfsResourceId)) {\n+      return false;\n+    }\n+    String otherBlob = ((AzfsResourceId) obj).blob;\n+    boolean equalBlob = blob != null && otherBlob != null && blob.equals(otherBlob);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 149}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1OTQxMw==", "bodyText": "Done, thanks for directing me to this.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459159413", "createdAt": "2020-07-23T00:40:00Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();\n+  }\n+\n+  String getBlobNonWildcardPrefix() {\n+    Matcher m = GLOB_PREFIX.matcher(blob);\n+    checkArgument(m.matches(), String.format(\"Glob expression: [%s] is not expandable.\", blob));\n+    return m.group(\"PREFIX\");\n+  }\n+\n+  @Override\n+  public ResourceId getCurrentDirectory() {\n+    if (isDirectory()) {\n+      return this;\n+    }\n+    if (blob.lastIndexOf('/') == -1) {\n+      return fromComponents(account, container);\n+    }\n+    return fromComponents(account, container, blob.substring(0, blob.lastIndexOf('/') + 1));\n+  }\n+\n+  @Nullable\n+  @Override\n+  public String getFilename() {\n+    if (blob == null) {\n+      return null;\n+    }\n+    if (!isDirectory()) {\n+      return blob.substring(blob.lastIndexOf('/') + 1);\n+    }\n+    String blobWithoutTrailingSlash = blob.substring(0, blob.length() - 1);\n+    return blobWithoutTrailingSlash.substring(blobWithoutTrailingSlash.lastIndexOf('/') + 1);\n+  }\n+\n+  // TODO: ensure that this function lines up with what the filesystem match method expects\n+  @Override\n+  public String toString() {\n+    if (blob != null) {\n+      return String.format(\"%s://%s/%s/%s\", SCHEME, account, container, blob);\n+    }\n+    return String.format(\"%s://%s/%s/\", SCHEME, account, container);\n+  }\n+\n+  @Override\n+  public boolean equals(Object obj) {\n+    if (!(obj instanceof AzfsResourceId)) {\n+      return false;\n+    }\n+    String otherBlob = ((AzfsResourceId) obj).blob;\n+    boolean equalBlob = blob != null && otherBlob != null && blob.equals(otherBlob);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyNzk0Mw=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 149}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTIwNDU3OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzureBlobStoreFileSystemRegistrar.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjo1NToyNlrOG13BXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDoyMDoxMlrOG14jqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyOTE4MQ==", "bodyText": "Add // TODO? Or you may want to have this file together with the file system changes later.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459129181", "createdAt": "2020-07-22T22:55:26Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzureBlobStoreFileSystemRegistrar.java", "diffHunk": "@@ -15,3 +15,20 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkNotNull;\n+\n+import javax.annotation.Nonnull;\n+import org.apache.beam.sdk.io.FileSystem;\n+import org.apache.beam.sdk.io.FileSystemRegistrar;\n+import org.apache.beam.sdk.options.PipelineOptions;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableList;\n+\n+public class AzureBlobStoreFileSystemRegistrar implements FileSystemRegistrar {\n+  @Override\n+  public Iterable<FileSystem> fromOptions(@Nonnull PipelineOptions options) {\n+    checkNotNull(options, \"Expect the runner have called FileSystems.setDefaultPipelineOptions().\");\n+    return ImmutableList.of();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1NDM0Ng==", "bodyText": "I was getting an error from javadoc because there were no public classes in the PR so I added this file.  I will add TODO.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459154346", "createdAt": "2020-07-23T00:20:12Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzureBlobStoreFileSystemRegistrar.java", "diffHunk": "@@ -15,3 +15,20 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkNotNull;\n+\n+import javax.annotation.Nonnull;\n+import org.apache.beam.sdk.io.FileSystem;\n+import org.apache.beam.sdk.io.FileSystemRegistrar;\n+import org.apache.beam.sdk.options.PipelineOptions;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableList;\n+\n+public class AzureBlobStoreFileSystemRegistrar implements FileSystemRegistrar {\n+  @Override\n+  public Iterable<FileSystem> fromOptions(@Nonnull PipelineOptions options) {\n+    checkNotNull(options, \"Expect the runner have called FileSystems.setDefaultPipelineOptions().\");\n+    return ImmutableList.of();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyOTE4MQ=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTIxNzIyOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMzowMTowMlrOG13I1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1NjozMVrOG16u4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMTA5NA==", "bodyText": "Minor: You could do this by using Parameterized  but it's up to you.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459131094", "createdAt": "2020-07-22T23:01:02Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE2ODc4OA==", "bodyText": "Okay, I will look into that.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459168788", "createdAt": "2020-07-23T01:18:26Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMTA5NA=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE4NDkxMQ==", "bodyText": "I rewrote these tests using Parameterized.  @boyuanzz can you please look over the test and confirm that I used Parameterized correctly?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459184911", "createdAt": "2020-07-23T02:32:18Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMTA5NA=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE4OTk4Nw==", "bodyText": "I also moved a few other tests into the parameterized tests.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459189987", "createdAt": "2020-07-23T02:56:31Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMTA5NA=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTIyNDEyOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMzowNDoyNFrOG13M_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDo1MToxNlrOG15CBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjE1OQ==", "bodyText": "Why do we want to compare a and a?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459132159", "createdAt": "2020-07-22T23:04:24Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 159}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1ODA0MA==", "bodyText": "To confirm that my equals() function is working properly.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459158040", "createdAt": "2020-07-23T00:34:42Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjE1OQ=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 159}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1OTA5Mg==", "bodyText": "but maybe a,b?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459159092", "createdAt": "2020-07-23T00:38:45Z", "author": {"login": "pabloem"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjE1OQ=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 159}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE2MDQ3Mw==", "bodyText": "ah nevermind, I see that both are used.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459160473", "createdAt": "2020-07-23T00:44:21Z", "author": {"login": "pabloem"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjE1OQ=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 159}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE2MjExOA==", "bodyText": "I see that S3ResourceIdTest writes both assertEquals(a, a) and assertEquals(a, b).  I can't think of any case where the second would pass but the first would fail, so I'll remove the assertEquals(a, a) test.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459162118", "createdAt": "2020-07-23T00:51:16Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjE1OQ=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 159}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTIzNDE0OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMzowOTo0MFrOG13TIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDozMzo1N1rOG14xaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMzczMA==", "bodyText": "assertNotEquals(a, b) means the same as ``assertNotEquals(b, a)", "url": "https://github.com/apache/beam/pull/12335#discussion_r459133730", "createdAt": "2020-07-22T23:09:40Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);\n+    assertEquals(a, b);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"a/b/c/\");\n+    assertNotEquals(a, b);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 163}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1Nzg2NA==", "bodyText": "I copied some of these tests from S3ResourceIdTest.  I removed the duplicate tests now; we should remove them from S3 too.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459157864", "createdAt": "2020-07-23T00:33:57Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);\n+    assertEquals(a, b);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"a/b/c/\");\n+    assertNotEquals(a, b);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMzczMA=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 163}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTIzNjQxOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMzoxMDozNFrOG13UZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDozMTowM1rOG14ukQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzNDA1NA==", "bodyText": "Please also test when blob is null and when blob is empty.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459134054", "createdAt": "2020-07-22T23:10:34Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);\n+    assertEquals(a, b);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"a/b/c/\");\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"x/y/z\");\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), \"other-container\", a.getBlob());\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(\"other-account\", a.getContainer(), a.getBlob());\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\"));\n+  }\n+\n+  @Test\n+  public void testFromComponents() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 184}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1NzEzNw==", "bodyText": "Done, thanks for bringing this to my attention.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459157137", "createdAt": "2020-07-23T00:31:03Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,308 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  static final class TestCase {\n+\n+    final String baseUri;\n+    final String relativePath;\n+    final ResolveOptions.StandardResolveOptions resolveOptions;\n+    final String expectedResult;\n+\n+    TestCase(\n+        String baseUri,\n+        String relativePath,\n+        ResolveOptions.StandardResolveOptions resolveOptions,\n+        String expectedResult) {\n+      this.baseUri = baseUri;\n+      this.relativePath = relativePath;\n+      this.resolveOptions = resolveOptions;\n+      this.expectedResult = expectedResult;\n+    }\n+  }\n+\n+  // Each test case is an expected URL, then the components used to build it.\n+  // Empty components result in a double slash.\n+  private static final List<TestCase> PATH_TEST_CASES =\n+      Arrays.asList(\n+          new TestCase(\n+              \"azfs://account/container/\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\", \"\", RESOLVE_DIRECTORY, \"azfs://account/container/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/dir\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/dir/\"),\n+          new TestCase(\n+              \"azfs://account/container\",\n+              \"path/to/object\",\n+              RESOLVE_FILE,\n+              \"azfs://account/container/path/to/object\"),\n+          new TestCase(\n+              \"azfs://account/container/path/to/dir/\",\n+              \"..\",\n+              RESOLVE_DIRECTORY,\n+              \"azfs://account/container/path/to/\"));\n+\n+  @Test\n+  public void testResolve() {\n+    for (TestCase testCase : PATH_TEST_CASES) {\n+      ResourceId resourceId = AzfsResourceId.fromUri(testCase.baseUri);\n+      ResourceId resolved = resourceId.resolve(testCase.relativePath, testCase.resolveOptions);\n+      assertEquals(testCase.expectedResult, resolved.toString());\n+    }\n+\n+    // Tests for common Azure paths.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\").resolve(\"aa\", RESOLVE_FILE));\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa/bb/cc/\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/\")\n+            .resolve(\"aa\", RESOLVE_DIRECTORY)\n+            .resolve(\"bb\", RESOLVE_DIRECTORY)\n+            .resolve(\"cc\", RESOLVE_DIRECTORY));\n+\n+    // Tests absolute path.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/aa\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/tmp/bb/\")\n+            .resolve(\"azfs://account/container/tmp/aa\", RESOLVE_FILE));\n+\n+    // Tests container with no ending '/'.\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/my-container/tmp\"),\n+        AzfsResourceId.fromUri(\"azfs://account/my-container\").resolve(\"tmp\", RESOLVE_FILE));\n+\n+    // Tests path with unicode\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\u8f93\u51fa \u6587\u4ef601.txt\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\u8f93\u51fa \u76ee\u5f55/\")\n+            .resolve(\"\u8f93\u51fa \u6587\u4ef601.txt\", RESOLVE_FILE));\n+  }\n+\n+  @Test\n+  public void testResolveInvalidInputs() {\n+    thrown.expect(IllegalArgumentException.class);\n+    thrown.expectMessage(\"Cannot resolve a file with a directory path: [tmp/]\");\n+    AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp/\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testResolveInvalidNotDirectory() {\n+    ResourceId tmpDir =\n+        AzfsResourceId.fromUri(\"azfs://account/my_container/\").resolve(\"tmp dir\", RESOLVE_FILE);\n+\n+    thrown.expect(IllegalStateException.class);\n+    thrown.expectMessage(\n+        \"Expected this resource to be a directory, but was [azfs://account/my_container/tmp dir]\");\n+    tmpDir.resolve(\"aa\", RESOLVE_FILE);\n+  }\n+\n+  @Test\n+  public void testS3ResolveWithFileBase() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/file\");\n+    thrown.expect(IllegalStateException.class);\n+    resourceId.resolve(\"child-path\", RESOLVE_DIRECTORY); // resource is not a directory\n+  }\n+\n+  @Test\n+  public void testResolveParentToFile() {\n+    ResourceId resourceId = AzfsResourceId.fromUri(\"azfs://account/container/path/to/dir/\");\n+    thrown.expect(IllegalArgumentException.class);\n+    resourceId.resolve(\"..\", RESOLVE_FILE); // '..' only resolves as dir, not as file\n+  }\n+\n+  @Test\n+  public void testEquals() {\n+    AzfsResourceId a = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    AzfsResourceId b = AzfsResourceId.fromComponents(\"account\", \"container\", \"a/b/c\");\n+    assertEquals(a, a);\n+    assertEquals(a, b);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"a/b/c/\");\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), a.getContainer(), \"x/y/z\");\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(a.getAccount(), \"other-container\", a.getBlob());\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    b = AzfsResourceId.fromComponents(\"other-account\", a.getContainer(), a.getBlob());\n+    assertNotEquals(a, b);\n+    assertNotEquals(b, a);\n+\n+    assertEquals(\n+        AzfsResourceId.fromUri(\"azfs://account/container\"),\n+        AzfsResourceId.fromUri(\"azfs://account/container/\"));\n+  }\n+\n+  @Test\n+  public void testFromComponents() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzNDA1NA=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 184}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTI0OTUwOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMzoxNjozNFrOG13b_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMToxNjo0MFrOG15aZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzNTk5Ng==", "bodyText": "It seems like this function is not used.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459135996", "createdAt": "2020-07-22T23:16:34Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();\n+  }\n+\n+  String getBlobNonWildcardPrefix() {\n+    Matcher m = GLOB_PREFIX.matcher(blob);\n+    checkArgument(m.matches(), String.format(\"Glob expression: [%s] is not expandable.\", blob));\n+    return m.group(\"PREFIX\");\n+  }\n+\n+  @Override\n+  public ResourceId getCurrentDirectory() {\n+    if (isDirectory()) {\n+      return this;\n+    }\n+    if (blob.lastIndexOf('/') == -1) {\n+      return fromComponents(account, container);\n+    }\n+    return fromComponents(account, container, blob.substring(0, blob.lastIndexOf('/') + 1));\n+  }\n+\n+  @Nullable\n+  @Override\n+  public String getFilename() {\n+    if (blob == null) {\n+      return null;\n+    }\n+    if (!isDirectory()) {\n+      return blob.substring(blob.lastIndexOf('/') + 1);\n+    }\n+    String blobWithoutTrailingSlash = blob.substring(0, blob.length() - 1);\n+    return blobWithoutTrailingSlash.substring(blobWithoutTrailingSlash.lastIndexOf('/') + 1);\n+  }\n+\n+  // TODO: ensure that this function lines up with what the filesystem match method expects\n+  @Override\n+  public String toString() {\n+    if (blob != null) {\n+      return String.format(\"%s://%s/%s/%s\", SCHEME, account, container, blob);\n+    }\n+    return String.format(\"%s://%s/%s/\", SCHEME, account, container);\n+  }\n+\n+  @Override\n+  public boolean equals(Object obj) {\n+    if (!(obj instanceof AzfsResourceId)) {\n+      return false;\n+    }\n+    String otherBlob = ((AzfsResourceId) obj).blob;\n+    boolean equalBlob = blob != null && otherBlob != null && blob.equals(otherBlob);\n+    boolean noBlobs = blob == null && otherBlob == null;\n+    return account.equals(((AzfsResourceId) obj).account)\n+        && container.equals(((AzfsResourceId) obj).container)\n+        && (equalBlob || noBlobs);\n+  }\n+\n+  @Override\n+  public int hashCode() {\n+    return Objects.hash(account, container, blob);\n+  }\n+\n+  @Override\n+  public ResourceId resolve(String other, ResolveOptions resolveOptions) {\n+    checkState(isDirectory(), \"Expected this resource to be a directory, but was [%s]\", toString());\n+    // TODO: check if resolve options are an illegal name in any way, see:\n+    // https://docs.microsoft.com/en-us/rest/api/storageservices/Naming-and-Referencing-Containers--Blobs--and-Metadata\n+\n+    if (resolveOptions == ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY) {\n+      if (\"..\".equals(other)) {\n+        if (\"/\".equals(blob)) {\n+          return this;\n+        }\n+        int parentStopsAt = blob.substring(0, blob.length() - 1).lastIndexOf('/');\n+        return fromComponents(account, container, blob.substring(0, parentStopsAt + 1));\n+      }\n+\n+      if (\"\".equals(other)) {\n+        return this;\n+      }\n+\n+      if (!other.endsWith(\"/\")) {\n+        other += \"/\";\n+      }\n+      if (AZFS_URI.matcher(other).matches()) {\n+        return fromUri(other);\n+      }\n+      if (blob == null) {\n+        return fromComponents(account, container, other);\n+      }\n+      return fromComponents(account, container, blob + other);\n+    }\n+\n+    if (resolveOptions == ResolveOptions.StandardResolveOptions.RESOLVE_FILE) {\n+      checkArgument(\n+          !other.endsWith(\"/\"), \"Cannot resolve a file with a directory path: [%s]\", other);\n+      checkArgument(!\"..\".equals(other), \"Cannot resolve parent as file: [%s]\", other);\n+      if (AZFS_URI.matcher(other).matches()) {\n+        return fromUri(other);\n+      }\n+      if (blob == null) {\n+        return fromComponents(account, container, other);\n+      }\n+      return fromComponents(account, container, blob + other);\n+    }\n+\n+    throw new UnsupportedOperationException(\n+        String.format(\"Unexpected StandardResolveOptions [%s]\", resolveOptions));\n+  }\n+\n+  // url format to interact with Azure\n+  public String toAzureUrl() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 210}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE2ODM1OA==", "bodyText": "I think I will need it later to interact with the Azure client, but I will remove it for now.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459168358", "createdAt": "2020-07-23T01:16:40Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,219 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    this.blob = blob;\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {\n+      blob = null;\n+    }\n+    return fromComponents(account, container, blob);\n+  }\n+\n+  public String getAccount() {\n+    return account;\n+  }\n+\n+  public String getContainer() {\n+    return container;\n+  }\n+\n+  public String getBlob() {\n+    return blob;\n+  }\n+\n+  @Override\n+  public String getScheme() {\n+    return SCHEME;\n+  }\n+\n+  @Override\n+  public boolean isDirectory() {\n+    return (blob == null) || (blob.endsWith(\"/\"));\n+  }\n+\n+  boolean isWildcard() {\n+    return GLOB_PREFIX.matcher(blob).matches();\n+  }\n+\n+  String getBlobNonWildcardPrefix() {\n+    Matcher m = GLOB_PREFIX.matcher(blob);\n+    checkArgument(m.matches(), String.format(\"Glob expression: [%s] is not expandable.\", blob));\n+    return m.group(\"PREFIX\");\n+  }\n+\n+  @Override\n+  public ResourceId getCurrentDirectory() {\n+    if (isDirectory()) {\n+      return this;\n+    }\n+    if (blob.lastIndexOf('/') == -1) {\n+      return fromComponents(account, container);\n+    }\n+    return fromComponents(account, container, blob.substring(0, blob.lastIndexOf('/') + 1));\n+  }\n+\n+  @Nullable\n+  @Override\n+  public String getFilename() {\n+    if (blob == null) {\n+      return null;\n+    }\n+    if (!isDirectory()) {\n+      return blob.substring(blob.lastIndexOf('/') + 1);\n+    }\n+    String blobWithoutTrailingSlash = blob.substring(0, blob.length() - 1);\n+    return blobWithoutTrailingSlash.substring(blobWithoutTrailingSlash.lastIndexOf('/') + 1);\n+  }\n+\n+  // TODO: ensure that this function lines up with what the filesystem match method expects\n+  @Override\n+  public String toString() {\n+    if (blob != null) {\n+      return String.format(\"%s://%s/%s/%s\", SCHEME, account, container, blob);\n+    }\n+    return String.format(\"%s://%s/%s/\", SCHEME, account, container);\n+  }\n+\n+  @Override\n+  public boolean equals(Object obj) {\n+    if (!(obj instanceof AzfsResourceId)) {\n+      return false;\n+    }\n+    String otherBlob = ((AzfsResourceId) obj).blob;\n+    boolean equalBlob = blob != null && otherBlob != null && blob.equals(otherBlob);\n+    boolean noBlobs = blob == null && otherBlob == null;\n+    return account.equals(((AzfsResourceId) obj).account)\n+        && container.equals(((AzfsResourceId) obj).container)\n+        && (equalBlob || noBlobs);\n+  }\n+\n+  @Override\n+  public int hashCode() {\n+    return Objects.hash(account, container, blob);\n+  }\n+\n+  @Override\n+  public ResourceId resolve(String other, ResolveOptions resolveOptions) {\n+    checkState(isDirectory(), \"Expected this resource to be a directory, but was [%s]\", toString());\n+    // TODO: check if resolve options are an illegal name in any way, see:\n+    // https://docs.microsoft.com/en-us/rest/api/storageservices/Naming-and-Referencing-Containers--Blobs--and-Metadata\n+\n+    if (resolveOptions == ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY) {\n+      if (\"..\".equals(other)) {\n+        if (\"/\".equals(blob)) {\n+          return this;\n+        }\n+        int parentStopsAt = blob.substring(0, blob.length() - 1).lastIndexOf('/');\n+        return fromComponents(account, container, blob.substring(0, parentStopsAt + 1));\n+      }\n+\n+      if (\"\".equals(other)) {\n+        return this;\n+      }\n+\n+      if (!other.endsWith(\"/\")) {\n+        other += \"/\";\n+      }\n+      if (AZFS_URI.matcher(other).matches()) {\n+        return fromUri(other);\n+      }\n+      if (blob == null) {\n+        return fromComponents(account, container, other);\n+      }\n+      return fromComponents(account, container, blob + other);\n+    }\n+\n+    if (resolveOptions == ResolveOptions.StandardResolveOptions.RESOLVE_FILE) {\n+      checkArgument(\n+          !other.endsWith(\"/\"), \"Cannot resolve a file with a directory path: [%s]\", other);\n+      checkArgument(!\"..\".equals(other), \"Cannot resolve parent as file: [%s]\", other);\n+      if (AZFS_URI.matcher(other).matches()) {\n+        return fromUri(other);\n+      }\n+      if (blob == null) {\n+        return fromComponents(account, container, other);\n+      }\n+      return fromComponents(account, container, blob + other);\n+    }\n+\n+    throw new UnsupportedOperationException(\n+        String.format(\"Unexpected StandardResolveOptions [%s]\", resolveOptions));\n+  }\n+\n+  // url format to interact with Azure\n+  public String toAzureUrl() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzNTk5Ng=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 210}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTI4NDE2OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzureBlobStoreFileSystemTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMzozMzowOVrOG13wTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMDoxMTozNFrOG14axA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE0MTE5OA==", "bodyText": "Remove the empty file?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459141198", "createdAt": "2020-07-22T23:33:09Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzureBlobStoreFileSystemTest.java", "diffHunk": "@@ -15,3 +15,4 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n+package org.apache.beam.sdk.io.azure.blobstore;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE1MjA2OA==", "bodyText": "Done.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459152068", "createdAt": "2020-07-23T00:11:34Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzureBlobStoreFileSystemTest.java", "diffHunk": "@@ -15,3 +15,4 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n+package org.apache.beam.sdk.io.azure.blobstore;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE0MTE5OA=="}, "originalCommit": {"oid": "87e3c906972eaa0165dd3f2e172edc57f68dbbee"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTQ2MzQzOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMToxMzozN1rOG15XgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMTozMzo0MFrOG15plA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE2NzYxNg==", "bodyText": "The constructor will take care of this , right?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459167616", "createdAt": "2020-07-23T01:13:37Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,223 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    if (blob == null || blob.isEmpty()) {\n+      this.blob = null;\n+    } else {\n+      this.blob = blob;\n+    }\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d53270812a8543ed5101ba1c96435083b527f09"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE3MjI0NA==", "bodyText": "Yes, I'll remove this extra code.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459172244", "createdAt": "2020-07-23T01:33:40Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/main/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceId.java", "diffHunk": "@@ -0,0 +1,223 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkArgument;\n+import static org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Preconditions.checkState;\n+\n+import java.util.Objects;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import javax.annotation.Nullable;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.base.Strings;\n+\n+class AzfsResourceId implements ResourceId {\n+\n+  static final String SCHEME = \"azfs\";\n+\n+  private static final Pattern AZFS_URI =\n+      Pattern.compile(\"(?<SCHEME>[^:]+)://(?<ACCOUNT>[^/]+)/(?<CONTAINER>[^/]+)(?:/(?<BLOB>.*))?\");\n+\n+  /** Matches a glob containing a wildcard, capturing the portion before the first wildcard. */\n+  private static final Pattern GLOB_PREFIX = Pattern.compile(\"(?<PREFIX>[^\\\\[*?]*)[\\\\[*?].*\");\n+\n+  private final String account;\n+  private final String container;\n+  private final String blob;\n+\n+  private AzfsResourceId(String account, String container, @Nullable String blob) {\n+    // We are assuming that every resource id is either a container or a blob in a container, not\n+    // just an account.\n+    // This is because we will not enable users to create Azure containers through beam at this\n+    // time.\n+    checkArgument(!Strings.isNullOrEmpty(container), \"container\");\n+    checkArgument(!container.contains(\"/\"), \"container must not contain '/': [%s]\", container);\n+    this.account = account;\n+    this.container = container;\n+    if (blob == null || blob.isEmpty()) {\n+      this.blob = null;\n+    } else {\n+      this.blob = blob;\n+    }\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container, String blob) {\n+    return new AzfsResourceId(account, container, blob);\n+  }\n+\n+  static AzfsResourceId fromComponents(String account, String container) {\n+    return new AzfsResourceId(account, container, null);\n+  }\n+\n+  static AzfsResourceId fromUri(String uri) {\n+    Matcher m = AZFS_URI.matcher(uri);\n+    checkArgument(m.matches(), \"Invalid AZFS URI: [%s]\", uri);\n+    checkArgument(m.group(\"SCHEME\").equalsIgnoreCase(SCHEME), \"Invalid AZFS URI scheme: [%s]\", uri);\n+    String account = m.group(\"ACCOUNT\");\n+    String container = m.group(\"CONTAINER\");\n+    String blob = m.group(\"BLOB\");\n+    if (blob != null && blob.isEmpty()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE2NzYxNg=="}, "originalCommit": {"oid": "3d53270812a8543ed5101ba1c96435083b527f09"}, "originalPosition": 76}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTY1MzU2OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoxOTowNFrOG17A5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNzo1ODo0OVrOG2VjpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NDU5OA==", "bodyText": "It should be @RunWith(Enclosed.class) to make sure inner test classes to be picked up.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459194598", "createdAt": "2020-07-23T03:19:04Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIwNzY0NA==", "bodyText": "If I switch @RunWith(JUnit4.class) to @RunWith(Enclosed.class) then all the tests except the inner test class are skipped.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459207644", "createdAt": "2020-07-23T04:24:23Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NDU5OA=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIwOTc3Nw==", "bodyText": "I see. I thought you were using subclass with @RunWith.  Let's keep with @RunWith(JUnit4.class).", "url": "https://github.com/apache/beam/pull/12335#discussion_r459209777", "createdAt": "2020-07-23T04:35:17Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NDU5OA=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNDExNg==", "bodyText": "@boyuanzz How can I get both the parameterized and the non-parameterized tests to run?  I tried putting all the non-parameterized tests in a separate inner class, but that didn't work either because that class would need to be static for the tests to run but if the class is static then I get an error since thrown is non-static.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459214116", "createdAt": "2020-07-23T04:55:31Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NDU5OA=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNTk2Ng==", "bodyText": "You could something similar to this: \n  \n    \n      beam/sdks/java/testing/nexmark/src/test/java/org/apache/beam/sdk/nexmark/queries/sql/SqlQuery0Test.java\n    \n    \n         Line 36\n      in\n      d4d45bf\n    \n    \n    \n    \n\n        \n          \n           @RunWith(Enclosed.class)", "url": "https://github.com/apache/beam/pull/12335#discussion_r459215966", "createdAt": "2020-07-23T05:04:06Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NDU5OA=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNjAyNg==", "bodyText": "I just saw your comment now.  You are correct that the inner test classes are being skipped with the current runner, so we shouldn't keep @RunWith(JUnit4.class).", "url": "https://github.com/apache/beam/pull/12335#discussion_r459216026", "createdAt": "2020-07-23T05:04:28Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NDU5OA=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNjk1Mw==", "bodyText": "If I use @RunWith(Enclosed.class) then the non-parameterized tests are skipped unless they are also in an inner class. But if they are in an inner class then the class needs to be static, and that causes an error non-static variable thrown cannot be referenced from a static context.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459216953", "createdAt": "2020-07-23T05:08:41Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NDU5OA=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyOTQ3Nw==", "bodyText": "Now you should change it to @RunWith(Enclosed.class)", "url": "https://github.com/apache/beam/pull/12335#discussion_r459629477", "createdAt": "2020-07-23T17:58:49Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NDU5OA=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTY2ODA5OnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoyOTowMVrOG17I4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNDowMzo1MlrOG2MEoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NjY0Mw==", "bodyText": "The annotation @Parameterized.Parameter can be used to avoid creating constructor. But having constructor is also good. It's up to you.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459196643", "createdAt": "2020-07-23T03:29:01Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  @RunWith(Parameterized.class)\n+  public static class ResolveTest {\n+\n+    private String baseUri;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNzMwOA==", "bodyText": "Where would I need to put the annotation?", "url": "https://github.com/apache/beam/pull/12335#discussion_r459217308", "createdAt": "2020-07-23T05:10:15Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  @RunWith(Parameterized.class)\n+  public static class ResolveTest {\n+\n+    private String baseUri;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NjY0Mw=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIyMTU0OA==", "bodyText": "You could do something similar to \n  \n    \n      beam/sdks/java/harness/src/test/java/org/apache/beam/fn/harness/BeamFnDataReadRunnerTest.java\n    \n    \n         Line 435\n      in\n      6fdde4f\n    \n    \n    \n    \n\n        \n          \n           @Parameterized.Parameter(0)", "url": "https://github.com/apache/beam/pull/12335#discussion_r459221548", "createdAt": "2020-07-23T05:29:01Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  @RunWith(Parameterized.class)\n+  public static class ResolveTest {\n+\n+    private String baseUri;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NjY0Mw=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQ3NDA4MA==", "bodyText": "I see, thanks for the example.", "url": "https://github.com/apache/beam/pull/12335#discussion_r459474080", "createdAt": "2020-07-23T14:03:52Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,318 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();\n+\n+  @RunWith(Parameterized.class)\n+  public static class ResolveTest {\n+\n+    private String baseUri;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5NjY0Mw=="}, "originalCommit": {"oid": "3a182bba14e986ffccd8be0f91f57ac4b07d512e"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2ODQ0OTMyOnYy", "diffSide": "RIGHT", "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNzo1ODozMFrOG2Vi-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxODowMzoyN1rOG2VtZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyOTMwNw==", "bodyText": "Please move this under the scope of NonParameterizedTests", "url": "https://github.com/apache/beam/pull/12335#discussion_r459629307", "createdAt": "2020-07-23T17:58:30Z", "author": {"login": "boyuanzz"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,319 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "045580b758d45de0256528e74432eab54d5dc8b5"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYzMTk3Mw==", "bodyText": "This resolves the issues I had before - all my tests are running now.  Thanks @boyuanzz !", "url": "https://github.com/apache/beam/pull/12335#discussion_r459631973", "createdAt": "2020-07-23T18:03:27Z", "author": {"login": "ettirapp"}, "path": "sdks/java/io/azure/src/test/java/org/apache/beam/sdk/io/azure/blobstore/AzfsResourceIdTest.java", "diffHunk": "@@ -0,0 +1,319 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.io.azure.blobstore;\n+\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_DIRECTORY;\n+import static org.apache.beam.sdk.io.fs.ResolveOptions.StandardResolveOptions.RESOLVE_FILE;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotEquals;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import org.apache.beam.sdk.io.fs.ResolveOptions;\n+import org.apache.beam.sdk.io.fs.ResourceId;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+import org.junit.runners.Parameterized;\n+\n+@RunWith(JUnit4.class)\n+public class AzfsResourceIdTest {\n+\n+  @Rule public ExpectedException thrown = ExpectedException.none();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyOTMwNw=="}, "originalCommit": {"oid": "045580b758d45de0256528e74432eab54d5dc8b5"}, "originalPosition": 42}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 910, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}