{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxMDM2NTgz", "number": 852, "title": "Assign Jurisdiction Functional Tests", "bodyText": "Change description\nFunctional tests for main Assign jurisdiction story (RDM-7162)\n[ ] Yes\n[x] No", "createdAt": "2020-03-19T14:28:45Z", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852", "merged": true, "mergeCommit": {"oid": "0a2e2f9436b805532b7795018cb555ac9cd6dd7e"}, "closed": true, "closedAt": "2020-03-26T10:18:56Z", "author": {"login": "noronhaa"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFjFFWAH2gAyMzkxMDM2NTgzOjU1ZjMyOWU4YjMwMTZkM2ZjYjQxMTcxZjRmZDI2ODcxNWRkMmMwOTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRY9sRAH2gAyMzkxMDM2NTgzOmUyZGM4NGUyZGNhNDc2N2Y2NWExMDRjYjE0MTE4NGVjODgyMzQ0YjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "55f329e8b3016d3fcb41171f4fd268715dd2c093", "author": {"user": {"login": "Thor-tech-of-metal", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/55f329e8b3016d3fcb41171f4fd268715dd2c093", "committedDate": "2020-02-18T14:47:56Z", "message": "RDM-7162: Automate Jurisdiction assignment \u2013 tactical solution\n\n    \u00a0\u00a0[RDM-7162] (https://tools.hmcts.net/jira/browse/RDM-7162)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38f18e5774f32a88e52b4fa1e5001d3498d327a3", "author": {"user": {"login": "Thor-tech-of-metal", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/38f18e5774f32a88e52b4fa1e5001d3498d327a3", "committedDate": "2020-02-18T14:48:32Z", "message": "Merge branch 'develop' of https://github.com/hmcts/ccd-data-store-api into RDM-7162"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1362733ac7f52c9305de6d64257609a66b4d231c", "author": {"user": {"login": "Thor-tech-of-metal", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/1362733ac7f52c9305de6d64257609a66b4d231c", "committedDate": "2020-02-20T12:43:36Z", "message": "RDM-7416: CCD throws NoHttpResponse when calling available services.\n\n    \u00a0\u00a0[RDM-7416] (https://tools.hmcts.net/jira/browse/RDM-7416)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b3c829bfc5d9b630b251fc69a55c56ffb3e67cd", "author": {"user": {"login": "Thor-tech-of-metal", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/9b3c829bfc5d9b630b251fc69a55c56ffb3e67cd", "committedDate": "2020-02-21T11:57:02Z", "message": "RDM-7162: Automate Jurisdiction assignment \u2013 tactical solution\n\n    \u00a0\u00a0[RDM-7162] (https://tools.hmcts.net/jira/browse/RDM-7162)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99b4400320f563da22905c418cf03b373307a8e6", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/99b4400320f563da22905c418cf03b373307a8e6", "committedDate": "2020-02-25T14:33:53Z", "message": "RDM-7162: Automate Jurisdiction assignment \u2013 tactical solution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe06fce9e123154f90e519c7ff9f8d0de627ec3b", "author": {"user": {"login": "Olawale", "name": "Olawale Olanrewaju"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/fe06fce9e123154f90e519c7ff9f8d0de627ec3b", "committedDate": "2020-03-02T15:15:09Z", "message": "Merge branch 'develop' into RDM-7162"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d1d70518c9899174cf6e61393e6ab3953149f9e", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/1d1d70518c9899174cf6e61393e6ab3953149f9e", "committedDate": "2020-03-10T06:21:56Z", "message": "Merge branch 'develop' into RDM-7162"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edb6ee43c9353ebf9c78cf44c185edf0e606ca89", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/edb6ee43c9353ebf9c78cf44c185edf0e606ca89", "committedDate": "2020-03-11T19:57:15Z", "message": "RDM-7162: Automate Jurisdiction assignment \u2013 tactical solution\nFixed UserProfile throwing exception when user doesn't exist on ccd"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "818e62a67fb1b661f11abf453b908a33425c4995", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/818e62a67fb1b661f11abf453b908a33425c4995", "committedDate": "2020-03-11T22:55:10Z", "message": "RDM-7162: fixed failing test cases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "962e02631c27ce4559d8e5c7a8d87d5f1b665337", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/962e02631c27ce4559d8e5c7a8d87d5f1b665337", "committedDate": "2020-03-12T12:36:07Z", "message": "RDM-7162: Changed exception handling logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bbcecbe84305d7a54968728b3cd4c13d1136020", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/3bbcecbe84305d7a54968728b3cd4c13d1136020", "committedDate": "2020-03-13T09:15:47Z", "message": "RDM-7162: fixed checkstyle issues (unused imports)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e441a9a629eaa1dfa02d6d8cfc215a2831e2297", "author": {"user": {"login": "MSancaktutar", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/5e441a9a629eaa1dfa02d6d8cfc215a2831e2297", "committedDate": "2020-03-13T13:32:15Z", "message": "Merge branch 'develop' into RDM-7162"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37a30b672a70373c1be6e840ccdabea54fc19aba", "author": {"user": {"login": "MSancaktutar", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/37a30b672a70373c1be6e840ccdabea54fc19aba", "committedDate": "2020-03-13T13:32:22Z", "message": "Merge branch 'RDM-7162' of git@github.com:hmcts/ccd-data-store-api.git into RDM-7162"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "committedDate": "2020-03-19T14:08:21Z", "message": "assign jurisdiction functional tests added"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5MDY5NDQ0", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#pullrequestreview-379069444", "createdAt": "2020-03-22T23:39:07Z", "commit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQyMzozOTowN1rOF5zwjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQyMzo1MzoyMVrOF5z1-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTE2NA==", "bodyText": "This shouldn't be ANYTHING_PRESENT. We can know what to expect for this attribute in the response, and it is the same env variable as what we used for the request.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161164", "createdAt": "2020-03-22T23:39:07Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",\n+          \"email\": \"[[ANYTHING_PRESENT]]\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTE5NA==", "bodyText": "This shouldn't be ANYTHING_PRESENT. We can know what to expect for this attribute in the response, and it is the same uid as what we used for the request.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161194", "createdAt": "2020-03-22T23:39:30Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTI5MQ==", "bodyText": "These should also be consistent predefined values we can specifically expect in the response.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161291", "createdAt": "2020-03-22T23:40:35Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",\n+          \"email\": \"[[ANYTHING_PRESENT]]\",\n+          \"forename\": \"[[ANYTHING_PRESENT]]\",\n+          \"surname\": \"[[ANYTHING_PRESENT]]\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTMxOA==", "bodyText": "same as above", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161318", "createdAt": "2020-03-22T23:40:48Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",\n+          \"email\": \"[[ANYTHING_PRESENT]]\",\n+          \"forename\": \"[[ANYTHING_PRESENT]]\",\n+          \"surname\": \"[[ANYTHING_PRESENT]]\",\n+          \"roles\": \"[[ANYTHING_PRESENT]]\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTM5NA==", "bodyText": "casetypes under BEFTA_JURISDICTION_1 are predefined. Please expressly list them as expected.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161394", "createdAt": "2020-03-22T23:41:35Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",\n+          \"email\": \"[[ANYTHING_PRESENT]]\",\n+          \"forename\": \"[[ANYTHING_PRESENT]]\",\n+          \"surname\": \"[[ANYTHING_PRESENT]]\",\n+          \"roles\": \"[[ANYTHING_PRESENT]]\",\n+          \"defaultService\": null\n+        }\n+      },\n+      \"channels\": null,\n+      \"jurisdictions\": [\n+        {\n+          \"id\": \"BEFTA_JURISDICTION_1\",\n+          \"name\": \"BEFTA_JURISDICTION_1\",\n+          \"description\": \"Content for the Test Jurisdiction.\",\n+          \"caseTypes\": \"[[ANYTHING_PRESENT]]\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTc4MQ==", "bodyText": "This is a potential breaking change and should be checked if there is any consumer of this operation relying on the previous behaviour.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161781", "createdAt": "2020-03-22T23:45:42Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/F-051.feature", "diffHunk": "@@ -16,13 +16,12 @@ Background:\n \n \n   @S-109\n-  Scenario: must return appropriate negative response for a user not having a profile in CCD\n+  Scenario: must return appropriate user setting from idam role for a user not having a profile in CCD\n     Given a user with [no profile in CCD]\n     When a request is prepared with appropriate values\n-    And the request [uses a Case ID that doesn\u2019t exist in CCD]\n     And it is submitted to call the [Get default settings for user] operation of [CCD Data Store]\n-    Then a negative response is received\n-    And the response [has the 403 return code]\n+    Then a positive response is received\n+    And the response [has the 200 return code]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjAzOQ==", "bodyText": "The line 24 can be removed, since, from a behavioural specification point of view, \"Then a positive response is received\" would be sufficient.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162039", "createdAt": "2020-03-22T23:48:23Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/F-051.feature", "diffHunk": "@@ -16,13 +16,12 @@ Background:\n \n \n   @S-109\n-  Scenario: must return appropriate negative response for a user not having a profile in CCD\n+  Scenario: must return appropriate user setting from idam role for a user not having a profile in CCD\n     Given a user with [no profile in CCD]\n     When a request is prepared with appropriate values\n-    And the request [uses a Case ID that doesn\u2019t exist in CCD]\n     And it is submitted to call the [Get default settings for user] operation of [CCD Data Store]\n-    Then a negative response is received\n-    And the response [has the 403 return code]\n+    Then a positive response is received\n+    And the response [has the 200 return code]", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTc4MQ=="}, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjEwMw==", "bodyText": "line 61 can be removed", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162103", "createdAt": "2020-03-22T23:48:55Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-102/F-102.feature", "diffHunk": "@@ -50,3 +50,14 @@ Feature: F-102: Get jurisdictions available to the user\n     And the response [contains HTTP 400 Bad Request]\n     And the response [contains an error message : Access can only be 'create', 'read' or 'update']\n     And the response has all other details as expected\n+\n+  @S-580\n+  Scenario: must return a list of jurisdictions for a valid user with no user profile\n+    Given a user with [appropriate idam roles but no CCD user profile]\n+    When a request is prepared with appropriate values\n+    And the request [has CREATE as case access parameter]\n+    And it is submitted to call the [Get jurisdictions available to the user] operation of [CCD Data Store]\n+    Then a positive response is received\n+    And the response [contains HTTP 200 Ok status code]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjE2Ng==", "bodyText": "password used is for another user", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162166", "createdAt": "2020-03-22T23:49:39Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjM0MA==", "bodyText": "this will inherit the password of another user specified in the parent object, which is not good. every user should use its own password env variable.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162340", "createdAt": "2020-03-22T23:51:30Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-102/S-580.td.json", "diffHunk": "@@ -0,0 +1,78 @@\n+{\n+  \"_guid_\": \"S-580\",\n+  \"_extends_\": \"F-102_Test_Data_Base\",\n+  \"title\": \"Get jurisdictions available to the user\",\n+  \"specs\": [\n+    \"appropriate idam roles but no CCD user profile\",\n+    \"has CREATE as case access parameter\",\n+    \"contains HTTP 200 Ok status code\",\n+    \"contains the list of jurisdictions a user has access to\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\"\n+  },", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjQzMQ==", "bodyText": "these can be expected to be specific values, couldn't them?", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162431", "createdAt": "2020-03-22T23:52:24Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-102/S-580.td.json", "diffHunk": "@@ -0,0 +1,78 @@\n+{\n+  \"_guid_\": \"S-580\",\n+  \"_extends_\": \"F-102_Test_Data_Base\",\n+  \"title\": \"Get jurisdictions available to the user\",\n+  \"specs\": [\n+    \"appropriate idam roles but no CCD user profile\",\n+    \"has CREATE as case access parameter\",\n+    \"contains HTTP 200 Ok status code\",\n+    \"contains the list of jurisdictions a user has access to\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\"\n+  },\n+  \"request\": {\n+    \"_extends_\": \"Common_Request\",\n+    \"queryParams\": {\n+      \"access\": \"create\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"_extends_\": \"Common_200_Response\",\n+    \"body\": {\n+      \"arrayInMap\": [\n+        {\n+          \"id\": \"BEFTA_JURISDICTION_1\",\n+          \"name\": \"BEFTA_JURISDICTION_1\",\n+          \"description\": \"Content for the Test Jurisdiction.\",\n+          \"caseTypes\": [\n+            {\n+              \"id\": \"BEFTA_CASETYPE_1_1\",\n+              \"description\": \"Create a case of type BEFTA_CASETYPE_1_1\",\n+              \"version\": null,\n+              \"name\": \"BEFTA Case Type 1 1\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjQ0Nw==", "bodyText": "these can be expected to be specific values, couldn't they?", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162447", "createdAt": "2020-03-22T23:52:31Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-102/S-580.td.json", "diffHunk": "@@ -0,0 +1,78 @@\n+{\n+  \"_guid_\": \"S-580\",\n+  \"_extends_\": \"F-102_Test_Data_Base\",\n+  \"title\": \"Get jurisdictions available to the user\",\n+  \"specs\": [\n+    \"appropriate idam roles but no CCD user profile\",\n+    \"has CREATE as case access parameter\",\n+    \"contains HTTP 200 Ok status code\",\n+    \"contains the list of jurisdictions a user has access to\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\"\n+  },\n+  \"request\": {\n+    \"_extends_\": \"Common_Request\",\n+    \"queryParams\": {\n+      \"access\": \"create\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"_extends_\": \"Common_200_Response\",\n+    \"body\": {\n+      \"arrayInMap\": [\n+        {\n+          \"id\": \"BEFTA_JURISDICTION_1\",\n+          \"name\": \"BEFTA_JURISDICTION_1\",\n+          \"description\": \"Content for the Test Jurisdiction.\",\n+          \"caseTypes\": [\n+            {\n+              \"id\": \"BEFTA_CASETYPE_1_1\",\n+              \"description\": \"Create a case of type BEFTA_CASETYPE_1_1\",\n+              \"version\": null,\n+              \"name\": \"BEFTA Case Type 1 1\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",\n+              \"searchAliasFields\": [],\n+              \"security_classification\": null,\n+              \"case_fields\": [],\n+              \"printable_document_url\": null,\n+              \"acls\": [\n+                {\n+                  \"role\": \"caseworker-befta_jurisdiction_1\",\n+                  \"create\": true,\n+                  \"read\": true,\n+                  \"update\": true,\n+                  \"delete\": false\n+                }\n+              ]\n+            },\n+            {\n+              \"id\": \"CASE_TYPE_WITH_NO_CASES\",\n+              \"description\": \"Create a case of type CASE_TYPE_WITH_NO_CASES\",\n+              \"version\": null,\n+              \"name\": \"CT With No Cases -Don't Create\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjU1NQ==", "bodyText": "better make a dynamic reference to the field in the request, to avoid copy-paste duplication of the same value.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162555", "createdAt": "2020-03-22T23:53:21Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-102/S-580.td.json", "diffHunk": "@@ -0,0 +1,78 @@\n+{\n+  \"_guid_\": \"S-580\",\n+  \"_extends_\": \"F-102_Test_Data_Base\",\n+  \"title\": \"Get jurisdictions available to the user\",\n+  \"specs\": [\n+    \"appropriate idam roles but no CCD user profile\",\n+    \"has CREATE as case access parameter\",\n+    \"contains HTTP 200 Ok status code\",\n+    \"contains the list of jurisdictions a user has access to\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\"\n+  },\n+  \"request\": {\n+    \"_extends_\": \"Common_Request\",\n+    \"queryParams\": {\n+      \"access\": \"create\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"_extends_\": \"Common_200_Response\",\n+    \"body\": {\n+      \"arrayInMap\": [\n+        {\n+          \"id\": \"BEFTA_JURISDICTION_1\",\n+          \"name\": \"BEFTA_JURISDICTION_1\",\n+          \"description\": \"Content for the Test Jurisdiction.\",\n+          \"caseTypes\": [\n+            {\n+              \"id\": \"BEFTA_CASETYPE_1_1\",\n+              \"description\": \"Create a case of type BEFTA_CASETYPE_1_1\",\n+              \"version\": null,\n+              \"name\": \"BEFTA Case Type 1 1\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",\n+              \"searchAliasFields\": [],\n+              \"security_classification\": null,\n+              \"case_fields\": [],\n+              \"printable_document_url\": null,\n+              \"acls\": [\n+                {\n+                  \"role\": \"caseworker-befta_jurisdiction_1\",\n+                  \"create\": true,\n+                  \"read\": true,\n+                  \"update\": true,\n+                  \"delete\": false\n+                }\n+              ]\n+            },\n+            {\n+              \"id\": \"CASE_TYPE_WITH_NO_CASES\",\n+              \"description\": \"Create a case of type CASE_TYPE_WITH_NO_CASES\",\n+              \"version\": null,\n+              \"name\": \"CT With No Cases -Don't Create\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",\n+              \"searchAliasFields\": [],\n+              \"security_classification\": null,\n+              \"case_fields\": [],\n+              \"printable_document_url\": null,\n+              \"acls\": [\n+                {\n+                  \"role\": \"caseworker-befta_jurisdiction_1\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1"}, "originalPosition": 65}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e842b5cde4c49f8bc35635f80bced56e7a420283", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/e842b5cde4c49f8bc35635f80bced56e7a420283", "committedDate": "2020-03-25T11:50:22Z", "message": "adress review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMTA5MjM4", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#pullrequestreview-381109238", "createdAt": "2020-03-25T12:41:56Z", "commit": {"oid": "e842b5cde4c49f8bc35635f80bced56e7a420283"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMjo0MTo1NlrOF7ZMBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxMjo0MTo1NlrOF7ZMBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzgyMjk4Mg==", "bodyText": "we could use\n\"email\": \"${[scenarioContext][theInvokingUser][username]}\",", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r397822982", "createdAt": "2020-03-25T12:41:56Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,481 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_NO_PROFILE_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"${[scenarioContext][theInvokingUser][id]}\",\n+          \"email\": \"befta.caseworker.1.noprofile@gmail.com\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e842b5cde4c49f8bc35635f80bced56e7a420283"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cc32ec3e938de56ea09c77f731b8cae2c46e68b", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/6cc32ec3e938de56ea09c77f731b8cae2c46e68b", "committedDate": "2020-03-25T13:19:37Z", "message": "Merge branch 'develop' into RDM-7926"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "faa08eec5b1efce641abbdbb03f7b3c232067ad2", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/faa08eec5b1efce641abbdbb03f7b3c232067ad2", "committedDate": "2020-03-25T17:05:17Z", "message": "add headers to data file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1df9babbd464c7ef9da03089313dc6a80be8dc80", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/1df9babbd464c7ef9da03089313dc6a80be8dc80", "committedDate": "2020-03-25T17:07:05Z", "message": "Merge branch 'RDM-7926' of github.com:hmcts/ccd-data-store-api into RDM-7926"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25d1cde3b84088fba686a81e596bf0637a512176", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/25d1cde3b84088fba686a81e596bf0637a512176", "committedDate": "2020-03-26T07:47:51Z", "message": "updated datat file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxODM4NjUz", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#pullrequestreview-381838653", "createdAt": "2020-03-26T09:39:19Z", "commit": {"oid": "25d1cde3b84088fba686a81e596bf0637a512176"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQwOTozOToxOVrOF7-e8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQwOTozOToxOVrOF7-e8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODQzNDAzNA==", "bodyText": "must return a list of jurisdictions for a valid user with no CCD user profile", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r398434034", "createdAt": "2020-03-26T09:39:19Z", "author": {"login": "MSancaktutar"}, "path": "src/aat/resources/features/F-102/F-102.feature", "diffHunk": "@@ -50,3 +50,13 @@ Feature: F-102: Get jurisdictions available to the user\n     And the response [contains HTTP 400 Bad Request]\n     And the response [contains an error message : Access can only be 'create', 'read' or 'update']\n     And the response has all other details as expected\n+\n+  @S-580\n+  Scenario: must return a list of jurisdictions for a valid user with no user profile", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25d1cde3b84088fba686a81e596bf0637a512176"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxODM5OTA1", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#pullrequestreview-381839905", "createdAt": "2020-03-26T09:40:55Z", "commit": {"oid": "25d1cde3b84088fba686a81e596bf0637a512176"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2dc84e2dca4767f65a104cb141184ec882344b0", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/e2dc84e2dca4767f65a104cb141184ec882344b0", "committedDate": "2020-03-26T09:47:54Z", "message": "updated datat file"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2634, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}