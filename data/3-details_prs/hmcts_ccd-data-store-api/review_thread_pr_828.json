{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwMzExNTM0", "number": 828, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODozMjozMFrODtbiJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwOToyNjowNVrODtcwYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4OTYzNjIyOnYy", "diffSide": "RIGHT", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODozMjozMFrOF-2MCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODozMjozMFrOF-2MCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ0Mzg0OA==", "bodyText": "this method probably does not belong to the MidEventCallback. Could we introduce a utility class if we don't have a suitable one already? suggestions: WizardPagesUtils. also better to change the method signature not to pass in CaseDetails. The method will instead return wizardPageFields that then the\nMidEventCallback will remove from the CaseDetails", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#discussion_r401443848", "createdAt": "2020-04-01T08:32:30Z", "author": {"login": "mario-paniccia"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "diffHunk": "@@ -90,6 +90,19 @@ public JsonNode invoke(String caseTypeId,\n         return dataJsonNode(content.getData());\n     }\n \n+    private void removeNextPageFieldData(CaseDetails currentCaseDetails, Integer order, String caseTypeId, String eventId) {\n+        if (order != null) {\n+            Set<String> wizardPageFields = uiDefinitionRepository\n+                .getWizardPageCollection(caseTypeId, eventId)\n+                .stream()\n+                .filter(wizardPage -> wizardPage.getOrder() > order)\n+                .map(WizardPage::getWizardPageFieldNames)\n+                .flatMap(Set::stream)\n+                .collect(Collectors.toSet());\n+            currentCaseDetails.getData().entrySet().removeIf(entry -> wizardPageFields.contains(entry.getKey()));\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4OTY3NjU1OnYy", "diffSide": "RIGHT", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODo0Mzo0MFrOF-2l0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMjo1MzowN1rOF-_KMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ1MDQ1MQ==", "bodyText": "in theory page display order is optional. Even thought we recommend to always set it. The ordering is guaranteed only if a display order is defined. Otherwise I think pages are ordered by page id or in the order they are defined on the spreadsheet (can't recall exactly). In this case we won't be removing the next pages right?", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#discussion_r401450451", "createdAt": "2020-04-01T08:43:40Z", "author": {"login": "mario-paniccia"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "diffHunk": "@@ -90,6 +90,19 @@ public JsonNode invoke(String caseTypeId,\n         return dataJsonNode(content.getData());\n     }\n \n+    private void removeNextPageFieldData(CaseDetails currentCaseDetails, Integer order, String caseTypeId, String eventId) {\n+        if (order != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU5MDgzMw==", "bodyText": "I have verified all the prod files, PageDisplayOrder is defined for most of the definitions except for some fields in below definition files.\nCCD_Publiclaw_BulkScanningExceptionRecord_V00.01-PROD\nccd-fpl-prod", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#discussion_r401590833", "createdAt": "2020-04-01T12:53:07Z", "author": {"login": "kiran-yenigala-hmcts"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "diffHunk": "@@ -90,6 +90,19 @@ public JsonNode invoke(String caseTypeId,\n         return dataJsonNode(content.getData());\n     }\n \n+    private void removeNextPageFieldData(CaseDetails currentCaseDetails, Integer order, String caseTypeId, String eventId) {\n+        if (order != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ1MDQ1MQ=="}, "originalCommit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4OTgzNjQ5OnYy", "diffSide": "RIGHT", "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwOToyNjowNVrOF-4K2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwOToyNjowNVrOF-4K2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ3NjMxNA==", "bodyText": "looking at this now, rather than a WizardPagesUtils I think the best thing is the UIDefRepo to return the list of pages wrapped inside a new class WizardPages that will then contain all the utility methods to process the pages like getPagesBefore(int pageId). But this might be too many changes now. you can ignore it", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#discussion_r401476314", "createdAt": "2020-04-01T09:26:05Z", "author": {"login": "mario-paniccia"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "diffHunk": "@@ -90,6 +90,19 @@ public JsonNode invoke(String caseTypeId,\n         return dataJsonNode(content.getData());\n     }\n \n+    private void removeNextPageFieldData(CaseDetails currentCaseDetails, Integer order, String caseTypeId, String eventId) {\n+        if (order != null) {\n+            Set<String> wizardPageFields = uiDefinitionRepository", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3893, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}