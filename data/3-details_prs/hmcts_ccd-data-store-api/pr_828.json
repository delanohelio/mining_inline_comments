{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwMzExNTM0", "number": 828, "title": "RDM-7455: [Immigration and Asylum]- Date Validation errors not cleare\u2026", "bodyText": "JIRA link (if applicable)\nhttps://tools.hmcts.net/jira/browse/RDM-7455\nChange description\nPass only the current wizard page fields to validate\nDoes this PR introduce a breaking change? (check one with \"x\")\n[ ] Yes\n[ X] No", "createdAt": "2020-02-26T14:32:48Z", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828", "merged": true, "mergeCommit": {"oid": "a76d6a150f0ef056cddfc8c29b8eaa25d326faae"}, "closed": true, "closedAt": "2020-09-08T12:08:54Z", "author": {"login": "kiran-yenigala-hmcts"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIHn6AAH2gAyMzgwMzExNTM0OjhjMGRmOWY0Yzc4YWJlNDVhYzAyNTVlNTgwMjlkZTAzMGQ2ZTJhZWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdG2eKaAH2gAyMzgwMzExNTM0OjRjZDQ1NTQwNjg0NWQxNjdmODcyNzg4YjIzZWMxYmEzZmJhNDBiZjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8c0df9f4c78abe45ac0255e58029de030d6e2aeb", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/8c0df9f4c78abe45ac0255e58029de030d6e2aeb", "committedDate": "2020-02-26T14:30:24Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation errors not cleared when user goes to previous page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbe05c5c3d91ada25a50bf7a3ddf0ac7815751e6", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/dbe05c5c3d91ada25a50bf7a3ddf0ac7815751e6", "committedDate": "2020-03-23T22:30:25Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation errors not cleared when user goes to previous page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c413dedec896257092199fcc10ac12e973791cd", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/6c413dedec896257092199fcc10ac12e973791cd", "committedDate": "2020-03-24T09:10:45Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation errors not cleared when user goes to previous page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "acc0e18263348855fdf6ad7bdc63cec0bae2c4f7", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/acc0e18263348855fdf6ad7bdc63cec0bae2c4f7", "committedDate": "2020-03-24T09:30:15Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation errors not cleared when user goes to previous page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f67537daaf65d84437cbfc26f292f28d4818a92", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/5f67537daaf65d84437cbfc26f292f28d4818a92", "committedDate": "2020-03-24T09:51:54Z", "message": "CVE-2020-10672, CVE-2020-10673"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4f02e0475d5434813cca2d39168beab93fc001c", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/b4f02e0475d5434813cca2d39168beab93fc001c", "committedDate": "2020-03-24T19:24:34Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : Test case added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47deca6c1fe39766933e4b5ce020c9f52f996424", "author": {"user": {"login": "kiran-yenigala-hmcts", "name": "Kiran Kumar Yenigala"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/47deca6c1fe39766933e4b5ce020c9f52f996424", "committedDate": "2020-03-24T19:27:46Z", "message": "Merge branch 'develop' into RDM-7455"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da2c8081fa193f52d59d5a20bcee7be5405070c5", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/da2c8081fa193f52d59d5a20bcee7be5405070c5", "committedDate": "2020-03-24T20:24:19Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : Temporary supression on jackson data bind"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "012a548754e904a1c56ea6410dd147e72465e8c0", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/012a548754e904a1c56ea6410dd147e72465e8c0", "committedDate": "2020-03-24T20:27:30Z", "message": "Merge remote-tracking branch 'origin/RDM-7455' into RDM-7455"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b7ceac9cc88ce9d487dd855bf785775989cc47e", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/5b7ceac9cc88ce9d487dd855bf785775989cc47e", "committedDate": "2020-03-24T20:30:41Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : reverted jackson-databind version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76e45d1ca791dcb646341322c40b6af5c8c149c4", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/76e45d1ca791dcb646341322c40b6af5c8c149c4", "committedDate": "2020-03-24T21:24:02Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : reverted to previous changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84095b83b1d8088720e8ff737848230d93bf00bd", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/84095b83b1d8088720e8ff737848230d93bf00bd", "committedDate": "2020-03-24T21:38:03Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : reverted to previous changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b7f2e43803504bb5e40849ce171cb38c2257b9e", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/8b7f2e43803504bb5e40849ce171cb38c2257b9e", "committedDate": "2020-03-24T22:23:18Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : Test cases added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "010e92a27573cef07d5a0433d3ccd02707ac928f", "author": {"user": {"login": "Olawale", "name": "Olawale Olanrewaju"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/010e92a27573cef07d5a0433d3ccd02707ac928f", "committedDate": "2020-03-25T09:30:49Z", "message": "Merge branch 'develop' into RDM-7455"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8aeea624ee67c6af74f1fdf5ff49b30f4ea5487", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/e8aeea624ee67c6af74f1fdf5ff49b30f4ea5487", "committedDate": "2020-03-27T10:19:34Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : Test cases added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e658696a247d06fe3154ff48849f1c2a6c615672", "author": {"user": {"login": "kiran-yenigala-hmcts", "name": "Kiran Kumar Yenigala"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/e658696a247d06fe3154ff48849f1c2a6c615672", "committedDate": "2020-03-27T11:56:14Z", "message": "Merge branch 'develop' into RDM-7455"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1104504bce96f39f4017b3ba99399fdb12ac4125", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/1104504bce96f39f4017b3ba99399fdb12ac4125", "committedDate": "2020-03-27T16:15:43Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : Failure Test cases resolved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bd04b2e7f84d2deb8450753d5e4e7e31f87cb9d2", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/bd04b2e7f84d2deb8450753d5e4e7e31f87cb9d2", "committedDate": "2020-03-29T19:52:43Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : Integration Test cases added and removed changed from functional test part"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12ca208e4fa2723cb46da36cbbe0b05465d24edd", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/12ca208e4fa2723cb46da36cbbe0b05465d24edd", "committedDate": "2020-03-29T22:57:50Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : Integration Test cases added for  multi page filtering and checkstyle issues fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "854857be610f733ac71796aa47396df42c440968", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/854857be610f733ac71796aa47396df42c440968", "committedDate": "2020-03-30T09:06:59Z", "message": "RDM-7455: [Immigration and Asylum]- Date Validation : Checkstyle issues fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MzcwODk2", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#pullrequestreview-385370896", "createdAt": "2020-04-01T08:32:30Z", "commit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODozMjozMFrOF-2MCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODozMjozMFrOF-2MCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ0Mzg0OA==", "bodyText": "this method probably does not belong to the MidEventCallback. Could we introduce a utility class if we don't have a suitable one already? suggestions: WizardPagesUtils. also better to change the method signature not to pass in CaseDetails. The method will instead return wizardPageFields that then the\nMidEventCallback will remove from the CaseDetails", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#discussion_r401443848", "createdAt": "2020-04-01T08:32:30Z", "author": {"login": "mario-paniccia"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "diffHunk": "@@ -90,6 +90,19 @@ public JsonNode invoke(String caseTypeId,\n         return dataJsonNode(content.getData());\n     }\n \n+    private void removeNextPageFieldData(CaseDetails currentCaseDetails, Integer order, String caseTypeId, String eventId) {\n+        if (order != null) {\n+            Set<String> wizardPageFields = uiDefinitionRepository\n+                .getWizardPageCollection(caseTypeId, eventId)\n+                .stream()\n+                .filter(wizardPage -> wizardPage.getOrder() > order)\n+                .map(WizardPage::getWizardPageFieldNames)\n+                .flatMap(Set::stream)\n+                .collect(Collectors.toSet());\n+            currentCaseDetails.getData().entrySet().removeIf(entry -> wizardPageFields.contains(entry.getKey()));\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "originalPosition": 58}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1Mzc5MTc0", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#pullrequestreview-385379174", "createdAt": "2020-04-01T08:43:39Z", "commit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODo0Mzo0MFrOF-2l0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwODo0Mzo0MFrOF-2l0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ1MDQ1MQ==", "bodyText": "in theory page display order is optional. Even thought we recommend to always set it. The ordering is guaranteed only if a display order is defined. Otherwise I think pages are ordered by page id or in the order they are defined on the spreadsheet (can't recall exactly). In this case we won't be removing the next pages right?", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#discussion_r401450451", "createdAt": "2020-04-01T08:43:40Z", "author": {"login": "mario-paniccia"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "diffHunk": "@@ -90,6 +90,19 @@ public JsonNode invoke(String caseTypeId,\n         return dataJsonNode(content.getData());\n     }\n \n+    private void removeNextPageFieldData(CaseDetails currentCaseDetails, Integer order, String caseTypeId, String eventId) {\n+        if (order != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NDExMjQy", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#pullrequestreview-385411242", "createdAt": "2020-04-01T09:26:05Z", "commit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwOToyNjowNVrOF-4K2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQwOToyNjowNVrOF-4K2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTQ3NjMxNA==", "bodyText": "looking at this now, rather than a WizardPagesUtils I think the best thing is the UIDefRepo to return the list of pages wrapped inside a new class WizardPages that will then contain all the utility methods to process the pages like getPagesBefore(int pageId). But this might be too many changes now. you can ignore it", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#discussion_r401476314", "createdAt": "2020-04-01T09:26:05Z", "author": {"login": "mario-paniccia"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallback.java", "diffHunk": "@@ -90,6 +90,19 @@ public JsonNode invoke(String caseTypeId,\n         return dataJsonNode(content.getData());\n     }\n \n+    private void removeNextPageFieldData(CaseDetails currentCaseDetails, Integer order, String caseTypeId, String eventId) {\n+        if (order != null) {\n+            Set<String> wizardPageFields = uiDefinitionRepository", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NDE2OTYw", "url": "https://github.com/hmcts/ccd-data-store-api/pull/828#pullrequestreview-385416960", "createdAt": "2020-04-01T09:33:01Z", "commit": {"oid": "854857be610f733ac71796aa47396df42c440968"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbaf99cd331b8bed8c81edd43c471a9164ace6d1", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/cbaf99cd331b8bed8c81edd43c471a9164ace6d1", "committedDate": "2020-04-02T06:59:53Z", "message": "Merge branch 'develop' into RDM-7455"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44d08c60b9cedbde273f5d51d48cefee4faf49b9", "author": {"user": {"login": "noronhaa", "name": "Ashley Noronha"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/44d08c60b9cedbde273f5d51d48cefee4faf49b9", "committedDate": "2020-04-02T13:35:18Z", "message": "Merge branch 'develop' into RDM-7455"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22f3f6f604e4b201318f6e730f97d824590ef36e", "author": {"user": null}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/22f3f6f604e4b201318f6e730f97d824590ef36e", "committedDate": "2020-09-03T15:29:35Z", "message": "Merge branch 'release-cut-19.2' into RDM-7455\n\n# Conflicts:\n#\tdependency-check-suppressions.xml\n#\tsrc/main/java/uk/gov/hmcts/ccd/domain/service/common/CaseService.java\n#\tsrc/test/java/uk/gov/hmcts/ccd/domain/service/common/TestBuildersUtil.java\n#\tsrc/test/java/uk/gov/hmcts/ccd/domain/service/createevent/MidEventCallbackTest.java\n#\tsrc/test/java/uk/gov/hmcts/ccd/endpoint/std/CaseDetailsEndpointIT.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cd455406845d167f872788b23ec1ba3fba40bf1", "author": {"user": {"login": "hemantt", "name": "Hemanth Potipati"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/4cd455406845d167f872788b23ec1ba3fba40bf1", "committedDate": "2020-09-08T12:08:36Z", "message": "Merge branch 'release-cut-19.2' into RDM-7455"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2608, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}