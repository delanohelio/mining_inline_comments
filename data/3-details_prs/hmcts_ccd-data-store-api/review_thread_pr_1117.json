{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NjQ5NDAw", "number": 1117, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDozOToxMVrOEkeVXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDo0MDoxM1rOEkeWwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjgxMTgwOnYy", "diffSide": "RIGHT", "path": "Jenkinsfile_nightly", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDozOToxMVrOHTcBtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMzo1OTozMVrOHTjo3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0NDE4MQ==", "bodyText": "couldn't quite get these.\nWhy would these lines be showing as different?\nDid we add them as part of this ticket?", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1117#discussion_r490144181", "createdAt": "2020-09-17T10:39:11Z", "author": {"login": "MSancaktutar"}, "path": "Jenkinsfile_nightly", "diffHunk": "@@ -42,7 +42,10 @@ def secrets = [\n         secret('ccd-befta-citizen-3-pwd', 'CCD_BEFTA_CITIZEN_3_PWD'),\n         secret('ccd-befta-solicitor-3-pwd', 'CCD_BEFTA_SOLICITOR_3_PWD'),\n         secret('ccd-befta-caseworker-1-no-profile-pwd', 'CCD_BEFTA_CASEWORKER_1_NO_PROFILE_PWD'),\n-        secret('ccd-befta-caseworker-caa-pwd', 'CCD_BEFTA_CASEWORKER_CAA_PWD')\n+        secret('ccd-befta-caseworker-caa-pwd', 'CCD_BEFTA_CASEWORKER_CAA_PWD'),\n+        secret('ccd-befta-master-caseworker-pwd', 'CCD_BEFTA_MASTER_CASEWORKER_PWD'),\n+        secret('ccd-befta-master-solicitor1-pwd', 'CCD_BEFTA_MASTER_SOLICITOR_1_PWD'),\n+        secret('ccd-befta-master-solicitor2-pwd', 'CCD_BEFTA_MASTER_SOLICITOR_2_PWD')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b556c4d154f75332c8db40f3339b68f98dcecf10"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI2ODg5Mw==", "bodyText": "Well, I can appreciate if the above lines may be required for nightly builds, but that should come under another ticket and PR.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1117#discussion_r490268893", "createdAt": "2020-09-17T13:59:31Z", "author": {"login": "MSancaktutar"}, "path": "Jenkinsfile_nightly", "diffHunk": "@@ -42,7 +42,10 @@ def secrets = [\n         secret('ccd-befta-citizen-3-pwd', 'CCD_BEFTA_CITIZEN_3_PWD'),\n         secret('ccd-befta-solicitor-3-pwd', 'CCD_BEFTA_SOLICITOR_3_PWD'),\n         secret('ccd-befta-caseworker-1-no-profile-pwd', 'CCD_BEFTA_CASEWORKER_1_NO_PROFILE_PWD'),\n-        secret('ccd-befta-caseworker-caa-pwd', 'CCD_BEFTA_CASEWORKER_CAA_PWD')\n+        secret('ccd-befta-caseworker-caa-pwd', 'CCD_BEFTA_CASEWORKER_CAA_PWD'),\n+        secret('ccd-befta-master-caseworker-pwd', 'CCD_BEFTA_MASTER_CASEWORKER_PWD'),\n+        secret('ccd-befta-master-solicitor1-pwd', 'CCD_BEFTA_MASTER_SOLICITOR_1_PWD'),\n+        secret('ccd-befta-master-solicitor2-pwd', 'CCD_BEFTA_MASTER_SOLICITOR_2_PWD')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0NDE4MQ=="}, "originalCommit": {"oid": "b556c4d154f75332c8db40f3339b68f98dcecf10"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2NjgxNTM3OnYy", "diffSide": "RIGHT", "path": "Jenkinsfile_nightly", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QxMDo0MDoxM1rOHTcD3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xN1QyMDowMzo0OVrOHTzi3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0NDczNA==", "bodyText": "couldn't quite get these.\nWhy would the lines on this file be showing as different?\nDid we add them as part of this ticket?", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1117#discussion_r490144734", "createdAt": "2020-09-17T10:40:13Z", "author": {"login": "MSancaktutar"}, "path": "Jenkinsfile_nightly", "diffHunk": "@@ -59,9 +62,44 @@ static LinkedHashMap<String, Object> secret(String secretName, String envVar) {\n     ]\n }\n \n+def vaultOverrides = [\n+    'preview' : 'aat',\n+    'spreview': 'saat'\n+]\n+// vars needed for functional tests\n+// Assume a feature build branched off 'develop', with dependencies develop-to-develop.\n+//env.DEFINITION_STORE_HOST = \"http://ccd-definition-store-api-${definitionStoreDevelopPr}.service.core-compute-preview.internal\".toLowerCase()\n+\n+// Other env variables needed for BEFTA.\n+env.IDAM_URL = \"https://idam-api.aat.platform.hmcts.net\"\n+env.S2S_URL = \"http://rpe-service-auth-provider-aat.service.core-compute-aat.internal\"\n+env.BEFTA_S2S_CLIENT_ID = \"ccd_gw\"\n+env.OAUTH2_CLIENT_ID = \"ccd_gateway\"\n+env.OAUTH2_REDIRECT_URI = \"https://www-ccd.aat.platform.hmcts.net/oauth2redirect\"\n+env.DM_STORE_BASE_URL = \"http://dm-store-aat.service.core-compute-aat.internal\"\n+env.RD_PROFESSIONAL_API_BASE_URL = \"http://rd-professional-api-aat.service.core-compute-aat.internal\"\n+env.BEFTA_RESPONSE_HEADER_CHECK_POLICY=\"JUST_WARN\" // Temporary workaround for platform changes: turn BEFTA header checks to warning mode\n+env.ELASTIC_SEARCH_FTA_ENABLED = \"false\"\n+\n+\n withNightlyPipeline(type, product, component) {\n+    overrideVaultEnvironments(vaultOverrides)\n+    disableLegacyDeploymentOnAAT()\n     loadVaultSecrets(secrets)\n     enableDbMigration('ccd')\n-    enableMutationTest()\n+    disableLegacyDeployment()\n+\n+    after('test') {\n+        // hmcts/cnp-jenkins-library may fail to copy artifacts after checkstyle error so repeat command (see /src/uk/gov/hmcts/contino/GradleBuilder.groovy)\n+        steps.archiveArtifacts allowEmptyArchive: true, artifacts: '**/reports/checkstyle/*.html'\n+    }\n+\n+    after('functionalTest:preview') {\n+        steps.archiveArtifacts allowEmptyArchive: true, artifacts: '**/target/cucumber/**/*'\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b556c4d154f75332c8db40f3339b68f98dcecf10"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI2ODk3OA==", "bodyText": "Well, I can appreciate if the above lines may be required for nightly builds, but that should come under another ticket and PR.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1117#discussion_r490268978", "createdAt": "2020-09-17T13:59:37Z", "author": {"login": "MSancaktutar"}, "path": "Jenkinsfile_nightly", "diffHunk": "@@ -59,9 +62,44 @@ static LinkedHashMap<String, Object> secret(String secretName, String envVar) {\n     ]\n }\n \n+def vaultOverrides = [\n+    'preview' : 'aat',\n+    'spreview': 'saat'\n+]\n+// vars needed for functional tests\n+// Assume a feature build branched off 'develop', with dependencies develop-to-develop.\n+//env.DEFINITION_STORE_HOST = \"http://ccd-definition-store-api-${definitionStoreDevelopPr}.service.core-compute-preview.internal\".toLowerCase()\n+\n+// Other env variables needed for BEFTA.\n+env.IDAM_URL = \"https://idam-api.aat.platform.hmcts.net\"\n+env.S2S_URL = \"http://rpe-service-auth-provider-aat.service.core-compute-aat.internal\"\n+env.BEFTA_S2S_CLIENT_ID = \"ccd_gw\"\n+env.OAUTH2_CLIENT_ID = \"ccd_gateway\"\n+env.OAUTH2_REDIRECT_URI = \"https://www-ccd.aat.platform.hmcts.net/oauth2redirect\"\n+env.DM_STORE_BASE_URL = \"http://dm-store-aat.service.core-compute-aat.internal\"\n+env.RD_PROFESSIONAL_API_BASE_URL = \"http://rd-professional-api-aat.service.core-compute-aat.internal\"\n+env.BEFTA_RESPONSE_HEADER_CHECK_POLICY=\"JUST_WARN\" // Temporary workaround for platform changes: turn BEFTA header checks to warning mode\n+env.ELASTIC_SEARCH_FTA_ENABLED = \"false\"\n+\n+\n withNightlyPipeline(type, product, component) {\n+    overrideVaultEnvironments(vaultOverrides)\n+    disableLegacyDeploymentOnAAT()\n     loadVaultSecrets(secrets)\n     enableDbMigration('ccd')\n-    enableMutationTest()\n+    disableLegacyDeployment()\n+\n+    after('test') {\n+        // hmcts/cnp-jenkins-library may fail to copy artifacts after checkstyle error so repeat command (see /src/uk/gov/hmcts/contino/GradleBuilder.groovy)\n+        steps.archiveArtifacts allowEmptyArchive: true, artifacts: '**/reports/checkstyle/*.html'\n+    }\n+\n+    after('functionalTest:preview') {\n+        steps.archiveArtifacts allowEmptyArchive: true, artifacts: '**/target/cucumber/**/*'\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0NDczNA=="}, "originalCommit": {"oid": "b556c4d154f75332c8db40f3339b68f98dcecf10"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDUyOTUwMw==", "bodyText": "reverted irrelevant commits from this branch.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1117#discussion_r490529503", "createdAt": "2020-09-17T20:03:49Z", "author": {"login": "MSancaktutar"}, "path": "Jenkinsfile_nightly", "diffHunk": "@@ -59,9 +62,44 @@ static LinkedHashMap<String, Object> secret(String secretName, String envVar) {\n     ]\n }\n \n+def vaultOverrides = [\n+    'preview' : 'aat',\n+    'spreview': 'saat'\n+]\n+// vars needed for functional tests\n+// Assume a feature build branched off 'develop', with dependencies develop-to-develop.\n+//env.DEFINITION_STORE_HOST = \"http://ccd-definition-store-api-${definitionStoreDevelopPr}.service.core-compute-preview.internal\".toLowerCase()\n+\n+// Other env variables needed for BEFTA.\n+env.IDAM_URL = \"https://idam-api.aat.platform.hmcts.net\"\n+env.S2S_URL = \"http://rpe-service-auth-provider-aat.service.core-compute-aat.internal\"\n+env.BEFTA_S2S_CLIENT_ID = \"ccd_gw\"\n+env.OAUTH2_CLIENT_ID = \"ccd_gateway\"\n+env.OAUTH2_REDIRECT_URI = \"https://www-ccd.aat.platform.hmcts.net/oauth2redirect\"\n+env.DM_STORE_BASE_URL = \"http://dm-store-aat.service.core-compute-aat.internal\"\n+env.RD_PROFESSIONAL_API_BASE_URL = \"http://rd-professional-api-aat.service.core-compute-aat.internal\"\n+env.BEFTA_RESPONSE_HEADER_CHECK_POLICY=\"JUST_WARN\" // Temporary workaround for platform changes: turn BEFTA header checks to warning mode\n+env.ELASTIC_SEARCH_FTA_ENABLED = \"false\"\n+\n+\n withNightlyPipeline(type, product, component) {\n+    overrideVaultEnvironments(vaultOverrides)\n+    disableLegacyDeploymentOnAAT()\n     loadVaultSecrets(secrets)\n     enableDbMigration('ccd')\n-    enableMutationTest()\n+    disableLegacyDeployment()\n+\n+    after('test') {\n+        // hmcts/cnp-jenkins-library may fail to copy artifacts after checkstyle error so repeat command (see /src/uk/gov/hmcts/contino/GradleBuilder.groovy)\n+        steps.archiveArtifacts allowEmptyArchive: true, artifacts: '**/reports/checkstyle/*.html'\n+    }\n+\n+    after('functionalTest:preview') {\n+        steps.archiveArtifacts allowEmptyArchive: true, artifacts: '**/target/cucumber/**/*'\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0NDczNA=="}, "originalCommit": {"oid": "b556c4d154f75332c8db40f3339b68f98dcecf10"}, "originalPosition": 51}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3685, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}