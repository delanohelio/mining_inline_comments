{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4MDIxNzc3", "number": 1242, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNToxNjozNFrOE9rQ3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1NDo0NlrOE97gSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMTA3NDIyOnYy", "diffSide": "RIGHT", "path": "charts/ccd-data-store-api/Chart.yaml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQxNToxNjozNFrOH6fdVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0zMFQxMjo1Mjo0M1rOH75wDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA5NDg2OQ==", "bodyText": "Doesn't look right that we're downgrading? \ud83e\udd14", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531094869", "createdAt": "2020-11-26T15:16:34Z", "author": {"login": "danlysiak"}, "path": "charts/ccd-data-store-api/Chart.yaml", "diffHunk": "@@ -2,13 +2,13 @@ description: Helm chart for the HMCTS CCD Data Store\n name: ccd-data-store-api\n apiVersion: v2\n home: https://github.com/hmcts/ccd-data-store-api\n-version: 1.7.2\n+version: 1.7.3\n maintainers:\n   - name: HMCTS CCD Dev Team\n     email: ccd-devops@HMCTS.NET\n dependencies:\n   - name: java\n-    version: 3.4.4\n+    version: 3.4.2", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71f85e158ed447e6db0fa12008f46983cd1470a7"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTEwMDY5MA==", "bodyText": "That is right. good spot. it was committed but was not pushed it. all done.", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531100690", "createdAt": "2020-11-26T15:26:34Z", "author": {"login": "henrykcgi"}, "path": "charts/ccd-data-store-api/Chart.yaml", "diffHunk": "@@ -2,13 +2,13 @@ description: Helm chart for the HMCTS CCD Data Store\n name: ccd-data-store-api\n apiVersion: v2\n home: https://github.com/hmcts/ccd-data-store-api\n-version: 1.7.2\n+version: 1.7.3\n maintainers:\n   - name: HMCTS CCD Dev Team\n     email: ccd-devops@HMCTS.NET\n dependencies:\n   - name: java\n-    version: 3.4.4\n+    version: 3.4.2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA5NDg2OQ=="}, "originalCommit": {"oid": "71f85e158ed447e6db0fa12008f46983cd1470a7"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU3NDIyMA==", "bodyText": "It should be down down graded", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r532574220", "createdAt": "2020-11-30T12:52:43Z", "author": {"login": "henrykcgi"}, "path": "charts/ccd-data-store-api/Chart.yaml", "diffHunk": "@@ -2,13 +2,13 @@ description: Helm chart for the HMCTS CCD Data Store\n name: ccd-data-store-api\n apiVersion: v2\n home: https://github.com/hmcts/ccd-data-store-api\n-version: 1.7.2\n+version: 1.7.3\n maintainers:\n   - name: HMCTS CCD Dev Team\n     email: ccd-devops@HMCTS.NET\n dependencies:\n   - name: java\n-    version: 3.4.4\n+    version: 3.4.2", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA5NDg2OQ=="}, "originalCommit": {"oid": "71f85e158ed447e6db0fa12008f46983cd1470a7"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMzcyMjAwOnYy", "diffSide": "RIGHT", "path": "src/main/java/uk/gov/hmcts/ccd/security/JwtGrantedAuthoritiesConverter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1MTowN1rOH63u2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1MTowN1rOH63u2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5MjU2OQ==", "bodyText": "we are already logging in idamRepository, it is not needed again here... it will log the same info multiple times", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531492569", "createdAt": "2020-11-27T09:51:07Z", "author": {"login": "kiran-yenigala-hmcts"}, "path": "src/main/java/uk/gov/hmcts/ccd/security/JwtGrantedAuthoritiesConverter.java", "diffHunk": "@@ -33,6 +36,8 @@ public JwtGrantedAuthoritiesConverter(IdamRepository idamRepository) {\n         List<GrantedAuthority> authorities = new ArrayList<>();\n         if (jwt.containsClaim(TOKEN_NAME) && jwt.getClaim(TOKEN_NAME).equals(ACCESS_TOKEN)) {\n             UserInfo userInfo = idamRepository.getUserInfo(jwt.getTokenValue());\n+            log.info(\"JwtGrantedAuthoritiesConverter retrieved user info from idamRepository. User Id={}. Roles={}.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e0407872add6ce07c402fef432068887f5f380f"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMzcyNDQzOnYy", "diffSide": "RIGHT", "path": "src/main/java/uk/gov/hmcts/ccd/data/SecurityUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1MTo1MFrOH63wVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1MTo1MFrOH63wVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5Mjk0OQ==", "bodyText": "we are already logging in idamRepository, it is not needed again here... it will log the same info multiple times", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531492949", "createdAt": "2020-11-27T09:51:50Z", "author": {"login": "kiran-yenigala-hmcts"}, "path": "src/main/java/uk/gov/hmcts/ccd/data/SecurityUtils.java", "diffHunk": "@@ -54,7 +56,13 @@ public HttpHeaders userAuthorizationHeaders() {\n     }\n \n     public UserInfo getUserInfo() {\n-        return idamRepository.getUserInfo(getUserToken());\n+        UserInfo userInfo = idamRepository.getUserInfo(getUserToken());\n+        if (userInfo != null) {\n+            log.info(\"SecurityUtils retrieved user info from idamRepository. User Id={}. Roles={}.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e0407872add6ce07c402fef432068887f5f380f"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMzcyOTU1OnYy", "diffSide": "RIGHT", "path": "src/main/java/uk/gov/hmcts/ccd/config/SwaggerConfiguration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1MzoxOFrOH63zhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1MzoxOFrOH63zhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5Mzc2Ng==", "bodyText": "can we use ParameterType.HEADER(\"header\"), instead of hard coding \"header\"", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531493766", "createdAt": "2020-11-27T09:53:18Z", "author": {"login": "kiran-yenigala-hmcts"}, "path": "src/main/java/uk/gov/hmcts/ccd/config/SwaggerConfiguration.java", "diffHunk": "@@ -83,7 +87,8 @@ private RequestParameter headerAuthorization() {\n         return new RequestParameterBuilder()\n             .name(\"Authorization\")\n             .description(\"Keyword `Bearer` followed by a valid IDAM user token\")\n-            .in(ParameterType.HEADER)\n+            .in(\"header\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e0407872add6ce07c402fef432068887f5f380f"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMzczMDA0OnYy", "diffSide": "RIGHT", "path": "src/main/java/uk/gov/hmcts/ccd/config/SwaggerConfiguration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1MzoyOFrOH63z2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1MzoyOFrOH63z2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5Mzg1MA==", "bodyText": "can we use ParameterType.HEADER(\"header\"), instead of hard coding \"header\"", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531493850", "createdAt": "2020-11-27T09:53:28Z", "author": {"login": "kiran-yenigala-hmcts"}, "path": "src/main/java/uk/gov/hmcts/ccd/config/SwaggerConfiguration.java", "diffHunk": "@@ -92,7 +97,8 @@ private RequestParameter headerServiceAuthorization() {\n         return new RequestParameterBuilder()\n             .name(\"ServiceAuthorization\")\n             .description(\"Valid Service-to-Service JWT token for a whitelisted micro-service\")\n-            .in(ParameterType.HEADER)\n+            .in(\"header\")\n+            .accepts(Collections.singleton(MediaType.APPLICATION_JSON))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e0407872add6ce07c402fef432068887f5f380f"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzMzczNTEzOnYy", "diffSide": "RIGHT", "path": "src/main/java/uk/gov/hmcts/ccd/AliasWebConfig.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1NDo0NlrOH6324w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QwOTo1NDo0NlrOH6324w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5NDYyNw==", "bodyText": "if we are forwarding the request to \"/health\" do we need to add this in \"SecurityConfiguration --> AUTH_WHITELIST\"", "url": "https://github.com/hmcts/ccd-data-store-api/pull/1242#discussion_r531494627", "createdAt": "2020-11-27T09:54:46Z", "author": {"login": "kiran-yenigala-hmcts"}, "path": "src/main/java/uk/gov/hmcts/ccd/AliasWebConfig.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package uk.gov.hmcts.ccd;\n+\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;\n+import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;\n+\n+@Configuration\n+public class AliasWebConfig implements WebMvcConfigurer {\n+\n+    @Override\n+    public void addViewControllers(ViewControllerRegistry registry) {\n+        /**\n+         * This alias is to support Tactical health checks. Once support of Tactical is dropped,\n+         * this alias can be removed.\n+         */\n+        registry.addViewController(\"/status/health\").setViewName(\"forward:/health\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e0407872add6ce07c402fef432068887f5f380f"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3656, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}