{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2OTUzMTkx", "number": 984, "title": "Rdm 8747: supplementary data db changes", "bodyText": "Before creating a pull request make sure that:\n\n commit messages are meaningful and follow good commit message guidelines\n README and other documentation has been updated / added (if needed)\n tests have been updated / new tests has been added (if needed)\n\nPlease remove this line and everything above and fill the following sections:\nJIRA link (if applicable)\nChange description\nDoes this PR introduce a breaking change? (check one with \"x\")\n[ ] Yes\n[ ] No", "createdAt": "2020-06-19T08:00:23Z", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984", "merged": true, "mergeCommit": {"oid": "15f45ecc8697de7c82878db234df87e5eeae0ed0"}, "closed": true, "closedAt": "2020-07-07T11:08:00Z", "author": {"login": "Thor-tech-of-metal"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsuXDnAH2gAyNDM2OTUzMTkxOjI5MDk1MGFmNzU1NTE3NmM2NDE3YjllNTNlNGQxNjJlMWJlZTc2ZmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyjZgdAH2gAyNDM2OTUzMTkxOmIzMzAyYWIyZTg3YmJkYzQ2NjdlOGI2NjUwYTA0NWNhNzlkZTg3ZDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "290950af7555176c6417b9e53e4d162e1bee76fe", "author": {"user": {"login": "Thor-tech-of-metal", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/290950af7555176c6417b9e53e4d162e1bee76fe", "committedDate": "2020-06-19T07:59:34Z", "message": "work in progress."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzODk0MDc3", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#pullrequestreview-433894077", "createdAt": "2020-06-19T08:23:06Z", "commit": {"oid": "290950af7555176c6417b9e53e4d162e1bee76fe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwODoyMzowN1rOGmMhnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwODoyMzowN1rOGmMhnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjcwNDI4NA==", "bodyText": "we don't want to allow getting and setting the whole supplementary data. Consider providing methods to instead get and set specific properties", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r442704284", "createdAt": "2020-06-19T08:23:07Z", "author": {"login": "mario-paniccia"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java", "diffHunk": "@@ -208,6 +215,22 @@ public void setLastStateModifiedDate(LocalDateTime lastStateModifiedDate) {\n         this.lastStateModifiedDate = lastStateModifiedDate;\n     }\n \n+    public Map<String, JsonNode> getSupplementaryData() {\n+        return supplementaryData;\n+    }\n+\n+    public void setSupplementaryData(Map<String, JsonNode> supplementaryData) {\n+        this.supplementaryData = supplementaryData;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "290950af7555176c6417b9e53e4d162e1bee76fe"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzODk0NDQw", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#pullrequestreview-433894440", "createdAt": "2020-06-19T08:23:38Z", "commit": {"oid": "290950af7555176c6417b9e53e4d162e1bee76fe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwODoyMzozOVrOGmMipw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwODoyMzozOVrOGmMipw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjcwNDU1MQ==", "bodyText": "can you push the file too please", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r442704551", "createdAt": "2020-06-19T08:23:39Z", "author": {"login": "mario-paniccia"}, "path": "src/main/resources/db/changelog/db.changelog-master.xml", "diffHunk": "@@ -32,4 +32,5 @@\n     <include file=\"db/changelog/db.changelog-RDM-6111.xml\"/>\n     <include file=\"db/changelog/db.changelog-RDM-4641.xml\"/>\n     <include file=\"db/changelog/db.changelog-RDM-8485.xml\"/>\n+    <include file=\"db/changelog/db.changelog-RDM-8747.xml\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "290950af7555176c6417b9e53e4d162e1bee76fe"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95a9061f27d9d059fab03aaba5b20704fe20b58e", "author": {"user": {"login": "Thor-tech-of-metal", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/95a9061f27d9d059fab03aaba5b20704fe20b58e", "committedDate": "2020-06-19T11:36:30Z", "message": "RDM-8747: New fields for supplementary data to CCD and ES case\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [RDM-8747] (https://tools.hmcts.net/jira/browse/RDM-8747).\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 New fields for supplementary data to CCD and ES case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1Njc3MzA3", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#pullrequestreview-435677307", "createdAt": "2020-06-23T11:10:35Z", "commit": {"oid": "95a9061f27d9d059fab03aaba5b20704fe20b58e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxMToxMDozNVrOGnkamA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxMToxMTowMlrOGnkbZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE0NDI4MA==", "bodyText": "src/main/java/uk/gov/hmcts/ccd/data/casedetails/CaseDetailsEntity.java will be removed from the PR", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r444144280", "createdAt": "2020-06-23T11:10:35Z", "author": {"login": "Thor-tech-of-metal"}, "path": "src/main/java/uk/gov/hmcts/ccd/data/casedetails/CaseDetailsEntity.java", "diffHunk": "@@ -1,31 +1,43 @@\n package uk.gov.hmcts.ccd.data.casedetails;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95a9061f27d9d059fab03aaba5b20704fe20b58e"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE0NDQ4NA==", "bodyText": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java  will be removed from the PR", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r444144484", "createdAt": "2020-06-23T11:11:02Z", "author": {"login": "Thor-tech-of-metal"}, "path": "src/main/java/uk/gov/hmcts/ccd/domain/model/definition/CaseDetails.java", "diffHunk": "@@ -30,7 +30,8 @@\n import static uk.gov.hmcts.ccd.domain.model.definition.FieldTypeDefinition.CASE_PAYMENT_HISTORY_VIEWER;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95a9061f27d9d059fab03aaba5b20704fe20b58e"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755", "author": {"user": {"login": "Thor-tech-of-metal", "name": null}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755", "committedDate": "2020-06-23T14:22:48Z", "message": "RDM-8747: New fields for supplementary data to CCD and ES case\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [RDM-8747] (https://tools.hmcts.net/jira/browse/RDM-8747).\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 New fields for supplementary data to CCD and ES case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDc3Nzcy", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#pullrequestreview-436477772", "createdAt": "2020-06-24T09:27:36Z", "commit": {"oid": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwOToyNzozNlrOGoKTiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwOToyNzozNlrOGoKTiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc2NTA2NQ==", "bodyText": "we have this as initially null?  and then will be gradually populated whenever supplementary data is written using the supplementary data update endpoint? Would this cause problems to the LS sql query? let's verify", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#discussion_r444765065", "createdAt": "2020-06-24T09:27:36Z", "author": {"login": "mario-paniccia"}, "path": "src/main/resources/db/changelog/db.changelog-RDM-8747.xml", "diffHunk": "@@ -0,0 +1,15 @@\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n+                   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+                   xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd\">\n+\n+    <changeSet id=\"rdm-8747\" author=\"tobias.derose@hmcts.net\">\n+        <addColumn tableName=\"case_data\">\n+            <column name=\"supplementary_data\" type=\"jsonb\">\n+                <constraints nullable=\"true\"/>\n+            </column>\n+            <column name=\"supplementary_data_last_modified\" type=\"timestamp\">\n+                <constraints />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NDk1MTY0", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#pullrequestreview-436495164", "createdAt": "2020-06-24T09:51:07Z", "commit": {"oid": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NTU3NjM2", "url": "https://github.com/hmcts/ccd-data-store-api/pull/984#pullrequestreview-436557636", "createdAt": "2020-06-24T11:27:32Z", "commit": {"oid": "86b2e870e0e3fe8ac7f612fa6339a8c2cbd64755"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3302ab2e87bbdc4667e8b6650a045ca79de87d3", "author": {"user": {"login": "Olawale", "name": "Olawale Olanrewaju"}}, "url": "https://github.com/hmcts/ccd-data-store-api/commit/b3302ab2e87bbdc4667e8b6650a045ca79de87d3", "committedDate": "2020-07-07T10:36:50Z", "message": "Merge branch 'develop' into RDM-8747"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2787, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}