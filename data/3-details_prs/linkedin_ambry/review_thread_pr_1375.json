{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyMTY3MzM0", "number": 1375, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNTo0MzoyNVrODfDb4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMjoyMDoxMFrODfZZzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzODg4NzM3OnYy", "diffSide": "RIGHT", "path": "ambry-api/src/main/java/com.github.ambry/network/NetworkRequest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNTo0MzoyNVrOFoiVlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNTo0MzoyNVrOFoiVlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA0OTk0MA==", "bodyText": "document return value", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378049940", "createdAt": "2020-02-12T05:43:25Z", "author": {"login": "cgtz"}, "path": "ambry-api/src/main/java/com.github.ambry/network/NetworkRequest.java", "diffHunk": "@@ -35,5 +35,7 @@\n   /**\n    * Release any resource this request is holding.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1029456f79fe963617cbb1e4bb553d4efacf26b9"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzODkwODE2OnYy", "diffSide": "RIGHT", "path": "ambry-api/src/main/java/com.github.ambry/network/BoundedNettyByteBufReceive.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNTo1Nzo0OFrOFoiicA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNTo1Nzo0OFrOFoiicA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA1MzIzMg==", "bodyText": "A DefaultByteBufHolder interface may help to reduce some of the duplicated code for the different impls of of ByteBufHolder. Something like:\ninterface DefaultByteBufHolder<T extends ByteBufHolder> extends ByteBufHolder {\n\n  @Override\n  T replace(ByteBuf content);\n\n  @Override\n  default T copy() {\n    return replace(content().copy());\n  }\n\n  // ...\n  \n  @Override\n  default int refCnt() {\n    return content().refCnt();\n  }\n  \n  // ...\n}", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378053232", "createdAt": "2020-02-12T05:57:48Z", "author": {"login": "cgtz"}, "path": "ambry-api/src/main/java/com.github.ambry/network/BoundedNettyByteBufReceive.java", "diffHunk": "@@ -100,31 +106,87 @@ public long readFrom(ReadableByteChannel channel) throws IOException {\n   }\n \n   /**\n-   * Returns the payload as {@link ByteBuf}, at the same time release the current reference to this payload.\n-   * It's not safe to call this function multiple times.\n+   * The total size in bytes that needs to receive from the channel\n+   * It will be initialized only after header is read.\n+   * @return the size of the data in bytes to receive after reading header, otherwise return 0\n+   */\n+  public long sizeRead() {\n+    return sizeRead;\n+  }\n+\n+  /**\n+   * Returns the byte buffer received.\n    * @return\n    */\n+  public ByteBuf content() {\n+    return buffer;\n+  }\n+\n   @Override\n-  public ByteBuf getAndRelease() {\n-    if (buffer == null) {\n-      return null;\n+  public BoundedNettyByteBufReceive copy() {\n+    return replace(content().copy());\n+  }\n+\n+  @Override\n+  public BoundedNettyByteBufReceive duplicate() {\n+    return replace(content().duplicate());\n+  }\n+\n+  @Override\n+  public BoundedNettyByteBufReceive retainedDuplicate() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1029456f79fe963617cbb1e4bb553d4efacf26b9"}, "originalPosition": 86}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjE2NjEwOnYy", "diffSide": "RIGHT", "path": "ambry-api/src/main/java/com.github.ambry/network/BoundedNettyByteBufReceive.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQyMzoxOTo0MlrOFpCC5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQyMzoxOTo0MlrOFpCC5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU2OTQ0NQ==", "bodyText": "variable receive is redundant.", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378569445", "createdAt": "2020-02-12T23:19:42Z", "author": {"login": "jsjtzyy"}, "path": "ambry-api/src/main/java/com.github.ambry/network/BoundedNettyByteBufReceive.java", "diffHunk": "@@ -99,32 +105,26 @@ public long readFrom(ReadableByteChannel channel) throws IOException {\n     return bytesRead;\n   }\n \n-  /**\n-   * Returns the payload as {@link ByteBuf}, at the same time release the current reference to this payload.\n-   * It's not safe to call this function multiple times.\n-   * @return\n-   */\n-  @Override\n-  public ByteBuf getAndRelease() {\n-    if (buffer == null) {\n-      return null;\n-    } else {\n-      try {\n-        return buffer.retainedDuplicate();\n-      } finally {\n-        buffer.release();\n-        buffer = null;\n-      }\n-    }\n-  }\n-\n   /**\n    * The total size in bytes that needs to receive from the channel\n    * It will be initialized only after header is read.\n    * @return the size of the data in bytes to receive after reading header, otherwise return 0\n    */\n-  @Override\n   public long sizeRead() {\n     return sizeRead;\n   }\n+\n+  /**\n+   * Returns the byte buffer received.\n+   * @return\n+   */\n+  public ByteBuf content() {\n+    return buffer;\n+  }\n+\n+  @Override\n+  public BoundedNettyByteBufReceive replace(ByteBuf content) {\n+    BoundedNettyByteBufReceive receive = new BoundedNettyByteBufReceive(content, sizeToRead);\n+    return receive;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 96}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjE5MjM4OnYy", "diffSide": "RIGHT", "path": "ambry-api/src/main/java/com.github.ambry/network/BoundedNettyByteBufReceive.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQyMzozMjo0OFrOFpCTFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQyMzozMjo0OFrOFpCTFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU3MzU5MQ==", "bodyText": "nit: complete the java doc", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378573591", "createdAt": "2020-02-12T23:32:48Z", "author": {"login": "jsjtzyy"}, "path": "ambry-api/src/main/java/com.github.ambry/network/BoundedNettyByteBufReceive.java", "diffHunk": "@@ -99,32 +105,26 @@ public long readFrom(ReadableByteChannel channel) throws IOException {\n     return bytesRead;\n   }\n \n-  /**\n-   * Returns the payload as {@link ByteBuf}, at the same time release the current reference to this payload.\n-   * It's not safe to call this function multiple times.\n-   * @return\n-   */\n-  @Override\n-  public ByteBuf getAndRelease() {\n-    if (buffer == null) {\n-      return null;\n-    } else {\n-      try {\n-        return buffer.retainedDuplicate();\n-      } finally {\n-        buffer.release();\n-        buffer = null;\n-      }\n-    }\n-  }\n-\n   /**\n    * The total size in bytes that needs to receive from the channel\n    * It will be initialized only after header is read.\n    * @return the size of the data in bytes to receive after reading header, otherwise return 0\n    */\n-  @Override\n   public long sizeRead() {\n     return sizeRead;\n   }\n+\n+  /**\n+   * Returns the byte buffer received.\n+   * @return", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 87}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjI5OTIxOnYy", "diffSide": "RIGHT", "path": "ambry-api/src/main/java/com.github.ambry/network/ResponseInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMDozMDoyMVrOFpDT9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMDozMDoyMVrOFpDT9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU5MDE5Ng==", "bodyText": "info is redundant", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378590196", "createdAt": "2020-02-13T00:30:21Z", "author": {"login": "jsjtzyy"}, "path": "ambry-api/src/main/java/com.github.ambry/network/ResponseInfo.java", "diffHunk": "@@ -99,7 +77,18 @@ public DataNodeId getDataNode() {\n \n   @Override\n   public String toString() {\n-    return \"ResponseInfo{\" + \"requestInfo=\" + requestInfo + \", error=\" + error + \", response=\" + response\n-        + \", dataNode=\" + dataNode + '}';\n+    return \"ResponseInfo{\" + \"requestInfo=\" + requestInfo + \", error=\" + error + \", response=\" + content + \", dataNode=\"\n+        + dataNode + '}';\n+  }\n+\n+  @Override\n+  public ByteBuf content() {\n+    return content;\n+  }\n+\n+  @Override\n+  public ResponseInfo replace(ByteBuf content) {\n+    ResponseInfo info = new ResponseInfo(requestInfo, error, content, dataNode);\n+    return info;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 105}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjMwMjE4OnYy", "diffSide": "RIGHT", "path": "ambry-api/src/main/java/com.github.ambry/network/ResponseInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMDozMTo0MVrOFpDVoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMDozMTo0MVrOFpDVoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU5MDYyNQ==", "bodyText": "minor: combine \"ResponseInfo{\" + \"requestInfo=\" to a single string", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378590625", "createdAt": "2020-02-13T00:31:41Z", "author": {"login": "jsjtzyy"}, "path": "ambry-api/src/main/java/com.github.ambry/network/ResponseInfo.java", "diffHunk": "@@ -99,7 +77,18 @@ public DataNodeId getDataNode() {\n \n   @Override\n   public String toString() {\n-    return \"ResponseInfo{\" + \"requestInfo=\" + requestInfo + \", error=\" + error + \", response=\" + response\n-        + \", dataNode=\" + dataNode + '}';\n+    return \"ResponseInfo{\" + \"requestInfo=\" + requestInfo + \", error=\" + error + \", response=\" + content + \", dataNode=\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 93}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjM1MzA5OnYy", "diffSide": "RIGHT", "path": "ambry-messageformat/src/main/java/com.github.ambry.messageformat/BlobData.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMDo1NTozOVrOFpDykw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMDo1NTozOVrOFpDykw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU5ODAzNQ==", "bodyText": "same here", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378598035", "createdAt": "2020-02-13T00:55:39Z", "author": {"login": "jsjtzyy"}, "path": "ambry-messageformat/src/main/java/com.github.ambry.messageformat/BlobData.java", "diffHunk": "@@ -68,40 +51,14 @@ public long getSize() {\n     return size;\n   }\n \n-  /**\n-   * @return the {@link ByteBufferInputStream} containing the blob content.\n-   */\n-  @Deprecated\n-  public ByteBufferInputStream getStream() {\n-    if (stream != null) {\n-      return stream;\n-    }\n-    // The blob content is passed as a ByteBuf since the stream is nulle\n-    if (byteBuf == null) {\n-      return null;\n-    }\n-    ByteBuffer temp = ByteBuffer.allocate(byteBuf.readableBytes());\n-    byteBuf.readBytes(temp);\n-    byteBuf.release();\n-    byteBuf = null;\n-    temp.flip();\n-    stream = new ByteBufferInputStream(temp);\n-    return stream;\n+  @Override\n+  public ByteBuf content() {\n+    return content;\n   }\n \n-  /**\n-   * Return the netty {@link ByteBuf} and then transfer the ownership to the caller. It's not safe\n-   * to call this method more than once.\n-   */\n-  public ByteBuf getAndRelease() {\n-    if (byteBuf == null) {\n-      return null;\n-    }\n-    try {\n-      return byteBuf.retainedDuplicate();\n-    } finally {\n-      byteBuf.release();\n-      byteBuf = null;\n-    }\n+  @Override\n+  public BlobData replace(ByteBuf content) {\n+    BlobData data = new BlobData(blobType, size, content);\n+    return data;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 97}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjQ3NjIwOnYy", "diffSide": "RIGHT", "path": "ambry-network/src/main/java/com.github.ambry.network/LocalRequestResponseChannel.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMjoxMzowMlrOFpE9qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMjoxMzowMlrOFpE9qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODYxNzI1OA==", "bodyText": "minor: update java doc", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378617258", "createdAt": "2020-02-13T02:13:02Z", "author": {"login": "jsjtzyy"}, "path": "ambry-network/src/main/java/com.github.ambry.network/LocalRequestResponseChannel.java", "diffHunk": "@@ -121,14 +122,13 @@ public void shutdown() {\n    * Utility to extract a byte buffer from a {@link Send} object, skipping the size header.\n    * @param payload the payload whose bytes we want.\n    */\n-  static ByteBuffer byteBufferFromPayload(Send payload) throws IOException {\n+  static ByteBuf byteBufFromPayload(Send payload) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjQ3ODY3OnYy", "diffSide": "RIGHT", "path": "ambry-network/src/main/java/com.github.ambry.network/SocketRequestResponseChannel.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMjoxNDozMlrOFpE_Ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMjoxNDozMlrOFpE_Ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODYxNzYzNA==", "bodyText": "same here", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378617634", "createdAt": "2020-02-13T02:14:32Z", "author": {"login": "jsjtzyy"}, "path": "ambry-network/src/main/java/com.github.ambry.network/SocketRequestResponseChannel.java", "diffHunk": "@@ -53,21 +54,24 @@ public long getStartTimeInMs() {\n     return startTimeInMs;\n   }\n \n-  @Override\n-  public void release() {\n-    if (buffer != null) {\n-      ReferenceCountUtil.release(buffer);\n-      buffer = null;\n-    }\n-  }\n-\n   public int getProcessor() {\n     return processor;\n   }\n \n   public String getConnectionId() {\n     return connectionId;\n   }\n+\n+  @Override\n+  public ByteBuf content() {\n+    return content;\n+  }\n+\n+  @Override\n+  public SocketServerRequest replace(ByteBuf content) {\n+    SocketServerRequest request = new SocketServerRequest(getProcessor(), getConnectionId(), content);\n+    return request;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjQ4MzMzOnYy", "diffSide": "RIGHT", "path": "ambry-network/src/main/java/com.github.ambry.network/SocketServer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMjoxNzo1N1rOFpFCFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjoyMjoxNVrOFpaZhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODYxODM4OQ==", "bodyText": "who is supposed to release the buffer?", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378618389", "createdAt": "2020-02-13T02:17:57Z", "author": {"login": "jsjtzyy"}, "path": "ambry-network/src/main/java/com.github.ambry.network/SocketServer.java", "diffHunk": "@@ -419,9 +420,8 @@ public void run() {\n         List<NetworkReceive> completedReceives = selector.completedReceives();\n         for (NetworkReceive networkReceive : completedReceives) {\n           String connectionId = networkReceive.getConnectionId();\n-          Object buffer = networkReceive.getReceivedBytes().getAndRelease();\n-          SocketServerRequest req = new SocketServerRequest(id, connectionId, buffer,\n-              Utils.createDataInputStreamFromBuffer(buffer, networkConfig.networkPutRequestShareMemory));\n+          ByteBuf buffer = networkReceive.getReceivedBytes().content();\n+          SocketServerRequest req = new SocketServerRequest(id, connectionId, buffer);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk2ODQ1Mw==", "bodyText": "in the RequestHandler, we have a for loop to get the request out and after dealing with the request, we release it.", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378968453", "createdAt": "2020-02-13T16:22:15Z", "author": {"login": "justinlin-linkedin"}, "path": "ambry-network/src/main/java/com.github.ambry.network/SocketServer.java", "diffHunk": "@@ -419,9 +420,8 @@ public void run() {\n         List<NetworkReceive> completedReceives = selector.completedReceives();\n         for (NetworkReceive networkReceive : completedReceives) {\n           String connectionId = networkReceive.getConnectionId();\n-          Object buffer = networkReceive.getReceivedBytes().getAndRelease();\n-          SocketServerRequest req = new SocketServerRequest(id, connectionId, buffer,\n-              Utils.createDataInputStreamFromBuffer(buffer, networkConfig.networkPutRequestShareMemory));\n+          ByteBuf buffer = networkReceive.getReceivedBytes().content();\n+          SocketServerRequest req = new SocketServerRequest(id, connectionId, buffer);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODYxODM4OQ=="}, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MjQ4NjU0OnYy", "diffSide": "RIGHT", "path": "ambry-network/src/test/java/com.github.ambry.network/SSLSelectorTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwMjoyMDoxMFrOFpFEIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNjoyMjoyN1rOFpaZ_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODYxODkxMw==", "bodyText": "did we release the payload?", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378618913", "createdAt": "2020-02-13T02:20:10Z", "author": {"login": "jsjtzyy"}, "path": "ambry-network/src/test/java/com.github.ambry.network/SSLSelectorTest.java", "diffHunk": "@@ -212,11 +212,10 @@ public void testNormalOperation() throws Exception {\n \n       // handle any responses we may have gotten\n       for (NetworkReceive receive : selector.completedReceives()) {\n-        ByteBuffer payload = (ByteBuffer) (receive.getReceivedBytes().getAndRelease());\n+        ByteBuf payload = receive.getReceivedBytes().content();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk2ODU3NQ==", "bodyText": "good catch. updated", "url": "https://github.com/linkedin/ambry/pull/1375#discussion_r378968575", "createdAt": "2020-02-13T16:22:27Z", "author": {"login": "justinlin-linkedin"}, "path": "ambry-network/src/test/java/com.github.ambry.network/SSLSelectorTest.java", "diffHunk": "@@ -212,11 +212,10 @@ public void testNormalOperation() throws Exception {\n \n       // handle any responses we may have gotten\n       for (NetworkReceive receive : selector.completedReceives()) {\n-        ByteBuffer payload = (ByteBuffer) (receive.getReceivedBytes().getAndRelease());\n+        ByteBuf payload = receive.getReceivedBytes().content();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODYxODkxMw=="}, "originalCommit": {"oid": "cb614f600cd5e1c26ab70b44b88493c7a68d6b41"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1691, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}