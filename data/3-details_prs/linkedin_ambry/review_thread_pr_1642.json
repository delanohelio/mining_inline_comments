{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MTQ1OTE3", "number": 1642, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMjoxNjowN1rOEp9k_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjo1NzoxM1rOEqZ2ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNDM1OTY3OnYy", "diffSide": "RIGHT", "path": "ambry-replication/src/main/java/com/github/ambry/replication/ReplicaThread.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMjoxNjowN1rOHb88Qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQyMjoxNjowN1rOHb88Qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTA3MjA2Ng==", "bodyText": "I was under the impression the stream way to collect to set is deep copy, so this should be ok (better to confirm it)", "url": "https://github.com/linkedin/ambry/pull/1642#discussion_r499072066", "createdAt": "2020-10-02T22:16:07Z", "author": {"login": "jsjtzyy"}, "path": "ambry-replication/src/main/java/com/github/ambry/replication/ReplicaThread.java", "diffHunk": "@@ -1629,7 +1630,7 @@ synchronized boolean isEmpty() {\n     }\n \n     /**\n-     *  get the keys corresponding to the missing messages in local store\n+     *  Get the keys corresponding to the missing messages in local store\n      */\n     Set<StoreKey> getMissingStoreKeys() {\n       return missingStoreMessages == null ? Collections.emptySet()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43c9b0478a4d73a9cda89b7283c888abe15a9131"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyODk5MjY3OnYy", "diffSide": "RIGHT", "path": "ambry-replication/src/main/java/com/github/ambry/replication/ReplicaThread.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjo1NzoxM1rOHclzVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNzoxMTo0N1rOHcmSGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MTUyNQ==", "bodyText": "Should this method be synchronized too? It seems like missingStoreMessages can be mutated and using a stream is just like iterating through it and subject to a ConcurrentModificationException.", "url": "https://github.com/linkedin/ambry/pull/1642#discussion_r499741525", "createdAt": "2020-10-05T16:57:13Z", "author": {"login": "cgtz"}, "path": "ambry-replication/src/main/java/com/github/ambry/replication/ReplicaThread.java", "diffHunk": "@@ -1629,7 +1630,7 @@ synchronized boolean isEmpty() {\n     }\n \n     /**\n-     *  get the keys corresponding to the missing messages in local store\n+     *  Get the keys corresponding to the missing messages in local store\n      */\n     Set<StoreKey> getMissingStoreKeys() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43c9b0478a4d73a9cda89b7283c888abe15a9131"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0OTQwMg==", "bodyText": "+1, good point.", "url": "https://github.com/linkedin/ambry/pull/1642#discussion_r499749402", "createdAt": "2020-10-05T17:11:47Z", "author": {"login": "jsjtzyy"}, "path": "ambry-replication/src/main/java/com/github/ambry/replication/ReplicaThread.java", "diffHunk": "@@ -1629,7 +1630,7 @@ synchronized boolean isEmpty() {\n     }\n \n     /**\n-     *  get the keys corresponding to the missing messages in local store\n+     *  Get the keys corresponding to the missing messages in local store\n      */\n     Set<StoreKey> getMissingStoreKeys() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MTUyNQ=="}, "originalCommit": {"oid": "43c9b0478a4d73a9cda89b7283c888abe15a9131"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1406, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}