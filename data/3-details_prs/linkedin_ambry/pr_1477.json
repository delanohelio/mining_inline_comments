{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0ODU2NTY1", "number": 1477, "title": "Use DelayedAutoRebalancer in Helix VCR cluster", "bodyText": "Add tool option to update existing resources", "createdAt": "2020-04-17T00:18:40Z", "url": "https://github.com/linkedin/ambry/pull/1477", "merged": true, "mergeCommit": {"oid": "e81244dac3d87107dda5110adf3c2fb7f7f7463a"}, "closed": true, "closedAt": "2020-04-28T02:12:49Z", "author": {"login": "lightningrob"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYV-Y6gH2gAyNDA0ODU2NTY1OmRhNThmNDZkYzkxMTI4ZWFhNTZkNmIzODg0NDU0YWQ1OWUyN2U5NTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcb6OsjgFqTQwMTQ1MDM5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "da58f46dc91128eaa56d6b3884454ad59e27e959", "author": {"user": {"login": "shipkit-org", "name": "shipkit.org automated bot"}}, "url": "https://github.com/linkedin/ambry/commit/da58f46dc91128eaa56d6b3884454ad59e27e959", "committedDate": "2020-04-17T00:16:25Z", "message": "Use DelayedAutoRebalancer in Helix VCR cluster\nAdd tool option to update existing resources"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NjM2OTQ5", "url": "https://github.com/linkedin/ambry/pull/1477#pullrequestreview-396636949", "createdAt": "2020-04-20T16:53:13Z", "commit": {"oid": "da58f46dc91128eaa56d6b3884454ad59e27e959"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMzE5MzEx", "url": "https://github.com/linkedin/ambry/pull/1477#pullrequestreview-401319311", "createdAt": "2020-04-27T20:55:52Z", "commit": {"oid": "da58f46dc91128eaa56d6b3884454ad59e27e959"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QyMDo1NTo1MlrOGM3TNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QyMDo1NTo1MlrOGM3TNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0MjEzMg==", "bodyText": "I am a little confused about this comment because I see resource ideal state is updated in the following lines.", "url": "https://github.com/linkedin/ambry/pull/1477#discussion_r416142132", "createdAt": "2020-04-27T20:55:52Z", "author": {"login": "jsjtzyy"}, "path": "ambry-tools/src/main/java/com/github/ambry/clustermap/HelixVcrPopulateTool.java", "diffHunk": "@@ -92,11 +101,26 @@ public static void main(String[] args) {\n     }\n \n     if (options.has(updateClusterOpt)) {\n-      String srcZkString = options.valueOf(srcOpt).split(SEPARATOR)[0];\n-      String srcClusterName = options.valueOf(srcOpt).split(SEPARATOR)[1];\n-      System.out.println(\"Updating cluster: \" + destClusterName + \"by checking \" + srcClusterName);\n       boolean dryRun = options.has(dryRunOpt);\n-      updateResourceAndPartition(srcZkString, srcClusterName, destZkString, destClusterName, dryRun);\n+      if (options.has(srcOpt)) {\n+        String[] srcZkAndCluster = options.valueOf(srcOpt).split(SEPARATOR);\n+        if (srcZkAndCluster.length != 2) {\n+          errorAndExit(\"src argument must have form 'zkString/clusterName'\");\n+        }\n+        String srcZkString = srcZkAndCluster[0];\n+        String srcClusterName = srcZkAndCluster[1];\n+        System.out.println(\"Updating cluster: \" + destClusterName + \"by checking \" + srcClusterName);\n+        updateResourceAndPartition(srcZkString, srcClusterName, destZkString, destClusterName, dryRun);\n+      } else {\n+        // Just update cluster config, not resources", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da58f46dc91128eaa56d6b3884454ad59e27e959"}, "originalPosition": 83}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c53ba3debc4d918436ede42dae9c9276147f6dc", "author": {"user": {"login": "shipkit-org", "name": "shipkit.org automated bot"}}, "url": "https://github.com/linkedin/ambry/commit/7c53ba3debc4d918436ede42dae9c9276147f6dc", "committedDate": "2020-04-28T00:03:33Z", "message": "Remove confusing comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNDUwMzk3", "url": "https://github.com/linkedin/ambry/pull/1477#pullrequestreview-401450397", "createdAt": "2020-04-28T02:12:35Z", "commit": {"oid": "7c53ba3debc4d918436ede42dae9c9276147f6dc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1402, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}