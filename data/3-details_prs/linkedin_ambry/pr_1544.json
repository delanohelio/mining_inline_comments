{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2MTI3Njc4", "number": 1544, "title": "Minor improvement for Helix bootstrap tool", "bodyText": "ensure there is a dry-run option for bootstrapping/upgrading Helix.\nuse isClusterSetup() instead of getClusters() to avoid expensive validation.", "createdAt": "2020-06-01T17:53:33Z", "url": "https://github.com/linkedin/ambry/pull/1544", "merged": true, "mergeCommit": {"oid": "9f639d4fb7fed0127040580d746a9f22ce6d79db"}, "closed": true, "closedAt": "2020-06-08T20:30:30Z", "author": {"login": "jsjtzyy"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnD_FegH2gAyNDI2MTI3Njc4OmE2YTFhNmEyZDU5YjBkNjJhZTE0NWIwOWYxY2MxODc0NWZhNjI5OGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoYqNsgH2gAyNDI2MTI3Njc4OjM1OGY2ZDIwYTUxNWRhODM3ZGFlMTVjZmNlMmVhNjZhZDViOWQwMTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a6a1a6a2d59b0d62ae145b09f1cc18745fa6298e", "author": {"user": {"login": "jsjtzyy", "name": "Yingyi Zhang"}}, "url": "https://github.com/linkedin/ambry/commit/a6a1a6a2d59b0d62ae145b09f1cc18745fa6298e", "committedDate": "2020-06-01T17:47:45Z", "message": "Minor improvement for Helix bootstrap tool\n\n1. ensure there is a dry-run option for bootstrapping/upgrading Helix.\n2. use isClusterSetup() instead of getClusters() to avoid expensive validation."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNDgwOTc3", "url": "https://github.com/linkedin/ambry/pull/1544#pullrequestreview-422480977", "createdAt": "2020-06-02T09:02:09Z", "commit": {"oid": "a6a1a6a2d59b0d62ae145b09f1cc18745fa6298e"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwOTowMjowOVrOGdooCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwOTowODo0MVrOGdo3mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzcyNzQ5OA==", "bodyText": "Minor: formating, info(\"[{}] Instance {} already present in Helix...\",", "url": "https://github.com/linkedin/ambry/pull/1544#discussion_r433727498", "createdAt": "2020-06-02T09:02:09Z", "author": {"login": "xuhao417347761"}, "path": "ambry-clustermap/src/main/java/com/github/ambry/clustermap/HelixBootstrapUpgradeUtil.java", "diffHunk": "@@ -863,22 +877,30 @@ private void addUpdateInstances(String dcName, Map<String, Set<String>> partitio\n             // the appropriate instanceConfig that is constructed with the correct values from both).\n             // For now, only bootstrapping cluster is allowed to directly change InstanceConfig\n             dcAdmin.setInstanceConfig(clusterName, instanceName, instanceConfigFromStatic);\n+          } else {\n+            info(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a6a1a6a2d59b0d62ae145b09f1cc18745fa6298e"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzczMTQ4Mg==", "bodyText": "The ZNRecordSerializer, HelixZkClient and ZKHelixAdmin are deprecated. Maybe add a to-do to update in the future?", "url": "https://github.com/linkedin/ambry/pull/1544#discussion_r433731482", "createdAt": "2020-06-02T09:08:41Z", "author": {"login": "xuhao417347761"}, "path": "ambry-clustermap/src/main/java/com/github/ambry/clustermap/HelixBootstrapUpgradeUtil.java", "diffHunk": "@@ -464,8 +465,21 @@ private HelixBootstrapUpgradeUtil(String hardwareLayoutPath, String partitionLay\n         throw new IllegalArgumentException(\n             entry.getKey() + \" has invalid number of ZK endpoints: \" + zkConnectStrs.size());\n       }\n-      HelixAdmin admin = helixAdminFactory.getHelixAdmin(zkConnectStrs.get(0));\n+      HelixAdmin admin;\n+      RealmAwareZkClient zkClient = null;\n+      if (helixAdminFactory == null) {\n+        RealmAwareZkClient.RealmAwareZkClientConfig clientConfig =\n+            new RealmAwareZkClient.RealmAwareZkClientConfig().setConnectInitTimeout(30 * 1000L)\n+                .setZkSerializer(new ZNRecordSerializer());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a6a1a6a2d59b0d62ae145b09f1cc18745fa6298e"}, "originalPosition": 133}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ee556b0441955260d42ae44c0010cc3b20557d2", "author": {"user": {"login": "jsjtzyy", "name": "Yingyi Zhang"}}, "url": "https://github.com/linkedin/ambry/commit/6ee556b0441955260d42ae44c0010cc3b20557d2", "committedDate": "2020-06-03T05:24:01Z", "message": "comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2f5e4183bd85771ccf61ff8b08c43bc73ba6773", "author": {"user": {"login": "jsjtzyy", "name": "Yingyi Zhang"}}, "url": "https://github.com/linkedin/ambry/commit/c2f5e4183bd85771ccf61ff8b08c43bc73ba6773", "committedDate": "2020-06-05T17:21:17Z", "message": "minor change for VCR populate tool"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NDg1OTk0", "url": "https://github.com/linkedin/ambry/pull/1544#pullrequestreview-425485994", "createdAt": "2020-06-05T17:23:53Z", "commit": {"oid": "c2f5e4183bd85771ccf61ff8b08c43bc73ba6773"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNzoyMzo1M1rOGf27jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQxNzoyMzo1M1rOGf27jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjA1OTAyMw==", "bodyText": "@ankagrawal this minor change should help us get rid of the warning messages we saw when building a new VCR cluster.", "url": "https://github.com/linkedin/ambry/pull/1544#discussion_r436059023", "createdAt": "2020-06-05T17:23:53Z", "author": {"login": "jsjtzyy"}, "path": "ambry-tools/src/main/java/com/github/ambry/clustermap/HelixVcrPopulateTool.java", "diffHunk": "@@ -145,7 +146,7 @@ public static void main(String[] args) {\n   static void createCluster(String destZkString, String destClusterName) {\n     HelixZkClient destZkClient = getHelixZkClient(destZkString);\n     HelixAdmin destAdmin = new ZKHelixAdmin(destZkClient);\n-    if (destAdmin.getClusters().contains(destClusterName)) {\n+    if (ZKUtil.isClusterSetup(destClusterName, destZkClient)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2f5e4183bd85771ccf61ff8b08c43bc73ba6773"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b499939ab0b24447541ccd3f4f957632a3b72f18", "author": {"user": {"login": "jsjtzyy", "name": "Yingyi Zhang"}}, "url": "https://github.com/linkedin/ambry/commit/b499939ab0b24447541ccd3f4f957632a3b72f18", "committedDate": "2020-06-05T17:44:53Z", "message": "minor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "358f6d20a515da837dae15cfce2ea66ad5b9d015", "author": {"user": {"login": "jsjtzyy", "name": "Yingyi Zhang"}}, "url": "https://github.com/linkedin/ambry/commit/358f6d20a515da837dae15cfce2ea66ad5b9d015", "committedDate": "2020-06-05T20:26:53Z", "message": "minor comment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1087, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}