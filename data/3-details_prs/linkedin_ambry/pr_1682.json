{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MzUzMTY2", "number": 1682, "title": "[BlobStoreCompaction] Add metric to record the duplicate puts", "bodyText": "Add a metric to record the duplicate error now we are ignoring it.", "createdAt": "2020-11-02T21:58:31Z", "url": "https://github.com/linkedin/ambry/pull/1682", "merged": true, "mergeCommit": {"oid": "9d05494a62019e9b758f7fbcdebf252badbc8a49"}, "closed": true, "closedAt": "2020-11-04T23:37:46Z", "author": {"login": "justinlin-linkedin"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZCFUtAFqTUyMjk1NTExOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZWe7TAFqTUyMzgxMzg0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyOTU1MTE5", "url": "https://github.com/linkedin/ambry/pull/1682#pullrequestreview-522955119", "createdAt": "2020-11-03T23:50:09Z", "commit": {"oid": "ca2ef13cb64319ac2eb40d7bae5e53645fec298c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzo1MDowOVrOHtEgDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMzo1MDowOVrOHtEgDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAyMTcwOQ==", "bodyText": "nit: maybe following is more readable:\nif ( recoveryStartToken == null || !recoveryStartToken.getOffset().equals(indexSegmentStartOffset))", "url": "https://github.com/linkedin/ambry/pull/1682#discussion_r517021709", "createdAt": "2020-11-03T23:50:09Z", "author": {"login": "jsjtzyy"}, "path": "ambry-store/src/main/java/com/github/ambry/store/BlobStoreCompactor.java", "diffHunk": "@@ -631,6 +639,10 @@ private boolean isDuplicate(IndexEntry copyCandidate, FileSpan duplicateSearchSp\n         logger.trace(\"{} in segment with start offset {} in {} is a duplicate because it has already been copied\",\n             copyCandidate, indexSegmentStartOffset, storeId);\n         isDuplicate = true;\n+        if (!(recoveryStartToken != null && recoveryStartToken.getOffset().equals(indexSegmentStartOffset))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca2ef13cb64319ac2eb40d7bae5e53645fec298c"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyOTY3ODcy", "url": "https://github.com/linkedin/ambry/pull/1682#pullrequestreview-522967872", "createdAt": "2020-11-04T00:29:12Z", "commit": {"oid": "ca2ef13cb64319ac2eb40d7bae5e53645fec298c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d09fbe06ff61c8cc9e14be084de3d40bbed553cf", "author": {"user": {"login": "justinlin-linkedin", "name": "Justin Lin"}}, "url": "https://github.com/linkedin/ambry/commit/d09fbe06ff61c8cc9e14be084de3d40bbed553cf", "committedDate": "2020-11-04T19:20:33Z", "message": "[BlobStoreCompaction] Add metric to record the duplicate puts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ed261e45358eb6763b967a0ee92dab39ece122d", "author": {"user": {"login": "justinlin-linkedin", "name": "Justin Lin"}}, "url": "https://github.com/linkedin/ambry/commit/8ed261e45358eb6763b967a0ee92dab39ece122d", "committedDate": "2020-11-04T21:55:47Z", "message": "Address comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca2ef13cb64319ac2eb40d7bae5e53645fec298c", "author": {"user": {"login": "justinlin-linkedin", "name": "Justin Lin"}}, "url": "https://github.com/linkedin/ambry/commit/ca2ef13cb64319ac2eb40d7bae5e53645fec298c", "committedDate": "2020-11-02T21:56:52Z", "message": "[BlobStoreCompaction] Add metric to record the duplicate puts"}, "afterCommit": {"oid": "8ed261e45358eb6763b967a0ee92dab39ece122d", "author": {"user": {"login": "justinlin-linkedin", "name": "Justin Lin"}}, "url": "https://github.com/linkedin/ambry/commit/8ed261e45358eb6763b967a0ee92dab39ece122d", "committedDate": "2020-11-04T21:55:47Z", "message": "Address comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzODEzODQ2", "url": "https://github.com/linkedin/ambry/pull/1682#pullrequestreview-523813846", "createdAt": "2020-11-04T23:37:02Z", "commit": {"oid": "8ed261e45358eb6763b967a0ee92dab39ece122d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 978, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}