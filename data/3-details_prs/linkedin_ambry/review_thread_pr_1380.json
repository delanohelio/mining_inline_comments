{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMzY4MTI3", "number": 1380, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QwMDozOTo0NFrODiHWSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QwMDo0NDo1OVrODiHW_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDk4NTcwOnYy", "diffSide": "RIGHT", "path": "ambry-cloud/src/main/java/com.github.ambry.cloud/azure/AzureBlobDataAccessor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QwMDozOTo0NFrOFtNmYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QwMDozOTo0NFrOFtNmYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk1MzA1OQ==", "bodyText": "log exception?", "url": "https://github.com/linkedin/ambry/pull/1380#discussion_r382953059", "createdAt": "2020-02-23T00:39:44Z", "author": {"login": "cgtz"}, "path": "ambry-cloud/src/main/java/com.github.ambry.cloud/azure/AzureBlobDataAccessor.java", "diffHunk": "@@ -295,7 +301,13 @@ public boolean updateBlobMetadata(BlobId blobId, String fieldName, Object value)\n         String textValue = String.valueOf(value);\n         if (!textValue.equals(metadata.get(fieldName))) {\n           metadata.put(fieldName, textValue);\n-          // Set condition to ensure we don't clobber another update\n+          if (updateCallback != null) {\n+            try {\n+              updateCallback.call();\n+            } catch (Exception ex) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c36f8fed8487d4b1bca059cb87476c3a996566c"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDk4Njc4OnYy", "diffSide": "RIGHT", "path": "ambry-cloud/src/main/java/com.github.ambry.cloud/azure/AzureBlobDataAccessor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QwMDo0MjozMlrOFtNm5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QwMDo0MjozMlrOFtNm5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk1MzE5MA==", "bodyText": "use generics in both the member variable and method arg. If the return type of call doesn't matter, you can use Callable<?> in both places.", "url": "https://github.com/linkedin/ambry/pull/1380#discussion_r382953190", "createdAt": "2020-02-23T00:42:32Z", "author": {"login": "cgtz"}, "path": "ambry-cloud/src/main/java/com.github.ambry.cloud/azure/AzureBlobDataAccessor.java", "diffHunk": "@@ -120,6 +121,11 @@\n     this.purgeBatchSize = AzureCloudConfig.DEFAULT_PURGE_BATCH_SIZE;\n   }\n \n+  /** Visible for testing */\n+  void setUpdateCallback(Callable callback) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c36f8fed8487d4b1bca059cb87476c3a996566c"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDk4NzQ4OnYy", "diffSide": "RIGHT", "path": "ambry-cloud/src/main/java/com.github.ambry.cloud/azure/CosmosDataAccessor.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QwMDo0NDo1OVrOFtNnNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QwMDo0NDo1OVrOFtNnNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk1MzI2OA==", "bodyText": "same comments for CosmosDataAccessor as AzureBlobDataAccessor.", "url": "https://github.com/linkedin/ambry/pull/1380#discussion_r382953268", "createdAt": "2020-02-23T00:44:59Z", "author": {"login": "cgtz"}, "path": "ambry-cloud/src/main/java/com.github.ambry.cloud/azure/CosmosDataAccessor.java", "diffHunk": "@@ -58,6 +61,11 @@\n     this.azureMetrics = azureMetrics;\n   }\n \n+  /** Visible for testing */\n+  void setUpdateCallback(Callable callback) {\n+    this.updateCallback = callback;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c36f8fed8487d4b1bca059cb87476c3a996566c"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1703, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}