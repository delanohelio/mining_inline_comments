{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0MzAwMjQz", "number": 1662, "title": "Fix CompositeByteBuf memory leak and test failure in RouterServerSSLTest", "bodyText": "This PR\n\nFix a the compositeByteBuf leak in GetResponse.\nIncrease the timeout to 50 second and try to fix the test failure (at least mitigate) in #1636\nAdd code change ignored by #1656", "createdAt": "2020-10-15T18:36:16Z", "url": "https://github.com/linkedin/ambry/pull/1662", "merged": true, "mergeCommit": {"oid": "474b8c5cda3fe5baa28489787d8d7bf813d09999"}, "closed": true, "closedAt": "2020-10-15T23:29:37Z", "author": {"login": "justinlin-linkedin"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdS2JtWgH2gAyNTA0MzAwMjQzOjFjYWRkY2I5NDUxM2Q4Mjk1NTBkYjAwMGYxZDVhMDIxN2VkMWE2NTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdS6UemAFqTUwOTg3NDkwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1caddcb94513d829550db000f1d5a0217ed1a659", "author": {"user": {"login": "justinlin-linkedin", "name": "Justin Lin"}}, "url": "https://github.com/linkedin/ambry/commit/1caddcb94513d829550db000f1d5a0217ed1a659", "committedDate": "2020-10-15T18:33:21Z", "message": "Fix CompositeByteBuf memory leak and test failure in RouterServerSSLTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NjY5OTU1", "url": "https://github.com/linkedin/ambry/pull/1662#pullrequestreview-509669955", "createdAt": "2020-10-15T18:44:29Z", "commit": {"oid": "1caddcb94513d829550db000f1d5a0217ed1a659"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0NDozMFrOHiVYcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxODo0NDozMFrOHiVYcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc2Mzk1NA==", "bodyText": "why do CompositeByteBufs have to be treated differently here as opposed to just calling addComponent(true, content)?\nIs there a reason not to nest CompositeByteBufs?", "url": "https://github.com/linkedin/ambry/pull/1662#discussion_r505763954", "createdAt": "2020-10-15T18:44:30Z", "author": {"login": "cgtz"}, "path": "ambry-protocol/src/main/java/com/github/ambry/protocol/CompositeSend.java", "diffHunk": "@@ -71,8 +71,9 @@ public CompositeSend(List<Send> compositeSendList) {\n             if (content instanceof CompositeByteBuf) {\n               Iterator<ByteBuf> iterator = ((CompositeByteBuf) content).iterator();\n               while (iterator.hasNext()) {\n-                ((CompositeByteBuf) compositeSendContent).addComponent(true, iterator.next());\n+                ((CompositeByteBuf) compositeSendContent).addComponent(true, iterator.next().retain());\n               }\n+              content.release();\n             } else {\n               ((CompositeByteBuf) compositeSendContent).addComponent(true, content);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1caddcb94513d829550db000f1d5a0217ed1a659"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5Njc3NjIy", "url": "https://github.com/linkedin/ambry/pull/1662#pullrequestreview-509677622", "createdAt": "2020-10-15T18:54:57Z", "commit": {"oid": "1caddcb94513d829550db000f1d5a0217ed1a659"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "644eb4ebaaba6904ec52985be0a89f299cdaa0b8", "author": {"user": {"login": "justinlin-linkedin", "name": "Justin Lin"}}, "url": "https://github.com/linkedin/ambry/commit/644eb4ebaaba6904ec52985be0a89f299cdaa0b8", "committedDate": "2020-10-15T20:40:36Z", "message": "Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cd9ce56ad15a6844ccd66f6e16b4cc8d6bc6f88", "author": {"user": {"login": "justinlin-linkedin", "name": "Justin Lin"}}, "url": "https://github.com/linkedin/ambry/commit/5cd9ce56ad15a6844ccd66f6e16b4cc8d6bc6f88", "committedDate": "2020-10-15T21:17:13Z", "message": "Fix typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5ODc0OTA4", "url": "https://github.com/linkedin/ambry/pull/1662#pullrequestreview-509874908", "createdAt": "2020-10-15T23:24:44Z", "commit": {"oid": "5cd9ce56ad15a6844ccd66f6e16b4cc8d6bc6f88"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 946, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}