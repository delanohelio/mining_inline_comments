{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwMTgyNzMz", "number": 1523, "title": "Adding a new metrics to track delayed close for netty channels.", "bodyText": "adding another metric for tracking to make sure all the sheduled delayed close gets expired and the callbacks are called.\nModified the UT as well.", "createdAt": "2020-05-19T15:08:46Z", "url": "https://github.com/linkedin/ambry/pull/1523", "merged": true, "mergeCommit": {"oid": "090bc42eeae142d78d0bde2310b4b7559ec44c1e"}, "closed": true, "closedAt": "2020-05-20T21:28:19Z", "author": {"login": "ssen-li"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceZxb3AH2gAyNDIwMTgyNzMzOjI3NmFhNjcxMzNhMzNmOGI2YmVlMmIyNmY2OGVhY2IxYzMxY2QxYTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjNc_oAH2gAyNDIwMTgyNzMzOjc5NjdjZjc2M2MyM2RhMDUzOWJjZTE1ZDAwMjY1YTBiOGJkNWE3MDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "276aa67133a33f8b6bee2b26f68eacb1c31cd1a9", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/276aa67133a33f8b6bee2b26f68eacb1c31cd1a9", "committedDate": "2020-05-05T20:05:26Z", "message": "Introducing a delay in closing the netty channel when a POST request fails due to any reason.\nAdding a config to enable this behaviour. By default this is disabled.\nAlso adding a metric to keep a count of such delayed close event.\nFix for some existing UT and and new UT to test the new code flow."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a54e259a79c65a0ec53bf4b55dce9e043d5c4af", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/5a54e259a79c65a0ec53bf4b55dce9e043d5c4af", "committedDate": "2020-05-05T20:39:35Z", "message": "Merge branch 'master' into ambry6804"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c875af4d0596d18c05bbc138cd066ba5629a957c", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/c875af4d0596d18c05bbc138cd066ba5629a957c", "committedDate": "2020-05-06T05:43:18Z", "message": "rename the variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "327a6a95372c56d28332cab88809db267ae5feb2", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/327a6a95372c56d28332cab88809db267ae5feb2", "committedDate": "2020-05-06T05:50:42Z", "message": "removing the sleep"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00dc8e661333eba2c64213f1c79d176ecbf9d135", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/00dc8e661333eba2c64213f1c79d176ecbf9d135", "committedDate": "2020-05-06T15:33:25Z", "message": "adding another metrics to keep track of delayed close execution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d98df91792d8d343b7f3fe58964f4c8e66c0b09f", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/d98df91792d8d343b7f3fe58964f4c8e66c0b09f", "committedDate": "2020-05-06T18:55:14Z", "message": "Merge branch 'master' of github.com:linkedin/ambry into ambry6804"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e732dca1afd644576825f18dd54e49b919d97615", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/e732dca1afd644576825f18dd54e49b919d97615", "committedDate": "2020-05-06T20:27:26Z", "message": "addressing the review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d83cf4dfca4c72af7b1b5a072cf5b7f87df6250c", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/d83cf4dfca4c72af7b1b5a072cf5b7f87df6250c", "committedDate": "2020-05-09T05:44:26Z", "message": "enhancing the UT to test the channel close after the delay.:wq"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a08fda5d0b77d61d1aaf82927ec9bcd8fa0eb119", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/a08fda5d0b77d61d1aaf82927ec9bcd8fa0eb119", "committedDate": "2020-05-11T17:10:53Z", "message": "addressing more review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "965ead714fafbce74babb5728f1ece72ce6f5891", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/965ead714fafbce74babb5728f1ece72ce6f5891", "committedDate": "2020-05-19T04:08:41Z", "message": "Merge branch 'master' into ambry6804"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de34b4c156636e8b7654598bee96bda147a28c87", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/de34b4c156636e8b7654598bee96bda147a28c87", "committedDate": "2020-05-19T15:02:26Z", "message": "adding another metric for tracking to make sure all the sheduled\ndelayed close gets expired and the callbacks are called."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aee0e135f7161e8bb8f7c4c28257d84878c29705", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/aee0e135f7161e8bb8f7c4c28257d84878c29705", "committedDate": "2020-05-19T15:11:08Z", "message": "minor string change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NTkzNTM0", "url": "https://github.com/linkedin/ambry/pull/1523#pullrequestreview-414593534", "createdAt": "2020-05-19T15:57:34Z", "commit": {"oid": "aee0e135f7161e8bb8f7c4c28257d84878c29705"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NTkyODUx", "url": "https://github.com/linkedin/ambry/pull/1523#pullrequestreview-415592851", "createdAt": "2020-05-20T18:12:35Z", "commit": {"oid": "aee0e135f7161e8bb8f7c4c28257d84878c29705"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxODoxMjozNlrOGYX9Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxODoxMjozNlrOGYX9Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIxMTUwMw==", "bodyText": "Nit: nothing has really expired here.  Suggest renaming this delayedCloseActivatedCount or delayedCloseTriggerCount.", "url": "https://github.com/linkedin/ambry/pull/1523#discussion_r428211503", "createdAt": "2020-05-20T18:12:36Z", "author": {"login": "lightningrob"}, "path": "ambry-rest/src/main/java/com/github/ambry/rest/NettyResponseChannel.java", "diffHunk": "@@ -123,6 +123,7 @@\n     public void operationComplete(ChannelFuture future) {\n       logger.trace(\"scheduling closure of channel {}\", future.channel());\n       future.channel().eventLoop().schedule(() -> {\n+        nettyMetrics.delayedCloseExpiredCount.inc();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aee0e135f7161e8bb8f7c4c28257d84878c29705"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7967cf763c23da0539bce15d00265a0b8bd5a706", "author": {"user": {"login": "ssen-li", "name": "Subhadeep Sen"}}, "url": "https://github.com/linkedin/ambry/commit/7967cf763c23da0539bce15d00265a0b8bd5a706", "committedDate": "2020-05-20T18:33:52Z", "message": "renaming the metrics as suggested"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1497, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}