{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MTcwMTI2", "number": 50, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMzowNTo0OVrODotkSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMjoyMzoxNFrODqWpXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MDE2MjAwOnYy", "diffSide": "RIGHT", "path": "src/test/java/com/artipie/http/rq/MpTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMzowNTo0OVrOF3bUCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMzowNTo0OVrOF3bUCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY2MzQ5OQ==", "bodyText": "@Sammers21 You can supress web variable here, it is just used once.", "url": "https://github.com/artipie/http/pull/50#discussion_r393663499", "createdAt": "2020-03-17T13:05:49Z", "author": {"login": "paulodamaso"}, "path": "src/test/java/com/artipie/http/rq/MpTest.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.http.rq;\n+\n+import com.artipie.http.Slice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.vertx.VertxSliceServer;\n+import io.reactivex.Flowable;\n+import io.vertx.reactivex.core.Vertx;\n+import io.vertx.reactivex.ext.web.client.WebClient;\n+import io.vertx.reactivex.ext.web.multipart.MultipartForm;\n+import java.io.IOException;\n+import java.net.ServerSocket;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.HashSet;\n+import java.util.concurrent.CompletableFuture;\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.io.TempDir;\n+\n+/**\n+ * Multipart parser test.\n+ * @todo #32:60min Enable this test.\n+ *  In order to ensure that multipart parser works correctly we wrote a test for it. For now, it\n+ *  is disabled, but, later, we will enable it.\n+ * @since 0.4\n+ */\n+@SuppressWarnings(\"PMD.AvoidDuplicateLiterals\")\n+public class MpTest {\n+\n+    /**\n+     * The localhost.\n+     */\n+    private static final String LOCALHOST = \"localhost\";\n+\n+    @Test\n+    @Disabled\n+    public void ableToParseBasic(@TempDir final Path dir) throws IOException {\n+        final Vertx vertx = Vertx.vertx();\n+        final Slice slice = (line, headers, body) -> connection -> {\n+            final int zero = 0;\n+            final Mp mpp = new Mp(headers);\n+            body.subscribe(mpp);\n+            Flowable.fromPublisher(mpp).subscribe();\n+            connection.accept(\n+                RsStatus.OK,\n+                new HashSet<>(zero),\n+                Flowable.empty()\n+            );\n+            return CompletableFuture.completedFuture(null);\n+        };\n+        final int port = this.rndPort();\n+        final VertxSliceServer server = new VertxSliceServer(vertx, slice, port);\n+        server.start();\n+        final Path resolve = dir.resolve(\"text.txt\");\n+        Files.write(resolve, \"Hello worrrrld!!!\".getBytes());\n+        final WebClient web = WebClient.create(vertx);\n+        web.post(port, MpTest.LOCALHOST, \"/hello\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c6543d0621afb18573d17230e65d6ceabc41ad1"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MDIxOTM2OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/artipie/http/rq/MpTest.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMzoyMDo1MVrOF3b5FA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNTo0MTo1NFrOF40chQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY3Mjk4MA==", "bodyText": "@Sammers21 This test doesn't look complete; you should test somehow if the multipart form is correctly parsed, not just execute it and expect that no error is thrown. Also, I think that we don't need a puzzle just for enabling those tests; we could add this information in the puzzles related to finishing Mp implementation", "url": "https://github.com/artipie/http/pull/50#discussion_r393672980", "createdAt": "2020-03-17T13:20:51Z", "author": {"login": "paulodamaso"}, "path": "src/test/java/com/artipie/http/rq/MpTest.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.http.rq;\n+\n+import com.artipie.http.Slice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.vertx.VertxSliceServer;\n+import io.reactivex.Flowable;\n+import io.vertx.reactivex.core.Vertx;\n+import io.vertx.reactivex.ext.web.client.WebClient;\n+import io.vertx.reactivex.ext.web.multipart.MultipartForm;\n+import java.io.IOException;\n+import java.net.ServerSocket;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.HashSet;\n+import java.util.concurrent.CompletableFuture;\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.io.TempDir;\n+\n+/**\n+ * Multipart parser test.\n+ * @todo #32:60min Enable this test.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c6543d0621afb18573d17230e65d6ceabc41ad1"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTAyODA2MA==", "bodyText": "@paulodamaso , looks reasonable", "url": "https://github.com/artipie/http/pull/50#discussion_r395028060", "createdAt": "2020-03-19T13:34:54Z", "author": {"login": "Sammers21"}, "path": "src/test/java/com/artipie/http/rq/MpTest.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.http.rq;\n+\n+import com.artipie.http.Slice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.vertx.VertxSliceServer;\n+import io.reactivex.Flowable;\n+import io.vertx.reactivex.core.Vertx;\n+import io.vertx.reactivex.ext.web.client.WebClient;\n+import io.vertx.reactivex.ext.web.multipart.MultipartForm;\n+import java.io.IOException;\n+import java.net.ServerSocket;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.HashSet;\n+import java.util.concurrent.CompletableFuture;\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.io.TempDir;\n+\n+/**\n+ * Multipart parser test.\n+ * @todo #32:60min Enable this test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY3Mjk4MA=="}, "originalCommit": {"oid": "0c6543d0621afb18573d17230e65d6ceabc41ad1"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTAzMTY1OA==", "bodyText": "@paulodamaso , done", "url": "https://github.com/artipie/http/pull/50#discussion_r395031658", "createdAt": "2020-03-19T13:40:20Z", "author": {"login": "Sammers21"}, "path": "src/test/java/com/artipie/http/rq/MpTest.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.http.rq;\n+\n+import com.artipie.http.Slice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.vertx.VertxSliceServer;\n+import io.reactivex.Flowable;\n+import io.vertx.reactivex.core.Vertx;\n+import io.vertx.reactivex.ext.web.client.WebClient;\n+import io.vertx.reactivex.ext.web.multipart.MultipartForm;\n+import java.io.IOException;\n+import java.net.ServerSocket;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.HashSet;\n+import java.util.concurrent.CompletableFuture;\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.io.TempDir;\n+\n+/**\n+ * Multipart parser test.\n+ * @todo #32:60min Enable this test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY3Mjk4MA=="}, "originalCommit": {"oid": "0c6543d0621afb18573d17230e65d6ceabc41ad1"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTEyMzg0NQ==", "bodyText": "@Sammers21 I still don't see where the tests assure that the Multipart parser works correctly; you should test it by providing a set of known values to Multipart and checking the generated output.", "url": "https://github.com/artipie/http/pull/50#discussion_r395123845", "createdAt": "2020-03-19T15:41:54Z", "author": {"login": "paulodamaso"}, "path": "src/test/java/com/artipie/http/rq/MpTest.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.http.rq;\n+\n+import com.artipie.http.Slice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.vertx.VertxSliceServer;\n+import io.reactivex.Flowable;\n+import io.vertx.reactivex.core.Vertx;\n+import io.vertx.reactivex.ext.web.client.WebClient;\n+import io.vertx.reactivex.ext.web.multipart.MultipartForm;\n+import java.io.IOException;\n+import java.net.ServerSocket;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.HashSet;\n+import java.util.concurrent.CompletableFuture;\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.io.TempDir;\n+\n+/**\n+ * Multipart parser test.\n+ * @todo #32:60min Enable this test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY3Mjk4MA=="}, "originalCommit": {"oid": "0c6543d0621afb18573d17230e65d6ceabc41ad1"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MDIzODc1OnYy", "diffSide": "RIGHT", "path": "src/main/java/com/artipie/http/rq/Mp.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMzoyNToyNlrOF3cFVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMzozNDoxMVrOF4ukkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY3NjExNw==", "bodyText": "@Sammers21 You could call this class Multipart, I think that it becomes clearer to the reader", "url": "https://github.com/artipie/http/pull/50#discussion_r393676117", "createdAt": "2020-03-17T13:25:26Z", "author": {"login": "paulodamaso"}, "path": "src/main/java/com/artipie/http/rq/Mp.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.rq;\n+\n+import java.nio.ByteBuffer;\n+import java.util.Map;\n+import java.util.function.Supplier;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import java.util.stream.StreamSupport;\n+import org.reactivestreams.Processor;\n+import org.reactivestreams.Subscriber;\n+import org.reactivestreams.Subscription;\n+\n+/**\n+ * A multipart parser. Parses a Flow of Bytes into a flow of Multiparts\n+ * See\n+ * <a href=\"https://www.w3.org/Protocols/rfc1341/7_2_Multipart.html\">rfc1341</a>\n+ * spec.\n+ * @todo #32:120min Implement Publisher part.\n+ *  Subscribe is a part of publisher contract. Parts are emmited in a way, similar to stream parser,\n+ *  but with an attention to headers.\n+ * @todo #32:120min Implement Subscriber part.\n+ *  On subscribe is called when upstream wants to propagate elements to us. We should take it and\n+ *  use it.\n+ * @since 0.4\n+ * @checkstyle ConstantUsageCheck (500 lines)\n+ */\n+@SuppressWarnings({\"PMD.AvoidDuplicateLiterals\", \"PMD.UnusedPrivateField\", \"PMD.SingularField\"})\n+public final class Mp implements Processor<ByteBuffer, Part> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c6543d0621afb18573d17230e65d6ceabc41ad1"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTAyNzYwMg==", "bodyText": "@paulodamaso , agree", "url": "https://github.com/artipie/http/pull/50#discussion_r395027602", "createdAt": "2020-03-19T13:34:11Z", "author": {"login": "Sammers21"}, "path": "src/main/java/com/artipie/http/rq/Mp.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.rq;\n+\n+import java.nio.ByteBuffer;\n+import java.util.Map;\n+import java.util.function.Supplier;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import java.util.stream.StreamSupport;\n+import org.reactivestreams.Processor;\n+import org.reactivestreams.Subscriber;\n+import org.reactivestreams.Subscription;\n+\n+/**\n+ * A multipart parser. Parses a Flow of Bytes into a flow of Multiparts\n+ * See\n+ * <a href=\"https://www.w3.org/Protocols/rfc1341/7_2_Multipart.html\">rfc1341</a>\n+ * spec.\n+ * @todo #32:120min Implement Publisher part.\n+ *  Subscribe is a part of publisher contract. Parts are emmited in a way, similar to stream parser,\n+ *  but with an attention to headers.\n+ * @todo #32:120min Implement Subscriber part.\n+ *  On subscribe is called when upstream wants to propagate elements to us. We should take it and\n+ *  use it.\n+ * @since 0.4\n+ * @checkstyle ConstantUsageCheck (500 lines)\n+ */\n+@SuppressWarnings({\"PMD.AvoidDuplicateLiterals\", \"PMD.UnusedPrivateField\", \"PMD.SingularField\"})\n+public final class Mp implements Processor<ByteBuffer, Part> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY3NjExNw=="}, "originalCommit": {"oid": "0c6543d0621afb18573d17230e65d6ceabc41ad1"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzM3ODIyOnYy", "diffSide": "RIGHT", "path": "src/test/java/com/artipie/http/rq/MultipartTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMjoyMzoxNFrOF6DAmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMjo1NjowNVrOF6EHzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQxMTAzMw==", "bodyText": "@Sammers21 Great, could you please just inline sliceand port into server variable instantiation?", "url": "https://github.com/artipie/http/pull/50#discussion_r396411033", "createdAt": "2020-03-23T12:23:14Z", "author": {"login": "paulodamaso"}, "path": "src/test/java/com/artipie/http/rq/MultipartTest.java", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.http.rq;\n+\n+import com.artipie.http.Slice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.http.stream.ByteFlowAsString;\n+import com.artipie.vertx.VertxSliceServer;\n+import io.reactivex.Flowable;\n+import io.vertx.reactivex.core.Vertx;\n+import io.vertx.reactivex.ext.web.client.WebClient;\n+import io.vertx.reactivex.ext.web.multipart.MultipartForm;\n+import java.io.IOException;\n+import java.net.ServerSocket;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.HashSet;\n+import java.util.concurrent.CompletableFuture;\n+import org.hamcrest.MatcherAssert;\n+import org.hamcrest.core.IsEqual;\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.io.TempDir;\n+\n+/**\n+ * Multipart parser test.\n+ * @since 0.4\n+ */\n+@SuppressWarnings(\"PMD.AvoidDuplicateLiterals\")\n+public class MultipartTest {\n+\n+    /**\n+     * The localhost.\n+     */\n+    private static final String LOCALHOST = \"localhost\";\n+\n+    @Test\n+    @Disabled\n+    public void ableToParseBasic(@TempDir final Path dir) throws IOException {\n+        final Vertx vertx = Vertx.vertx();\n+        final Slice slice = (line, headers, body) -> connection -> {\n+            final int zero = 0;\n+            final Multipart mpp = new Multipart(headers);\n+            body.subscribe(mpp);\n+            MatcherAssert.assertThat(\n+                new ByteFlowAsString(Flowable.fromPublisher(mpp).flatMap(part -> part)).value(),\n+                new IsEqual<>(\"Hello worrrrld!!!Hello worrrrld!!!\")\n+            );\n+            connection.accept(\n+                RsStatus.OK,\n+                new HashSet<>(zero),\n+                Flowable.empty()\n+            );\n+            return CompletableFuture.completedFuture(null);\n+        };\n+        final int port = this.rndPort();\n+        final VertxSliceServer server = new VertxSliceServer(vertx, slice, port);\n+        server.start();\n+        final Path resolve = dir.resolve(\"text.txt\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7854831b1520a3d6a2988c35efe60b0075068ef4"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQyOTI2MQ==", "bodyText": "@paulodamaso , port can't be inlined", "url": "https://github.com/artipie/http/pull/50#discussion_r396429261", "createdAt": "2020-03-23T12:56:05Z", "author": {"login": "Sammers21"}, "path": "src/test/java/com/artipie/http/rq/MultipartTest.java", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+package com.artipie.http.rq;\n+\n+import com.artipie.http.Slice;\n+import com.artipie.http.rs.RsStatus;\n+import com.artipie.http.stream.ByteFlowAsString;\n+import com.artipie.vertx.VertxSliceServer;\n+import io.reactivex.Flowable;\n+import io.vertx.reactivex.core.Vertx;\n+import io.vertx.reactivex.ext.web.client.WebClient;\n+import io.vertx.reactivex.ext.web.multipart.MultipartForm;\n+import java.io.IOException;\n+import java.net.ServerSocket;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.HashSet;\n+import java.util.concurrent.CompletableFuture;\n+import org.hamcrest.MatcherAssert;\n+import org.hamcrest.core.IsEqual;\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.io.TempDir;\n+\n+/**\n+ * Multipart parser test.\n+ * @since 0.4\n+ */\n+@SuppressWarnings(\"PMD.AvoidDuplicateLiterals\")\n+public class MultipartTest {\n+\n+    /**\n+     * The localhost.\n+     */\n+    private static final String LOCALHOST = \"localhost\";\n+\n+    @Test\n+    @Disabled\n+    public void ableToParseBasic(@TempDir final Path dir) throws IOException {\n+        final Vertx vertx = Vertx.vertx();\n+        final Slice slice = (line, headers, body) -> connection -> {\n+            final int zero = 0;\n+            final Multipart mpp = new Multipart(headers);\n+            body.subscribe(mpp);\n+            MatcherAssert.assertThat(\n+                new ByteFlowAsString(Flowable.fromPublisher(mpp).flatMap(part -> part)).value(),\n+                new IsEqual<>(\"Hello worrrrld!!!Hello worrrrld!!!\")\n+            );\n+            connection.accept(\n+                RsStatus.OK,\n+                new HashSet<>(zero),\n+                Flowable.empty()\n+            );\n+            return CompletableFuture.completedFuture(null);\n+        };\n+        final int port = this.rndPort();\n+        final VertxSliceServer server = new VertxSliceServer(vertx, slice, port);\n+        server.start();\n+        final Path resolve = dir.resolve(\"text.txt\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQxMTAzMw=="}, "originalCommit": {"oid": "7854831b1520a3d6a2988c35efe60b0075068ef4"}, "originalPosition": 80}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1961, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}