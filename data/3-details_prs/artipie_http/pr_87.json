{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNDI5Mjkx", "number": 87, "title": "#86 - Mark & reset buffers in RsHasBody", "bodyText": "Closes issue #86\nAdded mark() and reset() calls to RsHasBody, so buffers remain unchanged after matching", "createdAt": "2020-03-18T13:16:07Z", "url": "https://github.com/artipie/http/pull/87", "merged": true, "mergeCommit": {"oid": "e9382e7d2221479ec14b23b4d052417f92ca497e"}, "closed": true, "closedAt": "2020-03-23T12:07:39Z", "author": {"login": "olegmoz"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcO3NZZAH2gAyMzkwNDI5MjkxOmY2Y2EwMTNmNmRhMjViYzZjNTgyMjhlMTE4MDYzMTgwNjMzZTVmOTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPKCDDAFqTM3NzYyNTI2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f6ca013f6da25bc6c58228e118063180633e5f94", "author": {"user": {"login": "olegmoz", "name": "Oleg Mozzhechkov"}}, "url": "https://github.com/artipie/http/commit/f6ca013f6da25bc6c58228e118063180633e5f94", "committedDate": "2020-03-18T13:20:26Z", "message": "#86 - Mark & reset buffers in RsHasBody"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3cf5bd7cbdb428685e400ac537ad57a2fea8f2df", "author": {"user": {"login": "olegmoz", "name": "Oleg Mozzhechkov"}}, "url": "https://github.com/artipie/http/commit/3cf5bd7cbdb428685e400ac537ad57a2fea8f2df", "committedDate": "2020-03-18T13:14:32Z", "message": "#86 - Mark & reset buffers in RsHasBody"}, "afterCommit": {"oid": "f6ca013f6da25bc6c58228e118063180633e5f94", "author": {"user": {"login": "olegmoz", "name": "Oleg Mozzhechkov"}}, "url": "https://github.com/artipie/http/commit/f6ca013f6da25bc6c58228e118063180633e5f94", "committedDate": "2020-03-18T13:20:26Z", "message": "#86 - Mark & reset buffers in RsHasBody"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MTk5MzI3", "url": "https://github.com/artipie/http/pull/87#pullrequestreview-377199327", "createdAt": "2020-03-18T20:10:54Z", "commit": {"oid": "f6ca013f6da25bc6c58228e118063180633e5f94"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMDoxMDo1NFrOF4VIig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMDoxMjo1NlrOF4VMrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDYxMDgyNg==", "bodyText": "@olegmoz we can instantiate RsHasBody only once", "url": "https://github.com/artipie/http/pull/87#discussion_r394610826", "createdAt": "2020-03-18T20:10:54Z", "author": {"login": "Vatavuk"}, "path": "src/test/java/com/artipie/http/hm/RsHasBodyTest.java", "diffHunk": "@@ -71,4 +76,23 @@ void shouldNotMatchNotEqualBody() {\n         );\n     }\n \n+    @ParameterizedTest\n+    @ValueSource(strings = {\"data\", \"chunk1,chunk2\"})\n+    void shouldMatchResponseTwice(final String chunks) {\n+        final String[] elements = chunks.split(\",\");\n+        final byte[] data = String.join(\"\", elements).getBytes();\n+        final Response response = new RsWithBody(\n+            Flowable.fromIterable(\n+                Stream.of(elements)\n+                    .map(String::getBytes)\n+                    .map(ByteBuffer::wrap)\n+                    .collect(Collectors.toList())\n+            )\n+        );\n+        new RsHasBody(data).matches(response);\n+        MatcherAssert.assertThat(\n+            new RsHasBody(data).matches(response),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6ca013f6da25bc6c58228e118063180633e5f94"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDYxMTg4Ng==", "bodyText": "@olegmoz why do we need this magic? Can we instantiate elements variable in the test method without annotations?", "url": "https://github.com/artipie/http/pull/87#discussion_r394611886", "createdAt": "2020-03-18T20:12:56Z", "author": {"login": "Vatavuk"}, "path": "src/test/java/com/artipie/http/hm/RsHasBodyTest.java", "diffHunk": "@@ -71,4 +76,23 @@ void shouldNotMatchNotEqualBody() {\n         );\n     }\n \n+    @ParameterizedTest\n+    @ValueSource(strings = {\"data\", \"chunk1,chunk2\"})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6ca013f6da25bc6c58228e118063180633e5f94"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NjI1MjY5", "url": "https://github.com/artipie/http/pull/87#pullrequestreview-377625269", "createdAt": "2020-03-19T11:16:14Z", "commit": {"oid": "f6ca013f6da25bc6c58228e118063180633e5f94"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3140, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}