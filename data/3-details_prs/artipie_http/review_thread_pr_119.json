{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0MTYyNjY0", "number": 119, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNjo1NTowMVrODyyTsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNzozNTozM1rODyzAOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NTc5NjMzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/artipie/http/rq/RequestLineFrom.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNjo1NTowMVrOGHCBrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNjo1NTowMVrOGHCBrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNjQxMw==", "bodyText": "@olenagerasimova this doesn't have to be a static variable, we can hardcode 3 in the part method", "url": "https://github.com/artipie/http/pull/119#discussion_r410026413", "createdAt": "2020-04-17T06:55:01Z", "author": {"login": "Vatavuk"}, "path": "src/main/java/com/artipie/http/rq/RequestLineFrom.java", "diffHunk": "@@ -43,6 +43,12 @@\n  */\n public final class RequestLineFrom {\n \n+    /**\n+     * Valid HTTP request line must contains 3 parts which can be splitted by\n+     * whitespace char.\n+     */\n+    private static final int PARTS_AMOUNT = 3;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ceb748f9bc0e9a7d82d07277f9123189c73762b"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NTc5ODk3OnYy", "diffSide": "RIGHT", "path": "src/test/java/com/artipie/http/rq/RequestLineFromTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNjo1NjowNFrOGHCDZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNjo1NjowNFrOGHCDZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAyNjg1Mw==", "bodyText": "@olenagerasimova let's create one test with 4 parts in http line", "url": "https://github.com/artipie/http/pull/119#discussion_r410026853", "createdAt": "2020-04-17T06:56:04Z", "author": {"login": "Vatavuk"}, "path": "src/test/java/com/artipie/http/rq/RequestLineFromTest.java", "diffHunk": "@@ -39,42 +41,68 @@\n  */\n public final class RequestLineFromTest {\n     @Test\n-    void parsesMethodName() throws Exception {\n+    void parsesMethodName() {\n         MatcherAssert.assertThat(\n             new RequestLineFrom(\"TRACE /foo HTTP/1.1\\r\\n\").method(),\n             Matchers.equalTo(RqMethod.TRACE)\n         );\n     }\n \n     @Test\n-    void parsesAsteriskUri() throws Exception {\n+    void parsesAsteriskUri() {\n         MatcherAssert.assertThat(\n             new RequestLineFrom(\"GET * HTTP/1.1\\r\\n\").uri(),\n             Matchers.equalTo(URI.create(\"*\"))\n         );\n     }\n \n     @Test\n-    void parsesAbsoluteUri() throws Exception {\n+    void parsesAbsoluteUri() {\n         MatcherAssert.assertThat(\n             new RequestLineFrom(\"GET http://www.w3.org/pub/WWW/TheProject.html HTTP/1.1\\r\\n\").uri(),\n             Matchers.equalTo(URI.create(\"http://www.w3.org/pub/WWW/TheProject.html\"))\n         );\n     }\n \n     @Test\n-    void parsesAbsolutePath() throws Exception {\n+    void parsesAbsolutePath() {\n         MatcherAssert.assertThat(\n             new RequestLineFrom(\"GET /pub/WWW/TheProject.html HTTP/1.1\\r\\n\").uri(),\n             Matchers.equalTo(URI.create(\"/pub/WWW/TheProject.html\"))\n         );\n     }\n \n     @Test\n-    void parsesHttpVersion() throws Exception {\n+    void parsesHttpVersion() {\n         MatcherAssert.assertThat(\n             new RequestLineFrom(\"PUT * HTTP/1.1\\r\\n\").version(),\n             Matchers.equalTo(\"HTTP/1.1\")\n         );\n     }\n+\n+    @Test\n+    void throwsExceptionIfMethodIsUnknown() {\n+        final String method = \"SURRENDER\";\n+        MatcherAssert.assertThat(\n+            Assertions.assertThrows(\n+                IllegalStateException.class,\n+                () -> new RequestLineFrom(\n+                    String.format(\"%s /wallet/or/life HTTP/1.1\\n\", method)\n+                ).method()\n+            ).getMessage(),\n+            new IsEqual<>(String.format(\"Unknown method: '%s'\", method))\n+        );\n+    }\n+\n+    @Test\n+    void throwsExceptionIfLineIsInvalid() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ceb748f9bc0e9a7d82d07277f9123189c73762b"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NTkxMDMzOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/artipie/http/rq/RequestLineFrom.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNzozNTozM1rOGHDJBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwODoyNDoyOVrOGHEqUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA0NDY3Nw==", "bodyText": "@olenagerasimova I believe its a bit more easier to digest parts.length == 3 than having a separate variable.", "url": "https://github.com/artipie/http/pull/119#discussion_r410044677", "createdAt": "2020-04-17T07:35:33Z", "author": {"login": "Vatavuk"}, "path": "src/main/java/com/artipie/http/rq/RequestLineFrom.java", "diffHunk": "@@ -99,8 +93,9 @@ public String version() {\n      * @return Part string\n      */\n     private String part(final int idx) {\n+        final int pcount = 3;\n         final String[] parts = this.line.trim().split(\"\\\\s\");\n-        if (parts.length == RequestLineFrom.PARTS_AMOUNT) {\n+        if (parts.length == pcount) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f524c06c7523f2ba9f9284b1535493db52217903"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA1MjgxNA==", "bodyText": "@Vatavuk it's a magic number, that's why I initially extracted in into constant: unlike variables constants are properly documented with the answer to the questions \"where the hell did this number come from\"...", "url": "https://github.com/artipie/http/pull/119#discussion_r410052814", "createdAt": "2020-04-17T07:52:11Z", "author": {"login": "olenagerasimova"}, "path": "src/main/java/com/artipie/http/rq/RequestLineFrom.java", "diffHunk": "@@ -99,8 +93,9 @@ public String version() {\n      * @return Part string\n      */\n     private String part(final int idx) {\n+        final int pcount = 3;\n         final String[] parts = this.line.trim().split(\"\\\\s\");\n-        if (parts.length == RequestLineFrom.PARTS_AMOUNT) {\n+        if (parts.length == pcount) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA0NDY3Nw=="}, "originalCommit": {"oid": "f524c06c7523f2ba9f9284b1535493db52217903"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA2OTU4NA==", "bodyText": "@olenagerasimova ok let's then expand the description for part method explaining that http line must contain 3 parts.", "url": "https://github.com/artipie/http/pull/119#discussion_r410069584", "createdAt": "2020-04-17T08:24:29Z", "author": {"login": "Vatavuk"}, "path": "src/main/java/com/artipie/http/rq/RequestLineFrom.java", "diffHunk": "@@ -99,8 +93,9 @@ public String version() {\n      * @return Part string\n      */\n     private String part(final int idx) {\n+        final int pcount = 3;\n         final String[] parts = this.line.trim().split(\"\\\\s\");\n-        if (parts.length == RequestLineFrom.PARTS_AMOUNT) {\n+        if (parts.length == pcount) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA0NDY3Nw=="}, "originalCommit": {"oid": "f524c06c7523f2ba9f9284b1535493db52217903"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1832, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}