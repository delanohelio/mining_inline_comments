{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMTQ4NjI0", "number": 145, "title": "deps: upgrade gax to 1.53.0", "bodyText": "", "createdAt": "2020-01-09T20:40:19Z", "url": "https://github.com/googleapis/java-bigtable/pull/145", "merged": true, "mergeCommit": {"oid": "c3fc40df4358bd68cddcfc6f0a3fedb74dcdf465"}, "closed": true, "closedAt": "2020-01-09T21:32:52Z", "author": {"login": "kolea2"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4wI7agH2gAyMzYxMTQ4NjI0OmU2Njc0ZWYwMThmZTE3MGExN2JmODQ5YzQ5OTJjODRkZDhiY2Q4NDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4wz6ZAH2gAyMzYxMTQ4NjI0OjY1YTE1ZTIyN2JiOTZmN2I4OTJiYjYyNTNkMjNkNWNkNTU1ZDVhMzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e6674ef018fe170a17bf849c4992c84dd8bcd840", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/googleapis/java-bigtable/commit/e6674ef018fe170a17bf849c4992c84dd8bcd840", "committedDate": "2020-01-09T20:39:53Z", "message": "deps: upgrade gax to 1.53.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab3059038b0be4ac189de26a2937fe4b58ae1ebe", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/googleapis/java-bigtable/commit/ab3059038b0be4ac189de26a2937fe4b58ae1ebe", "committedDate": "2020-01-09T21:05:17Z", "message": "fix compile failures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5693e6e6438b9308aa9f793e6ca12e77c3366d9c", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/googleapis/java-bigtable/commit/5693e6e6438b9308aa9f793e6ca12e77c3366d9c", "committedDate": "2020-01-09T21:06:42Z", "message": "rename parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea5371624cf7e16df1187252b119b6225b537528", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/googleapis/java-bigtable/commit/ea5371624cf7e16df1187252b119b6225b537528", "committedDate": "2020-01-09T21:10:16Z", "message": "rename test variables"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwODE2MTM2", "url": "https://github.com/googleapis/java-bigtable/pull/145#pullrequestreview-340816136", "createdAt": "2020-01-09T21:10:34Z", "commit": {"oid": "5693e6e6438b9308aa9f793e6ca12e77c3366d9c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMToxMDozNFrOFcDdQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMToxNTozM1rOFcDk3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MTA4OQ==", "bodyText": "lets rename batch to entries", "url": "https://github.com/googleapis/java-bigtable/pull/145#discussion_r364961089", "createdAt": "2020-01-09T21:10:34Z", "author": {"login": "igorbernstein2"}, "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/data/v2/stub/mutaterows/MutateRowsBatchingDescriptor.java", "diffHunk": "@@ -45,9 +46,9 @@\n   }\n \n   @Override\n-  public void splitResponse(Void response, List<SettableApiFuture<Void>> batch) {\n-    for (SettableApiFuture<Void> batchResponse : batch) {\n-      batchResponse.set(null);\n+  public void splitResponse(Void response, List<BatchEntry<RowMutationEntry, Void>> batch) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5693e6e6438b9308aa9f793e6ca12e77c3366d9c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MTEyOA==", "bodyText": "lets rename batch to entries", "url": "https://github.com/googleapis/java-bigtable/pull/145#discussion_r364961128", "createdAt": "2020-01-09T21:10:42Z", "author": {"login": "igorbernstein2"}, "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/data/v2/stub/mutaterows/MutateRowsBatchingDescriptor.java", "diffHunk": "@@ -58,10 +59,10 @@ public void splitResponse(Void response, List<SettableApiFuture<Void>> batch) {\n    * entries whose index is mentioned {@link MutateRowsException#getFailedMutations()}.\n    */\n   @Override\n-  public void splitException(Throwable throwable, List<SettableApiFuture<Void>> batch) {\n+  public void splitException(Throwable throwable, List<BatchEntry<RowMutationEntry, Void>> batch) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5693e6e6438b9308aa9f793e6ca12e77c3366d9c"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MTc4NA==", "bodyText": "The mutaterows descriptor shouldn't accept nulls, the check is missing, but lets keep the test correct:\nList<BatchEntry<RowMutationEntry, Void>> entries =\n        ImmutableList.of(\n            BatchEntry.create(\n                RowMutationEntry.create(\"key1\").deleteRow(), SettableApiFuture.<Void>create()),\n            BatchEntry.create(\n                RowMutationEntry.create(\"key2\").deleteRow(), SettableApiFuture.<Void>create()));", "url": "https://github.com/googleapis/java-bigtable/pull/145#discussion_r364961784", "createdAt": "2020-01-09T21:12:18Z", "author": {"login": "igorbernstein2"}, "path": "google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/data/v2/stub/mutaterows/MutateRowsBatchingDescriptorTest.java", "diffHunk": "@@ -77,29 +78,35 @@ public void requestBuilderTest() {\n \n   @Test\n   public void splitResponseTest() {\n-    List<SettableApiFuture<Void>> batchResponse =\n-        ImmutableList.of(SettableApiFuture.<Void>create(), SettableApiFuture.<Void>create());\n-    assertThat(batchResponse.get(0).isDone()).isFalse();\n-    assertThat(batchResponse.get(1).isDone()).isFalse();\n+    BatchEntry<RowMutationEntry, Void> resultFuture1 = BatchEntry.create(null, SettableApiFuture.<Void>create());\n+    BatchEntry<RowMutationEntry, Void> resultFuture2 = BatchEntry.create(null, SettableApiFuture.<Void>create());\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5693e6e6438b9308aa9f793e6ca12e77c3366d9c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MjM2MA==", "bodyText": "same as above:\nList<BatchEntry<RowMutationEntry, Void>> batchResponses =\n        ImmutableList.of(\n            BatchEntry.create(\n                RowMutationEntry.create(\"key1\").deleteRow(), SettableApiFuture.<Void>create()),\n            BatchEntry.create(\n                RowMutationEntry.create(\"key2\").deleteRow(), SettableApiFuture.<Void>create()));", "url": "https://github.com/googleapis/java-bigtable/pull/145#discussion_r364962360", "createdAt": "2020-01-09T21:13:55Z", "author": {"login": "igorbernstein2"}, "path": "google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/data/v2/stub/mutaterows/MutateRowsBatchingDescriptorTest.java", "diffHunk": "@@ -77,29 +78,35 @@ public void requestBuilderTest() {\n \n   @Test\n   public void splitResponseTest() {\n-    List<SettableApiFuture<Void>> batchResponse =\n-        ImmutableList.of(SettableApiFuture.<Void>create(), SettableApiFuture.<Void>create());\n-    assertThat(batchResponse.get(0).isDone()).isFalse();\n-    assertThat(batchResponse.get(1).isDone()).isFalse();\n+    BatchEntry<RowMutationEntry, Void> resultFuture1 = BatchEntry.create(null, SettableApiFuture.<Void>create());\n+    BatchEntry<RowMutationEntry, Void> resultFuture2 = BatchEntry.create(null, SettableApiFuture.<Void>create());\n+\n+    List<BatchEntry<RowMutationEntry, Void>> batchResponse =\n+        ImmutableList.of(resultFuture1, resultFuture2);\n+    assertThat(batchResponse.get(0).getResultFuture().isDone()).isFalse();\n+    assertThat(batchResponse.get(1).getResultFuture().isDone()).isFalse();\n \n     MutateRowsBatchingDescriptor underTest = new MutateRowsBatchingDescriptor();\n     underTest.splitResponse(null, batchResponse);\n-    assertThat(batchResponse.get(0).isDone()).isTrue();\n-    assertThat(batchResponse.get(1).isDone()).isTrue();\n+    assertThat(batchResponse.get(0).getResultFuture().isDone()).isTrue();\n+    assertThat(batchResponse.get(1).getResultFuture().isDone()).isTrue();\n   }\n \n   @Test\n   public void splitExceptionTest() {\n+    BatchEntry<RowMutationEntry, Void> resultFuture1 = BatchEntry.create(null, SettableApiFuture.<Void>create());\n+    BatchEntry<RowMutationEntry, Void> resultFuture2 = BatchEntry.create(null, SettableApiFuture.<Void>create());\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5693e6e6438b9308aa9f793e6ca12e77c3366d9c"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2MzAzOQ==", "bodyText": "similar to above, don't use null", "url": "https://github.com/googleapis/java-bigtable/pull/145#discussion_r364963039", "createdAt": "2020-01-09T21:15:33Z", "author": {"login": "igorbernstein2"}, "path": "google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/data/v2/stub/mutaterows/MutateRowsBatchingDescriptorTest.java", "diffHunk": "@@ -110,9 +117,9 @@ public void splitExceptionTest() {\n   public void splitExceptionWithFailedMutationsTest() {\n     MutateRowsBatchingDescriptor underTest = new MutateRowsBatchingDescriptor();\n     Throwable actualThrowable = null;\n-    SettableApiFuture<Void> resultFuture1 = SettableApiFuture.create();\n-    SettableApiFuture<Void> resultFuture2 = SettableApiFuture.create();\n-    SettableApiFuture<Void> resultFuture3 = SettableApiFuture.create();\n+    BatchEntry<RowMutationEntry, Void> resultFuture1 = BatchEntry.create(null, SettableApiFuture.<Void>create());\n+    BatchEntry<RowMutationEntry, Void> resultFuture2 = BatchEntry.create(null, SettableApiFuture.<Void>create());\n+    BatchEntry<RowMutationEntry, Void> resultFuture3 = BatchEntry.create(null, SettableApiFuture.<Void>create());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5693e6e6438b9308aa9f793e6ca12e77c3366d9c"}, "originalPosition": 63}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d5e153c2b4be0b1fb999c971fd6131991788825", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/googleapis/java-bigtable/commit/8d5e153c2b4be0b1fb999c971fd6131991788825", "committedDate": "2020-01-09T21:19:16Z", "message": "review feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwODIzNjc3", "url": "https://github.com/googleapis/java-bigtable/pull/145#pullrequestreview-340823677", "createdAt": "2020-01-09T21:24:34Z", "commit": {"oid": "8d5e153c2b4be0b1fb999c971fd6131991788825"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMToyNDozNFrOFcDyyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMToyNDo1MlrOFcDzKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2NjYwMQ==", "bodyText": "s/future/entry", "url": "https://github.com/googleapis/java-bigtable/pull/145#discussion_r364966601", "createdAt": "2020-01-09T21:24:34Z", "author": {"login": "igorbernstein2"}, "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/data/v2/stub/mutaterows/MutateRowsBatchingDescriptor.java", "diffHunk": "@@ -58,10 +58,11 @@ public void splitResponse(Void response, List<SettableApiFuture<Void>> batch) {\n    * entries whose index is mentioned {@link MutateRowsException#getFailedMutations()}.\n    */\n   @Override\n-  public void splitException(Throwable throwable, List<SettableApiFuture<Void>> batch) {\n+  public void splitException(\n+      Throwable throwable, List<BatchEntry<RowMutationEntry, Void>> entries) {\n     if (!(throwable instanceof MutateRowsException)) {\n-      for (SettableApiFuture<Void> future : batch) {\n-        future.setException(throwable);\n+      for (BatchEntry<RowMutationEntry, Void> future : entries) {\n+        future.getResultFuture().setException(throwable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d5e153c2b4be0b1fb999c971fd6131991788825"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk2NjY5OQ==", "bodyText": "s/entryResultFuture/entry", "url": "https://github.com/googleapis/java-bigtable/pull/145#discussion_r364966699", "createdAt": "2020-01-09T21:24:52Z", "author": {"login": "igorbernstein2"}, "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/data/v2/stub/mutaterows/MutateRowsBatchingDescriptor.java", "diffHunk": "@@ -74,12 +75,12 @@ public void splitException(Throwable throwable, List<SettableApiFuture<Void>> ba\n     }\n \n     int i = 0;\n-    for (SettableApiFuture<Void> entryResultFuture : batch) {\n+    for (BatchEntry<RowMutationEntry, Void> entryResultFuture : entries) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8d5e153c2b4be0b1fb999c971fd6131991788825"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65a15e227bb96f7b892bb6253d23d5cd555d5a32", "author": {"user": {"login": "kolea2", "name": null}}, "url": "https://github.com/googleapis/java-bigtable/commit/65a15e227bb96f7b892bb6253d23d5cd555d5a32", "committedDate": "2020-01-09T21:26:50Z", "message": "review feedback"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1123, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}