{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4NjMxODE3", "number": 407, "title": "fix: RowCells are not actually serializeable", "bodyText": "Fixes #384", "createdAt": "2020-09-03T13:26:19Z", "url": "https://github.com/googleapis/java-bigtable/pull/407", "merged": true, "mergeCommit": {"oid": "39e17cc17c438f2d665875f9ff2b2cdf984e37b7"}, "closed": true, "closedAt": "2020-09-08T22:35:55Z", "author": {"login": "dmitry-fa"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFOj5OAH2gAyNDc4NjMxODE3Ojk3NTgyNDVlM2RjYTc1Y2U5MDliYWRmOGNlM2Q2NTRmZjFhODFjM2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdG_cZYgFqTQ4NDUzNjI3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9758245e3dca75ce909badf8ce3d654ff1a81c3c", "author": {"user": {"login": "dmitry-fa", "name": "Dmitry"}}, "url": "https://github.com/googleapis/java-bigtable/commit/9758245e3dca75ce909badf8ce3d654ff1a81c3c", "committedDate": "2020-09-03T11:04:44Z", "message": "fix: make RowCell serializable regardless given type of the labels parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b33307bdf977aed2f6e7f11ad3bbbaa588958454", "author": {"user": {"login": "dmitry-fa", "name": "Dmitry"}}, "url": "https://github.com/googleapis/java-bigtable/commit/b33307bdf977aed2f6e7f11ad3bbbaa588958454", "committedDate": "2020-09-03T11:36:55Z", "message": "fix: make RowCell serializable regardless given type of the labels parameter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMDM0NTgx", "url": "https://github.com/googleapis/java-bigtable/pull/407#pullrequestreview-482034581", "createdAt": "2020-09-03T16:59:54Z", "commit": {"oid": "b33307bdf977aed2f6e7f11ad3bbbaa588958454"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNjo1OTo1NFrOHMvrog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNjo1OTo1NFrOHMvrog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzEyNjE3OA==", "bodyText": "This doesnt optimize for the common case. The common case is empty labels. This is currently creating an extra allocation. Optimization would be:\nlabels = labels.isEmpty()? ImmutableList.of() : ImmutableList.copyOf(labels);", "url": "https://github.com/googleapis/java-bigtable/pull/407#discussion_r483126178", "createdAt": "2020-09-03T16:59:54Z", "author": {"login": "igorbernstein2"}, "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/data/v2/models/RowCell.java", "diffHunk": "@@ -62,7 +63,8 @@ public static RowCell create(\n       long timestamp,\n       @Nonnull List<String> labels,\n       @Nonnull ByteString value) {\n-    return new AutoValue_RowCell(family, qualifier, timestamp, value, labels);\n+    // Ensure that the list is serializable and optimize for the common case\n+    return new AutoValue_RowCell(family, qualifier, timestamp, value, ImmutableList.copyOf(labels));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b33307bdf977aed2f6e7f11ad3bbbaa588958454"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "020c4374de90bfe63f1689d80bd9f570e1aeac89", "author": {"user": {"login": "dmitry-fa", "name": "Dmitry"}}, "url": "https://github.com/googleapis/java-bigtable/commit/020c4374de90bfe63f1689d80bd9f570e1aeac89", "committedDate": "2020-09-03T17:48:53Z", "message": "optimization for an empty labels list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NTM2Mjc0", "url": "https://github.com/googleapis/java-bigtable/pull/407#pullrequestreview-484536274", "createdAt": "2020-09-08T22:35:49Z", "commit": {"oid": "020c4374de90bfe63f1689d80bd9f570e1aeac89"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1078, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}