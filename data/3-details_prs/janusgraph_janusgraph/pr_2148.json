{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwMjE2Nzg0", "number": 2148, "title": "Fix #2147: graph is created again during the drop process", "bodyText": "This PR address issue #2147 by refactoring the drop() method in the ConfiguredGraphFactory class.\nThe bug was in the call to removeGraphFromCache(String graphName) which internally tries to open the graph. Because of the order of the calls, the graph was already dropped by a call to JanusGraphFactory.drop(graph) which then result in the storage to be recreated.\n\nThank you for contributing to JanusGraph!\nIn order to streamline the review of the contribution we ask you\nto ensure the following steps have been taken:\nFor all changes:\n\n Is there an issue associated with this PR? Is it referenced in the commit message?\n Does your PR body contain #xyz where xyz is the issue number you are trying to resolve?\n Has your PR been rebased against the latest commit within the target branch (typically master)?\n Is your initial contribution a single, squashed commit?\n\nFor code changes:\n\n Have you written and/or updated unit tests to verify your changes?\n If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under ASF 2.0?\n If applicable, have you updated the LICENSE.txt file, including the main LICENSE.txt file in the root of this repository?\n If applicable, have you updated the NOTICE.txt file, including the main NOTICE.txt file found in the root of this repository?\n\nFor documentation related changes:\n\n Have you ensured that format looks appropriate for the output in which it is rendered?\n If this PR is a documentation-only change, have you added a [doc only]\ntag to the first line of your commit message to avoid spending CPU cycles in\nTravis CI when no code, tests, or build configuration are modified?\n\nNote:\nPlease ensure that once the PR is submitted, you check Travis CI for build issues and submit an update to your PR as soon as possible.", "createdAt": "2020-06-25T19:32:41Z", "url": "https://github.com/JanusGraph/janusgraph/pull/2148", "merged": true, "mergeCommit": {"oid": "057f9e3429aa013841fb202d48de17afab7bb367"}, "closed": true, "closedAt": "2021-02-13T15:12:25Z", "author": {"login": "BrunoBerisso"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcvAy7agBqjM0ODYwNjcyNjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABd5boQ2ABqjQzMjU0MTkzMzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "484684ab8ebd7acad4b14766eb24e41a3f188aba", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/484684ab8ebd7acad4b14766eb24e41a3f188aba", "committedDate": "2020-06-25T19:28:08Z", "message": "Fix #2147: graph is created again during the drop process"}, "afterCommit": {"oid": "6877996bf2fbc8ac30513478a944e76827669c82", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/6877996bf2fbc8ac30513478a944e76827669c82", "committedDate": "2020-06-26T10:35:20Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NTA5MTEy", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-439509112", "createdAt": "2020-06-29T21:20:34Z", "commit": {"oid": "6877996bf2fbc8ac30513478a944e76827669c82"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMToyMDozNFrOGqioyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMToyMjo1OVrOGqitUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI2MDg3NA==", "bodyText": "I just added test in it pass without changes which i expected not to happen.", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r447260874", "createdAt": "2020-06-29T21:20:34Z", "author": {"login": "farodin91"}, "path": "janusgraph-test/src/test/java/org/janusgraph/core/ConfiguredGraphFactoryTest.java", "diffHunk": "@@ -222,6 +223,25 @@ public void removeConfigurationShouldRemoveGraphFromCache() throws Exception {\n         }\n     }\n \n+    @Test\n+    public void dropGraphShouldRemoveGraphFromCache() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877996bf2fbc8ac30513478a944e76827669c82"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI2MjAzMg==", "bodyText": "The bug was in the call to removeGraphFromCache(String graphName) which internally tries to open the graph. Because of the order of the calls, the graph was already dropped by a call to JanusGraphFactory.drop(graph) which then result in the storage to be recreated.\n\nThis sentence confuses me a bit, due the fact you didn't change the functionality of it.\nCan you clarify it for me?", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r447262032", "createdAt": "2020-06-29T21:22:59Z", "author": {"login": "farodin91"}, "path": "janusgraph-core/src/main/java/org/janusgraph/core/ConfiguredGraphFactory.java", "diffHunk": "@@ -155,10 +155,16 @@ public static JanusGraph close(String graphName) throws Exception {\n      * @throws BackendException If an error occurs during deletion\n      * @throws ConfigurationManagementGraphNotEnabledException If ConfigurationManagementGraph not\n      */\n-    public static void drop(String graphName) throws Exception {\n-        final StandardJanusGraph graph = (StandardJanusGraph) ConfiguredGraphFactory.close(graphName);\n+    public static void drop(String graphName) throws BackendException, ConfigurationManagementGraphNotEnabledException, Exception {\n+        final ConfigurationManagementGraph configManagementGraph = getConfigGraphManagementInstance();\n+        configManagementGraph.removeConfiguration(graphName);\n+\n+        final JanusGraphManager jgm = JanusGraphManagerUtility.getInstance();\n+        Preconditions.checkNotNull(jgm, JANUS_GRAPH_MANAGER_EXPECTED_STATE_MSG);\n+\n+        final StandardJanusGraph graph = (StandardJanusGraph) jgm.getGraph(graphName);\n+        removeGraphFromCache(graph);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877996bf2fbc8ac30513478a944e76827669c82"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6877996bf2fbc8ac30513478a944e76827669c82", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/6877996bf2fbc8ac30513478a944e76827669c82", "committedDate": "2020-06-26T10:35:20Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "bb433c31c430e2bdf666a5dc763809001c23ba7b", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/bb433c31c430e2bdf666a5dc763809001c23ba7b", "committedDate": "2020-07-02T13:50:12Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb433c31c430e2bdf666a5dc763809001c23ba7b", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/bb433c31c430e2bdf666a5dc763809001c23ba7b", "committedDate": "2020-07-02T13:50:12Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "dd71d66affd1ad4eb8f60e9b66aec499af1e2311", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/dd71d66affd1ad4eb8f60e9b66aec499af1e2311", "committedDate": "2020-07-02T19:41:14Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dd71d66affd1ad4eb8f60e9b66aec499af1e2311", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/dd71d66affd1ad4eb8f60e9b66aec499af1e2311", "committedDate": "2020-07-02T19:41:14Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "5c73d87345ac4ec23549428878ef9009651d59c6", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/5c73d87345ac4ec23549428878ef9009651d59c6", "committedDate": "2020-07-03T12:41:12Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNDQzMDEw", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-442443010", "createdAt": "2020-07-03T14:18:47Z", "commit": {"oid": "5c73d87345ac4ec23549428878ef9009651d59c6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxNDoxODo0N1rOGsxzGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxNDoxODo0N1rOGsxzGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYwNjQyNg==", "bodyText": "This long delay was needed because the Cassandra docker image takes around 5 min to get ready (measured in my machine) when running the verify command so I choose to set a safe default. I believe it's because the tests are running in parallel.", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r449606426", "createdAt": "2020-07-03T14:18:47Z", "author": {"login": "BrunoBerisso"}, "path": "janusgraph-test/src/test/java/org/janusgraph/core/ConfiguredGraphFactoryTest.java", "diffHunk": "@@ -26,16 +27,35 @@\n import org.apache.tinkerpop.gremlin.server.Settings;\n import org.apache.commons.configuration.MapConfiguration;\n \n+import java.time.Duration;\n import java.util.Map;\n import java.util.HashMap;\n \n import org.junit.jupiter.api.Test;\n import org.junit.jupiter.api.AfterEach;\n+import org.testcontainers.containers.CassandraContainer;\n+import org.testcontainers.junit.jupiter.Container;\n+import org.testcontainers.junit.jupiter.Testcontainers;\n+\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_HOSTS;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_PORT;\n import static org.junit.jupiter.api.Assertions.*;\n \n+@Testcontainers\n public class ConfiguredGraphFactoryTest {\n+\n+    private static final String CASSANDRA_VERSION = \"3.11.6\";\n+    private static final String CASSANDRA_IMAGE = \"cassandra\";\n+\n+    @Container\n+    public static final CassandraContainer cqlContainer;\n     private static final JanusGraphManager gm;\n+\n     static {\n+        cqlContainer = new CassandraContainer<>(CASSANDRA_IMAGE + \":\" + CASSANDRA_VERSION)\n+            .withExposedPorts(9042)\n+            .withStartupAttempts(1)\n+            .withStartupTimeout(Duration.ofMinutes(10));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c73d87345ac4ec23549428878ef9009651d59c6"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNDQ1NjQ2", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-442445646", "createdAt": "2020-07-03T14:23:30Z", "commit": {"oid": "5c73d87345ac4ec23549428878ef9009651d59c6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxNDoyMzozMFrOGsx6_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QxNDoyMzozMFrOGsx6_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYwODQ0NA==", "bodyText": "I hit this error from Travis\nThe job exceeded the maximum log length, and has been terminated.\n\nand found out that the log4j settings were not being used because of a conflict on the available SLF4J available at run time. This change enforces the use of log4j which make the settings in log4j.properties being picked up.\nThe logs are much quieter now, the full DEBUG output is being appended to a file. Let me know if this is the right approach.", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r449608444", "createdAt": "2020-07-03T14:23:30Z", "author": {"login": "BrunoBerisso"}, "path": "janusgraph-test/pom.xml", "diffHunk": "@@ -30,6 +30,13 @@\n     </repositories>\n \n     <dependencies>\n+        <!-- Enforce a classpath ordering constraint to ensure log4j is used for logging. -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c73d87345ac4ec23549428878ef9009651d59c6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3ODA3MTQy", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-447807142", "createdAt": "2020-07-14T05:55:39Z", "commit": {"oid": "5c73d87345ac4ec23549428878ef9009651d59c6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c73d87345ac4ec23549428878ef9009651d59c6", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/5c73d87345ac4ec23549428878ef9009651d59c6", "committedDate": "2020-07-03T12:41:12Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "6fc675386f129e26c162cb9e76dd48456d38b38a", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/6fc675386f129e26c162cb9e76dd48456d38b38a", "committedDate": "2020-11-27T16:44:36Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNTcxNDI5", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-542571429", "createdAt": "2020-12-02T07:52:35Z", "commit": {"oid": "6fc675386f129e26c162cb9e76dd48456d38b38a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NjE2NjQ4", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-544616648", "createdAt": "2020-12-04T02:40:18Z", "commit": {"oid": "6fc675386f129e26c162cb9e76dd48456d38b38a"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwMjo0MDoxOFrOH--O7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQwMzowMTo1NVrOH_oynA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc5MzM5MQ==", "bodyText": "So from my understanding, this test case is to avoid any regression, which is nice. Is there any reason you cannot test your changes in this PR? Am I missing something?", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r535793391", "createdAt": "2020-12-04T02:40:18Z", "author": {"login": "li-boxuan"}, "path": "janusgraph-test/src/test/java/org/janusgraph/core/ConfiguredGraphFactoryTest.java", "diffHunk": "@@ -222,6 +223,25 @@ public void removeConfigurationShouldRemoveGraphFromCache() throws Exception {\n         }\n     }\n \n+    @Test\n+    public void dropGraphShouldRemoveGraphFromCache() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI2MDg3NA=="}, "originalCommit": {"oid": "6877996bf2fbc8ac30513478a944e76827669c82"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc5NjgxOA==", "bodyText": "What about making this ConfiguredGraphFactoryTest a base class and let different backends extend this base test? Like what we have in JanusGraphTest & JanusGraphIndexTest.", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r535796818", "createdAt": "2020-12-04T02:50:32Z", "author": {"login": "li-boxuan"}, "path": "janusgraph-test/src/test/java/org/janusgraph/core/ConfiguredGraphFactoryTest.java", "diffHunk": "@@ -26,16 +27,35 @@\n import org.apache.tinkerpop.gremlin.server.Settings;\n import org.apache.commons.configuration.MapConfiguration;\n \n+import java.time.Duration;\n import java.util.Map;\n import java.util.HashMap;\n \n import org.junit.jupiter.api.Test;\n import org.junit.jupiter.api.AfterEach;\n+import org.testcontainers.containers.CassandraContainer;\n+import org.testcontainers.junit.jupiter.Container;\n+import org.testcontainers.junit.jupiter.Testcontainers;\n+\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_HOSTS;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_PORT;\n import static org.junit.jupiter.api.Assertions.*;\n \n+@Testcontainers\n public class ConfiguredGraphFactoryTest {\n+\n+    private static final String CASSANDRA_VERSION = \"3.11.6\";\n+    private static final String CASSANDRA_IMAGE = \"cassandra\";\n+\n+    @Container\n+    public static final CassandraContainer cqlContainer;\n     private static final JanusGraphManager gm;\n+\n     static {\n+        cqlContainer = new CassandraContainer<>(CASSANDRA_IMAGE + \":\" + CASSANDRA_VERSION)\n+            .withExposedPorts(9042)\n+            .withStartupAttempts(1)\n+            .withStartupTimeout(Duration.ofMinutes(10));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYwNjQyNg=="}, "originalCommit": {"oid": "5c73d87345ac4ec23549428878ef9009651d59c6"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc5NzA0NA==", "bodyText": "nitpick: missing newline at end of file", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r535797044", "createdAt": "2020-12-04T02:51:06Z", "author": {"login": "li-boxuan"}, "path": "janusgraph-test/src/test/resources/log4j.properties", "diffHunk": "@@ -27,3 +27,6 @@ log4j.rootLogger=DEBUG, A1\n log4j.logger.org.apache.cassandra=INFO\n log4j.logger.org.apache.hadoop=INFO\n log4j.logger.org.apache.zookeeper=INFO\n+\n+log4j.logger.org.testcontainers=INFO\n+log4j.logger.com.github.dockerjava=WARN", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc675386f129e26c162cb9e76dd48456d38b38a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ5MDY1Mg==", "bodyText": "The blocking mechanism you implemented looks correct to me, but I recommend using CountDownLatch which is simpler and less error-prone.", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r536490652", "createdAt": "2020-12-05T03:01:55Z", "author": {"login": "li-boxuan"}, "path": "janusgraph-core/src/main/java/org/janusgraph/core/ConfiguredGraphFactory.java", "diffHunk": "@@ -152,13 +153,62 @@ public static JanusGraph close(String graphName) throws Exception {\n      *\n      * <p><b>WARNING: This is an irreversible operation that will delete all graph and index data.</b></p>\n      * @param graphName String graphName. Corresponding graph can be open or closed.\n-     * @throws BackendException If an error occurs during deletion\n-     * @throws ConfigurationManagementGraphNotEnabledException If ConfigurationManagementGraph not\n      */\n-    public static void drop(String graphName) throws Exception {\n-        final StandardJanusGraph graph = (StandardJanusGraph) ConfiguredGraphFactory.close(graphName);\n-        JanusGraphFactory.drop(graph);\n-        removeConfiguration(graphName);\n+    public static void drop(String graphName) {\n+        final JanusGraphManager jgm = JanusGraphManagerUtility.getInstance();\n+        Preconditions.checkNotNull(jgm, JANUS_GRAPH_MANAGER_EXPECTED_STATE_MSG);\n+\n+        final StandardJanusGraph graph = (StandardJanusGraph) jgm.getGraph(graphName);\n+        // Evict the graph from the cache in all nodes in the cluster\n+        DropGraphOnEvictionTrigger dropTrigger = new DropGraphOnEvictionTrigger(graphName, graph, getConfigGraphManagementInstance());\n+        removeGraphFromCache(graph, dropTrigger);\n+        // Block the current thread until the drop operation finish\n+        dropTrigger.waitUntilDropFinish();\n+    }\n+\n+    /**\n+     * This trigger will fire when the give graph was evicted from all the nodes in the cluster.\n+     */\n+    private static class DropGraphOnEvictionTrigger implements Callable<Boolean> {\n+        private static final Logger log = LoggerFactory.getLogger(DropGraphOnEvictionTrigger.class);\n+        private final String graphName;\n+        private final JanusGraph graph;\n+        private final ConfigurationManagementGraph configManagementGraph;\n+        private boolean dropFinished;\n+\n+        private DropGraphOnEvictionTrigger(String graphName, JanusGraph graph, ConfigurationManagementGraph configManagementGraph) {\n+            this.graphName = graphName;\n+            this.graph = graph;\n+            this.configManagementGraph = configManagementGraph;\n+            this.dropFinished = false;\n+        }\n+\n+        @Override\n+        public synchronized Boolean call() throws BackendException {\n+            try {\n+                log.info(\"Graph {} has been removed from the graph cache on every JanusGraph node in the cluster.\", graphName);\n+                log.warn(\"Attempting to drop the graph {}.\", graphName);\n+                configManagementGraph.removeConfiguration(graphName);\n+                JanusGraphFactory.drop(graph);\n+                log.warn(\"Graph {} has been dropped.\", graphName);\n+                return true;\n+            } finally {\n+                dropFinished = true;\n+                notifyAll();\n+            }\n+        }\n+\n+        public synchronized void waitUntilDropFinish() {\n+            log.debug(\"Waiting for graph {} to be evicted from the cache in all JanusGraph nodes...\", graphName);\n+            while (!dropFinished) {\n+                try {\n+                    wait();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fc675386f129e26c162cb9e76dd48456d38b38a"}, "originalPosition": 67}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6fc675386f129e26c162cb9e76dd48456d38b38a", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/6fc675386f129e26c162cb9e76dd48456d38b38a", "committedDate": "2020-11-27T16:44:36Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "cfe82516ef3d38540a5027f264cdb84ce1e9b976", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/cfe82516ef3d38540a5027f264cdb84ce1e9b976", "committedDate": "2020-12-29T16:24:19Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cfe82516ef3d38540a5027f264cdb84ce1e9b976", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/cfe82516ef3d38540a5027f264cdb84ce1e9b976", "committedDate": "2020-12-29T16:24:19Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "37d2cad23a8138286732ed73cb16b5e2c41d6fce", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/37d2cad23a8138286732ed73cb16b5e2c41d6fce", "committedDate": "2020-12-29T17:17:19Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NzY0MDc5", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-559764079", "createdAt": "2020-12-30T02:50:22Z", "commit": {"oid": "37d2cad23a8138286732ed73cb16b5e2c41d6fce"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMjo1MDoyM1rOIMcUGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQwMjo1MDoyM1rOIMcUGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkxNzcyMg==", "bodyText": "Can you use JanusGraphCassandraContainer if possible?", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r549917722", "createdAt": "2020-12-30T02:50:23Z", "author": {"login": "li-boxuan"}, "path": "janusgraph-test/src/test/java/org/janusgraph/core/CQLConfiguredGraphFactoryTest.java", "diffHunk": "@@ -0,0 +1,89 @@\n+// Copyright 2017 JanusGraph Authors\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package org.janusgraph.core;\n+\n+import com.datastax.driver.core.Session;\n+import org.apache.commons.configuration.MapConfiguration;\n+import org.janusgraph.graphdb.database.StandardJanusGraph;\n+import org.junit.jupiter.api.Test;\n+import org.testcontainers.containers.CassandraContainer;\n+import org.testcontainers.junit.jupiter.Container;\n+import org.testcontainers.junit.jupiter.Testcontainers;\n+\n+import java.time.Duration;\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.GRAPH_NAME;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_BACKEND;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_HOSTS;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_PORT;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertNull;\n+\n+@Testcontainers\n+public class CQLConfiguredGraphFactoryTest extends ConfiguredGraphFactoryTest {\n+\n+    private static final String CASSANDRA_VERSION = \"3.11.6\";\n+    private static final String CASSANDRA_IMAGE = \"cassandra\";\n+\n+    @Container\n+    public static final CassandraContainer cqlContainer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37d2cad23a8138286732ed73cb16b5e2c41d6fce"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwMTE2MjE2", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-560116216", "createdAt": "2020-12-30T16:27:42Z", "commit": {"oid": "37d2cad23a8138286732ed73cb16b5e2c41d6fce"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQxNjoyNzo0M1rOIMwtMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQxNjoyNzo0M1rOIMwtMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDI1MTgyNg==", "bodyText": "Is it possible not to use in-memory backend in CQL test? Not familiar with this, so not sure if this is the reason you are unable to use JanusGraphCassandraContainer.\n@farodin91 Any idea here?", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r550251826", "createdAt": "2020-12-30T16:27:43Z", "author": {"login": "li-boxuan"}, "path": "janusgraph-test/src/test/java/org/janusgraph/core/ConfiguredGraphFactoryTest.java", "diffHunk": "@@ -14,37 +14,65 @@\n \n package org.janusgraph.core;\n \n+import org.apache.commons.configuration.MapConfiguration;\n+import org.apache.tinkerpop.gremlin.server.Settings;\n+import org.janusgraph.diskstorage.configuration.backend.CommonsConfiguration;\n import org.janusgraph.graphdb.configuration.builder.GraphDatabaseConfigurationBuilder;\n-import org.janusgraph.graphdb.management.JanusGraphManager;\n+import org.janusgraph.graphdb.database.StandardJanusGraph;\n import org.janusgraph.graphdb.management.ConfigurationManagementGraph;\n+import org.janusgraph.graphdb.management.JanusGraphManager;\n import org.janusgraph.graphdb.management.utils.ConfigurationManagementGraphNotEnabledException;\n-import org.janusgraph.diskstorage.configuration.backend.CommonsConfiguration;\n-import org.janusgraph.graphdb.database.StandardJanusGraph;\n-import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.GRAPH_NAME;\n-import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_BACKEND;\n-\n-import org.apache.tinkerpop.gremlin.server.Settings;\n-import org.apache.commons.configuration.MapConfiguration;\n+import org.junit.jupiter.api.AfterEach;\n+import org.junit.jupiter.api.Test;\n \n-import java.util.Map;\n import java.util.HashMap;\n+import java.util.Map;\n \n-import org.junit.jupiter.api.Test;\n-import org.junit.jupiter.api.AfterEach;\n-import static org.junit.jupiter.api.Assertions.*;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.GRAPH_NAME;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_BACKEND;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertFalse;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertNull;\n+import static org.junit.jupiter.api.Assertions.assertThrows;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+public abstract class ConfiguredGraphFactoryTest {\n \n-public class ConfiguredGraphFactoryTest {\n     private static final JanusGraphManager gm;\n+\n     static {\n         gm = new JanusGraphManager(new Settings());\n-        final Map<String, Object> map = new HashMap<>();\n-        map.put(STORAGE_BACKEND.toStringWithoutRoot(), \"inmemory\");\n-        final MapConfiguration config = new MapConfiguration(map);\n+        final MapConfiguration config = getManagementConfig();\n         final StandardJanusGraph graph = new StandardJanusGraph(new GraphDatabaseConfigurationBuilder().build(new CommonsConfiguration(config)));\n         // Instantiate the ConfigurationManagementGraph Singleton\n         new ConfigurationManagementGraph(graph);\n     }\n \n+    /**\n+     * Getter for the settings to use to instantiate the graph supporting the\n+     * ConfigurationManagementGraph instance.\n+     * @return a MapConfiguration instance\n+     */\n+    protected static MapConfiguration getManagementConfig() {\n+        final Map<String, Object> map = new HashMap<>();\n+        map.put(STORAGE_BACKEND.toStringWithoutRoot(), \"inmemory\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37d2cad23a8138286732ed73cb16b5e2c41d6fce"}, "originalPosition": 62}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "37d2cad23a8138286732ed73cb16b5e2c41d6fce", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/37d2cad23a8138286732ed73cb16b5e2c41d6fce", "committedDate": "2020-12-29T17:17:19Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "a0568582b0ee958840d6210e79a4fef7a58c53b7", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/a0568582b0ee958840d6210e79a4fef7a58c53b7", "committedDate": "2021-01-04T11:56:24Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY0Njc4NDM2", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-564678436", "createdAt": "2021-01-09T02:59:34Z", "commit": {"oid": "a0568582b0ee958840d6210e79a4fef7a58c53b7"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOVQwMjo1OTozNVrOIQmoKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOVQwMzowNTo0OFrOIQmqlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDI4MTAwMw==", "bodyText": "Not 100% sure but I think this is not needed.", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r554281003", "createdAt": "2021-01-09T02:59:35Z", "author": {"login": "li-boxuan"}, "path": "janusgraph-test/src/test/java/org/janusgraph/core/CQLConfiguredGraphFactoryTest.java", "diffHunk": "@@ -0,0 +1,86 @@\n+// Copyright 2017 JanusGraph Authors\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package org.janusgraph.core;\n+\n+import com.datastax.driver.core.Session;\n+import org.apache.commons.configuration.MapConfiguration;\n+import org.janusgraph.JanusGraphCassandraContainer;\n+import org.janusgraph.graphdb.database.StandardJanusGraph;\n+import org.junit.jupiter.api.Test;\n+import org.testcontainers.junit.jupiter.Container;\n+import org.testcontainers.junit.jupiter.Testcontainers;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.GRAPH_NAME;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_BACKEND;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_HOSTS;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_PORT;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertNull;\n+\n+@Testcontainers\n+public class CQLConfiguredGraphFactoryTest extends ConfiguredGraphFactoryTest {\n+\n+    @Container\n+    public static final JanusGraphCassandraContainer cqlContainer = new JanusGraphCassandraContainer();\n+\n+    static {\n+        cqlContainer.start();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0568582b0ee958840d6210e79a4fef7a58c53b7"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDI4MTYyMg==", "bodyText": "Can you move CQLConfiguredGraphFactoryTest to janusgraph-cql module,\nConfiguredGraphFactoryTest to janusgraph-backend-testutils module (you might need to introduce additional dependency),\nand InmemoryConfiguredGraphFactoryTest to janusgraph-inmemory module?\nThis is a common practice for tests involving different backends. We have workflows like ci-backend-cql.yml which picks up tests only under certain folders.", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r554281622", "createdAt": "2021-01-09T03:05:48Z", "author": {"login": "li-boxuan"}, "path": "janusgraph-test/src/test/java/org/janusgraph/core/CQLConfiguredGraphFactoryTest.java", "diffHunk": "@@ -0,0 +1,86 @@\n+// Copyright 2017 JanusGraph Authors\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package org.janusgraph.core;\n+\n+import com.datastax.driver.core.Session;\n+import org.apache.commons.configuration.MapConfiguration;\n+import org.janusgraph.JanusGraphCassandraContainer;\n+import org.janusgraph.graphdb.database.StandardJanusGraph;\n+import org.junit.jupiter.api.Test;\n+import org.testcontainers.junit.jupiter.Container;\n+import org.testcontainers.junit.jupiter.Testcontainers;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.GRAPH_NAME;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_BACKEND;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_HOSTS;\n+import static org.janusgraph.graphdb.configuration.GraphDatabaseConfiguration.STORAGE_PORT;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertNull;\n+\n+@Testcontainers\n+public class CQLConfiguredGraphFactoryTest extends ConfiguredGraphFactoryTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0568582b0ee958840d6210e79a4fef7a58c53b7"}, "originalPosition": 36}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a0568582b0ee958840d6210e79a4fef7a58c53b7", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/a0568582b0ee958840d6210e79a4fef7a58c53b7", "committedDate": "2021-01-04T11:56:24Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "5dc618af15a1dd9267434d1db7c44c6aa47055dc", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/5dc618af15a1dd9267434d1db7c44c6aa47055dc", "committedDate": "2021-02-05T16:20:34Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5dc618af15a1dd9267434d1db7c44c6aa47055dc", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/5dc618af15a1dd9267434d1db7c44c6aa47055dc", "committedDate": "2021-02-05T16:20:34Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "8cdc0ea4480520cb80b24815e22964c33f320d5a", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/8cdc0ea4480520cb80b24815e22964c33f320d5a", "committedDate": "2021-02-05T17:19:41Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8cdc0ea4480520cb80b24815e22964c33f320d5a", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/8cdc0ea4480520cb80b24815e22964c33f320d5a", "committedDate": "2021-02-05T17:19:41Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "5533d507d3d4321270279719b19c9798c9eb1289", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/5533d507d3d4321270279719b19c9798c9eb1289", "committedDate": "2021-02-05T17:43:44Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5533d507d3d4321270279719b19c9798c9eb1289", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/5533d507d3d4321270279719b19c9798c9eb1289", "committedDate": "2021-02-05T17:43:44Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "2bf56ccd51686bb0605de148578f9951a6231eb3", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/2bf56ccd51686bb0605de148578f9951a6231eb3", "committedDate": "2021-02-05T19:14:04Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2bf56ccd51686bb0605de148578f9951a6231eb3", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/2bf56ccd51686bb0605de148578f9951a6231eb3", "committedDate": "2021-02-05T19:14:04Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "bf3dde8803cc43da1218c1f340a9cbab663ed45e", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/bf3dde8803cc43da1218c1f340a9cbab663ed45e", "committedDate": "2021-02-08T16:56:04Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf3dde8803cc43da1218c1f340a9cbab663ed45e", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/bf3dde8803cc43da1218c1f340a9cbab663ed45e", "committedDate": "2021-02-08T16:56:04Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "e32d30f1cadbb06e9f53fdcf726d00f806735ff1", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/e32d30f1cadbb06e9f53fdcf726d00f806735ff1", "committedDate": "2021-02-11T13:07:03Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg5MTQ3NzYz", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#pullrequestreview-589147763", "createdAt": "2021-02-12T03:01:45Z", "commit": {"oid": "e32d30f1cadbb06e9f53fdcf726d00f806735ff1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMlQwMzowMTo0NVrOIkVCig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMlQwMzowMTo0NVrOIkVCig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDk2NDM2Mg==", "bodyText": "Can you add\n          - module: cql\n            args: \"-Pcassandra3-byteordered -Dtest=\\\"**/core/cql/*\\\"\"\n\nso that we test against byteordered partitioner as well?", "url": "https://github.com/JanusGraph/janusgraph/pull/2148#discussion_r574964362", "createdAt": "2021-02-12T03:01:45Z", "author": {"login": "li-boxuan"}, "path": ".github/workflows/ci-backend-cql.yml", "diffHunk": "@@ -70,6 +70,8 @@ jobs:\n             args: \"-Pcassandra3-murmur -Dtest=\\\"**/graphdb/cql/*\\\"\"\n           - module: cql\n             args: \"-Pcassandra3-murmur -Dtest=\\\"**/hadoop/*\\\"\"\n+          - module: cql\n+            args: \"-Pcassandra3-murmur -Dtest=\\\"**/core/cql/*\\\"\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e32d30f1cadbb06e9f53fdcf726d00f806735ff1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7171441abcfa84c8b3457d910b215850b96c0df", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/f7171441abcfa84c8b3457d910b215850b96c0df", "committedDate": "2021-02-12T15:42:08Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e32d30f1cadbb06e9f53fdcf726d00f806735ff1", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/e32d30f1cadbb06e9f53fdcf726d00f806735ff1", "committedDate": "2021-02-11T13:07:03Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}, "afterCommit": {"oid": "f7171441abcfa84c8b3457d910b215850b96c0df", "author": {"user": {"login": "BrunoBerisso", "name": "Bruno Berisso"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/f7171441abcfa84c8b3457d910b215850b96c0df", "committedDate": "2021-02-12T15:42:08Z", "message": "Fix #2147: graph is created again during the drop process\n\nSigned-off-by: Bruno Berisso <bruno.berisso@experoinc.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4793, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}