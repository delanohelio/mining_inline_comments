{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5ODk5NDM0", "number": 2218, "title": "Make iterators auto-closeable and fix SubqueryIterator close bug", "bodyText": "Changes:\n\nMake a few iterators auto-closeable. Now traversal.close() can be delegated to SubqueryIterator.\nExtract some logic from MultiDistinctOrderedIterator and use new MultiDistinctUnorderedIterator when orders are not given. This makes the code cleaner and reduces the overhead of creating & maintaining complex data structures.\nMake a few iterators extend CloseableAbstractIterator which in turn leverages Guava Iterator's computeNext method. Now, these iterators don't need to explicitly write hasNext and next.\nFix SubqueryIterator bug so that profiler is correctly stopped and results can be cached appropriately.\n\nThis PR does not:\n\nMake all iterators auto-closeable. It only refactors iterators on the traversal -> SubqueryIterator chain so that traversal.close() can be delegated.\nRefactor all iterators using computeNext method. Some iterators have complex internal logic thus I would like to leave them as they are in this PR. Generally, all iterators using nextInternal method could be rewritten using computeNext which is much cleaner and avoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nThank you for contributing to JanusGraph!\nIn order to streamline the review of the contribution we ask you\nto ensure the following steps have been taken:\nFor all changes:\n\n Is there an issue associated with this PR? Is it referenced in the commit message?\n Does your PR body contain #xyz where xyz is the issue number you are trying to resolve?\n Has your PR been rebased against the latest commit within the target branch (typically master)?\n Is your initial contribution a single, squashed commit?\n\nFor code changes:\n\n Have you written and/or updated unit tests to verify your changes?\n If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under ASF 2.0?\n If applicable, have you updated the LICENSE.txt file, including the main LICENSE.txt file in the root of this repository?\n If applicable, have you updated the NOTICE.txt file, including the main NOTICE.txt file found in the root of this repository?\n\nFor documentation related changes:\n\n Have you ensured that format looks appropriate for the output in which it is rendered?\n If this PR is a documentation-only change, have you added a [doc only]\ntag to the first line of your commit message to avoid spending CPU cycles in\nTravis CI when no code, tests, or build configuration are modified?\n\nNote:\nPlease ensure that once the PR is submitted, you check Travis CI for build issues and submit an update to your PR as soon as possible.", "createdAt": "2020-09-20T12:44:25Z", "url": "https://github.com/JanusGraph/janusgraph/pull/2218", "merged": true, "mergeCommit": {"oid": "3787fd4d78d2aa5e849ea836852901b19a469ec5"}, "closed": true, "closedAt": "2020-12-22T01:04:24Z", "author": {"login": "li-boxuan"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKvwS3ABqjM3ODYxMzcwMDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdoZi-VAFqTU1NjU1MjQ4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "20530e078811f310ec61d133d430d8c7c6236d4f", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/20530e078811f310ec61d133d430d8c7c6236d4f", "committedDate": "2020-09-20T12:42:42Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "4bf4c6a377f3c59ebd851f6da2a374ceca5a34eb", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/4bf4c6a377f3c59ebd851f6da2a374ceca5a34eb", "committedDate": "2020-09-20T14:34:24Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4bf4c6a377f3c59ebd851f6da2a374ceca5a34eb", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/4bf4c6a377f3c59ebd851f6da2a374ceca5a34eb", "committedDate": "2020-09-20T14:34:24Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "db73fa612f471b3fbfcad137ea54e84fd5baf6ac", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/db73fa612f471b3fbfcad137ea54e84fd5baf6ac", "committedDate": "2020-09-20T14:38:42Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "db73fa612f471b3fbfcad137ea54e84fd5baf6ac", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/db73fa612f471b3fbfcad137ea54e84fd5baf6ac", "committedDate": "2020-09-20T14:38:42Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1", "committedDate": "2020-09-21T01:09:00Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyMjgzNDM1", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-492283435", "createdAt": "2020-09-21T05:17:27Z", "commit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwNToxNzoyN1rOHVA7yg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwNTozNDoyOVrOHVBJgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc5NzQ1MA==", "bodyText": "What happened to the currentIds != null check here? Before your change, the SubQueryIterator was also stopped if currentIds was null, even if the elementIterator had a next element.", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r491797450", "createdAt": "2020-09-21T05:17:27Z", "author": {"login": "rngcntr"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/util/SubqueryIterator.java", "diffHunk": "@@ -73,11 +74,8 @@ public SubqueryIterator(JointIndexQuery.Subquery subQuery, IndexSerializer index\n \n     @Override\n     public boolean hasNext() {\n-        if (!elementIterator.hasNext() && currentIds != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc5ODI4NQ==", "bodyText": "Not sure: The encapsulation of all the code within an if (isTimerRunning) suggests that calling close() with an already stopped timer is also a valid operation. Does it make sense to restrict the cache update to the case where the timer is still running?\nFrom my understanding, there should be no real difference since after the timer has stopped, currentIds should not be altered anymore. But still I would be more comfortable if the if block only encapsulates operations that are invalid if the timer is stopped.", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r491798285", "createdAt": "2020-09-21T05:21:46Z", "author": {"login": "rngcntr"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/util/SubqueryIterator.java", "diffHunk": "@@ -88,9 +86,13 @@ public JanusGraphElement next() {\n     }\n \n     @Override\n-    public void close() throws Exception {\n+    public void close() {\n         if (isTimerRunning) {\n+            assert currentIds != null;\n+            indexCache.put(subQuery, currentIds);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgwMDk2MA==", "bodyText": "I don't have a strong opinion on this but if the ResultSetIterator itself is a CloseableIterator, would it make sense to enforce it's inner iterator to be closeable, too?", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r491800960", "createdAt": "2020-09-21T05:34:29Z", "author": {"login": "rngcntr"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/query/ResultSetIterator.java", "diffHunk": "@@ -36,7 +37,7 @@\n \n \n     public ResultSetIterator(Iterator<R> inner, int limit) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0MDgyMTUy", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-494082152", "createdAt": "2020-09-23T04:49:28Z", "commit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1", "committedDate": "2020-09-21T01:09:00Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "50251d59fbde80624b23168fa86391609559e7a7", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/50251d59fbde80624b23168fa86391609559e7a7", "committedDate": "2020-09-26T07:11:33Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "50251d59fbde80624b23168fa86391609559e7a7", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/50251d59fbde80624b23168fa86391609559e7a7", "committedDate": "2020-09-26T07:11:33Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1", "committedDate": "2020-09-21T01:09:00Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NTU2NjU4", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-497556658", "createdAt": "2020-09-28T14:15:09Z", "commit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNDoxNTowOVrOHY_xIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNDoxNTowOVrOHY_xIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTk3MjY0Mw==", "bodyText": "I didn't spend much time checking the logic behind this class but from the first glance both solutions look error prone to me.\nThe first solution binds the logic to hasNext to add new elements to the cache (no one said that hasNext should always be executed before next or close methods, thus the solution is error prone).\nA new solution binds logic to close method which might be a little bit better but still looks error prone to me (if we don't call close method at all).\nI think it would be more correct to bind that logic to next method because only next method is responsible for retrieving new elements. Without calling next we can't collect necessary elements for our cache.\nI didn't had much time to think about another solution but what if we use a separate method, something like:\nprivate void cacheQueryIfNoMoreElementsAvailable(){\n    if (!elementIterator.hasNext() && currentIds != null) {\n        indexCache.put(subQuery, currentIds);\n        profiler.setResultSize(currentIds.size());\n        profiler.stopTimer();\n        isTimerRunning = false;\n    }\n}\n\nThan our next method could look like:\npublic JanusGraphElement next() {\n    JanusGraphElement element = this.elementIterator.next();\n    cacheQueryIfNoMoreElementsAvailable();\n    return element;\n}\n\nIn addition we can execute this method in the end of SubqueryIterator constructor just for cases when an index contains 0 elements.\nThat said, I didn't check the above soltuion and didn't think too much about it, thus I may missed something. Nevertheless, I would like to hear some opinions regarding it.", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r495972643", "createdAt": "2020-09-28T14:15:09Z", "author": {"login": "porunov"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/util/SubqueryIterator.java", "diffHunk": "@@ -88,9 +86,13 @@ public JanusGraphElement next() {\n     }\n \n     @Override\n-    public void close() throws Exception {\n+    public void close() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1"}, "originalPosition": 36}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/70a4da19f659d4e319d4d4d9f1d8cb0f5f8b06d1", "committedDate": "2020-09-21T01:09:00Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "1973676c48d0d37ac42fd0bd317bf3c4edfc66bf", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/1973676c48d0d37ac42fd0bd317bf3c4edfc66bf", "committedDate": "2020-10-01T02:46:59Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwMDk2NzI4", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-500096728", "createdAt": "2020-10-01T07:59:59Z", "commit": {"oid": "1973676c48d0d37ac42fd0bd317bf3c4edfc66bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQwNzo1OTo1OVrOHa-21w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQwNzo1OTo1OVrOHa-21w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODA1NDg3MQ==", "bodyText": "Don't forget to cache a query when the result is empty and nobody calls hasNext or next or close.", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r498054871", "createdAt": "2020-10-01T07:59:59Z", "author": {"login": "porunov"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/util/SubqueryIterator.java", "diffHunk": "@@ -73,24 +75,37 @@ public SubqueryIterator(JointIndexQuery.Subquery subQuery, IndexSerializer index\n \n     @Override\n     public boolean hasNext() {\n-        if (!elementIterator.hasNext() && currentIds != null) {\n-            indexCache.put(subQuery, currentIds);\n-            profiler.stopTimer();\n-            isTimerRunning = false;\n-            profiler.setResultSize(currentIds.size());\n+        final boolean hasNext = elementIterator.hasNext();\n+        if (!hasNext) {\n+            if (currentIds != null) {\n+                indexCache.put(subQuery, currentIds);\n+            }\n+            close();\n         }\n-        return elementIterator.hasNext();\n+        return hasNext;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1973676c48d0d37ac42fd0bd317bf3c4edfc66bf"}, "originalPosition": 38}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1973676c48d0d37ac42fd0bd317bf3c4edfc66bf", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/1973676c48d0d37ac42fd0bd317bf3c4edfc66bf", "committedDate": "2020-10-01T02:46:59Z", "message": "Fix SubqueryIterator close bug\n\nThis makes SubqueryIterator, LimitAdjustingIterator, and\nResultSetIterator implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "a364ccbb704172326c38b2001e9c60720890bc61", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/a364ccbb704172326c38b2001e9c60720890bc61", "committedDate": "2020-10-04T04:04:15Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nThis makes a few iterators implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a364ccbb704172326c38b2001e9c60720890bc61", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/a364ccbb704172326c38b2001e9c60720890bc61", "committedDate": "2020-10-04T04:04:15Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nThis makes a few iterators implement CloseableIterator, and makes\nsure SubqueryIterator finishes properly.\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "1c6c9e503a70d511f6b71c34519e2e57e52cdcd1", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/1c6c9e503a70d511f6b71c34519e2e57e52cdcd1", "committedDate": "2020-10-04T12:39:20Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nChanges:\n\n1. Make a few iterators auto-closeable. Now traversal.close() can\nbe delegated to SubqueryIterator.\n2. Extract some logic from MultiDistinctOrderedIterator and use new\nMultiDistinctUnorderedIterator when orders are not given. This\nmakes the code cleaner and reduces the overhead of creating &\nmaintaining complex data structures.\n3. Make a few iterators extend CloseableAbstractIterator which in\nturn leverages Guava Iterator's computeNext method. Now, these\niterators don't need to explicitly write hasNext and next.\n4. Fix SubqueryIterator bug so that profiler is correctly stopped\nand results can be cached appropriately.\n\nThis commit does not:\n\n1. Make all iterators auto-closeable. It only refactors iterators on\nthe traversal -> SubqueryIterator chain so that traversal.close()\ncan be delegated.\n2. Refactor all iterators using computeNext method. Some iterators have\ncomplex internal logic thus I would like to leave them as they are\nin this commit. Generally, all iterators using nextInternal method\ncould be rewritten using computeNext which is much cleaner and\navoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1c6c9e503a70d511f6b71c34519e2e57e52cdcd1", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/1c6c9e503a70d511f6b71c34519e2e57e52cdcd1", "committedDate": "2020-10-04T12:39:20Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nChanges:\n\n1. Make a few iterators auto-closeable. Now traversal.close() can\nbe delegated to SubqueryIterator.\n2. Extract some logic from MultiDistinctOrderedIterator and use new\nMultiDistinctUnorderedIterator when orders are not given. This\nmakes the code cleaner and reduces the overhead of creating &\nmaintaining complex data structures.\n3. Make a few iterators extend CloseableAbstractIterator which in\nturn leverages Guava Iterator's computeNext method. Now, these\niterators don't need to explicitly write hasNext and next.\n4. Fix SubqueryIterator bug so that profiler is correctly stopped\nand results can be cached appropriately.\n\nThis commit does not:\n\n1. Make all iterators auto-closeable. It only refactors iterators on\nthe traversal -> SubqueryIterator chain so that traversal.close()\ncan be delegated.\n2. Refactor all iterators using computeNext method. Some iterators have\ncomplex internal logic thus I would like to leave them as they are\nin this commit. Generally, all iterators using nextInternal method\ncould be rewritten using computeNext which is much cleaner and\navoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "106f0c84c99e7fe2851a372b0917086d469dc1d2", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/106f0c84c99e7fe2851a372b0917086d469dc1d2", "committedDate": "2020-10-05T15:26:06Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nChanges:\n\n1. Make a few iterators auto-closeable. Now traversal.close() can\nbe delegated to SubqueryIterator.\n2. Extract some logic from MultiDistinctOrderedIterator and use new\nMultiDistinctUnorderedIterator when orders are not given. This\nmakes the code cleaner and reduces the overhead of creating &\nmaintaining complex data structures.\n3. Make a few iterators extend CloseableAbstractIterator which in\nturn leverages Guava Iterator's computeNext method. Now, these\niterators don't need to explicitly write hasNext and next.\n4. Fix SubqueryIterator bug so that profiler is correctly stopped\nand results can be cached appropriately.\n\nThis commit does not:\n\n1. Make all iterators auto-closeable. It only refactors iterators on\nthe traversal -> SubqueryIterator chain so that traversal.close()\ncan be delegated.\n2. Refactor all iterators using computeNext method. Some iterators have\ncomplex internal logic thus I would like to leave them as they are\nin this commit. Generally, all iterators using nextInternal method\ncould be rewritten using computeNext which is much cleaner and\navoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxNTI4MTMz", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-541528133", "createdAt": "2020-12-01T06:45:38Z", "commit": {"oid": "106f0c84c99e7fe2851a372b0917086d469dc1d2"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNjo0NTozOFrOH8aN0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwNzoyNDowNlrOH8bFQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEwNjEzMQ==", "bodyText": "Nit: One should avoid calling get(index) on plain lists. My suggestion is to use an iterator, which iterates over the iterators \ud83d\ude01", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r533106131", "createdAt": "2020-12-01T06:45:38Z", "author": {"login": "rngcntr"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/util/MultiIterator.java", "diffHunk": "@@ -0,0 +1,52 @@\n+// Copyright 2020 JanusGraph Authors\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package org.janusgraph.graphdb.util;\n+\n+import org.apache.tinkerpop.gremlin.structure.util.CloseableIterator;\n+\n+import java.util.List;\n+import java.util.Objects;\n+\n+public class MultiIterator<E> extends CloseableAbstractIterator<E> {\n+\n+    private List<CloseableIterator<E>> iterators;\n+    private int current;\n+\n+    public MultiIterator(final List<CloseableIterator<E>> iterators) {\n+        Objects.requireNonNull(iterators);\n+        this.iterators = iterators;\n+    }\n+\n+    @Override\n+    protected E computeNext() {\n+        while (current < iterators.size()) {\n+            CloseableIterator<E> iterator = iterators.get(current);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "106f0c84c99e7fe2851a372b0917086d469dc1d2"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEwNjk0Ng==", "bodyText": "same", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r533106946", "createdAt": "2020-12-01T06:48:01Z", "author": {"login": "rngcntr"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/util/MultiIterator.java", "diffHunk": "@@ -0,0 +1,52 @@\n+// Copyright 2020 JanusGraph Authors\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package org.janusgraph.graphdb.util;\n+\n+import org.apache.tinkerpop.gremlin.structure.util.CloseableIterator;\n+\n+import java.util.List;\n+import java.util.Objects;\n+\n+public class MultiIterator<E> extends CloseableAbstractIterator<E> {\n+\n+    private List<CloseableIterator<E>> iterators;\n+    private int current;\n+\n+    public MultiIterator(final List<CloseableIterator<E>> iterators) {\n+        Objects.requireNonNull(iterators);\n+        this.iterators = iterators;\n+    }\n+\n+    @Override\n+    protected E computeNext() {\n+        while (current < iterators.size()) {\n+            CloseableIterator<E> iterator = iterators.get(current);\n+            if (iterator.hasNext()) {\n+                return iterator.next();\n+            } else {\n+                iterator.close();\n+                current++;\n+            }\n+        }\n+        return endOfData();\n+    }\n+\n+    @Override\n+    public void close() {\n+        for (int i = current; i < iterators.size(); i++) {\n+            iterators.get(i).close();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "106f0c84c99e7fe2851a372b0917086d469dc1d2"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEyMDMyMQ==", "bodyText": "Just an idea: For large sets it can be quite inefficient to perform this check, because hash sets are not cache friendly at all. So before this check, one could query a bloom filter. If the filter says that this element is new, the check can be skipped.\nOn the downside, we would still need to collect the elements in allElements so insertions would still consume as much time as before. Therefore I'm not sure how significant a change like this would be.\nThis is just a general consideration and has nothing to do with your PR. So feel free to dismiss it \ud83d\ude04", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r533120321", "createdAt": "2020-12-01T07:24:06Z", "author": {"login": "rngcntr"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/util/MultiDistinctUnorderedIterator.java", "diffHunk": "@@ -0,0 +1,63 @@\n+// Copyright 2020 JanusGraph Authors\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package org.janusgraph.graphdb.util;\n+\n+import org.apache.tinkerpop.gremlin.structure.util.CloseableIterator;\n+\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.Set;\n+\n+public class MultiDistinctUnorderedIterator<E> extends CloseableAbstractIterator<E> {\n+\n+    private final Set<E> allElements = new HashSet<E>();\n+    private final CloseableIterator<E> iterator;\n+    private final int limit;\n+    private long count;\n+\n+    public MultiDistinctUnorderedIterator(final int lowLimit, final int highLimit, final List<CloseableIterator<E>> iterators) {\n+        Objects.requireNonNull(iterators);\n+        iterator = IteratorUtils.concat(iterators);\n+        limit = highLimit;\n+\n+        long i = 0;\n+        while (i < lowLimit && hasNext()) {\n+            next();\n+            i++;\n+        }\n+    }\n+\n+    @Override\n+    protected E computeNext() {\n+        if (count < limit) {\n+            while (iterator.hasNext()) {\n+                E elem = iterator.next();\n+                if (!allElements.contains(elem)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "106f0c84c99e7fe2851a372b0917086d469dc1d2"}, "originalPosition": 48}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "106f0c84c99e7fe2851a372b0917086d469dc1d2", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/106f0c84c99e7fe2851a372b0917086d469dc1d2", "committedDate": "2020-10-05T15:26:06Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nChanges:\n\n1. Make a few iterators auto-closeable. Now traversal.close() can\nbe delegated to SubqueryIterator.\n2. Extract some logic from MultiDistinctOrderedIterator and use new\nMultiDistinctUnorderedIterator when orders are not given. This\nmakes the code cleaner and reduces the overhead of creating &\nmaintaining complex data structures.\n3. Make a few iterators extend CloseableAbstractIterator which in\nturn leverages Guava Iterator's computeNext method. Now, these\niterators don't need to explicitly write hasNext and next.\n4. Fix SubqueryIterator bug so that profiler is correctly stopped\nand results can be cached appropriately.\n\nThis commit does not:\n\n1. Make all iterators auto-closeable. It only refactors iterators on\nthe traversal -> SubqueryIterator chain so that traversal.close()\ncan be delegated.\n2. Refactor all iterators using computeNext method. Some iterators have\ncomplex internal logic thus I would like to leave them as they are\nin this commit. Generally, all iterators using nextInternal method\ncould be rewritten using computeNext which is much cleaner and\navoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "c4a0ac68034e4c67d0d789b9673047e18560a572", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/c4a0ac68034e4c67d0d789b9673047e18560a572", "committedDate": "2020-12-02T15:11:30Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nChanges:\n\n1. Make a few iterators auto-closeable. Now traversal.close() can\nbe delegated to SubqueryIterator.\n2. Extract some logic from MultiDistinctOrderedIterator and use new\nMultiDistinctUnorderedIterator when orders are not given. This\nmakes the code cleaner and reduces the overhead of creating &\nmaintaining complex data structures.\n3. Make a few iterators extend CloseableAbstractIterator which in\nturn leverages Guava Iterator's computeNext method. Now, these\niterators don't need to explicitly write hasNext and next.\n4. Fix SubqueryIterator bug so that profiler is correctly stopped\nand results can be cached appropriately.\n\nThis commit does not:\n\n1. Make all iterators auto-closeable. It only refactors iterators on\nthe traversal -> SubqueryIterator chain so that traversal.close()\ncan be delegated.\n2. Refactor all iterators using computeNext method. Some iterators have\ncomplex internal logic thus I would like to leave them as they are\nin this commit. Generally, all iterators using nextInternal method\ncould be rewritten using computeNext which is much cleaner and\navoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyOTc1NzQ1", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-542975745", "createdAt": "2020-12-02T15:50:12Z", "commit": {"oid": "c4a0ac68034e4c67d0d789b9673047e18560a572"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNTo1MDoxMlrOH9hi7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNTo1MDoxMlrOH9hi7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI3NDc5Ng==", "bodyText": "I've seen you used IteratorUtils.concat(iterators);. Will it be easier to manage MultiIterator with IteratorUtils.concat(iterators); or did you create it for some other purposes (like better performance, less overhead or something like that)?", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#discussion_r534274796", "createdAt": "2020-12-02T15:50:12Z", "author": {"login": "porunov"}, "path": "janusgraph-core/src/main/java/org/janusgraph/graphdb/util/MultiIterator.java", "diffHunk": "@@ -0,0 +1,59 @@\n+// Copyright 2020 JanusGraph Authors\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package org.janusgraph.graphdb.util;\n+\n+import org.apache.tinkerpop.gremlin.structure.util.CloseableIterator;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+public class MultiIterator<E> extends CloseableAbstractIterator<E> {\n+\n+    private Iterator<CloseableIterator<E>> listIterator;\n+    private CloseableIterator<E> currentIterator;\n+\n+    public MultiIterator(final List<CloseableIterator<E>> iterators) {\n+        Objects.requireNonNull(iterators);\n+        listIterator = iterators.iterator();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4a0ac68034e4c67d0d789b9673047e18560a572"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2a4781db5a3a17a370e8d855d1b692ee1774a05", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/b2a4781db5a3a17a370e8d855d1b692ee1774a05", "committedDate": "2020-12-03T01:59:45Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nChanges:\n\n1. Make a few iterators auto-closeable. Now traversal.close() can\nbe delegated to SubqueryIterator.\n2. Extract some logic from MultiDistinctOrderedIterator and use new\nMultiDistinctUnorderedIterator when orders are not given. This\nmakes the code cleaner and reduces the overhead of creating &\nmaintaining complex data structures.\n3. Make a few iterators extend CloseableAbstractIterator which in\nturn leverages Guava Iterator's computeNext method. Now, these\niterators don't need to explicitly write hasNext and next.\n4. Fix SubqueryIterator bug so that profiler is correctly stopped\nand results can be cached appropriately.\n\nThis commit does not:\n\n1. Make all iterators auto-closeable. It only refactors iterators on\nthe traversal -> SubqueryIterator chain so that traversal.close()\ncan be delegated.\n2. Refactor all iterators using computeNext method. Some iterators have\ncomplex internal logic thus I would like to leave them as they are\nin this commit. Generally, all iterators using nextInternal method\ncould be rewritten using computeNext which is much cleaner and\navoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c4a0ac68034e4c67d0d789b9673047e18560a572", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/c4a0ac68034e4c67d0d789b9673047e18560a572", "committedDate": "2020-12-02T15:11:30Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nChanges:\n\n1. Make a few iterators auto-closeable. Now traversal.close() can\nbe delegated to SubqueryIterator.\n2. Extract some logic from MultiDistinctOrderedIterator and use new\nMultiDistinctUnorderedIterator when orders are not given. This\nmakes the code cleaner and reduces the overhead of creating &\nmaintaining complex data structures.\n3. Make a few iterators extend CloseableAbstractIterator which in\nturn leverages Guava Iterator's computeNext method. Now, these\niterators don't need to explicitly write hasNext and next.\n4. Fix SubqueryIterator bug so that profiler is correctly stopped\nand results can be cached appropriately.\n\nThis commit does not:\n\n1. Make all iterators auto-closeable. It only refactors iterators on\nthe traversal -> SubqueryIterator chain so that traversal.close()\ncan be delegated.\n2. Refactor all iterators using computeNext method. Some iterators have\ncomplex internal logic thus I would like to leave them as they are\nin this commit. Generally, all iterators using nextInternal method\ncould be rewritten using computeNext which is much cleaner and\navoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}, "afterCommit": {"oid": "b2a4781db5a3a17a370e8d855d1b692ee1774a05", "author": {"user": {"login": "li-boxuan", "name": "Boxuan Li"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/b2a4781db5a3a17a370e8d855d1b692ee1774a05", "committedDate": "2020-12-03T01:59:45Z", "message": "Make iterators auto-closeable and fix SubqueryIterator close bug\n\nChanges:\n\n1. Make a few iterators auto-closeable. Now traversal.close() can\nbe delegated to SubqueryIterator.\n2. Extract some logic from MultiDistinctOrderedIterator and use new\nMultiDistinctUnorderedIterator when orders are not given. This\nmakes the code cleaner and reduces the overhead of creating &\nmaintaining complex data structures.\n3. Make a few iterators extend CloseableAbstractIterator which in\nturn leverages Guava Iterator's computeNext method. Now, these\niterators don't need to explicitly write hasNext and next.\n4. Fix SubqueryIterator bug so that profiler is correctly stopped\nand results can be cached appropriately.\n\nThis commit does not:\n\n1. Make all iterators auto-closeable. It only refactors iterators on\nthe traversal -> SubqueryIterator chain so that traversal.close()\ncan be delegated.\n2. Refactor all iterators using computeNext method. Some iterators have\ncomplex internal logic thus I would like to leave them as they are\nin this commit. Generally, all iterators using nextInternal method\ncould be rewritten using computeNext which is much cleaner and\navoids eager-computing (fetches the first result in the constructor).\n\nFixes #2217\n\nSigned-off-by: Boxuan Li <liboxuan@connect.hku.hk>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzNjE4NzQ2", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-543618746", "createdAt": "2020-12-03T06:32:44Z", "commit": {"oid": "b2a4781db5a3a17a370e8d855d1b692ee1774a05"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NzMyNjE4", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-545732618", "createdAt": "2020-12-06T17:58:12Z", "commit": {"oid": "b2a4781db5a3a17a370e8d855d1b692ee1774a05"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a008d965a0a2e62407ffee118cd128bdc0ef3d86", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/a008d965a0a2e62407ffee118cd128bdc0ef3d86", "committedDate": "2020-12-20T21:16:48Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}, "afterCommit": {"oid": "fe145a5576ebcc844b70ca182d719f19fc05e7b6", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/fe145a5576ebcc844b70ca182d719f19fc05e7b6", "committedDate": "2020-12-20T21:27:41Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fe145a5576ebcc844b70ca182d719f19fc05e7b6", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/fe145a5576ebcc844b70ca182d719f19fc05e7b6", "committedDate": "2020-12-20T21:27:41Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}, "afterCommit": {"oid": "267f18987b2b4605fe21572451e3e7854e492056", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/267f18987b2b4605fe21572451e3e7854e492056", "committedDate": "2020-12-20T21:34:12Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "267f18987b2b4605fe21572451e3e7854e492056", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/267f18987b2b4605fe21572451e3e7854e492056", "committedDate": "2020-12-20T21:34:12Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}, "afterCommit": {"oid": "4a7db78cdbe9cea61966ff98a716d67249218877", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/4a7db78cdbe9cea61966ff98a716d67249218877", "committedDate": "2020-12-20T21:37:55Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "166c22ba97ebf5589aa87baa642b035e7d846ec8", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/166c22ba97ebf5589aa87baa642b035e7d846ec8", "committedDate": "2020-12-20T21:57:31Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a7db78cdbe9cea61966ff98a716d67249218877", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/4a7db78cdbe9cea61966ff98a716d67249218877", "committedDate": "2020-12-20T21:37:55Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}, "afterCommit": {"oid": "166c22ba97ebf5589aa87baa642b035e7d846ec8", "author": {"user": {"login": "porunov", "name": "Oleksandr Porunov"}}, "url": "https://github.com/JanusGraph/janusgraph/commit/166c22ba97ebf5589aa87baa642b035e7d846ec8", "committedDate": "2020-12-20T21:57:31Z", "message": "Reduce wrappings of iterators to closable iterators\n\nSigned-off-by: Oleksandr Porunov <alexandr.porunov@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2NTUyNDgw", "url": "https://github.com/JanusGraph/janusgraph/pull/2218#pullrequestreview-556552480", "createdAt": "2020-12-21T17:40:02Z", "commit": {"oid": "166c22ba97ebf5589aa87baa642b035e7d846ec8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4636, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}