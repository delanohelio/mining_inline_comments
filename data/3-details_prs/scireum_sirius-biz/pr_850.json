{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4NDcxNTcw", "number": 850, "title": "Allows job parameters to be logged only as system message or not at all", "bodyText": "Altough parameters can be restricted by permission within the collectParameters method, once they are logged they can be seen by everyone who has access to these logs. As this could expose sensitive data, parameters can now restrict their logging behaviour.\nFixes: OX-6144", "createdAt": "2020-09-03T08:54:21Z", "url": "https://github.com/scireum/sirius-biz/pull/850", "merged": true, "mergeCommit": {"oid": "cbe3f750ffd0fd84acd79c46d4366338858b5f4f"}, "closed": true, "closedAt": "2020-09-03T11:09:37Z", "author": {"login": "meg1502"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFMpoBgH2gAyNDc4NDcxNTcwOmZjMzkxZTNjZmVmYjgwZWY1MWRlMGQ5ZTVlOTFjNGY5YWY1MDUwNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFOfxjAFqTQ4MTcyNzI2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065", "author": {"user": {"login": "meg1502", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/fc391e3cfefb80ef51de0d9e5e91c4f9af505065", "committedDate": "2020-09-03T08:51:11Z", "message": "Allows job parameters to be logged only as system message or not at all\n\nAltough parameters can be restricted by permission within the collectParameters method, once they are logged they can be seen by everyone who has access to these logs. As this could expose sensitive data, parameters can now restrict their logging behaviour.\n\nFixes: OX-6144"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNjM3NDY2", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481637466", "createdAt": "2020-09-03T08:59:42Z", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNjQxMDQy", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481641042", "createdAt": "2020-09-03T09:04:03Z", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNjQxMzQy", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481641342", "createdAt": "2020-09-03T09:04:23Z", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTowNDoyM1rOHMdNOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTowNDoyM1rOHMdNOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyMzQ4MQ==", "bodyText": "i18n", "url": "https://github.com/scireum/sirius-biz/pull/850#discussion_r482823481", "createdAt": "2020-09-03T09:04:23Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/jobs/batch/BatchProcessJobFactory.java", "diffHunk": "@@ -213,16 +216,36 @@ protected void executeTask(ProcessContext process) throws Exception {\n     protected abstract BatchJob createJob(ProcessContext process) throws Exception;\n \n     protected void logParameters(ProcessContext process) {\n+        List<Parameter<?, ?>> parameters = getParameters();\n+\n         StringBuilder output = new StringBuilder();\n         output.append(\"Parameter:\\n\\n\");\n+        appendParameterValues(process, output, parameters, Parameter::shouldBeNormalLogged);\n+        process.log(ProcessLog.info().withMessage(output.toString().trim()));\n+\n+        if (parameters.stream().anyMatch(Parameter::shouldBeSystemLogged)) {\n+            logSystemParameters(process, parameters);\n+        }\n+    }\n \n-        getParameters().forEach(param -> {\n+    private void logSystemParameters(ProcessContext process, List<Parameter<?, ?>> parameters) {\n+        StringBuilder output = new StringBuilder();\n+        output.append(\"Systemparameter:\\n\\n\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNjQxNDIz", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481641423", "createdAt": "2020-09-03T09:04:30Z", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTowNDozMFrOHMdNdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTowNDozMFrOHMdNdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyMzU0Mw==", "bodyText": "i18n", "url": "https://github.com/scireum/sirius-biz/pull/850#discussion_r482823543", "createdAt": "2020-09-03T09:04:30Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/jobs/batch/BatchProcessJobFactory.java", "diffHunk": "@@ -213,16 +216,36 @@ protected void executeTask(ProcessContext process) throws Exception {\n     protected abstract BatchJob createJob(ProcessContext process) throws Exception;\n \n     protected void logParameters(ProcessContext process) {\n+        List<Parameter<?, ?>> parameters = getParameters();\n+\n         StringBuilder output = new StringBuilder();\n         output.append(\"Parameter:\\n\\n\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNjQzNzU3", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481643757", "createdAt": "2020-09-03T09:07:21Z", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTowNzoyMVrOHMdUfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTowNzoyMVrOHMdUfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyNTM0MQ==", "bodyText": "wouldn't a getter be enough here? it is only used in another condition, we could even use this as a parameter (s.a.)", "url": "https://github.com/scireum/sirius-biz/pull/850#discussion_r482825341", "createdAt": "2020-09-03T09:07:21Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/jobs/params/Parameter.java", "diffHunk": "@@ -122,6 +148,25 @@ public boolean isVisible(Map<String, String> context) {\n         return get(context).isPresent();\n     }\n \n+    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNjQ0MzQw", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481644340", "createdAt": "2020-09-03T09:08:06Z", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNjYxNzQw", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481661740", "createdAt": "2020-09-03T09:28:52Z", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNjgyODk0", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481682894", "createdAt": "2020-09-03T09:55:22Z", "commit": {"oid": "fc391e3cfefb80ef51de0d9e5e91c4f9af505065"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6d3e70b56e9a5d1fab3b689f162d4a6c12859aa", "author": {"user": {"login": "meg1502", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/b6d3e70b56e9a5d1fab3b689f162d4a6c12859aa", "committedDate": "2020-09-03T10:03:31Z", "message": "Refactors and simplifies parameter logging\n\nFixes: OX-6144"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNzIwMDIz", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481720023", "createdAt": "2020-09-03T10:49:43Z", "commit": {"oid": "b6d3e70b56e9a5d1fab3b689f162d4a6c12859aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNzI3MjY4", "url": "https://github.com/scireum/sirius-biz/pull/850#pullrequestreview-481727268", "createdAt": "2020-09-03T11:00:14Z", "commit": {"oid": "b6d3e70b56e9a5d1fab3b689f162d4a6c12859aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4418, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}