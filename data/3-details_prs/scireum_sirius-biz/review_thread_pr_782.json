{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1MTY3Nzk0", "number": 782, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNTo1NjozMVrOEGNCew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNjoyMDo1MVrOEGNXkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTQwNTM5OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/storage/layer2/BlobDispatcher.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNTo1NjozMVrOGk2ptQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNTo1NjozMVrOGk2ptQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI5NzMzMw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param blobKey the blob key to be delivered\n          \n          \n            \n                 * @param blobKey    the blob key to be delivered", "url": "https://github.com/scireum/sirius-biz/pull/782#discussion_r441297333", "createdAt": "2020-06-17T05:56:31Z", "author": {"login": "jmuscireum"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobDispatcher.java", "diffHunk": "@@ -283,12 +306,14 @@ private String stripAdditionalText(String input) {\n      * @param request     the request to handle\n      * @param space       the space which is accessed\n      * @param accessToken the security token to verify\n+     * @param blobKey the blob key to be delivered", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08e64a151975b0e7d213ba86cf78cc0e0fad845f"}, "originalPosition": 98}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTQwNjY3OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/storage/layer2/BlobStorageSpace.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNTo1NzowNVrOGk2qZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNTo1NzowNVrOGk2qZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI5NzUxMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Delivers the contents of the given blob by using the alredy known physicalKey.\n          \n          \n            \n                 * Delivers the contents of the given blob by using the already known physicalKey.", "url": "https://github.com/scireum/sirius-biz/pull/782#discussion_r441297510", "createdAt": "2020-06-17T05:57:05Z", "author": {"login": "jmuscireum"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobStorageSpace.java", "diffHunk": "@@ -256,10 +258,36 @@\n      */\n     void deliver(@Nonnull String blobKey, @Nonnull String variant, @Nonnull Response response);\n \n+    /**\n+     * Delivers the contents of the given blob by using the alredy known physicalKey.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08e64a151975b0e7d213ba86cf78cc0e0fad845f"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTQ1ODYwOnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/storage/layer2/BlobDispatcher.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNjoyMDozN1rOGk3Kfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNjoyMDozN1rOGk3Kfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMwNTcyNw==", "bodyText": "would be nice of such changes would be an extra commit with an explaining commit message", "url": "https://github.com/scireum/sirius-biz/pull/782#discussion_r441305727", "createdAt": "2020-06-17T06:20:37Z", "author": {"login": "sabieber"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobDispatcher.java", "diffHunk": "@@ -157,21 +153,48 @@ public DispatchDecision dispatch(WebContext request) throws Exception {\n         Values uriParts = Values.of(uri.split(\"/\"));\n         String type = uriParts.at(0).asString();\n         if (Strings.areEqual(type, PHYSICAL_DELIVERY)) {\n-            String filename = stripAdditionalText(uriParts.at(3).asString());\n-            physicalDelivery(request,\n-                             uriParts.at(1).asString(),\n-                             uriParts.at(2).asString(),\n-                             Files.getFilenameWithoutExtension(filename),\n-                             filename);\n+            if (uriParts.length() == 4) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5c9c7a7f96769a7fba428d24c6118dd13060613"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTQ1OTM5OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/storage/layer2/BlobDispatcher.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNjoyMDo1MVrOGk3K-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNjoyMDo1MVrOGk3K-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMwNTg0OQ==", "bodyText": "Reference Ticket?", "url": "https://github.com/scireum/sirius-biz/pull/782#discussion_r441305849", "createdAt": "2020-06-17T06:20:51Z", "author": {"login": "sabieber"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobDispatcher.java", "diffHunk": "@@ -157,21 +153,48 @@ public DispatchDecision dispatch(WebContext request) throws Exception {\n         Values uriParts = Values.of(uri.split(\"/\"));\n         String type = uriParts.at(0).asString();\n         if (Strings.areEqual(type, PHYSICAL_DELIVERY)) {\n-            String filename = stripAdditionalText(uriParts.at(3).asString());\n-            physicalDelivery(request,\n-                             uriParts.at(1).asString(),\n-                             uriParts.at(2).asString(),\n-                             Files.getFilenameWithoutExtension(filename),\n-                             filename);\n+            if (uriParts.length() == 4) {\n+                // Support for legacy URLS (where the blob key is missing)\n+                // TODO delete by Sept 2020", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c5c9c7a7f96769a7fba428d24c6118dd13060613"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1922, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}