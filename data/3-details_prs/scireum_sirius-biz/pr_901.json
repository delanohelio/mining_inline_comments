{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3NTM3NTU5", "number": 901, "title": "Only handle upload as job file if it is not empty", "bodyText": "due to sftp changes jobsroot get now also gets supplied with empty files\nthose get ignored\nreusage of blobs not desired here, as jobsroot isn't a regular filesystem with regards to uniqueness of filenames\n\nFixes: SE-10139", "createdAt": "2020-11-09T07:10:51Z", "url": "https://github.com/scireum/sirius-biz/pull/901", "merged": true, "mergeCommit": {"oid": "3ba593d674feb673c979cffa8b12c8d0e49460dd"}, "closed": true, "closedAt": "2020-11-09T10:43:26Z", "author": {"login": "mkeckmkeck"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdavXJMgH2gAyNTE3NTM3NTU5OmUxNDE2ZGQ5OTJlY2Q3OWVjYjhiMWE1ZmE2MzAxMWVmMTBlOWY4YWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdav6bAgFqTUyNTk5Mzk1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e1416dd992ecd79ecb8b1a5fa63011ef10e9f8ae", "author": {"user": {"login": "mkeckmkeck", "name": "Matthias Keck"}}, "url": "https://github.com/scireum/sirius-biz/commit/e1416dd992ecd79ecb8b1a5fa63011ef10e9f8ae", "committedDate": "2020-11-09T07:10:05Z", "message": "Only handle upload as job file if it is not empty\n\n- due to sftp changes jobsroot get now also gets supplied with empty files\n- those get ignored\n- reusage of blobs not desired here, as jobsroot isn't a regular filesystem with regards to uniqueness of filenames\n\nFixes: SE-10139"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1OTc1NjYy", "url": "https://github.com/scireum/sirius-biz/pull/901#pullrequestreview-525975662", "createdAt": "2020-11-09T07:14:01Z", "commit": {"oid": "e1416dd992ecd79ecb8b1a5fa63011ef10e9f8ae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1OTc2MzM5", "url": "https://github.com/scireum/sirius-biz/pull/901#pullrequestreview-525976339", "createdAt": "2020-11-09T07:14:41Z", "commit": {"oid": "e1416dd992ecd79ecb8b1a5fa63011ef10e9f8ae"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwNzoxNDo0MlrOHvhTmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwNzoxNDo0MlrOHvhTmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTU5MDgwOA==", "bodyText": "else { delete... } ?", "url": "https://github.com/scireum/sirius-biz/pull/901#discussion_r519590808", "createdAt": "2020-11-09T07:14:42Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/jobs/JobsRoot.java", "diffHunk": "@@ -153,8 +152,10 @@ private OutputStream uploadAndTrigger(JobPreset preset, String filename) {\n             BlobStorageSpace temporaryStorageSpace = blobStorage.getSpace(TmpRoot.TMP_SPACE);\n             Blob buffer = temporaryStorageSpace.createTemporaryBlob(UserContext.getCurrentUser().getTenantId());\n             return buffer.createOutputStream(() -> {\n-                temporaryStorageSpace.markAsUsed(buffer);\n-                trigger(preset, buffer, filename);\n+                if (buffer.getSize() > 0) {\n+                    temporaryStorageSpace.markAsUsed(buffer);\n+                    trigger(preset, buffer, filename);\n+                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1416dd992ecd79ecb8b1a5fa63011ef10e9f8ae"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c20b9f44252302bb813cecc9be9601a8de1312c", "author": {"user": {"login": "mkeckmkeck", "name": "Matthias Keck"}}, "url": "https://github.com/scireum/sirius-biz/commit/6c20b9f44252302bb813cecc9be9601a8de1312c", "committedDate": "2020-11-09T07:20:12Z", "message": "Directly delete unnecessary file at jobsroot sftp upload\n\nFixes: SE-10139"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1OTgwMTE2", "url": "https://github.com/scireum/sirius-biz/pull/901#pullrequestreview-525980116", "createdAt": "2020-11-09T07:22:45Z", "commit": {"oid": "6c20b9f44252302bb813cecc9be9601a8de1312c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1OTgzNjQw", "url": "https://github.com/scireum/sirius-biz/pull/901#pullrequestreview-525983640", "createdAt": "2020-11-09T07:29:48Z", "commit": {"oid": "6c20b9f44252302bb813cecc9be9601a8de1312c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1OTg0NTI5", "url": "https://github.com/scireum/sirius-biz/pull/901#pullrequestreview-525984529", "createdAt": "2020-11-09T07:31:30Z", "commit": {"oid": "6c20b9f44252302bb813cecc9be9601a8de1312c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1OTkzOTUz", "url": "https://github.com/scireum/sirius-biz/pull/901#pullrequestreview-525993953", "createdAt": "2020-11-09T07:48:37Z", "commit": {"oid": "6c20b9f44252302bb813cecc9be9601a8de1312c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4231, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}