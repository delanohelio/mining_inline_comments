{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2Njg3NzY4", "number": 727, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMzo1NTowMlrOD0Qe6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNDowMDoxMlrOD0Qpug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MTIyNjAwOnYy", "diffSide": "RIGHT", "path": "src/test/java/sirius/biz/storage/layer2/BlobHardRefSpec.groovy", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMzo1NTowMlrOGJHCyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDowNDoyM1rOGJuPZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwNTc2OA==", "bodyText": "oma.refresh oder or oma.findOrFail", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412205768", "createdAt": "2020-04-21T13:55:02Z", "author": {"login": "andyHa"}, "path": "src/test/java/sirius/biz/storage/layer2/BlobHardRefSpec.groovy", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2\n+\n+import sirius.db.jdbc.OMA\n+import sirius.kernel.BaseSpecification\n+import sirius.kernel.di.std.Part\n+\n+class BlobHardRefSpec extends BaseSpecification {\n+\n+    @Part\n+    private static OMA oma;\n+\n+    @Part\n+    private static BlobStorage blobStorage;\n+\n+    def \"store entity with unchanged hard ref blob must not fail\"() {\n+        given:\n+        def testEntity = new BlobHardRefEntity()\n+        Blob blob = blobStorage.getSpace(\"blob-files\").createTemporaryBlob()\n+        testEntity.getTheBlobRef().setBlob(blob)\n+        oma.update(testEntity)\n+        when:\n+        def loadedEntity = oma.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjg0Nzk3NQ==", "bodyText": "done", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412847975", "createdAt": "2020-04-22T10:04:23Z", "author": {"login": "mkeckmkeck"}, "path": "src/test/java/sirius/biz/storage/layer2/BlobHardRefSpec.groovy", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2\n+\n+import sirius.db.jdbc.OMA\n+import sirius.kernel.BaseSpecification\n+import sirius.kernel.di.std.Part\n+\n+class BlobHardRefSpec extends BaseSpecification {\n+\n+    @Part\n+    private static OMA oma;\n+\n+    @Part\n+    private static BlobStorage blobStorage;\n+\n+    def \"store entity with unchanged hard ref blob must not fail\"() {\n+        given:\n+        def testEntity = new BlobHardRefEntity()\n+        Blob blob = blobStorage.getSpace(\"blob-files\").createTemporaryBlob()\n+        testEntity.getTheBlobRef().setBlob(blob)\n+        oma.update(testEntity)\n+        when:\n+        def loadedEntity = oma.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwNTc2OA=="}, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MTIzMDI0OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/storage/layer2/BlobRefProperty.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMzo1NTo1MFrOGJHFbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDowMzo1N1rOGJuOHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwNjQ0NA==", "bodyText": "protected or package visibility?", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412206444", "createdAt": "2020-04-21T13:55:50Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobRefProperty.java", "diffHunk": "@@ -0,0 +1,126 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2;\n+\n+import sirius.db.jdbc.OMA;\n+import sirius.db.jdbc.schema.SQLPropertyInfo;\n+import sirius.db.jdbc.schema.Table;\n+import sirius.db.jdbc.schema.TableColumn;\n+import sirius.db.mixing.AccessPath;\n+import sirius.db.mixing.BaseEntity;\n+import sirius.db.mixing.EntityDescriptor;\n+import sirius.db.mixing.Property;\n+import sirius.kernel.commons.Value;\n+import sirius.kernel.health.Exceptions;\n+\n+import javax.annotation.Nonnull;\n+import java.lang.reflect.Field;\n+import java.sql.Types;\n+\n+/**\n+ * Holder of common parts of blob reference property handling.\n+ * <p>\n+ * NOTE: This implementation assumes that BlobHardRef stays the parent class for all blob reference\n+ * property classes, which should be valid because hard and soft references should be enough.\n+ */\n+public abstract class BlobRefProperty extends Property implements SQLPropertyInfo {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjg0NzY0NQ==", "bodyText": "done", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412847645", "createdAt": "2020-04-22T10:03:57Z", "author": {"login": "mkeckmkeck"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobRefProperty.java", "diffHunk": "@@ -0,0 +1,126 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2;\n+\n+import sirius.db.jdbc.OMA;\n+import sirius.db.jdbc.schema.SQLPropertyInfo;\n+import sirius.db.jdbc.schema.Table;\n+import sirius.db.jdbc.schema.TableColumn;\n+import sirius.db.mixing.AccessPath;\n+import sirius.db.mixing.BaseEntity;\n+import sirius.db.mixing.EntityDescriptor;\n+import sirius.db.mixing.Property;\n+import sirius.kernel.commons.Value;\n+import sirius.kernel.health.Exceptions;\n+\n+import javax.annotation.Nonnull;\n+import java.lang.reflect.Field;\n+import java.sql.Types;\n+\n+/**\n+ * Holder of common parts of blob reference property handling.\n+ * <p>\n+ * NOTE: This implementation assumes that BlobHardRef stays the parent class for all blob reference\n+ * property classes, which should be valid because hard and soft references should be enough.\n+ */\n+public abstract class BlobRefProperty extends Property implements SQLPropertyInfo {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwNjQ0NA=="}, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MTIzMzk1OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/storage/layer2/BlobRefProperty.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMzo1NjoyOVrOGJHHlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDowNDo1M1rOGJuQmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwNjk5OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return <tt>true</tt> if unchanged, else <tt>false</tt>\n          \n          \n            \n                 * @return <tt>true</tt> if changed, <tt>false</tt> otherwise", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412206998", "createdAt": "2020-04-21T13:56:29Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobRefProperty.java", "diffHunk": "@@ -0,0 +1,126 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2;\n+\n+import sirius.db.jdbc.OMA;\n+import sirius.db.jdbc.schema.SQLPropertyInfo;\n+import sirius.db.jdbc.schema.Table;\n+import sirius.db.jdbc.schema.TableColumn;\n+import sirius.db.mixing.AccessPath;\n+import sirius.db.mixing.BaseEntity;\n+import sirius.db.mixing.EntityDescriptor;\n+import sirius.db.mixing.Property;\n+import sirius.kernel.commons.Value;\n+import sirius.kernel.health.Exceptions;\n+\n+import javax.annotation.Nonnull;\n+import java.lang.reflect.Field;\n+import java.sql.Types;\n+\n+/**\n+ * Holder of common parts of blob reference property handling.\n+ * <p>\n+ * NOTE: This implementation assumes that BlobHardRef stays the parent class for all blob reference\n+ * property classes, which should be valid because hard and soft references should be enough.\n+ */\n+public abstract class BlobRefProperty extends Property implements SQLPropertyInfo {\n+\n+    protected static final int DEFAULT_KEY_LENGTH = 64;\n+\n+    /**\n+     * Creates a new property for the given descriptor, access path and field.\n+     *\n+     * @param descriptor the descriptor which owns the property\n+     * @param accessPath the access path required to obtain the target object which contains the field\n+     * @param field      the field which stores the database value\n+     */\n+    protected BlobRefProperty(@Nonnull EntityDescriptor descriptor,\n+                              @Nonnull AccessPath accessPath,\n+                              @Nonnull Field field) {\n+        super(descriptor, accessPath, field);\n+    }\n+\n+    /**\n+     * Gets a {@link BlobHardRef} for the given entity.\n+     *\n+     * @param entity The entity to get the reference from\n+     * @return a {@link BlobHardRef} or a subclass of it\n+     */\n+    protected BlobHardRef getRef(Object entity) {\n+        try {\n+            return (BlobHardRef) super.getValueFromField(this.accessPath.apply(entity));\n+        } catch (Exception e) {\n+            throw Exceptions.handle()\n+                            .to(OMA.LOG)\n+                            .error(e)\n+                            .withSystemErrorMessage(\n+                                    \"Unable to obtain a reference object from entity ref field ('%s' in '%s'): %s (%s)\",\n+                                    getName(),\n+                                    descriptor.getType().getName())\n+                            .handle();\n+        }\n+    }\n+\n+    @Override\n+    protected Object getValueFromField(Object target) {\n+        return getRef(target).getKey();\n+    }\n+\n+    @Override\n+    public Object transformValue(Value value) {\n+        return value.get();\n+    }\n+\n+    @Override\n+    protected Object transformToJDBC(Object object) {\n+        return object;\n+    }\n+\n+    @Override\n+    protected Object transformFromJDBC(Value object) {\n+        return object.get();\n+    }\n+\n+    @Override\n+    public void setValue(Object entity, Object object) {\n+        this.setValueToField(object, entity);\n+    }\n+\n+    /**\n+     * Sets the given value on the target entity as either a blob or a key depending on the value.\n+     *\n+     * @param value        The value to be set\n+     * @param targetEntity The entity to be set on\n+     */\n+    protected void setValueToField(Object value, Object targetEntity) {\n+        BlobHardRef ref = getRef(targetEntity);\n+\n+        if (value == null || value instanceof Blob) {\n+            ref.setBlob((Blob) value);\n+        } else {\n+            ref.setKey((String) value);\n+        }\n+    }\n+\n+    @Override\n+    public void contributeToTable(Table table) {\n+        table.getColumns().add(new TableColumn(this, Types.CHAR));\n+    }\n+\n+    /**\n+     * Checks if the blob reference on the entity has changed since loading from DB.\n+     *\n+     * @param entity the entity to check\n+     * @return <tt>true</tt> if unchanged, else <tt>false</tt>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwNzQ2Ng==", "bodyText": "the first part is the real change - second is just the common way to express the \"else\" part :)", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412207466", "createdAt": "2020-04-21T13:57:00Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobRefProperty.java", "diffHunk": "@@ -0,0 +1,126 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2;\n+\n+import sirius.db.jdbc.OMA;\n+import sirius.db.jdbc.schema.SQLPropertyInfo;\n+import sirius.db.jdbc.schema.Table;\n+import sirius.db.jdbc.schema.TableColumn;\n+import sirius.db.mixing.AccessPath;\n+import sirius.db.mixing.BaseEntity;\n+import sirius.db.mixing.EntityDescriptor;\n+import sirius.db.mixing.Property;\n+import sirius.kernel.commons.Value;\n+import sirius.kernel.health.Exceptions;\n+\n+import javax.annotation.Nonnull;\n+import java.lang.reflect.Field;\n+import java.sql.Types;\n+\n+/**\n+ * Holder of common parts of blob reference property handling.\n+ * <p>\n+ * NOTE: This implementation assumes that BlobHardRef stays the parent class for all blob reference\n+ * property classes, which should be valid because hard and soft references should be enough.\n+ */\n+public abstract class BlobRefProperty extends Property implements SQLPropertyInfo {\n+\n+    protected static final int DEFAULT_KEY_LENGTH = 64;\n+\n+    /**\n+     * Creates a new property for the given descriptor, access path and field.\n+     *\n+     * @param descriptor the descriptor which owns the property\n+     * @param accessPath the access path required to obtain the target object which contains the field\n+     * @param field      the field which stores the database value\n+     */\n+    protected BlobRefProperty(@Nonnull EntityDescriptor descriptor,\n+                              @Nonnull AccessPath accessPath,\n+                              @Nonnull Field field) {\n+        super(descriptor, accessPath, field);\n+    }\n+\n+    /**\n+     * Gets a {@link BlobHardRef} for the given entity.\n+     *\n+     * @param entity The entity to get the reference from\n+     * @return a {@link BlobHardRef} or a subclass of it\n+     */\n+    protected BlobHardRef getRef(Object entity) {\n+        try {\n+            return (BlobHardRef) super.getValueFromField(this.accessPath.apply(entity));\n+        } catch (Exception e) {\n+            throw Exceptions.handle()\n+                            .to(OMA.LOG)\n+                            .error(e)\n+                            .withSystemErrorMessage(\n+                                    \"Unable to obtain a reference object from entity ref field ('%s' in '%s'): %s (%s)\",\n+                                    getName(),\n+                                    descriptor.getType().getName())\n+                            .handle();\n+        }\n+    }\n+\n+    @Override\n+    protected Object getValueFromField(Object target) {\n+        return getRef(target).getKey();\n+    }\n+\n+    @Override\n+    public Object transformValue(Value value) {\n+        return value.get();\n+    }\n+\n+    @Override\n+    protected Object transformToJDBC(Object object) {\n+        return object;\n+    }\n+\n+    @Override\n+    protected Object transformFromJDBC(Value object) {\n+        return object.get();\n+    }\n+\n+    @Override\n+    public void setValue(Object entity, Object object) {\n+        this.setValueToField(object, entity);\n+    }\n+\n+    /**\n+     * Sets the given value on the target entity as either a blob or a key depending on the value.\n+     *\n+     * @param value        The value to be set\n+     * @param targetEntity The entity to be set on\n+     */\n+    protected void setValueToField(Object value, Object targetEntity) {\n+        BlobHardRef ref = getRef(targetEntity);\n+\n+        if (value == null || value instanceof Blob) {\n+            ref.setBlob((Blob) value);\n+        } else {\n+            ref.setKey((String) value);\n+        }\n+    }\n+\n+    @Override\n+    public void contributeToTable(Table table) {\n+        table.getColumns().add(new TableColumn(this, Types.CHAR));\n+    }\n+\n+    /**\n+     * Checks if the blob reference on the entity has changed since loading from DB.\n+     *\n+     * @param entity the entity to check\n+     * @return <tt>true</tt> if unchanged, else <tt>false</tt>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwNjk5OA=="}, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjg0ODI4Mw==", "bodyText": "done", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412848283", "createdAt": "2020-04-22T10:04:53Z", "author": {"login": "mkeckmkeck"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobRefProperty.java", "diffHunk": "@@ -0,0 +1,126 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2;\n+\n+import sirius.db.jdbc.OMA;\n+import sirius.db.jdbc.schema.SQLPropertyInfo;\n+import sirius.db.jdbc.schema.Table;\n+import sirius.db.jdbc.schema.TableColumn;\n+import sirius.db.mixing.AccessPath;\n+import sirius.db.mixing.BaseEntity;\n+import sirius.db.mixing.EntityDescriptor;\n+import sirius.db.mixing.Property;\n+import sirius.kernel.commons.Value;\n+import sirius.kernel.health.Exceptions;\n+\n+import javax.annotation.Nonnull;\n+import java.lang.reflect.Field;\n+import java.sql.Types;\n+\n+/**\n+ * Holder of common parts of blob reference property handling.\n+ * <p>\n+ * NOTE: This implementation assumes that BlobHardRef stays the parent class for all blob reference\n+ * property classes, which should be valid because hard and soft references should be enough.\n+ */\n+public abstract class BlobRefProperty extends Property implements SQLPropertyInfo {\n+\n+    protected static final int DEFAULT_KEY_LENGTH = 64;\n+\n+    /**\n+     * Creates a new property for the given descriptor, access path and field.\n+     *\n+     * @param descriptor the descriptor which owns the property\n+     * @param accessPath the access path required to obtain the target object which contains the field\n+     * @param field      the field which stores the database value\n+     */\n+    protected BlobRefProperty(@Nonnull EntityDescriptor descriptor,\n+                              @Nonnull AccessPath accessPath,\n+                              @Nonnull Field field) {\n+        super(descriptor, accessPath, field);\n+    }\n+\n+    /**\n+     * Gets a {@link BlobHardRef} for the given entity.\n+     *\n+     * @param entity The entity to get the reference from\n+     * @return a {@link BlobHardRef} or a subclass of it\n+     */\n+    protected BlobHardRef getRef(Object entity) {\n+        try {\n+            return (BlobHardRef) super.getValueFromField(this.accessPath.apply(entity));\n+        } catch (Exception e) {\n+            throw Exceptions.handle()\n+                            .to(OMA.LOG)\n+                            .error(e)\n+                            .withSystemErrorMessage(\n+                                    \"Unable to obtain a reference object from entity ref field ('%s' in '%s'): %s (%s)\",\n+                                    getName(),\n+                                    descriptor.getType().getName())\n+                            .handle();\n+        }\n+    }\n+\n+    @Override\n+    protected Object getValueFromField(Object target) {\n+        return getRef(target).getKey();\n+    }\n+\n+    @Override\n+    public Object transformValue(Value value) {\n+        return value.get();\n+    }\n+\n+    @Override\n+    protected Object transformToJDBC(Object object) {\n+        return object;\n+    }\n+\n+    @Override\n+    protected Object transformFromJDBC(Value object) {\n+        return object.get();\n+    }\n+\n+    @Override\n+    public void setValue(Object entity, Object object) {\n+        this.setValueToField(object, entity);\n+    }\n+\n+    /**\n+     * Sets the given value on the target entity as either a blob or a key depending on the value.\n+     *\n+     * @param value        The value to be set\n+     * @param targetEntity The entity to be set on\n+     */\n+    protected void setValueToField(Object value, Object targetEntity) {\n+        BlobHardRef ref = getRef(targetEntity);\n+\n+        if (value == null || value instanceof Blob) {\n+            ref.setBlob((Blob) value);\n+        } else {\n+            ref.setKey((String) value);\n+        }\n+    }\n+\n+    @Override\n+    public void contributeToTable(Table table) {\n+        table.getColumns().add(new TableColumn(this, Types.CHAR));\n+    }\n+\n+    /**\n+     * Checks if the blob reference on the entity has changed since loading from DB.\n+     *\n+     * @param entity the entity to check\n+     * @return <tt>true</tt> if unchanged, else <tt>false</tt>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwNjk5OA=="}, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 120}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MTI1MTY1OnYy", "diffSide": "RIGHT", "path": "src/test/java/sirius/biz/storage/layer2/BlobHardRefSpec.groovy", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMzo1OTo0NVrOGJHSaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDowNTowOVrOGJuROg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwOTc3MQ==", "bodyText": "while being at it - maybe add another test for the happy path (meaning the given part of the test below as when: and in then: simply ensure that the blob is no longer temporary)\nand then delete the entity and check that the blob is marked as deleted :) (either in one case or in two cases)", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412209771", "createdAt": "2020-04-21T13:59:45Z", "author": {"login": "andyHa"}, "path": "src/test/java/sirius/biz/storage/layer2/BlobHardRefSpec.groovy", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2\n+\n+import sirius.db.jdbc.OMA\n+import sirius.kernel.BaseSpecification\n+import sirius.kernel.di.std.Part\n+\n+class BlobHardRefSpec extends BaseSpecification {\n+\n+    @Part\n+    private static OMA oma;\n+\n+    @Part\n+    private static BlobStorage blobStorage;\n+\n+    def \"store entity with unchanged hard ref blob must not fail\"() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjg0ODQ0Mg==", "bodyText": "done", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412848442", "createdAt": "2020-04-22T10:05:09Z", "author": {"login": "mkeckmkeck"}, "path": "src/test/java/sirius/biz/storage/layer2/BlobHardRefSpec.groovy", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.storage.layer2\n+\n+import sirius.db.jdbc.OMA\n+import sirius.kernel.BaseSpecification\n+import sirius.kernel.di.std.Part\n+\n+class BlobHardRefSpec extends BaseSpecification {\n+\n+    @Part\n+    private static OMA oma;\n+\n+    @Part\n+    private static BlobStorage blobStorage;\n+\n+    def \"store entity with unchanged hard ref blob must not fail\"() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIwOTc3MQ=="}, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MTI1MzcwOnYy", "diffSide": "RIGHT", "path": "src/test/resources/test.conf", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNDowMDoxMlrOGJHTzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMDowNTowMFrOGJuQ1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIxMDEyNw==", "bodyText": "just for the record - the description isn't necessary in test configs :)", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412210127", "createdAt": "2020-04-21T14:00:12Z", "author": {"login": "andyHa"}, "path": "src/test/resources/test.conf", "diffHunk": "@@ -182,6 +182,13 @@ storage {\n             reply-secondary {\n                 engine = \"s3\"\n             }\n+            blob-files {}\n+        }\n+    }\n+    layer2.spaces {\n+        blob-files {\n+                readPermission = \"disabled\"\n+                description = \"blob-files {}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjg0ODM0MA==", "bodyText": "done", "url": "https://github.com/scireum/sirius-biz/pull/727#discussion_r412848340", "createdAt": "2020-04-22T10:05:00Z", "author": {"login": "mkeckmkeck"}, "path": "src/test/resources/test.conf", "diffHunk": "@@ -182,6 +182,13 @@ storage {\n             reply-secondary {\n                 engine = \"s3\"\n             }\n+            blob-files {}\n+        }\n+    }\n+    layer2.spaces {\n+        blob-files {\n+                readPermission = \"disabled\"\n+                description = \"blob-files {}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIxMDEyNw=="}, "originalCommit": {"oid": "48ac972467dd6c5c96ec6fffab338b6f68b7a38b"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2048, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}