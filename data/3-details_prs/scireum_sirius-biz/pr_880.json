{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0MDMyODU3", "number": 880, "title": "Implement a taglib for selecting a file for a blobSoftRef", "bodyText": "", "createdAt": "2020-10-15T11:33:33Z", "url": "https://github.com/scireum/sirius-biz/pull/880", "merged": true, "mergeCommit": {"oid": "ac70affb299e456cffedeb87927a350f89182c66"}, "closed": true, "closedAt": "2020-10-16T11:00:15Z", "author": {"login": "jmuscireum"}, "timelineItems": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSv7LfgH2gAyNTA0MDMyODU3OjkxMDg3MThkMGY4OTJjYzU2ODMxOTdiMDcyMDI0YjAwNTczZDg3ODk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdTEREyAFqTUxMDM2NjQzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9108718d0f892cc5683197b072024b00573d8789", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/9108718d0f892cc5683197b072024b00573d8789", "committedDate": "2020-10-15T11:18:03Z", "message": "Introduce a route for fetching the blob info of a given path\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "653e6bba032806d2395e8d4cffcf7e0696252008", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/653e6bba032806d2395e8d4cffcf7e0696252008", "committedDate": "2020-10-15T11:23:43Z", "message": "Allow to restrict the file select modal to one directory\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/d0dc12792aeca8f2730390cedee4210254de2335", "committedDate": "2020-10-15T11:31:42Z", "message": "Implement a taglib for selecting a file for a blobSoftRef\n\nFixes: SE-10084"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5Mjg5NDg4", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-509289488", "createdAt": "2020-10-15T11:44:41Z", "commit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5MjkwMzg1", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-509290385", "createdAt": "2020-10-15T11:45:59Z", "commit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTo0NTo1OVrOHiD0fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTo0NTo1OVrOHiD0fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ3NjIyMg==", "bodyText": "what does the prefix 'dasd' stand for?", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r505476222", "createdAt": "2020-10-15T11:45:59Z", "author": {"login": "meg1502"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobController.java", "diffHunk": "@@ -86,4 +85,39 @@ public void uploadFile(final WebContext ctx,\n                             .handle();\n         }\n     }\n+\n+    /**\n+     * Find the {@link Blob} for a given path and returns info about it.\n+     *\n+     * @param webContext the request to handle\n+     * @param out        the response to the AJAX call\n+     * @param spaceName  the {@link BlobStorageSpace} to find the object in\n+     */\n+    @Routed(value = \"/dasd/blob-info-for-path/:1\", jsonCall = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5Mjk0NTEx", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-509294511", "createdAt": "2020-10-15T11:51:36Z", "commit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTo1MTozNlrOHiEAjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTo1MTozNlrOHiEAjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ3OTMwOQ==", "bodyText": "if you just call one function with this, pretty pointless to define these const IMO", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r505479309", "createdAt": "2020-10-15T11:51:36Z", "author": {"login": "meg1502"}, "path": "src/main/resources/default/taglib/w/blobSoftRefField.html.pasta", "diffHunk": "@@ -0,0 +1,61 @@\n+<i:arg type=\"sirius.biz.storage.layer2.BlobSoftRef\" name=\"blobRef\"/>\n+<i:arg type=\"String\" name=\"id\" default=\"@('blob-soft-ref-' + call.generateLocalId())\"/>\n+<i:arg type=\"String\" name=\"inputId\"/>\n+<i:arg type=\"String\" name=\"defaultPreview\" default=\"\"/>\n+<i:arg type=\"boolean\" name=\"urlAllowed\" default=\"@blobRef.isSupportsURL()\" description=\"\"/>\n+<i:arg type=\"boolean\" name=\"showResetButton\" default=\"@blobRef.isFilled()\"/>\n+\n+<div id=\"@id\" class=\"blob-ref-field\">\n+    <div class=\"file file-js\"></div>\n+\n+    <button type=\"button\" class=\"btn btn-primary btn-block btn-select-file-js\">\n+        @i18n(\"StoredObject.uploadBtn\")\n+    </button>\n+\n+    <i:if test=\"@urlAllowed\">\n+        <button type=\"button\" class=\"btn btn-block\" data-placement=\"top\" data-toggle=\"popover\">\n+            @i18n(\"StoredObject.specifyURL\")\n+        </button>\n+\n+        <div class=\"popover-content hide\">\n+            <div class=\"row\">\n+                <div class=\"col-md-12\">\n+                    <div class=\"form-group\">\n+                        <label>@i18n(\"StoredObject.URL\")</label>\n+                        <input type=\"text\" class=\"form-control\">\n+                    </div>\n+                </div>\n+\n+                <div class=\"col-md-6\">\n+                    <button type=\"button\" class=\"btn btn-block btn-primary button-apply\">\n+                        <i class=\"fa fa-check\"></i> @i18n(\"NLS.ok\")\n+                    </button>\n+                </div>\n+\n+                <div class=\"col-md-6\">\n+                    <button type=\"button\" class=\"btn btn-block button-close\">\n+                        @i18n(\"NLS.cancel\")\n+                    </button>\n+                </div>\n+            </div>\n+        </div>\n+    </i:if>\n+\n+    <button type=\"button\" class=\"btn btn-block btn-reset-js @if(!showResetButton) { hide }\">\n+        @i18n(\"StoredObject.resetBtn\")\n+    </button>\n+</div>\n+\n+<script type=\"text/javascript\">\n+    $(document).ready(function () {\n+        const $element = $('#___id');\n+        const $blobKeyField = $('#___inputId');\n+        const blobStorageSpace = '___blobRef.getSpace()';\n+        const url = '___blobRef.url().asDownload().buildURL().orElse(\"\")';\n+        const filename = '___blobRef.getFilename()';\n+        const path = '___blobRef.getPath()';\n+        const defaultPreview = '___defaultPreview';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5Mjk3Mzg0", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-509297384", "createdAt": "2020-10-15T11:55:41Z", "commit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTo1NTo0MlrOHiEI-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMTo1NjoxMFrOHiEJ_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ4MTQ2NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Find the {@link Blob} for a given path and returns info about it.\n          \n          \n            \n                 * Finds the {@link Blob} for a given path and returns info about it.", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r505481465", "createdAt": "2020-10-15T11:55:42Z", "author": {"login": "bwiedmann"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobController.java", "diffHunk": "@@ -86,4 +85,39 @@ public void uploadFile(final WebContext ctx,\n                             .handle();\n         }\n     }\n+\n+    /**\n+     * Find the {@link Blob} for a given path and returns info about it.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTQ4MTcyNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Initialize the given blobSoftRefField\n          \n          \n            \n             * Initializes the given blobSoftRefField", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r505481725", "createdAt": "2020-10-15T11:56:10Z", "author": {"login": "bwiedmann"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -0,0 +1,237 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+/**\n+ * Initialize the given blobSoftRefField", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d0dc12792aeca8f2730390cedee4210254de2335"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9754af7a3eae4764bcb8349641ec4350d26d871a", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/9754af7a3eae4764bcb8349641ec4350d26d871a", "committedDate": "2020-10-15T13:38:00Z", "message": "Fix typos\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71730aa59f6f2ae1abece1d3072afa681923420d", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/71730aa59f6f2ae1abece1d3072afa681923420d", "committedDate": "2020-10-15T13:38:21Z", "message": "Only include the js once\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5029b061a42cda5f29070ee53cfb17dd808fba1", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/d5029b061a42cda5f29070ee53cfb17dd808fba1", "committedDate": "2020-10-15T13:40:36Z", "message": "Move CSS\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee2b213352a2ef36a69c880720e02fc71fe3a398", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/ee2b213352a2ef36a69c880720e02fc71fe3a398", "committedDate": "2020-10-15T13:42:30Z", "message": "Remove unnecessary escaped @\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a16ea1e45640bb7a0c59252116d89c7d2fe2c117", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/a16ea1e45640bb7a0c59252116d89c7d2fe2c117", "committedDate": "2020-10-15T14:18:38Z", "message": "Add a missing arg\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/d1d10bafe8882070a601d8f9b792749bf2d95a31", "committedDate": "2020-10-16T06:17:30Z", "message": "Only use jQuery where absolutely required\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b67a17ff1b296d891895eb30bce0530a5c7b0afd", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/b67a17ff1b296d891895eb30bce0530a5c7b0afd", "committedDate": "2020-10-16T06:40:26Z", "message": "Fix the upload when a file is already referenced\n\n/fs/list can accept a file path to list the contents of the parent\ndirectory. But /fs/upload will throw an error, which will prevent the\nupload if a file is already referenced.\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75f1684e7f5e3701fc44ed659bbf46f62e1d90ef", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/75f1684e7f5e3701fc44ed659bbf46f62e1d90ef", "committedDate": "2020-10-16T06:41:31Z", "message": "Fix the upload in jobs when a file is already selected\n\n/fs/list can accept a file path to list the contents of the parent\ndirectory. But /fs/upload will throw an error, which will prevent the\nupload if a file is already selected."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMTk0Nzgw", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510194780", "createdAt": "2020-10-16T06:47:32Z", "commit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwNjo0NzozMlrOHipkDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwNjo1MjowN1rOHipwsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NDYwNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                element.setAttribute('data-path', originalPath);\n          \n          \n            \n                element.dataset.path = originalPath;", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506094604", "createdAt": "2020-10-16T06:47:32Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NDkwNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    closeButton.addEventListener('click', function (e) {\n          \n          \n            \n                        e.preventDefault();\n          \n          \n            \n                    closeButton.addEventListener('click', function (event) {\n          \n          \n            \n                        event.preventDefault();", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506094904", "createdAt": "2020-10-16T06:48:16Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);\n \n-    $urlButton.popover({\n+    $(urlButton).popover({\n         html: true, trigger: 'manual', content: function () {\n-            return $element.find('.popover-content').html();\n+            return element.querySelector('.popover-content').innerHTML;\n         }\n     });\n \n-    $urlButton.on('inserted.bs.popover', function () {\n-        const $popup = $(this);\n-        const $closeButton = $popup.next('.popover').find('.button-close');\n-        const $applyButton = $popup.next('.popover').find('.button-apply');\n-        const $input = $popup.next('.popover').find('input');\n+    $(urlButton).on('inserted.bs.popover', function () {\n+        const popover = urlButton.parentElement.querySelector('.popover');\n+        const closeButton = popover.querySelector('.button-close');\n+        const applyButton = popover.querySelector('.button-apply');\n+        const input = popover.querySelector('input');\n \n-        $closeButton.click(function () {\n-            $popup.popover('hide');\n+        closeButton.addEventListener('click', function (e) {\n+            e.preventDefault();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NTQzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    input.addEventListener('keyup', function (e) {\n          \n          \n            \n                        if (e.which === 13) {\n          \n          \n            \n                    input.addEventListener('keyup', function (event) {\n          \n          \n            \n                        if (event.key === 'Enter') {", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506095436", "createdAt": "2020-10-16T06:49:25Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);\n \n-    $urlButton.popover({\n+    $(urlButton).popover({\n         html: true, trigger: 'manual', content: function () {\n-            return $element.find('.popover-content').html();\n+            return element.querySelector('.popover-content').innerHTML;\n         }\n     });\n \n-    $urlButton.on('inserted.bs.popover', function () {\n-        const $popup = $(this);\n-        const $closeButton = $popup.next('.popover').find('.button-close');\n-        const $applyButton = $popup.next('.popover').find('.button-apply');\n-        const $input = $popup.next('.popover').find('input');\n+    $(urlButton).on('inserted.bs.popover', function () {\n+        const popover = urlButton.parentElement.querySelector('.popover');\n+        const closeButton = popover.querySelector('.button-close');\n+        const applyButton = popover.querySelector('.button-apply');\n+        const input = popover.querySelector('input');\n \n-        $closeButton.click(function () {\n-            $popup.popover('hide');\n+        closeButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            $(urlButton).popover('hide');\n         });\n \n-        $input.bind(\"input propertychange\", function () {\n-            checkURL($input.val(), $applyButton);\n+        input.addEventListener('input', function () {\n+            checkURL(input.value, applyButton);\n         });\n \n-        $input.keyup(function (e) {\n+        input.addEventListener('paste', function () {\n+            checkURL(input.value, applyButton);\n+        });\n+\n+        input.addEventListener('keyup', function (e) {\n             if (e.which === 13) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NTY1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    applyButton.addEventListener('click', function (e) {\n          \n          \n            \n                        e.preventDefault();\n          \n          \n            \n                    applyButton.addEventListener('click', function (event) {\n          \n          \n            \n                        event.preventDefault();", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506095651", "createdAt": "2020-10-16T06:49:40Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);\n \n-    $urlButton.popover({\n+    $(urlButton).popover({\n         html: true, trigger: 'manual', content: function () {\n-            return $element.find('.popover-content').html();\n+            return element.querySelector('.popover-content').innerHTML;\n         }\n     });\n \n-    $urlButton.on('inserted.bs.popover', function () {\n-        const $popup = $(this);\n-        const $closeButton = $popup.next('.popover').find('.button-close');\n-        const $applyButton = $popup.next('.popover').find('.button-apply');\n-        const $input = $popup.next('.popover').find('input');\n+    $(urlButton).on('inserted.bs.popover', function () {\n+        const popover = urlButton.parentElement.querySelector('.popover');\n+        const closeButton = popover.querySelector('.button-close');\n+        const applyButton = popover.querySelector('.button-apply');\n+        const input = popover.querySelector('input');\n \n-        $closeButton.click(function () {\n-            $popup.popover('hide');\n+        closeButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            $(urlButton).popover('hide');\n         });\n \n-        $input.bind(\"input propertychange\", function () {\n-            checkURL($input.val(), $applyButton);\n+        input.addEventListener('input', function () {\n+            checkURL(input.value, applyButton);\n         });\n \n-        $input.keyup(function (e) {\n+        input.addEventListener('paste', function () {\n+            checkURL(input.value, applyButton);\n+        });\n+\n+        input.addEventListener('keyup', function (e) {\n             if (e.which === 13) {\n-                updateURL($input.val());\n+                updateURL(input.value);\n             }\n         });\n \n-        $applyButton.click(function () {\n-            updateURL($input.val());\n+        applyButton.addEventListener('click', function (e) {\n+            e.preventDefault();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NTk2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                urlButton.addEventListener('click', function (e) {\n          \n          \n            \n                    e.preventDefault();\n          \n          \n            \n                urlButton.addEventListener('click', function (event) {\n          \n          \n            \n                    event.preventDefault();", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506095960", "createdAt": "2020-10-16T06:50:01Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);\n \n-    $urlButton.popover({\n+    $(urlButton).popover({\n         html: true, trigger: 'manual', content: function () {\n-            return $element.find('.popover-content').html();\n+            return element.querySelector('.popover-content').innerHTML;\n         }\n     });\n \n-    $urlButton.on('inserted.bs.popover', function () {\n-        const $popup = $(this);\n-        const $closeButton = $popup.next('.popover').find('.button-close');\n-        const $applyButton = $popup.next('.popover').find('.button-apply');\n-        const $input = $popup.next('.popover').find('input');\n+    $(urlButton).on('inserted.bs.popover', function () {\n+        const popover = urlButton.parentElement.querySelector('.popover');\n+        const closeButton = popover.querySelector('.button-close');\n+        const applyButton = popover.querySelector('.button-apply');\n+        const input = popover.querySelector('input');\n \n-        $closeButton.click(function () {\n-            $popup.popover('hide');\n+        closeButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            $(urlButton).popover('hide');\n         });\n \n-        $input.bind(\"input propertychange\", function () {\n-            checkURL($input.val(), $applyButton);\n+        input.addEventListener('input', function () {\n+            checkURL(input.value, applyButton);\n         });\n \n-        $input.keyup(function (e) {\n+        input.addEventListener('paste', function () {\n+            checkURL(input.value, applyButton);\n+        });\n+\n+        input.addEventListener('keyup', function (e) {\n             if (e.which === 13) {\n-                updateURL($input.val());\n+                updateURL(input.value);\n             }\n         });\n \n-        $applyButton.click(function () {\n-            updateURL($input.val());\n+        applyButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            updateURL(input.value);\n         });\n-    });\n \n-    $urlButton.click(function () {\n-        let url = $blobKeyField.val();\n+        let url = blobKeyField.value;\n \n         if (!url.startsWith('http://') && !url.startsWith('https://')) {\n             url = '';\n         }\n \n-        $(this).blur();\n-        $(this).popover('toggle');\n+        input.value = url;\n+        input.select();\n \n-        const $input = $(this).next('.popover').find('input');\n-        const $applyButton = $(this).next('.popover').find('.button-apply');\n+        checkURL(input.value, applyButton);\n+    });\n \n-        $input.val(url).select();\n+    urlButton.addEventListener('click', function (e) {\n+        e.preventDefault();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NjA1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                resetButton.addEventListener('click', function (e) {\n          \n          \n            \n                    e.preventDefault();\n          \n          \n            \n                resetButton.addEventListener('click', function (event) {\n          \n          \n            \n                    event.preventDefault();", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506096051", "createdAt": "2020-10-16T06:50:12Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);\n \n-    $urlButton.popover({\n+    $(urlButton).popover({\n         html: true, trigger: 'manual', content: function () {\n-            return $element.find('.popover-content').html();\n+            return element.querySelector('.popover-content').innerHTML;\n         }\n     });\n \n-    $urlButton.on('inserted.bs.popover', function () {\n-        const $popup = $(this);\n-        const $closeButton = $popup.next('.popover').find('.button-close');\n-        const $applyButton = $popup.next('.popover').find('.button-apply');\n-        const $input = $popup.next('.popover').find('input');\n+    $(urlButton).on('inserted.bs.popover', function () {\n+        const popover = urlButton.parentElement.querySelector('.popover');\n+        const closeButton = popover.querySelector('.button-close');\n+        const applyButton = popover.querySelector('.button-apply');\n+        const input = popover.querySelector('input');\n \n-        $closeButton.click(function () {\n-            $popup.popover('hide');\n+        closeButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            $(urlButton).popover('hide');\n         });\n \n-        $input.bind(\"input propertychange\", function () {\n-            checkURL($input.val(), $applyButton);\n+        input.addEventListener('input', function () {\n+            checkURL(input.value, applyButton);\n         });\n \n-        $input.keyup(function (e) {\n+        input.addEventListener('paste', function () {\n+            checkURL(input.value, applyButton);\n+        });\n+\n+        input.addEventListener('keyup', function (e) {\n             if (e.which === 13) {\n-                updateURL($input.val());\n+                updateURL(input.value);\n             }\n         });\n \n-        $applyButton.click(function () {\n-            updateURL($input.val());\n+        applyButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            updateURL(input.value);\n         });\n-    });\n \n-    $urlButton.click(function () {\n-        let url = $blobKeyField.val();\n+        let url = blobKeyField.value;\n \n         if (!url.startsWith('http://') && !url.startsWith('https://')) {\n             url = '';\n         }\n \n-        $(this).blur();\n-        $(this).popover('toggle');\n+        input.value = url;\n+        input.select();\n \n-        const $input = $(this).next('.popover').find('input');\n-        const $applyButton = $(this).next('.popover').find('.button-apply');\n+        checkURL(input.value, applyButton);\n+    });\n \n-        $input.val(url).select();\n+    urlButton.addEventListener('click', function (e) {\n+        e.preventDefault();\n+        urlButton.blur();\n \n-        checkURL($input.val(), $applyButton);\n+        $(urlButton).popover('toggle');\n     });\n \n-    $resetButton.click(function (e) {\n+    resetButton.addEventListener('click', function (e) {\n         e.preventDefault();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 118}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NjM4MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                selectButton.addEventListener('click', function (e) {\n          \n          \n            \n                    e.preventDefault();\n          \n          \n            \n                selectButton.addEventListener('click', function (event) {\n          \n          \n            \n                    event.preventDefault();", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506096380", "createdAt": "2020-10-16T06:50:32Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);\n \n-    $urlButton.popover({\n+    $(urlButton).popover({\n         html: true, trigger: 'manual', content: function () {\n-            return $element.find('.popover-content').html();\n+            return element.querySelector('.popover-content').innerHTML;\n         }\n     });\n \n-    $urlButton.on('inserted.bs.popover', function () {\n-        const $popup = $(this);\n-        const $closeButton = $popup.next('.popover').find('.button-close');\n-        const $applyButton = $popup.next('.popover').find('.button-apply');\n-        const $input = $popup.next('.popover').find('input');\n+    $(urlButton).on('inserted.bs.popover', function () {\n+        const popover = urlButton.parentElement.querySelector('.popover');\n+        const closeButton = popover.querySelector('.button-close');\n+        const applyButton = popover.querySelector('.button-apply');\n+        const input = popover.querySelector('input');\n \n-        $closeButton.click(function () {\n-            $popup.popover('hide');\n+        closeButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            $(urlButton).popover('hide');\n         });\n \n-        $input.bind(\"input propertychange\", function () {\n-            checkURL($input.val(), $applyButton);\n+        input.addEventListener('input', function () {\n+            checkURL(input.value, applyButton);\n         });\n \n-        $input.keyup(function (e) {\n+        input.addEventListener('paste', function () {\n+            checkURL(input.value, applyButton);\n+        });\n+\n+        input.addEventListener('keyup', function (e) {\n             if (e.which === 13) {\n-                updateURL($input.val());\n+                updateURL(input.value);\n             }\n         });\n \n-        $applyButton.click(function () {\n-            updateURL($input.val());\n+        applyButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            updateURL(input.value);\n         });\n-    });\n \n-    $urlButton.click(function () {\n-        let url = $blobKeyField.val();\n+        let url = blobKeyField.value;\n \n         if (!url.startsWith('http://') && !url.startsWith('https://')) {\n             url = '';\n         }\n \n-        $(this).blur();\n-        $(this).popover('toggle');\n+        input.value = url;\n+        input.select();\n \n-        const $input = $(this).next('.popover').find('input');\n-        const $applyButton = $(this).next('.popover').find('.button-apply');\n+        checkURL(input.value, applyButton);\n+    });\n \n-        $input.val(url).select();\n+    urlButton.addEventListener('click', function (e) {\n+        e.preventDefault();\n+        urlButton.blur();\n \n-        checkURL($input.val(), $applyButton);\n+        $(urlButton).popover('toggle');\n     });\n \n-    $resetButton.click(function (e) {\n+    resetButton.addEventListener('click', function (e) {\n         e.preventDefault();\n-        $(this).blur();\n+        resetButton.blur();\n \n-        $blobKeyField.val('');\n+        blobKeyField.value = '';\n \n         updateFile('');\n         updateResetButton();\n     });\n \n-    $selectButton.click(function () {\n-        const currentPath = $element.data('path') || blobStorageSpacePath;\n+    selectButton.addEventListener('click', function (e) {\n+        e.preventDefault();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 132}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NjU4MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    const currentPath = element.getAttribute('data-path') || blobStorageSpacePath;\n          \n          \n            \n                    const currentPath = element.dataset.path || blobStorageSpacePath;", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506096581", "createdAt": "2020-10-16T06:50:48Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);\n \n-    $urlButton.popover({\n+    $(urlButton).popover({\n         html: true, trigger: 'manual', content: function () {\n-            return $element.find('.popover-content').html();\n+            return element.querySelector('.popover-content').innerHTML;\n         }\n     });\n \n-    $urlButton.on('inserted.bs.popover', function () {\n-        const $popup = $(this);\n-        const $closeButton = $popup.next('.popover').find('.button-close');\n-        const $applyButton = $popup.next('.popover').find('.button-apply');\n-        const $input = $popup.next('.popover').find('input');\n+    $(urlButton).on('inserted.bs.popover', function () {\n+        const popover = urlButton.parentElement.querySelector('.popover');\n+        const closeButton = popover.querySelector('.button-close');\n+        const applyButton = popover.querySelector('.button-apply');\n+        const input = popover.querySelector('input');\n \n-        $closeButton.click(function () {\n-            $popup.popover('hide');\n+        closeButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            $(urlButton).popover('hide');\n         });\n \n-        $input.bind(\"input propertychange\", function () {\n-            checkURL($input.val(), $applyButton);\n+        input.addEventListener('input', function () {\n+            checkURL(input.value, applyButton);\n         });\n \n-        $input.keyup(function (e) {\n+        input.addEventListener('paste', function () {\n+            checkURL(input.value, applyButton);\n+        });\n+\n+        input.addEventListener('keyup', function (e) {\n             if (e.which === 13) {\n-                updateURL($input.val());\n+                updateURL(input.value);\n             }\n         });\n \n-        $applyButton.click(function () {\n-            updateURL($input.val());\n+        applyButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            updateURL(input.value);\n         });\n-    });\n \n-    $urlButton.click(function () {\n-        let url = $blobKeyField.val();\n+        let url = blobKeyField.value;\n \n         if (!url.startsWith('http://') && !url.startsWith('https://')) {\n             url = '';\n         }\n \n-        $(this).blur();\n-        $(this).popover('toggle');\n+        input.value = url;\n+        input.select();\n \n-        const $input = $(this).next('.popover').find('input');\n-        const $applyButton = $(this).next('.popover').find('.button-apply');\n+        checkURL(input.value, applyButton);\n+    });\n \n-        $input.val(url).select();\n+    urlButton.addEventListener('click', function (e) {\n+        e.preventDefault();\n+        urlButton.blur();\n \n-        checkURL($input.val(), $applyButton);\n+        $(urlButton).popover('toggle');\n     });\n \n-    $resetButton.click(function (e) {\n+    resetButton.addEventListener('click', function (e) {\n         e.preventDefault();\n-        $(this).blur();\n+        resetButton.blur();\n \n-        $blobKeyField.val('');\n+        blobKeyField.value = '';\n \n         updateFile('');\n         updateResetButton();\n     });\n \n-    $selectButton.click(function () {\n-        const currentPath = $element.data('path') || blobStorageSpacePath;\n+    selectButton.addEventListener('click', function (e) {\n+        e.preventDefault();\n+\n+        const currentPath = element.getAttribute('data-path') || blobStorageSpacePath;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 134}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5NjkwNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            element.setAttribute('data-path', selectedValue);\n          \n          \n            \n                            element.dataset.path = selectedValue;", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506096904", "createdAt": "2020-10-16T06:51:07Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -43,81 +43,89 @@ function initBlobSoftRefField($element,\n \n     const blobStorageSpacePath = '/' + blobStorageSpace;\n \n-    const $selectButton = $element.find('.btn-select-file-js');\n-    const $urlButton = $element.find('[data-toggle=popover]');\n-    const $resetButton = $element.find('.btn-reset-js');\n-    const $fileElement = $element.find('.file-js');\n+    const selectButton = element.querySelector('.btn-select-file-js');\n+    const urlButton = element.querySelector('[data-toggle=popover]');\n+    const resetButton = element.querySelector('.btn-reset-js');\n+    const fileElement = element.querySelector('.file-js');\n \n-    $element.data('path', originalPath);\n+    element.setAttribute('data-path', originalPath);\n \n-    $urlButton.popover({\n+    $(urlButton).popover({\n         html: true, trigger: 'manual', content: function () {\n-            return $element.find('.popover-content').html();\n+            return element.querySelector('.popover-content').innerHTML;\n         }\n     });\n \n-    $urlButton.on('inserted.bs.popover', function () {\n-        const $popup = $(this);\n-        const $closeButton = $popup.next('.popover').find('.button-close');\n-        const $applyButton = $popup.next('.popover').find('.button-apply');\n-        const $input = $popup.next('.popover').find('input');\n+    $(urlButton).on('inserted.bs.popover', function () {\n+        const popover = urlButton.parentElement.querySelector('.popover');\n+        const closeButton = popover.querySelector('.button-close');\n+        const applyButton = popover.querySelector('.button-apply');\n+        const input = popover.querySelector('input');\n \n-        $closeButton.click(function () {\n-            $popup.popover('hide');\n+        closeButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            $(urlButton).popover('hide');\n         });\n \n-        $input.bind(\"input propertychange\", function () {\n-            checkURL($input.val(), $applyButton);\n+        input.addEventListener('input', function () {\n+            checkURL(input.value, applyButton);\n         });\n \n-        $input.keyup(function (e) {\n+        input.addEventListener('paste', function () {\n+            checkURL(input.value, applyButton);\n+        });\n+\n+        input.addEventListener('keyup', function (e) {\n             if (e.which === 13) {\n-                updateURL($input.val());\n+                updateURL(input.value);\n             }\n         });\n \n-        $applyButton.click(function () {\n-            updateURL($input.val());\n+        applyButton.addEventListener('click', function (e) {\n+            e.preventDefault();\n+            updateURL(input.value);\n         });\n-    });\n \n-    $urlButton.click(function () {\n-        let url = $blobKeyField.val();\n+        let url = blobKeyField.value;\n \n         if (!url.startsWith('http://') && !url.startsWith('https://')) {\n             url = '';\n         }\n \n-        $(this).blur();\n-        $(this).popover('toggle');\n+        input.value = url;\n+        input.select();\n \n-        const $input = $(this).next('.popover').find('input');\n-        const $applyButton = $(this).next('.popover').find('.button-apply');\n+        checkURL(input.value, applyButton);\n+    });\n \n-        $input.val(url).select();\n+    urlButton.addEventListener('click', function (e) {\n+        e.preventDefault();\n+        urlButton.blur();\n \n-        checkURL($input.val(), $applyButton);\n+        $(urlButton).popover('toggle');\n     });\n \n-    $resetButton.click(function (e) {\n+    resetButton.addEventListener('click', function (e) {\n         e.preventDefault();\n-        $(this).blur();\n+        resetButton.blur();\n \n-        $blobKeyField.val('');\n+        blobKeyField.value = '';\n \n         updateFile('');\n         updateResetButton();\n     });\n \n-    $selectButton.click(function () {\n-        const currentPath = $element.data('path') || blobStorageSpacePath;\n+    selectButton.addEventListener('click', function (e) {\n+        e.preventDefault();\n+\n+        const currentPath = element.getAttribute('data-path') || blobStorageSpacePath;\n \n         selectVFSFile(currentPath, blobStorageSpacePath).then(function (selectedValue) {\n             $.getJSON('/dasd/blob-info-for-path/' + blobStorageSpace, {\n                 path: selectedValue.substring(blobStorageSpacePath.length)\n             }, function (json) {\n-                $blobKeyField.val(json.fileId);\n-                $element.data('path', selectedValue);\n+                blobKeyField.value = json.fileId;\n+                element.setAttribute('data-path', selectedValue);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1d10bafe8882070a601d8f9b792749bf2d95a31"}, "originalPosition": 143}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5Nzg0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                element.setAttribute('data-path', determineParentPath(originalPath));\n          \n          \n            \n                element.dataset.path = determineParentPath(originalPath);", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506097841", "createdAt": "2020-10-16T06:52:07Z", "author": {"login": "sabieber"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -241,5 +232,14 @@ function initBlobSoftRefField(element,\n         return 'fa-file-o';\n     };\n \n-    updateFile(originalUrl, originalFilename);\n+    const determineFilename = function (path) {\n+        return path.substr(path.lastIndexOf(\"/\") + 1);\n+    };\n+\n+    const determineParentPath = function (path) {\n+        return path.substr(0, path.lastIndexOf(\"/\"));\n+    };\n+\n+    element.setAttribute('data-path', determineParentPath(originalPath));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b67a17ff1b296d891895eb30bce0530a5c7b0afd"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjI1MzUy", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510225352", "createdAt": "2020-10-16T07:41:25Z", "commit": {"oid": "75f1684e7f5e3701fc44ed659bbf46f62e1d90ef"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b216b40928bac1eba5d8dc565ff655dac62dfe40", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/b216b40928bac1eba5d8dc565ff655dac62dfe40", "committedDate": "2020-10-16T07:49:10Z", "message": "Use a more modern way to access the data attributes\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3694851c91dff5e45980e42558a18348b54162b7", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/3694851c91dff5e45980e42558a18348b54162b7", "committedDate": "2020-10-16T07:49:59Z", "message": "Use better variable names for events\n\nFixes: SE-10084"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7d8bae3234f8f26d19ba39984e6f7118160b2a7", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/c7d8bae3234f8f26d19ba39984e6f7118160b2a7", "committedDate": "2020-10-16T07:56:42Z", "message": "Check for the pressed key in a more readable way\n\nFixes: SE-10084"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjM3MjUx", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510237251", "createdAt": "2020-10-16T07:59:05Z", "commit": {"oid": "c7d8bae3234f8f26d19ba39984e6f7118160b2a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjQyMDQy", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510242042", "createdAt": "2020-10-16T08:05:37Z", "commit": {"oid": "c7d8bae3234f8f26d19ba39984e6f7118160b2a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjczMTE2", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510273116", "createdAt": "2020-10-16T08:48:07Z", "commit": {"oid": "c7d8bae3234f8f26d19ba39984e6f7118160b2a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwODo0ODowN1rOHiu9zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwODo0ODowN1rOHiu9zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjE4MzExOQ==", "bodyText": "@nullable", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506183119", "createdAt": "2020-10-16T08:48:07Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/storage/layer2/BlobHardRef.java", "diffHunk": "@@ -95,6 +95,19 @@ public String getFilename() {\n         return getBlob().getFilename();\n     }\n \n+    /**\n+     * Determines the path of the referenced blob.\n+     *\n+     * @return the path, or <tt>null</tt> if no blob is referenced\n+     */\n+    public String getPath() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7d8bae3234f8f26d19ba39984e6f7118160b2a7"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjczNjM5", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510273639", "createdAt": "2020-10-16T08:48:46Z", "commit": {"oid": "c7d8bae3234f8f26d19ba39984e6f7118160b2a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwODo0ODo0NlrOHiu_gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQwODo0ODo0NlrOHiu_gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjE4MzU1NA==", "bodyText": "sexy! \ud83d\udc4d", "url": "https://github.com/scireum/sirius-biz/pull/880#discussion_r506183554", "createdAt": "2020-10-16T08:48:46Z", "author": {"login": "andyHa"}, "path": "src/main/resources/default/assets/javascript/blobreffield.js", "diffHunk": "@@ -0,0 +1,245 @@\n+/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7d8bae3234f8f26d19ba39984e6f7118160b2a7"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjc0MzIx", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510274321", "createdAt": "2020-10-16T08:49:38Z", "commit": {"oid": "c7d8bae3234f8f26d19ba39984e6f7118160b2a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4803903768e13ef1801e9c30b46dd21ea04070af", "author": {"user": {"login": "jmuscireum", "name": null}}, "url": "https://github.com/scireum/sirius-biz/commit/4803903768e13ef1801e9c30b46dd21ea04070af", "committedDate": "2020-10-16T09:11:41Z", "message": "Add Nullable annotations to blob refs\n\nFixes: SE-10084"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjk2MzI2", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510296326", "createdAt": "2020-10-16T09:18:10Z", "commit": {"oid": "4803903768e13ef1801e9c30b46dd21ea04070af"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMjk5MzMz", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510299333", "createdAt": "2020-10-16T09:22:10Z", "commit": {"oid": "4803903768e13ef1801e9c30b46dd21ea04070af"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMzAwNTA1", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510300505", "createdAt": "2020-10-16T09:23:35Z", "commit": {"oid": "4803903768e13ef1801e9c30b46dd21ea04070af"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwMzY2NDM1", "url": "https://github.com/scireum/sirius-biz/pull/880#pullrequestreview-510366435", "createdAt": "2020-10-16T11:00:04Z", "commit": {"oid": "4803903768e13ef1801e9c30b46dd21ea04070af"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4204, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}