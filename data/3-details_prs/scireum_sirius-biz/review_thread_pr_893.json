{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExMTk0NjY2", "number": 893, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNTowNzo1OFrOEyptzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNTozODo1NlrOEyqEPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxNTQ3NzI2OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/tenants/jdbc/SQLTenant.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNTowNzo1OFrOHpaPTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNTowNzo1OFrOHpaPTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE4MzU2NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // NOOP if no AdditionalRolesProviders arep resent...\n          \n          \n            \n                        // NOOP if no AdditionalRolesProviders are present...", "url": "https://github.com/scireum/sirius-biz/pull/893#discussion_r513183565", "createdAt": "2020-10-28T05:07:58Z", "author": {"login": "bwiedmann"}, "path": "src/main/java/sirius/biz/tenants/jdbc/SQLTenant.java", "diffHunk": "@@ -71,7 +72,12 @@ public boolean hasPermission(String permission) {\n                 permissions.add(\"tenant-\" + tenantData.getAccountNumber());\n             }\n \n+            // We assign here, in case an AdditionalRolesProvider uses hasPermission recursively...\n             effectivePermissions = permissions;\n+\n+            // and we assign again the final value after all AdditionalRolesProviders ran. Note that this is a\n+            // NOOP if no AdditionalRolesProviders arep resent...", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e99169414d7234ae36b5fe679988dc172315fa49"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxNTQ3Nzc1OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/tenants/mongo/MongoTenant.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNTowODoyOFrOHpaPsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNTowODoyOFrOHpaPsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE4MzY2NA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // NOOP if no AdditionalRolesProviders arep resent...\n          \n          \n            \n                        // NOOP if no AdditionalRolesProviders are present...", "url": "https://github.com/scireum/sirius-biz/pull/893#discussion_r513183664", "createdAt": "2020-10-28T05:08:28Z", "author": {"login": "bwiedmann"}, "path": "src/main/java/sirius/biz/tenants/mongo/MongoTenant.java", "diffHunk": "@@ -80,7 +81,12 @@ public boolean hasPermission(String permission) {\n                 permissions.add(\"tenant-\" + tenantData.getAccountNumber());\n             }\n \n+            // We assign here, in case an AdditionalRolesProvider uses hasPermission recursively...\n             effectivePermissions = permissions;\n+\n+            // and we assign again the final value after all AdditionalRolesProviders ran. Note that this is a\n+            // NOOP if no AdditionalRolesProviders arep resent...", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e99169414d7234ae36b5fe679988dc172315fa49"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxNTUzNDY4OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/tenants/AdditionalRolesProvider.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNTozODo1NlrOHpawPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNTozODo1NlrOHpawPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE5MTk5OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * maps which e.g. deciede which roles are offered for a user (based on the capabilities of its tenant).\n          \n          \n            \n                 * maps which e.g. decide which roles are offered for a user (based on the capabilities of its tenant).", "url": "https://github.com/scireum/sirius-biz/pull/893#discussion_r513191999", "createdAt": "2020-10-28T05:38:56Z", "author": {"login": "mkeckmkeck"}, "path": "src/main/java/sirius/biz/tenants/AdditionalRolesProvider.java", "diffHunk": "@@ -22,4 +22,20 @@\n      * @param roleConsumer the consumer for the additonal roles\n      */\n     void addAdditionalRoles(UserAccount<?, ?> user, Consumer<String> roleConsumer);\n+\n+    /**\n+     * Adds additional roles / permissions / flag specifically to {@link Tenant#hasPermission(String)}.\n+     * <p>\n+     * Note that permissions added here, still have to be reported by {@link #addAdditionalRoles(UserAccount, Consumer)}\n+     * in order to be present for a user.\n+     * <p>\n+     * The main reason to implement this method is to toggle some flags which are used in role to permission\n+     * maps which e.g. deciede which roles are offered for a user (based on the capabilities of its tenant).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e99169414d7234ae36b5fe679988dc172315fa49"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1818, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}