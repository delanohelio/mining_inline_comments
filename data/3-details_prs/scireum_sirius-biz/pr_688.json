{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3ODUwNzA3", "number": 688, "title": "Mongo Searchable Prefixes via BiConsumer", "bodyText": "Offers the ability to create Transformers to offer an alternative way to collect values to index from Properties, where the standard getValue() is not applicable.\nAlso adds the Optimus Prime , Megatron and Bumblebee transformers for MultiLanguageString, StringList and StringMap respectively \ud83d\ude09", "createdAt": "2020-02-20T16:23:10Z", "url": "https://github.com/scireum/sirius-biz/pull/688", "merged": true, "mergeCommit": {"oid": "a0d0fc13899bdd26e29542cc2f3a824787a6ec6a"}, "closed": true, "closedAt": "2020-02-26T10:38:05Z", "author": {"login": "idlira"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGNcZwgH2gAyMzc3ODUwNzA3OjhmN2U3NTU2Y2UwYWYwMzhhNmQwNDczNDljOTRmMmI3NWRlYjk2NmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIDmmOgH2gAyMzc3ODUwNzA3OjFiOTA1YmI4ZTMxZDNlNWViM2Q3NGYwMDE4MGMzM2RhMzliYTM0ZWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8f7e7556ce0af038a6d047349c94f2b75deb966f", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/8f7e7556ce0af038a6d047349c94f2b75deb966f", "committedDate": "2020-02-20T16:09:25Z", "message": "Upgrades sirius-db to dev-13.1\n\nIncludes the latest changes around MultiLanguageStrings\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1669fa9597633b0d493da3db4920d6337e6b634a", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/1669fa9597633b0d493da3db4920d6337e6b634a", "committedDate": "2020-02-20T16:14:35Z", "message": "Introduces a PrefixSearchableContentSupplier\n\nWhich combined with a Transformer, offer an alternative method to retrieve Property's values when the default #getValue is not applicable.\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a0252d985eefd7d2032922a76f05829b59436f8", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/4a0252d985eefd7d2032922a76f05829b59436f8", "committedDate": "2020-02-20T16:15:12Z", "message": "Adds transformers to index values of StringMap and MultiLanguageString\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a1336431890451c194eb8e04b7e83d6e9bec4e9", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/9a1336431890451c194eb8e04b7e83d6e9bec4e9", "committedDate": "2020-02-20T16:16:03Z", "message": "Enhance the searchable prefix test cases\n\nIncluding tests for StringMap and MultiLanguageString\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7aced99e32c7b0b41a7dd62d71536251d4356add", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/7aced99e32c7b0b41a7dd62d71536251d4356add", "committedDate": "2020-02-21T07:28:16Z", "message": "Code formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNTA4MzUy", "url": "https://github.com/scireum/sirius-biz/pull/688#pullrequestreview-362508352", "createdAt": "2020-02-21T09:45:28Z", "commit": {"oid": "7aced99e32c7b0b41a7dd62d71536251d4356add"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwOTo0NToyOFrOFsxIxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQwOTo0NToyOFrOFsxIxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQ4NjcyNw==", "bodyText": "why this intermediate step, couldn't we transform into a BiConsumer which accepts an entity and a StringBuilder or even BiConsumer<PrefixSearchableEntity, Consumer> and then invoke with (entity, this::addContentString) or the like", "url": "https://github.com/scireum/sirius-biz/pull/688#discussion_r382486727", "createdAt": "2020-02-21T09:45:28Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/mongo/MultiLanguageStringPropertyTransformer.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.mongo;\n+\n+import sirius.db.mixing.properties.MultiLanguageStringProperty;\n+import sirius.db.mixing.types.StringList;\n+import sirius.kernel.di.std.Register;\n+import sirius.kernel.di.transformers.Transformer;\n+\n+import javax.annotation.Nonnull;\n+import javax.annotation.Nullable;\n+import java.util.Map;\n+\n+/**\n+ * Generates a {@link StringList} from the values of a {@link MultiLanguageStringProperty}.\n+ */\n+@Register\n+public class MultiLanguageStringPropertyTransformer\n+        implements Transformer<MultiLanguageStringProperty, PrefixSearchableContentSupplier> {\n+\n+    @Override\n+    public Class<MultiLanguageStringProperty> getSourceClass() {\n+        return MultiLanguageStringProperty.class;\n+    }\n+\n+    @Override\n+    public Class<PrefixSearchableContentSupplier> getTargetClass() {\n+        return PrefixSearchableContentSupplier.class;\n+    }\n+\n+    @Nullable\n+    @Override\n+    @SuppressWarnings(\"unchecked\")\n+    public PrefixSearchableContentSupplier make(@Nonnull MultiLanguageStringProperty source) {\n+        return entity -> {\n+            StringList tokens = new StringList();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7aced99e32c7b0b41a7dd62d71536251d4356add"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNTM0NDAx", "url": "https://github.com/scireum/sirius-biz/pull/688#pullrequestreview-362534401", "createdAt": "2020-02-21T10:29:16Z", "commit": {"oid": "7aced99e32c7b0b41a7dd62d71536251d4356add"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8ccd204dab6c0c6c1b26c04a865cc15200d3325", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/b8ccd204dab6c0c6c1b26c04a865cc15200d3325", "committedDate": "2020-02-21T13:42:57Z", "message": "Merge branch 'master' into ili/SearchablePrefixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "628348271ffbe599cf0df49080997cfc8fe334a2", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/628348271ffbe599cf0df49080997cfc8fe334a2", "committedDate": "2020-02-24T15:34:49Z", "message": "Refactors the tokenizing of searchable prefixes\n\nIntroducing a BiConsumer as base interface for Transformers, which shall implement the logic to deal with the property type and tokenize its items by invoking the given consumer.\nSame as before, property.getValue is used when no transformer exist.\n\nNote that addContent has been removed as the logic in this method should be implemented as Transformers.\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0aec9db674bc257faae8cc48e528d334518a95b", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/e0aec9db674bc257faae8cc48e528d334518a95b", "committedDate": "2020-02-24T15:35:30Z", "message": "Replaces defunct method\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5adc0703181369857c0f66dd96b8dee2ab6cb8e1", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/5adc0703181369857c0f66dd96b8dee2ab6cb8e1", "committedDate": "2020-02-24T15:37:16Z", "message": "Fixes the transformers to return the expected consumer\n\nAdds a new transformer for StringListProperty\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bfce98195963628b0e3a14511dd4ee3525814b5", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/1bfce98195963628b0e3a14511dd4ee3525814b5", "committedDate": "2020-02-24T15:37:54Z", "message": "Adds StringList to test case\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNTA0OTg2", "url": "https://github.com/scireum/sirius-biz/pull/688#pullrequestreview-363504986", "createdAt": "2020-02-24T16:05:09Z", "commit": {"oid": "1bfce98195963628b0e3a14511dd4ee3525814b5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzOTIwNDg1", "url": "https://github.com/scireum/sirius-biz/pull/688#pullrequestreview-363920485", "createdAt": "2020-02-25T07:35:42Z", "commit": {"oid": "1bfce98195963628b0e3a14511dd4ee3525814b5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MTk1MDYx", "url": "https://github.com/scireum/sirius-biz/pull/688#pullrequestreview-364195061", "createdAt": "2020-02-25T14:44:35Z", "commit": {"oid": "1bfce98195963628b0e3a14511dd4ee3525814b5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNDo0NDozNVrOFuIv9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxNDo0NDozNVrOFuIv9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzkyMjE2Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public interface PrefixSearchableContentConsumer extends BiConsumer<PrefixSearchableEntity, Consumer<Object>> {\n          \n          \n            \n            public interface PrefixSearchableContentConsumer extends BiConsumer<PrefixSearchableEntity, Consumer<String>> {", "url": "https://github.com/scireum/sirius-biz/pull/688#discussion_r383922167", "createdAt": "2020-02-25T14:44:35Z", "author": {"login": "andyHa"}, "path": "src/main/java/sirius/biz/mongo/PrefixSearchableContentConsumer.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * Made with all the love in the world\n+ * by scireum in Remshalden, Germany\n+ *\n+ * Copyright by scireum GmbH\n+ * http://www.scireum.de - info@scireum.de\n+ */\n+\n+package sirius.biz.mongo;\n+\n+import java.util.function.BiConsumer;\n+import java.util.function.Consumer;\n+\n+/**\n+ * Used as target class to transform {@link sirius.db.mixing.Property properties} into a {@link BiConsumer}.\n+ * <p>\n+ * The consumer takes the {@link PrefixSearchableEntity} containing the values to extract which are then\n+ * passed as the {@link Consumer} argument.\n+ */\n+public interface PrefixSearchableContentConsumer extends BiConsumer<PrefixSearchableEntity, Consumer<Object>> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1bfce98195963628b0e3a14511dd4ee3525814b5"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MTk1MTU4", "url": "https://github.com/scireum/sirius-biz/pull/688#pullrequestreview-364195158", "createdAt": "2020-02-25T14:44:42Z", "commit": {"oid": "1bfce98195963628b0e3a14511dd4ee3525814b5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fa9c152d8b2627af70dbe07a75bdae50de5354d", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/4fa9c152d8b2627af70dbe07a75bdae50de5354d", "committedDate": "2020-02-25T15:12:20Z", "message": "Changes the Consumer to receive a String to tokenize instead of a generic object\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecfda5553694e5fb73eed279511a0ca37559300b", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/ecfda5553694e5fb73eed279511a0ca37559300b", "committedDate": "2020-02-25T20:23:52Z", "message": "Refactor addContentAsTokens to accept String instead of Object\n\nKeeping the tokenizing functions / transformers in sync.\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6e3743923a5b4a3f1f0efab567a91c63f991993", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/c6e3743923a5b4a3f1f0efab567a91c63f991993", "committedDate": "2020-02-26T09:43:56Z", "message": "Revert \"Refactor addContentAsTokens to accept String instead of Object\"\n\nThis reverts commit ecfda555\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81dcdc6e8d417176201d1b2aee5a268a45cd6c5c", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/81dcdc6e8d417176201d1b2aee5a268a45cd6c5c", "committedDate": "2020-02-26T09:44:06Z", "message": "Revert \"Changes the Consumer to receive a String to tokenize instead of a generic object\"\n\nThis reverts commit 4fa9c152\n\nFixes: SIRI-171"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b905bb8e31d3e5eb3d74f00180c33da39ba34ea", "author": {"user": {"login": "idlira", "name": "Idevaldo De Lira"}}, "url": "https://github.com/scireum/sirius-biz/commit/1b905bb8e31d3e5eb3d74f00180c33da39ba34ea", "committedDate": "2020-02-26T09:49:21Z", "message": "Reverts the String - Object\n\nFixes: SIRI-171"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4526, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}