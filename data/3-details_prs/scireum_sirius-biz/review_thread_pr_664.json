{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0MDU1MTY0", "number": 664, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwOTo1NzozMVrODYxFFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxMDowNTozNlrODYxNxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3Mjk2NTM0OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/jobs/params/BooleanParameter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwOTo1NzozMVrOFez_tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QwOTo1NzozMVrOFez_tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg1MzQ5NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"A boolean parameter must not be marked as required as it is inherently so. Use markNullable() to make the parameter optional\");\n          \n          \n            \n                            \"A boolean parameter must not be marked as required as it is inherently so. Use markNullable() to make the parameter optional.\");", "url": "https://github.com/scireum/sirius-biz/pull/664#discussion_r367853495", "createdAt": "2020-01-17T09:57:31Z", "author": {"login": "meg1502"}, "path": "src/main/java/sirius/biz/jobs/params/BooleanParameter.java", "diffHunk": "@@ -47,18 +50,41 @@ protected String checkAndTransformValue(Value input) {\n         if (isRequired() && !input.asBoolean()) {\n             return null;\n         }\n-\n+        if (nullable && !resolveFromString(input).isPresent()) {\n+            return null;\n+        }\n         return NLS.toMachineString(input.asBoolean());\n     }\n \n+    /**\n+     * Marks the parameter as boolean.\n+     * <p>\n+     * This allows for a tri-state boolean where a job parameter can also receive\n+     * {@code null} when a value is not selected instead of being defaulted to false.\n+     *\n+     * @return the parameter itself for fluent method calls\n+     */\n+    public BooleanParameter markNullable() {\n+        this.nullable = true;\n+        return self();\n+    }\n+\n     @Override\n     public BooleanParameter markRequired() {\n         throw new UnsupportedOperationException(\n-                \"A boolean parameter must not be marked as required as it is inherently so!\");\n+                \"A boolean parameter must not be marked as required as it is inherently so. Use markNullable() to make the parameter optional\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfe60f40daef36c4a900341c0a9157bf4bdbc6e5"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3Mjk4NzU3OnYy", "diffSide": "RIGHT", "path": "src/main/java/sirius/biz/jobs/params/BooleanParameter.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxMDowNTozNlrOFe0Now==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxMDoxMzo0MFrOFe0byQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg1NzA1OQ==", "bodyText": "this does not match the parsing of input.asBoolean which is used when the parameter is required, as $NLS.yes is also considerd as true (and $NLS.no as false)\n->\nif the parameter is required i will get true for \"yes\"\nif the parameter is nullable i will get null for \"yes\"", "url": "https://github.com/scireum/sirius-biz/pull/664#discussion_r367857059", "createdAt": "2020-01-17T10:05:36Z", "author": {"login": "meg1502"}, "path": "src/main/java/sirius/biz/jobs/params/BooleanParameter.java", "diffHunk": "@@ -47,18 +50,41 @@ protected String checkAndTransformValue(Value input) {\n         if (isRequired() && !input.asBoolean()) {\n             return null;\n         }\n-\n+        if (nullable && !resolveFromString(input).isPresent()) {\n+            return null;\n+        }\n         return NLS.toMachineString(input.asBoolean());\n     }\n \n+    /**\n+     * Marks the parameter as boolean.\n+     * <p>\n+     * This allows for a tri-state boolean where a job parameter can also receive\n+     * {@code null} when a value is not selected instead of being defaulted to false.\n+     *\n+     * @return the parameter itself for fluent method calls\n+     */\n+    public BooleanParameter markNullable() {\n+        this.nullable = true;\n+        return self();\n+    }\n+\n     @Override\n     public BooleanParameter markRequired() {\n         throw new UnsupportedOperationException(\n-                \"A boolean parameter must not be marked as required as it is inherently so!\");\n+                \"A boolean parameter must not be marked as required as it is inherently so. Use markNullable() to make the parameter optional\");\n     }\n \n     @Override\n-    protected Optional<Boolean> resolveFromString(Value input) {\n+    public boolean isRequired() {\n+        return !nullable;\n+    }\n+\n+    @Override\n+    protected Optional<Boolean> resolveFromString(@Nonnull Value input) {\n+        if (nullable && !(\"true\".equalsIgnoreCase(input.asString()) || \"false\".equalsIgnoreCase(input.asString()))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfe60f40daef36c4a900341c0a9157bf4bdbc6e5"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg1OTUwMg==", "bodyText": "my suggestion:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (nullable && !(\"true\".equalsIgnoreCase(input.asString()) || \"false\".equalsIgnoreCase(input.asString()))) {\n          \n          \n            \n                    if (nullable && !input.isFilled()) {", "url": "https://github.com/scireum/sirius-biz/pull/664#discussion_r367859502", "createdAt": "2020-01-17T10:11:05Z", "author": {"login": "meg1502"}, "path": "src/main/java/sirius/biz/jobs/params/BooleanParameter.java", "diffHunk": "@@ -47,18 +50,41 @@ protected String checkAndTransformValue(Value input) {\n         if (isRequired() && !input.asBoolean()) {\n             return null;\n         }\n-\n+        if (nullable && !resolveFromString(input).isPresent()) {\n+            return null;\n+        }\n         return NLS.toMachineString(input.asBoolean());\n     }\n \n+    /**\n+     * Marks the parameter as boolean.\n+     * <p>\n+     * This allows for a tri-state boolean where a job parameter can also receive\n+     * {@code null} when a value is not selected instead of being defaulted to false.\n+     *\n+     * @return the parameter itself for fluent method calls\n+     */\n+    public BooleanParameter markNullable() {\n+        this.nullable = true;\n+        return self();\n+    }\n+\n     @Override\n     public BooleanParameter markRequired() {\n         throw new UnsupportedOperationException(\n-                \"A boolean parameter must not be marked as required as it is inherently so!\");\n+                \"A boolean parameter must not be marked as required as it is inherently so. Use markNullable() to make the parameter optional\");\n     }\n \n     @Override\n-    protected Optional<Boolean> resolveFromString(Value input) {\n+    public boolean isRequired() {\n+        return !nullable;\n+    }\n+\n+    @Override\n+    protected Optional<Boolean> resolveFromString(@Nonnull Value input) {\n+        if (nullable && !(\"true\".equalsIgnoreCase(input.asString()) || \"false\".equalsIgnoreCase(input.asString()))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg1NzA1OQ=="}, "originalCommit": {"oid": "dfe60f40daef36c4a900341c0a9157bf4bdbc6e5"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg1OTc0Nw==", "bodyText": "Cannot use input.asBoolean here (is actually the whole point of it), because it evaluates anything else as false. In this usage case (and the actual values of the selectBoolean template) only allow (and expect) true or false.", "url": "https://github.com/scireum/sirius-biz/pull/664#discussion_r367859747", "createdAt": "2020-01-17T10:11:41Z", "author": {"login": "idlira"}, "path": "src/main/java/sirius/biz/jobs/params/BooleanParameter.java", "diffHunk": "@@ -47,18 +50,41 @@ protected String checkAndTransformValue(Value input) {\n         if (isRequired() && !input.asBoolean()) {\n             return null;\n         }\n-\n+        if (nullable && !resolveFromString(input).isPresent()) {\n+            return null;\n+        }\n         return NLS.toMachineString(input.asBoolean());\n     }\n \n+    /**\n+     * Marks the parameter as boolean.\n+     * <p>\n+     * This allows for a tri-state boolean where a job parameter can also receive\n+     * {@code null} when a value is not selected instead of being defaulted to false.\n+     *\n+     * @return the parameter itself for fluent method calls\n+     */\n+    public BooleanParameter markNullable() {\n+        this.nullable = true;\n+        return self();\n+    }\n+\n     @Override\n     public BooleanParameter markRequired() {\n         throw new UnsupportedOperationException(\n-                \"A boolean parameter must not be marked as required as it is inherently so!\");\n+                \"A boolean parameter must not be marked as required as it is inherently so. Use markNullable() to make the parameter optional\");\n     }\n \n     @Override\n-    protected Optional<Boolean> resolveFromString(Value input) {\n+    public boolean isRequired() {\n+        return !nullable;\n+    }\n+\n+    @Override\n+    protected Optional<Boolean> resolveFromString(@Nonnull Value input) {\n+        if (nullable && !(\"true\".equalsIgnoreCase(input.asString()) || \"false\".equalsIgnoreCase(input.asString()))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg1NzA1OQ=="}, "originalCommit": {"oid": "dfe60f40daef36c4a900341c0a9157bf4bdbc6e5"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg2MDY4MQ==", "bodyText": "but \"yes\" and \"no\" should still be parsed as booleans, and null should possibly only be returned if the value is not filled at all?", "url": "https://github.com/scireum/sirius-biz/pull/664#discussion_r367860681", "createdAt": "2020-01-17T10:13:40Z", "author": {"login": "meg1502"}, "path": "src/main/java/sirius/biz/jobs/params/BooleanParameter.java", "diffHunk": "@@ -47,18 +50,41 @@ protected String checkAndTransformValue(Value input) {\n         if (isRequired() && !input.asBoolean()) {\n             return null;\n         }\n-\n+        if (nullable && !resolveFromString(input).isPresent()) {\n+            return null;\n+        }\n         return NLS.toMachineString(input.asBoolean());\n     }\n \n+    /**\n+     * Marks the parameter as boolean.\n+     * <p>\n+     * This allows for a tri-state boolean where a job parameter can also receive\n+     * {@code null} when a value is not selected instead of being defaulted to false.\n+     *\n+     * @return the parameter itself for fluent method calls\n+     */\n+    public BooleanParameter markNullable() {\n+        this.nullable = true;\n+        return self();\n+    }\n+\n     @Override\n     public BooleanParameter markRequired() {\n         throw new UnsupportedOperationException(\n-                \"A boolean parameter must not be marked as required as it is inherently so!\");\n+                \"A boolean parameter must not be marked as required as it is inherently so. Use markNullable() to make the parameter optional\");\n     }\n \n     @Override\n-    protected Optional<Boolean> resolveFromString(Value input) {\n+    public boolean isRequired() {\n+        return !nullable;\n+    }\n+\n+    @Override\n+    protected Optional<Boolean> resolveFromString(@Nonnull Value input) {\n+        if (nullable && !(\"true\".equalsIgnoreCase(input.asString()) || \"false\".equalsIgnoreCase(input.asString()))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg1NzA1OQ=="}, "originalCommit": {"oid": "dfe60f40daef36c4a900341c0a9157bf4bdbc6e5"}, "originalPosition": 56}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2094, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}